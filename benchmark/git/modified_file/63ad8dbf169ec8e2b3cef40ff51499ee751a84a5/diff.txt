diff --git a/convert.c b/convert.c
index 35b25eb3cb..ee4d32978e 100644
--- a/convert.c
+++ b/convert.c
@@ -322,6 +322,9 @@ static void trace_encoding(const char *context, const char *path,
 	struct strbuf trace = STRBUF_INIT;
 	int i;
 
+	if (!trace_want(&coe))
+		return;
+
 	strbuf_addf(&trace, "%s (%s, considered %s):\n", context, path, encoding);
 	for (i = 0; i < len && buf; ++i) {
 		strbuf_addf(
