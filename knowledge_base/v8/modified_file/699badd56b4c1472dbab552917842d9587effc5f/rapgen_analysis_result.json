{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/699badd56b4c1472dbab552917842d9587effc5f",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/699badd56b4c1472dbab552917842d9587effc5f/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/699badd56b4c1472dbab552917842d9587effc5f/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/699badd56b4c1472dbab552917842d9587effc5f/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 596,
          "old_api": "V8_LIKELY",
          "new_api": "unibrow::Utf8::ValueOfIncremental(&cursor, &state, &incomplete_char)",
          "old_text": "V8_LIKELY(t <= unibrow::Utf16::kMaxNonSurrogateCharCode)",
          "new_text": "unibrow::Utf8::ValueOfIncremental(&cursor, &state, &incomplete_char)",
          "old_line_content": "    if (V8_LIKELY(t <= unibrow::Utf16::kMaxNonSurrogateCharCode)) {",
          "new_line_content": "        unibrow::Utf8::ValueOfIncremental(&cursor, &state, &incomplete_char);",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "static_cast<uc16>(t)",
          "new_api": "V8_LIKELY",
          "old_text": "static_cast<uc16>(t)",
          "new_text": "V8_LIKELY(t <= unibrow::Utf16::kMaxNonSurrogateCharCode)",
          "old_line_content": "      *(output_cursor++) = static_cast<uc16>(t);  // The most frequent case.",
          "new_line_content": "    if (V8_LIKELY(t <= unibrow::Utf16::kMaxNonSurrogateCharCode)) {",
          "content_same": false
        },
        {
          "line": 602,
          "old_api": "unibrow::Utf16::TrailSurrogate(t)",
          "new_api": "unibrow::Utf16::LeadSurrogate(t)",
          "old_text": "unibrow::Utf16::TrailSurrogate(t)",
          "new_text": "unibrow::Utf16::LeadSurrogate(t)",
          "old_line_content": "      *(output_cursor++) = unibrow::Utf16::TrailSurrogate(t);",
          "new_line_content": "      *(output_cursor++) = unibrow::Utf16::LeadSurrogate(t);",
          "content_same": false
        },
        {
          "line": 635,
          "old_api": "empty",
          "new_api": "GetMoreData",
          "old_text": "chunks_.empty()",
          "new_text": "source_stream_->GetMoreData(&chunk)",
          "old_line_content": "  if (chunks_.empty()) {",
          "new_line_content": "  size_t length = source_stream_->GetMoreData(&chunk);",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": "DCHECK_EQ",
          "new_api": "push_back",
          "old_text": "DCHECK_EQ(current_.chunk_no, 0u)",
          "new_text": "chunks_.push_back({chunk, length, current_.pos})",
          "old_line_content": "    DCHECK_EQ(current_.chunk_no, 0u);",
          "new_line_content": "  chunks_.push_back({chunk, length, current_.pos});",
          "content_same": false
        },
        {
          "line": 694,
          "old_api": "FetchChunk",
          "new_api": "DCHECK_EQ",
          "old_text": "FetchChunk()",
          "new_text": "DCHECK_EQ(position, current_.pos.chars)",
          "old_line_content": "    have_more_data = FetchChunk();",
          "new_line_content": "    DCHECK_EQ(position, current_.pos.chars);",
          "content_same": false
        },
        {
          "line": 701,
          "old_api": "back",
          "new_api": "size",
          "old_text": "chunks_.back()",
          "new_text": "chunks_.size()",
          "old_line_content": "  DCHECK_EQ(have_more_data, chunks_.back().length != 0);",
          "new_line_content": "  DCHECK_EQ(chunk_no, chunks_.size() - 1);",
          "content_same": false
        },
        {
          "line": 723,
          "old_api": "FetchChunk",
          "new_api": "SearchPosition",
          "old_text": "FetchChunk()",
          "new_text": "SearchPosition(position)",
          "old_line_content": "      out_of_data = !FetchChunk();",
          "new_line_content": "  SearchPosition(position);",
          "content_same": false
        },
        {
          "line": 738,
          "old_api": "length",
          "new_api": "FillBufferFromCurrentChunk",
          "old_text": "data->length()",
          "new_text": "FillBufferFromCurrentChunk()",
          "old_line_content": "  return ScannerStream::For(isolate, data, 0, data->length());",
          "new_line_content": "    FillBufferFromCurrentChunk();",
          "content_same": false
        },
        {
          "line": 751,
          "old_api": "actual",
          "new_api": "length",
          "old_text": "ThinString::cast(parent).actual()",
          "new_text": "data->length()",
          "old_line_content": "    if (parent.IsThinString()) parent = ThinString::cast(parent).actual();",
          "new_line_content": "  return ScannerStream::For(isolate, data, 0, data->length());",
          "content_same": false
        },
        {
          "line": 756,
          "old_api": "IsExternalOneByteString",
          "new_api": "DCHECK_GE",
          "old_text": "data->IsExternalOneByteString()",
          "new_text": "DCHECK_GE(start_pos, 0)",
          "old_line_content": "  if (data->IsExternalOneByteString()) {",
          "new_line_content": "  DCHECK_GE(start_pos, 0);",
          "content_same": false
        },
        {
          "line": 758,
          "old_api": "ExternalOneByteString::cast(*data)",
          "new_api": "length",
          "old_text": "ExternalOneByteString::cast(*data)",
          "new_text": "data->length()",
          "old_line_content": "        static_cast<size_t>(start_pos), ExternalOneByteString::cast(*data),",
          "new_line_content": "  DCHECK_LE(end_pos, data->length());",
          "content_same": false
        },
        {
          "line": 760,
          "old_api": "IsExternalTwoByteString",
          "new_api": "IsSlicedString",
          "old_text": "data->IsExternalTwoByteString()",
          "new_text": "data->IsSlicedString()",
          "old_line_content": "  } else if (data->IsExternalTwoByteString()) {",
          "new_line_content": "  if (data->IsSlicedString()) {",
          "content_same": false
        },
        {
          "line": 762,
          "old_api": "ExternalTwoByteString::cast(*data)",
          "new_api": "offset",
          "old_text": "ExternalTwoByteString::cast(*data)",
          "new_text": "string.offset()",
          "old_line_content": "        static_cast<size_t>(start_pos), ExternalTwoByteString::cast(*data),",
          "new_line_content": "    start_offset = string.offset();",
          "content_same": false
        },
        {
          "line": 763,
          "old_api": "static_cast<size_t>(end_pos)",
          "new_api": "parent",
          "old_text": "static_cast<size_t>(end_pos)",
          "new_text": "string.parent()",
          "old_line_content": "        start_offset, static_cast<size_t>(end_pos));",
          "new_line_content": "    String parent = string.parent();",
          "content_same": false
        },
        {
          "line": 764,
          "old_api": "IsSeqOneByteString",
          "new_api": "actual",
          "old_text": "data->IsSeqOneByteString()",
          "new_text": "ThinString::cast(parent).actual()",
          "old_line_content": "  } else if (data->IsSeqOneByteString()) {",
          "new_line_content": "    if (parent.IsThinString()) parent = ThinString::cast(parent).actual();",
          "content_same": false
        },
        {
          "line": 767,
          "old_api": "static_cast<size_t>(end_pos)",
          "new_api": "String::Flatten(isolate, data)",
          "old_text": "static_cast<size_t>(end_pos)",
          "new_text": "String::Flatten(isolate, data)",
          "old_line_content": "        start_offset, static_cast<size_t>(end_pos));",
          "new_line_content": "    data = String::Flatten(isolate, data);",
          "content_same": false
        },
        {
          "line": 771,
          "old_api": "Handle<SeqTwoByteString>::cast(data)",
          "new_api": "ExternalOneByteString::cast(*data)",
          "old_text": "Handle<SeqTwoByteString>::cast(data)",
          "new_text": "ExternalOneByteString::cast(*data)",
          "old_line_content": "        Handle<SeqTwoByteString>::cast(data), start_offset,",
          "new_line_content": "        static_cast<size_t>(start_pos), ExternalOneByteString::cast(*data),",
          "content_same": false
        },
        {
          "line": 780,
          "old_api": "strlen",
          "new_api": "static_cast<size_t>(end_pos)",
          "old_text": "strlen(data)",
          "new_text": "static_cast<size_t>(end_pos)",
          "old_line_content": "  return ScannerStream::ForTesting(data, strlen(data));",
          "new_line_content": "        start_offset, static_cast<size_t>(end_pos));",
          "content_same": false
        },
        {
          "line": 785,
          "old_api": "std::unique_ptr<Utf16CharacterStream>(\n      new BufferedCharacterStream<TestingStream>(\n          static_cast<size_t>(0), reinterpret_cast<const uint8_t*>(data),\n          static_cast<size_t>(length)))",
          "new_api": "static_cast<size_t>(end_pos)",
          "old_text": "std::unique_ptr<Utf16CharacterStream>(\n      new BufferedCharacterStream<TestingStream>(\n          static_cast<size_t>(0), reinterpret_cast<const uint8_t*>(data),\n          static_cast<size_t>(length)))",
          "new_text": "static_cast<size_t>(end_pos)",
          "old_line_content": "  return std::unique_ptr<Utf16CharacterStream>(",
          "new_line_content": "        static_cast<size_t>(end_pos));",
          "content_same": false
        },
        {
          "line": 787,
          "old_api": "reinterpret_cast<const uint8_t*>(data)",
          "new_api": "UNREACHABLE",
          "old_text": "reinterpret_cast<const uint8_t*>(data)",
          "new_text": "UNREACHABLE()",
          "old_line_content": "          static_cast<size_t>(0), reinterpret_cast<const uint8_t*>(data),",
          "new_line_content": "    UNREACHABLE();",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 769,
          "old_api": null,
          "new_api": "IsExternalOneByteString",
          "old_text": null,
          "new_text": "data->IsExternalOneByteString()",
          "old_line_content": "    return new RelocatingCharacterStream(",
          "new_line_content": "  if (data->IsExternalOneByteString()) {",
          "content_same": false
        },
        {
          "line": 773,
          "old_api": null,
          "new_api": "IsExternalTwoByteString",
          "old_text": null,
          "new_text": "data->IsExternalTwoByteString()",
          "old_line_content": "  } else {",
          "new_line_content": "  } else if (data->IsExternalTwoByteString()) {",
          "content_same": false
        },
        {
          "line": 775,
          "old_api": null,
          "new_api": "ExternalTwoByteString::cast(*data)",
          "old_text": null,
          "new_text": "ExternalTwoByteString::cast(*data)",
          "old_line_content": "  }",
          "new_line_content": "        static_cast<size_t>(start_pos), ExternalTwoByteString::cast(*data),",
          "content_same": false
        },
        {
          "line": 648,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "chunks_.empty()",
          "old_line_content": "",
          "new_line_content": "  if (chunks_.empty()) {",
          "content_same": false
        },
        {
          "line": 649,
          "old_api": null,
          "new_api": "DCHECK_EQ",
          "old_text": null,
          "new_text": "DCHECK_EQ(current_.chunk_no, 0u)",
          "old_line_content": "  // Did we find the terminating (zero-length) chunk? Then we're seeking",
          "new_line_content": "    DCHECK_EQ(current_.chunk_no, 0u);",
          "content_same": false
        },
        {
          "line": 650,
          "old_api": null,
          "new_api": "DCHECK_EQ",
          "old_text": null,
          "new_text": "DCHECK_EQ(current_.pos.bytes, 0u)",
          "old_line_content": "  // behind the end of the data, and position does not exist.",
          "new_line_content": "    DCHECK_EQ(current_.pos.bytes, 0u);",
          "content_same": false
        },
        {
          "line": 651,
          "old_api": null,
          "new_api": "DCHECK_EQ",
          "old_text": null,
          "new_text": "DCHECK_EQ(current_.pos.chars, 0u)",
          "old_line_content": "  // Set current_ to point to the terminating chunk.",
          "new_line_content": "    DCHECK_EQ(current_.pos.chars, 0u);",
          "content_same": false
        },
        {
          "line": 652,
          "old_api": null,
          "new_api": "FetchChunk",
          "old_text": null,
          "new_text": "FetchChunk()",
          "old_line_content": "  if (chunks_[chunk_no].length == 0) {",
          "new_line_content": "    FetchChunk();",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": null,
          "new_api": "static_cast<size_t>(end_pos)",
          "old_text": null,
          "new_text": "static_cast<size_t>(end_pos)",
          "old_line_content": "}",
          "new_line_content": "        start_offset, static_cast<size_t>(end_pos));",
          "content_same": false
        },
        {
          "line": 777,
          "old_api": null,
          "new_api": "IsSeqOneByteString",
          "old_text": null,
          "new_text": "data->IsSeqOneByteString()",
          "old_line_content": "",
          "new_line_content": "  } else if (data->IsSeqOneByteString()) {",
          "content_same": false
        },
        {
          "line": 779,
          "old_api": null,
          "new_api": "Handle<SeqOneByteString>::cast(data)",
          "old_text": null,
          "new_text": "Handle<SeqOneByteString>::cast(data)",
          "old_line_content": "    const char* data) {",
          "new_line_content": "        static_cast<size_t>(start_pos), Handle<SeqOneByteString>::cast(data),",
          "content_same": false
        },
        {
          "line": 781,
          "old_api": null,
          "new_api": "IsSeqTwoByteString",
          "old_text": null,
          "new_text": "data->IsSeqTwoByteString()",
          "old_line_content": "}",
          "new_line_content": "  } else if (data->IsSeqTwoByteString()) {",
          "content_same": false
        },
        {
          "line": 657,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "chunks_.size()",
          "old_line_content": "  // Did we find the non-last chunk? Then our position must be within chunk_no.",
          "new_line_content": "  size_t chunk_no = chunks_.size() - 1;",
          "content_same": false
        },
        {
          "line": 783,
          "old_api": null,
          "new_api": "static_cast<size_t>(start_pos)",
          "old_text": null,
          "new_text": "static_cast<size_t>(start_pos)",
          "old_line_content": "std::unique_ptr<Utf16CharacterStream> ScannerStream::ForTesting(",
          "new_line_content": "        isolate, static_cast<size_t>(start_pos),",
          "content_same": false
        },
        {
          "line": 784,
          "old_api": null,
          "new_api": "Handle<SeqTwoByteString>::cast(data)",
          "old_text": null,
          "new_text": "Handle<SeqTwoByteString>::cast(data)",
          "old_line_content": "    const char* data, size_t length) {",
          "new_line_content": "        Handle<SeqTwoByteString>::cast(data), start_offset,",
          "content_same": false
        },
        {
          "line": 793,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(data)",
          "old_line_content": "    v8::ScriptCompiler::StreamedSource::Encoding encoding) {",
          "new_line_content": "  return ScannerStream::ForTesting(data, strlen(data));",
          "content_same": false
        },
        {
          "line": 798,
          "old_api": null,
          "new_api": "std::unique_ptr<Utf16CharacterStream>(\n      new BufferedCharacterStream<TestingStream>(\n          static_cast<size_t>(0), reinterpret_cast<const uint8_t*>(data),\n          static_cast<size_t>(length)))",
          "old_text": null,
          "new_text": "std::unique_ptr<Utf16CharacterStream>(\n      new BufferedCharacterStream<TestingStream>(\n          static_cast<size_t>(0), reinterpret_cast<const uint8_t*>(data),\n          static_cast<size_t>(length)))",
          "old_line_content": "    case v8::ScriptCompiler::StreamedSource::ONE_BYTE:",
          "new_line_content": "  return std::unique_ptr<Utf16CharacterStream>(",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "chunks_.size()",
          "old_line_content": "                  {chunks_[chunk_no].start.bytes + skip,",
          "new_line_content": "  if (chunk_no + 1 < chunks_.size()) {",
          "content_same": false
        },
        {
          "line": 800,
          "old_api": null,
          "new_api": "reinterpret_cast<const uint8_t*>(data)",
          "old_text": null,
          "new_text": "reinterpret_cast<const uint8_t*>(data)",
          "old_line_content": "                                                        source_stream);",
          "new_line_content": "          static_cast<size_t>(0), reinterpret_cast<const uint8_t*>(data),",
          "content_same": false
        },
        {
          "line": 801,
          "old_api": null,
          "new_api": "static_cast<size_t>(length)",
          "old_text": null,
          "new_text": "static_cast<size_t>(length)",
          "old_line_content": "    case v8::ScriptCompiler::StreamedSource::UTF8:",
          "new_line_content": "          static_cast<size_t>(length)));",
          "content_same": false
        },
        {
          "line": 810,
          "old_api": null,
          "new_api": "static_cast<size_t>(0)",
          "old_text": null,
          "new_text": "static_cast<size_t>(0)",
          "old_line_content": "",
          "new_line_content": "          static_cast<size_t>(0), source_stream);",
          "content_same": false
        },
        {
          "line": 812,
          "old_api": null,
          "new_api": "static_cast<size_t>(0)",
          "old_text": null,
          "new_text": "static_cast<size_t>(0)",
          "old_line_content": "",
          "new_line_content": "      return new BufferedCharacterStream<ChunkedStream>(static_cast<size_t>(0),",
          "content_same": false
        },
        {
          "line": 689,
          "old_api": null,
          "new_api": "SkipToPosition",
          "old_text": null,
          "new_text": "SkipToPosition(position)",
          "old_line_content": "  current_ = {chunk_no, chunks_[chunk_no].start};",
          "new_line_content": "      SkipToPosition(position);",
          "content_same": false
        },
        {
          "line": 817,
          "old_api": null,
          "new_api": "UNREACHABLE",
          "old_text": null,
          "new_text": "UNREACHABLE()",
          "old_line_content": "",
          "new_line_content": "  UNREACHABLE();",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": null,
          "new_api": "SkipToPosition",
          "old_text": null,
          "new_text": "SkipToPosition(position)",
          "old_line_content": "}",
          "new_line_content": "  bool found = SkipToPosition(position);",
          "content_same": false
        },
        {
          "line": 706,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "chunks_.size()",
          "old_line_content": "size_t Utf8ExternalStreamingStream::FillBuffer(size_t position) {",
          "new_line_content": "    DCHECK_EQ(current_.chunk_no, chunks_.size());",
          "content_same": false
        },
        {
          "line": 707,
          "old_api": null,
          "new_api": "FetchChunk",
          "old_text": null,
          "new_text": "FetchChunk()",
          "old_line_content": "  buffer_cursor_ = buffer_;",
          "new_line_content": "    have_more_data = FetchChunk();",
          "content_same": false
        },
        {
          "line": 708,
          "old_api": null,
          "new_api": "SkipToPosition",
          "old_text": null,
          "new_text": "SkipToPosition(position)",
          "old_line_content": "  buffer_end_ = buffer_;",
          "new_line_content": "    found = have_more_data && SkipToPosition(position);",
          "content_same": false
        },
        {
          "line": 713,
          "old_api": null,
          "new_api": "DCHECK_EQ",
          "old_text": null,
          "new_text": "DCHECK_EQ(found, current_.pos.chars == position)",
          "old_line_content": "                     current_.pos.incomplete_char == 0;",
          "new_line_content": "  DCHECK_EQ(found, current_.pos.chars == position);",
          "content_same": false
        },
        {
          "line": 714,
          "old_api": null,
          "new_api": "back",
          "old_text": null,
          "new_text": "chunks_.back()",
          "old_line_content": "",
          "new_line_content": "  DCHECK_EQ(have_more_data, chunks_.back().length != 0);",
          "content_same": false
        },
        {
          "line": 715,
          "old_api": null,
          "new_api": "DCHECK_IMPLIES",
          "old_text": null,
          "new_text": "DCHECK_IMPLIES(!found, !have_more_data)",
          "old_line_content": "  if (out_of_data) return 0;",
          "new_line_content": "  DCHECK_IMPLIES(!found, !have_more_data);",
          "content_same": false
        },
        {
          "line": 716,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "chunks_.size()",
          "old_line_content": "",
          "new_line_content": "  DCHECK_IMPLIES(!found, current_.chunk_no == chunks_.size() - 1);",
          "content_same": false
        },
        {
          "line": 724,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "chunks_.size()",
          "old_line_content": "    }",
          "new_line_content": "  bool out_of_data = current_.chunk_no != chunks_.size() &&",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": null,
          "new_api": "static_cast<uc16>(t)",
          "old_text": null,
          "new_text": "static_cast<uc16>(t)",
          "old_line_content": "    } else if (t == unibrow::Utf8::kIncomplete) {",
          "new_line_content": "      *(output_cursor++) = static_cast<uc16>(t);  // The most frequent case.",
          "content_same": false
        },
        {
          "line": 603,
          "old_api": null,
          "new_api": "unibrow::Utf16::TrailSurrogate(t)",
          "old_text": null,
          "new_text": "unibrow::Utf16::TrailSurrogate(t)",
          "old_line_content": "    }",
          "new_line_content": "      *(output_cursor++) = unibrow::Utf16::TrailSurrogate(t);",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "chunks_.size()",
          "old_line_content": "",
          "new_line_content": "    if (current_.chunk_no == chunks_.size()) {",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "Min",
          "old_text": null,
          "new_text": "Min(remaining, max_buffer)",
          "old_line_content": "  current_.pos.incomplete_char = incomplete_char;",
          "new_line_content": "    int max_length = static_cast<int>(Min(remaining, max_buffer));",
          "content_same": false
        },
        {
          "line": 609,
          "old_api": null,
          "new_api": "DCHECK_EQ",
          "old_text": null,
          "new_text": "DCHECK_EQ(state, unibrow::Utf8::State::kAccept)",
          "old_line_content": "  current_.pos.state = state;",
          "new_line_content": "    DCHECK_EQ(state, unibrow::Utf8::State::kAccept);",
          "content_same": false
        },
        {
          "line": 736,
          "old_api": null,
          "new_api": "FetchChunk",
          "old_text": null,
          "new_text": "FetchChunk()",
          "old_line_content": "Utf16CharacterStream* ScannerStream::For(Isolate* isolate,",
          "new_line_content": "      out_of_data = !FetchChunk();",
          "content_same": false
        },
        {
          "line": 613,
          "old_api": null,
          "new_api": "DCHECK_EQ",
          "old_text": null,
          "new_text": "DCHECK_EQ(unibrow::Utf8::kMaxOneByteChar, 0x7F)",
          "old_line_content": "}",
          "new_line_content": "      DCHECK_EQ(unibrow::Utf8::kMaxOneByteChar, 0x7F);",
          "content_same": false
        },
        {
          "line": 741,
          "old_api": null,
          "new_api": "DCHECK_EQ",
          "old_text": null,
          "new_text": "DCHECK_EQ(current_.pos.chars - position,\n            static_cast<size_t>(buffer_end_ - buffer_cursor_))",
          "old_line_content": "Utf16CharacterStream* ScannerStream::For(Isolate* isolate, Handle<String> data,",
          "new_line_content": "  DCHECK_EQ(current_.pos.chars - position,",
          "content_same": false
        },
        {
          "line": 742,
          "old_api": null,
          "new_api": "static_cast<size_t>(buffer_end_ - buffer_cursor_)",
          "old_text": null,
          "new_text": "static_cast<size_t>(buffer_end_ - buffer_cursor_)",
          "old_line_content": "                                         int start_pos, int end_pos) {",
          "new_line_content": "            static_cast<size_t>(buffer_end_ - buffer_cursor_));",
          "content_same": false
        },
        {
          "line": 757,
          "old_api": null,
          "new_api": "DCHECK_LE",
          "old_text": null,
          "new_text": "DCHECK_LE(start_pos, end_pos)",
          "old_line_content": "    return new BufferedCharacterStream<ExternalStringStream>(",
          "new_line_content": "  DCHECK_LE(start_pos, end_pos);",
          "content_same": false
        },
        {
          "line": 631,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "chunks_.size()",
          "old_line_content": "  // FillBuffer right after the current buffer.",
          "new_line_content": "  DCHECK_EQ(current_.chunk_no, chunks_.size());",
          "content_same": false
        },
        {
          "line": 632,
          "old_api": null,
          "new_api": "back",
          "old_text": null,
          "new_text": "chunks_.back()",
          "old_line_content": "  if (current_.pos.chars == position) return;",
          "new_line_content": "  DCHECK(chunks_.empty() || chunks_.back().length != 0);",
          "content_same": false
        },
        {
          "line": 761,
          "old_api": null,
          "new_api": "SlicedString::cast(*data)",
          "old_text": null,
          "new_text": "SlicedString::cast(*data)",
          "old_line_content": "    return new UnbufferedCharacterStream<ExternalStringStream>(",
          "new_line_content": "    SlicedString string = SlicedString::cast(*data);",
          "content_same": false
        },
        {
          "line": 765,
          "old_api": null,
          "new_api": "handle",
          "old_text": null,
          "new_text": "handle(parent, isolate)",
          "old_line_content": "    return new BufferedCharacterStream<OnHeapStream>(",
          "new_line_content": "    data = handle(parent, isolate);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 768,
          "old_api": "IsSeqTwoByteString",
          "new_api": null,
          "old_text": "data->IsSeqTwoByteString()",
          "new_text": null,
          "old_line_content": "  } else if (data->IsSeqTwoByteString()) {",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 770,
          "old_api": "static_cast<size_t>(start_pos)",
          "new_api": null,
          "old_text": "static_cast<size_t>(start_pos)",
          "new_text": null,
          "old_line_content": "        isolate, static_cast<size_t>(start_pos),",
          "new_line_content": "    return new BufferedCharacterStream<ExternalStringStream>(",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": "size",
          "new_api": null,
          "old_text": "chunks_.size()",
          "new_text": null,
          "old_line_content": "  size_t chunk_no = chunks_.size() - 1;",
          "new_line_content": "  // FillBuffer right after the current buffer.",
          "content_same": false
        },
        {
          "line": 774,
          "old_api": "UNREACHABLE",
          "new_api": null,
          "old_text": "UNREACHABLE()",
          "new_text": null,
          "old_line_content": "    UNREACHABLE();",
          "new_line_content": "    return new UnbufferedCharacterStream<ExternalStringStream>(",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": "Handle<SeqOneByteString>::cast(data)",
          "new_api": null,
          "old_text": "Handle<SeqOneByteString>::cast(data)",
          "new_text": null,
          "old_line_content": "        static_cast<size_t>(start_pos), Handle<SeqOneByteString>::cast(data),",
          "new_line_content": "  } else {",
          "content_same": false
        },
        {
          "line": 658,
          "old_api": "size",
          "new_api": null,
          "old_text": "chunks_.size()",
          "new_text": null,
          "old_line_content": "  if (chunk_no + 1 < chunks_.size()) {",
          "new_line_content": "  while (chunk_no > 0 && chunks_[chunk_no].start.chars > position) {",
          "content_same": false
        },
        {
          "line": 788,
          "old_api": "static_cast<size_t>(length)",
          "new_api": null,
          "old_text": "static_cast<size_t>(length)",
          "new_text": null,
          "old_line_content": "          static_cast<size_t>(length)));",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 797,
          "old_api": "static_cast<size_t>(0)",
          "new_api": null,
          "old_text": "static_cast<size_t>(0)",
          "new_text": null,
          "old_line_content": "          static_cast<size_t>(0), source_stream);",
          "new_line_content": "    const char* data, size_t length) {",
          "content_same": false
        },
        {
          "line": 799,
          "old_api": "static_cast<size_t>(0)",
          "new_api": null,
          "old_text": "static_cast<size_t>(0)",
          "new_text": null,
          "old_line_content": "      return new BufferedCharacterStream<ChunkedStream>(static_cast<size_t>(0),",
          "new_line_content": "      new BufferedCharacterStream<TestingStream>(",
          "content_same": false
        },
        {
          "line": 676,
          "old_api": "SkipToPosition",
          "new_api": null,
          "old_text": "SkipToPosition(position)",
          "new_text": null,
          "old_line_content": "      SkipToPosition(position);",
          "new_line_content": "    //  so avoid the expensive SkipToPosition.)",
          "content_same": false
        },
        {
          "line": 804,
          "old_api": "UNREACHABLE",
          "new_api": null,
          "old_text": "UNREACHABLE()",
          "new_text": null,
          "old_line_content": "  UNREACHABLE();",
          "new_line_content": "Utf16CharacterStream* ScannerStream::For(",
          "content_same": false
        },
        {
          "line": 681,
          "old_api": "DCHECK_EQ",
          "new_api": null,
          "old_text": "DCHECK_EQ(position, current_.pos.chars)",
          "new_text": null,
          "old_line_content": "    DCHECK_EQ(position, current_.pos.chars);",
          "new_line_content": "    if (ascii_only_chunk) {",
          "content_same": false
        },
        {
          "line": 688,
          "old_api": "size",
          "new_api": null,
          "old_text": "chunks_.size()",
          "new_text": null,
          "old_line_content": "  DCHECK_EQ(chunk_no, chunks_.size() - 1);",
          "new_line_content": "      current_ = {chunk_no, chunks_[chunk_no].start};",
          "content_same": false
        },
        {
          "line": 691,
          "old_api": "SkipToPosition",
          "new_api": null,
          "old_text": "SkipToPosition(position)",
          "new_text": null,
          "old_line_content": "  bool found = SkipToPosition(position);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 693,
          "old_api": "size",
          "new_api": null,
          "old_text": "chunks_.size()",
          "new_text": null,
          "old_line_content": "    DCHECK_EQ(current_.chunk_no, chunks_.size());",
          "new_line_content": "    // something.",
          "content_same": false
        },
        {
          "line": 695,
          "old_api": "SkipToPosition",
          "new_api": null,
          "old_text": "SkipToPosition(position)",
          "new_text": null,
          "old_line_content": "    found = have_more_data && SkipToPosition(position);",
          "new_line_content": "    return;",
          "content_same": false
        },
        {
          "line": 700,
          "old_api": "DCHECK_EQ",
          "new_api": null,
          "old_text": "DCHECK_EQ(found, current_.pos.chars == position)",
          "new_text": null,
          "old_line_content": "  DCHECK_EQ(found, current_.pos.chars == position);",
          "new_line_content": "  // have to obtain.",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": "DCHECK_IMPLIES",
          "new_api": null,
          "old_text": "DCHECK_IMPLIES(!found, !have_more_data)",
          "new_text": null,
          "old_line_content": "  DCHECK_IMPLIES(!found, !have_more_data);",
          "new_line_content": "  current_ = {chunk_no, chunks_[chunk_no].start};",
          "content_same": false
        },
        {
          "line": 703,
          "old_api": "size",
          "new_api": null,
          "old_text": "chunks_.size()",
          "new_text": null,
          "old_line_content": "  DCHECK_IMPLIES(!found, current_.chunk_no == chunks_.size() - 1);",
          "new_line_content": "  bool have_more_data = true;",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": "SearchPosition",
          "new_api": null,
          "old_text": "SearchPosition(position)",
          "new_text": null,
          "old_line_content": "  SearchPosition(position);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": "size",
          "new_api": null,
          "old_text": "chunks_.size()",
          "new_text": null,
          "old_line_content": "  bool out_of_data = current_.chunk_no != chunks_.size() &&",
          "new_line_content": "  // We'll return with a postion != the desired position only if we're out",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": "size",
          "new_api": null,
          "old_text": "chunks_.size()",
          "new_text": null,
          "old_line_content": "    if (current_.chunk_no == chunks_.size()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 595,
          "old_api": "unibrow::Utf8::ValueOfIncremental(&cursor, &state, &incomplete_char)",
          "new_api": null,
          "old_text": "unibrow::Utf8::ValueOfIncremental(&cursor, &state, &incomplete_char)",
          "new_text": null,
          "old_line_content": "        unibrow::Utf8::ValueOfIncremental(&cursor, &state, &incomplete_char);",
          "new_line_content": "    unibrow::uchar t =",
          "content_same": false
        },
        {
          "line": 725,
          "old_api": "FillBufferFromCurrentChunk",
          "new_api": null,
          "old_text": "FillBufferFromCurrentChunk()",
          "new_text": null,
          "old_line_content": "    FillBufferFromCurrentChunk();",
          "new_line_content": "                     chunks_[current_.chunk_no].length == 0 &&",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "DCHECK_EQ",
          "new_api": null,
          "old_text": "DCHECK_EQ(current_.pos.chars - position,\n            static_cast<size_t>(buffer_end_ - buffer_cursor_))",
          "new_text": null,
          "old_line_content": "  DCHECK_EQ(current_.pos.chars - position,",
          "new_line_content": "  if (out_of_data) return 0;",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": "unibrow::Utf16::LeadSurrogate(t)",
          "new_api": null,
          "old_text": "unibrow::Utf16::LeadSurrogate(t)",
          "new_text": null,
          "old_line_content": "      *(output_cursor++) = unibrow::Utf16::LeadSurrogate(t);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": "static_cast<size_t>(buffer_end_ - buffer_cursor_)",
          "new_api": null,
          "old_text": "static_cast<size_t>(buffer_end_ - buffer_cursor_)",
          "new_text": null,
          "old_line_content": "            static_cast<size_t>(buffer_end_ - buffer_cursor_));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 743,
          "old_api": "DCHECK_GE",
          "new_api": null,
          "old_text": "DCHECK_GE(start_pos, 0)",
          "new_text": null,
          "old_line_content": "  DCHECK_GE(start_pos, 0);",
          "new_line_content": "  return buffer_end_ - buffer_cursor_;",
          "content_same": false
        },
        {
          "line": 744,
          "old_api": "DCHECK_LE",
          "new_api": null,
          "old_text": "DCHECK_LE(start_pos, end_pos)",
          "new_text": null,
          "old_line_content": "  DCHECK_LE(start_pos, end_pos);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 745,
          "old_api": "length",
          "new_api": null,
          "old_text": "data->length()",
          "new_text": null,
          "old_line_content": "  DCHECK_LE(end_pos, data->length());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": "size",
          "new_api": null,
          "old_text": "chunks_.size()",
          "new_text": null,
          "old_line_content": "  DCHECK_EQ(current_.chunk_no, chunks_.size());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 619,
          "old_api": "back",
          "new_api": null,
          "old_text": "chunks_.back()",
          "new_text": null,
          "old_line_content": "  DCHECK(chunks_.empty() || chunks_.back().length != 0);",
          "new_line_content": "  current_.pos.bytes = chunk.start.bytes + (cursor - chunk.data);",
          "content_same": false
        },
        {
          "line": 747,
          "old_api": "IsSlicedString",
          "new_api": null,
          "old_text": "data->IsSlicedString()",
          "new_text": null,
          "old_line_content": "  if (data->IsSlicedString()) {",
          "new_line_content": "// ScannerStream: Create stream instances.",
          "content_same": false
        },
        {
          "line": 748,
          "old_api": "SlicedString::cast(*data)",
          "new_api": null,
          "old_text": "SlicedString::cast(*data)",
          "new_text": null,
          "old_line_content": "    SlicedString string = SlicedString::cast(*data);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 622,
          "old_api": "GetMoreData",
          "new_api": null,
          "old_text": "source_stream_->GetMoreData(&chunk)",
          "new_text": null,
          "old_line_content": "  size_t length = source_stream_->GetMoreData(&chunk);",
          "new_line_content": "  current_.pos.state = state;",
          "content_same": false
        },
        {
          "line": 623,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "chunks_.push_back({chunk, length, current_.pos})",
          "new_text": null,
          "old_line_content": "  chunks_.push_back({chunk, length, current_.pos});",
          "new_line_content": "  current_.chunk_no += (cursor == end);",
          "content_same": false
        },
        {
          "line": 749,
          "old_api": "offset",
          "new_api": null,
          "old_text": "string.offset()",
          "new_text": null,
          "old_line_content": "    start_offset = string.offset();",
          "new_line_content": "Utf16CharacterStream* ScannerStream::For(Isolate* isolate,",
          "content_same": false
        },
        {
          "line": 750,
          "old_api": "parent",
          "new_api": null,
          "old_text": "string.parent()",
          "new_text": null,
          "old_line_content": "    String parent = string.parent();",
          "new_line_content": "                                         Handle<String> data) {",
          "content_same": false
        },
        {
          "line": 752,
          "old_api": "handle",
          "new_api": null,
          "old_text": "handle(parent, isolate)",
          "new_text": null,
          "old_line_content": "    data = handle(parent, isolate);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 754,
          "old_api": "String::Flatten(isolate, data)",
          "new_api": null,
          "old_text": "String::Flatten(isolate, data)",
          "new_text": null,
          "old_line_content": "    data = String::Flatten(isolate, data);",
          "new_line_content": "Utf16CharacterStream* ScannerStream::For(Isolate* isolate, Handle<String> data,",
          "content_same": false
        },
        {
          "line": 759,
          "old_api": "static_cast<size_t>(end_pos)",
          "new_api": null,
          "old_text": "static_cast<size_t>(end_pos)",
          "new_text": null,
          "old_line_content": "        start_offset, static_cast<size_t>(end_pos));",
          "new_line_content": "  size_t start_offset = 0;",
          "content_same": false
        },
        {
          "line": 637,
          "old_api": "DCHECK_EQ",
          "new_api": null,
          "old_text": "DCHECK_EQ(current_.pos.bytes, 0u)",
          "new_text": null,
          "old_line_content": "    DCHECK_EQ(current_.pos.bytes, 0u);",
          "new_line_content": "  return length > 0;",
          "content_same": false
        },
        {
          "line": 638,
          "old_api": "DCHECK_EQ",
          "new_api": null,
          "old_text": "DCHECK_EQ(current_.pos.chars, 0u)",
          "new_text": null,
          "old_line_content": "    DCHECK_EQ(current_.pos.chars, 0u);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 639,
          "old_api": "FetchChunk",
          "new_api": null,
          "old_text": "FetchChunk()",
          "new_text": null,
          "old_line_content": "    FetchChunk();",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 21,
      "total_additions": 47,
      "total_deletions": 44,
      "total_api_changes": 112
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 14,
        "api_related_lines": 112,
        "non_api_lines": 11,
        "non_api_line_numbers": [
          610,
          611,
          612,
          614,
          615,
          616,
          593,
          594,
          605,
          606,
          607
        ]
      }
    },
    "api_calls_before": 179,
    "api_calls_after": 183,
    "diff_info": {
      "added_lines": 14,
      "removed_lines": 1,
      "total_diff_lines": 34
    }
  }
}