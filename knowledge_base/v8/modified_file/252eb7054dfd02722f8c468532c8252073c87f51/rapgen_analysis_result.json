{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/252eb7054dfd02722f8c468532c8252073c87f51",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/252eb7054dfd02722f8c468532c8252073c87f51/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/252eb7054dfd02722f8c468532c8252073c87f51/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/252eb7054dfd02722f8c468532c8252073c87f51/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 420,
          "old_api": "PrintF",
          "new_api": "PrintName",
          "old_text": "PrintF(\"[not yet optimizing \")",
          "new_text": "function->PrintName()",
          "old_line_content": "        PrintF(\"[not yet optimizing \");",
          "new_line_content": "        function->PrintName();",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": "PrintName",
          "new_api": "PrintF",
          "old_text": "function->PrintName()",
          "new_text": "PrintF(\", not enough type info: %d/%d (%d%%)]\\n\", typeinfo, total,\n               type_percentage)",
          "old_line_content": "        function->PrintName();",
          "new_line_content": "        PrintF(\", not enough type info: %d/%d (%d%%)]\\n\", typeinfo, total,",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": "done",
          "new_api": "frame",
          "old_text": "it.done()",
          "new_text": "it.frame()",
          "old_line_content": "       frame_count++ < frame_count_limit && !it.done();",
          "new_line_content": "    JavaScriptFrame* frame = it.frame();",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": "Advance",
          "new_api": "function",
          "old_text": "it.Advance()",
          "new_text": "frame->function()",
          "old_line_content": "       it.Advance()) {",
          "new_line_content": "    JSFunction* function = frame->function();",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": "shared",
          "new_api": "MaybeBaselineIgnition",
          "old_text": "function->shared()->IsInterpreted()",
          "new_text": "MaybeBaselineIgnition(function, frame)",
          "old_line_content": "    if (function->shared()->IsInterpreted()) {",
          "new_line_content": "        MaybeBaselineIgnition(function, frame);",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": "MaybeBaselineIgnition",
          "new_api": "DCHECK_EQ",
          "old_text": "MaybeBaselineIgnition(function, frame)",
          "new_text": "DCHECK_EQ(next_tier, Compiler::OPTIMIZED)",
          "old_line_content": "        MaybeBaselineIgnition(function, frame);",
          "new_line_content": "        DCHECK_EQ(next_tier, Compiler::OPTIMIZED);",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": "length",
          "new_api": "profiler_ticks",
          "old_text": "functions.length()",
          "new_text": "shared_function_info->profiler_ticks()",
          "old_line_content": "    for (int i = functions.length(); --i >= 0;) {",
          "new_line_content": "      int ticks = shared_function_info->profiler_ticks();",
          "content_same": false
        },
        {
          "line": 481,
          "old_api": "profiler_ticks",
          "new_api": "set_profiler_ticks",
          "old_text": "shared_function_info->profiler_ticks()",
          "new_text": "shared_function_info->set_profiler_ticks(ticks + 1)",
          "old_line_content": "      int ticks = shared_function_info->profiler_ticks();",
          "new_line_content": "        shared_function_info->set_profiler_ticks(ticks + 1);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 419,
          "old_api": null,
          "new_api": "PrintF",
          "old_text": null,
          "new_text": "PrintF(\"[not yet optimizing \")",
          "old_line_content": "      if (FLAG_trace_opt_verbose) {",
          "new_line_content": "        PrintF(\"[not yet optimizing \");",
          "content_same": false
        },
        {
          "line": 453,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "it.done()",
          "old_line_content": "  int frame_count_limit = FLAG_frame_count;",
          "new_line_content": "       frame_count++ < frame_count_limit && !it.done();",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": null,
          "new_api": "Advance",
          "old_text": null,
          "new_text": "it.Advance()",
          "old_line_content": "  for (JavaScriptFrameIterator it(isolate_);",
          "new_line_content": "       it.Advance()) {",
          "content_same": false
        },
        {
          "line": 427,
          "old_api": null,
          "new_api": "bytecode_array",
          "old_text": null,
          "new_text": "shared->bytecode_array()->Size()",
          "old_line_content": "  } else if (!any_ic_changed_ &&",
          "new_line_content": "             shared->bytecode_array()->Size() < kMaxSizeEarlyOptIgnition) {",
          "content_same": false
        },
        {
          "line": 459,
          "old_api": null,
          "new_api": "Compiler::NextCompilationTier(function)",
          "old_text": null,
          "new_text": "Compiler::NextCompilationTier(function)",
          "old_line_content": "",
          "new_line_content": "        Compiler::NextCompilationTier(function);",
          "content_same": false
        },
        {
          "line": 460,
          "old_api": null,
          "new_api": "shared",
          "old_text": null,
          "new_text": "function->shared()->IsInterpreted()",
          "old_line_content": "    Compiler::CompilationTier next_tier =",
          "new_line_content": "    if (function->shared()->IsInterpreted()) {",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": null,
          "new_api": "GetICCounts",
          "old_text": null,
          "new_text": "GetICCounts(function, &typeinfo, &generic, &total, &type_percentage,\n                &generic_percentage)",
          "old_line_content": "    int typeinfo, generic, total, type_percentage, generic_percentage;",
          "new_line_content": "    GetICCounts(function, &typeinfo, &generic, &total, &type_percentage,",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": null,
          "new_api": "MaybeOptimizeIgnition",
          "old_text": null,
          "new_text": "MaybeOptimizeIgnition(function, frame)",
          "old_line_content": "      } else {",
          "new_line_content": "        MaybeOptimizeIgnition(function, frame);",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": null,
          "new_api": "DCHECK_EQ",
          "old_text": null,
          "new_text": "DCHECK_EQ(next_tier, Compiler::OPTIMIZED)",
          "old_line_content": "      }",
          "new_line_content": "      DCHECK_EQ(next_tier, Compiler::OPTIMIZED);",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": null,
          "new_api": "MaybeOptimizeFullCodegen",
          "old_text": null,
          "new_text": "MaybeOptimizeFullCodegen(function, frame, frame_count)",
          "old_line_content": "    } else {",
          "new_line_content": "      MaybeOptimizeFullCodegen(function, frame, frame_count);",
          "content_same": false
        },
        {
          "line": 443,
          "old_api": null,
          "new_api": "use_crankshaft",
          "old_text": null,
          "new_text": "isolate_->use_crankshaft()",
          "old_line_content": "  HandleScope scope(isolate_);",
          "new_line_content": "  if (!isolate_->use_crankshaft()) return;",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": null,
          "new_api": "GetFunctions",
          "old_text": null,
          "new_text": "frame->GetFunctions(&functions)",
          "old_line_content": "    // Ignition (which updates ticks on shared function info) in sync.",
          "new_line_content": "    frame->GetFunctions(&functions);",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "functions.length()",
          "old_line_content": "    List<SharedFunctionInfo*> functions(4);",
          "new_line_content": "    for (int i = functions.length(); --i >= 0;) {",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 483,
          "old_api": "set_profiler_ticks",
          "new_api": null,
          "old_text": "shared_function_info->set_profiler_ticks(ticks + 1)",
          "new_text": null,
          "old_line_content": "        shared_function_info->set_profiler_ticks(ticks + 1);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 422,
          "old_api": "PrintF",
          "new_api": null,
          "old_text": "PrintF(\", not enough type info: %d/%d (%d%%)]\\n\", typeinfo, total,\n               type_percentage)",
          "new_text": null,
          "old_line_content": "        PrintF(\", not enough type info: %d/%d (%d%%)]\\n\", typeinfo, total,",
          "new_line_content": "               type_percentage);",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": "frame",
          "new_api": null,
          "old_text": "it.frame()",
          "new_text": null,
          "old_line_content": "    JavaScriptFrame* frame = it.frame();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": "function",
          "new_api": null,
          "old_text": "frame->function()",
          "new_text": null,
          "old_line_content": "    JSFunction* function = frame->function();",
          "new_line_content": "    Compiler::CompilationTier next_tier =",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": "bytecode_array",
          "new_api": null,
          "old_text": "shared->bytecode_array()->Size()",
          "new_text": null,
          "old_line_content": "             shared->bytecode_array()->Size() < kMaxSizeEarlyOptIgnition) {",
          "new_line_content": "    // If no IC was patched since the last tick and this function is very",
          "content_same": false
        },
        {
          "line": 461,
          "old_api": "Compiler::NextCompilationTier(function)",
          "new_api": null,
          "old_text": "Compiler::NextCompilationTier(function)",
          "new_text": null,
          "old_line_content": "        Compiler::NextCompilationTier(function);",
          "new_line_content": "      if (next_tier == Compiler::BASELINE) {",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": "GetICCounts",
          "new_api": null,
          "old_text": "GetICCounts(function, &typeinfo, &generic, &total, &type_percentage,\n                &generic_percentage)",
          "new_text": null,
          "old_line_content": "    GetICCounts(function, &typeinfo, &generic, &total, &type_percentage,",
          "new_line_content": "                &generic_percentage);",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": "DCHECK_EQ",
          "new_api": null,
          "old_text": "DCHECK_EQ(next_tier, Compiler::OPTIMIZED)",
          "new_text": null,
          "old_line_content": "        DCHECK_EQ(next_tier, Compiler::OPTIMIZED);",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 467,
          "old_api": "MaybeOptimizeIgnition",
          "new_api": null,
          "old_text": "MaybeOptimizeIgnition(function, frame)",
          "new_text": null,
          "old_line_content": "        MaybeOptimizeIgnition(function, frame);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": "DCHECK_EQ",
          "new_api": null,
          "old_text": "DCHECK_EQ(next_tier, Compiler::OPTIMIZED)",
          "new_text": null,
          "old_line_content": "      DCHECK_EQ(next_tier, Compiler::OPTIMIZED);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": "MaybeOptimizeFullCodegen",
          "new_api": null,
          "old_text": "MaybeOptimizeFullCodegen(function, frame, frame_count)",
          "new_text": null,
          "old_line_content": "      MaybeOptimizeFullCodegen(function, frame, frame_count);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": "use_crankshaft",
          "new_api": null,
          "old_text": "isolate_->use_crankshaft()",
          "new_text": null,
          "old_line_content": "  if (!isolate_->use_crankshaft()) return;",
          "new_line_content": "  DisallowHeapAllocation no_gc;",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": "GetFunctions",
          "new_api": null,
          "old_text": "frame->GetFunctions(&functions)",
          "new_text": null,
          "old_line_content": "    frame->GetFunctions(&functions);",
          "new_line_content": "      SharedFunctionInfo* shared_function_info = functions[i];",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 8,
      "total_additions": 13,
      "total_deletions": 13,
      "total_api_changes": 34
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 34,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          433,
          434,
          435,
          411,
          412
        ]
      }
    },
    "api_calls_before": 165,
    "api_calls_after": 165,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 4,
      "total_diff_lines": 25
    }
  }
}