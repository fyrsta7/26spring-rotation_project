{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/75e5a5a1a61cbe334439ce919cda37ae422d571c",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/75e5a5a1a61cbe334439ce919cda37ae422d571c/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/75e5a5a1a61cbe334439ce919cda37ae422d571c/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/75e5a5a1a61cbe334439ce919cda37ae422d571c/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 643,
          "old_api": "GetThreadContext",
          "new_api": "memset",
          "old_text": "GetThreadContext(profiled_thread, &context)",
          "new_text": "memset(&context, 0, sizeof(context))",
          "old_line_content": "  if (GetThreadContext(profiled_thread, &context) != 0) {",
          "new_line_content": "  memset(&context, 0, sizeof(context));",
          "content_same": false
        },
        {
          "line": 651,
          "old_api": "reinterpret_cast<Address>(context.Rbp)",
          "new_api": "reinterpret_cast<Address>(context.Rip)",
          "old_text": "reinterpret_cast<Address>(context.Rbp)",
          "new_text": "reinterpret_cast<Address>(context.Rip)",
          "old_line_content": "    state.fp = reinterpret_cast<Address>(context.Rbp);",
          "new_line_content": "    state.pc = reinterpret_cast<Address>(context.Rip);",
          "content_same": false
        },
        {
          "line": 653,
          "old_api": "reinterpret_cast<Address>(context.Eip)",
          "new_api": "reinterpret_cast<Address>(context.Rbp)",
          "old_text": "reinterpret_cast<Address>(context.Eip)",
          "new_text": "reinterpret_cast<Address>(context.Rbp)",
          "old_line_content": "    state.pc = reinterpret_cast<Address>(context.Eip);",
          "new_line_content": "    state.fp = reinterpret_cast<Address>(context.Rbp);",
          "content_same": false
        },
        {
          "line": 655,
          "old_api": "reinterpret_cast<Address>(context.Ebp)",
          "new_api": "reinterpret_cast<Address>(context.Eip)",
          "old_text": "reinterpret_cast<Address>(context.Ebp)",
          "new_text": "reinterpret_cast<Address>(context.Eip)",
          "old_line_content": "    state.fp = reinterpret_cast<Address>(context.Ebp);",
          "new_line_content": "    state.pc = reinterpret_cast<Address>(context.Eip);",
          "content_same": false
        },
        {
          "line": 660,
          "old_api": "ResumeThread",
          "new_api": "SampleStack",
          "old_text": "ResumeThread(profiled_thread)",
          "new_text": "SampleStack(state)",
          "old_line_content": "  ResumeThread(profiled_thread);",
          "new_line_content": "    SampleStack(state);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 645,
          "old_api": null,
          "new_api": "GetThreadContext",
          "old_text": null,
          "new_text": "GetThreadContext(profiled_thread, &context)",
          "old_line_content": "#if defined(USE_SIMULATOR)",
          "new_line_content": "  if (GetThreadContext(profiled_thread, &context) != 0) {",
          "content_same": false
        },
        {
          "line": 648,
          "old_api": null,
          "new_api": "FillRegisters",
          "old_text": null,
          "new_text": "helper.FillRegisters(&state)",
          "old_line_content": "#if V8_HOST_ARCH_X64",
          "new_line_content": "    helper.FillRegisters(&state);",
          "content_same": false
        },
        {
          "line": 652,
          "old_api": null,
          "new_api": "reinterpret_cast<Address>(context.Rsp)",
          "old_text": null,
          "new_text": "reinterpret_cast<Address>(context.Rsp)",
          "old_line_content": "#else",
          "new_line_content": "    state.sp = reinterpret_cast<Address>(context.Rsp);",
          "content_same": false
        },
        {
          "line": 623,
          "old_api": null,
          "new_api": "SignalHandler::Installed()",
          "old_text": null,
          "new_text": "SignalHandler::Installed()",
          "old_line_content": "}",
          "new_line_content": "  if (!SignalHandler::Installed()) return;",
          "content_same": false
        },
        {
          "line": 624,
          "old_api": null,
          "new_api": "vm_tid",
          "old_text": null,
          "new_text": "platform_data()->vm_tid()",
          "old_line_content": "",
          "new_line_content": "  pthread_kill(platform_data()->vm_tid(), SIGPROF);",
          "content_same": false
        },
        {
          "line": 656,
          "old_api": null,
          "new_api": "reinterpret_cast<Address>(context.Esp)",
          "old_text": null,
          "new_text": "reinterpret_cast<Address>(context.Esp)",
          "old_line_content": "#endif",
          "new_line_content": "    state.sp = reinterpret_cast<Address>(context.Esp);",
          "content_same": false
        },
        {
          "line": 657,
          "old_api": null,
          "new_api": "reinterpret_cast<Address>(context.Ebp)",
          "old_text": null,
          "new_text": "reinterpret_cast<Address>(context.Ebp)",
          "old_line_content": "#endif  // USE_SIMULATOR",
          "new_line_content": "    state.fp = reinterpret_cast<Address>(context.Ebp);",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": null,
          "new_api": "profiled_thread",
          "old_text": null,
          "new_text": "platform_data()->profiled_thread()",
          "old_line_content": "",
          "new_line_content": "  HANDLE profiled_thread = platform_data()->profiled_thread();",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": null,
          "new_api": "ResumeThread",
          "old_text": null,
          "new_text": "ResumeThread(profiled_thread)",
          "old_line_content": "",
          "new_line_content": "  ResumeThread(profiled_thread);",
          "content_same": false
        },
        {
          "line": 635,
          "old_api": null,
          "new_api": "isolate",
          "old_text": null,
          "new_text": "isolate()",
          "old_line_content": "",
          "new_line_content": "  if (!helper.Init(this, isolate())) return;",
          "content_same": false
        },
        {
          "line": 638,
          "old_api": null,
          "new_api": "static_cast<DWORD>(-1)",
          "old_text": null,
          "new_text": "static_cast<DWORD>(-1)",
          "old_line_content": "",
          "new_line_content": "  const DWORD kSuspendFailed = static_cast<DWORD>(-1);",
          "content_same": false
        },
        {
          "line": 639,
          "old_api": null,
          "new_api": "SuspendThread",
          "old_text": null,
          "new_text": "SuspendThread(profiled_thread)",
          "old_line_content": "  // Context used for sampling the register state of the profiled thread.",
          "new_line_content": "  if (SuspendThread(profiled_thread) == kSuspendFailed) return;",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 641,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(&context, 0, sizeof(context))",
          "new_text": null,
          "old_line_content": "  memset(&context, 0, sizeof(context));",
          "new_line_content": "  // Context used for sampling the register state of the profiled thread.",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": "FillRegisters",
          "new_api": null,
          "old_text": "helper.FillRegisters(&state)",
          "new_text": null,
          "old_line_content": "    helper.FillRegisters(&state);",
          "new_line_content": "    RegisterState state;",
          "content_same": false
        },
        {
          "line": 649,
          "old_api": "reinterpret_cast<Address>(context.Rip)",
          "new_api": null,
          "old_text": "reinterpret_cast<Address>(context.Rip)",
          "new_text": null,
          "old_line_content": "    state.pc = reinterpret_cast<Address>(context.Rip);",
          "new_line_content": "#else",
          "content_same": false
        },
        {
          "line": 650,
          "old_api": "reinterpret_cast<Address>(context.Rsp)",
          "new_api": null,
          "old_text": "reinterpret_cast<Address>(context.Rsp)",
          "new_text": null,
          "old_line_content": "    state.sp = reinterpret_cast<Address>(context.Rsp);",
          "new_line_content": "#if V8_HOST_ARCH_X64",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": "SignalHandler::Installed()",
          "new_api": null,
          "old_text": "SignalHandler::Installed()",
          "new_text": null,
          "old_line_content": "  if (!SignalHandler::Installed()) return;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 622,
          "old_api": "vm_tid",
          "new_api": null,
          "old_text": "platform_data()->vm_tid()",
          "new_text": null,
          "old_line_content": "  pthread_kill(platform_data()->vm_tid(), SIGPROF);",
          "new_line_content": "void Sampler::DoSample() {",
          "content_same": false
        },
        {
          "line": 654,
          "old_api": "reinterpret_cast<Address>(context.Esp)",
          "new_api": null,
          "old_text": "reinterpret_cast<Address>(context.Esp)",
          "new_text": null,
          "old_line_content": "    state.sp = reinterpret_cast<Address>(context.Esp);",
          "new_line_content": "#else",
          "content_same": false
        },
        {
          "line": 658,
          "old_api": "SampleStack",
          "new_api": null,
          "old_text": "SampleStack(state)",
          "new_text": null,
          "old_line_content": "    SampleStack(state);",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 628,
          "old_api": "profiled_thread",
          "new_api": null,
          "old_text": "platform_data()->profiled_thread()",
          "new_text": null,
          "old_line_content": "  HANDLE profiled_thread = platform_data()->profiled_thread();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 633,
          "old_api": "isolate",
          "new_api": null,
          "old_text": "isolate()",
          "new_text": null,
          "old_line_content": "  if (!helper.Init(this, isolate())) return;",
          "new_line_content": "#if defined(USE_SIMULATOR)",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": "static_cast<DWORD>(-1)",
          "new_api": null,
          "old_text": "static_cast<DWORD>(-1)",
          "new_text": null,
          "old_line_content": "  const DWORD kSuspendFailed = static_cast<DWORD>(-1);",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 637,
          "old_api": "SuspendThread",
          "new_api": null,
          "old_text": "SuspendThread(profiled_thread)",
          "new_text": null,
          "old_line_content": "  if (SuspendThread(profiled_thread) == kSuspendFailed) return;",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 5,
      "total_additions": 12,
      "total_deletions": 12,
      "total_api_changes": 29
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 29,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          612,
          613
        ]
      }
    },
    "api_calls_before": 167,
    "api_calls_after": 167,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 0,
      "total_diff_lines": 14
    }
  }
}