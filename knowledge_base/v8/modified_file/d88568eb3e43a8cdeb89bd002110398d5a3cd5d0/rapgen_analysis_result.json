{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/d88568eb3e43a8cdeb89bd002110398d5a3cd5d0",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/d88568eb3e43a8cdeb89bd002110398d5a3cd5d0/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/d88568eb3e43a8cdeb89bd002110398d5a3cd5d0/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/d88568eb3e43a8cdeb89bd002110398d5a3cd5d0/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 3275,
          "old_api": "Signal",
          "new_api": "contains_any",
          "old_text": "compilation_event_semaphore->Signal()",
          "new_text": "finished_events_.contains_any(events)",
          "old_line_content": "          compilation_event_semaphore->Signal();",
          "new_line_content": "    if (finished_events_.contains_any(events)) return;",
          "content_same": false
        },
        {
          "line": 3282,
          "old_api": "Wait",
          "new_api": "constexpr",
          "old_text": "compilation_event_semaphore->Wait()",
          "new_text": "constexpr",
          "old_line_content": "  compilation_event_semaphore->Wait();",
          "new_line_content": "  constexpr JobDelegate* kNoDelegate = nullptr;",
          "content_same": false
        },
        {
          "line": 3304,
          "old_api": "pop",
          "new_api": "size",
          "old_text": "queue_->pop()",
          "new_text": "queue->size()",
          "old_line_content": "    while (base::Optional<JSToWasmWrapperKey> key = queue_->pop()) {",
          "new_line_content": "        outstanding_units_(queue->size()) {}",
          "content_same": false
        },
        {
          "line": 3307,
          "old_api": "fetch_sub",
          "new_api": "pop",
          "old_text": "outstanding_units_.fetch_sub(1, std::memory_order_relaxed)",
          "new_text": "queue_->pop()",
          "old_line_content": "      outstanding_units_.fetch_sub(1, std::memory_order_relaxed);",
          "new_line_content": "    while (base::Optional<JSToWasmWrapperKey> key = queue_->pop()) {",
          "content_same": false
        },
        {
          "line": 3308,
          "old_api": "ShouldYield",
          "new_api": "get",
          "old_text": "delegate->ShouldYield()",
          "new_text": "*compilation_units_)[*key].get()",
          "old_line_content": "      if (delegate->ShouldYield()) return;",
          "new_line_content": "      JSToWasmWrapperCompilationUnit* unit = (*compilation_units_)[*key].get();",
          "content_same": false
        },
        {
          "line": 3346,
          "old_api": "std::move(unit)",
          "new_api": "wasm_engine",
          "old_text": "std::move(unit)",
          "new_text": "std::make_unique<JSToWasmWrapperCompilationUnit>(\n          isolate, isolate->wasm_engine(), function.sig, module,\n          function.imported, enabled_features)",
          "old_line_content": "      compilation_units.emplace(key, std::move(unit));",
          "new_line_content": "      auto unit = std::make_unique<JSToWasmWrapperCompilationUnit>(",
          "content_same": false
        },
        {
          "line": 3356,
          "old_api": "PostJob",
          "new_api": "static_cast<size_t>(flag_value)",
          "old_text": "V8::GetCurrentPlatform()->PostJob(\n      TaskPriority::kUserVisible, std::move(job))",
          "new_text": "static_cast<size_t>(flag_value)",
          "old_line_content": "  auto job_handle = V8::GetCurrentPlatform()->PostJob(",
          "new_line_content": "                                          : static_cast<size_t>(flag_value);",
          "content_same": false
        },
        {
          "line": 3357,
          "old_api": "std::move(job)",
          "new_api": "std::make_unique<CompileJSToWasmWrapperJob>(\n      &queue, &compilation_units, max_concurrency)",
          "old_text": "std::move(job)",
          "new_text": "std::make_unique<CompileJSToWasmWrapperJob>(\n      &queue, &compilation_units, max_concurrency)",
          "old_line_content": "      TaskPriority::kUserVisible, std::move(job));",
          "new_line_content": "  auto job = std::make_unique<CompileJSToWasmWrapperJob>(",
          "content_same": false
        },
        {
          "line": 3360,
          "old_api": "Join",
          "new_api": "std::move(job)",
          "old_text": "job_handle->Join()",
          "new_text": "std::move(job)",
          "old_line_content": "  job_handle->Join();",
          "new_line_content": "      TaskPriority::kUserVisible, std::move(job));",
          "content_same": false
        },
        {
          "line": 3369,
          "old_api": "get",
          "new_api": "heap",
          "old_text": "pair.second.get()",
          "new_text": "isolate->heap()",
          "old_line_content": "    JSToWasmWrapperCompilationUnit* unit = pair.second.get();",
          "new_line_content": "  CodeSpaceMemoryModificationScope modification_scope(isolate->heap());",
          "content_same": false
        },
        {
          "line": 3372,
          "old_api": "set",
          "new_api": "get",
          "old_text": "*export_wrappers_out)->set(wrapper_index, *code)",
          "new_text": "pair.second.get()",
          "old_line_content": "    (*export_wrappers_out)->set(wrapper_index, *code);",
          "new_line_content": "    JSToWasmWrapperCompilationUnit* unit = pair.second.get();",
          "content_same": false
        },
        {
          "line": 3373,
          "old_api": "counters",
          "new_api": "Finalize",
          "old_text": "isolate->counters()",
          "new_text": "unit->Finalize(isolate)",
          "old_line_content": "    RecordStats(*code, isolate->counters());",
          "new_line_content": "    Handle<Code> code = unit->Finalize(isolate);",
          "content_same": false
        },
        {
          "line": 3390,
          "old_api": "CreateCompilationEnv",
          "new_api": "module",
          "old_text": "native_module->CreateCompilationEnv()",
          "new_text": "native_module->module()",
          "old_line_content": "  CompilationEnv env = native_module->CreateCompilationEnv();",
          "new_line_content": "  bool source_positions = is_asmjs_module(native_module->module());",
          "content_same": false
        },
        {
          "line": 3393,
          "old_api": "as_vector",
          "new_api": "CreateCompilationEnv",
          "old_text": "native_module->AddCode(\n      result.func_index, result.code_desc, result.frame_slot_count,\n      result.tagged_parameter_slots,\n      result.protected_instructions_data.as_vector(),\n      result.source_positions.as_vector(), GetCodeKind(result),\n      ExecutionTier::kNone, kNoDebugging)",
          "new_text": "native_module->CreateCompilationEnv()",
          "old_line_content": "  std::unique_ptr<WasmCode> wasm_code = native_module->AddCode(",
          "new_line_content": "  CompilationEnv env = native_module->CreateCompilationEnv();",
          "content_same": false
        },
        {
          "line": 3399,
          "old_api": "std::move(wasm_code)",
          "new_api": "as_vector",
          "old_text": "std::move(wasm_code)",
          "new_text": "result.protected_instructions_data.as_vector()",
          "old_line_content": "  WasmCode* published_code = native_module->PublishCode(std::move(wasm_code));",
          "new_line_content": "      result.protected_instructions_data.as_vector(),",
          "content_same": false
        },
        {
          "line": 3402,
          "old_api": "length",
          "new_api": "std::move(wasm_code)",
          "old_text": "counters->wasm_generated_code_size()->Increment(\n      published_code->instructions().length())",
          "new_text": "std::move(wasm_code)",
          "old_line_content": "  counters->wasm_generated_code_size()->Increment(",
          "new_line_content": "  WasmCode* published_code = native_module->PublishCode(std::move(wasm_code));",
          "content_same": false
        },
        {
          "line": 3404,
          "old_api": "length",
          "new_api": "IncRef",
          "old_text": "published_code->reloc_info().length()",
          "new_text": "published_code->IncRef()",
          "old_line_content": "  counters->wasm_reloc_size()->Increment(published_code->reloc_info().length());",
          "new_line_content": "  published_code->IncRef();",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 3333,
          "old_api": null,
          "new_api": "factory",
          "old_text": null,
          "new_text": "isolate->factory()->NewFixedArray(\n      MaxNumExportWrappers(module), AllocationType::kOld)",
          "old_line_content": "  JSToWasmWrapperQueue queue;",
          "new_line_content": "  *export_wrappers_out = isolate->factory()->NewFixedArray(",
          "content_same": false
        },
        {
          "line": 3334,
          "old_api": null,
          "new_api": "MaxNumExportWrappers",
          "old_text": null,
          "new_text": "MaxNumExportWrappers(module)",
          "old_line_content": "  JSToWasmWrapperUnitMap compilation_units;",
          "new_line_content": "      MaxNumExportWrappers(module), AllocationType::kOld);",
          "content_same": false
        },
        {
          "line": 3338,
          "old_api": null,
          "new_api": "WasmFeatures::FromIsolate(isolate)",
          "old_text": null,
          "new_text": "WasmFeatures::FromIsolate(isolate)",
          "old_line_content": "  for (auto exp : module->export_table) {",
          "new_line_content": "  WasmFeatures enabled_features = WasmFeatures::FromIsolate(isolate);",
          "content_same": false
        },
        {
          "line": 3345,
          "old_api": null,
          "new_api": "insert",
          "old_text": null,
          "new_text": "queue.insert(key)",
          "old_line_content": "          function.imported, enabled_features);",
          "new_line_content": "    if (queue.insert(key)) {",
          "content_same": false
        },
        {
          "line": 3347,
          "old_api": null,
          "new_api": "wasm_engine",
          "old_text": null,
          "new_text": "isolate->wasm_engine()",
          "old_line_content": "    }",
          "new_line_content": "          isolate, isolate->wasm_engine(), function.sig, module,",
          "content_same": false
        },
        {
          "line": 3349,
          "old_api": null,
          "new_api": "std::move(unit)",
          "old_text": null,
          "new_text": "std::move(unit)",
          "old_line_content": "",
          "new_line_content": "      compilation_units.emplace(key, std::move(unit));",
          "content_same": false
        },
        {
          "line": 3355,
          "old_api": null,
          "new_api": "std::numeric_limits<size_t>::max()",
          "old_text": null,
          "new_text": "std::numeric_limits<size_t>::max()",
          "old_line_content": "      &queue, &compilation_units, max_concurrency);",
          "new_line_content": "  size_t max_concurrency = flag_value < 1 ? std::numeric_limits<size_t>::max()",
          "content_same": false
        },
        {
          "line": 3359,
          "old_api": null,
          "new_api": "PostJob",
          "old_text": null,
          "new_text": "V8::GetCurrentPlatform()->PostJob(\n      TaskPriority::kUserVisible, std::move(job))",
          "old_line_content": "  // Wait for completion, while contributing to the work.",
          "new_line_content": "  auto job_handle = V8::GetCurrentPlatform()->PostJob(",
          "content_same": false
        },
        {
          "line": 3363,
          "old_api": null,
          "new_api": "Join",
          "old_text": null,
          "new_text": "job_handle->Join()",
          "old_line_content": "  // TODO(6792): Wrappers below are allocated with {Factory::NewCode}. As an",
          "new_line_content": "  job_handle->Join();",
          "content_same": false
        },
        {
          "line": 3374,
          "old_api": null,
          "new_api": "GetExportWrapperIndex",
          "old_text": null,
          "new_text": "GetExportWrapperIndex(module, &key.second, key.first)",
          "old_line_content": "  }",
          "new_line_content": "    int wrapper_index = GetExportWrapperIndex(module, &key.second, key.first);",
          "content_same": false
        },
        {
          "line": 3375,
          "old_api": null,
          "new_api": "set",
          "old_text": null,
          "new_text": "*export_wrappers_out)->set(wrapper_index, *code)",
          "old_line_content": "}",
          "new_line_content": "    (*export_wrappers_out)->set(wrapper_index, *code);",
          "content_same": false
        },
        {
          "line": 3376,
          "old_api": null,
          "new_api": "counters",
          "old_text": null,
          "new_text": "isolate->counters()",
          "old_line_content": "",
          "new_line_content": "    RecordStats(*code, isolate->counters());",
          "content_same": false
        },
        {
          "line": 3389,
          "old_api": null,
          "new_api": "DCHECK_NULL",
          "old_text": null,
          "new_text": "DCHECK_NULL((*cache_scope)[key])",
          "old_line_content": "  WasmCodeRefScope code_ref_scope;",
          "new_line_content": "  DCHECK_NULL((*cache_scope)[key]);",
          "content_same": false
        },
        {
          "line": 3394,
          "old_api": null,
          "new_api": "compiler::CompileWasmImportCallWrapper(\n      wasm_engine, &env, kind, sig, source_positions, expected_arity)",
          "old_text": null,
          "new_text": "compiler::CompileWasmImportCallWrapper(\n      wasm_engine, &env, kind, sig, source_positions, expected_arity)",
          "old_line_content": "      result.func_index, result.code_desc, result.frame_slot_count,",
          "new_line_content": "  WasmCompilationResult result = compiler::CompileWasmImportCallWrapper(",
          "content_same": false
        },
        {
          "line": 3400,
          "old_api": null,
          "new_api": "GetCodeKind",
          "old_text": null,
          "new_text": "GetCodeKind(result)",
          "old_line_content": "  (*cache_scope)[key] = published_code;",
          "new_line_content": "      result.source_positions.as_vector(), GetCodeKind(result),",
          "content_same": false
        },
        {
          "line": 3276,
          "old_api": null,
          "new_api": "emplace_back",
          "old_text": null,
          "new_text": "callbacks_.emplace_back(\n        [compilation_event_semaphore, events](CompilationEvent event) {\n          if (events.contains(event)) compilation_event_semaphore->Signal();\n        })",
          "old_line_content": "        }",
          "new_line_content": "    callbacks_.emplace_back(",
          "content_same": false
        },
        {
          "line": 3405,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "counters->wasm_generated_code_size()->Increment(\n      published_code->instructions().length())",
          "old_line_content": "  return published_code;",
          "new_line_content": "  counters->wasm_generated_code_size()->Increment(",
          "content_same": false
        },
        {
          "line": 3278,
          "old_api": null,
          "new_api": "Signal",
          "old_text": null,
          "new_text": "compilation_event_semaphore->Signal()",
          "old_line_content": "",
          "new_line_content": "          if (events.contains(event)) compilation_event_semaphore->Signal();",
          "content_same": false
        },
        {
          "line": 3406,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "published_code->instructions().length()",
          "old_line_content": "}",
          "new_line_content": "      published_code->instructions().length());",
          "content_same": false
        },
        {
          "line": 3407,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "published_code->reloc_info().length()",
          "old_line_content": "",
          "new_line_content": "  counters->wasm_reloc_size()->Increment(published_code->reloc_info().length());",
          "content_same": false
        },
        {
          "line": 3283,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "async_counters_.get()",
          "old_line_content": "}",
          "new_line_content": "  ExecuteCompilationUnits(background_compile_token_, async_counters_.get(),",
          "content_same": false
        },
        {
          "line": 3285,
          "old_api": null,
          "new_api": "Wait",
          "old_text": null,
          "new_text": "compilation_event_semaphore->Wait()",
          "old_line_content": "namespace {",
          "new_line_content": "  compilation_event_semaphore->Wait();",
          "content_same": false
        },
        {
          "line": 3309,
          "old_api": null,
          "new_api": "Execute",
          "old_text": null,
          "new_text": "unit->Execute()",
          "old_line_content": "    }",
          "new_line_content": "      unit->Execute();",
          "content_same": false
        },
        {
          "line": 3310,
          "old_api": null,
          "new_api": "fetch_sub",
          "old_text": null,
          "new_text": "outstanding_units_.fetch_sub(1, std::memory_order_relaxed)",
          "old_line_content": "  }",
          "new_line_content": "      outstanding_units_.fetch_sub(1, std::memory_order_relaxed);",
          "content_same": false
        },
        {
          "line": 3311,
          "old_api": null,
          "new_api": "ShouldYield",
          "old_text": null,
          "new_text": "delegate->ShouldYield()",
          "old_line_content": "",
          "new_line_content": "      if (delegate->ShouldYield()) return;",
          "content_same": false
        },
        {
          "line": 3319,
          "old_api": null,
          "new_api": "load",
          "old_text": null,
          "new_text": "std::min(max_concurrency_,\n                    outstanding_units_.load(std::memory_order_relaxed))",
          "old_line_content": "",
          "new_line_content": "    return std::min(max_concurrency_,",
          "content_same": false
        },
        {
          "line": 3320,
          "old_api": null,
          "new_api": "load",
          "old_text": null,
          "new_text": "outstanding_units_.load(std::memory_order_relaxed)",
          "old_line_content": " private:",
          "new_line_content": "                    outstanding_units_.load(std::memory_order_relaxed));",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 3330,
          "old_api": "factory",
          "new_api": null,
          "old_text": "isolate->factory()->NewFixedArray(\n      MaxNumExportWrappers(module), AllocationType::kOld)",
          "new_text": null,
          "old_line_content": "  *export_wrappers_out = isolate->factory()->NewFixedArray(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3331,
          "old_api": "MaxNumExportWrappers",
          "new_api": null,
          "old_text": "MaxNumExportWrappers(module)",
          "new_text": null,
          "old_line_content": "      MaxNumExportWrappers(module), AllocationType::kOld);",
          "new_line_content": "void CompileJsToWasmWrappers(Isolate* isolate, const WasmModule* module,",
          "content_same": false
        },
        {
          "line": 3335,
          "old_api": "WasmFeatures::FromIsolate(isolate)",
          "new_api": null,
          "old_text": "WasmFeatures::FromIsolate(isolate)",
          "new_text": null,
          "old_line_content": "  WasmFeatures enabled_features = WasmFeatures::FromIsolate(isolate);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3342,
          "old_api": "insert",
          "new_api": null,
          "old_text": "queue.insert(key)",
          "new_text": null,
          "old_line_content": "    if (queue.insert(key)) {",
          "new_line_content": "    if (exp.kind != kExternalFunction) continue;",
          "content_same": false
        },
        {
          "line": 3343,
          "old_api": "wasm_engine",
          "new_api": null,
          "old_text": "std::make_unique<JSToWasmWrapperCompilationUnit>(\n          isolate, isolate->wasm_engine(), function.sig, module,\n          function.imported, enabled_features)",
          "new_text": null,
          "old_line_content": "      auto unit = std::make_unique<JSToWasmWrapperCompilationUnit>(",
          "new_line_content": "    auto& function = module->functions[exp.index];",
          "content_same": false
        },
        {
          "line": 3344,
          "old_api": "wasm_engine",
          "new_api": null,
          "old_text": "isolate->wasm_engine()",
          "new_text": null,
          "old_line_content": "          isolate, isolate->wasm_engine(), function.sig, module,",
          "new_line_content": "    JSToWasmWrapperKey key(function.imported, *function.sig);",
          "content_same": false
        },
        {
          "line": 3352,
          "old_api": "std::numeric_limits<size_t>::max()",
          "new_api": null,
          "old_text": "std::numeric_limits<size_t>::max()",
          "new_text": null,
          "old_line_content": "  size_t max_concurrency = flag_value < 1 ? std::numeric_limits<size_t>::max()",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3353,
          "old_api": "static_cast<size_t>(flag_value)",
          "new_api": null,
          "old_text": "static_cast<size_t>(flag_value)",
          "new_text": null,
          "old_line_content": "                                          : static_cast<size_t>(flag_value);",
          "new_line_content": "  // Execute wrapper compilation in the background.",
          "content_same": false
        },
        {
          "line": 3354,
          "old_api": "std::make_unique<CompileJSToWasmWrapperJob>(\n      &queue, &compilation_units, max_concurrency)",
          "new_api": null,
          "old_text": "std::make_unique<CompileJSToWasmWrapperJob>(\n      &queue, &compilation_units, max_concurrency)",
          "new_text": null,
          "old_line_content": "  auto job = std::make_unique<CompileJSToWasmWrapperJob>(",
          "new_line_content": "  int flag_value = FLAG_wasm_num_compilation_tasks;",
          "content_same": false
        },
        {
          "line": 3366,
          "old_api": "heap",
          "new_api": null,
          "old_text": "isolate->heap()",
          "new_text": null,
          "old_line_content": "  CodeSpaceMemoryModificationScope modification_scope(isolate->heap());",
          "new_line_content": "  // TODO(6792): Wrappers below are allocated with {Factory::NewCode}. As an",
          "content_same": false
        },
        {
          "line": 3370,
          "old_api": "Finalize",
          "new_api": null,
          "old_text": "unit->Finalize(isolate)",
          "new_text": null,
          "old_line_content": "    Handle<Code> code = unit->Finalize(isolate);",
          "new_line_content": "  for (auto& pair : compilation_units) {",
          "content_same": false
        },
        {
          "line": 3371,
          "old_api": "GetExportWrapperIndex",
          "new_api": null,
          "old_text": "GetExportWrapperIndex(module, &key.second, key.first)",
          "new_text": null,
          "old_line_content": "    int wrapper_index = GetExportWrapperIndex(module, &key.second, key.first);",
          "new_line_content": "    JSToWasmWrapperKey key = pair.first;",
          "content_same": false
        },
        {
          "line": 3386,
          "old_api": "DCHECK_NULL",
          "new_api": null,
          "old_text": "DCHECK_NULL((*cache_scope)[key])",
          "new_text": null,
          "old_line_content": "  DCHECK_NULL((*cache_scope)[key]);",
          "new_line_content": "  // other threads' iterators/references, but it should not have been compiled",
          "content_same": false
        },
        {
          "line": 3387,
          "old_api": "module",
          "new_api": null,
          "old_text": "native_module->module()",
          "new_text": null,
          "old_line_content": "  bool source_positions = is_asmjs_module(native_module->module());",
          "new_line_content": "  // yet.",
          "content_same": false
        },
        {
          "line": 3391,
          "old_api": "compiler::CompileWasmImportCallWrapper(\n      wasm_engine, &env, kind, sig, source_positions, expected_arity)",
          "new_api": null,
          "old_text": "compiler::CompileWasmImportCallWrapper(\n      wasm_engine, &env, kind, sig, source_positions, expected_arity)",
          "new_text": null,
          "old_line_content": "  WasmCompilationResult result = compiler::CompileWasmImportCallWrapper(",
          "new_line_content": "  // Keep the {WasmCode} alive until we explicitly call {IncRef}.",
          "content_same": false
        },
        {
          "line": 3397,
          "old_api": "GetCodeKind",
          "new_api": null,
          "old_text": "GetCodeKind(result)",
          "new_text": null,
          "old_line_content": "      result.source_positions.as_vector(), GetCodeKind(result),",
          "new_line_content": "      result.func_index, result.code_desc, result.frame_slot_count,",
          "content_same": false
        },
        {
          "line": 3271,
          "old_api": "Signal",
          "new_api": null,
          "old_text": "AddCallback(\n      [compilation_event_semaphore, expect_event](CompilationEvent event) {\n        if (event == expect_event ||\n            event == CompilationEvent::kFailedCompilation) {\n          compilation_event_semaphore->Signal();\n        }\n      })",
          "new_text": null,
          "old_line_content": "  AddCallback(",
          "new_line_content": "  base::EnumSet<CompilationEvent> events{expect_event,",
          "content_same": false
        },
        {
          "line": 3401,
          "old_api": "IncRef",
          "new_api": null,
          "old_text": "published_code->IncRef()",
          "new_text": null,
          "old_line_content": "  published_code->IncRef();",
          "new_line_content": "      ExecutionTier::kNone, kNoDebugging);",
          "content_same": false
        },
        {
          "line": 3403,
          "old_api": "length",
          "new_api": null,
          "old_text": "published_code->instructions().length()",
          "new_text": null,
          "old_line_content": "      published_code->instructions().length());",
          "new_line_content": "  (*cache_scope)[key] = published_code;",
          "content_same": false
        },
        {
          "line": 3279,
          "old_api": "constexpr",
          "new_api": null,
          "old_text": "constexpr",
          "new_text": null,
          "old_line_content": "  constexpr JobDelegate* kNoDelegate = nullptr;",
          "new_line_content": "        });",
          "content_same": false
        },
        {
          "line": 3280,
          "old_api": "get",
          "new_api": null,
          "old_text": "async_counters_.get()",
          "new_text": null,
          "old_line_content": "  ExecuteCompilationUnits(background_compile_token_, async_counters_.get(),",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 3301,
          "old_api": "size",
          "new_api": null,
          "old_text": "queue->size()",
          "new_text": null,
          "old_line_content": "        outstanding_units_(queue->size()) {}",
          "new_line_content": "      : queue_(queue),",
          "content_same": false
        },
        {
          "line": 3305,
          "old_api": "get",
          "new_api": null,
          "old_text": "*compilation_units_)[*key].get()",
          "new_text": null,
          "old_line_content": "      JSToWasmWrapperCompilationUnit* unit = (*compilation_units_)[*key].get();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3306,
          "old_api": "Execute",
          "new_api": null,
          "old_text": "unit->Execute()",
          "new_text": null,
          "old_line_content": "      unit->Execute();",
          "new_line_content": "  void Run(JobDelegate* delegate) override {",
          "content_same": false
        },
        {
          "line": 3316,
          "old_api": "load",
          "new_api": null,
          "old_text": "std::min(max_concurrency_,\n                    outstanding_units_.load(std::memory_order_relaxed))",
          "new_text": null,
          "old_line_content": "    return std::min(max_concurrency_,",
          "new_line_content": "    // {outstanding_units_} includes the units that other workers are currently",
          "content_same": false
        },
        {
          "line": 3317,
          "old_api": "load",
          "new_api": null,
          "old_text": "outstanding_units_.load(std::memory_order_relaxed)",
          "new_text": null,
          "old_line_content": "                    outstanding_units_.load(std::memory_order_relaxed));",
          "new_line_content": "    // working on, so we can safely ignore the {worker_count} and just return",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 17,
      "total_additions": 27,
      "total_deletions": 26,
      "total_api_changes": 70
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 10,
        "api_related_lines": 70,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          3272,
          3273,
          3274,
          3277
        ]
      }
    },
    "api_calls_before": 1235,
    "api_calls_after": 1237,
    "diff_info": {
      "added_lines": 10,
      "removed_lines": 7,
      "total_diff_lines": 29
    }
  }
}