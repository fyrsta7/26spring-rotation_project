diff --git a/src/wasm/module-compiler.cc b/src/wasm/module-compiler.cc
index 6fdb67beabc..5512c44eeaa 100644
--- a/src/wasm/module-compiler.cc
+++ b/src/wasm/module-compiler.cc
@@ -3268,13 +3268,16 @@ void CompilationStateImpl::SetError() {
 void CompilationStateImpl::WaitForCompilationEvent(
     CompilationEvent expect_event) {
   auto compilation_event_semaphore = std::make_shared<base::Semaphore>(0);
-  AddCallback(
-      [compilation_event_semaphore, expect_event](CompilationEvent event) {
-        if (event == expect_event ||
-            event == CompilationEvent::kFailedCompilation) {
-          compilation_event_semaphore->Signal();
-        }
-      });
+  base::EnumSet<CompilationEvent> events{expect_event,
+                                         CompilationEvent::kFailedCompilation};
+  {
+    base::MutexGuard callbacks_guard(&callbacks_mutex_);
+    if (finished_events_.contains_any(events)) return;
+    callbacks_.emplace_back(
+        [compilation_event_semaphore, events](CompilationEvent event) {
+          if (events.contains(event)) compilation_event_semaphore->Signal();
+        });
+  }
 
   constexpr JobDelegate* kNoDelegate = nullptr;
   ExecuteCompilationUnits(background_compile_token_, async_counters_.get(),
