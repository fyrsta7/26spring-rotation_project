{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/00eb355247526c76cdbeee6422dd76c236ee7bd9",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/00eb355247526c76cdbeee6422dd76c236ee7bd9/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/00eb355247526c76cdbeee6422dd76c236ee7bd9/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/00eb355247526c76cdbeee6422dd76c236ee7bd9/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 247,
          "old_api": "IsUndefined",
          "new_api": "get",
          "old_text": "element->IsUndefined()",
          "new_text": "get(OPTIMIZED_FUNCTIONS_LIST)",
          "old_line_content": "  while (!element->IsUndefined()) {",
          "new_line_content": "    Object* element = get(OPTIMIZED_FUNCTIONS_LIST);",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": "CHECK",
          "new_api": "IsUndefined",
          "old_text": "CHECK(element != function)",
          "new_text": "element->IsUndefined()",
          "old_line_content": "    CHECK(element != function);",
          "new_line_content": "    while (!element->IsUndefined()) {",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": "next_function_link",
          "new_api": "CHECK",
          "old_text": "JSFunction::cast(element)->next_function_link()",
          "new_text": "CHECK(element != function)",
          "old_line_content": "    element = JSFunction::cast(element)->next_function_link();",
          "new_line_content": "      CHECK(element != function);",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": "CHECK",
          "new_api": "get",
          "old_text": "CHECK(found)",
          "new_text": "Context::cast(context)->get(Context::NEXT_CONTEXT_LINK)",
          "old_line_content": "  CHECK(found);",
          "new_line_content": "    context = Context::cast(context)->get(Context::NEXT_CONTEXT_LINK);",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": "get",
          "new_api": "CHECK",
          "old_text": "get(OPTIMIZED_FUNCTIONS_LIST)",
          "new_text": "CHECK(found)",
          "old_line_content": "  function->set_next_function_link(get(OPTIMIZED_FUNCTIONS_LIST));",
          "new_line_content": "  CHECK(found);",
          "content_same": false
        },
        {
          "line": 275,
          "old_api": "IsUndefined",
          "new_api": "get",
          "old_text": "element->IsUndefined()",
          "new_text": "get(OPTIMIZED_FUNCTIONS_LIST)",
          "old_line_content": "  while (!element->IsUndefined()) {",
          "new_line_content": "  Object* element = get(OPTIMIZED_FUNCTIONS_LIST);",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": "next_function_link",
          "new_api": "IsUndefined",
          "old_text": "element_function->next_function_link()->IsUndefined()",
          "new_text": "element->IsUndefined()",
          "old_line_content": "    ASSERT(element_function->next_function_link()->IsUndefined() ||",
          "new_line_content": "  while (!element->IsUndefined()) {",
          "content_same": false
        },
        {
          "line": 278,
          "old_api": "next_function_link",
          "new_api": "JSFunction::cast(element)",
          "old_text": "element_function->next_function_link()->IsJSFunction()",
          "new_text": "JSFunction::cast(element)",
          "old_line_content": "           element_function->next_function_link()->IsJSFunction());",
          "new_line_content": "    JSFunction* element_function = JSFunction::cast(element);",
          "content_same": false
        },
        {
          "line": 285,
          "old_api": "undefined_value",
          "new_api": "next_function_link",
          "old_text": "GetHeap()->undefined_value()",
          "new_text": "element_function->next_function_link()",
          "old_line_content": "      element_function->set_next_function_link(GetHeap()->undefined_value());",
          "new_line_content": "        prev->set_next_function_link(element_function->next_function_link());",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": "UNREACHABLE",
          "new_api": "next_function_link",
          "old_text": "UNREACHABLE()",
          "new_text": "element_function->next_function_link()",
          "old_line_content": "  UNREACHABLE();",
          "new_line_content": "    element = element_function->next_function_link();",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": "bootstrapper",
          "new_api": "Isolate::Current()",
          "old_text": "isolate->bootstrapper()->IsActive()",
          "new_text": "Isolate::Current()",
          "old_line_content": "      isolate->bootstrapper()->IsActive() ||",
          "new_line_content": "  Isolate* isolate = Isolate::Current();",
          "content_same": false
        },
        {
          "line": 320,
          "old_api": "IsGlobalObject",
          "new_api": "heap",
          "old_text": "object->IsGlobalObject()",
          "new_text": "isolate->heap()->gc_state()",
          "old_line_content": "      object->IsGlobalObject();",
          "new_line_content": "  return isolate->heap()->gc_state() != Heap::NOT_IN_GC ||",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 321,
          "old_api": null,
          "new_api": "bootstrapper",
          "old_text": null,
          "new_text": "isolate->bootstrapper()->IsActive()",
          "old_line_content": "}",
          "new_line_content": "      isolate->bootstrapper()->IsActive() ||",
          "content_same": false
        },
        {
          "line": 258,
          "old_api": null,
          "new_api": "global_contexts_list",
          "old_text": null,
          "new_text": "GetHeap()->global_contexts_list()",
          "old_line_content": "    if (context == this) {",
          "new_line_content": "  Object* context = GetHeap()->global_contexts_list();",
          "content_same": false
        },
        {
          "line": 259,
          "old_api": null,
          "new_api": "IsUndefined",
          "old_text": null,
          "new_text": "context->IsUndefined()",
          "old_line_content": "      found = true;",
          "new_line_content": "  while (!context->IsUndefined()) {",
          "content_same": false
        },
        {
          "line": 312,
          "old_api": null,
          "new_api": "IsContext",
          "old_text": null,
          "new_text": "object->IsContext()",
          "old_line_content": "",
          "new_line_content": "  return Isolate::Current()->bootstrapper()->IsActive() || object->IsContext();",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": null,
          "new_api": "UNREACHABLE",
          "old_text": null,
          "new_text": "UNREACHABLE()",
          "old_line_content": "",
          "new_line_content": "  UNREACHABLE();",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": null,
          "new_api": "IsGlobalObject",
          "old_text": null,
          "new_text": "object->IsGlobalObject()",
          "old_line_content": "#endif",
          "new_line_content": "      object->IsGlobalObject();",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": null,
          "new_api": "IsGlobalContext",
          "old_text": null,
          "new_text": "IsGlobalContext()",
          "old_line_content": "}",
          "new_line_content": "  ASSERT(IsGlobalContext());",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "get(OPTIMIZED_FUNCTIONS_LIST)",
          "old_line_content": "",
          "new_line_content": "  return get(OPTIMIZED_FUNCTIONS_LIST);",
          "content_same": false
        },
        {
          "line": 268,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "get(OPTIMIZED_FUNCTIONS_LIST)",
          "old_line_content": "}",
          "new_line_content": "  function->set_next_function_link(get(OPTIMIZED_FUNCTIONS_LIST));",
          "content_same": false
        },
        {
          "line": 269,
          "old_api": null,
          "new_api": "set",
          "old_text": null,
          "new_text": "set(OPTIMIZED_FUNCTIONS_LIST, function)",
          "old_line_content": "",
          "new_line_content": "  set(OPTIMIZED_FUNCTIONS_LIST, function);",
          "content_same": false
        },
        {
          "line": 304,
          "old_api": null,
          "new_api": "undefined_value",
          "old_text": null,
          "new_text": "GetHeap()->undefined_value()",
          "old_line_content": "",
          "new_line_content": "  set(OPTIMIZED_FUNCTIONS_LIST, GetHeap()->undefined_value());",
          "content_same": false
        },
        {
          "line": 274,
          "old_api": null,
          "new_api": "IsGlobalContext",
          "old_text": null,
          "new_text": "IsGlobalContext()",
          "old_line_content": "  JSFunction* prev = NULL;",
          "new_line_content": "  ASSERT(IsGlobalContext());",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": null,
          "new_api": "next_function_link",
          "old_text": null,
          "new_text": "element_function->next_function_link()->IsUndefined()",
          "old_line_content": "    if (element_function == function) {",
          "new_line_content": "    ASSERT(element_function->next_function_link()->IsUndefined() ||",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": null,
          "new_api": "next_function_link",
          "old_text": null,
          "new_text": "element_function->next_function_link()->IsJSFunction()",
          "old_line_content": "      if (prev == NULL) {",
          "new_line_content": "           element_function->next_function_link()->IsJSFunction());",
          "content_same": false
        },
        {
          "line": 250,
          "old_api": null,
          "new_api": "next_function_link",
          "old_text": null,
          "new_text": "JSFunction::cast(element)->next_function_link()",
          "old_line_content": "  }",
          "new_line_content": "      element = JSFunction::cast(element)->next_function_link();",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": null,
          "new_api": "next_function_link",
          "old_text": null,
          "new_text": "function->next_function_link()->IsUndefined()",
          "old_line_content": "  // Check that the context belongs to the weak global contexts list.",
          "new_line_content": "  CHECK(function->next_function_link()->IsUndefined());",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": null,
          "new_api": "undefined_value",
          "old_text": null,
          "new_text": "GetHeap()->undefined_value()",
          "old_line_content": "    }",
          "new_line_content": "      element_function->set_next_function_link(GetHeap()->undefined_value());",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 256,
          "old_api": "global_contexts_list",
          "new_api": null,
          "old_text": "GetHeap()->global_contexts_list()",
          "new_text": null,
          "old_line_content": "  Object* context = GetHeap()->global_contexts_list();",
          "new_line_content": "  // Check that the context belongs to the weak global contexts list.",
          "content_same": false
        },
        {
          "line": 257,
          "old_api": "IsUndefined",
          "new_api": null,
          "old_text": "context->IsUndefined()",
          "new_text": null,
          "old_line_content": "  while (!context->IsUndefined()) {",
          "new_line_content": "  bool found = false;",
          "content_same": false
        },
        {
          "line": 289,
          "old_api": "next_function_link",
          "new_api": null,
          "old_text": "element_function->next_function_link()",
          "new_text": null,
          "old_line_content": "    element = element_function->next_function_link();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": "get",
          "new_api": null,
          "old_text": "Context::cast(context)->get(Context::NEXT_CONTEXT_LINK)",
          "new_text": null,
          "old_line_content": "    context = Context::cast(context)->get(Context::NEXT_CONTEXT_LINK);",
          "new_line_content": "      break;",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": "IsGlobalContext",
          "new_api": null,
          "old_text": "IsGlobalContext()",
          "new_text": null,
          "old_line_content": "  ASSERT(IsGlobalContext());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": "get",
          "new_api": null,
          "old_text": "get(OPTIMIZED_FUNCTIONS_LIST)",
          "new_text": null,
          "old_line_content": "  return get(OPTIMIZED_FUNCTIONS_LIST);",
          "new_line_content": "Object* Context::OptimizedFunctionsListHead() {",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": "set",
          "new_api": null,
          "old_text": "set(OPTIMIZED_FUNCTIONS_LIST, function)",
          "new_text": null,
          "old_line_content": "  set(OPTIMIZED_FUNCTIONS_LIST, function);",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": "undefined_value",
          "new_api": null,
          "old_text": "GetHeap()->undefined_value()",
          "new_text": null,
          "old_line_content": "  set(OPTIMIZED_FUNCTIONS_LIST, GetHeap()->undefined_value());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 272,
          "old_api": "IsGlobalContext",
          "new_api": null,
          "old_text": "IsGlobalContext()",
          "new_text": null,
          "old_line_content": "  ASSERT(IsGlobalContext());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": "get",
          "new_api": null,
          "old_text": "get(OPTIMIZED_FUNCTIONS_LIST)",
          "new_text": null,
          "old_line_content": "  Object* element = get(OPTIMIZED_FUNCTIONS_LIST);",
          "new_line_content": "void Context::RemoveOptimizedFunction(JSFunction* function) {",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": "JSFunction::cast(element)",
          "new_api": null,
          "old_text": "JSFunction::cast(element)",
          "new_text": null,
          "old_line_content": "    JSFunction* element_function = JSFunction::cast(element);",
          "new_line_content": "  JSFunction* prev = NULL;",
          "content_same": false
        },
        {
          "line": 246,
          "old_api": "get",
          "new_api": null,
          "old_text": "get(OPTIMIZED_FUNCTIONS_LIST)",
          "new_text": null,
          "old_line_content": "  Object* element = get(OPTIMIZED_FUNCTIONS_LIST);",
          "new_line_content": "  if (FLAG_enable_slow_asserts) {",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": "IsContext",
          "new_api": null,
          "old_text": "object->IsContext()",
          "new_text": null,
          "old_line_content": "  return Isolate::Current()->bootstrapper()->IsActive() || object->IsContext();",
          "new_line_content": "  // During bootstrapping we allow all objects to pass as",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": "next_function_link",
          "new_api": null,
          "old_text": "element_function->next_function_link()",
          "new_text": null,
          "old_line_content": "        set(OPTIMIZED_FUNCTIONS_LIST, element_function->next_function_link());",
          "new_line_content": "    if (element_function == function) {",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": "next_function_link",
          "new_api": null,
          "old_text": "function->next_function_link()->IsUndefined()",
          "new_text": null,
          "old_line_content": "  CHECK(function->next_function_link()->IsUndefined());",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 317,
          "old_api": "Isolate::Current()",
          "new_api": null,
          "old_text": "Isolate::Current()",
          "new_text": null,
          "old_line_content": "  Isolate* isolate = Isolate::Current();",
          "new_line_content": "  // During bootstrapping we allow all objects to pass as global",
          "content_same": false
        },
        {
          "line": 318,
          "old_api": "heap",
          "new_api": null,
          "old_text": "isolate->heap()->gc_state()",
          "new_text": null,
          "old_line_content": "  return isolate->heap()->gc_state() != Heap::NOT_IN_GC ||",
          "new_line_content": "  // objects. This is necessary to fix circular dependencies.",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 12,
      "total_additions": 17,
      "total_deletions": 17,
      "total_api_changes": 46
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 6,
        "api_related_lines": 46,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          251
        ]
      }
    },
    "api_calls_before": 132,
    "api_calls_after": 132,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 4,
      "total_diff_lines": 22
    }
  }
}