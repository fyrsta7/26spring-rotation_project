{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/7e181fb0fe1693970fc8eced022a392e861fd397",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/7e181fb0fe1693970fc8eced022a392e861fd397/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/7e181fb0fe1693970fc8eced022a392e861fd397/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/7e181fb0fe1693970fc8eced022a392e861fd397/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 78,
          "old_api": "apObject::FromAddress(soon_object);",
          "new_api": "jectSlot",
          "old_text": "apObject::FromAddress(soon_object);\n",
          "new_text": "jectSlot(soon_object)).",
          "old_line_content": "  HeapObject heap_object = HeapObject::FromAddress(soon_object);",
          "new_line_content": "  DCHECK((*ObjectSlot(soon_object)).IsMap());",
          "content_same": false
        },
        {
          "line": 86,
          "old_api": "::Utils::ToLocal(obj);",
          "new_api": "dStack",
          "old_text": "::Utils::ToLocal(obj);\n",
          "new_text": "dStack();\n",
          "old_line_content": "  Local<v8::Value> loc = v8::Utils::ToLocal(obj);",
          "new_line_content": "  AllocationNode* node = AddStack();",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": "get",
          "new_api": "d::move(sample));",
          "old_text": "mple.get(), ",
          "new_text": "d::move(sample));",
          "old_line_content": "  sample->global.SetWeak(sample.get(), OnWeakCallback,",
          "new_line_content": "  samples_.emplace(sample.get(), std::move(sample));",
          "content_same": false
        },
        {
          "line": 99,
          "old_api": "GetParameter",
          "new_api": "HECK_GT",
          "old_text": "ta.GetParameter();\n",
          "new_text": "HECK_GT(node->allocations_[sample->size], 0);\n",
          "old_line_content": "  Sample* sample = data.GetParameter();",
          "new_line_content": "  DCHECK_GT(node->allocations_[sample->size], 0);",
          "content_same": false
        },
        {
          "line": 108,
          "old_api": "locationNode::function_id(\n          node->script_id_, node->script_position_, node->name_);",
          "new_api": "erase",
          "old_text": "locationNode::function_id(\n          node->script_id_, node->script_position_, node->name_);\n",
          "new_text": "rent->children_.erase(id);\n",
          "old_line_content": "      AllocationNode::FunctionId id = AllocationNode::function_id(",
          "new_line_content": "      parent->children_.erase(id);",
          "content_same": false
        },
        {
          "line": 123,
          "old_api": "FindChildNode",
          "new_api": "rcmp",
          "old_text": "rent->FindChildNode(id);\n",
          "new_text": "rcmp(child->name_, name), ",
          "old_line_content": "  AllocationNode* child = parent->FindChildNode(id);",
          "new_line_content": "    DCHECK_EQ(strcmp(child->name_, name), 0);",
          "content_same": false
        },
        {
          "line": 128,
          "old_api": "d::make_unique<AllocationNode>(\n      parent, name, script_id, start_position, next_node_id());",
          "new_api": "d::move(new_child));",
          "old_text": "d::make_unique<AllocationNode>(\n      parent, name, script_id, start_position, next_node_id());\n",
          "new_text": "d::move(new_child));",
          "old_line_content": "  auto new_child = std::make_unique<AllocationNode>(",
          "new_line_content": "  return parent->AddChildNode(id, std::move(new_child));",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "IsJSFunction",
          "new_api": "push_back",
          "old_text": "ame->unchecked_function().IsJSFunction()) ",
          "new_text": "ack.push_back(shared);\n",
          "old_line_content": "    if (frame->unchecked_function().IsJSFunction()) {",
          "new_line_content": "      stack.push_back(shared);",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": "rend",
          "new_api": "DebugName",
          "old_text": "ack.rend(); ",
          "new_text": "ared.DebugName());",
          "old_line_content": "  for (auto it = stack.rbegin(); it != stack.rend(); ++it) {",
          "new_line_content": "    const char* name = this->names()->GetName(shared.DebugName());",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": "DebugName",
          "new_api": "script",
          "old_text": "ared.DebugName());",
          "new_text": "ared.script().IsScript()) ",
          "old_line_content": "    const char* name = this->names()->GetName(shared.DebugName());",
          "new_line_content": "    if (shared.script().IsScript()) {",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": "script",
          "new_api": "id",
          "old_text": "ared.script().IsScript()) ",
          "new_text": "ript.id();\n",
          "old_line_content": "    if (shared.script().IsScript()) {",
          "new_line_content": "      script_id = script.id();",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": "id",
          "new_api": "StartPosition",
          "old_text": "ript.id();\n",
          "new_text": "ared.StartPosition());",
          "old_line_content": "      script_id = script.id();",
          "new_line_content": "    node = FindOrAddChildNode(node, name, script_id, shared.StartPosition());",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": "size",
          "new_api": "end",
          "old_text": "de->allocations_.size());",
          "new_text": "ripts.end()) ",
          "old_line_content": "  allocations.reserve(node->allocations_.size());",
          "new_line_content": "      scripts.find(node->script_id_) != scripts.end()) {",
          "content_same": false
        },
        {
          "line": 228,
          "old_api": "nst_cast<std::map<int, Handle<Script>>&>(scripts);",
          "new_api": "is_null",
          "old_text": "nst_cast<std::map<int, Handle<Script>>&>(scripts);\n",
          "new_text": "ript.is_null()) ",
          "old_line_content": "        const_cast<std::map<int, Handle<Script>>&>(scripts);",
          "new_line_content": "    if (!script.is_null()) {",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": "is_null",
          "new_api": "name",
          "old_text": "ript.is_null()) ",
          "new_text": "ript->name());",
          "old_line_content": "    if (!script.is_null()) {",
          "new_line_content": "        Name name = Name::cast(script->name());",
          "content_same": false
        },
        {
          "line": 231,
          "old_api": "IsName",
          "new_api": "factory",
          "old_text": "ript->name().IsName()) ",
          "new_text": "ApiHandle<v8::String>(\n            isolate_->factory()->InternalizeUtf8String(names_->GetName(name)));\n",
          "old_line_content": "      if (script->name().IsName()) {",
          "new_line_content": "        script_name = ToApiHandle<v8::String>(",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "name",
          "new_api": "GetName",
          "old_text": "ript->name());",
          "new_text": "mes_->GetName(name)))",
          "old_line_content": "        Name name = Name::cast(script->name());",
          "new_line_content": "            isolate_->factory()->InternalizeUtf8String(names_->GetName(name)));",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": "GetName",
          "new_api": "ript::GetLineNumber(script, node->script_position_);",
          "old_text": "mes_->GetName(name)))",
          "new_text": "ript::GetLineNumber(script, node->script_position_);\n",
          "old_line_content": "            isolate_->factory()->InternalizeUtf8String(names_->GetName(name)));",
          "new_line_content": "      line = 1 + Script::GetLineNumber(script, node->script_position_);",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": "push_back",
          "new_api": "factory",
          "old_text": "ofile->nodes_.push_back(v8::AllocationProfile::Node{\n      ToApiHandle<v8::String>(\n          isolate_->factory()->InternalizeUtf8String(node->name_)),\n      script_name, node->script_id_, node->script_position_, line, column,\n      node->id_, std::vector<v8::AllocationProfile::Node*>(), allocations});\n",
          "new_text": "olate_->factory()->InternalizeUtf8String(node->name_)),",
          "old_line_content": "  profile->nodes_.push_back(v8::AllocationProfile::Node{",
          "new_line_content": "          isolate_->factory()->InternalizeUtf8String(node->name_)),",
          "content_same": false
        },
        {
          "line": 246,
          "old_api": "factory",
          "new_api": "d::vector<v8::AllocationProfile::Node*>(),",
          "old_text": "olate_->factory()->InternalizeUtf8String(node->name_)),",
          "new_text": "d::vector<v8::AllocationProfile::Node*>(), ",
          "old_line_content": "          isolate_->factory()->InternalizeUtf8String(node->name_)),",
          "new_line_content": "      node->id_, std::vector<v8::AllocationProfile::Node*>(), allocations});",
          "content_same": false
        },
        {
          "line": 272,
          "old_api": "is_null",
          "new_api": "ndle",
          "old_text": "ript.is_null();\n",
          "new_text": "ndle(script, isolate_);\n",
          "old_line_content": "    for (Script script = iterator.Next(); !script.is_null();",
          "new_line_content": "      scripts[script.id()] = handle(script, isolate_);",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": "size",
          "new_api": "get",
          "old_text": "mples_.size());",
          "new_text": ".second.get();\n",
          "old_line_content": "  samples.reserve(samples_.size());",
          "new_line_content": "    const Sample* sample = it.second.get();",
          "content_same": false
        },
        {
          "line": 289,
          "old_api": "get",
          "new_api": "aleSample",
          "old_text": ".second.get();\n",
          "new_text": "aleSample(sample->size, 1).c",
          "old_line_content": "    const Sample* sample = it.second.get();",
          "new_line_content": "        sample->owner->id_, sample->size, ScaleSample(sample->size, 1).count,",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 262,
          "old_api": null,
          "new_api": "heap",
          "old_text": null,
          "new_text": "olate_->heap()->CollectAllGarbage(\n        Heap::kNoGCFlags, GarbageCollectionReason::kSamplingProfiler);\n",
          "old_line_content": "v8::AllocationProfile* SamplingHeapProfiler::GetAllocationProfile() {",
          "new_line_content": "    isolate_->heap()->CollectAllGarbage(",
          "content_same": false
        },
        {
          "line": 138,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": ".done() &",
          "old_line_content": "  int frames_captured = 0;",
          "new_line_content": "  while (!it.done() && frames_captured < stack_depth_) {",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": null,
          "new_api": "frame",
          "old_text": null,
          "new_text": ".frame();\n",
          "old_line_content": "  bool found_arguments_marker_frames = false;",
          "new_line_content": "    JavaScriptFrame* frame = it.frame();",
          "content_same": false
        },
        {
          "line": 270,
          "old_api": null,
          "new_api": "is_null",
          "old_text": null,
          "new_text": "ript.is_null();\n",
          "old_line_content": "  {",
          "new_line_content": "    for (Script script = iterator.Next(); !script.is_null();",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": null,
          "new_api": "Next",
          "old_text": null,
          "new_text": "erator.Next()) ",
          "old_line_content": "    Script::Iterator iterator(isolate_);",
          "new_line_content": "         script = iterator.Next()) {",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": null,
          "new_api": "IsJSFunction",
          "old_text": null,
          "new_text": "ame->unchecked_function().IsJSFunction()) ",
          "old_line_content": "    // in the top frames of the stack). The allocations made in this",
          "new_line_content": "    if (frame->unchecked_function().IsJSFunction()) {",
          "content_same": false
        },
        {
          "line": 146,
          "old_api": null,
          "new_api": "shared",
          "old_text": null,
          "new_text": "ame->function().shared();\n",
          "old_line_content": "    // sensitive moment belong to the formerly optimized frame anyway.",
          "new_line_content": "      SharedFunctionInfo shared = frame->function().shared();",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": null,
          "new_api": "anslateAllocationNode",
          "old_text": null,
          "new_text": "anslateAllocationNode(profile, &profile_root_, scripts);\n",
          "old_line_content": "  }",
          "new_line_content": "  TranslateAllocationNode(profile, &profile_root_, scripts);",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": null,
          "new_api": "ildSamples",
          "old_text": null,
          "new_text": "ildSamples();\n",
          "old_line_content": "  auto profile = new v8::internal::AllocationProfile();",
          "new_line_content": "  profile->samples_ = BuildSamples();",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": null,
          "new_api": "Advance",
          "old_text": null,
          "new_text": ".Advance();\n",
          "old_line_content": "      found_arguments_marker_frames = true;",
          "new_line_content": "    it.Advance();",
          "content_same": false
        },
        {
          "line": 157,
          "old_api": null,
          "new_api": "current_vm_state",
          "old_text": null,
          "new_text": "olate_->current_vm_state()) ",
          "old_line_content": "  if (frames_captured == 0) {",
          "new_line_content": "    switch (isolate_->current_vm_state()) {",
          "content_same": false
        },
        {
          "line": 285,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "mples_.size());",
          "old_line_content": "SamplingHeapProfiler::BuildSamples() const {",
          "new_line_content": "  samples.reserve(samples_.size());",
          "content_same": false
        },
        {
          "line": 288,
          "old_api": null,
          "new_api": "emplace_back",
          "old_text": null,
          "new_text": "mples.emplace_back(v8::AllocationProfile::Sample{\n        sample->owner->id_, sample->size, ScaleSample(sample->size, 1).count,\n        sample->sample_id});\n",
          "old_line_content": "  for (const auto& it : samples_) {",
          "new_line_content": "    samples.emplace_back(v8::AllocationProfile::Sample{",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": null,
          "new_api": "ndOrAddChildNode",
          "old_text": null,
          "new_text": "ndOrAddChildNode(node, name, v8::UnboundScript::kNoScriptId, 0);\n",
          "old_line_content": "        break;",
          "new_line_content": "    return FindOrAddChildNode(node, name, v8::UnboundScript::kNoScriptId, 0);",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": null,
          "new_api": "rend",
          "old_text": null,
          "new_text": "ack.rend(); ",
          "old_line_content": "  // We need to process the stack in reverse order as the top of the stack is",
          "new_line_content": "  for (auto it = stack.rbegin(); it != stack.rend(); ++it) {",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": null,
          "new_api": "script",
          "old_text": null,
          "new_text": "ared.script());",
          "old_line_content": "    int script_id = v8::UnboundScript::kNoScriptId;",
          "new_line_content": "      Script script = Script::cast(shared.script());",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": null,
          "new_api": "ndOrAddChildNode",
          "old_text": null,
          "new_text": "ndOrAddChildNode(node, \"(deopt)\", v8::UnboundScript::kNoScriptId, 0);\n",
          "old_line_content": "  if (found_arguments_marker_frames) {",
          "new_line_content": "        FindOrAddChildNode(node, \"(deopt)\", v8::UnboundScript::kNoScriptId, 0);",
          "content_same": false
        },
        {
          "line": 81,
          "old_api": null,
          "new_api": "apObject::FromAddress(soon_object);",
          "old_text": null,
          "new_text": "apObject::FromAddress(soon_object);\n",
          "old_line_content": "  // Mark the new block as FreeSpace to make sure the heap is iterable while we",
          "new_line_content": "  HeapObject heap_object = HeapObject::FromAddress(soon_object);",
          "content_same": false
        },
        {
          "line": 84,
          "old_api": null,
          "new_api": "::Utils::ToLocal(obj);",
          "old_text": null,
          "new_text": "::Utils::ToLocal(obj);\n",
          "old_line_content": "                              ClearRecordedSlots::kNo);",
          "new_line_content": "  Local<v8::Value> loc = v8::Utils::ToLocal(obj);",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": ".second.get(), ",
          "old_line_content": "  for (const auto& it : node->children_) {",
          "new_line_content": "        TranslateAllocationNode(profile, it.second.get(), scripts));",
          "content_same": false
        },
        {
          "line": 89,
          "old_api": null,
          "new_api": "xt_sample_id",
          "old_text": null,
          "new_text": "xt_sample_id());",
          "old_line_content": "  node->allocations_[size]++;",
          "new_line_content": "      std::make_unique<Sample>(size, node, loc, this, next_sample_id());",
          "content_same": false
        },
        {
          "line": 90,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "mple.get(), ",
          "old_line_content": "  auto sample =",
          "new_line_content": "  sample->global.SetWeak(sample.get(), OnWeakCallback,",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": null,
          "new_api": "factory",
          "old_text": null,
          "new_text": "olate_->factory()->InternalizeUtf8String(\"\"));",
          "old_line_content": "  node->pinned_ = true;",
          "new_line_content": "      ToApiHandle<v8::String>(isolate_->factory()->InternalizeUtf8String(\"\"));",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "de->allocations_.size());",
          "old_line_content": "  int column = v8::AllocationProfile::kNoColumnNumberInfo;",
          "new_line_content": "  allocations.reserve(node->allocations_.size());",
          "content_same": false
        },
        {
          "line": 97,
          "old_api": null,
          "new_api": "GetParameter",
          "old_text": null,
          "new_text": "ta.GetParameter();\n",
          "old_line_content": "void SamplingHeapProfiler::OnWeakCallback(",
          "new_line_content": "  Sample* sample = data.GetParameter();",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": null,
          "new_api": "nst_cast<std::map<int, Handle<Script>>&>(scripts);",
          "old_text": null,
          "new_text": "nst_cast<std::map<int, Handle<Script>>&>(scripts);\n",
          "old_line_content": "    // Cannot use std::map<T>::at because it is not available on android.",
          "new_line_content": "        const_cast<std::map<int, Handle<Script>>&>(scripts);",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": null,
          "new_api": "IsName",
          "old_text": null,
          "new_text": "ript->name().IsName()) ",
          "old_line_content": "    Handle<Script> script = non_const_scripts[node->script_id_];",
          "new_line_content": "      if (script->name().IsName()) {",
          "content_same": false
        },
        {
          "line": 102,
          "old_api": null,
          "new_api": "erase",
          "old_text": null,
          "new_text": "de->allocations_.erase(sample->size);\n",
          "old_line_content": "  node->allocations_[sample->size]--;",
          "new_line_content": "    node->allocations_.erase(sample->size);",
          "content_same": false
        },
        {
          "line": 103,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "de->children_.empty() &",
          "old_line_content": "  if (node->allocations_[sample->size] == 0) {",
          "new_line_content": "    while (node->allocations_.empty() && node->children_.empty() &&",
          "content_same": false
        },
        {
          "line": 106,
          "old_api": null,
          "new_api": "locationNode::function_id(\n          node->script_id_, node->script_position_, node->name_);",
          "old_text": null,
          "new_text": "locationNode::function_id(\n          node->script_id_, node->script_position_, node->name_);\n",
          "old_line_content": "           node->parent_ && !node->parent_->pinned_) {",
          "new_line_content": "      AllocationNode::FunctionId id = AllocationNode::function_id(",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": null,
          "new_api": "ript::GetColumnNumber(script, node->script_position_);",
          "old_text": null,
          "new_text": "ript::GetColumnNumber(script, node->script_position_);\n",
          "old_line_content": "      }",
          "new_line_content": "      column = 1 + Script::GetColumnNumber(script, node->script_position_);",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": null,
          "new_api": "aleSample",
          "old_text": null,
          "new_text": "aleSample(alloc.first, alloc.second));",
          "old_line_content": "  }",
          "new_line_content": "    allocations.push_back(ScaleSample(alloc.first, alloc.second));",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": null,
          "new_api": "erase",
          "old_text": null,
          "new_text": "mple->profiler->samples_.erase(sample);\n",
          "old_line_content": "    }",
          "new_line_content": "  sample->profiler->samples_.erase(sample);",
          "content_same": false
        },
        {
          "line": 242,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "ofile->nodes_.push_back(v8::AllocationProfile::Node{\n      ToApiHandle<v8::String>(\n          isolate_->factory()->InternalizeUtf8String(node->name_)),\n      script_name, node->script_id_, node->script_position_, line, column,\n      node->id_, std::vector<v8::AllocationProfile::Node*>(), allocations});\n",
          "old_line_content": "  }",
          "new_line_content": "  profile->nodes_.push_back(v8::AllocationProfile::Node{",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": null,
          "new_api": "factory",
          "old_text": null,
          "new_text": "ApiHandle<v8::String>(\n          isolate_->factory()->InternalizeUtf8String(node->name_)),\n",
          "old_line_content": "",
          "new_line_content": "      ToApiHandle<v8::String>(",
          "content_same": false
        },
        {
          "line": 247,
          "old_api": null,
          "new_api": "back",
          "old_text": null,
          "new_text": "ofile->nodes_.back();\n",
          "old_line_content": "      script_name, node->script_id_, node->script_position_, line, column,",
          "new_line_content": "  v8::AllocationProfile::Node* current = &profile->nodes_.back();",
          "content_same": false
        },
        {
          "line": 120,
          "old_api": null,
          "new_api": "locationNode::function_id(script_id, start_position, name);",
          "old_text": null,
          "new_text": "locationNode::function_id(script_id, start_position, name);\n",
          "old_line_content": "    int start_position) {",
          "new_line_content": "      AllocationNode::function_id(script_id, start_position, name);",
          "content_same": false
        },
        {
          "line": 121,
          "old_api": null,
          "new_api": "FindChildNode",
          "old_text": null,
          "new_text": "rent->FindChildNode(id);\n",
          "old_line_content": "  AllocationNode::FunctionId id =",
          "new_line_content": "  AllocationNode* child = parent->FindChildNode(id);",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "rrent->children.push_back(\n        TranslateAllocationNode(profile, it.second.get(), scripts));\n",
          "old_line_content": "  // invalidated upon std::map insertion.",
          "new_line_content": "    current->children.push_back(",
          "content_same": false
        },
        {
          "line": 126,
          "old_api": null,
          "new_api": "d::make_unique<AllocationNode>(\n      parent, name, script_id, start_position, next_node_id());",
          "old_text": null,
          "new_text": "d::make_unique<AllocationNode>(\n      parent, name, script_id, start_position, next_node_id());\n",
          "old_line_content": "    return child;",
          "new_line_content": "  auto new_child = std::make_unique<AllocationNode>(",
          "content_same": false
        },
        {
          "line": 127,
          "old_api": null,
          "new_api": "xt_node_id",
          "old_text": null,
          "new_text": "xt_node_id());",
          "old_line_content": "  }",
          "new_line_content": "      parent, name, script_id, start_position, next_node_id());",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 256,
          "old_api": "get",
          "new_api": null,
          "old_text": ".second.get(), ",
          "new_text": null,
          "old_line_content": "        TranslateAllocationNode(profile, it.second.get(), scripts));",
          "new_line_content": "  node->pinned_ = false;",
          "content_same": false
        },
        {
          "line": 129,
          "old_api": "xt_node_id",
          "new_api": null,
          "old_text": "xt_node_id());",
          "new_text": null,
          "old_line_content": "      parent, name, script_id, start_position, next_node_id());",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 130,
          "old_api": "d::move(new_child));",
          "new_api": null,
          "old_text": "d::move(new_child));",
          "new_text": null,
          "old_line_content": "  return parent->AddChildNode(id, std::move(new_child));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": "heap",
          "new_api": null,
          "old_text": "olate_->heap()->CollectAllGarbage(\n        Heap::kNoGCFlags, GarbageCollectionReason::kSamplingProfiler);\n",
          "new_text": null,
          "old_line_content": "    isolate_->heap()->CollectAllGarbage(",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 140,
          "old_api": "done",
          "new_api": null,
          "old_text": ".done() &",
          "new_text": null,
          "old_line_content": "  while (!it.done() && frames_captured < stack_depth_) {",
          "new_line_content": "    // If we are materializing objects during deoptimization, inlined",
          "content_same": false
        },
        {
          "line": 141,
          "old_api": "frame",
          "new_api": null,
          "old_text": ".frame();\n",
          "new_text": null,
          "old_line_content": "    JavaScriptFrame* frame = it.frame();",
          "new_line_content": "    // closures may not yet be materialized, and this includes the",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": "Next",
          "new_api": null,
          "old_text": "erator.Next()) ",
          "new_text": null,
          "old_line_content": "         script = iterator.Next()) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 274,
          "old_api": "ndle",
          "new_api": null,
          "old_text": "ndle(script, isolate_);\n",
          "new_text": null,
          "old_line_content": "      scripts[script.id()] = handle(script, isolate_);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 148,
          "old_api": "shared",
          "new_api": null,
          "old_text": "ame->function().shared();\n",
          "new_text": null,
          "old_line_content": "      SharedFunctionInfo shared = frame->function().shared();",
          "new_line_content": "      frames_captured++;",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "ack.push_back(shared);\n",
          "new_text": null,
          "old_line_content": "      stack.push_back(shared);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 278,
          "old_api": "anslateAllocationNode",
          "new_api": null,
          "old_text": "anslateAllocationNode(profile, &profile_root_, scripts);\n",
          "new_text": null,
          "old_line_content": "  TranslateAllocationNode(profile, &profile_root_, scripts);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": "ildSamples",
          "new_api": null,
          "old_text": "ildSamples();\n",
          "new_text": null,
          "old_line_content": "  profile->samples_ = BuildSamples();",
          "new_line_content": "  return profile;",
          "content_same": false
        },
        {
          "line": 154,
          "old_api": "Advance",
          "new_api": null,
          "old_text": ".Advance();\n",
          "new_text": null,
          "old_line_content": "    it.Advance();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 159,
          "old_api": "current_vm_state",
          "new_api": null,
          "old_text": "olate_->current_vm_state()) ",
          "new_text": null,
          "old_line_content": "    switch (isolate_->current_vm_state()) {",
          "new_line_content": "        name = \"(GC)\";",
          "content_same": false
        },
        {
          "line": 290,
          "old_api": "emplace_back",
          "new_api": null,
          "old_text": "mples.emplace_back(v8::AllocationProfile::Sample{\n        sample->owner->id_, sample->size, ScaleSample(sample->size, 1).count,\n        sample->sample_id});\n",
          "new_text": null,
          "old_line_content": "    samples.emplace_back(v8::AllocationProfile::Sample{",
          "new_line_content": "        sample->sample_id});",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": "aleSample",
          "new_api": null,
          "old_text": "aleSample(sample->size, 1).c",
          "new_text": null,
          "old_line_content": "        sample->owner->id_, sample->size, ScaleSample(sample->size, 1).count,",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "ndOrAddChildNode",
          "new_api": null,
          "old_text": "ndOrAddChildNode(node, name, v8::UnboundScript::kNoScriptId, 0);\n",
          "new_text": null,
          "old_line_content": "    return FindOrAddChildNode(node, name, v8::UnboundScript::kNoScriptId, 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": "script",
          "new_api": null,
          "old_text": "ared.script());",
          "new_text": null,
          "old_line_content": "      Script script = Script::cast(shared.script());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "StartPosition",
          "new_api": null,
          "old_text": "ared.StartPosition());",
          "new_text": null,
          "old_line_content": "    node = FindOrAddChildNode(node, name, script_id, shared.StartPosition());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "ndOrAddChildNode",
          "new_api": null,
          "old_text": "ndOrAddChildNode(node, \"(deopt)\", v8::UnboundScript::kNoScriptId, 0);\n",
          "new_text": null,
          "old_line_content": "        FindOrAddChildNode(node, \"(deopt)\", v8::UnboundScript::kNoScriptId, 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 83,
          "old_api": "atic_cast<int>(size),",
          "new_api": null,
          "old_text": "atic_cast<int>(size),\n",
          "new_text": null,
          "old_line_content": "  heap_->CreateFillerObjectAt(soon_object, static_cast<int>(size),",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 88,
          "old_api": "dStack",
          "new_api": null,
          "old_text": "dStack();\n",
          "new_text": null,
          "old_line_content": "  AllocationNode* node = AddStack();",
          "new_line_content": "  auto sample =",
          "content_same": false
        },
        {
          "line": 91,
          "old_api": "xt_sample_id",
          "new_api": null,
          "old_text": "xt_sample_id());",
          "new_text": null,
          "old_line_content": "      std::make_unique<Sample>(size, node, loc, this, next_sample_id());",
          "new_line_content": "                         WeakCallbackType::kParameter);",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": "factory",
          "new_api": null,
          "old_text": "olate_->factory()->InternalizeUtf8String(\"\"));",
          "new_text": null,
          "old_line_content": "      ToApiHandle<v8::String>(isolate_->factory()->InternalizeUtf8String(\"\"));",
          "new_line_content": "  int column = v8::AllocationProfile::kNoColumnNumberInfo;",
          "content_same": false
        },
        {
          "line": 94,
          "old_api": "d::move(sample));",
          "new_api": null,
          "old_text": "d::move(sample));",
          "new_text": null,
          "old_line_content": "  samples_.emplace(sample.get(), std::move(sample));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "end",
          "new_api": null,
          "old_text": "ripts.end()) ",
          "new_text": null,
          "old_line_content": "      scripts.find(node->script_id_) != scripts.end()) {",
          "new_line_content": "    auto non_const_scripts =",
          "content_same": false
        },
        {
          "line": 101,
          "old_api": "HECK_GT",
          "new_api": null,
          "old_text": "HECK_GT(node->allocations_[sample->size], 0);\n",
          "new_text": null,
          "old_line_content": "  DCHECK_GT(node->allocations_[sample->size], 0);",
          "new_line_content": "  if (node->allocations_[sample->size] == 0) {",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": "erase",
          "new_api": null,
          "old_text": "de->allocations_.erase(sample->size);\n",
          "new_text": null,
          "old_line_content": "    node->allocations_.erase(sample->size);",
          "new_line_content": "           node->parent_ && !node->parent_->pinned_) {",
          "content_same": false
        },
        {
          "line": 105,
          "old_api": "empty",
          "new_api": null,
          "old_text": "de->children_.empty() &",
          "new_text": null,
          "old_line_content": "    while (node->allocations_.empty() && node->children_.empty() &&",
          "new_line_content": "      AllocationNode* parent = node->parent_;",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": "factory",
          "new_api": null,
          "old_text": "ApiHandle<v8::String>(\n            isolate_->factory()->InternalizeUtf8String(names_->GetName(name)));\n",
          "new_text": null,
          "old_line_content": "        script_name = ToApiHandle<v8::String>(",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": "ript::GetLineNumber(script, node->script_position_);",
          "new_api": null,
          "old_text": "ript::GetLineNumber(script, node->script_position_);\n",
          "new_text": null,
          "old_line_content": "      line = 1 + Script::GetLineNumber(script, node->script_position_);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": "ript::GetColumnNumber(script, node->script_position_);",
          "new_api": null,
          "old_text": "ript::GetColumnNumber(script, node->script_position_);\n",
          "new_text": null,
          "old_line_content": "      column = 1 + Script::GetColumnNumber(script, node->script_position_);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 110,
          "old_api": "erase",
          "new_api": null,
          "old_text": "rent->children_.erase(id);\n",
          "new_text": null,
          "old_line_content": "      parent->children_.erase(id);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": "aleSample",
          "new_api": null,
          "old_text": "aleSample(alloc.first, alloc.second));",
          "new_text": null,
          "old_line_content": "    allocations.push_back(ScaleSample(alloc.first, alloc.second));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 114,
          "old_api": "erase",
          "new_api": null,
          "old_text": "mple->profiler->samples_.erase(sample);\n",
          "new_text": null,
          "old_line_content": "  sample->profiler->samples_.erase(sample);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 245,
          "old_api": "factory",
          "new_api": null,
          "old_text": "ApiHandle<v8::String>(\n          isolate_->factory()->InternalizeUtf8String(node->name_)),\n",
          "new_text": null,
          "old_line_content": "      ToApiHandle<v8::String>(",
          "new_line_content": "      script_name, node->script_id_, node->script_position_, line, column,",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": "d::vector<v8::AllocationProfile::Node*>(),",
          "new_api": null,
          "old_text": "d::vector<v8::AllocationProfile::Node*>(), ",
          "new_text": null,
          "old_line_content": "      node->id_, std::vector<v8::AllocationProfile::Node*>(), allocations});",
          "new_line_content": "  // The |children_| map may have nodes inserted into it during translation",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": "back",
          "new_api": null,
          "old_text": "ofile->nodes_.back();\n",
          "new_text": null,
          "old_line_content": "  v8::AllocationProfile::Node* current = &profile->nodes_.back();",
          "new_line_content": "  // because the translation may allocate strings on the JS heap that have",
          "content_same": false
        },
        {
          "line": 122,
          "old_api": "locationNode::function_id(script_id, start_position, name);",
          "new_api": null,
          "old_text": "locationNode::function_id(script_id, start_position, name);\n",
          "new_text": null,
          "old_line_content": "      AllocationNode::function_id(script_id, start_position, name);",
          "new_line_content": "  if (child) {",
          "content_same": false
        },
        {
          "line": 125,
          "old_api": "rcmp",
          "new_api": null,
          "old_text": "rcmp(child->name_, name), ",
          "new_text": null,
          "old_line_content": "    DCHECK_EQ(strcmp(child->name_, name), 0);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 255,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "rrent->children.push_back(\n        TranslateAllocationNode(profile, it.second.get(), scripts));\n",
          "new_text": null,
          "old_line_content": "    current->children.push_back(",
          "new_line_content": "  }",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 23,
      "total_additions": 41,
      "total_deletions": 41,
      "total_api_changes": 105
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 8,
        "api_related_lines": 105,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          82,
          85,
          77,
          79
        ]
      }
    },
    "api_calls_before": 109,
    "api_calls_after": 110,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 5,
      "total_diff_lines": 24
    }
  }
}