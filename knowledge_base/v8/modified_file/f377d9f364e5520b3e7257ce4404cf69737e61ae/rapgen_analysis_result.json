{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/f377d9f364e5520b3e7257ce4404cf69737e61ae",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/f377d9f364e5520b3e7257ce4404cf69737e61ae/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/f377d9f364e5520b3e7257ce4404cf69737e61ae/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/f377d9f364e5520b3e7257ce4404cf69737e61ae/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 379,
          "old_api": "insert",
          "new_api": "std::make_pair(assessment, virtual_register)",
          "old_text": "seen.insert(block_id)",
          "new_text": "std::make_pair(assessment, virtual_register)",
          "old_line_content": "  seen.insert(block_id);",
          "new_line_content": "  worklist.push(std::make_pair(assessment, virtual_register));",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": "front",
          "new_api": "empty",
          "old_text": "worklist.front()",
          "new_text": "worklist.empty()",
          "old_line_content": "    auto work = worklist.front();",
          "new_line_content": "  while (!worklist.empty()) {",
          "content_same": false
        },
        {
          "line": 386,
          "old_api": "pop",
          "new_api": "operand",
          "old_text": "worklist.pop()",
          "new_text": "current_assessment->operand()",
          "old_line_content": "    worklist.pop();",
          "new_line_content": "    InstructionOperand current_operand = current_assessment->operand();",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": "size",
          "new_api": "origin",
          "old_text": "origin->phis().size()",
          "new_text": "current_assessment->origin()",
          "old_line_content": "    CHECK(origin->PredecessorCount() > 1 || origin->phis().size() > 0);",
          "new_line_content": "    const InstructionBlock* origin = current_assessment->origin();",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": "virtual_register",
          "new_api": "phis",
          "old_text": "candidate->virtual_register()",
          "new_text": "origin->phis()",
          "old_line_content": "      if (candidate->virtual_register() == current_virtual_register) {",
          "new_line_content": "    for (const PhiInstruction* candidate : origin->phis()) {",
          "content_same": false
        },
        {
          "line": 411,
          "old_api": "end",
          "new_api": "find",
          "old_text": "assessments_.end()",
          "new_text": "assessments_.find(pred)",
          "old_line_content": "      if (pred_assignment == assessments_.end()) {",
          "new_line_content": "      auto pred_assignment = assessments_.find(pred);",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": "IsLoopHeader",
          "new_api": "end",
          "old_text": "origin->IsLoopHeader()",
          "new_text": "assessments_.end()",
          "old_line_content": "        CHECK(origin->IsLoopHeader());",
          "new_line_content": "      if (pred_assignment == assessments_.end()) {",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": "find",
          "new_api": "IsLoopHeader",
          "old_text": "outstanding_assessments_.find(pred)",
          "new_text": "origin->IsLoopHeader()",
          "old_line_content": "        auto todo_iter = outstanding_assessments_.find(pred);",
          "new_line_content": "        CHECK(origin->IsLoopHeader());",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": "zone",
          "new_api": "end",
          "old_text": "zone()",
          "new_text": "outstanding_assessments_.end()",
          "old_line_content": "          set = new (zone()) DelayedAssessments(zone());",
          "new_line_content": "        if (todo_iter == outstanding_assessments_.end()) {",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": "std::make_pair(pred, set)",
          "new_api": "zone",
          "old_text": "std::make_pair(pred, set)",
          "new_text": "zone()",
          "old_line_content": "          outstanding_assessments_.insert(std::make_pair(pred, set));",
          "new_line_content": "          set = new (zone()) DelayedAssessments(zone());",
          "content_same": false
        },
        {
          "line": 427,
          "old_api": "end",
          "new_api": "find",
          "old_text": "pred_assessments->map().end()",
          "new_text": "pred_assessments->map().find(current_operand)",
          "old_line_content": "      CHECK(found_contribution != pred_assessments->map().end());",
          "new_line_content": "      auto found_contribution = pred_assessments->map().find(current_operand);",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": "end",
          "new_api": "PendingAssessment::cast(contribution)",
          "old_text": "seen.end()",
          "new_text": "PendingAssessment::cast(contribution)",
          "old_line_content": "          if (seen.find(pred) == seen.end()) {",
          "new_line_content": "          const PendingAssessment* next = PendingAssessment::cast(contribution);",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": "push",
          "new_api": "end",
          "old_text": "worklist.push({next, expected})",
          "new_text": "seen.end()",
          "old_line_content": "            worklist.push({next, expected});",
          "new_line_content": "          if (seen.find(pred) == seen.end()) {",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": "insert",
          "new_api": "push",
          "old_text": "seen.insert(pred)",
          "new_text": "worklist.push({next, expected})",
          "old_line_content": "            seen.insert(pred);",
          "new_line_content": "            worklist.push({next, expected});",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": "zone",
          "new_api": "map",
          "old_text": "zone()",
          "new_text": "current_assessments->map()",
          "old_line_content": "      new (zone()) FinalAssessment(virtual_register, assessment);",
          "new_line_content": "  current_assessments->map()[op] =",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": "CHECK_NOT_NULL",
          "new_api": "original_pending_assessment",
          "old_text": "CHECK_NOT_NULL(old)",
          "new_text": "assessment->original_pending_assessment()",
          "old_line_content": "  CHECK_NOT_NULL(old);",
          "new_line_content": "  const PendingAssessment* old = assessment->original_pending_assessment();",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": "origin",
          "new_api": "CHECK_NOT_NULL",
          "old_text": "old->origin()->rpo_number()",
          "new_text": "CHECK_NOT_NULL(old)",
          "old_line_content": "  RpoNumber old_block = old->origin()->rpo_number();",
          "new_line_content": "  CHECK_NOT_NULL(old);",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": "DCHECK_LE",
          "new_api": "origin",
          "old_text": "DCHECK_LE(old_block, block_id)",
          "new_text": "old->origin()->rpo_number()",
          "old_line_content": "  DCHECK_LE(old_block, block_id);",
          "new_line_content": "  RpoNumber old_block = old->origin()->rpo_number();",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": "FinalAssessment::cast(assessment)",
          "new_api": "ValidateFinalAssessment",
          "old_text": "FinalAssessment::cast(assessment)",
          "new_text": "ValidateFinalAssessment(block_id, op, current_assessments,\n                              FinalAssessment::cast(assessment),\n                              virtual_register)",
          "old_line_content": "                              FinalAssessment::cast(assessment),",
          "new_line_content": "      ValidateFinalAssessment(block_id, op, current_assessments,",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": "ValidatePendingAssessment",
          "new_api": "PendingAssessment::cast(assessment)",
          "old_text": "ValidatePendingAssessment(block_id, op, current_assessments, pending,\n                                virtual_register)",
          "new_text": "PendingAssessment::cast(assessment)",
          "old_line_content": "      ValidatePendingAssessment(block_id, op, current_assessments, pending,",
          "new_line_content": "      const PendingAssessment* pending = PendingAssessment::cast(assessment);",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": "size",
          "new_api": "empty",
          "old_text": "sequence()->instruction_blocks().size()",
          "new_text": "outstanding_assessments_.empty()",
          "old_line_content": "  const size_t block_count = sequence()->instruction_blocks().size();",
          "new_line_content": "  CHECK(outstanding_assessments_.empty());",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": "CreateForBlock",
          "new_api": "instruction_blocks",
          "old_text": "CreateForBlock(block)",
          "new_text": "sequence()->instruction_blocks()",
          "old_line_content": "    BlockAssessments* block_assessments = CreateForBlock(block);",
          "new_line_content": "        sequence()->instruction_blocks()[block_index];",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": "rpo_number",
          "new_api": "InputAt",
          "old_text": "block->rpo_number()",
          "new_text": "instr->InputAt(i)",
          "old_line_content": "        ValidateUse(block->rpo_number(), block_assessments, op,",
          "new_line_content": "        InstructionOperand op = *instr->InputAt(i);",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": "TempAt",
          "new_api": "TempCount",
          "old_text": "instr->TempAt(i)",
          "new_text": "instr->TempCount()",
          "old_line_content": "        block_assessments->Drop(*instr->TempAt(i));",
          "new_line_content": "      for (size_t i = 0; i < instr->TempCount(); ++i, ++count) {",
          "content_same": false
        },
        {
          "line": 535,
          "old_api": "DropRegisters",
          "new_api": "IsCall",
          "old_text": "block_assessments->DropRegisters()",
          "new_text": "instr->IsCall()",
          "old_line_content": "        block_assessments->DropRegisters();",
          "new_line_content": "      if (instr->IsCall()) {",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": "representation",
          "new_api": "OutputAt",
          "old_text": "reg_op->representation()",
          "new_text": "instr->OutputAt(i)",
          "old_line_content": "          MachineRepresentation rep = reg_op->representation();",
          "new_line_content": "              AllocatedOperand::cast(instr->OutputAt(i));",
          "content_same": false
        },
        {
          "line": 544,
          "old_api": "AllocatedOperand::New(\n              zone(), LocationOperand::LocationKind::STACK_SLOT, rep,\n              op_constraints[i].spilled_slot_)",
          "new_api": "representation",
          "old_text": "AllocatedOperand::New(\n              zone(), LocationOperand::LocationKind::STACK_SLOT, rep,\n              op_constraints[i].spilled_slot_)",
          "new_text": "reg_op->representation()",
          "old_line_content": "          const AllocatedOperand* stack_op = AllocatedOperand::New(",
          "new_line_content": "          MachineRepresentation rep = reg_op->representation();",
          "content_same": false
        },
        {
          "line": 545,
          "old_api": "zone",
          "new_api": "AllocatedOperand::New(\n              zone(), LocationOperand::LocationKind::STACK_SLOT, rep,\n              op_constraints[i].spilled_slot_)",
          "old_text": "zone()",
          "new_text": "AllocatedOperand::New(\n              zone(), LocationOperand::LocationKind::STACK_SLOT, rep,\n              op_constraints[i].spilled_slot_)",
          "old_line_content": "              zone(), LocationOperand::LocationKind::STACK_SLOT, rep,",
          "new_line_content": "          const AllocatedOperand* stack_op = AllocatedOperand::New(",
          "content_same": false
        },
        {
          "line": 556,
          "old_api": "end",
          "new_api": "rpo_number",
          "old_text": "outstanding_assessments_.end()",
          "new_text": "block->rpo_number()",
          "old_line_content": "    if (todo_iter == outstanding_assessments_.end()) continue;",
          "new_line_content": "    auto todo_iter = outstanding_assessments_.find(block->rpo_number());",
          "content_same": false
        },
        {
          "line": 562,
          "old_api": "end",
          "new_api": "find",
          "old_text": "block_assessments->map().end()",
          "new_text": "block_assessments->map().find(op)",
          "old_line_content": "      CHECK(found_op != block_assessments->map().end());",
          "new_line_content": "      auto found_op = block_assessments->map().find(op);",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": "kind",
          "new_api": "end",
          "old_text": "found_op->second->kind()",
          "new_text": "block_assessments->map().end()",
          "old_line_content": "      switch (found_op->second->kind()) {",
          "new_line_content": "      CHECK(found_op != block_assessments->map().end());",
          "content_same": false
        },
        {
          "line": 566,
          "old_api": "FinalAssessment::cast(found_op->second)",
          "new_api": "rpo_number",
          "old_text": "FinalAssessment::cast(found_op->second)",
          "new_text": "block->rpo_number()",
          "old_line_content": "                                  FinalAssessment::cast(found_op->second),",
          "new_line_content": "          ValidateFinalAssessment(block->rpo_number(), op, block_assessments,",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": "rpo_number",
          "new_api": "PendingAssessment::cast(found_op->second)",
          "old_text": "block->rpo_number()",
          "new_text": "PendingAssessment::cast(found_op->second)",
          "old_line_content": "          ValidatePendingAssessment(block->rpo_number(), op, block_assessments,",
          "new_line_content": "              PendingAssessment::cast(found_op->second);",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": "zone",
          "new_api": "map",
          "old_text": "zone()",
          "new_text": "block_assessments->map()",
          "old_line_content": "              new (zone()) FinalAssessment(vreg, pending);",
          "new_line_content": "          block_assessments->map()[op] =",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 513,
          "old_api": null,
          "new_api": "code_end",
          "old_text": null,
          "new_text": "block->code_end()",
          "old_line_content": "         ++instr_index) {",
          "new_line_content": "    for (int instr_index = block->code_start(); instr_index < block->code_end();",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": null,
          "new_api": "pop",
          "old_text": null,
          "new_text": "worklist.pop()",
          "old_line_content": "",
          "new_line_content": "    worklist.pop();",
          "content_same": false
        },
        {
          "line": 517,
          "old_api": null,
          "new_api": "PerformMoves",
          "old_text": null,
          "new_text": "block_assessments->PerformMoves(instr)",
          "old_line_content": "",
          "new_line_content": "      block_assessments->PerformMoves(instr);",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "origin->phis().size()",
          "old_line_content": "",
          "new_line_content": "    CHECK(origin->PredecessorCount() > 1 || origin->phis().size() > 0);",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": null,
          "new_api": "InputCount",
          "old_text": null,
          "new_text": "instr->InputCount()",
          "old_line_content": "        if (op_constraints[count].type_ == kImmediate ||",
          "new_line_content": "      for (size_t i = 0; i < instr->InputCount(); ++i, ++count) {",
          "content_same": false
        },
        {
          "line": 511,
          "old_api": null,
          "new_api": "CreateForBlock",
          "old_text": null,
          "new_text": "CreateForBlock(block)",
          "old_line_content": "",
          "new_line_content": "    BlockAssessments* block_assessments = CreateForBlock(block);",
          "content_same": false
        },
        {
          "line": 399,
          "old_api": null,
          "new_api": "virtual_register",
          "old_text": null,
          "new_text": "candidate->virtual_register()",
          "old_line_content": "        phi = candidate;",
          "new_line_content": "      if (candidate->virtual_register() == current_virtual_register) {",
          "content_same": false
        },
        {
          "line": 529,
          "old_api": null,
          "new_api": "rpo_number",
          "old_text": null,
          "new_text": "block->rpo_number()",
          "old_line_content": "                    virtual_register);",
          "new_line_content": "        ValidateUse(block->rpo_number(), block_assessments, op,",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": null,
          "new_api": "TempAt",
          "old_text": null,
          "new_text": "instr->TempAt(i)",
          "old_line_content": "      }",
          "new_line_content": "        block_assessments->Drop(*instr->TempAt(i));",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": null,
          "new_api": "predecessors",
          "old_text": null,
          "new_text": "origin->predecessors()",
          "old_line_content": "      int expected =",
          "new_line_content": "    for (RpoNumber pred : origin->predecessors()) {",
          "content_same": false
        },
        {
          "line": 536,
          "old_api": null,
          "new_api": "DropRegisters",
          "old_text": null,
          "new_text": "block_assessments->DropRegisters()",
          "old_line_content": "      }",
          "new_line_content": "        block_assessments->DropRegisters();",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": null,
          "new_api": "operands",
          "old_text": null,
          "new_text": "phi->operands()",
          "old_line_content": "",
          "new_line_content": "          phi != nullptr ? phi->operands()[op_index] : current_virtual_register;",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": null,
          "new_api": "OutputCount",
          "old_text": null,
          "new_text": "instr->OutputCount()",
          "old_line_content": "        int virtual_register = op_constraints[count].virtual_register_;",
          "new_line_content": "      for (size_t i = 0; i < instr->OutputCount(); ++i, ++count) {",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": null,
          "new_api": "OutputAt",
          "old_text": null,
          "new_text": "instr->OutputAt(i)",
          "old_line_content": "        if (op_constraints[count].type_ == kRegisterAndSlot) {",
          "new_line_content": "        block_assessments->AddDefinition(*instr->OutputAt(i), virtual_register);",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": null,
          "new_api": "find",
          "old_text": null,
          "new_text": "outstanding_assessments_.find(pred)",
          "old_line_content": "        DelayedAssessments* set = nullptr;",
          "new_line_content": "        auto todo_iter = outstanding_assessments_.find(pred);",
          "content_same": false
        },
        {
          "line": 546,
          "old_api": null,
          "new_api": "zone",
          "old_text": null,
          "new_text": "zone()",
          "old_line_content": "              op_constraints[i].spilled_slot_);",
          "new_line_content": "              zone(), LocationOperand::LocationKind::STACK_SLOT, rep,",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": null,
          "new_api": "std::make_pair(pred, set)",
          "old_text": null,
          "new_text": "std::make_pair(pred, set)",
          "old_line_content": "        } else {",
          "new_line_content": "          outstanding_assessments_.insert(std::make_pair(pred, set));",
          "content_same": false
        },
        {
          "line": 548,
          "old_api": null,
          "new_api": "AddDefinition",
          "old_text": null,
          "new_text": "block_assessments->AddDefinition(*stack_op, virtual_register)",
          "old_line_content": "        }",
          "new_line_content": "          block_assessments->AddDefinition(*stack_op, virtual_register);",
          "content_same": false
        },
        {
          "line": 422,
          "old_api": null,
          "new_api": "AddDelayedAssessment",
          "old_text": null,
          "new_text": "set->AddDelayedAssessment(current_operand, expected)",
          "old_line_content": "        continue;",
          "new_line_content": "        set->AddDelayedAssessment(current_operand, expected);",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": null,
          "new_api": "rpo_number",
          "old_text": null,
          "new_text": "block->rpo_number()",
          "old_line_content": "",
          "new_line_content": "    assessments_[block->rpo_number()] = block_assessments;",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "pred_assessments->map().end()",
          "old_line_content": "      Assessment* contribution = found_contribution->second;",
          "new_line_content": "      CHECK(found_contribution != pred_assessments->map().end());",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "outstanding_assessments_.end()",
          "old_line_content": "    DelayedAssessments* todo = todo_iter->second;",
          "new_line_content": "    if (todo_iter == outstanding_assessments_.end()) continue;",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": null,
          "new_api": "map",
          "old_text": null,
          "new_text": "todo->map()",
          "old_line_content": "      InstructionOperand op = pair.first;",
          "new_line_content": "    for (auto pair : todo->map()) {",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": null,
          "new_api": "kind",
          "old_text": null,
          "new_text": "contribution->kind()",
          "old_line_content": "        case Final:",
          "new_line_content": "      switch (contribution->kind()) {",
          "content_same": false
        },
        {
          "line": 433,
          "old_api": null,
          "new_api": "ValidateFinalAssessment",
          "old_text": null,
          "new_text": "ValidateFinalAssessment(\n              block_id, current_operand, current_assessments,\n              FinalAssessment::cast(contribution), expected)",
          "old_line_content": "              block_id, current_operand, current_assessments,",
          "new_line_content": "          ValidateFinalAssessment(",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": null,
          "new_api": "FinalAssessment::cast(contribution)",
          "old_text": null,
          "new_text": "FinalAssessment::cast(contribution)",
          "old_line_content": "          break;",
          "new_line_content": "              FinalAssessment::cast(contribution), expected);",
          "content_same": false
        },
        {
          "line": 564,
          "old_api": null,
          "new_api": "kind",
          "old_text": null,
          "new_text": "found_op->second->kind()",
          "old_line_content": "        case Final:",
          "new_line_content": "      switch (found_op->second->kind()) {",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": null,
          "new_api": "FinalAssessment::cast(found_op->second)",
          "old_text": null,
          "new_text": "FinalAssessment::cast(found_op->second)",
          "old_line_content": "                                  vreg);",
          "new_line_content": "                                  FinalAssessment::cast(found_op->second),",
          "content_same": false
        },
        {
          "line": 443,
          "old_api": null,
          "new_api": "insert",
          "old_text": null,
          "new_text": "seen.insert(pred)",
          "old_line_content": "          }",
          "new_line_content": "            seen.insert(pred);",
          "content_same": false
        },
        {
          "line": 573,
          "old_api": null,
          "new_api": "rpo_number",
          "old_text": null,
          "new_text": "block->rpo_number()",
          "old_line_content": "                                    pending, vreg);",
          "new_line_content": "          ValidatePendingAssessment(block->rpo_number(), op, block_assessments,",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": null,
          "new_api": "zone",
          "old_text": null,
          "new_text": "zone()",
          "old_line_content": "          break;",
          "new_line_content": "              new (zone()) FinalAssessment(vreg, pending);",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": null,
          "new_api": "zone",
          "old_text": null,
          "new_text": "zone()",
          "old_line_content": "}",
          "new_line_content": "      new (zone()) FinalAssessment(virtual_register, assessment);",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": null,
          "new_api": "virtual_register",
          "old_text": null,
          "new_text": "assessment->virtual_register()",
          "old_line_content": "  // If we have 2 phis with the exact same operand list, and the first phi is",
          "new_line_content": "  if (assessment->virtual_register() == virtual_register) return;",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": null,
          "new_api": "DCHECK_LE",
          "old_text": null,
          "new_text": "DCHECK_LE(old_block, block_id)",
          "old_line_content": "  BlockAssessments* old_block_assessments =",
          "new_line_content": "  DCHECK_LE(old_block, block_id);",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": null,
          "new_api": "ValidatePendingAssessment",
          "old_text": null,
          "new_text": "ValidatePendingAssessment(old_block, op, old_block_assessments, old,\n                            virtual_register)",
          "old_line_content": "                            virtual_register);",
          "new_line_content": "  ValidatePendingAssessment(old_block, op, old_block_assessments, old,",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": null,
          "new_api": "find",
          "old_text": null,
          "new_text": "current_assessments->map().find(op)",
          "old_line_content": "  // We should have seen this operand before.",
          "new_line_content": "  auto iterator = current_assessments->map().find(op);",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "current_assessments->map().end()",
          "old_line_content": "  Assessment* assessment = iterator->second;",
          "new_line_content": "  CHECK(iterator != current_assessments->map().end());",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": null,
          "new_api": "kind",
          "old_text": null,
          "new_text": "assessment->kind()",
          "old_line_content": "    case Final:",
          "new_line_content": "  switch (assessment->kind()) {",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": null,
          "new_api": "FinalAssessment::cast(assessment)",
          "old_text": null,
          "new_text": "FinalAssessment::cast(assessment)",
          "old_line_content": "                              virtual_register);",
          "new_line_content": "                              FinalAssessment::cast(assessment),",
          "content_same": false
        },
        {
          "line": 497,
          "old_api": null,
          "new_api": "ValidatePendingAssessment",
          "old_text": null,
          "new_text": "ValidatePendingAssessment(block_id, op, current_assessments, pending,\n                                virtual_register)",
          "old_line_content": "                                virtual_register);",
          "new_line_content": "      ValidatePendingAssessment(block_id, op, current_assessments, pending,",
          "content_same": false
        },
        {
          "line": 507,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "sequence()->instruction_blocks().size()",
          "old_line_content": "  for (size_t block_index = 0; block_index < block_count; ++block_index) {",
          "new_line_content": "  const size_t block_count = sequence()->instruction_blocks().size();",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": null,
          "new_api": "insert",
          "old_text": null,
          "new_text": "seen.insert(block_id)",
          "old_line_content": "",
          "new_line_content": "  seen.insert(block_id);",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": null,
          "new_api": "front",
          "old_text": null,
          "new_text": "worklist.front()",
          "old_line_content": "    const PendingAssessment* current_assessment = work.first;",
          "new_line_content": "    auto work = worklist.front();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 512,
          "old_api": "code_end",
          "new_api": null,
          "old_text": "block->code_end()",
          "new_text": null,
          "old_line_content": "    for (int instr_index = block->code_start(); instr_index < block->code_end();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": "operand",
          "new_api": null,
          "old_text": "current_assessment->operand()",
          "new_text": null,
          "old_line_content": "    InstructionOperand current_operand = current_assessment->operand();",
          "new_line_content": "    int current_virtual_register = work.second;",
          "content_same": false
        },
        {
          "line": 509,
          "old_api": "instruction_blocks",
          "new_api": null,
          "old_text": "sequence()->instruction_blocks()",
          "new_text": null,
          "old_line_content": "        sequence()->instruction_blocks()[block_index];",
          "new_line_content": "    const InstructionBlock* block =",
          "content_same": false
        },
        {
          "line": 516,
          "old_api": "PerformMoves",
          "new_api": null,
          "old_text": "block_assessments->PerformMoves(instr)",
          "new_text": null,
          "old_line_content": "      block_assessments->PerformMoves(instr);",
          "new_line_content": "      const Instruction* instr = instr_constraint.instruction_;",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "origin",
          "new_api": null,
          "old_text": "current_assessment->origin()",
          "new_text": null,
          "old_line_content": "    const InstructionBlock* origin = current_assessment->origin();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": "InputCount",
          "new_api": null,
          "old_text": "instr->InputCount()",
          "new_text": null,
          "old_line_content": "      for (size_t i = 0; i < instr->InputCount(); ++i, ++count) {",
          "new_line_content": "      size_t count = 0;",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": "phis",
          "new_api": null,
          "old_text": "origin->phis()",
          "new_text": null,
          "old_line_content": "    for (const PhiInstruction* candidate : origin->phis()) {",
          "new_line_content": "    const PhiInstruction* phi = nullptr;",
          "content_same": false
        },
        {
          "line": 527,
          "old_api": "InputAt",
          "new_api": null,
          "old_text": "instr->InputAt(i)",
          "new_text": null,
          "old_line_content": "        InstructionOperand op = *instr->InputAt(i);",
          "new_line_content": "        int virtual_register = op_constraints[count].virtual_register_;",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": "TempCount",
          "new_api": null,
          "old_text": "instr->TempCount()",
          "new_text": null,
          "old_line_content": "      for (size_t i = 0; i < instr->TempCount(); ++i, ++count) {",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": "predecessors",
          "new_api": null,
          "old_text": "origin->predecessors()",
          "new_text": null,
          "old_line_content": "    for (RpoNumber pred : origin->predecessors()) {",
          "new_line_content": "    int op_index = 0;",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": "IsCall",
          "new_api": null,
          "old_text": "instr->IsCall()",
          "new_text": null,
          "old_line_content": "      if (instr->IsCall()) {",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 407,
          "old_api": "operands",
          "new_api": null,
          "old_text": "phi->operands()",
          "new_text": null,
          "old_line_content": "          phi != nullptr ? phi->operands()[op_index] : current_virtual_register;",
          "new_line_content": "      int expected =",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": "OutputCount",
          "new_api": null,
          "old_text": "instr->OutputCount()",
          "new_text": null,
          "old_line_content": "      for (size_t i = 0; i < instr->OutputCount(); ++i, ++count) {",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 410,
          "old_api": "find",
          "new_api": null,
          "old_text": "assessments_.find(pred)",
          "new_text": null,
          "old_line_content": "      auto pred_assignment = assessments_.find(pred);",
          "new_line_content": "      ++op_index;",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": "OutputAt",
          "new_api": null,
          "old_text": "instr->OutputAt(i)",
          "new_text": null,
          "old_line_content": "        block_assessments->AddDefinition(*instr->OutputAt(i), virtual_register);",
          "new_line_content": "        int virtual_register = op_constraints[count].virtual_register_;",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": "OutputAt",
          "new_api": null,
          "old_text": "instr->OutputAt(i)",
          "new_text": null,
          "old_line_content": "              AllocatedOperand::cast(instr->OutputAt(i));",
          "new_line_content": "          const AllocatedOperand* reg_op =",
          "content_same": false
        },
        {
          "line": 415,
          "old_api": "end",
          "new_api": null,
          "old_text": "outstanding_assessments_.end()",
          "new_text": null,
          "old_line_content": "        if (todo_iter == outstanding_assessments_.end()) {",
          "new_line_content": "        DelayedAssessments* set = nullptr;",
          "content_same": false
        },
        {
          "line": 547,
          "old_api": "AddDefinition",
          "new_api": null,
          "old_text": "block_assessments->AddDefinition(*stack_op, virtual_register)",
          "new_text": null,
          "old_line_content": "          block_assessments->AddDefinition(*stack_op, virtual_register);",
          "new_line_content": "              op_constraints[i].spilled_slot_);",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": "AddDelayedAssessment",
          "new_api": null,
          "old_text": "set->AddDelayedAssessment(current_operand, expected)",
          "new_text": null,
          "old_line_content": "        set->AddDelayedAssessment(current_operand, expected);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": "rpo_number",
          "new_api": null,
          "old_text": "block->rpo_number()",
          "new_text": null,
          "old_line_content": "    assessments_[block->rpo_number()] = block_assessments;",
          "new_line_content": "    // assessments, ValidatePendingAssessment should see this block, too.",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": "find",
          "new_api": null,
          "old_text": "pred_assessments->map().find(current_operand)",
          "new_text": null,
          "old_line_content": "      auto found_contribution = pred_assessments->map().find(current_operand);",
          "new_line_content": "      const BlockAssessments* pred_assessments = pred_assignment->second;",
          "content_same": false
        },
        {
          "line": 555,
          "old_api": "rpo_number",
          "new_api": null,
          "old_text": "block->rpo_number()",
          "new_text": null,
          "old_line_content": "    auto todo_iter = outstanding_assessments_.find(block->rpo_number());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 558,
          "old_api": "map",
          "new_api": null,
          "old_text": "todo->map()",
          "new_text": null,
          "old_line_content": "    for (auto pair : todo->map()) {",
          "new_line_content": "    DelayedAssessments* todo = todo_iter->second;",
          "content_same": false
        },
        {
          "line": 430,
          "old_api": "kind",
          "new_api": null,
          "old_text": "contribution->kind()",
          "new_text": null,
          "old_line_content": "      switch (contribution->kind()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": "ValidateFinalAssessment",
          "new_api": null,
          "old_text": "ValidateFinalAssessment(\n              block_id, current_operand, current_assessments,\n              FinalAssessment::cast(contribution), expected)",
          "new_text": null,
          "old_line_content": "          ValidateFinalAssessment(",
          "new_line_content": "        case Final:",
          "content_same": false
        },
        {
          "line": 561,
          "old_api": "find",
          "new_api": null,
          "old_text": "block_assessments->map().find(op)",
          "new_text": null,
          "old_line_content": "      auto found_op = block_assessments->map().find(op);",
          "new_line_content": "      int vreg = pair.second;",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": "FinalAssessment::cast(contribution)",
          "new_api": null,
          "old_text": "FinalAssessment::cast(contribution)",
          "new_text": null,
          "old_line_content": "              FinalAssessment::cast(contribution), expected);",
          "new_line_content": "              block_id, current_operand, current_assessments,",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": "rpo_number",
          "new_api": null,
          "old_text": "block->rpo_number()",
          "new_text": null,
          "old_line_content": "          ValidateFinalAssessment(block->rpo_number(), op, block_assessments,",
          "new_line_content": "        case Final:",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": "PendingAssessment::cast(contribution)",
          "new_api": null,
          "old_text": "PendingAssessment::cast(contribution)",
          "new_text": null,
          "old_line_content": "          const PendingAssessment* next = PendingAssessment::cast(contribution);",
          "new_line_content": "          // the inner one never being used - other than for carrying the value.",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": "PendingAssessment::cast(found_op->second)",
          "new_api": null,
          "old_text": "PendingAssessment::cast(found_op->second)",
          "new_text": null,
          "old_line_content": "              PendingAssessment::cast(found_op->second);",
          "new_line_content": "          const PendingAssessment* pending =",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": "map",
          "new_api": null,
          "old_text": "block_assessments->map()",
          "new_text": null,
          "old_line_content": "          block_assessments->map()[op] =",
          "new_line_content": "                                    pending, vreg);",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": "map",
          "new_api": null,
          "old_text": "current_assessments->map()",
          "new_text": null,
          "old_line_content": "  current_assessments->map()[op] =",
          "new_line_content": "  // If everything checks out, we may make the assessment.",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "virtual_register",
          "new_api": null,
          "old_text": "assessment->virtual_register()",
          "new_text": null,
          "old_line_content": "  if (assessment->virtual_register() == virtual_register) return;",
          "new_line_content": "    int virtual_register) {",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": "original_pending_assessment",
          "new_api": null,
          "old_text": "assessment->original_pending_assessment()",
          "new_text": null,
          "old_line_content": "  const PendingAssessment* old = assessment->original_pending_assessment();",
          "new_line_content": "  // is virtual_register.",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": "ValidatePendingAssessment",
          "new_api": null,
          "old_text": "ValidatePendingAssessment(old_block, op, old_block_assessments, old,\n                            virtual_register)",
          "new_text": null,
          "old_line_content": "  ValidatePendingAssessment(old_block, op, old_block_assessments, old,",
          "new_line_content": "      old_block == block_id ? current_assessments : assessments_[old_block];",
          "content_same": false
        },
        {
          "line": 483,
          "old_api": "find",
          "new_api": null,
          "old_text": "current_assessments->map().find(op)",
          "new_text": null,
          "old_line_content": "  auto iterator = current_assessments->map().find(op);",
          "new_line_content": "    InstructionOperand op, int virtual_register) {",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": "end",
          "new_api": null,
          "old_text": "current_assessments->map().end()",
          "new_text": null,
          "old_line_content": "  CHECK(iterator != current_assessments->map().end());",
          "new_line_content": "  // We should have seen this operand before.",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": "kind",
          "new_api": null,
          "old_text": "assessment->kind()",
          "new_text": null,
          "old_line_content": "  switch (assessment->kind()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": "ValidateFinalAssessment",
          "new_api": null,
          "old_text": "ValidateFinalAssessment(block_id, op, current_assessments,\n                              FinalAssessment::cast(assessment),\n                              virtual_register)",
          "new_text": null,
          "old_line_content": "      ValidateFinalAssessment(block_id, op, current_assessments,",
          "new_line_content": "    case Final:",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": "PendingAssessment::cast(assessment)",
          "new_api": null,
          "old_text": "PendingAssessment::cast(assessment)",
          "new_text": null,
          "old_line_content": "      const PendingAssessment* pending = PendingAssessment::cast(assessment);",
          "new_line_content": "    case Pending: {",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": "empty",
          "new_api": null,
          "old_text": "assessments_.empty()",
          "new_text": null,
          "old_line_content": "  CHECK(assessments_.empty());",
          "new_line_content": "void RegisterAllocatorVerifier::VerifyGapMoves() {",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": "std::make_pair(assessment, virtual_register)",
          "new_api": null,
          "old_text": "std::make_pair(assessment, virtual_register)",
          "new_text": null,
          "old_line_content": "  worklist.push(std::make_pair(assessment, virtual_register));",
          "new_line_content": "  ZoneSet<RpoNumber> seen(&local_zone);",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": "empty",
          "new_api": null,
          "old_text": "worklist.empty()",
          "new_text": null,
          "old_line_content": "  while (!worklist.empty()) {",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 34,
      "total_additions": 43,
      "total_deletions": 43,
      "total_api_changes": 120
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 120,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          376,
          377
        ]
      }
    },
    "api_calls_before": 310,
    "api_calls_after": 310,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 2,
      "total_diff_lines": 17
    }
  }
}