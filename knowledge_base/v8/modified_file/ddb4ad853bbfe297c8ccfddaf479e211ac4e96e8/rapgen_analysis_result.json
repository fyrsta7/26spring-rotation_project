{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/ddb4ad853bbfe297c8ccfddaf479e211ac4e96e8",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/ddb4ad853bbfe297c8ccfddaf479e211ac4e96e8/before.h",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/ddb4ad853bbfe297c8ccfddaf479e211ac4e96e8/after.h",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/ddb4ad853bbfe297c8ccfddaf479e211ac4e96e8/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 143,
          "old_api": "IncrementPredecessorCount",
          "new_api": "end",
          "old_text": "IncrementPredecessorCount(succ)",
          "new_text": "block->end()->SuccessorAt(i)",
          "old_line_content": "        IncrementPredecessorCount(succ);",
          "new_line_content": "        HBasicBlock* succ = block->end()->SuccessorAt(i);",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": "StateAt",
          "new_api": "IncrementPredecessorCount",
          "old_text": "StateAt(succ)",
          "new_text": "IncrementPredecessorCount(succ)",
          "old_line_content": "        if (StateAt(succ) == NULL) {",
          "new_line_content": "        IncrementPredecessorCount(succ);",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": "StateAt",
          "new_api": "SetStateAt",
          "old_text": "StateAt(succ)",
          "new_text": "SetStateAt(succ, state)",
          "old_line_content": "          SetStateAt(succ, state->Merge(succ, StateAt(succ), zone_));",
          "new_line_content": "            SetStateAt(succ, state);",
          "content_same": false
        },
        {
          "line": 167,
          "old_api": "loop_information",
          "new_api": "block_id",
          "old_text": "block->loop_information()",
          "new_text": "block->block_id()",
          "old_line_content": "    HLoopInformation* loop = block->loop_information();",
          "new_line_content": "    Effects* effects = loop_effects_[block->block_id()];",
          "content_same": false
        },
        {
          "line": 171,
          "old_api": "blocks",
          "new_api": "block_id",
          "old_text": "graph_->blocks()->at(i)",
          "new_text": "block->block_id()",
          "old_line_content": "      HBasicBlock* member = graph_->blocks()->at(i);",
          "new_line_content": "    loop_effects_[block->block_id()] = effects;",
          "content_same": false
        },
        {
          "line": 172,
          "old_api": "IsLoopHeader",
          "new_api": "Disabled",
          "old_text": "member->IsLoopHeader()",
          "new_text": "effects->Disabled()",
          "old_line_content": "      if (i != block->block_id() && member->IsLoopHeader()) {",
          "new_line_content": "    if (effects->Disabled()) return effects;  // No effects for this analysis.",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": "ComputeLoopEffects",
          "new_api": "GetLastBackEdge",
          "old_text": "ComputeLoopEffects(member)",
          "new_text": "loop->GetLastBackEdge()->block_id()",
          "old_line_content": "        Effects* nested = ComputeLoopEffects(member);",
          "new_line_content": "    int end = loop->GetLastBackEdge()->block_id();",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": "loop_information",
          "new_api": "blocks",
          "old_text": "member->loop_information()->GetLastBackEdge()->block_id()",
          "new_text": "graph_->blocks()->at(i)",
          "old_line_content": "        i = member->loop_information()->GetLastBackEdge()->block_id();",
          "new_line_content": "      HBasicBlock* member = graph_->blocks()->at(i);",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": "current_loop",
          "new_api": "loop_information",
          "old_text": "member->current_loop()",
          "new_text": "member->loop_information()->parent_loop()",
          "old_line_content": "        ASSERT(member->current_loop() == loop);",
          "new_line_content": "        ASSERT(member->loop_information()->parent_loop() == loop);",
          "content_same": false
        },
        {
          "line": 182,
          "old_api": "Advance",
          "new_api": "ComputeLoopEffects",
          "old_text": "it.Advance()",
          "new_text": "ComputeLoopEffects(member)",
          "old_line_content": "        for (HInstructionIterator it(member); !it.Done(); it.Advance()) {",
          "new_line_content": "        Effects* nested = ComputeLoopEffects(member);",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": "Current",
          "new_api": "Union",
          "old_text": "it.Current()",
          "new_text": "effects->Union(nested, zone_)",
          "old_line_content": "          effects->Process(it.Current(), zone_);",
          "new_line_content": "        effects->Union(nested, zone_);",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": "block_id",
          "new_api": "blocks",
          "old_text": "block->block_id()",
          "new_text": "graph_->blocks()->length()",
          "old_line_content": "    ASSERT(block->predecessors()->length() == pred_counts_[block->block_id()]);",
          "new_line_content": "    pred_counts_.AddBlock(0, graph_->blocks()->length(), zone_);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 145,
          "old_api": null,
          "new_api": "StateAt",
          "old_text": null,
          "new_text": "StateAt(succ)",
          "old_line_content": "          // This is the first state to reach the successor.",
          "new_line_content": "        if (StateAt(succ) == NULL) {",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": null,
          "new_api": "predecessors",
          "old_text": null,
          "new_text": "succ->predecessors()->length()",
          "old_line_content": "        } else {",
          "new_line_content": "          if (max == 1 && succ->predecessors()->length() == 1) {",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": null,
          "new_api": "Copy",
          "old_text": null,
          "new_text": "state->Copy(succ, zone_)",
          "old_line_content": "    }",
          "new_line_content": "            SetStateAt(succ, state->Copy(succ, zone_));",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": null,
          "new_api": "StateAt",
          "old_text": null,
          "new_text": "StateAt(succ)",
          "old_line_content": "  // Computes and caches the loop effects for the loop which has the given",
          "new_line_content": "          SetStateAt(succ, state->Merge(succ, StateAt(succ), zone_));",
          "content_same": false
        },
        {
          "line": 166,
          "old_api": null,
          "new_api": "IsLoopHeader",
          "old_text": null,
          "new_text": "block->IsLoopHeader()",
          "old_line_content": "",
          "new_line_content": "    ASSERT(block->IsLoopHeader());",
          "content_same": false
        },
        {
          "line": 177,
          "old_api": null,
          "new_api": "block_id",
          "old_text": null,
          "new_text": "block->block_id()",
          "old_line_content": "        // Skip the nested loop's blocks.",
          "new_line_content": "    for (int i = block->block_id(); i <= end; i++) {",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": null,
          "new_api": "IsLoopHeader",
          "old_text": null,
          "new_text": "member->IsLoopHeader()",
          "old_line_content": "      } else {",
          "new_line_content": "      if (i != block->block_id() && member->IsLoopHeader()) {",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": null,
          "new_api": "loop_information",
          "old_text": null,
          "new_text": "member->loop_information()->GetLastBackEdge()->block_id()",
          "old_line_content": "      }",
          "new_line_content": "        i = member->loop_information()->GetLastBackEdge()->block_id();",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": null,
          "new_api": "current_loop",
          "old_text": null,
          "new_text": "member->current_loop()",
          "old_line_content": "  }",
          "new_line_content": "        ASSERT(member->current_loop() == loop);",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": null,
          "new_api": "Advance",
          "old_text": null,
          "new_text": "it.Advance()",
          "old_line_content": "",
          "new_line_content": "        for (HInstructionIterator it(member); !it.Done(); it.Advance()) {",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": null,
          "new_api": "Current",
          "old_text": null,
          "new_text": "it.Current()",
          "old_line_content": "  inline bool SkipNonDominatedBlock(HBasicBlock* root, HBasicBlock* other) {",
          "new_line_content": "          effects->Process(it.Current(), zone_);",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": null,
          "new_api": "block_id",
          "old_text": null,
          "new_text": "root->block_id()",
          "old_line_content": "  }",
          "new_line_content": "    if (root->block_id() == 0) return false;  // Visit the whole graph.",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": null,
          "new_api": "Dominates",
          "old_text": null,
          "new_text": "root->Dominates(other)",
          "old_line_content": "  inline void SetStateAt(HBasicBlock* block, State* state) {",
          "new_line_content": "    return !root->Dominates(other);           // Only visit dominated blocks.",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": null,
          "new_api": "block_id",
          "old_text": null,
          "new_text": "block->block_id()",
          "old_line_content": "  inline void InitializeStates() {",
          "new_line_content": "    return block_states_.at(block->block_id());",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": null,
          "new_api": "block_id",
          "old_text": null,
          "new_text": "block->block_id()",
          "old_line_content": "#endif",
          "new_line_content": "    block_states_.Set(block->block_id(), state);",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": null,
          "new_api": "Rewind",
          "old_text": null,
          "new_text": "pred_counts_.Rewind(0)",
          "old_line_content": "  inline void CheckPredecessorCount(HBasicBlock* block) {",
          "new_line_content": "    pred_counts_.Rewind(0);",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": null,
          "new_api": "Rewind",
          "old_text": null,
          "new_text": "block_states_.Rewind(0)",
          "old_line_content": "",
          "new_line_content": "    block_states_.Rewind(0);",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": null,
          "new_api": "blocks",
          "old_text": null,
          "new_text": "graph_->blocks()->length()",
          "old_line_content": "  inline void IncrementPredecessorCount(HBasicBlock* block) {",
          "new_line_content": "    block_states_.AddBlock(NULL, graph_->blocks()->length(), zone_);",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": null,
          "new_api": "block_id",
          "old_text": null,
          "new_text": "block->block_id()",
          "old_line_content": "  }",
          "new_line_content": "    ASSERT(block->predecessors()->length() == pred_counts_[block->block_id()]);",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": null,
          "new_api": "block_id",
          "old_text": null,
          "new_text": "block->block_id()",
          "old_line_content": "  ZoneList<int> pred_counts_;        // Finished predecessors (by block id).",
          "new_line_content": "    pred_counts_[block->block_id()]++;",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 160,
          "old_api": "block_id",
          "new_api": null,
          "old_text": "block->block_id()",
          "new_text": null,
          "old_line_content": "    Effects* effects = loop_effects_[block->block_id()];",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "block_id",
          "new_api": null,
          "old_text": "root->block_id()",
          "new_text": null,
          "old_line_content": "    if (root->block_id() == 0) return false;  // Visit the whole graph.",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": "Dominates",
          "new_api": null,
          "old_text": "root->Dominates(other)",
          "new_text": null,
          "old_line_content": "    return !root->Dominates(other);           // Only visit dominated blocks.",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 164,
          "old_api": "block_id",
          "new_api": null,
          "old_text": "block->block_id()",
          "new_text": null,
          "old_line_content": "    loop_effects_[block->block_id()] = effects;",
          "new_line_content": "  // block as its loop header.",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": "Disabled",
          "new_api": null,
          "old_text": "effects->Disabled()",
          "new_text": null,
          "old_line_content": "    if (effects->Disabled()) return effects;  // No effects for this analysis.",
          "new_line_content": "  Effects* ComputeLoopEffects(HBasicBlock* block) {",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": "block_id",
          "new_api": null,
          "old_text": "block->block_id()",
          "new_text": null,
          "old_line_content": "    return block_states_.at(block->block_id());",
          "new_line_content": "  inline bool SkipNonDominatedBlock(HBasicBlock* root, HBasicBlock* other) {",
          "content_same": false
        },
        {
          "line": 168,
          "old_api": "GetLastBackEdge",
          "new_api": null,
          "old_text": "loop->GetLastBackEdge()->block_id()",
          "new_text": null,
          "old_line_content": "    int end = loop->GetLastBackEdge()->block_id();",
          "new_line_content": "    if (effects != NULL) return effects;  // Already analyzed this loop.",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "block_id",
          "new_api": null,
          "old_text": "block->block_id()",
          "new_text": null,
          "old_line_content": "    block_states_.Set(block->block_id(), state);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 170,
          "old_api": "block_id",
          "new_api": null,
          "old_text": "block->block_id()",
          "new_text": null,
          "old_line_content": "    for (int i = block->block_id(); i <= end; i++) {",
          "new_line_content": "    effects = new(zone_) Effects(zone_);",
          "content_same": false
        },
        {
          "line": 142,
          "old_api": "end",
          "new_api": null,
          "old_text": "block->end()->SuccessorAt(i)",
          "new_text": null,
          "old_line_content": "        HBasicBlock* succ = block->end()->SuccessorAt(i);",
          "new_line_content": "      for (int i = 0; i < max; i++) {",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "Rewind",
          "new_api": null,
          "old_text": "pred_counts_.Rewind(0)",
          "new_text": null,
          "old_line_content": "    pred_counts_.Rewind(0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": "Union",
          "new_api": null,
          "old_text": "effects->Union(nested, zone_)",
          "new_text": null,
          "old_line_content": "        effects->Union(nested, zone_);",
          "new_line_content": "    // Process the blocks between the header and the end.",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": "blocks",
          "new_api": null,
          "old_text": "graph_->blocks()->length()",
          "new_text": null,
          "old_line_content": "    pred_counts_.AddBlock(0, graph_->blocks()->length(), zone_);",
          "new_line_content": "  inline void SetStateAt(HBasicBlock* block, State* state) {",
          "content_same": false
        },
        {
          "line": 146,
          "old_api": "Copy",
          "new_api": null,
          "old_text": "state->Copy(succ, zone_)",
          "new_text": null,
          "old_line_content": "          SetStateAt(succ, state->Copy(succ, zone_));",
          "new_line_content": "          // This is the first state to reach the successor.",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": "Rewind",
          "new_api": null,
          "old_text": "block_states_.Rewind(0)",
          "new_text": null,
          "old_line_content": "    block_states_.Rewind(0);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": "blocks",
          "new_api": null,
          "old_text": "graph_->blocks()->length()",
          "new_text": null,
          "old_line_content": "    block_states_.AddBlock(NULL, graph_->blocks()->length(), zone_);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": "block_id",
          "new_api": null,
          "old_text": "block->block_id()",
          "new_text": null,
          "old_line_content": "    pred_counts_[block->block_id()]++;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 159,
          "old_api": "IsLoopHeader",
          "new_api": null,
          "old_text": "block->IsLoopHeader()",
          "new_text": null,
          "old_line_content": "    ASSERT(block->IsLoopHeader());",
          "new_line_content": "    }",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 12,
      "total_additions": 20,
      "total_deletions": 18,
      "total_api_changes": 50
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 10,
        "api_related_lines": 50,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          141,
          148,
          150,
          151,
          153
        ]
      }
    },
    "api_calls_before": 88,
    "api_calls_after": 91,
    "diff_info": {
      "added_lines": 9,
      "removed_lines": 2,
      "total_diff_lines": 27
    }
  }
}