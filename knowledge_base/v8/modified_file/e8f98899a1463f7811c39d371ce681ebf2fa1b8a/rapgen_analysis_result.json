{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/e8f98899a1463f7811c39d371ce681ebf2fa1b8a",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/e8f98899a1463f7811c39d371ce681ebf2fa1b8a/before.h",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/e8f98899a1463f7811c39d371ce681ebf2fa1b8a/after.h",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/e8f98899a1463f7811c39d371ce681ebf2fa1b8a/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 584,
          "old_api": "reinterpret_cast<const char*>(start)",
          "new_api": "explicit",
          "old_text": "reinterpret_cast<const char*>(start)",
          "new_text": "explicit",
          "old_line_content": "      : TruncatedUserString(reinterpret_cast<const char*>(start), len) {}",
          "new_line_content": "  explicit TruncatedUserString(Vector<T> name)",
          "content_same": false
        },
        {
          "line": 588,
          "old_api": "static_cast<size_t>(kMaxLen)",
          "new_api": "reinterpret_cast<const char*>(start)",
          "old_text": "static_cast<size_t>(kMaxLen)",
          "new_text": "reinterpret_cast<const char*>(start)",
          "old_line_content": "    if (len > static_cast<size_t>(kMaxLen)) {",
          "new_line_content": "      : TruncatedUserString(reinterpret_cast<const char*>(start), len) {}",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 384,
          "old_api": null,
          "new_api": "handle",
          "old_text": null,
          "new_text": "handle(*default_function_code_, isolate)",
          "old_line_content": "  // the wasm invariant that it should be divisible by kPageSize - for test.",
          "new_line_content": "    default_function_code_ = handle(*default_function_code_, isolate);",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "name.length()",
          "old_line_content": "",
          "new_line_content": "      : TruncatedUserString(name.start(), name.length()) {}",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": null,
          "new_api": "ModuleEnv",
          "old_text": null,
          "new_text": "ModuleEnv()",
          "old_line_content": "  // indirect function tables.",
          "new_line_content": "  ModuleEnv() = default;",
          "content_same": false
        },
        {
          "line": 591,
          "old_api": null,
          "new_api": "static_cast<int>(len)",
          "old_text": null,
          "new_text": "static_cast<int>(len)",
          "old_line_content": "      start_ = buffer_;",
          "new_line_content": "      : start_(start), length_(std::min(kMaxLen, static_cast<int>(len))) {",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": null,
          "new_api": "static_cast<size_t>(kMaxLen)",
          "old_text": null,
          "new_text": "static_cast<size_t>(kMaxLen)",
          "old_line_content": "    }",
          "new_line_content": "    if (len > static_cast<size_t>(kMaxLen)) {",
          "content_same": false
        },
        {
          "line": 593,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(buffer_, start, kMaxLen - 3)",
          "old_line_content": "  }",
          "new_line_content": "      memcpy(buffer_, start, kMaxLen - 3);",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(buffer_ + kMaxLen - 3, '.', 3)",
          "old_line_content": "",
          "new_line_content": "      memset(buffer_ + kMaxLen - 3, '.', 3);",
          "content_same": false
        },
        {
          "line": 367,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "function_code_.size()",
          "old_line_content": "    return function_code_[index];",
          "new_line_content": "    if (index < function_code_.size()) {",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": null,
          "new_api": "is_shared",
          "old_text": null,
          "new_text": "buffer->is_shared()",
          "old_line_content": "  return SharedFlag::kNotShared;",
          "new_line_content": "  if (!buffer.is_null() && buffer->is_shared()) {",
          "content_same": false
        },
        {
          "line": 535,
          "old_api": null,
          "new_api": "DCHECK",
          "old_text": null,
          "new_text": "DCHECK(FLAG_experimental_wasm_threads)",
          "old_line_content": "}",
          "new_line_content": "    DCHECK(FLAG_experimental_wasm_threads);",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": null,
          "new_api": "handle",
          "old_text": null,
          "new_text": "handle(*code, isolate)",
          "old_line_content": "",
          "new_line_content": "      code = handle(*code, isolate);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 580,
          "old_api": "explicit",
          "new_api": null,
          "old_text": "explicit",
          "new_text": null,
          "old_line_content": "  explicit TruncatedUserString(Vector<T> name)",
          "new_line_content": "  static_assert(kMaxLen >= 4, \"minimum length is 4 (length of '...' plus one)\");",
          "content_same": false
        },
        {
          "line": 581,
          "old_api": "length",
          "new_api": null,
          "old_text": "name.length()",
          "new_text": null,
          "old_line_content": "      : TruncatedUserString(name.start(), name.length()) {}",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": "ModuleEnv",
          "new_api": null,
          "old_text": "ModuleEnv()",
          "new_text": null,
          "old_line_content": "  ModuleEnv() = default;",
          "new_line_content": "  // The derived class is responsible for correctly setting up the",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": "size",
          "new_api": null,
          "old_text": "module->functions.size()",
          "new_text": null,
          "old_line_content": "        function_code_(module->functions.size(), default_function_code),",
          "new_line_content": "        default_function_code_(default_function_code),",
          "content_same": false
        },
        {
          "line": 587,
          "old_api": "static_cast<int>(len)",
          "new_api": null,
          "old_text": "static_cast<int>(len)",
          "new_text": null,
          "old_line_content": "      : start_(start), length_(std::min(kMaxLen, static_cast<int>(len))) {",
          "new_line_content": "  TruncatedUserString(const byte* start, size_t len)",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(buffer_, start, kMaxLen - 3)",
          "new_text": null,
          "old_line_content": "      memcpy(buffer_, start, kMaxLen - 3);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(buffer_ + kMaxLen - 3, '.', 3)",
          "new_text": null,
          "old_line_content": "      memset(buffer_ + kMaxLen - 3, '.', 3);",
          "new_line_content": "  TruncatedUserString(const char* start, size_t len)",
          "content_same": false
        },
        {
          "line": 530,
          "old_api": "is_shared",
          "new_api": null,
          "old_text": "buffer->is_shared()",
          "new_text": null,
          "old_line_content": "  if (!buffer.is_null() && buffer->is_shared()) {",
          "new_line_content": "         !FLAG_experimental_wasm_threads;",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": "DCHECK",
          "new_api": null,
          "old_text": "DCHECK(FLAG_experimental_wasm_threads)",
          "new_text": null,
          "old_line_content": "    DCHECK(FLAG_experimental_wasm_threads);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": "handle",
          "new_api": null,
          "old_text": "handle(*table, isolate)",
          "new_text": null,
          "old_line_content": "      table = handle(*table, isolate);",
          "new_line_content": "  // TODO(mtrofin): this is async compilation-specific. Move this out.",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 2,
      "total_additions": 11,
      "total_deletions": 10,
      "total_api_changes": 23
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 12,
        "api_related_lines": 23,
        "non_api_lines": 9,
        "non_api_line_numbers": [
          368,
          369,
          370,
          401,
          400,
          402,
          404,
          405,
          409
        ]
      }
    },
    "api_calls_before": 81,
    "api_calls_after": 82,
    "diff_info": {
      "added_lines": 9,
      "removed_lines": 5,
      "total_diff_lines": 50
    }
  }
}