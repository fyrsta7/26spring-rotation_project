{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/3d157f7ff6191dd2c5570923e5e5ba0a7f4a1e18",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/3d157f7ff6191dd2c5570923e5e5ba0a7f4a1e18/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/3d157f7ff6191dd2c5570923e5e5ba0a7f4a1e18/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/3d157f7ff6191dd2c5570923e5e5ba0a7f4a1e18/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 323,
          "old_api": "zone",
          "new_api": "InputAt",
          "old_text": "zone()",
          "new_text": "arith->InputAt(1)",
          "old_line_content": "      InductionVariable(phi, arith, incr, initial, zone(), arithmeticType);",
          "new_line_content": "  Node* incr = arith->InputAt(1);",
          "content_same": false
        },
        {
          "line": 329,
          "old_api": "use_edges",
          "new_api": "op",
          "old_text": "loop->use_edges()",
          "new_text": "loop->op()->ControlInputCount()",
          "old_line_content": "  for (Edge edge : loop->use_edges()) {",
          "new_line_content": "  if (loop->op()->ControlInputCount() != 2) return;",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": "NodeProperties::IsControlEdge(edge)",
          "new_api": "id",
          "old_text": "NodeProperties::IsControlEdge(edge)",
          "new_text": "loop->id()",
          "old_line_content": "    if (NodeProperties::IsControlEdge(edge) &&",
          "new_line_content": "  TRACE(\"Loop variables for loop %i:\", loop->id());",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": "from",
          "new_api": "use_edges",
          "old_text": "edge.from()->opcode()",
          "new_text": "loop->use_edges()",
          "old_line_content": "        edge.from()->opcode() == IrOpcode::kPhi) {",
          "new_line_content": "  for (Edge edge : loop->use_edges()) {",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": "from",
          "new_api": "NodeProperties::IsControlEdge(edge)",
          "old_text": "edge.from()",
          "new_text": "NodeProperties::IsControlEdge(edge)",
          "old_line_content": "      Node* phi = edge.from();",
          "new_line_content": "    if (NodeProperties::IsControlEdge(edge) &&",
          "content_same": false
        },
        {
          "line": 333,
          "old_api": "TryGetInductionVariable",
          "new_api": "from",
          "old_text": "TryGetInductionVariable(phi)",
          "new_text": "edge.from()->opcode()",
          "old_line_content": "      InductionVariable* induction_var = TryGetInductionVariable(phi);",
          "new_line_content": "        edge.from()->opcode() == IrOpcode::kPhi) {",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": "id",
          "new_api": "TryGetInductionVariable",
          "old_text": "phi->id()",
          "new_text": "TryGetInductionVariable(phi)",
          "old_line_content": "        induction_vars_[phi->id()] = induction_var;",
          "new_line_content": "      InductionVariable* induction_var = TryGetInductionVariable(phi);",
          "content_same": false
        },
        {
          "line": 350,
          "old_api": "size",
          "new_api": "phi",
          "old_text": "induction_var->upper_bounds().size()",
          "new_text": "DCHECK_EQ(MachineRepresentation::kTagged,\n              PhiRepresentationOf(induction_var->phi()->op()))",
          "old_line_content": "    if (induction_var->upper_bounds().size() == 0 &&",
          "new_line_content": "    DCHECK_EQ(MachineRepresentation::kTagged,",
          "content_same": false
        },
        {
          "line": 351,
          "old_api": "size",
          "new_api": "phi",
          "old_text": "induction_var->lower_bounds().size()",
          "new_text": "induction_var->phi()->op()",
          "old_line_content": "        induction_var->lower_bounds().size() == 0) {",
          "new_line_content": "              PhiRepresentationOf(induction_var->phi()->op()));",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": "increment",
          "new_api": "zone",
          "old_text": "induction_var->increment()",
          "new_text": "graph()->zone()",
          "old_line_content": "                                      induction_var->increment());",
          "new_line_content": "    induction_var->phi()->InsertInput(graph()->zone(),",
          "content_same": false
        },
        {
          "line": 359,
          "old_api": "lower_bounds",
          "new_api": "increment",
          "old_text": "induction_var->lower_bounds()",
          "new_text": "induction_var->increment()",
          "old_line_content": "    for (auto bound : induction_var->lower_bounds()) {",
          "new_line_content": "                                      induction_var->increment());",
          "content_same": false
        },
        {
          "line": 361,
          "old_api": "phi",
          "new_api": "lower_bounds",
          "old_text": "induction_var->phi()->InputCount()",
          "new_text": "induction_var->lower_bounds()",
          "old_line_content": "          graph()->zone(), induction_var->phi()->InputCount() - 1, bound.bound);",
          "new_line_content": "    for (auto bound : induction_var->lower_bounds()) {",
          "content_same": false
        },
        {
          "line": 363,
          "old_api": "upper_bounds",
          "new_api": "phi",
          "old_text": "induction_var->upper_bounds()",
          "new_text": "induction_var->phi()->InputCount()",
          "old_line_content": "    for (auto bound : induction_var->upper_bounds()) {",
          "new_line_content": "          graph()->zone(), induction_var->phi()->InputCount() - 1, bound.bound);",
          "content_same": false
        },
        {
          "line": 365,
          "old_api": "phi",
          "new_api": "upper_bounds",
          "old_text": "induction_var->phi()->InputCount()",
          "new_text": "induction_var->upper_bounds()",
          "old_line_content": "          graph()->zone(), induction_var->phi()->InputCount() - 1, bound.bound);",
          "new_line_content": "    for (auto bound : induction_var->upper_bounds()) {",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": "phi",
          "new_api": "op",
          "old_text": "induction_var->phi()->ReplaceInput(value_count, control)",
          "new_text": "control->op()->ControlInputCount()",
          "old_line_content": "      induction_var->phi()->ReplaceInput(value_count, control);",
          "new_line_content": "      DCHECK_EQ(value_count, control->op()->ControlInputCount());",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": "Phi",
          "new_api": "phi",
          "old_text": "common()->Phi(MachineRepresentation::kTagged, value_count)",
          "new_text": "NodeProperties::ChangeOp(\n          induction_var->phi(),\n          common()->Phi(MachineRepresentation::kTagged, value_count))",
          "old_line_content": "          common()->Phi(MachineRepresentation::kTagged, value_count));",
          "new_line_content": "      NodeProperties::ChangeOp(",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": "Is",
          "new_api": "NodeProperties::GetType(backedge_value)",
          "old_text": "backedge_type->Is(phi_type)",
          "new_text": "NodeProperties::GetType(backedge_value)",
          "old_line_content": "      if (!backedge_type->Is(phi_type)) {",
          "new_line_content": "      Type* backedge_type = NodeProperties::GetType(backedge_value);",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": "phi",
          "new_api": "Is",
          "old_text": "induction_var->phi()",
          "new_text": "backedge_type->Is(phi_type)",
          "old_line_content": "            NodeProperties::GetControlInput(induction_var->phi())->InputAt(1);",
          "new_line_content": "      if (!backedge_type->Is(phi_type)) {",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": "phi",
          "new_api": "TypeGuard",
          "old_text": "induction_var->phi()->ReplaceInput(1, rename)",
          "new_text": "common()->TypeGuard(phi_type)",
          "old_line_content": "        induction_var->phi()->ReplaceInput(1, rename);",
          "new_line_content": "        Node* rename = graph()->NewNode(common()->TypeGuard(phi_type),",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 386,
          "old_api": null,
          "new_api": "phi",
          "old_text": null,
          "new_text": "induction_var->phi()",
          "old_line_content": "",
          "new_line_content": "          induction_var->phi(),",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": null,
          "new_api": "Phi",
          "old_text": null,
          "new_text": "common()->Phi(MachineRepresentation::kTagged, value_count)",
          "old_line_content": "      // If the backedge is not a subtype of the phi's type, we insert a sigma",
          "new_line_content": "          common()->Phi(MachineRepresentation::kTagged, value_count));",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": null,
          "new_api": "phi",
          "old_text": null,
          "new_text": "induction_var->phi()",
          "old_line_content": "        Node* backedge_control =",
          "new_line_content": "      Type* phi_type = NodeProperties::GetType(induction_var->phi());",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": null,
          "new_api": "phi",
          "old_text": null,
          "new_text": "induction_var->phi()",
          "old_line_content": "                                        backedge_value, backedge_control);",
          "new_line_content": "            NodeProperties::GetControlInput(induction_var->phi())->InputAt(1);",
          "content_same": false
        },
        {
          "line": 399,
          "old_api": null,
          "new_api": "phi",
          "old_text": null,
          "new_text": "induction_var->phi()->ReplaceInput(1, rename)",
          "old_line_content": "    }",
          "new_line_content": "        induction_var->phi()->ReplaceInput(1, rename);",
          "content_same": false
        },
        {
          "line": 307,
          "old_api": null,
          "new_api": "opcode",
          "old_text": null,
          "new_text": "arith->opcode()",
          "old_line_content": "    arithmeticType = InductionVariable::ArithmeticType::kAddition;",
          "new_line_content": "      arith->opcode() == IrOpcode::kSpeculativeNumberAdd) {",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": null,
          "new_api": "opcode",
          "old_text": null,
          "new_text": "arith->opcode()",
          "old_line_content": "    arithmeticType = InductionVariable::ArithmeticType::kSubtraction;",
          "new_line_content": "  } else if (arith->opcode() == IrOpcode::kJSSubtract ||",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": null,
          "new_api": "opcode",
          "old_text": null,
          "new_text": "arith->opcode()",
          "old_line_content": "  } else {",
          "new_line_content": "             arith->opcode() == IrOpcode::kSpeculativeNumberSubtract) {",
          "content_same": false
        },
        {
          "line": 318,
          "old_api": null,
          "new_api": "InputAt",
          "old_text": null,
          "new_text": "arith->InputAt(0)->opcode()",
          "old_line_content": "      return nullptr;",
          "new_line_content": "    if (arith->InputAt(0)->opcode() != IrOpcode::kJSToNumber ||",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": null,
          "new_api": "InputAt",
          "old_text": null,
          "new_text": "arith->InputAt(0)->InputAt(0)",
          "old_line_content": "    }",
          "new_line_content": "        arith->InputAt(0)->InputAt(0) != phi) {",
          "content_same": false
        },
        {
          "line": 324,
          "old_api": null,
          "new_api": "zone",
          "old_text": null,
          "new_text": "zone()",
          "old_line_content": "}",
          "new_line_content": "  return new (zone())",
          "content_same": false
        },
        {
          "line": 325,
          "old_api": null,
          "new_api": "zone",
          "old_text": null,
          "new_text": "zone()",
          "old_line_content": "",
          "new_line_content": "      InductionVariable(phi, arith, incr, initial, zone(), arithmeticType);",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": null,
          "new_api": "from",
          "old_text": null,
          "new_text": "edge.from()",
          "old_line_content": "      if (induction_var) {",
          "new_line_content": "      Node* phi = edge.from();",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": null,
          "new_api": "id",
          "old_text": null,
          "new_text": "phi->id()",
          "old_line_content": "      }",
          "new_line_content": "        induction_vars_[phi->id()] = induction_var;",
          "content_same": false
        },
        {
          "line": 338,
          "old_api": null,
          "new_api": "phi",
          "old_text": null,
          "new_text": "induction_var->phi()->id()",
          "old_line_content": "    }",
          "new_line_content": "        TRACE(\" %i\", induction_var->phi()->id());",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": null,
          "new_api": "TRACE",
          "old_text": null,
          "new_text": "TRACE(\"\\n\")",
          "old_line_content": "",
          "new_line_content": "  TRACE(\"\\n\");",
          "content_same": false
        },
        {
          "line": 352,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "induction_var->upper_bounds().size()",
          "old_line_content": "      continue;",
          "new_line_content": "    if (induction_var->upper_bounds().size() == 0 &&",
          "content_same": false
        },
        {
          "line": 353,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "induction_var->lower_bounds().size()",
          "old_line_content": "    }",
          "new_line_content": "        induction_var->lower_bounds().size() == 0) {",
          "content_same": false
        },
        {
          "line": 358,
          "old_api": null,
          "new_api": "phi",
          "old_text": null,
          "new_text": "induction_var->phi()->InputCount()",
          "old_line_content": "    // Insert the bound inputs to the value inputs.",
          "new_line_content": "                                      induction_var->phi()->InputCount() - 1,",
          "content_same": false
        },
        {
          "line": 362,
          "old_api": null,
          "new_api": "phi",
          "old_text": null,
          "new_text": "induction_var->phi()->InsertInput(\n          graph()->zone(), induction_var->phi()->InputCount() - 1, bound.bound)",
          "old_line_content": "    }",
          "new_line_content": "      induction_var->phi()->InsertInput(",
          "content_same": false
        },
        {
          "line": 366,
          "old_api": null,
          "new_api": "phi",
          "old_text": null,
          "new_text": "induction_var->phi()->InsertInput(\n          graph()->zone(), induction_var->phi()->InputCount() - 1, bound.bound)",
          "old_line_content": "    }",
          "new_line_content": "      induction_var->phi()->InsertInput(",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": null,
          "new_api": "phi",
          "old_text": null,
          "new_text": "induction_var->phi()",
          "old_line_content": "  }",
          "new_line_content": "        induction_var->phi(),",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": null,
          "new_api": "phi",
          "old_text": null,
          "new_text": "induction_var->phi()->InputCount()",
          "old_line_content": "}",
          "new_line_content": "        common()->InductionVariablePhi(induction_var->phi()->InputCount() - 1));",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": null,
          "new_api": "phi",
          "old_text": null,
          "new_text": "induction_var->phi()->opcode()",
          "old_line_content": "      int value_count = 2;",
          "new_line_content": "    if (induction_var->phi()->opcode() == IrOpcode::kInductionVariablePhi) {",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 389,
          "old_api": "phi",
          "new_api": null,
          "old_text": "induction_var->phi()->InputAt(1)",
          "new_text": null,
          "old_line_content": "      Node* backedge_value = induction_var->phi()->InputAt(1);",
          "new_line_content": "      // If the backedge is not a subtype of the phi's type, we insert a sigma",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": "NodeProperties::GetType(backedge_value)",
          "new_api": null,
          "old_text": "NodeProperties::GetType(backedge_value)",
          "new_text": null,
          "old_line_content": "      Type* backedge_type = NodeProperties::GetType(backedge_value);",
          "new_line_content": "      // to get the typing right.",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": "TypeGuard",
          "new_api": null,
          "old_text": "common()->TypeGuard(phi_type)",
          "new_text": null,
          "old_line_content": "        Node* rename = graph()->NewNode(common()->TypeGuard(phi_type),",
          "new_line_content": "        Node* backedge_control =",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": "opcode",
          "new_api": null,
          "old_text": "arith->opcode()",
          "new_text": null,
          "old_line_content": "  } else if (arith->opcode() == IrOpcode::kJSSubtract) {",
          "new_line_content": "    arithmeticType = InductionVariable::ArithmeticType::kAddition;",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": "InputAt",
          "new_api": null,
          "old_text": "arith->InputAt(0)",
          "new_text": null,
          "old_line_content": "  if (arith->InputAt(0) != phi) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 316,
          "old_api": "InputAt",
          "new_api": null,
          "old_text": "arith->InputAt(0)->opcode()",
          "new_text": null,
          "old_line_content": "    if (arith->InputAt(0)->opcode() != IrOpcode::kJSToNumber ||",
          "new_line_content": "  // TODO(jarin) Support both sides.",
          "content_same": false
        },
        {
          "line": 321,
          "old_api": "InputAt",
          "new_api": null,
          "old_text": "arith->InputAt(1)",
          "new_text": null,
          "old_line_content": "  Node* incr = arith->InputAt(1);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": "zone",
          "new_api": null,
          "old_text": "zone()",
          "new_text": null,
          "old_line_content": "  return new (zone())",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 327,
          "old_api": "op",
          "new_api": null,
          "old_text": "loop->op()->ControlInputCount()",
          "new_text": null,
          "old_line_content": "  if (loop->op()->ControlInputCount() != 2) return;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 328,
          "old_api": "id",
          "new_api": null,
          "old_text": "loop->id()",
          "new_text": null,
          "old_line_content": "  TRACE(\"Loop variables for loop %i:\", loop->id());",
          "new_line_content": "void LoopVariableOptimizer::DetectInductionVariables(Node* loop) {",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": "phi",
          "new_api": null,
          "old_text": "induction_var->phi()->id()",
          "new_text": null,
          "old_line_content": "        TRACE(\" %i\", induction_var->phi()->id());",
          "new_line_content": "      if (induction_var) {",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": "TRACE",
          "new_api": null,
          "old_text": "TRACE(\"\\n\")",
          "new_text": null,
          "old_line_content": "  TRACE(\"\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": "phi",
          "new_api": null,
          "old_text": "DCHECK_EQ(MachineRepresentation::kTagged,\n              PhiRepresentationOf(induction_var->phi()->op()))",
          "new_text": null,
          "old_line_content": "    DCHECK_EQ(MachineRepresentation::kTagged,",
          "new_line_content": "    // there is a bound.",
          "content_same": false
        },
        {
          "line": 349,
          "old_api": "phi",
          "new_api": null,
          "old_text": "induction_var->phi()->op()",
          "new_text": null,
          "old_line_content": "              PhiRepresentationOf(induction_var->phi()->op()));",
          "new_line_content": "    InductionVariable* induction_var = entry.second;",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": "zone",
          "new_api": null,
          "old_text": "graph()->zone()",
          "new_text": null,
          "old_line_content": "    induction_var->phi()->InsertInput(graph()->zone(),",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 356,
          "old_api": "phi",
          "new_api": null,
          "old_text": "induction_var->phi()->InputCount()",
          "new_text": null,
          "old_line_content": "                                      induction_var->phi()->InputCount() - 1,",
          "new_line_content": "    // Insert the increment value to the value inputs.",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": "phi",
          "new_api": null,
          "old_text": "induction_var->phi()->InsertInput(\n          graph()->zone(), induction_var->phi()->InputCount() - 1, bound.bound)",
          "new_text": null,
          "old_line_content": "      induction_var->phi()->InsertInput(",
          "new_line_content": "    // Insert the bound inputs to the value inputs.",
          "content_same": false
        },
        {
          "line": 364,
          "old_api": "phi",
          "new_api": null,
          "old_text": "induction_var->phi()->InsertInput(\n          graph()->zone(), induction_var->phi()->InputCount() - 1, bound.bound)",
          "new_text": null,
          "old_line_content": "      induction_var->phi()->InsertInput(",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 368,
          "old_api": "phi",
          "new_api": null,
          "old_text": "induction_var->phi()",
          "new_text": null,
          "old_line_content": "        induction_var->phi(),",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 376,
          "old_api": "phi",
          "new_api": null,
          "old_text": "induction_var->phi()->opcode()",
          "new_text": null,
          "old_line_content": "    if (induction_var->phi()->opcode() == IrOpcode::kInductionVariablePhi) {",
          "new_line_content": "  for (auto entry : induction_vars_) {",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": "phi",
          "new_api": null,
          "old_text": "induction_var->phi()",
          "new_text": null,
          "old_line_content": "      Node* control = NodeProperties::GetControlInput(induction_var->phi());",
          "new_line_content": "      // Turn the induction variable phi back to normal phi.",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": "op",
          "new_api": null,
          "old_text": "control->op()->ControlInputCount()",
          "new_text": null,
          "old_line_content": "      DCHECK_EQ(value_count, control->op()->ControlInputCount());",
          "new_line_content": "      int value_count = 2;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 19,
      "total_additions": 24,
      "total_deletions": 22,
      "total_api_changes": 65
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 65,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          306
        ]
      }
    },
    "api_calls_before": 229,
    "api_calls_after": 231,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 2,
      "total_diff_lines": 19
    }
  }
}