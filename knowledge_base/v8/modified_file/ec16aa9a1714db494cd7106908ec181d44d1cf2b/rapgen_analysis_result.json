{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/ec16aa9a1714db494cd7106908ec181d44d1cf2b",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/ec16aa9a1714db494cd7106908ec181d44d1cf2b/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/ec16aa9a1714db494cd7106908ec181d44d1cf2b/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/v8/modified_file/ec16aa9a1714db494cd7106908ec181d44d1cf2b/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 137,
          "old_api": "code",
          "new_api": "Heap::InNewSpace(function)",
          "old_text": "function->code()",
          "new_text": "Heap::InNewSpace(function)",
          "old_line_content": "  Code* code = function->code();",
          "new_line_content": "  if (Heap::InNewSpace(function)) return false;",
          "content_same": false
        },
        {
          "line": 138,
          "old_api": "optimizable",
          "new_api": "code",
          "old_text": "code->optimizable()",
          "new_text": "function->code()",
          "old_line_content": "  return code->kind() == Code::FUNCTION && code->optimizable();",
          "new_line_content": "  Code* code = function->code();",
          "content_same": false
        },
        {
          "line": 146,
          "old_api": "PrintName",
          "new_api": "PrintF",
          "old_text": "function->PrintName()",
          "new_text": "PrintF(\"[marking (%s) \", eager ? \"eagerly\" : \"lazily\")",
          "old_line_content": "    function->PrintName();",
          "new_line_content": "    PrintF(\"[marking (%s) \", eager ? \"eagerly\" : \"lazily\");",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "PrintF",
          "new_api": "PrintName",
          "old_text": "PrintF(\" for recompilation\")",
          "new_text": "function->PrintName()",
          "old_line_content": "    PrintF(\" for recompilation\");",
          "new_line_content": "    function->PrintName();",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": "IsBuiltin",
          "new_api": "IsMarkedForLazyRecompilation",
          "old_text": "function->IsBuiltin()",
          "new_text": "function->IsMarkedForLazyRecompilation()",
          "old_line_content": "  if (!FLAG_use_osr || Debug::has_break_points() || function->IsBuiltin()) {",
          "new_line_content": "  ASSERT(function->IsMarkedForLazyRecompilation());",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": "PrintName",
          "new_api": "PrintF",
          "old_text": "function->PrintName()",
          "new_text": "PrintF(\"[patching stack checks in \")",
          "old_line_content": "    function->PrintName();",
          "new_line_content": "    PrintF(\"[patching stack checks in \");",
          "content_same": false
        },
        {
          "line": 184,
          "old_api": "PrintF",
          "new_api": "PrintName",
          "old_text": "PrintF(\" for on-stack replacement]\\n\")",
          "new_text": "function->PrintName()",
          "old_line_content": "    PrintF(\" for on-stack replacement]\\n\");",
          "new_line_content": "    function->PrintName();",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": "ToObject",
          "new_api": "TryGetCode",
          "old_text": "maybe_check_code->ToObject(&check_code)",
          "new_text": "check_stub.TryGetCode()",
          "old_line_content": "  if (maybe_check_code->ToObject(&check_code)) {",
          "new_line_content": "  MaybeObject* maybe_check_code = check_stub.TryGetCode();",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": "Builtins::builtin(Builtins::OnStackReplacement)",
          "new_api": "ToObject",
          "old_text": "Builtins::builtin(Builtins::OnStackReplacement)",
          "new_text": "maybe_check_code->ToObject(&check_code)",
          "old_line_content": "    Code* replacement_code = Builtins::builtin(Builtins::OnStackReplacement);",
          "new_line_content": "  if (maybe_check_code->ToObject(&check_code)) {",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": "code",
          "new_api": "Builtins::builtin(Builtins::OnStackReplacement)",
          "old_text": "shared->code()",
          "new_text": "Builtins::builtin(Builtins::OnStackReplacement)",
          "old_line_content": "    Code* unoptimized_code = shared->code();",
          "new_line_content": "    Code* replacement_code = Builtins::builtin(Builtins::OnStackReplacement);",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "next",
          "new_api": "done",
          "old_text": "it.next()",
          "new_text": "it.done()",
          "old_line_content": "         it.next()) {",
          "new_line_content": "         !it.done();",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": "rinfo",
          "new_api": "next",
          "old_text": "it.rinfo()",
          "new_text": "it.next()",
          "old_line_content": "      RelocInfo* rinfo = it.rinfo();",
          "new_line_content": "         it.next()) {",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": "entry",
          "new_api": "rinfo",
          "old_text": "Code::cast(check_code)->entry()",
          "new_text": "it.rinfo()",
          "old_line_content": "      if (rinfo->target_address() == Code::cast(check_code)->entry()) {",
          "new_line_content": "      RelocInfo* rinfo = it.rinfo();",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": "IsValid",
          "new_api": "next",
          "old_text": "current->IsValid()",
          "new_text": "current->next()",
          "old_line_content": "    if (current->IsValid()) {",
          "new_line_content": "    PendingListNode* next = current->next();",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": "function",
          "new_api": "IsValid",
          "old_text": "current->function()",
          "new_text": "current->IsValid()",
          "old_line_content": "      Handle<JSFunction> function = current->function();",
          "new_line_content": "    if (current->IsValid()) {",
          "content_same": false
        },
        {
          "line": 263,
          "old_api": "Delay",
          "new_api": "function",
          "old_text": "current->Delay()",
          "new_text": "current->function()",
          "old_line_content": "      int delay = current->Delay();",
          "new_line_content": "      Handle<JSFunction> function = current->function();",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": "IsOptimizable",
          "new_api": "Delay",
          "old_text": "IsOptimizable(*function)",
          "new_text": "current->Delay()",
          "old_line_content": "      if (IsOptimizable(*function)) {",
          "new_line_content": "      int delay = current->Delay();",
          "content_same": false
        },
        {
          "line": 265,
          "old_api": "Optimize",
          "new_api": "IsOptimizable",
          "old_text": "Optimize(*function, true, delay)",
          "new_text": "IsOptimizable(*function)",
          "old_line_content": "        Optimize(*function, true, delay);",
          "new_line_content": "      if (IsOptimizable(*function)) {",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": "Advance",
          "new_api": "done",
          "old_text": "it.Advance()",
          "new_text": "it.done()",
          "old_line_content": "       it.Advance()) {",
          "new_line_content": "       frame_count++ < kSamplerFrameCount && !it.done();",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": "frame",
          "new_api": "Advance",
          "old_text": "it.frame()",
          "new_text": "it.Advance()",
          "old_line_content": "    JavaScriptFrame* frame = it.frame();",
          "new_line_content": "       it.Advance()) {",
          "content_same": false
        },
        {
          "line": 283,
          "old_api": "function",
          "new_api": "frame",
          "old_text": "frame->function()",
          "new_text": "it.frame()",
          "old_line_content": "    JSFunction* function = JSFunction::cast(frame->function());",
          "new_line_content": "    JavaScriptFrame* frame = it.frame();",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": "shared",
          "new_api": "IsMarkedForLazyRecompilation",
          "old_text": "function->shared()->code()",
          "new_text": "function->IsMarkedForLazyRecompilation()",
          "old_line_content": "      Code* unoptimized = function->shared()->code();",
          "new_line_content": "    if (function->IsMarkedForLazyRecompilation()) {",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": "allow_osr_at_loop_nesting_level",
          "new_api": "shared",
          "old_text": "unoptimized->allow_osr_at_loop_nesting_level()",
          "new_text": "function->shared()->code()",
          "old_line_content": "      int nesting = unoptimized->allow_osr_at_loop_nesting_level();",
          "new_line_content": "      Code* unoptimized = function->shared()->code();",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": "AttemptOnStackReplacement",
          "new_api": "allow_osr_at_loop_nesting_level",
          "old_text": "AttemptOnStackReplacement(function)",
          "new_text": "unoptimized->allow_osr_at_loop_nesting_level()",
          "old_line_content": "      if (nesting == 0) AttemptOnStackReplacement(function);",
          "new_line_content": "      int nesting = unoptimized->allow_osr_at_loop_nesting_level();",
          "content_same": false
        },
        {
          "line": 304,
          "old_api": "Min",
          "new_api": "AttemptOnStackReplacement",
          "old_text": "Min(nesting + 1, Code::kMaxLoopNestingMarker)",
          "new_text": "AttemptOnStackReplacement(function)",
          "old_line_content": "      int new_nesting = Min(nesting + 1, Code::kMaxLoopNestingMarker);",
          "new_line_content": "      if (nesting == 0) AttemptOnStackReplacement(function);",
          "content_same": false
        },
        {
          "line": 305,
          "old_api": "set_allow_osr_at_loop_nesting_level",
          "new_api": "Min",
          "old_text": "unoptimized->set_allow_osr_at_loop_nesting_level(new_nesting)",
          "new_text": "Min(nesting + 1, Code::kMaxLoopNestingMarker)",
          "old_line_content": "      unoptimized->set_allow_osr_at_loop_nesting_level(new_nesting);",
          "new_line_content": "      int new_nesting = Min(nesting + 1, Code::kMaxLoopNestingMarker);",
          "content_same": false
        },
        {
          "line": 333,
          "old_api": "Optimize",
          "new_api": "LookupSample",
          "old_text": "Optimize(function, false, 0)",
          "new_text": "LookupSample(function)",
          "old_line_content": "      Optimize(function, false, 0);",
          "new_line_content": "    if (LookupSample(function) >= threshold) {",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": "Handle<JSFunction>(function)",
          "new_api": "Optimize",
          "old_text": "Handle<JSFunction>(function)",
          "new_text": "Optimize(function, false, 0)",
          "old_line_content": "      CompilationCache::MarkForEagerOptimizing(Handle<JSFunction>(function));",
          "new_line_content": "      Optimize(function, false, 0);",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": "StackGuard::RequestRuntimeProfilerTick()",
          "new_api": "UpdateStateRatio",
          "old_text": "StackGuard::RequestRuntimeProfilerTick()",
          "new_text": "UpdateStateRatio(state)",
          "old_line_content": "  StackGuard::RequestRuntimeProfilerTick();",
          "new_line_content": "  UpdateStateRatio(state);",
          "content_same": false
        },
        {
          "line": 443,
          "old_api": "CpuProfiler::is_profiling()",
          "new_api": "RuntimeProfiler::IsEnabled()",
          "old_text": "CpuProfiler::is_profiling()",
          "new_text": "RuntimeProfiler::IsEnabled()",
          "old_line_content": "      !CpuProfiler::is_profiling() &&",
          "new_line_content": "  if (RuntimeProfiler::IsEnabled() &&",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 392,
          "old_api": null,
          "new_api": "ClearSampleBuffer",
          "old_text": null,
          "new_text": "ClearSampleBuffer()",
          "old_line_content": "  } else {",
          "new_line_content": "    ClearSampleBuffer();",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": null,
          "new_api": "Optimize",
          "old_text": null,
          "new_text": "Optimize(*function, true, delay)",
          "old_line_content": "      }",
          "new_line_content": "        Optimize(*function, true, delay);",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": null,
          "new_api": "optimizable",
          "old_text": null,
          "new_text": "code->optimizable()",
          "old_line_content": "}",
          "new_line_content": "  return code->kind() == Code::FUNCTION && code->optimizable();",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": null,
          "new_api": "ClearSampleBufferNewSpaceEntries",
          "old_text": null,
          "new_text": "ClearSampleBufferNewSpaceEntries()",
          "old_line_content": "  }",
          "new_line_content": "    ClearSampleBufferNewSpaceEntries();",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": null,
          "new_api": "IsOptimizable",
          "old_text": null,
          "new_text": "IsOptimizable(function)",
          "old_line_content": "  if (FLAG_trace_opt) {",
          "new_line_content": "  ASSERT(IsOptimizable(function));",
          "content_same": false
        },
        {
          "line": 148,
          "old_api": null,
          "new_api": "PrintF",
          "old_text": null,
          "new_text": "PrintF(\" for recompilation\")",
          "old_line_content": "    if (delay > 0) {",
          "new_line_content": "    PrintF(\" for recompilation\");",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": null,
          "new_api": "static_cast<double>(delay)",
          "old_text": null,
          "new_text": "static_cast<double>(delay)",
          "old_line_content": "    }",
          "new_line_content": "      PrintF(\" (delayed %0.3f ms)\", static_cast<double>(delay) / 1000);",
          "content_same": false
        },
        {
          "line": 407,
          "old_api": null,
          "new_api": "ClearSampleBuffer",
          "old_text": null,
          "new_text": "ClearSampleBuffer()",
          "old_line_content": "  // If the ticker hasn't already started, make sure to do so to get",
          "new_line_content": "  ClearSampleBuffer();",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": null,
          "new_api": "PrintF",
          "old_text": null,
          "new_text": "PrintF(\"]\\n\")",
          "old_line_content": "  }",
          "new_line_content": "    PrintF(\"]\\n\");",
          "content_same": false
        },
        {
          "line": 410,
          "old_api": null,
          "new_api": "Logger::EnsureTickerStarted()",
          "old_text": null,
          "new_text": "Logger::EnsureTickerStarted()",
          "old_line_content": "}",
          "new_line_content": "  if (IsEnabled()) Logger::EnsureTickerStarted();",
          "content_same": false
        },
        {
          "line": 284,
          "old_api": null,
          "new_api": "function",
          "old_text": null,
          "new_text": "frame->function()",
          "old_line_content": "",
          "new_line_content": "    JSFunction* function = JSFunction::cast(frame->function());",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": null,
          "new_api": "MarkForLazyRecompilation",
          "old_text": null,
          "new_text": "function->MarkForLazyRecompilation()",
          "old_line_content": "}",
          "new_line_content": "  function->MarkForLazyRecompilation();",
          "content_same": false
        },
        {
          "line": 164,
          "old_api": null,
          "new_api": "IsBuiltin",
          "old_text": null,
          "new_text": "function->IsBuiltin()",
          "old_line_content": "    return;",
          "new_line_content": "  if (!FLAG_use_osr || Debug::has_break_points() || function->IsBuiltin()) {",
          "content_same": false
        },
        {
          "line": 168,
          "old_api": null,
          "new_api": "shared",
          "old_text": null,
          "new_text": "function->shared()",
          "old_line_content": "  // If the code is not optimizable or references context slots, don't try OSR.",
          "new_line_content": "  SharedFunctionInfo* shared = function->shared();",
          "content_same": false
        },
        {
          "line": 170,
          "old_api": null,
          "new_api": "allows_lazy_compilation",
          "old_text": null,
          "new_text": "shared->allows_lazy_compilation()",
          "old_line_content": "    return;",
          "new_line_content": "  if (!shared->code()->optimizable() || !shared->allows_lazy_compilation()) {",
          "content_same": false
        },
        {
          "line": 177,
          "old_api": null,
          "new_api": "scope_info",
          "old_text": null,
          "new_text": "shared->scope_info()->HasArgumentsShadow()",
          "old_line_content": "",
          "new_line_content": "  if (shared->scope_info()->HasArgumentsShadow()) return;",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": null,
          "new_api": "set_allow_osr_at_loop_nesting_level",
          "old_text": null,
          "new_text": "unoptimized->set_allow_osr_at_loop_nesting_level(new_nesting)",
          "old_line_content": "    }",
          "new_line_content": "      unoptimized->set_allow_osr_at_loop_nesting_level(new_nesting);",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": null,
          "new_api": "IsOptimizable",
          "old_text": null,
          "new_text": "IsOptimizable(function)",
          "old_line_content": "    samples[sample_count++] = function;",
          "new_line_content": "    if (!IsOptimizable(function)) continue;",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": null,
          "new_api": "PrintF",
          "old_text": null,
          "new_text": "PrintF(\" for on-stack replacement]\\n\")",
          "old_line_content": "  }",
          "new_line_content": "    PrintF(\" for on-stack replacement]\\n\");",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": null,
          "new_api": "shared",
          "old_text": null,
          "new_text": "function->shared()->SourceSize()",
          "old_line_content": "    int threshold_size_factor = (function_size > kSizeLimit)",
          "new_line_content": "    int function_size = function->shared()->SourceSize();",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": null,
          "new_api": "CpuProfiler::is_profiling()",
          "old_text": null,
          "new_text": "CpuProfiler::is_profiling()",
          "old_line_content": "      !(FLAG_prof && FLAG_prof_auto)) {",
          "new_line_content": "      !CpuProfiler::is_profiling() &&",
          "content_same": false
        },
        {
          "line": 446,
          "old_api": null,
          "new_api": "Top::IsInJSState()",
          "old_text": null,
          "new_text": "Top::IsInJSState()",
          "old_line_content": "      non_js_ticks_ = 0;",
          "new_line_content": "    if (Top::IsInJSState()) {",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": null,
          "new_api": "NoBarrier_Load",
          "old_text": null,
          "new_text": "NoBarrier_Load(&js_ratio)",
          "old_line_content": "",
          "new_line_content": "    int current_js_ratio = NoBarrier_Load(&js_ratio);",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": null,
          "new_api": "code",
          "old_text": null,
          "new_text": "shared->code()",
          "old_line_content": "    // Iterate the unoptimized code and patch every stack check except at",
          "new_line_content": "    Code* unoptimized_code = shared->code();",
          "content_same": false
        },
        {
          "line": 452,
          "old_api": null,
          "new_api": "Top::WaitForJSState()",
          "old_text": null,
          "new_text": "Top::WaitForJSState()",
          "old_line_content": "      }",
          "new_line_content": "        if (Top::WaitForJSState()) return true;",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": null,
          "new_api": "entry",
          "old_text": null,
          "new_text": "Code::cast(check_code)->entry()",
          "old_line_content": "        if (first) {",
          "new_line_content": "      if (rinfo->target_address() == Code::cast(check_code)->entry()) {",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": null,
          "new_api": "Handle<JSFunction>(function)",
          "old_text": null,
          "new_text": "Handle<JSFunction>(function)",
          "old_line_content": "    }",
          "new_line_content": "      CompilationCache::MarkForEagerOptimizing(Handle<JSFunction>(function));",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": null,
          "new_api": "Deoptimizer::PatchStackCheckCode(rinfo, replacement_code)",
          "old_text": null,
          "new_text": "Deoptimizer::PatchStackCheckCode(rinfo, replacement_code)",
          "old_line_content": "        }",
          "new_line_content": "          Deoptimizer::PatchStackCheckCode(rinfo, replacement_code);",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": null,
          "new_api": "AddSample",
          "old_text": null,
          "new_text": "AddSample(samples[i], kSamplerFrameWeight[i])",
          "old_line_content": "  }",
          "new_line_content": "    AddSample(samples[i], kSamplerFrameWeight[i]);",
          "content_same": false
        },
        {
          "line": 349,
          "old_api": null,
          "new_api": "IsOptimizable",
          "old_text": null,
          "new_text": "IsOptimizable(function)",
          "old_line_content": "  PendingListNode* node = new PendingListNode(function);",
          "new_line_content": "  if (!IsOptimizable(function)) return;",
          "content_same": false
        },
        {
          "line": 351,
          "old_api": null,
          "new_api": "set_next",
          "old_text": null,
          "new_text": "node->set_next(optimize_soon_list)",
          "old_line_content": "  optimize_soon_list = node;",
          "new_line_content": "  node->set_next(optimize_soon_list);",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": null,
          "new_api": "Heap::InNewSpace(sampler_window[i])",
          "old_text": null,
          "new_text": "Heap::InNewSpace(sampler_window[i])",
          "old_line_content": "      sampler_window[i] = NULL;",
          "new_line_content": "    if (Heap::InNewSpace(sampler_window[i])) {",
          "content_same": false
        },
        {
          "line": 367,
          "old_api": null,
          "new_api": "IsPowerOf2",
          "old_text": null,
          "new_text": "IsPowerOf2(kStateWindowSize)",
          "old_line_content": "  state_window_position = (state_window_position + 1) &",
          "new_line_content": "  ASSERT(IsPowerOf2(kStateWindowSize));",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": null,
          "new_api": "NoBarrier_Store",
          "old_text": null,
          "new_text": "NoBarrier_Store(&js_ratio, state_counts[IN_JS_STATE] * 100 /\n                  kStateWindowSize)",
          "old_line_content": "                  kStateWindowSize);",
          "new_line_content": "  NoBarrier_Store(&js_ratio, state_counts[IN_JS_STATE] * 100 /",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": null,
          "new_api": "IsPowerOf2",
          "old_text": null,
          "new_text": "IsPowerOf2(kSamplerWindowSize)",
          "old_line_content": "  sampler_window[sampler_window_position] = function;",
          "new_line_content": "  ASSERT(IsPowerOf2(kSamplerWindowSize));",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": null,
          "new_api": "Top::IsInJSState()",
          "old_text": null,
          "new_text": "Top::IsInJSState()",
          "old_line_content": "      ? IN_JS_STATE",
          "new_line_content": "  SamplerState state = Top::IsInJSState()",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": null,
          "new_api": "StackGuard::RequestRuntimeProfilerTick()",
          "old_text": null,
          "new_text": "StackGuard::RequestRuntimeProfilerTick()",
          "old_line_content": "#endif",
          "new_line_content": "  StackGuard::RequestRuntimeProfilerTick();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 260,
          "old_api": "next",
          "new_api": null,
          "old_text": "current->next()",
          "new_text": null,
          "old_line_content": "    PendingListNode* next = current->next();",
          "new_line_content": "  while (current != NULL) {",
          "content_same": false
        },
        {
          "line": 391,
          "old_api": "ClearSampleBuffer",
          "new_api": null,
          "old_text": "ClearSampleBuffer()",
          "new_text": null,
          "old_line_content": "    ClearSampleBuffer();",
          "new_line_content": "    // function might move.",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": "ClearSampleBufferNewSpaceEntries",
          "new_api": null,
          "old_text": "ClearSampleBufferNewSpaceEntries()",
          "new_text": null,
          "old_line_content": "    ClearSampleBufferNewSpaceEntries();",
          "new_line_content": "    // old-space functions will move.",
          "content_same": false
        },
        {
          "line": 143,
          "old_api": "IsOptimizable",
          "new_api": null,
          "old_text": "IsOptimizable(function)",
          "new_text": null,
          "old_line_content": "  ASSERT(IsOptimizable(function));",
          "new_line_content": "static void Optimize(JSFunction* function, bool eager, int delay) {",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": "PrintF",
          "new_api": null,
          "old_text": "PrintF(\"[marking (%s) \", eager ? \"eagerly\" : \"lazily\")",
          "new_text": null,
          "old_line_content": "    PrintF(\"[marking (%s) \", eager ? \"eagerly\" : \"lazily\");",
          "new_line_content": "  if (FLAG_trace_opt) {",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": "static_cast<double>(delay)",
          "new_api": null,
          "old_text": "static_cast<double>(delay)",
          "new_text": null,
          "old_line_content": "      PrintF(\" (delayed %0.3f ms)\", static_cast<double>(delay) / 1000);",
          "new_line_content": "    if (delay > 0) {",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": "ClearSampleBuffer",
          "new_api": null,
          "old_text": "ClearSampleBuffer()",
          "new_text": null,
          "old_line_content": "  ClearSampleBuffer();",
          "new_line_content": "void RuntimeProfiler::Setup() {",
          "content_same": false
        },
        {
          "line": 151,
          "old_api": "PrintF",
          "new_api": null,
          "old_text": "PrintF(\"]\\n\")",
          "new_text": null,
          "old_line_content": "    PrintF(\"]\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": "done",
          "new_api": null,
          "old_text": "it.done()",
          "new_text": null,
          "old_line_content": "       frame_count++ < kSamplerFrameCount && !it.done();",
          "new_line_content": "  for (JavaScriptFrameIterator it;",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": "Logger::EnsureTickerStarted()",
          "new_api": null,
          "old_text": "Logger::EnsureTickerStarted()",
          "new_text": null,
          "old_line_content": "  if (IsEnabled()) Logger::EnsureTickerStarted();",
          "new_line_content": "  // the ticks for the runtime profiler.",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": "MarkForLazyRecompilation",
          "new_api": null,
          "old_text": "function->MarkForLazyRecompilation()",
          "new_text": null,
          "old_line_content": "  function->MarkForLazyRecompilation();",
          "new_line_content": "  // The next call to the function will trigger optimization.",
          "content_same": false
        },
        {
          "line": 162,
          "old_api": "IsMarkedForLazyRecompilation",
          "new_api": null,
          "old_text": "function->IsMarkedForLazyRecompilation()",
          "new_text": null,
          "old_line_content": "  ASSERT(function->IsMarkedForLazyRecompilation());",
          "new_line_content": "  // Debug::has_break_points().",
          "content_same": false
        },
        {
          "line": 167,
          "old_api": "shared",
          "new_api": null,
          "old_text": "function->shared()",
          "new_text": null,
          "old_line_content": "  SharedFunctionInfo* shared = function->shared();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 169,
          "old_api": "allows_lazy_compilation",
          "new_api": null,
          "old_text": "shared->allows_lazy_compilation()",
          "new_text": null,
          "old_line_content": "  if (!shared->code()->optimizable() || !shared->allows_lazy_compilation()) {",
          "new_line_content": "  // If the code is not optimizable or references context slots, don't try OSR.",
          "content_same": false
        },
        {
          "line": 300,
          "old_api": "IsMarkedForLazyRecompilation",
          "new_api": null,
          "old_text": "function->IsMarkedForLazyRecompilation()",
          "new_text": null,
          "old_line_content": "    if (function->IsMarkedForLazyRecompilation()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": "scope_info",
          "new_api": null,
          "old_text": "shared->scope_info()->HasArgumentsShadow()",
          "new_text": null,
          "old_line_content": "  if (shared->scope_info()->HasArgumentsShadow()) return;",
          "new_line_content": "  // arguments accesses, which is unsound.  Don't try OSR.",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": "IsOptimizable",
          "new_api": null,
          "old_text": "IsOptimizable(function)",
          "new_text": null,
          "old_line_content": "    if (!IsOptimizable(function)) continue;",
          "new_line_content": "    // Do not record non-optimizable functions.",
          "content_same": false
        },
        {
          "line": 182,
          "old_api": "PrintF",
          "new_api": null,
          "old_text": "PrintF(\"[patching stack checks in \")",
          "new_text": null,
          "old_line_content": "    PrintF(\"[patching stack checks in \");",
          "new_line_content": "  if (FLAG_trace_osr) {",
          "content_same": false
        },
        {
          "line": 312,
          "old_api": "shared",
          "new_api": null,
          "old_text": "function->shared()->SourceSize()",
          "new_text": null,
          "old_line_content": "    int function_size = function->shared()->SourceSize();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": "RuntimeProfiler::IsEnabled()",
          "new_api": null,
          "old_text": "RuntimeProfiler::IsEnabled()",
          "new_text": null,
          "old_line_content": "  if (RuntimeProfiler::IsEnabled() &&",
          "new_line_content": "  // because it samples both JavaScript and C++ code.",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": "Top::IsInJSState()",
          "new_api": null,
          "old_text": "Top::IsInJSState()",
          "new_text": null,
          "old_line_content": "    if (Top::IsInJSState()) {",
          "new_line_content": "      !(FLAG_prof && FLAG_prof_auto)) {",
          "content_same": false
        },
        {
          "line": 318,
          "old_api": "NoBarrier_Load",
          "new_api": null,
          "old_text": "NoBarrier_Load(&js_ratio)",
          "new_text": null,
          "old_line_content": "    int current_js_ratio = NoBarrier_Load(&js_ratio);",
          "new_line_content": "    int threshold = sampler_threshold * threshold_size_factor;",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "TryGetCode",
          "new_api": null,
          "old_text": "check_stub.TryGetCode()",
          "new_text": null,
          "old_line_content": "  MaybeObject* maybe_check_code = check_stub.TryGetCode();",
          "new_line_content": "  Object* check_code;",
          "content_same": false
        },
        {
          "line": 451,
          "old_api": "Top::WaitForJSState()",
          "new_api": null,
          "old_text": "Top::WaitForJSState()",
          "new_text": null,
          "old_line_content": "        if (Top::WaitForJSState()) return true;",
          "new_line_content": "      } else {",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": "done",
          "new_api": null,
          "old_text": "it.done()",
          "new_text": null,
          "old_line_content": "         !it.done();",
          "new_line_content": "    for (RelocIterator it(unoptimized_code, RelocInfo::kCodeTargetMask);",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": "LookupSample",
          "new_api": null,
          "old_text": "LookupSample(function)",
          "new_text": null,
          "old_line_content": "    if (LookupSample(function) >= threshold) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": "Deoptimizer::PatchStackCheckCode(rinfo, replacement_code)",
          "new_api": null,
          "old_text": "Deoptimizer::PatchStackCheckCode(rinfo, replacement_code)",
          "new_text": null,
          "old_line_content": "          Deoptimizer::PatchStackCheckCode(rinfo, replacement_code);",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": "AddSample",
          "new_api": null,
          "old_text": "AddSample(samples[i], kSamplerFrameWeight[i])",
          "new_text": null,
          "old_line_content": "    AddSample(samples[i], kSamplerFrameWeight[i]);",
          "new_line_content": "  for (int i = 0; i < sample_count; i++) {",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": "IsOptimizable",
          "new_api": null,
          "old_text": "IsOptimizable(function)",
          "new_text": null,
          "old_line_content": "  if (!IsOptimizable(function)) return;",
          "new_line_content": "void RuntimeProfiler::OptimizeSoon(JSFunction* function) {",
          "content_same": false
        },
        {
          "line": 350,
          "old_api": "set_next",
          "new_api": null,
          "old_text": "node->set_next(optimize_soon_list)",
          "new_text": null,
          "old_line_content": "  node->set_next(optimize_soon_list);",
          "new_line_content": "  PendingListNode* node = new PendingListNode(function);",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "Heap::InNewSpace(sampler_window[i])",
          "new_api": null,
          "old_text": "Heap::InNewSpace(sampler_window[i])",
          "new_text": null,
          "old_line_content": "    if (Heap::InNewSpace(sampler_window[i])) {",
          "new_line_content": "  for (int i = 0; i < kSamplerWindowSize; i++) {",
          "content_same": false
        },
        {
          "line": 366,
          "old_api": "IsPowerOf2",
          "new_api": null,
          "old_text": "IsPowerOf2(kStateWindowSize)",
          "new_text": null,
          "old_line_content": "  ASSERT(IsPowerOf2(kStateWindowSize));",
          "new_line_content": "  state_counts[current_state]++;",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": "NoBarrier_Store",
          "new_api": null,
          "old_text": "NoBarrier_Store(&js_ratio, state_counts[IN_JS_STATE] * 100 /\n                  kStateWindowSize)",
          "new_text": null,
          "old_line_content": "  NoBarrier_Store(&js_ratio, state_counts[IN_JS_STATE] * 100 /",
          "new_line_content": "      (kStateWindowSize - 1);",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": "IsPowerOf2",
          "new_api": null,
          "old_text": "IsPowerOf2(kSamplerWindowSize)",
          "new_text": null,
          "old_line_content": "  ASSERT(IsPowerOf2(kSamplerWindowSize));",
          "new_line_content": "static void AddSample(JSFunction* function, int weight) {",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": "Top::IsInJSState()",
          "new_api": null,
          "old_text": "Top::IsInJSState()",
          "new_text": null,
          "old_line_content": "  SamplerState state = Top::IsInJSState()",
          "new_line_content": "  // Record state sample.",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": "UpdateStateRatio",
          "new_api": null,
          "old_text": "UpdateStateRatio(state)",
          "new_text": null,
          "old_line_content": "  UpdateStateRatio(state);",
          "new_line_content": "      : IN_NON_JS_STATE;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 30,
      "total_additions": 37,
      "total_deletions": 36,
      "total_api_changes": 103
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 1,
        "api_related_lines": 103,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 99,
    "api_calls_after": 100,
    "diff_info": {
      "added_lines": 1,
      "removed_lines": 0,
      "total_diff_lines": 13
    }
  }
}