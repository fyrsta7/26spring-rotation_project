{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/grpc/modified_file/450196ae3f3457b8dfbef7d3c2f332b3d5ad5305",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/grpc/modified_file/450196ae3f3457b8dfbef7d3c2f332b3d5ad5305/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/grpc/modified_file/450196ae3f3457b8dfbef7d3c2f332b3d5ad5305/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/grpc/modified_file/450196ae3f3457b8dfbef7d3c2f332b3d5ad5305/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 463,
          "old_api": "gpr_inf_future",
          "new_api": "grpc_completion_queue_pluck",
          "old_text": "gpr_inf_future(GPR_CLOCK_REALTIME)",
          "new_text": "grpc_completion_queue_pluck(completion_queue, wrapped,\n                              gpr_inf_future(GPR_CLOCK_REALTIME), NULL)",
          "old_line_content": "                              gpr_inf_future(GPR_CLOCK_REALTIME), NULL);",
          "new_line_content": "  grpc_completion_queue_pluck(completion_queue, wrapped,",
          "content_same": false
        },
        {
          "line": 481,
          "old_api": "add_property_zval",
          "new_api": "grpc_parse_metadata_array",
          "old_text": "add_property_zval(result, \"metadata\", recv_md)",
          "new_text": "grpc_parse_metadata_array(&recv_metadata)",
          "old_line_content": "      add_property_zval(result, \"metadata\", recv_md);",
          "new_line_content": "      recv_md = grpc_parse_metadata_array(&recv_metadata);",
          "content_same": false
        },
        {
          "line": 482,
          "old_api": "zval_ptr_dtor",
          "new_api": "add_property_zval",
          "old_text": "zval_ptr_dtor(recv_md)",
          "new_text": "add_property_zval(result, \"metadata\", recv_md)",
          "old_line_content": "      zval_ptr_dtor(recv_md);",
          "new_line_content": "      add_property_zval(result, \"metadata\", recv_md);",
          "content_same": false
        },
        {
          "line": 483,
          "old_api": "PHP_GRPC_FREE_STD_ZVAL",
          "new_api": "zval_ptr_dtor",
          "old_text": "PHP_GRPC_FREE_STD_ZVAL(recv_md)",
          "new_text": "zval_ptr_dtor(recv_md)",
          "old_line_content": "      PHP_GRPC_FREE_STD_ZVAL(recv_md);",
          "new_line_content": "      zval_ptr_dtor(recv_md);",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": "PHP_GRPC_DELREF",
          "new_api": "PHP_GRPC_FREE_STD_ZVAL",
          "old_text": "PHP_GRPC_DELREF(array)",
          "new_text": "PHP_GRPC_FREE_STD_ZVAL(recv_md)",
          "old_line_content": "      PHP_GRPC_DELREF(array);",
          "new_line_content": "      PHP_GRPC_FREE_STD_ZVAL(recv_md);",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": "add_property_zval",
          "new_api": "ZVAL_NEW_STR",
          "old_text": "add_property_zval(result, \"message\", &zmessage_val)",
          "new_text": "ZVAL_NEW_STR(&zmessage_val, zmessage)",
          "old_line_content": "        add_property_zval(result, \"message\", &zmessage_val);",
          "new_line_content": "        ZVAL_NEW_STR(&zmessage_val, zmessage);",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": "zval_ptr_dtor",
          "new_api": "add_property_zval",
          "old_text": "zval_ptr_dtor(&zmessage_val)",
          "new_text": "add_property_zval(result, \"message\", &zmessage_val)",
          "old_line_content": "        zval_ptr_dtor(&zmessage_val);",
          "new_line_content": "        add_property_zval(result, \"message\", &zmessage_val);",
          "content_same": false
        },
        {
          "line": 500,
          "old_api": "object_init",
          "new_api": "PHP_GRPC_MAKE_STD_ZVAL",
          "old_text": "object_init(recv_status)",
          "new_text": "PHP_GRPC_MAKE_STD_ZVAL(recv_status)",
          "old_line_content": "      object_init(recv_status);",
          "new_line_content": "      PHP_GRPC_MAKE_STD_ZVAL(recv_status);",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": "grpc_parse_metadata_array",
          "new_api": "object_init",
          "old_text": "grpc_parse_metadata_array(&recv_trailing_metadata)",
          "new_text": "object_init(recv_status)",
          "old_line_content": "      recv_md = grpc_parse_metadata_array(&recv_trailing_metadata);",
          "new_line_content": "      object_init(recv_status);",
          "content_same": false
        },
        {
          "line": 502,
          "old_api": "add_property_zval",
          "new_api": "grpc_parse_metadata_array",
          "old_text": "add_property_zval(recv_status, \"metadata\", recv_md)",
          "new_text": "grpc_parse_metadata_array(&recv_trailing_metadata)",
          "old_line_content": "      add_property_zval(recv_status, \"metadata\", recv_md);",
          "new_line_content": "      recv_md = grpc_parse_metadata_array(&recv_trailing_metadata);",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": "zval_ptr_dtor",
          "new_api": "add_property_zval",
          "old_text": "zval_ptr_dtor(recv_md)",
          "new_text": "add_property_zval(recv_status, \"metadata\", recv_md)",
          "old_line_content": "      zval_ptr_dtor(recv_md);",
          "new_line_content": "      add_property_zval(recv_status, \"metadata\", recv_md);",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": "PHP_GRPC_FREE_STD_ZVAL",
          "new_api": "zval_ptr_dtor",
          "old_text": "PHP_GRPC_FREE_STD_ZVAL(recv_md)",
          "new_text": "zval_ptr_dtor(recv_md)",
          "old_line_content": "      PHP_GRPC_FREE_STD_ZVAL(recv_md);",
          "new_line_content": "      zval_ptr_dtor(recv_md);",
          "content_same": false
        },
        {
          "line": 505,
          "old_api": "PHP_GRPC_DELREF",
          "new_api": "PHP_GRPC_FREE_STD_ZVAL",
          "old_text": "PHP_GRPC_DELREF(array)",
          "new_text": "PHP_GRPC_FREE_STD_ZVAL(recv_md)",
          "old_line_content": "      PHP_GRPC_DELREF(array);",
          "new_line_content": "      PHP_GRPC_FREE_STD_ZVAL(recv_md);",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": "add_property_long",
          "new_api": "PHP_GRPC_DELREF",
          "old_text": "add_property_long(recv_status, \"code\", status)",
          "new_text": "PHP_GRPC_DELREF(array)",
          "old_line_content": "      add_property_long(recv_status, \"code\", status);",
          "new_line_content": "      PHP_GRPC_DELREF(array);",
          "content_same": false
        },
        {
          "line": 507,
          "old_api": "grpc_slice_to_c_string",
          "new_api": "add_property_long",
          "old_text": "grpc_slice_to_c_string(recv_status_details)",
          "new_text": "add_property_long(recv_status, \"code\", status)",
          "old_line_content": "      char *status_details_text = grpc_slice_to_c_string(recv_status_details);",
          "new_line_content": "      add_property_long(recv_status, \"code\", status);",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": "php_grpc_add_property_string",
          "new_api": "grpc_slice_to_c_string",
          "old_text": "php_grpc_add_property_string(recv_status, \"details\", status_details_text,\n                                   true)",
          "new_text": "grpc_slice_to_c_string(recv_status_details)",
          "old_line_content": "      php_grpc_add_property_string(recv_status, \"details\", status_details_text,",
          "new_line_content": "      char *status_details_text = grpc_slice_to_c_string(recv_status_details);",
          "content_same": false
        },
        {
          "line": 511,
          "old_api": "add_property_zval",
          "new_api": "gpr_free",
          "old_text": "add_property_zval(result, \"status\", recv_status)",
          "new_text": "gpr_free(status_details_text)",
          "old_line_content": "      add_property_zval(result, \"status\", recv_status);",
          "new_line_content": "      gpr_free(status_details_text);",
          "content_same": false
        },
        {
          "line": 512,
          "old_api": "zval_ptr_dtor",
          "new_api": "add_property_zval",
          "old_text": "zval_ptr_dtor(recv_status)",
          "new_text": "add_property_zval(result, \"status\", recv_status)",
          "old_line_content": "      zval_ptr_dtor(recv_status);",
          "new_line_content": "      add_property_zval(result, \"status\", recv_status);",
          "content_same": false
        },
        {
          "line": 513,
          "old_api": "PHP_GRPC_DELREF",
          "new_api": "zval_ptr_dtor",
          "old_text": "PHP_GRPC_DELREF(recv_status)",
          "new_text": "zval_ptr_dtor(recv_status)",
          "old_line_content": "      PHP_GRPC_DELREF(recv_status);",
          "new_line_content": "      zval_ptr_dtor(recv_status);",
          "content_same": false
        },
        {
          "line": 514,
          "old_api": "PHP_GRPC_FREE_STD_ZVAL",
          "new_api": "PHP_GRPC_DELREF",
          "old_text": "PHP_GRPC_FREE_STD_ZVAL(recv_status)",
          "new_text": "PHP_GRPC_DELREF(recv_status)",
          "old_line_content": "      PHP_GRPC_FREE_STD_ZVAL(recv_status);",
          "new_line_content": "      PHP_GRPC_DELREF(recv_status);",
          "content_same": false
        },
        {
          "line": 527,
          "old_api": "grpc_metadata_array_destroy",
          "new_api": "grpc_php_metadata_array_destroy_including_entries",
          "old_text": "grpc_metadata_array_destroy(&recv_metadata)",
          "new_text": "grpc_php_metadata_array_destroy_including_entries(&trailing_metadata)",
          "old_line_content": "  grpc_metadata_array_destroy(&recv_metadata);",
          "new_line_content": "  grpc_php_metadata_array_destroy_including_entries(&trailing_metadata);",
          "content_same": false
        },
        {
          "line": 529,
          "old_api": "grpc_slice_unref",
          "new_api": "grpc_metadata_array_destroy",
          "old_text": "grpc_slice_unref(recv_status_details)",
          "new_text": "grpc_metadata_array_destroy(&recv_trailing_metadata)",
          "old_line_content": "  grpc_slice_unref(recv_status_details);",
          "new_line_content": "  grpc_metadata_array_destroy(&recv_trailing_metadata);",
          "content_same": false
        },
        {
          "line": 548,
          "old_api": "getThis",
          "new_api": "PHP_GRPC_GET_WRAPPED_OBJECT",
          "old_text": "getThis()",
          "new_text": "PHP_GRPC_GET_WRAPPED_OBJECT(wrapped_grpc_call,\n                                                        getThis())",
          "old_line_content": "                                                        getThis());",
          "new_line_content": "  wrapped_grpc_call *call = PHP_GRPC_GET_WRAPPED_OBJECT(wrapped_grpc_call,",
          "content_same": false
        },
        {
          "line": 549,
          "old_api": "grpc_call_get_peer",
          "new_api": "getThis",
          "old_text": "grpc_call_get_peer(call->wrapped)",
          "new_text": "getThis()",
          "old_line_content": "  char *peer = grpc_call_get_peer(call->wrapped);",
          "new_line_content": "                                                        getThis());",
          "content_same": false
        },
        {
          "line": 550,
          "old_api": "PHP_GRPC_RETVAL_STRING",
          "new_api": "grpc_call_get_peer",
          "old_text": "PHP_GRPC_RETVAL_STRING(peer, 1)",
          "new_text": "grpc_call_get_peer(call->wrapped)",
          "old_line_content": "  PHP_GRPC_RETVAL_STRING(peer, 1);",
          "new_line_content": "  char *peer = grpc_call_get_peer(call->wrapped);",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": "gpr_free",
          "new_api": "PHP_GRPC_RETVAL_STRING",
          "old_text": "gpr_free(peer)",
          "new_text": "PHP_GRPC_RETVAL_STRING(peer, 1)",
          "old_line_content": "  gpr_free(peer);",
          "new_line_content": "  PHP_GRPC_RETVAL_STRING(peer, 1);",
          "content_same": false
        },
        {
          "line": 561,
          "old_api": "getThis",
          "new_api": "PHP_GRPC_GET_WRAPPED_OBJECT",
          "old_text": "getThis()",
          "new_text": "PHP_GRPC_GET_WRAPPED_OBJECT(wrapped_grpc_call,\n                                                        getThis())",
          "old_line_content": "                                                        getThis());",
          "new_line_content": "  wrapped_grpc_call *call = PHP_GRPC_GET_WRAPPED_OBJECT(wrapped_grpc_call,",
          "content_same": false
        },
        {
          "line": 562,
          "old_api": "grpc_call_cancel",
          "new_api": "getThis",
          "old_text": "grpc_call_cancel(call->wrapped, NULL)",
          "new_text": "getThis()",
          "old_line_content": "  grpc_call_cancel(call->wrapped, NULL);",
          "new_line_content": "                                                        getThis());",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": "getThis",
          "new_api": "PHP_GRPC_GET_WRAPPED_OBJECT",
          "old_text": "getThis()",
          "new_text": "PHP_GRPC_GET_WRAPPED_OBJECT(wrapped_grpc_call,\n                                                        getThis())",
          "old_line_content": "                                                        getThis());",
          "new_line_content": "  wrapped_grpc_call *call = PHP_GRPC_GET_WRAPPED_OBJECT(wrapped_grpc_call,",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": "RETURN_LONG",
          "new_api": "grpc_call_set_credentials",
          "old_text": "RETURN_LONG(error)",
          "new_text": "grpc_call_set_credentials(call->wrapped, creds->wrapped)",
          "old_line_content": "  RETURN_LONG(error);",
          "new_line_content": "  error = grpc_call_set_credentials(call->wrapped, creds->wrapped);",
          "content_same": false
        },
        {
          "line": 593,
          "old_api": "ZEND_ARG_INFO",
          "new_api": "ZEND_BEGIN_ARG_INFO_EX",
          "old_text": "ZEND_ARG_INFO(0, channel)",
          "new_text": "ZEND_BEGIN_ARG_INFO_EX(arginfo_construct, 0, 0, 3)",
          "old_line_content": "  ZEND_ARG_INFO(0, channel)",
          "new_line_content": "ZEND_BEGIN_ARG_INFO_EX(arginfo_construct, 0, 0, 3)",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "ZEND_END_ARG_INFO",
          "new_api": "ZEND_ARG_INFO",
          "old_text": "ZEND_END_ARG_INFO()",
          "new_text": "ZEND_ARG_INFO(0, host_override)",
          "old_line_content": "ZEND_END_ARG_INFO()",
          "new_line_content": "  ZEND_ARG_INFO(0, host_override)",
          "content_same": false
        },
        {
          "line": 600,
          "old_api": "ZEND_ARG_INFO",
          "new_api": "ZEND_BEGIN_ARG_INFO_EX",
          "old_text": "ZEND_ARG_INFO(0, ops)",
          "new_text": "ZEND_BEGIN_ARG_INFO_EX(arginfo_startBatch, 0, 0, 1)",
          "old_line_content": "  ZEND_ARG_INFO(0, ops)",
          "new_line_content": "ZEND_BEGIN_ARG_INFO_EX(arginfo_startBatch, 0, 0, 1)",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": "ZEND_END_ARG_INFO",
          "new_api": "ZEND_ARG_INFO",
          "old_text": "ZEND_END_ARG_INFO()",
          "new_text": "ZEND_ARG_INFO(0, ops)",
          "old_line_content": "ZEND_END_ARG_INFO()",
          "new_line_content": "  ZEND_ARG_INFO(0, ops)",
          "content_same": false
        },
        {
          "line": 604,
          "old_api": "ZEND_END_ARG_INFO",
          "new_api": "ZEND_BEGIN_ARG_INFO_EX",
          "old_text": "ZEND_END_ARG_INFO()",
          "new_text": "ZEND_BEGIN_ARG_INFO_EX(arginfo_getPeer, 0, 0, 0)",
          "old_line_content": "ZEND_END_ARG_INFO()",
          "new_line_content": "ZEND_BEGIN_ARG_INFO_EX(arginfo_getPeer, 0, 0, 0)",
          "content_same": false
        },
        {
          "line": 607,
          "old_api": "ZEND_END_ARG_INFO",
          "new_api": "ZEND_BEGIN_ARG_INFO_EX",
          "old_text": "ZEND_END_ARG_INFO()",
          "new_text": "ZEND_BEGIN_ARG_INFO_EX(arginfo_cancel, 0, 0, 0)",
          "old_line_content": "ZEND_END_ARG_INFO()",
          "new_line_content": "ZEND_BEGIN_ARG_INFO_EX(arginfo_cancel, 0, 0, 0)",
          "content_same": false
        },
        {
          "line": 610,
          "old_api": "ZEND_ARG_INFO",
          "new_api": "ZEND_BEGIN_ARG_INFO_EX",
          "old_text": "ZEND_ARG_INFO(0, credentials)",
          "new_text": "ZEND_BEGIN_ARG_INFO_EX(arginfo_setCredentials, 0, 0, 1)",
          "old_line_content": "  ZEND_ARG_INFO(0, credentials)",
          "new_line_content": "ZEND_BEGIN_ARG_INFO_EX(arginfo_setCredentials, 0, 0, 1)",
          "content_same": false
        },
        {
          "line": 611,
          "old_api": "ZEND_END_ARG_INFO",
          "new_api": "ZEND_ARG_INFO",
          "old_text": "ZEND_END_ARG_INFO()",
          "new_text": "ZEND_ARG_INFO(0, credentials)",
          "old_line_content": "ZEND_END_ARG_INFO()",
          "new_line_content": "  ZEND_ARG_INFO(0, credentials)",
          "content_same": false
        },
        {
          "line": 629,
          "old_api": "zend_string_init",
          "new_api": "ZVAL_NULL",
          "old_text": "zend_string_init(\"channel\", sizeof(\"channel\") - 1, 1)",
          "new_text": "ZVAL_NULL(&property_channel_default_value)",
          "old_line_content": "  zend_string *property_channel_name = zend_string_init(\"channel\", sizeof(\"channel\") - 1, 1);",
          "new_line_content": "  ZVAL_NULL(&property_channel_default_value);",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": "zend_declare_property_ex",
          "new_api": "zend_string_init",
          "old_text": "zend_declare_property_ex(grpc_ce_call, property_channel_name, &property_channel_default_value, ZEND_ACC_PROTECTED, NULL)",
          "new_text": "zend_string_init(\"channel\", sizeof(\"channel\") - 1, 1)",
          "old_line_content": "  zend_declare_property_ex(grpc_ce_call, property_channel_name, &property_channel_default_value, ZEND_ACC_PROTECTED, NULL);",
          "new_line_content": "  zend_string *property_channel_name = zend_string_init(\"channel\", sizeof(\"channel\") - 1, 1);",
          "content_same": false
        },
        {
          "line": 631,
          "old_api": "zend_string_release",
          "new_api": "zend_declare_property_ex",
          "old_text": "zend_string_release(property_channel_name)",
          "new_text": "zend_declare_property_ex(grpc_ce_call, property_channel_name, &property_channel_default_value, ZEND_ACC_PROTECTED, NULL)",
          "old_line_content": "  zend_string_release(property_channel_name);",
          "new_line_content": "  zend_declare_property_ex(grpc_ce_call, property_channel_name, &property_channel_default_value, ZEND_ACC_PROTECTED, NULL);",
          "content_same": false
        },
        {
          "line": 632,
          "old_api": "PHP_GRPC_INIT_HANDLER",
          "new_api": "zend_string_release",
          "old_text": "PHP_GRPC_INIT_HANDLER(wrapped_grpc_call, call_ce_handlers)",
          "new_text": "zend_string_release(property_channel_name)",
          "old_line_content": "  PHP_GRPC_INIT_HANDLER(wrapped_grpc_call, call_ce_handlers);",
          "new_line_content": "  zend_string_release(property_channel_name);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 515,
          "old_api": null,
          "new_api": "PHP_GRPC_FREE_STD_ZVAL",
          "old_text": null,
          "new_text": "PHP_GRPC_FREE_STD_ZVAL(recv_status)",
          "old_line_content": "      break;",
          "new_line_content": "      PHP_GRPC_FREE_STD_ZVAL(recv_status);",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": null,
          "new_api": "add_property_bool",
          "old_text": null,
          "new_text": "add_property_bool(result, \"cancelled\", cancelled)",
          "old_line_content": "      break;",
          "new_line_content": "      add_property_bool(result, \"cancelled\", cancelled);",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": null,
          "new_api": "grpc_slice_unref",
          "old_text": null,
          "new_text": "grpc_slice_unref(send_status_details)",
          "old_line_content": "  for (int i = 0; i < op_num; i++) {",
          "new_line_content": "  grpc_slice_unref(send_status_details);",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": null,
          "new_api": "grpc_byte_buffer_destroy",
          "old_text": null,
          "new_text": "grpc_byte_buffer_destroy(ops[i].data.send_message.send_message)",
          "old_line_content": "    }",
          "new_line_content": "      grpc_byte_buffer_destroy(ops[i].data.send_message.send_message);",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": null,
          "new_api": "grpc_byte_buffer_destroy",
          "old_text": null,
          "new_text": "grpc_byte_buffer_destroy(message)",
          "old_line_content": "    }",
          "new_line_content": "      grpc_byte_buffer_destroy(message);",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": null,
          "new_api": "RETURN_DESTROY_ZVAL",
          "old_text": null,
          "new_text": "RETURN_DESTROY_ZVAL(result)",
          "old_line_content": "}",
          "new_line_content": "  RETURN_DESTROY_ZVAL(result);",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": null,
          "new_api": "gpr_free",
          "old_text": null,
          "new_text": "gpr_free(peer)",
          "old_line_content": "}",
          "new_line_content": "  gpr_free(peer);",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": null,
          "new_api": "grpc_call_cancel",
          "old_text": null,
          "new_text": "grpc_call_cancel(call->wrapped, NULL)",
          "old_line_content": "}",
          "new_line_content": "  grpc_call_cancel(call->wrapped, NULL);",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": null,
          "new_api": "ZEND_NUM_ARGS",
          "old_text": null,
          "new_text": "ZEND_NUM_ARGS()",
          "old_line_content": "                            grpc_ce_call_credentials) == FAILURE) {",
          "new_line_content": "  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"O\", &creds_obj,",
          "content_same": false
        },
        {
          "line": 577,
          "old_api": null,
          "new_api": "zend_throw_exception",
          "old_text": null,
          "new_text": "zend_throw_exception(spl_ce_InvalidArgumentException,\n                         \"setCredentials expects 1 CallCredentials\",\n                         1 TSRMLS_CC)",
          "old_line_content": "                         \"setCredentials expects 1 CallCredentials\",",
          "new_line_content": "    zend_throw_exception(spl_ce_InvalidArgumentException,",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": null,
          "new_api": "grpc_call_start_batch",
          "old_text": null,
          "new_text": "grpc_call_start_batch(wrapped, ops, op_num, wrapped,\n                                NULL)",
          "old_line_content": "                                NULL);",
          "new_line_content": "  error = grpc_call_start_batch(wrapped, ops, op_num, wrapped,",
          "content_same": false
        },
        {
          "line": 586,
          "old_api": null,
          "new_api": "getThis",
          "old_text": null,
          "new_text": "getThis()",
          "old_line_content": "",
          "new_line_content": "                                                        getThis());",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": null,
          "new_api": "zend_throw_exception",
          "old_text": null,
          "new_text": "zend_throw_exception(spl_ce_LogicException,\n                         \"start_batch was called incorrectly\",\n                         (long)error TSRMLS_CC)",
          "old_line_content": "                         \"start_batch was called incorrectly\",",
          "new_line_content": "    zend_throw_exception(spl_ce_LogicException,",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": null,
          "new_api": "RETURN_LONG",
          "old_text": null,
          "new_text": "RETURN_LONG(error)",
          "old_line_content": "}",
          "new_line_content": "  RETURN_LONG(error);",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": null,
          "new_api": "gpr_inf_future",
          "old_text": null,
          "new_text": "gpr_inf_future(GPR_CLOCK_REALTIME)",
          "old_line_content": "  zval *recv_md;",
          "new_line_content": "                              gpr_inf_future(GPR_CLOCK_REALTIME), NULL);",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": null,
          "new_api": "add_property_bool",
          "old_text": null,
          "new_text": "add_property_bool(result, \"send_metadata\", true)",
          "old_line_content": "      break;",
          "new_line_content": "      add_property_bool(result, \"send_metadata\", true);",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": null,
          "new_api": "ZEND_END_ARG_INFO",
          "old_text": null,
          "new_text": "ZEND_END_ARG_INFO()",
          "old_line_content": "",
          "new_line_content": "ZEND_END_ARG_INFO()",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": null,
          "new_api": "add_property_bool",
          "old_text": null,
          "new_text": "add_property_bool(result, \"send_message\", true)",
          "old_line_content": "      break;",
          "new_line_content": "      add_property_bool(result, \"send_message\", true);",
          "content_same": false
        },
        {
          "line": 602,
          "old_api": null,
          "new_api": "ZEND_END_ARG_INFO",
          "old_text": null,
          "new_text": "ZEND_END_ARG_INFO()",
          "old_line_content": "",
          "new_line_content": "ZEND_END_ARG_INFO()",
          "content_same": false
        },
        {
          "line": 475,
          "old_api": null,
          "new_api": "add_property_bool",
          "old_text": null,
          "new_text": "add_property_bool(result, \"send_close\", true)",
          "old_line_content": "      break;",
          "new_line_content": "      add_property_bool(result, \"send_close\", true);",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": null,
          "new_api": "ZEND_END_ARG_INFO",
          "old_text": null,
          "new_text": "ZEND_END_ARG_INFO()",
          "old_line_content": "",
          "new_line_content": "ZEND_END_ARG_INFO()",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": null,
          "new_api": "add_property_bool",
          "old_text": null,
          "new_text": "add_property_bool(result, \"send_status\", true)",
          "old_line_content": "      break;",
          "new_line_content": "      add_property_bool(result, \"send_status\", true);",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "ZEND_END_ARG_INFO",
          "old_text": null,
          "new_text": "ZEND_END_ARG_INFO()",
          "old_line_content": "",
          "new_line_content": "ZEND_END_ARG_INFO()",
          "content_same": false
        },
        {
          "line": 612,
          "old_api": null,
          "new_api": "ZEND_END_ARG_INFO",
          "old_text": null,
          "new_text": "ZEND_END_ARG_INFO()",
          "old_line_content": "",
          "new_line_content": "ZEND_END_ARG_INFO()",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": null,
          "new_api": "PHP_GRPC_DELREF",
          "old_text": null,
          "new_text": "PHP_GRPC_DELREF(array)",
          "old_line_content": "      break;",
          "new_line_content": "      PHP_GRPC_DELREF(array);",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": null,
          "new_api": "byte_buffer_to_zend_string",
          "old_text": null,
          "new_text": "byte_buffer_to_zend_string(message)",
          "old_line_content": "",
          "new_line_content": "      zmessage = byte_buffer_to_zend_string(message);",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": null,
          "new_api": "add_property_null",
          "old_text": null,
          "new_text": "add_property_null(result, \"message\")",
          "old_line_content": "      } else {",
          "new_line_content": "        add_property_null(result, \"message\");",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": null,
          "new_api": "zval_ptr_dtor",
          "old_text": null,
          "new_text": "zval_ptr_dtor(&zmessage_val)",
          "old_line_content": "      }",
          "new_line_content": "        zval_ptr_dtor(&zmessage_val);",
          "content_same": false
        },
        {
          "line": 625,
          "old_api": null,
          "new_api": "INIT_CLASS_ENTRY",
          "old_text": null,
          "new_text": "INIT_CLASS_ENTRY(ce, \"Grpc\\\\Call\", call_methods)",
          "old_line_content": "  ce.create_object = create_wrapped_grpc_call;",
          "new_line_content": "  INIT_CLASS_ENTRY(ce, \"Grpc\\\\Call\", call_methods);",
          "content_same": false
        },
        {
          "line": 627,
          "old_api": null,
          "new_api": "zend_register_internal_class",
          "old_text": null,
          "new_text": "zend_register_internal_class(&ce TSRMLS_CC)",
          "old_line_content": "  zval property_channel_default_value;",
          "new_line_content": "  grpc_ce_call = zend_register_internal_class(&ce TSRMLS_CC);",
          "content_same": false
        },
        {
          "line": 633,
          "old_api": null,
          "new_api": "PHP_GRPC_INIT_HANDLER",
          "old_text": null,
          "new_text": "PHP_GRPC_INIT_HANDLER(wrapped_grpc_call, call_ce_handlers)",
          "old_line_content": "}",
          "new_line_content": "  PHP_GRPC_INIT_HANDLER(wrapped_grpc_call, call_ce_handlers);",
          "content_same": false
        },
        {
          "line": 509,
          "old_api": null,
          "new_api": "php_grpc_add_property_string",
          "old_text": null,
          "new_text": "php_grpc_add_property_string(recv_status, \"details\", status_details_text,\n                                   true)",
          "old_line_content": "                                   true);",
          "new_line_content": "      php_grpc_add_property_string(recv_status, \"details\", status_details_text,",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 517,
          "old_api": "add_property_bool",
          "new_api": null,
          "old_text": "add_property_bool(result, \"cancelled\", cancelled)",
          "new_text": null,
          "old_line_content": "      add_property_bool(result, \"cancelled\", cancelled);",
          "new_line_content": "    case GRPC_OP_RECV_CLOSE_ON_SERVER:",
          "content_same": false
        },
        {
          "line": 525,
          "old_api": "grpc_php_metadata_array_destroy_including_entries",
          "new_api": null,
          "old_text": "grpc_php_metadata_array_destroy_including_entries(&metadata)",
          "new_text": null,
          "old_line_content": "  grpc_php_metadata_array_destroy_including_entries(&metadata);",
          "new_line_content": "cleanup:",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": "grpc_byte_buffer_destroy",
          "new_api": null,
          "old_text": "grpc_byte_buffer_destroy(ops[i].data.send_message.send_message)",
          "new_text": null,
          "old_line_content": "      grpc_byte_buffer_destroy(ops[i].data.send_message.send_message);",
          "new_line_content": "    if (ops[i].op == GRPC_OP_SEND_MESSAGE) {",
          "content_same": false
        },
        {
          "line": 536,
          "old_api": "grpc_byte_buffer_destroy",
          "new_api": null,
          "old_text": "grpc_byte_buffer_destroy(message)",
          "new_text": null,
          "old_line_content": "      grpc_byte_buffer_destroy(message);",
          "new_line_content": "    if (ops[i].op == GRPC_OP_RECV_MESSAGE) {",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": "RETURN_DESTROY_ZVAL",
          "new_api": null,
          "old_text": "RETURN_DESTROY_ZVAL(result)",
          "new_text": null,
          "old_line_content": "  RETURN_DESTROY_ZVAL(result);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 547,
          "old_api": "PHP_GRPC_GET_WRAPPED_OBJECT",
          "new_api": null,
          "old_text": "PHP_GRPC_GET_WRAPPED_OBJECT(wrapped_grpc_call,\n                                                        getThis())",
          "new_text": null,
          "old_line_content": "  wrapped_grpc_call *call = PHP_GRPC_GET_WRAPPED_OBJECT(wrapped_grpc_call,",
          "new_line_content": "PHP_METHOD(Call, getPeer) {",
          "content_same": false
        },
        {
          "line": 560,
          "old_api": "PHP_GRPC_GET_WRAPPED_OBJECT",
          "new_api": null,
          "old_text": "PHP_GRPC_GET_WRAPPED_OBJECT(wrapped_grpc_call,\n                                                        getThis())",
          "new_text": null,
          "old_line_content": "  wrapped_grpc_call *call = PHP_GRPC_GET_WRAPPED_OBJECT(wrapped_grpc_call,",
          "new_line_content": "PHP_METHOD(Call, cancel) {",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": "ZEND_NUM_ARGS",
          "new_api": null,
          "old_text": "ZEND_NUM_ARGS()",
          "new_text": null,
          "old_line_content": "  if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, \"O\", &creds_obj,",
          "new_line_content": "  /* \"O\" == 1 Object */",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": "zend_throw_exception",
          "new_api": null,
          "old_text": "zend_throw_exception(spl_ce_InvalidArgumentException,\n                         \"setCredentials expects 1 CallCredentials\",\n                         1 TSRMLS_CC)",
          "new_text": null,
          "old_line_content": "    zend_throw_exception(spl_ce_InvalidArgumentException,",
          "new_line_content": "                            grpc_ce_call_credentials) == FAILURE) {",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": "grpc_call_start_batch",
          "new_api": null,
          "old_text": "grpc_call_start_batch(call->wrapped, ops, op_num, call->wrapped,\n                                NULL)",
          "new_text": null,
          "old_line_content": "  error = grpc_call_start_batch(call->wrapped, ops, op_num, call->wrapped,",
          "new_line_content": "  grpc_call *wrapped = call->wrapped;",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": "PHP_GRPC_GET_WRAPPED_OBJECT",
          "new_api": null,
          "old_text": "PHP_GRPC_GET_WRAPPED_OBJECT(wrapped_grpc_call_credentials, creds_obj)",
          "new_text": null,
          "old_line_content": "    PHP_GRPC_GET_WRAPPED_OBJECT(wrapped_grpc_call_credentials, creds_obj);",
          "new_line_content": "  wrapped_grpc_call_credentials *creds =",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": "zend_throw_exception",
          "new_api": null,
          "old_text": "zend_throw_exception(spl_ce_LogicException,\n                         \"start_batch was called incorrectly\",\n                         (long)error TSRMLS_CC)",
          "new_text": null,
          "old_line_content": "    zend_throw_exception(spl_ce_LogicException,",
          "new_line_content": "  if (error != GRPC_CALL_OK) {",
          "content_same": false
        },
        {
          "line": 588,
          "old_api": "grpc_call_set_credentials",
          "new_api": null,
          "old_text": "grpc_call_set_credentials(call->wrapped, creds->wrapped)",
          "new_text": null,
          "old_line_content": "  error = grpc_call_set_credentials(call->wrapped, creds->wrapped);",
          "new_line_content": "  grpc_call_error error = GRPC_CALL_ERROR;",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": "grpc_completion_queue_pluck",
          "new_api": null,
          "old_text": "grpc_completion_queue_pluck(completion_queue, call->wrapped,\n                              gpr_inf_future(GPR_CLOCK_REALTIME), NULL)",
          "new_text": null,
          "old_line_content": "  grpc_completion_queue_pluck(completion_queue, call->wrapped,",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": "ZEND_BEGIN_ARG_INFO_EX",
          "new_api": null,
          "old_text": "ZEND_BEGIN_ARG_INFO_EX(arginfo_construct, 0, 0, 3)",
          "new_text": null,
          "old_line_content": "ZEND_BEGIN_ARG_INFO_EX(arginfo_construct, 0, 0, 3)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": "add_property_bool",
          "new_api": null,
          "old_text": "add_property_bool(result, \"send_metadata\", true)",
          "new_text": null,
          "old_line_content": "      add_property_bool(result, \"send_metadata\", true);",
          "new_line_content": "    case GRPC_OP_SEND_INITIAL_METADATA:",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": "ZEND_BEGIN_ARG_INFO_EX",
          "new_api": null,
          "old_text": "ZEND_BEGIN_ARG_INFO_EX(arginfo_startBatch, 0, 0, 1)",
          "new_text": null,
          "old_line_content": "ZEND_BEGIN_ARG_INFO_EX(arginfo_startBatch, 0, 0, 1)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": "add_property_bool",
          "new_api": null,
          "old_text": "add_property_bool(result, \"send_message\", true)",
          "new_text": null,
          "old_line_content": "      add_property_bool(result, \"send_message\", true);",
          "new_line_content": "    case GRPC_OP_SEND_MESSAGE:",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": "add_property_bool",
          "new_api": null,
          "old_text": "add_property_bool(result, \"send_close\", true)",
          "new_text": null,
          "old_line_content": "      add_property_bool(result, \"send_close\", true);",
          "new_line_content": "    case GRPC_OP_SEND_CLOSE_FROM_CLIENT:",
          "content_same": false
        },
        {
          "line": 603,
          "old_api": "ZEND_BEGIN_ARG_INFO_EX",
          "new_api": null,
          "old_text": "ZEND_BEGIN_ARG_INFO_EX(arginfo_getPeer, 0, 0, 0)",
          "new_text": null,
          "old_line_content": "ZEND_BEGIN_ARG_INFO_EX(arginfo_getPeer, 0, 0, 0)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": "add_property_bool",
          "new_api": null,
          "old_text": "add_property_bool(result, \"send_status\", true)",
          "new_text": null,
          "old_line_content": "      add_property_bool(result, \"send_status\", true);",
          "new_line_content": "    case GRPC_OP_SEND_STATUS_FROM_SERVER:",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": "ZEND_BEGIN_ARG_INFO_EX",
          "new_api": null,
          "old_text": "ZEND_BEGIN_ARG_INFO_EX(arginfo_cancel, 0, 0, 0)",
          "new_text": null,
          "old_line_content": "ZEND_BEGIN_ARG_INFO_EX(arginfo_cancel, 0, 0, 0)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": "grpc_parse_metadata_array",
          "new_api": null,
          "old_text": "grpc_parse_metadata_array(&recv_metadata)",
          "new_text": null,
          "old_line_content": "      recv_md = grpc_parse_metadata_array(&recv_metadata);",
          "new_line_content": "    case GRPC_OP_RECV_INITIAL_METADATA:",
          "content_same": false
        },
        {
          "line": 609,
          "old_api": "ZEND_BEGIN_ARG_INFO_EX",
          "new_api": null,
          "old_text": "ZEND_BEGIN_ARG_INFO_EX(arginfo_setCredentials, 0, 0, 1)",
          "new_text": null,
          "old_line_content": "ZEND_BEGIN_ARG_INFO_EX(arginfo_setCredentials, 0, 0, 1)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": "byte_buffer_to_zend_string",
          "new_api": null,
          "old_text": "byte_buffer_to_zend_string(message)",
          "new_text": null,
          "old_line_content": "      zmessage = byte_buffer_to_zend_string(message);",
          "new_line_content": "    case GRPC_OP_RECV_MESSAGE:",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": "add_property_null",
          "new_api": null,
          "old_text": "add_property_null(result, \"message\")",
          "new_text": null,
          "old_line_content": "        add_property_null(result, \"message\");",
          "new_line_content": "      if (zmessage == NULL) {",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": "ZVAL_NEW_STR",
          "new_api": null,
          "old_text": "ZVAL_NEW_STR(&zmessage_val, zmessage)",
          "new_text": null,
          "old_line_content": "        ZVAL_NEW_STR(&zmessage_val, zmessage);",
          "new_line_content": "        zval zmessage_val;",
          "content_same": false
        },
        {
          "line": 624,
          "old_api": "INIT_CLASS_ENTRY",
          "new_api": null,
          "old_text": "INIT_CLASS_ENTRY(ce, \"Grpc\\\\Call\", call_methods)",
          "new_text": null,
          "old_line_content": "  INIT_CLASS_ENTRY(ce, \"Grpc\\\\Call\", call_methods);",
          "new_line_content": "  zend_class_entry ce;",
          "content_same": false
        },
        {
          "line": 626,
          "old_api": "zend_register_internal_class",
          "new_api": null,
          "old_text": "zend_register_internal_class(&ce TSRMLS_CC)",
          "new_text": null,
          "old_line_content": "  grpc_ce_call = zend_register_internal_class(&ce TSRMLS_CC);",
          "new_line_content": "  ce.create_object = create_wrapped_grpc_call;",
          "content_same": false
        },
        {
          "line": 499,
          "old_api": "PHP_GRPC_MAKE_STD_ZVAL",
          "new_api": null,
          "old_text": "PHP_GRPC_MAKE_STD_ZVAL(recv_status)",
          "new_text": null,
          "old_line_content": "      PHP_GRPC_MAKE_STD_ZVAL(recv_status);",
          "new_line_content": "    case GRPC_OP_RECV_STATUS_ON_CLIENT:",
          "content_same": false
        },
        {
          "line": 628,
          "old_api": "ZVAL_NULL",
          "new_api": null,
          "old_text": "ZVAL_NULL(&property_channel_default_value)",
          "new_text": null,
          "old_line_content": "  ZVAL_NULL(&property_channel_default_value);",
          "new_line_content": "  zval property_channel_default_value;",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": "gpr_free",
          "new_api": null,
          "old_text": "gpr_free(status_details_text)",
          "new_text": null,
          "old_line_content": "      gpr_free(status_details_text);",
          "new_line_content": "                                   true);",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 42,
      "total_additions": 32,
      "total_deletions": 32,
      "total_api_changes": 106
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 4,
        "api_related_lines": 106,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 218,
    "api_calls_after": 218,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 2,
      "total_diff_lines": 24
    }
  }
}