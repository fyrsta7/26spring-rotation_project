{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/grpc/modified_file/c8d5db17173318ff5efe3e0721bca3340251f738",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/grpc/modified_file/c8d5db17173318ff5efe3e0721bca3340251f738/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/grpc/modified_file/c8d5db17173318ff5efe3e0721bca3340251f738/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/grpc/modified_file/c8d5db17173318ff5efe3e0721bca3340251f738/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 471,
          "old_api": "ic_cast<size_t>(read_bytes) < t",
          "new_api": "ic_cast<size_t>(read_bytes) ==",
          "old_text": "ic_cast<size_t>(read_bytes) < t",
          "new_text": "ic_cast<size_t>(read_bytes) == ",
          "old_line_content": "    if (static_cast<size_t>(read_bytes) < tcp->incoming_buffer->length) {",
          "new_line_content": "    if (static_cast<size_t>(read_bytes) == tcp->incoming_buffer->length) {",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": "_slice_buffer_trim_end",
          "new_api": "sh_estimate",
          "old_text": "_slice_buffer_trim_end(\n          tcp->incoming_buffer,\n          tcp->incoming_buffer->length - static_cast<size_t>(read_bytes),\n          &tcp->last_read_buffer);\n  ",
          "new_text": "sh_estimate(tcp);\n  ",
          "old_line_content": "      grpc_slice_buffer_trim_end(",
          "new_line_content": "      finish_estimate(tcp);",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": "ic_cast<size_t>(read_bytes),",
          "new_api": "_slice_buffer_trim_end",
          "old_text": "ic_cast<size_t>(read_bytes),\n  ",
          "new_text": "_slice_buffer_trim_end(\n          tcp->incoming_buffer,\n          tcp->incoming_buffer->length - static_cast<size_t>(read_bytes),\n          &tcp->last_read_buffer);\n  ",
          "old_line_content": "          tcp->incoming_buffer->length - static_cast<size_t>(read_bytes),",
          "new_line_content": "      grpc_slice_buffer_trim_end(",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": "UNREF",
          "new_api": "ASSERT",
          "old_text": "UNREF(tcp, \"read\");\n  ",
          "new_text": "ASSERT((size_t)read_bytes == tcp->incoming_buffer->length);\n  ",
          "old_line_content": "    TCP_UNREF(tcp, \"read\");",
          "new_line_content": "    GPR_ASSERT((size_t)read_bytes == tcp->incoming_buffer->length);",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": "log",
          "new_api": "ic_cast<grpc_tcp*>(tcpp);",
          "old_text": "log(GPR_INFO, \"TCP:%p read_allocation_done: %s\", tcp,\n            grpc_error_string(error));\n  ",
          "new_text": "ic_cast<grpc_tcp*>(tcpp);\n  ",
          "old_line_content": "    gpr_log(GPR_INFO, \"TCP:%p read_allocation_done: %s\", tcp,",
          "new_line_content": "  grpc_tcp* tcp = static_cast<grpc_tcp*>(tcpp);",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": "_error_string",
          "new_api": "enabled",
          "old_text": "_error_string(error));\n ",
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "            grpc_error_string(error));",
          "new_line_content": "  if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": "_ERROR_REF",
          "new_api": "_slice_buffer_reset_and_unref_internal",
          "old_text": "_ERROR_REF(error));\n ",
          "new_text": "_slice_buffer_reset_and_unref_internal(tcp->incoming_buffer);\n  ",
          "old_line_content": "    call_read_cb(tcp, GRPC_ERROR_REF(error));",
          "new_line_content": "    grpc_slice_buffer_reset_and_unref_internal(tcp->incoming_buffer);",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": "UNREF",
          "new_api": "_slice_buffer_reset_and_unref_internal",
          "old_text": "UNREF(tcp, \"read\");\n  ",
          "new_text": "_slice_buffer_reset_and_unref_internal(&tcp->last_read_buffer);\n  ",
          "old_line_content": "    TCP_UNREF(tcp, \"read\");",
          "new_line_content": "    grpc_slice_buffer_reset_and_unref_internal(&tcp->last_read_buffer);",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": "do_read",
          "new_api": "UNREF",
          "old_text": "do_read(tcp);\n  ",
          "new_text": "UNREF(tcp, \"read\");\n  ",
          "old_line_content": "    tcp_do_read(tcp);",
          "new_line_content": "    TCP_UNREF(tcp, \"read\");",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": "_resource_user_alloc_slices",
          "new_api": "log",
          "old_text": "_resource_user_alloc_slices(&tcp->slice_allocator, target_read_size, 1,\n                                    tcp->incoming_buffer);\n  ",
          "new_text": "log(GPR_INFO, \"TCP:%p alloc_slices\", tcp);\n  ",
          "old_line_content": "    grpc_resource_user_alloc_slices(&tcp->slice_allocator, target_read_size, 1,",
          "new_line_content": "      gpr_log(GPR_INFO, \"TCP:%p alloc_slices\", tcp);",
          "content_same": false
        },
        {
          "line": 512,
          "old_api": "do_read",
          "new_api": "log",
          "old_text": "do_read(tcp);\n  ",
          "new_text": "log(GPR_INFO, \"TCP:%p do_read\", tcp);\n  ",
          "old_line_content": "    tcp_do_read(tcp);",
          "new_line_content": "      gpr_log(GPR_INFO, \"TCP:%p do_read\", tcp);",
          "content_same": false
        },
        {
          "line": 519,
          "old_api": "_error_string",
          "new_api": "ic_cast<grpc_tcp*>(arg);",
          "old_text": "_error_string(error));\n ",
          "new_text": "ic_cast<grpc_tcp*>(arg);\n  ",
          "old_line_content": "    gpr_log(GPR_INFO, \"TCP:%p got_read: %s\", tcp, grpc_error_string(error));",
          "new_line_content": "  grpc_tcp* tcp = static_cast<grpc_tcp*>(arg);",
          "content_same": false
        },
        {
          "line": 525,
          "old_api": "_ERROR_REF",
          "new_api": "_slice_buffer_reset_and_unref_internal",
          "old_text": "_ERROR_REF(error));\n ",
          "new_text": "_slice_buffer_reset_and_unref_internal(tcp->incoming_buffer);\n  ",
          "old_line_content": "    call_read_cb(tcp, GRPC_ERROR_REF(error));",
          "new_line_content": "    grpc_slice_buffer_reset_and_unref_internal(tcp->incoming_buffer);",
          "content_same": false
        },
        {
          "line": 526,
          "old_api": "UNREF",
          "new_api": "_slice_buffer_reset_and_unref_internal",
          "old_text": "UNREF(tcp, \"read\");\n  ",
          "new_text": "_slice_buffer_reset_and_unref_internal(&tcp->last_read_buffer);\n  ",
          "old_line_content": "    TCP_UNREF(tcp, \"read\");",
          "new_line_content": "    grpc_slice_buffer_reset_and_unref_internal(&tcp->last_read_buffer);",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": "continue_read",
          "new_api": "UNREF",
          "old_text": "continue_read(tcp);\n  ",
          "new_text": "UNREF(tcp, \"read\");\n  ",
          "old_line_content": "    tcp_continue_read(tcp);",
          "new_line_content": "    TCP_UNREF(tcp, \"read\");",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": "REF",
          "new_api": "_slice_buffer_reset_and_unref_internal",
          "old_text": "REF(tcp, \"read\");\n  ",
          "new_text": "_slice_buffer_reset_and_unref_internal(incoming_buffer);\n  ",
          "old_line_content": "  TCP_REF(tcp, \"read\");",
          "new_line_content": "  grpc_slice_buffer_reset_and_unref_internal(incoming_buffer);",
          "content_same": false
        },
        {
          "line": 591,
          "old_api": "_OS_ERROR",
          "new_api": "ockopt",
          "old_text": "_OS_ERROR(errno, \"setsockopt\"), tc",
          "new_text": "ockopt(tcp->fd, SOL_SOCKET, SO_TIMESTAMPING,\n                   static_cast<void*>(&opt), sizeof(opt)) != ",
          "old_line_content": "      *error = tcp_annotate_error(GRPC_OS_ERROR(errno, \"setsockopt\"), tcp);",
          "new_line_content": "    if (setsockopt(tcp->fd, SOL_SOCKET, SO_TIMESTAMPING,",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": "_slice_buffer_reset_and_unref_internal",
          "new_api": "ic_cast<void*>(&opt), si",
          "old_text": "_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);\n  ",
          "new_text": "ic_cast<void*>(&opt), si",
          "old_line_content": "      grpc_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);",
          "new_line_content": "                   static_cast<void*>(&opt), sizeof(opt)) != 0) {",
          "content_same": false
        },
        {
          "line": 593,
          "old_api": "enabled",
          "new_api": "_OS_ERROR",
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": "_OS_ERROR(errno, \"setsockopt\"), tc",
          "old_line_content": "      if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "      *error = tcp_annotate_error(GRPC_OS_ERROR(errno, \"setsockopt\"), tcp);",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": "log",
          "new_api": "_slice_buffer_reset_and_unref_internal",
          "old_text": "log(GPR_ERROR, \"Failed to set timestamping options on the socket.\");\n  ",
          "new_text": "_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);\n  ",
          "old_line_content": "        gpr_log(GPR_ERROR, \"Failed to set timestamping options on the socket.\");",
          "new_line_content": "      grpc_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": "_core::TracedBuffer::AddNewEntry(\n        &tcp->tb_head, static_cast<int>(tcp->bytes_counter + length),\n        tcp->outgoing_buffer_arg);",
          "new_api": "ic_cast<size_t>(length)) {",
          "old_text": "_core::TracedBuffer::AddNewEntry(\n        &tcp->tb_head, static_cast<int>(tcp->bytes_counter + length),\n        tcp->outgoing_buffer_arg);\n  ",
          "new_text": "ic_cast<size_t>(length)) {\n",
          "old_line_content": "    grpc_core::TracedBuffer::AddNewEntry(",
          "new_line_content": "  if (sending_length == static_cast<size_t>(length)) {",
          "content_same": false
        },
        {
          "line": 622,
          "old_api": "ic_cast<int>(tcp->bytes_counter + length),",
          "new_api": "mu_lock",
          "old_text": "ic_cast<int>(tcp->bytes_counter + length),\n  ",
          "new_text": "mu_lock(&tcp->tb_mu);\n  ",
          "old_line_content": "        &tcp->tb_head, static_cast<int>(tcp->bytes_counter + length),",
          "new_line_content": "    gpr_mu_lock(&tcp->tb_mu);",
          "content_same": false
        },
        {
          "line": 624,
          "old_api": "mu_unlock",
          "new_api": "ic_cast<int>(tcp->bytes_counter + length),",
          "old_text": "mu_unlock(&tcp->tb_mu);\n  ",
          "new_text": "ic_cast<int>(tcp->bytes_counter + length),\n  ",
          "old_line_content": "    gpr_mu_unlock(&tcp->tb_mu);",
          "new_line_content": "        &tcp->tb_head, static_cast<int>(tcp->bytes_counter + length),",
          "content_same": false
        },
        {
          "line": 641,
          "old_api": "enabled",
          "new_api": "_NXTHDR",
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": "_NXTHDR(msg, cmsg);\n  ",
          "old_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "  auto next_cmsg = CMSG_NXTHDR(msg, cmsg);",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": "mu_unlock",
          "new_api": "mu_lock",
          "old_text": "mu_unlock(&tcp->tb_mu);\n  ",
          "new_text": "mu_lock(&tcp->tb_mu);\n  ",
          "old_line_content": "  gpr_mu_unlock(&tcp->tb_mu);",
          "new_line_content": "  gpr_mu_lock(&tcp->tb_mu);",
          "content_same": false
        },
        {
          "line": 714,
          "old_api": "log",
          "new_api": "enabled",
          "old_text": "log(GPR_INFO, \"Error message was truncated.\");\n  ",
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "        gpr_log(GPR_INFO, \"Error message was truncated.\");",
          "new_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 743,
          "old_api": "_error_string",
          "new_api": "ic_cast<grpc_tcp*>(arg);",
          "old_text": "_error_string(error));\n ",
          "new_text": "ic_cast<grpc_tcp*>(arg);\n  ",
          "old_line_content": "    gpr_log(GPR_INFO, \"TCP:%p got_error: %s\", tcp, grpc_error_string(error));",
          "new_line_content": "  grpc_tcp* tcp = static_cast<grpc_tcp*>(arg);",
          "content_same": false
        },
        {
          "line": 764,
          "old_api": "_CLOSURE_INIT",
          "new_api": "_fd_set_writable",
          "old_text": "_CLOSURE_INIT(&tcp->error_closure, tcp_handle_error, tcp,\n                    grpc_schedule_on_exec_ctx);\n  ",
          "new_text": "_fd_set_writable(tcp->em_fd);\n  ",
          "old_line_content": "  GRPC_CLOSURE_INIT(&tcp->error_closure, tcp_handle_error, tcp,",
          "new_line_content": "    grpc_fd_set_writable(tcp->em_fd);",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": "_fd_notify_on_error",
          "new_api": "_CLOSURE_INIT",
          "old_text": "_fd_notify_on_error(tcp->em_fd, &tcp->error_closure);\n}\n",
          "new_text": "_CLOSURE_INIT(&tcp->error_closure, tcp_handle_error, tcp,\n                    grpc_schedule_on_exec_ctx);\n  ",
          "old_line_content": "  grpc_fd_notify_on_error(tcp->em_fd, &tcp->error_closure);",
          "new_line_content": "  GRPC_CLOSURE_INIT(&tcp->error_closure, tcp_handle_error, tcp,",
          "content_same": false
        },
        {
          "line": 841,
          "old_api": "send",
          "new_api": "_STATS_INC_TCP_WRITE_IOV_SIZE",
          "old_text": "send(tcp->fd, &msg);\n  ",
          "new_text": "_STATS_INC_TCP_WRITE_IOV_SIZE(iov_size);\n\n ",
          "old_line_content": "      sent_length = tcp_send(tcp->fd, &msg);",
          "new_line_content": "      GRPC_STATS_INC_TCP_WRITE_IOV_SIZE(iov_size);",
          "content_same": false
        },
        {
          "line": 867,
          "old_api": "ic_cast<size_t>(sent_length);",
          "new_api": "ASSERT",
          "old_text": "ic_cast<size_t>(sent_length);\n  ",
          "new_text": "ASSERT(tcp->outgoing_byte_idx == 0);\n  ",
          "old_line_content": "    trailing = sending_length - static_cast<size_t>(sent_length);",
          "new_line_content": "    GPR_ASSERT(tcp->outgoing_byte_idx == 0);",
          "content_same": false
        },
        {
          "line": 903,
          "old_api": "log",
          "new_api": "flush",
          "old_text": "log(GPR_INFO, \"write: delayed\");\n  ",
          "new_text": "flush(tcp, &error)) {\n",
          "old_line_content": "      gpr_log(GPR_INFO, \"write: delayed\");",
          "new_line_content": "  if (!tcp_flush(tcp, &error)) {",
          "content_same": false
        },
        {
          "line": 905,
          "old_api": "fy_on_write",
          "new_api": "log",
          "old_text": "fy_on_write(tcp);\n  ",
          "new_text": "log(GPR_INFO, \"write: delayed\");\n  ",
          "old_line_content": "    notify_on_write(tcp);",
          "new_line_content": "      gpr_log(GPR_INFO, \"write: delayed\");",
          "content_same": false
        },
        {
          "line": 911,
          "old_api": "log",
          "new_api": "enabled",
          "old_text": "log(GPR_INFO, \"write: %s\", str);\n  ",
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "      gpr_log(GPR_INFO, \"write: %s\", str);",
          "new_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 913,
          "old_api": "_CLOSURE_SCHED",
          "new_api": "log",
          "old_text": "_CLOSURE_SCHED(cb, error);\n  ",
          "new_text": "log(GPR_INFO, \"write: %s\", str);\n  ",
          "old_line_content": "    GRPC_CLOSURE_SCHED(cb, error);",
          "new_line_content": "      gpr_log(GPR_INFO, \"write: %s\", str);",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": "free",
          "new_api": "_dump_slice",
          "old_text": "free(data);\n  ",
          "new_text": "_dump_slice(buf->slices[i], GPR_DUMP_HEX | GPR_DUMP_ASCII);\n  ",
          "old_line_content": "      gpr_free(data);",
          "new_line_content": "          grpc_dump_slice(buf->slices[i], GPR_DUMP_HEX | GPR_DUMP_ASCII);",
          "content_same": false
        },
        {
          "line": 940,
          "old_api": "annotate_error",
          "new_api": "_CLOSURE_SCHED",
          "old_text": "annotate_error(\n                      GRPC_ERROR_CREATE_FROM_STATIC_STRING(\"EOF\"), tcp)\n   ",
          "new_text": "_CLOSURE_SCHED(\n        cb, grpc_fd_is_shutdown(tcp->em_fd)\n                ? tcp_annotate_error(\n                      GRPC_ERROR_CREATE_FROM_STATIC_STRING(\"EOF\"), tcp)\n                : GRPC_ERROR_NONE);\n  ",
          "old_line_content": "                ? tcp_annotate_error(",
          "new_line_content": "    GRPC_CLOSURE_SCHED(",
          "content_same": false
        },
        {
          "line": 941,
          "old_api": "_ERROR_CREATE_FROM_STATIC_STRING",
          "new_api": "_fd_is_shutdown",
          "old_text": "_ERROR_CREATE_FROM_STATIC_STRING(\"EOF\"), tc",
          "new_text": "_fd_is_shutdown(tcp->em_fd)\n   ",
          "old_line_content": "                      GRPC_ERROR_CREATE_FROM_STATIC_STRING(\"EOF\"), tcp)",
          "new_line_content": "        cb, grpc_fd_is_shutdown(tcp->em_fd)",
          "content_same": false
        },
        {
          "line": 955,
          "old_api": "enabled",
          "new_api": "REF",
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": "REF(tcp, \"write\");\n  ",
          "old_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "    TCP_REF(tcp, \"write\");",
          "content_same": false
        },
        {
          "line": 958,
          "old_api": "fy_on_write",
          "new_api": "log",
          "old_text": "fy_on_write(tcp);\n  ",
          "new_text": "log(GPR_INFO, \"write: delayed\");\n  ",
          "old_line_content": "    notify_on_write(tcp);",
          "new_line_content": "      gpr_log(GPR_INFO, \"write: delayed\");",
          "content_same": false
        },
        {
          "line": 960,
          "old_api": "enabled",
          "new_api": "fy_on_write",
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": "fy_on_write(tcp);\n  ",
          "old_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "    notify_on_write(tcp);",
          "content_same": false
        },
        {
          "line": 962,
          "old_api": "log",
          "new_api": "enabled",
          "old_text": "log(GPR_INFO, \"write: %s\", str);\n  ",
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "      gpr_log(GPR_INFO, \"write: %s\", str);",
          "new_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 964,
          "old_api": "_CLOSURE_SCHED",
          "new_api": "log",
          "old_text": "_CLOSURE_SCHED(cb, error);\n  ",
          "new_text": "log(GPR_INFO, \"write: %s\", str);\n  ",
          "old_line_content": "    GRPC_CLOSURE_SCHED(cb, error);",
          "new_line_content": "      gpr_log(GPR_INFO, \"write: %s\", str);",
          "content_same": false
        },
        {
          "line": 1038,
          "old_api": "mp",
          "new_api": "_channel_arg_get_integer",
          "old_text": "mp(channel_args->args[i].key, GRPC_ARG_RESOURCE_QUOTA)) {\n",
          "new_text": "_channel_arg_get_integer(&channel_args->args[i], options);\n  ",
          "old_line_content": "                 strcmp(channel_args->args[i].key, GRPC_ARG_RESOURCE_QUOTA)) {",
          "new_line_content": "            grpc_channel_arg_get_integer(&channel_args->args[i], options);",
          "content_same": false
        },
        {
          "line": 1041,
          "old_api": "ic_cast<grpc_resource_quota*>(\n                channel_args->args[i].value.pointer.p));",
          "new_api": "_resource_quota_unref_internal",
          "old_text": "ic_cast<grpc_resource_quota*>(\n                channel_args->args[i].value.pointer.p));\n ",
          "new_text": "_resource_quota_unref_internal(resource_quota);\n  ",
          "old_line_content": "            grpc_resource_quota_ref_internal(static_cast<grpc_resource_quota*>(",
          "new_line_content": "        grpc_resource_quota_unref_internal(resource_quota);",
          "content_same": false
        },
        {
          "line": 1055,
          "old_api": "strdup",
          "new_api": "malloc",
          "old_text": "strdup(peer_string);\n  ",
          "new_text": "malloc(sizeof(grpc_tcp)));\n ",
          "old_line_content": "  tcp->peer_string = gpr_strdup(peer_string);",
          "new_line_content": "  grpc_tcp* tcp = static_cast<grpc_tcp*>(gpr_malloc(sizeof(grpc_tcp)));",
          "content_same": false
        },
        {
          "line": 1074,
          "old_api": "_slice_buffer_init",
          "new_api": "atm_no_barrier_store",
          "old_text": "_slice_buffer_init(&tcp->last_read_buffer);\n  ",
          "new_text": "atm_no_barrier_store(&tcp->shutdown_count, 0);\n  ",
          "old_line_content": "  grpc_slice_buffer_init(&tcp->last_read_buffer);",
          "new_line_content": "  gpr_atm_no_barrier_store(&tcp->shutdown_count, 0);",
          "content_same": false
        },
        {
          "line": 1076,
          "old_api": "_resource_user_slice_allocator_init",
          "new_api": "_slice_buffer_init",
          "old_text": "_resource_user_slice_allocator_init(\n      &tcp->slice_allocator, tcp->resource_user, tcp_read_allocation_done, tcp);\n  ",
          "new_text": "_slice_buffer_init(&tcp->last_read_buffer);\n  ",
          "old_line_content": "  grpc_resource_user_slice_allocator_init(",
          "new_line_content": "  grpc_slice_buffer_init(&tcp->last_read_buffer);",
          "content_same": false
        },
        {
          "line": 1081,
          "old_api": "mu_init",
          "new_api": "_network_status_register_endpoint",
          "old_text": "mu_init(&tcp->tb_mu);\n  ",
          "new_text": "_network_status_register_endpoint(&tcp->base);\n  ",
          "old_line_content": "  gpr_mu_init(&tcp->tb_mu);",
          "new_line_content": "  grpc_network_status_register_endpoint(&tcp->base);",
          "content_same": false
        },
        {
          "line": 1090,
          "old_api": "_CLOSURE_INIT",
          "new_api": "REF",
          "old_text": "_CLOSURE_INIT(&tcp->error_closure, tcp_handle_error, tcp,\n                      grpc_schedule_on_exec_ctx);\n  ",
          "new_text": "REF(tcp, \"error-tracking\");\n  ",
          "old_line_content": "    GRPC_CLOSURE_INIT(&tcp->error_closure, tcp_handle_error, tcp,",
          "new_line_content": "    TCP_REF(tcp, \"error-tracking\");",
          "content_same": false
        },
        {
          "line": 1092,
          "old_api": "_fd_notify_on_error",
          "new_api": "_CLOSURE_INIT",
          "old_text": "_fd_notify_on_error(tcp->em_fd, &tcp->error_closure);\n  ",
          "new_text": "_CLOSURE_INIT(&tcp->error_closure, tcp_handle_error, tcp,\n                      grpc_schedule_on_exec_ctx);\n  ",
          "old_line_content": "    grpc_fd_notify_on_error(tcp->em_fd, &tcp->error_closure);",
          "new_line_content": "    GRPC_CLOSURE_INIT(&tcp->error_closure, tcp_handle_error, tcp,",
          "content_same": false
        },
        {
          "line": 1101,
          "old_api": "_fd_wrapped_fd",
          "new_api": "terpret_cast<grpc_tcp*>(ep);",
          "old_text": "_fd_wrapped_fd(tcp->em_fd);\n}\n",
          "new_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "old_line_content": "  return grpc_fd_wrapped_fd(tcp->em_fd);",
          "new_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "content_same": false
        },
        {
          "line": 1108,
          "old_api": "ASSERT",
          "new_api": "_network_status_unregister_endpoint",
          "old_text": "ASSERT(ep->vtable == &vtable);\n  ",
          "new_text": "_network_status_unregister_endpoint(ep);\n  ",
          "old_line_content": "  GPR_ASSERT(ep->vtable == &vtable);",
          "new_line_content": "  grpc_network_status_unregister_endpoint(ep);",
          "content_same": false
        },
        {
          "line": 1114,
          "old_api": "atm_no_barrier_store",
          "new_api": "_event_engine_can_track_errors",
          "old_text": "atm_no_barrier_store(&tcp->stop_error_notification, true);\n  ",
          "new_text": "_event_engine_can_track_errors()) {\n",
          "old_line_content": "    gpr_atm_no_barrier_store(&tcp->stop_error_notification, true);",
          "new_line_content": "  if (grpc_event_engine_can_track_errors()) {",
          "content_same": false
        },
        {
          "line": 1117,
          "old_api": "UNREF",
          "new_api": "_fd_set_error",
          "old_text": "UNREF(tcp, \"destroy\");\n}\n",
          "new_text": "_fd_set_error(tcp->em_fd);\n  ",
          "old_line_content": "  TCP_UNREF(tcp, \"destroy\");",
          "new_line_content": "    grpc_fd_set_error(tcp->em_fd);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1025,
          "old_api": null,
          "new_api": "mp",
          "old_text": null,
          "new_text": "mp(channel_args->args[i].key, GRPC_ARG_TCP_READ_CHUNK_SIZE)) {\n",
          "old_line_content": "        tcp_read_chunk_size =",
          "new_line_content": "          strcmp(channel_args->args[i].key, GRPC_ARG_TCP_READ_CHUNK_SIZE)) {",
          "content_same": false
        },
        {
          "line": 514,
          "old_api": null,
          "new_api": "do_read",
          "old_text": null,
          "new_text": "do_read(tcp);\n  ",
          "old_line_content": "}",
          "new_line_content": "    tcp_do_read(tcp);",
          "content_same": false
        },
        {
          "line": 1028,
          "old_api": null,
          "new_api": "_channel_arg_get_integer",
          "old_text": null,
          "new_text": "_channel_arg_get_integer(&channel_args->args[i], options);\n  ",
          "old_line_content": "                             GRPC_ARG_TCP_MIN_READ_CHUNK_SIZE)) {",
          "new_line_content": "            grpc_channel_arg_get_integer(&channel_args->args[i], options);",
          "content_same": false
        },
        {
          "line": 1029,
          "old_api": null,
          "new_api": "mp",
          "old_text": null,
          "new_text": "mp(channel_args->args[i].key,\n                             GRPC_ARG_TCP_MIN_READ_CHUNK_SIZE)) {\n",
          "old_line_content": "        grpc_integer_options options = {tcp_read_chunk_size, 1, MAX_CHUNK_SIZE};",
          "new_line_content": "      } else if (0 == strcmp(channel_args->args[i].key,",
          "content_same": false
        },
        {
          "line": 520,
          "old_api": null,
          "new_api": "enabled",
          "old_text": null,
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "  }",
          "new_line_content": "  if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": null,
          "new_api": "_error_string",
          "old_text": null,
          "new_text": "_error_string(error));\n ",
          "old_line_content": "",
          "new_line_content": "    gpr_log(GPR_INFO, \"TCP:%p got_read: %s\", tcp, grpc_error_string(error));",
          "content_same": false
        },
        {
          "line": 1033,
          "old_api": null,
          "new_api": "_channel_arg_get_integer",
          "old_text": null,
          "new_text": "_channel_arg_get_integer(&channel_args->args[i], options);\n  ",
          "old_line_content": "                             GRPC_ARG_TCP_MAX_READ_CHUNK_SIZE)) {",
          "new_line_content": "            grpc_channel_arg_get_integer(&channel_args->args[i], options);",
          "content_same": false
        },
        {
          "line": 1034,
          "old_api": null,
          "new_api": "mp",
          "old_text": null,
          "new_text": "mp(channel_args->args[i].key,\n                             GRPC_ARG_TCP_MAX_READ_CHUNK_SIZE)) {\n",
          "old_line_content": "        grpc_integer_options options = {tcp_read_chunk_size, 1, MAX_CHUNK_SIZE};",
          "new_line_content": "      } else if (0 == strcmp(channel_args->args[i].key,",
          "content_same": false
        },
        {
          "line": 527,
          "old_api": null,
          "new_api": "_ERROR_REF",
          "old_text": null,
          "new_text": "_ERROR_REF(error));\n ",
          "old_line_content": "  } else {",
          "new_line_content": "    call_read_cb(tcp, GRPC_ERROR_REF(error));",
          "content_same": false
        },
        {
          "line": 1040,
          "old_api": null,
          "new_api": "mp",
          "old_text": null,
          "new_text": "mp(channel_args->args[i].key, GRPC_ARG_RESOURCE_QUOTA)) {\n",
          "old_line_content": "        resource_quota =",
          "new_line_content": "                 strcmp(channel_args->args[i].key, GRPC_ARG_RESOURCE_QUOTA)) {",
          "content_same": false
        },
        {
          "line": 530,
          "old_api": null,
          "new_api": "continue_read",
          "old_text": null,
          "new_text": "continue_read(tcp);\n  ",
          "old_line_content": "}",
          "new_line_content": "    tcp_continue_read(tcp);",
          "content_same": false
        },
        {
          "line": 1043,
          "old_api": null,
          "new_api": "ic_cast<grpc_resource_quota*>(\n                channel_args->args[i].value.pointer.p));",
          "old_text": null,
          "new_text": "ic_cast<grpc_resource_quota*>(\n                channel_args->args[i].value.pointer.p));\n ",
          "old_line_content": "      }",
          "new_line_content": "            grpc_resource_quota_ref_internal(static_cast<grpc_resource_quota*>(",
          "content_same": false
        },
        {
          "line": 536,
          "old_api": null,
          "new_api": "terpret_cast<grpc_tcp*>(ep);",
          "old_text": null,
          "new_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "old_line_content": "  tcp->read_cb = cb;",
          "new_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(tcp->read_cb == nullptr);\n  ",
          "old_line_content": "  tcp->incoming_buffer = incoming_buffer;",
          "new_line_content": "  GPR_ASSERT(tcp->read_cb == nullptr);",
          "content_same": false
        },
        {
          "line": 1052,
          "old_api": null,
          "new_api": "CLAMP",
          "old_text": null,
          "new_text": "CLAMP(tcp_read_chunk_size, tcp_min_read_chunk_size,\n                                  tcp_max_read_chunk_size);\n\n ",
          "old_line_content": "",
          "new_line_content": "  tcp_read_chunk_size = GPR_CLAMP(tcp_read_chunk_size, tcp_min_read_chunk_size,",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": null,
          "new_api": "_slice_buffer_swap",
          "old_text": null,
          "new_text": "_slice_buffer_swap(incoming_buffer, &tcp->last_read_buffer);\n  ",
          "old_line_content": "  if (tcp->is_first_read) {",
          "new_line_content": "  grpc_slice_buffer_swap(incoming_buffer, &tcp->last_read_buffer);",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": null,
          "new_api": "REF",
          "old_text": null,
          "new_text": "REF(tcp, \"read\");\n  ",
          "old_line_content": "    /* Endpoint read called for the very first time. Register read callback with",
          "new_line_content": "  TCP_REF(tcp, \"read\");",
          "content_same": false
        },
        {
          "line": 1057,
          "old_api": null,
          "new_api": "strdup",
          "old_text": null,
          "new_text": "strdup(peer_string);\n  ",
          "old_line_content": "  tcp->read_cb = nullptr;",
          "new_line_content": "  tcp->peer_string = gpr_strdup(peer_string);",
          "content_same": false
        },
        {
          "line": 1058,
          "old_api": null,
          "new_api": "_fd_wrapped_fd",
          "old_text": null,
          "new_text": "_fd_wrapped_fd(em_fd);\n  ",
          "old_line_content": "  tcp->write_cb = nullptr;",
          "new_line_content": "  tcp->fd = grpc_fd_wrapped_fd(em_fd);",
          "content_same": false
        },
        {
          "line": 547,
          "old_api": null,
          "new_api": "fy_on_read",
          "old_text": null,
          "new_text": "fy_on_read(tcp);\n  ",
          "old_line_content": "    /* Not the first time. We may or may not have more bytes available. In any",
          "new_line_content": "    notify_on_read(tcp);",
          "content_same": false
        },
        {
          "line": 1064,
          "old_api": null,
          "new_api": "ic_cast<double>(tcp_read_chunk_size);",
          "old_text": null,
          "new_text": "ic_cast<double>(tcp_read_chunk_size);\n  ",
          "old_line_content": "  tcp->max_read_chunk_size = tcp_max_read_chunk_size;",
          "new_line_content": "  tcp->target_length = static_cast<double>(tcp_read_chunk_size);",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": null,
          "new_api": "_CLOSURE_SCHED",
          "old_text": null,
          "new_text": "_CLOSURE_SCHED(&tcp->read_done_closure, GRPC_ERROR_NONE);\n  ",
          "old_line_content": "}",
          "new_line_content": "    GRPC_CLOSURE_SCHED(&tcp->read_done_closure, GRPC_ERROR_NONE);",
          "content_same": false
        },
        {
          "line": 561,
          "old_api": null,
          "new_api": "TIMER_SCOPE",
          "old_text": null,
          "new_text": "TIMER_SCOPE(\"sendmsg\", 1);\n  ",
          "old_line_content": "  do {",
          "new_line_content": "  GPR_TIMER_SCOPE(\"sendmsg\", 1);",
          "content_same": false
        },
        {
          "line": 1073,
          "old_api": null,
          "new_api": "ref_init",
          "old_text": null,
          "new_text": "ref_init(&tcp->refcount, 1);\n  ",
          "old_line_content": "  tcp->em_fd = em_fd;",
          "new_line_content": "  gpr_ref_init(&tcp->refcount, 1);",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": null,
          "new_api": "_STATS_INC_SYSCALL_WRITE",
          "old_text": null,
          "new_text": "_STATS_INC_SYSCALL_WRITE();\n  ",
          "old_line_content": "  } while (sent_length < 0 && errno == EINTR);",
          "new_line_content": "    GRPC_STATS_INC_SYSCALL_WRITE();",
          "content_same": false
        },
        {
          "line": 566,
          "old_api": null,
          "new_api": "msg",
          "old_text": null,
          "new_text": "msg(fd, msg, SENDMSG_FLAGS);\n  ",
          "old_line_content": "  return sent_length;",
          "new_line_content": "    sent_length = sendmsg(fd, msg, SENDMSG_FLAGS);",
          "content_same": false
        },
        {
          "line": 1077,
          "old_api": null,
          "new_api": "_resource_user_create",
          "old_text": null,
          "new_text": "_resource_user_create(resource_quota, peer_string);\n  ",
          "old_line_content": "      &tcp->slice_allocator, tcp->resource_user, tcp_read_allocation_done, tcp);",
          "new_line_content": "  tcp->resource_user = grpc_resource_user_create(resource_quota, peer_string);",
          "content_same": false
        },
        {
          "line": 1078,
          "old_api": null,
          "new_api": "_resource_user_slice_allocator_init",
          "old_text": null,
          "new_text": "_resource_user_slice_allocator_init(\n      &tcp->slice_allocator, tcp->resource_user, tcp_read_allocation_done, tcp);\n  ",
          "old_line_content": "  /* Tell network status tracker about new endpoint */",
          "new_line_content": "  grpc_resource_user_slice_allocator_init(",
          "content_same": false
        },
        {
          "line": 1082,
          "old_api": null,
          "new_api": "_resource_quota_unref_internal",
          "old_text": null,
          "new_text": "_resource_quota_unref_internal(resource_quota);\n  ",
          "old_line_content": "  tcp->tb_head = nullptr;",
          "new_line_content": "  grpc_resource_quota_unref_internal(resource_quota);",
          "content_same": false
        },
        {
          "line": 1083,
          "old_api": null,
          "new_api": "mu_init",
          "old_text": null,
          "new_text": "mu_init(&tcp->tb_mu);\n  ",
          "old_line_content": "  /* Start being notified on errors if event engine can track errors. */",
          "new_line_content": "  gpr_mu_init(&tcp->tb_mu);",
          "content_same": false
        },
        {
          "line": 1086,
          "old_api": null,
          "new_api": "_event_engine_can_track_errors",
          "old_text": null,
          "new_text": "_event_engine_can_track_errors()) {\n",
          "old_line_content": "     * processing errors. We unref when we no longer want to track errors",
          "new_line_content": "  if (grpc_event_engine_can_track_errors()) {",
          "content_same": false
        },
        {
          "line": 1091,
          "old_api": null,
          "new_api": "atm_rel_store",
          "old_text": null,
          "new_text": "atm_rel_store(&tcp->stop_error_notification, 0);\n  ",
          "old_line_content": "                      grpc_schedule_on_exec_ctx);",
          "new_line_content": "    gpr_atm_rel_store(&tcp->stop_error_notification, 0);",
          "content_same": false
        },
        {
          "line": 1094,
          "old_api": null,
          "new_api": "_fd_notify_on_error",
          "old_text": null,
          "new_text": "_fd_notify_on_error(tcp->em_fd, &tcp->error_closure);\n  ",
          "old_line_content": "",
          "new_line_content": "    grpc_fd_notify_on_error(tcp->em_fd, &tcp->error_closure);",
          "content_same": false
        },
        {
          "line": 1102,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(ep->vtable == &vtable);\n  ",
          "old_line_content": "}",
          "new_line_content": "  GPR_ASSERT(ep->vtable == &vtable);",
          "content_same": false
        },
        {
          "line": 1103,
          "old_api": null,
          "new_api": "_fd_wrapped_fd",
          "old_text": null,
          "new_text": "_fd_wrapped_fd(tcp->em_fd);\n}\n",
          "old_line_content": "",
          "new_line_content": "  return grpc_fd_wrapped_fd(tcp->em_fd);",
          "content_same": false
        },
        {
          "line": 595,
          "old_api": null,
          "new_api": "enabled",
          "old_text": null,
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "      }",
          "new_line_content": "      if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log(GPR_ERROR, \"Failed to set timestamping options on the socket.\");\n  ",
          "old_line_content": "      return false;",
          "new_line_content": "        gpr_log(GPR_ERROR, \"Failed to set timestamping options on the socket.\");",
          "content_same": false
        },
        {
          "line": 1109,
          "old_api": null,
          "new_api": "terpret_cast<grpc_tcp*>(ep);",
          "old_text": null,
          "new_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "old_line_content": "  tcp->release_fd = fd;",
          "new_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "content_same": false
        },
        {
          "line": 1110,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(ep->vtable == &vtable);\n  ",
          "old_line_content": "  tcp->release_fd_cb = done;",
          "new_line_content": "  GPR_ASSERT(ep->vtable == &vtable);",
          "content_same": false
        },
        {
          "line": 1113,
          "old_api": null,
          "new_api": "_slice_buffer_reset_and_unref_internal",
          "old_text": null,
          "new_text": "_slice_buffer_reset_and_unref_internal(&tcp->last_read_buffer);\n  ",
          "old_line_content": "    /* Stop errors notification. */",
          "new_line_content": "  grpc_slice_buffer_reset_and_unref_internal(&tcp->last_read_buffer);",
          "content_same": false
        },
        {
          "line": 1116,
          "old_api": null,
          "new_api": "atm_no_barrier_store",
          "old_text": null,
          "new_text": "atm_no_barrier_store(&tcp->stop_error_notification, true);\n  ",
          "old_line_content": "  }",
          "new_line_content": "    gpr_atm_no_barrier_store(&tcp->stop_error_notification, true);",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": null,
          "new_api": "_SPACE",
          "old_text": null,
          "new_text": "_SPACE(sizeof(uint32_t))];\n ",
          "old_line_content": "  } u;",
          "new_line_content": "    char cmsg_buf[CMSG_SPACE(sizeof(uint32_t))];",
          "content_same": false
        },
        {
          "line": 1119,
          "old_api": null,
          "new_api": "UNREF",
          "old_text": null,
          "new_text": "UNREF(tcp, \"destroy\");\n}\n",
          "old_line_content": "",
          "new_line_content": "  TCP_UNREF(tcp, \"destroy\");",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "terpret_cast<cmsghdr*>(u.cmsg_buf);",
          "old_text": null,
          "new_text": "terpret_cast<cmsghdr*>(u.cmsg_buf);\n  ",
          "old_line_content": "  cmsg->cmsg_type = SO_TIMESTAMPING;",
          "new_line_content": "  cmsghdr* cmsg = reinterpret_cast<cmsghdr*>(u.cmsg_buf);",
          "content_same": false
        },
        {
          "line": 611,
          "old_api": null,
          "new_api": "_LEN",
          "old_text": null,
          "new_text": "_LEN(sizeof(uint32_t));\n  ",
          "old_line_content": "      grpc_core::kTimestampingRecordingOptions;",
          "new_line_content": "  cmsg->cmsg_len = CMSG_LEN(sizeof(uint32_t));",
          "content_same": false
        },
        {
          "line": 612,
          "old_api": null,
          "new_api": "_DATA",
          "old_text": null,
          "new_text": "_DATA(cmsg)) =\n",
          "old_line_content": "  msg->msg_control = u.cmsg_buf;",
          "new_line_content": "  *reinterpret_cast<int*>(CMSG_DATA(cmsg)) =",
          "content_same": false
        },
        {
          "line": 615,
          "old_api": null,
          "new_api": "_SPACE",
          "old_text": null,
          "new_text": "_SPACE(sizeof(uint32_t));\n\n ",
          "old_line_content": "  /* If there was an error on sendmsg the logic in tcp_flush will handle it. */",
          "new_line_content": "  msg->msg_controllen = CMSG_SPACE(sizeof(uint32_t));",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": null,
          "new_api": "send",
          "old_text": null,
          "new_text": "send(tcp->fd, msg);\n  ",
          "old_line_content": "  /* Only save timestamps if all the bytes were taken by sendmsg. */",
          "new_line_content": "  ssize_t length = tcp_send(tcp->fd, msg);",
          "content_same": false
        },
        {
          "line": 623,
          "old_api": null,
          "new_api": "_core::TracedBuffer::AddNewEntry(\n        &tcp->tb_head, static_cast<int>(tcp->bytes_counter + length),\n        tcp->outgoing_buffer_arg);",
          "old_text": null,
          "new_text": "_core::TracedBuffer::AddNewEntry(\n        &tcp->tb_head, static_cast<int>(tcp->bytes_counter + length),\n        tcp->outgoing_buffer_arg);\n  ",
          "old_line_content": "        tcp->outgoing_buffer_arg);",
          "new_line_content": "    grpc_core::TracedBuffer::AddNewEntry(",
          "content_same": false
        },
        {
          "line": 626,
          "old_api": null,
          "new_api": "mu_unlock",
          "old_text": null,
          "new_text": "mu_unlock(&tcp->tb_mu);\n  ",
          "old_line_content": "  }",
          "new_line_content": "    gpr_mu_unlock(&tcp->tb_mu);",
          "content_same": false
        },
        {
          "line": 643,
          "old_api": null,
          "new_api": "enabled",
          "old_text": null,
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "    }",
          "new_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log(GPR_ERROR, \"Received timestamp without extended error\");\n  ",
          "old_line_content": "    return cmsg;",
          "new_line_content": "      gpr_log(GPR_ERROR, \"Received timestamp without extended error\");",
          "content_same": false
        },
        {
          "line": 652,
          "old_api": null,
          "new_api": "enabled",
          "old_text": null,
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "    }",
          "new_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 653,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log(GPR_ERROR, \"Unexpected control message\");\n  ",
          "old_line_content": "    return cmsg;",
          "new_line_content": "      gpr_log(GPR_ERROR, \"Unexpected control message\");",
          "content_same": false
        },
        {
          "line": 659,
          "old_api": null,
          "new_api": "_DATA",
          "old_text": null,
          "new_text": "_DATA(cmsg));\n ",
          "old_line_content": "  if (serr->ee_errno != ENOMSG ||",
          "new_line_content": "      reinterpret_cast<struct grpc_core::scm_timestamping*>(CMSG_DATA(cmsg));",
          "content_same": false
        },
        {
          "line": 660,
          "old_api": null,
          "new_api": "_DATA",
          "old_text": null,
          "new_text": "_DATA(next_cmsg));\n ",
          "old_line_content": "      serr->ee_origin != SO_EE_ORIGIN_TIMESTAMPING) {",
          "new_line_content": "  auto serr = reinterpret_cast<struct sock_extended_err*>(CMSG_DATA(next_cmsg));",
          "content_same": false
        },
        {
          "line": 663,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log(GPR_ERROR, \"Unexpected control message\");\n  ",
          "old_line_content": "  }",
          "new_line_content": "    gpr_log(GPR_ERROR, \"Unexpected control message\");",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": null,
          "new_api": "_core::TracedBuffer::ProcessTimestamp(&tcp->tb_head, serr, tss);",
          "old_text": null,
          "new_text": "_core::TracedBuffer::ProcessTimestamp(&tcp->tb_head, serr, tss);\n  ",
          "old_line_content": "  return next_cmsg;",
          "new_line_content": "  grpc_core::TracedBuffer::ProcessTimestamp(&tcp->tb_head, serr, tss);",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": null,
          "new_api": "mu_unlock",
          "old_text": null,
          "new_text": "mu_unlock(&tcp->tb_mu);\n  ",
          "old_line_content": "}",
          "new_line_content": "  gpr_mu_unlock(&tcp->tb_mu);",
          "content_same": false
        },
        {
          "line": 697,
          "old_api": null,
          "new_api": "et",
          "old_text": null,
          "new_text": "et(&aligned_buf, 0, sizeof(aligned_buf));\n\n ",
          "old_line_content": "    msg.msg_control = aligned_buf.rbuf;",
          "new_line_content": "    memset(&aligned_buf, 0, sizeof(aligned_buf));",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": null,
          "new_api": "msg",
          "old_text": null,
          "new_text": "msg(tcp->fd, &msg, MSG_ERRQUEUE);\n  ",
          "old_line_content": "    } while (r < 0 && saved_errno == EINTR);",
          "new_line_content": "      r = recvmsg(tcp->fd, &msg, MSG_ERRQUEUE);",
          "content_same": false
        },
        {
          "line": 716,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log(GPR_INFO, \"Error message was truncated.\");\n  ",
          "old_line_content": "    }",
          "new_line_content": "        gpr_log(GPR_INFO, \"Error message was truncated.\");",
          "content_same": false
        },
        {
          "line": 724,
          "old_api": null,
          "new_api": "_FIRSTHDR",
          "old_text": null,
          "new_text": "_FIRSTHDR(&msg); cm",
          "old_line_content": "      if (cmsg->cmsg_level != SOL_SOCKET ||",
          "new_line_content": "    for (auto cmsg = CMSG_FIRSTHDR(&msg); cmsg && cmsg->cmsg_len;",
          "content_same": false
        },
        {
          "line": 725,
          "old_api": null,
          "new_api": "_NXTHDR",
          "old_text": null,
          "new_text": "_NXTHDR(&msg, cmsg)) {\n",
          "old_line_content": "          cmsg->cmsg_type != SCM_TIMESTAMPING) {",
          "new_line_content": "         cmsg = CMSG_NXTHDR(&msg, cmsg)) {",
          "content_same": false
        },
        {
          "line": 730,
          "old_api": null,
          "new_api": "enabled",
          "old_text": null,
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "                  \"unknown control message cmsg_level:%d cmsg_type:%d\",",
          "new_line_content": "        if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 731,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log(GPR_INFO,\n                  \"unknown control message cmsg_level:%d cmsg_type:%d\",\n                  cmsg->cmsg_level, cmsg->cmsg_type);\n  ",
          "old_line_content": "                  cmsg->cmsg_level, cmsg->cmsg_type);",
          "new_line_content": "          gpr_log(GPR_INFO,",
          "content_same": false
        },
        {
          "line": 737,
          "old_api": null,
          "new_api": "ess_timestamp",
          "old_text": null,
          "new_text": "ess_timestamp(tcp, &msg, cmsg);\n  ",
          "old_line_content": "  }",
          "new_line_content": "      process_timestamp(tcp, &msg, cmsg);",
          "content_same": false
        },
        {
          "line": 744,
          "old_api": null,
          "new_api": "enabled",
          "old_text": null,
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "  }",
          "new_line_content": "  if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 745,
          "old_api": null,
          "new_api": "_error_string",
          "old_text": null,
          "new_text": "_error_string(error));\n ",
          "old_line_content": "",
          "new_line_content": "    gpr_log(GPR_INFO, \"TCP:%p got_error: %s\", tcp, grpc_error_string(error));",
          "content_same": false
        },
        {
          "line": 749,
          "old_api": null,
          "new_api": "atm_acq_load",
          "old_text": null,
          "new_text": "atm_acq_load(&tcp->stop_error_notification))) {",
          "old_line_content": "     * unref. */",
          "new_line_content": "      static_cast<bool>(gpr_atm_acq_load(&tcp->stop_error_notification))) {",
          "content_same": false
        },
        {
          "line": 752,
          "old_api": null,
          "new_api": "_ERROR_REF",
          "old_text": null,
          "new_text": "_ERROR_REF(error));\n ",
          "old_line_content": "    return;",
          "new_line_content": "    grpc_core::TracedBuffer::Shutdown(&tcp->tb_head, GRPC_ERROR_REF(error));",
          "content_same": false
        },
        {
          "line": 753,
          "old_api": null,
          "new_api": "UNREF",
          "old_text": null,
          "new_text": "UNREF(tcp, \"error-tracking\");\n  ",
          "old_line_content": "  }",
          "new_line_content": "    TCP_UNREF(tcp, \"error-tracking\");",
          "content_same": false
        },
        {
          "line": 759,
          "old_api": null,
          "new_api": "ess_errors",
          "old_text": null,
          "new_text": "ess_errors(tcp)) {\n",
          "old_line_content": "     * read and write closures to be ready.",
          "new_line_content": "  if (!process_errors(tcp)) {",
          "content_same": false
        },
        {
          "line": 763,
          "old_api": null,
          "new_api": "_fd_set_readable",
          "old_text": null,
          "new_text": "_fd_set_readable(tcp->em_fd);\n  ",
          "old_line_content": "  }",
          "new_line_content": "    grpc_fd_set_readable(tcp->em_fd);",
          "content_same": false
        },
        {
          "line": 768,
          "old_api": null,
          "new_api": "_fd_notify_on_error",
          "old_text": null,
          "new_text": "_fd_notify_on_error(tcp->em_fd, &tcp->error_closure);\n}\n",
          "old_line_content": "",
          "new_line_content": "  grpc_fd_notify_on_error(tcp->em_fd, &tcp->error_closure);",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log(GPR_ERROR, \"Write with timestamps not supported for this platform\");\n  ",
          "old_line_content": "  return false;",
          "new_line_content": "  gpr_log(GPR_ERROR, \"Write with timestamps not supported for this platform\");",
          "content_same": false
        },
        {
          "line": 777,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(0);\n  ",
          "old_line_content": "}",
          "new_line_content": "  GPR_ASSERT(0);",
          "content_same": false
        },
        {
          "line": 782,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log(GPR_ERROR, \"Error handling is not supported for this platform\");\n  ",
          "old_line_content": "}",
          "new_line_content": "  gpr_log(GPR_ERROR, \"Error handling is not supported for this platform\");",
          "content_same": false
        },
        {
          "line": 783,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(0);\n}\n",
          "old_line_content": "#endif /* GRPC_LINUX_ERRQUEUE */",
          "new_line_content": "  GPR_ASSERT(0);",
          "content_same": false
        },
        {
          "line": 815,
          "old_api": null,
          "new_api": "_SLICE_START_PTR",
          "old_text": null,
          "new_text": "_SLICE_START_PTR(\n              tcp->outgoing_buffer->slices[outgoing_slice_idx]) +\n ",
          "old_line_content": "          tcp->outgoing_byte_idx;",
          "new_line_content": "          GRPC_SLICE_START_PTR(",
          "content_same": false
        },
        {
          "line": 819,
          "old_api": null,
          "new_api": "_SLICE_LENGTH",
          "old_text": null,
          "new_text": "_SLICE_LENGTH(tcp->outgoing_buffer->slices[outgoing_slice_idx]) -\n ",
          "old_line_content": "      sending_length += iov[iov_size].iov_len;",
          "new_line_content": "          GRPC_SLICE_LENGTH(tcp->outgoing_buffer->slices[outgoing_slice_idx]) -",
          "content_same": false
        },
        {
          "line": 825,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(iov_size > 0);\n\n ",
          "old_line_content": "    msg.msg_name = nullptr;",
          "new_line_content": "    GPR_ASSERT(iov_size > 0);",
          "content_same": false
        },
        {
          "line": 833,
          "old_api": null,
          "new_api": "write_with_timestamps",
          "old_text": null,
          "new_text": "write_with_timestamps(tcp, &msg, sending_length, &sent_length,\n                                     error))\n  ",
          "old_line_content": "        return true; /* something went wrong with timestamps */",
          "new_line_content": "      if (!tcp_write_with_timestamps(tcp, &msg, sending_length, &sent_length,",
          "content_same": false
        },
        {
          "line": 840,
          "old_api": null,
          "new_api": "_STATS_INC_TCP_WRITE_SIZE",
          "old_text": null,
          "new_text": "_STATS_INC_TCP_WRITE_SIZE(sending_length);\n  ",
          "old_line_content": "",
          "new_line_content": "      GRPC_STATS_INC_TCP_WRITE_SIZE(sending_length);",
          "content_same": false
        },
        {
          "line": 843,
          "old_api": null,
          "new_api": "send",
          "old_text": null,
          "new_text": "send(tcp->fd, &msg);\n  ",
          "old_line_content": "",
          "new_line_content": "      sent_length = tcp_send(tcp->fd, &msg);",
          "content_same": false
        },
        {
          "line": 852,
          "old_api": null,
          "new_api": "_slice_unref_internal",
          "old_text": null,
          "new_text": "_slice_unref_internal(\n              grpc_slice_buffer_take_first(tcp->outgoing_buffer));\n  ",
          "old_line_content": "        }",
          "new_line_content": "          grpc_slice_unref_internal(",
          "content_same": false
        },
        {
          "line": 853,
          "old_api": null,
          "new_api": "_slice_buffer_take_first",
          "old_text": null,
          "new_text": "_slice_buffer_take_first(tcp->outgoing_buffer));\n ",
          "old_line_content": "        return false;",
          "new_line_content": "              grpc_slice_buffer_take_first(tcp->outgoing_buffer));",
          "content_same": false
        },
        {
          "line": 857,
          "old_api": null,
          "new_api": "_OS_ERROR",
          "old_text": null,
          "new_text": "_OS_ERROR(errno, \"sendmsg\"), tc",
          "old_line_content": "        return true;",
          "new_line_content": "        *error = tcp_annotate_error(GRPC_OS_ERROR(errno, \"sendmsg\"), tcp);",
          "content_same": false
        },
        {
          "line": 858,
          "old_api": null,
          "new_api": "_slice_buffer_reset_and_unref_internal",
          "old_text": null,
          "new_text": "_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);\n  ",
          "old_line_content": "      } else {",
          "new_line_content": "        grpc_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);",
          "content_same": false
        },
        {
          "line": 861,
          "old_api": null,
          "new_api": "_OS_ERROR",
          "old_text": null,
          "new_text": "_OS_ERROR(errno, \"sendmsg\"), tc",
          "old_line_content": "        return true;",
          "new_line_content": "        *error = tcp_annotate_error(GRPC_OS_ERROR(errno, \"sendmsg\"), tcp);",
          "content_same": false
        },
        {
          "line": 862,
          "old_api": null,
          "new_api": "_slice_buffer_reset_and_unref_internal",
          "old_text": null,
          "new_text": "_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);\n  ",
          "old_line_content": "      }",
          "new_line_content": "        grpc_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);",
          "content_same": false
        },
        {
          "line": 869,
          "old_api": null,
          "new_api": "ic_cast<size_t>(sent_length);",
          "old_text": null,
          "new_text": "ic_cast<size_t>(sent_length);\n  ",
          "old_line_content": "      size_t slice_length;",
          "new_line_content": "    trailing = sending_length - static_cast<size_t>(sent_length);",
          "content_same": false
        },
        {
          "line": 875,
          "old_api": null,
          "new_api": "_SLICE_LENGTH",
          "old_text": null,
          "new_text": "_SLICE_LENGTH(tcp->outgoing_buffer->slices[outgoing_slice_idx]);\n  ",
          "old_line_content": "        tcp->outgoing_byte_idx = slice_length - trailing;",
          "new_line_content": "          GRPC_SLICE_LENGTH(tcp->outgoing_buffer->slices[outgoing_slice_idx]);",
          "content_same": false
        },
        {
          "line": 885,
          "old_api": null,
          "new_api": "_slice_buffer_reset_and_unref_internal",
          "old_text": null,
          "new_text": "_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);\n  ",
          "old_line_content": "    }",
          "new_line_content": "      grpc_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);",
          "content_same": false
        },
        {
          "line": 892,
          "old_api": null,
          "new_api": "ic_cast<grpc_tcp*>(arg);",
          "old_text": null,
          "new_text": "ic_cast<grpc_tcp*>(arg);\n  ",
          "old_line_content": "",
          "new_line_content": "  grpc_tcp* tcp = static_cast<grpc_tcp*>(arg);",
          "content_same": false
        },
        {
          "line": 898,
          "old_api": null,
          "new_api": "cb",
          "old_text": null,
          "new_text": "cb(cb->cb_arg, error);\n  ",
          "old_line_content": "    return;",
          "new_line_content": "    cb->cb(cb->cb_arg, error);",
          "content_same": false
        },
        {
          "line": 899,
          "old_api": null,
          "new_api": "UNREF",
          "old_text": null,
          "new_text": "UNREF(tcp, \"write\");\n  ",
          "old_line_content": "  }",
          "new_line_content": "    TCP_UNREF(tcp, \"write\");",
          "content_same": false
        },
        {
          "line": 904,
          "old_api": null,
          "new_api": "enabled",
          "old_text": null,
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "    }",
          "new_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 907,
          "old_api": null,
          "new_api": "fy_on_write",
          "old_text": null,
          "new_text": "fy_on_write(tcp);\n  ",
          "old_line_content": "    cb = tcp->write_cb;",
          "new_line_content": "    notify_on_write(tcp);",
          "content_same": false
        },
        {
          "line": 912,
          "old_api": null,
          "new_api": "_error_string",
          "old_text": null,
          "new_text": "_error_string(error);\n  ",
          "old_line_content": "    }",
          "new_line_content": "      const char* str = grpc_error_string(error);",
          "content_same": false
        },
        {
          "line": 915,
          "old_api": null,
          "new_api": "_CLOSURE_SCHED",
          "old_text": null,
          "new_text": "_CLOSURE_SCHED(cb, error);\n  ",
          "old_line_content": "  }",
          "new_line_content": "    GRPC_CLOSURE_SCHED(cb, error);",
          "content_same": false
        },
        {
          "line": 916,
          "old_api": null,
          "new_api": "UNREF",
          "old_text": null,
          "new_text": "UNREF(tcp, \"write\");\n  ",
          "old_line_content": "}",
          "new_line_content": "    TCP_UNREF(tcp, \"write\");",
          "content_same": false
        },
        {
          "line": 922,
          "old_api": null,
          "new_api": "TIMER_SCOPE",
          "old_text": null,
          "new_text": "TIMER_SCOPE(\"tcp_write\", 0);\n  ",
          "old_line_content": "  grpc_error* error = GRPC_ERROR_NONE;",
          "new_line_content": "  GPR_TIMER_SCOPE(\"tcp_write\", 0);",
          "content_same": false
        },
        {
          "line": 923,
          "old_api": null,
          "new_api": "terpret_cast<grpc_tcp*>(ep);",
          "old_text": null,
          "new_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "old_line_content": "",
          "new_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "content_same": false
        },
        {
          "line": 926,
          "old_api": null,
          "new_api": "enabled",
          "old_text": null,
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "",
          "new_line_content": "  if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 932,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log(GPR_INFO, \"WRITE %p (peer=%s): %s\", tcp, tcp->peer_string, data);\n  ",
          "old_line_content": "    }",
          "new_line_content": "      gpr_log(GPR_INFO, \"WRITE %p (peer=%s): %s\", tcp, tcp->peer_string, data);",
          "content_same": false
        },
        {
          "line": 933,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(data);\n  ",
          "old_line_content": "  }",
          "new_line_content": "      gpr_free(data);",
          "content_same": false
        },
        {
          "line": 937,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(tcp->write_cb == nullptr);\n\n ",
          "old_line_content": "  if (buf->length == 0) {",
          "new_line_content": "  GPR_ASSERT(tcp->write_cb == nullptr);",
          "content_same": false
        },
        {
          "line": 942,
          "old_api": null,
          "new_api": "annotate_error",
          "old_text": null,
          "new_text": "annotate_error(\n                      GRPC_ERROR_CREATE_FROM_STATIC_STRING(\"EOF\"), tcp)\n   ",
          "old_line_content": "                : GRPC_ERROR_NONE);",
          "new_line_content": "                ? tcp_annotate_error(",
          "content_same": false
        },
        {
          "line": 943,
          "old_api": null,
          "new_api": "_ERROR_CREATE_FROM_STATIC_STRING",
          "old_text": null,
          "new_text": "_ERROR_CREATE_FROM_STATIC_STRING(\"EOF\"), tc",
          "old_line_content": "    return;",
          "new_line_content": "                      GRPC_ERROR_CREATE_FROM_STATIC_STRING(\"EOF\"), tcp)",
          "content_same": false
        },
        {
          "line": 951,
          "old_api": null,
          "new_api": "_event_engine_can_track_errors",
          "old_text": null,
          "new_text": "_event_engine_can_track_errors());\n ",
          "old_line_content": "",
          "new_line_content": "    GPR_ASSERT(grpc_event_engine_can_track_errors());",
          "content_same": false
        },
        {
          "line": 954,
          "old_api": null,
          "new_api": "flush",
          "old_text": null,
          "new_text": "flush(tcp, &error)) {\n",
          "old_line_content": "    tcp->write_cb = cb;",
          "new_line_content": "  if (!tcp_flush(tcp, &error)) {",
          "content_same": false
        },
        {
          "line": 957,
          "old_api": null,
          "new_api": "enabled",
          "old_text": null,
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "    }",
          "new_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 963,
          "old_api": null,
          "new_api": "_error_string",
          "old_text": null,
          "new_text": "_error_string(error);\n  ",
          "old_line_content": "    }",
          "new_line_content": "      const char* str = grpc_error_string(error);",
          "content_same": false
        },
        {
          "line": 966,
          "old_api": null,
          "new_api": "_CLOSURE_SCHED",
          "old_text": null,
          "new_text": "_CLOSURE_SCHED(cb, error);\n  ",
          "old_line_content": "}",
          "new_line_content": "    GRPC_CLOSURE_SCHED(cb, error);",
          "content_same": false
        },
        {
          "line": 971,
          "old_api": null,
          "new_api": "terpret_cast<grpc_tcp*>(ep);",
          "old_text": null,
          "new_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "old_line_content": "}",
          "new_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "content_same": false
        },
        {
          "line": 972,
          "old_api": null,
          "new_api": "_pollset_add_fd",
          "old_text": null,
          "new_text": "_pollset_add_fd(pollset, tcp->em_fd);\n}\n",
          "old_line_content": "",
          "new_line_content": "  grpc_pollset_add_fd(pollset, tcp->em_fd);",
          "content_same": false
        },
        {
          "line": 977,
          "old_api": null,
          "new_api": "terpret_cast<grpc_tcp*>(ep);",
          "old_text": null,
          "new_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "old_line_content": "}",
          "new_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "content_same": false
        },
        {
          "line": 978,
          "old_api": null,
          "new_api": "_pollset_set_add_fd",
          "old_text": null,
          "new_text": "_pollset_set_add_fd(pollset_set, tcp->em_fd);\n}\n",
          "old_line_content": "",
          "new_line_content": "  grpc_pollset_set_add_fd(pollset_set, tcp->em_fd);",
          "content_same": false
        },
        {
          "line": 983,
          "old_api": null,
          "new_api": "terpret_cast<grpc_tcp*>(ep);",
          "old_text": null,
          "new_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "old_line_content": "}",
          "new_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "content_same": false
        },
        {
          "line": 984,
          "old_api": null,
          "new_api": "_pollset_set_del_fd",
          "old_text": null,
          "new_text": "_pollset_set_del_fd(pollset_set, tcp->em_fd);\n}\n",
          "old_line_content": "",
          "new_line_content": "  grpc_pollset_set_del_fd(pollset_set, tcp->em_fd);",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": null,
          "new_api": "ic_cast<size_t>(read_bytes) < t",
          "old_text": null,
          "new_text": "ic_cast<size_t>(read_bytes) < t",
          "old_line_content": "          tcp->incoming_buffer,",
          "new_line_content": "    } else if (static_cast<size_t>(read_bytes) < tcp->incoming_buffer->length) {",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": null,
          "new_api": "ic_cast<size_t>(read_bytes),",
          "old_text": null,
          "new_text": "ic_cast<size_t>(read_bytes),\n  ",
          "old_line_content": "    }",
          "new_line_content": "          tcp->incoming_buffer->length - static_cast<size_t>(read_bytes),",
          "content_same": false
        },
        {
          "line": 988,
          "old_api": null,
          "new_api": "terpret_cast<grpc_tcp*>(ep);",
          "old_text": null,
          "new_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "old_line_content": "}",
          "new_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "content_same": false
        },
        {
          "line": 989,
          "old_api": null,
          "new_api": "strdup",
          "old_text": null,
          "new_text": "strdup(tcp->peer_string);\n}\n",
          "old_line_content": "",
          "new_line_content": "  return gpr_strdup(tcp->peer_string);",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": null,
          "new_api": "_read_cb",
          "old_text": null,
          "new_text": "_read_cb(tcp, GRPC_ERROR_NONE);\n  ",
          "old_line_content": "  }",
          "new_line_content": "    call_read_cb(tcp, GRPC_ERROR_NONE);",
          "content_same": false
        },
        {
          "line": 481,
          "old_api": null,
          "new_api": "UNREF",
          "old_text": null,
          "new_text": "UNREF(tcp, \"read\");\n  ",
          "old_line_content": "}",
          "new_line_content": "    TCP_UNREF(tcp, \"read\");",
          "content_same": false
        },
        {
          "line": 993,
          "old_api": null,
          "new_api": "terpret_cast<grpc_tcp*>(ep);",
          "old_text": null,
          "new_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "old_line_content": "}",
          "new_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "content_same": false
        },
        {
          "line": 998,
          "old_api": null,
          "new_api": "terpret_cast<grpc_tcp*>(ep);",
          "old_text": null,
          "new_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "old_line_content": "}",
          "new_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log(GPR_INFO, \"TCP:%p read_allocation_done: %s\", tcp,\n            grpc_error_string(error));\n  ",
          "old_line_content": "  }",
          "new_line_content": "    gpr_log(GPR_INFO, \"TCP:%p read_allocation_done: %s\", tcp,",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": null,
          "new_api": "_error_string",
          "old_text": null,
          "new_text": "_error_string(error));\n ",
          "old_line_content": "  if (error != GRPC_ERROR_NONE) {",
          "new_line_content": "            grpc_error_string(error));",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": null,
          "new_api": "_ERROR_REF",
          "old_text": null,
          "new_text": "_ERROR_REF(error));\n ",
          "old_line_content": "  } else {",
          "new_line_content": "    call_read_cb(tcp, GRPC_ERROR_REF(error));",
          "content_same": false
        },
        {
          "line": 497,
          "old_api": null,
          "new_api": "do_read",
          "old_text": null,
          "new_text": "do_read(tcp);\n  ",
          "old_line_content": "}",
          "new_line_content": "    tcp_do_read(tcp);",
          "content_same": false
        },
        {
          "line": 502,
          "old_api": null,
          "new_api": "target_read_size",
          "old_text": null,
          "new_text": "target_read_size(tcp);\n  ",
          "old_line_content": "      tcp->incoming_buffer->count < MAX_READ_IOVEC) {",
          "new_line_content": "  size_t target_read_size = get_target_read_size(tcp);",
          "content_same": false
        },
        {
          "line": 505,
          "old_api": null,
          "new_api": "enabled",
          "old_text": null,
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "    }",
          "new_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": null,
          "new_api": "_resource_user_alloc_slices",
          "old_text": null,
          "new_text": "_resource_user_alloc_slices(&tcp->slice_allocator, target_read_size, 1,\n                                    tcp->incoming_buffer);\n  ",
          "old_line_content": "  } else {",
          "new_line_content": "    grpc_resource_user_alloc_slices(&tcp->slice_allocator, target_read_size, 1,",
          "content_same": false
        },
        {
          "line": 1021,
          "old_api": null,
          "new_api": "_resource_quota_create",
          "old_text": null,
          "new_text": "_resource_quota_create(nullptr);\n  ",
          "old_line_content": "    for (size_t i = 0; i < channel_args->num_args; i++) {",
          "new_line_content": "  grpc_resource_quota* resource_quota = grpc_resource_quota_create(nullptr);",
          "content_same": false
        },
        {
          "line": 511,
          "old_api": null,
          "new_api": "enabled",
          "old_text": null,
          "new_text": "_tcp_trace.enabled()) {\n",
          "old_line_content": "    }",
          "new_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1026,
          "old_api": "_channel_arg_get_integer",
          "new_api": null,
          "old_text": "_channel_arg_get_integer(&channel_args->args[i], options);\n  ",
          "new_text": null,
          "old_line_content": "            grpc_channel_arg_get_integer(&channel_args->args[i], options);",
          "new_line_content": "        grpc_integer_options options = {tcp_read_chunk_size, 1, MAX_CHUNK_SIZE};",
          "content_same": false
        },
        {
          "line": 1027,
          "old_api": "mp",
          "new_api": null,
          "old_text": "mp(channel_args->args[i].key,\n                             GRPC_ARG_TCP_MIN_READ_CHUNK_SIZE)) {\n",
          "new_text": null,
          "old_line_content": "      } else if (0 == strcmp(channel_args->args[i].key,",
          "new_line_content": "        tcp_read_chunk_size =",
          "content_same": false
        },
        {
          "line": 517,
          "old_api": "ic_cast<grpc_tcp*>(arg);",
          "new_api": null,
          "old_text": "ic_cast<grpc_tcp*>(arg);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = static_cast<grpc_tcp*>(arg);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": "enabled",
          "new_api": null,
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": null,
          "old_line_content": "  if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "static void tcp_handle_read(void* arg /* grpc_tcp */, grpc_error* error) {",
          "content_same": false
        },
        {
          "line": 1031,
          "old_api": "_channel_arg_get_integer",
          "new_api": null,
          "old_text": "_channel_arg_get_integer(&channel_args->args[i], options);\n  ",
          "new_text": null,
          "old_line_content": "            grpc_channel_arg_get_integer(&channel_args->args[i], options);",
          "new_line_content": "        grpc_integer_options options = {tcp_read_chunk_size, 1, MAX_CHUNK_SIZE};",
          "content_same": false
        },
        {
          "line": 1032,
          "old_api": "mp",
          "new_api": null,
          "old_text": "mp(channel_args->args[i].key,\n                             GRPC_ARG_TCP_MAX_READ_CHUNK_SIZE)) {\n",
          "new_text": null,
          "old_line_content": "      } else if (0 == strcmp(channel_args->args[i].key,",
          "new_line_content": "        tcp_min_read_chunk_size =",
          "content_same": false
        },
        {
          "line": 523,
          "old_api": "_slice_buffer_reset_and_unref_internal",
          "new_api": null,
          "old_text": "_slice_buffer_reset_and_unref_internal(tcp->incoming_buffer);\n  ",
          "new_text": null,
          "old_line_content": "    grpc_slice_buffer_reset_and_unref_internal(tcp->incoming_buffer);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": "_slice_buffer_reset_and_unref_internal",
          "new_api": null,
          "old_text": "_slice_buffer_reset_and_unref_internal(&tcp->last_read_buffer);\n  ",
          "new_text": null,
          "old_line_content": "    grpc_slice_buffer_reset_and_unref_internal(&tcp->last_read_buffer);",
          "new_line_content": "  if (error != GRPC_ERROR_NONE) {",
          "content_same": false
        },
        {
          "line": 1036,
          "old_api": "_channel_arg_get_integer",
          "new_api": null,
          "old_text": "_channel_arg_get_integer(&channel_args->args[i], options);\n  ",
          "new_text": null,
          "old_line_content": "            grpc_channel_arg_get_integer(&channel_args->args[i], options);",
          "new_line_content": "        grpc_integer_options options = {tcp_read_chunk_size, 1, MAX_CHUNK_SIZE};",
          "content_same": false
        },
        {
          "line": 1039,
          "old_api": "_resource_quota_unref_internal",
          "new_api": null,
          "old_text": "_resource_quota_unref_internal(resource_quota);\n  ",
          "new_text": null,
          "old_line_content": "        grpc_resource_quota_unref_internal(resource_quota);",
          "new_line_content": "      } else if (0 ==",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": "terpret_cast<grpc_tcp*>(ep);",
          "new_api": null,
          "old_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "new_line_content": "static void tcp_read(grpc_endpoint* ep, grpc_slice_buffer* incoming_buffer,",
          "content_same": false
        },
        {
          "line": 535,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(tcp->read_cb == nullptr);\n  ",
          "new_text": null,
          "old_line_content": "  GPR_ASSERT(tcp->read_cb == nullptr);",
          "new_line_content": "                     grpc_closure* cb) {",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": "_slice_buffer_reset_and_unref_internal",
          "new_api": null,
          "old_text": "_slice_buffer_reset_and_unref_internal(incoming_buffer);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_slice_buffer_reset_and_unref_internal(incoming_buffer);",
          "new_line_content": "  tcp->read_cb = cb;",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": "_slice_buffer_swap",
          "new_api": null,
          "old_text": "_slice_buffer_swap(incoming_buffer, &tcp->last_read_buffer);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_slice_buffer_swap(incoming_buffer, &tcp->last_read_buffer);",
          "new_line_content": "  tcp->incoming_buffer = incoming_buffer;",
          "content_same": false
        },
        {
          "line": 1050,
          "old_api": "CLAMP",
          "new_api": null,
          "old_text": "CLAMP(tcp_read_chunk_size, tcp_min_read_chunk_size,\n                                  tcp_max_read_chunk_size);\n\n ",
          "new_text": null,
          "old_line_content": "  tcp_read_chunk_size = GPR_CLAMP(tcp_read_chunk_size, tcp_min_read_chunk_size,",
          "new_line_content": "    tcp_min_read_chunk_size = tcp_max_read_chunk_size;",
          "content_same": false
        },
        {
          "line": 1053,
          "old_api": "malloc",
          "new_api": null,
          "old_text": "malloc(sizeof(grpc_tcp)));\n ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = static_cast<grpc_tcp*>(gpr_malloc(sizeof(grpc_tcp)));",
          "new_line_content": "                                  tcp_max_read_chunk_size);",
          "content_same": false
        },
        {
          "line": 1056,
          "old_api": "_fd_wrapped_fd",
          "new_api": null,
          "old_text": "_fd_wrapped_fd(em_fd);\n  ",
          "new_text": null,
          "old_line_content": "  tcp->fd = grpc_fd_wrapped_fd(em_fd);",
          "new_line_content": "  tcp->base.vtable = &vtable;",
          "content_same": false
        },
        {
          "line": 545,
          "old_api": "fy_on_read",
          "new_api": null,
          "old_text": "fy_on_read(tcp);\n  ",
          "new_text": null,
          "old_line_content": "    notify_on_read(tcp);",
          "new_line_content": "     * the polling engine */",
          "content_same": false
        },
        {
          "line": 1062,
          "old_api": "ic_cast<double>(tcp_read_chunk_size);",
          "new_api": null,
          "old_text": "ic_cast<double>(tcp_read_chunk_size);\n  ",
          "new_text": null,
          "old_line_content": "  tcp->target_length = static_cast<double>(tcp_read_chunk_size);",
          "new_line_content": "  tcp->release_fd = nullptr;",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": "_CLOSURE_SCHED",
          "new_api": null,
          "old_text": "_CLOSURE_SCHED(&tcp->read_done_closure, GRPC_ERROR_NONE);\n  ",
          "new_text": null,
          "old_line_content": "    GRPC_CLOSURE_SCHED(&tcp->read_done_closure, GRPC_ERROR_NONE);",
          "new_line_content": "     * bytes or calls notify_on_read() to be notified when new bytes become",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": "TIMER_SCOPE",
          "new_api": null,
          "old_text": "TIMER_SCOPE(\"sendmsg\", 1);\n  ",
          "new_text": null,
          "old_line_content": "  GPR_TIMER_SCOPE(\"sendmsg\", 1);",
          "new_line_content": " * of bytes sent. */",
          "content_same": false
        },
        {
          "line": 1071,
          "old_api": "ref_init",
          "new_api": null,
          "old_text": "ref_init(&tcp->refcount, 1);\n  ",
          "new_text": null,
          "old_line_content": "  gpr_ref_init(&tcp->refcount, 1);",
          "new_line_content": "  tcp->socket_ts_enabled = false;",
          "content_same": false
        },
        {
          "line": 1072,
          "old_api": "atm_no_barrier_store",
          "new_api": null,
          "old_text": "atm_no_barrier_store(&tcp->shutdown_count, 0);\n  ",
          "new_text": null,
          "old_line_content": "  gpr_atm_no_barrier_store(&tcp->shutdown_count, 0);",
          "new_line_content": "  /* paired with unref in grpc_tcp_destroy */",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": "_STATS_INC_SYSCALL_WRITE",
          "new_api": null,
          "old_text": "_STATS_INC_SYSCALL_WRITE();\n  ",
          "new_text": null,
          "old_line_content": "    GRPC_STATS_INC_SYSCALL_WRITE();",
          "new_line_content": "  do {",
          "content_same": false
        },
        {
          "line": 564,
          "old_api": "msg",
          "new_api": null,
          "old_text": "msg(fd, msg, SENDMSG_FLAGS);\n  ",
          "new_text": null,
          "old_line_content": "    sent_length = sendmsg(fd, msg, SENDMSG_FLAGS);",
          "new_line_content": "    /* TODO(klempner): Cork if this is a partial write */",
          "content_same": false
        },
        {
          "line": 1075,
          "old_api": "_resource_user_create",
          "new_api": null,
          "old_text": "_resource_user_create(resource_quota, peer_string);\n  ",
          "new_text": null,
          "old_line_content": "  tcp->resource_user = grpc_resource_user_create(resource_quota, peer_string);",
          "new_line_content": "  tcp->em_fd = em_fd;",
          "content_same": false
        },
        {
          "line": 1079,
          "old_api": "_network_status_register_endpoint",
          "new_api": null,
          "old_text": "_network_status_register_endpoint(&tcp->base);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_network_status_register_endpoint(&tcp->base);",
          "new_line_content": "      &tcp->slice_allocator, tcp->resource_user, tcp_read_allocation_done, tcp);",
          "content_same": false
        },
        {
          "line": 1080,
          "old_api": "_resource_quota_unref_internal",
          "new_api": null,
          "old_text": "_resource_quota_unref_internal(resource_quota);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_resource_quota_unref_internal(resource_quota);",
          "new_line_content": "  /* Tell network status tracker about new endpoint */",
          "content_same": false
        },
        {
          "line": 1084,
          "old_api": "_event_engine_can_track_errors",
          "new_api": null,
          "old_text": "_event_engine_can_track_errors()) {\n",
          "new_text": null,
          "old_line_content": "  if (grpc_event_engine_can_track_errors()) {",
          "new_line_content": "  tcp->tb_head = nullptr;",
          "content_same": false
        },
        {
          "line": 1088,
          "old_api": "REF",
          "new_api": null,
          "old_text": "REF(tcp, \"error-tracking\");\n  ",
          "new_text": null,
          "old_line_content": "    TCP_REF(tcp, \"error-tracking\");",
          "new_line_content": "     * processing errors. We unref when we no longer want to track errors",
          "content_same": false
        },
        {
          "line": 1089,
          "old_api": "atm_rel_store",
          "new_api": null,
          "old_text": "atm_rel_store(&tcp->stop_error_notification, 0);\n  ",
          "new_text": null,
          "old_line_content": "    gpr_atm_rel_store(&tcp->stop_error_notification, 0);",
          "new_line_content": "     * separately. */",
          "content_same": false
        },
        {
          "line": 1099,
          "old_api": "terpret_cast<grpc_tcp*>(ep);",
          "new_api": null,
          "old_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1100,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(ep->vtable == &vtable);\n  ",
          "new_text": null,
          "old_line_content": "  GPR_ASSERT(ep->vtable == &vtable);",
          "new_line_content": "int grpc_tcp_fd(grpc_endpoint* ep) {",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": "ockopt",
          "new_api": null,
          "old_text": "ockopt(tcp->fd, SOL_SOCKET, SO_TIMESTAMPING,\n                   static_cast<void*>(&opt), sizeof(opt)) != ",
          "new_text": null,
          "old_line_content": "    if (setsockopt(tcp->fd, SOL_SOCKET, SO_TIMESTAMPING,",
          "new_line_content": "  if (!tcp->socket_ts_enabled) {",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": "ic_cast<void*>(&opt), si",
          "new_api": null,
          "old_text": "ic_cast<void*>(&opt), si",
          "new_text": null,
          "old_line_content": "                   static_cast<void*>(&opt), sizeof(opt)) != 0) {",
          "new_line_content": "    uint32_t opt = grpc_core::kTimestampingSocketOptions;",
          "content_same": false
        },
        {
          "line": 1106,
          "old_api": "_network_status_unregister_endpoint",
          "new_api": null,
          "old_text": "_network_status_unregister_endpoint(ep);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_network_status_unregister_endpoint(ep);",
          "new_line_content": "void grpc_tcp_destroy_and_release_fd(grpc_endpoint* ep, int* fd,",
          "content_same": false
        },
        {
          "line": 1107,
          "old_api": "terpret_cast<grpc_tcp*>(ep);",
          "new_api": null,
          "old_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "new_line_content": "                                     grpc_closure* done) {",
          "content_same": false
        },
        {
          "line": 1111,
          "old_api": "_slice_buffer_reset_and_unref_internal",
          "new_api": null,
          "old_text": "_slice_buffer_reset_and_unref_internal(&tcp->last_read_buffer);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_slice_buffer_reset_and_unref_internal(&tcp->last_read_buffer);",
          "new_line_content": "  tcp->release_fd = fd;",
          "content_same": false
        },
        {
          "line": 1112,
          "old_api": "_event_engine_can_track_errors",
          "new_api": null,
          "old_text": "_event_engine_can_track_errors()) {\n",
          "new_text": null,
          "old_line_content": "  if (grpc_event_engine_can_track_errors()) {",
          "new_line_content": "  tcp->release_fd_cb = done;",
          "content_same": false
        },
        {
          "line": 603,
          "old_api": "_SPACE",
          "new_api": null,
          "old_text": "_SPACE(sizeof(uint32_t))];\n ",
          "new_text": null,
          "old_line_content": "    char cmsg_buf[CMSG_SPACE(sizeof(uint32_t))];",
          "new_line_content": "  /* Set control message to indicate that you want timestamps. */",
          "content_same": false
        },
        {
          "line": 1115,
          "old_api": "_fd_set_error",
          "new_api": null,
          "old_text": "_fd_set_error(tcp->em_fd);\n  ",
          "new_text": null,
          "old_line_content": "    grpc_fd_set_error(tcp->em_fd);",
          "new_line_content": "    /* Stop errors notification. */",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": "terpret_cast<cmsghdr*>(u.cmsg_buf);",
          "new_api": null,
          "old_text": "terpret_cast<cmsghdr*>(u.cmsg_buf);\n  ",
          "new_text": null,
          "old_line_content": "  cmsghdr* cmsg = reinterpret_cast<cmsghdr*>(u.cmsg_buf);",
          "new_line_content": "    struct cmsghdr align;",
          "content_same": false
        },
        {
          "line": 609,
          "old_api": "_LEN",
          "new_api": null,
          "old_text": "_LEN(sizeof(uint32_t));\n  ",
          "new_text": null,
          "old_line_content": "  cmsg->cmsg_len = CMSG_LEN(sizeof(uint32_t));",
          "new_line_content": "  cmsg->cmsg_level = SOL_SOCKET;",
          "content_same": false
        },
        {
          "line": 610,
          "old_api": "_DATA",
          "new_api": null,
          "old_text": "_DATA(cmsg)) =\n",
          "new_text": null,
          "old_line_content": "  *reinterpret_cast<int*>(CMSG_DATA(cmsg)) =",
          "new_line_content": "  cmsg->cmsg_type = SO_TIMESTAMPING;",
          "content_same": false
        },
        {
          "line": 613,
          "old_api": "_SPACE",
          "new_api": null,
          "old_text": "_SPACE(sizeof(uint32_t));\n\n ",
          "new_text": null,
          "old_line_content": "  msg->msg_controllen = CMSG_SPACE(sizeof(uint32_t));",
          "new_line_content": "      grpc_core::kTimestampingRecordingOptions;",
          "content_same": false
        },
        {
          "line": 616,
          "old_api": "send",
          "new_api": null,
          "old_text": "send(tcp->fd, msg);\n  ",
          "new_text": null,
          "old_line_content": "  ssize_t length = tcp_send(tcp->fd, msg);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 619,
          "old_api": "ic_cast<size_t>(length)) {",
          "new_api": null,
          "old_text": "ic_cast<size_t>(length)) {\n",
          "new_text": null,
          "old_line_content": "  if (sending_length == static_cast<size_t>(length)) {",
          "new_line_content": "  *sent_length = length;",
          "content_same": false
        },
        {
          "line": 620,
          "old_api": "mu_lock",
          "new_api": null,
          "old_text": "mu_lock(&tcp->tb_mu);\n  ",
          "new_text": null,
          "old_line_content": "    gpr_mu_lock(&tcp->tb_mu);",
          "new_line_content": "  /* Only save timestamps if all the bytes were taken by sendmsg. */",
          "content_same": false
        },
        {
          "line": 639,
          "old_api": "_NXTHDR",
          "new_api": null,
          "old_text": "_NXTHDR(msg, cmsg);\n  ",
          "new_text": null,
          "old_line_content": "  auto next_cmsg = CMSG_NXTHDR(msg, cmsg);",
          "new_line_content": "struct cmsghdr* process_timestamp(grpc_tcp* tcp, msghdr* msg,",
          "content_same": false
        },
        {
          "line": 642,
          "old_api": "log",
          "new_api": null,
          "old_text": "log(GPR_ERROR, \"Received timestamp without extended error\");\n  ",
          "new_text": null,
          "old_line_content": "      gpr_log(GPR_ERROR, \"Received timestamp without extended error\");",
          "new_line_content": "  if (next_cmsg == nullptr) {",
          "content_same": false
        },
        {
          "line": 650,
          "old_api": "enabled",
          "new_api": null,
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": null,
          "old_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "      !(next_cmsg->cmsg_type == IP_RECVERR ||",
          "content_same": false
        },
        {
          "line": 651,
          "old_api": "log",
          "new_api": null,
          "old_text": "log(GPR_ERROR, \"Unexpected control message\");\n  ",
          "new_text": null,
          "old_line_content": "      gpr_log(GPR_ERROR, \"Unexpected control message\");",
          "new_line_content": "        next_cmsg->cmsg_type == IPV6_RECVERR)) {",
          "content_same": false
        },
        {
          "line": 657,
          "old_api": "_DATA",
          "new_api": null,
          "old_text": "_DATA(cmsg));\n ",
          "new_text": null,
          "old_line_content": "      reinterpret_cast<struct grpc_core::scm_timestamping*>(CMSG_DATA(cmsg));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 658,
          "old_api": "_DATA",
          "new_api": null,
          "old_text": "_DATA(next_cmsg));\n ",
          "new_text": null,
          "old_line_content": "  auto serr = reinterpret_cast<struct sock_extended_err*>(CMSG_DATA(next_cmsg));",
          "new_line_content": "  auto tss =",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": "log",
          "new_api": null,
          "old_text": "log(GPR_ERROR, \"Unexpected control message\");\n  ",
          "new_text": null,
          "old_line_content": "    gpr_log(GPR_ERROR, \"Unexpected control message\");",
          "new_line_content": "  if (serr->ee_errno != ENOMSG ||",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": "mu_lock",
          "new_api": null,
          "old_text": "mu_lock(&tcp->tb_mu);\n  ",
          "new_text": null,
          "old_line_content": "  gpr_mu_lock(&tcp->tb_mu);",
          "new_line_content": "   * to protect the traced buffer list. A lock free list might be better. Using",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": "_core::TracedBuffer::ProcessTimestamp(&tcp->tb_head, serr, tss);",
          "new_api": null,
          "old_text": "_core::TracedBuffer::ProcessTimestamp(&tcp->tb_head, serr, tss);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_core::TracedBuffer::ProcessTimestamp(&tcp->tb_head, serr, tss);",
          "new_line_content": "   * a simple mutex for now. */",
          "content_same": false
        },
        {
          "line": 695,
          "old_api": "et",
          "new_api": null,
          "old_text": "et(&aligned_buf, 0, sizeof(aligned_buf));\n\n ",
          "new_text": null,
          "old_line_content": "    memset(&aligned_buf, 0, sizeof(aligned_buf));",
          "new_line_content": "      struct cmsghdr align;",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": "msg",
          "new_api": null,
          "old_text": "msg(tcp->fd, &msg, MSG_ERRQUEUE);\n  ",
          "new_text": null,
          "old_line_content": "      r = recvmsg(tcp->fd, &msg, MSG_ERRQUEUE);",
          "new_line_content": "    int r, saved_errno;",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": "enabled",
          "new_api": null,
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": null,
          "old_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "      return false;",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": "_FIRSTHDR",
          "new_api": null,
          "old_text": "_FIRSTHDR(&msg); cm",
          "new_text": null,
          "old_line_content": "    for (auto cmsg = CMSG_FIRSTHDR(&msg); cmsg && cmsg->cmsg_len;",
          "new_line_content": "      return true;",
          "content_same": false
        },
        {
          "line": 723,
          "old_api": "_NXTHDR",
          "new_api": null,
          "old_text": "_NXTHDR(&msg, cmsg)) {\n",
          "new_text": null,
          "old_line_content": "         cmsg = CMSG_NXTHDR(&msg, cmsg)) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "enabled",
          "new_api": null,
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": null,
          "old_line_content": "        if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "        /* Got a control message that is not a timestamp. Don't know how to",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": "log",
          "new_api": null,
          "old_text": "log(GPR_INFO,\n                  \"unknown control message cmsg_level:%d cmsg_type:%d\",\n                  cmsg->cmsg_level, cmsg->cmsg_type);\n  ",
          "new_text": null,
          "old_line_content": "          gpr_log(GPR_INFO,",
          "new_line_content": "         * handle this. */",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": "ess_timestamp",
          "new_api": null,
          "old_text": "ess_timestamp(tcp, &msg, cmsg);\n  ",
          "new_text": null,
          "old_line_content": "      process_timestamp(tcp, &msg, cmsg);",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 741,
          "old_api": "ic_cast<grpc_tcp*>(arg);",
          "new_api": null,
          "old_text": "ic_cast<grpc_tcp*>(arg);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = static_cast<grpc_tcp*>(arg);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 742,
          "old_api": "enabled",
          "new_api": null,
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": null,
          "old_line_content": "  if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "static void tcp_handle_error(void* arg /* grpc_tcp */, grpc_error* error) {",
          "content_same": false
        },
        {
          "line": 747,
          "old_api": "atm_acq_load",
          "new_api": null,
          "old_text": "atm_acq_load(&tcp->stop_error_notification))) {",
          "new_text": null,
          "old_line_content": "      static_cast<bool>(gpr_atm_acq_load(&tcp->stop_error_notification))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 750,
          "old_api": "_ERROR_REF",
          "new_api": null,
          "old_text": "_ERROR_REF(error));\n ",
          "new_text": null,
          "old_line_content": "    grpc_core::TracedBuffer::Shutdown(&tcp->tb_head, GRPC_ERROR_REF(error));",
          "new_line_content": "    /* We aren't going to register to hear on error anymore, so it is safe to",
          "content_same": false
        },
        {
          "line": 751,
          "old_api": "UNREF",
          "new_api": null,
          "old_text": "UNREF(tcp, \"error-tracking\");\n  ",
          "new_text": null,
          "old_line_content": "    TCP_UNREF(tcp, \"error-tracking\");",
          "new_line_content": "     * unref. */",
          "content_same": false
        },
        {
          "line": 757,
          "old_api": "ess_errors",
          "new_api": null,
          "old_text": "ess_errors(tcp)) {\n",
          "new_text": null,
          "old_line_content": "  if (!process_errors(tcp)) {",
          "new_line_content": "  /* We are still interested in collecting timestamps, so let's try reading",
          "content_same": false
        },
        {
          "line": 761,
          "old_api": "_fd_set_readable",
          "new_api": null,
          "old_text": "_fd_set_readable(tcp->em_fd);\n  ",
          "new_text": null,
          "old_line_content": "    grpc_fd_set_readable(tcp->em_fd);",
          "new_line_content": "     * read and write closures to be ready.",
          "content_same": false
        },
        {
          "line": 762,
          "old_api": "_fd_set_writable",
          "new_api": null,
          "old_text": "_fd_set_writable(tcp->em_fd);\n  ",
          "new_text": null,
          "old_line_content": "    grpc_fd_set_writable(tcp->em_fd);",
          "new_line_content": "     */",
          "content_same": false
        },
        {
          "line": 774,
          "old_api": "log",
          "new_api": null,
          "old_text": "log(GPR_ERROR, \"Write with timestamps not supported for this platform\");\n  ",
          "new_text": null,
          "old_line_content": "  gpr_log(GPR_ERROR, \"Write with timestamps not supported for this platform\");",
          "new_line_content": "                                      ssize_t* sent_length,",
          "content_same": false
        },
        {
          "line": 775,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(0);\n  ",
          "new_text": null,
          "old_line_content": "  GPR_ASSERT(0);",
          "new_line_content": "                                      grpc_error** error) {",
          "content_same": false
        },
        {
          "line": 780,
          "old_api": "log",
          "new_api": null,
          "old_text": "log(GPR_ERROR, \"Error handling is not supported for this platform\");\n  ",
          "new_text": null,
          "old_line_content": "  gpr_log(GPR_ERROR, \"Error handling is not supported for this platform\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 781,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(0);\n}\n",
          "new_text": null,
          "old_line_content": "  GPR_ASSERT(0);",
          "new_line_content": "static void tcp_handle_error(void* arg /* grpc_tcp */, grpc_error* error) {",
          "content_same": false
        },
        {
          "line": 813,
          "old_api": "_SLICE_START_PTR",
          "new_api": null,
          "old_text": "_SLICE_START_PTR(\n              tcp->outgoing_buffer->slices[outgoing_slice_idx]) +\n ",
          "new_text": null,
          "old_line_content": "          GRPC_SLICE_START_PTR(",
          "new_line_content": "         iov_size++) {",
          "content_same": false
        },
        {
          "line": 817,
          "old_api": "_SLICE_LENGTH",
          "new_api": null,
          "old_text": "_SLICE_LENGTH(tcp->outgoing_buffer->slices[outgoing_slice_idx]) -\n ",
          "new_text": null,
          "old_line_content": "          GRPC_SLICE_LENGTH(tcp->outgoing_buffer->slices[outgoing_slice_idx]) -",
          "new_line_content": "          tcp->outgoing_byte_idx;",
          "content_same": false
        },
        {
          "line": 823,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(iov_size > 0);\n\n ",
          "new_text": null,
          "old_line_content": "    GPR_ASSERT(iov_size > 0);",
          "new_line_content": "      tcp->outgoing_byte_idx = 0;",
          "content_same": false
        },
        {
          "line": 831,
          "old_api": "write_with_timestamps",
          "new_api": null,
          "old_text": "write_with_timestamps(tcp, &msg, sending_length, &sent_length,\n                                     error))\n  ",
          "new_text": null,
          "old_line_content": "      if (!tcp_write_with_timestamps(tcp, &msg, sending_length, &sent_length,",
          "new_line_content": "    msg.msg_flags = 0;",
          "content_same": false
        },
        {
          "line": 838,
          "old_api": "_STATS_INC_TCP_WRITE_SIZE",
          "new_api": null,
          "old_text": "_STATS_INC_TCP_WRITE_SIZE(sending_length);\n  ",
          "new_text": null,
          "old_line_content": "      GRPC_STATS_INC_TCP_WRITE_SIZE(sending_length);",
          "new_line_content": "      msg.msg_controllen = 0;",
          "content_same": false
        },
        {
          "line": 839,
          "old_api": "_STATS_INC_TCP_WRITE_IOV_SIZE",
          "new_api": null,
          "old_text": "_STATS_INC_TCP_WRITE_IOV_SIZE(iov_size);\n\n ",
          "new_text": null,
          "old_line_content": "      GRPC_STATS_INC_TCP_WRITE_IOV_SIZE(iov_size);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 850,
          "old_api": "_slice_unref_internal",
          "new_api": null,
          "old_text": "_slice_unref_internal(\n              grpc_slice_buffer_take_first(tcp->outgoing_buffer));\n  ",
          "new_text": null,
          "old_line_content": "          grpc_slice_unref_internal(",
          "new_line_content": "        // point",
          "content_same": false
        },
        {
          "line": 851,
          "old_api": "_slice_buffer_take_first",
          "new_api": null,
          "old_text": "_slice_buffer_take_first(tcp->outgoing_buffer));\n ",
          "new_text": null,
          "old_line_content": "              grpc_slice_buffer_take_first(tcp->outgoing_buffer));",
          "new_line_content": "        for (size_t idx = 0; idx < unwind_slice_idx; ++idx) {",
          "content_same": false
        },
        {
          "line": 855,
          "old_api": "_OS_ERROR",
          "new_api": null,
          "old_text": "_OS_ERROR(errno, \"sendmsg\"), tc",
          "new_text": null,
          "old_line_content": "        *error = tcp_annotate_error(GRPC_OS_ERROR(errno, \"sendmsg\"), tcp);",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 856,
          "old_api": "_slice_buffer_reset_and_unref_internal",
          "new_api": null,
          "old_text": "_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);\n  ",
          "new_text": null,
          "old_line_content": "        grpc_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);",
          "new_line_content": "      } else if (errno == EPIPE) {",
          "content_same": false
        },
        {
          "line": 859,
          "old_api": "_OS_ERROR",
          "new_api": null,
          "old_text": "_OS_ERROR(errno, \"sendmsg\"), tc",
          "new_text": null,
          "old_line_content": "        *error = tcp_annotate_error(GRPC_OS_ERROR(errno, \"sendmsg\"), tcp);",
          "new_line_content": "        return true;",
          "content_same": false
        },
        {
          "line": 860,
          "old_api": "_slice_buffer_reset_and_unref_internal",
          "new_api": null,
          "old_text": "_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);\n  ",
          "new_text": null,
          "old_line_content": "        grpc_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);",
          "new_line_content": "      } else {",
          "content_same": false
        },
        {
          "line": 865,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(tcp->outgoing_byte_idx == 0);\n  ",
          "new_text": null,
          "old_line_content": "    GPR_ASSERT(tcp->outgoing_byte_idx == 0);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 873,
          "old_api": "_SLICE_LENGTH",
          "new_api": null,
          "old_text": "_SLICE_LENGTH(tcp->outgoing_buffer->slices[outgoing_slice_idx]);\n  ",
          "new_text": null,
          "old_line_content": "          GRPC_SLICE_LENGTH(tcp->outgoing_buffer->slices[outgoing_slice_idx]);",
          "new_line_content": "      outgoing_slice_idx--;",
          "content_same": false
        },
        {
          "line": 883,
          "old_api": "_slice_buffer_reset_and_unref_internal",
          "new_api": null,
          "old_text": "_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);\n  ",
          "new_text": null,
          "old_line_content": "      grpc_slice_buffer_reset_and_unref_internal(tcp->outgoing_buffer);",
          "new_line_content": "    if (outgoing_slice_idx == tcp->outgoing_buffer->count) {",
          "content_same": false
        },
        {
          "line": 890,
          "old_api": "ic_cast<grpc_tcp*>(arg);",
          "new_api": null,
          "old_text": "ic_cast<grpc_tcp*>(arg);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = static_cast<grpc_tcp*>(arg);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 896,
          "old_api": "cb",
          "new_api": null,
          "old_text": "cb(cb->cb_arg, error);\n  ",
          "new_text": null,
          "old_line_content": "    cb->cb(cb->cb_arg, error);",
          "new_line_content": "    cb = tcp->write_cb;",
          "content_same": false
        },
        {
          "line": 897,
          "old_api": "UNREF",
          "new_api": null,
          "old_text": "UNREF(tcp, \"write\");\n  ",
          "new_text": null,
          "old_line_content": "    TCP_UNREF(tcp, \"write\");",
          "new_line_content": "    tcp->write_cb = nullptr;",
          "content_same": false
        },
        {
          "line": 901,
          "old_api": "flush",
          "new_api": null,
          "old_text": "flush(tcp, &error)) {\n",
          "new_text": null,
          "old_line_content": "  if (!tcp_flush(tcp, &error)) {",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 902,
          "old_api": "enabled",
          "new_api": null,
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": null,
          "old_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 909,
          "old_api": "enabled",
          "new_api": null,
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": null,
          "old_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "    cb = tcp->write_cb;",
          "content_same": false
        },
        {
          "line": 910,
          "old_api": "_error_string",
          "new_api": null,
          "old_text": "_error_string(error);\n  ",
          "new_text": null,
          "old_line_content": "      const char* str = grpc_error_string(error);",
          "new_line_content": "    tcp->write_cb = nullptr;",
          "content_same": false
        },
        {
          "line": 914,
          "old_api": "UNREF",
          "new_api": null,
          "old_text": "UNREF(tcp, \"write\");\n  ",
          "new_text": null,
          "old_line_content": "    TCP_UNREF(tcp, \"write\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 920,
          "old_api": "TIMER_SCOPE",
          "new_api": null,
          "old_text": "TIMER_SCOPE(\"tcp_write\", 0);\n  ",
          "new_text": null,
          "old_line_content": "  GPR_TIMER_SCOPE(\"tcp_write\", 0);",
          "new_line_content": "static void tcp_write(grpc_endpoint* ep, grpc_slice_buffer* buf,",
          "content_same": false
        },
        {
          "line": 921,
          "old_api": "terpret_cast<grpc_tcp*>(ep);",
          "new_api": null,
          "old_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "new_line_content": "                      grpc_closure* cb, void* arg) {",
          "content_same": false
        },
        {
          "line": 924,
          "old_api": "enabled",
          "new_api": null,
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": null,
          "old_line_content": "  if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "  grpc_error* error = GRPC_ERROR_NONE;",
          "content_same": false
        },
        {
          "line": 929,
          "old_api": "_dump_slice",
          "new_api": null,
          "old_text": "_dump_slice(buf->slices[i], GPR_DUMP_HEX | GPR_DUMP_ASCII);\n  ",
          "new_text": null,
          "old_line_content": "          grpc_dump_slice(buf->slices[i], GPR_DUMP_HEX | GPR_DUMP_ASCII);",
          "new_line_content": "    for (i = 0; i < buf->count; i++) {",
          "content_same": false
        },
        {
          "line": 930,
          "old_api": "log",
          "new_api": null,
          "old_text": "log(GPR_INFO, \"WRITE %p (peer=%s): %s\", tcp, tcp->peer_string, data);\n  ",
          "new_text": null,
          "old_line_content": "      gpr_log(GPR_INFO, \"WRITE %p (peer=%s): %s\", tcp, tcp->peer_string, data);",
          "new_line_content": "      char* data =",
          "content_same": false
        },
        {
          "line": 935,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(tcp->write_cb == nullptr);\n\n ",
          "new_text": null,
          "old_line_content": "  GPR_ASSERT(tcp->write_cb == nullptr);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 938,
          "old_api": "_CLOSURE_SCHED",
          "new_api": null,
          "old_text": "_CLOSURE_SCHED(\n        cb, grpc_fd_is_shutdown(tcp->em_fd)\n                ? tcp_annotate_error(\n                      GRPC_ERROR_CREATE_FROM_STATIC_STRING(\"EOF\"), tcp)\n                : GRPC_ERROR_NONE);\n  ",
          "new_text": null,
          "old_line_content": "    GRPC_CLOSURE_SCHED(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 939,
          "old_api": "_fd_is_shutdown",
          "new_api": null,
          "old_text": "_fd_is_shutdown(tcp->em_fd)\n   ",
          "new_text": null,
          "old_line_content": "        cb, grpc_fd_is_shutdown(tcp->em_fd)",
          "new_line_content": "  if (buf->length == 0) {",
          "content_same": false
        },
        {
          "line": 949,
          "old_api": "_event_engine_can_track_errors",
          "new_api": null,
          "old_text": "_event_engine_can_track_errors());\n ",
          "new_text": null,
          "old_line_content": "    GPR_ASSERT(grpc_event_engine_can_track_errors());",
          "new_line_content": "  tcp->outgoing_buffer_arg = arg;",
          "content_same": false
        },
        {
          "line": 952,
          "old_api": "flush",
          "new_api": null,
          "old_text": "flush(tcp, &error)) {\n",
          "new_text": null,
          "old_line_content": "  if (!tcp_flush(tcp, &error)) {",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 953,
          "old_api": "REF",
          "new_api": null,
          "old_text": "REF(tcp, \"write\");\n  ",
          "new_text": null,
          "old_line_content": "    TCP_REF(tcp, \"write\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 956,
          "old_api": "log",
          "new_api": null,
          "old_text": "log(GPR_INFO, \"write: delayed\");\n  ",
          "new_text": null,
          "old_line_content": "      gpr_log(GPR_INFO, \"write: delayed\");",
          "new_line_content": "    tcp->write_cb = cb;",
          "content_same": false
        },
        {
          "line": 961,
          "old_api": "_error_string",
          "new_api": null,
          "old_text": "_error_string(error);\n  ",
          "new_text": null,
          "old_line_content": "      const char* str = grpc_error_string(error);",
          "new_line_content": "  } else {",
          "content_same": false
        },
        {
          "line": 969,
          "old_api": "terpret_cast<grpc_tcp*>(ep);",
          "new_api": null,
          "old_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 970,
          "old_api": "_pollset_add_fd",
          "new_api": null,
          "old_text": "_pollset_add_fd(pollset, tcp->em_fd);\n}\n",
          "new_text": null,
          "old_line_content": "  grpc_pollset_add_fd(pollset, tcp->em_fd);",
          "new_line_content": "static void tcp_add_to_pollset(grpc_endpoint* ep, grpc_pollset* pollset) {",
          "content_same": false
        },
        {
          "line": 975,
          "old_api": "terpret_cast<grpc_tcp*>(ep);",
          "new_api": null,
          "old_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "new_line_content": "static void tcp_add_to_pollset_set(grpc_endpoint* ep,",
          "content_same": false
        },
        {
          "line": 976,
          "old_api": "_pollset_set_add_fd",
          "new_api": null,
          "old_text": "_pollset_set_add_fd(pollset_set, tcp->em_fd);\n}\n",
          "new_text": null,
          "old_line_content": "  grpc_pollset_set_add_fd(pollset_set, tcp->em_fd);",
          "new_line_content": "                                   grpc_pollset_set* pollset_set) {",
          "content_same": false
        },
        {
          "line": 981,
          "old_api": "terpret_cast<grpc_tcp*>(ep);",
          "new_api": null,
          "old_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "new_line_content": "static void tcp_delete_from_pollset_set(grpc_endpoint* ep,",
          "content_same": false
        },
        {
          "line": 982,
          "old_api": "_pollset_set_del_fd",
          "new_api": null,
          "old_text": "_pollset_set_del_fd(pollset_set, tcp->em_fd);\n}\n",
          "new_text": null,
          "old_line_content": "  grpc_pollset_set_del_fd(pollset_set, tcp->em_fd);",
          "new_line_content": "                                        grpc_pollset_set* pollset_set) {",
          "content_same": false
        },
        {
          "line": 986,
          "old_api": "terpret_cast<grpc_tcp*>(ep);",
          "new_api": null,
          "old_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 987,
          "old_api": "strdup",
          "new_api": null,
          "old_text": "strdup(tcp->peer_string);\n}\n",
          "new_text": null,
          "old_line_content": "  return gpr_strdup(tcp->peer_string);",
          "new_line_content": "static char* tcp_get_peer(grpc_endpoint* ep) {",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT((size_t)read_bytes == tcp->incoming_buffer->length);\n  ",
          "new_text": null,
          "old_line_content": "    GPR_ASSERT((size_t)read_bytes == tcp->incoming_buffer->length);",
          "new_line_content": "          &tcp->last_read_buffer);",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": "_read_cb",
          "new_api": null,
          "old_text": "_read_cb(tcp, GRPC_ERROR_NONE);\n  ",
          "new_text": null,
          "old_line_content": "    call_read_cb(tcp, GRPC_ERROR_NONE);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 991,
          "old_api": "terpret_cast<grpc_tcp*>(ep);",
          "new_api": null,
          "old_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": "ic_cast<grpc_tcp*>(tcpp);",
          "new_api": null,
          "old_text": "ic_cast<grpc_tcp*>(tcpp);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = static_cast<grpc_tcp*>(tcpp);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": "enabled",
          "new_api": null,
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": null,
          "old_line_content": "  if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "static void tcp_read_allocation_done(void* tcpp, grpc_error* error) {",
          "content_same": false
        },
        {
          "line": 996,
          "old_api": "terpret_cast<grpc_tcp*>(ep);",
          "new_api": null,
          "old_text": "terpret_cast<grpc_tcp*>(ep);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_tcp* tcp = reinterpret_cast<grpc_tcp*>(ep);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": "_slice_buffer_reset_and_unref_internal",
          "new_api": null,
          "old_text": "_slice_buffer_reset_and_unref_internal(tcp->incoming_buffer);\n  ",
          "new_text": null,
          "old_line_content": "    grpc_slice_buffer_reset_and_unref_internal(tcp->incoming_buffer);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": "_slice_buffer_reset_and_unref_internal",
          "new_api": null,
          "old_text": "_slice_buffer_reset_and_unref_internal(&tcp->last_read_buffer);\n  ",
          "new_text": null,
          "old_line_content": "    grpc_slice_buffer_reset_and_unref_internal(&tcp->last_read_buffer);",
          "new_line_content": "  if (error != GRPC_ERROR_NONE) {",
          "content_same": false
        },
        {
          "line": 500,
          "old_api": "target_read_size",
          "new_api": null,
          "old_text": "target_read_size(tcp);\n  ",
          "new_text": null,
          "old_line_content": "  size_t target_read_size = get_target_read_size(tcp);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": "enabled",
          "new_api": null,
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": null,
          "old_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "  if (tcp->incoming_buffer->length < target_read_size &&",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": "log",
          "new_api": null,
          "old_text": "log(GPR_INFO, \"TCP:%p alloc_slices\", tcp);\n  ",
          "new_text": null,
          "old_line_content": "      gpr_log(GPR_INFO, \"TCP:%p alloc_slices\", tcp);",
          "new_line_content": "      tcp->incoming_buffer->count < MAX_READ_IOVEC) {",
          "content_same": false
        },
        {
          "line": 1019,
          "old_api": "_resource_quota_create",
          "new_api": null,
          "old_text": "_resource_quota_create(nullptr);\n  ",
          "new_text": null,
          "old_line_content": "  grpc_resource_quota* resource_quota = grpc_resource_quota_create(nullptr);",
          "new_line_content": "  int tcp_max_read_chunk_size = 4 * 1024 * 1024;",
          "content_same": false
        },
        {
          "line": 509,
          "old_api": "enabled",
          "new_api": null,
          "old_text": "_tcp_trace.enabled()) {\n",
          "new_text": null,
          "old_line_content": "    if (grpc_tcp_trace.enabled()) {",
          "new_line_content": "                                    tcp->incoming_buffer);",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": "log",
          "new_api": null,
          "old_text": "log(GPR_INFO, \"TCP:%p do_read\", tcp);\n  ",
          "new_text": null,
          "old_line_content": "      gpr_log(GPR_INFO, \"TCP:%p do_read\", tcp);",
          "new_line_content": "  } else {",
          "content_same": false
        },
        {
          "line": 1023,
          "old_api": "mp",
          "new_api": null,
          "old_text": "mp(channel_args->args[i].key, GRPC_ARG_TCP_READ_CHUNK_SIZE)) {\n",
          "new_text": null,
          "old_line_content": "          strcmp(channel_args->args[i].key, GRPC_ARG_TCP_READ_CHUNK_SIZE)) {",
          "new_line_content": "    for (size_t i = 0; i < channel_args->num_args; i++) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 55,
      "total_additions": 138,
      "total_deletions": 136,
      "total_api_changes": 329
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 329,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 356,
    "api_calls_after": 358,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 1,
      "total_diff_lines": 16
    }
  }
}