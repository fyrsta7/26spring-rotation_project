{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/x64dbg/modified_file/529e5f1e3a4a1b3bd94c3858fd1fb876a9216859",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/x64dbg/modified_file/529e5f1e3a4a1b3bd94c3858fd1fb876a9216859/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/x64dbg/modified_file/529e5f1e3a4a1b3bd94c3858fd1fb876a9216859/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/x64dbg/modified_file/529e5f1e3a4a1b3bd94c3858fd1fb876a9216859/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 39,
          "old_api": "/ Don't use a foreach loop her",
          "new_api": "/ Erase element using native f",
          "old_text": "/ Don't use a foreach loop her",
          "new_text": "/ Erase element using native f",
          "old_line_content": null,
          "new_line_content": "    EXCLUSIVE_ACQUIRE(LockThreads);",
          "content_same": true
        },
        {
          "line": 42,
          "old_api": "(itr->first == T",
          "new_api": "end",
          "old_text": "(itr->first == T",
          "new_text": " threadList.end())\n      ",
          "old_line_content": "    for(auto itr = threadList.begin(); itr != threadList.end(); itr++)",
          "new_line_content": "    auto itr = threadList.find(ThreadId);",
          "content_same": false
        },
        {
          "line": 59,
          "old_api": "e the GUI's list",
          "new_api": "D_ACQUIRE",
          "old_text": "e the GUI's list\n ",
          "new_text": "D_ACQUIRE(LockThreads",
          "old_line_content": "    threadList.clear();",
          "new_line_content": "    GuiUpdateThreadView();",
          "content_same": false
        },
        {
          "line": 107,
          "old_api": "etContextDataEx",
          "new_api": "List->list[i].LastError =",
          "old_text": "etContextDataEx(threadHandle, UE_CIP);\n        List->list[i].Suspend",
          "new_text": "     List->list[i].LastError = ",
          "old_line_content": "        memcpy(&List->list[i].BasicInfo, &threadList[i], sizeof(THREADINFO));",
          "new_line_content": "        List->list[i].Priority = ThreadGetPriority(threadHandle);",
          "content_same": false
        },
        {
          "line": 109,
          "old_api": "dle);\n        List->list[i].Priority =",
          "new_api": "find",
          "old_text": "dle);\n        List->list[i].Priority =",
          "new_text": "_ACQUIRE(LockThreads);\n    return threadList.find(",
          "old_line_content": "        List->list[i].ThreadCip = GetContextDataEx(threadHandle, UE_CIP);",
          "new_line_content": "        List->list[i].LastError = getLastErrorFromTeb(threadList[i].ThreadLocalBase);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 135,
          "old_api": null,
          "new_api": "ead);\n\n    return sus",
          "old_text": null,
          "new_text": "ead);\n\n    return sus",
          "old_line_content": "    //",
          "new_line_content": "    int suspendCount = (int)SuspendThread(Thread);",
          "content_same": false
        },
        {
          "line": 141,
          "old_api": null,
          "new_api": "ority",
          "old_text": null,
          "new_text": "ority(Thread);\n}\n\nTH",
          "old_line_content": "    if(suspendCount == -1)",
          "new_line_content": "    ResumeThread(Thread);",
          "content_same": false
        },
        {
          "line": 148,
          "old_api": null,
          "new_api": "s\n    return _Executive;",
          "old_text": null,
          "new_text": "s\n    return _Executive;\n",
          "old_line_content": "}",
          "new_line_content": "    return (THREADPRIORITY)GetThreadPriority(Thread);",
          "content_same": false
        },
        {
          "line": 153,
          "old_api": null,
          "new_api": "kThreads);\n\n    if(threadList.",
          "old_text": null,
          "new_text": "kThreads);\n\n    if(threadList.",
          "old_line_content": "}",
          "new_line_content": "    UNREFERENCED_PARAMETER(Thread);",
          "content_same": false
        },
        {
          "line": 161,
          "old_api": null,
          "new_api": "return 0;\n}\n\nbool Thread",
          "old_text": null,
          "new_text": "   return 0;\n}\n\nbool Thread",
          "old_line_content": "}",
          "new_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": null,
          "new_api": "{\n    EXCLUSIVE",
          "old_text": null,
          "new_text": "\n{\n    EXCLUSIVE",
          "old_line_content": "DWORD ThreadGetLastError(DWORD ThreadId)",
          "new_line_content": "    if(threadList.find(ThreadId) != threadList.end())",
          "content_same": false
        },
        {
          "line": 164,
          "old_api": null,
          "new_api": "ds);\n\n    // Modifies a variable (name), so an exclusive",
          "old_text": null,
          "new_text": "ds);\n\n    // Modifies a variable (name), so an exclusive ",
          "old_line_content": "{",
          "new_line_content": "        return getLastErrorFromTeb(threadList[ThreadId].ThreadLocalBase);",
          "content_same": false
        },
        {
          "line": 171,
          "old_api": null,
          "new_api": "f",
          "old_text": null,
          "new_text": "f(!Name)\n            Name = \"\"",
          "old_line_content": "}",
          "new_line_content": "    EXCLUSIVE_ACQUIRE(LockThreads);",
          "content_same": false
        },
        {
          "line": 44,
          "old_api": null,
          "new_api": "itr);\n\n    EXCLU",
          "old_text": null,
          "new_text": "itr);\n\n    EXCLU",
          "old_line_content": "        if(itr->first == ThreadId)",
          "new_line_content": "    if(itr != threadList.end())",
          "content_same": false
        },
        {
          "line": 45,
          "old_api": null,
          "new_api": "E",
          "old_text": null,
          "new_text": "E();\n    GuiUpdateThr",
          "old_line_content": "        {",
          "new_line_content": "        threadList.erase(itr);",
          "content_same": false
        },
        {
          "line": 174,
          "old_api": null,
          "new_api": "ANDLE ThreadGetH",
          "old_text": null,
          "new_text": "ANDLE ThreadGetH",
          "old_line_content": "{",
          "new_line_content": "    if(threadList.find(ThreadId) != threadList.end())",
          "content_same": false
        },
        {
          "line": 47,
          "old_api": null,
          "new_api": ";\n}\n\nvoid ThreadCle",
          "old_text": null,
          "new_text": ";\n}\n\nvoid ThreadCle",
          "old_line_content": "            break;",
          "new_line_content": "    EXCLUSIVE_RELEASE();",
          "content_same": false
        },
        {
          "line": 48,
          "old_api": null,
          "new_api": "// Clear the curr",
          "old_text": null,
          "new_text": "    // Clear the curr",
          "old_line_content": "        }",
          "new_line_content": "    GuiUpdateThreadView();",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": null,
          "new_api": "find",
          "old_text": null,
          "new_text": "f(threadList.find(ThreadId) != threadList.end()",
          "old_line_content": "    {",
          "new_line_content": "        strcpy_s(threadList[ThreadId].threadName, Name);",
          "content_same": false
        },
        {
          "line": 54,
          "old_api": null,
          "new_api": ");\n    EXCLUSIVE_RELEASE();",
          "old_text": null,
          "new_text": ");\n    EXCLUSIVE_RELEASE();\n\n ",
          "old_line_content": "",
          "new_line_content": "    EXCLUSIVE_ACQUIRE(LockThreads);",
          "content_same": false
        },
        {
          "line": 55,
          "old_api": null,
          "new_api": "pdate the GUI's li",
          "old_text": null,
          "new_text": "pdate the GUI's li",
          "old_line_content": "void ThreadClear()",
          "new_line_content": "    threadList.clear();",
          "content_same": false
        },
        {
          "line": 56,
          "old_api": null,
          "new_api": "GuiUpdateThreadView",
          "old_text": null,
          "new_text": "GuiUpdateThreadView",
          "old_line_content": "{",
          "new_line_content": "    EXCLUSIVE_RELEASE();",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": null,
          "new_api": "SHARED_ACQUIRE(LockThre",
          "old_text": null,
          "new_text": "    SHARED_ACQUIRE(LockThre",
          "old_line_content": "}",
          "new_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": null,
          "new_api": "cal list\n    for",
          "old_text": null,
          "new_text": "cal list\n    for",
          "old_line_content": "HANDLE ThreadGetHandle(DWORD ThreadId)",
          "new_line_content": "    if(threadList.find(ThreadId) != threadList.end())",
          "content_same": false
        },
        {
          "line": 64,
          "old_api": null,
          "new_api": "}\n\nDWORD getLastErrorFromT",
          "old_text": null,
          "new_text": "\n}\n\nDWORD getLastErrorFromT",
          "old_line_content": "}",
          "new_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "content_same": false
        },
        {
          "line": 65,
          "old_api": null,
          "new_api": "LocalBase)\n{",
          "old_text": null,
          "new_text": "LocalBase)\n{\n    ",
          "old_line_content": "",
          "new_line_content": "    return (int)threadList.size();",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": null,
          "new_api": "// Wasn't found, check wi",
          "old_text": null,
          "new_text": "  // Wasn't found, check wi",
          "old_line_content": "}",
          "new_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "content_same": false
        },
        {
          "line": 72,
          "old_api": null,
          "new_api": "LastErrorValue;\n}\n\nvoid ThreadGetLi",
          "old_text": null,
          "new_text": "LastErrorValue;\n}\n\nvoid ThreadGetLi",
          "old_line_content": "DWORD getLastErrorFromTeb(ULONG_PTR ThreadLocalBase)",
          "new_line_content": "    if(!ThreadGetTeb(ThreadLocalBase, &teb))",
          "content_same": false
        },
        {
          "line": 80,
          "old_api": null,
          "new_api": "ector to a C-style THREADLI",
          "old_text": null,
          "new_text": "ector to a C-style THREADLI",
          "old_line_content": "}",
          "new_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": null,
          "new_api": "st)\n    {\n        i",
          "old_text": null,
          "new_text": "st)\n    {\n        i",
          "old_line_content": "            return entry.first;",
          "new_line_content": "    return GetThreadId(Thread);",
          "content_same": false
        },
        {
          "line": 86,
          "old_api": null,
          "new_api": "List->list = (THR",
          "old_text": null,
          "new_text": "List->list = (THR",
          "old_line_content": "    //",
          "new_line_content": "    int count = (int)threadList.size();",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": null,
          "new_api": "//\n    // ResumeThread",
          "old_text": null,
          "new_text": "\n    //\n    // ResumeThread",
          "old_line_content": "{",
          "new_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": null,
          "new_api": "0; i < count; i++)\n    {\n        HANDLE th",
          "old_text": null,
          "new_text": "0; i < count; i++)\n    {\n        HANDLE th",
          "old_line_content": "    if(count <= 0)",
          "new_line_content": "    List->list = (THREADALLINFO*)BridgeAlloc(count * sizeof(THREADALLINFO));",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": null,
          "new_api": "int count = 0;\n    for(auto",
          "old_text": null,
          "new_text": "\n\n    int count = 0;\n    for(auto ",
          "old_line_content": "",
          "new_line_content": "        if(SuspendThread(entry.second.Handle) != -1)",
          "content_same": false
        },
        {
          "line": 103,
          "old_api": null,
          "new_api": "= GetContextDataEx(threadHandle, UE_CIP);\n        List->list[i].Sus",
          "old_text": null,
          "new_text": " = GetContextDataEx(threadHandle, UE_CIP);\n        List->list[i].Sus",
          "old_line_content": "        // Get the debugger's current thread index",
          "new_line_content": "        memcpy(&List->list[i].BasicInfo, &threadList[i], sizeof(THREADINFO));",
          "content_same": false
        },
        {
          "line": 105,
          "old_api": null,
          "new_api": "dHandle);\n        List->list[i].Priori",
          "old_text": null,
          "new_text": "dHandle);\n        List->list[i].Priori",
          "old_line_content": "            List->CurrentThread = i;",
          "new_line_content": "        List->list[i].ThreadCip = GetContextDataEx(threadHandle, UE_CIP);",
          "content_same": false
        },
        {
          "line": 106,
          "old_api": null,
          "new_api": "List->list[i].WaitReason = Th",
          "old_text": null,
          "new_text": "      List->list[i].WaitReason = Th",
          "old_line_content": "",
          "new_line_content": "        List->list[i].SuspendCount = ThreadGetSuspendCount(threadHandle);",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "{",
          "new_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "content_same": false
        },
        {
          "line": 108,
          "old_api": null,
          "new_api": "adLocalBase);\n    }\n}\n\nbool Threa",
          "old_text": null,
          "new_text": "adLocalBase);\n    }\n}\n\nbool Threa",
          "old_line_content": "",
          "new_line_content": "        List->list[i].WaitReason = ThreadGetWaitReason(threadHandle);",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "",
          "new_line_content": "        if(ResumeThread(entry.second.Handle) != -1)",
          "content_same": false
        },
        {
          "line": 115,
          "old_api": null,
          "new_api": "EBAddress, TEB* Teb)\n{",
          "old_text": null,
          "new_text": "EBAddress, TEB* Teb)\n{\n    ",
          "old_line_content": "}",
          "new_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "content_same": false
        },
        {
          "line": 116,
          "old_api": null,
          "new_api": "he vector\n    //",
          "old_text": null,
          "new_text": "he vector\n    //",
          "old_line_content": "",
          "new_line_content": "    return threadList.find(ThreadId) != threadList.end();",
          "content_same": false
        },
        {
          "line": 124,
          "old_api": null,
          "new_api": "t",
          "old_text": null,
          "new_text": "t(HANDLE Thread)\n{\n    //\n ",
          "old_line_content": "{",
          "new_line_content": "    memset(Teb, 0, sizeof(TEB));",
          "content_same": false
        },
        {
          "line": 126,
          "old_api": null,
          "new_api": "thread in order to get the previous suspension count",
          "old_text": null,
          "new_text": "thread in order to get the previous suspension count\n",
          "old_line_content": "    // TODO: Keep a cached copy inside the vector",
          "new_line_content": "    return MemRead((void*)TEBAddress, Teb, sizeof(TEB), nullptr);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 128,
          "old_api": "NDLE Thread)\n{\n    //\n    /",
          "new_api": null,
          "old_text": "NDLE Thread)\n{\n    //\n    /",
          "new_text": null,
          "old_line_content": "    memset(Teb, 0, sizeof(TEB));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 130,
          "old_api": "ad in order to get the previous suspension count",
          "new_api": null,
          "old_text": "ad in order to get the previous suspension count\n    ",
          "new_text": null,
          "old_line_content": "    return MemRead((void*)TEBAddress, Teb, sizeof(TEB), nullptr);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": ";\n\n    return suspend",
          "new_api": null,
          "old_text": ";\n\n    return suspend",
          "new_text": null,
          "old_line_content": "    int suspendCount = (int)SuspendThread(Thread);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": "y",
          "new_api": null,
          "old_text": "y(Thread);\n}\n\nTHREAD",
          "new_text": null,
          "old_line_content": "    ResumeThread(Thread);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": "return _Executive;\n}\n\nD",
          "new_api": null,
          "old_text": "  return _Executive;\n}\n\nD",
          "new_text": null,
          "old_line_content": "    return (THREADPRIORITY)GetThreadPriority(Thread);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 157,
          "old_api": "eads);\n\n    if(threadList.find",
          "new_api": null,
          "old_text": "eads);\n\n    if(threadList.find",
          "new_text": null,
          "old_line_content": "    UNREFERENCED_PARAMETER(Thread);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": "eturn 0;\n}\n\nbool ThreadSetN",
          "new_api": null,
          "old_text": "eturn 0;\n}\n\nbool ThreadSetN",
          "new_text": null,
          "old_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 167,
          "old_api": "EXCLUSIVE_ACQ",
          "new_api": null,
          "old_text": "   EXCLUSIVE_ACQ",
          "new_text": null,
          "old_line_content": "    if(threadList.find(ThreadId) != threadList.end())",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 168,
          "old_api": "// Modifies a variable (name), so an exclusive lock",
          "new_api": null,
          "old_text": "\n\n    // Modifies a variable (name), so an exclusive lock",
          "new_text": null,
          "old_line_content": "        return getLastErrorFromTeb(threadList[ThreadId].ThreadLocalBase);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 46,
          "old_api": "}\n    }\n\n    EXC",
          "new_api": null,
          "old_text": "     }\n    }\n\n    EXC",
          "new_text": null,
          "old_line_content": "            threadList.erase(itr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": "ame)\n            Name = \"\";",
          "new_api": null,
          "old_text": "ame)\n            Name = \"\";\n\n ",
          "new_text": null,
          "old_line_content": "    EXCLUSIVE_ACQUIRE(LockThreads);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": "E ThreadGetHandl",
          "new_api": null,
          "old_text": "E ThreadGetHandl",
          "new_text": null,
          "old_line_content": "    if(threadList.find(ThreadId) != threadList.end())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 51,
          "old_api": "void ThreadClear()",
          "new_api": null,
          "old_text": "\nvoid ThreadClear()",
          "new_text": null,
          "old_line_content": "    EXCLUSIVE_RELEASE();",
          "new_line_content": "void ThreadClear()",
          "content_same": false
        },
        {
          "line": 52,
          "old_api": "// Clear the current",
          "new_api": null,
          "old_text": "// Clear the current ",
          "new_text": null,
          "old_line_content": "    GuiUpdateThreadView();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": "find",
          "new_api": null,
          "old_text": "readList.find(ThreadId) != threadList.end())\n  ",
          "new_text": null,
          "old_line_content": "        strcpy_s(threadList[ThreadId].threadName, Name);",
          "new_line_content": "    return false;",
          "content_same": false
        },
        {
          "line": 58,
          "old_api": "EXCLUSIVE_RELEASE();\n\n    /",
          "new_api": null,
          "old_text": "   EXCLUSIVE_RELEASE();\n\n    /",
          "new_text": null,
          "old_line_content": "    EXCLUSIVE_ACQUIRE(LockThreads);",
          "new_line_content": "    // Update the GUI's list",
          "content_same": false
        },
        {
          "line": 60,
          "old_api": "pdateThreadView",
          "new_api": null,
          "old_text": "pdateThreadView();\n",
          "new_text": null,
          "old_line_content": "    EXCLUSIVE_RELEASE();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 63,
          "old_api": "QUIRE",
          "new_api": null,
          "old_text": "QUIRE(LockThreads);\n ",
          "new_text": null,
          "old_line_content": "    GuiUpdateThreadView();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": "SHARED_ACQUIRE",
          "new_api": null,
          "old_text": "SHARED_ACQUIRE(LockThreads)",
          "new_text": null,
          "old_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": "list\n    for(aut",
          "new_api": null,
          "old_text": "list\n    for(aut",
          "new_text": null,
          "old_line_content": "    if(threadList.find(ThreadId) != threadList.end())",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 68,
          "old_api": "DWORD getLastErrorFromTeb(U",
          "new_api": null,
          "old_text": "DWORD getLastErrorFromTeb(U",
          "new_text": null,
          "old_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "new_line_content": "DWORD getLastErrorFromTeb(ULONG_PTR ThreadLocalBase)",
          "content_same": false
        },
        {
          "line": 69,
          "old_api": "lBase)\n{\n    TEB",
          "new_api": null,
          "old_text": "lBase)\n{\n    TEB ",
          "new_text": null,
          "old_line_content": "    return (int)threadList.size();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": "Wasn't found, check with W",
          "new_api": null,
          "old_text": " Wasn't found, check with W",
          "new_text": null,
          "old_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 76,
          "old_api": "ErrorValue;\n}\n\nvoid ThreadGetList(T",
          "new_api": null,
          "old_text": "ErrorValue;\n}\n\nvoid ThreadGetList(T",
          "new_text": null,
          "old_line_content": "    if(!ThreadGetTeb(ThreadLocalBase, &teb))",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 84,
          "old_api": "r to a C-style THREADLIST[]",
          "new_api": null,
          "old_text": "r to a C-style THREADLIST[]",
          "new_text": null,
          "old_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "new_line_content": "    // Also assume BridgeAlloc zeros the returned buffer.",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "{\n        if(Su",
          "new_api": null,
          "old_text": "    {\n        if(Su",
          "new_text": null,
          "old_line_content": "    return GetThreadId(Thread);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 90,
          "old_api": "->list = (THREADA",
          "new_api": null,
          "old_text": "->list = (THREADA",
          "new_text": null,
          "old_line_content": "    int count = (int)threadList.size();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": "//\n    // ResumeThread doe",
          "new_api": null,
          "old_text": " //\n    // ResumeThread doe",
          "new_text": null,
          "old_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 96,
          "old_api": "< count; i++)\n    {\n        HANDLE thread",
          "new_api": null,
          "old_text": " < count; i++)\n    {\n        HANDLE thread",
          "new_text": null,
          "old_line_content": "    List->list = (THREADALLINFO*)BridgeAlloc(count * sizeof(THREADALLINFO));",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "int count = 0;\n    for(auto & en",
          "new_api": null,
          "old_text": "  int count = 0;\n    for(auto & en",
          "new_text": null,
          "old_line_content": "        if(SuspendThread(entry.second.Handle) != -1)",
          "new_line_content": "    return count;",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 110,
          "old_api": "List->list[i].WaitReason = Thread",
          "new_api": null,
          "old_text": "  List->list[i].WaitReason = Thread",
          "new_text": null,
          "old_line_content": "        List->list[i].SuspendCount = ThreadGetSuspendCount(threadHandle);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 111,
          "old_api": "List->list[i].LastError = getL",
          "new_api": null,
          "old_text": " List->list[i].LastError = getL",
          "new_text": null,
          "old_line_content": "        List->list[i].Priority = ThreadGetPriority(threadHandle);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": "calBase);\n    }\n}\n\nbool ThreadIsV",
          "new_api": null,
          "old_text": "calBase);\n    }\n}\n\nbool ThreadIsV",
          "new_text": null,
          "old_line_content": "        List->list[i].WaitReason = ThreadGetWaitReason(threadHandle);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 113,
          "old_api": "find",
          "new_api": null,
          "old_text": "UIRE(LockThreads);\n    return threadList.find(Thre",
          "new_text": null,
          "old_line_content": "        List->list[i].LastError = getLastErrorFromTeb(threadList[i].ThreadLocalBase);",
          "new_line_content": "bool ThreadIsValid(DWORD ThreadId)",
          "content_same": false
        },
        {
          "line": 242,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        if(ResumeThread(entry.second.Handle) != -1)",
          "new_line_content": "    return count;",
          "content_same": false
        },
        {
          "line": 119,
          "old_api": "dress, TEB* Teb)\n{\n    //",
          "new_api": null,
          "old_text": "dress, TEB* Teb)\n{\n    //\n ",
          "new_text": null,
          "old_line_content": "    SHARED_ACQUIRE(LockThreads);",
          "new_line_content": "bool ThreadGetTeb(uint TEBAddress, TEB* Teb)",
          "content_same": false
        },
        {
          "line": 120,
          "old_api": "ector\n    //",
          "new_api": null,
          "old_text": "ector\n    //\n   ",
          "new_text": null,
          "old_line_content": "    return threadList.find(ThreadId) != threadList.end();",
          "new_line_content": "{",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 5,
      "total_additions": 39,
      "total_deletions": 38,
      "total_api_changes": 82
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 9,
        "api_related_lines": 82,
        "non_api_lines": 3,
        "non_api_line_numbers": [
          41,
          43,
          49
        ]
      }
    },
    "api_calls_before": 57,
    "api_calls_after": 57,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 9,
      "total_diff_lines": 26
    }
  }
}