{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/c76c11d8cd155d5adc454e046148bcba01570ded",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/c76c11d8cd155d5adc454e046148bcba01570ded/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/c76c11d8cd155d5adc454e046148bcba01570ded/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/c76c11d8cd155d5adc454e046148bcba01570ded/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 41,
          "old_api": "StringRef",
          "new_api": "allocContinue",
          "old_text": "StringRef(pos, sizeof(T))",
          "new_text": "arena.allocContinue(sizeof(T), begin)",
          "old_line_content": "    return StringRef(pos, sizeof(T));",
          "new_line_content": "    auto pos = arena.allocContinue(sizeof(T), begin);",
          "content_same": false
        },
        {
          "line": 74,
          "old_api": "size",
          "new_api": "permutation",
          "old_text": "tmp_res.size()",
          "new_text": "permutation(reverse, limit, tmp_res)",
          "old_line_content": "        res.resize(tmp_res.size());",
          "new_line_content": "        permutation(reverse, limit, tmp_res);",
          "content_same": false
        },
        {
          "line": 89,
          "old_api": "Exception",
          "new_api": "size",
          "old_text": "Exception(\"Size of permutation is less than required.\", ErrorCodes::SIZES_OF_COLUMNS_DOESNT_MATCH)",
          "new_text": "data.size()",
          "old_line_content": "        throw Exception(\"Size of permutation is less than required.\", ErrorCodes::SIZES_OF_COLUMNS_DOESNT_MATCH);",
          "new_line_content": "    size_t size = limit ? std::min(data.size(), limit) : data.size();",
          "content_same": false
        },
        {
          "line": 91,
          "old_api": "create",
          "new_api": "Exception",
          "old_text": "this->create(size, scale)",
          "new_text": "Exception(\"Size of permutation is less than required.\", ErrorCodes::SIZES_OF_COLUMNS_DOESNT_MATCH)",
          "old_line_content": "    auto res = this->create(size, scale);",
          "new_line_content": "        throw Exception(\"Size of permutation is less than required.\", ErrorCodes::SIZES_OF_COLUMNS_DOESNT_MATCH);",
          "content_same": false
        },
        {
          "line": 110,
          "old_api": "size",
          "new_api": "resize",
          "old_text": "this->size()",
          "new_text": "new_col.data.resize(size)",
          "old_line_content": "        size_t count = std::min(this->size(), size);",
          "new_line_content": "        new_col.data.resize(size);",
          "content_same": false
        },
        {
          "line": 136,
          "old_api": "size",
          "new_api": "static_cast<const ColumnDecimal &>(src)",
          "old_text": "src_vec.data.size()",
          "new_text": "static_cast<const ColumnDecimal &>(src)",
          "old_line_content": "    if (start + length > src_vec.data.size())",
          "new_line_content": "    const ColumnDecimal & src_vec = static_cast<const ColumnDecimal &>(src);",
          "content_same": false
        },
        {
          "line": 143,
          "old_api": "data",
          "new_api": "size",
          "old_text": "data.data()",
          "new_text": "data.size()",
          "old_line_content": "    memcpy(data.data() + old_size, &src_vec.data[start], length * sizeof(data[0]));",
          "new_line_content": "    size_t old_size = data.size();",
          "content_same": false
        },
        {
          "line": 151,
          "old_api": "Exception",
          "new_api": "size",
          "old_text": "Exception(\"Size of filter doesn't match size of column.\", ErrorCodes::SIZES_OF_COLUMNS_DOESNT_MATCH)",
          "new_text": "data.size()",
          "old_line_content": "        throw Exception(\"Size of filter doesn't match size of column.\", ErrorCodes::SIZES_OF_COLUMNS_DOESNT_MATCH);",
          "new_line_content": "    size_t size = data.size();",
          "content_same": false
        },
        {
          "line": 153,
          "old_api": "create",
          "new_api": "Exception",
          "old_text": "this->create(0, scale)",
          "new_text": "Exception(\"Size of filter doesn't match size of column.\", ErrorCodes::SIZES_OF_COLUMNS_DOESNT_MATCH)",
          "old_line_content": "    auto res = this->create(0, scale);",
          "new_line_content": "        throw Exception(\"Size of filter doesn't match size of column.\", ErrorCodes::SIZES_OF_COLUMNS_DOESNT_MATCH);",
          "content_same": false
        },
        {
          "line": 159,
          "old_api": "data",
          "new_api": "reserve",
          "old_text": "filt.data()",
          "new_text": "res_data.reserve(result_size_hint > 0 ? result_size_hint : size)",
          "old_line_content": "    const UInt8 * filt_pos = filt.data();",
          "new_line_content": "        res_data.reserve(result_size_hint > 0 ? result_size_hint : size);",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": "Exception",
          "new_api": "size",
          "old_text": "Exception(\"Size of offsets doesn't match size of column.\", ErrorCodes::SIZES_OF_COLUMNS_DOESNT_MATCH)",
          "new_text": "data.size()",
          "old_line_content": "        throw Exception(\"Size of offsets doesn't match size of column.\", ErrorCodes::SIZES_OF_COLUMNS_DOESNT_MATCH);",
          "new_line_content": "    size_t size = data.size();",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "create",
          "new_api": "Exception",
          "old_text": "this->create(0, scale)",
          "new_text": "Exception(\"Size of offsets doesn't match size of column.\", ErrorCodes::SIZES_OF_COLUMNS_DOESNT_MATCH)",
          "old_line_content": "    auto res = this->create(0, scale);",
          "new_line_content": "        throw Exception(\"Size of offsets doesn't match size of column.\", ErrorCodes::SIZES_OF_COLUMNS_DOESNT_MATCH);",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": "NearestFieldType<T>(0, scale)",
          "new_api": "size",
          "old_text": "NearestFieldType<T>(0, scale)",
          "new_text": "data.size()",
          "old_line_content": "        min = NearestFieldType<T>(0, scale);",
          "new_line_content": "    if (data.size() == 0)",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 129,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(&tmp, src, sizeof(T))",
          "old_line_content": "}",
          "new_line_content": "    memcpy(&tmp, src, sizeof(T));",
          "content_same": false
        },
        {
          "line": 130,
          "old_api": null,
          "new_api": "emplace_back",
          "old_text": null,
          "new_text": "data.emplace_back(tmp)",
          "old_line_content": "",
          "new_line_content": "    data.emplace_back(tmp);",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": null,
          "new_api": "toString",
          "old_text": null,
          "new_text": "toString(length)",
          "old_line_content": "            ErrorCodes::PARAMETER_OUT_OF_BOUND);",
          "new_line_content": "        throw Exception(\"Parameters start = \" + toString(start) + \", length = \" + toString(length) +",
          "content_same": false
        },
        {
          "line": 140,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "src_vec.data.size()",
          "old_line_content": "",
          "new_line_content": "            \" are out of bound in ColumnDecimal<T>::insertRangeFrom method (data.size() = \" + toString(src_vec.data.size()) + \").\",",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": null,
          "new_api": "resize",
          "old_text": null,
          "new_text": "data.resize(old_size + length)",
          "old_line_content": "}",
          "new_line_content": "    data.resize(old_size + length);",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": null,
          "new_api": "data",
          "old_text": null,
          "new_text": "data.data()",
          "old_line_content": "",
          "new_line_content": "    memcpy(data.data() + old_size, &src_vec.data[start], length * sizeof(data[0]));",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "filt.size()",
          "old_line_content": "",
          "new_line_content": "    if (size != filt.size())",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": null,
          "new_api": "create",
          "old_text": null,
          "new_text": "this->create(0, scale)",
          "old_line_content": "",
          "new_line_content": "    auto res = this->create(0, scale);",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": null,
          "new_api": "getData",
          "old_text": null,
          "new_text": "res->getData()",
          "old_line_content": "    if (result_size_hint)",
          "new_line_content": "    Container & res_data = res->getData();",
          "content_same": false
        },
        {
          "line": 35,
          "old_api": null,
          "new_api": "decimalLess<T>(a, b, scale, other.scale)",
          "old_text": null,
          "new_text": "decimalLess<T>(a, b, scale, other.scale)",
          "old_line_content": "",
          "new_line_content": "    return decimalLess<T>(b, a, other.scale, scale) ? 1 : (decimalLess<T>(a, b, scale, other.scale) ? -1 : 0);",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": null,
          "new_api": "data",
          "old_text": null,
          "new_text": "data.data()",
          "old_line_content": "    while (filt_pos < filt_end)",
          "new_line_content": "    const T * data_pos = data.data();",
          "content_same": false
        },
        {
          "line": 168,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "res_data.push_back(*data_pos)",
          "old_line_content": "        ++filt_pos;",
          "new_line_content": "            res_data.push_back(*data_pos);",
          "content_same": false
        },
        {
          "line": 42,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(pos, &data[n], sizeof(T))",
          "old_line_content": "}",
          "new_line_content": "    memcpy(pos, &data[n], sizeof(T));",
          "content_same": false
        },
        {
          "line": 43,
          "old_api": null,
          "new_api": "StringRef",
          "old_text": null,
          "new_text": "StringRef(pos, sizeof(T))",
          "old_line_content": "",
          "new_line_content": "    return StringRef(pos, sizeof(T));",
          "content_same": false
        },
        {
          "line": 49,
          "old_api": null,
          "new_api": "unalignedLoad<T>(pos)",
          "old_text": null,
          "new_text": "unalignedLoad<T>(pos)",
          "old_line_content": "}",
          "new_line_content": "    data.push_back(unalignedLoad<T>(pos));",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": null,
          "new_api": "selectIndexImpl",
          "old_text": null,
          "new_text": "selectIndexImpl(*this, indexes, limit)",
          "old_line_content": "",
          "new_line_content": "    return selectIndexImpl(*this, indexes, limit);",
          "content_same": false
        },
        {
          "line": 57,
          "old_api": null,
          "new_api": "getFamilyName",
          "old_text": null,
          "new_text": "getFamilyName()",
          "old_line_content": "}",
          "new_line_content": "        throw Exception(String(\"Method get64 is not supported for \") + getFamilyName(), ErrorCodes::NOT_IMPLEMENTED);",
          "content_same": false
        },
        {
          "line": 58,
          "old_api": null,
          "new_api": "static_cast<typename T::NativeType>(data[n])",
          "old_text": null,
          "new_text": "static_cast<typename T::NativeType>(data[n])",
          "old_line_content": "",
          "new_line_content": "    return static_cast<typename T::NativeType>(data[n]);",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "offsets.size()",
          "old_line_content": "",
          "new_line_content": "    if (size != offsets.size())",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": null,
          "new_api": "create",
          "old_text": null,
          "new_text": "this->create(0, scale)",
          "old_line_content": "        return res;",
          "new_line_content": "    auto res = this->create(0, scale);",
          "content_same": false
        },
        {
          "line": 64,
          "old_api": null,
          "new_api": "update",
          "old_text": null,
          "new_text": "hash.update(data[n])",
          "old_line_content": "",
          "new_line_content": "    hash.update(data[n]);",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": null,
          "new_api": "getData",
          "old_text": null,
          "new_text": "res->getData()",
          "old_line_content": "",
          "new_line_content": "    typename Self::Container & res_data = res->getData();",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": null,
          "new_api": "back",
          "old_text": null,
          "new_text": "offsets.back()",
          "old_line_content": "    IColumn::Offset prev_offset = 0;",
          "new_line_content": "    res_data.reserve(offsets.back());",
          "content_same": false
        },
        {
          "line": 71,
          "old_api": null,
          "new_api": "std::numeric_limits<UInt32>::max()",
          "old_text": null,
          "new_text": "std::numeric_limits<UInt32>::max()",
          "old_line_content": "        PaddedPODArray<UInt32> tmp_res;",
          "new_line_content": "    if (data.size() <= std::numeric_limits<UInt32>::max())",
          "content_same": false
        },
        {
          "line": 76,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "tmp_res.size()",
          "old_line_content": "            res[i] = tmp_res[i];",
          "new_line_content": "        res.resize(tmp_res.size());",
          "content_same": false
        },
        {
          "line": 77,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "tmp_res.size()",
          "old_line_content": "        return;",
          "new_line_content": "        for (size_t i = 0; i < tmp_res.size(); ++i)",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "res_data.push_back(data[i])",
          "old_line_content": "",
          "new_line_content": "            res_data.push_back(data[i]);",
          "content_same": false
        },
        {
          "line": 83,
          "old_api": null,
          "new_api": "permutation",
          "old_text": null,
          "new_text": "permutation(reverse, limit, res)",
          "old_line_content": "",
          "new_line_content": "    permutation(reverse, limit, res);",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": null,
          "new_api": "gather",
          "old_text": null,
          "new_text": "gatherer.gather(*this)",
          "old_line_content": "",
          "new_line_content": "    gatherer.gather(*this);",
          "content_same": false
        },
        {
          "line": 90,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "perm.size()",
          "old_line_content": "",
          "new_line_content": "    if (perm.size() < size)",
          "content_same": false
        },
        {
          "line": 93,
          "old_api": null,
          "new_api": "create",
          "old_text": null,
          "new_text": "this->create(size, scale)",
          "old_line_content": "",
          "new_line_content": "    auto res = this->create(size, scale);",
          "content_same": false
        },
        {
          "line": 94,
          "old_api": null,
          "new_api": "getData",
          "old_text": null,
          "new_text": "res->getData()",
          "old_line_content": "    for (size_t i = 0; i < size; ++i)",
          "new_line_content": "    typename Self::Container & res_data = res->getData();",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": null,
          "new_api": "NearestFieldType<T>(0, scale)",
          "old_text": null,
          "new_text": "NearestFieldType<T>(0, scale)",
          "old_line_content": "        return;",
          "new_line_content": "        min = NearestFieldType<T>(0, scale);",
          "content_same": false
        },
        {
          "line": 222,
          "old_api": null,
          "new_api": "NearestFieldType<T>(0, scale)",
          "old_text": null,
          "new_text": "NearestFieldType<T>(0, scale)",
          "old_line_content": "    }",
          "new_line_content": "        max = NearestFieldType<T>(0, scale);",
          "content_same": false
        },
        {
          "line": 105,
          "old_api": null,
          "new_api": "create",
          "old_text": null,
          "new_text": "this->create(0, scale)",
          "old_line_content": "    if (size > 0)",
          "new_line_content": "    auto res = this->create(0, scale);",
          "content_same": false
        },
        {
          "line": 109,
          "old_api": null,
          "new_api": "static_cast<Self &>(*res)",
          "old_text": null,
          "new_text": "static_cast<Self &>(*res)",
          "old_line_content": "",
          "new_line_content": "        auto & new_col = static_cast<Self &>(*res);",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": null,
          "new_api": "NearestFieldType<T>(cur_min, scale)",
          "old_text": null,
          "new_text": "NearestFieldType<T>(cur_min, scale)",
          "old_line_content": "}",
          "new_line_content": "    min = NearestFieldType<T>(cur_min, scale);",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": null,
          "new_api": "NearestFieldType<T>(cur_max, scale)",
          "old_text": null,
          "new_text": "NearestFieldType<T>(cur_max, scale)",
          "old_line_content": "",
          "new_line_content": "    max = NearestFieldType<T>(cur_max, scale);",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "this->size()",
          "old_line_content": "",
          "new_line_content": "        size_t count = std::min(this->size(), size);",
          "content_same": false
        },
        {
          "line": 113,
          "old_api": null,
          "new_api": "data",
          "old_text": null,
          "new_text": "data.data()",
          "old_line_content": "        if (size > count)",
          "new_line_content": "        memcpy(new_col.data.data(), data.data(), count * sizeof(data[0]));",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(tail, 0, (size - count) * sizeof(T))",
          "old_line_content": "    }",
          "new_line_content": "            memset(tail, 0, (size - count) * sizeof(T));",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 128,
          "old_api": "emplace_back",
          "new_api": null,
          "old_text": "data.emplace_back(tmp)",
          "new_text": null,
          "old_line_content": "    data.emplace_back(tmp);",
          "new_line_content": "    T tmp;",
          "content_same": false
        },
        {
          "line": 134,
          "old_api": "static_cast<const ColumnDecimal &>(src)",
          "new_api": null,
          "old_text": "static_cast<const ColumnDecimal &>(src)",
          "new_text": null,
          "old_line_content": "    const ColumnDecimal & src_vec = static_cast<const ColumnDecimal &>(src);",
          "new_line_content": "void ColumnDecimal<T>::insertRangeFrom(const IColumn & src, size_t start, size_t length)",
          "content_same": false
        },
        {
          "line": 137,
          "old_api": "toString",
          "new_api": null,
          "old_text": "toString(length)",
          "new_text": null,
          "old_line_content": "        throw Exception(\"Parameters start = \" + toString(start) + \", length = \" + toString(length) +",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 141,
          "old_api": "size",
          "new_api": null,
          "old_text": "data.size()",
          "new_text": null,
          "old_line_content": "    size_t old_size = data.size();",
          "new_line_content": "            ErrorCodes::PARAMETER_OUT_OF_BOUND);",
          "content_same": false
        },
        {
          "line": 142,
          "old_api": "resize",
          "new_api": null,
          "old_text": "data.resize(old_size + length)",
          "new_text": null,
          "old_line_content": "    data.resize(old_size + length);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": "size",
          "new_api": null,
          "old_text": "data.size()",
          "new_text": null,
          "old_line_content": "    size_t size = data.size();",
          "new_line_content": "ColumnPtr ColumnDecimal<T>::filter(const IColumn::Filter & filt, ssize_t result_size_hint) const",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": "size",
          "new_api": null,
          "old_text": "filt.size()",
          "new_text": null,
          "old_line_content": "    if (size != filt.size())",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 154,
          "old_api": "getData",
          "new_api": null,
          "old_text": "res->getData()",
          "new_text": null,
          "old_line_content": "    Container & res_data = res->getData();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 157,
          "old_api": "reserve",
          "new_api": null,
          "old_text": "res_data.reserve(result_size_hint > 0 ? result_size_hint : size)",
          "new_text": null,
          "old_line_content": "        res_data.reserve(result_size_hint > 0 ? result_size_hint : size);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 33,
          "old_api": "decimalLess<T>(a, b, scale, other.scale)",
          "new_api": null,
          "old_text": "decimalLess<T>(a, b, scale, other.scale)",
          "new_text": null,
          "old_line_content": "    return decimalLess<T>(b, a, other.scale, scale) ? 1 : (decimalLess<T>(a, b, scale, other.scale) ? -1 : 0);",
          "new_line_content": "    if (scale == other.scale)",
          "content_same": false
        },
        {
          "line": 166,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "res_data.push_back(*data_pos)",
          "new_text": null,
          "old_line_content": "            res_data.push_back(*data_pos);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 39,
          "old_api": "allocContinue",
          "new_api": null,
          "old_text": "arena.allocContinue(sizeof(T), begin)",
          "new_text": null,
          "old_line_content": "    auto pos = arena.allocContinue(sizeof(T), begin);",
          "new_line_content": "StringRef ColumnDecimal<T>::serializeValueIntoArena(size_t n, Arena & arena, char const *& begin) const",
          "content_same": false
        },
        {
          "line": 40,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(pos, &data[n], sizeof(T))",
          "new_text": null,
          "old_line_content": "    memcpy(pos, &data[n], sizeof(T));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 47,
          "old_api": "unalignedLoad<T>(pos)",
          "new_api": null,
          "old_text": "unalignedLoad<T>(pos)",
          "new_text": null,
          "old_line_content": "    data.push_back(unalignedLoad<T>(pos));",
          "new_line_content": "const char * ColumnDecimal<T>::deserializeAndInsertFromArena(const char * pos)",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": "selectIndexImpl",
          "new_api": null,
          "old_text": "selectIndexImpl(*this, indexes, limit)",
          "new_text": null,
          "old_line_content": "    return selectIndexImpl(*this, indexes, limit);",
          "new_line_content": "ColumnPtr ColumnDecimal<T>::index(const IColumn & indexes, size_t limit) const",
          "content_same": false
        },
        {
          "line": 55,
          "old_api": "getFamilyName",
          "new_api": null,
          "old_text": "getFamilyName()",
          "new_text": null,
          "old_line_content": "        throw Exception(String(\"Method get64 is not supported for \") + getFamilyName(), ErrorCodes::NOT_IMPLEMENTED);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 56,
          "old_api": "static_cast<typename T::NativeType>(data[n])",
          "new_api": null,
          "old_text": "static_cast<typename T::NativeType>(data[n])",
          "new_text": null,
          "old_line_content": "    return static_cast<typename T::NativeType>(data[n]);",
          "new_line_content": "    if constexpr (sizeof(T) > sizeof(UInt64))",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": "size",
          "new_api": null,
          "old_text": "offsets.size()",
          "new_text": null,
          "old_line_content": "    if (size != offsets.size())",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 184,
          "old_api": "size",
          "new_api": null,
          "old_text": "data.size()",
          "new_text": null,
          "old_line_content": "    size_t size = data.size();",
          "new_line_content": "ColumnPtr ColumnDecimal<T>::replicate(const IColumn::Offsets & offsets) const",
          "content_same": false
        },
        {
          "line": 62,
          "old_api": "update",
          "new_api": null,
          "old_text": "hash.update(data[n])",
          "new_text": null,
          "old_line_content": "    hash.update(data[n]);",
          "new_line_content": "void ColumnDecimal<T>::updateHashWithValue(size_t n, SipHash & hash) const",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": "getData",
          "new_api": null,
          "old_text": "res->getData()",
          "new_text": null,
          "old_line_content": "    typename Self::Container & res_data = res->getData();",
          "new_line_content": "        return res;",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": "back",
          "new_api": null,
          "old_text": "offsets.back()",
          "new_text": null,
          "old_line_content": "    res_data.reserve(offsets.back());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 69,
          "old_api": "std::numeric_limits<UInt32>::max()",
          "new_api": null,
          "old_text": "std::numeric_limits<UInt32>::max()",
          "new_text": null,
          "old_line_content": "    if (data.size() <= std::numeric_limits<UInt32>::max())",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 72,
          "old_api": "permutation",
          "new_api": null,
          "old_text": "permutation(reverse, limit, tmp_res)",
          "new_text": null,
          "old_line_content": "        permutation(reverse, limit, tmp_res);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "res_data.push_back(data[i])",
          "new_text": null,
          "old_line_content": "            res_data.push_back(data[i]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 75,
          "old_api": "size",
          "new_api": null,
          "old_text": "tmp_res.size()",
          "new_text": null,
          "old_line_content": "        for (size_t i = 0; i < tmp_res.size(); ++i)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 81,
          "old_api": "permutation",
          "new_api": null,
          "old_text": "permutation(reverse, limit, res)",
          "new_text": null,
          "old_line_content": "    permutation(reverse, limit, res);",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "gather",
          "new_api": null,
          "old_text": "gatherer.gather(*this)",
          "new_text": null,
          "old_line_content": "    gatherer.gather(*this);",
          "new_line_content": "void ColumnDecimal<T>::gather(ColumnGathererStream & gatherer)",
          "content_same": false
        },
        {
          "line": 87,
          "old_api": "size",
          "new_api": null,
          "old_text": "data.size()",
          "new_text": null,
          "old_line_content": "    size_t size = limit ? std::min(data.size(), limit) : data.size();",
          "new_line_content": "ColumnPtr ColumnDecimal<T>::permute(const IColumn::Permutation & perm, size_t limit) const",
          "content_same": false
        },
        {
          "line": 88,
          "old_api": "size",
          "new_api": null,
          "old_text": "perm.size()",
          "new_text": null,
          "old_line_content": "    if (perm.size() < size)",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": "size",
          "new_api": null,
          "old_text": "data.size()",
          "new_text": null,
          "old_line_content": "    if (data.size() == 0)",
          "new_line_content": "void ColumnDecimal<T>::getExtremes(Field & min, Field & max) const",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": "getData",
          "new_api": null,
          "old_text": "res->getData()",
          "new_text": null,
          "old_line_content": "    typename Self::Container & res_data = res->getData();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": "NearestFieldType<T>(0, scale)",
          "new_api": null,
          "old_text": "NearestFieldType<T>(0, scale)",
          "new_text": null,
          "old_line_content": "        max = NearestFieldType<T>(0, scale);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 103,
          "old_api": "create",
          "new_api": null,
          "old_text": "this->create(0, scale)",
          "new_text": null,
          "old_line_content": "    auto res = this->create(0, scale);",
          "new_line_content": "MutableColumnPtr ColumnDecimal<T>::cloneResized(size_t size) const",
          "content_same": false
        },
        {
          "line": 107,
          "old_api": "static_cast<Self &>(*res)",
          "new_api": null,
          "old_text": "static_cast<Self &>(*res)",
          "new_text": null,
          "old_line_content": "        auto & new_col = static_cast<Self &>(*res);",
          "new_line_content": "    if (size > 0)",
          "content_same": false
        },
        {
          "line": 108,
          "old_api": "resize",
          "new_api": null,
          "old_text": "new_col.data.resize(size)",
          "new_text": null,
          "old_line_content": "        new_col.data.resize(size);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": "NearestFieldType<T>(cur_min, scale)",
          "new_api": null,
          "old_text": "NearestFieldType<T>(cur_min, scale)",
          "new_text": null,
          "old_line_content": "    min = NearestFieldType<T>(cur_min, scale);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": "NearestFieldType<T>(cur_max, scale)",
          "new_api": null,
          "old_text": "NearestFieldType<T>(cur_max, scale)",
          "new_text": null,
          "old_line_content": "    max = NearestFieldType<T>(cur_max, scale);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 111,
          "old_api": "data",
          "new_api": null,
          "old_text": "data.data()",
          "new_text": null,
          "old_line_content": "        memcpy(new_col.data.data(), data.data(), count * sizeof(data[0]));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 116,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(tail, 0, (size - count) * sizeof(T))",
          "new_text": null,
          "old_line_content": "            memset(tail, 0, (size - count) * sizeof(T));",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 127,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(&tmp, src, sizeof(T))",
          "new_text": null,
          "old_line_content": "    memcpy(&tmp, src, sizeof(T));",
          "new_line_content": "{",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 13,
      "total_additions": 41,
      "total_deletions": 41,
      "total_api_changes": 95
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 95,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          34
        ]
      }
    },
    "api_calls_before": 73,
    "api_calls_after": 73,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 0,
      "total_diff_lines": 14
    }
  }
}