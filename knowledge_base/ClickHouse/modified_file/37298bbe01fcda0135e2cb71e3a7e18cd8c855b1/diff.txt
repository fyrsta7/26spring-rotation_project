diff --git a/dbms/src/Common/VirtualColumnUtils.cpp b/dbms/src/Common/VirtualColumnUtils.cpp
index 1f09475a46e..1d5bf3998ee 100644
--- a/dbms/src/Common/VirtualColumnUtils.cpp
+++ b/dbms/src/Common/VirtualColumnUtils.cpp
@@ -108,18 +108,15 @@ static bool isValidFunction(ASTPtr expression, const NameSet & columns)
 /// Извлечь все подфункции главной конъюнкции, но зависящие только от заданных столбцов
 static void extractFunctions(ASTPtr expression, const NameSet & columns, std::vector<ASTPtr> & result)
 {
-	if (const ASTFunction * function = typeid_cast<const ASTFunction *>(&* expression))
+	const ASTFunction * function = typeid_cast<const ASTFunction *>(&* expression);
+	if (function && function->name == "and")
 	{
-		if (function->name == "and")
-		{
-			for (size_t i = 0; i < function->arguments->children.size(); ++i)
-				extractFunctions(function->arguments->children[i], columns, result);
-		}
-		else
-		{
-			if (isValidFunction(expression, columns))
-				result.push_back(expression->clone());
-		}
+		for (size_t i = 0; i < function->arguments->children.size(); ++i)
+			extractFunctions(function->arguments->children[i], columns, result);
+	}
+	else if (isValidFunction(expression, columns))
+	{
+		result.push_back(expression->clone());
 	}
 }
 
