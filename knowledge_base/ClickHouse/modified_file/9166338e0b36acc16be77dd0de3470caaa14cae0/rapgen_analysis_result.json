{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/9166338e0b36acc16be77dd0de3470caaa14cae0",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/9166338e0b36acc16be77dd0de3470caaa14cae0/before.h",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/9166338e0b36acc16be77dd0de3470caaa14cae0/after.h",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/9166338e0b36acc16be77dd0de3470caaa14cae0/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 215,
          "old_api": "BackQuot",
          "new_api": "(*pos >=",
          "old_text": "BackQuot",
          "new_text": " (*pos >=",
          "old_line_content": "\t\tconst char * pos = s.data() + 1;",
          "new_line_content": "\tif (s.empty() || !((s[0] >= 'a' && s[0] <= 'z') || (s[0] >= 'A' && s[0] <= 'Z') || s[0] == '_'))",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": "g",
          "new_api": "(pos != end)\n\t\t\twriteBackQuot",
          "old_text": "g(s, buf",
          "new_text": "(pos != end)\n\t\t\twriteBackQuot",
          "old_line_content": "\t\tconst char * end = s.data() + s.size();",
          "new_line_content": "\t\twriteBackQuotedString(s, buf);",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": "lues.day_of_month / 10;\n\ts[9] += values.day_of_month",
          "new_api": "+= values.month",
          "old_text": "lues.day_of_month / 10;\n\ts[9] += values.day_of_month",
          "new_text": " += values.month",
          "old_line_content": "\tconst Yandex::DateLUT::Values & values = Yandex::DateLUTSingleton::instance().getValues(date);",
          "new_line_content": "\t\tbuf.write(s, 10);",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": "er & buf)\n{",
          "new_api": "асно текуще",
          "old_text": "er & buf)\n{\n",
          "new_text": "асно текуще",
          "old_line_content": "\ts[5] += date.month() / 10;",
          "new_line_content": "\ts[0] += date.year() / 1000;",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": "0', '0', '0'",
          "new_api": "nline void",
          "old_text": "0', '0', '0'",
          "new_text": "nline void ",
          "old_line_content": "\ts[6] += date.month() % 10;",
          "new_line_content": "\ts[1] += (date.year() / 100) % 10;",
          "content_same": false
        },
        {
          "line": 263,
          "old_api": "'0', '-',",
          "new_api": "datetime,",
          "old_text": " '0', '-',",
          "new_text": " datetime, ",
          "old_line_content": "\ts[8] += date.day() / 10;",
          "new_line_content": "\ts[2] += (date.year() / 10) % 10;",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": "'0', '0',",
          "new_api": "char s[19]",
          "old_text": "'0', '0', ",
          "new_text": "char s[19] ",
          "old_line_content": "\ts[9] += date.day() % 10;",
          "new_line_content": "\ts[3] += date.year() % 10;",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": "'0', ':', '0',",
          "new_api": "0', '0', ' '",
          "old_text": " '0', ':', '0', ",
          "new_text": "0', '0', ' '",
          "old_line_content": "\tbuf.write(s, 10);",
          "new_line_content": "\ts[6] += date.month() % 10;",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": "h % 10;\n\ts[8] += values.day_of_month",
          "new_api": "onth / 10;\n\ts[6]",
          "old_text": "h % 10;\n\ts[8] += values.day_of_month",
          "new_text": "onth / 10;\n\ts[6]",
          "old_line_content": "\tYandex::DateLUTSingleton & date_lut = Yandex::DateLUTSingleton::instance();",
          "new_line_content": "\t\tbuf.write(s, 19);",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": "[18] += datetime",
          "new_api": "14] += datetime",
          "old_text": "[18] += datetime",
          "new_text": "14] += datetime",
          "old_line_content": "\ts[5] += datetime.month() / 10;",
          "new_line_content": "\ts[0] += datetime.year() / 1000;",
          "content_same": false
        },
        {
          "line": 316,
          "old_api": "write",
          "new_api": "15] += datetime",
          "old_text": "\n\tbuf.write(s, 1",
          "new_text": "15] += datetime",
          "old_line_content": "\ts[6] += datetime.month() % 10;",
          "new_line_content": "\ts[1] += (datetime.year() / 100) % 10;",
          "content_same": false
        },
        {
          "line": 317,
          "old_api": "сти mysqlxx::R",
          "new_api": "= datetime.seco",
          "old_text": "сти mysqlxx::R",
          "new_text": "= datetime.seco",
          "old_line_content": "\ts[8] += datetime.day() / 10;",
          "new_line_content": "\ts[2] += (datetime.year() / 10) % 10;",
          "content_same": false
        },
        {
          "line": 318,
          "old_api": "ed виде\ninline",
          "new_api": "second",
          "old_text": "ed виде\ninline",
          "new_text": "atetime.second(",
          "old_line_content": "\ts[9] += datetime.day() % 10;",
          "new_line_content": "\ts[3] += datetime.year() % 10;",
          "content_same": false
        },
        {
          "line": 320,
          "old_api": "Row",
          "new_api": "lxx::Row в tab-s",
          "old_text": "Row(const mysql",
          "new_text": "lxx::Row в tab-s",
          "old_line_content": "\ts[11] += datetime.hour() / 10;",
          "new_line_content": "\ts[6] += datetime.month() % 10;",
          "content_same": false
        },
        {
          "line": 321,
          "old_api": "iteBuffer & buf",
          "new_api": "line void writ",
          "old_text": "iteBuffer & buf",
          "new_text": "line void writ",
          "old_line_content": "\ts[12] += datetime.hour() % 10;",
          "new_line_content": "\ts[8] += datetime.day() / 10;",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": "i = 0; i < row.si",
          "new_api": "t mysqlxx::Row",
          "old_text": "i = 0; i < row.si",
          "new_text": "t mysqlxx::Row",
          "old_line_content": "\ts[14] += datetime.minute() / 10;",
          "new_line_content": "\ts[9] += datetime.day() % 10;",
          "content_same": false
        },
        {
          "line": 324,
          "old_api": "if (unlikely(row[",
          "new_api": "r & buf)\n{\n\tfor",
          "old_text": "if (unlikely(row[",
          "new_text": "r & buf)\n{\n\tfor",
          "old_line_content": "\ts[17] += datetime.second() / 10;",
          "new_line_content": "\ts[11] += datetime.hour() / 10;",
          "content_same": false
        },
        {
          "line": 325,
          "old_api": "write",
          "new_api": "size",
          "old_text": "\n\t\t\tbuf.write(\"\\\\",
          "new_text": " < row.size(); ",
          "old_line_content": "\ts[18] += datetime.second() % 10;",
          "new_line_content": "\ts[12] += datetime.hour() % 10;",
          "content_same": false
        },
        {
          "line": 327,
          "old_api": "continue;\n\t\t}",
          "new_api": "likely",
          "old_text": "\t\tcontinue;\n\t\t}\n",
          "new_text": "likely(row[i].isN",
          "old_line_content": "\tbuf.write(s, 19);",
          "new_line_content": "\ts[15] += datetime.minute() % 10;",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": "tion",
          "new_api": "ct-ов\n\tthrow Ex",
          "old_text": "tion(\"Method writeT",
          "new_text": "ct-ов\n\tthrow Ex",
          "old_line_content": "\t\t\tbuf.write(\"\\\\N\", 2);",
          "new_line_content": "\t\t\tbuf.write('\\t');",
          "content_same": false
        },
        {
          "line": 345,
          "old_api": "<> inline void",
          "new_api": "d for this type.\",",
          "old_text": " <> inline void",
          "new_text": "d for this type.\", ",
          "old_line_content": "\t\twriteAnyEscapedString<'\\''>(row[i].data(), row[i].data() + row[i].length(), buf);",
          "new_line_content": "\t\t\tbuf.write(\"\\\\N\", 2);",
          "content_same": false
        },
        {
          "line": 358,
          "old_api": "inline void writeTe",
          "new_api": "riteIntText",
          "old_text": " inline void writeTe",
          "new_text": "riteIntText(x, buf); }\ntemplate <> inline void writeText<UInt64>\t(const UInt64 & x, \tWriteBu",
          "old_line_content": "template <> inline void writeText<UInt16>\t(const UInt16 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "new_line_content": "\tthrow Exception(\"Method writeText is not implemented for this type.\", ErrorCodes::NOT_IMPLEMENTED);",
          "content_same": false
        },
        {
          "line": 361,
          "old_api": "line void writeText<",
          "new_api": "Int8 & x, \tWriteBuff",
          "old_text": "line void writeText<",
          "new_text": "Int8 & x, \tWriteBuff",
          "old_line_content": "template <> inline void writeText<Int8>\t\t(const Int8 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "new_line_content": "template <> inline void writeText<UInt8>\t(const UInt8 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "content_same": false
        },
        {
          "line": 362,
          "old_api": "<> inline void write",
          "new_api": "16 & x, \tWriteBuffer",
          "old_text": "<> inline void write",
          "new_text": "16 & x, \tWriteBuffer",
          "old_line_content": "template <> inline void writeText<Int16>\t(const Int16 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "new_line_content": "template <> inline void writeText<UInt16>\t(const UInt16 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "content_same": false
        },
        {
          "line": 363,
          "old_api": "late <> inline void",
          "new_api": "& x, \tWriteBuffer &",
          "old_text": "late <> inline void ",
          "new_text": " & x, \tWriteBuffer &",
          "old_line_content": "template <> inline void writeText<Int32>\t(const Int32 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "new_line_content": "template <> inline void writeText<UInt32>\t(const UInt32 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "content_same": false
        },
        {
          "line": 364,
          "old_api": "}\ntemplate <> inlin",
          "new_api": "x, \tWriteBuffer & b",
          "old_text": " }\ntemplate <> inlin",
          "new_text": " x, \tWriteBuffer & b",
          "old_line_content": "template <> inline void writeText<Int64>\t(const Int64 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "new_line_content": "template <> inline void writeText<UInt64>\t(const UInt64 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "content_same": false
        },
        {
          "line": 365,
          "old_api": "template <> inline vo",
          "new_api": "t32 & x, WriteBuffer",
          "old_text": "\ntemplate <> inline vo",
          "new_text": "t32 & x, WriteBuffer",
          "old_line_content": "template <> inline void writeText<Float32>\t(const Float32 & x, WriteBuffer & buf) { writeFloatText(x, buf); }",
          "new_line_content": "template <> inline void writeText<Int8>\t\t(const Int8 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "content_same": false
        },
        {
          "line": 366,
          "old_api": "xt",
          "new_api": "Float64 & x, WriteB",
          "old_text": "xt(x, buf); }\ntemplate",
          "new_text": " Float64 & x, WriteB",
          "old_line_content": "template <> inline void writeText<Float64>\t(const Float64 & x, WriteBuffer & buf) { writeFloatText(x, buf); }",
          "new_line_content": "template <> inline void writeText<Int16>\t(const Int16 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "content_same": false
        },
        {
          "line": 367,
          "old_api": "& buf) { writeDateTimeTex",
          "new_api": "onst String & x,\tWri",
          "old_text": " & buf) { writeDateTimeTex",
          "new_text": "onst String & x,\tWri",
          "old_line_content": "template <> inline void writeText<String>\t(const String & x,\tWriteBuffer & buf) { writeEscapedString(x, buf); }",
          "new_line_content": "template <> inline void writeText<Int32>\t(const Int32 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "content_same": false
        },
        {
          "line": 368,
          "old_api": "",
          "new_api": "l>\t\t(const bool & x,",
          "old_text": "",
          "new_text": "l>\t\t(const bool & x,",
          "old_line_content": "template <> inline void writeText<bool>\t\t(const bool & x, \tWriteBuffer & buf) { writeBoolText(x, buf); }",
          "new_line_content": "template <> inline void writeText<Int64>\t(const Int64 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": "",
          "new_api": "iteText<mysqlxx::DateT",
          "old_text": "",
          "new_text": "iteText<mysqlxx::DateT",
          "old_line_content": "template <> inline void writeText<mysqlxx::Date>\t\t(const mysqlxx::Date & x,\t\tWriteBuffer & buf) { writeDateText(x, buf); }",
          "new_line_content": "template <> inline void writeText<Float64>\t(const Float64 & x, WriteBuffer & buf) { writeFloatText(x, buf); }",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": "",
          "new_api": "}",
          "old_text": "",
          "new_text": "\n}\n",
          "old_line_content": "template <> inline void writeText<mysqlxx::DateTime>\t(const mysqlxx::DateTime & x,\tWriteBuffer & buf) { writeDateTimeText(x, buf); }",
          "new_line_content": "template <> inline void writeText<String>\t(const String & x,\tWriteBuffer & buf) { writeEscapedString(x, buf); }",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 265,
          "old_api": null,
          "new_api": ", '0', '-',",
          "old_text": null,
          "new_text": ", '0', '-', ",
          "old_line_content": "",
          "new_line_content": "\ts[5] += date.month() / 10;",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": null,
          "new_api": "'0', '0',",
          "old_text": null,
          "new_text": " '0', '0',",
          "old_line_content": "}",
          "new_line_content": "\ts[8] += date.day() / 10;",
          "content_same": false
        },
        {
          "line": 268,
          "old_api": null,
          "new_api": "if (unl",
          "old_text": null,
          "new_text": "\n\n\tif (unl",
          "old_line_content": "",
          "new_line_content": "\ts[9] += date.day() % 10;",
          "content_same": false
        },
        {
          "line": 270,
          "old_api": null,
          "new_api": "etime > DATE_LUT",
          "old_text": null,
          "new_text": "etime > DATE_LUT",
          "old_line_content": "/// в формате YYYY-MM-DD HH:MM:SS, согласно текущему часовому поясу",
          "new_line_content": "\tbuf.write(s, 10);",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": null,
          "new_api": "/ 10) % 10;\n\ts[3] += values.year % 10;\n\ts[5] += v",
          "old_text": null,
          "new_text": " / 10) % 10;\n\ts[3] += values.year % 10;\n\ts[5] += v",
          "old_line_content": "\t}",
          "new_line_content": "\tif (unlikely(datetime > DATE_LUT_MAX || datetime == 0))",
          "content_same": false
        },
        {
          "line": 285,
          "old_api": null,
          "new_api": "0;\n\ts[9] += values.day_of_month % 10",
          "old_text": null,
          "new_text": "0;\n\ts[9] += values.day_of_month % 10",
          "old_line_content": "\ts[1] += (values.year / 100) % 10;",
          "new_line_content": "\tYandex::DateLUTSingleton & date_lut = Yandex::DateLUTSingleton::instance();",
          "content_same": false
        },
        {
          "line": 286,
          "old_api": null,
          "new_api": "atetime);\n\tUInt8 minute = da",
          "old_text": null,
          "new_text": "atetime);\n\tUInt8 minute = da",
          "old_line_content": "\ts[2] += (values.year / 10) % 10;",
          "new_line_content": "\tconst Yandex::DateLUT::Values & values = date_lut.getValues(datetime);",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": null,
          "new_api": "DateTime datetime, WriteBuffer & bu",
          "old_text": null,
          "new_text": "DateTime datetime, WriteBuffer & bu",
          "old_line_content": "\ts[11] += hour / 10;",
          "new_line_content": "\tUInt8 hour = date_lut.toHourInaccurate(datetime);",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": null,
          "new_api": "{'0', '0', '0', '0', '-',",
          "old_text": null,
          "new_text": " {'0', '0', '0', '0', '-', ",
          "old_line_content": "\ts[12] += hour % 10;",
          "new_line_content": "\tUInt8 minute = date_lut.toMinute(datetime);",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": null,
          "new_api": ", '0', ' ', '0', '0', ':',",
          "old_text": null,
          "new_text": ", '0', ' ', '0', '0', ':', ",
          "old_line_content": "\ts[14] += minute / 10;",
          "new_line_content": "\tUInt8 second = date_lut.toSecond(datetime);",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": null,
          "new_api": "QuotedSt",
          "old_text": null,
          "new_text": "QuotedSt",
          "old_line_content": "}",
          "new_line_content": "\tif (NULL == strpbrk(s.data(), \"\\b\\f\\n\\r\\t\\'\\\\\") && strlen(s.data()) == s.size())",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": null,
          "new_api": "(const String & s,",
          "old_text": null,
          "new_text": "(const String & s, ",
          "old_line_content": "",
          "new_line_content": "\t\twriteString(s, buf);",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": null,
          "new_api": "[3] += datetime.",
          "old_text": null,
          "new_text": "[3] += datetime.",
          "old_line_content": "{",
          "new_line_content": "\tbuf.write(s, 19);",
          "content_same": false
        },
        {
          "line": 182,
          "old_api": null,
          "new_api": "r & buf)\n{\n\twriteChar(c, buf);\n\twri",
          "old_text": null,
          "new_text": "r & buf)\n{\n\twriteChar(c, buf);\n\twri",
          "old_line_content": "template <char c>",
          "new_line_content": "\t\twriteAnyEscapedString<'\\''>(s, buf);",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": null,
          "new_api": "String & s, Writ",
          "old_text": null,
          "new_text": " String & s, Writ",
          "old_line_content": "",
          "new_line_content": "\twriteChar(c, buf);",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": null,
          "new_api": "ffer & buf)\n{\n\twriteAnyQuotedStr",
          "old_text": null,
          "new_text": "ffer & buf)\n{\n\twriteAnyQuotedStr",
          "old_line_content": "",
          "new_line_content": "\twriteAnyEscapedString<c>(s, buf);",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": null,
          "new_api": "<'\\''>(s, buf);\n}",
          "old_text": null,
          "new_text": "<'\\''>(s, buf);\n}",
          "old_line_content": "inline void writeQuotedString(const String & s, WriteBuffer & buf)",
          "new_line_content": "\twriteChar(c, buf);",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": null,
          "new_api": "ite",
          "old_text": null,
          "new_text": "ite(s, 19);\n}\n\n\n",
          "old_line_content": "",
          "new_line_content": "\ts[5] += datetime.month() / 10;",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": null,
          "new_api": "s, WriteBuffer & buf)\n{\n\twriteAnyQ",
          "old_text": null,
          "new_text": "s, WriteBuffer & buf)\n{\n\twriteAnyQ",
          "old_line_content": "inline void writeDoubleQuotedString(const String & s, WriteBuffer & buf)",
          "new_line_content": "\twriteAnyQuotedString<'\\''>(s, buf);",
          "content_same": false
        },
        {
          "line": 326,
          "old_api": null,
          "new_api": "= 0)\n\t\t\tbuf.write",
          "old_text": null,
          "new_text": "= 0)\n\t\t\tbuf.write",
          "old_line_content": "",
          "new_line_content": "\ts[14] += datetime.minute() / 10;",
          "content_same": false
        },
        {
          "line": 328,
          "old_api": null,
          "new_api": "write",
          "old_text": null,
          "new_text": "f.write(\"\\\\N\", 2)",
          "old_line_content": "}",
          "new_line_content": "\ts[17] += datetime.second() / 10;",
          "content_same": false
        },
        {
          "line": 329,
          "old_api": null,
          "new_api": "}\n\n\t\twriteAnyEsca",
          "old_text": null,
          "new_text": "}\n\n\t\twriteAnyEsca",
          "old_line_content": "",
          "new_line_content": "\ts[18] += datetime.second() % 10;",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": null,
          "new_api": "ckQuotedString",
          "old_text": null,
          "new_text": "ckQuotedString(const String & s, ",
          "old_line_content": "inline void writeBackQuotedString(const String & s, WriteBuffer & buf)",
          "new_line_content": "\twriteAnyQuotedString<'\"'>(s, buf);",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": null,
          "new_api": "<'\\''>(row[i].da",
          "old_text": null,
          "new_text": "<'\\''>(row[i].da",
          "old_line_content": "/// Вывести mysqlxx::Row в tab-separated виде",
          "new_line_content": "\tbuf.write(s, 19);",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": null,
          "new_api": "inline void writeProbablyBackQuot",
          "old_text": null,
          "new_text": "inline void writeProbablyBackQuot",
          "old_line_content": "inline void writeProbablyBackQuotedString(const String & s, WriteBuffer & buf)",
          "new_line_content": "\twriteAnyQuotedString<'`'>(s, buf);",
          "content_same": false
        },
        {
          "line": 338,
          "old_api": null,
          "new_api": "метод треб",
          "old_text": null,
          "new_text": "метод треб",
          "old_line_content": "",
          "new_line_content": "\tfor (size_t i = 0; i < row.size(); ++i)",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": null,
          "new_api": "iteText is not",
          "old_text": null,
          "new_text": "iteText is not ",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tif (unlikely(row[i].isNull()))",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": null,
          "new_api": "eString",
          "old_text": null,
          "new_text": "eString(",
          "old_line_content": "\t\t\t\tbreak;",
          "new_line_content": "\t\tconst char * pos = s.data() + 1;",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": null,
          "new_api": "DD\ninlin",
          "old_text": null,
          "new_text": "DD\ninlin",
          "old_line_content": "\t\tif (pos != end)",
          "new_line_content": "\t\tconst char * end = s.data() + s.size();",
          "content_same": false
        },
        {
          "line": 349,
          "old_api": null,
          "new_api": "UInt8 & x, \tWri",
          "old_text": null,
          "new_text": "UInt8 & x, \tWri",
          "old_line_content": "",
          "new_line_content": "\t\twriteAnyEscapedString<'\\''>(row[i].data(), row[i].data() + row[i].length(), buf);",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": null,
          "new_api": "write",
          "old_text": null,
          "new_text": "e == 0))\n\t{\n\t\tbuf.write(s, 10",
          "old_line_content": "}",
          "new_line_content": "\t\t\twriteBackQuotedString(s, buf);",
          "content_same": false
        },
        {
          "line": 227,
          "old_api": null,
          "new_api": "}\n\n\tconst Yandex:",
          "old_text": null,
          "new_text": "\n\t}\n\n\tconst Yandex:",
          "old_line_content": "",
          "new_line_content": "\t\t\twriteString(s, buf);",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": null,
          "new_api": "3] += values.year % 10;\n\ts[5] += values.month / 10",
          "old_text": null,
          "new_text": "3] += values.year % 10;\n\ts[5] += values.month / 10",
          "old_line_content": "\t}",
          "new_line_content": "\tif (unlikely(date > DATE_LUT_MAX_DAY_NUM || date == 0))",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": null,
          "new_api": "xx::Date>\t\t(const mysq",
          "old_text": null,
          "new_text": "xx::Date>\t\t(const mysq",
          "old_line_content": "",
          "new_line_content": "template <> inline void writeText<Float32>\t(const Float32 & x, WriteBuffer & buf) { writeFloatText(x, buf); }",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": null,
          "new_api": "write",
          "old_text": null,
          "new_text": "day_of_month % 10;\n\t\n\tbuf.write(s, 10);\n}\n\ninline vo",
          "old_line_content": "\ts[2] += (values.year / 10) % 10;",
          "new_line_content": "\tconst Yandex::DateLUT::Values & values = Yandex::DateLUTSingleton::instance().getValues(date);",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "",
          "new_line_content": "template <> inline void writeText<bool>\t\t(const bool & x, \tWriteBuffer & buf) { writeBoolText(x, buf); }",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "}",
          "new_line_content": "template <> inline void writeText<mysqlxx::Date>\t\t(const mysqlxx::Date & x,\t\tWriteBuffer & buf) { writeDateText(x, buf); }",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "",
          "new_line_content": "template <> inline void writeText<mysqlxx::DateTime>\t(const mysqlxx::DateTime & x,\tWriteBuffer & buf) { writeDateTimeText(x, buf); }",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": null,
          "new_api": "month",
          "old_text": null,
          "new_text": "= date.month() /",
          "old_line_content": "{",
          "new_line_content": "\tbuf.write(s, 10);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 257,
          "old_api": "/// в форм",
          "new_api": null,
          "old_text": "\n/// в форм",
          "new_text": null,
          "old_line_content": "\ts[0] += date.year() / 1000;",
          "new_line_content": "inline void writeDateText(mysqlxx::Date date, WriteBuffer & buf)",
          "content_same": false
        },
        {
          "line": 258,
          "old_api": "M:SS, согла",
          "new_api": null,
          "old_text": "M:SS, согла",
          "new_text": null,
          "old_line_content": "\ts[1] += (date.year() / 100) % 10;",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 259,
          "old_api": "ясу\ninline",
          "new_api": null,
          "old_text": "ясу\ninline ",
          "new_text": null,
          "old_line_content": "\ts[2] += (date.year() / 10) % 10;",
          "new_line_content": "\tchar s[10] = {'0', '0', '0', '0', '-', '0', '0', '-', '0', '0'};",
          "content_same": false
        },
        {
          "line": 260,
          "old_api": "(time_t dat",
          "new_api": null,
          "old_text": "(time_t dat",
          "new_text": null,
          "old_line_content": "\ts[3] += date.year() % 10;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 275,
          "old_api": ".year / 100) % 10;\n\ts[2] += (values.year / 10) % 1",
          "new_api": null,
          "old_text": ".year / 100) % 10;\n\ts[2] += (values.year / 10) % 1",
          "new_text": null,
          "old_line_content": "\tif (unlikely(datetime > DATE_LUT_MAX || datetime == 0))",
          "new_line_content": "inline void writeDateTimeText(time_t datetime, WriteBuffer & buf)",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": "] += values.year",
          "new_api": null,
          "old_text": "] += values.year",
          "new_text": null,
          "old_line_content": "\t\tbuf.write(s, 19);",
          "new_line_content": "\tchar s[19] = {'0', '0', '0', '0', '-', '0', '0', '-', '0', '0', ' ', '0', '0', ':', '0', '0', ':', '0', '0'};",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": "UInt8 hour = date_lut.toHour",
          "new_api": null,
          "old_text": "UInt8 hour = date_lut.toHour",
          "new_text": null,
          "old_line_content": "\tconst Yandex::DateLUT::Values & values = date_lut.getValues(datetime);",
          "new_line_content": "\t\treturn;",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": "inline void writeDateTimeText(mysq",
          "new_api": null,
          "old_text": "\ninline void writeDateTimeText(mysq",
          "new_text": null,
          "old_line_content": "\tUInt8 hour = date_lut.toHourInaccurate(datetime);",
          "new_line_content": "\ts[6] += values.month % 10;",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": "time, WriteBuffer & buf)\n{",
          "new_api": null,
          "old_text": "time, WriteBuffer & buf)\n{\n",
          "new_text": null,
          "old_line_content": "\tUInt8 minute = date_lut.toMinute(datetime);",
          "new_line_content": "\ts[8] += values.day_of_month / 10;",
          "content_same": false
        },
        {
          "line": 295,
          "old_api": ", '0', '0', '0', '-', '0',",
          "new_api": null,
          "old_text": ", '0', '0', '0', '-', '0', ",
          "new_text": null,
          "old_line_content": "\tUInt8 second = date_lut.toSecond(datetime);",
          "new_line_content": "\ts[9] += values.day_of_month % 10;",
          "content_same": false
        },
        {
          "line": 304,
          "old_api": "s[2] += (dateti",
          "new_api": null,
          "old_text": "\ts[2] += (dateti",
          "new_text": null,
          "old_line_content": "\tbuf.write(s, 19);",
          "new_line_content": "\ts[15] += minute % 10;",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": "uotedString",
          "new_api": null,
          "old_text": "uotedString(const String & s, Write",
          "new_text": null,
          "old_line_content": "\twriteAnyEscapedString<'\\''>(s, buf);",
          "new_line_content": "\t/// strpbrk хорошо оптимизирована (этот if ускоряет код в 1.5 раза)",
          "content_same": false
        },
        {
          "line": 311,
          "old_api": "10;\n\ts[12] +=",
          "new_api": null,
          "old_text": " 10;\n\ts[12] += ",
          "new_text": null,
          "old_line_content": "\ts[0] += datetime.year() / 1000;",
          "new_line_content": "inline void writeDateTimeText(mysqlxx::DateTime datetime, WriteBuffer & buf)",
          "content_same": false
        },
        {
          "line": 312,
          "old_api": "0;\n\ts[14] += da",
          "new_api": null,
          "old_text": "0;\n\ts[14] += da",
          "new_text": null,
          "old_line_content": "\ts[1] += (datetime.year() / 100) % 10;",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": "}\n\n\ninline void",
          "new_api": null,
          "old_text": "\n}\n\n\ninline void ",
          "new_text": null,
          "old_line_content": "\twriteChar(c, buf);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": "teQuotedString",
          "new_api": null,
          "old_text": "teQuotedString(const String & s,",
          "new_text": null,
          "old_line_content": "\twriteAnyEscapedString<c>(s, buf);",
          "new_line_content": "template <char c>",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": "iteBuffer & buf)",
          "new_api": null,
          "old_text": "iteBuffer & buf)\n",
          "new_text": null,
          "old_line_content": "\twriteChar(c, buf);",
          "new_line_content": "void writeAnyQuotedString(const String & s, WriteBuffer & buf)",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": "[15] += datetim",
          "new_api": null,
          "old_text": "[15] += datetim",
          "new_text": null,
          "old_line_content": "\ts[2] += (datetime.year() / 10) % 10;",
          "new_line_content": "\tchar s[19] = {'0', '0', '0', '0', '-', '0', '0', '-', '0', '0', ' ', '0', '0', ':', '0', '0', ':', '0', '0'};",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": "] += datetime.s",
          "new_api": null,
          "old_text": "] += datetime.s",
          "new_text": null,
          "old_line_content": "\ts[3] += datetime.year() % 10;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": "writeDoubleQuotedString(const Str",
          "new_api": null,
          "old_text": " writeDoubleQuotedString(const Str",
          "new_text": null,
          "old_line_content": "\twriteAnyQuotedString<'\\''>(s, buf);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 323,
          "old_api": "f (i != 0)\n\t\t\tbuf",
          "new_api": null,
          "old_text": "f (i != 0)\n\t\t\tbuf",
          "new_text": null,
          "old_line_content": "\ts[15] += datetime.minute() % 10;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": "ентификатор в MySQL.\ninline void",
          "new_api": null,
          "old_text": "ентификатор в MySQL.\ninline void ",
          "new_text": null,
          "old_line_content": "\twriteAnyQuotedString<'\"'>(s, buf);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "ля идентификатора без обратных ка",
          "new_api": null,
          "old_text": "ля идентификатора без обратных ка",
          "new_text": null,
          "old_line_content": "\twriteAnyQuotedString<'`'>(s, buf);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": "/// Перен",
          "new_api": null,
          "old_text": "\t/// Перен",
          "new_text": null,
          "old_line_content": "\tfor (size_t i = 0; i < row.size(); ++i)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": "ак метод требуе",
          "new_api": null,
          "old_text": "ак метод требуе",
          "new_text": null,
          "old_line_content": "\t\t\tbuf.write('\\t');",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "if (!(",
          "new_api": null,
          "old_text": "\t\t\tif (!(",
          "new_text": null,
          "old_line_content": "\tif (s.empty() || !((s[0] >= 'a' && s[0] <= 'z') || (s[0] >= 'A' && s[0] <= 'Z') || s[0] == '_'))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "= '9') || *pos == '_'))\n\t\t\t\tb",
          "new_api": null,
          "old_text": "= '9') || *pos == '_'))\n\t\t\t\tb",
          "new_text": null,
          "old_line_content": "\t\twriteBackQuotedString(s, buf);",
          "new_line_content": "/// То же самое, но обратные кавычки применяются только при наличии символов, не подходящих для идентификатора без обратных кавычек.",
          "content_same": false
        },
        {
          "line": 339,
          "old_api": "DBObject-ов\n\tt",
          "new_api": null,
          "old_text": " DBObject-ов\n\tt",
          "new_text": null,
          "old_line_content": "\t\tif (unlikely(row[i].isNull()))",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": "ikely",
          "new_api": null,
          "old_text": "ikely(date > DATE_LUT_MAX_DAY",
          "new_text": null,
          "old_line_content": "\t\t\twriteBackQuotedString(s, buf);",
          "new_line_content": "\t\tfor (; pos < end; ++pos)",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": "== 0))\n\t{\n\t\tbuf.wr",
          "new_api": null,
          "old_text": " == 0))\n\t{\n\t\tbuf.wr",
          "new_text": null,
          "old_line_content": "\t\t\twriteString(s, buf);",
          "new_line_content": "\t\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": "onst UInt32 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }\ntemplate <> inline void write",
          "new_api": null,
          "old_text": "onst UInt32 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }\ntemplate <> inline void write",
          "new_text": null,
          "old_line_content": "\tthrow Exception(\"Method writeText is not implemented for this type.\", ErrorCodes::NOT_IMPLEMENTED);",
          "new_line_content": "template <typename T>",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": "<> inline void writ",
          "new_api": null,
          "old_text": " <> inline void writ",
          "new_text": null,
          "old_line_content": "template <> inline void writeText<UInt8>\t(const UInt8 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "new_line_content": "\t/// Переношу ошибку в рантайм, так как метод требуется для компиляции DBObject-ов",
          "content_same": false
        },
        {
          "line": 359,
          "old_api": "nline void writeText",
          "new_api": null,
          "old_text": "nline void writeText",
          "new_text": null,
          "old_line_content": "template <> inline void writeText<UInt32>\t(const UInt32 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": "ine void writeText<I",
          "new_api": null,
          "old_text": "ine void writeText<I",
          "new_text": null,
          "old_line_content": "template <> inline void writeText<UInt64>\t(const UInt64 & x, \tWriteBuffer & buf) { writeIntText(x, buf); }",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": "0;\n\ts[2] += (values.year / 10) % 10;\n\ts[3] += valu",
          "new_api": null,
          "old_text": "0;\n\ts[2] += (values.year / 10) % 10;\n\ts[3] += valu",
          "new_text": null,
          "old_line_content": "\tif (unlikely(date > DATE_LUT_MAX_DAY_NUM || date == 0))",
          "new_line_content": "inline void writeDateText(Yandex::DayNum_t date, WriteBuffer & buf)",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": "% 10;\n\ts[5] +=",
          "new_api": null,
          "old_text": " % 10;\n\ts[5] += ",
          "new_text": null,
          "old_line_content": "\t\tbuf.write(s, 10);",
          "new_line_content": "\tchar s[10] = {'0', '0', '0', '0', '-', '0', '0', '-', '0', '0'};",
          "content_same": false
        },
        {
          "line": 250,
          "old_api": "% 10;\n\ts[3] += d",
          "new_api": null,
          "old_text": "% 10;\n\ts[3] += d",
          "new_text": null,
          "old_line_content": "\tbuf.write(s, 10);",
          "new_line_content": "\ts[6] += values.month % 10;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 32,
      "total_additions": 39,
      "total_deletions": 37,
      "total_api_changes": 108
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 108,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          181
        ]
      }
    },
    "api_calls_before": 118,
    "api_calls_after": 124,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 1,
      "total_diff_lines": 18
    }
  }
}