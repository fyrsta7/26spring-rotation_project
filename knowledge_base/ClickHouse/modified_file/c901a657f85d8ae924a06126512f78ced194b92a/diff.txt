diff --git a/src/Processors/Formats/Impl/PrettyBlockOutputFormat.cpp b/src/Processors/Formats/Impl/PrettyBlockOutputFormat.cpp
index 6ad5c2ad719..3a6b01a36ae 100644
--- a/src/Processors/Formats/Impl/PrettyBlockOutputFormat.cpp
+++ b/src/Processors/Formats/Impl/PrettyBlockOutputFormat.cpp
@@ -57,6 +57,13 @@ void PrettyBlockOutputFormat::calculateWidths(
                 elem.type->serializeAsText(*column, j, out_serialize, format_settings);
             }
 
+            /// Avoid calculating width of too long strings by limiting the size in bytes.
+            /// Note that it is just an estimation. 4 is the maximum size of Unicode code point in bytes in UTF-8.
+            /// But it's possible that the string is long in bytes but very short in visible size.
+            /// (e.g. non-printable characters, diacritics, combining characters)
+            if (serialized_value.size() > format_settings.pretty.max_value_width * 4)
+                serialized_value.resize(format_settings.pretty.max_value_width * 4);
+
             widths[i][j] = UTF8::computeWidth(reinterpret_cast<const UInt8 *>(serialized_value.data()), serialized_value.size(), prefix);
             max_padded_widths[i] = std::max(max_padded_widths[i],
                 std::min(format_settings.pretty.max_column_pad_width,
