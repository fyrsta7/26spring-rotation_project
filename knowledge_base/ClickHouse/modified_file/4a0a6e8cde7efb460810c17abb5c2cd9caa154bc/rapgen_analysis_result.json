{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/4a0a6e8cde7efb460810c17abb5c2cd9caa154bc",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/4a0a6e8cde7efb460810c17abb5c2cd9caa154bc/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/4a0a6e8cde7efb460810c17abb5c2cd9caa154bc/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/4a0a6e8cde7efb460810c17abb5c2cd9caa154bc/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 105,
          "old_api": "visit",
          "new_api": "ast->as<ASTIdentifier>()",
          "old_text": "visit(*t, ast, data)",
          "new_text": "ast->as<ASTIdentifier>()",
          "old_line_content": "        visit(*t, ast, data);",
          "new_line_content": "    if (auto * t = ast->as<ASTIdentifier>())",
          "content_same": false
        },
        {
          "line": 106,
          "old_api": "ast->as<ASTTableJoin>()",
          "new_api": "visit",
          "old_text": "ast->as<ASTTableJoin>()",
          "new_text": "visit(*t, ast, data)",
          "old_line_content": "    if (auto * t = ast->as<ASTTableJoin>())",
          "new_line_content": "        visit(*t, ast, data);",
          "content_same": false
        },
        {
          "line": 107,
          "old_api": "visit",
          "new_api": "ast->as<ASTTableJoin>()",
          "old_text": "visit(*t, ast, data)",
          "new_text": "ast->as<ASTTableJoin>()",
          "old_line_content": "        visit(*t, ast, data);",
          "new_line_content": "    if (auto * t = ast->as<ASTTableJoin>())",
          "content_same": false
        },
        {
          "line": 108,
          "old_api": "ast->as<ASTSelectQuery>()",
          "new_api": "visit",
          "old_text": "ast->as<ASTSelectQuery>()",
          "new_text": "visit(*t, ast, data)",
          "old_line_content": "    if (auto * t = ast->as<ASTSelectQuery>())",
          "new_line_content": "        visit(*t, ast, data);",
          "content_same": false
        },
        {
          "line": 109,
          "old_api": "visit",
          "new_api": "ast->as<ASTSelectQuery>()",
          "old_text": "visit(*t, ast, data)",
          "new_text": "ast->as<ASTSelectQuery>()",
          "old_line_content": "        visit(*t, ast, data);",
          "new_line_content": "    if (auto * t = ast->as<ASTSelectQuery>())",
          "content_same": false
        },
        {
          "line": 110,
          "old_api": "ast->as<ASTExpressionList>()",
          "new_api": "visit",
          "old_text": "ast->as<ASTExpressionList>()",
          "new_text": "visit(*t, ast, data)",
          "old_line_content": "    if (auto * node = ast->as<ASTExpressionList>())",
          "new_line_content": "        visit(*t, ast, data);",
          "content_same": false
        },
        {
          "line": 111,
          "old_api": "visit",
          "new_api": "ast->as<ASTExpressionList>()",
          "old_text": "visit(*node, ast, data)",
          "new_text": "ast->as<ASTExpressionList>()",
          "old_line_content": "        visit(*node, ast, data);",
          "new_line_content": "    if (auto * node = ast->as<ASTExpressionList>())",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": "ast->as<ASTFunction>()",
          "new_api": "visit",
          "old_text": "ast->as<ASTFunction>()",
          "new_text": "visit(*node, ast, data)",
          "old_line_content": "    if (auto * node = ast->as<ASTFunction>())",
          "new_line_content": "        visit(*node, ast, data);",
          "content_same": false
        },
        {
          "line": 113,
          "old_api": "visit",
          "new_api": "ast->as<ASTFunction>()",
          "old_text": "visit(*node, ast, data)",
          "new_text": "ast->as<ASTFunction>()",
          "old_line_content": "        visit(*node, ast, data);",
          "new_line_content": "    if (auto * node = ast->as<ASTFunction>())",
          "content_same": false
        },
        {
          "line": 121,
          "old_api": "contains",
          "new_api": "shortName",
          "old_text": "data.join_using_columns.contains(short_name)",
          "new_text": "identifier.shortName()",
          "old_line_content": "        bool allow_ambiguous = data.join_using_columns.contains(short_name);",
          "new_line_content": "        String short_name = identifier.shortName();",
          "content_same": false
        },
        {
          "line": 122,
          "old_api": "IdentifierSemantic::chooseTable(identifier, data.tables, allow_ambiguous)",
          "new_api": "contains",
          "old_text": "IdentifierSemantic::chooseTable(identifier, data.tables, allow_ambiguous)",
          "new_text": "data.join_using_columns.contains(short_name)",
          "old_line_content": "        if (auto best_pos = IdentifierSemantic::chooseTable(identifier, data.tables, allow_ambiguous))",
          "new_line_content": "        bool allow_ambiguous = data.join_using_columns.contains(short_name);",
          "content_same": false
        },
        {
          "line": 128,
          "old_api": "name",
          "new_api": "getQualifiedNamePrefix",
          "old_text": "identifier.name()",
          "new_text": "data.tables[table_pos].table.getQualifiedNamePrefix(false)",
          "old_line_content": "                throw Exception(\"There's no column '\" + identifier.name() + \"' in table '\" + table_name + \"'\",",
          "new_line_content": "                String table_name = data.tables[table_pos].table.getQualifiedNamePrefix(false);",
          "content_same": false
        },
        {
          "line": 138,
          "old_api": "IdentifierSemantic::setColumnLongName(identifier, table)",
          "new_api": "at",
          "old_text": "IdentifierSemantic::setColumnLongName(identifier, table)",
          "new_text": "short_name.at(0)",
          "old_line_content": "                IdentifierSemantic::setColumnLongName(identifier, table);",
          "new_line_content": "            if (table_pos && (data.hasColumn(short_name) || !isValidIdentifierBegin(short_name.at(0))))",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": "func_arguments->children[0]->as<ASTAsterisk>()",
          "new_api": "size",
          "old_text": "func_arguments->children[0]->as<ASTAsterisk>()",
          "new_text": "func_arguments->children.size()",
          "old_line_content": "        func_arguments->children[0]->as<ASTAsterisk>())",
          "new_line_content": "        func_arguments->children.size() == 1 &&",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": "clear",
          "new_api": "func_arguments->children[0]->as<ASTAsterisk>()",
          "old_text": "func_arguments->children.clear()",
          "new_text": "func_arguments->children[0]->as<ASTAsterisk>()",
          "old_line_content": "        func_arguments->children.clear();",
          "new_line_content": "        func_arguments->children[0]->as<ASTAsterisk>())",
          "content_same": false
        },
        {
          "line": 162,
          "old_api": "Exception",
          "new_api": "empty",
          "old_text": "Exception(\"Logical error: qualified asterisk must have children\", ErrorCodes::LOGICAL_ERROR)",
          "new_text": "ast->children.empty()",
          "old_line_content": "        throw Exception(\"Logical error: qualified asterisk must have children\", ErrorCodes::LOGICAL_ERROR);",
          "new_line_content": "    if (ast->children.empty())",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": "extractJoinUsingColumns",
          "new_api": "join",
          "old_text": "extractJoinUsingColumns(join->table_join, data)",
          "new_text": "select.join()",
          "old_line_content": "        extractJoinUsingColumns(join->table_join, data);",
          "new_line_content": "    if (const auto * join = select.join())",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": "refPrewhere",
          "new_api": "prewhere",
          "old_text": "select.refPrewhere()",
          "new_text": "select.prewhere()",
          "old_line_content": "        Visitor(data).visit(select.refPrewhere());",
          "new_line_content": "    if (select.prewhere())",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": "where",
          "new_api": "refPrewhere",
          "old_text": "select.where()",
          "new_text": "select.refPrewhere()",
          "old_line_content": "    if (select.where())",
          "new_line_content": "        Visitor(data).visit(select.refPrewhere());",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": "refWhere",
          "new_api": "where",
          "old_text": "select.refWhere()",
          "new_text": "select.where()",
          "old_line_content": "        Visitor(data).visit(select.refWhere());",
          "new_line_content": "    if (select.where())",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": "having",
          "new_api": "refWhere",
          "old_text": "select.having()",
          "new_text": "select.refWhere()",
          "old_line_content": "    if (select.having())",
          "new_line_content": "        Visitor(data).visit(select.refWhere());",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": "refHaving",
          "new_api": "having",
          "old_text": "select.refHaving()",
          "new_text": "select.having()",
          "old_line_content": "        Visitor(data).visit(select.refHaving());",
          "new_line_content": "    if (select.having())",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": "begin",
          "new_api": "getQualifiedNamePrefix",
          "old_text": "parts.begin()",
          "new_text": "table.getQualifiedNamePrefix(false)",
          "old_line_content": "    if (!table_name.empty()) parts.insert(parts.begin(), table_name);",
          "new_line_content": "    String table_name = table.getQualifiedNamePrefix(false);",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": "Exception",
          "new_api": "empty",
          "old_text": "Exception(\"An asterisk cannot be replaced with empty columns.\", ErrorCodes::LOGICAL_ERROR)",
          "new_text": "tables_with_columns.empty()",
          "old_line_content": "                    throw Exception(\"An asterisk cannot be replaced with empty columns.\", ErrorCodes::LOGICAL_ERROR);",
          "new_line_content": "                if (tables_with_columns.empty())",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": "size",
          "new_api": "swap",
          "old_text": "old_children.size()",
          "new_text": "old_children.swap(node.children)",
          "old_line_content": "            node.children.reserve(old_children.size());",
          "new_line_content": "            old_children.swap(node.children);",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": "addIdentifier",
          "new_api": "contains",
          "old_text": "addIdentifier(columns, table.table, column.name)",
          "new_text": "data.join_using_columns.contains(column.name)",
          "old_line_content": "                            addIdentifier(columns, table.table, column.name);",
          "new_line_content": "                        if (first_table || !data.join_using_columns.contains(column.name))",
          "content_same": false
        },
        {
          "line": 312,
          "old_api": "end",
          "new_api": "insert",
          "old_text": "node.children.end()",
          "new_text": "node.children.insert(\n            node.children.end(),\n            std::make_move_iterator(columns.begin()),\n            std::make_move_iterator(columns.end()))",
          "old_line_content": "            node.children.end(),",
          "new_line_content": "        node.children.insert(",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": "begin",
          "new_api": "end",
          "old_text": "columns.begin()",
          "new_text": "node.children.end()",
          "old_line_content": "            std::make_move_iterator(columns.begin()),",
          "new_line_content": "            node.children.end(),",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": "end",
          "new_api": "begin",
          "old_text": "columns.end()",
          "new_text": "columns.begin()",
          "old_line_content": "            std::make_move_iterator(columns.end()));",
          "new_line_content": "            std::make_move_iterator(columns.begin()),",
          "content_same": false
        },
        {
          "line": 328,
          "old_api": "insert",
          "new_api": "tryGetIdentifierName",
          "old_text": "data.join_using_columns.insert(*opt_column)",
          "new_text": "tryGetIdentifierName(key)",
          "old_line_content": "                data.join_using_columns.insert(*opt_column);",
          "new_line_content": "            if (auto opt_column = tryGetIdentifierName(key))",
          "content_same": false
        },
        {
          "line": 329,
          "old_api": "key->as<ASTLiteral>()",
          "new_api": "insert",
          "old_text": "key->as<ASTLiteral>()",
          "new_text": "data.join_using_columns.insert(*opt_column)",
          "old_line_content": "            else if (key->as<ASTLiteral>())",
          "new_line_content": "                data.join_using_columns.insert(*opt_column);",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": "getColumnName",
          "new_api": "key->as<ASTLiteral>()",
          "old_text": "key->getColumnName()",
          "new_text": "key->as<ASTLiteral>()",
          "old_line_content": "                data.join_using_columns.insert(key->getColumnName());",
          "new_line_content": "            else if (key->as<ASTLiteral>())",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": "empty",
          "new_api": "tryGetAlias",
          "old_text": "alias.empty()",
          "new_text": "key->tryGetAlias()",
          "old_line_content": "                if (alias.empty())",
          "new_line_content": "                String alias = key->tryGetAlias();",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": "getID",
          "new_api": "empty",
          "old_text": "key->getID()",
          "new_text": "alias.empty()",
          "old_line_content": "                    throw Exception(\"Wrong key in USING. Expected identifier or alias, got: \" + key->getID(),",
          "new_line_content": "                if (alias.empty())",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": "visit",
          "new_api": "ast->as<ASTIdentifier>()",
          "old_text": "visit(*t, ast, data)",
          "new_text": "ast->as<ASTIdentifier>()",
          "old_line_content": "        visit(*t, ast, data);",
          "new_line_content": "    if (auto * t = ast->as<ASTIdentifier>())",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": "changeTable",
          "new_api": "restoreTable",
          "old_text": "data.changeTable(identifier)",
          "new_text": "identifier.restoreTable()",
          "old_line_content": "            data.changeTable(identifier);",
          "new_line_content": "            identifier.restoreTable();  // TODO(ilezhankin): should restore qualified name here - why exactly here?",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 129,
          "old_api": null,
          "new_api": "name",
          "old_text": null,
          "new_text": "identifier.name()",
          "old_line_content": "                                ErrorCodes::UNKNOWN_IDENTIFIER);",
          "new_line_content": "                throw Exception(\"There's no column '\" + identifier.name() + \"' in table '\" + table_name + \"'\",",
          "content_same": false
        },
        {
          "line": 133,
          "old_api": null,
          "new_api": "IdentifierSemantic::setMembership(identifier, table_pos)",
          "old_text": null,
          "new_text": "IdentifierSemantic::setMembership(identifier, table_pos)",
          "old_line_content": "",
          "new_line_content": "            IdentifierSemantic::setMembership(identifier, table_pos);",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": null,
          "new_api": "IASTColumnsTransformer::transform(transformer, columns)",
          "old_text": null,
          "new_text": "IASTColumnsTransformer::transform(transformer, columns)",
          "old_line_content": "        }",
          "new_line_content": "                IASTColumnsTransformer::transform(transformer, columns);",
          "content_same": false
        },
        {
          "line": 263,
          "old_api": null,
          "new_api": "child->as<ASTColumnsListMatcher>()",
          "old_text": null,
          "new_text": "child->as<ASTColumnsListMatcher>()",
          "old_line_content": "        {",
          "new_line_content": "        else if (auto * asterisk_column_list = child->as<ASTColumnsListMatcher>())",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": null,
          "new_api": "clone",
          "old_text": null,
          "new_text": "ident->clone()",
          "old_line_content": "",
          "new_line_content": "                columns.emplace_back(ident->clone());",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": null,
          "new_api": "IdentifierSemantic::setColumnLongName(identifier, table)",
          "old_text": null,
          "new_text": "IdentifierSemantic::setColumnLongName(identifier, table)",
          "old_line_content": "            else",
          "new_line_content": "                IdentifierSemantic::setColumnLongName(identifier, table);",
          "content_same": false
        },
        {
          "line": 141,
          "old_api": null,
          "new_api": "IdentifierSemantic::setColumnShortName(identifier, table)",
          "old_text": null,
          "new_text": "IdentifierSemantic::setColumnShortName(identifier, table)",
          "old_line_content": "        }",
          "new_line_content": "                IdentifierSemantic::setColumnShortName(identifier, table);",
          "content_same": false
        },
        {
          "line": 269,
          "old_api": null,
          "new_api": "IASTColumnsTransformer::transform(transformer, columns)",
          "old_text": null,
          "new_text": "IASTColumnsTransformer::transform(transformer, columns)",
          "old_line_content": "        }",
          "new_line_content": "                IASTColumnsTransformer::transform(transformer, columns);",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": null,
          "new_api": "child->as<ASTColumnsRegexpMatcher>()",
          "old_text": null,
          "new_text": "child->as<ASTColumnsRegexpMatcher>()",
          "old_line_content": "        {",
          "new_line_content": "        else if (const auto * asterisk_regexp_pattern = child->as<ASTColumnsRegexpMatcher>())",
          "content_same": false
        },
        {
          "line": 278,
          "old_api": null,
          "new_api": "contains",
          "old_text": null,
          "new_text": "data.join_using_columns.contains(column.name)",
          "old_line_content": "                    {",
          "new_line_content": "                    if (asterisk_regexp_pattern->isColumnMatching(column.name) && (first_table || !data.join_using_columns.contains(column.name)))",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": null,
          "new_api": "addIdentifier",
          "old_text": null,
          "new_text": "addIdentifier(columns, table.table, column.name)",
          "old_line_content": "                    }",
          "new_line_content": "                        addIdentifier(columns, table.table, column.name);",
          "content_same": false
        },
        {
          "line": 153,
          "old_api": null,
          "new_api": "Poco::toLower(node.name)",
          "old_text": null,
          "new_text": "Poco::toLower(node.name)",
          "old_line_content": "    if (func_name_lowercase == \"count\" &&",
          "new_line_content": "    String func_name_lowercase = Poco::toLower(node.name);",
          "content_same": false
        },
        {
          "line": 157,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "func_arguments->children.clear()",
          "old_line_content": "}",
          "new_line_content": "        func_arguments->children.clear();",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": null,
          "new_api": "IASTColumnsTransformer::transform(transformer, columns)",
          "old_text": null,
          "new_text": "IASTColumnsTransformer::transform(transformer, columns)",
          "old_line_content": "        }",
          "new_line_content": "                IASTColumnsTransformer::transform(transformer, columns);",
          "content_same": false
        },
        {
          "line": 289,
          "old_api": null,
          "new_api": "child->as<ASTQualifiedAsterisk>()",
          "old_text": null,
          "new_text": "child->as<ASTQualifiedAsterisk>()",
          "old_line_content": "        {",
          "new_line_content": "        else if (const auto * qualified_asterisk = child->as<ASTQualifiedAsterisk>())",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": null,
          "new_api": "Exception",
          "old_text": null,
          "new_text": "Exception(\"Logical error: qualified asterisk must have children\", ErrorCodes::LOGICAL_ERROR)",
          "old_line_content": "",
          "new_line_content": "        throw Exception(\"Logical error: qualified asterisk must have children\", ErrorCodes::LOGICAL_ERROR);",
          "content_same": false
        },
        {
          "line": 295,
          "old_api": null,
          "new_api": "satisfies",
          "old_text": null,
          "new_text": "ident_db_and_name.satisfies(table.table, true)",
          "old_line_content": "                {",
          "new_line_content": "                if (ident_db_and_name.satisfies(table.table, true))",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": null,
          "new_api": "addIdentifier",
          "old_text": null,
          "new_text": "addIdentifier(columns, table.table, column.name)",
          "old_line_content": "                    break;",
          "new_line_content": "                        addIdentifier(columns, table.table, column.name);",
          "content_same": false
        },
        {
          "line": 171,
          "old_api": null,
          "new_api": "satisfies",
          "old_text": null,
          "new_text": "db_and_table.satisfies(known_table.table, true)",
          "old_line_content": "            return;",
          "new_line_content": "        if (db_and_table.satisfies(known_table.table, true))",
          "content_same": false
        },
        {
          "line": 174,
          "old_api": null,
          "new_api": "getAliasOrColumnName",
          "old_text": null,
          "new_text": "ident->getAliasOrColumnName()",
          "old_line_content": "}",
          "new_line_content": "    throw Exception(\"Unknown qualified identifier: \" + ident->getAliasOrColumnName(), ErrorCodes::UNKNOWN_IDENTIFIER);",
          "content_same": false
        },
        {
          "line": 304,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "qualified_asterisk->children.end()",
          "old_line_content": "            {",
          "new_line_content": "            for (auto it = qualified_asterisk->children.begin() + 1; it != qualified_asterisk->children.end(); ++it)",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": null,
          "new_api": "IASTColumnsTransformer::transform(*it, columns)",
          "old_text": null,
          "new_text": "IASTColumnsTransformer::transform(*it, columns)",
          "old_line_content": "            }",
          "new_line_content": "                IASTColumnsTransformer::transform(*it, columns);",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": null,
          "new_api": "visit",
          "old_text": null,
          "new_text": "Visitor(data).visit(join.using_expression_list)",
          "old_line_content": "    else if (join.on_expression)",
          "new_line_content": "        Visitor(data).visit(join.using_expression_list);",
          "content_same": false
        },
        {
          "line": 53,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "names.size()",
          "old_line_content": "            {",
          "new_line_content": "            for (size_t i = 0; i < names.size(); ++i)",
          "content_same": false
        },
        {
          "line": 182,
          "old_api": null,
          "new_api": "visit",
          "old_text": null,
          "new_text": "Visitor(data).visit(join.on_expression)",
          "old_line_content": "}",
          "new_line_content": "        Visitor(data).visit(join.on_expression);",
          "content_same": false
        },
        {
          "line": 55,
          "old_api": null,
          "new_api": "matchColumnName",
          "old_text": null,
          "new_text": "matchColumnName(sub_name, names[i], element_types[i])",
          "old_line_content": "                {",
          "new_line_content": "                if (matchColumnName(sub_name, names[i], element_types[i]))",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": null,
          "new_api": "emplace_back",
          "old_text": null,
          "new_text": "columns.emplace_back(child)",
          "old_line_content": "",
          "new_line_content": "            columns.emplace_back(child);",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "columns.end()",
          "old_line_content": "    }",
          "new_line_content": "            std::make_move_iterator(columns.end()));",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": null,
          "new_api": "extractJoinUsingColumns",
          "old_text": null,
          "new_text": "extractJoinUsingColumns(join->table_join, data)",
          "old_line_content": "",
          "new_line_content": "        extractJoinUsingColumns(join->table_join, data);",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": null,
          "new_api": "ast->as<ASTTableJoin &>()",
          "old_text": null,
          "new_text": "ast->as<ASTTableJoin &>()",
          "old_line_content": "",
          "new_line_content": "    const auto & table_join = ast->as<ASTTableJoin &>();",
          "content_same": false
        },
        {
          "line": 69,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "columns.empty()",
          "old_line_content": "        return false;",
          "new_line_content": "    if (columns.empty())",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": null,
          "new_api": "refHaving",
          "old_text": null,
          "new_text": "select.refHaving()",
          "old_line_content": "}",
          "new_line_content": "        Visitor(data).visit(select.refHaving());",
          "content_same": false
        },
        {
          "line": 326,
          "old_api": null,
          "new_api": "table_join.using_expression_list->as<ASTExpressionList &>()",
          "old_text": null,
          "new_text": "table_join.using_expression_list->as<ASTExpressionList &>()",
          "old_line_content": "        for (const auto & key : keys.children)",
          "new_line_content": "        const auto & keys = table_join.using_expression_list->as<ASTExpressionList &>();",
          "content_same": false
        },
        {
          "line": 73,
          "old_api": null,
          "new_api": "IdentifierSemantic::extractNestedName(identifier, table)",
          "old_text": null,
          "new_text": "IdentifierSemantic::extractNestedName(identifier, table)",
          "old_line_content": "",
          "new_line_content": "    auto full_name = IdentifierSemantic::extractNestedName(identifier, table);",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": null,
          "new_api": "getColumnName",
          "old_text": null,
          "new_text": "key->getColumnName()",
          "old_line_content": "            else",
          "new_line_content": "                data.join_using_columns.insert(key->getColumnName());",
          "content_same": false
        },
        {
          "line": 77,
          "old_api": null,
          "new_api": "matchColumnName",
          "old_text": null,
          "new_text": "matchColumnName(full_name, column.name, column.type)",
          "old_line_content": "            return false;",
          "new_line_content": "        if (matchColumnName(full_name, column.name, column.type))",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": null,
          "new_api": "begin",
          "old_text": null,
          "new_text": "parts.begin()",
          "old_line_content": "",
          "new_line_content": "    if (!table_name.empty()) parts.insert(parts.begin(), table_name);",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": null,
          "new_api": "std::move(parts)",
          "old_text": null,
          "new_text": "std::move(parts)",
          "old_line_content": "}",
          "new_line_content": "    nodes.emplace_back(std::make_shared<ASTIdentifier>(std::move(parts)));",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": null,
          "new_api": "getID",
          "old_text": null,
          "new_text": "key->getID()",
          "old_line_content": "                                    ErrorCodes::UNSUPPORTED_JOIN_KEYS);",
          "new_line_content": "                    throw Exception(\"Wrong key in USING. Expected identifier or alias, got: \" + key->getID(),",
          "content_same": false
        },
        {
          "line": 338,
          "old_api": null,
          "new_api": "insert",
          "old_text": null,
          "new_text": "data.join_using_columns.insert(alias)",
          "old_line_content": "            }",
          "new_line_content": "                data.join_using_columns.insert(alias);",
          "content_same": false
        },
        {
          "line": 83,
          "old_api": null,
          "new_api": "matchColumnName",
          "old_text": null,
          "new_text": "matchColumnName(full_name, column.name, column.type)",
          "old_line_content": "            return false;",
          "new_line_content": "        if (matchColumnName(full_name, column.name, column.type))",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": null,
          "new_api": "addIdentifier",
          "old_text": null,
          "new_text": "addIdentifier(columns, table.table, column.name)",
          "old_line_content": "                    }",
          "new_line_content": "                            addIdentifier(columns, table.table, column.name);",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": null,
          "new_api": "processAsterisks",
          "old_text": null,
          "new_text": "data.processAsterisks()",
          "old_line_content": "    {",
          "new_line_content": "    if (data.processAsterisks())",
          "content_same": false
        },
        {
          "line": 346,
          "old_api": null,
          "new_api": "IdentifierSemantic::canReferColumnToTable(identifier, distributed_table)",
          "old_text": null,
          "new_text": "IdentifierSemantic::canReferColumnToTable(identifier, distributed_table)",
          "old_line_content": "    switch (match)",
          "new_line_content": "    auto match = IdentifierSemantic::canReferColumnToTable(identifier, distributed_table);",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": null,
          "new_api": "child->as<ASTSelectWithUnionQuery>()",
          "old_text": null,
          "new_text": "child->as<ASTSelectWithUnionQuery>()",
          "old_line_content": "        return false;",
          "new_line_content": "    if (child->as<ASTTableExpression>() || child->as<ASTSelectWithUnionQuery>())",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": null,
          "new_api": "child->as<ASTColumnsRegexpMatcher>()",
          "old_text": null,
          "new_text": "child->as<ASTColumnsRegexpMatcher>()",
          "old_line_content": "            {",
          "new_line_content": "            if (child->as<ASTAsterisk>() || child->as<ASTColumnsListMatcher>() || child->as<ASTColumnsRegexpMatcher>())",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": null,
          "new_api": "IdentifierSemantic::getColumnName(identifier)",
          "old_text": null,
          "new_text": "IdentifierSemantic::getColumnName(identifier)",
          "old_line_content": "    {",
          "new_line_content": "    if (IdentifierSemantic::getColumnName(identifier))",
          "content_same": false
        },
        {
          "line": 96,
          "old_api": null,
          "new_api": "node->as<ASTTableJoin>()",
          "old_text": null,
          "new_text": "node->as<ASTTableJoin>()",
          "old_line_content": "        return false;",
          "new_line_content": "    if (node->as<ASTQualifiedAsterisk>() || node->as<ASTTableJoin>())",
          "content_same": false
        },
        {
          "line": 224,
          "old_api": null,
          "new_api": "Exception",
          "old_text": null,
          "new_text": "Exception(\"An asterisk cannot be replaced with empty columns.\", ErrorCodes::LOGICAL_ERROR)",
          "old_line_content": "                has_asterisk = true;",
          "new_line_content": "                    throw Exception(\"An asterisk cannot be replaced with empty columns.\", ErrorCodes::LOGICAL_ERROR);",
          "content_same": false
        },
        {
          "line": 352,
          "old_api": null,
          "new_api": "IdentifierSemantic::setColumnLongName(identifier, remote_table)",
          "old_text": null,
          "new_text": "IdentifierSemantic::setColumnLongName(identifier, remote_table)",
          "old_line_content": "            break;",
          "new_line_content": "            IdentifierSemantic::setColumnLongName(identifier, remote_table);",
          "content_same": false
        },
        {
          "line": 227,
          "old_api": null,
          "new_api": "child->as<ASTQualifiedAsterisk>()",
          "old_text": null,
          "new_text": "child->as<ASTQualifiedAsterisk>()",
          "old_line_content": "            {",
          "new_line_content": "            else if (const auto * qa = child->as<ASTQualifiedAsterisk>())",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": null,
          "new_api": "visit",
          "old_text": null,
          "new_text": "visit(*qa, child, data)",
          "old_line_content": "                has_asterisk = true;",
          "new_line_content": "                visit(*qa, child, data); /// check if it's OK before rewrite",
          "content_same": false
        },
        {
          "line": 362,
          "old_api": null,
          "new_api": "child->as<ASTSelectWithUnionQuery>()",
          "old_text": null,
          "new_text": "child->as<ASTSelectWithUnionQuery>()",
          "old_line_content": "        return false; // NOLINT",
          "new_line_content": "    if (child->as<ASTSelectWithUnionQuery>())",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "old_children.size()",
          "old_line_content": "        }",
          "new_line_content": "            node.children.reserve(old_children.size());",
          "content_same": false
        },
        {
          "line": 114,
          "old_api": null,
          "new_api": "visit",
          "old_text": null,
          "new_text": "visit(*node, ast, data)",
          "old_line_content": "}",
          "new_line_content": "        visit(*node, ast, data);",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": null,
          "new_api": "visit",
          "old_text": null,
          "new_text": "visit(*t, ast, data)",
          "old_line_content": "}",
          "new_line_content": "        visit(*t, ast, data);",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": null,
          "new_api": "child->as<ASTAsterisk>()",
          "old_text": null,
          "new_text": "child->as<ASTAsterisk>()",
          "old_line_content": "        {",
          "new_line_content": "        if (const auto * asterisk = child->as<ASTAsterisk>())",
          "content_same": false
        },
        {
          "line": 119,
          "old_api": null,
          "new_api": "IdentifierSemantic::getColumnName(identifier)",
          "old_text": null,
          "new_text": "IdentifierSemantic::getColumnName(identifier)",
          "old_line_content": "    {",
          "new_line_content": "    if (IdentifierSemantic::getColumnName(identifier))",
          "content_same": false
        },
        {
          "line": 377,
          "old_api": null,
          "new_api": "IdentifierSemantic::getMembership(identifier)",
          "old_text": null,
          "new_text": "IdentifierSemantic::getMembership(identifier)",
          "old_line_content": "        {",
          "new_line_content": "        if (IdentifierSemantic::getMembership(identifier))",
          "content_same": false
        },
        {
          "line": 123,
          "old_api": null,
          "new_api": "IdentifierSemantic::chooseTable(identifier, data.tables, allow_ambiguous)",
          "old_text": null,
          "new_text": "IdentifierSemantic::chooseTable(identifier, data.tables, allow_ambiguous)",
          "old_line_content": "        {",
          "new_line_content": "        if (auto best_pos = IdentifierSemantic::chooseTable(identifier, data.tables, allow_ambiguous))",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": null,
          "new_api": "changeTable",
          "old_text": null,
          "new_text": "data.changeTable(identifier)",
          "old_line_content": "        }",
          "new_line_content": "            data.changeTable(identifier);",
          "content_same": false
        },
        {
          "line": 126,
          "old_api": null,
          "new_api": "unknownColumn",
          "old_text": null,
          "new_text": "data.unknownColumn(table_pos, identifier)",
          "old_line_content": "            {",
          "new_line_content": "            if (data.unknownColumn(table_pos, identifier))",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 132,
          "old_api": "IdentifierSemantic::setMembership(identifier, table_pos)",
          "new_api": null,
          "old_text": "IdentifierSemantic::setMembership(identifier, table_pos)",
          "new_text": null,
          "old_line_content": "            IdentifierSemantic::setMembership(identifier, table_pos);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 260,
          "old_api": "IASTColumnsTransformer::transform(transformer, columns)",
          "new_api": null,
          "old_text": "IASTColumnsTransformer::transform(transformer, columns)",
          "new_text": null,
          "old_line_content": "                IASTColumnsTransformer::transform(transformer, columns);",
          "new_line_content": "            for (const auto & transformer : asterisk->children)",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": "child->as<ASTColumnsListMatcher>()",
          "new_api": null,
          "old_text": "child->as<ASTColumnsListMatcher>()",
          "new_text": null,
          "old_line_content": "        else if (auto * asterisk_column_list = child->as<ASTColumnsListMatcher>())",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 137,
          "old_api": "at",
          "new_api": null,
          "old_text": "short_name.at(0)",
          "new_text": null,
          "old_line_content": "            if (table_pos && (data.hasColumn(short_name) || !isValidIdentifierBegin(short_name.at(0))))",
          "new_line_content": "            const auto & table = data.tables[table_pos].table;",
          "content_same": false
        },
        {
          "line": 265,
          "old_api": "clone",
          "new_api": null,
          "old_text": "ident->clone()",
          "new_text": null,
          "old_line_content": "                columns.emplace_back(ident->clone());",
          "new_line_content": "            for (const auto & ident : asterisk_column_list->column_list->children)",
          "content_same": false
        },
        {
          "line": 140,
          "old_api": "IdentifierSemantic::setColumnShortName(identifier, table)",
          "new_api": null,
          "old_text": "IdentifierSemantic::setColumnShortName(identifier, table)",
          "new_text": null,
          "old_line_content": "                IdentifierSemantic::setColumnShortName(identifier, table);",
          "new_line_content": "            else",
          "content_same": false
        },
        {
          "line": 268,
          "old_api": "IASTColumnsTransformer::transform(transformer, columns)",
          "new_api": null,
          "old_text": "IASTColumnsTransformer::transform(transformer, columns)",
          "new_text": null,
          "old_line_content": "                IASTColumnsTransformer::transform(transformer, columns);",
          "new_line_content": "            for (const auto & transformer : asterisk_column_list->children)",
          "content_same": false
        },
        {
          "line": 270,
          "old_api": "child->as<ASTColumnsRegexpMatcher>()",
          "new_api": null,
          "old_text": "child->as<ASTColumnsRegexpMatcher>()",
          "new_text": null,
          "old_line_content": "        else if (const auto * asterisk_regexp_pattern = child->as<ASTColumnsRegexpMatcher>())",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": "contains",
          "new_api": null,
          "old_text": "data.join_using_columns.contains(column.name)",
          "new_text": null,
          "old_line_content": "                    if (asterisk_regexp_pattern->isColumnMatching(column.name) && (first_table || !data.join_using_columns.contains(column.name)))",
          "new_line_content": "                {",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": "addIdentifier",
          "new_api": null,
          "old_text": "addIdentifier(columns, table.table, column.name)",
          "new_text": null,
          "old_line_content": "                        addIdentifier(columns, table.table, column.name);",
          "new_line_content": "                    {",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": "Poco::toLower(node.name)",
          "new_api": null,
          "old_text": "Poco::toLower(node.name)",
          "new_text": null,
          "old_line_content": "    String func_name_lowercase = Poco::toLower(node.name);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 154,
          "old_api": "size",
          "new_api": null,
          "old_text": "func_arguments->children.size()",
          "new_text": null,
          "old_line_content": "        func_arguments->children.size() == 1 &&",
          "new_line_content": "    if (func_name_lowercase == \"count\" &&",
          "content_same": false
        },
        {
          "line": 286,
          "old_api": "IASTColumnsTransformer::transform(transformer, columns)",
          "new_api": null,
          "old_text": "IASTColumnsTransformer::transform(transformer, columns)",
          "new_text": null,
          "old_line_content": "                IASTColumnsTransformer::transform(transformer, columns);",
          "new_line_content": "            for (const auto & transformer : asterisk_regexp_pattern->children)",
          "content_same": false
        },
        {
          "line": 288,
          "old_api": "child->as<ASTQualifiedAsterisk>()",
          "new_api": null,
          "old_text": "child->as<ASTQualifiedAsterisk>()",
          "new_text": null,
          "old_line_content": "        else if (const auto * qualified_asterisk = child->as<ASTQualifiedAsterisk>())",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 161,
          "old_api": "empty",
          "new_api": null,
          "old_text": "ast->children.empty()",
          "new_text": null,
          "old_line_content": "    if (ast->children.empty())",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": "satisfies",
          "new_api": null,
          "old_text": "ident_db_and_name.satisfies(table.table, true)",
          "new_text": null,
          "old_line_content": "                if (ident_db_and_name.satisfies(table.table, true))",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": "addIdentifier",
          "new_api": null,
          "old_text": "addIdentifier(columns, table.table, column.name)",
          "new_text": null,
          "old_line_content": "                        addIdentifier(columns, table.table, column.name);",
          "new_line_content": "                    for (const auto & column : table.columns)",
          "content_same": false
        },
        {
          "line": 170,
          "old_api": "satisfies",
          "new_api": null,
          "old_text": "db_and_table.satisfies(known_table.table, true)",
          "new_text": null,
          "old_line_content": "        if (db_and_table.satisfies(known_table.table, true))",
          "new_line_content": "    for (const auto & known_table : data.tables)",
          "content_same": false
        },
        {
          "line": 173,
          "old_api": "getAliasOrColumnName",
          "new_api": null,
          "old_text": "ident->getAliasOrColumnName()",
          "new_text": null,
          "old_line_content": "    throw Exception(\"Unknown qualified identifier: \" + ident->getAliasOrColumnName(), ErrorCodes::UNKNOWN_IDENTIFIER);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": "end",
          "new_api": null,
          "old_text": "qualified_asterisk->children.end()",
          "new_text": null,
          "old_line_content": "            for (auto it = qualified_asterisk->children.begin() + 1; it != qualified_asterisk->children.end(); ++it)",
          "new_line_content": "            // QualifiedAsterisk's transformers start to appear at child 1",
          "content_same": false
        },
        {
          "line": 305,
          "old_api": "IASTColumnsTransformer::transform(*it, columns)",
          "new_api": null,
          "old_text": "IASTColumnsTransformer::transform(*it, columns)",
          "new_text": null,
          "old_line_content": "                IASTColumnsTransformer::transform(*it, columns);",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": "visit",
          "new_api": null,
          "old_text": "Visitor(data).visit(join.using_expression_list)",
          "new_text": null,
          "old_line_content": "        Visitor(data).visit(join.using_expression_list);",
          "new_line_content": "    if (join.using_expression_list)",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": "visit",
          "new_api": null,
          "old_text": "Visitor(data).visit(join.on_expression)",
          "new_text": null,
          "old_line_content": "        Visitor(data).visit(join.on_expression);",
          "new_line_content": "    else if (join.on_expression)",
          "content_same": false
        },
        {
          "line": 54,
          "old_api": "size",
          "new_api": null,
          "old_text": "column_name.size()",
          "new_text": null,
          "old_line_content": "                if (matchColumnName(name.substr(column_name.size() + 1, name.size() - column_name.size()), names[i], element_types[i]))",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": "emplace_back",
          "new_api": null,
          "old_text": "columns.emplace_back(child)",
          "new_text": null,
          "old_line_content": "            columns.emplace_back(child);",
          "new_line_content": "        else",
          "content_same": false
        },
        {
          "line": 311,
          "old_api": "insert",
          "new_api": null,
          "old_text": "node.children.insert(\n            node.children.end(),\n            std::make_move_iterator(columns.begin()),\n            std::make_move_iterator(columns.end()))",
          "new_text": null,
          "old_line_content": "        node.children.insert(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": "join",
          "new_api": null,
          "old_text": "select.join()",
          "new_text": null,
          "old_line_content": "    if (const auto * join = select.join())",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "prewhere",
          "new_api": null,
          "old_text": "select.prewhere()",
          "new_text": null,
          "old_line_content": "    if (select.prewhere())",
          "new_line_content": "    /// but also in where_expression and having_expression.",
          "content_same": false
        },
        {
          "line": 321,
          "old_api": "ast->as<ASTTableJoin &>()",
          "new_api": null,
          "old_text": "ast->as<ASTTableJoin &>()",
          "new_text": null,
          "old_line_content": "    const auto & table_join = ast->as<ASTTableJoin &>();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 68,
          "old_api": "empty",
          "new_api": null,
          "old_text": "columns.empty()",
          "new_text": null,
          "old_line_content": "    if (columns.empty())",
          "new_line_content": "    const auto & columns = tables[table_pos].columns;",
          "content_same": false
        },
        {
          "line": 325,
          "old_api": "table_join.using_expression_list->as<ASTExpressionList &>()",
          "new_api": null,
          "old_text": "table_join.using_expression_list->as<ASTExpressionList &>()",
          "new_text": null,
          "old_line_content": "        const auto & keys = table_join.using_expression_list->as<ASTExpressionList &>();",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 327,
          "old_api": "tryGetIdentifierName",
          "new_api": null,
          "old_text": "tryGetIdentifierName(key)",
          "new_text": null,
          "old_line_content": "            if (auto opt_column = tryGetIdentifierName(key))",
          "new_line_content": "        for (const auto & key : keys.children)",
          "content_same": false
        },
        {
          "line": 72,
          "old_api": "IdentifierSemantic::extractNestedName(identifier, table)",
          "new_api": null,
          "old_text": "IdentifierSemantic::extractNestedName(identifier, table)",
          "new_text": null,
          "old_line_content": "    auto full_name = IdentifierSemantic::extractNestedName(identifier, table);",
          "new_line_content": "    // Remove database and table name from the identifier'name",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": "getQualifiedNamePrefix",
          "new_api": null,
          "old_text": "table.getQualifiedNamePrefix(false)",
          "new_text": null,
          "old_line_content": "    String table_name = table.getQualifiedNamePrefix(false);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 76,
          "old_api": "matchColumnName",
          "new_api": null,
          "old_text": "matchColumnName(full_name, column.name, column.type)",
          "new_text": null,
          "old_line_content": "        if (matchColumnName(full_name, column.name, column.type))",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 333,
          "old_api": "tryGetAlias",
          "new_api": null,
          "old_text": "key->tryGetAlias()",
          "new_text": null,
          "old_line_content": "                String alias = key->tryGetAlias();",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "std::move(parts)",
          "new_api": null,
          "old_text": "std::move(parts)",
          "new_text": null,
          "old_line_content": "    nodes.emplace_back(std::make_shared<ASTIdentifier>(std::move(parts)));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": "insert",
          "new_api": null,
          "old_text": "data.join_using_columns.insert(alias)",
          "new_text": null,
          "old_line_content": "                data.join_using_columns.insert(alias);",
          "new_line_content": "                                    ErrorCodes::UNSUPPORTED_JOIN_KEYS);",
          "content_same": false
        },
        {
          "line": 82,
          "old_api": "matchColumnName",
          "new_api": null,
          "old_text": "matchColumnName(full_name, column.name, column.type)",
          "new_text": null,
          "old_line_content": "        if (matchColumnName(full_name, column.name, column.type))",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 215,
          "old_api": "processAsterisks",
          "new_api": null,
          "old_text": "data.processAsterisks()",
          "new_text": null,
          "old_line_content": "    if (data.processAsterisks())",
          "new_line_content": "    ASTs old_children;",
          "content_same": false
        },
        {
          "line": 345,
          "old_api": "IdentifierSemantic::canReferColumnToTable(identifier, distributed_table)",
          "new_api": null,
          "old_text": "IdentifierSemantic::canReferColumnToTable(identifier, distributed_table)",
          "new_text": null,
          "old_line_content": "    auto match = IdentifierSemantic::canReferColumnToTable(identifier, distributed_table);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 91,
          "old_api": "child->as<ASTSelectWithUnionQuery>()",
          "new_api": null,
          "old_text": "child->as<ASTSelectWithUnionQuery>()",
          "new_text": null,
          "old_line_content": "    if (child->as<ASTTableExpression>() || child->as<ASTSelectWithUnionQuery>())",
          "new_line_content": "    /// Do not go to FROM, JOIN, subqueries.",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": "child->as<ASTColumnsRegexpMatcher>()",
          "new_api": null,
          "old_text": "child->as<ASTColumnsRegexpMatcher>()",
          "new_text": null,
          "old_line_content": "            if (child->as<ASTAsterisk>() || child->as<ASTColumnsListMatcher>() || child->as<ASTColumnsRegexpMatcher>())",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 222,
          "old_api": "empty",
          "new_api": null,
          "old_text": "tables_with_columns.empty()",
          "new_text": null,
          "old_line_content": "                if (tables_with_columns.empty())",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 95,
          "old_api": "node->as<ASTTableJoin>()",
          "new_api": null,
          "old_text": "node->as<ASTTableJoin>()",
          "new_text": null,
          "old_line_content": "    if (node->as<ASTQualifiedAsterisk>() || node->as<ASTTableJoin>())",
          "new_line_content": "    /// Processed nodes. Do not go into children.",
          "content_same": false
        },
        {
          "line": 351,
          "old_api": "IdentifierSemantic::setColumnLongName(identifier, remote_table)",
          "new_api": null,
          "old_text": "IdentifierSemantic::setColumnLongName(identifier, remote_table)",
          "new_text": null,
          "old_line_content": "            IdentifierSemantic::setColumnLongName(identifier, remote_table);",
          "new_line_content": "        case IdentifierSemantic::ColumnMatch::DBAndTable:",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": "child->as<ASTQualifiedAsterisk>()",
          "new_api": null,
          "old_text": "child->as<ASTQualifiedAsterisk>()",
          "new_text": null,
          "old_line_content": "            else if (const auto * qa = child->as<ASTQualifiedAsterisk>())",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 228,
          "old_api": "visit",
          "new_api": null,
          "old_text": "visit(*qa, child, data)",
          "new_text": null,
          "old_line_content": "                visit(*qa, child, data); /// check if it's OK before rewrite",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 376,
          "old_api": "IdentifierSemantic::getMembership(identifier)",
          "new_api": null,
          "old_text": "IdentifierSemantic::getMembership(identifier)",
          "new_text": null,
          "old_line_content": "        if (IdentifierSemantic::getMembership(identifier))",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": "ast->as<ASTIdentifier>()",
          "new_api": null,
          "old_text": "ast->as<ASTIdentifier>()",
          "new_text": null,
          "old_line_content": "    if (auto * t = ast->as<ASTIdentifier>())",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 361,
          "old_api": "child->as<ASTSelectWithUnionQuery>()",
          "new_api": null,
          "old_text": "child->as<ASTSelectWithUnionQuery>()",
          "new_text": null,
          "old_line_content": "    if (child->as<ASTSelectWithUnionQuery>())",
          "new_line_content": "    /// Do not go into subqueries",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": "swap",
          "new_api": null,
          "old_text": "old_children.swap(node.children)",
          "new_text": null,
          "old_line_content": "            old_children.swap(node.children);",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 368,
          "old_api": "ast->as<ASTIdentifier>()",
          "new_api": null,
          "old_text": "ast->as<ASTIdentifier>()",
          "new_text": null,
          "old_line_content": "    if (auto * t = ast->as<ASTIdentifier>())",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": "child->as<ASTAsterisk>()",
          "new_api": null,
          "old_text": "child->as<ASTAsterisk>()",
          "new_text": null,
          "old_line_content": "        if (const auto * asterisk = child->as<ASTAsterisk>())",
          "new_line_content": "        ASTs columns;",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": "IdentifierSemantic::getColumnName(identifier)",
          "new_api": null,
          "old_text": "IdentifierSemantic::getColumnName(identifier)",
          "new_text": null,
          "old_line_content": "    if (IdentifierSemantic::getColumnName(identifier))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": "IdentifierSemantic::getColumnName(identifier)",
          "new_api": null,
          "old_text": "IdentifierSemantic::getColumnName(identifier)",
          "new_text": null,
          "old_line_content": "    if (IdentifierSemantic::getColumnName(identifier))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 120,
          "old_api": "shortName",
          "new_api": null,
          "old_text": "identifier.shortName()",
          "new_text": null,
          "old_line_content": "        String short_name = identifier.shortName();",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": "restoreTable",
          "new_api": null,
          "old_text": "identifier.restoreTable()",
          "new_text": null,
          "old_line_content": "            identifier.restoreTable();  // TODO(ilezhankin): should restore qualified name here - why exactly here?",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": "contains",
          "new_api": null,
          "old_text": "data.join_using_columns.contains(column.name)",
          "new_text": null,
          "old_line_content": "                        if (first_table || !data.join_using_columns.contains(column.name))",
          "new_line_content": "                    {",
          "content_same": false
        },
        {
          "line": 125,
          "old_api": "unknownColumn",
          "new_api": null,
          "old_text": "data.unknownColumn(table_pos, identifier)",
          "new_text": null,
          "old_line_content": "            if (data.unknownColumn(table_pos, identifier))",
          "new_line_content": "            size_t table_pos = *best_pos;",
          "content_same": false
        },
        {
          "line": 127,
          "old_api": "getQualifiedNamePrefix",
          "new_api": null,
          "old_text": "data.tables[table_pos].table.getQualifiedNamePrefix(false)",
          "new_text": null,
          "old_line_content": "                String table_name = data.tables[table_pos].table.getQualifiedNamePrefix(false);",
          "new_line_content": "            {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 36,
      "total_additions": 62,
      "total_deletions": 61,
      "total_api_changes": 159
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 159,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          52
        ]
      }
    },
    "api_calls_before": 145,
    "api_calls_after": 145,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 1,
      "total_diff_lines": 17
    }
  }
}