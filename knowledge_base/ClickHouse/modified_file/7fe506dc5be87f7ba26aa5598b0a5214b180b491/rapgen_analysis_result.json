{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/7fe506dc5be87f7ba26aa5598b0a5214b180b491",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/7fe506dc5be87f7ba26aa5598b0a5214b180b491/before.h",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/7fe506dc5be87f7ba26aa5598b0a5214b180b491/after.h",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ClickHouse/modified_file/7fe506dc5be87f7ba26aa5598b0a5214b180b491/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1179,
          "old_api": "insertFrom",
          "new_api": "reinterpret_cast<AggregateFunctionGroupBitmapData<T> *>(data_ptr_0)",
          "old_text": "col_to->insertFrom(data_ptr_0)",
          "new_text": "reinterpret_cast<AggregateFunctionGroupBitmapData<T> *>(data_ptr_0)",
          "old_line_content": "            col_to->insertFrom(data_ptr_0);",
          "new_line_content": "            auto && bm_1 = reinterpret_cast<AggregateFunctionGroupBitmapData<T> *>(data_ptr_0);",
          "content_same": false
        },
        {
          "line": 1180,
          "old_api": "getData",
          "new_api": "reinterpret_cast<AggregateFunctionGroupBitmapData<T> *>(data_ptr_1)",
          "old_text": "col_to->getData()",
          "new_text": "reinterpret_cast<AggregateFunctionGroupBitmapData<T> *>(data_ptr_1)",
          "old_line_content": "            AggregateFunctionGroupBitmapData<T> & bitmap_data_1 = *reinterpret_cast<AggregateFunctionGroupBitmapData<T> *>(col_to->getData()[i]);",
          "new_line_content": "            auto && bm_2 = reinterpret_cast<AggregateFunctionGroupBitmapData<T> *>(data_ptr_1);",
          "content_same": false
        },
        {
          "line": 1182,
          "old_api": "reinterpret_cast<const AggregateFunctionGroupBitmapData<T> *>(data_ptr_1)",
          "new_api": "isSmall",
          "old_text": "reinterpret_cast<const AggregateFunctionGroupBitmapData<T> *>(data_ptr_1)",
          "new_text": "bm_2->rbs.isSmall()",
          "old_line_content": "                = *reinterpret_cast<const AggregateFunctionGroupBitmapData<T> *>(data_ptr_1);",
          "new_line_content": "            auto need_exchange = (name == NameBitmapAnd::name) && bm_1->rbs.isLarge() && bm_2->rbs.isSmall();",
          "content_same": false
        },
        {
          "line": 1183,
          "old_api": "Impl<T>::apply(bitmap_data_1, bitmap_data_2)",
          "new_api": "insertFrom",
          "old_text": "Impl<T>::apply(bitmap_data_1, bitmap_data_2)",
          "new_text": "col_to->insertFrom(need_exchange ? data_ptr_1 : data_ptr_0)",
          "old_line_content": "            Impl<T>::apply(bitmap_data_1, bitmap_data_2);",
          "new_line_content": "            col_to->insertFrom(need_exchange ? data_ptr_1 : data_ptr_0);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1184,
          "old_api": null,
          "new_api": "getData",
          "old_text": null,
          "new_text": "col_to->getData()",
          "old_line_content": "        }",
          "new_line_content": "            AggregateFunctionGroupBitmapData<T> & bitmap_data_1 = *reinterpret_cast<AggregateFunctionGroupBitmapData<T> *>(col_to->getData()[i]);",
          "content_same": false
        },
        {
          "line": 1186,
          "old_api": null,
          "new_api": "reinterpret_cast<const AggregateFunctionGroupBitmapData<T> *>(need_exchange ? data_ptr_0 : data_ptr_1)",
          "old_text": null,
          "new_text": "reinterpret_cast<const AggregateFunctionGroupBitmapData<T> *>(need_exchange ? data_ptr_0 : data_ptr_1)",
          "old_line_content": "    }",
          "new_line_content": "            = *reinterpret_cast<const AggregateFunctionGroupBitmapData<T> *>(need_exchange ? data_ptr_0 : data_ptr_1);",
          "content_same": false
        },
        {
          "line": 1187,
          "old_api": null,
          "new_api": "Impl<T>::apply(bitmap_data_1, bitmap_data_2)",
          "old_text": null,
          "new_text": "Impl<T>::apply(bitmap_data_1, bitmap_data_2)",
          "old_line_content": "};",
          "new_line_content": "            Impl<T>::apply(bitmap_data_1, bitmap_data_2);",
          "content_same": false
        },
        {
          "line": 1258,
          "old_api": null,
          "new_api": "constexpr",
          "old_text": null,
          "new_text": "constexpr",
          "old_line_content": "using FunctionBitmapXor = FunctionBitmap<BitmapXorImpl, NameBitmapXor>;",
          "new_line_content": "    static constexpr auto name = \"bitmapAndnot\";",
          "content_same": false
        },
        {
          "line": 1195,
          "old_api": null,
          "new_api": "constexpr",
          "old_text": null,
          "new_text": "constexpr",
          "old_line_content": "struct NameBitmapToArray",
          "new_line_content": "    static constexpr auto name = \"bitmapBuild\";",
          "content_same": false
        },
        {
          "line": 1231,
          "old_api": null,
          "new_api": "constexpr",
          "old_text": null,
          "new_text": "constexpr",
          "old_line_content": "using FunctionBitmapMin = FunctionBitmapSelfCardinalityImpl<BitmapMinImpl>;",
          "new_line_content": "    static constexpr auto name = \"bitmapHasAny\";",
          "content_same": false
        },
        {
          "line": 1201,
          "old_api": null,
          "new_api": "constexpr",
          "old_text": null,
          "new_text": "constexpr",
          "old_line_content": "struct NameBitmapCardinality",
          "new_line_content": "    static constexpr auto name = \"bitmapToArray\";",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1242,
          "old_api": "constexpr",
          "new_api": null,
          "old_text": "constexpr",
          "new_text": null,
          "old_line_content": "    static constexpr auto name = \"bitmapAnd\";",
          "new_line_content": "using FunctionBitmapHasAny = FunctionBitmapCardinality<BitmapHasAnyImpl, NameBitmapHasAny, UInt8>;",
          "content_same": false
        },
        {
          "line": 1203,
          "old_api": "constexpr",
          "new_api": null,
          "old_text": "constexpr",
          "new_text": null,
          "old_line_content": "    static constexpr auto name = \"bitmapCardinality\";",
          "new_line_content": "using FunctionBitmapToArray = FunctionBitmapToArrayImpl<NameBitmapToArray>;",
          "content_same": false
        },
        {
          "line": 1197,
          "old_api": "constexpr",
          "new_api": null,
          "old_text": "constexpr",
          "new_text": null,
          "old_line_content": "    static constexpr auto name = \"bitmapToArray\";",
          "new_line_content": "using FunctionBitmapBuild = FunctionBitmapBuildImpl<NameBitmapBuild>;",
          "content_same": false
        },
        {
          "line": 1191,
          "old_api": "constexpr",
          "new_api": null,
          "old_text": "constexpr",
          "new_text": null,
          "old_line_content": "    static constexpr auto name = \"bitmapBuild\";",
          "new_line_content": "};",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 4,
      "total_additions": 7,
      "total_deletions": 4,
      "total_api_changes": 15
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 6,
        "api_related_lines": 15,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          1181
        ]
      }
    },
    "api_calls_before": 538,
    "api_calls_after": 542,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 2,
      "total_diff_lines": 22
    }
  }
}