{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/esp-idf/modified_file/58d222e66c773cecb01ccd1d2e52d18dd43aa432",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/esp-idf/modified_file/58d222e66c773cecb01ccd1d2e52d18dd43aa432/before.h",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/esp-idf/modified_file/58d222e66c773cecb01ccd1d2e52d18dd43aa432/after.h",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/esp-idf/modified_file/58d222e66c773cecb01ccd1d2e52d18dd43aa432/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 306,
          "old_api": "REGI2C_READ",
          "new_api": "REGI2C_WRITE",
          "old_text": "REGI2C_READ(I2C_MPLL, I2C_MPLL_DIV_REG_ADDR)",
          "new_text": "REGI2C_WRITE(I2C_MPLL, I2C_MPLL_DIV_REG_ADDR, val)",
          "old_line_content": "    uint32_t val = REGI2C_READ(I2C_MPLL, I2C_MPLL_DIV_REG_ADDR);",
          "new_line_content": "    REGI2C_WRITE(I2C_MPLL, I2C_MPLL_DIV_REG_ADDR, val);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 384,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param divider Divider. (PCR_LS_DIV_NUM + 1) * (PCR_AHB_LS_DIV_NUM + 1) = divider.",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_ahb_set_ls_divider(uint32_t divider)",
          "content_same": false
        },
        {
          "line": 514,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param divider Divider of RC_FAST_CLK. Usually this divider is set to 1 (reg. value is 0) in bootloader stage.",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_rc_fast_set_divider(uint32_t divider)",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @return Divider. Divider = (PCR_HS_DIV_NUM + 1) * (PCR_AHB_HS_DIV_NUM + 1).",
          "new_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_ahb_get_hs_divider(void)",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @return Divider. Divider = (CK8M_DIV_SEL + 1).",
          "new_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_rc_fast_get_divider(void)",
          "content_same": false
        },
        {
          "line": 404,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @return Divider. Divider = (PCR_LS_DIV_NUM + 1) * (PCR_AHB_LS_DIV_NUM + 1).",
          "new_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_ahb_get_ls_divider(void)",
          "content_same": false
        },
        {
          "line": 535,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param divider Divider of RC_SLOW_CLK. Usually this divider is set to 1 (reg. value is 0) in bootloader stage.",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_rc_slow_set_divider(uint32_t divider)",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param divider Divider. PCR_APB_DIV_NUM = divider - 1.",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_apb_set_divider(uint32_t divider)",
          "content_same": false
        },
        {
          "line": 550,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * in the ROM code.",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_xtal_store_freq_mhz(uint32_t xtal_freq_mhz)",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @return Divider. Divider = (PCR_APB_DIV_NUM + 1).",
          "new_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_apb_get_divider(void)",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param divider Divider.",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_mspi_fast_set_hs_divider(uint32_t divider)",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @return XTAL frequency, in MHz. Returns 0 if value in reg is invalid.",
          "new_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_xtal_load_freq_mhz(void)",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param in_sel One of the clock sources in soc_cpu_clk_src_t",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_cpu_set_src(soc_cpu_clk_src_t in_sel)",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param divider Divider.",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_mspi_fast_set_ls_divider(uint32_t divider)",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param cal_value The calibration value of slow clock period in microseconds, in Q13.19 fixed point format",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_rtc_slow_store_cal(uint32_t cal_value)",
          "content_same": false
        },
        {
          "line": 324,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @return Currently selected clock source (one of soc_cpu_clk_src_t values)",
          "new_line_content": "static inline __attribute__((always_inline)) soc_cpu_clk_src_t clk_ll_cpu_get_src(void)",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param in_sel One of the 32kHz clock sources (RC32K_CLK, XTAL32K_CLK, OSC_SLOW_CLK)",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_32k_calibration_set_target(soc_rtc_slow_clk_src_t in_sel)",
          "content_same": false
        },
        {
          "line": 587,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @return The calibration value of slow clock period in microseconds, in Q13.19 fixed point format",
          "new_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_rtc_slow_load_cal(void)",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param divider Divider. (PCR_HS_DIV_NUM + 1) * (PCR_CPU_HS_DIV_NUM + 1) = divider.",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_cpu_set_hs_divider(uint32_t divider)",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @return soc_rtc_slow_clk_src_t Currently selected calibration 32kHz clock (one of the 32kHz clocks)",
          "new_line_content": "static inline __attribute__((always_inline)) soc_rtc_slow_clk_src_t clk_ll_32k_calibration_get_target(void)",
          "content_same": false
        },
        {
          "line": 344,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param divider Divider. (PCR_LS_DIV_NUM + 1) * (PCR_CPU_LS_DIV_NUM + 1) = divider.",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_cpu_set_ls_divider(uint32_t divider)",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param in_sel One of the clock sources in soc_rtc_slow_clk_src_t",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_rtc_slow_set_src(soc_rtc_slow_clk_src_t in_sel)",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @return Divider. Divider = (PCR_HS_DIV_NUM + 1) * (PCR_CPU_HS_DIV_NUM + 1).",
          "new_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_cpu_get_hs_divider(void)",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @return Currently selected clock source (one of soc_rtc_slow_clk_src_t values)",
          "new_line_content": "static inline __attribute__((always_inline)) soc_rtc_slow_clk_src_t clk_ll_rtc_slow_get_src(void)",
          "content_same": false
        },
        {
          "line": 364,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @return Divider. Divider = (PCR_LS_DIV_NUM + 1) * (PCR_CPU_LS_DIV_NUM + 1).",
          "new_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_cpu_get_ls_divider(void)",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param in_sel One of the clock sources in soc_rtc_fast_clk_src_t",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_rtc_fast_set_src(soc_rtc_fast_clk_src_t in_sel)",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @param divider Divider. (PCR_HS_DIV_NUM + 1) * (PCR_AHB_HS_DIV_NUM + 1) = divider.",
          "new_line_content": "static inline __attribute__((always_inline)) void clk_ll_ahb_set_hs_divider(uint32_t divider)",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": null,
          "new_api": "__attribute__",
          "old_text": null,
          "new_text": "__attribute__((always_inline))",
          "old_line_content": " * @return Currently selected clock source (one of soc_rtc_fast_clk_src_t values)",
          "new_line_content": "static inline __attribute__((always_inline)) soc_rtc_fast_clk_src_t clk_ll_rtc_fast_get_src(void)",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 386,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_ahb_set_ls_divider(uint32_t divider)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 516,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_rc_fast_set_divider(uint32_t divider)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_ahb_get_hs_divider(void)",
          "new_line_content": "    return 0;",
          "content_same": false
        },
        {
          "line": 526,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_rc_fast_get_divider(void)",
          "new_line_content": "    // No divider on the target, always return divider = 1",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_ahb_get_ls_divider(void)",
          "new_line_content": "    return 1;",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_rc_slow_set_divider(uint32_t divider)",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_apb_set_divider(uint32_t divider)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_xtal_store_freq_mhz(uint32_t xtal_freq_mhz)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_apb_get_divider(void)",
          "new_line_content": "    return 1;",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": "REGI2C_WRITE",
          "new_api": null,
          "old_text": "REGI2C_WRITE(I2C_MPLL, I2C_MPLL_DIV_REG_ADDR, val)",
          "new_text": null,
          "old_line_content": "    REGI2C_WRITE(I2C_MPLL, I2C_MPLL_DIV_REG_ADDR, val);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 436,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_mspi_fast_set_hs_divider(uint32_t divider)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_xtal_load_freq_mhz(void)",
          "new_line_content": "    return 40;",
          "content_same": false
        },
        {
          "line": 316,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_cpu_set_src(soc_cpu_clk_src_t in_sel)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 446,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_mspi_fast_set_ls_divider(uint32_t divider)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 578,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_rtc_slow_store_cal(uint32_t cal_value)",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 326,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) soc_cpu_clk_src_t clk_ll_cpu_get_src(void)",
          "new_line_content": "    return SOC_CPU_CLK_SRC_XTAL;",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_32k_calibration_set_target(soc_rtc_slow_clk_src_t in_sel)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_rtc_slow_load_cal(void)",
          "new_line_content": "    return 0;",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_cpu_set_hs_divider(uint32_t divider)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) soc_rtc_slow_clk_src_t clk_ll_32k_calibration_get_target(void)",
          "new_line_content": "    return (soc_rtc_slow_clk_src_t)0;",
          "content_same": false
        },
        {
          "line": 346,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_cpu_set_ls_divider(uint32_t divider)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_rtc_slow_set_src(soc_rtc_slow_clk_src_t in_sel)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 356,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_cpu_get_hs_divider(void)",
          "new_line_content": "    return 0;",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) soc_rtc_slow_clk_src_t clk_ll_rtc_slow_get_src(void)",
          "new_line_content": "    return (soc_rtc_slow_clk_src_t)0;",
          "content_same": false
        },
        {
          "line": 366,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) uint32_t clk_ll_cpu_get_ls_divider(void)",
          "new_line_content": "    return 0;",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_rtc_fast_set_src(soc_rtc_fast_clk_src_t in_sel)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 376,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) void clk_ll_ahb_set_hs_divider(uint32_t divider)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": "__attribute__",
          "new_api": null,
          "old_text": "__attribute__((always_inline))",
          "new_text": null,
          "old_line_content": "static inline __attribute__((always_inline)) soc_rtc_fast_clk_src_t clk_ll_rtc_fast_get_src(void)",
          "new_line_content": "    return (soc_rtc_fast_clk_src_t)0;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 1,
      "total_additions": 27,
      "total_deletions": 28,
      "total_api_changes": 56
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 56,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          305,
          307
        ]
      }
    },
    "api_calls_before": 58,
    "api_calls_after": 57,
    "diff_info": {
      "added_lines": 1,
      "removed_lines": 3,
      "total_diff_lines": 16
    }
  }
}