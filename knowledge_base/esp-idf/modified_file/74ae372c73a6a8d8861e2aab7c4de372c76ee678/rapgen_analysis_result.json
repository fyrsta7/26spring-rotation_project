{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/esp-idf/modified_file/74ae372c73a6a8d8861e2aab7c4de372c76ee678",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/esp-idf/modified_file/74ae372c73a6a8d8861e2aab7c4de372c76ee678/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/esp-idf/modified_file/74ae372c73a6a8d8861e2aab7c4de372c76ee678/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/esp-idf/modified_file/74ae372c73a6a8d8861e2aab7c4de372c76ee678/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 705,
          "old_api": "calloc",
          "new_api": "MIN",
          "old_text": "calloc(count, sizeof(wifi_ap_record_t))",
          "new_text": "MIN(count, MAX_SCAN_RESULTS)",
          "old_line_content": "    prov_ctx->ap_list[curr_channel] = (wifi_ap_record_t *) calloc(count, sizeof(wifi_ap_record_t));",
          "new_line_content": "    uint16_t get_count = MIN(count, MAX_SCAN_RESULTS);",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": "ESP_LOGE",
          "new_api": "esp_wifi_scan_get_ap_records",
          "old_text": "ESP_LOGE(TAG, \"Failed to get scanned AP records\")",
          "new_text": "esp_wifi_scan_get_ap_records(&get_count, prov_ctx->ap_list[curr_channel])",
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to get scanned AP records\");",
          "new_line_content": "    if (esp_wifi_scan_get_ap_records(&get_count, prov_ctx->ap_list[curr_channel]) != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 899,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 905,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGD",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGD(TAG, \"Scan already running\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGD(TAG, \"Scan already running\");",
          "content_same": false
        },
        {
          "line": 939,
          "old_api": "ESP_LOGE",
          "new_api": "esp_wifi_scan_start",
          "old_text": "ESP_LOGE(TAG, \"Failed to start scan\")",
          "new_text": "esp_wifi_scan_start(&prov_ctx->scan_cfg, false)",
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to start scan\");",
          "new_line_content": "    if (esp_wifi_scan_start(&prov_ctx->scan_cfg, false) != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 940,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Failed to start scan\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to start scan\");",
          "content_same": false
        },
        {
          "line": 978,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 998,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 1023,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 1078,
          "old_api": "ESP_LOGD",
          "new_api": "strlen",
          "old_text": "ESP_LOGD(TAG, \"%s Wi-Fi SSID     : %.*s\", pretext,\n             strnlen((const char *) sta.ssid, sizeof(sta.ssid)), (const char *) sta.ssid)",
          "new_text": "strlen((const char*) sta.password)",
          "old_line_content": "    ESP_LOGD(TAG, \"%s Wi-Fi SSID     : %.*s\", pretext,",
          "new_line_content": "    size_t passlen = strlen((const char*) sta.password);",
          "content_same": false
        },
        {
          "line": 1079,
          "old_api": "strnlen",
          "new_api": "ESP_LOGD",
          "old_text": "strnlen((const char *) sta.ssid, sizeof(sta.ssid))",
          "new_text": "ESP_LOGD(TAG, \"%s Wi-Fi SSID     : %.*s\", pretext,\n             strnlen((const char *) sta.ssid, sizeof(sta.ssid)), (const char *) sta.ssid)",
          "old_line_content": "             strnlen((const char *) sta.ssid, sizeof(sta.ssid)), (const char *) sta.ssid);",
          "new_line_content": "    ESP_LOGD(TAG, \"%s Wi-Fi SSID     : %.*s\", pretext,",
          "content_same": false
        },
        {
          "line": 1084,
          "old_api": "ESP_LOGD",
          "new_api": "memset",
          "old_text": "ESP_LOGD(TAG, \"%s Wi-Fi Password : %s\", pretext, (const char *) sta.password)",
          "new_text": "memset(sta.password + (passlen > 3), '*', passlen - 2*(passlen > 3))",
          "old_line_content": "        ESP_LOGD(TAG, \"%s Wi-Fi Password : %s\", pretext, (const char *) sta.password);",
          "new_line_content": "        memset(sta.password + (passlen > 3), '*', passlen - 2*(passlen > 3));",
          "content_same": false
        },
        {
          "line": 1117,
          "old_api": "ESP_LOGE",
          "new_api": "esp_wifi_connect",
          "old_text": "ESP_LOGE(TAG, \"Failed to connect Wi-Fi\")",
          "new_text": "esp_wifi_connect()",
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to connect Wi-Fi\");",
          "new_line_content": "    if (esp_wifi_connect() != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1131,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Invalid state of Provisioning app\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Invalid state of Provisioning app\");",
          "content_same": false
        },
        {
          "line": 1136,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Wi-Fi credentials already received by provisioning app\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Wi-Fi credentials already received by provisioning app\");",
          "content_same": false
        },
        {
          "line": 1143,
          "old_api": "ESP_LOGE",
          "new_api": "esp_wifi_set_mode",
          "old_text": "ESP_LOGE(TAG, \"Failed to set Wi-Fi mode\")",
          "new_text": "esp_wifi_set_mode(prov_ctx->mgr_config.scheme.wifi_mode)",
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to set Wi-Fi mode\");",
          "new_line_content": "    if (esp_wifi_set_mode(prov_ctx->mgr_config.scheme.wifi_mode) != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1144,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Failed to set Wi-Fi mode\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to set Wi-Fi mode\");",
          "content_same": false
        },
        {
          "line": 1156,
          "old_api": "ESP_LOGE",
          "new_api": "esp_wifi_set_storage",
          "old_text": "ESP_LOGE(TAG, \"Failed to set storage Wi-Fi\")",
          "new_text": "esp_wifi_set_storage(WIFI_STORAGE_FLASH)",
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to set storage Wi-Fi\");",
          "new_line_content": "    if (esp_wifi_set_storage(WIFI_STORAGE_FLASH) != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1157,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Failed to set storage Wi-Fi\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to set storage Wi-Fi\");",
          "content_same": false
        },
        {
          "line": 1163,
          "old_api": "ESP_LOGE",
          "new_api": "esp_wifi_set_config",
          "old_text": "ESP_LOGE(TAG, \"Failed to set Wi-Fi configuration\")",
          "new_text": "esp_wifi_set_config(WIFI_IF_STA, wifi_cfg)",
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to set Wi-Fi configuration\");",
          "new_line_content": "    if (esp_wifi_set_config(WIFI_IF_STA, wifi_cfg) != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1164,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Failed to set Wi-Fi configuration\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to set Wi-Fi configuration\");",
          "content_same": false
        },
        {
          "line": 1170,
          "old_api": "ESP_LOGE",
          "new_api": "esp_timer_start_once",
          "old_text": "ESP_LOGE(TAG, \"Failed to start Wi-Fi connect timer\")",
          "new_text": "esp_timer_start_once(prov_ctx->wifi_connect_timer, 1000 * 1000U)",
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to start Wi-Fi connect timer\");",
          "new_line_content": "    if (esp_timer_start_once(prov_ctx->wifi_connect_timer, 1000 * 1000U) != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1171,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Failed to start Wi-Fi connect timer\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to start Wi-Fi connect timer\");",
          "content_same": false
        },
        {
          "line": 1180,
          "old_api": "RELEASE_LOCK",
          "new_api": "execute_event_cb",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "execute_event_cb(WIFI_PROV_CRED_RECV, (void *)&wifi_cfg->sta, sizeof(wifi_cfg->sta))",
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    execute_event_cb(WIFI_PROV_CRED_RECV, (void *)&wifi_cfg->sta, sizeof(wifi_cfg->sta));",
          "content_same": false
        },
        {
          "line": 1219,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager already initialized\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager already initialized\");",
          "content_same": false
        },
        {
          "line": 1227,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Error allocating memory for singleton instance\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Error allocating memory for singleton instance\");",
          "content_same": false
        },
        {
          "line": 1302,
          "old_api": "vTaskDelay",
          "new_api": "RELEASE_LOCK",
          "old_text": "vTaskDelay(1000 / portTICK_PERIOD_MS)",
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "            vTaskDelay(1000 / portTICK_PERIOD_MS);",
          "new_line_content": "            RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1331,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGD",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGD(TAG, \"Manager already de-initialized\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGD(TAG, \"Manager already de-initialized\");",
          "content_same": false
        },
        {
          "line": 1366,
          "old_api": "ESP_LOGE",
          "new_api": "esp_event_post",
          "old_text": "ESP_LOGE(TAG, \"Failed to post event WIFI_PROV_END\")",
          "new_text": "esp_event_post(WIFI_PROV_EVENT, WIFI_PROV_END, NULL, 0, portMAX_DELAY)",
          "old_line_content": "            ESP_LOGE(TAG, \"Failed to post event WIFI_PROV_END\");",
          "new_line_content": "        if (esp_event_post(WIFI_PROV_EVENT, WIFI_PROV_END, NULL, 0, portMAX_DELAY) != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1380,
          "old_api": "ESP_LOGE",
          "new_api": "esp_event_post",
          "old_text": "ESP_LOGE(TAG, \"Failed to post event WIFI_PROV_DEINIT\")",
          "new_text": "esp_event_post(WIFI_PROV_EVENT, WIFI_PROV_DEINIT, NULL, 0, portMAX_DELAY)",
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to post event WIFI_PROV_DEINIT\");",
          "new_line_content": "    if (esp_event_post(WIFI_PROV_EVENT, WIFI_PROV_DEINIT, NULL, 0, portMAX_DELAY) != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1397,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 1403,
          "old_api": "RELEASE_LOCK",
          "new_api": "ESP_LOGE",
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": "ESP_LOGE(TAG, \"Provisioning service already started\")",
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning service already started\");",
          "content_same": false
        },
        {
          "line": 1432,
          "old_api": "esp_wifi_get_config",
          "new_api": "memset",
          "old_text": "esp_wifi_get_config(WIFI_IF_STA, &wifi_cfg_old)",
          "new_text": "memset(&wifi_cfg_empty, 0, sizeof(wifi_config_t))",
          "old_line_content": "    esp_wifi_get_config(WIFI_IF_STA, &wifi_cfg_old);",
          "new_line_content": "    memset(&wifi_cfg_empty, 0, sizeof(wifi_config_t));",
          "content_same": false
        },
        {
          "line": 1433,
          "old_api": "esp_wifi_set_storage",
          "new_api": "esp_wifi_get_config",
          "old_text": "esp_wifi_set_storage(WIFI_STORAGE_RAM)",
          "new_text": "esp_wifi_get_config(WIFI_IF_STA, &wifi_cfg_old)",
          "old_line_content": "    ret = esp_wifi_set_storage(WIFI_STORAGE_RAM);",
          "new_line_content": "    esp_wifi_get_config(WIFI_IF_STA, &wifi_cfg_old);",
          "content_same": false
        },
        {
          "line": 1463,
          "old_api": "malloc",
          "new_api": "strlen",
          "old_text": "malloc(prov_ctx->pop.len)",
          "new_text": "strlen(pop)",
          "old_line_content": "        prov_ctx->pop.data = malloc(prov_ctx->pop.len);",
          "new_line_content": "        prov_ctx->pop.len = strlen(pop);",
          "content_same": false
        },
        {
          "line": 1485,
          "old_api": "free",
          "new_api": "ESP_LOGE",
          "old_text": "free((void *)prov_ctx->pop.data)",
          "new_text": "ESP_LOGE(TAG, \"Failed to create Wi-Fi connect timer\")",
          "old_line_content": "        free((void *)prov_ctx->pop.data);",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to create Wi-Fi connect timer\");",
          "content_same": false
        },
        {
          "line": 1501,
          "old_api": "esp_timer_delete",
          "new_api": "ESP_LOGE",
          "old_text": "esp_timer_delete(prov_ctx->wifi_connect_timer)",
          "new_text": "ESP_LOGE(TAG, \"Failed to create auto-stop timer\")",
          "old_line_content": "            esp_timer_delete(prov_ctx->wifi_connect_timer);",
          "new_line_content": "            ESP_LOGE(TAG, \"Failed to create auto-stop timer\");",
          "content_same": false
        },
        {
          "line": 1502,
          "old_api": "free",
          "new_api": "esp_timer_delete",
          "old_text": "free((void *)prov_ctx->pop.data)",
          "new_text": "esp_timer_delete(prov_ctx->wifi_connect_timer)",
          "old_line_content": "            free((void *)prov_ctx->pop.data);",
          "new_line_content": "            esp_timer_delete(prov_ctx->wifi_connect_timer);",
          "content_same": false
        },
        {
          "line": 1518,
          "old_api": "free",
          "new_api": "esp_timer_delete",
          "old_text": "free((void *)prov_ctx->pop.data)",
          "new_text": "esp_timer_delete(prov_ctx->wifi_connect_timer)",
          "old_line_content": "        free((void *)prov_ctx->pop.data);",
          "new_line_content": "        esp_timer_delete(prov_ctx->wifi_connect_timer);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1024,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return rval;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1538,
          "old_api": null,
          "new_api": "esp_wifi_set_storage",
          "old_text": null,
          "new_text": "esp_wifi_set_storage(WIFI_STORAGE_FLASH)",
          "old_line_content": "    }",
          "new_line_content": "        esp_wifi_set_storage(WIFI_STORAGE_FLASH);",
          "content_same": false
        },
        {
          "line": 1540,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "    return ret;",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1031,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "    return rval;",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1547,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 1038,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return ESP_ERR_INVALID_STATE;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 1551,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1042,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "    if (prov_ctx == NULL || state == NULL) {",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1044,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_FAIL;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1559,
          "old_api": null,
          "new_api": "wifi_prov_mgr_stop_service",
          "old_text": null,
          "new_text": "wifi_prov_mgr_stop_service(0)",
          "old_line_content": "",
          "new_line_content": "    wifi_prov_mgr_stop_service(0);",
          "content_same": false
        },
        {
          "line": 1049,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "    return ESP_OK;",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1561,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "}",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1566,
          "old_api": null,
          "new_api": "esp_wifi_restore",
          "old_text": null,
          "new_text": "esp_wifi_restore()",
          "old_line_content": "",
          "new_line_content": "    esp_err_t ret = esp_wifi_restore();",
          "content_same": false
        },
        {
          "line": 1056,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return ESP_ERR_INVALID_STATE;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 1533,
          "old_api": null,
          "new_api": "esp_wifi_set_config",
          "old_text": null,
          "new_text": "esp_wifi_set_config(WIFI_IF_STA, &wifi_cfg_old)",
          "old_line_content": "    }",
          "new_line_content": "        esp_wifi_set_config(WIFI_IF_STA, &wifi_cfg_old);",
          "content_same": false
        },
        {
          "line": 1569,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"esp_wifi_restore fail, ret is %d\", ret)",
          "old_line_content": "        ret = ESP_FAIL;",
          "new_line_content": "        ESP_LOGE(TAG, \"esp_wifi_restore fail, ret is %d\", ret);",
          "content_same": false
        },
        {
          "line": 1060,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "    if (prov_ctx == NULL || reason == NULL) {",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1062,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_FAIL;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1067,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_FAIL;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1579,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return ESP_ERR_INVALID_STATE;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 1583,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1072,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "    return ESP_OK;",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1587,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Trying reset when not in failure state. Current state: %d\", prov_ctx->prov_state)",
          "old_line_content": "        err = ESP_ERR_INVALID_STATE;",
          "new_line_content": "        ESP_LOGE(TAG, \"Trying reset when not in failure state. Current state: %d\", prov_ctx->prov_state);",
          "content_same": false
        },
        {
          "line": 1080,
          "old_api": null,
          "new_api": "strnlen",
          "old_text": null,
          "new_text": "strnlen((const char *) sta.ssid, sizeof(sta.ssid))",
          "old_line_content": "",
          "new_line_content": "             strnlen((const char *) sta.ssid, sizeof(sta.ssid)), (const char *) sta.ssid);",
          "content_same": false
        },
        {
          "line": 1594,
          "old_api": null,
          "new_api": "esp_wifi_set_config",
          "old_text": null,
          "new_text": "esp_wifi_set_config(WIFI_IF_STA, &wifi_cfg)",
          "old_line_content": "    if (err != ESP_OK) {",
          "new_line_content": "    err = esp_wifi_set_config(WIFI_IF_STA, &wifi_cfg);",
          "content_same": false
        },
        {
          "line": 1596,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Failed to set wifi config, 0x%x\", err)",
          "old_line_content": "        goto exit;",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to set wifi config, 0x%x\", err);",
          "content_same": false
        },
        {
          "line": 1085,
          "old_api": null,
          "new_api": "ESP_LOGD",
          "old_text": null,
          "new_text": "ESP_LOGD(TAG, \"%s Wi-Fi Password : %s\", pretext, (const char *) sta.password)",
          "old_line_content": "    }",
          "new_line_content": "        ESP_LOGD(TAG, \"%s Wi-Fi Password : %s\", pretext, (const char *) sta.password);",
          "content_same": false
        },
        {
          "line": 1603,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "    return err;",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1098,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return ESP_ERR_INVALID_STATE;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 1104,
          "old_api": null,
          "new_api": "esp_wifi_get_config",
          "old_text": null,
          "new_text": "esp_wifi_get_config(WIFI_IF_STA, &wifi_cfg)",
          "old_line_content": "        return ESP_FAIL;",
          "new_line_content": "    if (esp_wifi_get_config(WIFI_IF_STA, &wifi_cfg) != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1108,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen((const char *) wifi_cfg.sta.ssid)",
          "old_line_content": "        *provisioned = true;",
          "new_line_content": "    if (strlen((const char *) wifi_cfg.sta.ssid)) {",
          "content_same": false
        },
        {
          "line": 1110,
          "old_api": null,
          "new_api": "debug_print_wifi_credentials",
          "old_text": null,
          "new_text": "debug_print_wifi_credentials(wifi_cfg.sta, \"Found\")",
          "old_line_content": "    }",
          "new_line_content": "        debug_print_wifi_credentials(wifi_cfg.sta, \"Found\");",
          "content_same": false
        },
        {
          "line": 1118,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Failed to connect Wi-Fi\")",
          "old_line_content": "    }",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to connect Wi-Fi\");",
          "content_same": false
        },
        {
          "line": 1125,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return ESP_ERR_INVALID_STATE;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 1129,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "    if (!prov_ctx) {",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1132,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_FAIL;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1137,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_FAIL;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1140,
          "old_api": null,
          "new_api": "debug_print_wifi_credentials",
          "old_text": null,
          "new_text": "debug_print_wifi_credentials(wifi_cfg->sta, \"Received\")",
          "old_line_content": "",
          "new_line_content": "    debug_print_wifi_credentials(wifi_cfg->sta, \"Received\");",
          "content_same": false
        },
        {
          "line": 1145,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_FAIL;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1158,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_FAIL;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1165,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_FAIL;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1172,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_FAIL;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1181,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1194,
          "old_api": null,
          "new_api": "xSemaphoreCreateMutex",
          "old_text": null,
          "new_text": "xSemaphoreCreateMutex()",
          "old_line_content": "        if (!prov_ctx_lock) {",
          "new_line_content": "        prov_ctx_lock = xSemaphoreCreateMutex();",
          "content_same": false
        },
        {
          "line": 1196,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Failed to create mutex\")",
          "old_line_content": "            return ESP_ERR_NO_MEM;",
          "new_line_content": "            ESP_LOGE(TAG, \"Failed to create mutex\");",
          "content_same": false
        },
        {
          "line": 1217,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "    if (prov_ctx) {",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 706,
          "old_api": null,
          "new_api": "calloc",
          "old_text": null,
          "new_text": "calloc(get_count, sizeof(wifi_ap_record_t))",
          "old_line_content": "    if (!prov_ctx->ap_list[curr_channel]) {",
          "new_line_content": "    prov_ctx->ap_list[curr_channel] = (wifi_ap_record_t *) calloc(get_count, sizeof(wifi_ap_record_t));",
          "content_same": false
        },
        {
          "line": 708,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Failed to allocate memory for AP list\")",
          "old_line_content": "        goto exit;",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to allocate memory for AP list\");",
          "content_same": false
        },
        {
          "line": 1220,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_ERR_INVALID_STATE;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Failed to get scanned AP records\")",
          "old_line_content": "        goto exit;",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to get scanned AP records\");",
          "content_same": false
        },
        {
          "line": 1225,
          "old_api": null,
          "new_api": "calloc",
          "old_text": null,
          "new_text": "calloc(1, sizeof(struct wifi_prov_mgr_ctx))",
          "old_line_content": "    if (!prov_ctx) {",
          "new_line_content": "    prov_ctx = (struct wifi_prov_mgr_ctx *) calloc(1, sizeof(struct wifi_prov_mgr_ctx));",
          "content_same": false
        },
        {
          "line": 1228,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_ERR_NO_MEM;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 718,
          "old_api": null,
          "new_api": "ESP_LOGD",
          "old_text": null,
          "new_text": "ESP_LOGD(TAG, \"Scan results for channel %d :\", curr_channel)",
          "old_line_content": "    } else {",
          "new_line_content": "        ESP_LOGD(TAG, \"Scan results for channel %d :\", curr_channel);",
          "content_same": false
        },
        {
          "line": 720,
          "old_api": null,
          "new_api": "ESP_LOGD",
          "old_text": null,
          "new_text": "ESP_LOGD(TAG, \"Scan results :\")",
          "old_line_content": "    }",
          "new_line_content": "        ESP_LOGD(TAG, \"Scan results :\");",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": null,
          "new_api": "ESP_LOGD",
          "old_text": null,
          "new_text": "ESP_LOGD(TAG, \"\\tS.N. %-32s %-12s %s %s\", \"SSID\", \"BSSID\", \"RSSI\", \"AUTH\")",
          "old_line_content": "    for (uint8_t i = 0; i < prov_ctx->ap_list_len[curr_channel]; i++) {",
          "new_line_content": "    ESP_LOGD(TAG, \"\\tS.N. %-32s %-12s %s %s\", \"SSID\", \"BSSID\", \"RSSI\", \"AUTH\");",
          "content_same": false
        },
        {
          "line": 724,
          "old_api": null,
          "new_api": "ESP_LOGD",
          "old_text": null,
          "new_text": "ESP_LOGD(TAG, \"\\t[%2d] %-32s %02x%02x%02x%02x%02x%02x %4d %4d\", i,\n                 prov_ctx->ap_list[curr_channel][i].ssid,\n                 prov_ctx->ap_list[curr_channel][i].bssid[0],\n                 prov_ctx->ap_list[curr_channel][i].bssid[1],\n                 prov_ctx->ap_list[curr_channel][i].bssid[2],\n                 prov_ctx->ap_list[curr_channel][i].bssid[3],\n                 prov_ctx->ap_list[curr_channel][i].bssid[4],\n                 prov_ctx->ap_list[curr_channel][i].bssid[5],\n                 prov_ctx->ap_list[curr_channel][i].rssi,\n                 prov_ctx->ap_list[curr_channel][i].authmode)",
          "old_line_content": "                 prov_ctx->ap_list[curr_channel][i].ssid,",
          "new_line_content": "        ESP_LOGD(TAG, \"\\t[%2d] %-32s %02x%02x%02x%02x%02x%02x %4d %4d\", i,",
          "content_same": false
        },
        {
          "line": 1239,
          "old_api": null,
          "new_api": "new_config",
          "old_text": null,
          "new_text": "scheme->new_config()",
          "old_line_content": "    if (!prov_ctx->prov_scheme_config) {",
          "new_line_content": "    prov_ctx->prov_scheme_config = scheme->new_config();",
          "content_same": false
        },
        {
          "line": 1241,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"failed to allocate provisioning scheme configuration\")",
          "old_line_content": "        ret = ESP_ERR_NO_MEM;",
          "new_line_content": "        ESP_LOGE(TAG, \"failed to allocate provisioning scheme configuration\");",
          "content_same": false
        },
        {
          "line": 1246,
          "old_api": null,
          "new_api": "set_config_endpoint",
          "old_text": null,
          "new_text": "scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"prov-scan\", 0xFF50)",
          "old_line_content": "    if (ret != ESP_OK) {",
          "new_line_content": "    ret = scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"prov-scan\", 0xFF50);",
          "content_same": false
        },
        {
          "line": 1248,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"failed to configure Wi-Fi scanning endpoint\")",
          "old_line_content": "        goto exit;",
          "new_line_content": "        ESP_LOGE(TAG, \"failed to configure Wi-Fi scanning endpoint\");",
          "content_same": false
        },
        {
          "line": 1252,
          "old_api": null,
          "new_api": "set_config_endpoint",
          "old_text": null,
          "new_text": "scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"prov-session\", 0xFF51)",
          "old_line_content": "    if (ret != ESP_OK) {",
          "new_line_content": "    ret = scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"prov-session\", 0xFF51);",
          "content_same": false
        },
        {
          "line": 1254,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"failed to configure security endpoint\")",
          "old_line_content": "        goto exit;",
          "new_line_content": "        ESP_LOGE(TAG, \"failed to configure security endpoint\");",
          "content_same": false
        },
        {
          "line": 1258,
          "old_api": null,
          "new_api": "set_config_endpoint",
          "old_text": null,
          "new_text": "scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"prov-config\", 0xFF52)",
          "old_line_content": "    if (ret != ESP_OK) {",
          "new_line_content": "    ret = scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"prov-config\", 0xFF52);",
          "content_same": false
        },
        {
          "line": 1260,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"failed to configure Wi-Fi configuration endpoint\")",
          "old_line_content": "        goto exit;",
          "new_line_content": "        ESP_LOGE(TAG, \"failed to configure Wi-Fi configuration endpoint\");",
          "content_same": false
        },
        {
          "line": 1264,
          "old_api": null,
          "new_api": "set_config_endpoint",
          "old_text": null,
          "new_text": "scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"proto-ver\", 0xFF53)",
          "old_line_content": "    if (ret != ESP_OK) {",
          "new_line_content": "    ret = scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"proto-ver\", 0xFF53);",
          "content_same": false
        },
        {
          "line": 1266,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"failed to configure version endpoint\")",
          "old_line_content": "        goto exit;",
          "new_line_content": "        ESP_LOGE(TAG, \"failed to configure version endpoint\");",
          "content_same": false
        },
        {
          "line": 1281,
          "old_api": null,
          "new_api": "delete_config",
          "old_text": null,
          "new_text": "config.scheme.delete_config(prov_ctx->prov_scheme_config)",
          "old_line_content": "        }",
          "new_line_content": "            config.scheme.delete_config(prov_ctx->prov_scheme_config);",
          "content_same": false
        },
        {
          "line": 1283,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(prov_ctx)",
          "old_line_content": "    } else {",
          "new_line_content": "        free(prov_ctx);",
          "content_same": false
        },
        {
          "line": 1285,
          "old_api": null,
          "new_api": "execute_event_cb",
          "old_text": null,
          "new_text": "execute_event_cb(WIFI_PROV_INIT, NULL, 0)",
          "old_line_content": "    }",
          "new_line_content": "        execute_event_cb(WIFI_PROV_INIT, NULL, 0);",
          "content_same": false
        },
        {
          "line": 774,
          "old_api": null,
          "new_api": "vTaskDelay",
          "old_text": null,
          "new_text": "vTaskDelay(120 / portTICK_PERIOD_MS)",
          "old_line_content": "    }",
          "new_line_content": "        vTaskDelay(120 / portTICK_PERIOD_MS);",
          "content_same": false
        },
        {
          "line": 1287,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "    return ret;",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 777,
          "old_api": null,
          "new_api": "ESP_LOGD",
          "old_text": null,
          "new_text": "ESP_LOGD(TAG, \"Scan starting on channel %u...\", curr_channel)",
          "old_line_content": "    prov_ctx->scan_cfg.channel = curr_channel;",
          "new_line_content": "    ESP_LOGD(TAG, \"Scan starting on channel %u...\", curr_channel);",
          "content_same": false
        },
        {
          "line": 779,
          "old_api": null,
          "new_api": "esp_wifi_scan_start",
          "old_text": null,
          "new_text": "esp_wifi_scan_start(&prov_ctx->scan_cfg, false)",
          "old_line_content": "    if (ret != ESP_OK) {",
          "new_line_content": "    ret = esp_wifi_scan_start(&prov_ctx->scan_cfg, false);",
          "content_same": false
        },
        {
          "line": 781,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Failed to start scan\")",
          "old_line_content": "        prov_ctx->scanning = false;",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to start scan\");",
          "content_same": false
        },
        {
          "line": 1294,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 785,
          "old_api": null,
          "new_api": "ESP_LOGD",
          "old_text": null,
          "new_text": "ESP_LOGD(TAG, \"Scan started\")",
          "old_line_content": "",
          "new_line_content": "    ESP_LOGD(TAG, \"Scan started\");",
          "content_same": false
        },
        {
          "line": 1299,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "        if (prov_ctx &&",
          "new_line_content": "        ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1303,
          "old_api": null,
          "new_api": "vTaskDelay",
          "old_text": null,
          "new_text": "vTaskDelay(1000 / portTICK_PERIOD_MS)",
          "old_line_content": "            continue;",
          "new_line_content": "            vTaskDelay(1000 / portTICK_PERIOD_MS);",
          "content_same": false
        },
        {
          "line": 796,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 1308,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "}",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 799,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1314,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 805,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1318,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 813,
          "old_api": null,
          "new_api": "update_wifi_scan_results",
          "old_text": null,
          "new_text": "update_wifi_scan_results()",
          "old_line_content": "    }",
          "new_line_content": "        update_wifi_scan_results();",
          "content_same": false
        },
        {
          "line": 1326,
          "old_api": null,
          "new_api": "wifi_prov_mgr_stop_service",
          "old_text": null,
          "new_text": "wifi_prov_mgr_stop_service(1)",
          "old_line_content": "",
          "new_line_content": "    bool service_was_running = wifi_prov_mgr_stop_service(1);",
          "content_same": false
        },
        {
          "line": 819,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1332,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 824,
          "old_api": null,
          "new_api": "ESP_LOGI",
          "old_text": null,
          "new_text": "ESP_LOGI(TAG, \"STA Start\")",
          "old_line_content": "        /* Once configuration is received through protocomm,",
          "new_line_content": "        ESP_LOGI(TAG, \"STA Start\");",
          "content_same": false
        },
        {
          "line": 1337,
          "old_api": null,
          "new_api": "cJSON_Delete",
          "old_text": null,
          "new_text": "cJSON_Delete(prov_ctx->app_info_json)",
          "old_line_content": "    }",
          "new_line_content": "        cJSON_Delete(prov_ctx->app_info_json);",
          "content_same": false
        },
        {
          "line": 1341,
          "old_api": null,
          "new_api": "delete_config",
          "old_text": null,
          "new_text": "prov_ctx->mgr_config.scheme.delete_config(prov_ctx->prov_scheme_config)",
          "old_line_content": "    }",
          "new_line_content": "        prov_ctx->mgr_config.scheme.delete_config(prov_ctx->prov_scheme_config);",
          "content_same": false
        },
        {
          "line": 831,
          "old_api": null,
          "new_api": "ESP_LOGI",
          "old_text": null,
          "new_text": "ESP_LOGI(TAG, \"STA Got IP\")",
          "old_line_content": "        /* Station got IP. That means configuration is successful. */",
          "new_line_content": "        ESP_LOGI(TAG, \"STA Got IP\");",
          "content_same": false
        },
        {
          "line": 839,
          "old_api": null,
          "new_api": "ESP_LOGD",
          "old_text": null,
          "new_text": "ESP_LOGD(TAG, \"Starting %d sec timer for stop_prov_timer_cb()\",\n                        CONFIG_WIFI_PROV_AUTOSTOP_TIMEOUT)",
          "old_line_content": "                        CONFIG_WIFI_PROV_AUTOSTOP_TIMEOUT);",
          "new_line_content": "            ESP_LOGD(TAG, \"Starting %d sec timer for stop_prov_timer_cb()\",",
          "content_same": false
        },
        {
          "line": 1352,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(prov_ctx)",
          "old_line_content": "    prov_ctx = NULL;",
          "new_line_content": "    free(prov_ctx);",
          "content_same": false
        },
        {
          "line": 841,
          "old_api": null,
          "new_api": "esp_timer_start_once",
          "old_text": null,
          "new_text": "esp_timer_start_once(prov_ctx->autostop_timer, CONFIG_WIFI_PROV_AUTOSTOP_TIMEOUT * 1000000U)",
          "old_line_content": "        }",
          "new_line_content": "            esp_timer_start_once(prov_ctx->autostop_timer, CONFIG_WIFI_PROV_AUTOSTOP_TIMEOUT * 1000000U);",
          "content_same": false
        },
        {
          "line": 1354,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 845,
          "old_api": null,
          "new_api": "execute_event_cb",
          "old_text": null,
          "new_text": "execute_event_cb(WIFI_PROV_CRED_SUCCESS, NULL, 0)",
          "old_line_content": "    } else if (event_base == WIFI_EVENT && event_id == WIFI_EVENT_STA_DISCONNECTED) {",
          "new_line_content": "        execute_event_cb(WIFI_PROV_CRED_SUCCESS, NULL, 0);",
          "content_same": false
        },
        {
          "line": 847,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"STA Disconnected\")",
          "old_line_content": "        /* Station couldn't connect to configured host SSID */",
          "new_line_content": "        ESP_LOGE(TAG, \"STA Disconnected\");",
          "content_same": false
        },
        {
          "line": 1359,
          "old_api": null,
          "new_api": "ESP_LOGD",
          "old_text": null,
          "new_text": "ESP_LOGD(TAG, \"execute_event_cb : %d\", WIFI_PROV_END)",
          "old_line_content": "        if (scheme_cb) {",
          "new_line_content": "        ESP_LOGD(TAG, \"execute_event_cb : %d\", WIFI_PROV_END);",
          "content_same": false
        },
        {
          "line": 1361,
          "old_api": null,
          "new_api": "scheme_cb",
          "old_text": null,
          "new_text": "scheme_cb(scheme_data, WIFI_PROV_END, NULL)",
          "old_line_content": "        }",
          "new_line_content": "            scheme_cb(scheme_data, WIFI_PROV_END, NULL);",
          "content_same": false
        },
        {
          "line": 852,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Disconnect reason : %d\", disconnected->reason)",
          "old_line_content": "",
          "new_line_content": "        ESP_LOGE(TAG, \"Disconnect reason : %d\", disconnected->reason);",
          "content_same": false
        },
        {
          "line": 1364,
          "old_api": null,
          "new_api": "app_cb",
          "old_text": null,
          "new_text": "app_cb(app_data, WIFI_PROV_END, NULL)",
          "old_line_content": "        }",
          "new_line_content": "            app_cb(app_data, WIFI_PROV_END, NULL);",
          "content_same": false
        },
        {
          "line": 1367,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Failed to post event WIFI_PROV_END\")",
          "old_line_content": "        }",
          "new_line_content": "            ESP_LOGE(TAG, \"Failed to post event WIFI_PROV_END\");",
          "content_same": false
        },
        {
          "line": 1371,
          "old_api": null,
          "new_api": "ESP_LOGD",
          "old_text": null,
          "new_text": "ESP_LOGD(TAG, \"execute_event_cb : %d\", WIFI_PROV_DEINIT)",
          "old_line_content": "",
          "new_line_content": "    ESP_LOGD(TAG, \"execute_event_cb : %d\", WIFI_PROV_DEINIT);",
          "content_same": false
        },
        {
          "line": 862,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"STA Auth Error\")",
          "old_line_content": "            prov_ctx->wifi_disconnect_reason = WIFI_PROV_STA_AUTH_ERROR;",
          "new_line_content": "            ESP_LOGE(TAG, \"STA Auth Error\");",
          "content_same": false
        },
        {
          "line": 1375,
          "old_api": null,
          "new_api": "scheme_cb",
          "old_text": null,
          "new_text": "scheme_cb(scheme_data, WIFI_PROV_DEINIT, NULL)",
          "old_line_content": "    }",
          "new_line_content": "        scheme_cb(scheme_data, WIFI_PROV_DEINIT, NULL);",
          "content_same": false
        },
        {
          "line": 866,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"STA AP Not found\")",
          "old_line_content": "            prov_ctx->wifi_disconnect_reason = WIFI_PROV_STA_AP_NOT_FOUND;",
          "new_line_content": "            ESP_LOGE(TAG, \"STA AP Not found\");",
          "content_same": false
        },
        {
          "line": 1378,
          "old_api": null,
          "new_api": "app_cb",
          "old_text": null,
          "new_text": "app_cb(app_data, WIFI_PROV_DEINIT, NULL)",
          "old_line_content": "    }",
          "new_line_content": "        app_cb(app_data, WIFI_PROV_DEINIT, NULL);",
          "content_same": false
        },
        {
          "line": 1381,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Failed to post event WIFI_PROV_DEINIT\")",
          "old_line_content": "    }",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to post event WIFI_PROV_DEINIT\");",
          "content_same": false
        },
        {
          "line": 873,
          "old_api": null,
          "new_api": "esp_wifi_connect",
          "old_text": null,
          "new_text": "esp_wifi_connect()",
          "old_line_content": "        }",
          "new_line_content": "            esp_wifi_connect();",
          "content_same": false
        },
        {
          "line": 1391,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return ESP_ERR_INVALID_STATE;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 882,
          "old_api": null,
          "new_api": "execute_event_cb",
          "old_text": null,
          "new_text": "execute_event_cb(WIFI_PROV_CRED_FAIL, (void *)&reason, sizeof(reason))",
          "old_line_content": "        }",
          "new_line_content": "            execute_event_cb(WIFI_PROV_CRED_FAIL, (void *)&reason, sizeof(reason));",
          "content_same": false
        },
        {
          "line": 1395,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "    if (!prov_ctx) {",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 886,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "}",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1398,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_ERR_INVALID_STATE;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1404,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_ERR_INVALID_STATE;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 893,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return ESP_ERR_INVALID_STATE;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 896,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 900,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_ERR_INVALID_STATE;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1416,
          "old_api": null,
          "new_api": "esp_wifi_set_mode",
          "old_text": null,
          "new_text": "esp_wifi_set_mode(WIFI_MODE_STA)",
          "old_line_content": "    if (ret != ESP_OK) {",
          "new_line_content": "    ret = esp_wifi_set_mode(WIFI_MODE_STA);",
          "content_same": false
        },
        {
          "line": 906,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_OK;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1418,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Failed to set Wi-Fi mode to STA\")",
          "old_line_content": "        goto err;",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to set Wi-Fi mode to STA\");",
          "content_same": false
        },
        {
          "line": 1421,
          "old_api": null,
          "new_api": "esp_wifi_start",
          "old_text": null,
          "new_text": "esp_wifi_start()",
          "old_line_content": "    if (ret != ESP_OK) {",
          "new_line_content": "    ret = esp_wifi_start();",
          "content_same": false
        },
        {
          "line": 1423,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Failed to start Wi-Fi\")",
          "old_line_content": "        goto err;",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to start Wi-Fi\");",
          "content_same": false
        },
        {
          "line": 1434,
          "old_api": null,
          "new_api": "esp_wifi_set_storage",
          "old_text": null,
          "new_text": "esp_wifi_set_storage(WIFI_STORAGE_RAM)",
          "old_line_content": "    if (ret != ESP_OK) {",
          "new_line_content": "    ret = esp_wifi_set_storage(WIFI_STORAGE_RAM);",
          "content_same": false
        },
        {
          "line": 1436,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Failed to set Wi-Fi storage to RAM\")",
          "old_line_content": "        goto err;",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to set Wi-Fi storage to RAM\");",
          "content_same": false
        },
        {
          "line": 932,
          "old_api": null,
          "new_api": "ESP_LOGD",
          "old_text": null,
          "new_text": "ESP_LOGD(TAG, \"Scan starting on channel 1...\")",
          "old_line_content": "        prov_ctx->scan_cfg.channel = 1;",
          "new_line_content": "        ESP_LOGD(TAG, \"Scan starting on channel 1...\");",
          "content_same": false
        },
        {
          "line": 1445,
          "old_api": null,
          "new_api": "esp_wifi_set_config",
          "old_text": null,
          "new_text": "esp_wifi_set_config(WIFI_IF_STA, &wifi_cfg_empty)",
          "old_line_content": "    if (ret != ESP_OK) {",
          "new_line_content": "    ret = esp_wifi_set_config(WIFI_IF_STA, &wifi_cfg_empty);",
          "content_same": false
        },
        {
          "line": 935,
          "old_api": null,
          "new_api": "ESP_LOGD",
          "old_text": null,
          "new_text": "ESP_LOGD(TAG, \"Scan starting...\")",
          "old_line_content": "        prov_ctx->scan_cfg.channel = 0;",
          "new_line_content": "        ESP_LOGD(TAG, \"Scan starting...\");",
          "content_same": false
        },
        {
          "line": 1447,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Failed to set empty Wi-Fi credentials\")",
          "old_line_content": "        goto err;",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to set empty Wi-Fi credentials\");",
          "content_same": false
        },
        {
          "line": 941,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return ESP_FAIL;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1453,
          "old_api": null,
          "new_api": "esp_wifi_disconnect",
          "old_text": null,
          "new_text": "esp_wifi_disconnect()",
          "old_line_content": "    if (ret != ESP_OK) {",
          "new_line_content": "    ret = esp_wifi_disconnect();",
          "content_same": false
        },
        {
          "line": 1455,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Failed to disconnect\")",
          "old_line_content": "        goto err;",
          "new_line_content": "        ESP_LOGE(TAG, \"Failed to disconnect\");",
          "content_same": false
        },
        {
          "line": 945,
          "old_api": null,
          "new_api": "ESP_LOGD",
          "old_text": null,
          "new_text": "ESP_LOGD(TAG, \"Scan started\")",
          "old_line_content": "    prov_ctx->scanning = true;",
          "new_line_content": "    ESP_LOGD(TAG, \"Scan started\");",
          "content_same": false
        },
        {
          "line": 948,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1464,
          "old_api": null,
          "new_api": "malloc",
          "old_text": null,
          "new_text": "malloc(prov_ctx->pop.len)",
          "old_line_content": "        if (!prov_ctx->pop.data) {",
          "new_line_content": "        prov_ctx->pop.data = malloc(prov_ctx->pop.len);",
          "content_same": false
        },
        {
          "line": 1466,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Unable to allocate PoP data\")",
          "old_line_content": "            ret = ESP_ERR_NO_MEM;",
          "new_line_content": "            ESP_LOGE(TAG, \"Unable to allocate PoP data\");",
          "content_same": false
        },
        {
          "line": 958,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "        scanning = (prov_ctx && prov_ctx->scanning);",
          "new_line_content": "        ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1470,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy((void *)prov_ctx->pop.data, pop, prov_ctx->pop.len)",
          "old_line_content": "    } else {",
          "new_line_content": "        memcpy((void *)prov_ctx->pop.data, pop, prov_ctx->pop.len);",
          "content_same": false
        },
        {
          "line": 960,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 963,
          "old_api": null,
          "new_api": "vTaskDelay",
          "old_text": null,
          "new_text": "vTaskDelay(120 / portTICK_PERIOD_MS)",
          "old_line_content": "    }",
          "new_line_content": "        vTaskDelay(120 / portTICK_PERIOD_MS);",
          "content_same": false
        },
        {
          "line": 1483,
          "old_api": null,
          "new_api": "esp_timer_create",
          "old_text": null,
          "new_text": "esp_timer_create(&wifi_connect_timer_conf, &prov_ctx->wifi_connect_timer)",
          "old_line_content": "    if (ret != ESP_OK) {",
          "new_line_content": "    ret = esp_timer_create(&wifi_connect_timer_conf, &prov_ctx->wifi_connect_timer);",
          "content_same": false
        },
        {
          "line": 972,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return scan_finished;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 1486,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free((void *)prov_ctx->pop.data)",
          "old_line_content": "        goto err;",
          "new_line_content": "        free((void *)prov_ctx->pop.data);",
          "content_same": false
        },
        {
          "line": 976,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "    if (!prov_ctx) {",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 979,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return scan_finished;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 984,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "    return scan_finished;",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1499,
          "old_api": null,
          "new_api": "esp_timer_create",
          "old_text": null,
          "new_text": "esp_timer_create(&autostop_timer_conf, &prov_ctx->autostop_timer)",
          "old_line_content": "        if (ret != ESP_OK) {",
          "new_line_content": "        ret = esp_timer_create(&autostop_timer_conf, &prov_ctx->autostop_timer);",
          "content_same": false
        },
        {
          "line": 1503,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free((void *)prov_ctx->pop.data)",
          "old_line_content": "            goto err;",
          "new_line_content": "            free((void *)prov_ctx->pop.data);",
          "content_same": false
        },
        {
          "line": 992,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return rval;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 996,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "    if (!prov_ctx) {",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 999,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "        return rval;",
          "new_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1512,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1515,
          "old_api": null,
          "new_api": "wifi_prov_mgr_start_service",
          "old_text": null,
          "new_text": "wifi_prov_mgr_start_service(service_name, service_key)",
          "old_line_content": "    if (ret != ESP_OK) {",
          "new_line_content": "    ret = wifi_prov_mgr_start_service(service_name, service_key);",
          "content_same": false
        },
        {
          "line": 1519,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free((void *)prov_ctx->pop.data)",
          "old_line_content": "    }",
          "new_line_content": "        free((void *)prov_ctx->pop.data);",
          "content_same": false
        },
        {
          "line": 1009,
          "old_api": null,
          "new_api": "RELEASE_LOCK",
          "old_text": null,
          "new_text": "RELEASE_LOCK(prov_ctx_lock)",
          "old_line_content": "    return rval;",
          "new_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1521,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "    if (ret == ESP_OK) {",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        },
        {
          "line": 1525,
          "old_api": null,
          "new_api": "execute_event_cb",
          "old_text": null,
          "new_text": "execute_event_cb(WIFI_PROV_START, NULL, 0)",
          "old_line_content": "        goto exit;",
          "new_line_content": "        execute_event_cb(WIFI_PROV_START, NULL, 0);",
          "content_same": false
        },
        {
          "line": 1017,
          "old_api": null,
          "new_api": "ESP_LOGE",
          "old_text": null,
          "new_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "old_line_content": "        return rval;",
          "new_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "content_same": false
        },
        {
          "line": 1021,
          "old_api": null,
          "new_api": "ACQUIRE_LOCK",
          "old_text": null,
          "new_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "old_line_content": "    if (!prov_ctx) {",
          "new_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1537,
          "old_api": "esp_wifi_set_storage",
          "new_api": null,
          "old_text": "esp_wifi_set_storage(WIFI_STORAGE_FLASH)",
          "new_text": null,
          "old_line_content": "        esp_wifi_set_storage(WIFI_STORAGE_FLASH);",
          "new_line_content": "        /* Restore WiFi storage back to FLASH */",
          "content_same": false
        },
        {
          "line": 1539,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1030,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1546,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 1037,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 1550,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1041,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1043,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    if (prov_ctx == NULL || state == NULL) {",
          "content_same": false
        },
        {
          "line": 1558,
          "old_api": "wifi_prov_mgr_stop_service",
          "new_api": null,
          "old_text": "wifi_prov_mgr_stop_service(0)",
          "new_text": null,
          "old_line_content": "    wifi_prov_mgr_stop_service(0);",
          "new_line_content": "     */",
          "content_same": false
        },
        {
          "line": 1048,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    *state = prov_ctx->wifi_state;",
          "content_same": false
        },
        {
          "line": 1560,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1532,
          "old_api": "esp_wifi_set_config",
          "new_api": null,
          "old_text": "esp_wifi_set_config(WIFI_IF_STA, &wifi_cfg_old)",
          "new_text": null,
          "old_line_content": "        esp_wifi_set_config(WIFI_IF_STA, &wifi_cfg_old);",
          "new_line_content": "        /* Restore current WiFi settings, since provisioning start has failed */",
          "content_same": false
        },
        {
          "line": 1565,
          "old_api": "esp_wifi_restore",
          "new_api": null,
          "old_text": "esp_wifi_restore()",
          "new_text": null,
          "old_line_content": "    esp_err_t ret = esp_wifi_restore();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1055,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 1568,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"esp_wifi_restore fail, ret is %d\", ret)",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"esp_wifi_restore fail, ret is %d\", ret);",
          "new_line_content": "    if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1059,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1061,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    if (prov_ctx == NULL || reason == NULL) {",
          "content_same": false
        },
        {
          "line": 1066,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    if (prov_ctx->wifi_state != WIFI_PROV_STA_DISCONNECTED) {",
          "content_same": false
        },
        {
          "line": 1578,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 1582,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1071,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    *reason = prov_ctx->wifi_disconnect_reason;",
          "content_same": false
        },
        {
          "line": 1586,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Trying reset when not in failure state. Current state: %d\", prov_ctx->prov_state)",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Trying reset when not in failure state. Current state: %d\", prov_ctx->prov_state);",
          "new_line_content": "    if (prov_ctx->prov_state != WIFI_PROV_STATE_FAIL) {",
          "content_same": false
        },
        {
          "line": 1077,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen((const char*) sta.password)",
          "new_text": null,
          "old_line_content": "    size_t passlen = strlen((const char*) sta.password);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1593,
          "old_api": "esp_wifi_set_config",
          "new_api": null,
          "old_text": "esp_wifi_set_config(WIFI_IF_STA, &wifi_cfg)",
          "new_text": null,
          "old_line_content": "    err = esp_wifi_set_config(WIFI_IF_STA, &wifi_cfg);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1083,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(sta.password + (passlen > 3), '*', passlen - 2*(passlen > 3))",
          "new_text": null,
          "old_line_content": "        memset(sta.password + (passlen > 3), '*', passlen - 2*(passlen > 3));",
          "new_line_content": "        /* Mask password partially if longer than 3, else mask it completely */",
          "content_same": false
        },
        {
          "line": 1595,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Failed to set wifi config, 0x%x\", err)",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to set wifi config, 0x%x\", err);",
          "new_line_content": "    if (err != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1602,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "exit:",
          "content_same": false
        },
        {
          "line": 1097,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 1103,
          "old_api": "esp_wifi_get_config",
          "new_api": null,
          "old_text": "esp_wifi_get_config(WIFI_IF_STA, &wifi_cfg)",
          "new_text": null,
          "old_line_content": "    if (esp_wifi_get_config(WIFI_IF_STA, &wifi_cfg) != ESP_OK) {",
          "new_line_content": "    wifi_config_t wifi_cfg;",
          "content_same": false
        },
        {
          "line": 1107,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen((const char *) wifi_cfg.sta.ssid)",
          "new_text": null,
          "old_line_content": "    if (strlen((const char *) wifi_cfg.sta.ssid)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1109,
          "old_api": "debug_print_wifi_credentials",
          "new_api": null,
          "old_text": "debug_print_wifi_credentials(wifi_cfg.sta, \"Found\")",
          "new_text": null,
          "old_line_content": "        debug_print_wifi_credentials(wifi_cfg.sta, \"Found\");",
          "new_line_content": "        *provisioned = true;",
          "content_same": false
        },
        {
          "line": 1116,
          "old_api": "esp_wifi_connect",
          "new_api": null,
          "old_text": "esp_wifi_connect()",
          "new_text": null,
          "old_line_content": "    if (esp_wifi_connect() != ESP_OK) {",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1124,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 1128,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1130,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Invalid state of Provisioning app\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Invalid state of Provisioning app\");",
          "new_line_content": "    if (!prov_ctx) {",
          "content_same": false
        },
        {
          "line": 1135,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Wi-Fi credentials already received by provisioning app\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Wi-Fi credentials already received by provisioning app\");",
          "new_line_content": "    if (prov_ctx->prov_state >= WIFI_PROV_STATE_CRED_RECV) {",
          "content_same": false
        },
        {
          "line": 1139,
          "old_api": "debug_print_wifi_credentials",
          "new_api": null,
          "old_text": "debug_print_wifi_credentials(wifi_cfg->sta, \"Received\")",
          "new_text": null,
          "old_line_content": "    debug_print_wifi_credentials(wifi_cfg->sta, \"Received\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1142,
          "old_api": "esp_wifi_set_mode",
          "new_api": null,
          "old_text": "esp_wifi_set_mode(prov_ctx->mgr_config.scheme.wifi_mode)",
          "new_text": null,
          "old_line_content": "    if (esp_wifi_set_mode(prov_ctx->mgr_config.scheme.wifi_mode) != ESP_OK) {",
          "new_line_content": "    /* Configure Wi-Fi as both AP and/or Station */",
          "content_same": false
        },
        {
          "line": 1155,
          "old_api": "esp_wifi_set_storage",
          "new_api": null,
          "old_text": "esp_wifi_set_storage(WIFI_STORAGE_FLASH)",
          "new_text": null,
          "old_line_content": "    if (esp_wifi_set_storage(WIFI_STORAGE_FLASH) != ESP_OK) {",
          "new_line_content": "     * provided credentials on NVS */",
          "content_same": false
        },
        {
          "line": 1162,
          "old_api": "esp_wifi_set_config",
          "new_api": null,
          "old_text": "esp_wifi_set_config(WIFI_IF_STA, wifi_cfg)",
          "new_text": null,
          "old_line_content": "    if (esp_wifi_set_config(WIFI_IF_STA, wifi_cfg) != ESP_OK) {",
          "new_line_content": "     * provided during provisioning */",
          "content_same": false
        },
        {
          "line": 1169,
          "old_api": "esp_timer_start_once",
          "new_api": null,
          "old_text": "esp_timer_start_once(prov_ctx->wifi_connect_timer, 1000 * 1000U)",
          "new_text": null,
          "old_line_content": "    if (esp_timer_start_once(prov_ctx->wifi_connect_timer, 1000 * 1000U) != ESP_OK) {",
          "new_line_content": "     * be sent to the client successfully, before a channel change happens*/",
          "content_same": false
        },
        {
          "line": 1179,
          "old_api": "execute_event_cb",
          "new_api": null,
          "old_text": "execute_event_cb(WIFI_PROV_CRED_RECV, (void *)&wifi_cfg->sta, sizeof(wifi_cfg->sta))",
          "new_text": null,
          "old_line_content": "    execute_event_cb(WIFI_PROV_CRED_RECV, (void *)&wifi_cfg->sta, sizeof(wifi_cfg->sta));",
          "new_line_content": "    /* Execute user registered callback handler */",
          "content_same": false
        },
        {
          "line": 1193,
          "old_api": "xSemaphoreCreateMutex",
          "new_api": null,
          "old_text": "xSemaphoreCreateMutex()",
          "new_text": null,
          "old_line_content": "        prov_ctx_lock = xSemaphoreCreateMutex();",
          "new_line_content": "        * invalid and cause exception */",
          "content_same": false
        },
        {
          "line": 1195,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Failed to create mutex\")",
          "new_text": null,
          "old_line_content": "            ESP_LOGE(TAG, \"Failed to create mutex\");",
          "new_line_content": "        if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 1216,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1218,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager already initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager already initialized\");",
          "new_line_content": "    if (prov_ctx) {",
          "content_same": false
        },
        {
          "line": 707,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Failed to allocate memory for AP list\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to allocate memory for AP list\");",
          "new_line_content": "    if (!prov_ctx->ap_list[curr_channel]) {",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": "esp_wifi_scan_get_ap_records",
          "new_api": null,
          "old_text": "esp_wifi_scan_get_ap_records(&count, prov_ctx->ap_list[curr_channel])",
          "new_text": null,
          "old_line_content": "    if (esp_wifi_scan_get_ap_records(&count, prov_ctx->ap_list[curr_channel]) != ESP_OK) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1224,
          "old_api": "calloc",
          "new_api": null,
          "old_text": "calloc(1, sizeof(struct wifi_prov_mgr_ctx))",
          "new_text": null,
          "old_line_content": "    prov_ctx = (struct wifi_prov_mgr_ctx *) calloc(1, sizeof(struct wifi_prov_mgr_ctx));",
          "new_line_content": "    /* Allocate memory for provisioning app data */",
          "content_same": false
        },
        {
          "line": 1226,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Error allocating memory for singleton instance\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Error allocating memory for singleton instance\");",
          "new_line_content": "    if (!prov_ctx) {",
          "content_same": false
        },
        {
          "line": 717,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"Scan results for channel %d :\", curr_channel)",
          "new_text": null,
          "old_line_content": "        ESP_LOGD(TAG, \"Scan results for channel %d :\", curr_channel);",
          "new_line_content": "    if (prov_ctx->channels_per_group) {",
          "content_same": false
        },
        {
          "line": 719,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"Scan results :\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGD(TAG, \"Scan results :\");",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"\\tS.N. %-32s %-12s %s %s\", \"SSID\", \"BSSID\", \"RSSI\", \"AUTH\")",
          "new_text": null,
          "old_line_content": "    ESP_LOGD(TAG, \"\\tS.N. %-32s %-12s %s %s\", \"SSID\", \"BSSID\", \"RSSI\", \"AUTH\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 723,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"\\t[%2d] %-32s %02x%02x%02x%02x%02x%02x %4d %4d\", i,\n                 prov_ctx->ap_list[curr_channel][i].ssid,\n                 prov_ctx->ap_list[curr_channel][i].bssid[0],\n                 prov_ctx->ap_list[curr_channel][i].bssid[1],\n                 prov_ctx->ap_list[curr_channel][i].bssid[2],\n                 prov_ctx->ap_list[curr_channel][i].bssid[3],\n                 prov_ctx->ap_list[curr_channel][i].bssid[4],\n                 prov_ctx->ap_list[curr_channel][i].bssid[5],\n                 prov_ctx->ap_list[curr_channel][i].rssi,\n                 prov_ctx->ap_list[curr_channel][i].authmode)",
          "new_text": null,
          "old_line_content": "        ESP_LOGD(TAG, \"\\t[%2d] %-32s %02x%02x%02x%02x%02x%02x %4d %4d\", i,",
          "new_line_content": "    for (uint8_t i = 0; i < prov_ctx->ap_list_len[curr_channel]; i++) {",
          "content_same": false
        },
        {
          "line": 1238,
          "old_api": "new_config",
          "new_api": null,
          "old_text": "scheme->new_config()",
          "new_text": null,
          "old_line_content": "    prov_ctx->prov_scheme_config = scheme->new_config();",
          "new_line_content": "    esp_err_t ret = ESP_OK;",
          "content_same": false
        },
        {
          "line": 1240,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"failed to allocate provisioning scheme configuration\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"failed to allocate provisioning scheme configuration\");",
          "new_line_content": "    if (!prov_ctx->prov_scheme_config) {",
          "content_same": false
        },
        {
          "line": 1245,
          "old_api": "set_config_endpoint",
          "new_api": null,
          "old_text": "scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"prov-scan\", 0xFF50)",
          "new_text": null,
          "old_line_content": "    ret = scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"prov-scan\", 0xFF50);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1247,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"failed to configure Wi-Fi scanning endpoint\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"failed to configure Wi-Fi scanning endpoint\");",
          "new_line_content": "    if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 737,
          "old_api": "MIN",
          "new_api": null,
          "old_text": "MIN(count, MAX_SCAN_RESULTS)",
          "new_text": null,
          "old_line_content": "        int rc = MIN(count, MAX_SCAN_RESULTS);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 1251,
          "old_api": "set_config_endpoint",
          "new_api": null,
          "old_text": "scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"prov-session\", 0xFF51)",
          "new_text": null,
          "old_line_content": "    ret = scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"prov-session\", 0xFF51);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1253,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"failed to configure security endpoint\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"failed to configure security endpoint\");",
          "new_line_content": "    if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1257,
          "old_api": "set_config_endpoint",
          "new_api": null,
          "old_text": "scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"prov-config\", 0xFF52)",
          "new_text": null,
          "old_line_content": "    ret = scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"prov-config\", 0xFF52);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1259,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"failed to configure Wi-Fi configuration endpoint\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"failed to configure Wi-Fi configuration endpoint\");",
          "new_line_content": "    if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1263,
          "old_api": "set_config_endpoint",
          "new_api": null,
          "old_text": "scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"proto-ver\", 0xFF53)",
          "new_text": null,
          "old_line_content": "    ret = scheme->set_config_endpoint(prov_ctx->prov_scheme_config, \"proto-ver\", 0xFF53);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1265,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"failed to configure version endpoint\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"failed to configure version endpoint\");",
          "new_line_content": "    if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1280,
          "old_api": "delete_config",
          "new_api": null,
          "old_text": "config.scheme.delete_config(prov_ctx->prov_scheme_config)",
          "new_text": null,
          "old_line_content": "            config.scheme.delete_config(prov_ctx->prov_scheme_config);",
          "new_line_content": "        if (prov_ctx->prov_scheme_config) {",
          "content_same": false
        },
        {
          "line": 1282,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(prov_ctx)",
          "new_text": null,
          "old_line_content": "        free(prov_ctx);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1284,
          "old_api": "execute_event_cb",
          "new_api": null,
          "old_text": "execute_event_cb(WIFI_PROV_INIT, NULL, 0)",
          "new_text": null,
          "old_line_content": "        execute_event_cb(WIFI_PROV_INIT, NULL, 0);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 773,
          "old_api": "vTaskDelay",
          "new_api": null,
          "old_text": "vTaskDelay(120 / portTICK_PERIOD_MS)",
          "new_text": null,
          "old_line_content": "        vTaskDelay(120 / portTICK_PERIOD_MS);",
          "new_line_content": "    if ((curr_channel % prov_ctx->channels_per_group) == 0) {",
          "content_same": false
        },
        {
          "line": 1286,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"Scan starting on channel %u...\", curr_channel)",
          "new_text": null,
          "old_line_content": "    ESP_LOGD(TAG, \"Scan starting on channel %u...\", curr_channel);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 778,
          "old_api": "esp_wifi_scan_start",
          "new_api": null,
          "old_text": "esp_wifi_scan_start(&prov_ctx->scan_cfg, false)",
          "new_text": null,
          "old_line_content": "    ret = esp_wifi_scan_start(&prov_ctx->scan_cfg, false);",
          "new_line_content": "    prov_ctx->scan_cfg.channel = curr_channel;",
          "content_same": false
        },
        {
          "line": 780,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Failed to start scan\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to start scan\");",
          "new_line_content": "    if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1293,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 784,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"Scan started\")",
          "new_text": null,
          "old_line_content": "    ESP_LOGD(TAG, \"Scan started\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1298,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "        ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "    while (1) {",
          "content_same": false
        },
        {
          "line": 1301,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "            RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "            prov_ctx->prov_state != WIFI_PROV_STATE_IDLE) {",
          "content_same": false
        },
        {
          "line": 795,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 1307,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 798,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1313,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 804,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    if (!prov_ctx) {",
          "content_same": false
        },
        {
          "line": 1317,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 812,
          "old_api": "update_wifi_scan_results",
          "new_api": null,
          "old_text": "update_wifi_scan_results()",
          "new_text": null,
          "old_line_content": "        update_wifi_scan_results();",
          "new_line_content": "        event_id == WIFI_EVENT_SCAN_DONE) {",
          "content_same": false
        },
        {
          "line": 1325,
          "old_api": "wifi_prov_mgr_stop_service",
          "new_api": null,
          "old_text": "wifi_prov_mgr_stop_service(1)",
          "new_text": null,
          "old_line_content": "    bool service_was_running = wifi_prov_mgr_stop_service(1);",
          "new_line_content": "     */",
          "content_same": false
        },
        {
          "line": 818,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    if (prov_ctx->prov_state < WIFI_PROV_STATE_CRED_RECV) {",
          "content_same": false
        },
        {
          "line": 1330,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"Manager already de-initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGD(TAG, \"Manager already de-initialized\");",
          "new_line_content": "    if (!service_was_running && !prov_ctx) {",
          "content_same": false
        },
        {
          "line": 823,
          "old_api": "ESP_LOGI",
          "new_api": null,
          "old_text": "ESP_LOGI(TAG, \"STA Start\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGI(TAG, \"STA Start\");",
          "new_line_content": "    if (event_base == WIFI_EVENT && event_id == WIFI_EVENT_STA_START) {",
          "content_same": false
        },
        {
          "line": 1336,
          "old_api": "cJSON_Delete",
          "new_api": null,
          "old_text": "cJSON_Delete(prov_ctx->app_info_json)",
          "new_text": null,
          "old_line_content": "        cJSON_Delete(prov_ctx->app_info_json);",
          "new_line_content": "    if (prov_ctx->app_info_json) {",
          "content_same": false
        },
        {
          "line": 1340,
          "old_api": "delete_config",
          "new_api": null,
          "old_text": "prov_ctx->mgr_config.scheme.delete_config(prov_ctx->prov_scheme_config)",
          "new_text": null,
          "old_line_content": "        prov_ctx->mgr_config.scheme.delete_config(prov_ctx->prov_scheme_config);",
          "new_line_content": "    if (prov_ctx->prov_scheme_config) {",
          "content_same": false
        },
        {
          "line": 830,
          "old_api": "ESP_LOGI",
          "new_api": null,
          "old_text": "ESP_LOGI(TAG, \"STA Got IP\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGI(TAG, \"STA Got IP\");",
          "new_line_content": "    } else if (event_base == IP_EVENT && event_id == IP_EVENT_STA_GOT_IP) {",
          "content_same": false
        },
        {
          "line": 838,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"Starting %d sec timer for stop_prov_timer_cb()\",\n                        CONFIG_WIFI_PROV_AUTOSTOP_TIMEOUT)",
          "new_text": null,
          "old_line_content": "            ESP_LOGD(TAG, \"Starting %d sec timer for stop_prov_timer_cb()\",",
          "new_line_content": "        if (!prov_ctx->mgr_info.capabilities.no_auto_stop) {",
          "content_same": false
        },
        {
          "line": 1351,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(prov_ctx)",
          "new_text": null,
          "old_line_content": "    free(prov_ctx);",
          "new_line_content": "    /* Free manager context */",
          "content_same": false
        },
        {
          "line": 840,
          "old_api": "esp_timer_start_once",
          "new_api": null,
          "old_text": "esp_timer_start_once(prov_ctx->autostop_timer, CONFIG_WIFI_PROV_AUTOSTOP_TIMEOUT * 1000000U)",
          "new_text": null,
          "old_line_content": "            esp_timer_start_once(prov_ctx->autostop_timer, CONFIG_WIFI_PROV_AUTOSTOP_TIMEOUT * 1000000U);",
          "new_line_content": "                        CONFIG_WIFI_PROV_AUTOSTOP_TIMEOUT);",
          "content_same": false
        },
        {
          "line": 1353,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    prov_ctx = NULL;",
          "content_same": false
        },
        {
          "line": 844,
          "old_api": "execute_event_cb",
          "new_api": null,
          "old_text": "execute_event_cb(WIFI_PROV_CRED_SUCCESS, NULL, 0)",
          "new_text": null,
          "old_line_content": "        execute_event_cb(WIFI_PROV_CRED_SUCCESS, NULL, 0);",
          "new_line_content": "        /* Execute user registered callback handler */",
          "content_same": false
        },
        {
          "line": 846,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"STA Disconnected\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"STA Disconnected\");",
          "new_line_content": "    } else if (event_base == WIFI_EVENT && event_id == WIFI_EVENT_STA_DISCONNECTED) {",
          "content_same": false
        },
        {
          "line": 1358,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"execute_event_cb : %d\", WIFI_PROV_END)",
          "new_text": null,
          "old_line_content": "        ESP_LOGD(TAG, \"execute_event_cb : %d\", WIFI_PROV_END);",
          "new_line_content": "    if (service_was_running) {",
          "content_same": false
        },
        {
          "line": 1360,
          "old_api": "scheme_cb",
          "new_api": null,
          "old_text": "scheme_cb(scheme_data, WIFI_PROV_END, NULL)",
          "new_text": null,
          "old_line_content": "            scheme_cb(scheme_data, WIFI_PROV_END, NULL);",
          "new_line_content": "        if (scheme_cb) {",
          "content_same": false
        },
        {
          "line": 851,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Disconnect reason : %d\", disconnected->reason)",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Disconnect reason : %d\", disconnected->reason);",
          "new_line_content": "        wifi_event_sta_disconnected_t* disconnected = (wifi_event_sta_disconnected_t*) event_data;",
          "content_same": false
        },
        {
          "line": 1363,
          "old_api": "app_cb",
          "new_api": null,
          "old_text": "app_cb(app_data, WIFI_PROV_END, NULL)",
          "new_text": null,
          "old_line_content": "            app_cb(app_data, WIFI_PROV_END, NULL);",
          "new_line_content": "        if (app_cb) {",
          "content_same": false
        },
        {
          "line": 1365,
          "old_api": "esp_event_post",
          "new_api": null,
          "old_text": "esp_event_post(WIFI_PROV_EVENT, WIFI_PROV_END, NULL, 0, portMAX_DELAY)",
          "new_text": null,
          "old_line_content": "        if (esp_event_post(WIFI_PROV_EVENT, WIFI_PROV_END, NULL, 0, portMAX_DELAY) != ESP_OK) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1370,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"execute_event_cb : %d\", WIFI_PROV_DEINIT)",
          "new_text": null,
          "old_line_content": "    ESP_LOGD(TAG, \"execute_event_cb : %d\", WIFI_PROV_DEINIT);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 861,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"STA Auth Error\")",
          "new_text": null,
          "old_line_content": "            ESP_LOGE(TAG, \"STA Auth Error\");",
          "new_line_content": "        case WIFI_REASON_MIC_FAILURE:",
          "content_same": false
        },
        {
          "line": 1374,
          "old_api": "scheme_cb",
          "new_api": null,
          "old_text": "scheme_cb(scheme_data, WIFI_PROV_DEINIT, NULL)",
          "new_text": null,
          "old_line_content": "        scheme_cb(scheme_data, WIFI_PROV_DEINIT, NULL);",
          "new_line_content": "    if (scheme_cb) {",
          "content_same": false
        },
        {
          "line": 865,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"STA AP Not found\")",
          "new_text": null,
          "old_line_content": "            ESP_LOGE(TAG, \"STA AP Not found\");",
          "new_line_content": "        case WIFI_REASON_NO_AP_FOUND:",
          "content_same": false
        },
        {
          "line": 1377,
          "old_api": "app_cb",
          "new_api": null,
          "old_text": "app_cb(app_data, WIFI_PROV_DEINIT, NULL)",
          "new_text": null,
          "old_line_content": "        app_cb(app_data, WIFI_PROV_DEINIT, NULL);",
          "new_line_content": "    if (app_cb) {",
          "content_same": false
        },
        {
          "line": 1379,
          "old_api": "esp_event_post",
          "new_api": null,
          "old_text": "esp_event_post(WIFI_PROV_EVENT, WIFI_PROV_DEINIT, NULL, 0, portMAX_DELAY)",
          "new_text": null,
          "old_line_content": "    if (esp_event_post(WIFI_PROV_EVENT, WIFI_PROV_DEINIT, NULL, 0, portMAX_DELAY) != ESP_OK) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 872,
          "old_api": "esp_wifi_connect",
          "new_api": null,
          "old_text": "esp_wifi_connect()",
          "new_text": null,
          "old_line_content": "            esp_wifi_connect();",
          "new_line_content": "            prov_ctx->wifi_state = WIFI_PROV_STA_CONNECTING;",
          "content_same": false
        },
        {
          "line": 1390,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 881,
          "old_api": "execute_event_cb",
          "new_api": null,
          "old_text": "execute_event_cb(WIFI_PROV_CRED_FAIL, (void *)&reason, sizeof(reason))",
          "new_text": null,
          "old_line_content": "            execute_event_cb(WIFI_PROV_CRED_FAIL, (void *)&reason, sizeof(reason));",
          "new_line_content": "            /* Execute user registered callback handler */",
          "content_same": false
        },
        {
          "line": 1394,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1396,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx) {",
          "content_same": false
        },
        {
          "line": 885,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1402,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning service already started\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning service already started\");",
          "new_line_content": "    if (prov_ctx->prov_state != WIFI_PROV_STATE_IDLE) {",
          "content_same": false
        },
        {
          "line": 892,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 895,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 898,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx) {",
          "content_same": false
        },
        {
          "line": 1415,
          "old_api": "esp_wifi_set_mode",
          "new_api": null,
          "old_text": "esp_wifi_set_mode(WIFI_MODE_STA)",
          "new_text": null,
          "old_line_content": "    ret = esp_wifi_set_mode(WIFI_MODE_STA);",
          "new_line_content": "     * This is necessary for scanning to work */",
          "content_same": false
        },
        {
          "line": 904,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"Scan already running\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGD(TAG, \"Scan already running\");",
          "new_line_content": "    if (prov_ctx->scanning) {",
          "content_same": false
        },
        {
          "line": 1417,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Failed to set Wi-Fi mode to STA\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to set Wi-Fi mode to STA\");",
          "new_line_content": "    if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1420,
          "old_api": "esp_wifi_start",
          "new_api": null,
          "old_text": "esp_wifi_start()",
          "new_text": null,
          "old_line_content": "    ret = esp_wifi_start();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1422,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Failed to start Wi-Fi\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to start Wi-Fi\");",
          "new_line_content": "    if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1431,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(&wifi_cfg_empty, 0, sizeof(wifi_config_t))",
          "new_text": null,
          "old_line_content": "    memset(&wifi_cfg_empty, 0, sizeof(wifi_config_t));",
          "new_line_content": "    wifi_config_t wifi_cfg_empty, wifi_cfg_old;",
          "content_same": false
        },
        {
          "line": 1435,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Failed to set Wi-Fi storage to RAM\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to set Wi-Fi storage to RAM\");",
          "new_line_content": "    if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"Scan starting on channel 1...\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGD(TAG, \"Scan starting on channel 1...\");",
          "new_line_content": "    if (prov_ctx->channels_per_group) {",
          "content_same": false
        },
        {
          "line": 1444,
          "old_api": "esp_wifi_set_config",
          "new_api": null,
          "old_text": "esp_wifi_set_config(WIFI_IF_STA, &wifi_cfg_empty)",
          "new_text": null,
          "old_line_content": "    ret = esp_wifi_set_config(WIFI_IF_STA, &wifi_cfg_empty);",
          "new_line_content": "     * this time Wi-Fi will have no configuration to connect */",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"Scan starting...\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGD(TAG, \"Scan starting...\");",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 1446,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Failed to set empty Wi-Fi credentials\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to set empty Wi-Fi credentials\");",
          "new_line_content": "    if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 938,
          "old_api": "esp_wifi_scan_start",
          "new_api": null,
          "old_text": "esp_wifi_scan_start(&prov_ctx->scan_cfg, false)",
          "new_text": null,
          "old_line_content": "    if (esp_wifi_scan_start(&prov_ctx->scan_cfg, false) != ESP_OK) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1452,
          "old_api": "esp_wifi_disconnect",
          "new_api": null,
          "old_text": "esp_wifi_disconnect()",
          "new_text": null,
          "old_line_content": "    ret = esp_wifi_disconnect();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1454,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Failed to disconnect\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to disconnect\");",
          "new_line_content": "    if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 944,
          "old_api": "ESP_LOGD",
          "new_api": null,
          "old_text": "ESP_LOGD(TAG, \"Scan started\")",
          "new_text": null,
          "old_line_content": "    ESP_LOGD(TAG, \"Scan started\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 947,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    prov_ctx->curr_channel = prov_ctx->scan_cfg.channel;",
          "content_same": false
        },
        {
          "line": 1462,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(pop)",
          "new_text": null,
          "old_line_content": "        prov_ctx->pop.len = strlen(pop);",
          "new_line_content": "    } else if (pop) {",
          "content_same": false
        },
        {
          "line": 1465,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Unable to allocate PoP data\")",
          "new_text": null,
          "old_line_content": "            ESP_LOGE(TAG, \"Unable to allocate PoP data\");",
          "new_line_content": "        if (!prov_ctx->pop.data) {",
          "content_same": false
        },
        {
          "line": 957,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "        ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "    while (scanning) {",
          "content_same": false
        },
        {
          "line": 1469,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy((void *)prov_ctx->pop.data, pop, prov_ctx->pop.len)",
          "new_text": null,
          "old_line_content": "        memcpy((void *)prov_ctx->pop.data, pop, prov_ctx->pop.len);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 959,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "        RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "        scanning = (prov_ctx && prov_ctx->scanning);",
          "content_same": false
        },
        {
          "line": 962,
          "old_api": "vTaskDelay",
          "new_api": null,
          "old_text": "vTaskDelay(120 / portTICK_PERIOD_MS)",
          "new_text": null,
          "old_line_content": "        vTaskDelay(120 / portTICK_PERIOD_MS);",
          "new_line_content": "        /* 120ms delay is  sufficient for Wi-Fi beacons to be sent */",
          "content_same": false
        },
        {
          "line": 1482,
          "old_api": "esp_timer_create",
          "new_api": null,
          "old_text": "esp_timer_create(&wifi_connect_timer_conf, &prov_ctx->wifi_connect_timer)",
          "new_text": null,
          "old_line_content": "    ret = esp_timer_create(&wifi_connect_timer_conf, &prov_ctx->wifi_connect_timer);",
          "new_line_content": "    };",
          "content_same": false
        },
        {
          "line": 971,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 1484,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Failed to create Wi-Fi connect timer\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Failed to create Wi-Fi connect timer\");",
          "new_line_content": "    if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 975,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 977,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx) {",
          "content_same": false
        },
        {
          "line": 983,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    scan_finished = !prov_ctx->scanning;",
          "content_same": false
        },
        {
          "line": 1498,
          "old_api": "esp_timer_create",
          "new_api": null,
          "old_text": "esp_timer_create(&autostop_timer_conf, &prov_ctx->autostop_timer)",
          "new_text": null,
          "old_line_content": "        ret = esp_timer_create(&autostop_timer_conf, &prov_ctx->autostop_timer);",
          "new_line_content": "        };",
          "content_same": false
        },
        {
          "line": 1500,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Failed to create auto-stop timer\")",
          "new_text": null,
          "old_line_content": "            ESP_LOGE(TAG, \"Failed to create auto-stop timer\");",
          "new_line_content": "        if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 991,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 995,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 997,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx) {",
          "content_same": false
        },
        {
          "line": 1511,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "     * handler when system events need to be handled */",
          "content_same": false
        },
        {
          "line": 1514,
          "old_api": "wifi_prov_mgr_start_service",
          "new_api": null,
          "old_text": "wifi_prov_mgr_start_service(service_name, service_key)",
          "new_text": null,
          "old_line_content": "    ret = wifi_prov_mgr_start_service(service_name, service_key);",
          "new_line_content": "    /* Start provisioning service */",
          "content_same": false
        },
        {
          "line": 1516,
          "old_api": "esp_timer_delete",
          "new_api": null,
          "old_text": "esp_timer_delete(prov_ctx->autostop_timer)",
          "new_text": null,
          "old_line_content": "        esp_timer_delete(prov_ctx->autostop_timer);",
          "new_line_content": "    if (ret != ESP_OK) {",
          "content_same": false
        },
        {
          "line": 1008,
          "old_api": "RELEASE_LOCK",
          "new_api": null,
          "old_text": "RELEASE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    RELEASE_LOCK(prov_ctx_lock);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1520,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1524,
          "old_api": "execute_event_cb",
          "new_api": null,
          "old_text": "execute_event_cb(WIFI_PROV_START, NULL, 0)",
          "new_text": null,
          "old_line_content": "        execute_event_cb(WIFI_PROV_START, NULL, 0);",
          "new_line_content": "        /* Execute user registered callback handler */",
          "content_same": false
        },
        {
          "line": 1016,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx_lock) {",
          "content_same": false
        },
        {
          "line": 1020,
          "old_api": "ACQUIRE_LOCK",
          "new_api": null,
          "old_text": "ACQUIRE_LOCK(prov_ctx_lock)",
          "new_text": null,
          "old_line_content": "    ACQUIRE_LOCK(prov_ctx_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1022,
          "old_api": "ESP_LOGE",
          "new_api": null,
          "old_text": "ESP_LOGE(TAG, \"Provisioning manager not initialized\")",
          "new_text": null,
          "old_line_content": "        ESP_LOGE(TAG, \"Provisioning manager not initialized\");",
          "new_line_content": "    if (!prov_ctx) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 39,
      "total_additions": 160,
      "total_deletions": 160,
      "total_api_changes": 359
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 8,
        "api_related_lines": 359,
        "non_api_lines": 3,
        "non_api_line_numbers": [
          714,
          738,
          715
        ]
      }
    },
    "api_calls_before": 358,
    "api_calls_after": 358,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 4,
      "total_diff_lines": 35
    }
  }
}