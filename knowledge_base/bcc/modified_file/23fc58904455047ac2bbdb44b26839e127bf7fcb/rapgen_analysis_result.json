{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/bcc/modified_file/23fc58904455047ac2bbdb44b26839e127bf7fcb",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/bcc/modified_file/23fc58904455047ac2bbdb44b26839e127bf7fcb/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/bcc/modified_file/23fc58904455047ac2bbdb44b26839e127bf7fcb/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/bcc/modified_file/23fc58904455047ac2bbdb44b26839e127bf7fcb/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 344,
          "old_api": "getArg",
          "new_api": "getDecl",
          "old_text": "Call->getArg(1)->getLocStart()",
          "new_text": "Ref->getDecl()->getName()",
          "old_line_content": "          string args_other = rewriter_.getRewrittenText(expansionRange(SourceRange(Call->getArg(1)->getLocStart(),",
          "new_line_content": "          string name = Ref->getDecl()->getName();",
          "content_same": false
        },
        {
          "line": 367,
          "old_api": "getLocStart",
          "new_api": "getArg",
          "old_text": "Call->getLocStart()",
          "new_text": "Call->getArg(0)->getLocEnd()",
          "old_line_content": "              error(Call->getLocStart(), \"get_stackid only available on stacktrace maps\");",
          "new_line_content": "            rewrite_end = Call->getArg(0)->getLocEnd();",
          "content_same": false
        },
        {
          "line": 411,
          "old_api": "Decl->getAttr<AsmLabelAttr>()",
          "new_api": "getCalleeDecl",
          "old_text": "Decl->getAttr<AsmLabelAttr>()",
          "new_text": "Call->getCalleeDecl()",
          "old_line_content": "    if (AsmLabelAttr *A = Decl->getAttr<AsmLabelAttr>()) {",
          "new_line_content": "    NamedDecl *Decl = dyn_cast<NamedDecl>(Call->getCalleeDecl());",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": "getLocStart",
          "new_api": "getLabel",
          "old_text": "Call->getLocStart()",
          "new_text": "A->getLabel()",
          "old_line_content": "          error(Call->getLocStart(), \"cannot use builtin inside a macro\");",
          "new_line_content": "      if (A->getLabel() == \"llvm.bpf.extra\") {",
          "content_same": false
        },
        {
          "line": 430,
          "old_api": "getSourceRange",
          "new_api": "str",
          "old_text": "Call->getSourceRange()",
          "new_text": "fn_args_[0]->getName().str()",
          "old_line_content": "          rewriter_.ReplaceText(expansionRange(Call->getSourceRange()), text);",
          "new_line_content": "          text = \"bpf_l3_csum_replace_(\" + fn_args_[0]->getName().str() + \", (u64)\";",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": "str",
          "new_api": "getSourceRange",
          "old_text": "fn_args_[0]->getName().str()",
          "new_text": "Call->getSourceRange()",
          "old_line_content": "          text = \"bpf_l4_csum_replace_(\" + fn_args_[0]->getName().str() + \", (u64)\";",
          "new_line_content": "          rewriter_.ReplaceText(expansionRange(Call->getSourceRange()), text);",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "getArg",
          "new_api": "getSourceRange",
          "old_text": "Call->getArg(0)->getLocStart()",
          "new_text": "Call->getSourceRange()",
          "old_line_content": "          checkFormatSpecifiers(args[0], Call->getArg(0)->getLocStart());",
          "new_line_content": "          rewriter_.ReplaceText(expansionRange(Call->getSourceRange()), text);",
          "content_same": false
        },
        {
          "line": 443,
          "old_api": "getSourceRange",
          "new_api": "size",
          "old_text": "Call->getSourceRange()",
          "new_text": "args.size()",
          "old_line_content": "            rewriter_.ReplaceText(expansionRange(Call->getSourceRange()), text);",
          "new_line_content": "          if (args.size() <= 1) {",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": "getArg",
          "new_api": "getSourceRange",
          "old_text": "Call->getArg(0)->getLocEnd()",
          "new_text": "Call->getSourceRange()",
          "old_line_content": "            rewriter_.ReplaceText(expansionRange(SourceRange(Call->getLocStart(), Call->getArg(0)->getLocEnd())), text);",
          "new_line_content": "            rewriter_.ReplaceText(expansionRange(Call->getSourceRange()), text);",
          "content_same": false
        },
        {
          "line": 448,
          "old_api": "getName",
          "new_api": "getLocEnd",
          "old_text": "Decl->getName()",
          "new_text": "Call->getLocEnd()",
          "old_line_content": "        } else if (Decl->getName() == \"bpf_num_cpus\") {",
          "new_line_content": "            rewriter_.InsertTextAfter(Call->getLocEnd(), \"); }\");",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": "getName",
          "new_api": "to_string",
          "old_text": "Decl->getName()",
          "new_text": "to_string(numcpu)",
          "old_line_content": "        } else if (Decl->getName() == \"bpf_usdt_readarg_p\") {",
          "new_line_content": "          text = to_string(numcpu);",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": "getLocStart",
          "new_api": "dyn_cast<FunctionDecl>(Decl)",
          "old_text": "Decl->getLocStart()",
          "new_text": "dyn_cast<FunctionDecl>(Decl)",
          "old_line_content": "        auto start_loc = rewriter_.getSourceMgr().getFileLoc(Decl->getLocStart());",
          "new_line_content": "    } else if (FunctionDecl *F = dyn_cast<FunctionDecl>(Decl)) {",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": "getSourceMgr",
          "new_api": "getBuiltinID",
          "old_text": "rewriter_.getSourceMgr().getFileID(start_loc)",
          "new_text": "F->getBuiltinID()",
          "old_line_content": "        if (rewriter_.getSourceMgr().getFileID(start_loc)",
          "new_line_content": "      if (F->isExternallyVisible() && !F->getBuiltinID()) {",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": "getSourceMgr",
          "new_api": "getLocStart",
          "old_text": "rewriter_.getSourceMgr().getMainFileID()",
          "new_text": "Decl->getLocStart()",
          "old_line_content": "            == rewriter_.getSourceMgr().getMainFileID()) {",
          "new_line_content": "        auto start_loc = rewriter_.getSourceMgr().getFileLoc(Decl->getLocStart());",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": "getLocStart",
          "new_api": "getSourceMgr",
          "old_text": "Call->getLocStart()",
          "new_text": "rewriter_.getSourceMgr().getFileID(start_loc)",
          "old_line_content": "          error(Call->getLocStart(), \"cannot call non-static helper function\");",
          "new_line_content": "        if (rewriter_.getSourceMgr().getFileID(start_loc)",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": "getLocWithOffset",
          "new_api": "length",
          "old_text": "loc.getLocWithOffset(i)",
          "new_text": "fmt.length()",
          "old_line_content": "      warning(loc.getLocWithOffset(i), \"unrecognized character\");",
          "new_line_content": "  for (i = 0; i < fmt.length(); i++) {",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": "getLHS",
          "new_api": "isAssignmentOp",
          "old_text": "E->getLHS()->IgnoreImplicit()",
          "new_text": "E->isAssignmentOp()",
          "old_line_content": "  Expr *LHS = E->getLHS()->IgnoreImplicit();",
          "new_line_content": "  if (!E->isAssignmentOp())",
          "content_same": false
        },
        {
          "line": 535,
          "old_api": "getBase",
          "new_api": "getLHS",
          "old_text": "Memb->getBase()->IgnoreImplicit()",
          "new_text": "E->getLHS()->IgnoreImplicit()",
          "old_line_content": "    if (DeclRefExpr *Base = dyn_cast<DeclRefExpr>(Memb->getBase()->IgnoreImplicit())) {",
          "new_line_content": "  Expr *LHS = E->getLHS()->IgnoreImplicit();",
          "content_same": false
        },
        {
          "line": 536,
          "old_api": "getDecl",
          "new_api": "dyn_cast<MemberExpr>(LHS)",
          "old_text": "Base->getDecl()->getAttr<DeprecatedAttr>()",
          "new_text": "dyn_cast<MemberExpr>(LHS)",
          "old_line_content": "      if (DeprecatedAttr *A = Base->getDecl()->getAttr<DeprecatedAttr>()) {",
          "new_line_content": "  if (MemberExpr *Memb = dyn_cast<MemberExpr>(LHS)) {",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": "getMessage",
          "new_api": "getBase",
          "old_text": "A->getMessage()",
          "new_text": "Memb->getBase()->IgnoreImplicit()",
          "old_line_content": "        if (A->getMessage() == \"packet\") {",
          "new_line_content": "    if (DeclRefExpr *Base = dyn_cast<DeclRefExpr>(Memb->getBase()->IgnoreImplicit())) {",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": "getMemberDecl",
          "new_api": "getDecl",
          "old_text": "Memb->getMemberDecl()",
          "new_text": "Base->getDecl()->getAttr<DeprecatedAttr>()",
          "old_line_content": "          if (FieldDecl *F = dyn_cast<FieldDecl>(Memb->getMemberDecl())) {",
          "new_line_content": "      if (DeprecatedAttr *A = Base->getDecl()->getAttr<DeprecatedAttr>()) {",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": "getLocStart",
          "new_api": "getMessage",
          "old_text": "E->getLocStart()",
          "new_text": "A->getMessage()",
          "old_line_content": "            if (!rewriter_.isRewritable(E->getLocStart())) {",
          "new_line_content": "        if (A->getMessage() == \"packet\") {",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": "getLocStart",
          "new_api": "getMemberDecl",
          "old_text": "E->getLocStart()",
          "new_text": "Memb->getMemberDecl()",
          "old_line_content": "              error(E->getLocStart(), \"cannot use \\\"packet\\\" header type inside a macro\");",
          "new_line_content": "          if (FieldDecl *F = dyn_cast<FieldDecl>(Memb->getMemberDecl())) {",
          "content_same": false
        },
        {
          "line": 545,
          "old_api": "getSourceRange",
          "new_api": "getFieldOffset",
          "old_text": "Base->getSourceRange()",
          "new_text": "C.getFieldOffset(F)",
          "old_line_content": "            string base = rewriter_.getRewrittenText(expansionRange(Base->getSourceRange()));",
          "new_line_content": "            uint64_t ofs = C.getFieldOffset(F);",
          "content_same": false
        },
        {
          "line": 546,
          "old_api": "to_string",
          "new_api": "getType",
          "old_text": "to_string(ofs >> 3)",
          "new_text": "F->getType()",
          "old_line_content": "            string text = \"bpf_dins_pkt(\" + fn_args_[0]->getName().str() + \", (u64)\" + base + \"+\" + to_string(ofs >> 3)",
          "new_line_content": "            uint64_t sz = F->isBitField() ? F->getBitWidthValue(C) : C.getTypeSize(F->getType());",
          "content_same": false
        },
        {
          "line": 547,
          "old_api": "to_string",
          "new_api": "getSourceRange",
          "old_text": "to_string(sz)",
          "new_text": "Base->getSourceRange()",
          "old_line_content": "                + \", \" + to_string(ofs & 0x7) + \", \" + to_string(sz) + \",\";",
          "new_line_content": "            string base = rewriter_.getRewrittenText(expansionRange(Base->getSourceRange()));",
          "content_same": false
        },
        {
          "line": 548,
          "old_api": "getOperatorLoc",
          "new_api": "to_string",
          "old_text": "E->getOperatorLoc()",
          "new_text": "to_string(ofs >> 3)",
          "old_line_content": "            rewriter_.ReplaceText(expansionRange(SourceRange(E->getLocStart(), E->getOperatorLoc())), text);",
          "new_line_content": "            string text = \"bpf_dins_pkt(\" + fn_args_[0]->getName().str() + \", (u64)\" + base + \"+\" + to_string(ofs >> 3)",
          "content_same": false
        },
        {
          "line": 549,
          "old_api": "getLocEnd",
          "new_api": "to_string",
          "old_text": "E->getLocEnd()",
          "new_text": "to_string(sz)",
          "old_line_content": "            rewriter_.InsertTextAfterToken(E->getLocEnd(), \")\");",
          "new_line_content": "                + \", \" + to_string(ofs & 0x7) + \", \" + to_string(sz) + \",\";",
          "content_same": false
        },
        {
          "line": 561,
          "old_api": "IgnoreImplicit",
          "new_api": "getCastKind",
          "old_text": "E->IgnoreImplicit()",
          "new_text": "E->getCastKind()",
          "old_line_content": "  MemberExpr *Memb = dyn_cast<MemberExpr>(E->IgnoreImplicit());",
          "new_line_content": "  if (E->getCastKind() != CK_LValueToRValue)",
          "content_same": false
        },
        {
          "line": 566,
          "old_api": "getDecl",
          "new_api": "getBase",
          "old_text": "Ref->getDecl()->getAttr<DeprecatedAttr>()",
          "new_text": "Memb->getBase()->IgnoreImplicit()",
          "old_line_content": "    if (DeprecatedAttr *A = Ref->getDecl()->getAttr<DeprecatedAttr>()) {",
          "new_line_content": "  Expr *Base = Memb->getBase()->IgnoreImplicit();",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": "getMessage",
          "new_api": "dyn_cast<DeclRefExpr>(Base)",
          "old_text": "A->getMessage()",
          "new_text": "dyn_cast<DeclRefExpr>(Base)",
          "old_line_content": "      if (A->getMessage() == \"packet\") {",
          "new_line_content": "  if (DeclRefExpr *Ref = dyn_cast<DeclRefExpr>(Base)) {",
          "content_same": false
        },
        {
          "line": 568,
          "old_api": "getMemberDecl",
          "new_api": "getDecl",
          "old_text": "Memb->getMemberDecl()",
          "new_text": "Ref->getDecl()->getAttr<DeprecatedAttr>()",
          "old_line_content": "        if (FieldDecl *F = dyn_cast<FieldDecl>(Memb->getMemberDecl())) {",
          "new_line_content": "    if (DeprecatedAttr *A = Ref->getDecl()->getAttr<DeprecatedAttr>()) {",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "getLocStart",
          "new_api": "getMessage",
          "old_text": "E->getLocStart()",
          "new_text": "A->getMessage()",
          "old_line_content": "          if (!rewriter_.isRewritable(E->getLocStart())) {",
          "new_line_content": "      if (A->getMessage() == \"packet\") {",
          "content_same": false
        },
        {
          "line": 570,
          "old_api": "getLocStart",
          "new_api": "getMemberDecl",
          "old_text": "E->getLocStart()",
          "new_text": "Memb->getMemberDecl()",
          "old_line_content": "            error(E->getLocStart(), \"cannot use \\\"packet\\\" header type inside a macro\");",
          "new_line_content": "        if (FieldDecl *F = dyn_cast<FieldDecl>(Memb->getMemberDecl())) {",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": "str",
          "new_api": "getFieldOffset",
          "old_text": "Ref->getDecl()->getName().str()",
          "new_text": "C.getFieldOffset(F)",
          "old_line_content": "          string text = \"bpf_dext_pkt(\" + fn_args_[0]->getName().str() + \", (u64)\" + Ref->getDecl()->getName().str() + \"+\"",
          "new_line_content": "          uint64_t ofs = C.getFieldOffset(F);",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": "to_string",
          "new_api": "getType",
          "old_text": "to_string(sz)",
          "new_text": "F->getType()",
          "old_line_content": "              + to_string(ofs >> 3) + \", \" + to_string(ofs & 0x7) + \", \" + to_string(sz) + \")\";",
          "new_line_content": "          uint64_t sz = F->isBitField() ? F->getBitWidthValue(C) : C.getTypeSize(F->getType());",
          "content_same": false
        },
        {
          "line": 577,
          "old_api": "getSourceRange",
          "new_api": "str",
          "old_text": "E->getSourceRange()",
          "new_text": "Ref->getDecl()->getName().str()",
          "old_line_content": "          rewriter_.ReplaceText(expansionRange(E->getSourceRange()), text);",
          "new_line_content": "          string text = \"bpf_dext_pkt(\" + fn_args_[0]->getName().str() + \", (u64)\" + Ref->getDecl()->getName().str() + \"+\"",
          "content_same": false
        },
        {
          "line": 607,
          "old_api": "startswith",
          "new_api": "getType",
          "old_text": "A->getName().startswith(\"maps\")",
          "new_text": "Decl->getType()->getAs<RecordType>()",
          "old_line_content": "    if (!A->getName().startswith(\"maps\"))",
          "new_line_content": "  const RecordType *R = Decl->getType()->getAs<RecordType>();",
          "content_same": false
        },
        {
          "line": 625,
          "old_api": "getLocStart",
          "new_api": "fields",
          "old_text": "F->getLocStart()",
          "new_text": "RD->fields()",
          "old_line_content": "        error(F->getLocStart(), \"unknown type\");",
          "new_line_content": "    for (auto F : RD->fields()) {",
          "content_same": false
        },
        {
          "line": 632,
          "old_api": "getLocStart",
          "new_api": "getName",
          "old_text": "F->getLocStart()",
          "new_text": "F->getName()",
          "old_line_content": "          error(F->getLocStart(), \"invalid zero-sized leaf\");",
          "new_line_content": "      if (F->getName() == \"key\") {",
          "content_same": false
        },
        {
          "line": 639,
          "old_api": "getLocStart",
          "new_api": "getName",
          "old_text": "F->getLocStart()",
          "new_text": "F->getName()",
          "old_line_content": "          error(F->getLocStart(), \"invalid zero-sized leaf\");",
          "new_line_content": "      } else if (F->getName() == \"leaf\") {",
          "content_same": false
        },
        {
          "line": 645,
          "old_api": "getFieldIndex",
          "new_api": "getType",
          "old_text": "F->getFieldIndex()",
          "new_text": "F->getType()",
          "old_line_content": "        unsigned idx = F->getFieldIndex();",
          "new_line_content": "        leaf_type = F->getType();",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": "getInit",
          "new_api": "getName",
          "old_text": "Decl->getInit()",
          "new_text": "F->getName()",
          "old_line_content": "        if (auto I = dyn_cast_or_null<InitListExpr>(Decl->getInit())) {",
          "new_line_content": "      } else if (F->getName() == \"max_entries\") {",
          "content_same": false
        },
        {
          "line": 654,
          "old_api": "getInit",
          "new_api": "getName",
          "old_text": "Decl->getInit()",
          "new_text": "F->getName()",
          "old_line_content": "        if (auto I = dyn_cast_or_null<InitListExpr>(Decl->getInit())) {",
          "new_line_content": "      } else if (F->getName() == \"flags\") {",
          "content_same": false
        },
        {
          "line": 681,
          "old_api": "isSpecificBuiltinType",
          "new_api": "getName",
          "old_text": "key_type->isSpecificBuiltinType(BuiltinType::Int)",
          "new_text": "A->getName()",
          "old_line_content": "      if (key_type->isSpecificBuiltinType(BuiltinType::Int))",
          "new_line_content": "    } else if (A->getName() == \"maps/histogram\") {",
          "content_same": false
        },
        {
          "line": 685,
          "old_api": "getName",
          "new_api": "isSpecificBuiltinType",
          "old_text": "A->getName()",
          "new_text": "leaf_type->isSpecificBuiltinType(BuiltinType::ULongLong)",
          "old_line_content": "    } else if (A->getName() == \"maps/prog\") {",
          "new_line_content": "      if (!leaf_type->isSpecificBuiltinType(BuiltinType::ULongLong))",
          "content_same": false
        },
        {
          "line": 689,
          "old_api": "size",
          "new_api": "getName",
          "old_text": "get_possible_cpus().size()",
          "new_text": "A->getName()",
          "old_line_content": "      int numcpu = get_possible_cpus().size();",
          "new_line_content": "    } else if (A->getName() == \"maps/perf_output\") {",
          "content_same": false
        },
        {
          "line": 699,
          "old_api": "getLocStart",
          "new_api": "getName",
          "old_text": "Decl->getLocStart()",
          "new_text": "A->getName()",
          "old_line_content": "        error(Decl->getLocStart(), \"reference to undefined table\");",
          "new_line_content": "    } else if (A->getName() == \"maps/extern\") {",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": "getName",
          "new_api": "dup",
          "old_text": "A->getName()",
          "new_text": "table_it->second.dup()",
          "old_line_content": "    } else if (A->getName() == \"maps/export\") {",
          "new_line_content": "      table = table_it->second.dup();",
          "content_same": false
        },
        {
          "line": 706,
          "old_api": "substr",
          "new_api": "getName",
          "old_text": "table.name.substr(2)",
          "new_text": "A->getName()",
          "old_line_content": "        table.name = table.name.substr(2);",
          "new_line_content": "    } else if (A->getName() == \"maps/export\") {",
          "content_same": false
        },
        {
          "line": 707,
          "old_api": "id",
          "new_api": "substr",
          "old_text": "fe_.id()",
          "new_text": "table.name.substr(0, 2)",
          "old_line_content": "      Path local_path({fe_.id(), table.name});",
          "new_line_content": "      if (table.name.substr(0, 2) == \"__\")",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": "table_storage",
          "new_api": "id",
          "old_text": "fe_.table_storage().Find(local_path, table_it)",
          "new_text": "fe_.id()",
          "old_line_content": "      if (!fe_.table_storage().Find(local_path, table_it)) {",
          "new_line_content": "      Path local_path({fe_.id(), table.name});",
          "content_same": false
        },
        {
          "line": 734,
          "old_api": "getType",
          "new_api": "table_storage",
          "old_text": "Decl->getType()->getAs<PointerType>()",
          "new_text": "fe_.table_storage().VisitMapType(table, C, key_type, leaf_type)",
          "old_line_content": "  } else if (const PointerType *P = Decl->getType()->getAs<PointerType>()) {",
          "new_line_content": "    fe_.table_storage().VisitMapType(table, C, key_type, leaf_type);",
          "content_same": false
        },
        {
          "line": 739,
          "old_api": "RD->getAttr<DeprecatedAttr>()",
          "new_api": "getPointeeType",
          "old_text": "RD->getAttr<DeprecatedAttr>()",
          "new_text": "P->getPointeeType()->getAs<RecordType>()",
          "old_line_content": "        if (DeprecatedAttr *DA = RD->getAttr<DeprecatedAttr>()) {",
          "new_line_content": "    if (const RecordType *RT = P->getPointeeType()->getAs<RecordType>()) {",
          "content_same": false
        },
        {
          "line": 740,
          "old_api": "getMessage",
          "new_api": "getDecl",
          "old_text": "DA->getMessage()",
          "new_text": "RT->getDecl()->getDefinition()",
          "old_line_content": "          if (DA->getMessage() == \"packet\") {",
          "new_line_content": "      if (const RecordDecl *RD = RT->getDecl()->getDefinition()) {",
          "content_same": false
        },
        {
          "line": 741,
          "old_api": "clone",
          "new_api": "RD->getAttr<DeprecatedAttr>()",
          "old_text": "DA->clone(C)",
          "new_text": "RD->getAttr<DeprecatedAttr>()",
          "old_line_content": "            Decl->addAttr(DA->clone(C));",
          "new_line_content": "        if (DeprecatedAttr *DA = RD->getAttr<DeprecatedAttr>()) {",
          "content_same": false
        },
        {
          "line": 765,
          "old_api": "parameters",
          "new_api": "dyn_cast<FunctionDecl>(D)",
          "old_text": "F->parameters()",
          "new_text": "dyn_cast<FunctionDecl>(D)",
          "old_line_content": "        for (auto arg : F->parameters()) {",
          "new_line_content": "    if (FunctionDecl *F = dyn_cast<FunctionDecl>(D)) {",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": "getType",
          "new_api": "hasBody",
          "old_text": "arg->getType()->isFundamentalType()",
          "new_text": "F->hasBody()",
          "old_line_content": "          if (arg != F->getParamDecl(0) && !arg->getType()->isFundamentalType())",
          "new_line_content": "      if (F->isExternallyVisible() && F->hasBody()) {",
          "content_same": false
        },
        {
          "line": 767,
          "old_api": "set_ptreg",
          "new_api": "parameters",
          "old_text": "visitor_.set_ptreg(arg)",
          "new_text": "F->parameters()",
          "old_line_content": "            visitor_.set_ptreg(arg);",
          "new_line_content": "        for (auto arg : F->parameters()) {",
          "content_same": false
        },
        {
          "line": 769,
          "old_api": "TraverseDecl",
          "new_api": "set_ptreg",
          "old_text": "visitor_.TraverseDecl(D)",
          "new_text": "visitor_.set_ptreg(arg)",
          "old_line_content": "        visitor_.TraverseDecl(D);",
          "new_line_content": "            visitor_.set_ptreg(arg);",
          "content_same": false
        },
        {
          "line": 784,
          "old_api": "flush",
          "new_api": "llvm::errs()",
          "old_text": "os_.flush()",
          "new_text": "llvm::errs()",
          "old_line_content": "  os_.flush();",
          "new_line_content": "    rewriter_->getEditBuffer(rewriter_->getSourceMgr().getMainFileID()).write(llvm::errs());",
          "content_same": false
        },
        {
          "line": 790,
          "old_api": "getASTContext",
          "new_api": "getLangOpts",
          "old_text": "Compiler.getASTContext()",
          "new_text": "Compiler.getLangOpts()",
          "old_line_content": "  consumers.push_back(unique_ptr<ASTConsumer>(new ProbeConsumer(Compiler.getASTContext(), *rewriter_)));",
          "new_line_content": "  rewriter_->setSourceMgr(Compiler.getSourceManager(), Compiler.getLangOpts());",
          "content_same": false
        },
        {
          "line": 792,
          "old_api": "std::move(consumers)",
          "new_api": "getASTContext",
          "old_text": "std::move(consumers)",
          "new_text": "Compiler.getASTContext()",
          "old_line_content": "  return unique_ptr<ASTConsumer>(new MultiplexConsumer(std::move(consumers)));",
          "new_line_content": "  consumers.push_back(unique_ptr<ASTConsumer>(new ProbeConsumer(Compiler.getASTContext(), *rewriter_)));",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 524,
          "old_api": null,
          "new_api": "getLocWithOffset",
          "old_text": null,
          "new_text": "loc.getLocWithOffset(i - j)",
          "old_line_content": "      return false;",
          "new_line_content": "      warning(loc.getLocWithOffset(i - j),",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "E->getLocStart()",
          "old_line_content": "              return false;",
          "new_line_content": "            if (!rewriter_.isRewritable(E->getLocStart())) {",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "E->getLocStart()",
          "old_line_content": "            }",
          "new_line_content": "              error(E->getLocStart(), \"cannot use \\\"packet\\\" header type inside a macro\");",
          "content_same": false
        },
        {
          "line": 550,
          "old_api": null,
          "new_api": "getOperatorLoc",
          "old_text": null,
          "new_text": "E->getOperatorLoc()",
          "old_line_content": "          }",
          "new_line_content": "            rewriter_.ReplaceText(expansionRange(SourceRange(E->getLocStart(), E->getOperatorLoc())), text);",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": null,
          "new_api": "getLocEnd",
          "old_text": null,
          "new_text": "E->getLocEnd()",
          "old_line_content": "        }",
          "new_line_content": "            rewriter_.InsertTextAfterToken(E->getLocEnd(), \")\");",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": null,
          "new_api": "IgnoreImplicit",
          "old_text": null,
          "new_text": "E->IgnoreImplicit()",
          "old_line_content": "    return true;",
          "new_line_content": "  MemberExpr *Memb = dyn_cast<MemberExpr>(E->IgnoreImplicit());",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "E->getLocStart()",
          "old_line_content": "            return false;",
          "new_line_content": "          if (!rewriter_.isRewritable(E->getLocStart())) {",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "E->getLocStart()",
          "old_line_content": "          }",
          "new_line_content": "            error(E->getLocStart(), \"cannot use \\\"packet\\\" header type inside a macro\");",
          "content_same": false
        },
        {
          "line": 578,
          "old_api": null,
          "new_api": "to_string",
          "old_text": null,
          "new_text": "to_string(sz)",
          "old_line_content": "        }",
          "new_line_content": "              + to_string(ofs >> 3) + \", \" + to_string(ofs & 0x7) + \", \" + to_string(sz) + \")\";",
          "content_same": false
        },
        {
          "line": 579,
          "old_api": null,
          "new_api": "getSourceRange",
          "old_text": null,
          "new_text": "E->getSourceRange()",
          "old_line_content": "      }",
          "new_line_content": "          rewriter_.ReplaceText(expansionRange(E->getSourceRange()), text);",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": null,
          "new_api": "getSourceMgr",
          "old_text": null,
          "new_text": "rewriter_.getSourceMgr().getExpansionRange(range)",
          "old_line_content": "",
          "new_line_content": "  return rewriter_.getSourceMgr().getExpansionRange(range);",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": null,
          "new_api": "getDiagnostics",
          "old_text": null,
          "new_text": "C.getDiagnostics().getCustomDiagID(DiagnosticsEngine::Error, fmt)",
          "old_line_content": "}",
          "new_line_content": "  unsigned int diag_id = C.getDiagnostics().getCustomDiagID(DiagnosticsEngine::Error, fmt);",
          "content_same": false
        },
        {
          "line": 595,
          "old_api": null,
          "new_api": "getDiagnostics",
          "old_text": null,
          "new_text": "C.getDiagnostics().Report(loc, diag_id)",
          "old_line_content": "",
          "new_line_content": "  return C.getDiagnostics().Report(loc, diag_id);",
          "content_same": false
        },
        {
          "line": 600,
          "old_api": null,
          "new_api": "getDiagnostics",
          "old_text": null,
          "new_text": "C.getDiagnostics().getCustomDiagID(DiagnosticsEngine::Warning, fmt)",
          "old_line_content": "}",
          "new_line_content": "  unsigned int diag_id = C.getDiagnostics().getCustomDiagID(DiagnosticsEngine::Warning, fmt);",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": null,
          "new_api": "getDiagnostics",
          "old_text": null,
          "new_text": "C.getDiagnostics().Report(loc, diag_id)",
          "old_line_content": "",
          "new_line_content": "  return C.getDiagnostics().Report(loc, diag_id);",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "Decl->getAttr<SectionAttr>()",
          "old_text": null,
          "new_text": "Decl->getAttr<SectionAttr>()",
          "old_line_content": "      return true;",
          "new_line_content": "  if (SectionAttr *A = Decl->getAttr<SectionAttr>()) {",
          "content_same": false
        },
        {
          "line": 609,
          "old_api": null,
          "new_api": "startswith",
          "old_text": null,
          "new_text": "A->getName().startswith(\"maps\")",
          "old_line_content": "    if (!R) {",
          "new_line_content": "    if (!A->getName().startswith(\"maps\"))",
          "content_same": false
        },
        {
          "line": 612,
          "old_api": null,
          "new_api": "getLocEnd",
          "old_text": null,
          "new_text": "Decl->getLocEnd()",
          "old_line_content": "    }",
          "new_line_content": "      error(Decl->getLocEnd(), \"invalid type for bpf_table, expect struct\");",
          "content_same": false
        },
        {
          "line": 615,
          "old_api": null,
          "new_api": "getDecl",
          "old_text": null,
          "new_text": "R->getDecl()->getDefinition()",
          "old_line_content": "    TableDesc table;",
          "new_line_content": "    const RecordDecl *RD = R->getDecl()->getDefinition();",
          "content_same": false
        },
        {
          "line": 619,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "Decl->getName()",
          "old_line_content": "    Path global_path({table.name});",
          "new_line_content": "    table.name = Decl->getName();",
          "content_same": false
        },
        {
          "line": 620,
          "old_api": null,
          "new_api": "id",
          "old_text": null,
          "new_text": "fe_.id()",
          "old_line_content": "    QualType key_type, leaf_type;",
          "new_line_content": "    Path local_path({fe_.id(), table.name});",
          "content_same": false
        },
        {
          "line": 626,
          "old_api": null,
          "new_api": "getTypePtr",
          "old_text": null,
          "new_text": "F->getType().getTypePtr()->isIncompleteType()",
          "old_line_content": "        return false;",
          "new_line_content": "      if (F->getType().getTypePtr()->isIncompleteType()) {",
          "content_same": false
        },
        {
          "line": 627,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "F->getLocStart()",
          "old_line_content": "      }",
          "new_line_content": "        error(F->getLocStart(), \"unknown type\");",
          "content_same": false
        },
        {
          "line": 631,
          "old_api": null,
          "new_api": "getType",
          "old_text": null,
          "new_text": "F->getType()",
          "old_line_content": "        if (sz == 0) {",
          "new_line_content": "      size_t sz = C.getTypeSize(F->getType()) >> 3;",
          "content_same": false
        },
        {
          "line": 634,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "F->getLocStart()",
          "old_line_content": "        }",
          "new_line_content": "          error(F->getLocStart(), \"invalid zero-sized leaf\");",
          "content_same": false
        },
        {
          "line": 638,
          "old_api": null,
          "new_api": "getType",
          "old_text": null,
          "new_text": "F->getType()",
          "old_line_content": "        if (sz == 0) {",
          "new_line_content": "        key_type = F->getType();",
          "content_same": false
        },
        {
          "line": 641,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "F->getLocStart()",
          "old_line_content": "        }",
          "new_line_content": "          error(F->getLocStart(), \"invalid zero-sized leaf\");",
          "content_same": false
        },
        {
          "line": 647,
          "old_api": null,
          "new_api": "getFieldIndex",
          "old_text": null,
          "new_text": "F->getFieldIndex()",
          "old_line_content": "          llvm::APSInt res;",
          "new_line_content": "        unsigned idx = F->getFieldIndex();",
          "content_same": false
        },
        {
          "line": 650,
          "old_api": null,
          "new_api": "getInit",
          "old_text": null,
          "new_text": "I->getInit(idx)->EvaluateAsInt(res, C)",
          "old_line_content": "          }",
          "new_line_content": "          if (I->getInit(idx)->EvaluateAsInt(res, C)) {",
          "content_same": false
        },
        {
          "line": 651,
          "old_api": null,
          "new_api": "getExtValue",
          "old_text": null,
          "new_text": "res.getExtValue()",
          "old_line_content": "        }",
          "new_line_content": "            table.max_entries = res.getExtValue();",
          "content_same": false
        },
        {
          "line": 655,
          "old_api": null,
          "new_api": "getFieldIndex",
          "old_text": null,
          "new_text": "F->getFieldIndex()",
          "old_line_content": "          llvm::APSInt res;",
          "new_line_content": "        unsigned idx = F->getFieldIndex();",
          "content_same": false
        },
        {
          "line": 658,
          "old_api": null,
          "new_api": "getInit",
          "old_text": null,
          "new_text": "I->getInit(idx)->EvaluateAsInt(res, C)",
          "old_line_content": "          }",
          "new_line_content": "          if (I->getInit(idx)->EvaluateAsInt(res, C)) {",
          "content_same": false
        },
        {
          "line": 659,
          "old_api": null,
          "new_api": "getExtValue",
          "old_text": null,
          "new_text": "res.getExtValue()",
          "old_line_content": "        }",
          "new_line_content": "            table.flags = res.getExtValue();",
          "content_same": false
        },
        {
          "line": 686,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "Decl->getLocStart()",
          "old_line_content": "      map_type = BPF_MAP_TYPE_PROG_ARRAY;",
          "new_line_content": "        error(Decl->getLocStart(), \"histogram leaf type must be u64, got %0\") << leaf_type;",
          "content_same": false
        },
        {
          "line": 691,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "get_possible_cpus().size()",
          "old_line_content": "        numcpu = 1;",
          "new_line_content": "      int numcpu = get_possible_cpus().size();",
          "content_same": false
        },
        {
          "line": 700,
          "old_api": null,
          "new_api": "table_storage",
          "old_text": null,
          "new_text": "fe_.table_storage().Find(global_path, table_it)",
          "old_line_content": "        return false;",
          "new_line_content": "      if (!fe_.table_storage().Find(global_path, table_it)) {",
          "content_same": false
        },
        {
          "line": 701,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "Decl->getLocStart()",
          "old_line_content": "      }",
          "new_line_content": "        error(Decl->getLocStart(), \"reference to undefined table\");",
          "content_same": false
        },
        {
          "line": 708,
          "old_api": null,
          "new_api": "substr",
          "old_text": null,
          "new_text": "table.name.substr(2)",
          "old_line_content": "      Path global_path({table.name});",
          "new_line_content": "        table.name = table.name.substr(2);",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": null,
          "new_api": "table_storage",
          "old_text": null,
          "new_text": "fe_.table_storage().Find(local_path, table_it)",
          "old_line_content": "        return false;",
          "new_line_content": "      if (!fe_.table_storage().Find(local_path, table_it)) {",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "Decl->getLocStart()",
          "old_line_content": "      }",
          "new_line_content": "        error(Decl->getLocStart(), \"reference to undefined table\");",
          "content_same": false
        },
        {
          "line": 715,
          "old_api": null,
          "new_api": "dup",
          "old_text": null,
          "new_text": "table_it->second.dup()",
          "old_line_content": "    }",
          "new_line_content": "      fe_.table_storage().Insert(global_path, table_it->second.dup());",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "A->getName()",
          "old_line_content": "      }",
          "new_line_content": "        error(Decl->getLocStart(), \"unsupported map type: %0\") << A->getName();",
          "content_same": false
        },
        {
          "line": 726,
          "old_api": null,
          "new_api": "bpf_create_map",
          "old_text": null,
          "new_text": "bpf_create_map(map_type, table.key_size, table.leaf_size, table.max_entries, table.flags)",
          "old_line_content": "    if (table.fd < 0) {",
          "new_line_content": "      table.fd = bpf_create_map(map_type, table.key_size, table.leaf_size, table.max_entries, table.flags);",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "Decl->getLocStart()",
          "old_line_content": "      return false;",
          "new_line_content": "      error(Decl->getLocStart(), \"could not open bpf map: %0\\nis %1 map type enabled in your kernel?\") <<",
          "content_same": false
        },
        {
          "line": 730,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "A->getName()",
          "old_line_content": "    }",
          "new_line_content": "          strerror(errno) << A->getName();",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": null,
          "new_api": "move",
          "old_text": null,
          "new_text": "move(table)",
          "old_line_content": "    // if var is a pointer to a packet type, clone the annotation into the var",
          "new_line_content": "    fe_.table_storage().Insert(local_path, move(table));",
          "content_same": false
        },
        {
          "line": 736,
          "old_api": null,
          "new_api": "getType",
          "old_text": null,
          "new_text": "Decl->getType()->getAs<PointerType>()",
          "old_line_content": "    // decl so that the packet dext/dins rewriter can catch it",
          "new_line_content": "  } else if (const PointerType *P = Decl->getType()->getAs<PointerType>()) {",
          "content_same": false
        },
        {
          "line": 742,
          "old_api": null,
          "new_api": "getMessage",
          "old_text": null,
          "new_text": "DA->getMessage()",
          "old_line_content": "          }",
          "new_line_content": "          if (DA->getMessage() == \"packet\") {",
          "content_same": false
        },
        {
          "line": 743,
          "old_api": null,
          "new_api": "clone",
          "old_text": null,
          "new_text": "DA->clone(C)",
          "old_line_content": "        }",
          "new_line_content": "            Decl->addAttr(DA->clone(C));",
          "content_same": false
        },
        {
          "line": 756,
          "old_api": null,
          "new_api": "TraverseDecl",
          "old_text": null,
          "new_text": "visitor_.TraverseDecl(D)",
          "old_line_content": "}",
          "new_line_content": "    visitor_.TraverseDecl(D);",
          "content_same": false
        },
        {
          "line": 768,
          "old_api": null,
          "new_api": "getType",
          "old_text": null,
          "new_text": "arg->getType()->isFundamentalType()",
          "old_line_content": "        }",
          "new_line_content": "          if (arg != F->getParamDecl(0) && !arg->getType()->isFundamentalType())",
          "content_same": false
        },
        {
          "line": 771,
          "old_api": null,
          "new_api": "TraverseDecl",
          "old_text": null,
          "new_text": "visitor_.TraverseDecl(D)",
          "old_line_content": "    }",
          "new_line_content": "        visitor_.TraverseDecl(D);",
          "content_same": false
        },
        {
          "line": 785,
          "old_api": null,
          "new_api": "getMainFileID",
          "old_text": null,
          "new_text": "rewriter_->getSourceMgr().getMainFileID()",
          "old_line_content": "}",
          "new_line_content": "  rewriter_->getEditBuffer(rewriter_->getSourceMgr().getMainFileID()).write(os_);",
          "content_same": false
        },
        {
          "line": 786,
          "old_api": null,
          "new_api": "flush",
          "old_text": null,
          "new_text": "os_.flush()",
          "old_line_content": "",
          "new_line_content": "  os_.flush();",
          "content_same": false
        },
        {
          "line": 793,
          "old_api": null,
          "new_api": "getASTContext",
          "old_text": null,
          "new_text": "Compiler.getASTContext()",
          "old_line_content": "}",
          "new_line_content": "  consumers.push_back(unique_ptr<ASTConsumer>(new BTypeConsumer(Compiler.getASTContext(), *this)));",
          "content_same": false
        },
        {
          "line": 794,
          "old_api": null,
          "new_api": "std::move(consumers)",
          "old_text": null,
          "new_text": "std::move(consumers)",
          "old_line_content": "",
          "new_line_content": "  return unique_ptr<ASTConsumer>(new MultiplexConsumer(std::move(consumers)));",
          "content_same": false
        },
        {
          "line": 346,
          "old_api": null,
          "new_api": "getArg",
          "old_text": null,
          "new_text": "Call->getArg(1)->getLocStart()",
          "old_line_content": "          txt = \"bpf_perf_event_output(\" + arg0 + \", bpf_pseudo_fd(1, \" + fd + \")\";",
          "new_line_content": "          string args_other = rewriter_.getRewrittenText(expansionRange(SourceRange(Call->getArg(1)->getLocStart(),",
          "content_same": false
        },
        {
          "line": 347,
          "old_api": null,
          "new_api": "getArg",
          "old_text": null,
          "new_text": "Call->getArg(2)->getLocEnd()",
          "old_line_content": "          txt += \", CUR_CPU_IDENTIFIER, \" + args_other + \")\";",
          "new_line_content": "                                                           Call->getArg(2)->getLocEnd())));",
          "content_same": false
        },
        {
          "line": 353,
          "old_api": null,
          "new_api": "getArg",
          "old_text": null,
          "new_text": "Call->getArg(2)->getSourceRange()",
          "old_line_content": "          txt = \"bpf_perf_event_output(\" +",
          "new_line_content": "          string meta = rewriter_.getRewrittenText(expansionRange(Call->getArg(2)->getSourceRange()));",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": null,
          "new_api": "getArg",
          "old_text": null,
          "new_text": "Call->getArg(3)->getSourceRange()",
          "old_line_content": "            skb + \", \" +",
          "new_line_content": "          string meta_len = rewriter_.getRewrittenText(expansionRange(Call->getArg(3)->getSourceRange()));",
          "content_same": false
        },
        {
          "line": 364,
          "old_api": null,
          "new_api": "getArg",
          "old_text": null,
          "new_text": "Call->getArg(0)->getSourceRange()",
          "old_line_content": "            txt += \"bpf_pseudo_fd(1, \" + fd + \"), \" + arg0;",
          "new_line_content": "                rewriter_.getRewrittenText(expansionRange(Call->getArg(0)->getSourceRange()));",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "Call->getLocStart()",
          "old_line_content": "            }",
          "new_line_content": "              error(Call->getLocStart(), \"get_stackid only available on stacktrace maps\");",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "Call->getLocStart()",
          "old_line_content": "            prefix = \"bpf_map_update_elem\";",
          "new_line_content": "              warning(Call->getLocStart(), \"all element of an array already exist; insert() will have no effect\");",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "Call->getLocStart()",
          "old_line_content": "          }",
          "new_line_content": "            error(Call->getLocStart(), \"invalid bpf_table operation %0\") << memb_name;",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": null,
          "new_api": "isRewritable",
          "old_text": null,
          "new_text": "rewriter_.isRewritable(rewrite_end)",
          "old_line_content": "          return false;",
          "new_line_content": "        if (!rewriter_.isRewritable(rewrite_start) || !rewriter_.isRewritable(rewrite_end)) {",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "Call->getLocStart()",
          "old_line_content": "        }",
          "new_line_content": "          error(Call->getLocStart(), \"cannot use map function inside a macro\");",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": null,
          "new_api": "SourceRange",
          "old_text": null,
          "new_text": "SourceRange(rewrite_start, rewrite_end)",
          "old_line_content": "      }",
          "new_line_content": "        rewriter_.ReplaceText(expansionRange(SourceRange(rewrite_start, rewrite_end)), txt);",
          "content_same": false
        },
        {
          "line": 410,
          "old_api": null,
          "new_api": "getCalleeDecl",
          "old_text": null,
          "new_text": "Call->getCalleeDecl()",
          "old_line_content": "    if (!Decl) return true;",
          "new_line_content": "  } else if (Call->getCalleeDecl()) {",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": null,
          "new_api": "Decl->getAttr<AsmLabelAttr>()",
          "old_text": null,
          "new_text": "Decl->getAttr<AsmLabelAttr>()",
          "old_line_content": "      // rewriter rather than as a macro since they may also include nested",
          "new_line_content": "    if (AsmLabelAttr *A = Decl->getAttr<AsmLabelAttr>()) {",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "Call->getLocStart()",
          "old_line_content": "          return false;",
          "new_line_content": "        if (!rewriter_.isRewritable(Call->getLocStart())) {",
          "content_same": false
        },
        {
          "line": 420,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "Call->getLocStart()",
          "old_line_content": "        }",
          "new_line_content": "          error(Call->getLocStart(), \"cannot use builtin inside a macro\");",
          "content_same": false
        },
        {
          "line": 425,
          "old_api": null,
          "new_api": "arguments",
          "old_text": null,
          "new_text": "Call->arguments()",
          "old_line_content": "",
          "new_line_content": "        for (auto arg : Call->arguments())",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": null,
          "new_api": "getSourceRange",
          "old_text": null,
          "new_text": "arg->getSourceRange()",
          "old_line_content": "        string text;",
          "new_line_content": "          args.push_back(rewriter_.getRewrittenText(expansionRange(arg->getSourceRange())));",
          "content_same": false
        },
        {
          "line": 429,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "Decl->getName()",
          "old_line_content": "          text += args[0] + \", \" + args[1] + \", \" + args[2] + \", sizeof(\" + args[2] + \"))\";",
          "new_line_content": "        if (Decl->getName() == \"incr_cksum_l3\") {",
          "content_same": false
        },
        {
          "line": 433,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "Decl->getName()",
          "old_line_content": "          text += args[0] + \", \" + args[1] + \", \" + args[2];",
          "new_line_content": "        } else if (Decl->getName() == \"incr_cksum_l4\") {",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": null,
          "new_api": "str",
          "old_text": null,
          "new_text": "fn_args_[0]->getName().str()",
          "old_line_content": "          text += \", ((\" + args[3] + \" & 0x1) << 4) | sizeof(\" + args[2] + \"))\";",
          "new_line_content": "          text = \"bpf_l4_csum_replace_(\" + fn_args_[0]->getName().str() + \", (u64)\";",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "Decl->getName()",
          "old_line_content": "          //  #define bpf_trace_printk(fmt, args...)",
          "new_line_content": "        } else if (Decl->getName() == \"bpf_trace_printk\") {",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": null,
          "new_api": "getArg",
          "old_text": null,
          "new_text": "Call->getArg(0)->getLocStart()",
          "old_line_content": "          //    ({ char _fmt[] = fmt; bpf_trace_printk_(_fmt, sizeof(_fmt), args...); })",
          "new_line_content": "          checkFormatSpecifiers(args[0], Call->getArg(0)->getLocStart());",
          "content_same": false
        },
        {
          "line": 447,
          "old_api": null,
          "new_api": "getArg",
          "old_text": null,
          "new_text": "Call->getArg(0)->getLocEnd()",
          "old_line_content": "          }",
          "new_line_content": "            rewriter_.ReplaceText(expansionRange(SourceRange(Call->getLocStart(), Call->getArg(0)->getLocEnd())), text);",
          "content_same": false
        },
        {
          "line": 450,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "Decl->getName()",
          "old_line_content": "          if (numcpu <= 0)",
          "new_line_content": "        } else if (Decl->getName() == \"bpf_num_cpus\") {",
          "content_same": false
        },
        {
          "line": 451,
          "old_api": null,
          "new_api": "sysconf",
          "old_text": null,
          "new_text": "sysconf(_SC_NPROCESSORS_ONLN)",
          "old_line_content": "            numcpu = 1;",
          "new_line_content": "          int numcpu = sysconf(_SC_NPROCESSORS_ONLN);",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": null,
          "new_api": "getSourceRange",
          "old_text": null,
          "new_text": "Call->getSourceRange()",
          "old_line_content": "          text = \"({ u64 __addr = 0x0; \";",
          "new_line_content": "          rewriter_.ReplaceText(expansionRange(Call->getSourceRange()), text);",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "Decl->getName()",
          "old_line_content": "          text += \"_bpf_readarg_\" + current_fn_ + \"_\" + args[0] + \"(\" +",
          "new_line_content": "        } else if (Decl->getName() == \"bpf_usdt_readarg_p\") {",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": null,
          "new_api": "getSourceRange",
          "old_text": null,
          "new_text": "Call->getSourceRange()",
          "old_line_content": "          text = \"_bpf_readarg_\" + current_fn_ + \"_\" + args[0] + \"(\" + args[1] +",
          "new_line_content": "          rewriter_.ReplaceText(expansionRange(Call->getSourceRange()), text);",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "Decl->getName()",
          "old_line_content": "                 \", \" + args[2] + \", sizeof(*(\" + args[2] + \")))\";",
          "new_line_content": "        } else if (Decl->getName() == \"bpf_usdt_readarg\") {",
          "content_same": false
        },
        {
          "line": 467,
          "old_api": null,
          "new_api": "getSourceRange",
          "old_text": null,
          "new_text": "Call->getSourceRange()",
          "old_line_content": "      }",
          "new_line_content": "          rewriter_.ReplaceText(expansionRange(Call->getSourceRange()), text);",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": null,
          "new_api": "getSourceMgr",
          "old_text": null,
          "new_text": "rewriter_.getSourceMgr().getMainFileID()",
          "old_line_content": "          return false;",
          "new_line_content": "            == rewriter_.getSourceMgr().getMainFileID()) {",
          "content_same": false
        },
        {
          "line": 475,
          "old_api": null,
          "new_api": "getLocStart",
          "old_text": null,
          "new_text": "Call->getLocStart()",
          "old_line_content": "        }",
          "new_line_content": "          error(Call->getLocStart(), \"cannot call non-static helper function\");",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": null,
          "new_api": "isspace",
          "old_text": null,
          "new_text": "isspace(fmt[i])",
          "old_line_content": "      return false;",
          "new_line_content": "    if (!isascii(fmt[i]) || (!isprint(fmt[i]) && !isspace(fmt[i]))) {",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": null,
          "new_api": "getLocWithOffset",
          "old_text": null,
          "new_text": "loc.getLocWithOffset(i)",
          "old_line_content": "    }",
          "new_line_content": "      warning(loc.getLocWithOffset(i), \"unrecognized character\");",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": null,
          "new_api": "getLocWithOffset",
          "old_text": null,
          "new_text": "loc.getLocWithOffset(i)",
          "old_line_content": "    }",
          "new_line_content": "      warning(loc.getLocWithOffset(i), \"cannot use more than 3 conversion specifiers\");",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": null,
          "new_api": "ispunct",
          "old_text": null,
          "new_text": "ispunct(fmt[i])",
          "old_line_content": "                \"only %%d %%u %%x %%ld %%lu %%lx %%lld %%llu %%llx %%p %%s conversion specifiers allowed\");",
          "new_line_content": "      if (!isspace(fmt[i]) && !ispunct(fmt[i]) && fmt[i] != 0) {",
          "content_same": false
        },
        {
          "line": 505,
          "old_api": null,
          "new_api": "getLocWithOffset",
          "old_text": null,
          "new_text": "loc.getLocWithOffset(i - 2)",
          "old_line_content": "        return false;",
          "new_line_content": "        warning(loc.getLocWithOffset(i - 2),",
          "content_same": false
        },
        {
          "line": 511,
          "old_api": null,
          "new_api": "getLocWithOffset",
          "old_text": null,
          "new_text": "loc.getLocWithOffset(i - 2)",
          "old_line_content": "        }",
          "new_line_content": "          warning(loc.getLocWithOffset(i - 2), \"cannot use several %%s conversion specifiers\");",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 522,
          "old_api": "getLocWithOffset",
          "new_api": null,
          "old_text": "loc.getLocWithOffset(i - j)",
          "new_text": null,
          "old_line_content": "      warning(loc.getLocWithOffset(i - j),",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": "isAssignmentOp",
          "new_api": null,
          "old_text": "E->isAssignmentOp()",
          "new_text": null,
          "old_line_content": "  if (!E->isAssignmentOp())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": "dyn_cast<MemberExpr>(LHS)",
          "new_api": null,
          "old_text": "dyn_cast<MemberExpr>(LHS)",
          "new_text": null,
          "old_line_content": "  if (MemberExpr *Memb = dyn_cast<MemberExpr>(LHS)) {",
          "new_line_content": "    return true;",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": "getFieldOffset",
          "new_api": null,
          "old_text": "C.getFieldOffset(F)",
          "new_text": null,
          "old_line_content": "            uint64_t ofs = C.getFieldOffset(F);",
          "new_line_content": "              return false;",
          "content_same": false
        },
        {
          "line": 544,
          "old_api": "getType",
          "new_api": null,
          "old_text": "F->getType()",
          "new_text": null,
          "old_line_content": "            uint64_t sz = F->isBitField() ? F->getBitWidthValue(C) : C.getTypeSize(F->getType());",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": "getCastKind",
          "new_api": null,
          "old_text": "E->getCastKind()",
          "new_text": null,
          "old_line_content": "  if (E->getCastKind() != CK_LValueToRValue)",
          "new_line_content": "bool BTypeVisitor::VisitImplicitCastExpr(ImplicitCastExpr *E) {",
          "content_same": false
        },
        {
          "line": 564,
          "old_api": "getBase",
          "new_api": null,
          "old_text": "Memb->getBase()->IgnoreImplicit()",
          "new_text": null,
          "old_line_content": "  Expr *Base = Memb->getBase()->IgnoreImplicit();",
          "new_line_content": "  if (!Memb)",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": "dyn_cast<DeclRefExpr>(Base)",
          "new_api": null,
          "old_text": "dyn_cast<DeclRefExpr>(Base)",
          "new_text": null,
          "old_line_content": "  if (DeclRefExpr *Ref = dyn_cast<DeclRefExpr>(Base)) {",
          "new_line_content": "    return true;",
          "content_same": false
        },
        {
          "line": 573,
          "old_api": "getFieldOffset",
          "new_api": null,
          "old_text": "C.getFieldOffset(F)",
          "new_text": null,
          "old_line_content": "          uint64_t ofs = C.getFieldOffset(F);",
          "new_line_content": "            return false;",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": "getType",
          "new_api": null,
          "old_text": "F->getType()",
          "new_text": null,
          "old_line_content": "          uint64_t sz = F->isBitField() ? F->getBitWidthValue(C) : C.getTypeSize(F->getType());",
          "new_line_content": "          }",
          "content_same": false
        },
        {
          "line": 587,
          "old_api": "getSourceMgr",
          "new_api": null,
          "old_text": "rewriter_.getSourceMgr().getExpansionRange(range)",
          "new_text": null,
          "old_line_content": "  return rewriter_.getSourceMgr().getExpansionRange(range);",
          "new_line_content": "SourceRange",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": "getDiagnostics",
          "new_api": null,
          "old_text": "C.getDiagnostics().getCustomDiagID(DiagnosticsEngine::Error, fmt)",
          "new_text": null,
          "old_line_content": "  unsigned int diag_id = C.getDiagnostics().getCustomDiagID(DiagnosticsEngine::Error, fmt);",
          "new_line_content": "template <unsigned N>",
          "content_same": false
        },
        {
          "line": 593,
          "old_api": "getDiagnostics",
          "new_api": null,
          "old_text": "C.getDiagnostics().Report(loc, diag_id)",
          "new_text": null,
          "old_line_content": "  return C.getDiagnostics().Report(loc, diag_id);",
          "new_line_content": "DiagnosticBuilder BTypeVisitor::error(SourceLocation loc, const char (&fmt)[N]) {",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": "getDiagnostics",
          "new_api": null,
          "old_text": "C.getDiagnostics().getCustomDiagID(DiagnosticsEngine::Warning, fmt)",
          "new_text": null,
          "old_line_content": "  unsigned int diag_id = C.getDiagnostics().getCustomDiagID(DiagnosticsEngine::Warning, fmt);",
          "new_line_content": "template <unsigned N>",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": "getDiagnostics",
          "new_api": null,
          "old_text": "C.getDiagnostics().Report(loc, diag_id)",
          "new_text": null,
          "old_line_content": "  return C.getDiagnostics().Report(loc, diag_id);",
          "new_line_content": "DiagnosticBuilder BTypeVisitor::warning(SourceLocation loc, const char (&fmt)[N]) {",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": "getType",
          "new_api": null,
          "old_text": "Decl->getType()->getAs<RecordType>()",
          "new_text": null,
          "old_line_content": "  const RecordType *R = Decl->getType()->getAs<RecordType>();",
          "new_line_content": "// are declared.",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": "Decl->getAttr<SectionAttr>()",
          "new_api": null,
          "old_text": "Decl->getAttr<SectionAttr>()",
          "new_text": null,
          "old_line_content": "  if (SectionAttr *A = Decl->getAttr<SectionAttr>()) {",
          "new_line_content": "bool BTypeVisitor::VisitVarDecl(VarDecl *Decl) {",
          "content_same": false
        },
        {
          "line": 610,
          "old_api": "getLocEnd",
          "new_api": null,
          "old_text": "Decl->getLocEnd()",
          "new_text": null,
          "old_line_content": "      error(Decl->getLocEnd(), \"invalid type for bpf_table, expect struct\");",
          "new_line_content": "      return true;",
          "content_same": false
        },
        {
          "line": 613,
          "old_api": "getDecl",
          "new_api": null,
          "old_text": "R->getDecl()->getDefinition()",
          "new_text": null,
          "old_line_content": "    const RecordDecl *RD = R->getDecl()->getDefinition();",
          "new_line_content": "      return false;",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": "getName",
          "new_api": null,
          "old_text": "Decl->getName()",
          "new_text": null,
          "old_line_content": "    table.name = Decl->getName();",
          "new_line_content": "    TableDesc table;",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": "id",
          "new_api": null,
          "old_text": "fe_.id()",
          "new_text": null,
          "old_line_content": "    Path local_path({fe_.id(), table.name});",
          "new_line_content": "    TableStorage::iterator table_it;",
          "content_same": false
        },
        {
          "line": 623,
          "old_api": "fields",
          "new_api": null,
          "old_text": "RD->fields()",
          "new_text": null,
          "old_line_content": "    for (auto F : RD->fields()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 624,
          "old_api": "getTypePtr",
          "new_api": null,
          "old_text": "F->getType().getTypePtr()->isIncompleteType()",
          "new_text": null,
          "old_line_content": "      if (F->getType().getTypePtr()->isIncompleteType()) {",
          "new_line_content": "    unsigned i = 0;",
          "content_same": false
        },
        {
          "line": 629,
          "old_api": "getType",
          "new_api": null,
          "old_text": "F->getType()",
          "new_text": null,
          "old_line_content": "      size_t sz = C.getTypeSize(F->getType()) >> 3;",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": "getName",
          "new_api": null,
          "old_text": "F->getName()",
          "new_text": null,
          "old_line_content": "      if (F->getName() == \"key\") {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": "getType",
          "new_api": null,
          "old_text": "F->getType()",
          "new_text": null,
          "old_line_content": "        key_type = F->getType();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 637,
          "old_api": "getName",
          "new_api": null,
          "old_text": "F->getName()",
          "new_text": null,
          "old_line_content": "      } else if (F->getName() == \"leaf\") {",
          "new_line_content": "        table.key_size = sz;",
          "content_same": false
        },
        {
          "line": 643,
          "old_api": "getType",
          "new_api": null,
          "old_text": "F->getType()",
          "new_text": null,
          "old_line_content": "        leaf_type = F->getType();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": "getName",
          "new_api": null,
          "old_text": "F->getName()",
          "new_text": null,
          "old_line_content": "      } else if (F->getName() == \"max_entries\") {",
          "new_line_content": "        table.leaf_size = sz;",
          "content_same": false
        },
        {
          "line": 649,
          "old_api": "getExtValue",
          "new_api": null,
          "old_text": "res.getExtValue()",
          "new_text": null,
          "old_line_content": "            table.max_entries = res.getExtValue();",
          "new_line_content": "          llvm::APSInt res;",
          "content_same": false
        },
        {
          "line": 652,
          "old_api": "getName",
          "new_api": null,
          "old_text": "F->getName()",
          "new_text": null,
          "old_line_content": "      } else if (F->getName() == \"flags\") {",
          "new_line_content": "          }",
          "content_same": false
        },
        {
          "line": 653,
          "old_api": "getFieldIndex",
          "new_api": null,
          "old_text": "F->getFieldIndex()",
          "new_text": null,
          "old_line_content": "        unsigned idx = F->getFieldIndex();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 657,
          "old_api": "getExtValue",
          "new_api": null,
          "old_text": "res.getExtValue()",
          "new_text": null,
          "old_line_content": "            table.flags = res.getExtValue();",
          "new_line_content": "          llvm::APSInt res;",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": "getName",
          "new_api": null,
          "old_text": "A->getName()",
          "new_text": null,
          "old_line_content": "    if (A->getName() == \"maps/hash\") {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 684,
          "old_api": "getLocStart",
          "new_api": null,
          "old_text": "Decl->getLocStart()",
          "new_text": null,
          "old_line_content": "        error(Decl->getLocStart(), \"histogram leaf type must be u64, got %0\") << leaf_type;",
          "new_line_content": "        map_type = BPF_MAP_TYPE_ARRAY;",
          "content_same": false
        },
        {
          "line": 693,
          "old_api": "getName",
          "new_api": null,
          "old_text": "A->getName()",
          "new_text": null,
          "old_line_content": "    } else if (A->getName() == \"maps/perf_array\") {",
          "new_line_content": "        numcpu = 1;",
          "content_same": false
        },
        {
          "line": 698,
          "old_api": "table_storage",
          "new_api": null,
          "old_text": "fe_.table_storage().Find(global_path, table_it)",
          "new_text": null,
          "old_line_content": "      if (!fe_.table_storage().Find(global_path, table_it)) {",
          "new_line_content": "      map_type = BPF_MAP_TYPE_STACK_TRACE;",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": "dup",
          "new_api": null,
          "old_text": "table_it->second.dup()",
          "new_text": null,
          "old_line_content": "      table = table_it->second.dup();",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 705,
          "old_api": "substr",
          "new_api": null,
          "old_text": "table.name.substr(0, 2)",
          "new_text": null,
          "old_line_content": "      if (table.name.substr(0, 2) == \"__\")",
          "new_line_content": "      table.is_extern = true;",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": "getLocStart",
          "new_api": null,
          "old_text": "Decl->getLocStart()",
          "new_text": null,
          "old_line_content": "        error(Decl->getLocStart(), \"reference to undefined table\");",
          "new_line_content": "      Path global_path({table.name});",
          "content_same": false
        },
        {
          "line": 713,
          "old_api": "dup",
          "new_api": null,
          "old_text": "table_it->second.dup()",
          "new_text": null,
          "old_line_content": "      fe_.table_storage().Insert(global_path, table_it->second.dup());",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 719,
          "old_api": "getName",
          "new_api": null,
          "old_text": "A->getName()",
          "new_text": null,
          "old_line_content": "        error(Decl->getLocStart(), \"unsupported map type: %0\") << A->getName();",
          "new_line_content": "    if (!table.is_extern) {",
          "content_same": false
        },
        {
          "line": 724,
          "old_api": "bpf_create_map",
          "new_api": null,
          "old_text": "bpf_create_map(map_type, table.key_size, table.leaf_size, table.max_entries, table.flags)",
          "new_text": null,
          "old_line_content": "      table.fd = bpf_create_map(map_type, table.key_size, table.leaf_size, table.max_entries, table.flags);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 727,
          "old_api": "getLocStart",
          "new_api": null,
          "old_text": "Decl->getLocStart()",
          "new_text": null,
          "old_line_content": "      error(Decl->getLocStart(), \"could not open bpf map: %0\\nis %1 map type enabled in your kernel?\") <<",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "getName",
          "new_api": null,
          "old_text": "A->getName()",
          "new_text": null,
          "old_line_content": "          strerror(errno) << A->getName();",
          "new_line_content": "    if (table.fd < 0) {",
          "content_same": false
        },
        {
          "line": 732,
          "old_api": "table_storage",
          "new_api": null,
          "old_text": "fe_.table_storage().VisitMapType(table, C, key_type, leaf_type)",
          "new_text": null,
          "old_line_content": "    fe_.table_storage().VisitMapType(table, C, key_type, leaf_type);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 733,
          "old_api": "move",
          "new_api": null,
          "old_text": "move(table)",
          "new_text": null,
          "old_line_content": "    fe_.table_storage().Insert(local_path, move(table));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 737,
          "old_api": "getPointeeType",
          "new_api": null,
          "old_text": "P->getPointeeType()->getAs<RecordType>()",
          "new_text": null,
          "old_line_content": "    if (const RecordType *RT = P->getPointeeType()->getAs<RecordType>()) {",
          "new_line_content": "    // if var is a pointer to a packet type, clone the annotation into the var",
          "content_same": false
        },
        {
          "line": 738,
          "old_api": "getDecl",
          "new_api": null,
          "old_text": "RT->getDecl()->getDefinition()",
          "new_text": null,
          "old_line_content": "      if (const RecordDecl *RD = RT->getDecl()->getDefinition()) {",
          "new_line_content": "    // decl so that the packet dext/dins rewriter can catch it",
          "content_same": false
        },
        {
          "line": 754,
          "old_api": "TraverseDecl",
          "new_api": null,
          "old_text": "visitor_.TraverseDecl(D)",
          "new_text": null,
          "old_line_content": "    visitor_.TraverseDecl(D);",
          "new_line_content": "bool BTypeConsumer::HandleTopLevelDecl(DeclGroupRef Group) {",
          "content_same": false
        },
        {
          "line": 763,
          "old_api": "dyn_cast<FunctionDecl>(D)",
          "new_api": null,
          "old_text": "dyn_cast<FunctionDecl>(D)",
          "new_text": null,
          "old_line_content": "    if (FunctionDecl *F = dyn_cast<FunctionDecl>(D)) {",
          "new_line_content": "bool ProbeConsumer::HandleTopLevelDecl(DeclGroupRef Group) {",
          "content_same": false
        },
        {
          "line": 764,
          "old_api": "hasBody",
          "new_api": null,
          "old_text": "F->hasBody()",
          "new_text": null,
          "old_line_content": "      if (F->isExternallyVisible() && F->hasBody()) {",
          "new_line_content": "  for (auto D : Group) {",
          "content_same": false
        },
        {
          "line": 782,
          "old_api": "llvm::errs()",
          "new_api": null,
          "old_text": "llvm::errs()",
          "new_text": null,
          "old_line_content": "    rewriter_->getEditBuffer(rewriter_->getSourceMgr().getMainFileID()).write(llvm::errs());",
          "new_line_content": "void BFrontendAction::EndSourceFileAction() {",
          "content_same": false
        },
        {
          "line": 783,
          "old_api": "getMainFileID",
          "new_api": null,
          "old_text": "rewriter_->getSourceMgr().getMainFileID()",
          "new_text": null,
          "old_line_content": "  rewriter_->getEditBuffer(rewriter_->getSourceMgr().getMainFileID()).write(os_);",
          "new_line_content": "  if (flags_ & DEBUG_PREPROCESSOR)",
          "content_same": false
        },
        {
          "line": 788,
          "old_api": "getLangOpts",
          "new_api": null,
          "old_text": "Compiler.getLangOpts()",
          "new_text": null,
          "old_line_content": "  rewriter_->setSourceMgr(Compiler.getSourceManager(), Compiler.getLangOpts());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 791,
          "old_api": "getASTContext",
          "new_api": null,
          "old_text": "Compiler.getASTContext()",
          "new_text": null,
          "old_line_content": "  consumers.push_back(unique_ptr<ASTConsumer>(new BTypeConsumer(Compiler.getASTContext(), *this)));",
          "new_line_content": "  vector<unique_ptr<ASTConsumer>> consumers;",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": "getDecl",
          "new_api": null,
          "old_text": "Ref->getDecl()->getName()",
          "new_text": null,
          "old_line_content": "          string name = Ref->getDecl()->getName();",
          "new_line_content": "          txt += \"})\";",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": "getArg",
          "new_api": null,
          "old_text": "Call->getArg(0)->getSourceRange()",
          "new_text": null,
          "old_line_content": "          string arg0 = rewriter_.getRewrittenText(expansionRange(Call->getArg(0)->getSourceRange()));",
          "new_line_content": "        } else if (memb_name == \"perf_submit\") {",
          "content_same": false
        },
        {
          "line": 349,
          "old_api": "getArg",
          "new_api": null,
          "old_text": "Call->getArg(0)->getSourceRange()",
          "new_text": null,
          "old_line_content": "          string skb = rewriter_.getRewrittenText(expansionRange(Call->getArg(0)->getSourceRange()));",
          "new_line_content": "          txt += \", CUR_CPU_IDENTIFIER, \" + args_other + \")\";",
          "content_same": false
        },
        {
          "line": 350,
          "old_api": "getArg",
          "new_api": null,
          "old_text": "Call->getArg(1)->getSourceRange()",
          "new_text": null,
          "old_line_content": "          string skb_len = rewriter_.getRewrittenText(expansionRange(Call->getArg(1)->getSourceRange()));",
          "new_line_content": "        } else if (memb_name == \"perf_submit_skb\") {",
          "content_same": false
        },
        {
          "line": 362,
          "old_api": "getArg",
          "new_api": null,
          "old_text": "Call->getArg(0)->getSourceRange()",
          "new_text": null,
          "old_line_content": "                rewriter_.getRewrittenText(expansionRange(Call->getArg(0)->getSourceRange()));",
          "new_line_content": "          if (desc->second.type == BPF_MAP_TYPE_STACK_TRACE) {",
          "content_same": false
        },
        {
          "line": 365,
          "old_api": "getArg",
          "new_api": null,
          "old_text": "Call->getArg(0)->getLocEnd()",
          "new_text": null,
          "old_line_content": "            rewrite_end = Call->getArg(0)->getLocEnd();",
          "new_line_content": "            txt = \"bpf_get_stackid(\";",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": "getLocStart",
          "new_api": null,
          "old_text": "Call->getLocStart()",
          "new_text": null,
          "old_line_content": "              warning(Call->getLocStart(), \"all element of an array already exist; insert() will have no effect\");",
          "new_line_content": "          } else if (memb_name == \"insert\") {",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": "getLocStart",
          "new_api": null,
          "old_text": "Call->getLocStart()",
          "new_text": null,
          "old_line_content": "            error(Call->getLocStart(), \"invalid bpf_table operation %0\") << memb_name;",
          "new_line_content": "            suffix = \")\";",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": "isRewritable",
          "new_api": null,
          "old_text": "rewriter_.isRewritable(rewrite_end)",
          "new_text": null,
          "old_line_content": "        if (!rewriter_.isRewritable(rewrite_start) || !rewriter_.isRewritable(rewrite_end)) {",
          "new_line_content": "          txt = prefix + args + suffix;",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": "getLocStart",
          "new_api": null,
          "old_text": "Call->getLocStart()",
          "new_text": null,
          "old_line_content": "          error(Call->getLocStart(), \"cannot use map function inside a macro\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 404,
          "old_api": "SourceRange",
          "new_api": null,
          "old_text": "SourceRange(rewrite_start, rewrite_end)",
          "new_text": null,
          "old_line_content": "        rewriter_.ReplaceText(expansionRange(SourceRange(rewrite_start, rewrite_end)), txt);",
          "new_line_content": "          return false;",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": "getCalleeDecl",
          "new_api": null,
          "old_text": "Call->getCalleeDecl()",
          "new_text": null,
          "old_line_content": "  } else if (Call->getCalleeDecl()) {",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": "getCalleeDecl",
          "new_api": null,
          "old_text": "Call->getCalleeDecl()",
          "new_text": null,
          "old_line_content": "    NamedDecl *Decl = dyn_cast<NamedDecl>(Call->getCalleeDecl());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": "getLabel",
          "new_api": null,
          "old_text": "A->getLabel()",
          "new_text": null,
          "old_line_content": "      if (A->getLabel() == \"llvm.bpf.extra\") {",
          "new_line_content": "      // rewrites, and clang::Rewriter does not support rewrites in macros,",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": "getLocStart",
          "new_api": null,
          "old_text": "Call->getLocStart()",
          "new_text": null,
          "old_line_content": "        if (!rewriter_.isRewritable(Call->getLocStart())) {",
          "new_line_content": "      // unless one preprocesses the entire source file.",
          "content_same": false
        },
        {
          "line": 423,
          "old_api": "arguments",
          "new_api": null,
          "old_text": "Call->arguments()",
          "new_text": null,
          "old_line_content": "        for (auto arg : Call->arguments())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": "getSourceRange",
          "new_api": null,
          "old_text": "arg->getSourceRange()",
          "new_text": null,
          "old_line_content": "          args.push_back(rewriter_.getRewrittenText(expansionRange(arg->getSourceRange())));",
          "new_line_content": "        vector<string> args;",
          "content_same": false
        },
        {
          "line": 427,
          "old_api": "getName",
          "new_api": null,
          "old_text": "Decl->getName()",
          "new_text": null,
          "old_line_content": "        if (Decl->getName() == \"incr_cksum_l3\") {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": "str",
          "new_api": null,
          "old_text": "fn_args_[0]->getName().str()",
          "new_text": null,
          "old_line_content": "          text = \"bpf_l3_csum_replace_(\" + fn_args_[0]->getName().str() + \", (u64)\";",
          "new_line_content": "        string text;",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": "getName",
          "new_api": null,
          "old_text": "Decl->getName()",
          "new_text": null,
          "old_line_content": "        } else if (Decl->getName() == \"incr_cksum_l4\") {",
          "new_line_content": "          text += args[0] + \", \" + args[1] + \", \" + args[2] + \", sizeof(\" + args[2] + \"))\";",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": "getSourceRange",
          "new_api": null,
          "old_text": "Call->getSourceRange()",
          "new_text": null,
          "old_line_content": "          rewriter_.ReplaceText(expansionRange(Call->getSourceRange()), text);",
          "new_line_content": "          text += args[0] + \", \" + args[1] + \", \" + args[2];",
          "content_same": false
        },
        {
          "line": 436,
          "old_api": "getName",
          "new_api": null,
          "old_text": "Decl->getName()",
          "new_text": null,
          "old_line_content": "        } else if (Decl->getName() == \"bpf_trace_printk\") {",
          "new_line_content": "          text += \", ((\" + args[3] + \" & 0x1) << 4) | sizeof(\" + args[2] + \"))\";",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": "size",
          "new_api": null,
          "old_text": "args.size()",
          "new_text": null,
          "old_line_content": "          if (args.size() <= 1) {",
          "new_line_content": "          //    ({ char _fmt[] = fmt; bpf_trace_printk_(_fmt, sizeof(_fmt), args...); })",
          "content_same": false
        },
        {
          "line": 446,
          "old_api": "getLocEnd",
          "new_api": null,
          "old_text": "Call->getLocEnd()",
          "new_text": null,
          "old_line_content": "            rewriter_.InsertTextAfter(Call->getLocEnd(), \"); }\");",
          "new_line_content": "          } else {",
          "content_same": false
        },
        {
          "line": 449,
          "old_api": "sysconf",
          "new_api": null,
          "old_text": "sysconf(_SC_NPROCESSORS_ONLN)",
          "new_text": null,
          "old_line_content": "          int numcpu = sysconf(_SC_NPROCESSORS_ONLN);",
          "new_line_content": "          }",
          "content_same": false
        },
        {
          "line": 452,
          "old_api": "to_string",
          "new_api": null,
          "old_text": "to_string(numcpu)",
          "new_text": null,
          "old_line_content": "          text = to_string(numcpu);",
          "new_line_content": "          if (numcpu <= 0)",
          "content_same": false
        },
        {
          "line": 453,
          "old_api": "getSourceRange",
          "new_api": null,
          "old_text": "Call->getSourceRange()",
          "new_text": null,
          "old_line_content": "          rewriter_.ReplaceText(expansionRange(Call->getSourceRange()), text);",
          "new_line_content": "            numcpu = 1;",
          "content_same": false
        },
        {
          "line": 461,
          "old_api": "getSourceRange",
          "new_api": null,
          "old_text": "Call->getSourceRange()",
          "new_text": null,
          "old_line_content": "          rewriter_.ReplaceText(expansionRange(Call->getSourceRange()), text);",
          "new_line_content": "                  \", (void *)__addr);\";",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": "getName",
          "new_api": null,
          "old_text": "Decl->getName()",
          "new_text": null,
          "old_line_content": "        } else if (Decl->getName() == \"bpf_usdt_readarg\") {",
          "new_line_content": "          text += \"})\";",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": "getSourceRange",
          "new_api": null,
          "old_text": "Call->getSourceRange()",
          "new_text": null,
          "old_line_content": "          rewriter_.ReplaceText(expansionRange(Call->getSourceRange()), text);",
          "new_line_content": "          text = \"_bpf_readarg_\" + current_fn_ + \"_\" + args[0] + \"(\" + args[1] +",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": "dyn_cast<FunctionDecl>(Decl)",
          "new_api": null,
          "old_text": "dyn_cast<FunctionDecl>(Decl)",
          "new_text": null,
          "old_line_content": "    } else if (FunctionDecl *F = dyn_cast<FunctionDecl>(Decl)) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": "getBuiltinID",
          "new_api": null,
          "old_text": "F->getBuiltinID()",
          "new_text": null,
          "old_line_content": "      if (F->isExternallyVisible() && !F->getBuiltinID()) {",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": "length",
          "new_api": null,
          "old_text": "fmt.length()",
          "new_text": null,
          "old_line_content": "  for (i = 0; i < fmt.length(); i++) {",
          "new_line_content": "  unsigned nb_specifiers = 0, i, j;",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": "isspace",
          "new_api": null,
          "old_text": "isspace(fmt[i])",
          "new_text": null,
          "old_line_content": "    if (!isascii(fmt[i]) || (!isprint(fmt[i]) && !isspace(fmt[i]))) {",
          "new_line_content": "  bool has_s = false;",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": "getLocWithOffset",
          "new_api": null,
          "old_text": "loc.getLocWithOffset(i)",
          "new_text": null,
          "old_line_content": "      warning(loc.getLocWithOffset(i), \"cannot use more than 3 conversion specifiers\");",
          "new_line_content": "      continue;",
          "content_same": false
        },
        {
          "line": 502,
          "old_api": "ispunct",
          "new_api": null,
          "old_text": "ispunct(fmt[i])",
          "new_text": null,
          "old_line_content": "      if (!isspace(fmt[i]) && !ispunct(fmt[i]) && fmt[i] != 0) {",
          "new_line_content": "    } else if (fmt[i] == 'p' || fmt[i] == 's') {",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": "getLocWithOffset",
          "new_api": null,
          "old_text": "loc.getLocWithOffset(i - 2)",
          "new_text": null,
          "old_line_content": "        warning(loc.getLocWithOffset(i - 2),",
          "new_line_content": "      i++;",
          "content_same": false
        },
        {
          "line": 509,
          "old_api": "getLocWithOffset",
          "new_api": null,
          "old_text": "loc.getLocWithOffset(i - 2)",
          "new_text": null,
          "old_line_content": "          warning(loc.getLocWithOffset(i - 2), \"cannot use several %%s conversion specifiers\");",
          "new_line_content": "      if (fmt[i - 1] == 's') {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 63,
      "total_additions": 94,
      "total_deletions": 94,
      "total_api_changes": 251
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 251,
        "non_api_lines": 6,
        "non_api_line_numbers": [
          335,
          336,
          337,
          338,
          339,
          340
        ]
      }
    },
    "api_calls_before": 533,
    "api_calls_after": 533,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 4,
      "total_diff_lines": 24
    }
  }
}