{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/hyperscan/modified_file/698653766bf8bf8559f315b0518b12d9b88de4d0",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/hyperscan/modified_file/698653766bf8bf8559f315b0518b12d9b88de4d0/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/hyperscan/modified_file/698653766bf8bf8559f315b0518b12d9b88de4d0/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/hyperscan/modified_file/698653766bf8bf8559f315b0518b12d9b88de4d0/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 393,
          "old_api": "clear",
          "new_api": "size",
          "old_text": "rv.double_byte.clear()",
          "new_text": "rv.double_byte.size()",
          "old_line_content": "            rv.double_byte.clear();",
          "new_line_content": "        assert(outs2_broken || rv.double_byte.size() <= 8);",
          "content_same": false
        },
        {
          "line": 399,
          "old_api": "is_triggered",
          "new_api": "get_sds_or_proxy",
          "old_text": "is_triggered(rdfa.kind)",
          "new_text": "get_sds_or_proxy(rdfa)",
          "old_line_content": "    if (!double_byte_ok(rv) && !is_triggered(rdfa.kind) &&",
          "new_line_content": "    DEBUG_PRINTF(\"this %u, sds proxy %hu\\n\", this_idx, get_sds_or_proxy(rdfa));",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": "DEBUG_PRINTF",
          "new_api": "is_triggered",
          "old_text": "DEBUG_PRINTF(\"looking for offset accel at %u\\n\", this_idx)",
          "new_text": "is_triggered(rdfa.kind)",
          "old_line_content": "        DEBUG_PRINTF(\"looking for offset accel at %u\\n\", this_idx);",
          "new_line_content": "    if (!double_byte_ok(rv) && !is_triggered(rdfa.kind) &&",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": "max_allowed_offset_accel",
          "new_api": "DEBUG_PRINTF",
          "old_text": "max_allowed_offset_accel()",
          "new_text": "DEBUG_PRINTF(\"looking for offset accel at %u\\n\", this_idx)",
          "old_line_content": "            look_for_offset_accel(rdfa, this_idx, max_allowed_offset_accel());",
          "new_line_content": "        DEBUG_PRINTF(\"looking for offset accel at %u\\n\", this_idx);",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": "count",
          "new_api": "max_allowed_offset_accel",
          "old_text": "rv.cr.count()",
          "new_text": "max_allowed_offset_accel()",
          "old_line_content": "        if (double_byte_ok(offset) || offset.cr.count() < rv.cr.count()) {",
          "new_line_content": "            look_for_offset_accel(rdfa, this_idx, max_allowed_offset_accel());",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": "DEBUG_PRINTF",
          "new_api": "count",
          "old_text": "DEBUG_PRINTF(\"using offset accel\\n\")",
          "new_text": "rv.cr.count()",
          "old_line_content": "            DEBUG_PRINTF(\"using offset accel\\n\");",
          "new_line_content": "        DEBUG_PRINTF(\"width %zu vs %zu\\n\", offset.cr.count(), rv.cr.count());",
          "content_same": false
        },
        {
          "line": 422,
          "old_api": "verify_u8",
          "new_api": "DEBUG_PRINTF",
          "old_text": "verify_u8(info.offset)",
          "new_text": "DEBUG_PRINTF(\"accelerations scheme has offset s%u/d%u\\n\", info.offset,\n                 info.double_offset)",
          "old_line_content": "    accel->generic.offset = verify_u8(info.offset);",
          "new_line_content": "    DEBUG_PRINTF(\"accelerations scheme has offset s%u/d%u\\n\", info.offset,",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": "none",
          "new_api": "verify_u8",
          "old_text": "info.double_cr.none()",
          "new_text": "verify_u8(info.offset)",
          "old_line_content": "    if (double_byte_ok(info) && info.double_cr.none() &&",
          "new_line_content": "    accel->generic.offset = verify_u8(info.offset);",
          "content_same": false
        },
        {
          "line": 427,
          "old_api": "begin",
          "new_api": "size",
          "old_text": "info.double_byte.begin()",
          "new_text": "info.double_byte.size()",
          "old_line_content": "        accel->dverm.c1 = info.double_byte.begin()->first;",
          "new_line_content": "        info.double_byte.size() == 1) {",
          "content_same": false
        },
        {
          "line": 429,
          "old_api": "verify_u8",
          "new_api": "begin",
          "old_text": "verify_u8(info.double_offset)",
          "new_text": "info.double_byte.begin()",
          "old_line_content": "        accel->dverm.offset = verify_u8(info.double_offset);",
          "new_line_content": "        accel->dverm.c1 = info.double_byte.begin()->first;",
          "content_same": false
        },
        {
          "line": 430,
          "old_api": "DEBUG_PRINTF",
          "new_api": "begin",
          "old_text": "DEBUG_PRINTF(\"state %hu is double vermicelli\\n\", this_idx)",
          "new_text": "info.double_byte.begin()",
          "old_line_content": "        DEBUG_PRINTF(\"state %hu is double vermicelli\\n\", this_idx);",
          "new_line_content": "        accel->dverm.c2 = info.double_byte.begin()->second;",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": "begin",
          "new_api": "empty",
          "old_text": "info.double_byte.begin()",
          "new_text": "info.double_byte.empty()",
          "old_line_content": "        u8 secondC = info.double_byte.begin()->second & CASE_CLEAR;",
          "new_line_content": "        assert(!info.double_byte.empty());",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "verify_u8",
          "new_api": "buildDvermMask",
          "old_text": "verify_u8(info.double_offset)",
          "new_text": "buildDvermMask(info.double_byte, &m1, &m2)",
          "old_line_content": "            accel->dverm.offset = verify_u8(info.double_offset);",
          "new_line_content": "        if (buildDvermMask(info.double_byte, &m1, &m2)) {",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": "begin",
          "new_api": "verify_u8",
          "old_text": "info.double_byte.begin()",
          "new_text": "verify_u8(info.double_offset)",
          "old_line_content": "            accel->dverm.c2 = info.double_byte.begin()->second & m2;",
          "new_line_content": "            accel->dverm.offset = verify_u8(info.double_offset);",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": "DEBUG_PRINTF",
          "new_api": "none",
          "old_text": "DEBUG_PRINTF(\"state %hu is a dead end full of bureaucratic red tape\"\n                     \" from which there is no escape\\n\",\n                     this_idx)",
          "new_text": "info.cr.none()",
          "old_line_content": "        DEBUG_PRINTF(\"state %hu is a dead end full of bureaucratic red tape\"",
          "new_line_content": "    if (info.cr.none()) {",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": "find_first",
          "new_api": "count",
          "old_text": "info.cr.find_first()",
          "new_text": "info.cr.count()",
          "old_line_content": "        accel->verm.c = info.cr.find_first();",
          "new_line_content": "    if (info.cr.count() == 1) {",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": "find_first",
          "new_api": "isCaselessChar",
          "old_text": "info.cr.find_first()",
          "new_text": "info.cr.isCaselessChar()",
          "old_line_content": "        accel->verm.c = info.cr.find_first() & CASE_CLEAR;",
          "new_line_content": "    if (info.cr.count() == 2 && info.cr.isCaselessChar()) {",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": "DEBUG_PRINTF",
          "new_api": "max_floating_stop_char",
          "old_text": "DEBUG_PRINTF(\"state %hu is too broad\\n\", this_idx)",
          "new_text": "max_floating_stop_char()",
          "old_line_content": "        DEBUG_PRINTF(\"state %hu is too broad\\n\", this_idx);",
          "new_line_content": "    if (info.cr.count() > max_floating_stop_char()) {",
          "content_same": false
        },
        {
          "line": 517,
          "old_api": "DEBUG_PRINTF",
          "new_api": "shuftiBuildMasks",
          "old_text": "DEBUG_PRINTF(\"state %hu is shufti\\n\", this_idx)",
          "new_text": "shuftiBuildMasks(info.cr, (u8 *)&accel->shufti.lo,\n                               (u8 *)&accel->shufti.hi)",
          "old_line_content": "        DEBUG_PRINTF(\"state %hu is shufti\\n\", this_idx);",
          "new_line_content": "    if (-1 != shuftiBuildMasks(info.cr, (u8 *)&accel->shufti.lo,",
          "content_same": false
        },
        {
          "line": 523,
          "old_api": "truffleBuildMasks",
          "new_api": "none",
          "old_text": "truffleBuildMasks(info.cr, (u8 *)&accel->truffle.mask1,\n                      (u8 *)&accel->truffle.mask2)",
          "new_text": "info.cr.none()",
          "old_line_content": "    truffleBuildMasks(info.cr, (u8 *)&accel->truffle.mask1,",
          "new_line_content": "    assert(!info.cr.none());",
          "content_same": false
        },
        {
          "line": 525,
          "old_api": "DEBUG_PRINTF",
          "new_api": "truffleBuildMasks",
          "old_text": "DEBUG_PRINTF(\"state %hu is truffle\\n\", this_idx)",
          "new_text": "truffleBuildMasks(info.cr, (u8 *)&accel->truffle.mask1,\n                      (u8 *)&accel->truffle.mask2)",
          "old_line_content": "    DEBUG_PRINTF(\"state %hu is truffle\\n\", this_idx);",
          "new_line_content": "    truffleBuildMasks(info.cr, (u8 *)&accel->truffle.mask1,",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": "size",
          "new_api": "DEBUG_PRINTF",
          "old_text": "rdfa.states.size()",
          "new_text": "DEBUG_PRINTF(\"sds %hu\\n\", sds_proxy)",
          "old_line_content": "    for (size_t i = 0; i < rdfa.states.size(); i++) {",
          "new_line_content": "    DEBUG_PRINTF(\"sds %hu\\n\", sds_proxy);",
          "content_same": false
        },
        {
          "line": 556,
          "old_api": "find_escape_strings",
          "new_api": "DEBUG_PRINTF",
          "old_text": "find_escape_strings(i)",
          "new_text": "DEBUG_PRINTF(\"inspecting %zu/%hu: %zu\\n\", i, sds_proxy, single_limit)",
          "old_line_content": "        AccelScheme ei = find_escape_strings(i);",
          "new_line_content": "        DEBUG_PRINTF(\"inspecting %zu/%hu: %zu\\n\", i, sds_proxy, single_limit);",
          "content_same": false
        },
        {
          "line": 558,
          "old_api": "count",
          "new_api": "find_escape_strings",
          "old_text": "DEBUG_PRINTF(\"state %zu is not accelerable has %zu\\n\", i,\n                         ei.cr.count())",
          "new_text": "find_escape_strings(i)",
          "old_line_content": "            DEBUG_PRINTF(\"state %zu is not accelerable has %zu\\n\", i,",
          "new_line_content": "        AccelScheme ei = find_escape_strings(i);",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": "clear",
          "new_api": "contains",
          "old_text": "sds_ei.double_byte.clear()",
          "new_text": "contains(rv, sds_proxy)",
          "old_line_content": "        sds_ei.double_byte.clear(); /* region based on single byte scheme",
          "new_line_content": "    if (contains(rv, sds_proxy)) {",
          "content_same": false
        },
        {
          "line": 573,
          "old_api": "count",
          "new_api": "clear",
          "old_text": "DEBUG_PRINTF(\"looking to expand offset accel to nearby states, %zu\\n\",\n                     sds_ei.cr.count())",
          "new_text": "sds_ei.double_byte.clear()",
          "old_line_content": "        DEBUG_PRINTF(\"looking to expand offset accel to nearby states, %zu\\n\",",
          "new_line_content": "        sds_ei.double_byte.clear(); /* region based on single byte scheme",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": "find_region",
          "new_api": "count",
          "old_text": "find_region(rdfa, sds_proxy, sds_ei)",
          "new_text": "DEBUG_PRINTF(\"looking to expand offset accel to nearby states, %zu\\n\",\n                     sds_ei.cr.count())",
          "old_line_content": "        auto sds_region = find_region(rdfa, sds_proxy, sds_ei);",
          "new_line_content": "        DEBUG_PRINTF(\"looking to expand offset accel to nearby states, %zu\\n\",",
          "content_same": false
        },
        {
          "line": 577,
          "old_api": "better",
          "new_api": "find_region",
          "old_text": "better(sds_ei, rv[s])",
          "new_text": "find_region(rdfa, sds_proxy, sds_ei)",
          "old_line_content": "            if (!contains(rv, s) || better(sds_ei, rv[s])) {",
          "new_line_content": "        auto sds_region = find_region(rdfa, sds_proxy, sds_ei);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 512,
          "old_api": null,
          "new_api": "DEBUG_PRINTF",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\"state %hu is too broad\\n\", this_idx)",
          "old_line_content": "    }",
          "new_line_content": "        DEBUG_PRINTF(\"state %hu is too broad\\n\", this_idx);",
          "content_same": false
        },
        {
          "line": 519,
          "old_api": null,
          "new_api": "DEBUG_PRINTF",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\"state %hu is shufti\\n\", this_idx)",
          "old_line_content": "    }",
          "new_line_content": "        DEBUG_PRINTF(\"state %hu is shufti\\n\", this_idx);",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "rv.double_byte.clear()",
          "old_line_content": "    }",
          "new_line_content": "            rv.double_byte.clear();",
          "content_same": false
        },
        {
          "line": 527,
          "old_api": null,
          "new_api": "DEBUG_PRINTF",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\"state %hu is truffle\\n\", this_idx)",
          "old_line_content": "",
          "new_line_content": "    DEBUG_PRINTF(\"state %hu is truffle\\n\", this_idx);",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": null,
          "new_api": "DEBUG_PRINTF",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\"broken %d\\n\", outs2_broken)",
          "old_line_content": "        this_idx == rdfa.start_floating && this_idx != DEAD_STATE) {",
          "new_line_content": "    DEBUG_PRINTF(\"broken %d\\n\", outs2_broken);",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": null,
          "new_api": "get_raw",
          "old_text": null,
          "new_text": "get_raw()",
          "old_line_content": "        return rv;",
          "new_line_content": "    raw_dfa &rdfa = get_raw();",
          "content_same": false
        },
        {
          "line": 407,
          "old_api": null,
          "new_api": "count",
          "old_text": null,
          "new_text": "rv.cr.count()",
          "old_line_content": "            rv = offset;",
          "new_line_content": "        if (double_byte_ok(offset) || offset.cr.count() < rv.cr.count()) {",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": null,
          "new_api": "DEBUG_PRINTF",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\"using offset accel\\n\")",
          "old_line_content": "        }",
          "new_line_content": "            DEBUG_PRINTF(\"using offset accel\\n\");",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": null,
          "new_api": "get_sds_or_proxy",
          "old_text": null,
          "new_text": "get_sds_or_proxy(rdfa)",
          "old_line_content": "",
          "new_line_content": "    dstate_id_t sds_proxy = get_sds_or_proxy(rdfa);",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "rdfa.states.size()",
          "old_line_content": "            continue;",
          "new_line_content": "    for (size_t i = 0; i < rdfa.states.size(); i++) {",
          "content_same": false
        },
        {
          "line": 550,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "rdfa.states[i].reports.empty()",
          "old_line_content": "        }",
          "new_line_content": "        if (generates_callbacks(rdfa.kind) && !rdfa.states[i].reports.empty()) {",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": null,
          "new_api": "none",
          "old_text": null,
          "new_text": "info.double_cr.none()",
          "old_line_content": "        accel->accel_type = ACCEL_DVERM;",
          "new_line_content": "    if (double_byte_ok(info) && info.double_cr.none() &&",
          "content_same": false
        },
        {
          "line": 555,
          "old_api": null,
          "new_api": "max_stop_char",
          "old_text": null,
          "new_text": "max_stop_char()",
          "old_line_content": "",
          "new_line_content": "            i == sds_proxy ? max_floating_stop_char() : max_stop_char();",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": null,
          "new_api": "verify_u8",
          "old_text": null,
          "new_text": "verify_u8(info.double_offset)",
          "old_line_content": "        return;",
          "new_line_content": "        accel->dverm.offset = verify_u8(info.double_offset);",
          "content_same": false
        },
        {
          "line": 560,
          "old_api": null,
          "new_api": "count",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\"state %zu is not accelerable has %zu\\n\", i,\n                         ei.cr.count())",
          "old_line_content": "            continue;",
          "new_line_content": "            DEBUG_PRINTF(\"state %zu is not accelerable has %zu\\n\", i,",
          "content_same": false
        },
        {
          "line": 561,
          "old_api": null,
          "new_api": "count",
          "old_text": null,
          "new_text": "ei.cr.count()",
          "old_line_content": "        }",
          "new_line_content": "                         ei.cr.count());",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": null,
          "new_api": "DEBUG_PRINTF",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\"state %hu is double vermicelli\\n\", this_idx)",
          "old_line_content": "    }",
          "new_line_content": "        DEBUG_PRINTF(\"state %hu is double vermicelli\\n\", this_idx);",
          "content_same": false
        },
        {
          "line": 436,
          "old_api": null,
          "new_api": "none",
          "old_text": null,
          "new_text": "info.double_cr.none()",
          "old_line_content": "        bool ok = true;",
          "new_line_content": "    if (double_byte_ok(info) && info.double_cr.none() &&",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": null,
          "new_api": "count",
          "old_text": null,
          "new_text": "ei.cr.count()",
          "old_line_content": "        rv[i] = ei;",
          "new_line_content": "        DEBUG_PRINTF(\"state %zu should be accelerable %zu\\n\", i, ei.cr.count());",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "info.double_byte.size()",
          "old_line_content": "",
          "new_line_content": "        (info.double_byte.size() == 2 || info.double_byte.size() == 4)) {",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": null,
          "new_api": "begin",
          "old_text": null,
          "new_text": "info.double_byte.begin()",
          "old_line_content": "",
          "new_line_content": "        u8 firstC = info.double_byte.begin()->first & CASE_CLEAR;",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": null,
          "new_api": "begin",
          "old_text": null,
          "new_text": "info.double_byte.begin()",
          "old_line_content": "        for (const pair<u8, u8> &p : info.double_byte) {",
          "new_line_content": "        u8 secondC = info.double_byte.begin()->second & CASE_CLEAR;",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": null,
          "new_api": "count",
          "old_text": null,
          "new_text": "sds_ei.cr.count()",
          "old_line_content": "        for (auto s : sds_region) {",
          "new_line_content": "                     sds_ei.cr.count());",
          "content_same": false
        },
        {
          "line": 579,
          "old_api": null,
          "new_api": "better",
          "old_text": null,
          "new_text": "better(sds_ei, rv[s])",
          "old_line_content": "            }",
          "new_line_content": "            if (!contains(rv, s) || better(sds_ei, rv[s])) {",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": null,
          "new_api": "verify_u8",
          "old_text": null,
          "new_text": "verify_u8(info.double_offset)",
          "old_line_content": "            return;",
          "new_line_content": "            accel->dverm.offset = verify_u8(info.double_offset);",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": null,
          "new_api": "DEBUG_PRINTF",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\"state %hu is nc double vermicelli\\n\", this_idx)",
          "old_line_content": "        }",
          "new_line_content": "            DEBUG_PRINTF(\"state %hu is nc double vermicelli\\n\", this_idx);",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": null,
          "new_api": "begin",
          "old_text": null,
          "new_text": "info.double_byte.begin()",
          "old_line_content": "            accel->dverm.m1 = m1;",
          "new_line_content": "            accel->dverm.c1 = info.double_byte.begin()->first & m1;",
          "content_same": false
        },
        {
          "line": 467,
          "old_api": null,
          "new_api": "begin",
          "old_text": null,
          "new_text": "info.double_byte.begin()",
          "old_line_content": "            accel->dverm.m2 = m2;",
          "new_line_content": "            accel->dverm.c2 = info.double_byte.begin()->second & m2;",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": null,
          "new_api": "DEBUG_PRINTF",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\n                \"building maskeddouble-vermicelli for 0x%02hhx%02hhx\\n\",\n                accel->dverm.c1, accel->dverm.c2)",
          "old_line_content": "                accel->dverm.c1, accel->dverm.c2);",
          "new_line_content": "            DEBUG_PRINTF(",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": null,
          "new_api": "double_byte_ok",
          "old_text": null,
          "new_text": "double_byte_ok(info)",
          "old_line_content": "            info.double_cr, info.double_byte, (u8 *)&accel->dshufti.lo1,",
          "new_line_content": "    if (double_byte_ok(info) &&",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": null,
          "new_api": "shuftiBuildDoubleMasks",
          "old_text": null,
          "new_text": "shuftiBuildDoubleMasks(\n            info.double_cr, info.double_byte, (u8 *)&accel->dshufti.lo1,\n            (u8 *)&accel->dshufti.hi1, (u8 *)&accel->dshufti.lo2,\n            (u8 *)&accel->dshufti.hi2)",
          "old_line_content": "            (u8 *)&accel->dshufti.hi1, (u8 *)&accel->dshufti.lo2,",
          "new_line_content": "        shuftiBuildDoubleMasks(",
          "content_same": false
        },
        {
          "line": 483,
          "old_api": null,
          "new_api": "verify_u8",
          "old_text": null,
          "new_text": "verify_u8(info.double_offset)",
          "old_line_content": "        return;",
          "new_line_content": "        accel->dshufti.offset = verify_u8(info.double_offset);",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": null,
          "new_api": "DEBUG_PRINTF",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\"state %hu is double shufti\\n\", this_idx)",
          "old_line_content": "    }",
          "new_line_content": "        DEBUG_PRINTF(\"state %hu is double shufti\\n\", this_idx);",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": null,
          "new_api": "DEBUG_PRINTF",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\"state %hu is a dead end full of bureaucratic red tape\"\n                     \" from which there is no escape\\n\",\n                     this_idx)",
          "old_line_content": "                     this_idx);",
          "new_line_content": "        DEBUG_PRINTF(\"state %hu is a dead end full of bureaucratic red tape\"",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": null,
          "new_api": "find_first",
          "old_text": null,
          "new_text": "info.cr.find_first()",
          "old_line_content": "        return;",
          "new_line_content": "        accel->verm.c = info.cr.find_first();",
          "content_same": false
        },
        {
          "line": 499,
          "old_api": null,
          "new_api": "DEBUG_PRINTF",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\"state %hu is vermicelli\\n\", this_idx)",
          "old_line_content": "    }",
          "new_line_content": "        DEBUG_PRINTF(\"state %hu is vermicelli\\n\", this_idx);",
          "content_same": false
        },
        {
          "line": 505,
          "old_api": null,
          "new_api": "find_first",
          "old_text": null,
          "new_text": "info.cr.find_first()",
          "old_line_content": "        return;",
          "new_line_content": "        accel->verm.c = info.cr.find_first() & CASE_CLEAR;",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": null,
          "new_api": "DEBUG_PRINTF",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\"state %hu is caseless vermicelli\\n\", this_idx)",
          "old_line_content": "    }",
          "new_line_content": "        DEBUG_PRINTF(\"state %hu is caseless vermicelli\\n\", this_idx);",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "rv.double_byte.size()",
          "old_line_content": "                    }",
          "new_line_content": "                        if (rv.double_byte.size() > 8) {",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": null,
          "new_api": "DEBUG_PRINTF",
          "old_text": null,
          "new_text": "DEBUG_PRINTF(\"outs2 too big\\n\")",
          "old_line_content": "                }",
          "new_line_content": "                            DEBUG_PRINTF(\"outs2 too big\\n\");",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 515,
          "old_api": "shuftiBuildMasks",
          "new_api": null,
          "old_text": "shuftiBuildMasks(info.cr, (u8 *)&accel->shufti.lo,\n                               (u8 *)&accel->shufti.hi)",
          "new_text": null,
          "old_line_content": "    if (-1 != shuftiBuildMasks(info.cr, (u8 *)&accel->shufti.lo,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": "size",
          "new_api": null,
          "old_text": "rv.double_byte.size()",
          "new_text": null,
          "old_line_content": "        if (rv.double_byte.size() > 8) {",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "DEBUG_PRINTF",
          "new_api": null,
          "old_text": "DEBUG_PRINTF(\"outs2 too big\\n\")",
          "new_text": null,
          "old_line_content": "            DEBUG_PRINTF(\"outs2 too big\\n\");",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": "none",
          "new_api": null,
          "old_text": "info.cr.none()",
          "new_text": null,
          "old_line_content": "    assert(!info.cr.none());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": "get_sds_or_proxy",
          "new_api": null,
          "old_text": "get_sds_or_proxy(rdfa)",
          "new_text": null,
          "old_line_content": "    DEBUG_PRINTF(\"this %u, sds proxy %hu\\n\", this_idx, get_sds_or_proxy(rdfa));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": "DEBUG_PRINTF",
          "new_api": null,
          "old_text": "DEBUG_PRINTF(\"broken %d\\n\", outs2_broken)",
          "new_text": null,
          "old_line_content": "    DEBUG_PRINTF(\"broken %d\\n\", outs2_broken);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": "get_raw",
          "new_api": null,
          "old_text": "get_raw()",
          "new_text": null,
          "old_line_content": "    raw_dfa &rdfa = get_raw();",
          "new_line_content": "accel_dfa_build_strat::getAccelInfo(const Grey &grey) {",
          "content_same": false
        },
        {
          "line": 404,
          "old_api": "count",
          "new_api": null,
          "old_text": "rv.cr.count()",
          "new_text": null,
          "old_line_content": "        DEBUG_PRINTF(\"width %zu vs %zu\\n\", offset.cr.count(), rv.cr.count());",
          "new_line_content": "        auto offset =",
          "content_same": false
        },
        {
          "line": 536,
          "old_api": "get_sds_or_proxy",
          "new_api": null,
          "old_text": "get_sds_or_proxy(rdfa)",
          "new_text": null,
          "old_line_content": "    dstate_id_t sds_proxy = get_sds_or_proxy(rdfa);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": "DEBUG_PRINTF",
          "new_api": null,
          "old_text": "DEBUG_PRINTF(\"sds %hu\\n\", sds_proxy)",
          "new_text": null,
          "old_line_content": "    DEBUG_PRINTF(\"sds %hu\\n\", sds_proxy);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 548,
          "old_api": "empty",
          "new_api": null,
          "old_text": "rdfa.states[i].reports.empty()",
          "new_text": null,
          "old_line_content": "        if (generates_callbacks(rdfa.kind) && !rdfa.states[i].reports.empty()) {",
          "new_line_content": "         * are spamming out callbacks, the QR code paths don't raise reports",
          "content_same": false
        },
        {
          "line": 420,
          "old_api": "DEBUG_PRINTF",
          "new_api": null,
          "old_text": "DEBUG_PRINTF(\"accelerations scheme has offset s%u/d%u\\n\", info.offset,\n                 info.double_offset)",
          "new_text": null,
          "old_line_content": "    DEBUG_PRINTF(\"accelerations scheme has offset s%u/d%u\\n\", info.offset,",
          "new_line_content": "    AccelAux *accel = (AccelAux *)accel_out;",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": "max_stop_char",
          "new_api": null,
          "old_text": "max_stop_char()",
          "new_text": null,
          "old_line_content": "            i == sds_proxy ? max_floating_stop_char() : max_stop_char();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": "DEBUG_PRINTF",
          "new_api": null,
          "old_text": "DEBUG_PRINTF(\"inspecting %zu/%hu: %zu\\n\", i, sds_proxy, single_limit)",
          "new_text": null,
          "old_line_content": "        DEBUG_PRINTF(\"inspecting %zu/%hu: %zu\\n\", i, sds_proxy, single_limit);",
          "new_line_content": "        size_t single_limit =",
          "content_same": false
        },
        {
          "line": 425,
          "old_api": "size",
          "new_api": null,
          "old_text": "info.double_byte.size()",
          "new_text": null,
          "old_line_content": "        info.double_byte.size() == 1) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": "begin",
          "new_api": null,
          "old_text": "info.double_byte.begin()",
          "new_text": null,
          "old_line_content": "        accel->dverm.c2 = info.double_byte.begin()->second;",
          "new_line_content": "        accel->accel_type = ACCEL_DVERM;",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": "count",
          "new_api": null,
          "old_text": "ei.cr.count()",
          "new_text": null,
          "old_line_content": "        if (ei.cr.count() > single_limit) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": "none",
          "new_api": null,
          "old_text": "info.double_cr.none()",
          "new_text": null,
          "old_line_content": "    if (double_byte_ok(info) && info.double_cr.none() &&",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": "count",
          "new_api": null,
          "old_text": "ei.cr.count()",
          "new_text": null,
          "old_line_content": "        DEBUG_PRINTF(\"state %zu should be accelerable %zu\\n\", i, ei.cr.count());",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": "size",
          "new_api": null,
          "old_text": "info.double_byte.size()",
          "new_text": null,
          "old_line_content": "        (info.double_byte.size() == 2 || info.double_byte.size() == 4)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": "empty",
          "new_api": null,
          "old_text": "info.double_byte.empty()",
          "new_text": null,
          "old_line_content": "        assert(!info.double_byte.empty());",
          "new_line_content": "        bool ok = true;",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": "begin",
          "new_api": null,
          "old_text": "info.double_byte.begin()",
          "new_text": null,
          "old_line_content": "        u8 firstC = info.double_byte.begin()->first & CASE_CLEAR;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "contains",
          "new_api": null,
          "old_text": "contains(rv, sds_proxy)",
          "new_text": null,
          "old_line_content": "    if (contains(rv, sds_proxy)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": "count",
          "new_api": null,
          "old_text": "sds_ei.cr.count()",
          "new_text": null,
          "old_line_content": "                     sds_ei.cr.count());",
          "new_line_content": "                                     * may differ from double byte */",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": "verify_u8",
          "new_api": null,
          "old_text": "verify_u8(info.double_offset)",
          "new_text": null,
          "old_line_content": "            accel->dverm.offset = verify_u8(info.double_offset);",
          "new_line_content": "            accel->dverm.c1 = firstC;",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": "DEBUG_PRINTF",
          "new_api": null,
          "old_text": "DEBUG_PRINTF(\"state %hu is nc double vermicelli\\n\", this_idx)",
          "new_text": null,
          "old_line_content": "            DEBUG_PRINTF(\"state %hu is nc double vermicelli\\n\", this_idx);",
          "new_line_content": "            accel->dverm.c2 = secondC;",
          "content_same": false
        },
        {
          "line": 461,
          "old_api": "buildDvermMask",
          "new_api": null,
          "old_text": "buildDvermMask(info.double_byte, &m1, &m2)",
          "new_text": null,
          "old_line_content": "        if (buildDvermMask(info.double_byte, &m1, &m2)) {",
          "new_line_content": "        u8 m1;",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": "begin",
          "new_api": null,
          "old_text": "info.double_byte.begin()",
          "new_text": null,
          "old_line_content": "            accel->dverm.c1 = info.double_byte.begin()->first & m1;",
          "new_line_content": "            accel->accel_type = ACCEL_DVERM_MASKED;",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": "DEBUG_PRINTF",
          "new_api": null,
          "old_text": "DEBUG_PRINTF(\n                \"building maskeddouble-vermicelli for 0x%02hhx%02hhx\\n\",\n                accel->dverm.c1, accel->dverm.c2)",
          "new_text": null,
          "old_line_content": "            DEBUG_PRINTF(",
          "new_line_content": "            accel->dverm.m1 = m1;",
          "content_same": false
        },
        {
          "line": 475,
          "old_api": "double_byte_ok",
          "new_api": null,
          "old_text": "double_byte_ok(info)",
          "new_text": null,
          "old_line_content": "    if (double_byte_ok(info) &&",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": "shuftiBuildDoubleMasks",
          "new_api": null,
          "old_text": "shuftiBuildDoubleMasks(\n            info.double_cr, info.double_byte, (u8 *)&accel->dshufti.lo1,\n            (u8 *)&accel->dshufti.hi1, (u8 *)&accel->dshufti.lo2,\n            (u8 *)&accel->dshufti.hi2)",
          "new_text": null,
          "old_line_content": "        shuftiBuildDoubleMasks(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 481,
          "old_api": "verify_u8",
          "new_api": null,
          "old_text": "verify_u8(info.double_offset)",
          "new_text": null,
          "old_line_content": "        accel->dshufti.offset = verify_u8(info.double_offset);",
          "new_line_content": "            (u8 *)&accel->dshufti.hi2)) {",
          "content_same": false
        },
        {
          "line": 482,
          "old_api": "DEBUG_PRINTF",
          "new_api": null,
          "old_text": "DEBUG_PRINTF(\"state %hu is double shufti\\n\", this_idx)",
          "new_text": null,
          "old_line_content": "        DEBUG_PRINTF(\"state %hu is double shufti\\n\", this_idx);",
          "new_line_content": "        accel->accel_type = ACCEL_DSHUFTI;",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": "none",
          "new_api": null,
          "old_text": "info.cr.none()",
          "new_text": null,
          "old_line_content": "    if (info.cr.none()) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": "count",
          "new_api": null,
          "old_text": "info.cr.count()",
          "new_text": null,
          "old_line_content": "    if (info.cr.count() == 1) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 497,
          "old_api": "DEBUG_PRINTF",
          "new_api": null,
          "old_text": "DEBUG_PRINTF(\"state %hu is vermicelli\\n\", this_idx)",
          "new_text": null,
          "old_line_content": "        DEBUG_PRINTF(\"state %hu is vermicelli\\n\", this_idx);",
          "new_line_content": "        accel->accel_type = ACCEL_VERM;",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": "isCaselessChar",
          "new_api": null,
          "old_text": "info.cr.isCaselessChar()",
          "new_text": null,
          "old_line_content": "    if (info.cr.count() == 2 && info.cr.isCaselessChar()) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": "DEBUG_PRINTF",
          "new_api": null,
          "old_text": "DEBUG_PRINTF(\"state %hu is caseless vermicelli\\n\", this_idx)",
          "new_text": null,
          "old_line_content": "        DEBUG_PRINTF(\"state %hu is caseless vermicelli\\n\", this_idx);",
          "new_line_content": "        accel->accel_type = ACCEL_VERM_NOCASE;",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": "max_floating_stop_char",
          "new_api": null,
          "old_text": "max_floating_stop_char()",
          "new_text": null,
          "old_line_content": "    if (info.cr.count() > max_floating_stop_char()) {",
          "new_line_content": "    }",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 28,
      "total_additions": 40,
      "total_deletions": 39,
      "total_api_changes": 107
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 13,
        "api_related_lines": 107,
        "non_api_lines": 8,
        "non_api_line_numbers": [
          384,
          385,
          2,
          386,
          389,
          390,
          391,
          392
        ]
      }
    },
    "api_calls_before": 209,
    "api_calls_after": 211,
    "diff_info": {
      "added_lines": 8,
      "removed_lines": 6,
      "total_diff_lines": 36
    }
  }
}