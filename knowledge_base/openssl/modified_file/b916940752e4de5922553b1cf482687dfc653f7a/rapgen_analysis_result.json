{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/openssl/modified_file/b916940752e4de5922553b1cf482687dfc653f7a",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/openssl/modified_file/b916940752e4de5922553b1cf482687dfc653f7a/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/openssl/modified_file/b916940752e4de5922553b1cf482687dfc653f7a/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/openssl/modified_file/b916940752e4de5922553b1cf482687dfc653f7a/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 576,
          "old_api": "ERR_raise",
          "new_api": "EC_POINT_new",
          "old_text": "ERR_raise(ERR_LIB_EC, EC_R_INVALID_GROUP_ORDER)",
          "new_text": "EC_POINT_new(eckey->group)",
          "old_line_content": "        ERR_raise(ERR_LIB_EC, EC_R_INVALID_GROUP_ORDER);",
          "new_line_content": "    point = EC_POINT_new(eckey->group);",
          "content_same": false
        },
        {
          "line": 581,
          "old_api": "ERR_raise",
          "new_api": "BN_is_zero",
          "old_text": "ERR_raise(ERR_LIB_EC, ERR_R_EC_LIB)",
          "new_text": "BN_is_zero(order)",
          "old_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_EC_LIB);",
          "new_line_content": "    if (BN_is_zero(order)) {",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": "EC_POINT_free",
          "new_api": "EC_POINT_is_at_infinity",
          "old_text": "EC_POINT_free(point)",
          "new_text": "EC_POINT_is_at_infinity(eckey->group, point)",
          "old_line_content": "    EC_POINT_free(point);",
          "new_line_content": "    if (!EC_POINT_is_at_infinity(eckey->group, point)) {",
          "content_same": false
        },
        {
          "line": 637,
          "old_api": "ERR_raise",
          "new_api": "EC_POINT_new",
          "old_text": "ERR_raise(ERR_LIB_EC, ERR_R_EC_LIB)",
          "new_text": "EC_POINT_new(eckey->group)",
          "old_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_EC_LIB);",
          "new_line_content": "    point = EC_POINT_new(eckey->group);",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": "EC_POINT_free",
          "new_api": "EC_POINT_cmp",
          "old_text": "EC_POINT_free(point)",
          "new_text": "EC_POINT_cmp(eckey->group, point, eckey->pub_key, ctx)",
          "old_line_content": "    EC_POINT_free(point);",
          "new_line_content": "    if (EC_POINT_cmp(eckey->group, point, eckey->pub_key, ctx) != 0) {",
          "content_same": false
        },
        {
          "line": 673,
          "old_api": "ossl_ec_key_public_check",
          "new_api": "ERR_raise",
          "old_text": "ossl_ec_key_public_check(eckey, ctx)",
          "new_text": "ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER)",
          "old_line_content": "    if (!ossl_ec_key_public_check(eckey, ctx))",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER);",
          "content_same": false
        },
        {
          "line": 683,
          "old_api": "BN_CTX_free",
          "new_api": "ossl_ec_key_private_check",
          "old_text": "BN_CTX_free(ctx)",
          "new_text": "ossl_ec_key_private_check(eckey)",
          "old_line_content": "    BN_CTX_free(ctx);",
          "new_line_content": "        if (!ossl_ec_key_private_check(eckey)",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": "BN_CTX_get",
          "new_api": "BN_CTX_start",
          "old_text": "BN_CTX_get(ctx)",
          "new_text": "BN_CTX_start(ctx)",
          "old_line_content": "    tx = BN_CTX_get(ctx);",
          "new_line_content": "    BN_CTX_start(ctx);",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": "BN_CTX_get",
          "new_api": "EC_POINT_new",
          "old_text": "BN_CTX_get(ctx)",
          "new_text": "EC_POINT_new(key->group)",
          "old_line_content": "    ty = BN_CTX_get(ctx);",
          "new_line_content": "    point = EC_POINT_new(key->group);",
          "content_same": false
        },
        {
          "line": 716,
          "old_api": "EC_POINT_get_affine_coordinates",
          "new_api": "BN_CTX_get",
          "old_text": "EC_POINT_get_affine_coordinates(key->group, point, tx, ty, ctx)",
          "new_text": "BN_CTX_get(ctx)",
          "old_line_content": "    if (!EC_POINT_get_affine_coordinates(key->group, point, tx, ty, ctx))",
          "new_line_content": "    ty = BN_CTX_get(ctx);",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": "EC_KEY_set_public_key",
          "new_api": "BN_cmp",
          "old_text": "EC_KEY_set_public_key(key, point)",
          "new_text": "BN_cmp(y, ty)",
          "old_line_content": "    if (!EC_KEY_set_public_key(key, point))",
          "new_line_content": "    if (BN_cmp(x, tx) || BN_cmp(y, ty)) {",
          "content_same": false
        },
        {
          "line": 738,
          "old_api": "BN_CTX_end",
          "new_api": "EC_KEY_check_key",
          "old_text": "BN_CTX_end(ctx)",
          "new_text": "EC_KEY_check_key(key)",
          "old_line_content": "    BN_CTX_end(ctx);",
          "new_line_content": "    if (EC_KEY_check_key(key) == 0)",
          "content_same": false
        },
        {
          "line": 866,
          "old_api": "bn_get_top",
          "new_api": "BN_dup",
          "old_text": "bn_get_top(order)",
          "new_text": "BN_dup(priv_key)",
          "old_line_content": "    fixed_top = bn_get_top(order) + 2;",
          "new_line_content": "    tmp_key = BN_dup(priv_key);",
          "content_same": false
        },
        {
          "line": 872,
          "old_api": "BN_clear_free",
          "new_api": "bn_get_top",
          "old_text": "BN_clear_free(key->priv_key)",
          "new_text": "bn_get_top(order)",
          "old_line_content": "    BN_clear_free(key->priv_key);",
          "new_line_content": "    fixed_top = bn_get_top(order) + 2;",
          "content_same": false
        },
        {
          "line": 920,
          "old_api": "EC_GROUP_set_asn1_flag",
          "new_api": "EC_GROUP_set_point_conversion_form",
          "old_text": "EC_GROUP_set_asn1_flag(key->group, flag)",
          "new_text": "EC_GROUP_set_point_conversion_form(key->group, cform)",
          "old_line_content": "        EC_GROUP_set_asn1_flag(key->group, flag);",
          "new_line_content": "        EC_GROUP_set_point_conversion_form(key->group, cform);",
          "content_same": false
        },
        {
          "line": 1050,
          "old_api": "ERR_raise",
          "new_api": "BN_secure_new",
          "old_text": "ERR_raise(ERR_LIB_EC, ERR_R_BN_LIB)",
          "new_text": "BN_secure_new()",
          "old_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_BN_LIB);",
          "new_line_content": "        eckey->priv_key = BN_secure_new();",
          "content_same": false
        },
        {
          "line": 1115,
          "old_api": "ECDSA_do_verify",
          "new_api": "ECDSA_do_sign",
          "old_text": "ECDSA_do_verify(dgst, dgst_len, sig, eckey)",
          "new_text": "ECDSA_do_sign(dgst, dgst_len, eckey)",
          "old_line_content": "    if (ECDSA_do_verify(dgst, dgst_len, sig, eckey) != 1)",
          "new_line_content": "    sig = ECDSA_do_sign(dgst, dgst_len, eckey);",
          "content_same": false
        },
        {
          "line": 1121,
          "old_api": "OSSL_SELF_TEST_free",
          "new_api": "ECDSA_do_verify",
          "old_text": "OSSL_SELF_TEST_free(st)",
          "new_text": "ECDSA_do_verify(dgst, dgst_len, sig, eckey)",
          "old_line_content": "    OSSL_SELF_TEST_free(st);",
          "new_line_content": "    if (ECDSA_do_verify(dgst, dgst_len, sig, eckey) != 1)",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 896,
          "old_api": null,
          "new_api": "EC_POINT_dup",
          "old_text": null,
          "new_text": "EC_POINT_dup(pub_key, key->group)",
          "old_line_content": "{",
          "new_line_content": "    key->pub_key = EC_POINT_dup(pub_key, key->group);",
          "content_same": false
        },
        {
          "line": 642,
          "old_api": null,
          "new_api": "EC_POINT_mul",
          "old_text": null,
          "new_text": "EC_POINT_mul(eckey->group, point, eckey->priv_key, NULL, NULL, ctx)",
          "old_line_content": "        goto err;",
          "new_line_content": "    if (!EC_POINT_mul(eckey->group, point, eckey->priv_key, NULL, NULL, ctx)) {",
          "content_same": false
        },
        {
          "line": 643,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, ERR_R_EC_LIB)",
          "old_line_content": "    }",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_EC_LIB);",
          "content_same": false
        },
        {
          "line": 774,
          "old_api": null,
          "new_api": "set_group",
          "old_text": null,
          "new_text": "key->meth->set_group(key, group)",
          "old_line_content": "",
          "new_line_content": "    if (key->meth->set_group != NULL && key->meth->set_group(key, group) == 0)",
          "content_same": false
        },
        {
          "line": 647,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, EC_R_INVALID_PRIVATE_KEY)",
          "old_line_content": "    return ret;",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, EC_R_INVALID_PRIVATE_KEY);",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": null,
          "new_api": "EC_GROUP_free",
          "old_text": null,
          "new_text": "EC_GROUP_free(key->group)",
          "old_line_content": "    return (key->group == NULL) ? 0 : 1;",
          "new_line_content": "    EC_GROUP_free(key->group);",
          "content_same": false
        },
        {
          "line": 777,
          "old_api": null,
          "new_api": "EC_GROUP_dup",
          "old_text": null,
          "new_text": "EC_GROUP_dup(group)",
          "old_line_content": "}",
          "new_line_content": "    key->group = EC_GROUP_dup(group);",
          "content_same": false
        },
        {
          "line": 778,
          "old_api": null,
          "new_api": "EC_GROUP_get_curve_name",
          "old_text": null,
          "new_text": "EC_GROUP_get_curve_name(key->group)",
          "old_line_content": "",
          "new_line_content": "    if (key->group != NULL && EC_GROUP_get_curve_name(key->group) == NID_sm2)",
          "content_same": false
        },
        {
          "line": 779,
          "old_api": null,
          "new_api": "EC_KEY_set_flags",
          "old_text": null,
          "new_text": "EC_KEY_set_flags(key, EC_FLAG_SM2_RANGE)",
          "old_line_content": "const BIGNUM *EC_KEY_get0_private_key(const EC_KEY *key)",
          "new_line_content": "        EC_KEY_set_flags(key, EC_FLAG_SM2_RANGE);",
          "content_same": false
        },
        {
          "line": 652,
          "old_api": null,
          "new_api": "EC_POINT_free",
          "old_text": null,
          "new_text": "EC_POINT_free(point)",
          "old_line_content": " * ECC Key validation as specified in SP800-56A R3.",
          "new_line_content": "    EC_POINT_free(point);",
          "content_same": false
        },
        {
          "line": 1037,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED)",
          "old_line_content": "    return ret;",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED);",
          "content_same": false
        },
        {
          "line": 1040,
          "old_api": null,
          "new_api": "oct2priv",
          "old_text": null,
          "new_text": "eckey->group->meth->oct2priv(eckey, buf, len)",
          "old_line_content": "int ossl_ec_key_simple_oct2priv(EC_KEY *eckey, const unsigned char *buf,",
          "new_line_content": "    ret = eckey->group->meth->oct2priv(eckey, buf, len);",
          "content_same": false
        },
        {
          "line": 895,
          "old_api": null,
          "new_api": "EC_POINT_free",
          "old_text": null,
          "new_text": "EC_POINT_free(key->pub_key)",
          "old_line_content": "unsigned int EC_KEY_get_enc_flags(const EC_KEY *key)",
          "new_line_content": "    EC_POINT_free(key->pub_key);",
          "content_same": false
        },
        {
          "line": 1052,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, ERR_R_BN_LIB)",
          "old_line_content": "    }",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_BN_LIB);",
          "content_same": false
        },
        {
          "line": 926,
          "old_api": null,
          "new_api": "EC_GROUP_set_asn1_flag",
          "old_text": null,
          "new_text": "EC_GROUP_set_asn1_flag(key->group, flag)",
          "old_line_content": "    if (key->group == NULL)",
          "new_line_content": "        EC_GROUP_set_asn1_flag(key->group, flag);",
          "content_same": false
        },
        {
          "line": 1055,
          "old_api": null,
          "new_api": "BN_bin2bn",
          "old_text": null,
          "new_text": "BN_bin2bn(buf, len, eckey->priv_key)",
          "old_line_content": "}",
          "new_line_content": "    if (BN_bin2bn(buf, len, eckey->priv_key) == NULL) {",
          "content_same": false
        },
        {
          "line": 1056,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, ERR_R_BN_LIB)",
          "old_line_content": "",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_BN_LIB);",
          "content_same": false
        },
        {
          "line": 676,
          "old_api": null,
          "new_api": "BN_CTX_new_ex",
          "old_text": null,
          "new_text": "BN_CTX_new_ex(eckey->libctx)",
          "old_line_content": "    if (eckey->priv_key != NULL) {",
          "new_line_content": "    if ((ctx = BN_CTX_new_ex(eckey->libctx)) == NULL)",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": null,
          "new_api": "EC_GROUP_precompute_mult",
          "old_text": null,
          "new_text": "EC_GROUP_precompute_mult(key->group, ctx)",
          "old_line_content": "    return key->flags;",
          "new_line_content": "    return EC_GROUP_precompute_mult(key->group, ctx);",
          "content_same": false
        },
        {
          "line": 679,
          "old_api": null,
          "new_api": "ossl_ec_key_public_check",
          "old_text": null,
          "new_text": "ossl_ec_key_public_check(eckey, ctx)",
          "old_line_content": "            goto err;",
          "new_line_content": "    if (!ossl_ec_key_public_check(eckey, ctx))",
          "content_same": false
        },
        {
          "line": 807,
          "old_api": null,
          "new_api": "EC_GROUP_get0_order",
          "old_text": null,
          "new_text": "EC_GROUP_get0_order(key->group)",
          "old_line_content": "        return 0;",
          "new_line_content": "    order = EC_GROUP_get0_order(key->group);",
          "content_same": false
        },
        {
          "line": 808,
          "old_api": null,
          "new_api": "BN_is_zero",
          "old_text": null,
          "new_text": "BN_is_zero(order)",
          "old_line_content": "    if (key->meth->set_private != NULL",
          "new_line_content": "    if (order == NULL || BN_is_zero(order))",
          "content_same": false
        },
        {
          "line": 1068,
          "old_api": null,
          "new_api": "EC_KEY_priv2oct",
          "old_text": null,
          "new_text": "EC_KEY_priv2oct(eckey, NULL, 0)",
          "old_line_content": "    if (len == 0) {",
          "new_line_content": "    len = EC_KEY_priv2oct(eckey, NULL, 0);",
          "content_same": false
        },
        {
          "line": 684,
          "old_api": null,
          "new_api": "ossl_ec_key_pairwise_check",
          "old_text": null,
          "new_text": "ossl_ec_key_pairwise_check(eckey, ctx)",
          "old_line_content": "    return ok;",
          "new_line_content": "            || !ossl_ec_key_pairwise_check(eckey, ctx))",
          "content_same": false
        },
        {
          "line": 812,
          "old_api": null,
          "new_api": "set_private",
          "old_text": null,
          "new_text": "key->group->meth->set_private(key, priv_key)",
          "old_line_content": "    /*",
          "new_line_content": "        && key->group->meth->set_private(key, priv_key) == 0)",
          "content_same": false
        },
        {
          "line": 1071,
          "old_api": null,
          "new_api": "OPENSSL_malloc",
          "old_text": null,
          "new_text": "OPENSSL_malloc(len)",
          "old_line_content": "    }",
          "new_line_content": "    if ((buf = OPENSSL_malloc(len)) == NULL)",
          "content_same": false
        },
        {
          "line": 815,
          "old_api": null,
          "new_api": "set_private",
          "old_text": null,
          "new_text": "key->meth->set_private(key, priv_key)",
          "old_line_content": "     */",
          "new_line_content": "        && key->meth->set_private(key, priv_key) == 0)",
          "content_same": false
        },
        {
          "line": 1073,
          "old_api": null,
          "new_api": "EC_KEY_priv2oct",
          "old_text": null,
          "new_text": "EC_KEY_priv2oct(eckey, buf, len)",
          "old_line_content": "    return len;",
          "new_line_content": "    len = EC_KEY_priv2oct(eckey, buf, len);",
          "content_same": false
        },
        {
          "line": 689,
          "old_api": null,
          "new_api": "BN_CTX_free",
          "old_text": null,
          "new_text": "BN_CTX_free(ctx)",
          "old_line_content": "{",
          "new_line_content": "    BN_CTX_free(ctx);",
          "content_same": false
        },
        {
          "line": 1075,
          "old_api": null,
          "new_api": "OPENSSL_free",
          "old_text": null,
          "new_text": "OPENSSL_free(buf)",
          "old_line_content": "",
          "new_line_content": "        OPENSSL_free(buf);",
          "content_same": false
        },
        {
          "line": 566,
          "old_api": null,
          "new_api": "EC_GROUP_get0_cofactor",
          "old_text": null,
          "new_text": "EC_GROUP_get0_cofactor(eckey->group)",
          "old_line_content": "",
          "new_line_content": "    const BIGNUM *cofactor = EC_GROUP_get0_cofactor(eckey->group);",
          "content_same": false
        },
        {
          "line": 823,
          "old_api": null,
          "new_api": "BN_clear_free",
          "old_text": null,
          "new_text": "BN_clear_free(key->priv_key)",
          "old_line_content": "     * We should never leak the bit length of the secret scalar in the key,",
          "new_line_content": "        BN_clear_free(key->priv_key);",
          "content_same": false
        },
        {
          "line": 568,
          "old_api": null,
          "new_api": "ossl_ec_key_public_check_quick",
          "old_text": null,
          "new_text": "ossl_ec_key_public_check_quick(eckey, ctx)",
          "old_line_content": "        return 0;",
          "new_line_content": "    if (!ossl_ec_key_public_check_quick(eckey, ctx))",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": null,
          "new_api": "BN_is_one",
          "old_text": null,
          "new_text": "BN_is_one(cofactor)",
          "old_line_content": "    if (point == NULL)",
          "new_line_content": "    if (cofactor != NULL && BN_is_one(cofactor)) {",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER)",
          "old_line_content": "",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER);",
          "content_same": false
        },
        {
          "line": 705,
          "old_api": null,
          "new_api": "BN_CTX_new_ex",
          "old_text": null,
          "new_text": "BN_CTX_new_ex(key->libctx)",
          "old_line_content": "",
          "new_line_content": "    ctx = BN_CTX_new_ex(key->libctx);",
          "content_same": false
        },
        {
          "line": 582,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, EC_R_INVALID_GROUP_ORDER)",
          "old_line_content": "        goto err;",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, EC_R_INVALID_GROUP_ORDER);",
          "content_same": false
        },
        {
          "line": 967,
          "old_api": null,
          "new_api": "EC_POINT_point2buf",
          "old_text": null,
          "new_text": "EC_POINT_point2buf(key->group, key->pub_key, form, pbuf, ctx)",
          "old_line_content": "    if (key == NULL || key->group == NULL)",
          "new_line_content": "    return EC_POINT_point2buf(key->group, key->pub_key, form, pbuf, ctx);",
          "content_same": false
        },
        {
          "line": 586,
          "old_api": null,
          "new_api": "EC_POINT_mul",
          "old_text": null,
          "new_text": "EC_POINT_mul(eckey->group, point, NULL, eckey->pub_key, order, ctx)",
          "old_line_content": "        goto err;",
          "new_line_content": "    if (!EC_POINT_mul(eckey->group, point, NULL, eckey->pub_key, order, ctx)) {",
          "content_same": false
        },
        {
          "line": 587,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, ERR_R_EC_LIB)",
          "old_line_content": "    }",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_EC_LIB);",
          "content_same": false
        },
        {
          "line": 715,
          "old_api": null,
          "new_api": "BN_CTX_get",
          "old_text": null,
          "new_text": "BN_CTX_get(ctx)",
          "old_line_content": "        goto err;",
          "new_line_content": "    tx = BN_CTX_get(ctx);",
          "content_same": false
        },
        {
          "line": 591,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, EC_R_WRONG_ORDER)",
          "old_line_content": "    return ret;",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, EC_R_WRONG_ORDER);",
          "content_same": false
        },
        {
          "line": 720,
          "old_api": null,
          "new_api": "EC_POINT_set_affine_coordinates",
          "old_text": null,
          "new_text": "EC_POINT_set_affine_coordinates(key->group, point, x, y, ctx)",
          "old_line_content": "     * Check if retrieved coordinates match originals. The range check is done",
          "new_line_content": "    if (!EC_POINT_set_affine_coordinates(key->group, point, x, y, ctx))",
          "content_same": false
        },
        {
          "line": 976,
          "old_api": null,
          "new_api": "EC_POINT_new",
          "old_text": null,
          "new_text": "EC_POINT_new(key->group)",
          "old_line_content": "    /*",
          "new_line_content": "        key->pub_key = EC_POINT_new(key->group);",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": null,
          "new_api": "EC_POINT_get_affine_coordinates",
          "old_text": null,
          "new_text": "EC_POINT_get_affine_coordinates(key->group, point, tx, ty, ctx)",
          "old_line_content": "     */",
          "new_line_content": "    if (!EC_POINT_get_affine_coordinates(key->group, point, tx, ty, ctx))",
          "content_same": false
        },
        {
          "line": 979,
          "old_api": null,
          "new_api": "EC_POINT_oct2point",
          "old_text": null,
          "new_text": "EC_POINT_oct2point(key->group, key->pub_key, buf, len, ctx)",
          "old_line_content": "     * the last significant bit) contains the point conversion form.",
          "new_line_content": "    if (EC_POINT_oct2point(key->group, key->pub_key, buf, len, ctx) == 0)",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": null,
          "new_api": "EC_POINT_free",
          "old_text": null,
          "new_text": "EC_POINT_free(point)",
          "old_line_content": " * Section 5.6.2.1.2 Owner Assurance of Private-Key Validity",
          "new_line_content": "    EC_POINT_free(point);",
          "content_same": false
        },
        {
          "line": 1108,
          "old_api": null,
          "new_api": "OSSL_SELF_TEST_new",
          "old_text": null,
          "new_text": "OSSL_SELF_TEST_new(cb, cbarg)",
          "old_line_content": "",
          "new_line_content": "    st = OSSL_SELF_TEST_new(cb, cbarg);",
          "content_same": false
        },
        {
          "line": 1112,
          "old_api": null,
          "new_api": "OSSL_SELF_TEST_onbegin",
          "old_text": null,
          "new_text": "OSSL_SELF_TEST_onbegin(st, OSSL_SELF_TEST_TYPE_PCT,\n                           OSSL_SELF_TEST_DESC_PCT_ECDSA)",
          "old_line_content": "",
          "new_line_content": "    OSSL_SELF_TEST_onbegin(st, OSSL_SELF_TEST_TYPE_PCT,",
          "content_same": false
        },
        {
          "line": 730,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, EC_R_COORDINATES_OUT_OF_RANGE)",
          "old_line_content": "        goto err;",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, EC_R_COORDINATES_OUT_OF_RANGE);",
          "content_same": false
        },
        {
          "line": 990,
          "old_api": null,
          "new_api": "point_conversion_form_t)(buf[0] & ~0x01)",
          "old_text": null,
          "new_text": "point_conversion_form_t)(buf[0] & ~0x01)",
          "old_line_content": "{",
          "new_line_content": "        key->conv_form = (point_conversion_form_t)(buf[0] & ~0x01);",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": null,
          "new_api": "EC_KEY_set_public_key",
          "old_text": null,
          "new_text": "EC_KEY_set_public_key(key, point)",
          "old_line_content": "    ok = 1;",
          "new_line_content": "    if (!EC_KEY_set_public_key(key, point))",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER)",
          "old_line_content": "        return 0;",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER);",
          "content_same": false
        },
        {
          "line": 1119,
          "old_api": null,
          "new_api": "OSSL_SELF_TEST_oncorrupt_byte",
          "old_text": null,
          "new_text": "OSSL_SELF_TEST_oncorrupt_byte(st, dgst)",
          "old_line_content": "err:",
          "new_line_content": "    OSSL_SELF_TEST_oncorrupt_byte(st, dgst);",
          "content_same": false
        },
        {
          "line": 611,
          "old_api": null,
          "new_api": "BN_value_one",
          "old_text": null,
          "new_text": "BN_value_one()",
          "old_line_content": "}",
          "new_line_content": "    if (BN_cmp(eckey->priv_key, BN_value_one()) < 0",
          "content_same": false
        },
        {
          "line": 612,
          "old_api": null,
          "new_api": "BN_cmp",
          "old_text": null,
          "new_text": "BN_cmp(eckey->priv_key, eckey->group->order)",
          "old_line_content": "",
          "new_line_content": "        || BN_cmp(eckey->priv_key, eckey->group->order) >= 0) {",
          "content_same": false
        },
        {
          "line": 613,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, EC_R_INVALID_PRIVATE_KEY)",
          "old_line_content": "/*",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, EC_R_INVALID_PRIVATE_KEY);",
          "content_same": false
        },
        {
          "line": 1126,
          "old_api": null,
          "new_api": "OSSL_SELF_TEST_onend",
          "old_text": null,
          "new_text": "OSSL_SELF_TEST_onend(st, ret)",
          "old_line_content": "",
          "new_line_content": "    OSSL_SELF_TEST_onend(st, ret);",
          "content_same": false
        },
        {
          "line": 1127,
          "old_api": null,
          "new_api": "OSSL_SELF_TEST_free",
          "old_text": null,
          "new_text": "OSSL_SELF_TEST_free(st)",
          "old_line_content": "",
          "new_line_content": "    OSSL_SELF_TEST_free(st);",
          "content_same": false
        },
        {
          "line": 1128,
          "old_api": null,
          "new_api": "ECDSA_SIG_free",
          "old_text": null,
          "new_text": "ECDSA_SIG_free(sig)",
          "old_line_content": "",
          "new_line_content": "    ECDSA_SIG_free(sig);",
          "content_same": false
        },
        {
          "line": 744,
          "old_api": null,
          "new_api": "BN_CTX_end",
          "old_text": null,
          "new_text": "BN_CTX_end(ctx)",
          "old_line_content": "",
          "new_line_content": "    BN_CTX_end(ctx);",
          "content_same": false
        },
        {
          "line": 745,
          "old_api": null,
          "new_api": "BN_CTX_free",
          "old_text": null,
          "new_text": "BN_CTX_free(ctx)",
          "old_line_content": "OSSL_LIB_CTX *ossl_ec_key_get_libctx(const EC_KEY *key)",
          "new_line_content": "    BN_CTX_free(ctx);",
          "content_same": false
        },
        {
          "line": 746,
          "old_api": null,
          "new_api": "EC_POINT_free",
          "old_text": null,
          "new_text": "EC_POINT_free(point)",
          "old_line_content": "{",
          "new_line_content": "    EC_POINT_free(point);",
          "content_same": false
        },
        {
          "line": 870,
          "old_api": null,
          "new_api": "BN_set_flags",
          "old_text": null,
          "new_text": "BN_set_flags(tmp_key, BN_FLG_CONSTTIME)",
          "old_line_content": "    }",
          "new_line_content": "    BN_set_flags(tmp_key, BN_FLG_CONSTTIME);",
          "content_same": false
        },
        {
          "line": 873,
          "old_api": null,
          "new_api": "bn_wexpand",
          "old_text": null,
          "new_text": "bn_wexpand(tmp_key, fixed_top)",
          "old_line_content": "    key->priv_key = tmp_key;",
          "new_line_content": "    if (bn_wexpand(tmp_key, fixed_top) == NULL) {",
          "content_same": false
        },
        {
          "line": 874,
          "old_api": null,
          "new_api": "BN_clear_free",
          "old_text": null,
          "new_text": "BN_clear_free(tmp_key)",
          "old_line_content": "    key->dirty_cnt++;",
          "new_line_content": "        BN_clear_free(tmp_key);",
          "content_same": false
        },
        {
          "line": 878,
          "old_api": null,
          "new_api": "BN_clear_free",
          "old_text": null,
          "new_text": "BN_clear_free(key->priv_key)",
          "old_line_content": "",
          "new_line_content": "    BN_clear_free(key->priv_key);",
          "content_same": false
        },
        {
          "line": 1000,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED)",
          "old_line_content": "",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED);",
          "content_same": false
        },
        {
          "line": 1004,
          "old_api": null,
          "new_api": "priv2oct",
          "old_text": null,
          "new_text": "eckey->group->meth->priv2oct(eckey, buf, len)",
          "old_line_content": "    size_t buf_len;",
          "new_line_content": "    return eckey->group->meth->priv2oct(eckey, buf, len);",
          "content_same": false
        },
        {
          "line": 1012,
          "old_api": null,
          "new_api": "EC_GROUP_order_bits",
          "old_text": null,
          "new_text": "EC_GROUP_order_bits(eckey->group)",
          "old_line_content": "        return 0;",
          "new_line_content": "    buf_len = (EC_GROUP_order_bits(eckey->group) + 7) / 8;",
          "content_same": false
        },
        {
          "line": 633,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER)",
          "old_line_content": "        goto err;",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER);",
          "content_same": false
        },
        {
          "line": 893,
          "old_api": null,
          "new_api": "set_public",
          "old_text": null,
          "new_text": "key->meth->set_public(key, pub_key)",
          "old_line_content": "}",
          "new_line_content": "        && key->meth->set_public(key, pub_key) == 0)",
          "content_same": false
        },
        {
          "line": 1022,
          "old_api": null,
          "new_api": "BN_bn2binpad",
          "old_text": null,
          "new_text": "BN_bn2binpad(eckey->priv_key, buf, buf_len)",
          "old_line_content": "}",
          "new_line_content": "    if (BN_bn2binpad(eckey->priv_key, buf, buf_len) == -1) {",
          "content_same": false
        },
        {
          "line": 1023,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_EC, EC_R_BUFFER_TOO_SMALL)",
          "old_line_content": "",
          "new_line_content": "        ERR_raise(ERR_LIB_EC, EC_R_BUFFER_TOO_SMALL);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 640,
          "old_api": "EC_POINT_cmp",
          "new_api": null,
          "old_text": "EC_POINT_cmp(eckey->group, point, eckey->pub_key, ctx)",
          "new_text": null,
          "old_line_content": "    if (EC_POINT_cmp(eckey->group, point, eckey->pub_key, ctx) != 0) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 641,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_EC, EC_R_INVALID_PRIVATE_KEY)",
          "new_text": null,
          "old_line_content": "        ERR_raise(ERR_LIB_EC, EC_R_INVALID_PRIVATE_KEY);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 768,
          "old_api": "set_group",
          "new_api": null,
          "old_text": "key->meth->set_group(key, group)",
          "new_text": null,
          "old_line_content": "    if (key->meth->set_group != NULL && key->meth->set_group(key, group) == 0)",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 770,
          "old_api": "EC_GROUP_free",
          "new_api": null,
          "old_text": "EC_GROUP_free(key->group)",
          "new_text": null,
          "old_line_content": "    EC_GROUP_free(key->group);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 771,
          "old_api": "EC_GROUP_dup",
          "new_api": null,
          "old_text": "EC_GROUP_dup(group)",
          "new_text": null,
          "old_line_content": "    key->group = EC_GROUP_dup(group);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 772,
          "old_api": "EC_GROUP_get_curve_name",
          "new_api": null,
          "old_text": "EC_GROUP_get_curve_name(key->group)",
          "new_text": null,
          "old_line_content": "    if (key->group != NULL && EC_GROUP_get_curve_name(key->group) == NID_sm2)",
          "new_line_content": "int EC_KEY_set_group(EC_KEY *key, const EC_GROUP *group)",
          "content_same": false
        },
        {
          "line": 773,
          "old_api": "EC_KEY_set_flags",
          "new_api": null,
          "old_text": "EC_KEY_set_flags(key, EC_FLAG_SM2_RANGE)",
          "new_text": null,
          "old_line_content": "        EC_KEY_set_flags(key, EC_FLAG_SM2_RANGE);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1031,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_EC, ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED)",
          "new_text": null,
          "old_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1034,
          "old_api": "oct2priv",
          "new_api": null,
          "old_text": "eckey->group->meth->oct2priv(eckey, buf, len)",
          "new_text": null,
          "old_line_content": "    ret = eckey->group->meth->oct2priv(eckey, buf, len);",
          "new_line_content": "    if (eckey->group == NULL || eckey->group->meth == NULL)",
          "content_same": false
        },
        {
          "line": 914,
          "old_api": "EC_GROUP_set_point_conversion_form",
          "new_api": null,
          "old_text": "EC_GROUP_set_point_conversion_form(key->group, cform)",
          "new_text": null,
          "old_line_content": "        EC_GROUP_set_point_conversion_form(key->group, cform);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1044,
          "old_api": "BN_secure_new",
          "new_api": null,
          "old_text": "BN_secure_new()",
          "new_text": null,
          "old_line_content": "        eckey->priv_key = BN_secure_new();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1046,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_EC, ERR_R_BN_LIB)",
          "new_text": null,
          "old_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_BN_LIB);",
          "new_line_content": "int ossl_ec_key_simple_oct2priv(EC_KEY *eckey, const unsigned char *buf,",
          "content_same": false
        },
        {
          "line": 1049,
          "old_api": "BN_bin2bn",
          "new_api": null,
          "old_text": "BN_bin2bn(buf, len, eckey->priv_key)",
          "new_text": null,
          "old_line_content": "    if (BN_bin2bn(buf, len, eckey->priv_key) == NULL) {",
          "new_line_content": "    if (eckey->priv_key == NULL)",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER)",
          "new_text": null,
          "old_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER);",
          "new_line_content": "int ossl_ec_key_simple_check_key(const EC_KEY *eckey)",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": "BN_CTX_new_ex",
          "new_api": null,
          "old_text": "BN_CTX_new_ex(eckey->libctx)",
          "new_text": null,
          "old_line_content": "    if ((ctx = BN_CTX_new_ex(eckey->libctx)) == NULL)",
          "new_line_content": "    BN_CTX *ctx = NULL;",
          "content_same": false
        },
        {
          "line": 928,
          "old_api": "EC_GROUP_precompute_mult",
          "new_api": null,
          "old_text": "EC_GROUP_precompute_mult(key->group, ctx)",
          "new_text": null,
          "old_line_content": "    return EC_GROUP_precompute_mult(key->group, ctx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 801,
          "old_api": "EC_GROUP_get0_order",
          "new_api": null,
          "old_text": "EC_GROUP_get0_order(key->group)",
          "new_text": null,
          "old_line_content": "    order = EC_GROUP_get0_order(key->group);",
          "new_line_content": "     * fully initialized state.",
          "content_same": false
        },
        {
          "line": 802,
          "old_api": "BN_is_zero",
          "new_api": null,
          "old_text": "BN_is_zero(order)",
          "new_text": null,
          "old_line_content": "    if (order == NULL || BN_is_zero(order))",
          "new_line_content": "     *",
          "content_same": false
        },
        {
          "line": 677,
          "old_api": "ossl_ec_key_private_check",
          "new_api": null,
          "old_text": "ossl_ec_key_private_check(eckey)",
          "new_text": null,
          "old_line_content": "        if (!ossl_ec_key_private_check(eckey)",
          "new_line_content": "        return 0;",
          "content_same": false
        },
        {
          "line": 1062,
          "old_api": "EC_KEY_priv2oct",
          "new_api": null,
          "old_text": "EC_KEY_priv2oct(eckey, NULL, 0)",
          "new_text": null,
          "old_line_content": "    len = EC_KEY_priv2oct(eckey, NULL, 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 678,
          "old_api": "ossl_ec_key_pairwise_check",
          "new_api": null,
          "old_text": "ossl_ec_key_pairwise_check(eckey, ctx)",
          "new_text": null,
          "old_line_content": "            || !ossl_ec_key_pairwise_check(eckey, ctx))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 806,
          "old_api": "set_private",
          "new_api": null,
          "old_text": "key->group->meth->set_private(key, priv_key)",
          "new_text": null,
          "old_line_content": "        && key->group->meth->set_private(key, priv_key) == 0)",
          "new_line_content": "     */",
          "content_same": false
        },
        {
          "line": 1065,
          "old_api": "OPENSSL_malloc",
          "new_api": null,
          "old_text": "OPENSSL_malloc(len)",
          "new_text": null,
          "old_line_content": "    if ((buf = OPENSSL_malloc(len)) == NULL)",
          "new_line_content": "    size_t len;",
          "content_same": false
        },
        {
          "line": 809,
          "old_api": "set_private",
          "new_api": null,
          "old_text": "key->meth->set_private(key, priv_key)",
          "new_text": null,
          "old_line_content": "        && key->meth->set_private(key, priv_key) == 0)",
          "new_line_content": "        return 0; /* This should never happen */",
          "content_same": false
        },
        {
          "line": 1067,
          "old_api": "EC_KEY_priv2oct",
          "new_api": null,
          "old_text": "EC_KEY_priv2oct(eckey, buf, len)",
          "new_text": null,
          "old_line_content": "    len = EC_KEY_priv2oct(eckey, buf, len);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1069,
          "old_api": "OPENSSL_free",
          "new_api": null,
          "old_text": "OPENSSL_free(buf)",
          "new_text": null,
          "old_line_content": "        OPENSSL_free(buf);",
          "new_line_content": "    if (len == 0)",
          "content_same": false
        },
        {
          "line": 817,
          "old_api": "BN_clear_free",
          "new_api": null,
          "old_text": "BN_clear_free(key->priv_key)",
          "new_text": null,
          "old_line_content": "        BN_clear_free(key->priv_key);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": "ossl_ec_key_public_check_quick",
          "new_api": null,
          "old_text": "ossl_ec_key_public_check_quick(eckey, ctx)",
          "new_text": null,
          "old_line_content": "    if (!ossl_ec_key_public_check_quick(eckey, ctx))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 696,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER)",
          "new_text": null,
          "old_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER);",
          "new_line_content": "    BN_CTX *ctx = NULL;",
          "content_same": false
        },
        {
          "line": 570,
          "old_api": "EC_POINT_new",
          "new_api": null,
          "old_text": "EC_POINT_new(eckey->group)",
          "new_text": null,
          "old_line_content": "    point = EC_POINT_new(eckey->group);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 699,
          "old_api": "BN_CTX_new_ex",
          "new_api": null,
          "old_text": "BN_CTX_new_ex(key->libctx)",
          "new_text": null,
          "old_line_content": "    ctx = BN_CTX_new_ex(key->libctx);",
          "new_line_content": "    int ok = 0;",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": "BN_is_zero",
          "new_api": null,
          "old_text": "BN_is_zero(order)",
          "new_text": null,
          "old_line_content": "    if (BN_is_zero(order)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 703,
          "old_api": "BN_CTX_start",
          "new_api": null,
          "old_text": "BN_CTX_start(ctx)",
          "new_text": null,
          "old_line_content": "    BN_CTX_start(ctx);",
          "new_line_content": "        return 0;",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": "EC_POINT_new",
          "new_api": null,
          "old_text": "EC_POINT_new(key->group)",
          "new_text": null,
          "old_line_content": "    point = EC_POINT_new(key->group);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 961,
          "old_api": "EC_POINT_point2buf",
          "new_api": null,
          "old_text": "EC_POINT_point2buf(key->group, key->pub_key, form, pbuf, ctx)",
          "new_text": null,
          "old_line_content": "    return EC_POINT_point2buf(key->group, key->pub_key, form, pbuf, ctx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 580,
          "old_api": "EC_POINT_mul",
          "new_api": null,
          "old_text": "EC_POINT_mul(eckey->group, point, NULL, eckey->pub_key, order, ctx)",
          "new_text": null,
          "old_line_content": "    if (!EC_POINT_mul(eckey->group, point, NULL, eckey->pub_key, order, ctx)) {",
          "new_line_content": "    order = eckey->group->order;",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": "EC_POINT_is_at_infinity",
          "new_api": null,
          "old_text": "EC_POINT_is_at_infinity(eckey->group, point)",
          "new_text": null,
          "old_line_content": "    if (!EC_POINT_is_at_infinity(eckey->group, point)) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_EC, EC_R_WRONG_ORDER)",
          "new_text": null,
          "old_line_content": "        ERR_raise(ERR_LIB_EC, EC_R_WRONG_ORDER);",
          "new_line_content": "    /* 5.6.2.3.3 (Step 4) : pub_key * order is the point at infinity. */",
          "content_same": false
        },
        {
          "line": 714,
          "old_api": "EC_POINT_set_affine_coordinates",
          "new_api": null,
          "old_text": "EC_POINT_set_affine_coordinates(key->group, point, x, y, ctx)",
          "new_text": null,
          "old_line_content": "    if (!EC_POINT_set_affine_coordinates(key->group, point, x, y, ctx))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 970,
          "old_api": "EC_POINT_new",
          "new_api": null,
          "old_text": "EC_POINT_new(key->group)",
          "new_text": null,
          "old_line_content": "        key->pub_key = EC_POINT_new(key->group);",
          "new_line_content": "int EC_KEY_oct2key(EC_KEY *key, const unsigned char *buf, size_t len,",
          "content_same": false
        },
        {
          "line": 973,
          "old_api": "EC_POINT_oct2point",
          "new_api": null,
          "old_text": "EC_POINT_oct2point(key->group, key->pub_key, buf, len, ctx)",
          "new_text": null,
          "old_line_content": "    if (EC_POINT_oct2point(key->group, key->pub_key, buf, len, ctx) == 0)",
          "new_line_content": "    if (key == NULL || key->group == NULL)",
          "content_same": false
        },
        {
          "line": 1102,
          "old_api": "OSSL_SELF_TEST_new",
          "new_api": null,
          "old_text": "OSSL_SELF_TEST_new(cb, cbarg)",
          "new_text": null,
          "old_line_content": "    st = OSSL_SELF_TEST_new(cb, cbarg);",
          "new_line_content": "    int ret = 0;",
          "content_same": false
        },
        {
          "line": 1106,
          "old_api": "OSSL_SELF_TEST_onbegin",
          "new_api": null,
          "old_text": "OSSL_SELF_TEST_onbegin(st, OSSL_SELF_TEST_TYPE_PCT,\n                           OSSL_SELF_TEST_DESC_PCT_ECDSA)",
          "new_text": null,
          "old_line_content": "    OSSL_SELF_TEST_onbegin(st, OSSL_SELF_TEST_TYPE_PCT,",
          "new_line_content": "    OSSL_SELF_TEST *st = NULL;",
          "content_same": false
        },
        {
          "line": 723,
          "old_api": "BN_cmp",
          "new_api": null,
          "old_text": "BN_cmp(y, ty)",
          "new_text": null,
          "old_line_content": "    if (BN_cmp(x, tx) || BN_cmp(y, ty)) {",
          "new_line_content": "        goto err;",
          "content_same": false
        },
        {
          "line": 724,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_EC, EC_R_COORDINATES_OUT_OF_RANGE)",
          "new_text": null,
          "old_line_content": "        ERR_raise(ERR_LIB_EC, EC_R_COORDINATES_OUT_OF_RANGE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1109,
          "old_api": "ECDSA_do_sign",
          "new_api": null,
          "old_text": "ECDSA_do_sign(dgst, dgst_len, eckey)",
          "new_text": null,
          "old_line_content": "    sig = ECDSA_do_sign(dgst, dgst_len, eckey);",
          "new_line_content": "    if (st == NULL)",
          "content_same": false
        },
        {
          "line": 984,
          "old_api": "point_conversion_form_t)(buf[0] & ~0x01)",
          "new_api": null,
          "old_text": "point_conversion_form_t)(buf[0] & ~0x01)",
          "new_text": null,
          "old_line_content": "        key->conv_form = (point_conversion_form_t)(buf[0] & ~0x01);",
          "new_line_content": "     * For non-custom curves the first octet of the buffer (excluding",
          "content_same": false
        },
        {
          "line": 1113,
          "old_api": "OSSL_SELF_TEST_oncorrupt_byte",
          "new_api": null,
          "old_text": "OSSL_SELF_TEST_oncorrupt_byte(st, dgst)",
          "new_text": null,
          "old_line_content": "    OSSL_SELF_TEST_oncorrupt_byte(st, dgst);",
          "new_line_content": "                           OSSL_SELF_TEST_DESC_PCT_ECDSA);",
          "content_same": false
        },
        {
          "line": 602,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER)",
          "new_text": null,
          "old_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER);",
          "new_line_content": " * Section 5.6.2.1.2 Owner Assurance of Private-Key Validity",
          "content_same": false
        },
        {
          "line": 732,
          "old_api": "EC_KEY_check_key",
          "new_api": null,
          "old_text": "EC_KEY_check_key(key)",
          "new_text": null,
          "old_line_content": "    if (EC_KEY_check_key(key) == 0)",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": "BN_value_one",
          "new_api": null,
          "old_text": "BN_value_one()",
          "new_text": null,
          "old_line_content": "    if (BN_cmp(eckey->priv_key, BN_value_one()) < 0",
          "new_line_content": "int ossl_ec_key_private_check(const EC_KEY *eckey)",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": "BN_cmp",
          "new_api": null,
          "old_text": "BN_cmp(eckey->priv_key, eckey->group->order)",
          "new_text": null,
          "old_line_content": "        || BN_cmp(eckey->priv_key, eckey->group->order) >= 0) {",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 607,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_EC, EC_R_INVALID_PRIVATE_KEY)",
          "new_text": null,
          "old_line_content": "        ERR_raise(ERR_LIB_EC, EC_R_INVALID_PRIVATE_KEY);",
          "new_line_content": "    if (eckey == NULL || eckey->group == NULL || eckey->priv_key == NULL) {",
          "content_same": false
        },
        {
          "line": 1120,
          "old_api": "OSSL_SELF_TEST_onend",
          "new_api": null,
          "old_text": "OSSL_SELF_TEST_onend(st, ret)",
          "new_text": null,
          "old_line_content": "    OSSL_SELF_TEST_onend(st, ret);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 860,
          "old_api": "BN_dup",
          "new_api": null,
          "old_text": "BN_dup(priv_key)",
          "new_text": null,
          "old_line_content": "    tmp_key = BN_dup(priv_key);",
          "new_line_content": "     *",
          "content_same": false
        },
        {
          "line": 1122,
          "old_api": "ECDSA_SIG_free",
          "new_api": null,
          "old_text": "ECDSA_SIG_free(sig)",
          "new_text": null,
          "old_line_content": "    ECDSA_SIG_free(sig);",
          "new_line_content": "        goto err;",
          "content_same": false
        },
        {
          "line": 739,
          "old_api": "BN_CTX_free",
          "new_api": null,
          "old_text": "BN_CTX_free(ctx)",
          "new_text": null,
          "old_line_content": "    BN_CTX_free(ctx);",
          "new_line_content": "        goto err;",
          "content_same": false
        },
        {
          "line": 740,
          "old_api": "EC_POINT_free",
          "new_api": null,
          "old_text": "EC_POINT_free(point)",
          "new_text": null,
          "old_line_content": "    EC_POINT_free(point);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 864,
          "old_api": "BN_set_flags",
          "new_api": null,
          "old_text": "BN_set_flags(tmp_key, BN_FLG_CONSTTIME)",
          "new_text": null,
          "old_line_content": "    BN_set_flags(tmp_key, BN_FLG_CONSTTIME);",
          "new_line_content": "     * might temporarily overflow the order length.",
          "content_same": false
        },
        {
          "line": 867,
          "old_api": "bn_wexpand",
          "new_api": null,
          "old_text": "bn_wexpand(tmp_key, fixed_top)",
          "new_text": null,
          "old_line_content": "    if (bn_wexpand(tmp_key, fixed_top) == NULL) {",
          "new_line_content": "    if (tmp_key == NULL)",
          "content_same": false
        },
        {
          "line": 868,
          "old_api": "BN_clear_free",
          "new_api": null,
          "old_text": "BN_clear_free(tmp_key)",
          "new_text": null,
          "old_line_content": "        BN_clear_free(tmp_key);",
          "new_line_content": "        return 0;",
          "content_same": false
        },
        {
          "line": 994,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_EC, ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED)",
          "new_text": null,
          "old_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_SHOULD_NOT_HAVE_BEEN_CALLED);",
          "new_line_content": "size_t EC_KEY_priv2oct(const EC_KEY *eckey,",
          "content_same": false
        },
        {
          "line": 998,
          "old_api": "priv2oct",
          "new_api": null,
          "old_text": "eckey->group->meth->priv2oct(eckey, buf, len)",
          "new_text": null,
          "old_line_content": "    return eckey->group->meth->priv2oct(eckey, buf, len);",
          "new_line_content": "        return 0;",
          "content_same": false
        },
        {
          "line": 1006,
          "old_api": "EC_GROUP_order_bits",
          "new_api": null,
          "old_text": "EC_GROUP_order_bits(eckey->group)",
          "new_text": null,
          "old_line_content": "    buf_len = (EC_GROUP_order_bits(eckey->group) + 7) / 8;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 887,
          "old_api": "set_public",
          "new_api": null,
          "old_text": "key->meth->set_public(key, pub_key)",
          "new_text": null,
          "old_line_content": "        && key->meth->set_public(key, pub_key) == 0)",
          "new_line_content": "    return key->pub_key;",
          "content_same": false
        },
        {
          "line": 627,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER)",
          "new_text": null,
          "old_line_content": "        ERR_raise(ERR_LIB_EC, ERR_R_PASSED_NULL_PARAMETER);",
          "new_line_content": "    EC_POINT *point = NULL;",
          "content_same": false
        },
        {
          "line": 631,
          "old_api": "EC_POINT_new",
          "new_api": null,
          "old_text": "EC_POINT_new(eckey->group)",
          "new_text": null,
          "old_line_content": "    point = EC_POINT_new(eckey->group);",
          "new_line_content": "       || eckey->pub_key == NULL",
          "content_same": false
        },
        {
          "line": 1016,
          "old_api": "BN_bn2binpad",
          "new_api": null,
          "old_text": "BN_bn2binpad(eckey->priv_key, buf, buf_len)",
          "new_text": null,
          "old_line_content": "    if (BN_bn2binpad(eckey->priv_key, buf, buf_len) == -1) {",
          "new_line_content": "        return buf_len;",
          "content_same": false
        },
        {
          "line": 889,
          "old_api": "EC_POINT_free",
          "new_api": null,
          "old_text": "EC_POINT_free(key->pub_key)",
          "new_text": null,
          "old_line_content": "    EC_POINT_free(key->pub_key);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 890,
          "old_api": "EC_POINT_dup",
          "new_api": null,
          "old_text": "EC_POINT_dup(pub_key, key->group)",
          "new_text": null,
          "old_line_content": "    key->pub_key = EC_POINT_dup(pub_key, key->group);",
          "new_line_content": "int EC_KEY_set_public_key(EC_KEY *key, const EC_POINT *pub_key)",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": "EC_POINT_mul",
          "new_api": null,
          "old_text": "EC_POINT_mul(eckey->group, point, eckey->priv_key, NULL, NULL, ctx)",
          "new_text": null,
          "old_line_content": "    if (!EC_POINT_mul(eckey->group, point, eckey->priv_key, NULL, NULL, ctx)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1017,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_EC, EC_R_BUFFER_TOO_SMALL)",
          "new_text": null,
          "old_line_content": "        ERR_raise(ERR_LIB_EC, EC_R_BUFFER_TOO_SMALL);",
          "new_line_content": "    else if (len < buf_len)",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 18,
      "total_additions": 74,
      "total_deletions": 72,
      "total_api_changes": 164
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 6,
        "api_related_lines": 164,
        "non_api_lines": 3,
        "non_api_line_numbers": [
          572,
          573,
          574
        ]
      }
    },
    "api_calls_before": 204,
    "api_calls_after": 206,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 0,
      "total_diff_lines": 22
    }
  }
}