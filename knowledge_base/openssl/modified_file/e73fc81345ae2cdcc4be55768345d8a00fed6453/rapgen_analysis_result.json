{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/openssl/modified_file/e73fc81345ae2cdcc4be55768345d8a00fed6453",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/openssl/modified_file/e73fc81345ae2cdcc4be55768345d8a00fed6453/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/openssl/modified_file/e73fc81345ae2cdcc4be55768345d8a00fed6453/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/openssl/modified_file/e73fc81345ae2cdcc4be55768345d8a00fed6453/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 540,
          "old_api": "OPENSSL_zalloc",
          "new_api": "assert",
          "old_text": "OPENSSL_zalloc(calculated_length)",
          "new_text": "assert(name != NULL)",
          "old_line_content": "        data = OPENSSL_zalloc(calculated_length);",
          "new_line_content": "    assert(name != NULL);",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": "ERR_raise",
          "new_api": "ossl_ends_with_dirsep",
          "old_text": "ERR_raise(ERR_LIB_PROV, ERR_R_MALLOC_FAILURE)",
          "new_text": "ossl_ends_with_dirsep(ctx->uri)",
          "old_line_content": "            ERR_raise(ERR_LIB_PROV, ERR_R_MALLOC_FAILURE);",
          "new_line_content": "        const char *pathsep = ossl_ends_with_dirsep(ctx->uri) ? \"\" : \"/\";",
          "content_same": false
        },
        {
          "line": 546,
          "old_api": "OPENSSL_strlcat",
          "new_api": "OPENSSL_zalloc",
          "old_text": "OPENSSL_strlcat(data, ctx->uri, calculated_length)",
          "new_text": "OPENSSL_zalloc(calculated_length)",
          "old_line_content": "        OPENSSL_strlcat(data, ctx->uri, calculated_length);",
          "new_line_content": "        data = OPENSSL_zalloc(calculated_length);",
          "content_same": false
        },
        {
          "line": 548,
          "old_api": "OPENSSL_strlcat",
          "new_api": "ERR_raise",
          "old_text": "OPENSSL_strlcat(data, name, calculated_length)",
          "new_text": "ERR_raise(ERR_LIB_PROV, ERR_R_MALLOC_FAILURE)",
          "old_line_content": "        OPENSSL_strlcat(data, name, calculated_length);",
          "new_line_content": "            ERR_raise(ERR_LIB_PROV, ERR_R_MALLOC_FAILURE);",
          "content_same": false
        },
        {
          "line": 691,
          "old_api": "assert",
          "new_api": "file_load_dir_entry",
          "old_text": "assert(0)",
          "new_text": "file_load_dir_entry(ctx, object_cb, object_cbarg, pw_cb, pw_cbarg)",
          "old_line_content": "    assert(0);",
          "new_line_content": "            file_load_dir_entry(ctx, object_cb, object_cbarg, pw_cb, pw_cbarg);",
          "content_same": false
        },
        {
          "line": 754,
          "old_api": "assert",
          "new_api": "file_close_dir",
          "old_text": "assert(0)",
          "new_text": "file_close_dir(ctx)",
          "old_line_content": "    assert(0);",
          "new_line_content": "        return file_close_dir(ctx);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 640,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_SYS, ctx->_.dir.last_errno)",
          "old_line_content": "        /* flag acceptable names */",
          "new_line_content": "                ERR_raise(ERR_LIB_SYS, ctx->_.dir.last_errno);",
          "content_same": false
        },
        {
          "line": 516,
          "old_api": null,
          "new_api": "file_setup_decoders",
          "old_text": null,
          "new_text": "file_setup_decoders(ctx)",
          "old_line_content": "    data.object_cbarg = object_cbarg;",
          "new_line_content": "    if (!file_setup_decoders(ctx))",
          "content_same": false
        },
        {
          "line": 648,
          "old_api": null,
          "new_api": "file_name_check",
          "old_text": null,
          "new_text": "file_name_check(ctx, ctx->_.dir.last_entry)",
          "old_line_content": "        }",
          "new_line_content": "            && file_name_check(ctx, ctx->_.dir.last_entry)) {",
          "content_same": false
        },
        {
          "line": 523,
          "old_api": null,
          "new_api": "OSSL_DECODER_CTX_set_construct_data",
          "old_text": null,
          "new_text": "OSSL_DECODER_CTX_set_construct_data(ctx->_.file.decoderctx, &data)",
          "old_line_content": "}",
          "new_line_content": "    OSSL_DECODER_CTX_set_construct_data(ctx->_.file.decoderctx, &data);",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": null,
          "new_api": "OSSL_DECODER_CTX_set_passphrase_cb",
          "old_text": null,
          "new_text": "OSSL_DECODER_CTX_set_passphrase_cb(ctx->_.file.decoderctx, pw_cb, pw_cbarg)",
          "old_line_content": "",
          "new_line_content": "    OSSL_DECODER_CTX_set_passphrase_cb(ctx->_.file.decoderctx, pw_cb, pw_cbarg);",
          "content_same": false
        },
        {
          "line": 652,
          "old_api": null,
          "new_api": "file_name_to_uri",
          "old_text": null,
          "new_text": "file_name_to_uri(ctx, ctx->_.dir.last_entry)",
          "old_line_content": "         * cares about the second argument.  On the following calls, it",
          "new_line_content": "                 file_name_to_uri(ctx, ctx->_.dir.last_entry)) == NULL)",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": null,
          "new_api": "OSSL_DECODER_from_bio",
          "old_text": null,
          "new_text": "OSSL_DECODER_from_bio(ctx->_.file.decoderctx, ctx->_.file.file)",
          "old_line_content": " */",
          "new_line_content": "    return OSSL_DECODER_from_bio(ctx->_.file.decoderctx, ctx->_.file.file);",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": null,
          "new_api": "OPENSSL_DIR_read",
          "old_text": null,
          "new_text": "OPENSSL_DIR_read(&ctx->_.dir.ctx, ctx->uri)",
          "old_line_content": "    object[1].data = newname;",
          "new_line_content": "        ctx->_.dir.last_entry = OPENSSL_DIR_read(&ctx->_.dir.ctx, ctx->uri);",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(newname)",
          "old_line_content": "/*-",
          "new_line_content": "    object[1].data_size = strlen(newname);",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": null,
          "new_api": "object_cb",
          "old_text": null,
          "new_text": "object_cb(object, object_cbarg)",
          "old_line_content": " *  Loading, local dispatcher",
          "new_line_content": "    ok = object_cb(object, object_cbarg);",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(pathsep)",
          "old_line_content": "            return NULL;",
          "new_line_content": "        long calculated_length = strlen(ctx->uri) + strlen(pathsep)",
          "content_same": false
        },
        {
          "line": 544,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(name)",
          "old_line_content": "        }",
          "new_line_content": "            + strlen(name) + 1 /* \\0 */;",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": null,
          "new_api": "OPENSSL_free",
          "old_text": null,
          "new_text": "OPENSSL_free(newname)",
          "old_line_content": " *  -------------------------",
          "new_line_content": "    OPENSSL_free(newname);",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": null,
          "new_api": "OPENSSL_strlcat",
          "old_text": null,
          "new_text": "OPENSSL_strlcat(data, ctx->uri, calculated_length)",
          "old_line_content": "",
          "new_line_content": "        OPENSSL_strlcat(data, ctx->uri, calculated_length);",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": null,
          "new_api": "OPENSSL_strlcat",
          "old_text": null,
          "new_text": "OPENSSL_strlcat(data, pathsep, calculated_length)",
          "old_line_content": "static int file_name_check(struct file_ctx_st *ctx, const char *name)",
          "new_line_content": "        OPENSSL_strlcat(data, pathsep, calculated_length);",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": null,
          "new_api": "OPENSSL_strlcat",
          "old_text": null,
          "new_text": "OPENSSL_strlcat(data, name, calculated_length)",
          "old_line_content": "{",
          "new_line_content": "        OPENSSL_strlcat(data, name, calculated_length);",
          "content_same": false
        },
        {
          "line": 688,
          "old_api": null,
          "new_api": "file_load_file",
          "old_text": null,
          "new_text": "file_load_file(ctx, object_cb, object_cbarg, pw_cb, pw_cbarg)",
          "old_line_content": "    }",
          "new_line_content": "        return file_load_file(ctx, object_cb, object_cbarg, pw_cb, pw_cbarg);",
          "content_same": false
        },
        {
          "line": 433,
          "old_api": null,
          "new_api": "OSSL_DECODER_CTX_set_input_type",
          "old_text": null,
          "new_text": "OSSL_DECODER_CTX_set_input_type(ctx->_.file.decoderctx,\n                                             ctx->_.file.input_type)",
          "old_line_content": "",
          "new_line_content": "        if (!OSSL_DECODER_CTX_set_input_type(ctx->_.file.decoderctx,",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB)",
          "old_line_content": "         * Create the internal last resort decoder implementation together",
          "new_line_content": "            ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB);",
          "content_same": false
        },
        {
          "line": 697,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(0)",
          "old_line_content": " *  -------------------------",
          "new_line_content": "    assert(0);",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": null,
          "new_api": "ossl_decoder_from_algorithm",
          "old_text": null,
          "new_text": "ossl_decoder_from_algorithm(0, &ossl_der_to_obj_algorithm,\n                                             NULL)",
          "old_line_content": "        if (to_obj_inst == NULL)",
          "new_line_content": "        to_obj = ossl_decoder_from_algorithm(0, &ossl_der_to_obj_algorithm,",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": null,
          "new_api": "strncasecmp",
          "old_text": null,
          "new_text": "strncasecmp(name, ctx->_.dir.search_name,\n                    sizeof(ctx->_.dir.search_name) - 1)",
          "old_line_content": "    /*",
          "new_line_content": "    if (strncasecmp(name, ctx->_.dir.search_name,",
          "content_same": false
        },
        {
          "line": 449,
          "old_api": null,
          "new_api": "ossl_decoder_instance_new",
          "old_text": null,
          "new_text": "ossl_decoder_instance_new(to_obj, ctx->provctx)",
          "old_line_content": "                                               to_obj_inst)) {",
          "new_line_content": "        to_obj_inst = ossl_decoder_instance_new(to_obj, ctx->provctx);",
          "content_same": false
        },
        {
          "line": 453,
          "old_api": null,
          "new_api": "ossl_decoder_ctx_add_decoder_inst",
          "old_text": null,
          "new_text": "ossl_decoder_ctx_add_decoder_inst(ctx->_.file.decoderctx,\n                                               to_obj_inst)",
          "old_line_content": "",
          "new_line_content": "        if (!ossl_decoder_ctx_add_decoder_inst(ctx->_.file.decoderctx,",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB)",
          "old_line_content": "         * OSSL_DECODER_INSTANCE shouldn't be freed from this point on.",
          "new_line_content": "            ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB);",
          "content_same": false
        },
        {
          "line": 718,
          "old_api": null,
          "new_api": "BIO_pending",
          "old_text": null,
          "new_text": "BIO_pending(ctx->_.file.file)",
          "old_line_content": "    return 1;",
          "new_line_content": "        return !BIO_pending(ctx->_.file.file)",
          "content_same": false
        },
        {
          "line": 719,
          "old_api": null,
          "new_api": "BIO_eof",
          "old_text": null,
          "new_text": "BIO_eof(ctx->_.file.file)",
          "old_line_content": "}",
          "new_line_content": "            && BIO_eof(ctx->_.file.file);",
          "content_same": false
        },
        {
          "line": 723,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(0)",
          "old_line_content": "    if (ctx->_.dir.ctx != NULL)",
          "new_line_content": "    assert(0);",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": null,
          "new_api": "isdigit",
          "old_text": null,
          "new_text": "isdigit(*p)",
          "old_line_content": "    /*",
          "new_line_content": "    if (!isdigit(*p))",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": null,
          "new_api": "ossl_decoder_ctx_setup_for_pkey",
          "old_text": null,
          "new_text": "ossl_decoder_ctx_setup_for_pkey(ctx->_.file.decoderctx,\n                                                 &dummy, NULL,\n                                                 libctx, ctx->_.file.propq)",
          "old_line_content": "            goto err;",
          "new_line_content": "             && !ossl_decoder_ctx_setup_for_pkey(ctx->_.file.decoderctx,",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": null,
          "new_api": "isdigit",
          "old_text": null,
          "new_text": "isdigit(*p)",
          "old_line_content": "     */",
          "new_line_content": "    while (isdigit(*p))",
          "content_same": false
        },
        {
          "line": 730,
          "old_api": null,
          "new_api": "OPENSSL_DIR_end",
          "old_text": null,
          "new_text": "OPENSSL_DIR_end(&ctx->_.dir.ctx)",
          "old_line_content": "{",
          "new_line_content": "        OPENSSL_DIR_end(&ctx->_.dir.ctx);",
          "content_same": false
        },
        {
          "line": 731,
          "old_api": null,
          "new_api": "free_file_ctx",
          "old_text": null,
          "new_text": "free_file_ctx(ctx)",
          "old_line_content": "    /*",
          "new_line_content": "    free_file_ctx(ctx);",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": null,
          "new_api": "OSSL_DECODER_CTX_add_extra",
          "old_text": null,
          "new_text": "OSSL_DECODER_CTX_add_extra(ctx->_.file.decoderctx,\n                                           libctx, ctx->_.file.propq)",
          "old_line_content": "        /*",
          "new_line_content": "            || !OSSL_DECODER_CTX_add_extra(ctx->_.file.decoderctx,",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB)",
          "old_line_content": "         * own instead.",
          "new_line_content": "            ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB);",
          "content_same": false
        },
        {
          "line": 610,
          "old_api": null,
          "new_api": "ossl_isdigit",
          "old_text": null,
          "new_text": "ossl_isdigit(*p)",
          "old_line_content": "     * found a fitting file name.",
          "new_line_content": "            if (!ossl_isdigit(*p))",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": null,
          "new_api": "OSSL_DECODER_CTX_get_cleanup",
          "old_text": null,
          "new_text": "OSSL_DECODER_CTX_get_cleanup(ctx->_.file.decoderctx)",
          "old_line_content": "        /*",
          "new_line_content": "        old_cleanup = OSSL_DECODER_CTX_get_cleanup(ctx->_.file.decoderctx);",
          "content_same": false
        },
        {
          "line": 741,
          "old_api": null,
          "new_api": "BIO_free",
          "old_text": null,
          "new_text": "BIO_free(ctx->_.file.file)",
          "old_line_content": "",
          "new_line_content": "    BIO_free(ctx->_.file.file);",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": null,
          "new_api": "OSSL_DECODER_CTX_get_construct_data",
          "old_text": null,
          "new_text": "OSSL_DECODER_CTX_get_construct_data(ctx->_.file.decoderctx)",
          "old_line_content": "         */",
          "new_line_content": "            OSSL_DECODER_CTX_get_construct_data(ctx->_.file.decoderctx);",
          "content_same": false
        },
        {
          "line": 744,
          "old_api": null,
          "new_api": "free_file_ctx",
          "old_text": null,
          "new_text": "free_file_ctx(ctx)",
          "old_line_content": "    struct file_ctx_st *ctx = loaderctx;",
          "new_line_content": "    free_file_ctx(ctx);",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": null,
          "new_api": "old_cleanup",
          "old_text": null,
          "new_text": "old_cleanup(old_construct_data)",
          "old_line_content": "                                            file_load_construct)",
          "new_line_content": "            old_cleanup(old_construct_data);",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": null,
          "new_api": "OSSL_DECODER_free",
          "old_text": null,
          "new_text": "OSSL_DECODER_free(to_obj)",
          "old_line_content": "                          OSSL_PASSPHRASE_CALLBACK *pw_cb, void *pw_cbarg)",
          "new_line_content": "    OSSL_DECODER_free(to_obj);",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": null,
          "new_api": "OSSL_DECODER_CTX_set_construct",
          "old_text": null,
          "new_text": "OSSL_DECODER_CTX_set_construct(ctx->_.file.decoderctx,\n                                            file_load_construct)",
          "old_line_content": "        }",
          "new_line_content": "        if (!OSSL_DECODER_CTX_set_construct(ctx->_.file.decoderctx,",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": null,
          "new_api": "OSSL_DECODER_CTX_set_cleanup",
          "old_text": null,
          "new_text": "OSSL_DECODER_CTX_set_cleanup(ctx->_.file.decoderctx,\n                                             file_load_cleanup)",
          "old_line_content": "",
          "new_line_content": "            || !OSSL_DECODER_CTX_set_cleanup(ctx->_.file.decoderctx,",
          "content_same": false
        },
        {
          "line": 497,
          "old_api": null,
          "new_api": "ERR_raise",
          "old_text": null,
          "new_text": "ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB)",
          "old_line_content": " err:",
          "new_line_content": "            ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB);",
          "content_same": false
        },
        {
          "line": 628,
          "old_api": null,
          "new_api": "OSSL_PARAM_int",
          "old_text": null,
          "new_text": "OSSL_PARAM_int(OSSL_OBJECT_PARAM_TYPE, (int *)&object_type)",
          "old_line_content": "",
          "new_line_content": "        OSSL_PARAM_int(OSSL_OBJECT_PARAM_TYPE, (int *)&object_type),",
          "content_same": false
        },
        {
          "line": 629,
          "old_api": null,
          "new_api": "OSSL_PARAM_utf8_string",
          "old_text": null,
          "new_text": "OSSL_PARAM_utf8_string(OSSL_OBJECT_PARAM_DATA, NULL, 0)",
          "old_line_content": "    /* Loop until we get an error or until we have a suitable name */",
          "new_line_content": "        OSSL_PARAM_utf8_string(OSSL_OBJECT_PARAM_DATA, NULL, 0),",
          "content_same": false
        },
        {
          "line": 756,
          "old_api": null,
          "new_api": "file_close_stream",
          "old_text": null,
          "new_text": "file_close_stream(ctx)",
          "old_line_content": "}",
          "new_line_content": "        return file_close_stream(ctx);",
          "content_same": false
        },
        {
          "line": 760,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(0)",
          "old_line_content": "    { OSSL_FUNC_STORE_ATTACH, (void (*)(void))file_attach },",
          "new_line_content": "    assert(0);",
          "content_same": false
        },
        {
          "line": 639,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(ctx->_.dir.last_errno != 0)",
          "old_line_content": "",
          "new_line_content": "                assert(ctx->_.dir.last_errno != 0);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 642,
          "old_api": "file_name_check",
          "new_api": null,
          "old_text": "file_name_check(ctx, ctx->_.dir.last_entry)",
          "new_text": null,
          "old_line_content": "            && file_name_check(ctx, ctx->_.dir.last_entry)) {",
          "new_line_content": "            /* file_eof() will tell if EOF was reached */",
          "content_same": false
        },
        {
          "line": 517,
          "old_api": "OSSL_DECODER_CTX_set_construct_data",
          "new_api": null,
          "old_text": "OSSL_DECODER_CTX_set_construct_data(ctx->_.file.decoderctx, &data)",
          "new_text": null,
          "old_line_content": "    OSSL_DECODER_CTX_set_construct_data(ctx->_.file.decoderctx, &data);",
          "new_line_content": "        return 0;",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": "OSSL_DECODER_CTX_set_passphrase_cb",
          "new_api": null,
          "old_text": "OSSL_DECODER_CTX_set_passphrase_cb(ctx->_.file.decoderctx, pw_cb, pw_cbarg)",
          "new_text": null,
          "old_line_content": "    OSSL_DECODER_CTX_set_passphrase_cb(ctx->_.file.decoderctx, pw_cb, pw_cbarg);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": "file_name_to_uri",
          "new_api": null,
          "old_text": "file_name_to_uri(ctx, ctx->_.dir.last_entry)",
          "new_text": null,
          "old_line_content": "                 file_name_to_uri(ctx, ctx->_.dir.last_entry)) == NULL)",
          "new_line_content": "        /* flag acceptable names */",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": "OSSL_DECODER_from_bio",
          "new_api": null,
          "old_text": "OSSL_DECODER_from_bio(ctx->_.file.decoderctx, ctx->_.file.file)",
          "new_text": null,
          "old_line_content": "    return OSSL_DECODER_from_bio(ctx->_.file.decoderctx, ctx->_.file.file);",
          "new_line_content": "    data.object_cbarg = object_cbarg;",
          "content_same": false
        },
        {
          "line": 656,
          "old_api": "OPENSSL_DIR_read",
          "new_api": null,
          "old_text": "OPENSSL_DIR_read(&ctx->_.dir.ctx, ctx->uri)",
          "new_text": null,
          "old_line_content": "        ctx->_.dir.last_entry = OPENSSL_DIR_read(&ctx->_.dir.ctx, ctx->uri);",
          "new_line_content": "        /*",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(name != NULL)",
          "new_text": null,
          "old_line_content": "    assert(name != NULL);",
          "new_line_content": " */",
          "content_same": false
        },
        {
          "line": 663,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(newname)",
          "new_text": null,
          "old_line_content": "    object[1].data_size = strlen(newname);",
          "new_line_content": "        ctx->_.dir.last_errno = errno;",
          "content_same": false
        },
        {
          "line": 536,
          "old_api": "ossl_ends_with_dirsep",
          "new_api": null,
          "old_text": "ossl_ends_with_dirsep(ctx->uri)",
          "new_text": null,
          "old_line_content": "        const char *pathsep = ossl_ends_with_dirsep(ctx->uri) ? \"\" : \"/\";",
          "new_line_content": "static char *file_name_to_uri(struct file_ctx_st *ctx, const char *name)",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(pathsep)",
          "new_text": null,
          "old_line_content": "        long calculated_length = strlen(ctx->uri) + strlen(pathsep)",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(name)",
          "new_text": null,
          "old_line_content": "            + strlen(name) + 1 /* \\0 */;",
          "new_line_content": "    char *data = NULL;",
          "content_same": false
        },
        {
          "line": 664,
          "old_api": "object_cb",
          "new_api": null,
          "old_text": "object_cb(object, object_cbarg)",
          "new_text": null,
          "old_line_content": "    ok = object_cb(object, object_cbarg);",
          "new_line_content": "        if (ctx->_.dir.last_entry == NULL && ctx->_.dir.last_errno == 0)",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": "OPENSSL_free",
          "new_api": null,
          "old_text": "OPENSSL_free(newname)",
          "new_text": null,
          "old_line_content": "    OPENSSL_free(newname);",
          "new_line_content": "            ctx->_.dir.end_reached = 1;",
          "content_same": false
        },
        {
          "line": 547,
          "old_api": "OPENSSL_strlcat",
          "new_api": null,
          "old_text": "OPENSSL_strlcat(data, pathsep, calculated_length)",
          "new_text": null,
          "old_line_content": "        OPENSSL_strlcat(data, pathsep, calculated_length);",
          "new_line_content": "        if (data == NULL) {",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": "file_load_file",
          "new_api": null,
          "old_text": "file_load_file(ctx, object_cb, object_cbarg, pw_cb, pw_cbarg)",
          "new_text": null,
          "old_line_content": "        return file_load_file(ctx, object_cb, object_cbarg, pw_cb, pw_cbarg);",
          "new_line_content": "                     OSSL_PASSPHRASE_CALLBACK *pw_cb, void *pw_cbarg)",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": "OSSL_DECODER_CTX_set_input_type",
          "new_api": null,
          "old_text": "OSSL_DECODER_CTX_set_input_type(ctx->_.file.decoderctx,\n                                             ctx->_.file.input_type)",
          "new_text": null,
          "old_line_content": "        if (!OSSL_DECODER_CTX_set_input_type(ctx->_.file.decoderctx,",
          "new_line_content": "                           || ctx->expected_type == OSSL_STORE_INFO_PARAMS",
          "content_same": false
        },
        {
          "line": 685,
          "old_api": "file_load_dir_entry",
          "new_api": null,
          "old_text": "file_load_dir_entry(ctx, object_cb, object_cbarg, pw_cb, pw_cbarg)",
          "new_text": null,
          "old_line_content": "            file_load_dir_entry(ctx, object_cb, object_cbarg, pw_cb, pw_cbarg);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 430,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB)",
          "new_text": null,
          "old_line_content": "            ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB);",
          "new_line_content": "                           || ctx->expected_type == OSSL_STORE_INFO_PKEY);",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": "ossl_decoder_from_algorithm",
          "new_api": null,
          "old_text": "ossl_decoder_from_algorithm(0, &ossl_der_to_obj_algorithm,\n                                             NULL)",
          "new_text": null,
          "old_line_content": "        to_obj = ossl_decoder_from_algorithm(0, &ossl_der_to_obj_algorithm,",
          "new_line_content": "         * Create the internal last resort decoder implementation together",
          "content_same": false
        },
        {
          "line": 570,
          "old_api": "strncasecmp",
          "new_api": null,
          "old_text": "strncasecmp(name, ctx->_.dir.search_name,\n                    sizeof(ctx->_.dir.search_name) - 1)",
          "new_text": null,
          "old_line_content": "    if (strncasecmp(name, ctx->_.dir.search_name,",
          "new_line_content": "        && ctx->expected_type != OSSL_STORE_INFO_CRL)",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": "ossl_decoder_instance_new",
          "new_api": null,
          "old_text": "ossl_decoder_instance_new(to_obj, ctx->provctx)",
          "new_text": null,
          "old_line_content": "        to_obj_inst = ossl_decoder_instance_new(to_obj, ctx->provctx);",
          "new_line_content": "         */",
          "content_same": false
        },
        {
          "line": 448,
          "old_api": "ossl_decoder_ctx_add_decoder_inst",
          "new_api": null,
          "old_text": "ossl_decoder_ctx_add_decoder_inst(ctx->_.file.decoderctx,\n                                               to_obj_inst)",
          "new_text": null,
          "old_line_content": "        if (!ossl_decoder_ctx_add_decoder_inst(ctx->_.file.decoderctx,",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 450,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB)",
          "new_text": null,
          "old_line_content": "            ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB);",
          "new_line_content": "        if (to_obj_inst == NULL)",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": "BIO_pending",
          "new_api": null,
          "old_text": "BIO_pending(ctx->_.file.file)",
          "new_text": null,
          "old_line_content": "        return !BIO_pending(ctx->_.file.file)",
          "new_line_content": "        return ctx->_.dir.end_reached;",
          "content_same": false
        },
        {
          "line": 713,
          "old_api": "BIO_eof",
          "new_api": null,
          "old_text": "BIO_eof(ctx->_.file.file)",
          "new_text": null,
          "old_line_content": "            && BIO_eof(ctx->_.file.file);",
          "new_line_content": "    case IS_FILE:",
          "content_same": false
        },
        {
          "line": 717,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(0)",
          "new_text": null,
          "old_line_content": "    assert(0);",
          "new_line_content": "         */",
          "content_same": false
        },
        {
          "line": 593,
          "old_api": "isdigit",
          "new_api": null,
          "old_text": "isdigit(*p)",
          "new_text": null,
          "old_line_content": "    if (!isdigit(*p))",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": "ossl_decoder_ctx_setup_for_pkey",
          "new_api": null,
          "old_text": "ossl_decoder_ctx_setup_for_pkey(ctx->_.file.decoderctx,\n                                             &dummy, NULL,\n                                             libctx, ctx->_.file.propq)",
          "new_text": null,
          "old_line_content": "        if (!ossl_decoder_ctx_setup_for_pkey(ctx->_.file.decoderctx,",
          "new_line_content": "        /*",
          "content_same": false
        },
        {
          "line": 595,
          "old_api": "isdigit",
          "new_api": null,
          "old_text": "isdigit(*p)",
          "new_text": null,
          "old_line_content": "    while (isdigit(*p))",
          "new_line_content": "    /*",
          "content_same": false
        },
        {
          "line": 724,
          "old_api": "OPENSSL_DIR_end",
          "new_api": null,
          "old_text": "OPENSSL_DIR_end(&ctx->_.dir.ctx)",
          "new_text": null,
          "old_line_content": "        OPENSSL_DIR_end(&ctx->_.dir.ctx);",
          "new_line_content": "    return 1;",
          "content_same": false
        },
        {
          "line": 725,
          "old_api": "free_file_ctx",
          "new_api": null,
          "old_text": "free_file_ctx(ctx)",
          "new_text": null,
          "old_line_content": "    free_file_ctx(ctx);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": "OSSL_DECODER_CTX_add_extra",
          "new_api": null,
          "old_text": "OSSL_DECODER_CTX_add_extra(ctx->_.file.decoderctx,\n                                           libctx, ctx->_.file.propq)",
          "new_text": null,
          "old_line_content": "            || !OSSL_DECODER_CTX_add_extra(ctx->_.file.decoderctx,",
          "new_line_content": "         * more than that...",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB)",
          "new_text": null,
          "old_line_content": "            ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB);",
          "new_line_content": "        if ((expect_evp_pkey",
          "content_same": false
        },
        {
          "line": 604,
          "old_api": "ossl_isdigit",
          "new_api": null,
          "old_text": "ossl_isdigit(*p)",
          "new_text": null,
          "old_line_content": "            if (!ossl_isdigit(*p))",
          "new_line_content": "#ifdef __VMS",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": "OSSL_DECODER_CTX_get_cleanup",
          "new_api": null,
          "old_text": "OSSL_DECODER_CTX_get_cleanup(ctx->_.file.decoderctx)",
          "new_text": null,
          "old_line_content": "        old_cleanup = OSSL_DECODER_CTX_get_cleanup(ctx->_.file.decoderctx);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": "BIO_free",
          "new_api": null,
          "old_text": "BIO_free(ctx->_.file.file)",
          "new_text": null,
          "old_line_content": "    BIO_free(ctx->_.file.file);",
          "new_line_content": "static int file_close_stream(struct file_ctx_st *ctx)",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": "OSSL_DECODER_CTX_get_construct_data",
          "new_api": null,
          "old_text": "OSSL_DECODER_CTX_get_construct_data(ctx->_.file.decoderctx)",
          "new_text": null,
          "old_line_content": "            OSSL_DECODER_CTX_get_construct_data(ctx->_.file.decoderctx);",
          "new_line_content": "        /*",
          "content_same": false
        },
        {
          "line": 738,
          "old_api": "free_file_ctx",
          "new_api": null,
          "old_text": "free_file_ctx(ctx)",
          "new_text": null,
          "old_line_content": "    free_file_ctx(ctx);",
          "new_line_content": "     * This frees either the provider BIO filter (for file_attach()) OR",
          "content_same": false
        },
        {
          "line": 482,
          "old_api": "old_cleanup",
          "new_api": null,
          "old_text": "old_cleanup(old_construct_data)",
          "new_text": null,
          "old_line_content": "            old_cleanup(old_construct_data);",
          "new_line_content": "         * own instead.",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": "OSSL_DECODER_CTX_set_construct",
          "new_api": null,
          "old_text": "OSSL_DECODER_CTX_set_construct(ctx->_.file.decoderctx,\n                                            file_load_construct)",
          "new_text": null,
          "old_line_content": "        if (!OSSL_DECODER_CTX_set_construct(ctx->_.file.decoderctx,",
          "new_line_content": "        if (old_cleanup != NULL)",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": "OSSL_DECODER_CTX_set_cleanup",
          "new_api": null,
          "old_text": "OSSL_DECODER_CTX_set_cleanup(ctx->_.file.decoderctx,\n                                             file_load_cleanup)",
          "new_text": null,
          "old_line_content": "            || !OSSL_DECODER_CTX_set_cleanup(ctx->_.file.decoderctx,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB)",
          "new_text": null,
          "old_line_content": "            ERR_raise(ERR_LIB_PROV, ERR_R_OSSL_DECODER_LIB);",
          "new_line_content": "         * Set the hooks.",
          "content_same": false
        },
        {
          "line": 748,
          "old_api": "file_close_dir",
          "new_api": null,
          "old_text": "file_close_dir(ctx)",
          "new_text": null,
          "old_line_content": "        return file_close_dir(ctx);",
          "new_line_content": "static int file_close(void *loaderctx)",
          "content_same": false
        },
        {
          "line": 622,
          "old_api": "OSSL_PARAM_int",
          "new_api": null,
          "old_text": "OSSL_PARAM_int(OSSL_OBJECT_PARAM_TYPE, (int *)&object_type)",
          "new_text": null,
          "old_line_content": "        OSSL_PARAM_int(OSSL_OBJECT_PARAM_TYPE, (int *)&object_type),",
          "new_line_content": "                               OSSL_CALLBACK *object_cb, void *object_cbarg,",
          "content_same": false
        },
        {
          "line": 623,
          "old_api": "OSSL_PARAM_utf8_string",
          "new_api": null,
          "old_text": "OSSL_PARAM_utf8_string(OSSL_OBJECT_PARAM_DATA, NULL, 0)",
          "new_text": null,
          "old_line_content": "        OSSL_PARAM_utf8_string(OSSL_OBJECT_PARAM_DATA, NULL, 0),",
          "new_line_content": "                               OSSL_PASSPHRASE_CALLBACK *pw_cb, void *pw_cbarg)",
          "content_same": false
        },
        {
          "line": 750,
          "old_api": "file_close_stream",
          "new_api": null,
          "old_text": "file_close_stream(ctx)",
          "new_text": null,
          "old_line_content": "        return file_close_stream(ctx);",
          "new_line_content": "    struct file_ctx_st *ctx = loaderctx;",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": "OSSL_DECODER_free",
          "new_api": null,
          "old_text": "OSSL_DECODER_free(to_obj)",
          "new_text": null,
          "old_line_content": "    OSSL_DECODER_free(to_obj);",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 633,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(ctx->_.dir.last_errno != 0)",
          "new_text": null,
          "old_line_content": "                assert(ctx->_.dir.last_errno != 0);",
          "new_line_content": "    int ok;",
          "content_same": false
        },
        {
          "line": 634,
          "old_api": "ERR_raise",
          "new_api": null,
          "old_text": "ERR_raise(ERR_LIB_SYS, ctx->_.dir.last_errno)",
          "new_text": null,
          "old_line_content": "                ERR_raise(ERR_LIB_SYS, ctx->_.dir.last_errno);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": "file_setup_decoders",
          "new_api": null,
          "old_text": "file_setup_decoders(ctx)",
          "new_text": null,
          "old_line_content": "    if (!file_setup_decoders(ctx))",
          "new_line_content": "                          OSSL_PASSPHRASE_CALLBACK *pw_cb, void *pw_cbarg)",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 6,
      "total_additions": 50,
      "total_deletions": 50,
      "total_api_changes": 106
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 13,
        "api_related_lines": 106,
        "non_api_lines": 8,
        "non_api_line_numbers": [
          418,
          427,
          429,
          431,
          466,
          467,
          472,
          473
        ]
      }
    },
    "api_calls_before": 116,
    "api_calls_after": 116,
    "diff_info": {
      "added_lines": 10,
      "removed_lines": 4,
      "total_diff_lines": 40
    }
  }
}