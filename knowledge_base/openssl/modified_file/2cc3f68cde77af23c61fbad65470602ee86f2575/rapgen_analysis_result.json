{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/openssl/modified_file/2cc3f68cde77af23c61fbad65470602ee86f2575",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/openssl/modified_file/2cc3f68cde77af23c61fbad65470602ee86f2575/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/openssl/modified_file/2cc3f68cde77af23c61fbad65470602ee86f2575/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/openssl/modified_file/2cc3f68cde77af23c61fbad65470602ee86f2575/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 290,
          "old_api": "rsa_get_blinding",
          "new_api": "BN_MONT_CTX_set_locked",
          "old_text": "rsa_get_blinding(rsa, &local_blinding, ctx)",
          "new_text": "BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,\n                                    rsa->n, ctx)",
          "old_line_content": "        blinding = rsa_get_blinding(rsa, &local_blinding, ctx);",
          "new_line_content": "        if (!BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,",
          "content_same": false
        },
        {
          "line": 316,
          "old_api": "RSAerr",
          "new_api": "rsa_mod_exp",
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_ENCRYPT, ERR_R_MALLOC_FAILURE)",
          "new_text": "rsa->meth->rsa_mod_exp(ret, f, rsa, ctx)",
          "old_line_content": "            RSAerr(RSA_F_RSA_OSSL_PRIVATE_ENCRYPT, ERR_R_MALLOC_FAILURE);",
          "new_line_content": "        if (!rsa->meth->rsa_mod_exp(ret, f, rsa, ctx))",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": "BN_with_flags",
          "new_api": "BN_new",
          "old_text": "BN_with_flags(d, rsa->d, BN_FLG_CONSTTIME)",
          "new_text": "BN_new()",
          "old_line_content": "        BN_with_flags(d, rsa->d, BN_FLG_CONSTTIME);",
          "new_line_content": "        BIGNUM *d = BN_new();",
          "content_same": false
        },
        {
          "line": 324,
          "old_api": "BN_free",
          "new_api": "BN_with_flags",
          "old_text": "BN_free(d)",
          "new_text": "BN_with_flags(d, rsa->d, BN_FLG_CONSTTIME)",
          "old_line_content": "                BN_free(d);",
          "new_line_content": "        BN_with_flags(d, rsa->d, BN_FLG_CONSTTIME);",
          "content_same": false
        },
        {
          "line": 328,
          "old_api": "bn_mod_exp",
          "new_api": "BN_free",
          "old_text": "rsa->meth->bn_mod_exp(ret, f, d, rsa->n, ctx,\n                                   rsa->_method_mod_n)",
          "new_text": "BN_free(d)",
          "old_line_content": "        if (!rsa->meth->bn_mod_exp(ret, f, d, rsa->n, ctx,",
          "new_line_content": "            BN_free(d);",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": "BN_sub",
          "new_api": "BN_cmp",
          "old_text": "BN_sub(f, rsa->n, ret)",
          "new_text": "BN_cmp(ret, f)",
          "old_line_content": "        if (!BN_sub(f, rsa->n, ret))",
          "new_line_content": "        if (BN_cmp(ret, f) > 0)",
          "content_same": false
        },
        {
          "line": 359,
          "old_api": "BN_CTX_end",
          "new_api": "OPENSSL_clear_free",
          "old_text": "BN_CTX_end(ctx)",
          "new_text": "OPENSSL_clear_free(buf, num)",
          "old_line_content": "        BN_CTX_end(ctx);",
          "new_line_content": "    OPENSSL_clear_free(buf, num);",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": "BN_CTX_new",
          "new_api": "BN_CTX_start",
          "old_text": "BN_CTX_new()",
          "new_text": "BN_CTX_start(ctx)",
          "old_line_content": "    if ((ctx = BN_CTX_new()) == NULL)",
          "new_line_content": "    BN_CTX_start(ctx);",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": "BN_CTX_start",
          "new_api": "BN_CTX_get",
          "old_text": "BN_CTX_start(ctx)",
          "new_text": "BN_CTX_get(ctx)",
          "old_line_content": "    BN_CTX_start(ctx);",
          "new_line_content": "    ret = BN_CTX_get(ctx);",
          "content_same": false
        },
        {
          "line": 384,
          "old_api": "BN_CTX_get",
          "new_api": "BN_num_bytes",
          "old_text": "BN_CTX_get(ctx)",
          "new_text": "BN_num_bytes(rsa->n)",
          "old_line_content": "    f = BN_CTX_get(ctx);",
          "new_line_content": "    num = BN_num_bytes(rsa->n);",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": "BN_CTX_get",
          "new_api": "OPENSSL_malloc",
          "old_text": "BN_CTX_get(ctx)",
          "new_text": "OPENSSL_malloc(num)",
          "old_line_content": "    ret = BN_CTX_get(ctx);",
          "new_line_content": "    buf = OPENSSL_malloc(num);",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": "OPENSSL_malloc",
          "new_api": "RSAerr",
          "old_text": "OPENSSL_malloc(num)",
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_MALLOC_FAILURE)",
          "old_line_content": "    buf = OPENSSL_malloc(num);",
          "new_line_content": "        RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_MALLOC_FAILURE);",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": "rsa_get_blinding",
          "new_api": "RSAerr",
          "old_text": "rsa_get_blinding(rsa, &local_blinding, ctx)",
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_INTERNAL_ERROR)",
          "old_line_content": "        blinding = rsa_get_blinding(rsa, &local_blinding, ctx);",
          "new_line_content": "            RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_INTERNAL_ERROR);",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": "BN_new",
          "new_api": "RSAerr",
          "old_text": "BN_new()",
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_MALLOC_FAILURE)",
          "old_line_content": "        BIGNUM *d = BN_new();",
          "new_line_content": "            RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_MALLOC_FAILURE);",
          "content_same": false
        },
        {
          "line": 447,
          "old_api": "BN_MONT_CTX_set_locked",
          "new_api": "BN_free",
          "old_text": "BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,\n                                        rsa->n, ctx)",
          "new_text": "BN_free(d)",
          "old_line_content": "            if (!BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,",
          "new_line_content": "                BN_free(d);",
          "content_same": false
        },
        {
          "line": 452,
          "old_api": "bn_mod_exp",
          "new_api": "BN_free",
          "old_text": "rsa->meth->bn_mod_exp(ret, f, d, rsa->n, ctx,\n                                   rsa->_method_mod_n)",
          "new_text": "BN_free(d)",
          "old_line_content": "        if (!rsa->meth->bn_mod_exp(ret, f, d, rsa->n, ctx,",
          "new_line_content": "            BN_free(d);",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": "BN_CTX_end",
          "new_api": "OPENSSL_clear_free",
          "old_text": "BN_CTX_end(ctx)",
          "new_text": "OPENSSL_clear_free(buf, num)",
          "old_line_content": "        BN_CTX_end(ctx);",
          "new_line_content": "    OPENSSL_clear_free(buf, num);",
          "content_same": false
        },
        {
          "line": 515,
          "old_api": "BN_num_bits",
          "new_api": "RSAerr",
          "old_text": "BN_num_bits(rsa->n)",
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_BAD_E_VALUE)",
          "old_line_content": "    if (BN_num_bits(rsa->n) > OPENSSL_RSA_SMALL_MODULUS_BITS) {",
          "new_line_content": "            RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_BAD_E_VALUE);",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": "BN_CTX_new",
          "new_api": "BN_CTX_start",
          "old_text": "BN_CTX_new()",
          "new_text": "BN_CTX_start(ctx)",
          "old_line_content": "    if ((ctx = BN_CTX_new()) == NULL)",
          "new_line_content": "    BN_CTX_start(ctx);",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": "BN_CTX_start",
          "new_api": "BN_CTX_get",
          "old_text": "BN_CTX_start(ctx)",
          "new_text": "BN_CTX_get(ctx)",
          "old_line_content": "    BN_CTX_start(ctx);",
          "new_line_content": "    ret = BN_CTX_get(ctx);",
          "content_same": false
        },
        {
          "line": 525,
          "old_api": "BN_CTX_get",
          "new_api": "BN_num_bytes",
          "old_text": "BN_CTX_get(ctx)",
          "new_text": "BN_num_bytes(rsa->n)",
          "old_line_content": "    f = BN_CTX_get(ctx);",
          "new_line_content": "    num = BN_num_bytes(rsa->n);",
          "content_same": false
        },
        {
          "line": 526,
          "old_api": "BN_CTX_get",
          "new_api": "OPENSSL_malloc",
          "old_text": "BN_CTX_get(ctx)",
          "new_text": "OPENSSL_malloc(num)",
          "old_line_content": "    ret = BN_CTX_get(ctx);",
          "new_line_content": "    buf = OPENSSL_malloc(num);",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": "OPENSSL_malloc",
          "new_api": "RSAerr",
          "old_text": "OPENSSL_malloc(num)",
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, ERR_R_MALLOC_FAILURE)",
          "old_line_content": "    buf = OPENSSL_malloc(num);",
          "new_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, ERR_R_MALLOC_FAILURE);",
          "content_same": false
        },
        {
          "line": 586,
          "old_api": "BN_CTX_end",
          "new_api": "OPENSSL_clear_free",
          "old_text": "BN_CTX_end(ctx)",
          "new_text": "OPENSSL_clear_free(buf, num)",
          "old_line_content": "        BN_CTX_end(ctx);",
          "new_line_content": "    OPENSSL_clear_free(buf, num);",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": "BN_CTX_start",
          "new_api": "BN_CTX_get",
          "old_text": "BN_CTX_start(ctx)",
          "new_text": "BN_CTX_get(ctx)",
          "old_line_content": "    BN_CTX_start(ctx);",
          "new_line_content": "    r1 = BN_CTX_get(ctx);",
          "content_same": false
        },
        {
          "line": 623,
          "old_api": "BN_MONT_CTX_set_locked",
          "new_api": "BN_with_flags",
          "old_text": "BN_MONT_CTX_set_locked(&rsa->_method_mod_p, rsa->lock,\n                                     factor, ctx)",
          "new_text": "BN_with_flags(factor, rsa->q, BN_FLG_CONSTTIME)",
          "old_line_content": "              BN_MONT_CTX_set_locked(&rsa->_method_mod_p, rsa->lock,",
          "new_line_content": "            || !(BN_with_flags(factor, rsa->q, BN_FLG_CONSTTIME),",
          "content_same": false
        },
        {
          "line": 626,
          "old_api": "BN_MONT_CTX_set_locked",
          "new_api": "BN_free",
          "old_text": "BN_MONT_CTX_set_locked(&rsa->_method_mod_q, rsa->lock,\n                                        factor, ctx)",
          "new_text": "BN_free(factor)",
          "old_line_content": "                 BN_MONT_CTX_set_locked(&rsa->_method_mod_q, rsa->lock,",
          "new_line_content": "            BN_free(factor);",
          "content_same": false
        },
        {
          "line": 632,
          "old_api": "sk_RSA_PRIME_INFO_value",
          "new_api": "BN_MONT_CTX_set_locked",
          "old_text": "sk_RSA_PRIME_INFO_value(rsa->prime_infos, i)",
          "new_text": "BN_MONT_CTX_set_locked(&pinfo->m, rsa->lock, factor, ctx)",
          "old_line_content": "            pinfo = sk_RSA_PRIME_INFO_value(rsa->prime_infos, i);",
          "new_line_content": "            if (!BN_MONT_CTX_set_locked(&pinfo->m, rsa->lock, factor, ctx)) {",
          "content_same": false
        },
        {
          "line": 633,
          "old_api": "BN_with_flags",
          "new_api": "BN_free",
          "old_text": "BN_with_flags(factor, pinfo->r, BN_FLG_CONSTTIME)",
          "new_text": "BN_free(factor)",
          "old_line_content": "            BN_with_flags(factor, pinfo->r, BN_FLG_CONSTTIME);",
          "new_line_content": "                BN_free(factor);",
          "content_same": false
        },
        {
          "line": 664,
          "old_api": "bn_to_mont_fixed_top",
          "new_api": "BN_mod_exp_mont_consttime",
          "old_text": "bn_to_mont_fixed_top(m1, m1, rsa->_method_mod_q, ctx)",
          "new_text": "BN_mod_exp_mont_consttime(m1, m1, rsa->dmq1, rsa->q, ctx,\n                                          rsa->_method_mod_q)",
          "old_line_content": "            || !bn_to_mont_fixed_top(m1, m1, rsa->_method_mod_q, ctx)",
          "new_line_content": "            || !BN_mod_exp_mont_consttime(m1, m1, rsa->dmq1, rsa->q, ctx,",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": "bn_to_mont_fixed_top",
          "new_api": "BN_mod_exp_mont_consttime",
          "old_text": "bn_to_mont_fixed_top(r1, r1, rsa->_method_mod_p, ctx)",
          "new_text": "BN_mod_exp_mont_consttime(r1, r1, rsa->dmp1, rsa->p, ctx,\n                                          rsa->_method_mod_p)",
          "old_line_content": "            || !bn_to_mont_fixed_top(r1, r1, rsa->_method_mod_p, ctx)",
          "new_line_content": "            || !BN_mod_exp_mont_consttime(r1, r1, rsa->dmp1, rsa->p, ctx,",
          "content_same": false
        },
        {
          "line": 700,
          "old_api": "BN_with_flags",
          "new_api": "BN_mod",
          "old_text": "BN_with_flags(c, I, BN_FLG_CONSTTIME)",
          "new_text": "BN_mod(r1, c, rsa->q, ctx)",
          "old_line_content": "        BN_with_flags(c, I, BN_FLG_CONSTTIME);",
          "new_line_content": "        if (!BN_mod(r1, c, rsa->q, ctx)) {",
          "content_same": false
        },
        {
          "line": 708,
          "old_api": "BN_new",
          "new_api": "BN_free",
          "old_text": "BN_new()",
          "new_text": "BN_free(c)",
          "old_line_content": "            BIGNUM *dmq1 = BN_new();",
          "new_line_content": "                BN_free(c);",
          "content_same": false
        },
        {
          "line": 716,
          "old_api": "bn_mod_exp",
          "new_api": "BN_free",
          "old_text": "rsa->meth->bn_mod_exp(m1, r1, dmq1, rsa->q, ctx,\n                                       rsa->_method_mod_q)",
          "new_text": "BN_free(c)",
          "old_line_content": "            if (!rsa->meth->bn_mod_exp(m1, r1, dmq1, rsa->q, ctx,",
          "new_line_content": "                BN_free(c);",
          "content_same": false
        },
        {
          "line": 742,
          "old_api": "bn_mod_exp",
          "new_api": "BN_free",
          "old_text": "rsa->meth->bn_mod_exp(r0, r1, dmp1, rsa->p, ctx,\n                                   rsa->_method_mod_p)",
          "new_text": "BN_free(dmp1)",
          "old_line_content": "        if (!rsa->meth->bn_mod_exp(r0, r1, dmp1, rsa->p, ctx,",
          "new_line_content": "            BN_free(dmp1);",
          "content_same": false
        },
        {
          "line": 772,
          "old_api": "BN_CTX_get",
          "new_api": "BN_free",
          "old_text": "BN_CTX_get(ctx)",
          "new_text": "BN_free(di)",
          "old_line_content": "            if ((m[i] = BN_CTX_get(ctx)) == NULL) {",
          "new_line_content": "                BN_free(di);",
          "content_same": false
        },
        {
          "line": 782,
          "old_api": "BN_with_flags",
          "new_api": "BN_mod",
          "old_text": "BN_with_flags(di, pinfo->d, BN_FLG_CONSTTIME)",
          "new_text": "BN_mod(r1, cc, pinfo->r, ctx)",
          "old_line_content": "            BN_with_flags(di, pinfo->d, BN_FLG_CONSTTIME);",
          "new_line_content": "            if (!BN_mod(r1, cc, pinfo->r, ctx)) {",
          "content_same": false
        },
        {
          "line": 784,
          "old_api": "BN_mod",
          "new_api": "BN_free",
          "old_text": "BN_mod(r1, cc, pinfo->r, ctx)",
          "new_text": "BN_free(di)",
          "old_line_content": "            if (!BN_mod(r1, cc, pinfo->r, ctx)) {",
          "new_line_content": "                BN_free(di);",
          "content_same": false
        },
        {
          "line": 790,
          "old_api": "bn_mod_exp",
          "new_api": "BN_free",
          "old_text": "rsa->meth->bn_mod_exp(m[i], r1, di, pinfo->r, ctx, pinfo->m)",
          "new_text": "BN_free(di)",
          "old_line_content": "            if (!rsa->meth->bn_mod_exp(m[i], r1, di, pinfo->r, ctx, pinfo->m)) {",
          "new_line_content": "                BN_free(di);",
          "content_same": false
        },
        {
          "line": 818,
          "old_api": "BN_with_flags",
          "new_api": "BN_mod",
          "old_text": "BN_with_flags(pr1, r1, BN_FLG_CONSTTIME)",
          "new_text": "BN_mod(r0, pr1, rsa->p, ctx)",
          "old_line_content": "        BN_with_flags(pr1, r1, BN_FLG_CONSTTIME);",
          "new_line_content": "        if (!BN_mod(r0, pr1, rsa->p, ctx)) {",
          "content_same": false
        },
        {
          "line": 836,
          "old_api": "BN_add",
          "new_api": "BN_mul",
          "old_text": "BN_add(r0, r0, rsa->p)",
          "new_text": "BN_mul(r1, r0, rsa->q, ctx)",
          "old_line_content": "        if (!BN_add(r0, r0, rsa->p))",
          "new_line_content": "    if (!BN_mul(r1, r0, rsa->q, ctx))",
          "content_same": false
        },
        {
          "line": 838,
          "old_api": "BN_mul",
          "new_api": "BN_add",
          "old_text": "BN_mul(r1, r0, rsa->q, ctx)",
          "new_text": "BN_add(r0, r1, m1)",
          "old_line_content": "    if (!BN_mul(r1, r0, rsa->q, ctx))",
          "new_line_content": "    if (!BN_add(r0, r1, m1))",
          "content_same": false
        },
        {
          "line": 851,
          "old_api": "sk_RSA_PRIME_INFO_value",
          "new_api": "BN_free",
          "old_text": "sk_RSA_PRIME_INFO_value(rsa->prime_infos, i)",
          "new_text": "BN_free(pr2)",
          "old_line_content": "            pinfo = sk_RSA_PRIME_INFO_value(rsa->prime_infos, i);",
          "new_line_content": "                BN_free(pr2);",
          "content_same": false
        },
        {
          "line": 862,
          "old_api": "BN_with_flags",
          "new_api": "BN_mod",
          "old_text": "BN_with_flags(pr2, r2, BN_FLG_CONSTTIME)",
          "new_text": "BN_mod(r1, pr2, pinfo->r, ctx)",
          "old_line_content": "            BN_with_flags(pr2, r2, BN_FLG_CONSTTIME);",
          "new_line_content": "            if (!BN_mod(r1, pr2, pinfo->r, ctx)) {",
          "content_same": false
        },
        {
          "line": 869,
          "old_api": "BN_is_negative",
          "new_api": "BN_free",
          "old_text": "BN_is_negative(r1)",
          "new_text": "BN_free(pr2)",
          "old_line_content": "            if (BN_is_negative(r1))",
          "new_line_content": "                    BN_free(pr2);",
          "content_same": false
        },
        {
          "line": 904,
          "old_api": "BN_sub",
          "new_api": "BN_is_zero",
          "old_text": "BN_sub(vrfy, vrfy, I)",
          "new_text": "BN_is_zero(vrfy)",
          "old_line_content": "        if (!BN_sub(vrfy, vrfy, I))",
          "new_line_content": "        if (BN_is_zero(vrfy)) {",
          "content_same": false
        },
        {
          "line": 911,
          "old_api": "BN_mod",
          "new_api": "BN_is_negative",
          "old_text": "BN_mod(vrfy, vrfy, rsa->n, ctx)",
          "new_text": "BN_is_negative(vrfy)",
          "old_line_content": "        if (!BN_mod(vrfy, vrfy, rsa->n, ctx))",
          "new_line_content": "        if (BN_is_negative(vrfy))",
          "content_same": false
        },
        {
          "line": 914,
          "old_api": "BN_add",
          "new_api": "BN_is_zero",
          "old_text": "BN_add(vrfy, vrfy, rsa->n)",
          "new_text": "BN_is_zero(vrfy)",
          "old_line_content": "            if (!BN_add(vrfy, vrfy, rsa->n))",
          "new_line_content": "        if (!BN_is_zero(vrfy)) {",
          "content_same": false
        },
        {
          "line": 926,
          "old_api": "BN_with_flags",
          "new_api": "bn_mod_exp",
          "old_text": "BN_with_flags(d, rsa->d, BN_FLG_CONSTTIME)",
          "new_text": "rsa->meth->bn_mod_exp(r0, I, d, rsa->n, ctx,\n                                       rsa->_method_mod_n)",
          "old_line_content": "            BN_with_flags(d, rsa->d, BN_FLG_CONSTTIME);",
          "new_line_content": "            if (!rsa->meth->bn_mod_exp(r0, I, d, rsa->n, ctx,",
          "content_same": false
        },
        {
          "line": 928,
          "old_api": "bn_mod_exp",
          "new_api": "BN_free",
          "old_text": "rsa->meth->bn_mod_exp(r0, I, d, rsa->n, ctx,\n                                       rsa->_method_mod_n)",
          "new_text": "BN_free(d)",
          "old_line_content": "            if (!rsa->meth->bn_mod_exp(r0, I, d, rsa->n, ctx,",
          "new_line_content": "                BN_free(d);",
          "content_same": false
        },
        {
          "line": 964,
          "old_api": "BN_MONT_CTX_free",
          "new_api": "sk_RSA_PRIME_INFO_num",
          "old_text": "BN_MONT_CTX_free(rsa->_method_mod_p)",
          "new_text": "sk_RSA_PRIME_INFO_num(rsa->prime_infos)",
          "old_line_content": "    BN_MONT_CTX_free(rsa->_method_mod_p);",
          "new_line_content": "    for (i = 0; i < sk_RSA_PRIME_INFO_num(rsa->prime_infos); i++) {",
          "content_same": false
        },
        {
          "line": 965,
          "old_api": "BN_MONT_CTX_free",
          "new_api": "sk_RSA_PRIME_INFO_value",
          "old_text": "BN_MONT_CTX_free(rsa->_method_mod_q)",
          "new_text": "sk_RSA_PRIME_INFO_value(rsa->prime_infos, i)",
          "old_line_content": "    BN_MONT_CTX_free(rsa->_method_mod_q);",
          "new_line_content": "        pinfo = sk_RSA_PRIME_INFO_value(rsa->prime_infos, i);",
          "content_same": false
        },
        {
          "line": 966,
          "old_api": "sk_RSA_PRIME_INFO_num",
          "new_api": "BN_MONT_CTX_free",
          "old_text": "sk_RSA_PRIME_INFO_num(rsa->prime_infos)",
          "new_text": "BN_MONT_CTX_free(pinfo->m)",
          "old_line_content": "    for (i = 0; i < sk_RSA_PRIME_INFO_num(rsa->prime_infos); i++) {",
          "new_line_content": "        BN_MONT_CTX_free(pinfo->m);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 513,
          "old_api": null,
          "new_api": "BN_num_bits",
          "old_text": null,
          "new_text": "BN_num_bits(rsa->n)",
          "old_line_content": "",
          "new_line_content": "    if (BN_num_bits(rsa->n) > OPENSSL_RSA_SMALL_MODULUS_BITS) {",
          "content_same": false
        },
        {
          "line": 514,
          "old_api": null,
          "new_api": "BN_num_bits",
          "old_text": null,
          "new_text": "BN_num_bits(rsa->e)",
          "old_line_content": "    /* for large moduli, enforce exponent limit */",
          "new_line_content": "        if (BN_num_bits(rsa->e) > OPENSSL_RSA_MAX_PUBEXP_BITS) {",
          "content_same": false
        },
        {
          "line": 520,
          "old_api": null,
          "new_api": "BN_CTX_new",
          "old_text": null,
          "new_text": "BN_CTX_new()",
          "old_line_content": "    }",
          "new_line_content": "    if ((ctx = BN_CTX_new()) == NULL)",
          "content_same": false
        },
        {
          "line": 523,
          "old_api": null,
          "new_api": "BN_CTX_get",
          "old_text": null,
          "new_text": "BN_CTX_get(ctx)",
          "old_line_content": "        goto err;",
          "new_line_content": "    f = BN_CTX_get(ctx);",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_DATA_GREATER_THAN_MOD_LEN)",
          "old_line_content": "     */",
          "new_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_DATA_GREATER_THAN_MOD_LEN);",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": null,
          "new_api": "BN_bin2bn",
          "old_text": null,
          "new_text": "BN_bin2bn(from, flen, f)",
          "old_line_content": "    }",
          "new_line_content": "    if (BN_bin2bn(from, flen, f) == NULL)",
          "content_same": false
        },
        {
          "line": 544,
          "old_api": null,
          "new_api": "BN_ucmp",
          "old_text": null,
          "new_text": "BN_ucmp(f, rsa->n)",
          "old_line_content": "        goto err;",
          "new_line_content": "    if (BN_ucmp(f, rsa->n) >= 0) {",
          "content_same": false
        },
        {
          "line": 545,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT,\n               RSA_R_DATA_TOO_LARGE_FOR_MODULUS)",
          "old_line_content": "",
          "new_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT,",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": null,
          "new_api": "BN_MONT_CTX_set_locked",
          "old_text": null,
          "new_text": "BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,\n                                    rsa->n, ctx)",
          "old_line_content": "",
          "new_line_content": "        if (!BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,",
          "content_same": false
        },
        {
          "line": 555,
          "old_api": null,
          "new_api": "bn_mod_exp",
          "old_text": null,
          "new_text": "rsa->meth->bn_mod_exp(ret, f, rsa->e, rsa->n, ctx,\n                               rsa->_method_mod_n)",
          "old_line_content": "            goto err;",
          "new_line_content": "    if (!rsa->meth->bn_mod_exp(ret, f, rsa->e, rsa->n, ctx,",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": null,
          "new_api": "bn_get_words",
          "old_text": null,
          "new_text": "bn_get_words(ret)",
          "old_line_content": "        goto err;",
          "new_line_content": "    if ((padding == RSA_X931_PADDING) && ((bn_get_words(ret)[0] & 0xf) != 12))",
          "content_same": false
        },
        {
          "line": 560,
          "old_api": null,
          "new_api": "BN_sub",
          "old_text": null,
          "new_text": "BN_sub(ret, rsa->n, ret)",
          "old_line_content": "",
          "new_line_content": "        if (!BN_sub(ret, rsa->n, ret))",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": null,
          "new_api": "BN_bn2binpad",
          "old_text": null,
          "new_text": "BN_bn2binpad(ret, buf, num)",
          "old_line_content": "            goto err;",
          "new_line_content": "    i = BN_bn2binpad(ret, buf, num);",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": null,
          "new_api": "RSA_padding_check_PKCS1_type_1",
          "old_text": null,
          "new_text": "RSA_padding_check_PKCS1_type_1(to, num, buf, i, num)",
          "old_line_content": "    switch (padding) {",
          "new_line_content": "        r = RSA_padding_check_PKCS1_type_1(to, num, buf, i, num);",
          "content_same": false
        },
        {
          "line": 570,
          "old_api": null,
          "new_api": "RSA_padding_check_X931",
          "old_text": null,
          "new_text": "RSA_padding_check_X931(to, num, buf, i, num)",
          "old_line_content": "        break;",
          "new_line_content": "        r = RSA_padding_check_X931(to, num, buf, i, num);",
          "content_same": false
        },
        {
          "line": 573,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(to, buf, (r = i))",
          "old_line_content": "        break;",
          "new_line_content": "        memcpy(to, buf, (r = i));",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_UNKNOWN_PADDING_TYPE)",
          "old_line_content": "        break;",
          "new_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_UNKNOWN_PADDING_TYPE);",
          "content_same": false
        },
        {
          "line": 580,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_PADDING_CHECK_FAILED)",
          "old_line_content": "    }",
          "new_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_PADDING_CHECK_FAILED);",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": null,
          "new_api": "BN_CTX_end",
          "old_text": null,
          "new_text": "BN_CTX_end(ctx)",
          "old_line_content": " err:",
          "new_line_content": "        BN_CTX_end(ctx);",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": null,
          "new_api": "BN_CTX_free",
          "old_text": null,
          "new_text": "BN_CTX_free(ctx)",
          "old_line_content": "    if (ctx != NULL)",
          "new_line_content": "    BN_CTX_free(ctx);",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": null,
          "new_api": "BN_CTX_start",
          "old_text": null,
          "new_text": "BN_CTX_start(ctx)",
          "old_line_content": "    RSA_PRIME_INFO *pinfo;",
          "new_line_content": "    BN_CTX_start(ctx);",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": null,
          "new_api": "BN_CTX_get",
          "old_text": null,
          "new_text": "BN_CTX_get(ctx)",
          "old_line_content": "",
          "new_line_content": "    r2 = BN_CTX_get(ctx);",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": null,
          "new_api": "sk_RSA_PRIME_INFO_num",
          "old_text": null,
          "new_text": "sk_RSA_PRIME_INFO_num(rsa->prime_infos)",
          "old_line_content": "",
          "new_line_content": "        && ((ex_primes = sk_RSA_PRIME_INFO_num(rsa->prime_infos)) <= 0",
          "content_same": false
        },
        {
          "line": 611,
          "old_api": null,
          "new_api": "BN_new",
          "old_text": null,
          "new_text": "BN_new()",
          "old_line_content": "",
          "new_line_content": "        BIGNUM *factor = BN_new();",
          "content_same": false
        },
        {
          "line": 620,
          "old_api": null,
          "new_api": "BN_with_flags",
          "old_text": null,
          "new_text": "BN_with_flags(factor, rsa->p, BN_FLG_CONSTTIME)",
          "old_line_content": "         * BN_FLG_CONSTTIME flag",
          "new_line_content": "        if (!(BN_with_flags(factor, rsa->p, BN_FLG_CONSTTIME),",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": null,
          "new_api": "BN_MONT_CTX_set_locked",
          "old_text": null,
          "new_text": "BN_MONT_CTX_set_locked(&rsa->_method_mod_p, rsa->lock,\n                                     factor, ctx)",
          "old_line_content": "         */",
          "new_line_content": "              BN_MONT_CTX_set_locked(&rsa->_method_mod_p, rsa->lock,",
          "content_same": false
        },
        {
          "line": 624,
          "old_api": null,
          "new_api": "BN_MONT_CTX_set_locked",
          "old_text": null,
          "new_text": "BN_MONT_CTX_set_locked(&rsa->_method_mod_q, rsa->lock,\n                                        factor, ctx)",
          "old_line_content": "                                     factor, ctx))",
          "new_line_content": "                 BN_MONT_CTX_set_locked(&rsa->_method_mod_q, rsa->lock,",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": null,
          "new_api": "sk_RSA_PRIME_INFO_value",
          "old_text": null,
          "new_text": "sk_RSA_PRIME_INFO_value(rsa->prime_infos, i)",
          "old_line_content": "        }",
          "new_line_content": "            pinfo = sk_RSA_PRIME_INFO_value(rsa->prime_infos, i);",
          "content_same": false
        },
        {
          "line": 631,
          "old_api": null,
          "new_api": "BN_with_flags",
          "old_text": null,
          "new_text": "BN_with_flags(factor, pinfo->r, BN_FLG_CONSTTIME)",
          "old_line_content": "        for (i = 0; i < ex_primes; i++) {",
          "new_line_content": "            BN_with_flags(factor, pinfo->r, BN_FLG_CONSTTIME);",
          "content_same": false
        },
        {
          "line": 640,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(factor)",
          "old_line_content": "         * We MUST free |factor| before any further use of the prime factors",
          "new_line_content": "        BN_free(factor);",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": null,
          "new_api": "BN_num_bits",
          "old_text": null,
          "new_text": "BN_num_bits(rsa->p)",
          "old_line_content": "        smooth = (ex_primes == 0)",
          "new_line_content": "                 && (BN_num_bits(rsa->q) == BN_num_bits(rsa->p));",
          "content_same": false
        },
        {
          "line": 648,
          "old_api": null,
          "new_api": "BN_MONT_CTX_set_locked",
          "old_text": null,
          "new_text": "BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,\n                                    rsa->n, ctx)",
          "old_line_content": "",
          "new_line_content": "        if (!BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": null,
          "new_api": "bn_from_mont_fixed_top",
          "old_text": null,
          "new_text": "bn_from_mont_fixed_top(m1, I, rsa->_method_mod_q, ctx)",
          "old_line_content": "         */",
          "new_line_content": "            !bn_from_mont_fixed_top(m1, I, rsa->_method_mod_q, ctx)",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": null,
          "new_api": "bn_to_mont_fixed_top",
          "old_text": null,
          "new_text": "bn_to_mont_fixed_top(m1, m1, rsa->_method_mod_q, ctx)",
          "old_line_content": "        if (/* m1 = I moq q */",
          "new_line_content": "            || !bn_to_mont_fixed_top(m1, m1, rsa->_method_mod_q, ctx)",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": null,
          "new_api": "bn_from_mont_fixed_top",
          "old_text": null,
          "new_text": "bn_from_mont_fixed_top(r1, I, rsa->_method_mod_p, ctx)",
          "old_line_content": "                                          rsa->_method_mod_q)",
          "new_line_content": "            || !bn_from_mont_fixed_top(r1, I, rsa->_method_mod_p, ctx)",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": null,
          "new_api": "bn_to_mont_fixed_top",
          "old_text": null,
          "new_text": "bn_to_mont_fixed_top(r1, r1, rsa->_method_mod_p, ctx)",
          "old_line_content": "            /* r1 = I mod p */",
          "new_line_content": "            || !bn_to_mont_fixed_top(r1, r1, rsa->_method_mod_p, ctx)",
          "content_same": false
        },
        {
          "line": 679,
          "old_api": null,
          "new_api": "bn_mod_sub_fixed_top",
          "old_text": null,
          "new_text": "bn_mod_sub_fixed_top(r1, r1, m1, rsa->p)",
          "old_line_content": "             * when |m1| can be larger than |rsa->p|.",
          "new_line_content": "            || !bn_mod_sub_fixed_top(r1, r1, m1, rsa->p)",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": null,
          "new_api": "bn_to_mont_fixed_top",
          "old_text": null,
          "new_text": "bn_to_mont_fixed_top(r1, r1, rsa->_method_mod_p, ctx)",
          "old_line_content": "",
          "new_line_content": "            || !bn_to_mont_fixed_top(r1, r1, rsa->_method_mod_p, ctx)",
          "content_same": false
        },
        {
          "line": 683,
          "old_api": null,
          "new_api": "bn_mul_mont_fixed_top",
          "old_text": null,
          "new_text": "bn_mul_mont_fixed_top(r1, r1, rsa->iqmp, rsa->_method_mod_p,\n                                      ctx)",
          "old_line_content": "            /* r1 = r1 * iqmp mod p */",
          "new_line_content": "            || !bn_mul_mont_fixed_top(r1, r1, rsa->iqmp, rsa->_method_mod_p,",
          "content_same": false
        },
        {
          "line": 686,
          "old_api": null,
          "new_api": "bn_mul_fixed_top",
          "old_text": null,
          "new_text": "bn_mul_fixed_top(r0, r1, rsa->q, ctx)",
          "old_line_content": "                                      ctx)",
          "new_line_content": "            || !bn_mul_fixed_top(r0, r1, rsa->q, ctx)",
          "content_same": false
        },
        {
          "line": 687,
          "old_api": null,
          "new_api": "bn_mod_add_fixed_top",
          "old_text": null,
          "new_text": "bn_mod_add_fixed_top(r0, r0, m1, rsa->n)",
          "old_line_content": "            /* r0 = r1 * q + m1 */",
          "new_line_content": "            || !bn_mod_add_fixed_top(r0, r0, m1, rsa->n))",
          "content_same": false
        },
        {
          "line": 695,
          "old_api": null,
          "new_api": "BN_new",
          "old_text": null,
          "new_text": "BN_new()",
          "old_line_content": "    /* compute I mod q */",
          "new_line_content": "        BIGNUM *c = BN_new();",
          "content_same": false
        },
        {
          "line": 698,
          "old_api": null,
          "new_api": "BN_with_flags",
          "old_text": null,
          "new_text": "BN_with_flags(c, I, BN_FLG_CONSTTIME)",
          "old_line_content": "        if (c == NULL)",
          "new_line_content": "        BN_with_flags(c, I, BN_FLG_CONSTTIME);",
          "content_same": false
        },
        {
          "line": 701,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(c)",
          "old_line_content": "",
          "new_line_content": "            BN_free(c);",
          "content_same": false
        },
        {
          "line": 706,
          "old_api": null,
          "new_api": "BN_new",
          "old_text": null,
          "new_text": "BN_new()",
          "old_line_content": "",
          "new_line_content": "            BIGNUM *dmq1 = BN_new();",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": null,
          "new_api": "BN_with_flags",
          "old_text": null,
          "new_text": "BN_with_flags(dmq1, rsa->dmq1, BN_FLG_CONSTTIME)",
          "old_line_content": "                goto err;",
          "new_line_content": "            BN_with_flags(dmq1, rsa->dmq1, BN_FLG_CONSTTIME);",
          "content_same": false
        },
        {
          "line": 714,
          "old_api": null,
          "new_api": "bn_mod_exp",
          "old_text": null,
          "new_text": "rsa->meth->bn_mod_exp(m1, r1, dmq1, rsa->q, ctx,\n                                       rsa->_method_mod_q)",
          "old_line_content": "",
          "new_line_content": "            if (!rsa->meth->bn_mod_exp(m1, r1, dmq1, rsa->q, ctx,",
          "content_same": false
        },
        {
          "line": 717,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(dmq1)",
          "old_line_content": "                                       rsa->_method_mod_q)) {",
          "new_line_content": "                BN_free(dmq1);",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(dmq1)",
          "old_line_content": "            }",
          "new_line_content": "            BN_free(dmq1);",
          "content_same": false
        },
        {
          "line": 725,
          "old_api": null,
          "new_api": "BN_mod",
          "old_text": null,
          "new_text": "BN_mod(r1, c, rsa->p, ctx)",
          "old_line_content": "",
          "new_line_content": "        if (!BN_mod(r1, c, rsa->p, ctx)) {",
          "content_same": false
        },
        {
          "line": 726,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(c)",
          "old_line_content": "        /* compute I mod p */",
          "new_line_content": "            BN_free(c);",
          "content_same": false
        },
        {
          "line": 730,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(c)",
          "old_line_content": "        }",
          "new_line_content": "        BN_free(c);",
          "content_same": false
        },
        {
          "line": 734,
          "old_api": null,
          "new_api": "BN_new",
          "old_text": null,
          "new_text": "BN_new()",
          "old_line_content": "",
          "new_line_content": "        BIGNUM *dmp1 = BN_new();",
          "content_same": false
        },
        {
          "line": 737,
          "old_api": null,
          "new_api": "BN_with_flags",
          "old_text": null,
          "new_text": "BN_with_flags(dmp1, rsa->dmp1, BN_FLG_CONSTTIME)",
          "old_line_content": "        if (dmp1 == NULL)",
          "new_line_content": "        BN_with_flags(dmp1, rsa->dmp1, BN_FLG_CONSTTIME);",
          "content_same": false
        },
        {
          "line": 740,
          "old_api": null,
          "new_api": "bn_mod_exp",
          "old_text": null,
          "new_text": "rsa->meth->bn_mod_exp(r0, r1, dmp1, rsa->p, ctx,\n                                   rsa->_method_mod_p)",
          "old_line_content": "",
          "new_line_content": "        if (!rsa->meth->bn_mod_exp(r0, r1, dmp1, rsa->p, ctx,",
          "content_same": false
        },
        {
          "line": 746,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(dmp1)",
          "old_line_content": "        }",
          "new_line_content": "        BN_free(dmp1);",
          "content_same": false
        },
        {
          "line": 760,
          "old_api": null,
          "new_api": "BN_new",
          "old_text": null,
          "new_text": "BN_new()",
          "old_line_content": "     */",
          "new_line_content": "        BIGNUM *di = BN_new(), *cc = BN_new();",
          "content_same": false
        },
        {
          "line": 763,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(cc)",
          "old_line_content": "",
          "new_line_content": "            BN_free(cc);",
          "content_same": false
        },
        {
          "line": 764,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(di)",
          "old_line_content": "        if (cc == NULL || di == NULL) {",
          "new_line_content": "            BN_free(di);",
          "content_same": false
        },
        {
          "line": 770,
          "old_api": null,
          "new_api": "BN_CTX_get",
          "old_text": null,
          "new_text": "BN_CTX_get(ctx)",
          "old_line_content": "        for (i = 0; i < ex_primes; i++) {",
          "new_line_content": "            if ((m[i] = BN_CTX_get(ctx)) == NULL) {",
          "content_same": false
        },
        {
          "line": 771,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(cc)",
          "old_line_content": "            /* prepare m_i */",
          "new_line_content": "                BN_free(cc);",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": null,
          "new_api": "sk_RSA_PRIME_INFO_value",
          "old_text": null,
          "new_text": "sk_RSA_PRIME_INFO_value(rsa->prime_infos, i)",
          "old_line_content": "            }",
          "new_line_content": "            pinfo = sk_RSA_PRIME_INFO_value(rsa->prime_infos, i);",
          "content_same": false
        },
        {
          "line": 779,
          "old_api": null,
          "new_api": "BN_with_flags",
          "old_text": null,
          "new_text": "BN_with_flags(cc, I, BN_FLG_CONSTTIME)",
          "old_line_content": "",
          "new_line_content": "            BN_with_flags(cc, I, BN_FLG_CONSTTIME);",
          "content_same": false
        },
        {
          "line": 780,
          "old_api": null,
          "new_api": "BN_with_flags",
          "old_text": null,
          "new_text": "BN_with_flags(di, pinfo->d, BN_FLG_CONSTTIME)",
          "old_line_content": "            /* prepare c and d_i */",
          "new_line_content": "            BN_with_flags(di, pinfo->d, BN_FLG_CONSTTIME);",
          "content_same": false
        },
        {
          "line": 783,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(cc)",
          "old_line_content": "",
          "new_line_content": "                BN_free(cc);",
          "content_same": false
        },
        {
          "line": 788,
          "old_api": null,
          "new_api": "bn_mod_exp",
          "old_text": null,
          "new_text": "rsa->meth->bn_mod_exp(m[i], r1, di, pinfo->r, ctx, pinfo->m)",
          "old_line_content": "            }",
          "new_line_content": "            if (!rsa->meth->bn_mod_exp(m[i], r1, di, pinfo->r, ctx, pinfo->m)) {",
          "content_same": false
        },
        {
          "line": 789,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(cc)",
          "old_line_content": "            /* compute r1 ^ d_i mod r_i */",
          "new_line_content": "                BN_free(cc);",
          "content_same": false
        },
        {
          "line": 795,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(cc)",
          "old_line_content": "        }",
          "new_line_content": "        BN_free(cc);",
          "content_same": false
        },
        {
          "line": 796,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(di)",
          "old_line_content": "",
          "new_line_content": "        BN_free(di);",
          "content_same": false
        },
        {
          "line": 799,
          "old_api": null,
          "new_api": "BN_sub",
          "old_text": null,
          "new_text": "BN_sub(r0, r0, m1)",
          "old_line_content": "    }",
          "new_line_content": "    if (!BN_sub(r0, r0, m1))",
          "content_same": false
        },
        {
          "line": 805,
          "old_api": null,
          "new_api": "BN_is_negative",
          "old_text": null,
          "new_text": "BN_is_negative(r0)",
          "old_line_content": "     * multiply if it optimised for a power of 2 size",
          "new_line_content": "    if (BN_is_negative(r0))",
          "content_same": false
        },
        {
          "line": 806,
          "old_api": null,
          "new_api": "BN_add",
          "old_text": null,
          "new_text": "BN_add(r0, r0, rsa->p)",
          "old_line_content": "     */",
          "new_line_content": "        if (!BN_add(r0, r0, rsa->p))",
          "content_same": false
        },
        {
          "line": 295,
          "old_api": null,
          "new_api": "rsa_get_blinding",
          "old_text": null,
          "new_text": "rsa_get_blinding(rsa, &local_blinding, ctx)",
          "old_line_content": "    }",
          "new_line_content": "        blinding = rsa_get_blinding(rsa, &local_blinding, ctx);",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_ENCRYPT, ERR_R_INTERNAL_ERROR)",
          "old_line_content": "    if (blinding != NULL) {",
          "new_line_content": "            RSAerr(RSA_F_RSA_OSSL_PRIVATE_ENCRYPT, ERR_R_INTERNAL_ERROR);",
          "content_same": false
        },
        {
          "line": 809,
          "old_api": null,
          "new_api": "BN_mul",
          "old_text": null,
          "new_text": "BN_mul(r1, r0, rsa->iqmp, ctx)",
          "old_line_content": "            goto err;",
          "new_line_content": "    if (!BN_mul(r1, r0, rsa->iqmp, ctx))",
          "content_same": false
        },
        {
          "line": 813,
          "old_api": null,
          "new_api": "BN_new",
          "old_text": null,
          "new_text": "BN_new()",
          "old_line_content": "",
          "new_line_content": "        BIGNUM *pr1 = BN_new();",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": null,
          "new_api": "BN_CTX_get",
          "old_text": null,
          "new_text": "BN_CTX_get(ctx)",
          "old_line_content": "            goto err;",
          "new_line_content": "        if (!local_blinding && ((unblind = BN_CTX_get(ctx)) == NULL)) {",
          "content_same": false
        },
        {
          "line": 304,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_ENCRYPT, ERR_R_MALLOC_FAILURE)",
          "old_line_content": "    }",
          "new_line_content": "            RSAerr(RSA_F_RSA_OSSL_PRIVATE_ENCRYPT, ERR_R_MALLOC_FAILURE);",
          "content_same": false
        },
        {
          "line": 816,
          "old_api": null,
          "new_api": "BN_with_flags",
          "old_text": null,
          "new_text": "BN_with_flags(pr1, r1, BN_FLG_CONSTTIME)",
          "old_line_content": "        if (pr1 == NULL)",
          "new_line_content": "        BN_with_flags(pr1, r1, BN_FLG_CONSTTIME);",
          "content_same": false
        },
        {
          "line": 307,
          "old_api": null,
          "new_api": "rsa_blinding_convert",
          "old_text": null,
          "new_text": "rsa_blinding_convert(blinding, f, unblind, ctx)",
          "old_line_content": "        (rsa->version == RSA_ASN1_VERSION_MULTI) ||",
          "new_line_content": "        if (!rsa_blinding_convert(blinding, f, unblind, ctx))",
          "content_same": false
        },
        {
          "line": 819,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(pr1)",
          "old_line_content": "",
          "new_line_content": "            BN_free(pr1);",
          "content_same": false
        },
        {
          "line": 823,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(pr1)",
          "old_line_content": "        }",
          "new_line_content": "        BN_free(pr1);",
          "content_same": false
        },
        {
          "line": 321,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_ENCRYPT, ERR_R_MALLOC_FAILURE)",
          "old_line_content": "        if (rsa->flags & RSA_FLAG_CACHE_PUBLIC)",
          "new_line_content": "            RSAerr(RSA_F_RSA_OSSL_PRIVATE_ENCRYPT, ERR_R_MALLOC_FAILURE);",
          "content_same": false
        },
        {
          "line": 833,
          "old_api": null,
          "new_api": "BN_is_negative",
          "old_text": null,
          "new_text": "BN_is_negative(r0)",
          "old_line_content": "     * with OpenSSL generated keys because they ensure p > q [steve]",
          "new_line_content": "    if (BN_is_negative(r0))",
          "content_same": false
        },
        {
          "line": 834,
          "old_api": null,
          "new_api": "BN_add",
          "old_text": null,
          "new_text": "BN_add(r0, r0, rsa->p)",
          "old_line_content": "     */",
          "new_line_content": "        if (!BN_add(r0, r0, rsa->p))",
          "content_same": false
        },
        {
          "line": 326,
          "old_api": null,
          "new_api": "bn_mod_exp",
          "old_text": null,
          "new_text": "rsa->meth->bn_mod_exp(ret, f, d, rsa->n, ctx,\n                                   rsa->_method_mod_n)",
          "old_line_content": "            }",
          "new_line_content": "        if (!rsa->meth->bn_mod_exp(ret, f, d, rsa->n, ctx,",
          "content_same": false
        },
        {
          "line": 843,
          "old_api": null,
          "new_api": "BN_new",
          "old_text": null,
          "new_text": "BN_new()",
          "old_line_content": "    /* add m_i to m in multi-prime case */",
          "new_line_content": "        BIGNUM *pr2 = BN_new();",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(d)",
          "old_line_content": "        }",
          "new_line_content": "        BN_free(d);",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": null,
          "new_api": "rsa_blinding_invert",
          "old_text": null,
          "new_text": "rsa_blinding_invert(blinding, ret, unblind, ctx)",
          "old_line_content": "",
          "new_line_content": "        if (!rsa_blinding_invert(blinding, ret, unblind, ctx))",
          "content_same": false
        },
        {
          "line": 849,
          "old_api": null,
          "new_api": "sk_RSA_PRIME_INFO_value",
          "old_text": null,
          "new_text": "sk_RSA_PRIME_INFO_value(rsa->prime_infos, i)",
          "old_line_content": "",
          "new_line_content": "            pinfo = sk_RSA_PRIME_INFO_value(rsa->prime_infos, i);",
          "content_same": false
        },
        {
          "line": 850,
          "old_api": null,
          "new_api": "BN_sub",
          "old_text": null,
          "new_text": "BN_sub(r1, m[i], r0)",
          "old_line_content": "        for (i = 0; i < ex_primes; i++) {",
          "new_line_content": "            if (!BN_sub(r1, m[i], r0)) {",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": null,
          "new_api": "BN_sub",
          "old_text": null,
          "new_text": "BN_sub(f, rsa->n, ret)",
          "old_line_content": "",
          "new_line_content": "        if (!BN_sub(f, rsa->n, ret))",
          "content_same": false
        },
        {
          "line": 855,
          "old_api": null,
          "new_api": "BN_mul",
          "old_text": null,
          "new_text": "BN_mul(r2, r1, pinfo->t, ctx)",
          "old_line_content": "            }",
          "new_line_content": "            if (!BN_mul(r2, r1, pinfo->t, ctx)) {",
          "content_same": false
        },
        {
          "line": 856,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(pr2)",
          "old_line_content": "",
          "new_line_content": "                BN_free(pr2);",
          "content_same": false
        },
        {
          "line": 860,
          "old_api": null,
          "new_api": "BN_with_flags",
          "old_text": null,
          "new_text": "BN_with_flags(pr2, r2, BN_FLG_CONSTTIME)",
          "old_line_content": "            }",
          "new_line_content": "            BN_with_flags(pr2, r2, BN_FLG_CONSTTIME);",
          "content_same": false
        },
        {
          "line": 863,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(pr2)",
          "old_line_content": "",
          "new_line_content": "                BN_free(pr2);",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": null,
          "new_api": "BN_bn2binpad",
          "old_text": null,
          "new_text": "BN_bn2binpad(res, to, num)",
          "old_line_content": "     * the length of the modulus.",
          "new_line_content": "    r = BN_bn2binpad(res, to, num);",
          "content_same": false
        },
        {
          "line": 867,
          "old_api": null,
          "new_api": "BN_is_negative",
          "old_text": null,
          "new_text": "BN_is_negative(r1)",
          "old_line_content": "            }",
          "new_line_content": "            if (BN_is_negative(r1))",
          "content_same": false
        },
        {
          "line": 868,
          "old_api": null,
          "new_api": "BN_add",
          "old_text": null,
          "new_text": "BN_add(r1, r1, pinfo->r)",
          "old_line_content": "",
          "new_line_content": "                if (!BN_add(r1, r1, pinfo->r)) {",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": null,
          "new_api": "BN_CTX_end",
          "old_text": null,
          "new_text": "BN_CTX_end(ctx)",
          "old_line_content": " err:",
          "new_line_content": "        BN_CTX_end(ctx);",
          "content_same": false
        },
        {
          "line": 358,
          "old_api": null,
          "new_api": "BN_CTX_free",
          "old_text": null,
          "new_text": "BN_CTX_free(ctx)",
          "old_line_content": "    if (ctx != NULL)",
          "new_line_content": "    BN_CTX_free(ctx);",
          "content_same": false
        },
        {
          "line": 872,
          "old_api": null,
          "new_api": "BN_mul",
          "old_text": null,
          "new_text": "BN_mul(r1, r1, pinfo->pp, ctx)",
          "old_line_content": "                    goto err;",
          "new_line_content": "            if (!BN_mul(r1, r1, pinfo->pp, ctx)) {",
          "content_same": false
        },
        {
          "line": 873,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(pr2)",
          "old_line_content": "                }",
          "new_line_content": "                BN_free(pr2);",
          "content_same": false
        },
        {
          "line": 876,
          "old_api": null,
          "new_api": "BN_add",
          "old_text": null,
          "new_text": "BN_add(r0, r0, r1)",
          "old_line_content": "                goto err;",
          "new_line_content": "            if (!BN_add(r0, r0, r1)) {",
          "content_same": false
        },
        {
          "line": 877,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(pr2)",
          "old_line_content": "            }",
          "new_line_content": "                BN_free(pr2);",
          "content_same": false
        },
        {
          "line": 881,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(pr2)",
          "old_line_content": "            }",
          "new_line_content": "        BN_free(pr2);",
          "content_same": false
        },
        {
          "line": 887,
          "old_api": null,
          "new_api": "BN_mod_exp_mont",
          "old_text": null,
          "new_text": "BN_mod_exp_mont(vrfy, r0, rsa->e, rsa->n, ctx,\n                                 rsa->_method_mod_n)",
          "old_line_content": "    if (rsa->e && rsa->n) {",
          "new_line_content": "            if (!BN_mod_exp_mont(vrfy, r0, rsa->e, rsa->n, ctx,",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": null,
          "new_api": "BN_CTX_new",
          "old_text": null,
          "new_text": "BN_CTX_new()",
          "old_line_content": "    BN_BLINDING *blinding = NULL;",
          "new_line_content": "    if ((ctx = BN_CTX_new()) == NULL)",
          "content_same": false
        },
        {
          "line": 891,
          "old_api": null,
          "new_api": "bn_correct_top",
          "old_text": null,
          "new_text": "bn_correct_top(r0)",
          "old_line_content": "                goto err;",
          "new_line_content": "            bn_correct_top(r0);",
          "content_same": false
        },
        {
          "line": 892,
          "old_api": null,
          "new_api": "bn_mod_exp",
          "old_text": null,
          "new_text": "rsa->meth->bn_mod_exp(vrfy, r0, rsa->e, rsa->n, ctx,\n                                       rsa->_method_mod_n)",
          "old_line_content": "        } else {",
          "new_line_content": "            if (!rsa->meth->bn_mod_exp(vrfy, r0, rsa->e, rsa->n, ctx,",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": null,
          "new_api": "BN_CTX_get",
          "old_text": null,
          "new_text": "BN_CTX_get(ctx)",
          "old_line_content": "        goto err;",
          "new_line_content": "    f = BN_CTX_get(ctx);",
          "content_same": false
        },
        {
          "line": 902,
          "old_api": null,
          "new_api": "BN_sub",
          "old_text": null,
          "new_text": "BN_sub(vrfy, vrfy, I)",
          "old_line_content": "         * absolute equality, just congruency.",
          "new_line_content": "        if (!BN_sub(vrfy, vrfy, I))",
          "content_same": false
        },
        {
          "line": 905,
          "old_api": null,
          "new_api": "bn_correct_top",
          "old_text": null,
          "new_text": "bn_correct_top(r0)",
          "old_line_content": "            goto err;",
          "new_line_content": "            bn_correct_top(r0);",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT,\n               RSA_R_DATA_GREATER_THAN_MOD_LEN)",
          "old_line_content": "     */",
          "new_line_content": "        RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT,",
          "content_same": false
        },
        {
          "line": 909,
          "old_api": null,
          "new_api": "BN_mod",
          "old_text": null,
          "new_text": "BN_mod(vrfy, vrfy, rsa->n, ctx)",
          "old_line_content": "            goto err;   /* not actually error */",
          "new_line_content": "        if (!BN_mod(vrfy, vrfy, rsa->n, ctx))",
          "content_same": false
        },
        {
          "line": 912,
          "old_api": null,
          "new_api": "BN_add",
          "old_text": null,
          "new_text": "BN_add(vrfy, vrfy, rsa->n)",
          "old_line_content": "            goto err;",
          "new_line_content": "            if (!BN_add(vrfy, vrfy, rsa->n))",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": null,
          "new_api": "BN_bin2bn",
          "old_text": null,
          "new_text": "BN_bin2bn(from, (int)flen, f)",
          "old_line_content": "",
          "new_line_content": "    if (BN_bin2bn(from, (int)flen, f) == NULL)",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": null,
          "new_api": "BN_ucmp",
          "old_text": null,
          "new_text": "BN_ucmp(f, rsa->n)",
          "old_line_content": "        goto err;",
          "new_line_content": "    if (BN_ucmp(f, rsa->n) >= 0) {",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT,\n               RSA_R_DATA_TOO_LARGE_FOR_MODULUS)",
          "old_line_content": "",
          "new_line_content": "        RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT,",
          "content_same": false
        },
        {
          "line": 921,
          "old_api": null,
          "new_api": "BN_new",
          "old_text": null,
          "new_text": "BN_new()",
          "old_line_content": "             */",
          "new_line_content": "            BIGNUM *d = BN_new();",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": null,
          "new_api": "rsa_get_blinding",
          "old_text": null,
          "new_text": "rsa_get_blinding(rsa, &local_blinding, ctx)",
          "old_line_content": "",
          "new_line_content": "        blinding = rsa_get_blinding(rsa, &local_blinding, ctx);",
          "content_same": false
        },
        {
          "line": 924,
          "old_api": null,
          "new_api": "BN_with_flags",
          "old_text": null,
          "new_text": "BN_with_flags(d, rsa->d, BN_FLG_CONSTTIME)",
          "old_line_content": "            if (d == NULL)",
          "new_line_content": "            BN_with_flags(d, rsa->d, BN_FLG_CONSTTIME);",
          "content_same": false
        },
        {
          "line": 420,
          "old_api": null,
          "new_api": "BN_CTX_get",
          "old_text": null,
          "new_text": "BN_CTX_get(ctx)",
          "old_line_content": "",
          "new_line_content": "        if (!local_blinding && ((unblind = BN_CTX_get(ctx)) == NULL)) {",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_MALLOC_FAILURE)",
          "old_line_content": "    if (blinding != NULL) {",
          "new_line_content": "            RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_MALLOC_FAILURE);",
          "content_same": false
        },
        {
          "line": 932,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(d)",
          "old_line_content": "            }",
          "new_line_content": "            BN_free(d);",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": null,
          "new_api": "rsa_blinding_convert",
          "old_text": null,
          "new_text": "rsa_blinding_convert(blinding, f, unblind, ctx)",
          "old_line_content": "            goto err;",
          "new_line_content": "        if (!rsa_blinding_convert(blinding, f, unblind, ctx))",
          "content_same": false
        },
        {
          "line": 943,
          "old_api": null,
          "new_api": "bn_correct_top",
          "old_text": null,
          "new_text": "bn_correct_top(r0)",
          "old_line_content": "     * time and even conceal memory access pattern around corrected top.",
          "new_line_content": "    bn_correct_top(r0);",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": null,
          "new_api": "rsa_mod_exp",
          "old_text": null,
          "new_text": "rsa->meth->rsa_mod_exp(ret, f, rsa, ctx)",
          "old_line_content": "         (rsa->q != NULL) &&",
          "new_line_content": "        if (!rsa->meth->rsa_mod_exp(ret, f, rsa, ctx))",
          "content_same": false
        },
        {
          "line": 946,
          "old_api": null,
          "new_api": "BN_CTX_end",
          "old_text": null,
          "new_text": "BN_CTX_end(ctx)",
          "old_line_content": "    ret = 1;",
          "new_line_content": "    BN_CTX_end(ctx);",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": null,
          "new_api": "BN_new",
          "old_text": null,
          "new_text": "BN_new()",
          "old_line_content": "            goto err;",
          "new_line_content": "        BIGNUM *d = BN_new();",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": null,
          "new_api": "BN_with_flags",
          "old_text": null,
          "new_text": "BN_with_flags(d, rsa->d, BN_FLG_CONSTTIME)",
          "old_line_content": "            goto err;",
          "new_line_content": "        BN_with_flags(d, rsa->d, BN_FLG_CONSTTIME);",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": null,
          "new_api": "BN_MONT_CTX_set_locked",
          "old_text": null,
          "new_text": "BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,\n                                        rsa->n, ctx)",
          "old_line_content": "",
          "new_line_content": "            if (!BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,",
          "content_same": false
        },
        {
          "line": 961,
          "old_api": null,
          "new_api": "BN_MONT_CTX_free",
          "old_text": null,
          "new_text": "BN_MONT_CTX_free(rsa->_method_mod_n)",
          "old_line_content": "    RSA_PRIME_INFO *pinfo;",
          "new_line_content": "    BN_MONT_CTX_free(rsa->_method_mod_n);",
          "content_same": false
        },
        {
          "line": 450,
          "old_api": null,
          "new_api": "bn_mod_exp",
          "old_text": null,
          "new_text": "rsa->meth->bn_mod_exp(ret, f, d, rsa->n, ctx,\n                                   rsa->_method_mod_n)",
          "old_line_content": "                goto err;",
          "new_line_content": "        if (!rsa->meth->bn_mod_exp(ret, f, d, rsa->n, ctx,",
          "content_same": false
        },
        {
          "line": 962,
          "old_api": null,
          "new_api": "BN_MONT_CTX_free",
          "old_text": null,
          "new_text": "BN_MONT_CTX_free(rsa->_method_mod_p)",
          "old_line_content": "",
          "new_line_content": "    BN_MONT_CTX_free(rsa->_method_mod_p);",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": null,
          "new_api": "BN_free",
          "old_text": null,
          "new_text": "BN_free(d)",
          "old_line_content": "        }",
          "new_line_content": "        BN_free(d);",
          "content_same": false
        },
        {
          "line": 460,
          "old_api": null,
          "new_api": "rsa_blinding_invert",
          "old_text": null,
          "new_text": "rsa_blinding_invert(blinding, ret, unblind, ctx)",
          "old_line_content": "",
          "new_line_content": "        if (!rsa_blinding_invert(blinding, ret, unblind, ctx))",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": null,
          "new_api": "BN_bn2binpad",
          "old_text": null,
          "new_text": "BN_bn2binpad(ret, buf, num)",
          "old_line_content": "            goto err;",
          "new_line_content": "    j = BN_bn2binpad(ret, buf, num);",
          "content_same": false
        },
        {
          "line": 467,
          "old_api": null,
          "new_api": "RSA_padding_check_PKCS1_type_2",
          "old_text": null,
          "new_text": "RSA_padding_check_PKCS1_type_2(to, num, buf, j, num)",
          "old_line_content": "    switch (padding) {",
          "new_line_content": "        r = RSA_padding_check_PKCS1_type_2(to, num, buf, j, num);",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": null,
          "new_api": "RSA_padding_check_PKCS1_OAEP",
          "old_text": null,
          "new_text": "RSA_padding_check_PKCS1_OAEP(to, num, buf, j, num, NULL, 0)",
          "old_line_content": "        break;",
          "new_line_content": "        r = RSA_padding_check_PKCS1_OAEP(to, num, buf, j, num, NULL, 0);",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": null,
          "new_api": "RSA_padding_check_SSLv23",
          "old_text": null,
          "new_text": "RSA_padding_check_SSLv23(to, num, buf, j, num)",
          "old_line_content": "        break;",
          "new_line_content": "        r = RSA_padding_check_SSLv23(to, num, buf, j, num);",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(to, buf, (r = j))",
          "old_line_content": "        break;",
          "new_line_content": "        memcpy(to, buf, (r = j));",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, RSA_R_UNKNOWN_PADDING_TYPE)",
          "old_line_content": "        break;",
          "new_line_content": "        RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, RSA_R_UNKNOWN_PADDING_TYPE);",
          "content_same": false
        },
        {
          "line": 483,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, RSA_R_PADDING_CHECK_FAILED)",
          "old_line_content": "    }",
          "new_line_content": "        RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, RSA_R_PADDING_CHECK_FAILED);",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": null,
          "new_api": "BN_CTX_end",
          "old_text": null,
          "new_text": "BN_CTX_end(ctx)",
          "old_line_content": " err:",
          "new_line_content": "        BN_CTX_end(ctx);",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": null,
          "new_api": "BN_CTX_free",
          "old_text": null,
          "new_text": "BN_CTX_free(ctx)",
          "old_line_content": "    if (ctx != NULL)",
          "new_line_content": "    BN_CTX_free(ctx);",
          "content_same": false
        },
        {
          "line": 502,
          "old_api": null,
          "new_api": "BN_num_bits",
          "old_text": null,
          "new_text": "BN_num_bits(rsa->n)",
          "old_line_content": "    BN_CTX *ctx = NULL;",
          "new_line_content": "    if (BN_num_bits(rsa->n) > OPENSSL_RSA_MAX_MODULUS_BITS) {",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_MODULUS_TOO_LARGE)",
          "old_line_content": "",
          "new_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_MODULUS_TOO_LARGE);",
          "content_same": false
        },
        {
          "line": 507,
          "old_api": null,
          "new_api": "BN_ucmp",
          "old_text": null,
          "new_text": "BN_ucmp(rsa->n, rsa->e)",
          "old_line_content": "    }",
          "new_line_content": "    if (BN_ucmp(rsa->n, rsa->e) <= 0) {",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": null,
          "new_api": "RSAerr",
          "old_text": null,
          "new_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_BAD_E_VALUE)",
          "old_line_content": "",
          "new_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_BAD_E_VALUE);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 516,
          "old_api": "BN_num_bits",
          "new_api": null,
          "old_text": "BN_num_bits(rsa->e)",
          "new_text": null,
          "old_line_content": "        if (BN_num_bits(rsa->e) > OPENSSL_RSA_MAX_PUBEXP_BITS) {",
          "new_line_content": "            return -1;",
          "content_same": false
        },
        {
          "line": 517,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_BAD_E_VALUE)",
          "new_text": null,
          "old_line_content": "            RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_BAD_E_VALUE);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 527,
          "old_api": "BN_num_bytes",
          "new_api": null,
          "old_text": "BN_num_bytes(rsa->n)",
          "new_text": null,
          "old_line_content": "    num = BN_num_bytes(rsa->n);",
          "new_line_content": "    if (ret == NULL || buf == NULL) {",
          "content_same": false
        },
        {
          "line": 530,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, ERR_R_MALLOC_FAILURE)",
          "new_text": null,
          "old_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, ERR_R_MALLOC_FAILURE);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_DATA_GREATER_THAN_MOD_LEN)",
          "new_text": null,
          "old_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_DATA_GREATER_THAN_MOD_LEN);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": "BN_bin2bn",
          "new_api": null,
          "old_text": "BN_bin2bn(from, flen, f)",
          "new_text": null,
          "old_line_content": "    if (BN_bin2bn(from, flen, f) == NULL)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 546,
          "old_api": "BN_ucmp",
          "new_api": null,
          "old_text": "BN_ucmp(f, rsa->n)",
          "new_text": null,
          "old_line_content": "    if (BN_ucmp(f, rsa->n) >= 0) {",
          "new_line_content": "               RSA_R_DATA_TOO_LARGE_FOR_MODULUS);",
          "content_same": false
        },
        {
          "line": 547,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT,\n               RSA_R_DATA_TOO_LARGE_FOR_MODULUS)",
          "new_text": null,
          "old_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT,",
          "new_line_content": "        goto err;",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": "BN_MONT_CTX_set_locked",
          "new_api": null,
          "old_text": "BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,\n                                    rsa->n, ctx)",
          "new_text": null,
          "old_line_content": "        if (!BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": "bn_mod_exp",
          "new_api": null,
          "old_text": "rsa->meth->bn_mod_exp(ret, f, rsa->e, rsa->n, ctx,\n                               rsa->_method_mod_n)",
          "new_text": null,
          "old_line_content": "    if (!rsa->meth->bn_mod_exp(ret, f, rsa->e, rsa->n, ctx,",
          "new_line_content": "        goto err;",
          "content_same": false
        },
        {
          "line": 561,
          "old_api": "bn_get_words",
          "new_api": null,
          "old_text": "bn_get_words(ret)",
          "new_text": null,
          "old_line_content": "    if ((padding == RSA_X931_PADDING) && ((bn_get_words(ret)[0] & 0xf) != 12))",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 562,
          "old_api": "BN_sub",
          "new_api": null,
          "old_text": "BN_sub(ret, rsa->n, ret)",
          "new_text": null,
          "old_line_content": "        if (!BN_sub(ret, rsa->n, ret))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": "BN_bn2binpad",
          "new_api": null,
          "old_text": "BN_bn2binpad(ret, buf, num)",
          "new_text": null,
          "old_line_content": "    i = BN_bn2binpad(ret, buf, num);",
          "new_line_content": "    switch (padding) {",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "RSA_padding_check_PKCS1_type_1",
          "new_api": null,
          "old_text": "RSA_padding_check_PKCS1_type_1(to, num, buf, i, num)",
          "new_text": null,
          "old_line_content": "        r = RSA_padding_check_PKCS1_type_1(to, num, buf, i, num);",
          "new_line_content": "    case RSA_X931_PADDING:",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": "RSA_padding_check_X931",
          "new_api": null,
          "old_text": "RSA_padding_check_X931(to, num, buf, i, num)",
          "new_text": null,
          "old_line_content": "        r = RSA_padding_check_X931(to, num, buf, i, num);",
          "new_line_content": "    case RSA_NO_PADDING:",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(to, buf, (r = i))",
          "new_text": null,
          "old_line_content": "        memcpy(to, buf, (r = i));",
          "new_line_content": "    default:",
          "content_same": false
        },
        {
          "line": 578,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_UNKNOWN_PADDING_TYPE)",
          "new_text": null,
          "old_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_UNKNOWN_PADDING_TYPE);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 582,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_PADDING_CHECK_FAILED)",
          "new_text": null,
          "old_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_PADDING_CHECK_FAILED);",
          "new_line_content": " err:",
          "content_same": false
        },
        {
          "line": 587,
          "old_api": "BN_CTX_free",
          "new_api": null,
          "old_text": "BN_CTX_free(ctx)",
          "new_text": null,
          "old_line_content": "    BN_CTX_free(ctx);",
          "new_line_content": "    return r;",
          "content_same": false
        },
        {
          "line": 588,
          "old_api": "OPENSSL_clear_free",
          "new_api": null,
          "old_text": "OPENSSL_clear_free(buf, num)",
          "new_text": null,
          "old_line_content": "    OPENSSL_clear_free(buf, num);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 602,
          "old_api": "BN_CTX_get",
          "new_api": null,
          "old_text": "BN_CTX_get(ctx)",
          "new_text": null,
          "old_line_content": "    m1 = BN_CTX_get(ctx);",
          "new_line_content": "    if (vrfy == NULL)",
          "content_same": false
        },
        {
          "line": 603,
          "old_api": "BN_CTX_get",
          "new_api": null,
          "old_text": "BN_CTX_get(ctx)",
          "new_text": null,
          "old_line_content": "    vrfy = BN_CTX_get(ctx);",
          "new_line_content": "        goto err;",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": "sk_RSA_PRIME_INFO_num",
          "new_api": null,
          "old_text": "sk_RSA_PRIME_INFO_num(rsa->prime_infos)",
          "new_text": null,
          "old_line_content": "        && ((ex_primes = sk_RSA_PRIME_INFO_num(rsa->prime_infos)) <= 0",
          "new_line_content": "        goto err;",
          "content_same": false
        },
        {
          "line": 613,
          "old_api": "BN_new",
          "new_api": null,
          "old_text": "BN_new()",
          "new_text": null,
          "old_line_content": "        BIGNUM *factor = BN_new();",
          "new_line_content": "        if (factor == NULL)",
          "content_same": false
        },
        {
          "line": 622,
          "old_api": "BN_with_flags",
          "new_api": null,
          "old_text": "BN_with_flags(factor, rsa->p, BN_FLG_CONSTTIME)",
          "new_text": null,
          "old_line_content": "        if (!(BN_with_flags(factor, rsa->p, BN_FLG_CONSTTIME),",
          "new_line_content": "                                     factor, ctx))",
          "content_same": false
        },
        {
          "line": 625,
          "old_api": "BN_with_flags",
          "new_api": null,
          "old_text": "BN_with_flags(factor, rsa->q, BN_FLG_CONSTTIME)",
          "new_text": null,
          "old_line_content": "            || !(BN_with_flags(factor, rsa->q, BN_FLG_CONSTTIME),",
          "new_line_content": "                                        factor, ctx))) {",
          "content_same": false
        },
        {
          "line": 628,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(factor)",
          "new_text": null,
          "old_line_content": "            BN_free(factor);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 634,
          "old_api": "BN_MONT_CTX_set_locked",
          "new_api": null,
          "old_text": "BN_MONT_CTX_set_locked(&pinfo->m, rsa->lock, factor, ctx)",
          "new_text": null,
          "old_line_content": "            if (!BN_MONT_CTX_set_locked(&pinfo->m, rsa->lock, factor, ctx)) {",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 635,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(factor)",
          "new_text": null,
          "old_line_content": "                BN_free(factor);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 642,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(factor)",
          "new_text": null,
          "old_line_content": "        BN_free(factor);",
          "new_line_content": "        smooth = (ex_primes == 0)",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": "BN_num_bits",
          "new_api": null,
          "old_text": "BN_num_bits(rsa->p)",
          "new_text": null,
          "old_line_content": "                 && (BN_num_bits(rsa->q) == BN_num_bits(rsa->p));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 650,
          "old_api": "BN_MONT_CTX_set_locked",
          "new_api": null,
          "old_text": "BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,\n                                    rsa->n, ctx)",
          "new_text": null,
          "old_line_content": "        if (!BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 663,
          "old_api": "bn_from_mont_fixed_top",
          "new_api": null,
          "old_text": "bn_from_mont_fixed_top(m1, I, rsa->_method_mod_q, ctx)",
          "new_text": null,
          "old_line_content": "            !bn_from_mont_fixed_top(m1, I, rsa->_method_mod_q, ctx)",
          "new_line_content": "            /* m1 = m1^dmq1 mod q */",
          "content_same": false
        },
        {
          "line": 666,
          "old_api": "BN_mod_exp_mont_consttime",
          "new_api": null,
          "old_text": "BN_mod_exp_mont_consttime(m1, m1, rsa->dmq1, rsa->q, ctx,\n                                          rsa->_method_mod_q)",
          "new_text": null,
          "old_line_content": "            || !BN_mod_exp_mont_consttime(m1, m1, rsa->dmq1, rsa->q, ctx,",
          "new_line_content": "            /* r1 = I mod p */",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": "bn_from_mont_fixed_top",
          "new_api": null,
          "old_text": "bn_from_mont_fixed_top(r1, I, rsa->_method_mod_p, ctx)",
          "new_text": null,
          "old_line_content": "            || !bn_from_mont_fixed_top(r1, I, rsa->_method_mod_p, ctx)",
          "new_line_content": "            /* r1 = r1^dmp1 mod p */",
          "content_same": false
        },
        {
          "line": 672,
          "old_api": "BN_mod_exp_mont_consttime",
          "new_api": null,
          "old_text": "BN_mod_exp_mont_consttime(r1, r1, rsa->dmp1, rsa->p, ctx,\n                                          rsa->_method_mod_p)",
          "new_text": null,
          "old_line_content": "            || !BN_mod_exp_mont_consttime(r1, r1, rsa->dmp1, rsa->p, ctx,",
          "new_line_content": "            /* r1 = (r1 - m1) mod p */",
          "content_same": false
        },
        {
          "line": 681,
          "old_api": "bn_mod_sub_fixed_top",
          "new_api": null,
          "old_text": "bn_mod_sub_fixed_top(r1, r1, m1, rsa->p)",
          "new_text": null,
          "old_line_content": "            || !bn_mod_sub_fixed_top(r1, r1, m1, rsa->p)",
          "new_line_content": "            /* r1 = r1 * iqmp mod p */",
          "content_same": false
        },
        {
          "line": 684,
          "old_api": "bn_to_mont_fixed_top",
          "new_api": null,
          "old_text": "bn_to_mont_fixed_top(r1, r1, rsa->_method_mod_p, ctx)",
          "new_text": null,
          "old_line_content": "            || !bn_to_mont_fixed_top(r1, r1, rsa->_method_mod_p, ctx)",
          "new_line_content": "                                      ctx)",
          "content_same": false
        },
        {
          "line": 685,
          "old_api": "bn_mul_mont_fixed_top",
          "new_api": null,
          "old_text": "bn_mul_mont_fixed_top(r1, r1, rsa->iqmp, rsa->_method_mod_p,\n                                      ctx)",
          "new_text": null,
          "old_line_content": "            || !bn_mul_mont_fixed_top(r1, r1, rsa->iqmp, rsa->_method_mod_p,",
          "new_line_content": "            /* r0 = r1 * q + m1 */",
          "content_same": false
        },
        {
          "line": 688,
          "old_api": "bn_mul_fixed_top",
          "new_api": null,
          "old_text": "bn_mul_fixed_top(r0, r1, rsa->q, ctx)",
          "new_text": null,
          "old_line_content": "            || !bn_mul_fixed_top(r0, r1, rsa->q, ctx)",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 689,
          "old_api": "bn_mod_add_fixed_top",
          "new_api": null,
          "old_text": "bn_mod_add_fixed_top(r0, r0, m1, rsa->n)",
          "new_text": null,
          "old_line_content": "            || !bn_mod_add_fixed_top(r0, r0, m1, rsa->n))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 697,
          "old_api": "BN_new",
          "new_api": null,
          "old_text": "BN_new()",
          "new_text": null,
          "old_line_content": "        BIGNUM *c = BN_new();",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": "BN_mod",
          "new_api": null,
          "old_text": "BN_mod(r1, c, rsa->q, ctx)",
          "new_text": null,
          "old_line_content": "        if (!BN_mod(r1, c, rsa->q, ctx)) {",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 703,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(c)",
          "new_text": null,
          "old_line_content": "            BN_free(c);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(c)",
          "new_text": null,
          "old_line_content": "                BN_free(c);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 713,
          "old_api": "BN_with_flags",
          "new_api": null,
          "old_text": "BN_with_flags(dmq1, rsa->dmq1, BN_FLG_CONSTTIME)",
          "new_text": null,
          "old_line_content": "            BN_with_flags(dmq1, rsa->dmq1, BN_FLG_CONSTTIME);",
          "new_line_content": "            /* compute r1^dmq1 mod q */",
          "content_same": false
        },
        {
          "line": 718,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(c)",
          "new_text": null,
          "old_line_content": "                BN_free(c);",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 719,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(dmq1)",
          "new_text": null,
          "old_line_content": "                BN_free(dmq1);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 723,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(dmq1)",
          "new_text": null,
          "old_line_content": "            BN_free(dmq1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 727,
          "old_api": "BN_mod",
          "new_api": null,
          "old_text": "BN_mod(r1, c, rsa->p, ctx)",
          "new_text": null,
          "old_line_content": "        if (!BN_mod(r1, c, rsa->p, ctx)) {",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(c)",
          "new_text": null,
          "old_line_content": "            BN_free(c);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 732,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(c)",
          "new_text": null,
          "old_line_content": "        BN_free(c);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 736,
          "old_api": "BN_new",
          "new_api": null,
          "old_text": "BN_new()",
          "new_text": null,
          "old_line_content": "        BIGNUM *dmp1 = BN_new();",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 739,
          "old_api": "BN_with_flags",
          "new_api": null,
          "old_text": "BN_with_flags(dmp1, rsa->dmp1, BN_FLG_CONSTTIME)",
          "new_text": null,
          "old_line_content": "        BN_with_flags(dmp1, rsa->dmp1, BN_FLG_CONSTTIME);",
          "new_line_content": "        /* compute r1^dmp1 mod p */",
          "content_same": false
        },
        {
          "line": 744,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(dmp1)",
          "new_text": null,
          "old_line_content": "            BN_free(dmp1);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 748,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(dmp1)",
          "new_text": null,
          "old_line_content": "        BN_free(dmp1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 762,
          "old_api": "BN_new",
          "new_api": null,
          "old_text": "BN_new()",
          "new_text": null,
          "old_line_content": "        BIGNUM *di = BN_new(), *cc = BN_new();",
          "new_line_content": "        if (cc == NULL || di == NULL) {",
          "content_same": false
        },
        {
          "line": 765,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(cc)",
          "new_text": null,
          "old_line_content": "            BN_free(cc);",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(di)",
          "new_text": null,
          "old_line_content": "            BN_free(di);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 773,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(cc)",
          "new_text": null,
          "old_line_content": "                BN_free(cc);",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 774,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(di)",
          "new_text": null,
          "old_line_content": "                BN_free(di);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 778,
          "old_api": "sk_RSA_PRIME_INFO_value",
          "new_api": null,
          "old_text": "sk_RSA_PRIME_INFO_value(rsa->prime_infos, i)",
          "new_text": null,
          "old_line_content": "            pinfo = sk_RSA_PRIME_INFO_value(rsa->prime_infos, i);",
          "new_line_content": "            /* prepare c and d_i */",
          "content_same": false
        },
        {
          "line": 781,
          "old_api": "BN_with_flags",
          "new_api": null,
          "old_text": "BN_with_flags(cc, I, BN_FLG_CONSTTIME)",
          "new_text": null,
          "old_line_content": "            BN_with_flags(cc, I, BN_FLG_CONSTTIME);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 785,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(cc)",
          "new_text": null,
          "old_line_content": "                BN_free(cc);",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 786,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(di)",
          "new_text": null,
          "old_line_content": "                BN_free(di);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 791,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(cc)",
          "new_text": null,
          "old_line_content": "                BN_free(cc);",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 792,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(di)",
          "new_text": null,
          "old_line_content": "                BN_free(di);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 797,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(cc)",
          "new_text": null,
          "old_line_content": "        BN_free(cc);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 798,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(di)",
          "new_text": null,
          "old_line_content": "        BN_free(di);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 801,
          "old_api": "BN_sub",
          "new_api": null,
          "old_text": "BN_sub(r0, r0, m1)",
          "new_text": null,
          "old_line_content": "    if (!BN_sub(r0, r0, m1))",
          "new_line_content": "    /*",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_ENCRYPT, ERR_R_INTERNAL_ERROR)",
          "new_text": null,
          "old_line_content": "            RSAerr(RSA_F_RSA_OSSL_PRIVATE_ENCRYPT, ERR_R_INTERNAL_ERROR);",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 807,
          "old_api": "BN_is_negative",
          "new_api": null,
          "old_text": "BN_is_negative(r0)",
          "new_text": null,
          "old_line_content": "    if (BN_is_negative(r0))",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 808,
          "old_api": "BN_add",
          "new_api": null,
          "old_text": "BN_add(r0, r0, rsa->p)",
          "new_text": null,
          "old_line_content": "        if (!BN_add(r0, r0, rsa->p))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": "BN_CTX_get",
          "new_api": null,
          "old_text": "BN_CTX_get(ctx)",
          "new_text": null,
          "old_line_content": "        if (!local_blinding && ((unblind = BN_CTX_get(ctx)) == NULL)) {",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_ENCRYPT, ERR_R_MALLOC_FAILURE)",
          "new_text": null,
          "old_line_content": "            RSAerr(RSA_F_RSA_OSSL_PRIVATE_ENCRYPT, ERR_R_MALLOC_FAILURE);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 811,
          "old_api": "BN_mul",
          "new_api": null,
          "old_text": "BN_mul(r1, r0, rsa->iqmp, ctx)",
          "new_text": null,
          "old_line_content": "    if (!BN_mul(r1, r0, rsa->iqmp, ctx))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": "rsa_blinding_convert",
          "new_api": null,
          "old_text": "rsa_blinding_convert(blinding, f, unblind, ctx)",
          "new_text": null,
          "old_line_content": "        if (!rsa_blinding_convert(blinding, f, unblind, ctx))",
          "new_line_content": "    if (blinding != NULL) {",
          "content_same": false
        },
        {
          "line": 815,
          "old_api": "BN_new",
          "new_api": null,
          "old_text": "BN_new()",
          "new_text": null,
          "old_line_content": "        BIGNUM *pr1 = BN_new();",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 820,
          "old_api": "BN_mod",
          "new_api": null,
          "old_text": "BN_mod(r0, pr1, rsa->p, ctx)",
          "new_text": null,
          "old_line_content": "        if (!BN_mod(r0, pr1, rsa->p, ctx)) {",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 821,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(pr1)",
          "new_text": null,
          "old_line_content": "            BN_free(pr1);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 311,
          "old_api": "rsa_mod_exp",
          "new_api": null,
          "old_text": "rsa->meth->rsa_mod_exp(ret, f, rsa, ctx)",
          "new_text": null,
          "old_line_content": "        if (!rsa->meth->rsa_mod_exp(ret, f, rsa, ctx))",
          "new_line_content": "    if ((rsa->flags & RSA_FLAG_EXT_PKEY) ||",
          "content_same": false
        },
        {
          "line": 825,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(pr1)",
          "new_text": null,
          "old_line_content": "        BN_free(pr1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": "BN_new",
          "new_api": null,
          "old_text": "BN_new()",
          "new_text": null,
          "old_line_content": "        BIGNUM *d = BN_new();",
          "new_line_content": "         (rsa->q != NULL) &&",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": "BN_MONT_CTX_set_locked",
          "new_api": null,
          "old_text": "BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,\n                                        rsa->n, ctx)",
          "new_text": null,
          "old_line_content": "            if (!BN_MONT_CTX_set_locked(&rsa->_method_mod_n, rsa->lock,",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 835,
          "old_api": "BN_is_negative",
          "new_api": null,
          "old_text": "BN_is_negative(r0)",
          "new_text": null,
          "old_line_content": "    if (BN_is_negative(r0))",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 840,
          "old_api": "BN_add",
          "new_api": null,
          "old_text": "BN_add(r0, r1, m1)",
          "new_text": null,
          "old_line_content": "    if (!BN_add(r0, r1, m1))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(d)",
          "new_text": null,
          "old_line_content": "            BN_free(d);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 845,
          "old_api": "BN_new",
          "new_api": null,
          "old_text": "BN_new()",
          "new_text": null,
          "old_line_content": "        BIGNUM *pr2 = BN_new();",
          "new_line_content": "        if (pr2 == NULL)",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(d)",
          "new_text": null,
          "old_line_content": "        BN_free(d);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 338,
          "old_api": "rsa_blinding_invert",
          "new_api": null,
          "old_text": "rsa_blinding_invert(blinding, ret, unblind, ctx)",
          "new_text": null,
          "old_line_content": "        if (!rsa_blinding_invert(blinding, ret, unblind, ctx))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 852,
          "old_api": "BN_sub",
          "new_api": null,
          "old_text": "BN_sub(r1, m[i], r0)",
          "new_text": null,
          "old_line_content": "            if (!BN_sub(r1, m[i], r0)) {",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 853,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(pr2)",
          "new_text": null,
          "old_line_content": "                BN_free(pr2);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 344,
          "old_api": "BN_cmp",
          "new_api": null,
          "old_text": "BN_cmp(ret, f)",
          "new_text": null,
          "old_line_content": "        if (BN_cmp(ret, f) > 0)",
          "new_line_content": "        else",
          "content_same": false
        },
        {
          "line": 857,
          "old_api": "BN_mul",
          "new_api": null,
          "old_text": "BN_mul(r2, r1, pinfo->t, ctx)",
          "new_text": null,
          "old_line_content": "            if (!BN_mul(r2, r1, pinfo->t, ctx)) {",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 858,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(pr2)",
          "new_text": null,
          "old_line_content": "                BN_free(pr2);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 864,
          "old_api": "BN_mod",
          "new_api": null,
          "old_text": "BN_mod(r1, pr2, pinfo->r, ctx)",
          "new_text": null,
          "old_line_content": "            if (!BN_mod(r1, pr2, pinfo->r, ctx)) {",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 865,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(pr2)",
          "new_text": null,
          "old_line_content": "                BN_free(pr2);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 356,
          "old_api": "BN_bn2binpad",
          "new_api": null,
          "old_text": "BN_bn2binpad(res, to, num)",
          "new_text": null,
          "old_line_content": "    r = BN_bn2binpad(res, to, num);",
          "new_line_content": "    if (ctx != NULL)",
          "content_same": false
        },
        {
          "line": 870,
          "old_api": "BN_add",
          "new_api": null,
          "old_text": "BN_add(r1, r1, pinfo->r)",
          "new_text": null,
          "old_line_content": "                if (!BN_add(r1, r1, pinfo->r)) {",
          "new_line_content": "                    goto err;",
          "content_same": false
        },
        {
          "line": 871,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(pr2)",
          "new_text": null,
          "old_line_content": "                    BN_free(pr2);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": "BN_CTX_free",
          "new_api": null,
          "old_text": "BN_CTX_free(ctx)",
          "new_text": null,
          "old_line_content": "    BN_CTX_free(ctx);",
          "new_line_content": "    return r;",
          "content_same": false
        },
        {
          "line": 361,
          "old_api": "OPENSSL_clear_free",
          "new_api": null,
          "old_text": "OPENSSL_clear_free(buf, num)",
          "new_text": null,
          "old_line_content": "    OPENSSL_clear_free(buf, num);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 874,
          "old_api": "BN_mul",
          "new_api": null,
          "old_text": "BN_mul(r1, r1, pinfo->pp, ctx)",
          "new_text": null,
          "old_line_content": "            if (!BN_mul(r1, r1, pinfo->pp, ctx)) {",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 875,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(pr2)",
          "new_text": null,
          "old_line_content": "                BN_free(pr2);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 878,
          "old_api": "BN_add",
          "new_api": null,
          "old_text": "BN_add(r0, r0, r1)",
          "new_text": null,
          "old_line_content": "            if (!BN_add(r0, r0, r1)) {",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 879,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(pr2)",
          "new_text": null,
          "old_line_content": "                BN_free(pr2);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 883,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(pr2)",
          "new_text": null,
          "old_line_content": "        BN_free(pr2);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 889,
          "old_api": "BN_mod_exp_mont",
          "new_api": null,
          "old_text": "BN_mod_exp_mont(vrfy, r0, rsa->e, rsa->n, ctx,\n                                 rsa->_method_mod_n)",
          "new_text": null,
          "old_line_content": "            if (!BN_mod_exp_mont(vrfy, r0, rsa->e, rsa->n, ctx,",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 893,
          "old_api": "bn_correct_top",
          "new_api": null,
          "old_text": "bn_correct_top(r0)",
          "new_text": null,
          "old_line_content": "            bn_correct_top(r0);",
          "new_line_content": "                                       rsa->_method_mod_n))",
          "content_same": false
        },
        {
          "line": 894,
          "old_api": "bn_mod_exp",
          "new_api": null,
          "old_text": "rsa->meth->bn_mod_exp(vrfy, r0, rsa->e, rsa->n, ctx,\n                                       rsa->_method_mod_n)",
          "new_text": null,
          "old_line_content": "            if (!rsa->meth->bn_mod_exp(vrfy, r0, rsa->e, rsa->n, ctx,",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 386,
          "old_api": "BN_num_bytes",
          "new_api": null,
          "old_text": "BN_num_bytes(rsa->n)",
          "new_text": null,
          "old_line_content": "    num = BN_num_bytes(rsa->n);",
          "new_line_content": "    if (ret == NULL || buf == NULL) {",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_MALLOC_FAILURE)",
          "new_text": null,
          "old_line_content": "        RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_MALLOC_FAILURE);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 906,
          "old_api": "BN_is_zero",
          "new_api": null,
          "old_text": "BN_is_zero(vrfy)",
          "new_text": null,
          "old_line_content": "        if (BN_is_zero(vrfy)) {",
          "new_line_content": "            ret = 1;",
          "content_same": false
        },
        {
          "line": 907,
          "old_api": "bn_correct_top",
          "new_api": null,
          "old_text": "bn_correct_top(r0)",
          "new_text": null,
          "old_line_content": "            bn_correct_top(r0);",
          "new_line_content": "            goto err;   /* not actually error */",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT,\n               RSA_R_DATA_GREATER_THAN_MOD_LEN)",
          "new_text": null,
          "old_line_content": "        RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT,",
          "new_line_content": "        goto err;",
          "content_same": false
        },
        {
          "line": 913,
          "old_api": "BN_is_negative",
          "new_api": null,
          "old_text": "BN_is_negative(vrfy)",
          "new_text": null,
          "old_line_content": "        if (BN_is_negative(vrfy))",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 404,
          "old_api": "BN_bin2bn",
          "new_api": null,
          "old_text": "BN_bin2bn(from, (int)flen, f)",
          "new_text": null,
          "old_line_content": "    if (BN_bin2bn(from, (int)flen, f) == NULL)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 916,
          "old_api": "BN_is_zero",
          "new_api": null,
          "old_text": "BN_is_zero(vrfy)",
          "new_text": null,
          "old_line_content": "        if (!BN_is_zero(vrfy)) {",
          "new_line_content": "             * 'I' and 'vrfy' aren't congruent mod n. Don't leak",
          "content_same": false
        },
        {
          "line": 407,
          "old_api": "BN_ucmp",
          "new_api": null,
          "old_text": "BN_ucmp(f, rsa->n)",
          "new_text": null,
          "old_line_content": "    if (BN_ucmp(f, rsa->n) >= 0) {",
          "new_line_content": "               RSA_R_DATA_TOO_LARGE_FOR_MODULUS);",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT,\n               RSA_R_DATA_TOO_LARGE_FOR_MODULUS)",
          "new_text": null,
          "old_line_content": "        RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT,",
          "new_line_content": "        goto err;",
          "content_same": false
        },
        {
          "line": 923,
          "old_api": "BN_new",
          "new_api": null,
          "old_text": "BN_new()",
          "new_text": null,
          "old_line_content": "            BIGNUM *d = BN_new();",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_INTERNAL_ERROR)",
          "new_text": null,
          "old_line_content": "            RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_INTERNAL_ERROR);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 930,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(d)",
          "new_text": null,
          "old_line_content": "                BN_free(d);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 422,
          "old_api": "BN_CTX_get",
          "new_api": null,
          "old_text": "BN_CTX_get(ctx)",
          "new_text": null,
          "old_line_content": "        if (!local_blinding && ((unblind = BN_CTX_get(ctx)) == NULL)) {",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 423,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_MALLOC_FAILURE)",
          "new_text": null,
          "old_line_content": "            RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_MALLOC_FAILURE);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(d)",
          "new_text": null,
          "old_line_content": "            BN_free(d);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": "rsa_blinding_convert",
          "new_api": null,
          "old_text": "rsa_blinding_convert(blinding, f, unblind, ctx)",
          "new_text": null,
          "old_line_content": "        if (!rsa_blinding_convert(blinding, f, unblind, ctx))",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 945,
          "old_api": "bn_correct_top",
          "new_api": null,
          "old_text": "bn_correct_top(r0)",
          "new_text": null,
          "old_line_content": "    bn_correct_top(r0);",
          "new_line_content": " err:",
          "content_same": false
        },
        {
          "line": 436,
          "old_api": "rsa_mod_exp",
          "new_api": null,
          "old_text": "rsa->meth->rsa_mod_exp(ret, f, rsa, ctx)",
          "new_text": null,
          "old_line_content": "        if (!rsa->meth->rsa_mod_exp(ret, f, rsa, ctx))",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 948,
          "old_api": "BN_CTX_end",
          "new_api": null,
          "old_text": "BN_CTX_end(ctx)",
          "new_text": null,
          "old_line_content": "    BN_CTX_end(ctx);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_MALLOC_FAILURE)",
          "new_text": null,
          "old_line_content": "            RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, ERR_R_MALLOC_FAILURE);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": "BN_with_flags",
          "new_api": null,
          "old_text": "BN_with_flags(d, rsa->d, BN_FLG_CONSTTIME)",
          "new_text": null,
          "old_line_content": "        BN_with_flags(d, rsa->d, BN_FLG_CONSTTIME);",
          "new_line_content": "        if (rsa->flags & RSA_FLAG_CACHE_PUBLIC)",
          "content_same": false
        },
        {
          "line": 449,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(d)",
          "new_text": null,
          "old_line_content": "                BN_free(d);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(d)",
          "new_text": null,
          "old_line_content": "            BN_free(d);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 967,
          "old_api": "sk_RSA_PRIME_INFO_value",
          "new_api": null,
          "old_text": "sk_RSA_PRIME_INFO_value(rsa->prime_infos, i)",
          "new_text": null,
          "old_line_content": "        pinfo = sk_RSA_PRIME_INFO_value(rsa->prime_infos, i);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 968,
          "old_api": "BN_MONT_CTX_free",
          "new_api": null,
          "old_text": "BN_MONT_CTX_free(pinfo->m)",
          "new_text": null,
          "old_line_content": "        BN_MONT_CTX_free(pinfo->m);",
          "new_line_content": "    return 1;",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": "BN_free",
          "new_api": null,
          "old_text": "BN_free(d)",
          "new_text": null,
          "old_line_content": "        BN_free(d);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": "rsa_blinding_invert",
          "new_api": null,
          "old_text": "rsa_blinding_invert(blinding, ret, unblind, ctx)",
          "new_text": null,
          "old_line_content": "        if (!rsa_blinding_invert(blinding, ret, unblind, ctx))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": "BN_bn2binpad",
          "new_api": null,
          "old_text": "BN_bn2binpad(ret, buf, num)",
          "new_text": null,
          "old_line_content": "    j = BN_bn2binpad(ret, buf, num);",
          "new_line_content": "    switch (padding) {",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": "RSA_padding_check_PKCS1_type_2",
          "new_api": null,
          "old_text": "RSA_padding_check_PKCS1_type_2(to, num, buf, j, num)",
          "new_text": null,
          "old_line_content": "        r = RSA_padding_check_PKCS1_type_2(to, num, buf, j, num);",
          "new_line_content": "    case RSA_PKCS1_OAEP_PADDING:",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": "RSA_padding_check_PKCS1_OAEP",
          "new_api": null,
          "old_text": "RSA_padding_check_PKCS1_OAEP(to, num, buf, j, num, NULL, 0)",
          "new_text": null,
          "old_line_content": "        r = RSA_padding_check_PKCS1_OAEP(to, num, buf, j, num, NULL, 0);",
          "new_line_content": "    case RSA_SSLV23_PADDING:",
          "content_same": false
        },
        {
          "line": 475,
          "old_api": "RSA_padding_check_SSLv23",
          "new_api": null,
          "old_text": "RSA_padding_check_SSLv23(to, num, buf, j, num)",
          "new_text": null,
          "old_line_content": "        r = RSA_padding_check_SSLv23(to, num, buf, j, num);",
          "new_line_content": "    case RSA_NO_PADDING:",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(to, buf, (r = j))",
          "new_text": null,
          "old_line_content": "        memcpy(to, buf, (r = j));",
          "new_line_content": "    default:",
          "content_same": false
        },
        {
          "line": 481,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, RSA_R_UNKNOWN_PADDING_TYPE)",
          "new_text": null,
          "old_line_content": "        RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, RSA_R_UNKNOWN_PADDING_TYPE);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, RSA_R_PADDING_CHECK_FAILED)",
          "new_text": null,
          "old_line_content": "        RSAerr(RSA_F_RSA_OSSL_PRIVATE_DECRYPT, RSA_R_PADDING_CHECK_FAILED);",
          "new_line_content": " err:",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": "BN_CTX_free",
          "new_api": null,
          "old_text": "BN_CTX_free(ctx)",
          "new_text": null,
          "old_line_content": "    BN_CTX_free(ctx);",
          "new_line_content": "    return r;",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": "OPENSSL_clear_free",
          "new_api": null,
          "old_text": "OPENSSL_clear_free(buf, num)",
          "new_text": null,
          "old_line_content": "    OPENSSL_clear_free(buf, num);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": "BN_num_bits",
          "new_api": null,
          "old_text": "BN_num_bits(rsa->n)",
          "new_text": null,
          "old_line_content": "    if (BN_num_bits(rsa->n) > OPENSSL_RSA_MAX_MODULUS_BITS) {",
          "new_line_content": "        return -1;",
          "content_same": false
        },
        {
          "line": 505,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_MODULUS_TOO_LARGE)",
          "new_text": null,
          "old_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_MODULUS_TOO_LARGE);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 509,
          "old_api": "BN_ucmp",
          "new_api": null,
          "old_text": "BN_ucmp(rsa->n, rsa->e)",
          "new_text": null,
          "old_line_content": "    if (BN_ucmp(rsa->n, rsa->e) <= 0) {",
          "new_line_content": "        return -1;",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": "RSAerr",
          "new_api": null,
          "old_text": "RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_BAD_E_VALUE)",
          "new_text": null,
          "old_line_content": "        RSAerr(RSA_F_RSA_OSSL_PUBLIC_DECRYPT, RSA_R_BAD_E_VALUE);",
          "new_line_content": "    }",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 53,
      "total_additions": 150,
      "total_deletions": 151,
      "total_api_changes": 354
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 12,
        "api_related_lines": 354,
        "non_api_lines": 6,
        "non_api_line_numbers": [
          289,
          323,
          291,
          325,
          293,
          327
        ]
      }
    },
    "api_calls_before": 261,
    "api_calls_after": 260,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 7,
      "total_diff_lines": 31
    }
  }
}