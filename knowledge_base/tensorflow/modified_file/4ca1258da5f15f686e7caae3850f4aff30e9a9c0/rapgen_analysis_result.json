{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/4ca1258da5f15f686e7caae3850f4aff30e9a9c0",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/4ca1258da5f15f686e7caae3850f4aff30e9a9c0/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/4ca1258da5f15f686e7caae3850f4aff30e9a9c0/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/4ca1258da5f15f686e7caae3850f4aff30e9a9c0/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 378,
          "old_api": "str_util::Split(n, \":\")",
          "new_api": "size",
          "old_text": "str_util::Split(n, \":\")",
          "new_text": "_nodes_to_preserve.size()",
          "old_line_content": "    auto tokens = str_util::Split(n, \":\");",
          "new_line_content": "  nodes_to_preserve.reserve(_nodes_to_preserve.size());",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": "size",
          "new_api": "str_util::Split(n, \":\")",
          "old_text": "tokens.size()",
          "new_text": "str_util::Split(n, \":\")",
          "old_line_content": "    for (int i = 1; i < tokens.size() - 1; ++i) {",
          "new_line_content": "    auto tokens = str_util::Split(n, \":\");",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "back",
          "new_api": "size",
          "old_text": "tokens.back()",
          "new_text": "tokens.size()",
          "old_line_content": "      StrAppend(&s, \":\", tokens.back());",
          "new_line_content": "    if (tokens.size() > 1 &&",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": "push_back",
          "new_api": "back",
          "old_text": "nodes_to_preserve.push_back(s)",
          "new_text": "tokens.back()",
          "old_line_content": "    nodes_to_preserve.push_back(s);",
          "new_line_content": "      StrAppend(&s, \":\", tokens.back());",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": "func_attr",
          "new_api": "tensorflow::down_cast<const grappler::GrapplerFunctionItem&>(item)",
          "old_text": "func_item.func_attr()",
          "new_text": "tensorflow::down_cast<const grappler::GrapplerFunctionItem&>(item)",
          "old_line_content": "        UpdateFunctionSpecificConversionParams(cp, func_item.func_attr()));",
          "new_line_content": "        tensorflow::down_cast<const grappler::GrapplerFunctionItem&>(item);",
          "content_same": false
        },
        {
          "line": 415,
          "old_api": "assert",
          "new_api": "func_attr",
          "old_text": "assert(cp.minimum_segment_size > 0)",
          "new_text": "TF_RETURN_IF_ERROR(\n        UpdateFunctionSpecificConversionParams(cp, func_item.func_attr()))",
          "old_line_content": "    assert(cp.minimum_segment_size > 0);",
          "new_line_content": "    TF_RETURN_IF_ERROR(",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 416,
          "old_api": null,
          "new_api": "func_attr",
          "old_text": null,
          "new_text": "func_item.func_attr()",
          "old_line_content": "  }",
          "new_line_content": "        UpdateFunctionSpecificConversionParams(cp, func_item.func_attr()));",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(cp.minimum_segment_size > 0)",
          "old_line_content": "",
          "new_line_content": "    assert(cp.minimum_segment_size > 0);",
          "content_same": false
        },
        {
          "line": 420,
          "old_api": null,
          "new_api": "ConvertAfterShapes",
          "old_text": null,
          "new_text": "ConvertAfterShapes(cp)",
          "old_line_content": "  return status;",
          "new_line_content": "  auto status = ConvertAfterShapes(cp);",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": null,
          "new_api": "back",
          "old_text": null,
          "new_text": "tokens.back()",
          "old_line_content": "    }",
          "new_line_content": "        !strings::safe_strto32(tokens.back(), &dumm_port)) {  // non-absl ok",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": null,
          "new_api": "VLOG",
          "old_text": null,
          "new_text": "VLOG(1)",
          "old_line_content": "}",
          "new_line_content": "  VLOG(1) << \"Returning from \" << name_;",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "nodes_to_preserve.push_back(s)",
          "old_line_content": "",
          "new_line_content": "    nodes_to_preserve.push_back(s);",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": null,
          "new_api": "VLOG",
          "old_text": null,
          "new_text": "VLOG(1)",
          "old_line_content": "  }",
          "new_line_content": "    VLOG(1) << \"Constructing a CustomOptimizationPass registration object for \"",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": null,
          "new_api": "VLOG",
          "old_text": null,
          "new_text": "VLOG(1)",
          "old_line_content": "      return new TRTOptimizationPass(\"TensorRTOptimizer\");",
          "new_line_content": "      VLOG(1)",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "tokens.size()",
          "old_line_content": "    }",
          "new_line_content": "    for (int i = 1; i < tokens.size() - 1; ++i) {",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": null,
          "new_api": "at",
          "old_text": null,
          "new_text": "tokens.at(i)",
          "old_line_content": "    int dumm_port = -1;",
          "new_line_content": "      StrAppend(&s, \":\", tokens.at(i));",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 386,
          "old_api": "size",
          "new_api": null,
          "old_text": "tokens.size()",
          "new_text": null,
          "old_line_content": "    if (tokens.size() > 1 &&",
          "new_line_content": "    // If the last token is not an integer, it must be part of the name.",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": "back",
          "new_api": null,
          "old_text": "tokens.back()",
          "new_text": null,
          "old_line_content": "        !strings::safe_strto32(tokens.back(), &dumm_port)) {  // non-absl ok",
          "new_line_content": "    // Otherwise it is port number.",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": "ConvertAfterShapes",
          "new_api": null,
          "old_text": "ConvertAfterShapes(cp)",
          "new_text": null,
          "old_line_content": "  auto status = ConvertAfterShapes(cp);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": "VLOG",
          "new_api": null,
          "old_text": "VLOG(1)",
          "new_text": null,
          "old_line_content": "  VLOG(1) << \"Returning from \" << name_;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 430,
          "old_api": "VLOG",
          "new_api": null,
          "old_text": "VLOG(1)",
          "new_text": null,
          "old_line_content": "    VLOG(1) << \"Constructing a CustomOptimizationPass registration object for \"",
          "new_line_content": "      const string& name)",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "VLOG",
          "new_api": null,
          "old_text": "VLOG(1)",
          "new_text": null,
          "old_line_content": "      VLOG(1)",
          "new_line_content": "static VerboseCustomGraphOptimizerRegistrar TRTOptimizationPass_Registrar(",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": "at",
          "new_api": null,
          "old_text": "tokens.at(0)",
          "new_text": null,
          "old_line_content": "    string s = tokens.at(0);",
          "new_line_content": "  for (const auto& n : _nodes_to_preserve) {",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": "tensorflow::down_cast<const grappler::GrapplerFunctionItem&>(item)",
          "new_api": null,
          "old_text": "tensorflow::down_cast<const grappler::GrapplerFunctionItem&>(item)",
          "new_text": null,
          "old_line_content": "        tensorflow::down_cast<const grappler::GrapplerFunctionItem&>(item);",
          "new_line_content": "  if (item.id != \"tf_graph\" && do_function_conversion) {",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": "func_attr",
          "new_api": null,
          "old_text": "TF_RETURN_IF_ERROR(\n        UpdateFunctionSpecificConversionParams(cp, func_item.func_attr()))",
          "new_text": null,
          "old_line_content": "    TF_RETURN_IF_ERROR(",
          "new_line_content": "    const grappler::GrapplerFunctionItem& func_item =",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 6,
      "total_additions": 10,
      "total_deletions": 9,
      "total_api_changes": 25
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 25,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          377
        ]
      }
    },
    "api_calls_before": 216,
    "api_calls_after": 218,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 1,
      "total_diff_lines": 16
    }
  }
}