{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/f29af3e2dd35358000cc40f2680f2eb85d2e8370",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/f29af3e2dd35358000cc40f2680f2eb85d2e8370/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/f29af3e2dd35358000cc40f2680f2eb85d2e8370/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/f29af3e2dd35358000cc40f2680f2eb85d2e8370/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 113,
          "old_api": "name",
          "new_api": "TF_RETURN_IF_ERROR",
          "old_text": "feed.first.name()",
          "new_text": "TF_RETURN_IF_ERROR(feed.second.status)",
          "old_line_content": "    feeds.emplace_back(feed.first.name(), feed.second.tensor);",
          "new_line_content": "  TF_RETURN_IF_ERROR(feed.second.status);",
          "content_same": false
        },
        {
          "line": 116,
          "old_api": "size",
          "new_api": "std::forward_as_tuple(feed.second.tensor)",
          "old_text": "fetch_outputs.size()",
          "new_text": "std::forward_as_tuple(feed.second.tensor)",
          "old_line_content": "  output_tensor_names.reserve(fetch_outputs.size());",
          "new_line_content": "                     std::forward_as_tuple(feed.second.tensor));",
          "content_same": false
        },
        {
          "line": 125,
          "old_api": "MaybeExtendGraph",
          "new_api": "size",
          "old_text": "impl()->MaybeExtendGraph()",
          "new_text": "run_outputs.size()",
          "old_line_content": "  TF_RETURN_IF_ERROR(impl()->MaybeExtendGraph());",
          "new_line_content": "  target_node_names.reserve(run_outputs.size());",
          "content_same": false
        },
        {
          "line": 142,
          "old_api": "size",
          "new_api": "TF_RETURN_IF_ERROR",
          "old_text": "fetch_outputs.size()",
          "new_text": "TF_RETURN_IF_ERROR(feed.second.status)",
          "old_line_content": "  output_tensor_names.reserve(fetch_outputs.size());",
          "new_line_content": "    TF_RETURN_IF_ERROR(feed.second.status);",
          "content_same": false
        },
        {
          "line": 151,
          "old_api": "MaybeExtendGraph",
          "new_api": "size",
          "old_text": "impl()->MaybeExtendGraph()",
          "new_text": "run_outputs.size()",
          "old_line_content": "  TF_RETURN_IF_ERROR(impl()->MaybeExtendGraph());",
          "new_line_content": "  target_node_names.reserve(run_outputs.size());",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 129,
          "old_api": null,
          "new_api": "MaybeExtendGraph",
          "old_text": null,
          "new_text": "impl()->MaybeExtendGraph()",
          "old_line_content": "",
          "new_line_content": "  TF_RETURN_IF_ERROR(impl()->MaybeExtendGraph());",
          "content_same": false
        },
        {
          "line": 130,
          "old_api": null,
          "new_api": "Run",
          "old_text": null,
          "new_text": "impl()->session_->Run(run_options, feeds, output_tensor_names,\n                               target_node_names, outputs, run_metadata)",
          "old_line_content": "Status ClientSession::Run(",
          "new_line_content": "  return impl()->session_->Run(run_options, feeds, output_tensor_names,",
          "content_same": false
        },
        {
          "line": 143,
          "old_api": null,
          "new_api": "name",
          "old_text": null,
          "new_text": "feed.first.name()",
          "old_line_content": "  for (auto const& output : fetch_outputs) {",
          "new_line_content": "    feeds.emplace_back(feed.first.name(), feed.second.tensor);",
          "content_same": false
        },
        {
          "line": 146,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "fetch_outputs.size()",
          "old_line_content": "  std::vector<string> target_node_names;",
          "new_line_content": "  output_tensor_names.reserve(fetch_outputs.size());",
          "content_same": false
        },
        {
          "line": 148,
          "old_api": null,
          "new_api": "name",
          "old_text": null,
          "new_text": "output.name()",
          "old_line_content": "  for (auto const& output : run_outputs) {",
          "new_line_content": "    output_tensor_names.push_back(output.name());",
          "content_same": false
        },
        {
          "line": 153,
          "old_api": null,
          "new_api": "node",
          "old_text": null,
          "new_text": "output.node()->name()",
          "old_line_content": "                               target_node_names, outputs, run_metadata,",
          "new_line_content": "    target_node_names.push_back(output.node()->name());",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": null,
          "new_api": "MaybeExtendGraph",
          "old_text": null,
          "new_text": "impl()->MaybeExtendGraph()",
          "old_line_content": "}",
          "new_line_content": "  TF_RETURN_IF_ERROR(impl()->MaybeExtendGraph());",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": null,
          "new_api": "Run",
          "old_text": null,
          "new_text": "impl()->session_->Run(run_options, feeds, output_tensor_names,\n                               target_node_names, outputs, run_metadata,\n                               threadpool_options)",
          "old_line_content": "",
          "new_line_content": "  return impl()->session_->Run(run_options, feeds, output_tensor_names,",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": null,
          "new_api": "MaybeExtendGraph",
          "old_text": null,
          "new_text": "impl()->MaybeExtendGraph()",
          "old_line_content": "Status ClientSession::RunCallable(CallableHandle handle,",
          "new_line_content": "  TF_RETURN_IF_ERROR(impl()->MaybeExtendGraph());",
          "content_same": false
        },
        {
          "line": 164,
          "old_api": null,
          "new_api": "MakeCallable",
          "old_text": null,
          "new_text": "impl()->session_->MakeCallable(callable_options, out_handle)",
          "old_line_content": "                                  const std::vector<Tensor>& feed_tensors,",
          "new_line_content": "  return impl()->session_->MakeCallable(callable_options, out_handle);",
          "content_same": false
        },
        {
          "line": 171,
          "old_api": null,
          "new_api": "RunCallable",
          "old_text": null,
          "new_text": "impl()->session_->RunCallable(handle, feed_tensors, fetch_tensors,\n                                       run_metadata)",
          "old_line_content": "Status ClientSession::RunCallable(CallableHandle handle,",
          "new_line_content": "  return impl()->session_->RunCallable(handle, feed_tensors, fetch_tensors,",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": null,
          "new_api": "RunCallable",
          "old_text": null,
          "new_text": "impl()->session_->RunCallable(handle, feed_tensors, fetch_tensors,\n                                       run_metadata, options)",
          "old_line_content": "Status ClientSession::ReleaseCallable(CallableHandle handle) {",
          "new_line_content": "  return impl()->session_->RunCallable(handle, feed_tensors, fetch_tensors,",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": null,
          "new_api": "ReleaseCallable",
          "old_text": null,
          "new_text": "impl()->session_->ReleaseCallable(handle)",
          "old_line_content": "",
          "new_line_content": "  return impl()->session_->ReleaseCallable(handle);",
          "content_same": false
        },
        {
          "line": 111,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "inputs.size()",
          "old_line_content": "  for (auto const& feed : inputs) {",
          "new_line_content": "feeds.reserve(inputs.size());",
          "content_same": false
        },
        {
          "line": 114,
          "old_api": null,
          "new_api": "emplace_back",
          "old_text": null,
          "new_text": "feeds.emplace_back(std::piecewise_construct,\n                     std::forward_as_tuple(feed.first.name()),\n                     std::forward_as_tuple(feed.second.tensor))",
          "old_line_content": "  }",
          "new_line_content": "  feeds.emplace_back(std::piecewise_construct,",
          "content_same": false
        },
        {
          "line": 115,
          "old_api": null,
          "new_api": "name",
          "old_text": null,
          "new_text": "feed.first.name()",
          "old_line_content": "  std::vector<string> output_tensor_names;",
          "new_line_content": "                     std::forward_as_tuple(feed.first.name()),",
          "content_same": false
        },
        {
          "line": 120,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "fetch_outputs.size()",
          "old_line_content": "  std::vector<string> target_node_names;",
          "new_line_content": "  output_tensor_names.reserve(fetch_outputs.size());",
          "content_same": false
        },
        {
          "line": 122,
          "old_api": null,
          "new_api": "name",
          "old_text": null,
          "new_text": "output.name()",
          "old_line_content": "  for (auto const& output : run_outputs) {",
          "new_line_content": "    output_tensor_names.push_back(output.name());",
          "content_same": false
        },
        {
          "line": 127,
          "old_api": null,
          "new_api": "node",
          "old_text": null,
          "new_text": "output.node()->name()",
          "old_line_content": "                               target_node_names, outputs, run_metadata);",
          "new_line_content": "    target_node_names.push_back(output.node()->name());",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 160,
          "old_api": "MakeCallable",
          "new_api": null,
          "old_text": "impl()->session_->MakeCallable(callable_options, out_handle)",
          "new_text": null,
          "old_line_content": "  return impl()->session_->MakeCallable(callable_options, out_handle);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 167,
          "old_api": "RunCallable",
          "new_api": null,
          "old_text": "impl()->session_->RunCallable(handle, feed_tensors, fetch_tensors,\n                                       run_metadata)",
          "new_text": null,
          "old_line_content": "  return impl()->session_->RunCallable(handle, feed_tensors, fetch_tensors,",
          "new_line_content": "Status ClientSession::RunCallable(CallableHandle handle,",
          "content_same": false
        },
        {
          "line": 138,
          "old_api": "TF_RETURN_IF_ERROR",
          "new_api": null,
          "old_text": "TF_RETURN_IF_ERROR(feed.second.status)",
          "new_text": null,
          "old_line_content": "    TF_RETURN_IF_ERROR(feed.second.status);",
          "new_line_content": "    RunMetadata* run_metadata,",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": "name",
          "new_api": null,
          "old_text": "feed.first.name()",
          "new_text": null,
          "old_line_content": "    feeds.emplace_back(feed.first.name(), feed.second.tensor);",
          "new_line_content": "    const thread::ThreadPoolOptions& threadpool_options) const {",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": "name",
          "new_api": null,
          "old_text": "output.name()",
          "new_text": null,
          "old_line_content": "    output_tensor_names.push_back(output.name());",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": "RunCallable",
          "new_api": null,
          "old_text": "impl()->session_->RunCallable(handle, feed_tensors, fetch_tensors,\n                                       run_metadata, options)",
          "new_text": null,
          "old_line_content": "  return impl()->session_->RunCallable(handle, feed_tensors, fetch_tensors,",
          "new_line_content": "                                  const std::vector<Tensor>& feed_tensors,",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": "TF_RETURN_IF_ERROR",
          "new_api": null,
          "old_text": "TF_RETURN_IF_ERROR(feed.second.status)",
          "new_text": null,
          "old_line_content": "    TF_RETURN_IF_ERROR(feed.second.status);",
          "new_line_content": "for (auto const& feed : inputs) {",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "size",
          "new_api": null,
          "old_text": "run_outputs.size()",
          "new_text": null,
          "old_line_content": "  target_node_names.reserve(run_outputs.size());",
          "new_line_content": "  for (auto const& output : fetch_outputs) {",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": "node",
          "new_api": null,
          "old_text": "output.node()->name()",
          "new_text": null,
          "old_line_content": "    target_node_names.push_back(output.node()->name());",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": "ReleaseCallable",
          "new_api": null,
          "old_text": "impl()->session_->ReleaseCallable(handle)",
          "new_text": null,
          "old_line_content": "  return impl()->session_->ReleaseCallable(handle);",
          "new_line_content": "                                       run_metadata, options);",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": "name",
          "new_api": null,
          "old_text": "output.name()",
          "new_text": null,
          "old_line_content": "    output_tensor_names.push_back(output.name());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": "Run",
          "new_api": null,
          "old_text": "impl()->session_->Run(run_options, feeds, output_tensor_names,\n                               target_node_names, outputs, run_metadata,\n                               threadpool_options)",
          "new_text": null,
          "old_line_content": "  return impl()->session_->Run(run_options, feeds, output_tensor_names,",
          "new_line_content": "  for (auto const& output : run_outputs) {",
          "content_same": false
        },
        {
          "line": 121,
          "old_api": "size",
          "new_api": null,
          "old_text": "run_outputs.size()",
          "new_text": null,
          "old_line_content": "  target_node_names.reserve(run_outputs.size());",
          "new_line_content": "  for (auto const& output : fetch_outputs) {",
          "content_same": false
        },
        {
          "line": 123,
          "old_api": "node",
          "new_api": null,
          "old_text": "output.node()->name()",
          "new_text": null,
          "old_line_content": "    target_node_names.push_back(output.node()->name());",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 126,
          "old_api": "Run",
          "new_api": null,
          "old_text": "impl()->session_->Run(run_options, feeds, output_tensor_names,\n                               target_node_names, outputs, run_metadata)",
          "new_text": null,
          "old_line_content": "  return impl()->session_->Run(run_options, feeds, output_tensor_names,",
          "new_line_content": "  for (auto const& output : run_outputs) {",
          "content_same": false
        },
        {
          "line": 159,
          "old_api": "MaybeExtendGraph",
          "new_api": null,
          "old_text": "impl()->MaybeExtendGraph()",
          "new_text": null,
          "old_line_content": "  TF_RETURN_IF_ERROR(impl()->MaybeExtendGraph());",
          "new_line_content": "}",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 5,
      "total_additions": 19,
      "total_deletions": 16,
      "total_api_changes": 40
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 9,
        "api_related_lines": 40,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          117,
          110
        ]
      }
    },
    "api_calls_before": 63,
    "api_calls_after": 67,
    "diff_info": {
      "added_lines": 9,
      "removed_lines": 5,
      "total_diff_lines": 26
    }
  }
}