{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/39471f9b69f62815ddf6f896d3be6091dfc888a8",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/39471f9b69f62815ddf6f896d3be6091dfc888a8/before.h",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/39471f9b69f62815ddf6f896d3be6091dfc888a8/after.h",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/39471f9b69f62815ddf6f896d3be6091dfc888a8/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 187,
          "old_api": "reinterpret_cast<StorageType*>(output_data)",
          "new_api": "reinterpret_cast<const StorageType*>(input_data)",
          "old_text": "reinterpret_cast<StorageType*>(output_data)",
          "new_text": "reinterpret_cast<const StorageType*>(input_data)",
          "old_line_content": "      reinterpret_cast<StorageType*>(output_data);",
          "new_line_content": "      reinterpret_cast<const StorageType*>(input_data);",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": "DimensionsCount",
          "new_api": "reinterpret_cast<StorageType*>(output_data)",
          "old_text": "input_shape.DimensionsCount()",
          "new_text": "reinterpret_cast<StorageType*>(output_data)",
          "old_line_content": "  const int dims = input_shape.DimensionsCount();",
          "new_line_content": "      reinterpret_cast<StorageType*>(output_data);",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "DimsData",
          "new_api": "DimensionsCount",
          "old_text": "input_shape.DimsData()",
          "new_text": "input_shape.DimensionsCount()",
          "old_line_content": "  SetupTransposeStrides(input_stride, input_shape.DimsData(), dims);",
          "new_line_content": "  const int dims = input_shape.DimensionsCount();",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": "data",
          "new_api": "DimsData",
          "old_text": "TransposeImpl(0, dims, &params.perm[0], input_data_storage,\n                input_stride.data(), output_data_storage, output_stride.data(),\n                output_shape.DimsData())",
          "new_text": "input_shape.DimsData()",
          "old_line_content": "  TransposeImpl(0, dims, &params.perm[0], input_data_storage,",
          "new_line_content": "  SetupTransposeStrides(input_stride, input_shape.DimsData(), dims);",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": "data",
          "new_api": "DimsData",
          "old_text": "output_stride.data()",
          "new_text": "output_shape.DimsData()",
          "old_line_content": "                input_stride.data(), output_data_storage, output_stride.data(),",
          "new_line_content": "  SetupTransposeStrides(output_stride, output_shape.DimsData(), dims);",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": "DimsData",
          "new_api": "data",
          "old_text": "output_shape.DimsData()",
          "new_text": "TransposeImpl(0, dims, &params.perm[0], input_data_storage,\n                input_stride.data(), output_data_storage, output_stride.data(),\n                output_shape.DimsData())",
          "old_line_content": "                output_shape.DimsData());",
          "new_line_content": "  TransposeImpl(0, dims, &params.perm[0], input_data_storage,",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 109,
          "old_api": null,
          "new_api": "TransposeImpl",
          "old_text": null,
          "new_text": "TransposeImpl(depth + 1, dims, perm, input_data, input_stride,\n                    output_data, output_stride, output_shape)",
          "old_line_content": "",
          "new_line_content": "      TransposeImpl(depth + 1, dims, perm, input_data, input_stride,",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": null,
          "new_api": "data",
          "old_text": null,
          "new_text": "output_stride.data()",
          "old_line_content": "}",
          "new_line_content": "                input_stride.data(), output_data_storage, output_stride.data(),",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": null,
          "new_api": "DimsData",
          "old_text": null,
          "new_text": "output_shape.DimsData()",
          "old_line_content": "",
          "new_line_content": "                output_shape.DimsData());",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 192,
          "old_api": "DimsData",
          "new_api": null,
          "old_text": "output_shape.DimsData()",
          "new_text": null,
          "old_line_content": "  SetupTransposeStrides(output_stride, output_shape.DimsData(), dims);",
          "new_line_content": "  std::array<int, kTransposeMaxDimensions> input_stride, output_stride;",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": "reinterpret_cast<const StorageType*>(input_data)",
          "new_api": null,
          "old_text": "reinterpret_cast<const StorageType*>(input_data)",
          "new_text": null,
          "old_line_content": "      reinterpret_cast<const StorageType*>(input_data);",
          "new_line_content": "  using StorageType = typename TransposeStorageType<sizeof(T)>::type;",
          "content_same": false
        },
        {
          "line": 107,
          "old_api": "TransposeImpl",
          "new_api": null,
          "old_text": "TransposeImpl(depth + 1, dims, perm, input_data, input_stride,\n                    output_data, output_stride, output_shape)",
          "new_text": null,
          "old_line_content": "      TransposeImpl(depth + 1, dims, perm, input_data, input_stride,",
          "new_line_content": "  } else {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 6,
      "total_additions": 3,
      "total_deletions": 3,
      "total_api_changes": 12
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 12,
        "non_api_lines": 7,
        "non_api_line_numbers": [
          100,
          101,
          102,
          103,
          105,
          106,
          108
        ]
      }
    },
    "api_calls_before": 12,
    "api_calls_after": 12,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 3,
      "total_diff_lines": 24
    }
  }
}