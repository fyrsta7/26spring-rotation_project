{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/a6a42a33f85b10a18d5a5ca7fe8a24ea26bb143e",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/a6a42a33f85b10a18d5a5ca7fe8a24ea26bb143e/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/a6a42a33f85b10a18d5a5ca7fe8a24ea26bb143e/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/a6a42a33f85b10a18d5a5ca7fe8a24ea26bb143e/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 142,
          "old_api": "data",
          "new_api": "GetTensorData<int32_t>(op_context.input)",
          "old_text": "xnn_run_transpose_nd_x32(\n            GetTensorData<int32_t>(op_context.input),\n            GetTensorData<int32_t>(op_context.output), size,\n            xnn_input_shape.data(), xnn_perm.data(), /*flags=*/0, threadpool)",
          "new_text": "GetTensorData<int32_t>(op_context.input)",
          "old_line_content": "        status = xnn_run_transpose_nd_x32(",
          "new_line_content": "            GetTensorData<int32_t>(op_context.input),",
          "content_same": false
        },
        {
          "line": 143,
          "old_api": "GetTensorData<int32_t>(op_context.input)",
          "new_api": "GetTensorData<int32_t>(op_context.output)",
          "old_text": "GetTensorData<int32_t>(op_context.input)",
          "new_text": "GetTensorData<int32_t>(op_context.output)",
          "old_line_content": "            GetTensorData<int32_t>(op_context.input),",
          "new_line_content": "            GetTensorData<int32_t>(op_context.output), size,",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": "GetTensorData<int32_t>(op_context.output)",
          "new_api": "data",
          "old_text": "GetTensorData<int32_t>(op_context.output)",
          "new_text": "xnn_perm.data()",
          "old_line_content": "            GetTensorData<int32_t>(op_context.output), size,",
          "new_line_content": "            xnn_input_shape.data(), xnn_perm.data(),",
          "content_same": false
        },
        {
          "line": 184,
          "old_api": "GetTensorData<int16_t>(op_context.input)",
          "new_api": "data",
          "old_text": "GetTensorData<int16_t>(op_context.input)",
          "new_text": "xnn_run_transpose_nd_x16(\n            GetTensorData<int16_t>(op_context.input),\n            GetTensorData<int16_t>(op_context.output), size,\n            xnn_input_shape.data(), xnn_perm.data(),\n            /*flags=*/XNN_FLAG_YIELD_WORKERS, threadpool)",
          "old_line_content": "            GetTensorData<int16_t>(op_context.input),",
          "new_line_content": "        status = xnn_run_transpose_nd_x16(",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": "GetTensorData<int16_t>(op_context.output)",
          "new_api": "GetTensorData<int16_t>(op_context.input)",
          "old_text": "GetTensorData<int16_t>(op_context.output)",
          "new_text": "GetTensorData<int16_t>(op_context.input)",
          "old_line_content": "            GetTensorData<int16_t>(op_context.output), size,",
          "new_line_content": "            GetTensorData<int16_t>(op_context.input),",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": "data",
          "new_api": "GetTensorData<int16_t>(op_context.output)",
          "old_text": "xnn_perm.data()",
          "new_text": "GetTensorData<int16_t>(op_context.output)",
          "old_line_content": "            xnn_input_shape.data(), xnn_perm.data(), /*flags=*/0, threadpool);",
          "new_line_content": "            GetTensorData<int16_t>(op_context.output), size,",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": "TfLiteTypeGetName",
          "new_api": "TF_LITE_KERNEL_LOG",
          "old_text": "TfLiteTypeGetName(op_context.input->type)",
          "new_text": "TF_LITE_KERNEL_LOG(context,\n                         \"Type %s is currently not supported by Transpose.\",\n                         TfLiteTypeGetName(op_context.input->type))",
          "old_line_content": "                         TfLiteTypeGetName(op_context.input->type));",
          "new_line_content": "      TF_LITE_KERNEL_LOG(context,",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 228,
          "old_api": null,
          "new_api": "Register_TRANSPOSE_GENERIC_OPTIMIZED",
          "old_text": null,
          "new_text": "Register_TRANSPOSE_GENERIC_OPTIMIZED()",
          "old_line_content": "",
          "new_line_content": "  return Register_TRANSPOSE_GENERIC_OPTIMIZED();",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": null,
          "new_api": "TF_LITE_TRANSPOSE",
          "old_text": null,
          "new_text": "TF_LITE_TRANSPOSE(reference_ops, int64_t)",
          "old_line_content": "    default:",
          "new_line_content": "      TF_LITE_TRANSPOSE(reference_ops, int64_t);",
          "content_same": false
        },
        {
          "line": 172,
          "old_api": null,
          "new_api": "TF_LITE_KERNEL_LOG",
          "old_text": null,
          "new_text": "TF_LITE_KERNEL_LOG(context, \"Failed to run xnnpack transpose\")",
          "old_line_content": "        }",
          "new_line_content": "          TF_LITE_KERNEL_LOG(context, \"Failed to run xnnpack transpose\");",
          "content_same": false
        },
        {
          "line": 141,
          "old_api": null,
          "new_api": "data",
          "old_text": null,
          "new_text": "xnn_run_transpose_nd_x32(\n            GetTensorData<int32_t>(op_context.input),\n            GetTensorData<int32_t>(op_context.output), size,\n            xnn_input_shape.data(), xnn_perm.data(),\n            /*flags=*/XNN_FLAG_YIELD_WORKERS, threadpool)",
          "old_line_content": "#ifdef TFLITE_KERNEL_USE_XNNPACK",
          "new_line_content": "        status = xnn_run_transpose_nd_x32(",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": null,
          "new_api": "TfLiteTypeGetName",
          "old_text": null,
          "new_text": "TfLiteTypeGetName(op_context.input->type)",
          "old_line_content": "  }",
          "new_line_content": "                         TfLiteTypeGetName(op_context.input->type));",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": null,
          "new_api": "data",
          "old_text": null,
          "new_text": "xnn_perm.data()",
          "old_line_content": "        if (status != xnn_status_success) {",
          "new_line_content": "            xnn_input_shape.data(), xnn_perm.data(),",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": null,
          "new_api": "TF_LITE_KERNEL_LOG",
          "old_text": null,
          "new_text": "TF_LITE_KERNEL_LOG(context, \"Failed to run xnnpack transpose\")",
          "old_line_content": "#else   // TFLITE_KERNEL_USE_XNNPACK",
          "new_line_content": "          TF_LITE_KERNEL_LOG(context, \"Failed to run xnnpack transpose\");",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 226,
          "old_api": "Register_TRANSPOSE_GENERIC_OPTIMIZED",
          "new_api": null,
          "old_text": "Register_TRANSPOSE_GENERIC_OPTIMIZED()",
          "new_text": null,
          "old_line_content": "  return Register_TRANSPOSE_GENERIC_OPTIMIZED();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": "TF_LITE_TRANSPOSE",
          "new_api": null,
          "old_text": "TF_LITE_TRANSPOSE(reference_ops, int64_t)",
          "new_text": null,
          "old_line_content": "      TF_LITE_TRANSPOSE(reference_ops, int64_t);",
          "new_line_content": "      break;",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "TF_LITE_KERNEL_LOG",
          "new_api": null,
          "old_text": "TF_LITE_KERNEL_LOG(context,\n                         \"Type %s is currently not supported by Transpose.\",\n                         TfLiteTypeGetName(op_context.input->type))",
          "new_text": null,
          "old_line_content": "      TF_LITE_KERNEL_LOG(context,",
          "new_line_content": "      break;",
          "content_same": false
        },
        {
          "line": 171,
          "old_api": "TF_LITE_KERNEL_LOG",
          "new_api": null,
          "old_text": "TF_LITE_KERNEL_LOG(context, \"Failed to run xnnpack transpose\")",
          "new_text": null,
          "old_line_content": "          TF_LITE_KERNEL_LOG(context, \"Failed to run xnnpack transpose\");",
          "new_line_content": "        if (status != xnn_status_success) {",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": "data",
          "new_api": null,
          "old_text": "xnn_perm.data()",
          "new_text": null,
          "old_line_content": "            xnn_input_shape.data(), xnn_perm.data(), /*flags=*/0, threadpool);",
          "new_line_content": "            /*flags=*/XNN_FLAG_YIELD_WORKERS, threadpool);",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": "data",
          "new_api": null,
          "old_text": "xnn_run_transpose_nd_x16(\n            GetTensorData<int16_t>(op_context.input),\n            GetTensorData<int16_t>(op_context.output), size,\n            xnn_input_shape.data(), xnn_perm.data(), /*flags=*/0, threadpool)",
          "new_text": null,
          "old_line_content": "        status = xnn_run_transpose_nd_x16(",
          "new_line_content": "#ifdef TFLITE_KERNEL_USE_XNNPACK",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "TF_LITE_KERNEL_LOG",
          "new_api": null,
          "old_text": "TF_LITE_KERNEL_LOG(context, \"Failed to run xnnpack transpose\")",
          "new_text": null,
          "old_line_content": "          TF_LITE_KERNEL_LOG(context, \"Failed to run xnnpack transpose\");",
          "new_line_content": "            /*flags=*/XNN_FLAG_YIELD_WORKERS, threadpool);",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 7,
      "total_additions": 7,
      "total_deletions": 7,
      "total_api_changes": 21
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 8,
        "api_related_lines": 21,
        "non_api_lines": 3,
        "non_api_line_numbers": [
          169,
          170,
          113
        ]
      }
    },
    "api_calls_before": 49,
    "api_calls_after": 49,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 4,
      "total_diff_lines": 43
    }
  }
}