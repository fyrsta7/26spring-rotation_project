{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/174de936c1d8d0c78ed9fed1d8ffcf3a15d12c38",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/174de936c1d8d0c78ed9fed1d8ffcf3a15d12c38/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/174de936c1d8d0c78ed9fed1d8ffcf3a15d12c38/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/174de936c1d8d0c78ed9fed1d8ffcf3a15d12c38/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 105,
          "old_api": "resize",
          "new_api": "size",
          "old_text": "desc.data.resize(desc.size)",
          "new_text": "gpu_data.size()",
          "old_line_content": "  desc.data.resize(desc.size);",
          "new_line_content": "  desc.size = float_size * gpu_data.size();",
          "content_same": false
        },
        {
          "line": 111,
          "old_api": "size",
          "new_api": "data",
          "old_text": "gpu_data.size()",
          "new_text": "desc.data.data()",
          "old_line_content": "    for (int i = 0; i < gpu_data.size(); ++i) {",
          "new_line_content": "    half* gpu_data_half = reinterpret_cast<half*>(desc.data.data());",
          "content_same": false
        },
        {
          "line": 116,
          "old_api": "std::move(desc)",
          "new_api": "AddObject",
          "old_text": "std::move(desc)",
          "new_text": "op->args_.AddObject(\"constants\",\n                      absl::make_unique<BufferDescriptor>(std::move(desc)))",
          "old_line_content": "                      absl::make_unique<BufferDescriptor>(std::move(desc)));",
          "new_line_content": "  op->args_.AddObject(\"constants\",",
          "content_same": false
        },
        {
          "line": 125,
          "old_api": "AddSrcTensor",
          "new_api": "SetAddressMode",
          "old_text": "result->AddSrcTensor(\"src_tensor\", src_desc)",
          "new_text": "src_desc.SetAddressMode(AddressMode::kZero)",
          "old_line_content": "  result->AddSrcTensor(\"src_tensor\", src_desc);",
          "new_line_content": "  src_desc.SetAddressMode(AddressMode::kZero);",
          "content_same": false
        },
        {
          "line": 126,
          "old_api": "AddDstTensor",
          "new_api": "AddSrcTensor",
          "old_text": "result->AddDstTensor(\"dst_tensor\", op_def.dst_tensors[0])",
          "new_text": "result->AddSrcTensor(\"src_tensor\", src_desc)",
          "old_line_content": "  result->AddDstTensor(\"dst_tensor\", op_def.dst_tensors[0]);",
          "new_line_content": "  result->AddSrcTensor(\"src_tensor\", src_desc);",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": "std::to_string(weights_counter++)",
          "new_api": "std::to_string(d)",
          "old_text": "std::to_string(weights_counter++)",
          "new_text": "std::to_string(d)",
          "old_line_content": "         std::to_string(weights_counter++) + \");\\n\";",
          "new_line_content": "    c += \"  FLT4 dw_res_\" + std::to_string(d) + \" = args.constants.Read(\" +",
          "content_same": false
        },
        {
          "line": 168,
          "old_api": "SupportsZeroClamp",
          "new_api": "HasAxis",
          "old_text": "src_desc.SupportsZeroClamp(axis, gpu_info)",
          "new_text": "src_desc.HasAxis(axis)",
          "old_line_content": "          !src_desc.SupportsZeroClamp(axis, gpu_info)) {",
          "new_line_content": "      if (src_desc.HasAxis(axis) &&",
          "content_same": false
        },
        {
          "line": 169,
          "old_api": "empty",
          "new_api": "SupportsZeroClamp",
          "old_text": "check.empty()",
          "new_text": "src_desc.SupportsZeroClamp(axis, gpu_info)",
          "old_line_content": "        if (!check.empty()) {",
          "new_line_content": "          !src_desc.SupportsZeroClamp(axis, gpu_info)) {",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": "SupportsZeroClamp",
          "new_api": "generate_check",
          "old_text": "src_desc.SupportsZeroClamp(Axis::HEIGHT, gpu_info)",
          "new_text": "generate_check()",
          "old_line_content": "  if (!src_desc.SupportsZeroClamp(Axis::HEIGHT, gpu_info)) {",
          "new_line_content": "  const std::string check = generate_check();",
          "content_same": false
        },
        {
          "line": 227,
          "old_api": "std::to_string(weights_counter++)",
          "new_api": "std::to_string(d)",
          "old_text": "std::to_string(weights_counter++)",
          "new_text": "std::to_string(d)",
          "old_line_content": "         std::to_string(weights_counter++) + \");\\n\";",
          "new_line_content": "    c += \"  FLT4 conv_res_\" + std::to_string(d) + \" = args.constants.Read(\" +",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "std::to_string(d)",
          "new_api": "std::to_string(s)",
          "old_text": "std::to_string(d)",
          "new_text": "std::to_string(s)",
          "old_line_content": "      std::string dst = \"conv_res_\" + std::to_string(d);",
          "new_line_content": "      std::string src = \"dw_res_\" + std::to_string(s);",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": "IsValhall",
          "new_api": "IsMali",
          "old_text": "gpu_info.mali_info.IsValhall()",
          "new_text": "gpu_info.IsMali()",
          "old_line_content": "    if (!gpu_info.mali_info.IsValhall()) {",
          "new_line_content": "  } else if (gpu_info.IsMali()) {",
          "content_same": false
        },
        {
          "line": 321,
          "old_api": "DivideRoundUp",
          "new_api": "GenerateCode",
          "old_text": "DivideRoundUp(conv_attr.weights.shape.o, 4)",
          "new_text": "GenerateCode(definition, gpu_info, dw_attr, relu_attr_ptr,\n                   DivideRoundUp(conv_attr.weights.shape.o, 4), &result)",
          "old_line_content": "                   DivideRoundUp(conv_attr.weights.shape.o, 4), &result);",
          "new_line_content": "      GenerateCode(definition, gpu_info, dw_attr, relu_attr_ptr,",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 134,
          "old_api": null,
          "new_api": "AddInt",
          "old_text": null,
          "new_text": "result->args_.AddInt(\"dilation_y\", dw_attr.dilations.h)",
          "old_line_content": "",
          "new_line_content": "  result->args_.AddInt(\"dilation_y\", dw_attr.dilations.h);",
          "content_same": false
        },
        {
          "line": 138,
          "old_api": null,
          "new_api": "HasAxis",
          "old_text": null,
          "new_text": "op_def.dst_tensors[0].HasAxis(Axis::BATCH)",
          "old_line_content": "    c += \"  int linear_id = GLOBAL_ID_0;\\n\";",
          "new_line_content": "  if (op_def.dst_tensors[0].HasAxis(Axis::BATCH)) {",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": null,
          "new_api": "IsApple",
          "old_text": null,
          "new_text": "gpu_info.IsApple()",
          "old_line_content": "    if (definition.precision == CalculationsPrecision::F16) {",
          "new_line_content": "  if (gpu_info.IsApple()) {",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": null,
          "new_api": "DivideRoundUp",
          "old_text": null,
          "new_text": "DivideRoundUp(dw_attr.weights.shape.i, 4)",
          "old_line_content": "  int weights_counter = 0;",
          "new_line_content": "  int intermediate_depth = DivideRoundUp(dw_attr.weights.shape.i, 4);",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": null,
          "new_api": "IsValhall",
          "old_text": null,
          "new_text": "gpu_info.mali_info.IsValhall()",
          "old_line_content": "      return false;",
          "new_line_content": "    if (!gpu_info.mali_info.IsValhall()) {",
          "content_same": false
        },
        {
          "line": 284,
          "old_api": null,
          "new_api": "IsValhallGen1",
          "old_text": null,
          "new_text": "gpu_info.mali_info.IsValhallGen1()",
          "old_line_content": "      return false;",
          "new_line_content": "    if (gpu_info.mali_info.IsValhallGen1()) {",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": null,
          "new_api": "std::to_string(weights_counter++)",
          "old_text": null,
          "new_text": "std::to_string(weights_counter++)",
          "old_line_content": "  }",
          "new_line_content": "         std::to_string(weights_counter++) + \");\\n\";",
          "content_same": false
        },
        {
          "line": 289,
          "old_api": null,
          "new_api": "SupportsZeroClamp",
          "old_text": null,
          "new_text": "definition.src_tensors[0].SupportsZeroClamp(Axis::HEIGHT, gpu_info)",
          "old_line_content": "      bool recommended_dw = dw_shape.i <= 16 &&",
          "new_line_content": "        definition.src_tensors[0].SupportsZeroClamp(Axis::HEIGHT, gpu_info)) {",
          "content_same": false
        },
        {
          "line": 166,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "axes.size()",
          "old_line_content": "      const auto& axis = axes[i];",
          "new_line_content": "    for (int i = 0; i < axes.size(); ++i) {",
          "content_same": false
        },
        {
          "line": 170,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "check.empty()",
          "old_line_content": "          check += \" && \";",
          "new_line_content": "        if (!check.empty()) {",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": null,
          "new_api": "SupportsZeroClamp",
          "old_text": null,
          "new_text": "src_desc.SupportsZeroClamp(Axis::HEIGHT, gpu_info)",
          "old_line_content": "    c += \"  bool y_in;\\n\";",
          "new_line_content": "  if (!src_desc.SupportsZeroClamp(Axis::HEIGHT, gpu_info)) {",
          "content_same": false
        },
        {
          "line": 182,
          "old_api": null,
          "new_api": "SupportsZeroClamp",
          "old_text": null,
          "new_text": "src_desc.SupportsZeroClamp(Axis::WIDTH, gpu_info)",
          "old_line_content": "    c += \"  bool x_in;\\n\";",
          "new_line_content": "  if (!src_desc.SupportsZeroClamp(Axis::WIDTH, gpu_info)) {",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": null,
          "new_api": "std::min(4, dw_attr.weights.shape.i - d * 4)",
          "old_text": null,
          "new_text": "std::min(4, dw_attr.weights.shape.i - d * 4)",
          "old_line_content": "    const std::string s_postfix = postfixes[src_ch_count - 1];",
          "new_line_content": "    const int src_ch_count = std::min(4, dw_attr.weights.shape.i - d * 4);",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": null,
          "new_api": "std::to_string(ky)",
          "old_text": null,
          "new_text": "std::to_string(ky)",
          "old_line_content": "           \" * args.dilation_y;\\n\";",
          "new_line_content": "      c += \"  y_c = y_offseted + \" + std::to_string(ky) +",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": null,
          "new_api": "SupportsZeroClamp",
          "old_text": null,
          "new_text": "src_desc.SupportsZeroClamp(Axis::HEIGHT, gpu_info)",
          "old_line_content": "        c += \"  y_in = y_c >= 0 && y_c < args.src_tensor.Height();\\n\";",
          "new_line_content": "      if (!src_desc.SupportsZeroClamp(Axis::HEIGHT, gpu_info)) {",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": null,
          "new_api": "DivideRoundUp",
          "old_text": null,
          "new_text": "DivideRoundUp(conv_attr.weights.shape.o, 4)",
          "old_line_content": "  result.tensor_to_grid_ = TensorToGrid::kWBToX_HDToY_ZIs1;",
          "new_line_content": "                   DivideRoundUp(conv_attr.weights.shape.o, 4), &result);",
          "content_same": false
        },
        {
          "line": 324,
          "old_api": null,
          "new_api": "UploadWeights",
          "old_text": null,
          "new_text": "UploadWeights(dw_attr, conv_attr, gpu_info, definition.precision, &result)",
          "old_line_content": "  return result;",
          "new_line_content": "  UploadWeights(dw_attr, conv_attr, gpu_info, definition.precision, &result);",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": null,
          "new_api": "std::to_string(kx)",
          "old_text": null,
          "new_text": "std::to_string(kx)",
          "old_line_content": "             \" * args.dilation_x;\\n\";",
          "new_line_content": "        c += \"  x_c = x_offseted + \" + std::to_string(kx) +",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": null,
          "new_api": "SupportsZeroClamp",
          "old_text": null,
          "new_text": "src_desc.SupportsZeroClamp(Axis::WIDTH, gpu_info)",
          "old_line_content": "          c += \"  x_in = x_c >= 0 && x_c < args.src_tensor.Width();\\n\";",
          "new_line_content": "        if (!src_desc.SupportsZeroClamp(Axis::WIDTH, gpu_info)) {",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "check.empty()",
          "old_line_content": "        c += \"  src\" + s_postfix + \" = args.src_tensor.Read(x_c, y_c, \" +",
          "new_line_content": "            check.empty() ? \"\" : \" * INIT_FLT(\" + check + \")\";",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": null,
          "new_api": "std::to_string(d)",
          "old_text": null,
          "new_text": "std::to_string(d)",
          "old_line_content": "             s_postfix + \" * args.constants.Read(\" +",
          "new_line_content": "        c += \"  dw_res_\" + std::to_string(d) + s_postfix + \" += src\" +",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": null,
          "new_api": "std::to_string(weights_counter++)",
          "old_text": null,
          "new_text": "std::to_string(weights_counter++)",
          "old_line_content": "      }",
          "new_line_content": "             std::to_string(weights_counter++) + \")\" + s_postfix + \";\\n\";",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": null,
          "new_api": "CreateReLU",
          "old_text": null,
          "new_text": "CreateReLU(*relu_attr_ptr, op_def.precision, &result->args_,\n               &elementwise_code)",
          "old_line_content": "               &elementwise_code);",
          "new_line_content": "    CreateReLU(*relu_attr_ptr, op_def.precision, &result->args_,",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": null,
          "new_api": "std::to_string(d)",
          "old_text": null,
          "new_text": "std::to_string(d)",
          "old_line_content": "      const std::string elementwise_new_code =",
          "new_line_content": "      const std::string var_name = \"dw_res_\" + std::to_string(d);",
          "content_same": false
        },
        {
          "line": 222,
          "old_api": null,
          "new_api": "absl::StrReplaceAll(elementwise_code, {{\"in_out_value\", var_name}})",
          "old_text": null,
          "new_text": "absl::StrReplaceAll(elementwise_code, {{\"in_out_value\", var_name}})",
          "old_line_content": "      c += \"  {  \" + elementwise_new_code + \"  }\\n\";",
          "new_line_content": "          absl::StrReplaceAll(elementwise_code, {{\"in_out_value\", var_name}});",
          "content_same": false
        },
        {
          "line": 228,
          "old_api": null,
          "new_api": "std::to_string(weights_counter++)",
          "old_text": null,
          "new_text": "std::to_string(weights_counter++)",
          "old_line_content": "  }",
          "new_line_content": "         std::to_string(weights_counter++) + \");\\n\";",
          "content_same": false
        },
        {
          "line": 102,
          "old_api": null,
          "new_api": "IsAMD",
          "old_text": null,
          "new_text": "gpu_info.IsAMD()",
          "old_line_content": "  desc.memory_type =",
          "new_line_content": "  desc.memory_type = gpu_info.IsMali() || gpu_info.IsAMD()",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": null,
          "new_api": "std::to_string(d)",
          "old_text": null,
          "new_text": "std::to_string(d)",
          "old_line_content": "      c += \"  \" + dst + \" += \" + src + \".x * args.constants.Read(\" +",
          "new_line_content": "      std::string dst = \"conv_res_\" + std::to_string(d);",
          "content_same": false
        },
        {
          "line": 106,
          "old_api": null,
          "new_api": "resize",
          "old_text": null,
          "new_text": "desc.data.resize(desc.size)",
          "old_line_content": "",
          "new_line_content": "  desc.data.resize(desc.size);",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": null,
          "new_api": "std::to_string(weights_counter++)",
          "old_text": null,
          "new_text": "std::to_string(weights_counter++)",
          "old_line_content": "      c += \"  \" + dst + \" += \" + src + \".y * args.constants.Read(\" +",
          "new_line_content": "           std::to_string(weights_counter++) + \");\\n\";",
          "content_same": false
        },
        {
          "line": 109,
          "old_api": null,
          "new_api": "data",
          "old_text": null,
          "new_text": "gpu_data.data()",
          "old_line_content": "  } else {",
          "new_line_content": "    memcpy(desc.data.data(), gpu_data.data(), desc.size);",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": null,
          "new_api": "std::to_string(weights_counter++)",
          "old_text": null,
          "new_text": "std::to_string(weights_counter++)",
          "old_line_content": "      c += \"  \" + dst + \" += \" + src + \".z * args.constants.Read(\" +",
          "new_line_content": "           std::to_string(weights_counter++) + \");\\n\";",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": null,
          "new_api": "std::to_string(weights_counter++)",
          "old_text": null,
          "new_text": "std::to_string(weights_counter++)",
          "old_line_content": "      c += \"  \" + dst + \" += \" + src + \".w * args.constants.Read(\" +",
          "new_line_content": "           std::to_string(weights_counter++) + \");\\n\";",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "gpu_data.size()",
          "old_line_content": "      gpu_data_half[i] = gpu_data[i];",
          "new_line_content": "    for (int i = 0; i < gpu_data.size(); ++i) {",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": null,
          "new_api": "std::to_string(weights_counter++)",
          "old_text": null,
          "new_text": "std::to_string(weights_counter++)",
          "old_line_content": "    }",
          "new_line_content": "           std::to_string(weights_counter++) + \");\\n\";",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": null,
          "new_api": "std::to_string(d)",
          "old_text": null,
          "new_text": "std::to_string(d)",
          "old_line_content": "  }",
          "new_line_content": "         std::to_string(d) + \");\\n\";",
          "content_same": false
        },
        {
          "line": 117,
          "old_api": null,
          "new_api": "std::move(desc)",
          "old_text": null,
          "new_text": "std::move(desc)",
          "old_line_content": "}",
          "new_line_content": "                      absl::make_unique<BufferDescriptor>(std::move(desc)));",
          "content_same": false
        },
        {
          "line": 127,
          "old_api": null,
          "new_api": "AddDstTensor",
          "old_text": null,
          "new_text": "result->AddDstTensor(\"dst_tensor\", op_def.dst_tensors[0])",
          "old_line_content": "",
          "new_line_content": "  result->AddDstTensor(\"dst_tensor\", op_def.dst_tensors[0]);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 128,
          "old_api": "AddInt",
          "new_api": null,
          "old_text": "result->args_.AddInt(\"stride_x\", dw_attr.strides.w)",
          "new_text": null,
          "old_line_content": "  result->args_.AddInt(\"stride_x\", dw_attr.strides.w);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 137,
          "old_api": "HasAxis",
          "new_api": null,
          "old_text": "op_def.dst_tensors[0].HasAxis(Axis::BATCH)",
          "new_text": null,
          "old_line_content": "  if (op_def.dst_tensors[0].HasAxis(Axis::BATCH)) {",
          "new_line_content": "  c += \"MAIN_FUNCTION($0) {\\n\";",
          "content_same": false
        },
        {
          "line": 265,
          "old_api": "IsApple",
          "new_api": null,
          "old_text": "gpu_info.IsApple()",
          "new_text": null,
          "old_line_content": "  if (gpu_info.IsApple()) {",
          "new_line_content": "      conv_attr.padding.appended.h == 0;",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": "IsMali",
          "new_api": null,
          "old_text": "gpu_info.IsMali()",
          "new_text": null,
          "old_line_content": "  } else if (gpu_info.IsMali()) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 151,
          "old_api": "DivideRoundUp",
          "new_api": null,
          "old_text": "DivideRoundUp(dw_attr.weights.shape.i, 4)",
          "new_text": null,
          "old_line_content": "  int intermediate_depth = DivideRoundUp(dw_attr.weights.shape.i, 4);",
          "new_line_content": "  c += \"  } \\n\";",
          "content_same": false
        },
        {
          "line": 154,
          "old_api": "std::to_string(d)",
          "new_api": null,
          "old_text": "std::to_string(d)",
          "new_text": null,
          "old_line_content": "    c += \"  FLT4 dw_res_\" + std::to_string(d) + \" = args.constants.Read(\" +",
          "new_line_content": "  for (int d = 0; d < intermediate_depth; ++d) {",
          "content_same": false
        },
        {
          "line": 283,
          "old_api": "IsValhallGen1",
          "new_api": null,
          "old_text": "gpu_info.mali_info.IsValhallGen1()",
          "new_text": null,
          "old_line_content": "    if (gpu_info.mali_info.IsValhallGen1()) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": "SupportsZeroClamp",
          "new_api": null,
          "old_text": "definition.src_tensors[0].SupportsZeroClamp(Axis::WIDTH, gpu_info)",
          "new_text": null,
          "old_line_content": "        definition.src_tensors[0].SupportsZeroClamp(Axis::WIDTH, gpu_info) &&",
          "new_line_content": "    if (definition.precision == CalculationsPrecision::F16 &&",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": "size",
          "new_api": null,
          "old_text": "axes.size()",
          "new_text": null,
          "old_line_content": "    for (int i = 0; i < axes.size(); ++i) {",
          "new_line_content": "    const std::vector<std::string> names{\"x_in\", \"y_in\", \"z_in\"};",
          "content_same": false
        },
        {
          "line": 167,
          "old_api": "HasAxis",
          "new_api": null,
          "old_text": "src_desc.HasAxis(axis)",
          "new_text": null,
          "old_line_content": "      if (src_desc.HasAxis(axis) &&",
          "new_line_content": "      const auto& axis = axes[i];",
          "content_same": false
        },
        {
          "line": 177,
          "old_api": "generate_check",
          "new_api": null,
          "old_text": "generate_check()",
          "new_text": null,
          "old_line_content": "  const std::string check = generate_check();",
          "new_line_content": "  };",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": "SupportsZeroClamp",
          "new_api": null,
          "old_text": "src_desc.SupportsZeroClamp(Axis::WIDTH, gpu_info)",
          "new_text": null,
          "old_line_content": "  if (!src_desc.SupportsZeroClamp(Axis::WIDTH, gpu_info)) {",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "std::min(4, dw_attr.weights.shape.i - d * 4)",
          "new_api": null,
          "old_text": "std::min(4, dw_attr.weights.shape.i - d * 4)",
          "new_text": null,
          "old_line_content": "    const int src_ch_count = std::min(4, dw_attr.weights.shape.i - d * 4);",
          "new_line_content": "  for (int d = 0; d < intermediate_depth; ++d) {",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "std::to_string(ky)",
          "new_api": null,
          "old_text": "std::to_string(ky)",
          "new_text": null,
          "old_line_content": "      c += \"  y_c = y_offseted + \" + std::to_string(ky) +",
          "new_line_content": "    for (int ky = 0; ky < dw_attr.weights.shape.h; ++ky) {",
          "content_same": false
        },
        {
          "line": 320,
          "old_api": "GenerateCode",
          "new_api": null,
          "old_text": "GenerateCode(definition, gpu_info, dw_attr, relu_attr_ptr,\n                   DivideRoundUp(conv_attr.weights.shape.o, 4), &result)",
          "new_text": null,
          "old_line_content": "      GenerateCode(definition, gpu_info, dw_attr, relu_attr_ptr,",
          "new_line_content": "  result.code_ =",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": "SupportsZeroClamp",
          "new_api": null,
          "old_text": "src_desc.SupportsZeroClamp(Axis::HEIGHT, gpu_info)",
          "new_text": null,
          "old_line_content": "      if (!src_desc.SupportsZeroClamp(Axis::HEIGHT, gpu_info)) {",
          "new_line_content": "           \" * args.dilation_y;\\n\";",
          "content_same": false
        },
        {
          "line": 323,
          "old_api": "UploadWeights",
          "new_api": null,
          "old_text": "UploadWeights(dw_attr, conv_attr, gpu_info, definition.precision, &result)",
          "new_text": null,
          "old_line_content": "  UploadWeights(dw_attr, conv_attr, gpu_info, definition.precision, &result);",
          "new_line_content": "  result.tensor_to_grid_ = TensorToGrid::kWBToX_HDToY_ZIs1;",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": "std::to_string(kx)",
          "new_api": null,
          "old_text": "std::to_string(kx)",
          "new_text": null,
          "old_line_content": "        c += \"  x_c = x_offseted + \" + std::to_string(kx) +",
          "new_line_content": "      for (int kx = 0; kx < dw_attr.weights.shape.w; ++kx) {",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": "SupportsZeroClamp",
          "new_api": null,
          "old_text": "src_desc.SupportsZeroClamp(Axis::WIDTH, gpu_info)",
          "new_text": null,
          "old_line_content": "        if (!src_desc.SupportsZeroClamp(Axis::WIDTH, gpu_info)) {",
          "new_line_content": "             \" * args.dilation_x;\\n\";",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "empty",
          "new_api": null,
          "old_text": "check.empty()",
          "new_text": null,
          "old_line_content": "            check.empty() ? \"\" : \" * INIT_FLT(\" + check + \")\";",
          "new_line_content": "        std::string multiplier =",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": "std::to_string(d)",
          "new_api": null,
          "old_text": "std::to_string(d)",
          "new_text": null,
          "old_line_content": "             std::to_string(d) + \")\" + s_postfix + multiplier + \";\\n\";",
          "new_line_content": "        c += \"  src\" + s_postfix + \" = args.src_tensor.Read(x_c, y_c, \" +",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": "std::to_string(weights_counter++)",
          "new_api": null,
          "old_text": "std::to_string(weights_counter++)",
          "new_text": null,
          "old_line_content": "             std::to_string(weights_counter++) + \")\" + s_postfix + \";\\n\";",
          "new_line_content": "             s_postfix + \" * args.constants.Read(\" +",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": "CreateReLU",
          "new_api": null,
          "old_text": "CreateReLU(*relu_attr_ptr, op_def.precision, &result->args_,\n               &elementwise_code)",
          "new_text": null,
          "old_line_content": "    CreateReLU(*relu_attr_ptr, op_def.precision, &result->args_,",
          "new_line_content": "    std::string elementwise_code;",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": "std::to_string(d)",
          "new_api": null,
          "old_text": "std::to_string(d)",
          "new_text": null,
          "old_line_content": "      const std::string var_name = \"dw_res_\" + std::to_string(d);",
          "new_line_content": "    for (int d = 0; d < intermediate_depth; ++d) {",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": "absl::StrReplaceAll(elementwise_code, {{\"in_out_value\", var_name}})",
          "new_api": null,
          "old_text": "absl::StrReplaceAll(elementwise_code, {{\"in_out_value\", var_name}})",
          "new_text": null,
          "old_line_content": "          absl::StrReplaceAll(elementwise_code, {{\"in_out_value\", var_name}});",
          "new_line_content": "      const std::string elementwise_new_code =",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": "std::to_string(d)",
          "new_api": null,
          "old_text": "std::to_string(d)",
          "new_text": null,
          "old_line_content": "    c += \"  FLT4 conv_res_\" + std::to_string(d) + \" = args.constants.Read(\" +",
          "new_line_content": "  for (int d = 0; d < result_depth; ++d) {",
          "content_same": false
        },
        {
          "line": 103,
          "old_api": "IsMali",
          "new_api": null,
          "old_text": "gpu_info.IsMali()",
          "new_text": null,
          "old_line_content": "      gpu_info.IsMali() ? MemoryType::GLOBAL : MemoryType::CONSTANT;",
          "new_line_content": "                         ? MemoryType::GLOBAL",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": "size",
          "new_api": null,
          "old_text": "gpu_data.size()",
          "new_text": null,
          "old_line_content": "  desc.size = float_size * gpu_data.size();",
          "new_line_content": "                         : MemoryType::CONSTANT;",
          "content_same": false
        },
        {
          "line": 231,
          "old_api": "std::to_string(s)",
          "new_api": null,
          "old_text": "std::to_string(s)",
          "new_text": null,
          "old_line_content": "      std::string src = \"dw_res_\" + std::to_string(s);",
          "new_line_content": "    for (int s = 0; s < intermediate_depth; ++s) {",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": "std::to_string(weights_counter++)",
          "new_api": null,
          "old_text": "std::to_string(weights_counter++)",
          "new_text": null,
          "old_line_content": "           std::to_string(weights_counter++) + \");\\n\";",
          "new_line_content": "      c += \"  \" + dst + \" += \" + src + \".x * args.constants.Read(\" +",
          "content_same": false
        },
        {
          "line": 108,
          "old_api": "data",
          "new_api": null,
          "old_text": "gpu_data.data()",
          "new_text": null,
          "old_line_content": "    memcpy(desc.data.data(), gpu_data.data(), desc.size);",
          "new_line_content": "  if (fp32_weights) {",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": "std::to_string(weights_counter++)",
          "new_api": null,
          "old_text": "std::to_string(weights_counter++)",
          "new_text": null,
          "old_line_content": "           std::to_string(weights_counter++) + \");\\n\";",
          "new_line_content": "      c += \"  \" + dst + \" += \" + src + \".y * args.constants.Read(\" +",
          "content_same": false
        },
        {
          "line": 110,
          "old_api": "data",
          "new_api": null,
          "old_text": "desc.data.data()",
          "new_text": null,
          "old_line_content": "    half* gpu_data_half = reinterpret_cast<half*>(desc.data.data());",
          "new_line_content": "  } else {",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": "std::to_string(weights_counter++)",
          "new_api": null,
          "old_text": "std::to_string(weights_counter++)",
          "new_text": null,
          "old_line_content": "           std::to_string(weights_counter++) + \");\\n\";",
          "new_line_content": "      c += \"  \" + dst + \" += \" + src + \".z * args.constants.Read(\" +",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": "std::to_string(weights_counter++)",
          "new_api": null,
          "old_text": "std::to_string(weights_counter++)",
          "new_text": null,
          "old_line_content": "           std::to_string(weights_counter++) + \");\\n\";",
          "new_line_content": "      c += \"  \" + dst + \" += \" + src + \".w * args.constants.Read(\" +",
          "content_same": false
        },
        {
          "line": 242,
          "old_api": "std::to_string(d)",
          "new_api": null,
          "old_text": "std::to_string(d)",
          "new_text": null,
          "old_line_content": "    c += \"  args.dst_tensor.Write(conv_res_\" + std::to_string(d) + \", X, Y, \" +",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 115,
          "old_api": "AddObject",
          "new_api": null,
          "old_text": "op->args_.AddObject(\"constants\",\n                      absl::make_unique<BufferDescriptor>(std::move(desc)))",
          "new_text": null,
          "old_line_content": "  op->args_.AddObject(\"constants\",",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 124,
          "old_api": "SetAddressMode",
          "new_api": null,
          "old_text": "src_desc.SetAddressMode(AddressMode::kZero)",
          "new_text": null,
          "old_line_content": "  src_desc.SetAddressMode(AddressMode::kZero);",
          "new_line_content": "  auto src_desc = op_def.src_tensors[0];",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 13,
      "total_additions": 38,
      "total_deletions": 38,
      "total_api_changes": 89
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 89,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 77,
    "api_calls_after": 78,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 2,
      "total_diff_lines": 17
    }
  }
}