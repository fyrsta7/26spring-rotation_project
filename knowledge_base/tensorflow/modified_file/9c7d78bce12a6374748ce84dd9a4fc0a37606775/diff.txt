diff --git a/tensorflow/compiler/xla/service/cpu/ir_emitter.cc b/tensorflow/compiler/xla/service/cpu/ir_emitter.cc
index a7d0e0e066c..3f5eb3bdf0c 100644
--- a/tensorflow/compiler/xla/service/cpu/ir_emitter.cc
+++ b/tensorflow/compiler/xla/service/cpu/ir_emitter.cc
@@ -278,8 +278,12 @@ Status IrEmitter::HandleConstant(HloInstruction* constant) {
 }
 
 Status IrEmitter::HandleCopy(HloInstruction* copy) {
-  if (copy->shape().IsTuple()) {
-    // kCopy shallow copies a tuple so just memcpy the top-level buffer.
+  if (copy->shape().IsTuple() ||
+      (copy->shape().IsArray() &&
+       LayoutUtil::Equal(copy->operand(0)->shape().layout(),
+                         copy->shape().layout()))) {
+    // If the layouts are equal this is just a memcpy. kCopy shallow copies a
+    // tuple so just memcpy the top-level buffer for tuples.
     TF_RETURN_IF_ERROR(EmitTargetAddressForOp(copy));
     return EmitMemcpy(*(copy->operand(0)), *copy);
   } else if (copy->shape().IsArray()) {
