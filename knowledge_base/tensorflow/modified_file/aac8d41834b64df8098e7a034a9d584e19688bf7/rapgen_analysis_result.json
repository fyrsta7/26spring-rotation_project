{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/aac8d41834b64df8098e7a034a9d584e19688bf7",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/aac8d41834b64df8098e7a034a9d584e19688bf7/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/aac8d41834b64df8098e7a034a9d584e19688bf7/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tensorflow/modified_file/aac8d41834b64df8098e7a034a9d584e19688bf7/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 51,
          "old_api": "createScalarizationPass",
          "new_api": "createCollectStatsPass",
          "old_text": "createScalarizationPass(false)",
          "new_text": "createCollectStatsPass(options.statsDetailLevel)",
          "old_line_content": "  pm.addNestedPass<FuncOp>(createScalarizationPass(false));",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createCollectStatsPass(options.statsDetailLevel));",
          "content_same": false
        },
        {
          "line": 52,
          "old_api": "pm.addNestedPass<FuncOp>(\n      createVectorizeForCPUPass(options.vectorizationSizeThreshold))",
          "new_api": "createScalarizationPass",
          "old_text": "pm.addNestedPass<FuncOp>(\n      createVectorizeForCPUPass(options.vectorizationSizeThreshold))",
          "new_text": "createScalarizationPass(false)",
          "old_line_content": "  pm.addNestedPass<FuncOp>(",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createScalarizationPass(false));",
          "content_same": false
        },
        {
          "line": 53,
          "old_api": "createVectorizeForCPUPass",
          "new_api": "pm.addNestedPass<FuncOp>(\n      createVectorizeForCPUPass(options.vectorizationSizeThreshold))",
          "old_text": "createVectorizeForCPUPass(options.vectorizationSizeThreshold)",
          "new_text": "pm.addNestedPass<FuncOp>(\n      createVectorizeForCPUPass(options.vectorizationSizeThreshold))",
          "old_line_content": "      createVectorizeForCPUPass(options.vectorizationSizeThreshold));",
          "new_line_content": "  pm.addNestedPass<FuncOp>(",
          "content_same": false
        },
        {
          "line": 62,
          "old_api": "func::createDuplicateFunctionEliminationPass()",
          "new_api": "createFusionOutliningPass",
          "old_text": "func::createDuplicateFunctionEliminationPass()",
          "new_text": "createFusionOutliningPass()",
          "old_line_content": "    pm.addPass(func::createDuplicateFunctionEliminationPass());",
          "new_line_content": "    pm.addPass(createFusionOutliningPass());",
          "content_same": false
        },
        {
          "line": 63,
          "old_api": "createCSEPass",
          "new_api": "func::createDuplicateFunctionEliminationPass()",
          "old_text": "createCSEPass()",
          "new_text": "func::createDuplicateFunctionEliminationPass()",
          "old_line_content": "    pm.addPass(createCSEPass());",
          "new_line_content": "    pm.addPass(func::createDuplicateFunctionEliminationPass());",
          "content_same": false
        },
        {
          "line": 69,
          "old_api": "createTransformScatterForCpuPass",
          "new_api": "createTransformConvForCpuPass",
          "old_text": "createTransformScatterForCpuPass()",
          "new_text": "createTransformConvForCpuPass()",
          "old_line_content": "  pm.addNestedPass<FuncOp>(createTransformScatterForCpuPass());",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createTransformConvForCpuPass());",
          "content_same": false
        },
        {
          "line": 70,
          "old_api": "createTransformReduceForCpuPass",
          "new_api": "createTransformScatterForCpuPass",
          "old_text": "createTransformReduceForCpuPass(\n      options.vectorSize, options.reduction1DTileSize,\n      options.reduction2DTileSizes)",
          "new_text": "createTransformScatterForCpuPass()",
          "old_line_content": "  pm.addNestedPass<FuncOp>(createTransformReduceForCpuPass(",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createTransformScatterForCpuPass());",
          "content_same": false
        },
        {
          "line": 74,
          "old_api": "createTransformDotForCpuPass",
          "new_api": "pm.addNestedPass<FuncOp>(\n      createTransformDotForCpuPass(options.matmulTileSizes, options.cpuName))",
          "old_text": "createTransformDotForCpuPass(options.matmulTileSizes, options.cpuName)",
          "new_text": "pm.addNestedPass<FuncOp>(\n      createTransformDotForCpuPass(options.matmulTileSizes, options.cpuName))",
          "old_line_content": "      createTransformDotForCpuPass(options.matmulTileSizes, options.cpuName));",
          "new_line_content": "  pm.addNestedPass<FuncOp>(",
          "content_same": false
        },
        {
          "line": 84,
          "old_api": "createTransformPackForCpuPass",
          "new_api": "createTransformMmt4DForCpuPass",
          "old_text": "createTransformPackForCpuPass()",
          "new_text": "createTransformMmt4DForCpuPass()",
          "old_line_content": "  pm.addNestedPass<FuncOp>(createTransformPackForCpuPass());",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createTransformMmt4DForCpuPass());",
          "content_same": false
        },
        {
          "line": 89,
          "old_api": "createCanonicalizerPass",
          "new_api": "createCSEPass",
          "old_text": "createCanonicalizerPass()",
          "new_text": "createCSEPass()",
          "old_line_content": "  pm.addPass(createCanonicalizerPass());",
          "new_line_content": "  pm.addPass(createCSEPass());",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": "createComposeExtractInsertSlicePass",
          "new_api": "createRewriteForallOpPass",
          "old_text": "createComposeExtractInsertSlicePass()",
          "new_text": "createRewriteForallOpPass()",
          "old_line_content": "  pm.addNestedPass<FuncOp>(createComposeExtractInsertSlicePass());",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createRewriteForallOpPass());",
          "content_same": false
        },
        {
          "line": 93,
          "old_api": "pm.addNestedPass<FuncOp>(\n      createVectorizeForCPUPass(options.vectorizationTiledSizeThreshold))",
          "new_api": "createComposeExtractInsertSlicePass",
          "old_text": "pm.addNestedPass<FuncOp>(\n      createVectorizeForCPUPass(options.vectorizationTiledSizeThreshold))",
          "new_text": "createComposeExtractInsertSlicePass()",
          "old_line_content": "  pm.addNestedPass<FuncOp>(",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createComposeExtractInsertSlicePass());",
          "content_same": false
        },
        {
          "line": 94,
          "old_api": "createVectorizeForCPUPass",
          "new_api": "pm.addNestedPass<FuncOp>(\n      createVectorizeForCPUPass(options.vectorizationTiledSizeThreshold))",
          "old_text": "createVectorizeForCPUPass(options.vectorizationTiledSizeThreshold)",
          "new_text": "pm.addNestedPass<FuncOp>(\n      createVectorizeForCPUPass(options.vectorizationTiledSizeThreshold))",
          "old_line_content": "      createVectorizeForCPUPass(options.vectorizationTiledSizeThreshold));",
          "new_line_content": "  pm.addNestedPass<FuncOp>(",
          "content_same": false
        },
        {
          "line": 98,
          "old_api": "createScalarizationPass",
          "new_api": "createTileByOnePass",
          "old_text": "createScalarizationPass()",
          "new_text": "createTileByOnePass()",
          "old_line_content": "  pm.addNestedPass<FuncOp>(createScalarizationPass());",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createTileByOnePass());",
          "content_same": false
        },
        {
          "line": 109,
          "old_api": "getDefaultCPUPipelineOptions",
          "new_api": "addCPUTilingPipeline",
          "old_text": "getDefaultCPUPipelineOptions(cpuName, statsDetailLevel)",
          "new_text": "addCPUTilingPipeline(pm,\n                       getDefaultCPUPipelineOptions(cpuName, statsDetailLevel))",
          "old_line_content": "                       getDefaultCPUPipelineOptions(cpuName, statsDetailLevel));",
          "new_line_content": "  addCPUTilingPipeline(pm,",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 64,
          "old_api": null,
          "new_api": "createCSEPass",
          "old_text": null,
          "new_text": "createCSEPass()",
          "old_line_content": "  }",
          "new_line_content": "    pm.addPass(createCSEPass());",
          "content_same": false
        },
        {
          "line": 67,
          "old_api": null,
          "new_api": "createPackMatmulPass",
          "old_text": null,
          "new_text": "createPackMatmulPass()",
          "old_line_content": "",
          "new_line_content": "  if (options.lowerToMmt4d) pm.addNestedPass<FuncOp>(createPackMatmulPass());",
          "content_same": false
        },
        {
          "line": 99,
          "old_api": null,
          "new_api": "createScalarizationPass",
          "old_text": null,
          "new_text": "createScalarizationPass()",
          "old_line_content": "",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createScalarizationPass());",
          "content_same": false
        },
        {
          "line": 101,
          "old_api": null,
          "new_api": "createCanonicalizerPass",
          "old_text": null,
          "new_text": "createCanonicalizerPass()",
          "old_line_content": "",
          "new_line_content": "  pm.addPass(createCanonicalizerPass());",
          "content_same": false
        },
        {
          "line": 71,
          "old_api": null,
          "new_api": "createTransformReduceForCpuPass",
          "old_text": null,
          "new_text": "createTransformReduceForCpuPass(\n      options.vectorSize, options.reduction1DTileSize,\n      options.reduction2DTileSizes)",
          "old_line_content": "      options.vectorSize, options.reduction1DTileSize,",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createTransformReduceForCpuPass(",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": null,
          "new_api": "createRemoveLabelPass",
          "old_text": null,
          "new_text": "createRemoveLabelPass()",
          "old_line_content": "}",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createRemoveLabelPass());",
          "content_same": false
        },
        {
          "line": 75,
          "old_api": null,
          "new_api": "createTransformDotForCpuPass",
          "old_text": null,
          "new_text": "createTransformDotForCpuPass(options.matmulTileSizes, options.cpuName)",
          "old_line_content": "  // Upstream generalization of tensor.pack/unpack (i.e. tensor.pack/unpack ->",
          "new_line_content": "      createTransformDotForCpuPass(options.matmulTileSizes, options.cpuName));",
          "content_same": false
        },
        {
          "line": 110,
          "old_api": null,
          "new_api": "getDefaultCPUPipelineOptions",
          "old_text": null,
          "new_text": "getDefaultCPUPipelineOptions(cpuName, statsDetailLevel)",
          "old_line_content": "}",
          "new_line_content": "                       getDefaultCPUPipelineOptions(cpuName, statsDetailLevel));",
          "content_same": false
        },
        {
          "line": 82,
          "old_api": null,
          "new_api": "createTransformElementwiseForCpuPass",
          "old_text": null,
          "new_text": "createTransformElementwiseForCpuPass(\n      options.vectorSize, options.fuseDegenerateReshapes)",
          "old_line_content": "      options.vectorSize, options.fuseDegenerateReshapes));",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createTransformElementwiseForCpuPass(",
          "content_same": false
        },
        {
          "line": 85,
          "old_api": null,
          "new_api": "createTransformPackForCpuPass",
          "old_text": null,
          "new_text": "createTransformPackForCpuPass()",
          "old_line_content": "",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createTransformPackForCpuPass());",
          "content_same": false
        },
        {
          "line": 54,
          "old_api": null,
          "new_api": "createVectorizeForCPUPass",
          "old_text": null,
          "new_text": "createVectorizeForCPUPass(options.vectorizationSizeThreshold)",
          "old_line_content": "",
          "new_line_content": "      createVectorizeForCPUPass(options.vectorizationSizeThreshold));",
          "content_same": false
        },
        {
          "line": 87,
          "old_api": null,
          "new_api": "createInlineFusionClustersPass",
          "old_text": null,
          "new_text": "createInlineFusionClustersPass()",
          "old_line_content": "",
          "new_line_content": "  pm.addNestedPass<FuncOp>(createInlineFusionClustersPass());",
          "content_same": false
        },
        {
          "line": 57,
          "old_api": null,
          "new_api": "createFusionPlanningForCpuPass",
          "old_text": null,
          "new_text": "createFusionPlanningForCpuPass()",
          "old_line_content": "  }",
          "new_line_content": "    pm.addNestedPass<FuncOp>(createFusionPlanningForCpuPass());",
          "content_same": false
        },
        {
          "line": 90,
          "old_api": null,
          "new_api": "createCanonicalizerPass",
          "old_text": null,
          "new_text": "createCanonicalizerPass()",
          "old_line_content": "",
          "new_line_content": "  pm.addPass(createCanonicalizerPass());",
          "content_same": false
        },
        {
          "line": 95,
          "old_api": null,
          "new_api": "createVectorizeForCPUPass",
          "old_text": null,
          "new_text": "createVectorizeForCPUPass(options.vectorizationTiledSizeThreshold)",
          "old_line_content": "",
          "new_line_content": "      createVectorizeForCPUPass(options.vectorizationTiledSizeThreshold));",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 97,
          "old_api": "createTileByOnePass",
          "new_api": null,
          "old_text": "createTileByOnePass()",
          "new_text": null,
          "old_line_content": "  pm.addNestedPass<FuncOp>(createTileByOnePass());",
          "new_line_content": "  // Tile remaining ops by size one and scalarize what we can.",
          "content_same": false
        },
        {
          "line": 66,
          "old_api": "createPackMatmulPass",
          "new_api": null,
          "old_text": "createPackMatmulPass()",
          "new_text": null,
          "old_line_content": "  if (options.lowerToMmt4d) pm.addNestedPass<FuncOp>(createPackMatmulPass());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 68,
          "old_api": "createTransformConvForCpuPass",
          "new_api": null,
          "old_text": "createTransformConvForCpuPass()",
          "new_text": null,
          "old_line_content": "  pm.addNestedPass<FuncOp>(createTransformConvForCpuPass());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 100,
          "old_api": "createCanonicalizerPass",
          "new_api": null,
          "old_text": "createCanonicalizerPass()",
          "new_text": null,
          "old_line_content": "  pm.addPass(createCanonicalizerPass());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 103,
          "old_api": "createRemoveLabelPass",
          "new_api": null,
          "old_text": "createRemoveLabelPass()",
          "new_text": null,
          "old_line_content": "  pm.addNestedPass<FuncOp>(createRemoveLabelPass());",
          "new_line_content": "  // Remove transformed labels after tiling all ops.",
          "content_same": false
        },
        {
          "line": 73,
          "old_api": "pm.addNestedPass<FuncOp>(\n      createTransformDotForCpuPass(options.matmulTileSizes, options.cpuName))",
          "new_api": null,
          "old_text": "pm.addNestedPass<FuncOp>(\n      createTransformDotForCpuPass(options.matmulTileSizes, options.cpuName))",
          "new_text": null,
          "old_line_content": "  pm.addNestedPass<FuncOp>(",
          "new_line_content": "      options.reduction2DTileSizes));",
          "content_same": false
        },
        {
          "line": 91,
          "old_api": "createRewriteForallOpPass",
          "new_api": null,
          "old_text": "createRewriteForallOpPass()",
          "new_text": null,
          "old_line_content": "  pm.addNestedPass<FuncOp>(createRewriteForallOpPass());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 108,
          "old_api": "addCPUTilingPipeline",
          "new_api": null,
          "old_text": "addCPUTilingPipeline(pm,\n                       getDefaultCPUPipelineOptions(cpuName, statsDetailLevel))",
          "new_text": null,
          "old_line_content": "  addCPUTilingPipeline(pm,",
          "new_line_content": "                                 int64_t statsDetailLevel) {",
          "content_same": false
        },
        {
          "line": 81,
          "old_api": "createTransformElementwiseForCpuPass",
          "new_api": null,
          "old_text": "createTransformElementwiseForCpuPass(\n      options.vectorSize, options.fuseDegenerateReshapes)",
          "new_text": null,
          "old_line_content": "  pm.addNestedPass<FuncOp>(createTransformElementwiseForCpuPass(",
          "new_line_content": "  // transformation.",
          "content_same": false
        },
        {
          "line": 50,
          "old_api": "createCollectStatsPass",
          "new_api": null,
          "old_text": "createCollectStatsPass(options.statsDetailLevel)",
          "new_text": null,
          "old_line_content": "  pm.addNestedPass<FuncOp>(createCollectStatsPass(options.statsDetailLevel));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 83,
          "old_api": "createTransformMmt4DForCpuPass",
          "new_api": null,
          "old_text": "createTransformMmt4DForCpuPass()",
          "new_text": null,
          "old_line_content": "  pm.addNestedPass<FuncOp>(createTransformMmt4DForCpuPass());",
          "new_line_content": "      options.vectorSize, options.fuseDegenerateReshapes));",
          "content_same": false
        },
        {
          "line": 86,
          "old_api": "createInlineFusionClustersPass",
          "new_api": null,
          "old_text": "createInlineFusionClustersPass()",
          "new_text": null,
          "old_line_content": "  pm.addNestedPass<FuncOp>(createInlineFusionClustersPass());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 56,
          "old_api": "createFusionPlanningForCpuPass",
          "new_api": null,
          "old_text": "createFusionPlanningForCpuPass()",
          "new_text": null,
          "old_line_content": "    pm.addNestedPass<FuncOp>(createFusionPlanningForCpuPass());",
          "new_line_content": "  if (options.enableFusionClusters) {",
          "content_same": false
        },
        {
          "line": 88,
          "old_api": "createCSEPass",
          "new_api": null,
          "old_text": "createCSEPass()",
          "new_text": null,
          "old_line_content": "  pm.addPass(createCSEPass());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 61,
          "old_api": "createFusionOutliningPass",
          "new_api": null,
          "old_text": "createFusionOutliningPass()",
          "new_text": null,
          "old_line_content": "    pm.addPass(createFusionOutliningPass());",
          "new_line_content": "  if (options.enableFusionClusterOutlining) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 15,
      "total_additions": 15,
      "total_deletions": 15,
      "total_api_changes": 45
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 45,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          35,
          36
        ]
      }
    },
    "api_calls_before": 52,
    "api_calls_after": 52,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 1,
      "total_diff_lines": 15
    }
  }
}