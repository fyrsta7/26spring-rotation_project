{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/5cb5023c78ceb43d02db609db948fce62221b554",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/5cb5023c78ceb43d02db609db948fce62221b554/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/5cb5023c78ceb43d02db609db948fce62221b554/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/5cb5023c78ceb43d02db609db948fce62221b554/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 108,
          "old_api": "assert",
          "new_api": "ff_h264_find_frame_end",
          "old_text": "assert(pc->last_index + next >= 0 )",
          "new_text": "ff_h264_find_frame_end(h, buf, buf_size)",
          "old_line_content": "            assert(pc->last_index + next >= 0 );",
          "new_line_content": "        next= ff_h264_find_frame_end(h, buf, buf_size);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 118,
          "old_api": null,
          "new_api": "ff_h264_find_frame_end",
          "old_text": null,
          "new_text": "ff_h264_find_frame_end(h, &pc->buffer[pc->last_index + next], -next)",
          "old_line_content": "static int h264_split(AVCodecContext *avctx,",
          "new_line_content": "            ff_h264_find_frame_end(h, &pc->buffer[pc->last_index + next], -next); //update state",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(pc->buffer)",
          "old_line_content": "    close,",
          "new_line_content": "    av_free(pc->buffer);",
          "content_same": false
        },
        {
          "line": 117,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(pc->last_index + next >= 0 )",
          "old_line_content": "",
          "new_line_content": "            assert(pc->last_index + next >= 0 );",
          "content_same": false
        },
        {
          "line": 110,
          "old_api": null,
          "new_api": "ff_combine_frame",
          "old_text": null,
          "new_text": "ff_combine_frame(pc, next, &buf, &buf_size)",
          "old_line_content": "        }",
          "new_line_content": "        if (ff_combine_frame(pc, next, &buf, &buf_size) < 0) {",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 109,
          "old_api": "ff_h264_find_frame_end",
          "new_api": null,
          "old_text": "ff_h264_find_frame_end(h, &pc->buffer[pc->last_index + next], -next)",
          "new_text": null,
          "old_line_content": "            ff_h264_find_frame_end(h, &pc->buffer[pc->last_index + next], -next); //update state",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 99,
          "old_api": "ff_h264_find_frame_end",
          "new_api": null,
          "old_text": "ff_h264_find_frame_end(h, buf, buf_size)",
          "new_text": null,
          "old_line_content": "        next= ff_h264_find_frame_end(h, buf, buf_size);",
          "new_line_content": "                      const uint8_t *buf, int buf_size)",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(pc->buffer)",
          "new_text": null,
          "old_line_content": "    av_free(pc->buffer);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 101,
          "old_api": "ff_combine_frame",
          "new_api": null,
          "old_text": "ff_combine_frame(pc, next, &buf, &buf_size)",
          "new_text": null,
          "old_line_content": "        if (ff_combine_frame(pc, next, &buf, &buf_size) < 0) {",
          "new_line_content": "    H264Context *h = s->priv_data;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 1,
      "total_additions": 4,
      "total_deletions": 4,
      "total_api_changes": 9
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 9,
        "api_related_lines": 9,
        "non_api_lines": 9,
        "non_api_line_numbers": [
          47,
          48,
          49,
          50,
          51,
          52,
          53,
          54,
          55
        ]
      }
    },
    "api_calls_before": 5,
    "api_calls_after": 5,
    "diff_info": {
      "added_lines": 9,
      "removed_lines": 0,
      "total_diff_lines": 21
    }
  }
}