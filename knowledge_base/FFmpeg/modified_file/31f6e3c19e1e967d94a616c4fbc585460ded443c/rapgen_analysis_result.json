{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/31f6e3c19e1e967d94a616c4fbc585460ded443c",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/31f6e3c19e1e967d94a616c4fbc585460ded443c/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/31f6e3c19e1e967d94a616c4fbc585460ded443c/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/31f6e3c19e1e967d94a616c4fbc585460ded443c/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 475,
          "old_api": "filter_mb_edgeh",
          "new_api": "tprintf",
          "old_text": "filter_mb_edgeh( h, &img_y[j*linesize], tmp_linesize, bS, qp )",
          "new_text": "tprintf(s->avctx, \"\\n\")",
          "old_line_content": "            filter_mb_edgeh( h, &img_y[j*linesize], tmp_linesize, bS, qp );",
          "new_line_content": "            { int i; for (i = 0; i < 4; i++) tprintf(s->avctx, \" bS[%d]:%d\", i, bS[i]); tprintf(s->avctx, \"\\n\"); }",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": "filter_mb_edgech",
          "new_api": "filter_mb_edgeh",
          "old_text": "filter_mb_edgech( h, &img_cb[j*uvlinesize], tmp_uvlinesize, bS,\n                              ( h->chroma_qp[0] + get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1)",
          "new_text": "filter_mb_edgeh( h, &img_y[j*linesize], tmp_linesize, bS, qp )",
          "old_line_content": "            filter_mb_edgech( h, &img_cb[j*uvlinesize], tmp_uvlinesize, bS,",
          "new_line_content": "            filter_mb_edgeh( h, &img_y[j*linesize], tmp_linesize, bS, qp );",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": "get_chroma_qp",
          "new_api": "filter_mb_edgech",
          "old_text": "get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] )",
          "new_text": "filter_mb_edgech( h, &img_cb[j*uvlinesize], tmp_uvlinesize, bS,\n                              ( h->chroma_qp[0] + get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1)",
          "old_line_content": "                              ( h->chroma_qp[0] + get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1);",
          "new_line_content": "            filter_mb_edgech( h, &img_cb[j*uvlinesize], tmp_uvlinesize, bS,",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": "filter_mb_edgech",
          "new_api": "get_chroma_qp",
          "old_text": "filter_mb_edgech( h, &img_cr[j*uvlinesize], tmp_uvlinesize, bS,\n                              ( h->chroma_qp[1] + get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1)",
          "new_text": "get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] )",
          "old_line_content": "            filter_mb_edgech( h, &img_cr[j*uvlinesize], tmp_uvlinesize, bS,",
          "new_line_content": "                              ( h->chroma_qp[0] + get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1);",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": "get_chroma_qp",
          "new_api": "filter_mb_edgech",
          "old_text": "get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] )",
          "new_text": "filter_mb_edgech( h, &img_cr[j*uvlinesize], tmp_uvlinesize, bS,\n                              ( h->chroma_qp[1] + get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1)",
          "old_line_content": "                              ( h->chroma_qp[1] + get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1);",
          "new_line_content": "            filter_mb_edgech( h, &img_cr[j*uvlinesize], tmp_uvlinesize, bS,",
          "content_same": false
        },
        {
          "line": 595,
          "old_api": "filter_mb_edgecv",
          "new_api": "get_chroma_qp",
          "old_text": "filter_mb_edgecv( h, &img_cb[2*edge], uvlinesize, bS, qp)",
          "new_text": "get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] )",
          "old_line_content": "                filter_mb_edgecv( h, &img_cb[2*edge], uvlinesize, bS, qp);",
          "new_line_content": "                int qp= ( h->chroma_qp[0] + get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1;",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": "filter_mb_edgecv",
          "new_api": "get_chroma_qp",
          "old_text": "filter_mb_edgecv( h, &img_cr[2*edge], uvlinesize, bS, qp)",
          "new_text": "get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] )",
          "old_line_content": "                filter_mb_edgecv( h, &img_cr[2*edge], uvlinesize, bS, qp);",
          "new_line_content": "                    qp= ( h->chroma_qp[1] + get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1;",
          "content_same": false
        },
        {
          "line": 604,
          "old_api": "filter_mb_edgech",
          "new_api": "get_chroma_qp",
          "old_text": "filter_mb_edgech( h, &img_cb[2*edge*uvlinesize], uvlinesize, bS, qp)",
          "new_text": "get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] )",
          "old_line_content": "                filter_mb_edgech( h, &img_cb[2*edge*uvlinesize], uvlinesize, bS, qp);",
          "new_line_content": "                int qp= ( h->chroma_qp[0] + get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1;",
          "content_same": false
        },
        {
          "line": 607,
          "old_api": "filter_mb_edgech",
          "new_api": "get_chroma_qp",
          "old_text": "filter_mb_edgech( h, &img_cr[2*edge*uvlinesize], uvlinesize, bS, qp)",
          "new_text": "get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] )",
          "old_line_content": "                filter_mb_edgech( h, &img_cr[2*edge*uvlinesize], uvlinesize, bS, qp);",
          "new_line_content": "                    qp= ( h->chroma_qp[1] + get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1;",
          "content_same": false
        },
        {
          "line": 681,
          "old_api": "filter_mb_mbaff_edgev ( h, img_y  + 8*  linesize,   linesize, bS+4, 1, qp [1] )",
          "new_api": "filter_mb_mbaff_edgev ( h, img_y                ,   linesize, bS  , 1, qp [0] )",
          "old_text": "filter_mb_mbaff_edgev ( h, img_y  + 8*  linesize,   linesize, bS+4, 1, qp [1] )",
          "new_text": "filter_mb_mbaff_edgev ( h, img_y                ,   linesize, bS  , 1, qp [0] )",
          "old_line_content": "            filter_mb_mbaff_edgev ( h, img_y  + 8*  linesize,   linesize, bS+4, 1, qp [1] );",
          "new_line_content": "            filter_mb_mbaff_edgev ( h, img_y                ,   linesize, bS  , 1, qp [0] );",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": "filter_mb_mbaff_edgecv",
          "new_api": "filter_mb_mbaff_edgev ( h, img_y  + 8*  linesize,   linesize, bS+4, 1, qp [1] )",
          "old_text": "filter_mb_mbaff_edgecv( h, img_cb,                uvlinesize, bS  , 1, bqp[0] )",
          "new_text": "filter_mb_mbaff_edgev ( h, img_y  + 8*  linesize,   linesize, bS+4, 1, qp [1] )",
          "old_line_content": "            filter_mb_mbaff_edgecv( h, img_cb,                uvlinesize, bS  , 1, bqp[0] );",
          "new_line_content": "            filter_mb_mbaff_edgev ( h, img_y  + 8*  linesize,   linesize, bS+4, 1, qp [1] );",
          "content_same": false
        },
        {
          "line": 688,
          "old_api": "filter_mb_mbaff_edgev ( h, img_y  +   linesize, 2*  linesize, bS+1, 2, qp [1] )",
          "new_api": "filter_mb_mbaff_edgev ( h, img_y              , 2*  linesize, bS  , 2, qp [0] )",
          "old_text": "filter_mb_mbaff_edgev ( h, img_y  +   linesize, 2*  linesize, bS+1, 2, qp [1] )",
          "new_text": "filter_mb_mbaff_edgev ( h, img_y              , 2*  linesize, bS  , 2, qp [0] )",
          "old_line_content": "            filter_mb_mbaff_edgev ( h, img_y  +   linesize, 2*  linesize, bS+1, 2, qp [1] );",
          "new_line_content": "            filter_mb_mbaff_edgev ( h, img_y              , 2*  linesize, bS  , 2, qp [0] );",
          "content_same": false
        },
        {
          "line": 689,
          "old_api": "filter_mb_mbaff_edgecv",
          "new_api": "filter_mb_mbaff_edgev ( h, img_y  +   linesize, 2*  linesize, bS+1, 2, qp [1] )",
          "old_text": "filter_mb_mbaff_edgecv( h, img_cb,              2*uvlinesize, bS  , 2, bqp[0] )",
          "new_text": "filter_mb_mbaff_edgev ( h, img_y  +   linesize, 2*  linesize, bS+1, 2, qp [1] )",
          "old_line_content": "            filter_mb_mbaff_edgecv( h, img_cb,              2*uvlinesize, bS  , 2, bqp[0] );",
          "new_line_content": "            filter_mb_mbaff_edgev ( h, img_y  +   linesize, 2*  linesize, bS+1, 2, qp [1] );",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 513,
          "old_api": null,
          "new_api": "IS_INTERLACED",
          "old_text": null,
          "new_text": "IS_INTERLACED(mb_type ^ mbn_type)",
          "old_line_content": "                *(uint64_t*)bS= 0x0001000100010001ULL;",
          "new_line_content": "            else if( FRAME_MBAFF && IS_INTERLACED(mb_type ^ mbn_type)) {",
          "content_same": false
        },
        {
          "line": 643,
          "old_api": null,
          "new_api": "IS_INTRA",
          "old_text": null,
          "new_text": "IS_INTRA(mb_type)",
          "old_line_content": "            *(uint64_t*)&bS[0]=",
          "new_line_content": "        if( IS_INTRA(mb_type) )",
          "content_same": false
        },
        {
          "line": 650,
          "old_api": null,
          "new_api": "IS_INTRA",
          "old_text": null,
          "new_text": "IS_INTRA( s->current_picture.mb_type[mbn_xy] )",
          "old_line_content": "                    bS[i] = 4;",
          "new_line_content": "                if( IS_INTRA( s->current_picture.mb_type[mbn_xy] ) )",
          "content_same": false
        },
        {
          "line": 525,
          "old_api": null,
          "new_api": "FFABS",
          "old_text": null,
          "new_text": "FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[l][bn_idx][1] )",
          "old_line_content": "                }",
          "new_line_content": "                         FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[l][bn_idx][1] ) >= mvy_limit;",
          "content_same": false
        },
        {
          "line": 653,
          "old_api": null,
          "new_api": "IS_8x8DCT",
          "old_text": null,
          "new_text": "IS_8x8DCT(s->current_picture.mb_type[mbn_xy])",
          "old_line_content": "                            (h->cbp_table[mbn_xy] & ((MB_FIELD ? (i&2) : (mb_y&1)) ? 8 : 2))",
          "new_line_content": "                         ((!h->pps.cabac && IS_8x8DCT(s->current_picture.mb_type[mbn_xy])) ?",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": null,
          "new_api": "FFABS",
          "old_text": null,
          "new_text": "FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[ln][bn_idx][1] )",
          "old_line_content": "                    }",
          "new_line_content": "                            FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[ln][bn_idx][1] ) >= mvy_limit;",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": null,
          "new_api": "get_chroma_qp",
          "old_text": null,
          "new_text": "get_chroma_qp( h, 1, mbn0_qp )",
          "old_line_content": "        qp[1] = ( mb_qp + mbn1_qp + 1 ) >> 1;",
          "new_line_content": "                   get_chroma_qp( h, 1, mbn0_qp ) + 1 ) >> 1;",
          "content_same": false
        },
        {
          "line": 675,
          "old_api": null,
          "new_api": "get_chroma_qp",
          "old_text": null,
          "new_text": "get_chroma_qp( h, 1, mbn1_qp )",
          "old_line_content": "",
          "new_line_content": "                   get_chroma_qp( h, 1, mbn1_qp ) + 1 ) >> 1;",
          "content_same": false
        },
        {
          "line": 679,
          "old_api": null,
          "new_api": "tprintf",
          "old_text": null,
          "new_text": "tprintf(s->avctx, \"\\n\")",
          "old_line_content": "        if(MB_FIELD){",
          "new_line_content": "        { int i; for (i = 0; i < 8; i++) tprintf(s->avctx, \" bS[%d]:%d\", i, bS[i]); tprintf(s->avctx, \"\\n\"); }",
          "content_same": false
        },
        {
          "line": 686,
          "old_api": null,
          "new_api": "filter_mb_mbaff_edgecv",
          "old_text": null,
          "new_text": "filter_mb_mbaff_edgecv( h, img_cr + 4*uvlinesize, uvlinesize, bS+4, 1, rqp[1] )",
          "old_line_content": "        }else{",
          "new_line_content": "            filter_mb_mbaff_edgecv( h, img_cr + 4*uvlinesize, uvlinesize, bS+4, 1, rqp[1] );",
          "content_same": false
        },
        {
          "line": 560,
          "old_api": null,
          "new_api": "FFABS",
          "old_text": null,
          "new_text": "FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[l][bn_idx][1] )",
          "old_line_content": "                            bS[i] = 1;",
          "new_line_content": "                            FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[l][bn_idx][1] ) >= mvy_limit ) {",
          "content_same": false
        },
        {
          "line": 693,
          "old_api": null,
          "new_api": "filter_mb_mbaff_edgecv",
          "old_text": null,
          "new_text": "filter_mb_mbaff_edgecv( h, img_cr + uvlinesize, 2*uvlinesize, bS+1, 2, rqp[1] )",
          "old_line_content": "        }",
          "new_line_content": "            filter_mb_mbaff_edgecv( h, img_cr + uvlinesize, 2*uvlinesize, bS+1, 2, rqp[1] );",
          "content_same": false
        },
        {
          "line": 699,
          "old_api": null,
          "new_api": "filter_mb_dir",
          "old_text": null,
          "new_text": "filter_mb_dir(h, mb_x, mb_y, img_y, img_cb, img_cr, linesize, uvlinesize, mb_xy, mb_type, mvy_limit, dir ? 0 : first_vertical_edge_done, dir)",
          "old_line_content": "#else",
          "new_line_content": "        filter_mb_dir(h, mb_x, mb_y, img_y, img_cb, img_cr, linesize, uvlinesize, mb_xy, mb_type, mvy_limit, dir ? 0 : first_vertical_edge_done, dir);",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": null,
          "new_api": "FFABS",
          "old_text": null,
          "new_text": "FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[ln][bn_idx][1] )",
          "old_line_content": "                                bS[i] = 1;",
          "new_line_content": "                                FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[ln][bn_idx][1] ) >= mvy_limit ) {",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": null,
          "new_api": "filter_mb_dir",
          "old_text": null,
          "new_text": "filter_mb_dir(h, mb_x, mb_y, img_y, img_cb, img_cr, linesize, uvlinesize, mb_xy, mb_type, mvy_limit, 0, 1)",
          "old_line_content": "#endif",
          "new_line_content": "    filter_mb_dir(h, mb_x, mb_y, img_y, img_cb, img_cr, linesize, uvlinesize, mb_xy, mb_type, mvy_limit, 0, 1);",
          "content_same": false
        },
        {
          "line": 448,
          "old_api": null,
          "new_api": "IS_INTERLACED",
          "old_text": null,
          "new_text": "IS_INTERLACED(mbm_type&~mb_type)",
          "old_line_content": "        ) {",
          "new_line_content": "        && IS_INTERLACED(mbm_type&~mb_type)",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": null,
          "new_api": "tprintf",
          "old_text": null,
          "new_text": "tprintf(s->avctx, \"filter mb:%d/%d dir:%d edge:%d, QPy:%d ls:%d uvls:%d\", mb_x, mb_y, dir, edge, qp, linesize, uvlinesize)",
          "old_line_content": "        //{ int i; for (i = 0; i < 4; i++) tprintf(s->avctx, \" bS[%d]:%d\", i, bS[i]); tprintf(s->avctx, \"\\n\"); }",
          "new_line_content": "        tprintf(s->avctx, \"filter mb:%d/%d dir:%d edge:%d, QPy:%d ls:%d uvls:%d\", mb_x, mb_y, dir, edge, qp, linesize, uvlinesize);",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": null,
          "new_api": "IS_INTRA",
          "old_text": null,
          "new_text": "IS_INTRA(mb_type|s->current_picture.mb_type[mbn_xy])",
          "old_line_content": "                *(uint64_t*)bS= 0x0003000300030003ULL;",
          "new_line_content": "            if( IS_INTRA(mb_type|s->current_picture.mb_type[mbn_xy]) ) {",
          "content_same": false
        },
        {
          "line": 593,
          "old_api": null,
          "new_api": "filter_mb_edgev",
          "old_text": null,
          "new_text": "filter_mb_edgev( h, &img_y[4*edge], linesize, bS, qp )",
          "old_line_content": "            if( (edge&1) == 0 ) {",
          "new_line_content": "            filter_mb_edgev( h, &img_y[4*edge], linesize, bS, qp );",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": null,
          "new_api": "filter_mb_edgecv",
          "old_text": null,
          "new_text": "filter_mb_edgecv( h, &img_cb[2*edge], uvlinesize, bS, qp)",
          "old_line_content": "                if(h->pps.chroma_qp_diff)",
          "new_line_content": "                filter_mb_edgecv( h, &img_cb[2*edge], uvlinesize, bS, qp);",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": null,
          "new_api": "filter_mb_edgecv",
          "old_text": null,
          "new_text": "filter_mb_edgecv( h, &img_cr[2*edge], uvlinesize, bS, qp)",
          "old_line_content": "            }",
          "new_line_content": "                filter_mb_edgecv( h, &img_cr[2*edge], uvlinesize, bS, qp);",
          "content_same": false
        },
        {
          "line": 602,
          "old_api": null,
          "new_api": "filter_mb_edgeh",
          "old_text": null,
          "new_text": "filter_mb_edgeh( h, &img_y[4*edge*linesize], linesize, bS, qp )",
          "old_line_content": "            if( (edge&1) == 0 ) {",
          "new_line_content": "            filter_mb_edgeh( h, &img_y[4*edge*linesize], linesize, bS, qp );",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": null,
          "new_api": "filter_mb_edgech",
          "old_text": null,
          "new_text": "filter_mb_edgech( h, &img_cb[2*edge*uvlinesize], uvlinesize, bS, qp)",
          "old_line_content": "                if(h->pps.chroma_qp_diff)",
          "new_line_content": "                filter_mb_edgech( h, &img_cb[2*edge*uvlinesize], uvlinesize, bS, qp);",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "filter_mb_edgech",
          "old_text": null,
          "new_text": "filter_mb_edgech( h, &img_cr[2*edge*uvlinesize], uvlinesize, bS, qp)",
          "old_line_content": "            }",
          "new_line_content": "                filter_mb_edgech( h, &img_cr[2*edge*uvlinesize], uvlinesize, bS, qp);",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": null,
          "new_api": "get_chroma_qp",
          "old_text": null,
          "new_text": "get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] )",
          "old_line_content": "        }",
          "new_line_content": "                              ( h->chroma_qp[1] + get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1);",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": null,
          "new_api": "IS_INTERLACED",
          "old_text": null,
          "new_text": "IS_INTERLACED(mb_type)",
          "old_line_content": "    int first_vertical_edge_done = 0;",
          "new_line_content": "    const int mvy_limit = IS_INTERLACED(mb_type) ? 2 : 4;",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": null,
          "new_api": "IS_8x8DCT",
          "old_text": null,
          "new_text": "IS_8x8DCT(mb_type)",
          "old_line_content": "            continue;",
          "new_line_content": "        if( (edge&1) && IS_8x8DCT(mb_type) )",
          "content_same": false
        },
        {
          "line": 497,
          "old_api": null,
          "new_api": "IS_INTRA",
          "old_text": null,
          "new_text": "IS_INTRA(mb_type|mbn_type)",
          "old_line_content": "            *(uint64_t*)bS= 0x0003000300030003ULL;",
          "new_line_content": "        if( IS_INTRA(mb_type|mbn_type)) {",
          "content_same": false
        },
        {
          "line": 627,
          "old_api": null,
          "new_api": "IS_INTERLACED",
          "old_text": null,
          "new_text": "IS_INTERLACED(mb_type^s->current_picture.mb_type[mb_xy-1])",
          "old_line_content": "            // and left mb is in the same slice if deblocking_filter == 2",
          "new_line_content": "            && IS_INTERLACED(mb_type^s->current_picture.mb_type[mb_xy-1])",
          "content_same": false
        },
        {
          "line": 500,
          "old_api": null,
          "new_api": "IS_INTERLACED",
          "old_text": null,
          "new_text": "IS_INTERLACED(mb_type|mbm_type)",
          "old_line_content": "                    || ((FRAME_MBAFF || (s->picture_structure != PICT_FRAME)) && (dir == 0))",
          "new_line_content": "                if (   (!IS_INTERLACED(mb_type|mbm_type))",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 512,
          "old_api": "IS_INTERLACED",
          "new_api": null,
          "old_text": "IS_INTERLACED(mb_type ^ mbn_type)",
          "new_text": null,
          "old_line_content": "            else if( FRAME_MBAFF && IS_INTERLACED(mb_type ^ mbn_type)) {",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 642,
          "old_api": "IS_INTRA",
          "new_api": null,
          "old_text": "IS_INTRA(mb_type)",
          "new_text": null,
          "old_line_content": "        if( IS_INTRA(mb_type) )",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 649,
          "old_api": "IS_INTRA",
          "new_api": null,
          "old_text": "IS_INTRA( s->current_picture.mb_type[mbn_xy] )",
          "new_text": null,
          "old_line_content": "                if( IS_INTRA( s->current_picture.mb_type[mbn_xy] ) )",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": "FFABS",
          "new_api": null,
          "old_text": "FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[l][bn_idx][1] )",
          "new_text": null,
          "old_line_content": "                         FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[l][bn_idx][1] ) >= mvy_limit;",
          "new_line_content": "                         h->mv_cache[l][b_idx][0] - h->mv_cache[l][bn_idx][0] + 3 >= 7U |",
          "content_same": false
        },
        {
          "line": 652,
          "old_api": "IS_8x8DCT",
          "new_api": null,
          "old_text": "IS_8x8DCT(s->current_picture.mb_type[mbn_xy])",
          "new_text": null,
          "old_line_content": "                         ((!h->pps.cabac && IS_8x8DCT(s->current_picture.mb_type[mbn_xy])) ?",
          "new_line_content": "                else if( h->non_zero_count_cache[12+8*(i>>1)] != 0 ||",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": "FFABS",
          "new_api": null,
          "old_text": "FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[ln][bn_idx][1] )",
          "new_text": null,
          "old_line_content": "                            FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[ln][bn_idx][1] ) >= mvy_limit;",
          "new_line_content": "                            h->mv_cache[l][b_idx][0] - h->mv_cache[ln][bn_idx][0] + 3 >= 7U |",
          "content_same": false
        },
        {
          "line": 666,
          "old_api": "get_chroma_qp",
          "new_api": null,
          "old_text": "get_chroma_qp( h, 0, mb_qp )",
          "new_text": null,
          "old_line_content": "        bqp[0] = ( get_chroma_qp( h, 0, mb_qp ) +",
          "new_line_content": "        qp[0] = ( mb_qp + mbn0_qp + 1 ) >> 1;",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": "get_chroma_qp",
          "new_api": null,
          "old_text": "get_chroma_qp( h, 0, mb_qp )",
          "new_text": null,
          "old_line_content": "        bqp[1] = ( get_chroma_qp( h, 0, mb_qp ) +",
          "new_line_content": "        qp[1] = ( mb_qp + mbn1_qp + 1 ) >> 1;",
          "content_same": false
        },
        {
          "line": 677,
          "old_api": "tprintf",
          "new_api": null,
          "old_text": "tprintf(s->avctx, \"filter mb:%d/%d MBAFF, QPy:%d/%d, QPb:%d/%d QPr:%d/%d ls:%d uvls:%d\", mb_x, mb_y, qp[0], qp[1], bqp[0], bqp[1], rqp[0], rqp[1], linesize, uvlinesize)",
          "new_text": null,
          "old_line_content": "        tprintf(s->avctx, \"filter mb:%d/%d MBAFF, QPy:%d/%d, QPb:%d/%d QPr:%d/%d ls:%d uvls:%d\", mb_x, mb_y, qp[0], qp[1], bqp[0], bqp[1], rqp[0], rqp[1], linesize, uvlinesize);",
          "new_line_content": "        /* Filter edge */",
          "content_same": false
        },
        {
          "line": 680,
          "old_api": "filter_mb_mbaff_edgev ( h, img_y                ,   linesize, bS  , 1, qp [0] )",
          "new_api": null,
          "old_text": "filter_mb_mbaff_edgev ( h, img_y                ,   linesize, bS  , 1, qp [0] )",
          "new_text": null,
          "old_line_content": "            filter_mb_mbaff_edgev ( h, img_y                ,   linesize, bS  , 1, qp [0] );",
          "new_line_content": "        if(MB_FIELD){",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": "FFABS",
          "new_api": null,
          "old_text": "FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[l][bn_idx][1] )",
          "new_text": null,
          "old_line_content": "                            FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[l][bn_idx][1] ) >= mvy_limit ) {",
          "new_line_content": "                            h->mv_cache[l][b_idx][0] - h->mv_cache[l][bn_idx][0] + 3 >= 7U |",
          "content_same": false
        },
        {
          "line": 687,
          "old_api": "filter_mb_mbaff_edgev ( h, img_y              , 2*  linesize, bS  , 2, qp [0] )",
          "new_api": null,
          "old_text": "filter_mb_mbaff_edgev ( h, img_y              , 2*  linesize, bS  , 2, qp [0] )",
          "new_text": null,
          "old_line_content": "            filter_mb_mbaff_edgev ( h, img_y              , 2*  linesize, bS  , 2, qp [0] );",
          "new_line_content": "        }else{",
          "content_same": false
        },
        {
          "line": 698,
          "old_api": "filter_mb_dir",
          "new_api": null,
          "old_text": "filter_mb_dir(h, mb_x, mb_y, img_y, img_cb, img_cr, linesize, uvlinesize, mb_xy, mb_type, mvy_limit, dir ? 0 : first_vertical_edge_done, dir)",
          "new_text": null,
          "old_line_content": "        filter_mb_dir(h, mb_x, mb_y, img_y, img_cb, img_cr, linesize, uvlinesize, mb_xy, mb_type, mvy_limit, dir ? 0 : first_vertical_edge_done, dir);",
          "new_line_content": "    for( dir = 0; dir < 2; dir++ )",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": "FFABS",
          "new_api": null,
          "old_text": "FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[ln][bn_idx][1] )",
          "new_text": null,
          "old_line_content": "                                FFABS( h->mv_cache[l][b_idx][1] - h->mv_cache[ln][bn_idx][1] ) >= mvy_limit ) {",
          "new_line_content": "                                h->mv_cache[l][b_idx][0] - h->mv_cache[ln][bn_idx][0] + 3 >= 7U |",
          "content_same": false
        },
        {
          "line": 700,
          "old_api": "filter_mb_dir",
          "new_api": null,
          "old_text": "filter_mb_dir(h, mb_x, mb_y, img_y, img_cb, img_cr, linesize, uvlinesize, mb_xy, mb_type, mvy_limit, first_vertical_edge_done, 0)",
          "new_text": null,
          "old_line_content": "    filter_mb_dir(h, mb_x, mb_y, img_y, img_cb, img_cr, linesize, uvlinesize, mb_xy, mb_type, mvy_limit, first_vertical_edge_done, 0);",
          "new_line_content": "#else",
          "content_same": false
        },
        {
          "line": 447,
          "old_api": "IS_INTERLACED",
          "new_api": null,
          "old_text": "IS_INTERLACED(mbm_type&~mb_type)",
          "new_text": null,
          "old_line_content": "        && IS_INTERLACED(mbm_type&~mb_type)",
          "new_line_content": "    if (FRAME_MBAFF && (dir == 1) && ((mb_y&1) == 0) && start == 0",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": "tprintf",
          "new_api": null,
          "old_text": "tprintf(s->avctx, \"filter mb:%d/%d dir:%d edge:%d, QPy:%d ls:%d uvls:%d\", mb_x, mb_y, dir, edge, qp, linesize, uvlinesize)",
          "new_text": null,
          "old_line_content": "        tprintf(s->avctx, \"filter mb:%d/%d dir:%d edge:%d, QPy:%d ls:%d uvls:%d\", mb_x, mb_y, dir, edge, qp, linesize, uvlinesize);",
          "new_line_content": "        //tprintf(s->avctx, \"filter mb:%d/%d dir:%d edge:%d, QPy:%d, QPc:%d, QPcn:%d\\n\", mb_x, mb_y, dir, edge, qp, h->chroma_qp[0], s->current_picture.qscale_table[mbn_xy]);",
          "content_same": false
        },
        {
          "line": 461,
          "old_api": "IS_INTRA",
          "new_api": null,
          "old_text": "IS_INTRA(mb_type|s->current_picture.mb_type[mbn_xy])",
          "new_text": null,
          "old_line_content": "            if( IS_INTRA(mb_type|s->current_picture.mb_type[mbn_xy]) ) {",
          "new_line_content": "            int qp;",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": "filter_mb_edgev",
          "new_api": null,
          "old_text": "filter_mb_edgev( h, &img_y[4*edge], linesize, bS, qp )",
          "new_text": null,
          "old_line_content": "            filter_mb_edgev( h, &img_y[4*edge], linesize, bS, qp );",
          "new_line_content": "        if( dir == 0 ) {",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": "get_chroma_qp",
          "new_api": null,
          "old_text": "get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] )",
          "new_text": null,
          "old_line_content": "                int qp= ( h->chroma_qp[0] + get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1;",
          "new_line_content": "            if( (edge&1) == 0 ) {",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "get_chroma_qp",
          "new_api": null,
          "old_text": "get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] )",
          "new_text": null,
          "old_line_content": "                    qp= ( h->chroma_qp[1] + get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1;",
          "new_line_content": "                if(h->pps.chroma_qp_diff)",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": "filter_mb_edgeh",
          "new_api": null,
          "old_text": "filter_mb_edgeh( h, &img_y[4*edge*linesize], linesize, bS, qp )",
          "new_text": null,
          "old_line_content": "            filter_mb_edgeh( h, &img_y[4*edge*linesize], linesize, bS, qp );",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": "tprintf",
          "new_api": null,
          "old_text": "tprintf(s->avctx, \"filter mb:%d/%d dir:%d edge:%d, QPy:%d ls:%d uvls:%d\", mb_x, mb_y, dir, edge, qp, tmp_linesize, tmp_uvlinesize)",
          "new_text": null,
          "old_line_content": "            tprintf(s->avctx, \"filter mb:%d/%d dir:%d edge:%d, QPy:%d ls:%d uvls:%d\", mb_x, mb_y, dir, edge, qp, tmp_linesize, tmp_uvlinesize);",
          "new_line_content": "            qp = ( s->current_picture.qscale_table[mb_xy] + s->current_picture.qscale_table[mbn_xy] + 1 ) >> 1;",
          "content_same": false
        },
        {
          "line": 603,
          "old_api": "get_chroma_qp",
          "new_api": null,
          "old_text": "get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] )",
          "new_text": null,
          "old_line_content": "                int qp= ( h->chroma_qp[0] + get_chroma_qp( h, 0, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1;",
          "new_line_content": "            if( (edge&1) == 0 ) {",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": "get_chroma_qp",
          "new_api": null,
          "old_text": "get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] )",
          "new_text": null,
          "old_line_content": "                    qp= ( h->chroma_qp[1] + get_chroma_qp( h, 1, s->current_picture.qscale_table[mbn_xy] ) + 1 ) >> 1;",
          "new_line_content": "                if(h->pps.chroma_qp_diff)",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": "IS_INTERLACED",
          "new_api": null,
          "old_text": "IS_INTERLACED(mb_type)",
          "new_text": null,
          "old_line_content": "    const int mvy_limit = IS_INTERLACED(mb_type) ? 2 : 4;",
          "new_line_content": "    const int mb_type = s->current_picture.mb_type[mb_xy];",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": "IS_8x8DCT",
          "new_api": null,
          "old_text": "IS_8x8DCT(mb_type)",
          "new_text": null,
          "old_line_content": "        if( (edge&1) && IS_8x8DCT(mb_type) )",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": "IS_INTRA",
          "new_api": null,
          "old_text": "IS_INTRA(mb_type|mbn_type)",
          "new_text": null,
          "old_line_content": "        if( IS_INTRA(mb_type|mbn_type)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 626,
          "old_api": "IS_INTERLACED",
          "new_api": null,
          "old_text": "IS_INTERLACED(mb_type^s->current_picture.mb_type[mb_xy-1])",
          "new_text": null,
          "old_line_content": "            && IS_INTERLACED(mb_type^s->current_picture.mb_type[mb_xy-1])",
          "new_line_content": "            // and current and left pair do not have the same interlaced type",
          "content_same": false
        },
        {
          "line": 499,
          "old_api": "IS_INTERLACED",
          "new_api": null,
          "old_text": "IS_INTERLACED(mb_type|mbm_type)",
          "new_text": null,
          "old_line_content": "                if (   (!IS_INTERLACED(mb_type|mbm_type))",
          "new_line_content": "            if (edge == 0) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 13,
      "total_additions": 30,
      "total_deletions": 30,
      "total_api_changes": 73
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 73,
        "non_api_lines": 3,
        "non_api_line_numbers": [
          437,
          438,
          439
        ]
      }
    },
    "api_calls_before": 144,
    "api_calls_after": 144,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 2,
      "total_diff_lines": 17
    }
  }
}