{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/669bbedfa863f8a1491a186fac4238baba407037",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/669bbedfa863f8a1491a186fac4238baba407037/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/669bbedfa863f8a1491a186fac4238baba407037/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/669bbedfa863f8a1491a186fac4238baba407037/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 410,
          "old_api": "av_blowfish_crypt_ecb",
          "new_api": "AV_RB32",
          "old_text": "av_blowfish_crypt_ecb(ctx, &v0, &v1, decrypt)",
          "new_text": "AV_RB32(dst + 4)",
          "old_line_content": "            av_blowfish_crypt_ecb(ctx, &v0, &v1, decrypt);",
          "new_line_content": "                v1 = AV_RB32(dst + 4);",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": "AV_WB32",
          "new_api": "AV_RB32",
          "old_text": "AV_WB32(dst, v0)",
          "new_text": "AV_RB32(src)",
          "old_line_content": "            AV_WB32(dst, v0);",
          "new_line_content": "                v0 = AV_RB32(src);",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": "AV_WB32",
          "new_api": "AV_RB32",
          "old_text": "AV_WB32(dst + 4, v1)",
          "new_text": "AV_RB32(src + 4)",
          "old_line_content": "            AV_WB32(dst + 4, v1);",
          "new_line_content": "                v1 = AV_RB32(src + 4);",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": "memcpy",
          "new_api": "av_blowfish_crypt_ecb",
          "old_text": "memcpy(iv, dst, 8)",
          "new_text": "av_blowfish_crypt_ecb(ctx, &v0, &v1, decrypt)",
          "old_line_content": "                memcpy(iv, dst, 8);",
          "new_line_content": "            av_blowfish_crypt_ecb(ctx, &v0, &v1, decrypt);",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": "memcpy",
          "new_api": "av_blowfish_crypt",
          "old_text": "memcpy(tmptext_l, plaintext_l, sizeof(*plaintext_l) * NUM_VARIABLE_KEY_TESTS)",
          "new_text": "av_blowfish_crypt(&ctx, tmp, ciphertext, 1, NULL, 1)",
          "old_line_content": "    memcpy(tmptext_l, plaintext_l, sizeof(*plaintext_l) * NUM_VARIABLE_KEY_TESTS);",
          "new_line_content": "    av_blowfish_crypt(&ctx, tmp, ciphertext, 1, NULL, 1);",
          "content_same": false
        },
        {
          "line": 544,
          "old_api": "memcpy",
          "new_api": "memcmp",
          "old_text": "memcpy(tmptext_r, plaintext_r, sizeof(*plaintext_r) * NUM_VARIABLE_KEY_TESTS)",
          "new_text": "memcmp(tmp, plaintext, 8)",
          "old_line_content": "    memcpy(tmptext_r, plaintext_r, sizeof(*plaintext_r) * NUM_VARIABLE_KEY_TESTS);",
          "new_line_content": "    if (memcmp(tmp, plaintext, 8)) {",
          "content_same": false
        },
        {
          "line": 549,
          "old_api": "av_blowfish_crypt_ecb",
          "new_api": "memcpy",
          "old_text": "av_blowfish_crypt_ecb(&ctx, &tmptext_l[i], &tmptext_r[i], 0)",
          "new_text": "memcpy(tmptext_l, plaintext_l, sizeof(*plaintext_l) * NUM_VARIABLE_KEY_TESTS)",
          "old_line_content": "        av_blowfish_crypt_ecb(&ctx, &tmptext_l[i], &tmptext_r[i], 0);",
          "new_line_content": "    memcpy(tmptext_l, plaintext_l, sizeof(*plaintext_l) * NUM_VARIABLE_KEY_TESTS);",
          "content_same": false
        },
        {
          "line": 561,
          "old_api": "printf",
          "new_api": "av_blowfish_crypt_ecb",
          "old_text": "printf(\"Test encryption/decryption success.\\n\")",
          "new_text": "av_blowfish_crypt_ecb(&ctx, &tmptext_l[i], &tmptext_r[i], 1)",
          "old_line_content": "    printf(\"Test encryption/decryption success.\\n\");",
          "new_line_content": "        av_blowfish_crypt_ecb(&ctx, &tmptext_l[i], &tmptext_r[i], 1);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 545,
          "old_api": null,
          "new_api": "printf",
          "old_text": null,
          "new_text": "printf(\"Test decryption failed.\\n\")",
          "old_line_content": "",
          "new_line_content": "        printf(\"Test decryption failed.\\n\");",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": null,
          "new_api": "AV_WB32",
          "old_text": null,
          "new_text": "AV_WB32(dst, v0)",
          "old_line_content": "",
          "new_line_content": "            AV_WB32(dst, v0);",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": null,
          "new_api": "AV_WB32",
          "old_text": null,
          "new_text": "AV_WB32(dst + 4, v1)",
          "old_line_content": "        src   += 8;",
          "new_line_content": "            AV_WB32(dst + 4, v1);",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": null,
          "new_api": "printf",
          "old_text": null,
          "new_text": "printf(\"Test encryption/decryption success.\\n\")",
          "old_line_content": "",
          "new_line_content": "    printf(\"Test encryption/decryption success.\\n\");",
          "content_same": false
        },
        {
          "line": 422,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(iv, dst, 8)",
          "old_line_content": "    }",
          "new_line_content": "                memcpy(iv, dst, 8);",
          "content_same": false
        },
        {
          "line": 550,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(tmptext_r, plaintext_r, sizeof(*plaintext_r) * NUM_VARIABLE_KEY_TESTS)",
          "old_line_content": "        if (tmptext_l[i] != ciphertext_l[i] || tmptext_r[i] != ciphertext_r[i]) {",
          "new_line_content": "    memcpy(tmptext_r, plaintext_r, sizeof(*plaintext_r) * NUM_VARIABLE_KEY_TESTS);",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": null,
          "new_api": "av_blowfish_init",
          "old_text": null,
          "new_text": "av_blowfish_init(&ctx, variable_key[i], 8)",
          "old_line_content": "        }",
          "new_line_content": "        av_blowfish_init(&ctx, variable_key[i], 8);",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": null,
          "new_api": "printf",
          "old_text": null,
          "new_text": "printf(\"Test decryption failed.\\n\")",
          "old_line_content": "    return 0;",
          "new_line_content": "            printf(\"Test decryption failed.\\n\");",
          "content_same": false
        },
        {
          "line": 535,
          "old_api": null,
          "new_api": "av_blowfish_init",
          "old_text": null,
          "new_text": "av_blowfish_init(&ctx, \"abcdefghijklmnopqrstuvwxyz\", 26)",
          "old_line_content": "    }",
          "new_line_content": "    av_blowfish_init(&ctx, \"abcdefghijklmnopqrstuvwxyz\", 26);",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": null,
          "new_api": "AV_RB32",
          "old_text": null,
          "new_text": "AV_RB32(dst)",
          "old_line_content": "",
          "new_line_content": "                v0 = AV_RB32(dst);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 547,
          "old_api": "av_blowfish_init",
          "new_api": null,
          "old_text": "av_blowfish_init(&ctx, variable_key[i], 8)",
          "new_text": null,
          "old_line_content": "        av_blowfish_init(&ctx, variable_key[i], 8);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": "printf",
          "new_api": null,
          "old_text": "printf(\"Test encryption failed.\\n\")",
          "new_text": null,
          "old_line_content": "            printf(\"Test encryption failed.\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 529,
          "old_api": "av_blowfish_init",
          "new_api": null,
          "old_text": "av_blowfish_init(&ctx, \"abcdefghijklmnopqrstuvwxyz\", 26)",
          "new_text": null,
          "old_line_content": "    av_blowfish_init(&ctx, \"abcdefghijklmnopqrstuvwxyz\", 26);",
          "new_line_content": "    AVBlowfish ctx;",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": "av_blowfish_crypt",
          "new_api": null,
          "old_text": "av_blowfish_crypt(&ctx, tmp, plaintext, 1, NULL, 0)",
          "new_text": null,
          "old_line_content": "    av_blowfish_crypt(&ctx, tmp, plaintext, 1, NULL, 0);",
          "new_line_content": "    uint32_t tmptext_r[NUM_VARIABLE_KEY_TESTS];",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": "AV_RB32",
          "new_api": null,
          "old_text": "AV_RB32(dst)",
          "new_text": null,
          "old_line_content": "                v0 = AV_RB32(dst);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 404,
          "old_api": "AV_RB32",
          "new_api": null,
          "old_text": "AV_RB32(dst + 4)",
          "new_text": null,
          "old_line_content": "                v1 = AV_RB32(dst + 4);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": "AV_RB32",
          "new_api": null,
          "old_text": "AV_RB32(src)",
          "new_text": null,
          "old_line_content": "                v0 = AV_RB32(src);",
          "new_line_content": "            if (iv) {",
          "content_same": false
        },
        {
          "line": 407,
          "old_api": "AV_RB32",
          "new_api": null,
          "old_text": "AV_RB32(src + 4)",
          "new_text": null,
          "old_line_content": "                v1 = AV_RB32(src + 4);",
          "new_line_content": "                for (i = 0; i < 8; i++)",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(tmp, ciphertext, 8)",
          "new_text": null,
          "old_line_content": "    if (memcmp(tmp, ciphertext, 8)) {",
          "new_line_content": "    uint8_t tmp[8];",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": "printf",
          "new_api": null,
          "old_text": "printf(\"Test encryption failed.\\n\")",
          "new_text": null,
          "old_line_content": "        printf(\"Test encryption failed.\\n\");",
          "new_line_content": "    int i;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 8,
      "total_additions": 10,
      "total_deletions": 10,
      "total_api_changes": 28
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 17,
        "api_related_lines": 28,
        "non_api_lines": 14,
        "non_api_line_numbers": [
          384,
          385,
          417,
          420,
          421,
          424,
          425,
          426,
          427,
          399,
          400,
          401,
          402,
          405
        ]
      }
    },
    "api_calls_before": 34,
    "api_calls_after": 34,
    "diff_info": {
      "added_lines": 13,
      "removed_lines": 7,
      "total_diff_lines": 47
    }
  }
}