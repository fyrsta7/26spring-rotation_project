{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/9be52d48d9137e05361dd1ffb6b1fb3677e1fb47",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/9be52d48d9137e05361dd1ffb6b1fb3677e1fb47/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/9be52d48d9137e05361dd1ffb6b1fb3677e1fb47/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/9be52d48d9137e05361dd1ffb6b1fb3677e1fb47/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 745,
          "old_api": "ff_ac3_bit_alloc_calc_mask",
          "new_api": "ff_ac3_bit_alloc_calc_psd",
          "old_text": "ff_ac3_bit_alloc_calc_mask(&s->bit_alloc, block->band_psd[ch],\n                                           0, s->nb_coefs[ch],\n                                           ff_ac3_fast_gain_tab[s->fast_gain_code[ch]],\n                                           ch == s->lfe_channel,\n                                           DBA_NONE, 0, NULL, NULL, NULL,\n                                           block->mask[ch])",
          "new_text": "ff_ac3_bit_alloc_calc_psd(block->exp[ch], 0,\n                                          s->nb_coefs[ch],\n                                          block->psd[ch], block->band_psd[ch])",
          "old_line_content": "                ff_ac3_bit_alloc_calc_mask(&s->bit_alloc, block->band_psd[ch],",
          "new_line_content": "                ff_ac3_bit_alloc_calc_psd(block->exp[ch], 0,",
          "content_same": false
        },
        {
          "line": 946,
          "old_api": "downgrade_exponents",
          "new_api": "cbr_bit_allocation",
          "old_text": "downgrade_exponents(s)",
          "new_text": "cbr_bit_allocation(s)",
          "old_line_content": "        if (!downgrade_exponents(s)) {",
          "new_line_content": "    ret = cbr_bit_allocation(s);",
          "content_same": false
        },
        {
          "line": 949,
          "old_api": "group_exponents",
          "new_api": "downgrade_exponents",
          "old_text": "group_exponents(s)",
          "new_text": "downgrade_exponents(s)",
          "old_line_content": "            group_exponents(s);",
          "new_line_content": "        if (!downgrade_exponents(s)) {",
          "content_same": false
        },
        {
          "line": 950,
          "old_api": "compute_bit_allocation",
          "new_api": "extract_exponents",
          "old_text": "compute_bit_allocation(s)",
          "new_text": "extract_exponents(s)",
          "old_line_content": "            ret = compute_bit_allocation(s);",
          "new_line_content": "            extract_exponents(s);",
          "content_same": false
        },
        {
          "line": 1094,
          "old_api": "asym_quant",
          "new_api": "sym_quant",
          "old_text": "asym_quant(c, e, 14)",
          "new_text": "sym_quant(c, e, 15)",
          "old_line_content": "            v = asym_quant(c, e, 14);",
          "new_line_content": "            v = sym_quant(c, e, 15);",
          "content_same": false
        },
        {
          "line": 1330,
          "old_api": "assert",
          "new_api": "flush_put_bits",
          "old_text": "assert(pad_bytes >= 0)",
          "new_text": "flush_put_bits(&s->pb)",
          "old_line_content": "    assert(pad_bytes >= 0);",
          "new_line_content": "    flush_put_bits(&s->pb);",
          "content_same": false
        },
        {
          "line": 1339,
          "old_api": "AV_WB16",
          "new_api": "av_crc",
          "old_text": "AV_WB16(frame + 2, crc1)",
          "new_text": "av_crc(crc_ctx, 0, frame + 4, frame_size_58 - 4)",
          "old_line_content": "    AV_WB16(frame + 2, crc1);",
          "new_line_content": "    crc1    = av_bswap16(av_crc(crc_ctx, 0, frame + 4, frame_size_58 - 4));",
          "content_same": false
        },
        {
          "line": 1342,
          "old_api": "av_crc",
          "new_api": "AV_WB16",
          "old_text": "av_crc(crc_ctx, 0, frame + frame_size_58,\n                          s->frame_size - frame_size_58 - 3)",
          "new_text": "AV_WB16(frame + 2, crc1)",
          "old_line_content": "    crc2_partial = av_crc(crc_ctx, 0, frame + frame_size_58,",
          "new_line_content": "    AV_WB16(frame + 2, crc1);",
          "content_same": false
        },
        {
          "line": 1351,
          "old_api": "AV_WB16",
          "new_api": "av_crc",
          "old_text": "AV_WB16(frame + s->frame_size - 2, crc2)",
          "new_text": "av_crc(crc_ctx, crc2_partial, frame + s->frame_size - 3, 1)",
          "old_line_content": "    AV_WB16(frame + s->frame_size - 2, crc2);",
          "new_line_content": "        crc2 = av_crc(crc_ctx, crc2_partial, frame + s->frame_size - 3, 1);",
          "content_same": false
        },
        {
          "line": 1367,
          "old_api": "output_audio_block",
          "new_api": "output_frame_header",
          "old_text": "output_audio_block(s, blk)",
          "new_text": "output_frame_header(s)",
          "old_line_content": "        output_audio_block(s, blk);",
          "new_line_content": "    output_frame_header(s);",
          "content_same": false
        },
        {
          "line": 1438,
          "old_api": "mdct_end",
          "new_api": "av_freep",
          "old_text": "mdct_end(&s->mdct)",
          "new_text": "av_freep(&block->qmant)",
          "old_line_content": "    mdct_end(&s->mdct);",
          "new_line_content": "        av_freep(&block->qmant);",
          "content_same": false
        },
        {
          "line": 1459,
          "old_api": "avcodec_guess_channel_layout",
          "new_api": "AVERROR",
          "old_text": "avcodec_guess_channel_layout(channels, CODEC_ID_AC3, NULL)",
          "new_text": "AVERROR(EINVAL)",
          "old_line_content": "        ch_layout = avcodec_guess_channel_layout(channels, CODEC_ID_AC3, NULL);",
          "new_line_content": "        return AVERROR(EINVAL);",
          "content_same": false
        },
        {
          "line": 1586,
          "old_api": "FF_ALLOCZ_OR_GOTO",
          "new_api": "FF_ALLOC_OR_GOTO",
          "old_text": "FF_ALLOCZ_OR_GOTO(avctx, s->planar_samples[ch],\n                          (AC3_FRAME_SIZE+AC3_BLOCK_SIZE) * sizeof(**s->planar_samples),\n                          alloc_fail)",
          "new_text": "FF_ALLOC_OR_GOTO(avctx, s->planar_samples, s->channels * sizeof(*s->planar_samples),\n                     alloc_fail)",
          "old_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, s->planar_samples[ch],",
          "new_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->planar_samples, s->channels * sizeof(*s->planar_samples),",
          "content_same": false
        },
        {
          "line": 1677,
          "old_api": "set_bandwidth",
          "new_api": "pow_poly",
          "old_text": "set_bandwidth(s)",
          "new_text": "pow_poly((CRC16_POLY >> 1), (8 * frame_size_58) - 16, CRC16_POLY)",
          "old_line_content": "    set_bandwidth(s);",
          "new_line_content": "        s->crc_inv[1] = pow_poly((CRC16_POLY >> 1), (8 * frame_size_58) - 16, CRC16_POLY);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1539,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"invalid cutoff frequency\\n\")",
          "old_line_content": "    s->cutoff = avctx->cutoff;",
          "new_line_content": "        av_log(avctx, AV_LOG_ERROR, \"invalid cutoff frequency\\n\");",
          "content_same": false
        },
        {
          "line": 1028,
          "old_api": null,
          "new_api": "SCALE_COEF",
          "old_text": null,
          "new_text": "SCALE_COEF(mdct_coef[i])",
          "old_line_content": "        switch (b) {",
          "new_line_content": "        int c = SCALE_COEF(mdct_coef[i]);",
          "content_same": false
        },
        {
          "line": 1540,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(EINVAL)",
          "old_line_content": "    if (s->cutoff > (s->sample_rate >> 1))",
          "new_line_content": "        return AVERROR(EINVAL);",
          "content_same": false
        },
        {
          "line": 1036,
          "old_api": null,
          "new_api": "sym_quant",
          "old_text": null,
          "new_text": "sym_quant(c, e, 3)",
          "old_line_content": "                s->qmant1_ptr = &qmant[i];",
          "new_line_content": "            v = sym_quant(c, e, 3);",
          "content_same": false
        },
        {
          "line": 1563,
          "old_api": null,
          "new_api": "av_clip",
          "old_text": null,
          "new_text": "av_clip((fbw_coeffs - 73) / 3, 0, 60)",
          "old_line_content": "        /* XXX: should compute the bandwidth according to the frame",
          "new_line_content": "        bw_code        = av_clip((fbw_coeffs - 73) / 3, 0, 60);",
          "content_same": false
        },
        {
          "line": 1056,
          "old_api": null,
          "new_api": "sym_quant",
          "old_text": null,
          "new_text": "sym_quant(c, e, 5)",
          "old_line_content": "                s->qmant2_ptr = &qmant[i];",
          "new_line_content": "            v = sym_quant(c, e, 5);",
          "content_same": false
        },
        {
          "line": 1589,
          "old_api": null,
          "new_api": "FF_ALLOCZ_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOCZ_OR_GOTO(avctx, s->planar_samples[ch],\n                          (AC3_FRAME_SIZE+AC3_BLOCK_SIZE) * sizeof(**s->planar_samples),\n                          alloc_fail)",
          "old_line_content": "    }",
          "new_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, s->planar_samples[ch],",
          "content_same": false
        },
        {
          "line": 1079,
          "old_api": null,
          "new_api": "sym_quant",
          "old_text": null,
          "new_text": "sym_quant(c, e, 11)",
          "old_line_content": "                s->qmant4_ptr = &qmant[i];",
          "new_line_content": "            v = sym_quant(c, e, 11);",
          "content_same": false
        },
        {
          "line": 568,
          "old_api": null,
          "new_api": "extract_exponents",
          "old_text": null,
          "new_text": "extract_exponents(s)",
          "old_line_content": "",
          "new_line_content": "    extract_exponents(s);",
          "content_same": false
        },
        {
          "line": 1593,
          "old_api": null,
          "new_api": "FF_ALLOC_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOC_OR_GOTO(avctx, s->bap_buffer,  AC3_MAX_BLOCKS * s->channels *\n                     AC3_MAX_COEFS * sizeof(*s->bap_buffer),  alloc_fail)",
          "old_line_content": "                     AC3_MAX_COEFS * sizeof(*s->bap1_buffer), alloc_fail);",
          "new_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->bap_buffer,  AC3_MAX_BLOCKS * s->channels *",
          "content_same": false
        },
        {
          "line": 570,
          "old_api": null,
          "new_api": "compute_exp_strategy",
          "old_text": null,
          "new_text": "compute_exp_strategy(s)",
          "old_line_content": "",
          "new_line_content": "    compute_exp_strategy(s);",
          "content_same": false
        },
        {
          "line": 1595,
          "old_api": null,
          "new_api": "FF_ALLOC_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOC_OR_GOTO(avctx, s->bap1_buffer, AC3_MAX_BLOCKS * s->channels *\n                     AC3_MAX_COEFS * sizeof(*s->bap1_buffer), alloc_fail)",
          "old_line_content": "                     AC3_MAX_COEFS * sizeof(*s->mdct_coef_buffer), alloc_fail);",
          "new_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->bap1_buffer, AC3_MAX_BLOCKS * s->channels *",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": null,
          "new_api": "encode_exponents",
          "old_text": null,
          "new_text": "encode_exponents(s)",
          "old_line_content": "}",
          "new_line_content": "    encode_exponents(s);",
          "content_same": false
        },
        {
          "line": 1597,
          "old_api": null,
          "new_api": "FF_ALLOC_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOC_OR_GOTO(avctx, s->mdct_coef_buffer, AC3_MAX_BLOCKS * s->channels *\n                     AC3_MAX_COEFS * sizeof(*s->mdct_coef_buffer), alloc_fail)",
          "old_line_content": "                     AC3_MAX_COEFS * sizeof(*s->exp_buffer), alloc_fail);",
          "new_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->mdct_coef_buffer, AC3_MAX_BLOCKS * s->channels *",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": null,
          "new_api": "group_exponents",
          "old_text": null,
          "new_text": "group_exponents(s)",
          "old_line_content": "",
          "new_line_content": "    group_exponents(s);",
          "content_same": false
        },
        {
          "line": 1599,
          "old_api": null,
          "new_api": "FF_ALLOC_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOC_OR_GOTO(avctx, s->exp_buffer, AC3_MAX_BLOCKS * s->channels *\n                     AC3_MAX_COEFS * sizeof(*s->exp_buffer), alloc_fail)",
          "old_line_content": "                     128 * sizeof(*s->grouped_exp_buffer), alloc_fail);",
          "new_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->exp_buffer, AC3_MAX_BLOCKS * s->channels *",
          "content_same": false
        },
        {
          "line": 1601,
          "old_api": null,
          "new_api": "FF_ALLOC_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOC_OR_GOTO(avctx, s->grouped_exp_buffer, AC3_MAX_BLOCKS * s->channels *\n                     128 * sizeof(*s->grouped_exp_buffer), alloc_fail)",
          "old_line_content": "                     AC3_MAX_COEFS * sizeof(*s->psd_buffer), alloc_fail);",
          "new_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->grouped_exp_buffer, AC3_MAX_BLOCKS * s->channels *",
          "content_same": false
        },
        {
          "line": 1603,
          "old_api": null,
          "new_api": "FF_ALLOC_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOC_OR_GOTO(avctx, s->psd_buffer, AC3_MAX_BLOCKS * s->channels *\n                     AC3_MAX_COEFS * sizeof(*s->psd_buffer), alloc_fail)",
          "old_line_content": "                     64 * sizeof(*s->band_psd_buffer), alloc_fail);",
          "new_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->psd_buffer, AC3_MAX_BLOCKS * s->channels *",
          "content_same": false
        },
        {
          "line": 1605,
          "old_api": null,
          "new_api": "FF_ALLOC_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOC_OR_GOTO(avctx, s->band_psd_buffer, AC3_MAX_BLOCKS * s->channels *\n                     64 * sizeof(*s->band_psd_buffer), alloc_fail)",
          "old_line_content": "                     64 * sizeof(*s->mask_buffer), alloc_fail);",
          "new_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->band_psd_buffer, AC3_MAX_BLOCKS * s->channels *",
          "content_same": false
        },
        {
          "line": 1607,
          "old_api": null,
          "new_api": "FF_ALLOC_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOC_OR_GOTO(avctx, s->mask_buffer, AC3_MAX_BLOCKS * s->channels *\n                     64 * sizeof(*s->mask_buffer), alloc_fail)",
          "old_line_content": "                     AC3_MAX_COEFS * sizeof(*s->qmant_buffer), alloc_fail);",
          "new_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->mask_buffer, AC3_MAX_BLOCKS * s->channels *",
          "content_same": false
        },
        {
          "line": 1609,
          "old_api": null,
          "new_api": "FF_ALLOC_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOC_OR_GOTO(avctx, s->qmant_buffer, AC3_MAX_BLOCKS * s->channels *\n                     AC3_MAX_COEFS * sizeof(*s->qmant_buffer), alloc_fail)",
          "old_line_content": "        AC3Block *block = &s->blocks[blk];",
          "new_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->qmant_buffer, AC3_MAX_BLOCKS * s->channels *",
          "content_same": false
        },
        {
          "line": 1613,
          "old_api": null,
          "new_api": "FF_ALLOC_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOC_OR_GOTO(avctx, block->bap, s->channels * sizeof(*block->bap),\n                         alloc_fail)",
          "old_line_content": "                          alloc_fail);",
          "new_line_content": "        FF_ALLOC_OR_GOTO(avctx, block->bap, s->channels * sizeof(*block->bap),",
          "content_same": false
        },
        {
          "line": 1103,
          "old_api": null,
          "new_api": "asym_quant",
          "old_text": null,
          "new_text": "asym_quant(c, e, b - 1)",
          "old_line_content": "        qmant[i] = v;",
          "new_line_content": "            v = asym_quant(c, e, b - 1);",
          "content_same": false
        },
        {
          "line": 1615,
          "old_api": null,
          "new_api": "FF_ALLOCZ_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOCZ_OR_GOTO(avctx, block->mdct_coef, s->channels * sizeof(*block->mdct_coef),\n                          alloc_fail)",
          "old_line_content": "                          alloc_fail);",
          "new_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->mdct_coef, s->channels * sizeof(*block->mdct_coef),",
          "content_same": false
        },
        {
          "line": 1617,
          "old_api": null,
          "new_api": "FF_ALLOCZ_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOCZ_OR_GOTO(avctx, block->exp, s->channels * sizeof(*block->exp),\n                          alloc_fail)",
          "old_line_content": "                          alloc_fail);",
          "new_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->exp, s->channels * sizeof(*block->exp),",
          "content_same": false
        },
        {
          "line": 1619,
          "old_api": null,
          "new_api": "FF_ALLOCZ_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOCZ_OR_GOTO(avctx, block->grouped_exp, s->channels * sizeof(*block->grouped_exp),\n                          alloc_fail)",
          "old_line_content": "                          alloc_fail);",
          "new_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->grouped_exp, s->channels * sizeof(*block->grouped_exp),",
          "content_same": false
        },
        {
          "line": 1621,
          "old_api": null,
          "new_api": "FF_ALLOCZ_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOCZ_OR_GOTO(avctx, block->psd, s->channels * sizeof(*block->psd),\n                          alloc_fail)",
          "old_line_content": "                          alloc_fail);",
          "new_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->psd, s->channels * sizeof(*block->psd),",
          "content_same": false
        },
        {
          "line": 1623,
          "old_api": null,
          "new_api": "FF_ALLOCZ_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOCZ_OR_GOTO(avctx, block->band_psd, s->channels * sizeof(*block->band_psd),\n                          alloc_fail)",
          "old_line_content": "                          alloc_fail);",
          "new_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->band_psd, s->channels * sizeof(*block->band_psd),",
          "content_same": false
        },
        {
          "line": 1625,
          "old_api": null,
          "new_api": "FF_ALLOCZ_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOCZ_OR_GOTO(avctx, block->mask, s->channels * sizeof(*block->mask),\n                          alloc_fail)",
          "old_line_content": "                          alloc_fail);",
          "new_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->mask, s->channels * sizeof(*block->mask),",
          "content_same": false
        },
        {
          "line": 1627,
          "old_api": null,
          "new_api": "FF_ALLOCZ_OR_GOTO",
          "old_text": null,
          "new_text": "FF_ALLOCZ_OR_GOTO(avctx, block->qmant, s->channels * sizeof(*block->qmant),\n                          alloc_fail)",
          "old_line_content": "        for (ch = 0; ch < s->channels; ch++) {",
          "new_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->qmant, s->channels * sizeof(*block->qmant),",
          "content_same": false
        },
        {
          "line": 1125,
          "old_api": null,
          "new_api": "quantize_mantissas_blk_ch",
          "old_text": null,
          "new_text": "quantize_mantissas_blk_ch(s, block->mdct_coef[ch], block->exp_shift[ch],\n                                      block->exp[ch], block->bap[ch],\n                                      block->qmant[ch], s->nb_coefs[ch])",
          "old_line_content": "        }",
          "new_line_content": "            quantize_mantissas_blk_ch(s, block->mdct_coef[ch], block->exp_shift[ch],",
          "content_same": false
        },
        {
          "line": 1644,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "",
          "new_line_content": "    return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1142,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 5,  s->bitstream_id)",
          "old_line_content": "    if ((s->channel_mode & 0x01) && s->channel_mode != AC3_CHMODE_MONO)",
          "new_line_content": "    put_bits(&s->pb, 5,  s->bitstream_id);",
          "content_same": false
        },
        {
          "line": 1144,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 3,  s->channel_mode)",
          "old_line_content": "    if (s->channel_mode & 0x04)",
          "new_line_content": "    put_bits(&s->pb, 3,  s->channel_mode);",
          "content_same": false
        },
        {
          "line": 1658,
          "old_api": null,
          "new_api": "ac3_common_init",
          "old_text": null,
          "new_text": "ac3_common_init()",
          "old_line_content": "    if (ret)",
          "new_line_content": "    ac3_common_init();",
          "content_same": false
        },
        {
          "line": 1146,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 2, 1)",
          "old_line_content": "    if (s->channel_mode == AC3_CHMODE_STEREO)",
          "new_line_content": "        put_bits(&s->pb, 2, 1);     /* XXX -4.5 dB */",
          "content_same": false
        },
        {
          "line": 1660,
          "old_api": null,
          "new_api": "validate_options",
          "old_text": null,
          "new_text": "validate_options(avctx, s)",
          "old_line_content": "",
          "new_line_content": "    ret = validate_options(avctx, s);",
          "content_same": false
        },
        {
          "line": 1158,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 1, 0)",
          "old_line_content": "}",
          "new_line_content": "    put_bits(&s->pb, 1, 0);         /* no time code 1 */",
          "content_same": false
        },
        {
          "line": 1159,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 1, 0)",
          "old_line_content": "",
          "new_line_content": "    put_bits(&s->pb, 1, 0);         /* no time code 2 */",
          "content_same": false
        },
        {
          "line": 1160,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 1, 0)",
          "old_line_content": "",
          "new_line_content": "    put_bits(&s->pb, 1, 0);         /* no additional bit stream info */",
          "content_same": false
        },
        {
          "line": 1680,
          "old_api": null,
          "new_api": "set_bandwidth",
          "old_text": null,
          "new_text": "set_bandwidth(s)",
          "old_line_content": "",
          "new_line_content": "    set_bandwidth(s);",
          "content_same": false
        },
        {
          "line": 1682,
          "old_api": null,
          "new_api": "exponent_init",
          "old_text": null,
          "new_text": "exponent_init(s)",
          "old_line_content": "",
          "new_line_content": "    exponent_init(s);",
          "content_same": false
        },
        {
          "line": 1684,
          "old_api": null,
          "new_api": "bit_alloc_init",
          "old_text": null,
          "new_text": "bit_alloc_init(s)",
          "old_line_content": "    if (ret)",
          "new_line_content": "    bit_alloc_init(s);",
          "content_same": false
        },
        {
          "line": 1174,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 1, 0)",
          "old_line_content": "    for (ch = 0; ch < s->fbw_channels; ch++)",
          "new_line_content": "        put_bits(&s->pb, 1, 0);",
          "content_same": false
        },
        {
          "line": 1686,
          "old_api": null,
          "new_api": "mdct_init",
          "old_text": null,
          "new_text": "mdct_init(avctx, &s->mdct, 9)",
          "old_line_content": "",
          "new_line_content": "    ret = mdct_init(avctx, &s->mdct, 9);",
          "content_same": false
        },
        {
          "line": 664,
          "old_api": null,
          "new_api": "count_frame_bits_fixed",
          "old_text": null,
          "new_text": "count_frame_bits_fixed(s)",
          "old_line_content": "",
          "new_line_content": "    count_frame_bits_fixed(s);",
          "content_same": false
        },
        {
          "line": 1690,
          "old_api": null,
          "new_api": "allocate_buffers",
          "old_text": null,
          "new_text": "allocate_buffers(avctx)",
          "old_line_content": "",
          "new_line_content": "    ret = allocate_buffers(avctx);",
          "content_same": false
        },
        {
          "line": 1181,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 1, 0)",
          "old_line_content": "    if (!block_num) {",
          "new_line_content": "    put_bits(&s->pb, 1, 0);",
          "content_same": false
        },
        {
          "line": 1694,
          "old_api": null,
          "new_api": "avcodec_alloc_frame",
          "old_text": null,
          "new_text": "avcodec_alloc_frame()",
          "old_line_content": "",
          "new_line_content": "    avctx->coded_frame= avcodec_alloc_frame();",
          "content_same": false
        },
        {
          "line": 1696,
          "old_api": null,
          "new_api": "dsputil_init",
          "old_text": null,
          "new_text": "dsputil_init(&s->dsp, avctx)",
          "old_line_content": "init_fail:",
          "new_line_content": "    dsputil_init(&s->dsp, avctx);",
          "content_same": false
        },
        {
          "line": 1186,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 1, 0)",
          "old_line_content": "    }",
          "new_line_content": "        put_bits(&s->pb, 1, 0); /* no coupling strategy */",
          "content_same": false
        },
        {
          "line": 1188,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 1, 0)",
          "old_line_content": "    /* stereo rematrixing */",
          "new_line_content": "        put_bits(&s->pb, 1, 0); /* no new coupling strategy */",
          "content_same": false
        },
        {
          "line": 1700,
          "old_api": null,
          "new_api": "ac3_encode_close",
          "old_text": null,
          "new_text": "ac3_encode_close(avctx)",
          "old_line_content": "",
          "new_line_content": "    ac3_encode_close(avctx);",
          "content_same": false
        },
        {
          "line": 1195,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 1, 1)",
          "old_line_content": "            for (rbnd = 0; rbnd < 4; rbnd++)",
          "new_line_content": "            put_bits(&s->pb, 1, 1);",
          "content_same": false
        },
        {
          "line": 1202,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 1, 0)",
          "old_line_content": "",
          "new_line_content": "            put_bits(&s->pb, 1, 0);",
          "content_same": false
        },
        {
          "line": 1208,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 2, block->exp_strategy[ch])",
          "old_line_content": "",
          "new_line_content": "        put_bits(&s->pb, 2, block->exp_strategy[ch]);",
          "content_same": false
        },
        {
          "line": 1210,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 1, block->exp_strategy[s->lfe_channel])",
          "old_line_content": "    for (ch = 0; ch < s->fbw_channels; ch++) {",
          "new_line_content": "        put_bits(&s->pb, 1, block->exp_strategy[s->lfe_channel]);",
          "content_same": false
        },
        {
          "line": 1215,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 6, s->bandwidth_code[ch])",
          "old_line_content": "    /* exponents */",
          "new_line_content": "            put_bits(&s->pb, 6, s->bandwidth_code[ch]);",
          "content_same": false
        },
        {
          "line": 1226,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 4, block->grouped_exp[ch][0])",
          "old_line_content": "        nb_groups = exponent_group_tab[block->exp_strategy[ch]-1][s->nb_coefs[ch]];",
          "new_line_content": "        put_bits(&s->pb, 4, block->grouped_exp[ch][0]);",
          "content_same": false
        },
        {
          "line": 1231,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 7, block->grouped_exp[ch][i])",
          "old_line_content": "        if (ch != s->lfe_channel)",
          "new_line_content": "            put_bits(&s->pb, 7, block->grouped_exp[ch][i]);",
          "content_same": false
        },
        {
          "line": 1235,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 2, 0)",
          "old_line_content": "    /* bit allocation info */",
          "new_line_content": "            put_bits(&s->pb, 2, 0);",
          "content_same": false
        },
        {
          "line": 1244,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 2, s->slow_gain_code)",
          "old_line_content": "    }",
          "new_line_content": "        put_bits(&s->pb, 2, s->slow_gain_code);",
          "content_same": false
        },
        {
          "line": 1245,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 2, s->db_per_bit_code)",
          "old_line_content": "",
          "new_line_content": "        put_bits(&s->pb, 2, s->db_per_bit_code);",
          "content_same": false
        },
        {
          "line": 1246,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 3, s->floor_code)",
          "old_line_content": "    /* snr offset */",
          "new_line_content": "        put_bits(&s->pb, 3, s->floor_code);",
          "content_same": false
        },
        {
          "line": 1250,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 1, baie)",
          "old_line_content": "        for (ch = 0; ch < s->channels; ch++) {",
          "new_line_content": "    put_bits(&s->pb, 1, baie);",
          "content_same": false
        },
        {
          "line": 1254,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 4, s->fine_snr_offset[ch])",
          "old_line_content": "    }",
          "new_line_content": "            put_bits(&s->pb, 4, s->fine_snr_offset[ch]);",
          "content_same": false
        },
        {
          "line": 1255,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 3, s->fast_gain_code[ch])",
          "old_line_content": "",
          "new_line_content": "            put_bits(&s->pb, 3, s->fast_gain_code[ch]);",
          "content_same": false
        },
        {
          "line": 1259,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 1, 0)",
          "old_line_content": "    /* mantissas */",
          "new_line_content": "    put_bits(&s->pb, 1, 0); /* no delta bit allocation */",
          "content_same": false
        },
        {
          "line": 748,
          "old_api": null,
          "new_api": "ff_ac3_bit_alloc_calc_mask",
          "old_text": null,
          "new_text": "ff_ac3_bit_alloc_calc_mask(&s->bit_alloc, block->band_psd[ch],\n                                           0, s->nb_coefs[ch],\n                                           ff_ac3_fast_gain_tab[s->fast_gain_code[ch]],\n                                           ch == s->lfe_channel,\n                                           DBA_NONE, 0, NULL, NULL, NULL,\n                                           block->mask[ch])",
          "old_line_content": "                                           ch == s->lfe_channel,",
          "new_line_content": "                ff_ac3_bit_alloc_calc_mask(&s->bit_alloc, block->band_psd[ch],",
          "content_same": false
        },
        {
          "line": 1260,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, 1, 0)",
          "old_line_content": "    for (ch = 0; ch < s->channels; ch++) {",
          "new_line_content": "    put_bits(&s->pb, 1, 0); /* no data to skip */",
          "content_same": false
        },
        {
          "line": 1274,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb,  14, q)",
          "old_line_content": "            }",
          "new_line_content": "            case 14:              put_bits(&s->pb,  14, q); break;",
          "content_same": false
        },
        {
          "line": 1275,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb,  16, q)",
          "old_line_content": "        }",
          "new_line_content": "            case 15:              put_bits(&s->pb,  16, q); break;",
          "content_same": false
        },
        {
          "line": 1276,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&s->pb, b-1, q)",
          "old_line_content": "    }",
          "new_line_content": "            default:              put_bits(&s->pb, b-1, q); break;",
          "content_same": false
        },
        {
          "line": 792,
          "old_api": null,
          "new_api": "reset_block_bap",
          "old_text": null,
          "new_text": "reset_block_bap(s)",
          "old_line_content": "        AC3Block *block = &s->blocks[blk];",
          "new_line_content": "    reset_block_bap(s);",
          "content_same": false
        },
        {
          "line": 1310,
          "old_api": null,
          "new_api": "mul_poly",
          "old_text": null,
          "new_text": "mul_poly(r, a, poly)",
          "old_line_content": "    }",
          "new_line_content": "            r = mul_poly(r, a, poly);",
          "content_same": false
        },
        {
          "line": 1311,
          "old_api": null,
          "new_api": "mul_poly",
          "old_text": null,
          "new_text": "mul_poly(a, a, poly)",
          "old_line_content": "    return r;",
          "new_line_content": "        a = mul_poly(a, a, poly);",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": null,
          "new_api": "SCALE_COEF",
          "old_text": null,
          "new_text": "SCALE_COEF(coef[i])",
          "old_line_content": "                else {",
          "new_line_content": "                int v = abs(SCALE_COEF(coef[i]));",
          "content_same": false
        },
        {
          "line": 808,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(block->bap[ch], s->blocks[blk-1].bap[ch], AC3_MAX_COEFS)",
          "old_line_content": "                                          s->nb_coefs[ch], snr_offset,",
          "new_line_content": "                memcpy(block->bap[ch], s->blocks[blk-1].bap[ch], AC3_MAX_COEFS);",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": null,
          "new_api": "av_log2",
          "old_text": null,
          "new_text": "av_log2(v)",
          "old_line_content": "                        block->mdct_coef[ch][i] = 0;",
          "new_line_content": "                    e = 23 - av_log2(v) + exp_shift;",
          "content_same": false
        },
        {
          "line": 810,
          "old_api": null,
          "new_api": "ff_ac3_bit_alloc_calc_bap",
          "old_text": null,
          "new_text": "ff_ac3_bit_alloc_calc_bap(block->mask[ch], block->psd[ch], 0,\n                                          s->nb_coefs[ch], snr_offset,\n                                          s->bit_alloc.floor, ff_ac3_bap_tab,\n                                          block->bap[ch])",
          "old_line_content": "                                          block->bap[ch]);",
          "new_line_content": "                ff_ac3_bit_alloc_calc_bap(block->mask[ch], block->psd[ch], 0,",
          "content_same": false
        },
        {
          "line": 1323,
          "old_api": null,
          "new_api": "av_crc_get_table",
          "old_text": null,
          "new_text": "av_crc_get_table(AV_CRC_16_ANSI)",
          "old_line_content": "",
          "new_line_content": "    const AVCRC *crc_ctx = av_crc_get_table(AV_CRC_16_ANSI);",
          "content_same": false
        },
        {
          "line": 815,
          "old_api": null,
          "new_api": "compute_mantissa_size",
          "old_text": null,
          "new_text": "compute_mantissa_size(mant_cnt, block->bap[ch], s->nb_coefs[ch])",
          "old_line_content": "    }",
          "new_line_content": "            mantissa_bits += compute_mantissa_size(mant_cnt, block->bap[ch], s->nb_coefs[ch]);",
          "content_same": false
        },
        {
          "line": 817,
          "old_api": null,
          "new_api": "compute_mantissa_size_final",
          "old_text": null,
          "new_text": "compute_mantissa_size_final(mant_cnt)",
          "old_line_content": "}",
          "new_line_content": "        mantissa_bits += compute_mantissa_size_final(mant_cnt);",
          "content_same": false
        },
        {
          "line": 1333,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(pad_bytes >= 0)",
          "old_line_content": "",
          "new_line_content": "    assert(pad_bytes >= 0);",
          "content_same": false
        },
        {
          "line": 1335,
          "old_api": null,
          "new_api": "put_bits_ptr",
          "old_text": null,
          "new_text": "put_bits_ptr(&s->pb)",
          "old_line_content": "    /* this is not so easy because it is at the beginning of the data... */",
          "new_line_content": "        memset(put_bits_ptr(&s->pb), 0, pad_bytes);",
          "content_same": false
        },
        {
          "line": 1341,
          "old_api": null,
          "new_api": "mul_poly",
          "old_text": null,
          "new_text": "mul_poly(crc_inv, crc1, CRC16_POLY)",
          "old_line_content": "    /* compute crc2 */",
          "new_line_content": "    crc1    = mul_poly(crc_inv, crc1, CRC16_POLY);",
          "content_same": false
        },
        {
          "line": 1345,
          "old_api": null,
          "new_api": "av_crc",
          "old_text": null,
          "new_text": "av_crc(crc_ctx, 0, frame + frame_size_58,\n                          s->frame_size - frame_size_58 - 3)",
          "old_line_content": "    /* ensure crc2 does not match sync word by flipping crcrsv bit if needed */",
          "new_line_content": "    crc2_partial = av_crc(crc_ctx, 0, frame + frame_size_58,",
          "content_same": false
        },
        {
          "line": 1347,
          "old_api": null,
          "new_api": "av_crc",
          "old_text": null,
          "new_text": "av_crc(crc_ctx, crc2_partial, frame + s->frame_size - 3, 1)",
          "old_line_content": "        frame[s->frame_size - 3] ^= 0x1;",
          "new_line_content": "    crc2 = av_crc(crc_ctx, crc2_partial, frame + s->frame_size - 3, 1);",
          "content_same": false
        },
        {
          "line": 840,
          "old_api": null,
          "new_api": "bit_alloc",
          "old_text": null,
          "new_text": "bit_alloc(s, 1023)",
          "old_line_content": "",
          "new_line_content": "        if (bit_alloc(s, 1023) <= bits_left)",
          "content_same": false
        },
        {
          "line": 1353,
          "old_api": null,
          "new_api": "av_bswap16",
          "old_text": null,
          "new_text": "av_bswap16(crc2)",
          "old_line_content": "",
          "new_line_content": "    crc2 = av_bswap16(crc2);",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": null,
          "new_api": "s->dsp.sad[0](NULL, exp[blk], exp[blk-1], 16, 16)",
          "old_text": null,
          "new_text": "s->dsp.sad[0](NULL, exp[blk], exp[blk-1], 16, 16)",
          "old_line_content": "        else",
          "new_line_content": "        exp_diff = s->dsp.sad[0](NULL, exp[blk], exp[blk-1], 16, 16);",
          "content_same": false
        },
        {
          "line": 1354,
          "old_api": null,
          "new_api": "AV_WB16",
          "old_text": null,
          "new_text": "AV_WB16(frame + s->frame_size - 2, crc2)",
          "old_line_content": "",
          "new_line_content": "    AV_WB16(frame + s->frame_size - 2, crc2);",
          "content_same": false
        },
        {
          "line": 845,
          "old_api": null,
          "new_api": "bit_alloc",
          "old_text": null,
          "new_text": "bit_alloc(s, snr_offset)",
          "old_line_content": "    if (snr_offset < 0)",
          "new_line_content": "           bit_alloc(s, snr_offset) > bits_left) {",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": null,
          "new_api": "emms_c",
          "old_text": null,
          "new_text": "emms_c()",
          "old_line_content": "       recoded, we use a coarse encoding */",
          "new_line_content": "    emms_c();",
          "content_same": false
        },
        {
          "line": 849,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(EINVAL)",
          "old_line_content": "    for (snr_incr = 64; snr_incr > 0; snr_incr >>= 2) {",
          "new_line_content": "        return AVERROR(EINVAL);",
          "content_same": false
        },
        {
          "line": 1365,
          "old_api": null,
          "new_api": "init_put_bits",
          "old_text": null,
          "new_text": "init_put_bits(&s->pb, frame, AC3_MAX_CODED_FRAME_SIZE)",
          "old_line_content": "",
          "new_line_content": "    init_put_bits(&s->pb, frame, AC3_MAX_CODED_FRAME_SIZE);",
          "content_same": false
        },
        {
          "line": 854,
          "old_api": null,
          "new_api": "bit_alloc",
          "old_text": null,
          "new_text": "bit_alloc(s, snr_offset + snr_incr)",
          "old_line_content": "        }",
          "new_line_content": "               bit_alloc(s, snr_offset + snr_incr) <= bits_left) {",
          "content_same": false
        },
        {
          "line": 1370,
          "old_api": null,
          "new_api": "output_audio_block",
          "old_text": null,
          "new_text": "output_audio_block(s, blk)",
          "old_line_content": "}",
          "new_line_content": "        output_audio_block(s, blk);",
          "content_same": false
        },
        {
          "line": 860,
          "old_api": null,
          "new_api": "reset_block_bap",
          "old_text": null,
          "new_text": "reset_block_bap(s)",
          "old_line_content": "    for (ch = 0; ch < s->channels; ch++)",
          "new_line_content": "    reset_block_bap(s);",
          "content_same": false
        },
        {
          "line": 1372,
          "old_api": null,
          "new_api": "output_frame_end",
          "old_text": null,
          "new_text": "output_frame_end(s)",
          "old_line_content": "",
          "new_line_content": "    output_frame_end(s);",
          "content_same": false
        },
        {
          "line": 1387,
          "old_api": null,
          "new_api": "adjust_frame_size",
          "old_text": null,
          "new_text": "adjust_frame_size(s)",
          "old_line_content": "",
          "new_line_content": "        adjust_frame_size(s);",
          "content_same": false
        },
        {
          "line": 1389,
          "old_api": null,
          "new_api": "deinterleave_input_samples",
          "old_text": null,
          "new_text": "deinterleave_input_samples(s, samples)",
          "old_line_content": "",
          "new_line_content": "    deinterleave_input_samples(s, samples);",
          "content_same": false
        },
        {
          "line": 1391,
          "old_api": null,
          "new_api": "apply_mdct",
          "old_text": null,
          "new_text": "apply_mdct(s)",
          "old_line_content": "",
          "new_line_content": "    apply_mdct(s);",
          "content_same": false
        },
        {
          "line": 1393,
          "old_api": null,
          "new_api": "process_exponents",
          "old_text": null,
          "new_text": "process_exponents(s)",
          "old_line_content": "    if (ret) {",
          "new_line_content": "    process_exponents(s);",
          "content_same": false
        },
        {
          "line": 1395,
          "old_api": null,
          "new_api": "compute_bit_allocation",
          "old_text": null,
          "new_text": "compute_bit_allocation(s)",
          "old_line_content": "        return ret;",
          "new_line_content": "    ret = compute_bit_allocation(s);",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": null,
          "new_api": "compute_exp_strategy_ch",
          "old_text": null,
          "new_text": "compute_exp_strategy_ch(s, exp_str1[ch], exp1[ch])",
          "old_line_content": "            s->blocks[blk].exp_strategy[ch] = exp_str1[ch][blk];",
          "new_line_content": "        compute_exp_strategy_ch(s, exp_str1[ch], exp1[ch]);",
          "content_same": false
        },
        {
          "line": 1397,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Bit allocation failed. Try increasing the bitrate.\\n\")",
          "old_line_content": "",
          "new_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Bit allocation failed. Try increasing the bitrate.\\n\");",
          "content_same": false
        },
        {
          "line": 1401,
          "old_api": null,
          "new_api": "quantize_mantissas",
          "old_text": null,
          "new_text": "quantize_mantissas(s)",
          "old_line_content": "",
          "new_line_content": "    quantize_mantissas(s);",
          "content_same": false
        },
        {
          "line": 1403,
          "old_api": null,
          "new_api": "output_frame",
          "old_text": null,
          "new_text": "output_frame(s, frame)",
          "old_line_content": "}",
          "new_line_content": "    output_frame(s, frame);",
          "content_same": false
        },
        {
          "line": 1426,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&s->band_psd_buffer)",
          "old_line_content": "    for (blk = 0; blk < AC3_MAX_BLOCKS; blk++) {",
          "new_line_content": "    av_freep(&s->band_psd_buffer);",
          "content_same": false
        },
        {
          "line": 1427,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&s->mask_buffer)",
          "old_line_content": "        AC3Block *block = &s->blocks[blk];",
          "new_line_content": "    av_freep(&s->mask_buffer);",
          "content_same": false
        },
        {
          "line": 1436,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&block->band_psd)",
          "old_line_content": "    }",
          "new_line_content": "        av_freep(&block->band_psd);",
          "content_same": false
        },
        {
          "line": 1437,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&block->mask)",
          "old_line_content": "",
          "new_line_content": "        av_freep(&block->mask);",
          "content_same": false
        },
        {
          "line": 1441,
          "old_api": null,
          "new_api": "mdct_end",
          "old_text": null,
          "new_text": "mdct_end(&s->mdct)",
          "old_line_content": "    return 0;",
          "new_line_content": "    mdct_end(&s->mdct);",
          "content_same": false
        },
        {
          "line": 1443,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&avctx->coded_frame)",
          "old_line_content": "",
          "new_line_content": "    av_freep(&avctx->coded_frame);",
          "content_same": false
        },
        {
          "line": 942,
          "old_api": null,
          "new_api": "count_frame_bits",
          "old_text": null,
          "new_text": "count_frame_bits(s)",
          "old_line_content": "",
          "new_line_content": "    count_frame_bits(s);",
          "content_same": false
        },
        {
          "line": 944,
          "old_api": null,
          "new_api": "bit_alloc_masking",
          "old_text": null,
          "new_text": "bit_alloc_masking(s)",
          "old_line_content": "    while (ret) {",
          "new_line_content": "    bit_alloc_masking(s);",
          "content_same": false
        },
        {
          "line": 1457,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(EINVAL)",
          "old_line_content": "    ch_layout = *channel_layout;",
          "new_line_content": "        return AVERROR(EINVAL);",
          "content_same": false
        },
        {
          "line": 1462,
          "old_api": null,
          "new_api": "avcodec_guess_channel_layout",
          "old_text": null,
          "new_text": "avcodec_guess_channel_layout(channels, CODEC_ID_AC3, NULL)",
          "old_line_content": "",
          "new_line_content": "        ch_layout = avcodec_guess_channel_layout(channels, CODEC_ID_AC3, NULL);",
          "content_same": false
        },
        {
          "line": 951,
          "old_api": null,
          "new_api": "encode_exponents",
          "old_text": null,
          "new_text": "encode_exponents(s)",
          "old_line_content": "            continue;",
          "new_line_content": "            encode_exponents(s);",
          "content_same": false
        },
        {
          "line": 952,
          "old_api": null,
          "new_api": "group_exponents",
          "old_text": null,
          "new_text": "group_exponents(s)",
          "old_line_content": "        }",
          "new_line_content": "            group_exponents(s);",
          "content_same": false
        },
        {
          "line": 953,
          "old_api": null,
          "new_api": "compute_bit_allocation",
          "old_text": null,
          "new_text": "compute_bit_allocation(s)",
          "old_line_content": "",
          "new_line_content": "            ret = compute_bit_allocation(s);",
          "content_same": false
        },
        {
          "line": 1463,
          "old_api": null,
          "new_api": "av_get_channel_layout_nb_channels",
          "old_text": null,
          "new_text": "av_get_channel_layout_nb_channels(ch_layout)",
          "old_line_content": "    s->lfe_on       = !!(ch_layout & AV_CH_LOW_FREQUENCY);",
          "new_line_content": "    if (av_get_channel_layout_nb_channels(ch_layout) != channels)",
          "content_same": false
        },
        {
          "line": 1464,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(EINVAL)",
          "old_line_content": "    s->channels     = channels;",
          "new_line_content": "        return AVERROR(EINVAL);",
          "content_same": false
        },
        {
          "line": 446,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(exp[i], exp[i+1] + 2)",
          "old_line_content": "    switch (exp_strategy) {",
          "new_line_content": "        exp[i] = FFMIN(exp[i], exp[i+1] + 2);",
          "content_same": false
        },
        {
          "line": 960,
          "old_api": null,
          "new_api": "reduce_bandwidth",
          "old_text": null,
          "new_text": "reduce_bandwidth(s, 0)",
          "old_line_content": "            continue;",
          "new_line_content": "        if (!s->cutoff && !reduce_bandwidth(s, 0)) {",
          "content_same": false
        },
        {
          "line": 961,
          "old_api": null,
          "new_api": "process_exponents",
          "old_text": null,
          "new_text": "process_exponents(s)",
          "old_line_content": "        }",
          "new_line_content": "            process_exponents(s);",
          "content_same": false
        },
        {
          "line": 962,
          "old_api": null,
          "new_api": "compute_bit_allocation",
          "old_text": null,
          "new_text": "compute_bit_allocation(s)",
          "old_line_content": "",
          "new_line_content": "            ret = compute_bit_allocation(s);",
          "content_same": false
        },
        {
          "line": 1484,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(EINVAL)",
          "old_line_content": "    s->channel_map  = ff_ac3_enc_channel_map[s->channel_mode][s->lfe_on];",
          "new_line_content": "        return AVERROR(EINVAL);",
          "content_same": false
        },
        {
          "line": 990,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(v >= 0 && v < levels)",
          "old_line_content": "",
          "new_line_content": "    assert(v >= 0 && v < levels);",
          "content_same": false
        },
        {
          "line": 1502,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_WARNING, \"No channel layout specified. The \"\n                                      \"encoder will guess the layout, but it \"\n                                      \"might be incorrect.\\n\")",
          "old_line_content": "    }",
          "new_line_content": "        av_log(avctx, AV_LOG_WARNING, \"No channel layout specified. The \"",
          "content_same": false
        },
        {
          "line": 1506,
          "old_api": null,
          "new_api": "set_channel_info",
          "old_text": null,
          "new_text": "set_channel_info(s, avctx->channels, &avctx->channel_layout)",
          "old_line_content": "        return ret;",
          "new_line_content": "    ret = set_channel_info(s, avctx->channels, &avctx->channel_layout);",
          "content_same": false
        },
        {
          "line": 1508,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"invalid channel layout\\n\")",
          "old_line_content": "",
          "new_line_content": "        av_log(avctx, AV_LOG_ERROR, \"invalid channel layout\\n\");",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": null,
          "new_api": "exponent_min",
          "old_text": null,
          "new_text": "exponent_min(block->exp[ch], block1->exp[ch], s->nb_coefs[ch])",
          "old_line_content": "            }",
          "new_line_content": "                exponent_min(block->exp[ch], block1->exp[ch], s->nb_coefs[ch]);",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": null,
          "new_api": "encode_exponents_blk_ch",
          "old_text": null,
          "new_text": "encode_exponents_blk_ch(block->exp[ch], s->nb_coefs[ch],\n                                    block->exp_strategy[ch])",
          "old_line_content": "            block2 = block + 1;",
          "new_line_content": "            encode_exponents_blk_ch(block->exp[ch], s->nb_coefs[ch],",
          "content_same": false
        },
        {
          "line": 1518,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"invalid sample rate\\n\")",
          "old_line_content": "    s->sample_rate        = avctx->sample_rate;",
          "new_line_content": "        av_log(avctx, AV_LOG_ERROR, \"invalid sample rate\\n\");",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(block2->exp[ch], block->exp[ch],\n                       s->nb_coefs[ch] * sizeof(uint8_t))",
          "old_line_content": "            blk = blk1;",
          "new_line_content": "                memcpy(block2->exp[ch], block->exp[ch],",
          "content_same": false
        },
        {
          "line": 1519,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(EINVAL)",
          "old_line_content": "    s->bit_alloc.sr_shift = i % 3;",
          "new_line_content": "        return AVERROR(EINVAL);",
          "content_same": false
        },
        {
          "line": 1012,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(v >= -m)",
          "old_line_content": "",
          "new_line_content": "    assert(v >= -m);",
          "content_same": false
        },
        {
          "line": 1531,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"invalid bit rate\\n\")",
          "old_line_content": "    s->bit_rate        = avctx->bit_rate;",
          "new_line_content": "        av_log(avctx, AV_LOG_ERROR, \"invalid bit rate\\n\");",
          "content_same": false
        },
        {
          "line": 1532,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(EINVAL)",
          "old_line_content": "    s->frame_size_code = i << 1;",
          "new_line_content": "        return AVERROR(EINVAL);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1536,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"invalid cutoff frequency\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(avctx, AV_LOG_ERROR, \"invalid cutoff frequency\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1025,
          "old_api": "SCALE_COEF",
          "new_api": null,
          "old_text": "SCALE_COEF(mdct_coef[i])",
          "new_text": null,
          "old_line_content": "        int c = SCALE_COEF(mdct_coef[i]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1537,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EINVAL)",
          "new_text": null,
          "old_line_content": "        return AVERROR(EINVAL);",
          "new_line_content": "    /* validate cutoff */",
          "content_same": false
        },
        {
          "line": 1033,
          "old_api": "sym_quant",
          "new_api": null,
          "old_text": "sym_quant(c, e, 3)",
          "new_text": null,
          "old_line_content": "            v = sym_quant(c, e, 3);",
          "new_line_content": "            v = 0;",
          "content_same": false
        },
        {
          "line": 1560,
          "old_api": "av_clip",
          "new_api": null,
          "old_text": "av_clip((fbw_coeffs - 73) / 3, 0, 60)",
          "new_text": null,
          "old_line_content": "        bw_code        = av_clip((fbw_coeffs - 73) / 3, 0, 60);",
          "new_line_content": "        /* calculate bandwidth based on user-specified cutoff frequency */",
          "content_same": false
        },
        {
          "line": 1053,
          "old_api": "sym_quant",
          "new_api": null,
          "old_text": "sym_quant(c, e, 5)",
          "new_text": null,
          "old_line_content": "            v = sym_quant(c, e, 5);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1583,
          "old_api": "FF_ALLOC_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOC_OR_GOTO(avctx, s->planar_samples, s->channels * sizeof(*s->planar_samples),\n                     alloc_fail)",
          "new_text": null,
          "old_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->planar_samples, s->channels * sizeof(*s->planar_samples),",
          "new_line_content": "    int blk, ch;",
          "content_same": false
        },
        {
          "line": 1073,
          "old_api": "sym_quant",
          "new_api": null,
          "old_text": "sym_quant(c, e, 7)",
          "new_text": null,
          "old_line_content": "            v = sym_quant(c, e, 7);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": "extract_exponents",
          "new_api": null,
          "old_text": "extract_exponents(s)",
          "new_text": null,
          "old_line_content": "    extract_exponents(s);",
          "new_line_content": " */",
          "content_same": false
        },
        {
          "line": 1590,
          "old_api": "FF_ALLOC_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOC_OR_GOTO(avctx, s->bap_buffer,  AC3_MAX_BLOCKS * s->channels *\n                     AC3_MAX_COEFS * sizeof(*s->bap_buffer),  alloc_fail)",
          "new_text": null,
          "old_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->bap_buffer,  AC3_MAX_BLOCKS * s->channels *",
          "new_line_content": "                          (AC3_FRAME_SIZE+AC3_BLOCK_SIZE) * sizeof(**s->planar_samples),",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": "compute_exp_strategy",
          "new_api": null,
          "old_text": "compute_exp_strategy(s)",
          "new_text": null,
          "old_line_content": "    compute_exp_strategy(s);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1592,
          "old_api": "FF_ALLOC_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOC_OR_GOTO(avctx, s->bap1_buffer, AC3_MAX_BLOCKS * s->channels *\n                     AC3_MAX_COEFS * sizeof(*s->bap1_buffer), alloc_fail)",
          "new_text": null,
          "old_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->bap1_buffer, AC3_MAX_BLOCKS * s->channels *",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "encode_exponents",
          "new_api": null,
          "old_text": "encode_exponents(s)",
          "new_text": null,
          "old_line_content": "    encode_exponents(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1594,
          "old_api": "FF_ALLOC_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOC_OR_GOTO(avctx, s->mdct_coef_buffer, AC3_MAX_BLOCKS * s->channels *\n                     AC3_MAX_COEFS * sizeof(*s->mdct_coef_buffer), alloc_fail)",
          "new_text": null,
          "old_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->mdct_coef_buffer, AC3_MAX_BLOCKS * s->channels *",
          "new_line_content": "                     AC3_MAX_COEFS * sizeof(*s->bap_buffer),  alloc_fail);",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": "group_exponents",
          "new_api": null,
          "old_text": "group_exponents(s)",
          "new_text": null,
          "old_line_content": "    group_exponents(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1596,
          "old_api": "FF_ALLOC_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOC_OR_GOTO(avctx, s->exp_buffer, AC3_MAX_BLOCKS * s->channels *\n                     AC3_MAX_COEFS * sizeof(*s->exp_buffer), alloc_fail)",
          "new_text": null,
          "old_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->exp_buffer, AC3_MAX_BLOCKS * s->channels *",
          "new_line_content": "                     AC3_MAX_COEFS * sizeof(*s->bap1_buffer), alloc_fail);",
          "content_same": false
        },
        {
          "line": 1598,
          "old_api": "FF_ALLOC_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOC_OR_GOTO(avctx, s->grouped_exp_buffer, AC3_MAX_BLOCKS * s->channels *\n                     128 * sizeof(*s->grouped_exp_buffer), alloc_fail)",
          "new_text": null,
          "old_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->grouped_exp_buffer, AC3_MAX_BLOCKS * s->channels *",
          "new_line_content": "                     AC3_MAX_COEFS * sizeof(*s->mdct_coef_buffer), alloc_fail);",
          "content_same": false
        },
        {
          "line": 1600,
          "old_api": "FF_ALLOC_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOC_OR_GOTO(avctx, s->psd_buffer, AC3_MAX_BLOCKS * s->channels *\n                     AC3_MAX_COEFS * sizeof(*s->psd_buffer), alloc_fail)",
          "new_text": null,
          "old_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->psd_buffer, AC3_MAX_BLOCKS * s->channels *",
          "new_line_content": "                     AC3_MAX_COEFS * sizeof(*s->exp_buffer), alloc_fail);",
          "content_same": false
        },
        {
          "line": 1602,
          "old_api": "FF_ALLOC_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOC_OR_GOTO(avctx, s->band_psd_buffer, AC3_MAX_BLOCKS * s->channels *\n                     64 * sizeof(*s->band_psd_buffer), alloc_fail)",
          "new_text": null,
          "old_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->band_psd_buffer, AC3_MAX_BLOCKS * s->channels *",
          "new_line_content": "                     128 * sizeof(*s->grouped_exp_buffer), alloc_fail);",
          "content_same": false
        },
        {
          "line": 1091,
          "old_api": "sym_quant",
          "new_api": null,
          "old_text": "sym_quant(c, e, 15)",
          "new_text": null,
          "old_line_content": "            v = sym_quant(c, e, 15);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1604,
          "old_api": "FF_ALLOC_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOC_OR_GOTO(avctx, s->mask_buffer, AC3_MAX_BLOCKS * s->channels *\n                     64 * sizeof(*s->mask_buffer), alloc_fail)",
          "new_text": null,
          "old_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->mask_buffer, AC3_MAX_BLOCKS * s->channels *",
          "new_line_content": "                     AC3_MAX_COEFS * sizeof(*s->psd_buffer), alloc_fail);",
          "content_same": false
        },
        {
          "line": 1606,
          "old_api": "FF_ALLOC_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOC_OR_GOTO(avctx, s->qmant_buffer, AC3_MAX_BLOCKS * s->channels *\n                     AC3_MAX_COEFS * sizeof(*s->qmant_buffer), alloc_fail)",
          "new_text": null,
          "old_line_content": "    FF_ALLOC_OR_GOTO(avctx, s->qmant_buffer, AC3_MAX_BLOCKS * s->channels *",
          "new_line_content": "                     64 * sizeof(*s->band_psd_buffer), alloc_fail);",
          "content_same": false
        },
        {
          "line": 1610,
          "old_api": "FF_ALLOC_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOC_OR_GOTO(avctx, block->bap, s->channels * sizeof(*block->bap),\n                         alloc_fail)",
          "new_text": null,
          "old_line_content": "        FF_ALLOC_OR_GOTO(avctx, block->bap, s->channels * sizeof(*block->bap),",
          "new_line_content": "                     AC3_MAX_COEFS * sizeof(*s->qmant_buffer), alloc_fail);",
          "content_same": false
        },
        {
          "line": 1612,
          "old_api": "FF_ALLOCZ_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOCZ_OR_GOTO(avctx, block->mdct_coef, s->channels * sizeof(*block->mdct_coef),\n                          alloc_fail)",
          "new_text": null,
          "old_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->mdct_coef, s->channels * sizeof(*block->mdct_coef),",
          "new_line_content": "        AC3Block *block = &s->blocks[blk];",
          "content_same": false
        },
        {
          "line": 1614,
          "old_api": "FF_ALLOCZ_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOCZ_OR_GOTO(avctx, block->exp, s->channels * sizeof(*block->exp),\n                          alloc_fail)",
          "new_text": null,
          "old_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->exp, s->channels * sizeof(*block->exp),",
          "new_line_content": "                         alloc_fail);",
          "content_same": false
        },
        {
          "line": 1616,
          "old_api": "FF_ALLOCZ_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOCZ_OR_GOTO(avctx, block->grouped_exp, s->channels * sizeof(*block->grouped_exp),\n                          alloc_fail)",
          "new_text": null,
          "old_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->grouped_exp, s->channels * sizeof(*block->grouped_exp),",
          "new_line_content": "                          alloc_fail);",
          "content_same": false
        },
        {
          "line": 1618,
          "old_api": "FF_ALLOCZ_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOCZ_OR_GOTO(avctx, block->psd, s->channels * sizeof(*block->psd),\n                          alloc_fail)",
          "new_text": null,
          "old_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->psd, s->channels * sizeof(*block->psd),",
          "new_line_content": "                          alloc_fail);",
          "content_same": false
        },
        {
          "line": 1620,
          "old_api": "FF_ALLOCZ_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOCZ_OR_GOTO(avctx, block->band_psd, s->channels * sizeof(*block->band_psd),\n                          alloc_fail)",
          "new_text": null,
          "old_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->band_psd, s->channels * sizeof(*block->band_psd),",
          "new_line_content": "                          alloc_fail);",
          "content_same": false
        },
        {
          "line": 1622,
          "old_api": "FF_ALLOCZ_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOCZ_OR_GOTO(avctx, block->mask, s->channels * sizeof(*block->mask),\n                          alloc_fail)",
          "new_text": null,
          "old_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->mask, s->channels * sizeof(*block->mask),",
          "new_line_content": "                          alloc_fail);",
          "content_same": false
        },
        {
          "line": 1624,
          "old_api": "FF_ALLOCZ_OR_GOTO",
          "new_api": null,
          "old_text": "FF_ALLOCZ_OR_GOTO(avctx, block->qmant, s->channels * sizeof(*block->qmant),\n                          alloc_fail)",
          "new_text": null,
          "old_line_content": "        FF_ALLOCZ_OR_GOTO(avctx, block->qmant, s->channels * sizeof(*block->qmant),",
          "new_line_content": "                          alloc_fail);",
          "content_same": false
        },
        {
          "line": 1122,
          "old_api": "quantize_mantissas_blk_ch",
          "new_api": null,
          "old_text": "quantize_mantissas_blk_ch(s, block->mdct_coef[ch], block->exp_shift[ch],\n                                      block->exp[ch], block->bap[ch],\n                                      block->qmant[ch], s->nb_coefs[ch])",
          "new_text": null,
          "old_line_content": "            quantize_mantissas_blk_ch(s, block->mdct_coef[ch], block->exp_shift[ch],",
          "new_line_content": "        s->qmant1_ptr = s->qmant2_ptr = s->qmant4_ptr = NULL;",
          "content_same": false
        },
        {
          "line": 1641,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "    return AVERROR(ENOMEM);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1135,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 16, 0x0b77)",
          "new_text": null,
          "old_line_content": "    put_bits(&s->pb, 16, 0x0b77);   /* frame header */",
          "new_line_content": " */",
          "content_same": false
        },
        {
          "line": 1136,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 16, 0)",
          "new_text": null,
          "old_line_content": "    put_bits(&s->pb, 16, 0);        /* crc1: will be filled later */",
          "new_line_content": "static void output_frame_header(AC3EncodeContext *s)",
          "content_same": false
        },
        {
          "line": 1137,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 2,  s->bit_alloc.sr_code)",
          "new_text": null,
          "old_line_content": "    put_bits(&s->pb, 2,  s->bit_alloc.sr_code);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1655,
          "old_api": "ac3_common_init",
          "new_api": null,
          "old_text": "ac3_common_init()",
          "new_text": null,
          "old_line_content": "    ac3_common_init();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1657,
          "old_api": "validate_options",
          "new_api": null,
          "old_text": "validate_options(avctx, s)",
          "new_text": null,
          "old_line_content": "    ret = validate_options(avctx, s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1145,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 2, 1)",
          "new_text": null,
          "old_line_content": "        put_bits(&s->pb, 2, 1);     /* XXX -6 dB */",
          "new_line_content": "    if ((s->channel_mode & 0x01) && s->channel_mode != AC3_CHMODE_MONO)",
          "content_same": false
        },
        {
          "line": 1147,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 2, 0)",
          "new_text": null,
          "old_line_content": "        put_bits(&s->pb, 2, 0);     /* surround not indicated */",
          "new_line_content": "    if (s->channel_mode & 0x04)",
          "content_same": false
        },
        {
          "line": 1149,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 5, 31)",
          "new_text": null,
          "old_line_content": "    put_bits(&s->pb, 5, 31);        /* dialog norm: -31 db */",
          "new_line_content": "    if (s->channel_mode == AC3_CHMODE_STEREO)",
          "content_same": false
        },
        {
          "line": 1671,
          "old_api": "pow_poly",
          "new_api": null,
          "old_text": "pow_poly((CRC16_POLY >> 1), (8 * frame_size_58) - 16, CRC16_POLY)",
          "new_text": null,
          "old_line_content": "    s->crc_inv[0] = pow_poly((CRC16_POLY >> 1), (8 * frame_size_58) - 16, CRC16_POLY);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1679,
          "old_api": "exponent_init",
          "new_api": null,
          "old_text": "exponent_init(s)",
          "new_text": null,
          "old_line_content": "    exponent_init(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1681,
          "old_api": "bit_alloc_init",
          "new_api": null,
          "old_text": "bit_alloc_init(s)",
          "new_text": null,
          "old_line_content": "    bit_alloc_init(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1171,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 1, 0)",
          "new_text": null,
          "old_line_content": "        put_bits(&s->pb, 1, 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1683,
          "old_api": "mdct_init",
          "new_api": null,
          "old_text": "mdct_init(avctx, &s->mdct, 9)",
          "new_text": null,
          "old_line_content": "    ret = mdct_init(avctx, &s->mdct, 9);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": "count_frame_bits_fixed",
          "new_api": null,
          "old_text": "count_frame_bits_fixed(s)",
          "new_text": null,
          "old_line_content": "    count_frame_bits_fixed(s);",
          "new_line_content": "    s->bit_alloc.db_per_bit = ff_ac3_db_per_bit_tab[s->db_per_bit_code];",
          "content_same": false
        },
        {
          "line": 1175,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 1, 1)",
          "new_text": null,
          "old_line_content": "        put_bits(&s->pb, 1, 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1687,
          "old_api": "allocate_buffers",
          "new_api": null,
          "old_text": "allocate_buffers(avctx)",
          "new_text": null,
          "old_line_content": "    ret = allocate_buffers(avctx);",
          "new_line_content": "    if (ret)",
          "content_same": false
        },
        {
          "line": 1691,
          "old_api": "avcodec_alloc_frame",
          "new_api": null,
          "old_text": "avcodec_alloc_frame()",
          "new_text": null,
          "old_line_content": "    avctx->coded_frame= avcodec_alloc_frame();",
          "new_line_content": "    if (ret)",
          "content_same": false
        },
        {
          "line": 1693,
          "old_api": "dsputil_init",
          "new_api": null,
          "old_text": "dsputil_init(&s->dsp, avctx)",
          "new_text": null,
          "old_line_content": "    dsputil_init(&s->dsp, avctx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1182,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 1, 1)",
          "new_text": null,
          "old_line_content": "        put_bits(&s->pb, 1, 1); /* coupling strategy present */",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1183,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 1, 0)",
          "new_text": null,
          "old_line_content": "        put_bits(&s->pb, 1, 0); /* no coupling strategy */",
          "new_line_content": "    /* channel coupling */",
          "content_same": false
        },
        {
          "line": 1697,
          "old_api": "ac3_encode_close",
          "new_api": null,
          "old_text": "ac3_encode_close(avctx)",
          "new_text": null,
          "old_line_content": "    ac3_encode_close(avctx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1192,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 1, 1)",
          "new_text": null,
          "old_line_content": "            put_bits(&s->pb, 1, 1);",
          "new_line_content": "    if (s->channel_mode == AC3_CHMODE_STEREO) {",
          "content_same": false
        },
        {
          "line": 1196,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 1, 0)",
          "new_text": null,
          "old_line_content": "                put_bits(&s->pb, 1, 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1205,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 2, block->exp_strategy[ch])",
          "new_text": null,
          "old_line_content": "        put_bits(&s->pb, 2, block->exp_strategy[ch]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1207,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 1, block->exp_strategy[s->lfe_channel])",
          "new_text": null,
          "old_line_content": "        put_bits(&s->pb, 1, block->exp_strategy[s->lfe_channel]);",
          "new_line_content": "    for (ch = 0; ch < s->fbw_channels; ch++)",
          "content_same": false
        },
        {
          "line": 1212,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 6, s->bandwidth_code[ch])",
          "new_text": null,
          "old_line_content": "            put_bits(&s->pb, 6, s->bandwidth_code[ch]);",
          "new_line_content": "    /* bandwidth */",
          "content_same": false
        },
        {
          "line": 1223,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 4, block->grouped_exp[ch][0])",
          "new_text": null,
          "old_line_content": "        put_bits(&s->pb, 4, block->grouped_exp[ch][0]);",
          "new_line_content": "            continue;",
          "content_same": false
        },
        {
          "line": 1228,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 7, block->grouped_exp[ch][i])",
          "new_text": null,
          "old_line_content": "            put_bits(&s->pb, 7, block->grouped_exp[ch][i]);",
          "new_line_content": "        /* exponent groups */",
          "content_same": false
        },
        {
          "line": 1232,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 2, 0)",
          "new_text": null,
          "old_line_content": "            put_bits(&s->pb, 2, 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1237,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 1, baie)",
          "new_text": null,
          "old_line_content": "    put_bits(&s->pb, 1, baie);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1239,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 2, s->slow_decay_code)",
          "new_text": null,
          "old_line_content": "        put_bits(&s->pb, 2, s->slow_decay_code);",
          "new_line_content": "    baie = (block_num == 0);",
          "content_same": false
        },
        {
          "line": 1241,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 2, s->slow_gain_code)",
          "new_text": null,
          "old_line_content": "        put_bits(&s->pb, 2, s->slow_gain_code);",
          "new_line_content": "    if (baie) {",
          "content_same": false
        },
        {
          "line": 1247,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 1, baie)",
          "new_text": null,
          "old_line_content": "    put_bits(&s->pb, 1, baie);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1249,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 6, s->coarse_snr_offset)",
          "new_text": null,
          "old_line_content": "        put_bits(&s->pb, 6, s->coarse_snr_offset);",
          "new_line_content": "    /* snr offset */",
          "content_same": false
        },
        {
          "line": 1251,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 4, s->fine_snr_offset[ch])",
          "new_text": null,
          "old_line_content": "            put_bits(&s->pb, 4, s->fine_snr_offset[ch]);",
          "new_line_content": "    if (baie) {",
          "content_same": false
        },
        {
          "line": 742,
          "old_api": "ff_ac3_bit_alloc_calc_psd",
          "new_api": null,
          "old_text": "ff_ac3_bit_alloc_calc_psd(block->exp[ch], 0,\n                                          s->nb_coefs[ch],\n                                          block->psd[ch], block->band_psd[ch])",
          "new_text": null,
          "old_line_content": "                ff_ac3_bit_alloc_calc_psd(block->exp[ch], 0,",
          "new_line_content": "               Since we currently do not calculate bap when exponent",
          "content_same": false
        },
        {
          "line": 1256,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 1, 0)",
          "new_text": null,
          "old_line_content": "    put_bits(&s->pb, 1, 0); /* no delta bit allocation */",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1257,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb, 1, 0)",
          "new_text": null,
          "old_line_content": "    put_bits(&s->pb, 1, 0); /* no data to skip */",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1267,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb,   5, q)",
          "new_text": null,
          "old_line_content": "            case 1: if (q != 128) put_bits(&s->pb,   5, q); break;",
          "new_line_content": "            b = block->bap[ch][i];",
          "content_same": false
        },
        {
          "line": 1268,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb,   7, q)",
          "new_text": null,
          "old_line_content": "            case 2: if (q != 128) put_bits(&s->pb,   7, q); break;",
          "new_line_content": "            switch (b) {",
          "content_same": false
        },
        {
          "line": 1269,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&s->pb,   3, q)",
          "new_text": null,
          "old_line_content": "            case 3:               put_bits(&s->pb,   3, q); break;",
          "new_line_content": "            case 0:                                         break;",
          "content_same": false
        },
        {
          "line": 789,
          "old_api": "reset_block_bap",
          "new_api": null,
          "old_text": "reset_block_bap(s)",
          "new_text": null,
          "old_line_content": "    reset_block_bap(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1307,
          "old_api": "mul_poly",
          "new_api": null,
          "old_text": "mul_poly(r, a, poly)",
          "new_text": null,
          "old_line_content": "            r = mul_poly(r, a, poly);",
          "new_line_content": "    r = 1;",
          "content_same": false
        },
        {
          "line": 1308,
          "old_api": "mul_poly",
          "new_api": null,
          "old_text": "mul_poly(a, a, poly)",
          "new_text": null,
          "old_line_content": "        a = mul_poly(a, a, poly);",
          "new_line_content": "    while (n) {",
          "content_same": false
        },
        {
          "line": 290,
          "old_api": "SCALE_COEF",
          "new_api": null,
          "old_text": "SCALE_COEF(block->mdct_coef[ch][i])",
          "new_text": null,
          "old_line_content": "                int v = abs(SCALE_COEF(block->mdct_coef[ch][i]));",
          "new_line_content": "            int exp_shift  = block->exp_shift[ch];",
          "content_same": false
        },
        {
          "line": 805,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(block->bap[ch], s->blocks[blk-1].bap[ch], AC3_MAX_COEFS)",
          "new_text": null,
          "old_line_content": "                memcpy(block->bap[ch], s->blocks[blk-1].bap[ch], AC3_MAX_COEFS);",
          "new_line_content": "               advantage of that by reusing the bit allocation pointers",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": "av_log2",
          "new_api": null,
          "old_text": "av_log2(v)",
          "new_text": null,
          "old_line_content": "                    e = 23 - av_log2(v) + block->exp_shift[ch];",
          "new_line_content": "                if (v == 0)",
          "content_same": false
        },
        {
          "line": 807,
          "old_api": "ff_ac3_bit_alloc_calc_bap",
          "new_api": null,
          "old_text": "ff_ac3_bit_alloc_calc_bap(block->mask[ch], block->psd[ch], 0,\n                                          s->nb_coefs[ch], snr_offset,\n                                          s->bit_alloc.floor, ff_ac3_bap_tab,\n                                          block->bap[ch])",
          "new_text": null,
          "old_line_content": "                ff_ac3_bit_alloc_calc_bap(block->mask[ch], block->psd[ch], 0,",
          "new_line_content": "            if (block->exp_strategy[ch] == EXP_REUSE) {",
          "content_same": false
        },
        {
          "line": 1320,
          "old_api": "av_crc_get_table",
          "new_api": null,
          "old_text": "av_crc_get_table(AV_CRC_16_ANSI)",
          "new_text": null,
          "old_line_content": "    const AVCRC *crc_ctx = av_crc_get_table(AV_CRC_16_ANSI);",
          "new_line_content": " */",
          "content_same": false
        },
        {
          "line": 812,
          "old_api": "compute_mantissa_size",
          "new_api": null,
          "old_text": "compute_mantissa_size(mant_cnt, block->bap[ch], s->nb_coefs[ch])",
          "new_text": null,
          "old_line_content": "            mantissa_bits += compute_mantissa_size(mant_cnt, block->bap[ch], s->nb_coefs[ch]);",
          "new_line_content": "                                          s->bit_alloc.floor, ff_ac3_bap_tab,",
          "content_same": false
        },
        {
          "line": 814,
          "old_api": "compute_mantissa_size_final",
          "new_api": null,
          "old_text": "compute_mantissa_size_final(mant_cnt)",
          "new_text": null,
          "old_line_content": "        mantissa_bits += compute_mantissa_size_final(mant_cnt);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1327,
          "old_api": "flush_put_bits",
          "new_api": null,
          "old_text": "flush_put_bits(&s->pb)",
          "new_text": null,
          "old_line_content": "    flush_put_bits(&s->pb);",
          "new_line_content": "    frame_size_58 = ((s->frame_size >> 2) + (s->frame_size >> 4)) << 1;",
          "content_same": false
        },
        {
          "line": 1329,
          "old_api": "put_bits_ptr",
          "new_api": null,
          "old_text": "put_bits_ptr(&s->pb)",
          "new_text": null,
          "old_line_content": "    pad_bytes = s->frame_size - (put_bits_ptr(&s->pb) - frame) - 2;",
          "new_line_content": "    /* pad the remainder of the frame with zeros */",
          "content_same": false
        },
        {
          "line": 1336,
          "old_api": "av_crc",
          "new_api": null,
          "old_text": "av_crc(crc_ctx, 0, frame + 4, frame_size_58 - 4)",
          "new_text": null,
          "old_line_content": "    crc1    = av_bswap16(av_crc(crc_ctx, 0, frame + 4, frame_size_58 - 4));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1338,
          "old_api": "mul_poly",
          "new_api": null,
          "old_text": "mul_poly(crc_inv, crc1, CRC16_POLY)",
          "new_text": null,
          "old_line_content": "    crc1    = mul_poly(crc_inv, crc1, CRC16_POLY);",
          "new_line_content": "    /* this is not so easy because it is at the beginning of the data... */",
          "content_same": false
        },
        {
          "line": 1344,
          "old_api": "av_crc",
          "new_api": null,
          "old_text": "av_crc(crc_ctx, crc2_partial, frame + s->frame_size - 3, 1)",
          "new_text": null,
          "old_line_content": "    crc2 = av_crc(crc_ctx, crc2_partial, frame + s->frame_size - 3, 1);",
          "new_line_content": "    /* compute crc2 */",
          "content_same": false
        },
        {
          "line": 1348,
          "old_api": "av_crc",
          "new_api": null,
          "old_text": "av_crc(crc_ctx, crc2_partial, frame + s->frame_size - 3, 1)",
          "new_text": null,
          "old_line_content": "        crc2 = av_crc(crc_ctx, crc2_partial, frame + s->frame_size - 3, 1);",
          "new_line_content": "    /* ensure crc2 does not match sync word by flipping crcrsv bit if needed */",
          "content_same": false
        },
        {
          "line": 837,
          "old_api": "bit_alloc",
          "new_api": null,
          "old_text": "bit_alloc(s, 1023)",
          "new_text": null,
          "old_line_content": "        if (bit_alloc(s, 1023) <= bits_left)",
          "new_line_content": "    /* if previous frame SNR offset was 1023, check if current frame can also",
          "content_same": false
        },
        {
          "line": 1350,
          "old_api": "av_bswap16",
          "new_api": null,
          "old_text": "av_bswap16(crc2)",
          "new_text": null,
          "old_line_content": "    crc2 = av_bswap16(crc2);",
          "new_line_content": "        frame[s->frame_size - 3] ^= 0x1;",
          "content_same": false
        },
        {
          "line": 327,
          "old_api": "s->dsp.sad[0](NULL, exp[blk], exp[blk-1], 16, 16)",
          "new_api": null,
          "old_text": "s->dsp.sad[0](NULL, exp[blk], exp[blk-1], 16, 16)",
          "new_text": null,
          "old_line_content": "        exp_diff = s->dsp.sad[0](NULL, exp[blk], exp[blk-1], 16, 16);",
          "new_line_content": "       reused in the next frame */",
          "content_same": false
        },
        {
          "line": 842,
          "old_api": "bit_alloc",
          "new_api": null,
          "old_text": "bit_alloc(s, snr_offset)",
          "new_text": null,
          "old_line_content": "           bit_alloc(s, snr_offset) > bits_left) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 333,
          "old_api": "emms_c",
          "new_api": null,
          "old_text": "emms_c()",
          "new_text": null,
          "old_line_content": "    emms_c();",
          "new_line_content": "        else",
          "content_same": false
        },
        {
          "line": 846,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EINVAL)",
          "new_text": null,
          "old_line_content": "        return AVERROR(EINVAL);",
          "new_line_content": "        snr_offset -= 64;",
          "content_same": false
        },
        {
          "line": 1362,
          "old_api": "init_put_bits",
          "new_api": null,
          "old_text": "init_put_bits(&s->pb, frame, AC3_MAX_CODED_FRAME_SIZE)",
          "new_text": null,
          "old_line_content": "    init_put_bits(&s->pb, frame, AC3_MAX_CODED_FRAME_SIZE);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 851,
          "old_api": "bit_alloc",
          "new_api": null,
          "old_text": "bit_alloc(s, snr_offset + snr_incr)",
          "new_text": null,
          "old_line_content": "               bit_alloc(s, snr_offset + snr_incr) <= bits_left) {",
          "new_line_content": "    FFSWAP(uint8_t *, s->bap_buffer, s->bap1_buffer);",
          "content_same": false
        },
        {
          "line": 1364,
          "old_api": "output_frame_header",
          "new_api": null,
          "old_text": "output_frame_header(s)",
          "new_text": null,
          "old_line_content": "    output_frame_header(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 857,
          "old_api": "reset_block_bap",
          "new_api": null,
          "old_text": "reset_block_bap(s)",
          "new_text": null,
          "old_line_content": "    reset_block_bap(s);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1369,
          "old_api": "output_frame_end",
          "new_api": null,
          "old_text": "output_frame_end(s)",
          "new_text": null,
          "old_line_content": "    output_frame_end(s);",
          "new_line_content": "    for (blk = 0; blk < AC3_MAX_BLOCKS; blk++)",
          "content_same": false
        },
        {
          "line": 1384,
          "old_api": "adjust_frame_size",
          "new_api": null,
          "old_text": "adjust_frame_size(s)",
          "new_text": null,
          "old_line_content": "        adjust_frame_size(s);",
          "new_line_content": "    int ret;",
          "content_same": false
        },
        {
          "line": 1386,
          "old_api": "deinterleave_input_samples",
          "new_api": null,
          "old_text": "deinterleave_input_samples(s, samples)",
          "new_text": null,
          "old_line_content": "    deinterleave_input_samples(s, samples);",
          "new_line_content": "    if (s->bit_alloc.sr_code == 1)",
          "content_same": false
        },
        {
          "line": 1388,
          "old_api": "apply_mdct",
          "new_api": null,
          "old_text": "apply_mdct(s)",
          "new_text": null,
          "old_line_content": "    apply_mdct(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1390,
          "old_api": "process_exponents",
          "new_api": null,
          "old_text": "process_exponents(s)",
          "new_text": null,
          "old_line_content": "    process_exponents(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1392,
          "old_api": "compute_bit_allocation",
          "new_api": null,
          "old_text": "compute_bit_allocation(s)",
          "new_text": null,
          "old_line_content": "    ret = compute_bit_allocation(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": "compute_exp_strategy_ch",
          "new_api": null,
          "old_text": "compute_exp_strategy_ch(s, exp_str1[ch], exp1[ch])",
          "new_text": null,
          "old_line_content": "        compute_exp_strategy_ch(s, exp_str1[ch], exp1[ch]);",
          "new_line_content": "            exp_str1[ch][blk] = s->blocks[blk].exp_strategy[ch];",
          "content_same": false
        },
        {
          "line": 1394,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Bit allocation failed. Try increasing the bitrate.\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Bit allocation failed. Try increasing the bitrate.\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1398,
          "old_api": "quantize_mantissas",
          "new_api": null,
          "old_text": "quantize_mantissas(s)",
          "new_text": null,
          "old_line_content": "    quantize_mantissas(s);",
          "new_line_content": "        return ret;",
          "content_same": false
        },
        {
          "line": 1400,
          "old_api": "output_frame",
          "new_api": null,
          "old_text": "output_frame(s, frame)",
          "new_text": null,
          "old_line_content": "    output_frame(s, frame);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1415,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&s->planar_samples[ch])",
          "new_text": null,
          "old_line_content": "        av_freep(&s->planar_samples[ch]);",
          "new_line_content": "    AC3EncodeContext *s = avctx->priv_data;",
          "content_same": false
        },
        {
          "line": 1416,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&s->planar_samples)",
          "new_text": null,
          "old_line_content": "    av_freep(&s->planar_samples);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1417,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&s->bap_buffer)",
          "new_text": null,
          "old_line_content": "    av_freep(&s->bap_buffer);",
          "new_line_content": "    for (ch = 0; ch < s->channels; ch++)",
          "content_same": false
        },
        {
          "line": 1429,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&block->mdct_coef)",
          "new_text": null,
          "old_line_content": "        av_freep(&block->mdct_coef);",
          "new_line_content": "    for (blk = 0; blk < AC3_MAX_BLOCKS; blk++) {",
          "content_same": false
        },
        {
          "line": 1430,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&block->exp)",
          "new_text": null,
          "old_line_content": "        av_freep(&block->exp);",
          "new_line_content": "        AC3Block *block = &s->blocks[blk];",
          "content_same": false
        },
        {
          "line": 1440,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&avctx->coded_frame)",
          "new_text": null,
          "old_line_content": "    av_freep(&avctx->coded_frame);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 939,
          "old_api": "count_frame_bits",
          "new_api": null,
          "old_text": "count_frame_bits(s)",
          "new_text": null,
          "old_line_content": "    count_frame_bits(s);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 941,
          "old_api": "bit_alloc_masking",
          "new_api": null,
          "old_text": "bit_alloc_masking(s)",
          "new_text": null,
          "old_line_content": "    bit_alloc_masking(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1454,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EINVAL)",
          "new_text": null,
          "old_line_content": "        return AVERROR(EINVAL);",
          "new_line_content": "    int ch_layout;",
          "content_same": false
        },
        {
          "line": 943,
          "old_api": "cbr_bit_allocation",
          "new_api": null,
          "old_text": "cbr_bit_allocation(s)",
          "new_text": null,
          "old_line_content": "    ret = cbr_bit_allocation(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1456,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EINVAL)",
          "new_text": null,
          "old_line_content": "        return AVERROR(EINVAL);",
          "new_line_content": "    if (channels < 1 || channels > AC3_MAX_CHANNELS)",
          "content_same": false
        },
        {
          "line": 947,
          "old_api": "extract_exponents",
          "new_api": null,
          "old_text": "extract_exponents(s)",
          "new_text": null,
          "old_line_content": "            extract_exponents(s);",
          "new_line_content": "    while (ret) {",
          "content_same": false
        },
        {
          "line": 948,
          "old_api": "encode_exponents",
          "new_api": null,
          "old_text": "encode_exponents(s)",
          "new_text": null,
          "old_line_content": "            encode_exponents(s);",
          "new_line_content": "        /* fallback 1: downgrade exponents */",
          "content_same": false
        },
        {
          "line": 1460,
          "old_api": "av_get_channel_layout_nb_channels",
          "new_api": null,
          "old_text": "av_get_channel_layout_nb_channels(ch_layout)",
          "new_text": null,
          "old_line_content": "    if (av_get_channel_layout_nb_channels(ch_layout) != channels)",
          "new_line_content": "    ch_layout = *channel_layout;",
          "content_same": false
        },
        {
          "line": 1461,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EINVAL)",
          "new_text": null,
          "old_line_content": "        return AVERROR(EINVAL);",
          "new_line_content": "    if (!ch_layout)",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(exp[i], exp[i-1] + 2)",
          "new_text": null,
          "old_line_content": "        exp[i] = FFMIN(exp[i], exp[i-1] + 2);",
          "new_line_content": "    /* decrease the delta between each groups to within 2 so that they can be",
          "content_same": false
        },
        {
          "line": 957,
          "old_api": "reduce_bandwidth",
          "new_api": null,
          "old_text": "reduce_bandwidth(s, 0)",
          "new_text": null,
          "old_line_content": "        if (!s->cutoff && !reduce_bandwidth(s, 0)) {",
          "new_line_content": "        /* fallback 2: reduce bandwidth */",
          "content_same": false
        },
        {
          "line": 958,
          "old_api": "process_exponents",
          "new_api": null,
          "old_text": "process_exponents(s)",
          "new_text": null,
          "old_line_content": "            process_exponents(s);",
          "new_line_content": "        /* only do this if the user has not specified a specific cutoff",
          "content_same": false
        },
        {
          "line": 959,
          "old_api": "compute_bit_allocation",
          "new_api": null,
          "old_text": "compute_bit_allocation(s)",
          "new_text": null,
          "old_line_content": "            ret = compute_bit_allocation(s);",
          "new_line_content": "           frequency */",
          "content_same": false
        },
        {
          "line": 1481,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EINVAL)",
          "new_text": null,
          "old_line_content": "        return AVERROR(EINVAL);",
          "new_line_content": "    case AV_CH_LAYOUT_5POINT0:",
          "content_same": false
        },
        {
          "line": 987,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(v >= 0 && v < levels)",
          "new_text": null,
          "old_line_content": "    assert(v >= 0 && v < levels);",
          "new_line_content": "        v = (v + 1) >> 1;",
          "content_same": false
        },
        {
          "line": 1499,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_WARNING, \"No channel layout specified. The \"\n                                      \"encoder will guess the layout, but it \"\n                                      \"might be incorrect.\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(avctx, AV_LOG_WARNING, \"No channel layout specified. The \"",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1503,
          "old_api": "set_channel_info",
          "new_api": null,
          "old_text": "set_channel_info(s, avctx->channels, &avctx->channel_layout)",
          "new_text": null,
          "old_line_content": "    ret = set_channel_info(s, avctx->channels, &avctx->channel_layout);",
          "new_line_content": "                                      \"encoder will guess the layout, but it \"",
          "content_same": false
        },
        {
          "line": 1505,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"invalid channel layout\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(avctx, AV_LOG_ERROR, \"invalid channel layout\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 483,
          "old_api": "exponent_min",
          "new_api": null,
          "old_text": "exponent_min(block->exp[ch], block1->exp[ch], s->nb_coefs[ch])",
          "new_text": null,
          "old_line_content": "                exponent_min(block->exp[ch], block1->exp[ch], s->nb_coefs[ch]);",
          "new_line_content": "            block1 = block + 1;",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": "encode_exponents_blk_ch",
          "new_api": null,
          "old_text": "encode_exponents_blk_ch(block->exp[ch], s->nb_coefs[ch],\n                                    block->exp_strategy[ch])",
          "new_text": null,
          "old_line_content": "            encode_exponents_blk_ch(block->exp[ch], s->nb_coefs[ch],",
          "new_line_content": "                blk1++;",
          "content_same": false
        },
        {
          "line": 1515,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"invalid sample rate\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(avctx, AV_LOG_ERROR, \"invalid sample rate\\n\");",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(block2->exp[ch], block->exp[ch],\n                       s->nb_coefs[ch] * sizeof(uint8_t))",
          "new_text": null,
          "old_line_content": "                memcpy(block2->exp[ch], block->exp[ch],",
          "new_line_content": "            /* copy encoded exponents for reuse case */",
          "content_same": false
        },
        {
          "line": 1516,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EINVAL)",
          "new_text": null,
          "old_line_content": "        return AVERROR(EINVAL);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1009,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(v >= -m)",
          "new_text": null,
          "old_line_content": "    assert(v >= -m);",
          "new_line_content": "    m = (1 << (qbits-1));",
          "content_same": false
        },
        {
          "line": 1528,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"invalid bit rate\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(avctx, AV_LOG_ERROR, \"invalid bit rate\\n\");",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 1529,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EINVAL)",
          "new_text": null,
          "old_line_content": "        return AVERROR(EINVAL);",
          "new_line_content": "    }",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 14,
      "total_additions": 141,
      "total_deletions": 141,
      "total_api_changes": 296
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 8,
        "api_related_lines": 296,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          288,
          289,
          300,
          303
        ]
      }
    },
    "api_calls_before": 207,
    "api_calls_after": 207,
    "diff_info": {
      "added_lines": 7,
      "removed_lines": 4,
      "total_diff_lines": 32
    }
  }
}