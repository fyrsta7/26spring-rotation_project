{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/3479b72bc28a2eaffa3202ba8ed8194558081f93",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/3479b72bc28a2eaffa3202ba8ed8194558081f93/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/3479b72bc28a2eaffa3202ba8ed8194558081f93/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/3479b72bc28a2eaffa3202ba8ed8194558081f93/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 48,
          "old_api": "R3",
          "new_api": "R2",
          "old_text": "R3(b,c,d,e,a,4+i)",
          "new_text": "R2(b,c,d,e,a,4+i)",
          "old_line_content": "        R3(a,b,c,d,e,0+i); R3(e,a,b,c,d,1+i); R3(d,e,a,b,c,2+i); R3(c,d,e,a,b,3+i); R3(b,c,d,e,a,4+i);",
          "new_line_content": "        R2(a,b,c,d,e,0+i); R2(e,a,b,c,d,1+i); R2(d,e,a,b,c,2+i); R2(c,d,e,a,b,3+i); R2(b,c,d,e,a,4+i);",
          "content_same": false
        },
        {
          "line": 51,
          "old_api": "R4",
          "new_api": "R3",
          "old_text": "R4(b,c,d,e,a,4+i)",
          "new_text": "R3(b,c,d,e,a,4+i)",
          "old_line_content": "        R4(a,b,c,d,e,0+i); R4(e,a,b,c,d,1+i); R4(d,e,a,b,c,2+i); R4(c,d,e,a,b,3+i); R4(b,c,d,e,a,4+i);",
          "new_line_content": "        R3(a,b,c,d,e,0+i); R3(e,a,b,c,d,1+i); R3(d,e,a,b,c,2+i); R3(c,d,e,a,b,3+i); R3(b,c,d,e,a,4+i);",
          "content_same": false
        },
        {
          "line": 54,
          "old_api": "R0",
          "new_api": "R4",
          "old_text": "R0(c,d,e,a,b, 3)",
          "new_text": "R4(b,c,d,e,a,4+i)",
          "old_line_content": "    R0(a,b,c,d,e, 0); R0(e,a,b,c,d, 1); R0(d,e,a,b,c, 2); R0(c,d,e,a,b, 3);",
          "new_line_content": "        R4(a,b,c,d,e,0+i); R4(e,a,b,c,d,1+i); R4(d,e,a,b,c,2+i); R4(c,d,e,a,b,3+i); R4(b,c,d,e,a,4+i);",
          "content_same": false
        },
        {
          "line": 58,
          "old_api": "R1",
          "new_api": "R0",
          "old_text": "R1(b,c,d,e,a,19)",
          "new_text": "R0(d,e,a,b,c, 7)",
          "old_line_content": "    R1(e,a,b,c,d,16); R1(d,e,a,b,c,17); R1(c,d,e,a,b,18); R1(b,c,d,e,a,19);",
          "new_line_content": "    R0(b,c,d,e,a, 4); R0(a,b,c,d,e, 5); R0(e,a,b,c,d, 6); R0(d,e,a,b,c, 7);",
          "content_same": false
        },
        {
          "line": 59,
          "old_api": "R2",
          "new_api": "R0",
          "old_text": "R2(c,d,e,a,b,23)",
          "new_text": "R0(e,a,b,c,d,11)",
          "old_line_content": "    R2(a,b,c,d,e,20); R2(e,a,b,c,d,21); R2(d,e,a,b,c,22); R2(c,d,e,a,b,23);",
          "new_line_content": "    R0(c,d,e,a,b, 8); R0(b,c,d,e,a, 9); R0(a,b,c,d,e,10); R0(e,a,b,c,d,11);",
          "content_same": false
        },
        {
          "line": 60,
          "old_api": "R2",
          "new_api": "R0",
          "old_text": "R2(d,e,a,b,c,27)",
          "new_text": "R0(a,b,c,d,e,15)",
          "old_line_content": "    R2(b,c,d,e,a,24); R2(a,b,c,d,e,25); R2(e,a,b,c,d,26); R2(d,e,a,b,c,27);",
          "new_line_content": "    R0(d,e,a,b,c,12); R0(c,d,e,a,b,13); R0(b,c,d,e,a,14); R0(a,b,c,d,e,15);",
          "content_same": false
        },
        {
          "line": 61,
          "old_api": "R2",
          "new_api": "R1",
          "old_text": "R2(e,a,b,c,d,31)",
          "new_text": "R1(b,c,d,e,a,19)",
          "old_line_content": "    R2(c,d,e,a,b,28); R2(b,c,d,e,a,29); R2(a,b,c,d,e,30); R2(e,a,b,c,d,31);",
          "new_line_content": "    R1(e,a,b,c,d,16); R1(d,e,a,b,c,17); R1(c,d,e,a,b,18); R1(b,c,d,e,a,19);",
          "content_same": false
        },
        {
          "line": 64,
          "old_api": "R3",
          "new_api": "R2",
          "old_text": "R3(c,d,e,a,b,43)",
          "new_text": "R2(e,a,b,c,d,31)",
          "old_line_content": "    R3(a,b,c,d,e,40); R3(e,a,b,c,d,41); R3(d,e,a,b,c,42); R3(c,d,e,a,b,43);",
          "new_line_content": "    R2(c,d,e,a,b,28); R2(b,c,d,e,a,29); R2(a,b,c,d,e,30); R2(e,a,b,c,d,31);",
          "content_same": false
        },
        {
          "line": 65,
          "old_api": "R3",
          "new_api": "R2",
          "old_text": "R3(d,e,a,b,c,47)",
          "new_text": "R2(a,b,c,d,e,35)",
          "old_line_content": "    R3(b,c,d,e,a,44); R3(a,b,c,d,e,45); R3(e,a,b,c,d,46); R3(d,e,a,b,c,47);",
          "new_line_content": "    R2(d,e,a,b,c,32); R2(c,d,e,a,b,33); R2(b,c,d,e,a,34); R2(a,b,c,d,e,35);",
          "content_same": false
        },
        {
          "line": 66,
          "old_api": "R3",
          "new_api": "R2",
          "old_text": "R3(e,a,b,c,d,51)",
          "new_text": "R2(b,c,d,e,a,39)",
          "old_line_content": "    R3(c,d,e,a,b,48); R3(b,c,d,e,a,49); R3(a,b,c,d,e,50); R3(e,a,b,c,d,51);",
          "new_line_content": "    R2(e,a,b,c,d,36); R2(d,e,a,b,c,37); R2(c,d,e,a,b,38); R2(b,c,d,e,a,39);",
          "content_same": false
        },
        {
          "line": 69,
          "old_api": "R4",
          "new_api": "R3",
          "old_text": "R4(c,d,e,a,b,63)",
          "new_text": "R3(e,a,b,c,d,51)",
          "old_line_content": "    R4(a,b,c,d,e,60); R4(e,a,b,c,d,61); R4(d,e,a,b,c,62); R4(c,d,e,a,b,63);",
          "new_line_content": "    R3(c,d,e,a,b,48); R3(b,c,d,e,a,49); R3(a,b,c,d,e,50); R3(e,a,b,c,d,51);",
          "content_same": false
        },
        {
          "line": 70,
          "old_api": "R4",
          "new_api": "R3",
          "old_text": "R4(d,e,a,b,c,67)",
          "new_text": "R3(a,b,c,d,e,55)",
          "old_line_content": "    R4(b,c,d,e,a,64); R4(a,b,c,d,e,65); R4(e,a,b,c,d,66); R4(d,e,a,b,c,67);",
          "new_line_content": "    R3(d,e,a,b,c,52); R3(c,d,e,a,b,53); R3(b,c,d,e,a,54); R3(a,b,c,d,e,55);",
          "content_same": false
        },
        {
          "line": 71,
          "old_api": "R4",
          "new_api": "R3",
          "old_text": "R4(e,a,b,c,d,71)",
          "new_text": "R3(b,c,d,e,a,59)",
          "old_line_content": "    R4(c,d,e,a,b,68); R4(b,c,d,e,a,69); R4(a,b,c,d,e,70); R4(e,a,b,c,d,71);",
          "new_line_content": "    R3(e,a,b,c,d,56); R3(d,e,a,b,c,57); R3(c,d,e,a,b,58); R3(b,c,d,e,a,59);",
          "content_same": false
        },
        {
          "line": 100,
          "old_api": "transform",
          "new_api": "memcpy",
          "old_text": "transform(context->state, &data[i])",
          "new_text": "memcpy(&context->buffer[j], data, (i = 64-j))",
          "old_line_content": "            transform(context->state, &data[i]);",
          "new_line_content": "        memcpy(&context->buffer[j], data, (i = 64-j));",
          "content_same": false
        },
        {
          "line": 143,
          "old_api": "printf",
          "new_api": "av_sha1_update",
          "old_text": "printf(\"%02X\", digest[i])",
          "new_text": "av_sha1_update(&context, \"a\", 1)",
          "old_line_content": "            printf(\"%02X\", digest[i]);",
          "new_line_content": "                av_sha1_update(&context, \"a\", 1);",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": "putchar",
          "new_api": "av_sha1_final",
          "old_text": "putchar('\\n')",
          "new_text": "av_sha1_final(&context, digest)",
          "old_line_content": "        putchar('\\n');",
          "new_line_content": "        av_sha1_final(&context, digest);",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "printf",
          "new_api": "putchar",
          "old_text": "printf(\"A9993E36 4706816A BA3E2571 7850C26C 9CD0D89D\\n\"\n           \"84983E44 1C3BD26E BAAE4AA1 F95129E5 E54670F1\\n\"\n           \"34AA973C D4C4DAA4 F61EEB2B DBAD2731 6534016F\\n\")",
          "new_text": "putchar('\\n')",
          "old_line_content": "    printf(\"A9993E36 4706816A BA3E2571 7850C26C 9CD0D89D\\n\"",
          "new_line_content": "        putchar('\\n');",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 34,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(block, buffer, 64)",
          "old_line_content": "    a = state[0];",
          "new_line_content": "    memcpy(block, buffer, 64);",
          "content_same": false
        },
        {
          "line": 101,
          "old_api": null,
          "new_api": "transform",
          "old_text": null,
          "new_text": "transform(context->state, context->buffer)",
          "old_line_content": "        }",
          "new_line_content": "        transform(context->state, context->buffer);",
          "content_same": false
        },
        {
          "line": 103,
          "old_api": null,
          "new_api": "transform",
          "old_text": null,
          "new_text": "transform(context->state, &data[i])",
          "old_line_content": "    else i = 0;",
          "new_line_content": "            transform(context->state, &data[i]);",
          "content_same": false
        },
        {
          "line": 136,
          "old_api": null,
          "new_api": "av_sha1_init",
          "old_text": null,
          "new_text": "av_sha1_init(&context)",
          "old_line_content": "        else if(k==1)",
          "new_line_content": "        av_sha1_init(&context);",
          "content_same": false
        },
        {
          "line": 138,
          "old_api": null,
          "new_api": "av_sha1_update",
          "old_text": null,
          "new_text": "av_sha1_update(&context, \"abc\", 3)",
          "old_line_content": "        else",
          "new_line_content": "            av_sha1_update(&context, \"abc\", 3);",
          "content_same": false
        },
        {
          "line": 74,
          "old_api": null,
          "new_api": "R4",
          "old_text": null,
          "new_text": "R4(e,a,b,c,d,71)",
          "old_line_content": "#endif",
          "new_line_content": "    R4(c,d,e,a,b,68); R4(b,c,d,e,a,69); R4(a,b,c,d,e,70); R4(e,a,b,c,d,71);",
          "content_same": false
        },
        {
          "line": 44,
          "old_api": null,
          "new_api": "R0",
          "old_text": null,
          "new_text": "R0(b,c,d,e,a,4+i)",
          "old_line_content": "    for(i=20; i<40; i+=5){",
          "new_line_content": "        R0(a,b,c,d,e,0+i); R0(e,a,b,c,d,1+i); R0(d,e,a,b,c,2+i); R0(c,d,e,a,b,3+i); R0(b,c,d,e,a,4+i);",
          "content_same": false
        },
        {
          "line": 75,
          "old_api": null,
          "new_api": "R4",
          "old_text": null,
          "new_text": "R4(a,b,c,d,e,75)",
          "old_line_content": "    state[0] += a;",
          "new_line_content": "    R4(d,e,a,b,c,72); R4(c,d,e,a,b,73); R4(b,c,d,e,a,74); R4(a,b,c,d,e,75);",
          "content_same": false
        },
        {
          "line": 46,
          "old_api": null,
          "new_api": "R1",
          "old_text": null,
          "new_text": "R1(b,c,d,e,a,19)",
          "old_line_content": "    }",
          "new_line_content": "    R0(a,b,c,d,e,15); R1(e,a,b,c,d,16); R1(d,e,a,b,c,17); R1(c,d,e,a,b,18); R1(b,c,d,e,a,19);",
          "content_same": false
        },
        {
          "line": 76,
          "old_api": null,
          "new_api": "R4",
          "old_text": null,
          "new_text": "R4(b,c,d,e,a,79)",
          "old_line_content": "    state[1] += b;",
          "new_line_content": "    R4(e,a,b,c,d,76); R4(d,e,a,b,c,77); R4(c,d,e,a,b,78); R4(b,c,d,e,a,79);",
          "content_same": false
        },
        {
          "line": 107,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(&context->buffer[j], &data[i], len - i)",
          "old_line_content": "void av_sha1_final(AVSHA1* context, uint8_t digest[20]){",
          "new_line_content": "    memcpy(&context->buffer[j], &data[i], len - i);",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": null,
          "new_api": "be2me_64",
          "old_text": null,
          "new_text": "be2me_64(context->count)",
          "old_line_content": "    while ((context->count & 504) != 448) {",
          "new_line_content": "    uint64_t finalcount= be2me_64(context->count);",
          "content_same": false
        },
        {
          "line": 146,
          "old_api": null,
          "new_api": "printf",
          "old_text": null,
          "new_text": "printf(\"%02X\", digest[i])",
          "old_line_content": "    //Test Vectors (from FIPS PUB 180-1)",
          "new_line_content": "            printf(\"%02X\", digest[i]);",
          "content_same": false
        },
        {
          "line": 114,
          "old_api": null,
          "new_api": "av_sha1_update",
          "old_text": null,
          "new_text": "av_sha1_update(context, \"\\200\", 1)",
          "old_line_content": "    }",
          "new_line_content": "    av_sha1_update(context, \"\\200\", 1);",
          "content_same": false
        },
        {
          "line": 116,
          "old_api": null,
          "new_api": "av_sha1_update",
          "old_text": null,
          "new_text": "av_sha1_update(context, \"\\0\", 1)",
          "old_line_content": "    for (i = 0; i < 20; i++) {",
          "new_line_content": "        av_sha1_update(context, \"\\0\", 1);",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": null,
          "new_api": "printf",
          "old_text": null,
          "new_text": "printf(\"A9993E36 4706816A BA3E2571 7850C26C 9CD0D89D\\n\"\n           \"84983E44 1C3BD26E BAAE4AA1 F95129E5 E54670F1\\n\"\n           \"34AA973C D4C4DAA4 F61EEB2B DBAD2731 6534016F\\n\")",
          "old_line_content": "",
          "new_line_content": "    printf(\"A9993E36 4706816A BA3E2571 7850C26C 9CD0D89D\\n\"",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": null,
          "new_api": "av_sha1_update",
          "old_text": null,
          "new_text": "av_sha1_update(context, &finalcount, 8)",
          "old_line_content": "    }",
          "new_line_content": "    av_sha1_update(context, &finalcount, 8);  /* Should cause a transform() */",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 97,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(&context->buffer[j], data, (i = 64-j))",
          "new_text": null,
          "old_line_content": "        memcpy(&context->buffer[j], data, (i = 64-j));",
          "new_line_content": "    j = (context->count >> 3) & 63;",
          "content_same": false
        },
        {
          "line": 98,
          "old_api": "transform",
          "new_api": null,
          "old_text": "transform(context->state, context->buffer)",
          "new_text": null,
          "old_line_content": "        transform(context->state, context->buffer);",
          "new_line_content": "    context->count += len << 3;",
          "content_same": false
        },
        {
          "line": 133,
          "old_api": "av_sha1_init",
          "new_api": null,
          "old_text": "av_sha1_init(&context)",
          "new_text": null,
          "old_line_content": "        av_sha1_init(&context);",
          "new_line_content": "    unsigned char digest[20];",
          "content_same": false
        },
        {
          "line": 135,
          "old_api": "av_sha1_update",
          "new_api": null,
          "old_text": "av_sha1_update(&context, \"abc\", 3)",
          "new_text": null,
          "old_line_content": "            av_sha1_update(&context, \"abc\", 3);",
          "new_line_content": "    for(k=0; k<3; k++){",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(&context->buffer[j], &data[i], len - i)",
          "new_text": null,
          "old_line_content": "    memcpy(&context->buffer[j], &data[i], len - i);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 137,
          "old_api": "av_sha1_update",
          "new_api": null,
          "old_text": "av_sha1_update(&context, \"abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq\", 56)",
          "new_text": null,
          "old_line_content": "            av_sha1_update(&context, \"abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq\", 56);",
          "new_line_content": "        if(k==0)",
          "content_same": false
        },
        {
          "line": 41,
          "old_api": "R0",
          "new_api": null,
          "old_text": "R0(b,c,d,e,a,4+i)",
          "new_text": null,
          "old_line_content": "        R0(a,b,c,d,e,0+i); R0(e,a,b,c,d,1+i); R0(d,e,a,b,c,2+i); R0(c,d,e,a,b,3+i); R0(b,c,d,e,a,4+i);",
          "new_line_content": "    e = state[4];",
          "content_same": false
        },
        {
          "line": 43,
          "old_api": "R1",
          "new_api": null,
          "old_text": "R1(b,c,d,e,a,19)",
          "new_text": null,
          "old_line_content": "    R0(a,b,c,d,e,15); R1(e,a,b,c,d,16); R1(d,e,a,b,c,17); R1(c,d,e,a,b,18); R1(b,c,d,e,a,19);",
          "new_line_content": "    for(i=0; i<15; i+=5){",
          "content_same": false
        },
        {
          "line": 141,
          "old_api": "av_sha1_final",
          "new_api": null,
          "old_text": "av_sha1_final(&context, digest)",
          "new_text": null,
          "old_line_content": "        av_sha1_final(&context, digest);",
          "new_line_content": "        else",
          "content_same": false
        },
        {
          "line": 45,
          "old_api": "R2",
          "new_api": null,
          "old_text": "R2(b,c,d,e,a,4+i)",
          "new_text": null,
          "old_line_content": "        R2(a,b,c,d,e,0+i); R2(e,a,b,c,d,1+i); R2(d,e,a,b,c,2+i); R2(c,d,e,a,b,3+i); R2(b,c,d,e,a,4+i);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 109,
          "old_api": "be2me_64",
          "new_api": null,
          "old_text": "be2me_64(context->count)",
          "new_text": null,
          "old_line_content": "    uint64_t finalcount= be2me_64(context->count);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 111,
          "old_api": "av_sha1_update",
          "new_api": null,
          "old_text": "av_sha1_update(context, \"\\200\", 1)",
          "new_text": null,
          "old_line_content": "    av_sha1_update(context, \"\\200\", 1);",
          "new_line_content": "    int i;",
          "content_same": false
        },
        {
          "line": 113,
          "old_api": "av_sha1_update",
          "new_api": null,
          "old_text": "av_sha1_update(context, \"\\0\", 1)",
          "new_text": null,
          "old_line_content": "        av_sha1_update(context, \"\\0\", 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 115,
          "old_api": "av_sha1_update",
          "new_api": null,
          "old_text": "av_sha1_update(context, &finalcount, 8)",
          "new_text": null,
          "old_line_content": "    av_sha1_update(context, &finalcount, 8);  /* Should cause a transform() */",
          "new_line_content": "    while ((context->count & 504) != 448) {",
          "content_same": false
        },
        {
          "line": 55,
          "old_api": "R0",
          "new_api": null,
          "old_text": "R0(d,e,a,b,c, 7)",
          "new_text": null,
          "old_line_content": "    R0(b,c,d,e,a, 4); R0(a,b,c,d,e, 5); R0(e,a,b,c,d, 6); R0(d,e,a,b,c, 7);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 56,
          "old_api": "R0",
          "new_api": null,
          "old_text": "R0(e,a,b,c,d,11)",
          "new_text": null,
          "old_line_content": "    R0(c,d,e,a,b, 8); R0(b,c,d,e,a, 9); R0(a,b,c,d,e,10); R0(e,a,b,c,d,11);",
          "new_line_content": "#else",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 17,
      "total_additions": 17,
      "total_deletions": 16,
      "total_api_changes": 50
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 4,
        "api_related_lines": 50,
        "non_api_lines": 3,
        "non_api_line_numbers": [
          32,
          33,
          35
        ]
      }
    },
    "api_calls_before": 121,
    "api_calls_after": 122,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 1,
      "total_diff_lines": 17
    }
  }
}