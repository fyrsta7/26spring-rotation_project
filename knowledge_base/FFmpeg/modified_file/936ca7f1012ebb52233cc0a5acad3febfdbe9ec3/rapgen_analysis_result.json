{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/936ca7f1012ebb52233cc0a5acad3febfdbe9ec3",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/936ca7f1012ebb52233cc0a5acad3febfdbe9ec3/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/936ca7f1012ebb52233cc0a5acad3febfdbe9ec3/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/936ca7f1012ebb52233cc0a5acad3febfdbe9ec3/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1405,
          "old_api": "bytestream2_tell",
          "new_api": "bytestream2_get_be32u",
          "old_text": "bytestream2_tell(&ctx->gb)",
          "new_text": "bytestream2_get_be32u(&ctx->gb)",
          "old_line_content": "            pos  = bytestream2_tell(&ctx->gb);",
          "new_line_content": "            sig  = bytestream2_get_be32u(&ctx->gb);",
          "content_same": false
        },
        {
          "line": 1407,
          "old_api": "bytestream2_get_bytes_left",
          "new_api": "bytestream2_tell",
          "old_text": "bytestream2_get_bytes_left(&ctx->gb)",
          "new_text": "bytestream2_tell(&ctx->gb)",
          "old_line_content": "            if (bytestream2_get_bytes_left(&ctx->gb) < size) {",
          "new_line_content": "            pos  = bytestream2_tell(&ctx->gb);",
          "content_same": false
        },
        {
          "line": 1414,
          "old_api": "av_log",
          "new_api": "MKBETAG",
          "old_text": "av_log(avctx, AV_LOG_ERROR,\n                           \"Incorrect palette block size %\"PRIu32\".\\n\", size)",
          "new_text": "MKBETAG('N', 'P', 'A', 'L')",
          "old_line_content": "                    av_log(avctx, AV_LOG_ERROR,",
          "new_line_content": "            case MKBETAG('N', 'P', 'A', 'L'):",
          "content_same": false
        },
        {
          "line": 1421,
          "old_api": "MKBETAG",
          "new_api": "bytestream2_get_be24u",
          "old_text": "MKBETAG('F', 'O', 'B', 'J')",
          "new_text": "bytestream2_get_be24u(&ctx->gb)",
          "old_line_content": "            case MKBETAG('F', 'O', 'B', 'J'):",
          "new_line_content": "                    ctx->pal[i] = 0xFFU << 24 | bytestream2_get_be24u(&ctx->gb);",
          "content_same": false
        },
        {
          "line": 1437,
          "old_api": "AV_RB24",
          "new_api": "av_clip_uint8",
          "old_text": "AV_RB24(tmp)",
          "new_text": "av_clip_uint8((t * 129 + ctx->delta_pal[i * 3 + j]) >> 7)",
          "old_line_content": "                        ctx->pal[i] = 0xFFU << 24 | AV_RB24(tmp);",
          "new_line_content": "                            tmp[j] = av_clip_uint8((t * 129 + ctx->delta_pal[i * 3 + j]) >> 7);",
          "content_same": false
        },
        {
          "line": 1448,
          "old_api": "bytestream2_get_le16u",
          "new_api": "bytestream2_skipu",
          "old_text": "bytestream2_get_le16u(&ctx->gb)",
          "new_text": "bytestream2_skipu(&ctx->gb, 4)",
          "old_line_content": "                        ctx->delta_pal[i] = bytestream2_get_le16u(&ctx->gb);",
          "new_line_content": "                    bytestream2_skipu(&ctx->gb, 4);",
          "content_same": false
        },
        {
          "line": 1453,
          "old_api": "memset",
          "new_api": "bytestream2_get_be24u",
          "old_text": "memset(ctx->pal, 0, sizeof(ctx->pal))",
          "new_text": "bytestream2_get_be24u(&ctx->gb)",
          "old_line_content": "                        memset(ctx->pal, 0, sizeof(ctx->pal));",
          "new_line_content": "                            ctx->pal[i] = 0xFFU << 24 | bytestream2_get_be24u(&ctx->gb);",
          "content_same": false
        },
        {
          "line": 1472,
          "old_api": "bytestream2_skip",
          "new_api": "bytestream2_seek",
          "old_text": "bytestream2_skip(&ctx->gb, 1)",
          "new_text": "bytestream2_seek(&ctx->gb, pos + size, SEEK_SET)",
          "old_line_content": "                bytestream2_skip(&ctx->gb, 1);",
          "new_line_content": "            bytestream2_seek(&ctx->gb, pos + size, SEEK_SET);",
          "content_same": false
        },
        {
          "line": 1478,
          "old_api": "memcpy",
          "new_api": "copy_output",
          "old_text": "memcpy(ctx->frame->data[1], ctx->pal, 1024)",
          "new_text": "copy_output(ctx, NULL)",
          "old_line_content": "        memcpy(ctx->frame->data[1], ctx->pal, 1024);",
          "new_line_content": "        if ((ret = copy_output(ctx, NULL)))",
          "content_same": false
        },
        {
          "line": 1496,
          "old_api": "av_log",
          "new_api": "FF_ARRAY_ELEMS",
          "old_text": "av_log(avctx, AV_LOG_ERROR,\n                       \"Subcodec %d: error decoding frame.\\n\", header.codec)",
          "new_text": "FF_ARRAY_ELEMS(v1_decoders)",
          "old_line_content": "                av_log(avctx, AV_LOG_ERROR,",
          "new_line_content": "        if (header.codec < FF_ARRAY_ELEMS(v1_decoders)) {",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1409,
          "old_api": null,
          "new_api": "bytestream2_get_bytes_left",
          "old_text": null,
          "new_text": "bytestream2_get_bytes_left(&ctx->gb)",
          "old_line_content": "                break;",
          "new_line_content": "            if (bytestream2_get_bytes_left(&ctx->gb) < size) {",
          "content_same": false
        },
        {
          "line": 1410,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Incorrect chunk size %\"PRIu32\".\\n\", size)",
          "old_line_content": "            }",
          "new_line_content": "                av_log(avctx, AV_LOG_ERROR, \"Incorrect chunk size %\"PRIu32\".\\n\", size);",
          "content_same": false
        },
        {
          "line": 1416,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR,\n                           \"Incorrect palette block size %\"PRIu32\".\\n\", size)",
          "old_line_content": "                    return AVERROR_INVALIDDATA;",
          "new_line_content": "                    av_log(avctx, AV_LOG_ERROR,",
          "content_same": false
        },
        {
          "line": 1423,
          "old_api": null,
          "new_api": "MKBETAG",
          "old_text": null,
          "new_text": "MKBETAG('F', 'O', 'B', 'J')",
          "old_line_content": "                    return AVERROR_INVALIDDATA;",
          "new_line_content": "            case MKBETAG('F', 'O', 'B', 'J'):",
          "content_same": false
        },
        {
          "line": 1426,
          "old_api": null,
          "new_api": "process_frame_obj",
          "old_text": null,
          "new_text": "process_frame_obj(ctx)",
          "old_line_content": "                break;",
          "new_line_content": "                if (ret = process_frame_obj(ctx))",
          "content_same": false
        },
        {
          "line": 1429,
          "old_api": null,
          "new_api": "MKBETAG",
          "old_text": null,
          "new_text": "MKBETAG('X', 'P', 'A', 'L')",
          "old_line_content": "                    uint8_t tmp[3];",
          "new_line_content": "            case MKBETAG('X', 'P', 'A', 'L'):",
          "content_same": false
        },
        {
          "line": 1439,
          "old_api": null,
          "new_api": "AV_RB24",
          "old_text": null,
          "new_text": "AV_RB24(tmp)",
          "old_line_content": "                } else {",
          "new_line_content": "                        ctx->pal[i] = 0xFFU << 24 | AV_RB24(tmp);",
          "content_same": false
        },
        {
          "line": 1443,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR,\n                               \"Incorrect palette change block size %\"PRIu32\".\\n\",\n                               size)",
          "old_line_content": "                               size);",
          "new_line_content": "                        av_log(avctx, AV_LOG_ERROR,",
          "content_same": false
        },
        {
          "line": 1450,
          "old_api": null,
          "new_api": "bytestream2_get_le16u",
          "old_text": null,
          "new_text": "bytestream2_get_le16u(&ctx->gb)",
          "old_line_content": "                        for (i = 0; i < PALETTE_SIZE; i++)",
          "new_line_content": "                        ctx->delta_pal[i] = bytestream2_get_le16u(&ctx->gb);",
          "content_same": false
        },
        {
          "line": 1455,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(ctx->pal, 0, sizeof(ctx->pal))",
          "old_line_content": "                }",
          "new_line_content": "                        memset(ctx->pal, 0, sizeof(ctx->pal));",
          "content_same": false
        },
        {
          "line": 1459,
          "old_api": null,
          "new_api": "MKBETAG",
          "old_text": null,
          "new_text": "MKBETAG('S', 'T', 'O', 'R')",
          "old_line_content": "                break;",
          "new_line_content": "            case MKBETAG('S', 'T', 'O', 'R'):",
          "content_same": false
        },
        {
          "line": 1462,
          "old_api": null,
          "new_api": "MKBETAG",
          "old_text": null,
          "new_text": "MKBETAG('F', 'T', 'C', 'H')",
          "old_line_content": "                break;",
          "new_line_content": "            case MKBETAG('F', 'T', 'C', 'H'):",
          "content_same": false
        },
        {
          "line": 1463,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(ctx->frm0, ctx->stored_frame, ctx->buf_size)",
          "old_line_content": "            default:",
          "new_line_content": "                memcpy(ctx->frm0, ctx->stored_frame, ctx->buf_size);",
          "content_same": false
        },
        {
          "line": 1466,
          "old_api": null,
          "new_api": "bytestream2_skip",
          "old_text": null,
          "new_text": "bytestream2_skip(&ctx->gb, size)",
          "old_line_content": "                       \"Unknown/unsupported chunk %\"PRIx32\".\\n\", sig);",
          "new_line_content": "                bytestream2_skip(&ctx->gb, size);",
          "content_same": false
        },
        {
          "line": 1467,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_DEBUG,\n                       \"Unknown/unsupported chunk %\"PRIx32\".\\n\", sig)",
          "old_line_content": "                break;",
          "new_line_content": "                av_log(avctx, AV_LOG_DEBUG,",
          "content_same": false
        },
        {
          "line": 1474,
          "old_api": null,
          "new_api": "bytestream2_skip",
          "old_text": null,
          "new_text": "bytestream2_skip(&ctx->gb, 1)",
          "old_line_content": "        if (to_store)",
          "new_line_content": "                bytestream2_skip(&ctx->gb, 1);",
          "content_same": false
        },
        {
          "line": 1477,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(ctx->stored_frame, ctx->frm0, ctx->buf_size)",
          "old_line_content": "            return ret;",
          "new_line_content": "            memcpy(ctx->stored_frame, ctx->frm0, ctx->buf_size);",
          "content_same": false
        },
        {
          "line": 1480,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(ctx->frame->data[1], ctx->pal, 1024)",
          "old_line_content": "        SANMFrameHeader header;",
          "new_line_content": "        memcpy(ctx->frame->data[1], ctx->pal, 1024);",
          "content_same": false
        },
        {
          "line": 1484,
          "old_api": null,
          "new_api": "read_frame_header",
          "old_text": null,
          "new_text": "read_frame_header(ctx, &header)",
          "old_line_content": "",
          "new_line_content": "        if ((ret = read_frame_header(ctx, &header)))",
          "content_same": false
        },
        {
          "line": 1490,
          "old_api": null,
          "new_api": "fill_frame",
          "old_text": null,
          "new_text": "fill_frame(ctx->frm1, ctx->npixels, header.bg_color)",
          "old_line_content": "        } else {",
          "new_line_content": "            fill_frame(ctx->frm1, ctx->npixels, header.bg_color);",
          "content_same": false
        },
        {
          "line": 1363,
          "old_api": null,
          "new_api": "av_memcpy_backptr",
          "old_text": null,
          "new_text": "av_memcpy_backptr((uint8_t*)pbuf, 2, 2*buf_size)",
          "old_line_content": "}",
          "new_line_content": "        av_memcpy_backptr((uint8_t*)pbuf, 2, 2*buf_size);",
          "content_same": false
        },
        {
          "line": 1491,
          "old_api": null,
          "new_api": "fill_frame",
          "old_text": null,
          "new_text": "fill_frame(ctx->frm2, ctx->npixels, header.bg_color)",
          "old_line_content": "            ctx->frame->pict_type = AV_PICTURE_TYPE_P;",
          "new_line_content": "            fill_frame(ctx->frm2, ctx->npixels, header.bg_color);",
          "content_same": false
        },
        {
          "line": 1497,
          "old_api": null,
          "new_api": "v1_decoders[header.codec](ctx)",
          "old_text": null,
          "new_text": "v1_decoders[header.codec](ctx)",
          "old_line_content": "                       \"Subcodec %d: error decoding frame.\\n\", header.codec);",
          "new_line_content": "            if ((ret = v1_decoders[header.codec](ctx))) {",
          "content_same": false
        },
        {
          "line": 1498,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR,\n                       \"Subcodec %d: error decoding frame.\\n\", header.codec)",
          "old_line_content": "                return ret;",
          "new_line_content": "                av_log(avctx, AV_LOG_ERROR,",
          "content_same": false
        },
        {
          "line": 1374,
          "old_api": null,
          "new_api": "ff_get_buffer",
          "old_text": null,
          "new_text": "ff_get_buffer(ctx->avctx, ctx->frame, 0)",
          "old_line_content": "",
          "new_line_content": "    if ((ret = ff_get_buffer(ctx->avctx, ctx->frame, 0)) < 0)",
          "content_same": false
        },
        {
          "line": 1503,
          "old_api": null,
          "new_api": "avpriv_request_sample",
          "old_text": null,
          "new_text": "avpriv_request_sample(avctx, \"Subcodec %d\", header.codec)",
          "old_line_content": "        }",
          "new_line_content": "            avpriv_request_sample(avctx, \"Subcodec %d\", header.codec);",
          "content_same": false
        },
        {
          "line": 1507,
          "old_api": null,
          "new_api": "copy_output",
          "old_text": null,
          "new_text": "copy_output(ctx, &header)",
          "old_line_content": "    }",
          "new_line_content": "        if ((ret = copy_output(ctx, &header)))",
          "content_same": false
        },
        {
          "line": 1381,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(dst, src, srcpitch)",
          "old_line_content": "        dst += dstpitch;",
          "new_line_content": "        memcpy(dst, src, srcpitch);",
          "content_same": false
        },
        {
          "line": 1511,
          "old_api": null,
          "new_api": "rotate_bufs",
          "old_text": null,
          "new_text": "rotate_bufs(ctx, ctx->rotate_code)",
          "old_line_content": "    *got_frame_ptr = 1;",
          "new_line_content": "        rotate_bufs(ctx, ctx->rotate_code);",
          "content_same": false
        },
        {
          "line": 1520,
          "old_api": null,
          "new_api": "NULL_IF_CONFIG_SMALL",
          "old_text": null,
          "new_text": "NULL_IF_CONFIG_SMALL(\"LucasArts SANM/Smush video\")",
          "old_line_content": "    .id             = AV_CODEC_ID_SANM,",
          "new_line_content": "    .long_name      = NULL_IF_CONFIG_SMALL(\"LucasArts SANM/Smush video\"),",
          "content_same": false
        },
        {
          "line": 1396,
          "old_api": null,
          "new_api": "bytestream2_init",
          "old_text": null,
          "new_text": "bytestream2_init(&ctx->gb, pkt->data, pkt->size)",
          "old_line_content": "    if (!ctx->version) {",
          "new_line_content": "    bytestream2_init(&ctx->gb, pkt->data, pkt->size);",
          "content_same": false
        },
        {
          "line": 1401,
          "old_api": null,
          "new_api": "bytestream2_get_bytes_left",
          "old_text": null,
          "new_text": "bytestream2_get_bytes_left(&ctx->gb)",
          "old_line_content": "            int pos;",
          "new_line_content": "        while (bytestream2_get_bytes_left(&ctx->gb) >= 8) {",
          "content_same": false
        },
        {
          "line": 1406,
          "old_api": null,
          "new_api": "bytestream2_get_be32u",
          "old_text": null,
          "new_text": "bytestream2_get_be32u(&ctx->gb)",
          "old_line_content": "",
          "new_line_content": "            size = bytestream2_get_be32u(&ctx->gb);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1408,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Incorrect chunk size %\"PRIu32\".\\n\", size)",
          "new_text": null,
          "old_line_content": "                av_log(avctx, AV_LOG_ERROR, \"Incorrect chunk size %\"PRIu32\".\\n\", size);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1412,
          "old_api": "MKBETAG",
          "new_api": null,
          "old_text": "MKBETAG('N', 'P', 'A', 'L')",
          "new_text": null,
          "old_line_content": "            case MKBETAG('N', 'P', 'A', 'L'):",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1419,
          "old_api": "bytestream2_get_be24u",
          "new_api": null,
          "old_text": "bytestream2_get_be24u(&ctx->gb)",
          "new_text": null,
          "old_line_content": "                    ctx->pal[i] = 0xFFU << 24 | bytestream2_get_be24u(&ctx->gb);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1424,
          "old_api": "process_frame_obj",
          "new_api": null,
          "old_text": "process_frame_obj(ctx)",
          "new_text": null,
          "old_line_content": "                if (ret = process_frame_obj(ctx))",
          "new_line_content": "                if (size < 16)",
          "content_same": false
        },
        {
          "line": 1427,
          "old_api": "MKBETAG",
          "new_api": null,
          "old_text": "MKBETAG('X', 'P', 'A', 'L')",
          "new_text": null,
          "old_line_content": "            case MKBETAG('X', 'P', 'A', 'L'):",
          "new_line_content": "                    return ret;",
          "content_same": false
        },
        {
          "line": 1435,
          "old_api": "av_clip_uint8",
          "new_api": null,
          "old_text": "av_clip_uint8((t * 129 + ctx->delta_pal[i * 3 + j]) >> 7)",
          "new_text": null,
          "old_line_content": "                            tmp[j] = av_clip_uint8((t * 129 + ctx->delta_pal[i * 3 + j]) >> 7);",
          "new_line_content": "                        for (j = 0; j < 3; j++) {",
          "content_same": false
        },
        {
          "line": 1441,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR,\n                               \"Incorrect palette change block size %\"PRIu32\".\\n\",\n                               size)",
          "new_text": null,
          "old_line_content": "                        av_log(avctx, AV_LOG_ERROR,",
          "new_line_content": "                } else {",
          "content_same": false
        },
        {
          "line": 1446,
          "old_api": "bytestream2_skipu",
          "new_api": null,
          "old_text": "bytestream2_skipu(&ctx->gb, 4)",
          "new_text": null,
          "old_line_content": "                    bytestream2_skipu(&ctx->gb, 4);",
          "new_line_content": "                        return AVERROR_INVALIDDATA;",
          "content_same": false
        },
        {
          "line": 1451,
          "old_api": "bytestream2_get_be24u",
          "new_api": null,
          "old_text": "bytestream2_get_be24u(&ctx->gb)",
          "new_text": null,
          "old_line_content": "                            ctx->pal[i] = 0xFFU << 24 | bytestream2_get_be24u(&ctx->gb);",
          "new_line_content": "                    if (size >= PALETTE_DELTA * 5 + 4) {",
          "content_same": false
        },
        {
          "line": 1457,
          "old_api": "MKBETAG",
          "new_api": null,
          "old_text": "MKBETAG('S', 'T', 'O', 'R')",
          "new_text": null,
          "old_line_content": "            case MKBETAG('S', 'T', 'O', 'R'):",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1460,
          "old_api": "MKBETAG",
          "new_api": null,
          "old_text": "MKBETAG('F', 'T', 'C', 'H')",
          "new_text": null,
          "old_line_content": "            case MKBETAG('F', 'T', 'C', 'H'):",
          "new_line_content": "                to_store = 1;",
          "content_same": false
        },
        {
          "line": 1461,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(ctx->frm0, ctx->stored_frame, ctx->buf_size)",
          "new_text": null,
          "old_line_content": "                memcpy(ctx->frm0, ctx->stored_frame, ctx->buf_size);",
          "new_line_content": "                break;",
          "content_same": false
        },
        {
          "line": 1464,
          "old_api": "bytestream2_skip",
          "new_api": null,
          "old_text": "bytestream2_skip(&ctx->gb, size)",
          "new_text": null,
          "old_line_content": "                bytestream2_skip(&ctx->gb, size);",
          "new_line_content": "                break;",
          "content_same": false
        },
        {
          "line": 1465,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_DEBUG,\n                       \"Unknown/unsupported chunk %\"PRIx32\".\\n\", sig)",
          "new_text": null,
          "old_line_content": "                av_log(avctx, AV_LOG_DEBUG,",
          "new_line_content": "            default:",
          "content_same": false
        },
        {
          "line": 1470,
          "old_api": "bytestream2_seek",
          "new_api": null,
          "old_text": "bytestream2_seek(&ctx->gb, pos + size, SEEK_SET)",
          "new_text": null,
          "old_line_content": "            bytestream2_seek(&ctx->gb, pos + size, SEEK_SET);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1475,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(ctx->stored_frame, ctx->frm0, ctx->buf_size)",
          "new_text": null,
          "old_line_content": "            memcpy(ctx->stored_frame, ctx->frm0, ctx->buf_size);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1476,
          "old_api": "copy_output",
          "new_api": null,
          "old_text": "copy_output(ctx, NULL)",
          "new_text": null,
          "old_line_content": "        if ((ret = copy_output(ctx, NULL)))",
          "new_line_content": "        if (to_store)",
          "content_same": false
        },
        {
          "line": 1482,
          "old_api": "read_frame_header",
          "new_api": null,
          "old_text": "read_frame_header(ctx, &header)",
          "new_text": null,
          "old_line_content": "        if ((ret = read_frame_header(ctx, &header)))",
          "new_line_content": "        SANMFrameHeader header;",
          "content_same": false
        },
        {
          "line": 1488,
          "old_api": "fill_frame",
          "new_api": null,
          "old_text": "fill_frame(ctx->frm1, ctx->npixels, header.bg_color)",
          "new_text": null,
          "old_line_content": "            fill_frame(ctx->frm1, ctx->npixels, header.bg_color);",
          "new_line_content": "        if ((ctx->frame->key_frame = !header.seq_num)) {",
          "content_same": false
        },
        {
          "line": 1489,
          "old_api": "fill_frame",
          "new_api": null,
          "old_text": "fill_frame(ctx->frm2, ctx->npixels, header.bg_color)",
          "new_text": null,
          "old_line_content": "            fill_frame(ctx->frm2, ctx->npixels, header.bg_color);",
          "new_line_content": "            ctx->frame->pict_type = AV_PICTURE_TYPE_I;",
          "content_same": false
        },
        {
          "line": 1494,
          "old_api": "FF_ARRAY_ELEMS",
          "new_api": null,
          "old_text": "FF_ARRAY_ELEMS(v1_decoders)",
          "new_text": null,
          "old_line_content": "        if (header.codec < FF_ARRAY_ELEMS(v1_decoders)) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1495,
          "old_api": "v1_decoders[header.codec](ctx)",
          "new_api": null,
          "old_text": "v1_decoders[header.codec](ctx)",
          "new_text": null,
          "old_line_content": "            if ((ret = v1_decoders[header.codec](ctx))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1372,
          "old_api": "ff_get_buffer",
          "new_api": null,
          "old_text": "ff_get_buffer(ctx->avctx, ctx->frame, 0)",
          "new_text": null,
          "old_line_content": "    if ((ret = ff_get_buffer(ctx->avctx, ctx->frame, 0)) < 0)",
          "new_line_content": "    ptrdiff_t dstpitch, srcpitch = ctx->pitch * (hdr ? sizeof(ctx->frm0[0]) : 1);",
          "content_same": false
        },
        {
          "line": 1501,
          "old_api": "avpriv_request_sample",
          "new_api": null,
          "old_text": "avpriv_request_sample(avctx, \"Subcodec %d\", header.codec)",
          "new_text": null,
          "old_line_content": "            avpriv_request_sample(avctx, \"Subcodec %d\", header.codec);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1505,
          "old_api": "copy_output",
          "new_api": null,
          "old_text": "copy_output(ctx, &header)",
          "new_text": null,
          "old_line_content": "        if ((ret = copy_output(ctx, &header)))",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1379,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(dst, src, srcpitch)",
          "new_text": null,
          "old_line_content": "        memcpy(dst, src, srcpitch);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1509,
          "old_api": "rotate_bufs",
          "new_api": null,
          "old_text": "rotate_bufs(ctx, ctx->rotate_code)",
          "new_text": null,
          "old_line_content": "        rotate_bufs(ctx, ctx->rotate_code);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1518,
          "old_api": "NULL_IF_CONFIG_SMALL",
          "new_api": null,
          "old_text": "NULL_IF_CONFIG_SMALL(\"LucasArts SANM/Smush video\")",
          "new_text": null,
          "old_line_content": "    .long_name      = NULL_IF_CONFIG_SMALL(\"LucasArts SANM/Smush video\"),",
          "new_line_content": "AVCodec ff_sanm_decoder = {",
          "content_same": false
        },
        {
          "line": 1394,
          "old_api": "bytestream2_init",
          "new_api": null,
          "old_text": "bytestream2_init(&ctx->gb, pkt->data, pkt->size)",
          "new_text": null,
          "old_line_content": "    bytestream2_init(&ctx->gb, pkt->data, pkt->size);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1399,
          "old_api": "bytestream2_get_bytes_left",
          "new_api": null,
          "old_text": "bytestream2_get_bytes_left(&ctx->gb)",
          "new_text": null,
          "old_line_content": "        while (bytestream2_get_bytes_left(&ctx->gb) >= 8) {",
          "new_line_content": "        int to_store = 0;",
          "content_same": false
        },
        {
          "line": 1403,
          "old_api": "bytestream2_get_be32u",
          "new_api": null,
          "old_text": "bytestream2_get_be32u(&ctx->gb)",
          "new_text": null,
          "old_line_content": "            sig  = bytestream2_get_be32u(&ctx->gb);",
          "new_line_content": "            int pos;",
          "content_same": false
        },
        {
          "line": 1404,
          "old_api": "bytestream2_get_be32u",
          "new_api": null,
          "old_text": "bytestream2_get_be32u(&ctx->gb)",
          "new_text": null,
          "old_line_content": "            size = bytestream2_get_be32u(&ctx->gb);",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 10,
      "total_additions": 33,
      "total_deletions": 32,
      "total_api_changes": 75
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 75,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          1361,
          1364
        ]
      }
    },
    "api_calls_before": 272,
    "api_calls_after": 273,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 1,
      "total_diff_lines": 17
    }
  }
}