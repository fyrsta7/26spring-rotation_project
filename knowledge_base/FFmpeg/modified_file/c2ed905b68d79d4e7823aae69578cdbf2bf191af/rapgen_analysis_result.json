{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/c2ed905b68d79d4e7823aae69578cdbf2bf191af",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/c2ed905b68d79d4e7823aae69578cdbf2bf191af/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/c2ed905b68d79d4e7823aae69578cdbf2bf191af/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/c2ed905b68d79d4e7823aae69578cdbf2bf191af/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 864,
          "old_api": "AVERROR",
          "new_api": "av_mallocz",
          "old_text": "AVERROR(ENOMEM)",
          "new_text": "av_mallocz(buf_size + AV_INPUT_BUFFER_PADDING_SIZE)",
          "old_line_content": "            return AVERROR(ENOMEM);",
          "new_line_content": "        buf2 = av_mallocz(buf_size + AV_INPUT_BUFFER_PADDING_SIZE);",
          "content_same": false
        },
        {
          "line": 866,
          "old_api": "AV_RB32",
          "new_api": "AVERROR",
          "old_text": "AV_RB32(buf)",
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "        if (IS_MARKER(AV_RB32(buf))) { /* frame starts with marker and needs to be parsed */",
          "new_line_content": "            return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 887,
          "old_api": "AVERROR",
          "new_api": "av_size_mult",
          "old_text": "AVERROR(ENOMEM)",
          "new_text": "av_size_mult(sizeof(*slices), n_slices+1, &next_allocated)",
          "old_line_content": "                        ret = AVERROR(ENOMEM);",
          "new_line_content": "                    av_size_mult(sizeof(*slices), n_slices+1, &next_allocated);",
          "content_same": false
        },
        {
          "line": 896,
          "old_api": "vc1_unescape_buffer",
          "new_api": "AVERROR",
          "old_text": "v->vc1dsp.vc1_unescape_buffer(start + 4, size,\n                                                              slices[n_slices].buf)",
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "                    buf_size3 = v->vc1dsp.vc1_unescape_buffer(start + 4, size,",
          "new_line_content": "                        ret = AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 920,
          "old_api": "av_mallocz",
          "new_api": "AVERROR",
          "old_text": "av_mallocz(size + AV_INPUT_BUFFER_PADDING_SIZE)",
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "                    slices[n_slices].buf = av_mallocz(size + AV_INPUT_BUFFER_PADDING_SIZE);",
          "new_line_content": "                        ret = AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 929,
          "old_api": "get_bits",
          "new_api": "vc1_unescape_buffer",
          "old_text": "get_bits(&slices[n_slices].gb, 9)",
          "new_text": "v->vc1dsp.vc1_unescape_buffer(start + 4, size,\n                                                              slices[n_slices].buf)",
          "old_line_content": "                    slices[n_slices].mby_start = get_bits(&slices[n_slices].gb, 9);",
          "new_line_content": "                    buf_size3 = v->vc1dsp.vc1_unescape_buffer(start + 4, size,",
          "content_same": false
        },
        {
          "line": 960,
          "old_api": "vc1_unescape_buffer",
          "new_api": "av_mallocz",
          "old_text": "v->vc1dsp.vc1_unescape_buffer(divider + 4, buf + buf_size - divider - 4, slices[n_slices].buf)",
          "new_text": "av_mallocz(buf_size + AV_INPUT_BUFFER_PADDING_SIZE)",
          "old_line_content": "                buf_size3 = v->vc1dsp.vc1_unescape_buffer(divider + 4, buf + buf_size - divider - 4, slices[n_slices].buf);",
          "new_line_content": "                slices[n_slices].buf = av_mallocz(buf_size + AV_INPUT_BUFFER_PADDING_SIZE);",
          "content_same": false
        },
        {
          "line": 1101,
          "old_api": "decode_slice",
          "new_api": "start_frame",
          "old_text": "avctx->hwaccel->decode_slice(avctx, buf_start, buf_start_second_field - buf_start)",
          "new_text": "avctx->hwaccel->start_frame(avctx, buf_start, buf_start_second_field - buf_start)",
          "old_line_content": "                if ((ret = avctx->hwaccel->decode_slice(avctx, buf_start, buf_start_second_field - buf_start)) < 0)",
          "new_line_content": "            if ((ret = avctx->hwaccel->start_frame(avctx, buf_start, buf_start_second_field - buf_start)) < 0)",
          "content_same": false
        },
        {
          "line": 1127,
          "old_api": "end_frame",
          "new_api": "decode_slice",
          "old_text": "avctx->hwaccel->end_frame(avctx)",
          "new_text": "avctx->hwaccel->decode_slice(avctx, slices[i].rawbuf, slices[i].raw_size)",
          "old_line_content": "            if ((ret = avctx->hwaccel->end_frame(avctx)) < 0)",
          "new_line_content": "                    if ((ret = avctx->hwaccel->decode_slice(avctx, slices[i].rawbuf, slices[i].raw_size)) < 0)",
          "content_same": false
        },
        {
          "line": 1148,
          "old_api": "decode_slice",
          "new_api": "start_frame",
          "old_text": "avctx->hwaccel->decode_slice(avctx, buf_start_second_field, (buf + buf_size) - buf_start_second_field)",
          "new_text": "avctx->hwaccel->start_frame(avctx, buf_start_second_field, (buf + buf_size) - buf_start_second_field)",
          "old_line_content": "                if ((ret = avctx->hwaccel->decode_slice(avctx, buf_start_second_field, (buf + buf_size) - buf_start_second_field)) < 0)",
          "new_line_content": "            if ((ret = avctx->hwaccel->start_frame(avctx, buf_start_second_field, (buf + buf_size) - buf_start_second_field)) < 0)",
          "content_same": false
        },
        {
          "line": 1174,
          "old_api": "end_frame",
          "new_api": "decode_slice",
          "old_text": "avctx->hwaccel->end_frame(avctx)",
          "new_text": "avctx->hwaccel->decode_slice(avctx, slices[i].rawbuf, slices[i].raw_size)",
          "old_line_content": "            if ((ret = avctx->hwaccel->end_frame(avctx)) < 0)",
          "new_line_content": "                    if ((ret = avctx->hwaccel->decode_slice(avctx, slices[i].rawbuf, slices[i].raw_size)) < 0)",
          "content_same": false
        },
        {
          "line": 1183,
          "old_api": "decode_slice",
          "new_api": "start_frame",
          "old_text": "avctx->hwaccel->decode_slice(avctx, buf_start, (buf + buf_size) - buf_start)",
          "new_text": "avctx->hwaccel->start_frame(avctx, buf_start, (buf + buf_size) - buf_start)",
          "old_line_content": "                if ((ret = avctx->hwaccel->decode_slice(avctx, buf_start, (buf + buf_size) - buf_start)) < 0)",
          "new_line_content": "            if ((ret = avctx->hwaccel->start_frame(avctx, buf_start, (buf + buf_size) - buf_start)) < 0)",
          "content_same": false
        },
        {
          "line": 1233,
          "old_api": "av_log",
          "new_api": "av_assert0 (mb_height > 0)",
          "old_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Slice %d starts beyond \"\n                           \"picture boundary (%d >= %d)\\n\", i,\n                           slices[i - 1].mby_start, mb_height)",
          "new_text": "av_assert0 (mb_height > 0)",
          "old_line_content": "                    av_log(v->s.avctx, AV_LOG_ERROR, \"Slice %d starts beyond \"",
          "new_line_content": "        av_assert0 (mb_height > 0);",
          "content_same": false
        },
        {
          "line": 1275,
          "old_api": "av_log",
          "new_api": "FFMAX",
          "old_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"first field slice count too large\\n\")",
          "new_text": "FFMAX(0, slices[i-1].mby_start % mb_height)",
          "old_line_content": "                    av_log(v->s.avctx, AV_LOG_ERROR, \"first field slice count too large\\n\");",
          "new_line_content": "            s->start_mb_y = (i == 0) ? 0 : FFMAX(0, slices[i-1].mby_start % mb_height);",
          "content_same": false
        },
        {
          "line": 1335,
          "old_api": "vc1_decode_sprites",
          "new_api": "av_frame_alloc",
          "old_text": "vc1_decode_sprites(v, &s->gb)",
          "new_text": "av_frame_alloc()",
          "old_line_content": "        if ((ret = vc1_decode_sprites(v, &s->gb)) < 0)",
          "new_line_content": "            !(v->sprite_output_frame = av_frame_alloc())) {",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1030,
          "old_api": null,
          "new_api": "ff_vc1_parse_frame_header",
          "old_text": null,
          "new_text": "ff_vc1_parse_frame_header(v, &s->gb)",
          "old_line_content": "            goto err;",
          "new_line_content": "        if ((ret = ff_vc1_parse_frame_header(v, &s->gb)) < 0) {",
          "content_same": false
        },
        {
          "line": 1034,
          "old_api": null,
          "new_api": "ff_vc1_parse_frame_header_adv",
          "old_text": null,
          "new_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "old_line_content": "",
          "new_line_content": "        if ((ret = ff_vc1_parse_frame_header_adv(v, &s->gb)) < 0) {",
          "content_same": false
        },
        {
          "line": 1041,
          "old_api": null,
          "new_api": "av_get_picture_type_char",
          "old_text": null,
          "new_text": "av_get_picture_type_char(s->pict_type)",
          "old_line_content": "        ret = AVERROR_INVALIDDATA;",
          "new_line_content": "        av_log(v->s.avctx, AV_LOG_DEBUG, \"pict_type: %c\\n\", av_get_picture_type_char(s->pict_type));",
          "content_same": false
        },
        {
          "line": 1045,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Sprite decoder: expected I-frame\\n\")",
          "old_line_content": "        && v->field_mode) {",
          "new_line_content": "        av_log(v->s.avctx, AV_LOG_ERROR, \"Sprite decoder: expected I-frame\\n\");",
          "content_same": false
        },
        {
          "line": 1056,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"image too short\\n\")",
          "old_line_content": "    // for skipping the frame",
          "new_line_content": "        av_log(v->s.avctx, AV_LOG_ERROR, \"image too short\\n\");",
          "content_same": false
        },
        {
          "line": 1067,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(v->s.avctx, AV_LOG_DEBUG, \"Skipping B frame without reference frames\\n\")",
          "old_line_content": "         avctx->skip_frame >= AVDISCARD_ALL) {",
          "new_line_content": "        av_log(v->s.avctx, AV_LOG_DEBUG, \"Skipping B frame without reference frames\\n\");",
          "content_same": false
        },
        {
          "line": 1076,
          "old_api": null,
          "new_api": "ff_mpv_frame_start",
          "old_text": null,
          "new_text": "ff_mpv_frame_start(s, avctx)",
          "old_line_content": "    v->s.current_picture_ptr->f->interlaced_frame = (v->fcm != PROGRESSIVE);",
          "new_line_content": "    if ((ret = ff_mpv_frame_start(s, avctx)) < 0) {",
          "content_same": false
        },
        {
          "line": 1106,
          "old_api": null,
          "new_api": "decode_slice",
          "old_text": null,
          "new_text": "avctx->hwaccel->decode_slice(avctx, buf_start, buf_start_second_field - buf_start)",
          "old_line_content": "",
          "new_line_content": "                if ((ret = avctx->hwaccel->decode_slice(avctx, buf_start, buf_start_second_field - buf_start)) < 0)",
          "content_same": false
        },
        {
          "line": 1109,
          "old_api": null,
          "new_api": "decode_slice",
          "old_text": null,
          "new_text": "avctx->hwaccel->decode_slice(avctx, buf_start, slices[0].rawbuf - buf_start)",
          "old_line_content": "                    s->mb_y = slices[i].mby_start;",
          "new_line_content": "                if ((ret = avctx->hwaccel->decode_slice(avctx, buf_start, slices[0].rawbuf - buf_start)) < 0)",
          "content_same": false
        },
        {
          "line": 1116,
          "old_api": null,
          "new_api": "get_bits1",
          "old_text": null,
          "new_text": "get_bits1(&s->gb)",
          "old_line_content": "                            if (avctx->err_recognition & AV_EF_EXPLODE)",
          "new_line_content": "                    v->pic_header_flag = get_bits1(&s->gb);",
          "content_same": false
        },
        {
          "line": 1118,
          "old_api": null,
          "new_api": "ff_vc1_parse_frame_header_adv",
          "old_text": null,
          "new_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "old_line_content": "                            continue;",
          "new_line_content": "                        if (ff_vc1_parse_frame_header_adv(v, &s->gb) < 0) {",
          "content_same": false
        },
        {
          "line": 1119,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\")",
          "old_line_content": "                        }",
          "new_line_content": "                            av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\");",
          "content_same": false
        },
        {
          "line": 1132,
          "old_api": null,
          "new_api": "end_frame",
          "old_text": null,
          "new_text": "avctx->hwaccel->end_frame(avctx)",
          "old_line_content": "            s->mb_y = slices[n_slices1 + 1].mby_start;",
          "new_line_content": "            if ((ret = avctx->hwaccel->end_frame(avctx)) < 0)",
          "content_same": false
        },
        {
          "line": 1141,
          "old_api": null,
          "new_api": "ff_vc1_parse_frame_header_adv",
          "old_text": null,
          "new_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "old_line_content": "            v->s.current_picture_ptr->f->pict_type = v->s.pict_type;",
          "new_line_content": "            if (ff_vc1_parse_frame_header_adv(v, &s->gb) < 0) {",
          "content_same": false
        },
        {
          "line": 1142,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"parsing header for second field failed\")",
          "old_line_content": "",
          "new_line_content": "                av_log(avctx, AV_LOG_ERROR, \"parsing header for second field failed\");",
          "content_same": false
        },
        {
          "line": 1153,
          "old_api": null,
          "new_api": "decode_slice",
          "old_text": null,
          "new_text": "avctx->hwaccel->decode_slice(avctx, buf_start_second_field, (buf + buf_size) - buf_start_second_field)",
          "old_line_content": "",
          "new_line_content": "                if ((ret = avctx->hwaccel->decode_slice(avctx, buf_start_second_field, (buf + buf_size) - buf_start_second_field)) < 0)",
          "content_same": false
        },
        {
          "line": 1156,
          "old_api": null,
          "new_api": "decode_slice",
          "old_text": null,
          "new_text": "avctx->hwaccel->decode_slice(avctx, buf_start_second_field, slices[n_slices1 + 2].rawbuf - buf_start_second_field)",
          "old_line_content": "                    s->mb_y = slices[i].mby_start;",
          "new_line_content": "                if ((ret = avctx->hwaccel->decode_slice(avctx, buf_start_second_field, slices[n_slices1 + 2].rawbuf - buf_start_second_field)) < 0)",
          "content_same": false
        },
        {
          "line": 1163,
          "old_api": null,
          "new_api": "get_bits1",
          "old_text": null,
          "new_text": "get_bits1(&s->gb)",
          "old_line_content": "                            if (avctx->err_recognition & AV_EF_EXPLODE)",
          "new_line_content": "                    v->pic_header_flag = get_bits1(&s->gb);",
          "content_same": false
        },
        {
          "line": 1165,
          "old_api": null,
          "new_api": "ff_vc1_parse_frame_header_adv",
          "old_text": null,
          "new_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "old_line_content": "                            continue;",
          "new_line_content": "                        if (ff_vc1_parse_frame_header_adv(v, &s->gb) < 0) {",
          "content_same": false
        },
        {
          "line": 1166,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\")",
          "old_line_content": "                        }",
          "new_line_content": "                            av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\");",
          "content_same": false
        },
        {
          "line": 1179,
          "old_api": null,
          "new_api": "end_frame",
          "old_text": null,
          "new_text": "avctx->hwaccel->end_frame(avctx)",
          "old_line_content": "                goto err;",
          "new_line_content": "            if ((ret = avctx->hwaccel->end_frame(avctx)) < 0)",
          "content_same": false
        },
        {
          "line": 1188,
          "old_api": null,
          "new_api": "decode_slice",
          "old_text": null,
          "new_text": "avctx->hwaccel->decode_slice(avctx, buf_start, (buf + buf_size) - buf_start)",
          "old_line_content": "                    goto err;",
          "new_line_content": "                if ((ret = avctx->hwaccel->decode_slice(avctx, buf_start, (buf + buf_size) - buf_start)) < 0)",
          "content_same": false
        },
        {
          "line": 1192,
          "old_api": null,
          "new_api": "decode_slice",
          "old_text": null,
          "new_text": "avctx->hwaccel->decode_slice(avctx, buf_start, slices[0].rawbuf - buf_start)",
          "old_line_content": "                    s->gb = slices[i].gb;",
          "new_line_content": "                if ((ret = avctx->hwaccel->decode_slice(avctx, buf_start, slices[0].rawbuf - buf_start)) < 0)",
          "content_same": false
        },
        {
          "line": 1200,
          "old_api": null,
          "new_api": "get_bits1",
          "old_text": null,
          "new_text": "get_bits1(&s->gb)",
          "old_line_content": "                            if (avctx->err_recognition & AV_EF_EXPLODE)",
          "new_line_content": "                    v->pic_header_flag = get_bits1(&s->gb);",
          "content_same": false
        },
        {
          "line": 1202,
          "old_api": null,
          "new_api": "ff_vc1_parse_frame_header_adv",
          "old_text": null,
          "new_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "old_line_content": "                            continue;",
          "new_line_content": "                        if (ff_vc1_parse_frame_header_adv(v, &s->gb) < 0) {",
          "content_same": false
        },
        {
          "line": 1203,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\")",
          "old_line_content": "                        }",
          "new_line_content": "                            av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\");",
          "content_same": false
        },
        {
          "line": 1211,
          "old_api": null,
          "new_api": "decode_slice",
          "old_text": null,
          "new_text": "avctx->hwaccel->decode_slice(avctx, slices[i].rawbuf, slices[i].raw_size)",
          "old_line_content": "                goto err;",
          "new_line_content": "                    if ((ret = avctx->hwaccel->decode_slice(avctx, slices[i].rawbuf, slices[i].raw_size)) < 0)",
          "content_same": false
        },
        {
          "line": 1215,
          "old_api": null,
          "new_api": "end_frame",
          "old_text": null,
          "new_text": "avctx->hwaccel->end_frame(avctx)",
          "old_line_content": "",
          "new_line_content": "            if ((ret = avctx->hwaccel->end_frame(avctx)) < 0)",
          "content_same": false
        },
        {
          "line": 1221,
          "old_api": null,
          "new_api": "ff_mpeg_er_frame_start",
          "old_text": null,
          "new_text": "ff_mpeg_er_frame_start(s)",
          "old_line_content": "            s->current_picture.f->linesize[1] <<= 1;",
          "new_line_content": "        ff_mpeg_er_frame_start(s);",
          "content_same": false
        },
        {
          "line": 1238,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Slice %d starts beyond \"\n                           \"picture boundary (%d >= %d)\\n\", i,\n                           slices[i - 1].mby_start, mb_height)",
          "old_line_content": "                v->second_field = 1;",
          "new_line_content": "                    av_log(v->s.avctx, AV_LOG_ERROR, \"Slice %d starts beyond \"",
          "content_same": false
        },
        {
          "line": 1244,
          "old_api": null,
          "new_api": "av_assert0",
          "old_text": null,
          "new_text": "av_assert0((s->mb_height & 1) == 0)",
          "old_line_content": "                v->blocks_off   = 0;",
          "new_line_content": "                av_assert0((s->mb_height & 1) == 0);",
          "content_same": false
        },
        {
          "line": 1255,
          "old_api": null,
          "new_api": "ff_vc1_parse_frame_header_adv",
          "old_text": null,
          "new_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "old_line_content": "                        continue;",
          "new_line_content": "                    if ((header_ret = ff_vc1_parse_frame_header_adv(v, &s->gb)) < 0) {",
          "content_same": false
        },
        {
          "line": 1256,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Field header damaged\\n\")",
          "old_line_content": "                    }",
          "new_line_content": "                        av_log(v->s.avctx, AV_LOG_ERROR, \"Field header damaged\\n\");",
          "content_same": false
        },
        {
          "line": 1262,
          "old_api": null,
          "new_api": "get_bits1",
          "old_text": null,
          "new_text": "get_bits1(&s->gb)",
          "old_line_content": "                        if (avctx->err_recognition & AV_EF_EXPLODE)",
          "new_line_content": "                } else if (get_bits1(&s->gb)) {",
          "content_same": false
        },
        {
          "line": 1264,
          "old_api": null,
          "new_api": "ff_vc1_parse_frame_header_adv",
          "old_text": null,
          "new_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "old_line_content": "                        continue;",
          "new_line_content": "                    if ((header_ret = ff_vc1_parse_frame_header_adv(v, &s->gb)) < 0) {",
          "content_same": false
        },
        {
          "line": 1265,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\")",
          "old_line_content": "                    }",
          "new_line_content": "                        av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\");",
          "content_same": false
        },
        {
          "line": 1277,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(mb_height, slices[i].mby_start % mb_height)",
          "old_line_content": "                }",
          "new_line_content": "                s->end_mb_y = (i == n_slices     ) ? mb_height : FFMIN(mb_height, slices[i].mby_start % mb_height);",
          "content_same": false
        },
        {
          "line": 1280,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"first field slice count too large\\n\")",
          "old_line_content": "            if (s->end_mb_y <= s->start_mb_y) {",
          "new_line_content": "                    av_log(v->s.avctx, AV_LOG_ERROR, \"first field slice count too large\\n\");",
          "content_same": false
        },
        {
          "line": 1283,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(mb_height, slices[i].mby_start % mb_height)",
          "old_line_content": "            }",
          "new_line_content": "                s->end_mb_y = (i == n_slices1 + 1) ? mb_height : FFMIN(mb_height, slices[i].mby_start % mb_height);",
          "content_same": false
        },
        {
          "line": 1286,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"end mb y %d %d invalid\\n\", s->end_mb_y, s->start_mb_y)",
          "old_line_content": "                !v->cbpcy_vlc) {",
          "new_line_content": "                av_log(v->s.avctx, AV_LOG_ERROR, \"end mb y %d %d invalid\\n\", s->end_mb_y, s->start_mb_y);",
          "content_same": false
        },
        {
          "line": 1292,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"missing cbpcy_vlc\\n\")",
          "old_line_content": "                s->gb = slices[i].gb;",
          "new_line_content": "                av_log(v->s.avctx, AV_LOG_ERROR, \"missing cbpcy_vlc\\n\");",
          "content_same": false
        },
        {
          "line": 1295,
          "old_api": null,
          "new_api": "ff_vc1_decode_blocks",
          "old_text": null,
          "new_text": "ff_vc1_decode_blocks(v)",
          "old_line_content": "        if (v->field_mode) {",
          "new_line_content": "            ff_vc1_decode_blocks(v);",
          "content_same": false
        },
        {
          "line": 1312,
          "old_api": null,
          "new_api": "ff_dlog",
          "old_text": null,
          "new_text": "ff_dlog(s->avctx, \"Consumed %i/%i bits\\n\",\n                get_bits_count(&s->gb), s->gb.size_in_bits)",
          "old_line_content": "            ret = AVERROR_INVALIDDATA;",
          "new_line_content": "        ff_dlog(s->avctx, \"Consumed %i/%i bits\\n\",",
          "content_same": false
        },
        {
          "line": 1313,
          "old_api": null,
          "new_api": "get_bits_count",
          "old_text": null,
          "new_text": "get_bits_count(&s->gb)",
          "old_line_content": "            goto err;",
          "new_line_content": "                get_bits_count(&s->gb), s->gb.size_in_bits);",
          "content_same": false
        },
        {
          "line": 1323,
          "old_api": null,
          "new_api": "ff_er_frame_end",
          "old_text": null,
          "new_text": "ff_er_frame_end(&s->er)",
          "old_line_content": "    if (avctx->codec_id == AV_CODEC_ID_WMV3IMAGE || avctx->codec_id == AV_CODEC_ID_VC1IMAGE) {",
          "new_line_content": "            ff_er_frame_end(&s->er);",
          "content_same": false
        },
        {
          "line": 1326,
          "old_api": null,
          "new_api": "ff_mpv_frame_end",
          "old_text": null,
          "new_text": "ff_mpv_frame_end(s)",
          "old_line_content": "        avctx->height = avctx->coded_height = v->output_height;",
          "new_line_content": "    ff_mpv_frame_end(s);",
          "content_same": false
        },
        {
          "line": 1336,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "            goto err;",
          "new_line_content": "            ret = AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1340,
          "old_api": null,
          "new_api": "vc1_decode_sprites",
          "old_text": null,
          "new_text": "vc1_decode_sprites(v, &s->gb)",
          "old_line_content": "        *got_frame = 1;",
          "new_line_content": "        if ((ret = vc1_decode_sprites(v, &s->gb)) < 0)",
          "content_same": false
        },
        {
          "line": 1348,
          "old_api": null,
          "new_api": "av_frame_ref",
          "old_text": null,
          "new_text": "av_frame_ref(pict, s->current_picture_ptr->f)",
          "old_line_content": "        } else if (s->last_picture_ptr) {",
          "new_line_content": "            if ((ret = av_frame_ref(pict, s->current_picture_ptr->f)) < 0)",
          "content_same": false
        },
        {
          "line": 1351,
          "old_api": null,
          "new_api": "ff_print_debug_info",
          "old_text": null,
          "new_text": "ff_print_debug_info(s, s->current_picture_ptr, pict)",
          "old_line_content": "            if (!v->field_mode)",
          "new_line_content": "                ff_print_debug_info(s, s->current_picture_ptr, pict);",
          "content_same": false
        },
        {
          "line": 1354,
          "old_api": null,
          "new_api": "av_frame_ref",
          "old_text": null,
          "new_text": "av_frame_ref(pict, s->last_picture_ptr->f)",
          "old_line_content": "        }",
          "new_line_content": "            if ((ret = av_frame_ref(pict, s->last_picture_ptr->f)) < 0)",
          "content_same": false
        },
        {
          "line": 1357,
          "old_api": null,
          "new_api": "ff_print_debug_info",
          "old_text": null,
          "new_text": "ff_print_debug_info(s, s->last_picture_ptr, pict)",
          "old_line_content": "end:",
          "new_line_content": "                ff_print_debug_info(s, s->last_picture_ptr, pict);",
          "content_same": false
        },
        {
          "line": 847,
          "old_api": null,
          "new_api": "AV_RB32",
          "old_text": null,
          "new_text": "AV_RB32(buf)",
          "old_line_content": "        /* special case for last picture */",
          "new_line_content": "    if (buf_size == 0 || (buf_size == 4 && AV_RB32(buf) == VC1_CODE_ENDOFSEQ)) {",
          "content_same": false
        },
        {
          "line": 850,
          "old_api": null,
          "new_api": "av_frame_ref",
          "old_text": null,
          "new_text": "av_frame_ref(pict, s->next_picture_ptr->f)",
          "old_line_content": "                return ret;",
          "new_line_content": "            if ((ret = av_frame_ref(pict, s->next_picture_ptr->f)) < 0)",
          "content_same": false
        },
        {
          "line": 1363,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(buf2)",
          "old_line_content": "",
          "new_line_content": "    av_free(buf2);",
          "content_same": false
        },
        {
          "line": 1366,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(slices)",
          "old_line_content": "    for (i = 0; i < n_slices; i++)",
          "new_line_content": "    av_free(slices);",
          "content_same": false
        },
        {
          "line": 1370,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(buf2)",
          "old_line_content": "}",
          "new_line_content": "    av_free(buf2);",
          "content_same": false
        },
        {
          "line": 1372,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(slices[i].buf)",
          "old_line_content": "",
          "new_line_content": "        av_free(slices[i].buf);",
          "content_same": false
        },
        {
          "line": 1373,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(slices)",
          "old_line_content": "static const enum AVPixelFormat vc1_hwaccel_pixfmt_list_420[] = {",
          "new_line_content": "    av_free(slices);",
          "content_same": false
        },
        {
          "line": 868,
          "old_api": null,
          "new_api": "AV_RB32",
          "old_text": null,
          "new_text": "AV_RB32(buf)",
          "old_line_content": "            int size;",
          "new_line_content": "        if (IS_MARKER(AV_RB32(buf))) { /* frame starts with marker and needs to be parsed */",
          "content_same": false
        },
        {
          "line": 874,
          "old_api": null,
          "new_api": "find_next_marker",
          "old_text": null,
          "new_text": "find_next_marker(start + 4, end)",
          "old_line_content": "                if (size <= 0) continue;",
          "new_line_content": "                next = find_next_marker(start + 4, end);",
          "content_same": false
        },
        {
          "line": 877,
          "old_api": null,
          "new_api": "AV_RB32",
          "old_text": null,
          "new_text": "AV_RB32(start)",
          "old_line_content": "                    if (avctx->hwaccel)",
          "new_line_content": "                switch (AV_RB32(start)) {",
          "content_same": false
        },
        {
          "line": 881,
          "old_api": null,
          "new_api": "vc1_unescape_buffer",
          "old_text": null,
          "new_text": "v->vc1dsp.vc1_unescape_buffer(start + 4, size, buf2)",
          "old_line_content": "                case VC1_CODE_FIELD: {",
          "new_line_content": "                    buf_size2 = v->vc1dsp.vc1_unescape_buffer(start + 4, size, buf2);",
          "content_same": false
        },
        {
          "line": 888,
          "old_api": null,
          "new_api": "av_fast_realloc",
          "old_text": null,
          "new_text": "av_fast_realloc(slices, &slices_allocated, next_allocated)",
          "old_line_content": "                        goto err;",
          "new_line_content": "                    tmp = next_allocated ? av_fast_realloc(slices, &slices_allocated, next_allocated) : NULL;",
          "content_same": false
        },
        {
          "line": 1401,
          "old_api": null,
          "new_api": "CODEC_LONG_NAME",
          "old_text": null,
          "new_text": "CODEC_LONG_NAME(\"SMPTE VC-1\")",
          "old_line_content": "    .close          = ff_vc1_decode_end,",
          "new_line_content": "    CODEC_LONG_NAME(\"SMPTE VC-1\"),",
          "content_same": false
        },
        {
          "line": 890,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "                    slices = tmp;",
          "new_line_content": "                        ret = AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 894,
          "old_api": null,
          "new_api": "av_mallocz",
          "old_text": null,
          "new_text": "av_mallocz(size + AV_INPUT_BUFFER_PADDING_SIZE)",
          "old_line_content": "                        goto err;",
          "new_line_content": "                    slices[n_slices].buf = av_mallocz(size + AV_INPUT_BUFFER_PADDING_SIZE);",
          "content_same": false
        },
        {
          "line": 1407,
          "old_api": null,
          "new_api": "FF_CODEC_DECODE_CB",
          "old_text": null,
          "new_text": "FF_CODEC_DECODE_CB(vc1_decode_frame)",
          "old_line_content": "#if CONFIG_VC1_DXVA2_HWACCEL",
          "new_line_content": "    FF_CODEC_DECODE_CB(vc1_decode_frame),",
          "content_same": false
        },
        {
          "line": 899,
          "old_api": null,
          "new_api": "vc1_unescape_buffer",
          "old_text": null,
          "new_text": "v->vc1dsp.vc1_unescape_buffer(start + 4, size,\n                                                              slices[n_slices].buf)",
          "old_line_content": "                                  buf_size3 << 3);",
          "new_line_content": "                    buf_size3 = v->vc1dsp.vc1_unescape_buffer(start + 4, size,",
          "content_same": false
        },
        {
          "line": 901,
          "old_api": null,
          "new_api": "init_get_bits",
          "old_text": null,
          "new_text": "init_get_bits(&slices[n_slices].gb, slices[n_slices].buf,\n                                  buf_size3 << 3)",
          "old_line_content": "                    slices[n_slices].rawbuf = start;",
          "new_line_content": "                    init_get_bits(&slices[n_slices].gb, slices[n_slices].buf,",
          "content_same": false
        },
        {
          "line": 1413,
          "old_api": null,
          "new_api": "HWACCEL_DXVA2",
          "old_text": null,
          "new_text": "HWACCEL_DXVA2(vc1)",
          "old_line_content": "#if CONFIG_VC1_D3D11VA2_HWACCEL",
          "new_line_content": "                        HWACCEL_DXVA2(vc1),",
          "content_same": false
        },
        {
          "line": 1416,
          "old_api": null,
          "new_api": "HWACCEL_D3D11VA",
          "old_text": null,
          "new_text": "HWACCEL_D3D11VA(vc1)",
          "old_line_content": "#if CONFIG_VC1_NVDEC_HWACCEL",
          "new_line_content": "                        HWACCEL_D3D11VA(vc1),",
          "content_same": false
        },
        {
          "line": 1419,
          "old_api": null,
          "new_api": "HWACCEL_D3D11VA2",
          "old_text": null,
          "new_text": "HWACCEL_D3D11VA2(vc1)",
          "old_line_content": "#if CONFIG_VC1_VAAPI_HWACCEL",
          "new_line_content": "                        HWACCEL_D3D11VA2(vc1),",
          "content_same": false
        },
        {
          "line": 1422,
          "old_api": null,
          "new_api": "HWACCEL_NVDEC",
          "old_text": null,
          "new_text": "HWACCEL_NVDEC(vc1)",
          "old_line_content": "#if CONFIG_VC1_VDPAU_HWACCEL",
          "new_line_content": "                        HWACCEL_NVDEC(vc1),",
          "content_same": false
        },
        {
          "line": 911,
          "old_api": null,
          "new_api": "vc1_unescape_buffer",
          "old_text": null,
          "new_text": "v->vc1dsp.vc1_unescape_buffer(start + 4, size, buf2)",
          "old_line_content": "                    break;",
          "new_line_content": "                    buf_size2 = v->vc1dsp.vc1_unescape_buffer(start + 4, size, buf2);",
          "content_same": false
        },
        {
          "line": 912,
          "old_api": null,
          "new_api": "init_get_bits",
          "old_text": null,
          "new_text": "init_get_bits(&s->gb, buf2, buf_size2 * 8)",
          "old_line_content": "                case VC1_CODE_SLICE: {",
          "new_line_content": "                    init_get_bits(&s->gb, buf2, buf_size2 * 8);",
          "content_same": false
        },
        {
          "line": 913,
          "old_api": null,
          "new_api": "ff_vc1_decode_entry_point",
          "old_text": null,
          "new_text": "ff_vc1_decode_entry_point(avctx, v, &s->gb)",
          "old_line_content": "                    int buf_size3;",
          "new_line_content": "                    ff_vc1_decode_entry_point(avctx, v, &s->gb);",
          "content_same": false
        },
        {
          "line": 1425,
          "old_api": null,
          "new_api": "HWACCEL_VAAPI",
          "old_text": null,
          "new_text": "HWACCEL_VAAPI(vc1)",
          "old_line_content": "                        NULL",
          "new_line_content": "                        HWACCEL_VAAPI(vc1),",
          "content_same": false
        },
        {
          "line": 1428,
          "old_api": null,
          "new_api": "HWACCEL_VDPAU",
          "old_text": null,
          "new_text": "HWACCEL_VDPAU(vc1)",
          "old_line_content": "};",
          "new_line_content": "                        HWACCEL_VDPAU(vc1),",
          "content_same": false
        },
        {
          "line": 917,
          "old_api": null,
          "new_api": "av_size_mult",
          "old_text": null,
          "new_text": "av_size_mult(sizeof(*slices), n_slices+1, &next_allocated)",
          "old_line_content": "                        goto err;",
          "new_line_content": "                    av_size_mult(sizeof(*slices), n_slices+1, &next_allocated);",
          "content_same": false
        },
        {
          "line": 918,
          "old_api": null,
          "new_api": "av_fast_realloc",
          "old_text": null,
          "new_text": "av_fast_realloc(slices, &slices_allocated, next_allocated)",
          "old_line_content": "                    }",
          "new_line_content": "                    tmp = next_allocated ? av_fast_realloc(slices, &slices_allocated, next_allocated) : NULL;",
          "content_same": false
        },
        {
          "line": 1432,
          "old_api": null,
          "new_api": "NULL_IF_CONFIG_SMALL",
          "old_text": null,
          "new_text": "NULL_IF_CONFIG_SMALL(ff_vc1_profiles)",
          "old_line_content": "    .p.name         = \"wmv3\",",
          "new_line_content": "    .p.profiles     = NULL_IF_CONFIG_SMALL(ff_vc1_profiles)",
          "content_same": false
        },
        {
          "line": 924,
          "old_api": null,
          "new_api": "av_mallocz",
          "old_text": null,
          "new_text": "av_mallocz(size + AV_INPUT_BUFFER_PADDING_SIZE)",
          "old_line_content": "                    }",
          "new_line_content": "                    slices[n_slices].buf = av_mallocz(size + AV_INPUT_BUFFER_PADDING_SIZE);",
          "content_same": false
        },
        {
          "line": 926,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "                                                              slices[n_slices].buf);",
          "new_line_content": "                        ret = AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1438,
          "old_api": null,
          "new_api": "CODEC_LONG_NAME",
          "old_text": null,
          "new_text": "CODEC_LONG_NAME(\"Windows Media Video 9\")",
          "old_line_content": "    .close          = ff_vc1_decode_end,",
          "new_line_content": "    CODEC_LONG_NAME(\"Windows Media Video 9\"),",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": null,
          "new_api": "init_get_bits",
          "old_text": null,
          "new_text": "init_get_bits(&slices[n_slices].gb, slices[n_slices].buf,\n                                  buf_size3 << 3)",
          "old_line_content": "                    slices[n_slices].raw_size = size + 4;",
          "new_line_content": "                    init_get_bits(&slices[n_slices].gb, slices[n_slices].buf,",
          "content_same": false
        },
        {
          "line": 1444,
          "old_api": null,
          "new_api": "FF_CODEC_DECODE_CB",
          "old_text": null,
          "new_text": "FF_CODEC_DECODE_CB(vc1_decode_frame)",
          "old_line_content": "#if CONFIG_WMV3_DXVA2_HWACCEL",
          "new_line_content": "    FF_CODEC_DECODE_CB(vc1_decode_frame),",
          "content_same": false
        },
        {
          "line": 933,
          "old_api": null,
          "new_api": "get_bits",
          "old_text": null,
          "new_text": "get_bits(&slices[n_slices].gb, 9)",
          "old_line_content": "                    break;",
          "new_line_content": "                    slices[n_slices].mby_start = get_bits(&slices[n_slices].gb, 9);",
          "content_same": false
        },
        {
          "line": 1450,
          "old_api": null,
          "new_api": "HWACCEL_DXVA2",
          "old_text": null,
          "new_text": "HWACCEL_DXVA2(wmv3)",
          "old_line_content": "#if CONFIG_WMV3_D3D11VA2_HWACCEL",
          "new_line_content": "                        HWACCEL_DXVA2(wmv3),",
          "content_same": false
        },
        {
          "line": 1453,
          "old_api": null,
          "new_api": "HWACCEL_D3D11VA",
          "old_text": null,
          "new_text": "HWACCEL_D3D11VA(wmv3)",
          "old_line_content": "#if CONFIG_WMV3_NVDEC_HWACCEL",
          "new_line_content": "                        HWACCEL_D3D11VA(wmv3),",
          "content_same": false
        },
        {
          "line": 1456,
          "old_api": null,
          "new_api": "HWACCEL_D3D11VA2",
          "old_text": null,
          "new_text": "HWACCEL_D3D11VA2(wmv3)",
          "old_line_content": "#if CONFIG_WMV3_VAAPI_HWACCEL",
          "new_line_content": "                        HWACCEL_D3D11VA2(wmv3),",
          "content_same": false
        },
        {
          "line": 945,
          "old_api": null,
          "new_api": "find_next_marker",
          "old_text": null,
          "new_text": "find_next_marker(buf, buf + buf_size)",
          "old_line_content": "                goto err;",
          "new_line_content": "            divider = find_next_marker(buf, buf + buf_size);",
          "content_same": false
        },
        {
          "line": 946,
          "old_api": null,
          "new_api": "AV_RB32",
          "old_text": null,
          "new_text": "AV_RB32(divider)",
          "old_line_content": "            } else { // found field marker, unescape second field",
          "new_line_content": "            if ((divider == (buf + buf_size)) || AV_RB32(divider) != VC1_CODE_FIELD) {",
          "content_same": false
        },
        {
          "line": 947,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Error in WVC1 interlaced frame\\n\")",
          "old_line_content": "                if (avctx->hwaccel)",
          "new_line_content": "                av_log(avctx, AV_LOG_ERROR, \"Error in WVC1 interlaced frame\\n\");",
          "content_same": false
        },
        {
          "line": 1459,
          "old_api": null,
          "new_api": "HWACCEL_NVDEC",
          "old_text": null,
          "new_text": "HWACCEL_NVDEC(wmv3)",
          "old_line_content": "#if CONFIG_WMV3_VDPAU_HWACCEL",
          "new_line_content": "                        HWACCEL_NVDEC(wmv3),",
          "content_same": false
        },
        {
          "line": 1462,
          "old_api": null,
          "new_api": "HWACCEL_VAAPI",
          "old_text": null,
          "new_text": "HWACCEL_VAAPI(wmv3)",
          "old_line_content": "                        NULL",
          "new_line_content": "                        HWACCEL_VAAPI(wmv3),",
          "content_same": false
        },
        {
          "line": 953,
          "old_api": null,
          "new_api": "av_size_mult",
          "old_text": null,
          "new_text": "av_size_mult(sizeof(*slices), n_slices+1, &next_allocated)",
          "old_line_content": "                }",
          "new_line_content": "                av_size_mult(sizeof(*slices), n_slices+1, &next_allocated);",
          "content_same": false
        },
        {
          "line": 954,
          "old_api": null,
          "new_api": "av_fast_realloc",
          "old_text": null,
          "new_text": "av_fast_realloc(slices, &slices_allocated, next_allocated)",
          "old_line_content": "                slices = tmp;",
          "new_line_content": "                tmp = next_allocated ? av_fast_realloc(slices, &slices_allocated, next_allocated) : NULL;",
          "content_same": false
        },
        {
          "line": 1465,
          "old_api": null,
          "new_api": "HWACCEL_VDPAU",
          "old_text": null,
          "new_text": "HWACCEL_VDPAU(wmv3)",
          "old_line_content": "};",
          "new_line_content": "                        HWACCEL_VDPAU(wmv3),",
          "content_same": false
        },
        {
          "line": 956,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "                if (!slices[n_slices].buf) {",
          "new_line_content": "                    ret = AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1469,
          "old_api": null,
          "new_api": "NULL_IF_CONFIG_SMALL",
          "old_text": null,
          "new_text": "NULL_IF_CONFIG_SMALL(ff_vc1_profiles)",
          "old_line_content": "const FFCodec ff_wmv3image_decoder = {",
          "new_line_content": "    .p.profiles     = NULL_IF_CONFIG_SMALL(ff_vc1_profiles)",
          "content_same": false
        },
        {
          "line": 962,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "                              buf_size3 << 3);",
          "new_line_content": "                    ret = AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1476,
          "old_api": null,
          "new_api": "CODEC_LONG_NAME",
          "old_text": null,
          "new_text": "CODEC_LONG_NAME(\"Windows Media Video 9 Image\")",
          "old_line_content": "    .close          = ff_vc1_decode_end,",
          "new_line_content": "    CODEC_LONG_NAME(\"Windows Media Video 9 Image\"),",
          "content_same": false
        },
        {
          "line": 965,
          "old_api": null,
          "new_api": "vc1_unescape_buffer",
          "old_text": null,
          "new_text": "v->vc1dsp.vc1_unescape_buffer(divider + 4, buf + buf_size - divider - 4, slices[n_slices].buf)",
          "old_line_content": "                slices[n_slices].raw_size = buf + buf_size - divider;",
          "new_line_content": "                buf_size3 = v->vc1dsp.vc1_unescape_buffer(divider + 4, buf + buf_size - divider - 4, slices[n_slices].buf);",
          "content_same": false
        },
        {
          "line": 966,
          "old_api": null,
          "new_api": "init_get_bits",
          "old_text": null,
          "new_text": "init_get_bits(&slices[n_slices].gb, slices[n_slices].buf,\n                              buf_size3 << 3)",
          "old_line_content": "                n_slices1 = n_slices - 1;",
          "new_line_content": "                init_get_bits(&slices[n_slices].gb, slices[n_slices].buf,",
          "content_same": false
        },
        {
          "line": 1482,
          "old_api": null,
          "new_api": "FF_CODEC_DECODE_CB",
          "old_text": null,
          "new_text": "FF_CODEC_DECODE_CB(vc1_decode_frame)",
          "old_line_content": "        AV_PIX_FMT_NONE",
          "new_line_content": "    FF_CODEC_DECODE_CB(vc1_decode_frame),",
          "content_same": false
        },
        {
          "line": 974,
          "old_api": null,
          "new_api": "vc1_unescape_buffer",
          "old_text": null,
          "new_text": "v->vc1dsp.vc1_unescape_buffer(buf, divider - buf, buf2)",
          "old_line_content": "    } else{",
          "new_line_content": "            buf_size2 = v->vc1dsp.vc1_unescape_buffer(buf, divider - buf, buf2);",
          "content_same": false
        },
        {
          "line": 976,
          "old_api": null,
          "new_api": "vc1_unescape_buffer",
          "old_text": null,
          "new_text": "v->vc1dsp.vc1_unescape_buffer(buf, buf_size, buf2)",
          "old_line_content": "        if (ret < 0)",
          "new_line_content": "            buf_size2 = v->vc1dsp.vc1_unescape_buffer(buf, buf_size, buf2);",
          "content_same": false
        },
        {
          "line": 978,
          "old_api": null,
          "new_api": "init_get_bits",
          "old_text": null,
          "new_text": "init_get_bits(&s->gb, buf2, buf_size2*8)",
          "old_line_content": "    }",
          "new_line_content": "        init_get_bits(&s->gb, buf2, buf_size2*8);",
          "content_same": false
        },
        {
          "line": 980,
          "old_api": null,
          "new_api": "init_get_bits8",
          "old_text": null,
          "new_text": "init_get_bits8(&s->gb, buf, buf_size)",
          "old_line_content": "    if (v->res_sprite) {",
          "new_line_content": "        ret = init_get_bits8(&s->gb, buf, buf_size);",
          "content_same": false
        },
        {
          "line": 1495,
          "old_api": null,
          "new_api": "CODEC_LONG_NAME",
          "old_text": null,
          "new_text": "CODEC_LONG_NAME(\"Windows Media Video 9 Image v2\")",
          "old_line_content": "    .close          = ff_vc1_decode_end,",
          "new_line_content": "    CODEC_LONG_NAME(\"Windows Media Video 9 Image v2\"),",
          "content_same": false
        },
        {
          "line": 986,
          "old_api": null,
          "new_api": "get_bits1",
          "old_text": null,
          "new_text": "get_bits1(&s->gb)",
          "old_line_content": "           the vc1 one for WVP2 */",
          "new_line_content": "        v->new_sprite  = !get_bits1(&s->gb);",
          "content_same": false
        },
        {
          "line": 987,
          "old_api": null,
          "new_api": "get_bits1",
          "old_text": null,
          "new_text": "get_bits1(&s->gb)",
          "old_line_content": "        if (avctx->codec_id == AV_CODEC_ID_WMV3IMAGE || avctx->codec_id == AV_CODEC_ID_VC1IMAGE) {",
          "new_line_content": "        v->two_sprites =  get_bits1(&s->gb);",
          "content_same": false
        },
        {
          "line": 1501,
          "old_api": null,
          "new_api": "FF_CODEC_DECODE_CB",
          "old_text": null,
          "new_text": "FF_CODEC_DECODE_CB(vc1_decode_frame)",
          "old_line_content": "        AV_PIX_FMT_NONE",
          "new_line_content": "    FF_CODEC_DECODE_CB(vc1_decode_frame),",
          "content_same": false
        },
        {
          "line": 1006,
          "old_api": null,
          "new_api": "ff_vc1_decode_end",
          "old_text": null,
          "new_text": "ff_vc1_decode_end(avctx)",
          "old_line_content": "        if (ret < 0)",
          "new_line_content": "        ff_vc1_decode_end(avctx);",
          "content_same": false
        },
        {
          "line": 1010,
          "old_api": null,
          "new_api": "ff_vc1_decode_init",
          "old_text": null,
          "new_text": "ff_vc1_decode_init(avctx)",
          "old_line_content": "",
          "new_line_content": "        ret = ff_vc1_decode_init(avctx);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1025,
          "old_api": "ff_vc1_parse_frame_header",
          "new_api": null,
          "old_text": "ff_vc1_parse_frame_header(v, &s->gb)",
          "new_text": null,
          "old_line_content": "        if ((ret = ff_vc1_parse_frame_header(v, &s->gb)) < 0) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1029,
          "old_api": "ff_vc1_parse_frame_header_adv",
          "new_api": null,
          "old_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "new_text": null,
          "old_line_content": "        if ((ret = ff_vc1_parse_frame_header_adv(v, &s->gb)) < 0) {",
          "new_line_content": "    if (v->profile < PROFILE_ADVANCED) {",
          "content_same": false
        },
        {
          "line": 1036,
          "old_api": "av_get_picture_type_char",
          "new_api": null,
          "old_text": "av_get_picture_type_char(s->pict_type)",
          "new_text": null,
          "old_line_content": "        av_log(v->s.avctx, AV_LOG_DEBUG, \"pict_type: %c\\n\", av_get_picture_type_char(s->pict_type));",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1040,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Sprite decoder: expected I-frame\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(v->s.avctx, AV_LOG_ERROR, \"Sprite decoder: expected I-frame\\n\");",
          "new_line_content": "    if (avctx->debug & FF_DEBUG_PICT_INFO)",
          "content_same": false
        },
        {
          "line": 1046,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Sprite decoder: expected Frames not Fields\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(v->s.avctx, AV_LOG_ERROR, \"Sprite decoder: expected Frames not Fields\\n\");",
          "new_line_content": "        ret = AVERROR_INVALIDDATA;",
          "content_same": false
        },
        {
          "line": 1062,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(v->s.avctx, AV_LOG_DEBUG, \"Skipping B frame without reference frames\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(v->s.avctx, AV_LOG_DEBUG, \"Skipping B frame without reference frames\\n\");",
          "new_line_content": "    s->current_picture.f->pict_type = s->pict_type;",
          "content_same": false
        },
        {
          "line": 1071,
          "old_api": "ff_mpv_frame_start",
          "new_api": null,
          "old_text": "ff_mpv_frame_start(s, avctx)",
          "new_text": null,
          "old_line_content": "    if ((ret = ff_mpv_frame_start(s, avctx)) < 0) {",
          "new_line_content": "        (avctx->skip_frame >= AVDISCARD_NONKEY && s->pict_type != AV_PICTURE_TYPE_I) ||",
          "content_same": false
        },
        {
          "line": 1096,
          "old_api": "start_frame",
          "new_api": null,
          "old_text": "avctx->hwaccel->start_frame(avctx, buf_start, buf_start_second_field - buf_start)",
          "new_text": null,
          "old_line_content": "            if ((ret = avctx->hwaccel->start_frame(avctx, buf_start, buf_start_second_field - buf_start)) < 0)",
          "new_line_content": "    if (avctx->hwaccel) {",
          "content_same": false
        },
        {
          "line": 1104,
          "old_api": "decode_slice",
          "new_api": null,
          "old_text": "avctx->hwaccel->decode_slice(avctx, buf_start, slices[0].rawbuf - buf_start)",
          "new_text": null,
          "old_line_content": "                if ((ret = avctx->hwaccel->decode_slice(avctx, buf_start, slices[0].rawbuf - buf_start)) < 0)",
          "new_line_content": "            if (n_slices1 == -1) {",
          "content_same": false
        },
        {
          "line": 1111,
          "old_api": "get_bits1",
          "new_api": null,
          "old_text": "get_bits1(&s->gb)",
          "new_text": null,
          "old_line_content": "                    v->pic_header_flag = get_bits1(&s->gb);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1113,
          "old_api": "ff_vc1_parse_frame_header_adv",
          "new_api": null,
          "old_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "new_text": null,
          "old_line_content": "                        if (ff_vc1_parse_frame_header_adv(v, &s->gb) < 0) {",
          "new_line_content": "                    s->gb = slices[i].gb;",
          "content_same": false
        },
        {
          "line": 1114,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\")",
          "new_text": null,
          "old_line_content": "                            av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\");",
          "new_line_content": "                    s->mb_y = slices[i].mby_start;",
          "content_same": false
        },
        {
          "line": 1122,
          "old_api": "decode_slice",
          "new_api": null,
          "old_text": "avctx->hwaccel->decode_slice(avctx, slices[i].rawbuf, slices[i].raw_size)",
          "new_text": null,
          "old_line_content": "                    if ((ret = avctx->hwaccel->decode_slice(avctx, slices[i].rawbuf, slices[i].raw_size)) < 0)",
          "new_line_content": "                                goto err;",
          "content_same": false
        },
        {
          "line": 1136,
          "old_api": "ff_vc1_parse_frame_header_adv",
          "new_api": null,
          "old_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "new_text": null,
          "old_line_content": "            if (ff_vc1_parse_frame_header_adv(v, &s->gb) < 0) {",
          "new_line_content": "            s->gb = slices[n_slices1 + 1].gb;",
          "content_same": false
        },
        {
          "line": 1137,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"parsing header for second field failed\")",
          "new_text": null,
          "old_line_content": "                av_log(avctx, AV_LOG_ERROR, \"parsing header for second field failed\");",
          "new_line_content": "            s->mb_y = slices[n_slices1 + 1].mby_start;",
          "content_same": false
        },
        {
          "line": 1143,
          "old_api": "start_frame",
          "new_api": null,
          "old_text": "avctx->hwaccel->start_frame(avctx, buf_start_second_field, (buf + buf_size) - buf_start_second_field)",
          "new_text": null,
          "old_line_content": "            if ((ret = avctx->hwaccel->start_frame(avctx, buf_start_second_field, (buf + buf_size) - buf_start_second_field)) < 0)",
          "new_line_content": "                ret = AVERROR_INVALIDDATA;",
          "content_same": false
        },
        {
          "line": 1151,
          "old_api": "decode_slice",
          "new_api": null,
          "old_text": "avctx->hwaccel->decode_slice(avctx, buf_start_second_field, slices[n_slices1 + 2].rawbuf - buf_start_second_field)",
          "new_text": null,
          "old_line_content": "                if ((ret = avctx->hwaccel->decode_slice(avctx, buf_start_second_field, slices[n_slices1 + 2].rawbuf - buf_start_second_field)) < 0)",
          "new_line_content": "            if (n_slices - n_slices1 == 2) {",
          "content_same": false
        },
        {
          "line": 1158,
          "old_api": "get_bits1",
          "new_api": null,
          "old_text": "get_bits1(&s->gb)",
          "new_text": null,
          "old_line_content": "                    v->pic_header_flag = get_bits1(&s->gb);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1160,
          "old_api": "ff_vc1_parse_frame_header_adv",
          "new_api": null,
          "old_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "new_text": null,
          "old_line_content": "                        if (ff_vc1_parse_frame_header_adv(v, &s->gb) < 0) {",
          "new_line_content": "                    s->gb = slices[i].gb;",
          "content_same": false
        },
        {
          "line": 1161,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\")",
          "new_text": null,
          "old_line_content": "                            av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\");",
          "new_line_content": "                    s->mb_y = slices[i].mby_start;",
          "content_same": false
        },
        {
          "line": 1169,
          "old_api": "decode_slice",
          "new_api": null,
          "old_text": "avctx->hwaccel->decode_slice(avctx, slices[i].rawbuf, slices[i].raw_size)",
          "new_text": null,
          "old_line_content": "                    if ((ret = avctx->hwaccel->decode_slice(avctx, slices[i].rawbuf, slices[i].raw_size)) < 0)",
          "new_line_content": "                                goto err;",
          "content_same": false
        },
        {
          "line": 1178,
          "old_api": "start_frame",
          "new_api": null,
          "old_text": "avctx->hwaccel->start_frame(avctx, buf_start, (buf + buf_size) - buf_start)",
          "new_text": null,
          "old_line_content": "            if ((ret = avctx->hwaccel->start_frame(avctx, buf_start, (buf + buf_size) - buf_start)) < 0)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1187,
          "old_api": "decode_slice",
          "new_api": null,
          "old_text": "avctx->hwaccel->decode_slice(avctx, buf_start, slices[0].rawbuf - buf_start)",
          "new_text": null,
          "old_line_content": "                if ((ret = avctx->hwaccel->decode_slice(avctx, buf_start, slices[0].rawbuf - buf_start)) < 0)",
          "new_line_content": "                // no slices, decode the frame as-is",
          "content_same": false
        },
        {
          "line": 1195,
          "old_api": "get_bits1",
          "new_api": null,
          "old_text": "get_bits1(&s->gb)",
          "new_text": null,
          "old_line_content": "                    v->pic_header_flag = get_bits1(&s->gb);",
          "new_line_content": "                // and process the slices as additional slices afterwards",
          "content_same": false
        },
        {
          "line": 1197,
          "old_api": "ff_vc1_parse_frame_header_adv",
          "new_api": null,
          "old_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "new_text": null,
          "old_line_content": "                        if (ff_vc1_parse_frame_header_adv(v, &s->gb) < 0) {",
          "new_line_content": "                    s->gb = slices[i].gb;",
          "content_same": false
        },
        {
          "line": 1198,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\")",
          "new_text": null,
          "old_line_content": "                            av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\");",
          "new_line_content": "                    s->mb_y = slices[i].mby_start;",
          "content_same": false
        },
        {
          "line": 1206,
          "old_api": "decode_slice",
          "new_api": null,
          "old_text": "avctx->hwaccel->decode_slice(avctx, slices[i].rawbuf, slices[i].raw_size)",
          "new_text": null,
          "old_line_content": "                    if ((ret = avctx->hwaccel->decode_slice(avctx, slices[i].rawbuf, slices[i].raw_size)) < 0)",
          "new_line_content": "                                goto err;",
          "content_same": false
        },
        {
          "line": 1210,
          "old_api": "end_frame",
          "new_api": null,
          "old_text": "avctx->hwaccel->end_frame(avctx)",
          "new_text": null,
          "old_line_content": "            if ((ret = avctx->hwaccel->end_frame(avctx)) < 0)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1216,
          "old_api": "ff_mpeg_er_frame_start",
          "new_api": null,
          "old_text": "ff_mpeg_er_frame_start(s)",
          "new_text": null,
          "old_line_content": "        ff_mpeg_er_frame_start(s);",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 1228,
          "old_api": "av_assert0 (mb_height > 0)",
          "new_api": null,
          "old_text": "av_assert0 (mb_height > 0)",
          "new_text": null,
          "old_line_content": "        av_assert0 (mb_height > 0);",
          "new_line_content": "            s->linesize                      <<= 1;",
          "content_same": false
        },
        {
          "line": 1239,
          "old_api": "av_assert0",
          "new_api": null,
          "old_text": "av_assert0((s->mb_height & 1) == 0)",
          "new_text": null,
          "old_line_content": "                av_assert0((s->mb_height & 1) == 0);",
          "new_line_content": "                           \"picture boundary (%d >= %d)\\n\", i,",
          "content_same": false
        },
        {
          "line": 1250,
          "old_api": "ff_vc1_parse_frame_header_adv",
          "new_api": null,
          "old_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "new_text": null,
          "old_line_content": "                    if ((header_ret = ff_vc1_parse_frame_header_adv(v, &s->gb)) < 0) {",
          "new_line_content": "                v->mb_off       = 0;",
          "content_same": false
        },
        {
          "line": 1251,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Field header damaged\\n\")",
          "new_text": null,
          "old_line_content": "                        av_log(v->s.avctx, AV_LOG_ERROR, \"Field header damaged\\n\");",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1257,
          "old_api": "get_bits1",
          "new_api": null,
          "old_text": "get_bits1(&s->gb)",
          "new_text": null,
          "old_line_content": "                } else if (get_bits1(&s->gb)) {",
          "new_line_content": "                        ret = AVERROR_INVALIDDATA;",
          "content_same": false
        },
        {
          "line": 1259,
          "old_api": "ff_vc1_parse_frame_header_adv",
          "new_api": null,
          "old_text": "ff_vc1_parse_frame_header_adv(v, &s->gb)",
          "new_text": null,
          "old_line_content": "                    if ((header_ret = ff_vc1_parse_frame_header_adv(v, &s->gb)) < 0) {",
          "new_line_content": "                            goto err;",
          "content_same": false
        },
        {
          "line": 1260,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\")",
          "new_text": null,
          "old_line_content": "                        av_log(v->s.avctx, AV_LOG_ERROR, \"Slice header damaged\\n\");",
          "new_line_content": "                        continue;",
          "content_same": false
        },
        {
          "line": 1270,
          "old_api": "FFMAX",
          "new_api": null,
          "old_text": "FFMAX(0, slices[i-1].mby_start % mb_height)",
          "new_text": null,
          "old_line_content": "            s->start_mb_y = (i == 0) ? 0 : FFMAX(0, slices[i-1].mby_start % mb_height);",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 1272,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(mb_height, slices[i].mby_start % mb_height)",
          "new_text": null,
          "old_line_content": "                s->end_mb_y = (i == n_slices     ) ? mb_height : FFMIN(mb_height, slices[i].mby_start % mb_height);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1278,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(mb_height, slices[i].mby_start % mb_height)",
          "new_text": null,
          "old_line_content": "                s->end_mb_y = (i == n_slices1 + 1) ? mb_height : FFMIN(mb_height, slices[i].mby_start % mb_height);",
          "new_line_content": "            else {",
          "content_same": false
        },
        {
          "line": 1281,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"end mb y %d %d invalid\\n\", s->end_mb_y, s->start_mb_y)",
          "new_text": null,
          "old_line_content": "                av_log(v->s.avctx, AV_LOG_ERROR, \"end mb y %d %d invalid\\n\", s->end_mb_y, s->start_mb_y);",
          "new_line_content": "                    continue;",
          "content_same": false
        },
        {
          "line": 1287,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(v->s.avctx, AV_LOG_ERROR, \"missing cbpcy_vlc\\n\")",
          "new_text": null,
          "old_line_content": "                av_log(v->s.avctx, AV_LOG_ERROR, \"missing cbpcy_vlc\\n\");",
          "new_line_content": "                continue;",
          "content_same": false
        },
        {
          "line": 1290,
          "old_api": "ff_vc1_decode_blocks",
          "new_api": null,
          "old_text": "ff_vc1_decode_blocks(v)",
          "new_text": null,
          "old_line_content": "            ff_vc1_decode_blocks(v);",
          "new_line_content": "                 (s->pict_type == AV_PICTURE_TYPE_B && !v->bi_type)) &&",
          "content_same": false
        },
        {
          "line": 1307,
          "old_api": "ff_dlog",
          "new_api": null,
          "old_text": "ff_dlog(s->avctx, \"Consumed %i/%i bits\\n\",\n                get_bits_count(&s->gb), s->gb.size_in_bits)",
          "new_text": null,
          "old_line_content": "        ff_dlog(s->avctx, \"Consumed %i/%i bits\\n\",",
          "new_line_content": "            if (v->s.pict_type != AV_PICTURE_TYPE_BI && v->s.pict_type != AV_PICTURE_TYPE_B) {",
          "content_same": false
        },
        {
          "line": 1308,
          "old_api": "get_bits_count",
          "new_api": null,
          "old_text": "get_bits_count(&s->gb)",
          "new_text": null,
          "old_line_content": "                get_bits_count(&s->gb), s->gb.size_in_bits);",
          "new_line_content": "                FFSWAP(uint8_t *, v->mv_f_next[0], v->mv_f[0]);",
          "content_same": false
        },
        {
          "line": 1318,
          "old_api": "ff_er_frame_end",
          "new_api": null,
          "old_text": "ff_er_frame_end(&s->er)",
          "new_text": null,
          "old_line_content": "            ff_er_frame_end(&s->er);",
          "new_line_content": "            goto err;",
          "content_same": false
        },
        {
          "line": 1321,
          "old_api": "ff_mpv_frame_end",
          "new_api": null,
          "old_text": "ff_mpv_frame_end(s)",
          "new_text": null,
          "old_line_content": "    ff_mpv_frame_end(s);",
          "new_line_content": "            && avctx->codec_id != AV_CODEC_ID_WMV3IMAGE",
          "content_same": false
        },
        {
          "line": 1330,
          "old_api": "av_frame_alloc",
          "new_api": null,
          "old_text": "av_frame_alloc()",
          "new_text": null,
          "old_line_content": "            !(v->sprite_output_frame = av_frame_alloc())) {",
          "new_line_content": "        avctx->width  = avctx->coded_width  = v->output_width;",
          "content_same": false
        },
        {
          "line": 1331,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "            ret = AVERROR(ENOMEM);",
          "new_line_content": "        avctx->height = avctx->coded_height = v->output_height;",
          "content_same": false
        },
        {
          "line": 1338,
          "old_api": "av_frame_ref",
          "new_api": null,
          "old_text": "av_frame_ref(pict, v->sprite_output_frame)",
          "new_text": null,
          "old_line_content": "        if ((ret = av_frame_ref(pict, v->sprite_output_frame)) < 0)",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1346,
          "old_api": "ff_print_debug_info",
          "new_api": null,
          "old_text": "ff_print_debug_info(s, s->current_picture_ptr, pict)",
          "new_text": null,
          "old_line_content": "                ff_print_debug_info(s, s->current_picture_ptr, pict);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 1349,
          "old_api": "av_frame_ref",
          "new_api": null,
          "old_text": "av_frame_ref(pict, s->last_picture_ptr->f)",
          "new_text": null,
          "old_line_content": "            if ((ret = av_frame_ref(pict, s->last_picture_ptr->f)) < 0)",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 1352,
          "old_api": "ff_print_debug_info",
          "new_api": null,
          "old_text": "ff_print_debug_info(s, s->last_picture_ptr, pict)",
          "new_text": null,
          "old_line_content": "                ff_print_debug_info(s, s->last_picture_ptr, pict);",
          "new_line_content": "            *got_frame = 1;",
          "content_same": false
        },
        {
          "line": 846,
          "old_api": "AV_RB32",
          "new_api": null,
          "old_text": "AV_RB32(buf)",
          "new_text": null,
          "old_line_content": "    if (buf_size == 0 || (buf_size == 4 && AV_RB32(buf) == VC1_CODE_ENDOFSEQ)) {",
          "new_line_content": "    /* no supplementary picture */",
          "content_same": false
        },
        {
          "line": 1358,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(buf2)",
          "new_text": null,
          "old_line_content": "    av_free(buf2);",
          "new_line_content": "            *got_frame = 1;",
          "content_same": false
        },
        {
          "line": 1360,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(slices[i].buf)",
          "new_text": null,
          "old_line_content": "        av_free(slices[i].buf);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 849,
          "old_api": "av_frame_ref",
          "new_api": null,
          "old_text": "av_frame_ref(pict, s->next_picture_ptr->f)",
          "new_text": null,
          "old_line_content": "            if ((ret = av_frame_ref(pict, s->next_picture_ptr->f)) < 0)",
          "new_line_content": "        if (s->low_delay == 0 && s->next_picture_ptr) {",
          "content_same": false
        },
        {
          "line": 1361,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(slices)",
          "new_text": null,
          "old_line_content": "    av_free(slices);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1367,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(slices[i].buf)",
          "new_text": null,
          "old_line_content": "        av_free(slices[i].buf);",
          "new_line_content": "    return buf_size;",
          "content_same": false
        },
        {
          "line": 1368,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(slices)",
          "new_text": null,
          "old_line_content": "    av_free(slices);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 862,
          "old_api": "av_mallocz",
          "new_api": null,
          "old_text": "av_mallocz(buf_size + AV_INPUT_BUFFER_PADDING_SIZE)",
          "new_text": null,
          "old_line_content": "        buf2 = av_mallocz(buf_size + AV_INPUT_BUFFER_PADDING_SIZE);",
          "new_line_content": "        int buf_size2 = 0;",
          "content_same": false
        },
        {
          "line": 872,
          "old_api": "find_next_marker",
          "new_api": null,
          "old_text": "find_next_marker(start + 4, end)",
          "new_text": null,
          "old_line_content": "                next = find_next_marker(start + 4, end);",
          "new_line_content": "            next = buf;",
          "content_same": false
        },
        {
          "line": 875,
          "old_api": "AV_RB32",
          "new_api": null,
          "old_text": "AV_RB32(start)",
          "new_text": null,
          "old_line_content": "                switch (AV_RB32(start)) {",
          "new_line_content": "                size = next - start - 4;",
          "content_same": false
        },
        {
          "line": 879,
          "old_api": "vc1_unescape_buffer",
          "new_api": null,
          "old_text": "v->vc1dsp.vc1_unescape_buffer(start + 4, size, buf2)",
          "new_text": null,
          "old_line_content": "                    buf_size2 = v->vc1dsp.vc1_unescape_buffer(start + 4, size, buf2);",
          "new_line_content": "                    if (avctx->hwaccel)",
          "content_same": false
        },
        {
          "line": 1396,
          "old_api": "CODEC_LONG_NAME",
          "new_api": null,
          "old_text": "CODEC_LONG_NAME(\"SMPTE VC-1\")",
          "new_text": null,
          "old_line_content": "    CODEC_LONG_NAME(\"SMPTE VC-1\"),",
          "new_line_content": "    AV_PIX_FMT_NONE",
          "content_same": false
        },
        {
          "line": 885,
          "old_api": "av_realloc_array",
          "new_api": null,
          "old_text": "av_realloc_array(slices, sizeof(*slices), n_slices+1)",
          "new_text": null,
          "old_line_content": "                    tmp = av_realloc_array(slices, sizeof(*slices), n_slices+1);",
          "new_line_content": "                    if (avctx->hwaccel)",
          "content_same": false
        },
        {
          "line": 1402,
          "old_api": "FF_CODEC_DECODE_CB",
          "new_api": null,
          "old_text": "FF_CODEC_DECODE_CB(vc1_decode_frame)",
          "new_text": null,
          "old_line_content": "    FF_CODEC_DECODE_CB(vc1_decode_frame),",
          "new_line_content": "    .p.type         = AVMEDIA_TYPE_VIDEO,",
          "content_same": false
        },
        {
          "line": 891,
          "old_api": "av_mallocz",
          "new_api": null,
          "old_text": "av_mallocz(size + AV_INPUT_BUFFER_PADDING_SIZE)",
          "new_text": null,
          "old_line_content": "                    slices[n_slices].buf = av_mallocz(size + AV_INPUT_BUFFER_PADDING_SIZE);",
          "new_line_content": "                        goto err;",
          "content_same": false
        },
        {
          "line": 893,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "                        ret = AVERROR(ENOMEM);",
          "new_line_content": "                    slices = tmp;",
          "content_same": false
        },
        {
          "line": 1408,
          "old_api": "HWACCEL_DXVA2",
          "new_api": null,
          "old_text": "HWACCEL_DXVA2(vc1)",
          "new_text": null,
          "old_line_content": "                        HWACCEL_DXVA2(vc1),",
          "new_line_content": "    .flush          = ff_mpeg_flush,",
          "content_same": false
        },
        {
          "line": 898,
          "old_api": "init_get_bits",
          "new_api": null,
          "old_text": "init_get_bits(&slices[n_slices].gb, slices[n_slices].buf,\n                                  buf_size3 << 3)",
          "new_text": null,
          "old_line_content": "                    init_get_bits(&slices[n_slices].gb, slices[n_slices].buf,",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 1411,
          "old_api": "HWACCEL_D3D11VA",
          "new_api": null,
          "old_text": "HWACCEL_D3D11VA(vc1)",
          "new_text": null,
          "old_line_content": "                        HWACCEL_D3D11VA(vc1),",
          "new_line_content": "    .hw_configs     = (const AVCodecHWConfigInternal *const []) {",
          "content_same": false
        },
        {
          "line": 1414,
          "old_api": "HWACCEL_D3D11VA2",
          "new_api": null,
          "old_text": "HWACCEL_D3D11VA2(vc1)",
          "new_text": null,
          "old_line_content": "                        HWACCEL_D3D11VA2(vc1),",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 1417,
          "old_api": "HWACCEL_NVDEC",
          "new_api": null,
          "old_text": "HWACCEL_NVDEC(vc1)",
          "new_text": null,
          "old_line_content": "                        HWACCEL_NVDEC(vc1),",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 908,
          "old_api": "vc1_unescape_buffer",
          "new_api": null,
          "old_text": "v->vc1dsp.vc1_unescape_buffer(start + 4, size, buf2)",
          "new_text": null,
          "old_line_content": "                    buf_size2 = v->vc1dsp.vc1_unescape_buffer(start + 4, size, buf2);",
          "new_line_content": "                    break;",
          "content_same": false
        },
        {
          "line": 909,
          "old_api": "init_get_bits",
          "new_api": null,
          "old_text": "init_get_bits(&s->gb, buf2, buf_size2 * 8)",
          "new_text": null,
          "old_line_content": "                    init_get_bits(&s->gb, buf2, buf_size2 * 8);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 910,
          "old_api": "ff_vc1_decode_entry_point",
          "new_api": null,
          "old_text": "ff_vc1_decode_entry_point(avctx, v, &s->gb)",
          "new_text": null,
          "old_line_content": "                    ff_vc1_decode_entry_point(avctx, v, &s->gb);",
          "new_line_content": "                case VC1_CODE_ENTRYPOINT: /* it should be before frame data */",
          "content_same": false
        },
        {
          "line": 1420,
          "old_api": "HWACCEL_VAAPI",
          "new_api": null,
          "old_text": "HWACCEL_VAAPI(vc1)",
          "new_text": null,
          "old_line_content": "                        HWACCEL_VAAPI(vc1),",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 1423,
          "old_api": "HWACCEL_VDPAU",
          "new_api": null,
          "old_text": "HWACCEL_VDPAU(vc1)",
          "new_text": null,
          "old_line_content": "                        HWACCEL_VDPAU(vc1),",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 914,
          "old_api": "av_realloc_array",
          "new_api": null,
          "old_text": "av_realloc_array(slices, sizeof(*slices), n_slices+1)",
          "new_text": null,
          "old_line_content": "                    tmp = av_realloc_array(slices, sizeof(*slices), n_slices+1);",
          "new_line_content": "                    break;",
          "content_same": false
        },
        {
          "line": 1427,
          "old_api": "NULL_IF_CONFIG_SMALL",
          "new_api": null,
          "old_text": "NULL_IF_CONFIG_SMALL(ff_vc1_profiles)",
          "new_text": null,
          "old_line_content": "    .p.profiles     = NULL_IF_CONFIG_SMALL(ff_vc1_profiles)",
          "new_line_content": "#if CONFIG_VC1_VDPAU_HWACCEL",
          "content_same": false
        },
        {
          "line": 916,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "                        ret = AVERROR(ENOMEM);",
          "new_line_content": "                    int buf_size3;",
          "content_same": false
        },
        {
          "line": 1433,
          "old_api": "CODEC_LONG_NAME",
          "new_api": null,
          "old_text": "CODEC_LONG_NAME(\"Windows Media Video 9\")",
          "new_text": null,
          "old_line_content": "    CODEC_LONG_NAME(\"Windows Media Video 9\"),",
          "new_line_content": "};",
          "content_same": false
        },
        {
          "line": 922,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "                        ret = AVERROR(ENOMEM);",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 925,
          "old_api": "vc1_unescape_buffer",
          "new_api": null,
          "old_text": "v->vc1dsp.vc1_unescape_buffer(start + 4, size,\n                                                              slices[n_slices].buf)",
          "new_text": null,
          "old_line_content": "                    buf_size3 = v->vc1dsp.vc1_unescape_buffer(start + 4, size,",
          "new_line_content": "                    if (!slices[n_slices].buf) {",
          "content_same": false
        },
        {
          "line": 927,
          "old_api": "init_get_bits",
          "new_api": null,
          "old_text": "init_get_bits(&slices[n_slices].gb, slices[n_slices].buf,\n                                  buf_size3 << 3)",
          "new_text": null,
          "old_line_content": "                    init_get_bits(&slices[n_slices].gb, slices[n_slices].buf,",
          "new_line_content": "                        goto err;",
          "content_same": false
        },
        {
          "line": 1439,
          "old_api": "FF_CODEC_DECODE_CB",
          "new_api": null,
          "old_text": "FF_CODEC_DECODE_CB(vc1_decode_frame)",
          "new_text": null,
          "old_line_content": "    FF_CODEC_DECODE_CB(vc1_decode_frame),",
          "new_line_content": "    .p.type         = AVMEDIA_TYPE_VIDEO,",
          "content_same": false
        },
        {
          "line": 1445,
          "old_api": "HWACCEL_DXVA2",
          "new_api": null,
          "old_text": "HWACCEL_DXVA2(wmv3)",
          "new_text": null,
          "old_line_content": "                        HWACCEL_DXVA2(wmv3),",
          "new_line_content": "    .flush          = ff_mpeg_flush,",
          "content_same": false
        },
        {
          "line": 1448,
          "old_api": "HWACCEL_D3D11VA",
          "new_api": null,
          "old_text": "HWACCEL_D3D11VA(wmv3)",
          "new_text": null,
          "old_line_content": "                        HWACCEL_D3D11VA(wmv3),",
          "new_line_content": "    .hw_configs     = (const AVCodecHWConfigInternal *const []) {",
          "content_same": false
        },
        {
          "line": 1451,
          "old_api": "HWACCEL_D3D11VA2",
          "new_api": null,
          "old_text": "HWACCEL_D3D11VA2(wmv3)",
          "new_text": null,
          "old_line_content": "                        HWACCEL_D3D11VA2(wmv3),",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 941,
          "old_api": "find_next_marker",
          "new_api": null,
          "old_text": "find_next_marker(buf, buf + buf_size)",
          "new_text": null,
          "old_line_content": "            divider = find_next_marker(buf, buf + buf_size);",
          "new_line_content": "        } else if (v->interlace && ((buf[0] & 0xC0) == 0xC0)) { /* WVC1 interlaced stores both fields divided by marker */",
          "content_same": false
        },
        {
          "line": 942,
          "old_api": "AV_RB32",
          "new_api": null,
          "old_text": "AV_RB32(divider)",
          "new_text": null,
          "old_line_content": "            if ((divider == (buf + buf_size)) || AV_RB32(divider) != VC1_CODE_FIELD) {",
          "new_line_content": "            const uint8_t *divider;",
          "content_same": false
        },
        {
          "line": 943,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Error in WVC1 interlaced frame\\n\")",
          "new_text": null,
          "old_line_content": "                av_log(avctx, AV_LOG_ERROR, \"Error in WVC1 interlaced frame\\n\");",
          "new_line_content": "            int buf_size3;",
          "content_same": false
        },
        {
          "line": 1454,
          "old_api": "HWACCEL_NVDEC",
          "new_api": null,
          "old_text": "HWACCEL_NVDEC(wmv3)",
          "new_text": null,
          "old_line_content": "                        HWACCEL_NVDEC(wmv3),",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 1457,
          "old_api": "HWACCEL_VAAPI",
          "new_api": null,
          "old_text": "HWACCEL_VAAPI(wmv3)",
          "new_text": null,
          "old_line_content": "                        HWACCEL_VAAPI(wmv3),",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 1460,
          "old_api": "HWACCEL_VDPAU",
          "new_api": null,
          "old_text": "HWACCEL_VDPAU(wmv3)",
          "new_text": null,
          "old_line_content": "                        HWACCEL_VDPAU(wmv3),",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 949,
          "old_api": "av_realloc_array",
          "new_api": null,
          "old_text": "av_realloc_array(slices, sizeof(*slices), n_slices+1)",
          "new_text": null,
          "old_line_content": "                tmp = av_realloc_array(slices, sizeof(*slices), n_slices+1);",
          "new_line_content": "                goto err;",
          "content_same": false
        },
        {
          "line": 951,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "                    ret = AVERROR(ENOMEM);",
          "new_line_content": "                if (avctx->hwaccel)",
          "content_same": false
        },
        {
          "line": 1464,
          "old_api": "NULL_IF_CONFIG_SMALL",
          "new_api": null,
          "old_text": "NULL_IF_CONFIG_SMALL(ff_vc1_profiles)",
          "new_text": null,
          "old_line_content": "    .p.profiles     = NULL_IF_CONFIG_SMALL(ff_vc1_profiles)",
          "new_line_content": "#if CONFIG_WMV3_VDPAU_HWACCEL",
          "content_same": false
        },
        {
          "line": 955,
          "old_api": "av_mallocz",
          "new_api": null,
          "old_text": "av_mallocz(buf_size + AV_INPUT_BUFFER_PADDING_SIZE)",
          "new_text": null,
          "old_line_content": "                slices[n_slices].buf = av_mallocz(buf_size + AV_INPUT_BUFFER_PADDING_SIZE);",
          "new_line_content": "                if (!tmp) {",
          "content_same": false
        },
        {
          "line": 957,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "                    ret = AVERROR(ENOMEM);",
          "new_line_content": "                    goto err;",
          "content_same": false
        },
        {
          "line": 1471,
          "old_api": "CODEC_LONG_NAME",
          "new_api": null,
          "old_text": "CODEC_LONG_NAME(\"Windows Media Video 9 Image\")",
          "new_text": null,
          "old_line_content": "    CODEC_LONG_NAME(\"Windows Media Video 9 Image\"),",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 961,
          "old_api": "init_get_bits",
          "new_api": null,
          "old_text": "init_get_bits(&slices[n_slices].gb, slices[n_slices].buf,\n                              buf_size3 << 3)",
          "new_text": null,
          "old_line_content": "                init_get_bits(&slices[n_slices].gb, slices[n_slices].buf,",
          "new_line_content": "                if (!slices[n_slices].buf) {",
          "content_same": false
        },
        {
          "line": 1477,
          "old_api": "FF_CODEC_DECODE_CB",
          "new_api": null,
          "old_text": "FF_CODEC_DECODE_CB(vc1_decode_frame)",
          "new_text": null,
          "old_line_content": "    FF_CODEC_DECODE_CB(vc1_decode_frame),",
          "new_line_content": "    .p.type         = AVMEDIA_TYPE_VIDEO,",
          "content_same": false
        },
        {
          "line": 969,
          "old_api": "vc1_unescape_buffer",
          "new_api": null,
          "old_text": "v->vc1dsp.vc1_unescape_buffer(buf, divider - buf, buf2)",
          "new_text": null,
          "old_line_content": "            buf_size2 = v->vc1dsp.vc1_unescape_buffer(buf, divider - buf, buf2);",
          "new_line_content": "                slices[n_slices].rawbuf = divider;",
          "content_same": false
        },
        {
          "line": 971,
          "old_api": "vc1_unescape_buffer",
          "new_api": null,
          "old_text": "v->vc1dsp.vc1_unescape_buffer(buf, buf_size, buf2)",
          "new_text": null,
          "old_line_content": "            buf_size2 = v->vc1dsp.vc1_unescape_buffer(buf, buf_size, buf2);",
          "new_line_content": "                n_slices1 = n_slices - 1;",
          "content_same": false
        },
        {
          "line": 973,
          "old_api": "init_get_bits",
          "new_api": null,
          "old_text": "init_get_bits(&s->gb, buf2, buf_size2*8)",
          "new_text": null,
          "old_line_content": "        init_get_bits(&s->gb, buf2, buf_size2*8);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 975,
          "old_api": "init_get_bits8",
          "new_api": null,
          "old_text": "init_get_bits8(&s->gb, buf, buf_size)",
          "new_text": null,
          "old_line_content": "        ret = init_get_bits8(&s->gb, buf, buf_size);",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 1490,
          "old_api": "CODEC_LONG_NAME",
          "new_api": null,
          "old_text": "CODEC_LONG_NAME(\"Windows Media Video 9 Image v2\")",
          "new_text": null,
          "old_line_content": "    CODEC_LONG_NAME(\"Windows Media Video 9 Image v2\"),",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 981,
          "old_api": "get_bits1",
          "new_api": null,
          "old_text": "get_bits1(&s->gb)",
          "new_text": null,
          "old_line_content": "        v->new_sprite  = !get_bits1(&s->gb);",
          "new_line_content": "        if (ret < 0)",
          "content_same": false
        },
        {
          "line": 982,
          "old_api": "get_bits1",
          "new_api": null,
          "old_text": "get_bits1(&s->gb)",
          "new_text": null,
          "old_line_content": "        v->two_sprites =  get_bits1(&s->gb);",
          "new_line_content": "            return ret;",
          "content_same": false
        },
        {
          "line": 1496,
          "old_api": "FF_CODEC_DECODE_CB",
          "new_api": null,
          "old_text": "FF_CODEC_DECODE_CB(vc1_decode_frame)",
          "new_text": null,
          "old_line_content": "    FF_CODEC_DECODE_CB(vc1_decode_frame),",
          "new_line_content": "    .p.type         = AVMEDIA_TYPE_VIDEO,",
          "content_same": false
        },
        {
          "line": 1001,
          "old_api": "ff_vc1_decode_end",
          "new_api": null,
          "old_text": "ff_vc1_decode_end(avctx)",
          "new_text": null,
          "old_line_content": "        ff_vc1_decode_end(avctx);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1005,
          "old_api": "ff_vc1_decode_init",
          "new_api": null,
          "old_text": "ff_vc1_decode_init(avctx)",
          "new_text": null,
          "old_line_content": "        ret = ff_vc1_decode_init(avctx);",
          "new_line_content": "         s->height != avctx->coded_height)) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 15,
      "total_additions": 116,
      "total_deletions": 113,
      "total_api_changes": 244
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 11,
        "api_related_lines": 244,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          863,
          839
        ]
      }
    },
    "api_calls_before": 314,
    "api_calls_after": 317,
    "diff_info": {
      "added_lines": 8,
      "removed_lines": 3,
      "total_diff_lines": 51
    }
  }
}