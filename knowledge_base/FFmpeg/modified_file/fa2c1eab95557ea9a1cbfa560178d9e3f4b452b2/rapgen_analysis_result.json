{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/fa2c1eab95557ea9a1cbfa560178d9e3f4b452b2",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/fa2c1eab95557ea9a1cbfa560178d9e3f4b452b2/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/fa2c1eab95557ea9a1cbfa560178d9e3f4b452b2/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/fa2c1eab95557ea9a1cbfa560178d9e3f4b452b2/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 581,
          "old_api": "rt",
          "new_api": "scalarproduct_float",
          "old_text": "rt(energy));",
          "new_text": ">fdsp->scalarproduct_float(ir, ir, sofa->n_samples);\n",
          "old_line_content": "        compensate = 256 / (sofa->n_samples * sqrt(energy));",
          "new_line_content": "            energy = s->fdsp->scalarproduct_float(ir, ir, sofa->n_samples);",
          "content_same": false
        },
        {
          "line": 663,
          "old_api": "MIN",
          "new_api": "mcpy",
          "old_text": "MIN(n_samples - (read % n_samples), buffer_length - read);\n",
          "new_text": "mcpy(temp_src, bptr + read, n_samples * sizeof(*temp_src));\n",
          "old_line_content": "                int len = FFMIN(n_samples - (read % n_samples), buffer_length - read);",
          "new_line_content": "                memcpy(temp_src, bptr + read, n_samples * sizeof(*temp_src));",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": "mcpy",
          "new_api": "MIN",
          "old_text": "mcpy(temp_src, bptr + read, len * sizeof(*temp_src));\n",
          "new_text": "MIN(n_samples - (read % n_samples), buffer_length - read);\n",
          "old_line_content": "                memcpy(temp_src, bptr + read, len * sizeof(*temp_src));",
          "new_line_content": "                int len = FFMIN(n_samples - (read % n_samples), buffer_length - read);",
          "content_same": false
        },
        {
          "line": 814,
          "old_api": "_frame_free",
          "new_api": "_get_audio_buffer",
          "old_text": "_frame_free(&in);\n",
          "new_text": "_get_audio_buffer(outlink, in->nb_samples);\n",
          "old_line_content": "        av_frame_free(&in);",
          "new_line_content": "    out = ff_get_audio_buffer(outlink, in->nb_samples);",
          "content_same": false
        },
        {
          "line": 817,
          "old_api": "_frame_copy_props",
          "new_api": "ERROR",
          "old_text": "_frame_copy_props(out, in);\n",
          "new_text": "ERROR(ENOMEM);\n",
          "old_line_content": "    av_frame_copy_props(out, in);",
          "new_line_content": "        return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 829,
          "old_api": "ms_c",
          "new_api": "execute",
          "old_text": "ms_c();\n",
          "new_text": "x->internal->execute(ctx, sofalizer_fast_convolute, &td, NULL, 2);\n",
          "old_line_content": "    emms_c();",
          "new_line_content": "        ctx->internal->execute(ctx, sofalizer_fast_convolute, &td, NULL, 2);",
          "content_same": false
        },
        {
          "line": 879,
          "old_api": "ERROR",
          "new_api": "_make_formatu64_list",
          "old_text": "ERROR(ENOMEM);\n",
          "new_text": "_make_formatu64_list(channel_layouts);\n",
          "old_line_content": "        return AVERROR(ENOMEM);",
          "new_line_content": "    layouts = ff_make_formatu64_list(channel_layouts);",
          "content_same": false
        },
        {
          "line": 881,
          "old_api": "_channel_layouts_ref",
          "new_api": "ERROR",
          "old_text": "_channel_layouts_ref(layouts, &ctx->inputs[0]->out_channel_layouts);\n",
          "new_text": "ERROR(ENOMEM);\n",
          "old_line_content": "    ret = ff_channel_layouts_ref(layouts, &ctx->inputs[0]->out_channel_layouts);",
          "new_line_content": "        return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 897,
          "old_api": "ERROR",
          "new_api": "_make_format_list",
          "old_text": "ERROR(ENOMEM);\n",
          "new_text": "_make_format_list(sample_rates);\n",
          "old_line_content": "        return AVERROR(ENOMEM);",
          "new_line_content": "    formats = ff_make_format_list(sample_rates);",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": "_free",
          "new_api": "_malloc_array",
          "old_text": "_free(data_ir_l);\n",
          "new_text": "_malloc_array(n_conv * n_samples, sizeof(*data_ir_r));\n",
          "old_line_content": "            av_free(data_ir_l);",
          "new_line_content": "        data_ir_r = av_malloc_array(n_conv * n_samples, sizeof(*data_ir_r));",
          "content_same": false
        },
        {
          "line": 936,
          "old_api": "ERROR",
          "new_api": "_free",
          "old_text": "ERROR(ENOMEM);\n",
          "new_text": "_free(data_ir_l);\n",
          "old_line_content": "            return AVERROR(ENOMEM);",
          "new_line_content": "            av_free(data_ir_l);",
          "content_same": false
        },
        {
          "line": 943,
          "old_api": "_free",
          "new_api": "_malloc_array",
          "old_text": "_free(data_hrtf_l);\n",
          "new_text": "_malloc_array(n_fft, sizeof(*data_hrtf_r) * n_conv);\n",
          "old_line_content": "            av_free(data_hrtf_l);",
          "new_line_content": "        data_hrtf_r = av_malloc_array(n_fft, sizeof(*data_hrtf_r) * n_conv);",
          "content_same": false
        },
        {
          "line": 945,
          "old_api": "ERROR",
          "new_api": "_free",
          "old_text": "ERROR(ENOMEM);\n",
          "new_text": "_free(data_hrtf_l);\n",
          "old_line_content": "            return AVERROR(ENOMEM);",
          "new_line_content": "            av_free(data_hrtf_l);",
          "content_same": false
        },
        {
          "line": 974,
          "old_api": "_free",
          "new_api": "_calloc",
          "old_text": "_free(data_hrtf_l);\n",
          "new_text": "_calloc(n_fft, sizeof(*fft_in_r));\n",
          "old_line_content": "                av_free(data_hrtf_l);",
          "new_line_content": "            fft_in_r = av_calloc(n_fft, sizeof(*fft_in_r));",
          "content_same": false
        },
        {
          "line": 978,
          "old_api": "ERROR",
          "new_api": "_free",
          "old_text": "ERROR(ENOMEM);\n",
          "new_text": "_free(fft_in_l);\n",
          "old_line_content": "                return AVERROR(ENOMEM);",
          "new_line_content": "                av_free(fft_in_l);",
          "content_same": false
        },
        {
          "line": 996,
          "old_api": "mcpy",
          "new_api": "_fft_permute",
          "old_text": "mcpy(data_hrtf_l + offset, fft_in_l, n_fft * sizeof(*fft_in_l));\n",
          "new_text": "_fft_permute(s->fft[0], fft_in_l);\n",
          "old_line_content": "            memcpy(data_hrtf_l + offset, fft_in_l, n_fft * sizeof(*fft_in_l));",
          "new_line_content": "            av_fft_permute(s->fft[0], fft_in_l);",
          "content_same": false
        },
        {
          "line": 997,
          "old_api": "_fft_permute",
          "new_api": "_fft_calc",
          "old_text": "_fft_permute(s->fft[0], fft_in_r);\n",
          "new_text": "_fft_calc(s->fft[0], fft_in_l);\n",
          "old_line_content": "            av_fft_permute(s->fft[0], fft_in_r);",
          "new_line_content": "            av_fft_calc(s->fft[0], fft_in_l);",
          "content_same": false
        },
        {
          "line": 998,
          "old_api": "_fft_calc",
          "new_api": "mcpy",
          "old_text": "_fft_calc(s->fft[0], fft_in_r);\n",
          "new_text": "mcpy(data_hrtf_l + offset, fft_in_l, n_fft * sizeof(*fft_in_l));\n",
          "old_line_content": "            av_fft_calc(s->fft[0], fft_in_r);",
          "new_line_content": "            memcpy(data_hrtf_l + offset, fft_in_l, n_fft * sizeof(*fft_in_l));",
          "content_same": false
        },
        {
          "line": 999,
          "old_api": "mcpy",
          "new_api": "_fft_permute",
          "old_text": "mcpy(data_hrtf_r + offset, fft_in_r, n_fft * sizeof(*fft_in_r));\n",
          "new_text": "_fft_permute(s->fft[0], fft_in_r);\n",
          "old_line_content": "            memcpy(data_hrtf_r + offset, fft_in_r, n_fft * sizeof(*fft_in_r));",
          "new_line_content": "            av_fft_permute(s->fft[0], fft_in_r);",
          "content_same": false
        },
        {
          "line": 1011,
          "old_api": "_freep",
          "new_api": "mcpy",
          "old_text": "_freep(&data_ir_l); ",
          "new_text": "mcpy(s->data_ir[1], data_ir_r, sizeof(float) * n_conv * n_samples);\n",
          "old_line_content": "        av_freep(&data_ir_l); /* free temporary IR memory */",
          "new_line_content": "        memcpy(s->data_ir[1], data_ir_r, sizeof(float) * n_conv * n_samples);",
          "content_same": false
        },
        {
          "line": 1014,
          "old_api": "_malloc_array",
          "new_api": "_freep",
          "old_text": "_malloc_array(n_fft * s->n_conv, sizeof(FFTComplex));\n",
          "new_text": "_freep(&data_ir_r);\n",
          "old_line_content": "        s->data_hrtf[0] = av_malloc_array(n_fft * s->n_conv, sizeof(FFTComplex));",
          "new_line_content": "        av_freep(&data_ir_r);",
          "content_same": false
        },
        {
          "line": 1017,
          "old_api": "_freep",
          "new_api": "_malloc_array",
          "old_text": "_freep(&data_hrtf_l);\n",
          "new_text": "_malloc_array(n_fft * s->n_conv, sizeof(FFTComplex));\n",
          "old_line_content": "            av_freep(&data_hrtf_l);",
          "new_line_content": "        s->data_hrtf[1] = av_malloc_array(n_fft * s->n_conv, sizeof(FFTComplex));",
          "content_same": false
        },
        {
          "line": 1021,
          "old_api": "ERROR",
          "new_api": "_freep",
          "old_text": "ERROR(ENOMEM); ",
          "new_text": "_freep(&fft_in_l);\n",
          "old_line_content": "            return AVERROR(ENOMEM); /* memory allocation failed */",
          "new_line_content": "            av_freep(&fft_in_l);",
          "content_same": false
        },
        {
          "line": 1067,
          "old_api": "ERROR",
          "new_api": "priv_float_dsp_alloc",
          "old_text": "ERROR(ENOMEM);\n",
          "new_text": "priv_float_dsp_alloc(0);\n",
          "old_line_content": "        return AVERROR(ENOMEM);",
          "new_line_content": "    s->fdsp = avpriv_float_dsp_alloc(0);",
          "content_same": false
        },
        {
          "line": 1122,
          "old_api": "g2",
          "new_api": "_fft_end",
          "old_text": "g2(s->n_fft), ",
          "new_text": "_fft_end(s->fft[0]);\n",
          "old_line_content": "        s->fft[0] = av_fft_init(log2(s->n_fft), 0);",
          "new_line_content": "        av_fft_end(s->fft[0]);",
          "content_same": false
        },
        {
          "line": 1123,
          "old_api": "g2",
          "new_api": "_fft_end",
          "old_text": "g2(s->n_fft), ",
          "new_text": "_fft_end(s->fft[1]);\n",
          "old_line_content": "        s->fft[1] = av_fft_init(log2(s->n_fft), 0);",
          "new_line_content": "        av_fft_end(s->fft[1]);",
          "content_same": false
        },
        {
          "line": 1124,
          "old_api": "_fft_end",
          "new_api": "g2",
          "old_text": "_fft_end(s->ifft[0]);\n",
          "new_text": "g2(s->n_fft), ",
          "old_line_content": "        av_fft_end(s->ifft[0]);",
          "new_line_content": "        s->fft[0] = av_fft_init(log2(s->n_fft), 0);",
          "content_same": false
        },
        {
          "line": 1125,
          "old_api": "_fft_end",
          "new_api": "g2",
          "old_text": "_fft_end(s->ifft[1]);\n",
          "new_text": "g2(s->n_fft), ",
          "old_line_content": "        av_fft_end(s->ifft[1]);",
          "new_line_content": "        s->fft[1] = av_fft_init(log2(s->n_fft), 0);",
          "content_same": false
        },
        {
          "line": 1126,
          "old_api": "g2",
          "new_api": "_fft_end",
          "old_text": "g2(s->n_fft), ",
          "new_text": "_fft_end(s->ifft[0]);\n",
          "old_line_content": "        s->ifft[0] = av_fft_init(log2(s->n_fft), 1);",
          "new_line_content": "        av_fft_end(s->ifft[0]);",
          "content_same": false
        },
        {
          "line": 1127,
          "old_api": "g2",
          "new_api": "_fft_end",
          "old_text": "g2(s->n_fft), ",
          "new_text": "_fft_end(s->ifft[1]);\n",
          "old_line_content": "        s->ifft[1] = av_fft_init(log2(s->n_fft), 1);",
          "new_line_content": "        av_fft_end(s->ifft[1]);",
          "content_same": false
        },
        {
          "line": 1152,
          "old_api": "_malloc_array",
          "new_api": "_calloc",
          "old_text": "_malloc_array(s->n_fft, sizeof(FFTComplex));\n",
          "new_text": "_calloc(s->buffer_length, sizeof(float));\n",
          "old_line_content": "        s->temp_fft[0] = av_malloc_array(s->n_fft, sizeof(FFTComplex));",
          "new_line_content": "        s->ringbuffer[0] = av_calloc(s->buffer_length, sizeof(float));",
          "content_same": false
        },
        {
          "line": 1153,
          "old_api": "_malloc_array",
          "new_api": "_calloc",
          "old_text": "_malloc_array(s->n_fft, sizeof(FFTComplex));\n",
          "new_text": "_calloc(s->buffer_length, sizeof(float));\n",
          "old_line_content": "        s->temp_fft[1] = av_malloc_array(s->n_fft, sizeof(FFTComplex));",
          "new_line_content": "        s->ringbuffer[1] = av_calloc(s->buffer_length, sizeof(float));",
          "content_same": false
        },
        {
          "line": 1155,
          "old_api": "ERROR",
          "new_api": "_malloc_array",
          "old_text": "ERROR(ENOMEM);\n",
          "new_text": "_malloc_array(s->n_fft, sizeof(FFTComplex));\n",
          "old_line_content": "            return AVERROR(ENOMEM);",
          "new_line_content": "        s->temp_fft[1] = av_malloc_array(s->n_fft, sizeof(FFTComplex));",
          "content_same": false
        },
        {
          "line": 1168,
          "old_api": "mpensate_volume",
          "new_api": "ERROR",
          "old_text": "mpensate_volume(ctx);\n",
          "new_text": "ERROR(ENOMEM);\n",
          "old_line_content": "    compensate_volume(ctx);",
          "new_line_content": "        return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1197,
          "old_api": "_fft_end",
          "new_api": "_freep",
          "old_text": "_fft_end(s->ifft[0]);\n",
          "new_text": "_freep(&s->sofa.data_ir);\n",
          "old_line_content": "    av_fft_end(s->ifft[0]);",
          "new_line_content": "        av_freep(&s->sofa.data_ir);",
          "content_same": false
        },
        {
          "line": 1201,
          "old_api": "_freep",
          "new_api": "_fft_end",
          "old_text": "_freep(&s->delay[0]);\n",
          "new_text": "_fft_end(s->fft[0]);\n",
          "old_line_content": "    av_freep(&s->delay[0]);",
          "new_line_content": "    av_fft_end(s->fft[0]);",
          "content_same": false
        },
        {
          "line": 1202,
          "old_api": "_freep",
          "new_api": "_fft_end",
          "old_text": "_freep(&s->delay[1]);\n",
          "new_text": "_fft_end(s->fft[1]);\n",
          "old_line_content": "    av_freep(&s->delay[1]);",
          "new_line_content": "    av_fft_end(s->fft[1]);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1028,
          "old_api": null,
          "new_api": "mcpy",
          "old_text": null,
          "new_text": "mcpy(s->data_hrtf[1], data_hrtf_r,\n            sizeof(FFTComplex) * n_conv * n_fft);\n",
          "old_line_content": "",
          "new_line_content": "        memcpy(s->data_hrtf[1], data_hrtf_r,",
          "content_same": false
        },
        {
          "line": 1031,
          "old_api": null,
          "new_api": "_freep",
          "old_text": null,
          "new_text": "_freep(&data_hrtf_l); ",
          "old_line_content": "",
          "new_line_content": "        av_freep(&data_hrtf_l); /* free temporary HRTF memory */",
          "content_same": false
        },
        {
          "line": 1034,
          "old_api": null,
          "new_api": "_freep",
          "old_text": null,
          "new_text": "_freep(&fft_in_l); ",
          "old_line_content": "    }",
          "new_line_content": "        av_freep(&fft_in_l); /* free temporary FFT memory */",
          "content_same": false
        },
        {
          "line": 1035,
          "old_api": null,
          "new_api": "_freep",
          "old_text": null,
          "new_text": "_freep(&fft_in_r);\n",
          "old_line_content": "",
          "new_line_content": "        av_freep(&fft_in_r);",
          "content_same": false
        },
        {
          "line": 1038,
          "old_api": null,
          "new_api": "mcpy",
          "old_text": null,
          "new_text": "mcpy(s->delay[0], &delay_l[0], sizeof(int) * s->n_conv);\n",
          "old_line_content": "",
          "new_line_content": "    memcpy(s->delay[0], &delay_l[0], sizeof(int) * s->n_conv);",
          "content_same": false
        },
        {
          "line": 1039,
          "old_api": null,
          "new_api": "mcpy",
          "old_text": null,
          "new_text": "mcpy(s->delay[1], &delay_r[0], sizeof(int) * s->n_conv);\n",
          "old_line_content": "    return 0;",
          "new_line_content": "    memcpy(s->delay[1], &delay_r[0], sizeof(int) * s->n_conv);",
          "content_same": false
        },
        {
          "line": 1054,
          "old_api": null,
          "new_api": "ad_sofa",
          "old_text": null,
          "new_text": "ad_sofa(ctx, s->filename, &s->sample_rate);\n",
          "old_line_content": "        /* file loading error */",
          "new_line_content": "    ret = load_sofa(ctx, s->filename, &s->sample_rate);",
          "content_same": false
        },
        {
          "line": 1059,
          "old_api": null,
          "new_api": "_log",
          "old_text": null,
          "new_text": "_log(ctx, AV_LOG_DEBUG, \"File '%s' loaded.\\n\", s->filename);\n",
          "old_line_content": "",
          "new_line_content": "        av_log(ctx, AV_LOG_DEBUG, \"File '%s' loaded.\\n\", s->filename);",
          "content_same": false
        },
        {
          "line": 1063,
          "old_api": null,
          "new_api": "_log",
          "old_text": null,
          "new_text": "_log(ctx, AV_LOG_ERROR, \"No valid SOFA file could be loaded. Please specify valid SOFA file.\\n\");\n",
          "old_line_content": "    }",
          "new_line_content": "        av_log(ctx, AV_LOG_ERROR, \"No valid SOFA file could be loaded. Please specify valid SOFA file.\\n\");",
          "content_same": false
        },
        {
          "line": 1069,
          "old_api": null,
          "new_api": "ERROR",
          "old_text": null,
          "new_text": "ERROR(ENOMEM);\n",
          "old_line_content": "    return 0;",
          "new_line_content": "        return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 579,
          "old_api": null,
          "new_api": "priv_scalarproduct_float_c",
          "old_text": null,
          "new_text": "priv_scalarproduct_float_c(ir, ir, sofa->n_samples);\n",
          "old_line_content": "            energy += *(ir + j) * *(ir + j);",
          "new_line_content": "            energy = avpriv_scalarproduct_float_c(ir, ir, sofa->n_samples);",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": null,
          "new_api": "rt",
          "old_text": null,
          "new_text": "rt(energy));",
          "old_line_content": "        ir = sofa->data_ir;",
          "new_line_content": "        compensate = 256 / (sofa->n_samples * sqrt(energy));",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": null,
          "new_api": "_log",
          "old_text": null,
          "new_text": "_log(ctx, AV_LOG_DEBUG, \"Compensate-factor: %f\\n\", compensate);\n",
          "old_line_content": "        for (j = 0; j < sofa->n_samples * sofa->m_dim * 2; j++) {",
          "new_line_content": "        av_log(ctx, AV_LOG_DEBUG, \"Compensate-factor: %f\\n\", compensate);",
          "content_same": false
        },
        {
          "line": 587,
          "old_api": null,
          "new_api": "vector_fmul_scalar",
          "old_text": null,
          "new_text": ">fdsp->vector_fmul_scalar(ir, ir, compensate, sofa->n_samples * sofa->m_dim * 2);\n",
          "old_line_content": "    }",
          "new_line_content": "        s->fdsp->vector_fmul_scalar(ir, ir, compensate, sofa->n_samples * sofa->m_dim * 2);",
          "content_same": false
        },
        {
          "line": 588,
          "old_api": null,
          "new_api": "ms_c",
          "old_text": null,
          "new_text": "ms_c();\n",
          "old_line_content": "",
          "new_line_content": "        emms_c();",
          "content_same": false
        },
        {
          "line": 1103,
          "old_api": null,
          "new_api": "pf",
          "old_text": null,
          "new_text": "pf((s->gain - 3 * inlink->channels - 6) / 20 * M_LN10);\n",
          "old_line_content": "    s->n_conv = nb_input_channels;",
          "new_line_content": "    s->gain_lfe = expf((s->gain - 3 * inlink->channels - 6) / 20 * M_LN10);",
          "content_same": false
        },
        {
          "line": 1109,
          "old_api": null,
          "new_api": "x_delay",
          "old_text": null,
          "new_text": "x_delay(&s->sofa);\n",
          "old_line_content": "        /* length of longest IR plus max. delay (in all SOFA files) */",
          "new_line_content": "    n_current = s->sofa.n_samples + max_delay(&s->sofa);",
          "content_same": false
        },
        {
          "line": 1118,
          "old_api": null,
          "new_api": "z",
          "old_text": null,
          "new_text": "z((uint32_t)n_max));",
          "old_line_content": "",
          "new_line_content": "    s->buffer_length = exp2(32 - clz((uint32_t)n_max));",
          "content_same": false
        },
        {
          "line": 1119,
          "old_api": null,
          "new_api": "z",
          "old_text": null,
          "new_text": "z((uint32_t)(n_max + inlink->sample_rate)));",
          "old_line_content": "    if (s->type == FREQUENCY_DOMAIN) {",
          "new_line_content": "    s->n_fft         = exp2(32 - clz((uint32_t)(n_max + inlink->sample_rate)));",
          "content_same": false
        },
        {
          "line": 1128,
          "old_api": null,
          "new_api": "g2",
          "old_text": null,
          "new_text": "g2(s->n_fft), ",
          "old_line_content": "",
          "new_line_content": "        s->ifft[0] = av_fft_init(log2(s->n_fft), 1);",
          "content_same": false
        },
        {
          "line": 1129,
          "old_api": null,
          "new_api": "g2",
          "old_text": null,
          "new_text": "g2(s->n_fft), ",
          "old_line_content": "        if (!s->fft[0] || !s->fft[1] || !s->ifft[0] || !s->ifft[1]) {",
          "new_line_content": "        s->ifft[1] = av_fft_init(log2(s->n_fft), 1);",
          "content_same": false
        },
        {
          "line": 1132,
          "old_api": null,
          "new_api": "_log",
          "old_text": null,
          "new_text": "_log(ctx, AV_LOG_ERROR, \"Unable to create FFT contexts.\\n\");\n",
          "old_line_content": "        }",
          "new_line_content": "            av_log(ctx, AV_LOG_ERROR, \"Unable to create FFT contexts.\\n\");",
          "content_same": false
        },
        {
          "line": 1133,
          "old_api": null,
          "new_api": "ERROR",
          "old_text": null,
          "new_text": "ERROR(ENOMEM);\n",
          "old_line_content": "    }",
          "new_line_content": "            return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1139,
          "old_api": null,
          "new_api": "_malloc_array",
          "old_text": null,
          "new_text": "_malloc_array(n_max_ir, sizeof(float) * s->n_conv);\n",
          "old_line_content": "    /* length:  number of channels to convolute */",
          "new_line_content": "    s->data_ir[0] = av_malloc_array(n_max_ir, sizeof(float) * s->n_conv);",
          "content_same": false
        },
        {
          "line": 1142,
          "old_api": null,
          "new_api": "_malloc_array",
          "old_text": null,
          "new_text": "_malloc_array(s->n_conv, sizeof(float));\n",
          "old_line_content": "    /* length: (buffer length) * (number of input channels),",
          "new_line_content": "    s->delay[0] = av_malloc_array(s->n_conv, sizeof(float));",
          "content_same": false
        },
        {
          "line": 1143,
          "old_api": null,
          "new_api": "_malloc_array",
          "old_text": null,
          "new_text": "_malloc_array(s->n_conv, sizeof(float));\n",
          "old_line_content": "     * OR: buffer length (if frequency domain processing)",
          "new_line_content": "    s->delay[1] = av_malloc_array(s->n_conv, sizeof(float));",
          "content_same": false
        },
        {
          "line": 1149,
          "old_api": null,
          "new_api": "_calloc",
          "old_text": null,
          "new_text": "_calloc(s->buffer_length, sizeof(float) * nb_input_channels);\n",
          "old_line_content": "    } else {",
          "new_line_content": "        s->ringbuffer[0] = av_calloc(s->buffer_length, sizeof(float) * nb_input_channels);",
          "content_same": false
        },
        {
          "line": 1154,
          "old_api": null,
          "new_api": "_malloc_array",
          "old_text": null,
          "new_text": "_malloc_array(s->n_fft, sizeof(FFTComplex));\n",
          "old_line_content": "        if (!s->temp_fft[0] || !s->temp_fft[1])",
          "new_line_content": "        s->temp_fft[0] = av_malloc_array(s->n_fft, sizeof(FFTComplex));",
          "content_same": false
        },
        {
          "line": 1157,
          "old_api": null,
          "new_api": "ERROR",
          "old_text": null,
          "new_text": "ERROR(ENOMEM);\n",
          "old_line_content": "",
          "new_line_content": "            return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1161,
          "old_api": null,
          "new_api": "_calloc",
          "old_text": null,
          "new_text": "_calloc(s->n_conv, sizeof(*s->speaker_azim));\n",
          "old_line_content": "",
          "new_line_content": "    s->speaker_azim = av_calloc(s->n_conv, sizeof(*s->speaker_azim));",
          "content_same": false
        },
        {
          "line": 1162,
          "old_api": null,
          "new_api": "_calloc",
          "old_text": null,
          "new_text": "_calloc(s->n_conv, sizeof(*s->speaker_elev));\n",
          "old_line_content": "    /* memory allocation failed: */",
          "new_line_content": "    s->speaker_elev = av_calloc(s->n_conv, sizeof(*s->speaker_elev));",
          "content_same": false
        },
        {
          "line": 1170,
          "old_api": null,
          "new_api": "mpensate_volume",
          "old_text": null,
          "new_text": "mpensate_volume(ctx);\n",
          "old_line_content": "    /* get speaker positions */",
          "new_line_content": "    compensate_volume(ctx);",
          "content_same": false
        },
        {
          "line": 1173,
          "old_api": null,
          "new_api": "t_speaker_pos",
          "old_text": null,
          "new_text": "t_speaker_pos(ctx, s->speaker_azim, s->speaker_elev)) ",
          "old_line_content": "        return ret;",
          "new_line_content": "    if ((ret = get_speaker_pos(ctx, s->speaker_azim, s->speaker_elev)) < 0) {",
          "content_same": false
        },
        {
          "line": 1174,
          "old_api": null,
          "new_api": "_log",
          "old_text": null,
          "new_text": "_log(ctx, AV_LOG_ERROR, \"Couldn't get speaker positions. Input channel configuration not supported.\\n\");\n",
          "old_line_content": "    }",
          "new_line_content": "        av_log(ctx, AV_LOG_ERROR, \"Couldn't get speaker positions. Input channel configuration not supported.\\n\");",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": null,
          "new_api": "mcpy",
          "old_text": null,
          "new_text": "mcpy(temp_src, bptr + read, len * sizeof(*temp_src));\n",
          "old_line_content": "            }",
          "new_line_content": "                memcpy(temp_src, bptr + read, len * sizeof(*temp_src));",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": null,
          "new_api": "mcpy",
          "old_text": null,
          "new_text": "mcpy(temp_src + len, bptr, (n_samples - len) * sizeof(*temp_src));\n",
          "old_line_content": "",
          "new_line_content": "                memcpy(temp_src + len, bptr, (n_samples - len) * sizeof(*temp_src));",
          "content_same": false
        },
        {
          "line": 1179,
          "old_api": null,
          "new_api": "ad_data",
          "old_text": null,
          "new_text": "ad_data(ctx, s->rotation, s->elevation, s->radius)) ",
          "old_line_content": "",
          "new_line_content": "    if ((ret = load_data(ctx, s->rotation, s->elevation, s->radius)) < 0)",
          "content_same": false
        },
        {
          "line": 1182,
          "old_api": null,
          "new_api": "_log",
          "old_text": null,
          "new_text": "_log(ctx, AV_LOG_DEBUG, \"Samplerate: %d Channels to convolute: %d, Length of ringbuffer: %d x %d\\n\",\n        inlink->sample_rate, s->n_conv, nb_input_channels, s->buffer_length);\n",
          "old_line_content": "",
          "new_line_content": "    av_log(ctx, AV_LOG_DEBUG, \"Samplerate: %d Channels to convolute: %d, Length of ringbuffer: %d x %d\\n\",",
          "content_same": false
        },
        {
          "line": 672,
          "old_api": null,
          "new_api": "scalarproduct_float",
          "old_text": null,
          "new_text": ">fdsp->scalarproduct_float(temp_ir, temp_src, n_samples);\n",
          "old_line_content": "        }",
          "new_line_content": "            dst[0] += s->fdsp->scalarproduct_float(temp_ir, temp_src, n_samples);",
          "content_same": false
        },
        {
          "line": 677,
          "old_api": null,
          "new_api": "bs",
          "old_text": null,
          "new_text": "bs(*dst) >",
          "old_line_content": "",
          "new_line_content": "        if (fabs(*dst) > 1)",
          "content_same": false
        },
        {
          "line": 1196,
          "old_api": null,
          "new_api": "_freep",
          "old_text": null,
          "new_text": "_freep(&s->sofa.data_delay);\n",
          "old_line_content": "    }",
          "new_line_content": "        av_freep(&s->sofa.data_delay);",
          "content_same": false
        },
        {
          "line": 1216,
          "old_api": null,
          "new_api": "_freep",
          "old_text": null,
          "new_text": "_freep(&s->data_hrtf[1]);\n",
          "old_line_content": "}",
          "new_line_content": "    av_freep(&s->data_hrtf[1]);",
          "content_same": false
        },
        {
          "line": 1217,
          "old_api": null,
          "new_api": "_freep",
          "old_text": null,
          "new_text": "_freep(&s->fdsp);\n",
          "old_line_content": "",
          "new_line_content": "    av_freep(&s->fdsp);",
          "content_same": false
        },
        {
          "line": 1228,
          "old_api": null,
          "new_api": "FSET",
          "old_text": null,
          "new_text": "FSET(radius), ",
          "old_line_content": "    { \"time\",      \"time domain\",      0,               AV_OPT_TYPE_CONST,  {.i64=0},       0,   0, .flags = FLAGS, \"type\" },",
          "new_line_content": "    { \"radius\",    \"set radius\",     OFFSET(radius),    AV_OPT_TYPE_FLOAT,  {.dbl=1},       0,   3, .flags = FLAGS },",
          "content_same": false
        },
        {
          "line": 1229,
          "old_api": null,
          "new_api": "FSET",
          "old_text": null,
          "new_text": "FSET(type), ",
          "old_line_content": "    { \"freq\",      \"frequency domain\", 0,               AV_OPT_TYPE_CONST,  {.i64=1},       0,   0, .flags = FLAGS, \"type\" },",
          "new_line_content": "    { \"type\",      \"set processing\", OFFSET(type),      AV_OPT_TYPE_INT,    {.i64=1},       0,   1, .flags = FLAGS, \"type\" },",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": null,
          "new_api": "MIN",
          "old_text": null,
          "new_text": "MIN(s->sofa.n_samples, in->nb_samples);\n",
          "old_line_content": "        /* initialize output buf with saved signal from overflow buf */",
          "new_line_content": "    n_read = FFMIN(s->sofa.n_samples, in->nb_samples);",
          "content_same": false
        },
        {
          "line": 1235,
          "old_api": null,
          "new_api": "FILTER_DEFINE_CLASS",
          "old_text": null,
          "new_text": "FILTER_DEFINE_CLASS(sofalizer);\n",
          "old_line_content": "static const AVFilterPad inputs[] = {",
          "new_line_content": "AVFILTER_DEFINE_CLASS(sofalizer);",
          "content_same": false
        },
        {
          "line": 1257,
          "old_api": null,
          "new_api": "LL_IF_CONFIG_SMALL",
          "old_text": null,
          "new_text": "LL_IF_CONFIG_SMALL(\"SOFAlizer (Spatially Oriented Format for Acoustics).\"),\n",
          "old_line_content": "    .priv_class    = &sofalizer_class,",
          "new_line_content": "    .description   = NULL_IF_CONFIG_SMALL(\"SOFAlizer (Spatially Oriented Format for Acoustics).\"),",
          "content_same": false
        },
        {
          "line": 749,
          "old_api": null,
          "new_api": "mset",
          "old_text": null,
          "new_text": "mset(fft_in, 0, sizeof(FFTComplex) * n_fft);\n",
          "old_line_content": "        for (j = 0; j < in->nb_samples; j++) {",
          "new_line_content": "        memset(fft_in, 0, sizeof(FFTComplex) * n_fft);",
          "content_same": false
        },
        {
          "line": 758,
          "old_api": null,
          "new_api": "_fft_permute",
          "old_text": null,
          "new_text": "_fft_permute(fft, fft_in);\n",
          "old_line_content": "        for (j = 0; j < n_fft; j++) {",
          "new_line_content": "        av_fft_permute(fft, fft_in);",
          "content_same": false
        },
        {
          "line": 759,
          "old_api": null,
          "new_api": "_fft_calc",
          "old_text": null,
          "new_text": "_fft_calc(fft, fft_in);\n",
          "old_line_content": "            const float re = fft_in[j].re;",
          "new_line_content": "        av_fft_calc(fft, fft_in);",
          "content_same": false
        },
        {
          "line": 772,
          "old_api": null,
          "new_api": "_fft_permute",
          "old_text": null,
          "new_text": "_fft_permute(ifft, fft_in);\n",
          "old_line_content": "",
          "new_line_content": "        av_fft_permute(ifft, fft_in);",
          "content_same": false
        },
        {
          "line": 773,
          "old_api": null,
          "new_api": "_fft_calc",
          "old_text": null,
          "new_text": "_fft_calc(ifft, fft_in);\n",
          "old_line_content": "        for (j = 0; j < in->nb_samples; j++) {",
          "new_line_content": "        av_fft_calc(ifft, fft_in);",
          "content_same": false
        },
        {
          "line": 791,
          "old_api": null,
          "new_api": "bs",
          "old_text": null,
          "new_text": "bs(*dst) >",
          "old_line_content": "        }",
          "new_line_content": "        if (fabs(*dst) > 1) { /* if current output sample > 1 */",
          "content_same": false
        },
        {
          "line": 816,
          "old_api": null,
          "new_api": "_frame_free",
          "old_text": null,
          "new_text": "_frame_free(&in);\n",
          "old_line_content": "    }",
          "new_line_content": "        av_frame_free(&in);",
          "content_same": false
        },
        {
          "line": 819,
          "old_api": null,
          "new_api": "_frame_copy_props",
          "old_text": null,
          "new_text": "_frame_copy_props(out, in);\n",
          "old_line_content": "    td.in = in; td.out = out; td.write = s->write;",
          "new_line_content": "    av_frame_copy_props(out, in);",
          "content_same": false
        },
        {
          "line": 831,
          "old_api": null,
          "new_api": "ms_c",
          "old_text": null,
          "new_text": "ms_c();\n",
          "old_line_content": "    /* display error message if clipping occured */",
          "new_line_content": "    emms_c();",
          "content_same": false
        },
        {
          "line": 835,
          "old_api": null,
          "new_api": "_log",
          "old_text": null,
          "new_text": "_log(ctx, AV_LOG_WARNING, \"%d of %d samples clipped. Please reduce gain.\\n\",\n               n_clippings[0] + n_clippings[1], out->nb_samples * 2);\n",
          "old_line_content": "    }",
          "new_line_content": "        av_log(ctx, AV_LOG_WARNING, \"%d of %d samples clipped. Please reduce gain.\\n\",",
          "content_same": false
        },
        {
          "line": 839,
          "old_api": null,
          "new_api": "_frame_free",
          "old_text": null,
          "new_text": "_frame_free(&in);\n",
          "old_line_content": "}",
          "new_line_content": "    av_frame_free(&in);",
          "content_same": false
        },
        {
          "line": 840,
          "old_api": null,
          "new_api": "_filter_frame",
          "old_text": null,
          "new_text": "_filter_frame(outlink, out);\n",
          "old_line_content": "",
          "new_line_content": "    return ff_filter_frame(outlink, out);",
          "content_same": false
        },
        {
          "line": 872,
          "old_api": null,
          "new_api": "_add_format",
          "old_text": null,
          "new_text": "_add_format(&formats, AV_SAMPLE_FMT_FLT);\n",
          "old_line_content": "        return ret;",
          "new_line_content": "    ret = ff_add_format(&formats, AV_SAMPLE_FMT_FLT);",
          "content_same": false
        },
        {
          "line": 875,
          "old_api": null,
          "new_api": "_set_common_formats",
          "old_text": null,
          "new_text": "_set_common_formats(ctx, formats);\n",
          "old_line_content": "        return ret;",
          "new_line_content": "    ret = ff_set_common_formats(ctx, formats);",
          "content_same": false
        },
        {
          "line": 883,
          "old_api": null,
          "new_api": "_channel_layouts_ref",
          "old_text": null,
          "new_text": "_channel_layouts_ref(layouts, &ctx->inputs[0]->out_channel_layouts);\n",
          "old_line_content": "        return ret;",
          "new_line_content": "    ret = ff_channel_layouts_ref(layouts, &ctx->inputs[0]->out_channel_layouts);",
          "content_same": false
        },
        {
          "line": 888,
          "old_api": null,
          "new_api": "_add_channel_layout",
          "old_text": null,
          "new_text": "_add_channel_layout(&layouts, AV_CH_LAYOUT_STEREO);\n",
          "old_line_content": "        return ret;",
          "new_line_content": "    ret = ff_add_channel_layout(&layouts, AV_CH_LAYOUT_STEREO);",
          "content_same": false
        },
        {
          "line": 892,
          "old_api": null,
          "new_api": "_channel_layouts_ref",
          "old_text": null,
          "new_text": "_channel_layouts_ref(layouts, &ctx->outputs[0]->in_channel_layouts);\n",
          "old_line_content": "        return ret;",
          "new_line_content": "    ret = ff_channel_layouts_ref(layouts, &ctx->outputs[0]->in_channel_layouts);",
          "content_same": false
        },
        {
          "line": 899,
          "old_api": null,
          "new_api": "ERROR",
          "old_text": null,
          "new_text": "ERROR(ENOMEM);\n",
          "old_line_content": "}",
          "new_line_content": "        return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 900,
          "old_api": null,
          "new_api": "_set_common_samplerates",
          "old_text": null,
          "new_text": "_set_common_samplerates(ctx, formats);\n",
          "old_line_content": "",
          "new_line_content": "    return ff_set_common_samplerates(ctx, formats);",
          "content_same": false
        },
        {
          "line": 912,
          "old_api": null,
          "new_api": "pf",
          "old_text": null,
          "new_text": "pf((s->gain - 3 * nb_input_channels) / 20 * M_LN10); ",
          "old_line_content": "    FFTComplex *data_hrtf_r = NULL;",
          "new_line_content": "    float gain_lin = expf((s->gain - 3 * nb_input_channels) / 20 * M_LN10); /* gain - 3dB/channel */",
          "content_same": false
        },
        {
          "line": 924,
          "old_api": null,
          "new_api": "_log",
          "old_text": null,
          "new_text": "_log(ctx, AV_LOG_ERROR, \"Selected SOFA file is invalid. Please select valid SOFA file.\\n\");\n",
          "old_line_content": "    }",
          "new_line_content": "        av_log(ctx, AV_LOG_ERROR, \"Selected SOFA file is invalid. Please select valid SOFA file.\\n\");",
          "content_same": false
        },
        {
          "line": 929,
          "old_api": null,
          "new_api": "ALIGN",
          "old_text": null,
          "new_text": "ALIGN(n_samples, 16), ",
          "old_line_content": "",
          "new_line_content": "        s->temp_src[0] = av_calloc(FFALIGN(n_samples, 16), sizeof(float));",
          "content_same": false
        },
        {
          "line": 930,
          "old_api": null,
          "new_api": "ALIGN",
          "old_text": null,
          "new_text": "ALIGN(n_samples, 16), ",
          "old_line_content": "        /* get temporary IR for L and R channel */",
          "new_line_content": "        s->temp_src[1] = av_calloc(FFALIGN(n_samples, 16), sizeof(float));",
          "content_same": false
        },
        {
          "line": 933,
          "old_api": null,
          "new_api": "_malloc_array",
          "old_text": null,
          "new_text": "_malloc_array(n_conv * n_samples, sizeof(*data_ir_l));\n",
          "old_line_content": "        if (!data_ir_r || !data_ir_l || !s->temp_src[0] || !s->temp_src[1]) {",
          "new_line_content": "        data_ir_l = av_malloc_array(n_conv * n_samples, sizeof(*data_ir_l));",
          "content_same": false
        },
        {
          "line": 937,
          "old_api": null,
          "new_api": "_free",
          "old_text": null,
          "new_text": "_free(data_ir_r);\n",
          "old_line_content": "        }",
          "new_line_content": "            av_free(data_ir_r);",
          "content_same": false
        },
        {
          "line": 938,
          "old_api": null,
          "new_api": "ERROR",
          "old_text": null,
          "new_text": "ERROR(ENOMEM);\n",
          "old_line_content": "    } else {",
          "new_line_content": "            return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 942,
          "old_api": null,
          "new_api": "_malloc_array",
          "old_text": null,
          "new_text": "_malloc_array(n_fft, sizeof(*data_hrtf_l) * n_conv);\n",
          "old_line_content": "        if (!data_hrtf_r || !data_hrtf_l) {",
          "new_line_content": "        data_hrtf_l = av_malloc_array(n_fft, sizeof(*data_hrtf_l) * n_conv);",
          "content_same": false
        },
        {
          "line": 946,
          "old_api": null,
          "new_api": "_free",
          "old_text": null,
          "new_text": "_free(data_hrtf_r);\n",
          "old_line_content": "        }",
          "new_line_content": "            av_free(data_hrtf_r);",
          "content_same": false
        },
        {
          "line": 947,
          "old_api": null,
          "new_api": "ERROR",
          "old_text": null,
          "new_text": "ERROR(ENOMEM);\n",
          "old_line_content": "    }",
          "new_line_content": "            return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 956,
          "old_api": null,
          "new_api": "nd_m",
          "old_text": null,
          "new_text": "nd_m(s, azim, elev, radius);\n",
          "old_line_content": "        /* load the delays associated with the current IRs */",
          "new_line_content": "        m[i] = find_m(s, azim, elev, radius);",
          "content_same": false
        },
        {
          "line": 973,
          "old_api": null,
          "new_api": "_calloc",
          "old_text": null,
          "new_text": "_calloc(n_fft, sizeof(*fft_in_l));\n",
          "old_line_content": "            if (!fft_in_l || !fft_in_r) {",
          "new_line_content": "            fft_in_l = av_calloc(n_fft, sizeof(*fft_in_l));",
          "content_same": false
        },
        {
          "line": 979,
          "old_api": null,
          "new_api": "_free",
          "old_text": null,
          "new_text": "_free(fft_in_r);\n",
          "old_line_content": "            }",
          "new_line_content": "                av_free(fft_in_r);",
          "content_same": false
        },
        {
          "line": 980,
          "old_api": null,
          "new_api": "ERROR",
          "old_text": null,
          "new_text": "ERROR(ENOMEM);\n",
          "old_line_content": "",
          "new_line_content": "                return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1000,
          "old_api": null,
          "new_api": "_fft_calc",
          "old_text": null,
          "new_text": "_fft_calc(s->fft[0], fft_in_r);\n",
          "old_line_content": "        }",
          "new_line_content": "            av_fft_calc(s->fft[0], fft_in_r);",
          "content_same": false
        },
        {
          "line": 1001,
          "old_api": null,
          "new_api": "mcpy",
          "old_text": null,
          "new_text": "mcpy(data_hrtf_r + offset, fft_in_r, n_fft * sizeof(*fft_in_r));\n",
          "old_line_content": "",
          "new_line_content": "            memcpy(data_hrtf_r + offset, fft_in_r, n_fft * sizeof(*fft_in_r));",
          "content_same": false
        },
        {
          "line": 1004,
          "old_api": null,
          "new_api": "_log",
          "old_text": null,
          "new_text": "_log(ctx, AV_LOG_DEBUG, \"Index: %d, Azimuth: %f, Elevation: %f, Radius: %f of SOFA file.\\n\",\n               m[i], *(s->sofa.sp_a + m[i]), *(s->sofa.sp_e + m[i]), *(s->sofa.sp_r + m[i]));\n",
          "old_line_content": "    }",
          "new_line_content": "        av_log(ctx, AV_LOG_DEBUG, \"Index: %d, Azimuth: %f, Elevation: %f, Radius: %f of SOFA file.\\n\",",
          "content_same": false
        },
        {
          "line": 1010,
          "old_api": null,
          "new_api": "mcpy",
          "old_text": null,
          "new_text": "mcpy(s->data_ir[0], data_ir_l, sizeof(float) * n_conv * n_samples);\n",
          "old_line_content": "",
          "new_line_content": "        memcpy(s->data_ir[0], data_ir_l, sizeof(float) * n_conv * n_samples);",
          "content_same": false
        },
        {
          "line": 1013,
          "old_api": null,
          "new_api": "_freep",
          "old_text": null,
          "new_text": "_freep(&data_ir_l); ",
          "old_line_content": "    } else {",
          "new_line_content": "        av_freep(&data_ir_l); /* free temporary IR memory */",
          "content_same": false
        },
        {
          "line": 1016,
          "old_api": null,
          "new_api": "_malloc_array",
          "old_text": null,
          "new_text": "_malloc_array(n_fft * s->n_conv, sizeof(FFTComplex));\n",
          "old_line_content": "        if (!s->data_hrtf[0] || !s->data_hrtf[1]) {",
          "new_line_content": "        s->data_hrtf[0] = av_malloc_array(n_fft * s->n_conv, sizeof(FFTComplex));",
          "content_same": false
        },
        {
          "line": 1022,
          "old_api": null,
          "new_api": "_freep",
          "old_text": null,
          "new_text": "_freep(&fft_in_r);\n",
          "old_line_content": "        }",
          "new_line_content": "            av_freep(&fft_in_r);",
          "content_same": false
        },
        {
          "line": 1023,
          "old_api": null,
          "new_api": "ERROR",
          "old_text": null,
          "new_text": "ERROR(ENOMEM); ",
          "old_line_content": "",
          "new_line_content": "            return AVERROR(ENOMEM); /* memory allocation failed */",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1024,
          "old_api": "mcpy",
          "new_api": null,
          "old_text": "mcpy(s->data_hrtf[0], data_hrtf_l, /* copy HRTF data to */\n            sizeof(FFTComplex) * n_conv * n_fft); ",
          "new_text": null,
          "old_line_content": "        memcpy(s->data_hrtf[0], data_hrtf_l, /* copy HRTF data to */",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1029,
          "old_api": "_freep",
          "new_api": null,
          "old_text": "_freep(&data_hrtf_l); ",
          "new_text": null,
          "old_line_content": "        av_freep(&data_hrtf_l); /* free temporary HRTF memory */",
          "new_line_content": "            sizeof(FFTComplex) * n_conv * n_fft);",
          "content_same": false
        },
        {
          "line": 1030,
          "old_api": "_freep",
          "new_api": null,
          "old_text": "_freep(&data_hrtf_r);\n",
          "new_text": null,
          "old_line_content": "        av_freep(&data_hrtf_r);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1033,
          "old_api": "_freep",
          "new_api": null,
          "old_text": "_freep(&fft_in_r);\n",
          "new_text": null,
          "old_line_content": "        av_freep(&fft_in_r);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1036,
          "old_api": "mcpy",
          "new_api": null,
          "old_text": "mcpy(s->delay[0], &delay_l[0], sizeof(int) * s->n_conv);\n",
          "new_text": null,
          "old_line_content": "    memcpy(s->delay[0], &delay_l[0], sizeof(int) * s->n_conv);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1037,
          "old_api": "mcpy",
          "new_api": null,
          "old_text": "mcpy(s->delay[1], &delay_r[0], sizeof(int) * s->n_conv);\n",
          "new_text": null,
          "old_line_content": "    memcpy(s->delay[1], &delay_r[0], sizeof(int) * s->n_conv);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1052,
          "old_api": "ad_sofa",
          "new_api": null,
          "old_text": "ad_sofa(ctx, s->filename, &s->sample_rate);\n",
          "new_text": null,
          "old_line_content": "    ret = load_sofa(ctx, s->filename, &s->sample_rate);",
          "new_line_content": "     * loaded files is free'd */",
          "content_same": false
        },
        {
          "line": 1055,
          "old_api": "_log",
          "new_api": null,
          "old_text": "_log(ctx, AV_LOG_ERROR, \"Error while loading SOFA file: '%s'\\n\", s->filename);\n",
          "new_text": null,
          "old_line_content": "        av_log(ctx, AV_LOG_ERROR, \"Error while loading SOFA file: '%s'\\n\", s->filename);",
          "new_line_content": "    if (ret) {",
          "content_same": false
        },
        {
          "line": 1061,
          "old_api": "_log",
          "new_api": null,
          "old_text": "_log(ctx, AV_LOG_ERROR, \"No valid SOFA file could be loaded. Please specify valid SOFA file.\\n\");\n",
          "new_text": null,
          "old_line_content": "        av_log(ctx, AV_LOG_ERROR, \"No valid SOFA file could be loaded. Please specify valid SOFA file.\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1065,
          "old_api": "priv_float_dsp_alloc",
          "new_api": null,
          "old_text": "priv_float_dsp_alloc(0);\n",
          "new_text": null,
          "old_line_content": "    s->fdsp = avpriv_float_dsp_alloc(0);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 582,
          "old_api": "_log",
          "new_api": null,
          "old_text": "_log(ctx, AV_LOG_DEBUG, \"Compensate-factor: %f\\n\", compensate);\n",
          "new_text": null,
          "old_line_content": "        av_log(ctx, AV_LOG_DEBUG, \"Compensate-factor: %f\\n\", compensate);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1101,
          "old_api": "pf",
          "new_api": null,
          "old_text": "pf((s->gain - 3 * inlink->channels - 6) / 20 * M_LN10);\n",
          "new_text": null,
          "old_line_content": "    s->gain_lfe = expf((s->gain - 3 * inlink->channels - 6) / 20 * M_LN10);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1107,
          "old_api": "x_delay",
          "new_api": null,
          "old_text": "x_delay(&s->sofa);\n",
          "new_text": null,
          "old_line_content": "    n_current = s->sofa.n_samples + max_delay(&s->sofa);",
          "new_line_content": "    /* get size of ringbuffer (longest IR plus max. delay) */",
          "content_same": false
        },
        {
          "line": 1116,
          "old_api": "z",
          "new_api": null,
          "old_text": "z((uint32_t)n_max));",
          "new_text": null,
          "old_line_content": "    s->buffer_length = exp2(32 - clz((uint32_t)n_max));",
          "new_line_content": "    /* buffer length is longest IR plus max. delay -> next power of 2",
          "content_same": false
        },
        {
          "line": 1117,
          "old_api": "z",
          "new_api": null,
          "old_text": "z((uint32_t)(n_max + inlink->sample_rate)));",
          "new_text": null,
          "old_line_content": "    s->n_fft         = exp2(32 - clz((uint32_t)(n_max + inlink->sample_rate)));",
          "new_line_content": "       (32 - count leading zeros gives required exponent)  */",
          "content_same": false
        },
        {
          "line": 1120,
          "old_api": "_fft_end",
          "new_api": null,
          "old_text": "_fft_end(s->fft[0]);\n",
          "new_text": null,
          "old_line_content": "        av_fft_end(s->fft[0]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1121,
          "old_api": "_fft_end",
          "new_api": null,
          "old_text": "_fft_end(s->fft[1]);\n",
          "new_text": null,
          "old_line_content": "        av_fft_end(s->fft[1]);",
          "new_line_content": "    if (s->type == FREQUENCY_DOMAIN) {",
          "content_same": false
        },
        {
          "line": 1130,
          "old_api": "_log",
          "new_api": null,
          "old_text": "_log(ctx, AV_LOG_ERROR, \"Unable to create FFT contexts.\\n\");\n",
          "new_text": null,
          "old_line_content": "            av_log(ctx, AV_LOG_ERROR, \"Unable to create FFT contexts.\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1131,
          "old_api": "ERROR",
          "new_api": null,
          "old_text": "ERROR(ENOMEM);\n",
          "new_text": null,
          "old_line_content": "            return AVERROR(ENOMEM);",
          "new_line_content": "        if (!s->fft[0] || !s->fft[1] || !s->ifft[0] || !s->ifft[1]) {",
          "content_same": false
        },
        {
          "line": 1137,
          "old_api": "_malloc_array",
          "new_api": null,
          "old_text": "_malloc_array(n_max_ir, sizeof(float) * s->n_conv);\n",
          "new_text": null,
          "old_line_content": "    s->data_ir[0] = av_malloc_array(n_max_ir, sizeof(float) * s->n_conv);",
          "new_line_content": "    /* Allocate memory for the impulse responses, delays and the ringbuffers */",
          "content_same": false
        },
        {
          "line": 1138,
          "old_api": "_malloc_array",
          "new_api": null,
          "old_text": "_malloc_array(n_max_ir, sizeof(float) * s->n_conv);\n",
          "new_text": null,
          "old_line_content": "    s->data_ir[1] = av_malloc_array(n_max_ir, sizeof(float) * s->n_conv);",
          "new_line_content": "    /* size: (longest IR) * (number of channels to convolute) */",
          "content_same": false
        },
        {
          "line": 1141,
          "old_api": "_malloc_array",
          "new_api": null,
          "old_text": "_malloc_array(s->n_conv, sizeof(float));\n",
          "new_text": null,
          "old_line_content": "    s->delay[1] = av_malloc_array(s->n_conv, sizeof(float));",
          "new_line_content": "    /* length:  number of channels to convolute */",
          "content_same": false
        },
        {
          "line": 1147,
          "old_api": "_calloc",
          "new_api": null,
          "old_text": "_calloc(s->buffer_length, sizeof(float) * nb_input_channels);\n",
          "new_text": null,
          "old_line_content": "        s->ringbuffer[0] = av_calloc(s->buffer_length, sizeof(float) * nb_input_channels);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1148,
          "old_api": "_calloc",
          "new_api": null,
          "old_text": "_calloc(s->buffer_length, sizeof(float) * nb_input_channels);\n",
          "new_text": null,
          "old_line_content": "        s->ringbuffer[1] = av_calloc(s->buffer_length, sizeof(float) * nb_input_channels);",
          "new_line_content": "    if (s->type == TIME_DOMAIN) {",
          "content_same": false
        },
        {
          "line": 1151,
          "old_api": "_calloc",
          "new_api": null,
          "old_text": "_calloc(s->buffer_length, sizeof(float));\n",
          "new_text": null,
          "old_line_content": "        s->ringbuffer[1] = av_calloc(s->buffer_length, sizeof(float));",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 1159,
          "old_api": "_calloc",
          "new_api": null,
          "old_text": "_calloc(s->n_conv, sizeof(*s->speaker_azim));\n",
          "new_text": null,
          "old_line_content": "    s->speaker_azim = av_calloc(s->n_conv, sizeof(*s->speaker_azim));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1160,
          "old_api": "_calloc",
          "new_api": null,
          "old_text": "_calloc(s->n_conv, sizeof(*s->speaker_elev));\n",
          "new_text": null,
          "old_line_content": "    s->speaker_elev = av_calloc(s->n_conv, sizeof(*s->speaker_elev));",
          "new_line_content": "    /* length: number of channels to convolute */",
          "content_same": false
        },
        {
          "line": 1166,
          "old_api": "ERROR",
          "new_api": null,
          "old_text": "ERROR(ENOMEM);\n",
          "new_text": null,
          "old_line_content": "        return AVERROR(ENOMEM);",
          "new_line_content": "        !s->delay[0] || !s->ringbuffer[0] || !s->ringbuffer[1] ||",
          "content_same": false
        },
        {
          "line": 1171,
          "old_api": "t_speaker_pos",
          "new_api": null,
          "old_text": "t_speaker_pos(ctx, s->speaker_azim, s->speaker_elev)) ",
          "new_text": null,
          "old_line_content": "    if ((ret = get_speaker_pos(ctx, s->speaker_azim, s->speaker_elev)) < 0) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1172,
          "old_api": "_log",
          "new_api": null,
          "old_text": "_log(ctx, AV_LOG_ERROR, \"Couldn't get speaker positions. Input channel configuration not supported.\\n\");\n",
          "new_text": null,
          "old_line_content": "        av_log(ctx, AV_LOG_ERROR, \"Couldn't get speaker positions. Input channel configuration not supported.\\n\");",
          "new_line_content": "    /* get speaker positions */",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": "mcpy",
          "new_api": null,
          "old_text": "mcpy(temp_src, bptr + read, n_samples * sizeof(*temp_src));\n",
          "new_text": null,
          "old_line_content": "                memcpy(temp_src, bptr + read, n_samples * sizeof(*temp_src));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1177,
          "old_api": "ad_data",
          "new_api": null,
          "old_text": "ad_data(ctx, s->rotation, s->elevation, s->radius)) ",
          "new_text": null,
          "old_line_content": "    if ((ret = load_data(ctx, s->rotation, s->elevation, s->radius)) < 0)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 666,
          "old_api": "mcpy",
          "new_api": null,
          "old_text": "mcpy(temp_src + len, bptr, (n_samples - len) * sizeof(*temp_src));\n",
          "new_text": null,
          "old_line_content": "                memcpy(temp_src + len, bptr, (n_samples - len) * sizeof(*temp_src));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1180,
          "old_api": "_log",
          "new_api": null,
          "old_text": "_log(ctx, AV_LOG_DEBUG, \"Samplerate: %d Channels to convolute: %d, Length of ringbuffer: %d x %d\\n\",\n        inlink->sample_rate, s->n_conv, nb_input_channels, s->buffer_length);\n",
          "new_text": null,
          "old_line_content": "    av_log(ctx, AV_LOG_DEBUG, \"Samplerate: %d Channels to convolute: %d, Length of ringbuffer: %d x %d\\n\",",
          "new_line_content": "        return ret;",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": "scalarproduct_float",
          "new_api": null,
          "old_text": ">fdsp->scalarproduct_float(temp_ir, temp_src, n_samples);\n",
          "new_text": null,
          "old_line_content": "            dst[0] += s->fdsp->scalarproduct_float(temp_ir, temp_src, n_samples);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 675,
          "old_api": "bs",
          "new_api": null,
          "old_text": "bs(*dst) >",
          "new_text": null,
          "old_line_content": "        if (fabs(*dst) > 1)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1191,
          "old_api": "_freep",
          "new_api": null,
          "old_text": "_freep(&s->sofa.sp_a);\n",
          "new_text": null,
          "old_line_content": "        av_freep(&s->sofa.sp_a);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1192,
          "old_api": "_freep",
          "new_api": null,
          "old_text": "_freep(&s->sofa.sp_e);\n",
          "new_text": null,
          "old_line_content": "        av_freep(&s->sofa.sp_e);",
          "new_line_content": "    if (s->sofa.ncid) {",
          "content_same": false
        },
        {
          "line": 1198,
          "old_api": "_fft_end",
          "new_api": null,
          "old_text": "_fft_end(s->ifft[1]);\n",
          "new_text": null,
          "old_line_content": "    av_fft_end(s->ifft[1]);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1222,
          "old_api": "FSET",
          "new_api": null,
          "old_text": "FSET(filename), ",
          "new_text": null,
          "old_line_content": "    { \"sofa\",      \"sofa filename\",  OFFSET(filename),  AV_OPT_TYPE_STRING, {.str=NULL},            .flags = FLAGS },",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1223,
          "old_api": "FSET",
          "new_api": null,
          "old_text": "FSET(gain), ",
          "new_text": null,
          "old_line_content": "    { \"gain\",      \"set gain in dB\", OFFSET(gain),      AV_OPT_TYPE_FLOAT,  {.dbl=0},     -20,  40, .flags = FLAGS },",
          "new_line_content": "static const AVOption sofalizer_options[] = {",
          "content_same": false
        },
        {
          "line": 720,
          "old_api": "MIN",
          "new_api": null,
          "old_text": "MIN(s->sofa.n_samples, in->nb_samples);\n",
          "new_text": null,
          "old_line_content": "    n_read = FFMIN(s->sofa.n_samples, in->nb_samples);",
          "new_line_content": "    /* find minimum between number of samples and output buffer length:",
          "content_same": false
        },
        {
          "line": 1233,
          "old_api": "FILTER_DEFINE_CLASS",
          "new_api": null,
          "old_text": "FILTER_DEFINE_CLASS(sofalizer);\n",
          "new_text": null,
          "old_line_content": "AVFILTER_DEFINE_CLASS(sofalizer);",
          "new_line_content": "};",
          "content_same": false
        },
        {
          "line": 1255,
          "old_api": "LL_IF_CONFIG_SMALL",
          "new_api": null,
          "old_text": "LL_IF_CONFIG_SMALL(\"SOFAlizer (Spatially Oriented Format for Acoustics).\"),\n",
          "new_text": null,
          "old_line_content": "    .description   = NULL_IF_CONFIG_SMALL(\"SOFAlizer (Spatially Oriented Format for Acoustics).\"),",
          "new_line_content": "AVFilter ff_af_sofalizer = {",
          "content_same": false
        },
        {
          "line": 747,
          "old_api": "mset",
          "new_api": null,
          "old_text": "mset(fft_in, 0, sizeof(FFTComplex) * n_fft);\n",
          "new_text": null,
          "old_line_content": "        memset(fft_in, 0, sizeof(FFTComplex) * n_fft);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 756,
          "old_api": "_fft_permute",
          "new_api": null,
          "old_text": "_fft_permute(fft, fft_in);\n",
          "new_text": null,
          "old_line_content": "        av_fft_permute(fft, fft_in);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 757,
          "old_api": "_fft_calc",
          "new_api": null,
          "old_text": "_fft_calc(fft, fft_in);\n",
          "new_text": null,
          "old_line_content": "        av_fft_calc(fft, fft_in);",
          "new_line_content": "        /* transform input signal of current channel to frequency domain */",
          "content_same": false
        },
        {
          "line": 770,
          "old_api": "_fft_permute",
          "new_api": null,
          "old_text": "_fft_permute(ifft, fft_in);\n",
          "new_text": null,
          "old_line_content": "        av_fft_permute(ifft, fft_in);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 771,
          "old_api": "_fft_calc",
          "new_api": null,
          "old_text": "_fft_calc(ifft, fft_in);\n",
          "new_text": null,
          "old_line_content": "        av_fft_calc(ifft, fft_in);",
          "new_line_content": "        /* transform output signal of current channel back to time domain */",
          "content_same": false
        },
        {
          "line": 789,
          "old_api": "bs",
          "new_api": null,
          "old_text": "bs(*dst) >",
          "new_text": null,
          "old_line_content": "        if (fabs(*dst) > 1) { /* if current output sample > 1 */",
          "new_line_content": "    for (i = 0; i < out->nb_samples; i++) {",
          "content_same": false
        },
        {
          "line": 812,
          "old_api": "_get_audio_buffer",
          "new_api": null,
          "old_text": "_get_audio_buffer(outlink, in->nb_samples);\n",
          "new_text": null,
          "old_line_content": "    out = ff_get_audio_buffer(outlink, in->nb_samples);",
          "new_line_content": "    AVFrame *out;",
          "content_same": false
        },
        {
          "line": 815,
          "old_api": "ERROR",
          "new_api": null,
          "old_text": "ERROR(ENOMEM);\n",
          "new_text": null,
          "old_line_content": "        return AVERROR(ENOMEM);",
          "new_line_content": "    if (!out) {",
          "content_same": false
        },
        {
          "line": 825,
          "old_api": "execute",
          "new_api": null,
          "old_text": "x->internal->execute(ctx, sofalizer_convolute, &td, NULL, 2);\n",
          "new_text": null,
          "old_line_content": "        ctx->internal->execute(ctx, sofalizer_convolute, &td, NULL, 2);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 833,
          "old_api": "_log",
          "new_api": null,
          "old_text": "_log(ctx, AV_LOG_WARNING, \"%d of %d samples clipped. Please reduce gain.\\n\",\n               n_clippings[0] + n_clippings[1], out->nb_samples * 2);\n",
          "new_text": null,
          "old_line_content": "        av_log(ctx, AV_LOG_WARNING, \"%d of %d samples clipped. Please reduce gain.\\n\",",
          "new_line_content": "    /* display error message if clipping occured */",
          "content_same": false
        },
        {
          "line": 837,
          "old_api": "_frame_free",
          "new_api": null,
          "old_text": "_frame_free(&in);\n",
          "new_text": null,
          "old_line_content": "    av_frame_free(&in);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 838,
          "old_api": "_filter_frame",
          "new_api": null,
          "old_text": "_filter_frame(outlink, out);\n",
          "new_text": null,
          "old_line_content": "    return ff_filter_frame(outlink, out);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 870,
          "old_api": "_add_format",
          "new_api": null,
          "old_text": "_add_format(&formats, AV_SAMPLE_FMT_FLT);\n",
          "new_text": null,
          "old_line_content": "    ret = ff_add_format(&formats, AV_SAMPLE_FMT_FLT);",
          "new_line_content": "                                                0, };",
          "content_same": false
        },
        {
          "line": 873,
          "old_api": "_set_common_formats",
          "new_api": null,
          "old_text": "_set_common_formats(ctx, formats);\n",
          "new_text": null,
          "old_line_content": "    ret = ff_set_common_formats(ctx, formats);",
          "new_line_content": "    if (ret)",
          "content_same": false
        },
        {
          "line": 877,
          "old_api": "_make_formatu64_list",
          "new_api": null,
          "old_text": "_make_formatu64_list(channel_layouts);\n",
          "new_text": null,
          "old_line_content": "    layouts = ff_make_formatu64_list(channel_layouts);",
          "new_line_content": "        return ret;",
          "content_same": false
        },
        {
          "line": 886,
          "old_api": "_add_channel_layout",
          "new_api": null,
          "old_text": "_add_channel_layout(&layouts, AV_CH_LAYOUT_STEREO);\n",
          "new_text": null,
          "old_line_content": "    ret = ff_add_channel_layout(&layouts, AV_CH_LAYOUT_STEREO);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 890,
          "old_api": "_channel_layouts_ref",
          "new_api": null,
          "old_text": "_channel_layouts_ref(layouts, &ctx->outputs[0]->in_channel_layouts);\n",
          "new_text": null,
          "old_line_content": "    ret = ff_channel_layouts_ref(layouts, &ctx->outputs[0]->in_channel_layouts);",
          "new_line_content": "        return ret;",
          "content_same": false
        },
        {
          "line": 895,
          "old_api": "_make_format_list",
          "new_api": null,
          "old_text": "_make_format_list(sample_rates);\n",
          "new_text": null,
          "old_line_content": "    formats = ff_make_format_list(sample_rates);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 898,
          "old_api": "_set_common_samplerates",
          "new_api": null,
          "old_text": "_set_common_samplerates(ctx, formats);\n",
          "new_text": null,
          "old_line_content": "    return ff_set_common_samplerates(ctx, formats);",
          "new_line_content": "    if (!formats)",
          "content_same": false
        },
        {
          "line": 910,
          "old_api": "pf",
          "new_api": null,
          "old_text": "pf((s->gain - 3 * nb_input_channels) / 20 * M_LN10); ",
          "new_text": null,
          "old_line_content": "    float gain_lin = expf((s->gain - 3 * nb_input_channels) / 20 * M_LN10); /* gain - 3dB/channel */",
          "new_line_content": "    int delay_r[10];",
          "content_same": false
        },
        {
          "line": 922,
          "old_api": "_log",
          "new_api": null,
          "old_text": "_log(ctx, AV_LOG_ERROR, \"Selected SOFA file is invalid. Please select valid SOFA file.\\n\");\n",
          "new_text": null,
          "old_line_content": "        av_log(ctx, AV_LOG_ERROR, \"Selected SOFA file is invalid. Please select valid SOFA file.\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 927,
          "old_api": "ALIGN",
          "new_api": null,
          "old_text": "ALIGN(n_samples, 16), ",
          "new_text": null,
          "old_line_content": "        s->temp_src[0] = av_calloc(FFALIGN(n_samples, 16), sizeof(float));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 928,
          "old_api": "ALIGN",
          "new_api": null,
          "old_text": "ALIGN(n_samples, 16), ",
          "new_text": null,
          "old_line_content": "        s->temp_src[1] = av_calloc(FFALIGN(n_samples, 16), sizeof(float));",
          "new_line_content": "    if (s->type == TIME_DOMAIN) {",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": "_malloc_array",
          "new_api": null,
          "old_text": "_malloc_array(n_conv * n_samples, sizeof(*data_ir_l));\n",
          "new_text": null,
          "old_line_content": "        data_ir_l = av_malloc_array(n_conv * n_samples, sizeof(*data_ir_l));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 932,
          "old_api": "_malloc_array",
          "new_api": null,
          "old_text": "_malloc_array(n_conv * n_samples, sizeof(*data_ir_r));\n",
          "new_text": null,
          "old_line_content": "        data_ir_r = av_malloc_array(n_conv * n_samples, sizeof(*data_ir_r));",
          "new_line_content": "        /* get temporary IR for L and R channel */",
          "content_same": false
        },
        {
          "line": 935,
          "old_api": "_free",
          "new_api": null,
          "old_text": "_free(data_ir_r);\n",
          "new_text": null,
          "old_line_content": "            av_free(data_ir_r);",
          "new_line_content": "        if (!data_ir_r || !data_ir_l || !s->temp_src[0] || !s->temp_src[1]) {",
          "content_same": false
        },
        {
          "line": 940,
          "old_api": "_malloc_array",
          "new_api": null,
          "old_text": "_malloc_array(n_fft, sizeof(*data_hrtf_l) * n_conv);\n",
          "new_text": null,
          "old_line_content": "        data_hrtf_l = av_malloc_array(n_fft, sizeof(*data_hrtf_l) * n_conv);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 941,
          "old_api": "_malloc_array",
          "new_api": null,
          "old_text": "_malloc_array(n_fft, sizeof(*data_hrtf_r) * n_conv);\n",
          "new_text": null,
          "old_line_content": "        data_hrtf_r = av_malloc_array(n_fft, sizeof(*data_hrtf_r) * n_conv);",
          "new_line_content": "        /* get temporary HRTF memory for L and R channel */",
          "content_same": false
        },
        {
          "line": 944,
          "old_api": "_free",
          "new_api": null,
          "old_text": "_free(data_hrtf_r);\n",
          "new_text": null,
          "old_line_content": "            av_free(data_hrtf_r);",
          "new_line_content": "        if (!data_hrtf_r || !data_hrtf_l) {",
          "content_same": false
        },
        {
          "line": 954,
          "old_api": "nd_m",
          "new_api": null,
          "old_text": "nd_m(s, azim, elev, radius);\n",
          "new_text": null,
          "old_line_content": "        m[i] = find_m(s, azim, elev, radius);",
          "new_line_content": "        elev = (int)(s->speaker_elev[i] + elev_orig) % 90;",
          "content_same": false
        },
        {
          "line": 971,
          "old_api": "_calloc",
          "new_api": null,
          "old_text": "_calloc(n_fft, sizeof(*fft_in_l));\n",
          "new_text": null,
          "old_line_content": "            fft_in_l = av_calloc(n_fft, sizeof(*fft_in_l));",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 972,
          "old_api": "_calloc",
          "new_api": null,
          "old_text": "_calloc(n_fft, sizeof(*fft_in_r));\n",
          "new_text": null,
          "old_line_content": "            fft_in_r = av_calloc(n_fft, sizeof(*fft_in_r));",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 975,
          "old_api": "_free",
          "new_api": null,
          "old_text": "_free(data_hrtf_r);\n",
          "new_text": null,
          "old_line_content": "                av_free(data_hrtf_r);",
          "new_line_content": "            if (!fft_in_l || !fft_in_r) {",
          "content_same": false
        },
        {
          "line": 994,
          "old_api": "_fft_permute",
          "new_api": null,
          "old_text": "_fft_permute(s->fft[0], fft_in_l);\n",
          "new_text": null,
          "old_line_content": "            av_fft_permute(s->fft[0], fft_in_l);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 995,
          "old_api": "_fft_calc",
          "new_api": null,
          "old_text": "_fft_calc(s->fft[0], fft_in_l);\n",
          "new_text": null,
          "old_line_content": "            av_fft_calc(s->fft[0], fft_in_l);",
          "new_line_content": "            /* actually transform to frequency domain (IRs -> HRTFs) */",
          "content_same": false
        },
        {
          "line": 1002,
          "old_api": "_log",
          "new_api": null,
          "old_text": "_log(ctx, AV_LOG_DEBUG, \"Index: %d, Azimuth: %f, Elevation: %f, Radius: %f of SOFA file.\\n\",\n               m[i], *(s->sofa.sp_a + m[i]), *(s->sofa.sp_e + m[i]), *(s->sofa.sp_r + m[i]));\n",
          "new_text": null,
          "old_line_content": "        av_log(ctx, AV_LOG_DEBUG, \"Index: %d, Azimuth: %f, Elevation: %f, Radius: %f of SOFA file.\\n\",",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1008,
          "old_api": "mcpy",
          "new_api": null,
          "old_text": "mcpy(s->data_ir[0], data_ir_l, sizeof(float) * n_conv * n_samples);\n",
          "new_text": null,
          "old_line_content": "        memcpy(s->data_ir[0], data_ir_l, sizeof(float) * n_conv * n_samples);",
          "new_line_content": "    if (s->type == TIME_DOMAIN) {",
          "content_same": false
        },
        {
          "line": 1009,
          "old_api": "mcpy",
          "new_api": null,
          "old_text": "mcpy(s->data_ir[1], data_ir_r, sizeof(float) * n_conv * n_samples);\n",
          "new_text": null,
          "old_line_content": "        memcpy(s->data_ir[1], data_ir_r, sizeof(float) * n_conv * n_samples);",
          "new_line_content": "        /* copy IRs and delays to allocated memory in the SOFAlizerContext struct: */",
          "content_same": false
        },
        {
          "line": 1012,
          "old_api": "_freep",
          "new_api": null,
          "old_text": "_freep(&data_ir_r);\n",
          "new_text": null,
          "old_line_content": "        av_freep(&data_ir_r);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1015,
          "old_api": "_malloc_array",
          "new_api": null,
          "old_text": "_malloc_array(n_fft * s->n_conv, sizeof(FFTComplex));\n",
          "new_text": null,
          "old_line_content": "        s->data_hrtf[1] = av_malloc_array(n_fft * s->n_conv, sizeof(FFTComplex));",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 1018,
          "old_api": "_freep",
          "new_api": null,
          "old_text": "_freep(&data_hrtf_r);\n",
          "new_text": null,
          "old_line_content": "            av_freep(&data_hrtf_r);",
          "new_line_content": "        if (!s->data_hrtf[0] || !s->data_hrtf[1]) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 37,
      "total_additions": 89,
      "total_deletions": 85,
      "total_api_changes": 211
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 10,
        "api_related_lines": 211,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          578,
          580,
          585,
          586,
          570
        ]
      }
    },
    "api_calls_before": 272,
    "api_calls_after": 276,
    "diff_info": {
      "added_lines": 8,
      "removed_lines": 6,
      "total_diff_lines": 37
    }
  }
}