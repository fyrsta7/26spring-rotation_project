{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/fd3c34ff304aebbeba1e730957bef08280fc9e10",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/fd3c34ff304aebbeba1e730957bef08280fc9e10/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/fd3c34ff304aebbeba1e730957bef08280fc9e10/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/fd3c34ff304aebbeba1e730957bef08280fc9e10/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1976,
          "old_api": "av_log",
          "new_api": "read_specific_config",
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Reading ALSSpecificConfig failed.\\n\")",
          "new_text": "read_specific_config(ctx)",
          "old_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Reading ALSSpecificConfig failed.\\n\");",
          "new_line_content": "    if ((ret = read_specific_config(ctx)) < 0) {",
          "content_same": false
        },
        {
          "line": 2031,
          "old_api": "AVERROR",
          "new_api": "av_log",
          "old_text": "AVERROR(ENOMEM)",
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\")",
          "old_line_content": "        ret = AVERROR(ENOMEM);",
          "new_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\");",
          "content_same": false
        },
        {
          "line": 2046,
          "old_api": "av_mallocz_array",
          "new_api": "av_malloc_array",
          "old_text": "av_mallocz_array(num_buffers, sizeof(*ctx->use_ltp))",
          "new_text": "av_malloc_array(num_buffers, sizeof(*ctx->store_prev_samples))",
          "old_line_content": "    ctx->use_ltp         = av_mallocz_array(num_buffers, sizeof(*ctx->use_ltp));",
          "new_line_content": "    ctx->store_prev_samples = av_malloc_array(num_buffers, sizeof(*ctx->store_prev_samples));",
          "content_same": false
        },
        {
          "line": 2047,
          "old_api": "av_malloc_array",
          "new_api": "av_mallocz_array",
          "old_text": "av_malloc_array(num_buffers, sizeof(*ctx->ltp_lag))",
          "new_text": "av_mallocz_array(num_buffers, sizeof(*ctx->use_ltp))",
          "old_line_content": "    ctx->ltp_lag         = av_malloc_array(num_buffers, sizeof(*ctx->ltp_lag));",
          "new_line_content": "    ctx->use_ltp         = av_mallocz_array(num_buffers, sizeof(*ctx->use_ltp));",
          "content_same": false
        },
        {
          "line": 2056,
          "old_api": "AVERROR",
          "new_api": "av_log",
          "old_text": "AVERROR(ENOMEM)",
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\")",
          "old_line_content": "        ret = AVERROR(ENOMEM);",
          "new_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\");",
          "content_same": false
        },
        {
          "line": 2074,
          "old_api": "AVERROR",
          "new_api": "av_log",
          "old_text": "AVERROR(ENOMEM)",
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\")",
          "old_line_content": "            ret = AVERROR(ENOMEM);",
          "new_line_content": "            av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\");",
          "content_same": false
        },
        {
          "line": 2089,
          "old_api": "av_mallocz_array",
          "new_api": "av_malloc_array",
          "old_text": "av_mallocz_array(avctx->channels * channel_size, sizeof(*ctx->raw_buffer))",
          "new_text": "av_malloc_array(sconf->max_order, sizeof(*ctx->prev_raw_samples))",
          "old_line_content": "    ctx->raw_buffer       = av_mallocz_array(avctx->channels * channel_size, sizeof(*ctx->raw_buffer));",
          "new_line_content": "    ctx->prev_raw_samples = av_malloc_array(sconf->max_order, sizeof(*ctx->prev_raw_samples));",
          "content_same": false
        },
        {
          "line": 2090,
          "old_api": "av_malloc_array",
          "new_api": "av_mallocz_array",
          "old_text": "av_malloc_array(avctx->channels, sizeof(*ctx->raw_samples))",
          "new_text": "av_mallocz_array(avctx->channels * channel_size, sizeof(*ctx->raw_buffer))",
          "old_line_content": "    ctx->raw_samples      = av_malloc_array(avctx->channels, sizeof(*ctx->raw_samples));",
          "new_line_content": "    ctx->raw_buffer       = av_mallocz_array(avctx->channels * channel_size, sizeof(*ctx->raw_buffer));",
          "content_same": false
        },
        {
          "line": 2097,
          "old_api": "av_mallocz_array",
          "new_api": "av_malloc_array",
          "old_text": "av_mallocz_array(avctx->channels, sizeof(*ctx->raw_mantissa))",
          "new_text": "av_malloc_array(avctx->channels, sizeof(*ctx->last_acf_mantissa))",
          "old_line_content": "        ctx->raw_mantissa      = av_mallocz_array(avctx->channels, sizeof(*ctx->raw_mantissa));",
          "new_line_content": "        ctx->last_acf_mantissa = av_malloc_array(avctx->channels, sizeof(*ctx->last_acf_mantissa));",
          "content_same": false
        },
        {
          "line": 2101,
          "old_api": "av_mallocz",
          "new_api": "av_malloc_array",
          "old_text": "av_mallocz(sizeof(*ctx->mlz))",
          "new_text": "av_malloc_array(ctx->cur_frame_length, sizeof(*ctx->nbits))",
          "old_line_content": "        ctx->mlz    = av_mallocz(sizeof(*ctx->mlz));",
          "new_line_content": "        ctx->nbits  = av_malloc_array(ctx->cur_frame_length, sizeof(*ctx->nbits));",
          "content_same": false
        },
        {
          "line": 2106,
          "old_api": "AVERROR",
          "new_api": "av_log",
          "old_text": "AVERROR(ENOMEM)",
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\")",
          "old_line_content": "            ret = AVERROR(ENOMEM);",
          "new_line_content": "            av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\");",
          "content_same": false
        },
        {
          "line": 2111,
          "old_api": "ff_mlz_flush_dict",
          "new_api": "ff_mlz_init_dict",
          "old_text": "ff_mlz_flush_dict(ctx->mlz)",
          "new_text": "ff_mlz_init_dict(avctx, ctx->mlz)",
          "old_line_content": "        ff_mlz_flush_dict(ctx->mlz);",
          "new_line_content": "        ff_mlz_init_dict(avctx, ctx->mlz);",
          "content_same": false
        },
        {
          "line": 2121,
          "old_api": "AVERROR",
          "new_api": "av_log",
          "old_text": "AVERROR(ENOMEM)",
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\")",
          "old_line_content": "        ret = AVERROR(ENOMEM);",
          "new_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\");",
          "content_same": false
        },
        {
          "line": 2139,
          "old_api": "AVERROR",
          "new_api": "av_log",
          "old_text": "AVERROR(ENOMEM)",
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\")",
          "old_line_content": "            ret = AVERROR(ENOMEM);",
          "new_line_content": "            av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\");",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 2050,
          "old_api": null,
          "new_api": "av_malloc_array",
          "old_text": null,
          "new_text": "av_malloc_array(num_buffers * 5, sizeof(*ctx->ltp_gain_buffer))",
          "old_line_content": "",
          "new_line_content": "    ctx->ltp_gain_buffer = av_malloc_array(num_buffers * 5, sizeof(*ctx->ltp_gain_buffer));",
          "content_same": false
        },
        {
          "line": 2057,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "        goto fail;",
          "new_line_content": "        ret = AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 2066,
          "old_api": null,
          "new_api": "av_mallocz_array",
          "old_text": null,
          "new_text": "av_mallocz_array(num_buffers * num_buffers,\n                                                 sizeof(*ctx->chan_data_buffer))",
          "old_line_content": "                                                 sizeof(*ctx->chan_data_buffer));",
          "new_line_content": "        ctx->chan_data_buffer  = av_mallocz_array(num_buffers * num_buffers,",
          "content_same": false
        },
        {
          "line": 1938,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&ctx->crc_buffer)",
          "old_line_content": "    if (ctx->mlz) {",
          "new_line_content": "    av_freep(&ctx->crc_buffer);",
          "content_same": false
        },
        {
          "line": 2068,
          "old_api": null,
          "new_api": "av_mallocz_array",
          "old_text": null,
          "new_text": "av_mallocz_array(num_buffers,\n                                                 sizeof(*ctx->chan_data))",
          "old_line_content": "                                                 sizeof(*ctx->chan_data));",
          "new_line_content": "        ctx->chan_data         = av_mallocz_array(num_buffers,",
          "content_same": false
        },
        {
          "line": 1941,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&ctx->mlz)",
          "old_line_content": "    }",
          "new_line_content": "        av_freep(&ctx->mlz);",
          "content_same": false
        },
        {
          "line": 2070,
          "old_api": null,
          "new_api": "av_malloc_array",
          "old_text": null,
          "new_text": "av_malloc_array(num_buffers,\n                                                 sizeof(*ctx->reverted_channels))",
          "old_line_content": "                                                 sizeof(*ctx->reverted_channels));",
          "new_line_content": "        ctx->reverted_channels = av_malloc_array(num_buffers,",
          "content_same": false
        },
        {
          "line": 1946,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&ctx->last_shift_value)",
          "old_line_content": "    if (ctx->raw_mantissa) {",
          "new_line_content": "    av_freep(&ctx->last_shift_value);",
          "content_same": false
        },
        {
          "line": 2075,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "            goto fail;",
          "new_line_content": "            ret = AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1949,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&ctx->raw_mantissa[i])",
          "old_line_content": "        }",
          "new_line_content": "            av_freep(&ctx->raw_mantissa[i]);",
          "content_same": false
        },
        {
          "line": 1951,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&ctx->raw_mantissa)",
          "old_line_content": "    }",
          "new_line_content": "        av_freep(&ctx->raw_mantissa);",
          "content_same": false
        },
        {
          "line": 1954,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&ctx->nbits)",
          "old_line_content": "",
          "new_line_content": "    av_freep(&ctx->nbits);",
          "content_same": false
        },
        {
          "line": 2091,
          "old_api": null,
          "new_api": "av_malloc_array",
          "old_text": null,
          "new_text": "av_malloc_array(avctx->channels, sizeof(*ctx->raw_samples))",
          "old_line_content": "",
          "new_line_content": "    ctx->raw_samples      = av_malloc_array(avctx->channels, sizeof(*ctx->raw_samples));",
          "content_same": false
        },
        {
          "line": 1837,
          "old_api": null,
          "new_api": "INTERLEAVE_OUTPUT",
          "old_text": null,
          "new_text": "INTERLEAVE_OUTPUT(16)",
          "old_line_content": "    } else {",
          "new_line_content": "        INTERLEAVE_OUTPUT(16)",
          "content_same": false
        },
        {
          "line": 1839,
          "old_api": null,
          "new_api": "INTERLEAVE_OUTPUT",
          "old_text": null,
          "new_text": "INTERLEAVE_OUTPUT(32)",
          "old_line_content": "    }",
          "new_line_content": "        INTERLEAVE_OUTPUT(32)",
          "content_same": false
        },
        {
          "line": 2098,
          "old_api": null,
          "new_api": "av_mallocz_array",
          "old_text": null,
          "new_text": "av_mallocz_array(avctx->channels, sizeof(*ctx->raw_mantissa))",
          "old_line_content": "",
          "new_line_content": "        ctx->raw_mantissa      = av_mallocz_array(avctx->channels, sizeof(*ctx->raw_mantissa));",
          "content_same": false
        },
        {
          "line": 1972,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Missing required ALS extradata.\\n\")",
          "old_line_content": "        return AVERROR_INVALIDDATA;",
          "new_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Missing required ALS extradata.\\n\");",
          "content_same": false
        },
        {
          "line": 2102,
          "old_api": null,
          "new_api": "av_mallocz",
          "old_text": null,
          "new_text": "av_mallocz(sizeof(*ctx->mlz))",
          "old_line_content": "",
          "new_line_content": "        ctx->mlz    = av_mallocz(sizeof(*ctx->mlz));",
          "content_same": false
        },
        {
          "line": 1977,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Reading ALSSpecificConfig failed.\\n\")",
          "old_line_content": "        goto fail;",
          "new_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Reading ALSSpecificConfig failed.\\n\");",
          "content_same": false
        },
        {
          "line": 2107,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "            goto fail;",
          "new_line_content": "            ret = AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1981,
          "old_api": null,
          "new_api": "check_specific_config",
          "old_text": null,
          "new_text": "check_specific_config(ctx)",
          "old_line_content": "        goto fail;",
          "new_line_content": "    if ((ret = check_specific_config(ctx)) < 0) {",
          "content_same": false
        },
        {
          "line": 1855,
          "old_api": null,
          "new_api": "av_bswap32",
          "old_text": null,
          "new_text": "av_bswap32(src[sample])",
          "old_line_content": "                else",
          "new_line_content": "                    v = av_bswap32(src[sample]);",
          "content_same": false
        },
        {
          "line": 2112,
          "old_api": null,
          "new_api": "ff_mlz_flush_dict",
          "old_text": null,
          "new_text": "ff_mlz_flush_dict(ctx->mlz)",
          "old_line_content": "",
          "new_line_content": "        ff_mlz_flush_dict(ctx->mlz);",
          "content_same": false
        },
        {
          "line": 1986,
          "old_api": null,
          "new_api": "ff_bgmc_init",
          "old_text": null,
          "new_text": "ff_bgmc_init(avctx, &ctx->bgmc_lut, &ctx->bgmc_lut_status)",
          "old_line_content": "        if (ret < 0)",
          "new_line_content": "        ret = ff_bgmc_init(avctx, &ctx->bgmc_lut, &ctx->bgmc_lut_status);",
          "content_same": false
        },
        {
          "line": 2115,
          "old_api": null,
          "new_api": "av_mallocz_array",
          "old_text": null,
          "new_text": "av_mallocz_array(ctx->cur_frame_length, sizeof(**ctx->raw_mantissa))",
          "old_line_content": "        }",
          "new_line_content": "            ctx->raw_mantissa[c] = av_mallocz_array(ctx->cur_frame_length, sizeof(**ctx->raw_mantissa));",
          "content_same": false
        },
        {
          "line": 1861,
          "old_api": null,
          "new_api": "av_crc",
          "old_text": null,
          "new_text": "av_crc(ctx->crc_table, ctx->crc, (uint8_t*)(&v), 3)",
          "old_line_content": "            }",
          "new_line_content": "                ctx->crc = av_crc(ctx->crc_table, ctx->crc, (uint8_t*)(&v), 3);",
          "content_same": false
        },
        {
          "line": 2122,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "        goto fail;",
          "new_line_content": "        ret = AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1998,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Bits per raw sample %d larger than 32.\\n\",\n                   avctx->bits_per_raw_sample)",
          "old_line_content": "                   avctx->bits_per_raw_sample);",
          "new_line_content": "            av_log(avctx, AV_LOG_ERROR, \"Bits per raw sample %d larger than 32.\\n\",",
          "content_same": false
        },
        {
          "line": 1873,
          "old_api": null,
          "new_api": "av_bswap16",
          "old_text": null,
          "new_text": "av_bswap16(src[sample])",
          "old_line_content": "                } else {",
          "new_line_content": "                        *dest++ = av_bswap16(src[sample]);",
          "content_same": false
        },
        {
          "line": 1875,
          "old_api": null,
          "new_api": "bswap_buf",
          "old_text": null,
          "new_text": "ctx->bdsp.bswap_buf((uint32_t *) ctx->crc_buffer,\n                                        (uint32_t *) frame->data[0],\n                                        ctx->cur_frame_length * avctx->channels)",
          "old_line_content": "                                        (uint32_t *) frame->data[0],",
          "new_line_content": "                    ctx->bdsp.bswap_buf((uint32_t *) ctx->crc_buffer,",
          "content_same": false
        },
        {
          "line": 2134,
          "old_api": null,
          "new_api": "av_malloc_array",
          "old_text": null,
          "new_text": "av_malloc_array(ctx->cur_frame_length *\n                                          avctx->channels *\n                                          av_get_bytes_per_sample(avctx->sample_fmt),\n                                          sizeof(*ctx->crc_buffer))",
          "old_line_content": "                                          avctx->channels *",
          "new_line_content": "        ctx->crc_buffer = av_malloc_array(ctx->cur_frame_length *",
          "content_same": false
        },
        {
          "line": 2136,
          "old_api": null,
          "new_api": "av_get_bytes_per_sample",
          "old_text": null,
          "new_text": "av_get_bytes_per_sample(avctx->sample_fmt)",
          "old_line_content": "                                          sizeof(*ctx->crc_buffer));",
          "new_line_content": "                                          av_get_bytes_per_sample(avctx->sample_fmt),",
          "content_same": false
        },
        {
          "line": 2140,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "            goto fail;",
          "new_line_content": "            ret = AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1884,
          "old_api": null,
          "new_api": "av_crc",
          "old_text": null,
          "new_text": "av_crc(ctx->crc_table, ctx->crc, crc_source,\n                              ctx->cur_frame_length * avctx->channels *\n                              av_get_bytes_per_sample(avctx->sample_fmt))",
          "old_line_content": "                              ctx->cur_frame_length * avctx->channels *",
          "new_line_content": "            ctx->crc = av_crc(ctx->crc_table, ctx->crc, crc_source,",
          "content_same": false
        },
        {
          "line": 1886,
          "old_api": null,
          "new_api": "av_get_bytes_per_sample",
          "old_text": null,
          "new_text": "av_get_bytes_per_sample(avctx->sample_fmt)",
          "old_line_content": "        }",
          "new_line_content": "                              av_get_bytes_per_sample(avctx->sample_fmt));",
          "content_same": false
        },
        {
          "line": 2145,
          "old_api": null,
          "new_api": "ff_bswapdsp_init",
          "old_text": null,
          "new_text": "ff_bswapdsp_init(&ctx->bdsp)",
          "old_line_content": "",
          "new_line_content": "    ff_bswapdsp_init(&ctx->bdsp);",
          "content_same": false
        },
        {
          "line": 1893,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"CRC error.\\n\")",
          "old_line_content": "            if (avctx->err_recognition & AV_EF_EXPLODE)",
          "new_line_content": "            av_log(avctx, AV_LOG_ERROR, \"CRC error.\\n\");",
          "content_same": false
        },
        {
          "line": 2021,
          "old_api": null,
          "new_api": "av_malloc_array",
          "old_text": null,
          "new_text": "av_malloc_array(num_buffers * sconf->max_order,\n                                            sizeof(*ctx->quant_cof_buffer))",
          "old_line_content": "                                            sizeof(*ctx->quant_cof_buffer));",
          "new_line_content": "    ctx->quant_cof_buffer = av_malloc_array(num_buffers * sconf->max_order,",
          "content_same": false
        },
        {
          "line": 2023,
          "old_api": null,
          "new_api": "av_malloc_array",
          "old_text": null,
          "new_text": "av_malloc_array(num_buffers * sconf->max_order,\n                                            sizeof(*ctx->lpc_cof_buffer))",
          "old_line_content": "                                            sizeof(*ctx->lpc_cof_buffer));",
          "new_line_content": "    ctx->lpc_cof_buffer   = av_malloc_array(num_buffers * sconf->max_order,",
          "content_same": false
        },
        {
          "line": 2025,
          "old_api": null,
          "new_api": "av_malloc_array",
          "old_text": null,
          "new_text": "av_malloc_array(sconf->max_order,\n                                                   sizeof(*ctx->lpc_cof_buffer))",
          "old_line_content": "                                                   sizeof(*ctx->lpc_cof_buffer));",
          "new_line_content": "    ctx->lpc_cof_reversed_buffer = av_malloc_array(sconf->max_order,",
          "content_same": false
        },
        {
          "line": 1902,
          "old_api": null,
          "new_api": "get_bits_count",
          "old_text": null,
          "new_text": "get_bits_count(&ctx->gb)",
          "old_line_content": "",
          "new_line_content": "                                 (get_bits_count(&ctx->gb) + 7) >> 3;",
          "content_same": false
        },
        {
          "line": 2032,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "        goto fail;",
          "new_line_content": "        ret = AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 2166,
          "old_api": null,
          "new_api": "NULL_IF_CONFIG_SMALL",
          "old_text": null,
          "new_text": "NULL_IF_CONFIG_SMALL(\"MPEG-4 Audio Lossless Coding (ALS)\")",
          "old_line_content": "    .type           = AVMEDIA_TYPE_AUDIO,",
          "new_line_content": "    .long_name      = NULL_IF_CONFIG_SMALL(\"MPEG-4 Audio Lossless Coding (ALS)\"),",
          "content_same": false
        },
        {
          "line": 1915,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&ctx->sconf.chan_pos)",
          "old_line_content": "",
          "new_line_content": "    av_freep(&ctx->sconf.chan_pos);",
          "content_same": false
        },
        {
          "line": 1917,
          "old_api": null,
          "new_api": "ff_bgmc_end",
          "old_text": null,
          "new_text": "ff_bgmc_end(&ctx->bgmc_lut, &ctx->bgmc_lut_status)",
          "old_line_content": "",
          "new_line_content": "    ff_bgmc_end(&ctx->bgmc_lut, &ctx->bgmc_lut_status);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 2055,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\");",
          "new_line_content": "        !ctx->ltp_gain || !ctx->ltp_gain_buffer) {",
          "content_same": false
        },
        {
          "line": 2065,
          "old_api": "av_mallocz_array",
          "new_api": null,
          "old_text": "av_mallocz_array(num_buffers * num_buffers,\n                                                 sizeof(*ctx->chan_data_buffer))",
          "new_text": null,
          "old_line_content": "        ctx->chan_data_buffer  = av_mallocz_array(num_buffers * num_buffers,",
          "new_line_content": "    if (sconf->mc_coding) {",
          "content_same": false
        },
        {
          "line": 2067,
          "old_api": "av_mallocz_array",
          "new_api": null,
          "old_text": "av_mallocz_array(num_buffers,\n                                                 sizeof(*ctx->chan_data))",
          "new_text": null,
          "old_line_content": "        ctx->chan_data         = av_mallocz_array(num_buffers,",
          "new_line_content": "                                                 sizeof(*ctx->chan_data_buffer));",
          "content_same": false
        },
        {
          "line": 1939,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&ctx->mlz->dict)",
          "new_text": null,
          "old_line_content": "        av_freep(&ctx->mlz->dict);",
          "new_line_content": "    if (ctx->mlz) {",
          "content_same": false
        },
        {
          "line": 2069,
          "old_api": "av_malloc_array",
          "new_api": null,
          "old_text": "av_malloc_array(num_buffers,\n                                                 sizeof(*ctx->reverted_channels))",
          "new_text": null,
          "old_line_content": "        ctx->reverted_channels = av_malloc_array(num_buffers,",
          "new_line_content": "                                                 sizeof(*ctx->chan_data));",
          "content_same": false
        },
        {
          "line": 1942,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&ctx->acf)",
          "new_text": null,
          "old_line_content": "    av_freep(&ctx->acf);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2073,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\")",
          "new_text": null,
          "old_line_content": "            av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\");",
          "new_line_content": "        if (!ctx->chan_data_buffer || !ctx->chan_data || !ctx->reverted_channels) {",
          "content_same": false
        },
        {
          "line": 1948,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&ctx->raw_mantissa[i])",
          "new_text": null,
          "old_line_content": "            av_freep(&ctx->raw_mantissa[i]);",
          "new_line_content": "        for (i = 0; i < avctx->channels; i++) {",
          "content_same": false
        },
        {
          "line": 1950,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&ctx->raw_mantissa)",
          "new_text": null,
          "old_line_content": "        av_freep(&ctx->raw_mantissa);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1952,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&ctx->larray)",
          "new_text": null,
          "old_line_content": "    av_freep(&ctx->larray);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2042,
          "old_api": "av_malloc_array",
          "new_api": null,
          "old_text": "av_malloc_array(num_buffers, sizeof(*ctx->const_block))",
          "new_text": null,
          "old_line_content": "    ctx->const_block     = av_malloc_array(num_buffers, sizeof(*ctx->const_block));",
          "new_line_content": "    // allocate and assign lag and gain data buffer for ltp mode",
          "content_same": false
        },
        {
          "line": 2088,
          "old_api": "av_malloc_array",
          "new_api": null,
          "old_text": "av_malloc_array(sconf->max_order, sizeof(*ctx->prev_raw_samples))",
          "new_text": null,
          "old_line_content": "    ctx->prev_raw_samples = av_malloc_array(sconf->max_order, sizeof(*ctx->prev_raw_samples));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1836,
          "old_api": "INTERLEAVE_OUTPUT",
          "new_api": null,
          "old_text": "INTERLEAVE_OUTPUT(16)",
          "new_text": null,
          "old_line_content": "        INTERLEAVE_OUTPUT(16)",
          "new_line_content": "    if (ctx->avctx->bits_per_raw_sample <= 16) {",
          "content_same": false
        },
        {
          "line": 2093,
          "old_api": "av_malloc_array",
          "new_api": null,
          "old_text": "av_malloc_array(avctx->channels, sizeof(*ctx->acf))",
          "new_text": null,
          "old_line_content": "        ctx->acf               = av_malloc_array(avctx->channels, sizeof(*ctx->acf));",
          "new_line_content": "    if (sconf->floating) {",
          "content_same": false
        },
        {
          "line": 1838,
          "old_api": "INTERLEAVE_OUTPUT",
          "new_api": null,
          "old_text": "INTERLEAVE_OUTPUT(32)",
          "new_text": null,
          "old_line_content": "        INTERLEAVE_OUTPUT(32)",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 2099,
          "old_api": "av_malloc_array",
          "new_api": null,
          "old_text": "av_malloc_array(ctx->cur_frame_length * 4, sizeof(*ctx->larray))",
          "new_text": null,
          "old_line_content": "        ctx->larray = av_malloc_array(ctx->cur_frame_length * 4, sizeof(*ctx->larray));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1971,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Missing required ALS extradata.\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Missing required ALS extradata.\\n\");",
          "new_line_content": "    if (!avctx->extradata) {",
          "content_same": false
        },
        {
          "line": 1975,
          "old_api": "read_specific_config",
          "new_api": null,
          "old_text": "read_specific_config(ctx)",
          "new_text": null,
          "old_line_content": "    if ((ret = read_specific_config(ctx)) < 0) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2105,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\")",
          "new_text": null,
          "old_line_content": "            av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\");",
          "new_line_content": "            || !ctx->last_acf_mantissa || !ctx->raw_mantissa) {",
          "content_same": false
        },
        {
          "line": 1980,
          "old_api": "check_specific_config",
          "new_api": null,
          "old_text": "check_specific_config(ctx)",
          "new_text": null,
          "old_line_content": "    if ((ret = check_specific_config(ctx)) < 0) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2110,
          "old_api": "ff_mlz_init_dict",
          "new_api": null,
          "old_text": "ff_mlz_init_dict(avctx, ctx->mlz)",
          "new_text": null,
          "old_line_content": "        ff_mlz_init_dict(avctx, ctx->mlz);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1854,
          "old_api": "av_bswap32",
          "new_api": null,
          "old_text": "av_bswap32(src[sample])",
          "new_text": null,
          "old_line_content": "                    v = av_bswap32(src[sample]);",
          "new_line_content": "                if (swap)",
          "content_same": false
        },
        {
          "line": 1985,
          "old_api": "ff_bgmc_init",
          "new_api": null,
          "old_text": "ff_bgmc_init(avctx, &ctx->bgmc_lut, &ctx->bgmc_lut_status)",
          "new_text": null,
          "old_line_content": "        ret = ff_bgmc_init(avctx, &ctx->bgmc_lut, &ctx->bgmc_lut_status);",
          "new_line_content": "    if (sconf->bgmc) {",
          "content_same": false
        },
        {
          "line": 2114,
          "old_api": "av_mallocz_array",
          "new_api": null,
          "old_text": "av_mallocz_array(ctx->cur_frame_length, sizeof(**ctx->raw_mantissa))",
          "new_text": null,
          "old_line_content": "            ctx->raw_mantissa[c] = av_mallocz_array(ctx->cur_frame_length, sizeof(**ctx->raw_mantissa));",
          "new_line_content": "        for (c = 0; c < avctx->channels; ++c) {",
          "content_same": false
        },
        {
          "line": 1860,
          "old_api": "av_crc",
          "new_api": null,
          "old_text": "av_crc(ctx->crc_table, ctx->crc, (uint8_t*)(&v), 3)",
          "new_text": null,
          "old_line_content": "                ctx->crc = av_crc(ctx->crc_table, ctx->crc, (uint8_t*)(&v), 3);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2120,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\");",
          "new_line_content": "    if (!ctx->prev_raw_samples || !ctx->raw_buffer|| !ctx->raw_samples) {",
          "content_same": false
        },
        {
          "line": 1997,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Bits per raw sample %d larger than 32.\\n\",\n                   avctx->bits_per_raw_sample)",
          "new_text": null,
          "old_line_content": "            av_log(avctx, AV_LOG_ERROR, \"Bits per raw sample %d larger than 32.\\n\",",
          "new_line_content": "        if (avctx->bits_per_raw_sample > 32) {",
          "content_same": false
        },
        {
          "line": 1872,
          "old_api": "av_bswap16",
          "new_api": null,
          "old_text": "av_bswap16(src[sample])",
          "new_text": null,
          "old_line_content": "                        *dest++ = av_bswap16(src[sample]);",
          "new_line_content": "                         sample++)",
          "content_same": false
        },
        {
          "line": 1874,
          "old_api": "bswap_buf",
          "new_api": null,
          "old_text": "ctx->bdsp.bswap_buf((uint32_t *) ctx->crc_buffer,\n                                        (uint32_t *) frame->data[0],\n                                        ctx->cur_frame_length * avctx->channels)",
          "new_text": null,
          "old_line_content": "                    ctx->bdsp.bswap_buf((uint32_t *) ctx->crc_buffer,",
          "new_line_content": "                } else {",
          "content_same": false
        },
        {
          "line": 2133,
          "old_api": "av_malloc_array",
          "new_api": null,
          "old_text": "av_malloc_array(ctx->cur_frame_length *\n                                          avctx->channels *\n                                          av_get_bytes_per_sample(avctx->sample_fmt),\n                                          sizeof(*ctx->crc_buffer))",
          "new_text": null,
          "old_line_content": "        ctx->crc_buffer = av_malloc_array(ctx->cur_frame_length *",
          "new_line_content": "        (avctx->err_recognition & (AV_EF_CRCCHECK|AV_EF_CAREFUL))) {",
          "content_same": false
        },
        {
          "line": 2135,
          "old_api": "av_get_bytes_per_sample",
          "new_api": null,
          "old_text": "av_get_bytes_per_sample(avctx->sample_fmt)",
          "new_text": null,
          "old_line_content": "                                          av_get_bytes_per_sample(avctx->sample_fmt),",
          "new_line_content": "                                          avctx->channels *",
          "content_same": false
        },
        {
          "line": 2138,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\")",
          "new_text": null,
          "old_line_content": "            av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\");",
          "new_line_content": "        if (!ctx->crc_buffer) {",
          "content_same": false
        },
        {
          "line": 1883,
          "old_api": "av_crc",
          "new_api": null,
          "old_text": "av_crc(ctx->crc_table, ctx->crc, crc_source,\n                              ctx->cur_frame_length * avctx->channels *\n                              av_get_bytes_per_sample(avctx->sample_fmt))",
          "new_text": null,
          "old_line_content": "            ctx->crc = av_crc(ctx->crc_table, ctx->crc, crc_source,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1885,
          "old_api": "av_get_bytes_per_sample",
          "new_api": null,
          "old_text": "av_get_bytes_per_sample(avctx->sample_fmt)",
          "new_text": null,
          "old_line_content": "                              av_get_bytes_per_sample(avctx->sample_fmt));",
          "new_line_content": "                              ctx->cur_frame_length * avctx->channels *",
          "content_same": false
        },
        {
          "line": 2144,
          "old_api": "ff_bswapdsp_init",
          "new_api": null,
          "old_text": "ff_bswapdsp_init(&ctx->bdsp)",
          "new_text": null,
          "old_line_content": "    ff_bswapdsp_init(&ctx->bdsp);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2018,
          "old_api": "av_malloc_array",
          "new_api": null,
          "old_text": "av_malloc_array(num_buffers, sizeof(*ctx->quant_cof))",
          "new_text": null,
          "old_line_content": "    ctx->quant_cof        = av_malloc_array(num_buffers, sizeof(*ctx->quant_cof));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1892,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"CRC error.\\n\")",
          "new_text": null,
          "old_line_content": "            av_log(avctx, AV_LOG_ERROR, \"CRC error.\\n\");",
          "new_line_content": "            ctx->crc_org != ctx->crc) {",
          "content_same": false
        },
        {
          "line": 2022,
          "old_api": "av_malloc_array",
          "new_api": null,
          "old_text": "av_malloc_array(num_buffers * sconf->max_order,\n                                            sizeof(*ctx->lpc_cof_buffer))",
          "new_text": null,
          "old_line_content": "    ctx->lpc_cof_buffer   = av_malloc_array(num_buffers * sconf->max_order,",
          "new_line_content": "                                            sizeof(*ctx->quant_cof_buffer));",
          "content_same": false
        },
        {
          "line": 2024,
          "old_api": "av_malloc_array",
          "new_api": null,
          "old_text": "av_malloc_array(sconf->max_order,\n                                                   sizeof(*ctx->lpc_cof_buffer))",
          "new_text": null,
          "old_line_content": "    ctx->lpc_cof_reversed_buffer = av_malloc_array(sconf->max_order,",
          "new_line_content": "                                            sizeof(*ctx->lpc_cof_buffer));",
          "content_same": false
        },
        {
          "line": 1901,
          "old_api": "get_bits_count",
          "new_api": null,
          "old_text": "get_bits_count(&ctx->gb)",
          "new_text": null,
          "old_line_content": "                                 (get_bits_count(&ctx->gb) + 7) >> 3;",
          "new_line_content": "    bytes_read = invalid_frame ? buffer_size :",
          "content_same": false
        },
        {
          "line": 2030,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Allocating buffer memory failed.\\n\");",
          "new_line_content": "        !ctx->lpc_cof_reversed_buffer) {",
          "content_same": false
        },
        {
          "line": 2165,
          "old_api": "NULL_IF_CONFIG_SMALL",
          "new_api": null,
          "old_text": "NULL_IF_CONFIG_SMALL(\"MPEG-4 Audio Lossless Coding (ALS)\")",
          "new_text": null,
          "old_line_content": "    .long_name      = NULL_IF_CONFIG_SMALL(\"MPEG-4 Audio Lossless Coding (ALS)\"),",
          "new_line_content": "    .name           = \"als\",",
          "content_same": false
        },
        {
          "line": 1914,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&ctx->sconf.chan_pos)",
          "new_text": null,
          "old_line_content": "    av_freep(&ctx->sconf.chan_pos);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1916,
          "old_api": "ff_bgmc_end",
          "new_api": null,
          "old_text": "ff_bgmc_end(&ctx->bgmc_lut, &ctx->bgmc_lut_status)",
          "new_text": null,
          "old_line_content": "    ff_bgmc_end(&ctx->bgmc_lut, &ctx->bgmc_lut_status);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1918,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&ctx->const_block)",
          "new_text": null,
          "old_line_content": "    av_freep(&ctx->const_block);",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 14,
      "total_additions": 45,
      "total_deletions": 45,
      "total_api_changes": 104
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 6,
        "api_related_lines": 104,
        "non_api_lines": 6,
        "non_api_line_numbers": [
          1827,
          1828,
          1831,
          1832,
          1822,
          1823
        ]
      }
    },
    "api_calls_before": 352,
    "api_calls_after": 352,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 3,
      "total_diff_lines": 26
    }
  }
}