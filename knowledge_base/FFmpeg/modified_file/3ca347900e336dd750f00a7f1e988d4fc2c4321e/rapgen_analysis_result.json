{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/3ca347900e336dd750f00a7f1e988d4fc2c4321e",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/3ca347900e336dd750f00a7f1e988d4fc2c4321e/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/3ca347900e336dd750f00a7f1e988d4fc2c4321e/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/3ca347900e336dd750f00a7f1e988d4fc2c4321e/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 707,
          "old_api": "av_frame_make_writable",
          "new_api": "AV_CEIL_RSHIFT",
          "old_text": "av_frame_make_writable(pict)",
          "new_text": "AV_CEIL_RSHIFT(pict->height, !!p)",
          "old_line_content": "            av_frame_make_writable(pict);",
          "new_line_content": "                int h = AV_CEIL_RSHIFT(pict->height, !!p);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 779,
          "old_api": null,
          "new_api": "NULL_IF_CONFIG_SMALL",
          "old_text": null,
          "new_text": "NULL_IF_CONFIG_SMALL(\"H.263 / H.263-1996, H.263+ / H.263-1998 / H.263 version 2\")",
          "old_line_content": "    .pix_fmts       = ff_h263_hwaccel_pixfmt_list_420,",
          "new_line_content": "    .long_name      = NULL_IF_CONFIG_SMALL(\"H.263 / H.263-1996, H.263+ / H.263-1998 / H.263 version 2\"),",
          "content_same": false
        },
        {
          "line": 757,
          "old_api": null,
          "new_api": "NULL_IF_CONFIG_SMALL",
          "old_text": null,
          "new_text": "NULL_IF_CONFIG_SMALL(\"H.263 / H.263-1996, H.263+ / H.263-1998 / H.263 version 2\")",
          "old_line_content": "#endif",
          "new_line_content": "    .long_name      = NULL_IF_CONFIG_SMALL(\"H.263 / H.263-1996, H.263+ / H.263-1998 / H.263 version 2\"),",
          "content_same": false
        },
        {
          "line": 750,
          "old_api": null,
          "new_api": "HWACCEL_VIDEOTOOLBOX",
          "old_text": null,
          "new_text": "HWACCEL_VIDEOTOOLBOX(h263)",
          "old_line_content": "    HWACCEL_NVDEC(mpeg4),",
          "new_line_content": "    HWACCEL_VIDEOTOOLBOX(h263),",
          "content_same": false
        },
        {
          "line": 719,
          "old_api": null,
          "new_api": "get_consumed_bytes",
          "old_text": null,
          "new_text": "get_consumed_bytes(s, buf_size)",
          "old_line_content": "        *got_frame = 1;",
          "new_line_content": "        return get_consumed_bytes(s, buf_size);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 709,
          "old_api": "AV_CEIL_RSHIFT",
          "new_api": null,
          "old_text": "AV_CEIL_RSHIFT(pict-> width, !!p)",
          "new_text": null,
          "old_line_content": "                int w = AV_CEIL_RSHIFT(pict-> width, !!p);",
          "new_line_content": "                pict->data[p]     += (h - 1) * pict->linesize[p];",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": "AV_CEIL_RSHIFT",
          "new_api": null,
          "old_text": "AV_CEIL_RSHIFT(pict->height, !!p)",
          "new_text": null,
          "old_line_content": "                int h = AV_CEIL_RSHIFT(pict->height, !!p);",
          "new_line_content": "                pict->linesize[p] *= -1;",
          "content_same": false
        },
        {
          "line": 714,
          "old_api": "FFSWAP",
          "new_api": null,
          "old_text": "FFSWAP(int,\n                               pict->data[p][x + y*linesize],\n                               pict->data[p][x + (h-1-y)*linesize])",
          "new_text": null,
          "old_line_content": "                        FFSWAP(int,",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 785,
          "old_api": "NULL_IF_CONFIG_SMALL",
          "new_api": null,
          "old_text": "NULL_IF_CONFIG_SMALL(\"H.263 / H.263-1996, H.263+ / H.263-1998 / H.263 version 2\")",
          "new_text": null,
          "old_line_content": "    .long_name      = NULL_IF_CONFIG_SMALL(\"H.263 / H.263-1996, H.263+ / H.263-1998 / H.263 version 2\"),",
          "new_line_content": "    .decode         = ff_h263_decode_frame,",
          "content_same": false
        },
        {
          "line": 756,
          "old_api": "HWACCEL_VIDEOTOOLBOX",
          "new_api": null,
          "old_text": "HWACCEL_VIDEOTOOLBOX(h263)",
          "new_text": null,
          "old_line_content": "    HWACCEL_VIDEOTOOLBOX(h263),",
          "new_line_content": "    .name           = \"h263\",",
          "content_same": false
        },
        {
          "line": 725,
          "old_api": "get_consumed_bytes",
          "new_api": null,
          "old_text": "get_consumed_bytes(s, buf_size)",
          "new_text": null,
          "old_line_content": "        return get_consumed_bytes(s, buf_size);",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 763,
          "old_api": "NULL_IF_CONFIG_SMALL",
          "new_api": null,
          "old_text": "NULL_IF_CONFIG_SMALL(\"H.263 / H.263-1996, H.263+ / H.263-1998 / H.263 version 2\")",
          "new_text": null,
          "old_line_content": "    .long_name      = NULL_IF_CONFIG_SMALL(\"H.263 / H.263-1996, H.263+ / H.263-1998 / H.263 version 2\"),",
          "new_line_content": "    .decode         = ff_h263_decode_frame,",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 1,
      "total_additions": 4,
      "total_deletions": 7,
      "total_api_changes": 12
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 11,
        "api_related_lines": 12,
        "non_api_lines": 7,
        "non_api_line_numbers": [
          706,
          708,
          711,
          712,
          713,
          715,
          716
        ]
      }
    },
    "api_calls_before": 135,
    "api_calls_after": 132,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 10,
      "total_diff_lines": 27
    }
  }
}