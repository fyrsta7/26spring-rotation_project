{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/8bf755d4ff26315f5af4faad3195b72ab8d386db",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/8bf755d4ff26315f5af4faad3195b72ab8d386db/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/8bf755d4ff26315f5af4faad3195b72ab8d386db/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/8bf755d4ff26315f5af4faad3195b72ab8d386db/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1685,
          "old_api": "CHECK_BIDIRR",
          "new_api": "CHECK_BIDIR2",
          "old_text": "CHECK_BIDIRR( 0, 1,-1, 1)",
          "new_text": "CHECK_BIDIR2( 0, 1, 0, 1)",
          "old_line_content": "                    CHECK_BIDIRR( 0, 1,-1, 1)",
          "new_line_content": "                CHECK_BIDIR2( 0, 1, 0, 1)",
          "content_same": false
        },
        {
          "line": 1686,
          "old_api": "CHECK_BIDIRR",
          "new_api": "CHECK_BIDIR2",
          "old_text": "CHECK_BIDIRR( 0, 1, 1,-1)",
          "new_text": "CHECK_BIDIR2( 1, 0, 1, 0)",
          "old_line_content": "                    CHECK_BIDIRR( 0, 1, 1,-1)",
          "new_line_content": "                CHECK_BIDIR2( 1, 0, 1, 0)",
          "content_same": false
        },
        {
          "line": 1689,
          "old_api": "CHECK_BIDIRR",
          "new_api": "CHECK_BIDIR2",
          "old_text": "CHECK_BIDIRR( 1, 1, 1,-1)",
          "new_text": "CHECK_BIDIR2(-1, 0, 1, 0)",
          "old_line_content": "                        CHECK_BIDIRR( 1, 1, 1,-1)",
          "new_line_content": "                CHECK_BIDIR2(-1, 0, 1, 0)",
          "content_same": false
        },
        {
          "line": 1691,
          "old_api": "CHECK_BIDIR2",
          "new_api": "CHECK_BIDIRR",
          "old_text": "CHECK_BIDIR2( 1,-1,-1, 1)",
          "new_text": "CHECK_BIDIRR( 0, 1, 1, 1)",
          "old_line_content": "                        CHECK_BIDIR2( 1,-1,-1, 1)",
          "new_line_content": "                    CHECK_BIDIRR( 0, 1, 1, 1)",
          "content_same": false
        },
        {
          "line": 1692,
          "old_api": "CHECK_BIDIR2",
          "new_api": "CHECK_BIDIRR",
          "old_text": "CHECK_BIDIR2( 1,-1, 1,-1)",
          "new_text": "CHECK_BIDIRR( 0,-1, 1, 1)",
          "old_line_content": "                        CHECK_BIDIR2( 1,-1, 1,-1)",
          "new_line_content": "                    CHECK_BIDIRR( 0,-1, 1, 1)",
          "content_same": false
        },
        {
          "line": 1753,
          "old_api": "assert",
          "new_api": "FFMIN",
          "old_text": "assert(xmax <= 15 && ymax <= 15 && xmin >= -16 && ymin >= -16)",
          "new_text": "FFMIN(xmax, s->width - max)",
          "old_line_content": "    assert(xmax <= 15 && ymax <= 15 && xmin >= -16 && ymin >= -16);",
          "new_line_content": "        xmax= FFMIN(xmax, s->width - max);",
          "content_same": false
        },
        {
          "line": 1785,
          "old_api": "ff_epzs_motion_search",
          "new_api": "clip",
          "old_text": "ff_epzs_motion_search(s, &mx, &my, P, 0, 0, mv_table, 1<<(16-shift), 0, 16)",
          "new_text": "clip(mv_table[mot_xy - 1][1], ymin<<shift, ymax<<shift)",
          "old_line_content": "    dmin = ff_epzs_motion_search(s, &mx, &my, P, 0, 0, mv_table, 1<<(16-shift), 0, 16);",
          "new_line_content": "    P_LEFT[1]        = clip(mv_table[mot_xy - 1][1], ymin<<shift, ymax<<shift);",
          "content_same": false
        },
        {
          "line": 1789,
          "old_api": "hpel_motion_search",
          "new_api": "clip",
          "old_text": "hpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16)",
          "new_text": "clip(mv_table[mot_xy - mot_stride             ][0], xmin<<shift, xmax<<shift)",
          "old_line_content": "        dmin = hpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16);",
          "new_line_content": "        P_TOP[0]      = clip(mv_table[mot_xy - mot_stride             ][0], xmin<<shift, xmax<<shift);",
          "content_same": false
        },
        {
          "line": 1792,
          "old_api": "ff_get_mb_score",
          "new_api": "clip",
          "old_text": "ff_get_mb_score(s, mx, my, 0, 0, 0, 16, 1)",
          "new_text": "clip(mv_table[mot_xy - mot_stride + 1         ][1], ymin<<shift, ymax<<shift)",
          "old_line_content": "        dmin= ff_get_mb_score(s, mx, my, 0, 0, 0, 16, 1);",
          "new_line_content": "        P_TOPRIGHT[1] = clip(mv_table[mot_xy - mot_stride + 1         ][1], ymin<<shift, ymax<<shift);",
          "content_same": false
        },
        {
          "line": 1794,
          "old_api": "get_limits",
          "new_api": "mid_pred",
          "old_text": "get_limits(s, 16*mb_x, 16*mb_y)",
          "new_text": "mid_pred(P_LEFT[0], P_TOP[0], P_TOPRIGHT[0])",
          "old_line_content": "    get_limits(s, 16*mb_x, 16*mb_y); //restore c->?min/max, maybe not needed",
          "new_line_content": "        P_MEDIAN[0]= mid_pred(P_LEFT[0], P_TOP[0], P_TOPRIGHT[0]);",
          "content_same": false
        },
        {
          "line": 1853,
          "old_api": "interlaced_search",
          "new_api": "direct_search",
          "old_text": "interlaced_search(s, 0,\n                                        s->b_field_mv_table[0], s->b_field_select_table[0],\n                                        s->b_forw_mv_table[xy][0], s->b_forw_mv_table[xy][1], 1)",
          "new_text": "direct_search(s, mb_x, mb_y)",
          "old_line_content": "                interlaced_search(s, 0,",
          "new_line_content": "                direct_search(s, mb_x, mb_y);",
          "content_same": false
        },
        {
          "line": 1972,
          "old_api": "FFMAX",
          "new_api": "FFMIN",
          "old_text": "FFMAX(fcode_tab[mx + MAX_MV],\n                                     fcode_tab[my + MAX_MV])",
          "new_text": "FFMIN(range, 16)",
          "old_line_content": "                    int fcode= FFMAX(fcode_tab[mx + MAX_MV],",
          "new_line_content": "            range= FFMIN(range, 16);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1795,
          "old_api": null,
          "new_api": "mid_pred",
          "old_text": null,
          "new_text": "mid_pred(P_LEFT[1], P_TOP[1], P_TOPRIGHT[1])",
          "old_line_content": "",
          "new_line_content": "        P_MEDIAN[1]= mid_pred(P_LEFT[1], P_TOP[1], P_TOPRIGHT[1]);",
          "content_same": false
        },
        {
          "line": 1798,
          "old_api": null,
          "new_api": "ff_epzs_motion_search",
          "old_text": null,
          "new_text": "ff_epzs_motion_search(s, &mx, &my, P, 0, 0, mv_table, 1<<(16-shift), 0, 16)",
          "old_line_content": "    c->flags     &= ~FLAG_DIRECT;",
          "new_line_content": "    dmin = ff_epzs_motion_search(s, &mx, &my, P, 0, 0, mv_table, 1<<(16-shift), 0, 16);",
          "content_same": false
        },
        {
          "line": 1800,
          "old_api": null,
          "new_api": "qpel_motion_search",
          "old_text": null,
          "new_text": "qpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16)",
          "old_line_content": "",
          "new_line_content": "        dmin = qpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16);",
          "content_same": false
        },
        {
          "line": 1802,
          "old_api": null,
          "new_api": "hpel_motion_search",
          "old_text": null,
          "new_text": "hpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16)",
          "old_line_content": "}",
          "new_line_content": "        dmin = hpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16);",
          "content_same": false
        },
        {
          "line": 1805,
          "old_api": null,
          "new_api": "ff_get_mb_score",
          "old_text": null,
          "new_text": "ff_get_mb_score(s, mx, my, 0, 0, 0, 16, 1)",
          "old_line_content": "                             int mb_x, int mb_y)",
          "new_line_content": "        dmin= ff_get_mb_score(s, mx, my, 0, 0, 0, 16, 1);",
          "content_same": false
        },
        {
          "line": 1807,
          "old_api": null,
          "new_api": "get_limits",
          "old_text": null,
          "new_text": "get_limits(s, 16*mb_x, 16*mb_y)",
          "old_line_content": "    MotionEstContext * const c= &s->me;",
          "new_line_content": "    get_limits(s, 16*mb_x, 16*mb_y); //restore c->?min/max, maybe not needed",
          "content_same": false
        },
        {
          "line": 1682,
          "old_api": null,
          "new_api": "CHECK_BIDIRR",
          "old_text": null,
          "new_text": "CHECK_BIDIRR( 0, 0, 0, 1)",
          "old_line_content": "                if(s->avctx->bidir_refine > 2){",
          "new_line_content": "            CHECK_BIDIRR( 0, 0, 0, 1)",
          "content_same": false
        },
        {
          "line": 1687,
          "old_api": null,
          "new_api": "CHECK_BIDIRR",
          "old_text": null,
          "new_text": "CHECK_BIDIRR( 0, 0,-1, 1)",
          "old_line_content": "                    if(s->avctx->bidir_refine > 3){",
          "new_line_content": "                CHECK_BIDIRR( 0, 0,-1, 1)",
          "content_same": false
        },
        {
          "line": 1693,
          "old_api": null,
          "new_api": "CHECK_BIDIRR",
          "old_text": null,
          "new_text": "CHECK_BIDIRR( 0, 1,-1, 1)",
          "old_line_content": "                    }",
          "new_line_content": "                    CHECK_BIDIRR( 0, 1,-1, 1)",
          "content_same": false
        },
        {
          "line": 1694,
          "old_api": null,
          "new_api": "CHECK_BIDIRR",
          "old_text": null,
          "new_text": "CHECK_BIDIRR( 0, 1, 1,-1)",
          "old_line_content": "                }",
          "new_line_content": "                    CHECK_BIDIRR( 0, 1, 1,-1)",
          "content_same": false
        },
        {
          "line": 1696,
          "old_api": null,
          "new_api": "CHECK_BIDIR2",
          "old_text": null,
          "new_text": "CHECK_BIDIR2( 1, 1, 1, 1)",
          "old_line_content": "        }while(!end);",
          "new_line_content": "                        CHECK_BIDIR2( 1, 1, 1, 1)",
          "content_same": false
        },
        {
          "line": 1825,
          "old_api": null,
          "new_api": "init_ref",
          "old_text": null,
          "new_text": "init_ref(c, s->new_picture.data, s->last_picture.data, s->next_picture.data, 16*mb_x, 16*mb_y, 2)",
          "old_line_content": "//            pic->mb_var   [s->mb_stride * mb_y + mb_x] = (varc+128)>>8;",
          "new_line_content": "    init_ref(c, s->new_picture.data, s->last_picture.data, s->next_picture.data, 16*mb_x, 16*mb_y, 2);",
          "content_same": false
        },
        {
          "line": 1697,
          "old_api": null,
          "new_api": "CHECK_BIDIRR",
          "old_text": null,
          "new_text": "CHECK_BIDIRR( 1, 1, 1,-1)",
          "old_line_content": "    }",
          "new_line_content": "                        CHECK_BIDIRR( 1, 1, 1,-1)",
          "content_same": false
        },
        {
          "line": 1699,
          "old_api": null,
          "new_api": "CHECK_BIDIR2",
          "old_text": null,
          "new_text": "CHECK_BIDIR2( 1,-1,-1, 1)",
          "old_line_content": "    return fbmin;",
          "new_line_content": "                        CHECK_BIDIR2( 1,-1,-1, 1)",
          "content_same": false
        },
        {
          "line": 1700,
          "old_api": null,
          "new_api": "CHECK_BIDIR2",
          "old_text": null,
          "new_text": "CHECK_BIDIR2( 1,-1, 1,-1)",
          "old_line_content": "}",
          "new_line_content": "                        CHECK_BIDIR2( 1,-1, 1,-1)",
          "content_same": false
        },
        {
          "line": 1827,
          "old_api": null,
          "new_api": "get_limits",
          "old_text": null,
          "new_text": "get_limits(s, 16*mb_x, 16*mb_y)",
          "old_line_content": "/*            pic->mb_mean  [s->mb_stride * mb_y + mb_x] = (sum+128)>>8;",
          "new_line_content": "    get_limits(s, 16*mb_x, 16*mb_y);",
          "content_same": false
        },
        {
          "line": 1698,
          "old_api": null,
          "new_api": "CHECK_BIDIR2",
          "old_text": null,
          "new_text": "CHECK_BIDIR2( 1, 1,-1,-1)",
          "old_line_content": "",
          "new_line_content": "                        CHECK_BIDIR2( 1, 1,-1,-1)",
          "content_same": false
        },
        {
          "line": 1831,
          "old_api": null,
          "new_api": "check_input_motion",
          "old_text": null,
          "new_text": "check_input_motion(s, mb_x, mb_y, 0)",
          "old_line_content": "                c->scene_change_score+= ff_sqrt(vard) - ff_sqrt(varc);",
          "new_line_content": "        int vard= check_input_motion(s, mb_x, mb_y, 0);",
          "content_same": false
        },
        {
          "line": 1974,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(range, 256)",
          "old_line_content": "                    int j;",
          "new_line_content": "            range= FFMIN(range, 256);",
          "content_same": false
        },
        {
          "line": 1857,
          "old_api": null,
          "new_api": "ff_estimate_motion_b",
          "old_text": null,
          "new_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code)",
          "old_line_content": "            if(type == CANDIDATE_MB_TYPE_BACKWARD_I || type == CANDIDATE_MB_TYPE_BIDIR_I){",
          "new_line_content": "                ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code);",
          "content_same": false
        },
        {
          "line": 1985,
          "old_api": null,
          "new_api": "FFMAX",
          "old_text": null,
          "new_text": "FFMAX(fcode_tab[mx + MAX_MV],\n                                     fcode_tab[my + MAX_MV])",
          "old_line_content": "                xy++;",
          "new_line_content": "                    int fcode= FFMAX(fcode_tab[mx + MAX_MV],",
          "content_same": false
        },
        {
          "line": 1732,
          "old_api": null,
          "new_api": "IS_8X8",
          "old_text": null,
          "new_text": "IS_8X8(s->next_picture.mb_type[mot_xy])",
          "old_line_content": "        c->direct_basis_mv[i][1]= c->co_located_mv[i][1]*time_pb/time_pp + ((i>>1)<<(shift+3));",
          "new_line_content": "    if(IS_8X8(s->next_picture.mb_type[mot_xy])){",
          "content_same": false
        },
        {
          "line": 1861,
          "old_api": null,
          "new_api": "ff_estimate_motion_b",
          "old_text": null,
          "new_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code)",
          "old_line_content": "                                        s->b_field_mv_table[1], s->b_field_select_table[1],",
          "new_line_content": "                ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code);",
          "content_same": false
        },
        {
          "line": 1866,
          "old_api": null,
          "new_api": "interlaced_search",
          "old_text": null,
          "new_text": "interlaced_search(s, 0,\n                                        s->b_field_mv_table[0], s->b_field_select_table[0],\n                                        s->b_forw_mv_table[xy][0], s->b_forw_mv_table[xy][1], 1)",
          "old_line_content": "    }",
          "new_line_content": "                interlaced_search(s, 0,",
          "content_same": false
        },
        {
          "line": 1873,
          "old_api": null,
          "new_api": "interlaced_search",
          "old_text": null,
          "new_text": "interlaced_search(s, 2,\n                                        s->b_field_mv_table[1], s->b_field_select_table[1],\n                                        s->b_back_mv_table[xy][0], s->b_back_mv_table[xy][1], 1)",
          "old_line_content": "    c->skip=0;",
          "new_line_content": "                interlaced_search(s, 2,",
          "content_same": false
        },
        {
          "line": 1749,
          "old_api": null,
          "new_api": "FFMAX",
          "old_text": null,
          "new_text": "FFMAX(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])",
          "old_line_content": "",
          "new_line_content": "        max= FFMAX(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])>>shift;",
          "content_same": false
        },
        {
          "line": 1750,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])",
          "old_line_content": "        if(s->mv_type == MV_TYPE_16X16) break;",
          "new_line_content": "        min= FFMIN(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])>>shift;",
          "content_same": false
        },
        {
          "line": 1754,
          "old_api": null,
          "new_api": "FFMAX",
          "old_text": null,
          "new_text": "FFMAX(xmin, - 16     - min)",
          "old_line_content": "",
          "new_line_content": "        xmin= FFMAX(xmin, - 16     - min);",
          "content_same": false
        },
        {
          "line": 1882,
          "old_api": null,
          "new_api": "direct_search",
          "old_text": null,
          "new_text": "direct_search(s, mb_x, mb_y)",
          "old_line_content": "//printf(\"%d %d %d %d\\n\", dmin, fmin, bmin, fbmin);",
          "new_line_content": "        dmin= direct_search(s, mb_x, mb_y);",
          "content_same": false
        },
        {
          "line": 1756,
          "old_api": null,
          "new_api": "FFMAX",
          "old_text": null,
          "new_text": "FFMAX(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])",
          "old_line_content": "        s->b_direct_mv_table[mot_xy][0]= 0;",
          "new_line_content": "        max= FFMAX(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])>>shift;",
          "content_same": false
        },
        {
          "line": 1757,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])",
          "old_line_content": "        s->b_direct_mv_table[mot_xy][1]= 0;",
          "new_line_content": "        min= FFMIN(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])>>shift;",
          "content_same": false
        },
        {
          "line": 1887,
          "old_api": null,
          "new_api": "ff_estimate_motion_b",
          "old_text": null,
          "new_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code)",
          "old_line_content": "        c->current_mv_penalty= c->mv_penalty[s->f_code] + MAX_MV;",
          "new_line_content": "    fmin= ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code) + 3*penalty_factor;",
          "content_same": false
        },
        {
          "line": 1760,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(ymax, s->height - max)",
          "old_line_content": "    }",
          "new_line_content": "        ymax= FFMIN(ymax, s->height - max);",
          "content_same": false
        },
        {
          "line": 1761,
          "old_api": null,
          "new_api": "FFMAX",
          "old_text": null,
          "new_text": "FFMAX(ymin, - 16      - min)",
          "old_line_content": "",
          "new_line_content": "        ymin= FFMAX(ymin, - 16      - min);",
          "content_same": false
        },
        {
          "line": 1890,
          "old_api": null,
          "new_api": "ff_estimate_motion_b",
          "old_text": null,
          "new_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code)",
          "old_line_content": "                                 s->b_forw_mv_table[xy][0], s->b_forw_mv_table[xy][1], 0);",
          "new_line_content": "    bmin= ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code) + 2*penalty_factor;",
          "content_same": false
        },
        {
          "line": 1766,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(xmax <= 15 && ymax <= 15 && xmin >= -16 && ymin >= -16)",
          "old_line_content": "    c->flags     |= FLAG_DIRECT;",
          "new_line_content": "    assert(xmax <= 15 && ymax <= 15 && xmin >= -16 && ymin >= -16);",
          "content_same": false
        },
        {
          "line": 1894,
          "old_api": null,
          "new_api": "bidir_refine",
          "old_text": null,
          "new_text": "bidir_refine(s, mb_x, mb_y)",
          "old_line_content": "                                 s->b_back_mv_table[xy][0], s->b_back_mv_table[xy][1], 0);",
          "new_line_content": "    fbmin= bidir_refine(s, mb_x, mb_y) + penalty_factor;",
          "content_same": false
        },
        {
          "line": 1641,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(map,0,sizeof(map))",
          "old_line_content": "                          motion_bx, motion_by,",
          "new_line_content": "    memset(map,0,sizeof(map));",
          "content_same": false
        },
        {
          "line": 2026,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(s->pict_type==P_TYPE)",
          "old_line_content": "        /* clip / convert to intra 8x8 type MVs */",
          "new_line_content": "    assert(s->pict_type==P_TYPE);",
          "content_same": false
        },
        {
          "line": 1644,
          "old_api": null,
          "new_api": "BIDIR_MAP",
          "old_text": null,
          "new_text": "BIDIR_MAP(0,0,0,0)",
          "old_line_content": "                          0, 16);",
          "new_line_content": "    BIDIR_MAP(0,0,0,0) = 1;",
          "content_same": false
        },
        {
          "line": 1901,
          "old_api": null,
          "new_api": "interlaced_search",
          "old_text": null,
          "new_text": "interlaced_search(s, 0,\n                                 s->b_field_mv_table[0], s->b_field_select_table[0],\n                                 s->b_forw_mv_table[xy][0], s->b_forw_mv_table[xy][1], 0)",
          "old_line_content": "",
          "new_line_content": "        fimin= interlaced_search(s, 0,",
          "content_same": false
        },
        {
          "line": 1646,
          "old_api": null,
          "new_api": "check_bidir_mv",
          "old_text": null,
          "new_text": "check_bidir_mv(s, motion_fx, motion_fy,\n                          motion_bx, motion_by,\n                          pred_fx, pred_fy,\n                          pred_bx, pred_by,\n                          0, 16)",
          "old_line_content": "    if(s->avctx->bidir_refine){",
          "new_line_content": "    fbmin= check_bidir_mv(s, motion_fx, motion_fy,",
          "content_same": false
        },
        {
          "line": 2030,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(range <= 16 || !s->msmpeg4_version)",
          "old_line_content": "            int x;",
          "new_line_content": "    assert(range <= 16 || !s->msmpeg4_version);",
          "content_same": false
        },
        {
          "line": 2031,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(range <=256 || !(s->codec_id == CODEC_ID_MPEG2VIDEO && s->avctx->strict_std_compliance >= FF_COMPLIANCE_NORMAL))",
          "old_line_content": "",
          "new_line_content": "    assert(range <=256 || !(s->codec_id == CODEC_ID_MPEG2VIDEO && s->avctx->strict_std_compliance >= FF_COMPLIANCE_NORMAL));",
          "content_same": false
        },
        {
          "line": 1905,
          "old_api": null,
          "new_api": "interlaced_search",
          "old_text": null,
          "new_text": "interlaced_search(s, 2,\n                                 s->b_field_mv_table[1], s->b_field_select_table[1],\n                                 s->b_back_mv_table[xy][0], s->b_back_mv_table[xy][1], 0)",
          "old_line_content": "        }",
          "new_line_content": "        bimin= interlaced_search(s, 2,",
          "content_same": false
        },
        {
          "line": 1784,
          "old_api": null,
          "new_api": "clip",
          "old_text": null,
          "new_text": "clip(mv_table[mot_xy - 1][0], xmin<<shift, xmax<<shift)",
          "old_line_content": "",
          "new_line_content": "    P_LEFT[0]        = clip(mv_table[mot_xy - 1][0], xmin<<shift, xmax<<shift);",
          "content_same": false
        },
        {
          "line": 1790,
          "old_api": null,
          "new_api": "clip",
          "old_text": null,
          "new_text": "clip(mv_table[mot_xy - mot_stride             ][1], ymin<<shift, ymax<<shift)",
          "old_line_content": "",
          "new_line_content": "        P_TOP[1]      = clip(mv_table[mot_xy - mot_stride             ][1], ymin<<shift, ymax<<shift);",
          "content_same": false
        },
        {
          "line": 1791,
          "old_api": null,
          "new_api": "clip",
          "old_text": null,
          "new_text": "clip(mv_table[mot_xy - mot_stride + 1         ][0], xmin<<shift, xmax<<shift)",
          "old_line_content": "    if(c->avctx->me_sub_cmp != c->avctx->mb_cmp && !c->skip)",
          "new_line_content": "        P_TOPRIGHT[0] = clip(mv_table[mot_xy - mot_stride + 1         ][0], xmin<<shift, xmax<<shift);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1674,
          "old_api": "CHECK_BIDIRR",
          "new_api": null,
          "old_text": "CHECK_BIDIRR( 0, 0, 0, 1)",
          "new_text": null,
          "old_line_content": "            CHECK_BIDIRR( 0, 0, 0, 1)",
          "new_line_content": "CHECK_BIDIR2(a,b,c,d)\\",
          "content_same": false
        },
        {
          "line": 1676,
          "old_api": "CHECK_BIDIRR",
          "new_api": null,
          "old_text": "CHECK_BIDIRR( 0, 0, 1, 1)",
          "new_text": null,
          "old_line_content": "                CHECK_BIDIRR( 0, 0, 1, 1)",
          "new_line_content": "CHECK_BIDIR2(c,d,a,b)\\",
          "content_same": false
        },
        {
          "line": 1677,
          "old_api": "CHECK_BIDIR2",
          "new_api": null,
          "old_text": "CHECK_BIDIR2( 0, 1, 0, 1)",
          "new_text": null,
          "old_line_content": "                CHECK_BIDIR2( 0, 1, 0, 1)",
          "new_line_content": "CHECK_BIDIR2(d,a,b,c)",
          "content_same": false
        },
        {
          "line": 1678,
          "old_api": "CHECK_BIDIR2",
          "new_api": null,
          "old_text": "CHECK_BIDIR2( 1, 0, 1, 0)",
          "new_text": null,
          "old_line_content": "                CHECK_BIDIR2( 1, 0, 1, 0)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1679,
          "old_api": "CHECK_BIDIRR",
          "new_api": null,
          "old_text": "CHECK_BIDIRR( 0, 0,-1, 1)",
          "new_text": null,
          "old_line_content": "                CHECK_BIDIRR( 0, 0,-1, 1)",
          "new_line_content": "        do{",
          "content_same": false
        },
        {
          "line": 1680,
          "old_api": "CHECK_BIDIR2",
          "new_api": null,
          "old_text": "CHECK_BIDIR2( 0,-1, 0, 1)",
          "new_text": null,
          "old_line_content": "                CHECK_BIDIR2( 0,-1, 0, 1)",
          "new_line_content": "            end=1;",
          "content_same": false
        },
        {
          "line": 1681,
          "old_api": "CHECK_BIDIR2",
          "new_api": null,
          "old_text": "CHECK_BIDIR2(-1, 0, 1, 0)",
          "new_text": null,
          "old_line_content": "                CHECK_BIDIR2(-1, 0, 1, 0)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1683,
          "old_api": "CHECK_BIDIRR",
          "new_api": null,
          "old_text": "CHECK_BIDIRR( 0, 1, 1, 1)",
          "new_text": null,
          "old_line_content": "                    CHECK_BIDIRR( 0, 1, 1, 1)",
          "new_line_content": "            if(s->avctx->bidir_refine > 1){",
          "content_same": false
        },
        {
          "line": 1812,
          "old_api": "init_ref",
          "new_api": null,
          "old_text": "init_ref(c, s->new_picture.data, s->last_picture.data, s->next_picture.data, 16*mb_x, 16*mb_y, 2)",
          "new_text": null,
          "old_line_content": "    init_ref(c, s->new_picture.data, s->last_picture.data, s->next_picture.data, 16*mb_x, 16*mb_y, 2);",
          "new_line_content": "    c->sub_flags &= ~FLAG_DIRECT;",
          "content_same": false
        },
        {
          "line": 1814,
          "old_api": "get_limits",
          "new_api": null,
          "old_text": "get_limits(s, 16*mb_x, 16*mb_y)",
          "new_text": null,
          "old_line_content": "    get_limits(s, 16*mb_x, 16*mb_y);",
          "new_line_content": "    return dmin;",
          "content_same": false
        },
        {
          "line": 1818,
          "old_api": "check_input_motion",
          "new_api": null,
          "old_text": "check_input_motion(s, mb_x, mb_y, 0)",
          "new_text": null,
          "old_line_content": "        int vard= check_input_motion(s, mb_x, mb_y, 0);",
          "new_line_content": "                             int mb_x, int mb_y)",
          "content_same": false
        },
        {
          "line": 1690,
          "old_api": "CHECK_BIDIR2",
          "new_api": null,
          "old_text": "CHECK_BIDIR2( 1, 1,-1,-1)",
          "new_text": null,
          "old_line_content": "                        CHECK_BIDIR2( 1, 1,-1,-1)",
          "new_line_content": "                if(s->avctx->bidir_refine > 2){",
          "content_same": false
        },
        {
          "line": 1959,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(range, 16)",
          "new_text": null,
          "old_line_content": "            range= FFMIN(range, 16);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1961,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(range, 256)",
          "new_text": null,
          "old_line_content": "            range= FFMIN(range, 256);",
          "new_line_content": "/* find best f_code for ME which do unlimited searches */",
          "content_same": false
        },
        {
          "line": 1840,
          "old_api": "direct_search",
          "new_api": null,
          "old_text": "direct_search(s, mb_x, mb_y)",
          "new_text": null,
          "old_line_content": "                direct_search(s, mb_x, mb_y);",
          "new_line_content": "/*            pic->mb_mean  [s->mb_stride * mb_y + mb_x] = (sum+128)>>8;",
          "content_same": false
        },
        {
          "line": 1844,
          "old_api": "ff_estimate_motion_b",
          "new_api": null,
          "old_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code)",
          "new_text": null,
          "old_line_content": "                ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code);",
          "new_line_content": "                c->scene_change_score+= ff_sqrt(vard) - ff_sqrt(varc);",
          "content_same": false
        },
        {
          "line": 1719,
          "old_api": "IS_8X8",
          "new_api": null,
          "old_text": "IS_8X8(s->next_picture.mb_type[mot_xy])",
          "new_text": null,
          "old_line_content": "    if(IS_8X8(s->next_picture.mb_type[mot_xy])){",
          "new_line_content": "    const int mot_stride = s->mb_stride;",
          "content_same": false
        },
        {
          "line": 1848,
          "old_api": "ff_estimate_motion_b",
          "new_api": null,
          "old_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code)",
          "new_text": null,
          "old_line_content": "                ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code);",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 1860,
          "old_api": "interlaced_search",
          "new_api": null,
          "old_text": "interlaced_search(s, 2,\n                                        s->b_field_mv_table[1], s->b_field_select_table[1],\n                                        s->b_back_mv_table[xy][0], s->b_back_mv_table[xy][1], 1)",
          "new_text": null,
          "old_line_content": "                interlaced_search(s, 2,",
          "new_line_content": "                c->skip=0;",
          "content_same": false
        },
        {
          "line": 1736,
          "old_api": "FFMAX",
          "new_api": null,
          "old_text": "FFMAX(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])",
          "new_text": null,
          "old_line_content": "        max= FFMAX(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])>>shift;",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1737,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])",
          "new_text": null,
          "old_line_content": "        min= FFMIN(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])>>shift;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1740,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(xmax, s->width - max)",
          "new_text": null,
          "old_line_content": "        xmax= FFMIN(xmax, s->width - max);",
          "new_line_content": "        int min, max;",
          "content_same": false
        },
        {
          "line": 1741,
          "old_api": "FFMAX",
          "new_api": null,
          "old_text": "FFMAX(xmin, - 16     - min)",
          "new_text": null,
          "old_line_content": "        xmin= FFMAX(xmin, - 16     - min);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1869,
          "old_api": "direct_search",
          "new_api": null,
          "old_text": "direct_search(s, mb_x, mb_y)",
          "new_text": null,
          "old_line_content": "        dmin= direct_search(s, mb_x, mb_y);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1743,
          "old_api": "FFMAX",
          "new_api": null,
          "old_text": "FFMAX(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])",
          "new_text": null,
          "old_line_content": "        max= FFMAX(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])>>shift;",
          "new_line_content": "        c->co_located_mv[i][1]= s->next_picture.motion_val[0][index][1];",
          "content_same": false
        },
        {
          "line": 1744,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])",
          "new_text": null,
          "old_line_content": "        min= FFMIN(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])>>shift;",
          "new_line_content": "        c->direct_basis_mv[i][0]= c->co_located_mv[i][0]*time_pb/time_pp + ((i& 1)<<(shift+3));",
          "content_same": false
        },
        {
          "line": 1874,
          "old_api": "ff_estimate_motion_b",
          "new_api": null,
          "old_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code)",
          "new_text": null,
          "old_line_content": "    fmin= ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code) + 3*penalty_factor;",
          "new_line_content": "                                        s->b_field_mv_table[1], s->b_field_select_table[1],",
          "content_same": false
        },
        {
          "line": 1747,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(ymax, s->height - max)",
          "new_text": null,
          "old_line_content": "        ymax= FFMIN(ymax, s->height - max);",
          "new_line_content": "//        c->direct_basis_mv[1][i][1]= c->co_located_mv[i][1]*(time_pb - time_pp)/time_pp + ((i>>1)<<(shift+3);",
          "content_same": false
        },
        {
          "line": 1748,
          "old_api": "FFMAX",
          "new_api": null,
          "old_text": "FFMAX(ymin, - 16      - min)",
          "new_text": null,
          "old_line_content": "        ymin= FFMAX(ymin, - 16      - min);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1877,
          "old_api": "ff_estimate_motion_b",
          "new_api": null,
          "old_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code)",
          "new_text": null,
          "old_line_content": "    bmin= ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code) + 2*penalty_factor;",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 1881,
          "old_api": "bidir_refine",
          "new_api": null,
          "old_text": "bidir_refine(s, mb_x, mb_y)",
          "new_text": null,
          "old_line_content": "    fbmin= bidir_refine(s, mb_x, mb_y) + penalty_factor;",
          "new_line_content": "    if (s->codec_id == CODEC_ID_MPEG4)",
          "content_same": false
        },
        {
          "line": 2013,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(s->pict_type==P_TYPE)",
          "new_text": null,
          "old_line_content": "    assert(s->pict_type==P_TYPE);",
          "new_line_content": "            printf(\"%d \", mv_num[i]);",
          "content_same": false
        },
        {
          "line": 1888,
          "old_api": "interlaced_search",
          "new_api": null,
          "old_text": "interlaced_search(s, 0,\n                                 s->b_field_mv_table[0], s->b_field_select_table[0],\n                                 s->b_forw_mv_table[xy][0], s->b_forw_mv_table[xy][1], 0)",
          "new_text": null,
          "old_line_content": "        fimin= interlaced_search(s, 0,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2017,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(range <= 16 || !s->msmpeg4_version)",
          "new_text": null,
          "old_line_content": "    assert(range <= 16 || !s->msmpeg4_version);",
          "new_line_content": "        return 1;",
          "content_same": false
        },
        {
          "line": 2018,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(range <=256 || !(s->codec_id == CODEC_ID_MPEG2VIDEO && s->avctx->strict_std_compliance >= FF_COMPLIANCE_NORMAL))",
          "new_text": null,
          "old_line_content": "    assert(range <=256 || !(s->codec_id == CODEC_ID_MPEG2VIDEO && s->avctx->strict_std_compliance >= FF_COMPLIANCE_NORMAL));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1892,
          "old_api": "interlaced_search",
          "new_api": null,
          "old_text": "interlaced_search(s, 2,\n                                 s->b_field_mv_table[1], s->b_field_select_table[1],\n                                 s->b_back_mv_table[xy][0], s->b_back_mv_table[xy][1], 0)",
          "new_text": null,
          "old_line_content": "        bimin= interlaced_search(s, 2,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1640,
          "old_api": "check_bidir_mv",
          "new_api": null,
          "old_text": "check_bidir_mv(s, motion_fx, motion_fy,\n                          motion_bx, motion_by,\n                          pred_fx, pred_fy,\n                          pred_bx, pred_by,\n                          0, 16)",
          "new_text": null,
          "old_line_content": "    fbmin= check_bidir_mv(s, motion_fx, motion_fy,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1771,
          "old_api": "clip",
          "new_api": null,
          "old_text": "clip(mv_table[mot_xy - 1][0], xmin<<shift, xmax<<shift)",
          "new_text": null,
          "old_line_content": "    P_LEFT[0]        = clip(mv_table[mot_xy - 1][0], xmin<<shift, xmax<<shift);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1772,
          "old_api": "clip",
          "new_api": null,
          "old_text": "clip(mv_table[mot_xy - 1][1], ymin<<shift, ymax<<shift)",
          "new_text": null,
          "old_line_content": "    P_LEFT[1]        = clip(mv_table[mot_xy - 1][1], ymin<<shift, ymax<<shift);",
          "new_line_content": "        return 256*256*256*64;",
          "content_same": false
        },
        {
          "line": 1776,
          "old_api": "clip",
          "new_api": null,
          "old_text": "clip(mv_table[mot_xy - mot_stride             ][0], xmin<<shift, xmax<<shift)",
          "new_text": null,
          "old_line_content": "        P_TOP[0]      = clip(mv_table[mot_xy - mot_stride             ][0], xmin<<shift, xmax<<shift);",
          "new_line_content": "    c->ymin= ymin;",
          "content_same": false
        },
        {
          "line": 1777,
          "old_api": "clip",
          "new_api": null,
          "old_text": "clip(mv_table[mot_xy - mot_stride             ][1], ymin<<shift, ymax<<shift)",
          "new_text": null,
          "old_line_content": "        P_TOP[1]      = clip(mv_table[mot_xy - mot_stride             ][1], ymin<<shift, ymax<<shift);",
          "new_line_content": "    c->xmax= xmax;",
          "content_same": false
        },
        {
          "line": 1778,
          "old_api": "clip",
          "new_api": null,
          "old_text": "clip(mv_table[mot_xy - mot_stride + 1         ][0], xmin<<shift, xmax<<shift)",
          "new_text": null,
          "old_line_content": "        P_TOPRIGHT[0] = clip(mv_table[mot_xy - mot_stride + 1         ][0], xmin<<shift, xmax<<shift);",
          "new_line_content": "    c->ymax= ymax;",
          "content_same": false
        },
        {
          "line": 1779,
          "old_api": "clip",
          "new_api": null,
          "old_text": "clip(mv_table[mot_xy - mot_stride + 1         ][1], ymin<<shift, ymax<<shift)",
          "new_text": null,
          "old_line_content": "        P_TOPRIGHT[1] = clip(mv_table[mot_xy - mot_stride + 1         ][1], ymin<<shift, ymax<<shift);",
          "new_line_content": "    c->flags     |= FLAG_DIRECT;",
          "content_same": false
        },
        {
          "line": 1781,
          "old_api": "mid_pred",
          "new_api": null,
          "old_text": "mid_pred(P_LEFT[0], P_TOP[0], P_TOPRIGHT[0])",
          "new_text": null,
          "old_line_content": "        P_MEDIAN[0]= mid_pred(P_LEFT[0], P_TOP[0], P_TOPRIGHT[0]);",
          "new_line_content": "    c->pred_x=0;",
          "content_same": false
        },
        {
          "line": 1782,
          "old_api": "mid_pred",
          "new_api": null,
          "old_text": "mid_pred(P_LEFT[1], P_TOP[1], P_TOPRIGHT[1])",
          "new_text": null,
          "old_line_content": "        P_MEDIAN[1]= mid_pred(P_LEFT[1], P_TOP[1], P_TOPRIGHT[1]);",
          "new_line_content": "    c->pred_y=0;",
          "content_same": false
        },
        {
          "line": 1787,
          "old_api": "qpel_motion_search",
          "new_api": null,
          "old_text": "qpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16)",
          "new_text": null,
          "old_line_content": "        dmin = qpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16);",
          "new_line_content": "    /* special case for first line */",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 12,
      "total_additions": 48,
      "total_deletions": 46,
      "total_api_changes": 106
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 15,
        "api_related_lines": 106,
        "non_api_lines": 12,
        "non_api_line_numbers": [
          1639,
          1642,
          1643,
          1708,
          1707,
          1709,
          1710,
          1711,
          1649,
          1655,
          1656,
          1658
        ]
      }
    },
    "api_calls_before": 278,
    "api_calls_after": 280,
    "diff_info": {
      "added_lines": 14,
      "removed_lines": 1,
      "total_diff_lines": 42
    }
  }
}