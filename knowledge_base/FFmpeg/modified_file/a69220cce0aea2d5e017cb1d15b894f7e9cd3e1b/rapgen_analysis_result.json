{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/a69220cce0aea2d5e017cb1d15b894f7e9cd3e1b",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/a69220cce0aea2d5e017cb1d15b894f7e9cd3e1b/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/a69220cce0aea2d5e017cb1d15b894f7e9cd3e1b/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/a69220cce0aea2d5e017cb1d15b894f7e9cd3e1b/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1524,
          "old_api": "CHECK_BIDIR2",
          "new_api": "CHECK_BIDIRR",
          "old_text": "CHECK_BIDIR2( 0, 1, 0, 1)",
          "new_text": "CHECK_BIDIRR( 0, 0, 1, 1)",
          "old_line_content": "                CHECK_BIDIR2( 0, 1, 0, 1)",
          "new_line_content": "                CHECK_BIDIRR( 0, 0, 1, 1)",
          "content_same": false
        },
        {
          "line": 1526,
          "old_api": "CHECK_BIDIRR",
          "new_api": "CHECK_BIDIR2",
          "old_text": "CHECK_BIDIRR( 0, 0,-1, 1)",
          "new_text": "CHECK_BIDIR2( 1, 0, 1, 0)",
          "old_line_content": "                CHECK_BIDIRR( 0, 0,-1, 1)",
          "new_line_content": "                CHECK_BIDIR2( 1, 0, 1, 0)",
          "content_same": false
        },
        {
          "line": 1527,
          "old_api": "CHECK_BIDIR2",
          "new_api": "CHECK_BIDIRR",
          "old_text": "CHECK_BIDIR2( 0,-1, 0, 1)",
          "new_text": "CHECK_BIDIRR( 0, 0,-1, 1)",
          "old_line_content": "                CHECK_BIDIR2( 0,-1, 0, 1)",
          "new_line_content": "                CHECK_BIDIRR( 0, 0,-1, 1)",
          "content_same": false
        },
        {
          "line": 1536,
          "old_api": "CHECK_BIDIRR",
          "new_api": "CHECK_BIDIR2",
          "old_text": "CHECK_BIDIRR( 1, 1, 1,-1)",
          "new_text": "CHECK_BIDIR2( 1, 1, 1, 1)",
          "old_line_content": "                        CHECK_BIDIRR( 1, 1, 1,-1)",
          "new_line_content": "                        CHECK_BIDIR2( 1, 1, 1, 1)",
          "content_same": false
        },
        {
          "line": 1537,
          "old_api": "CHECK_BIDIR2",
          "new_api": "CHECK_BIDIRR",
          "old_text": "CHECK_BIDIR2( 1, 1,-1,-1)",
          "new_text": "CHECK_BIDIRR( 1, 1, 1,-1)",
          "old_line_content": "                        CHECK_BIDIR2( 1, 1,-1,-1)",
          "new_line_content": "                        CHECK_BIDIRR( 1, 1, 1,-1)",
          "content_same": false
        },
        {
          "line": 1589,
          "old_api": "FFMIN",
          "new_api": "FFMAX",
          "old_text": "FFMIN(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])",
          "new_text": "FFMAX(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])",
          "old_line_content": "        min= FFMIN(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])>>shift;",
          "new_line_content": "        max= FFMAX(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])>>shift;",
          "content_same": false
        },
        {
          "line": 1593,
          "old_api": "FFMAX",
          "new_api": "FFMIN",
          "old_text": "FFMAX(xmin, - 16     - min)",
          "new_text": "FFMIN(xmax, s->width - max)",
          "old_line_content": "        xmin= FFMAX(xmin, - 16     - min);",
          "new_line_content": "        xmax= FFMIN(xmax, s->width - max);",
          "content_same": false
        },
        {
          "line": 1596,
          "old_api": "FFMIN",
          "new_api": "FFMAX",
          "old_text": "FFMIN(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])",
          "new_text": "FFMAX(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])",
          "old_line_content": "        min= FFMIN(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])>>shift;",
          "new_line_content": "        max= FFMAX(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])>>shift;",
          "content_same": false
        },
        {
          "line": 1600,
          "old_api": "FFMAX",
          "new_api": "FFMIN",
          "old_text": "FFMAX(ymin, - 16      - min)",
          "new_text": "FFMIN(ymax, s->height - max)",
          "old_line_content": "        ymin= FFMAX(ymin, - 16      - min);",
          "new_line_content": "        ymax= FFMIN(ymax, s->height - max);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1665,
          "old_api": null,
          "new_api": "init_ref",
          "old_text": null,
          "new_text": "init_ref(c, s->new_picture.data, s->last_picture.data, s->next_picture.data, 16*mb_x, 16*mb_y, 2)",
          "old_line_content": "",
          "new_line_content": "    init_ref(c, s->new_picture.data, s->last_picture.data, s->next_picture.data, 16*mb_x, 16*mb_y, 2);",
          "content_same": false
        },
        {
          "line": 1667,
          "old_api": null,
          "new_api": "get_limits",
          "old_text": null,
          "new_text": "get_limits(s, 16*mb_x, 16*mb_y)",
          "old_line_content": "",
          "new_line_content": "    get_limits(s, 16*mb_x, 16*mb_y);",
          "content_same": false
        },
        {
          "line": 1540,
          "old_api": null,
          "new_api": "CHECK_BIDIR2",
          "old_text": null,
          "new_text": "CHECK_BIDIR2( 1,-1, 1,-1)",
          "old_line_content": "                    }",
          "new_line_content": "                        CHECK_BIDIR2( 1,-1, 1,-1)",
          "content_same": false
        },
        {
          "line": 1672,
          "old_api": null,
          "new_api": "direct_search",
          "old_text": null,
          "new_text": "direct_search(s, mb_x, mb_y)",
          "old_line_content": "",
          "new_line_content": "        int score= direct_search(s, mb_x, mb_y); //FIXME just check 0,0",
          "content_same": false
        },
        {
          "line": 1683,
          "old_api": null,
          "new_api": "check_input_motion",
          "old_text": null,
          "new_text": "check_input_motion(s, mb_x, mb_y, 0)",
          "old_line_content": "",
          "new_line_content": "        int vard= check_input_motion(s, mb_x, mb_y, 0);",
          "content_same": false
        },
        {
          "line": 1826,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(range, 16)",
          "old_line_content": "        else if(s->codec_id == CODEC_ID_MPEG2VIDEO && s->avctx->strict_std_compliance >= FF_COMPLIANCE_NORMAL)",
          "new_line_content": "            range= FFMIN(range, 16);",
          "content_same": false
        },
        {
          "line": 1572,
          "old_api": null,
          "new_api": "IS_8X8",
          "old_text": null,
          "new_text": "IS_8X8(s->next_picture.mb_type[mot_xy])",
          "old_line_content": "        s->mv_type= MV_TYPE_8X8;",
          "new_line_content": "    if(IS_8X8(s->next_picture.mb_type[mot_xy])){",
          "content_same": false
        },
        {
          "line": 1828,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(range, 256)",
          "old_line_content": "",
          "new_line_content": "            range= FFMIN(range, 256);",
          "content_same": false
        },
        {
          "line": 1705,
          "old_api": null,
          "new_api": "direct_search",
          "old_text": null,
          "new_text": "direct_search(s, mb_x, mb_y)",
          "old_line_content": "            }",
          "new_line_content": "                direct_search(s, mb_x, mb_y);",
          "content_same": false
        },
        {
          "line": 1709,
          "old_api": null,
          "new_api": "ff_estimate_motion_b",
          "old_text": null,
          "new_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code)",
          "old_line_content": "            }",
          "new_line_content": "                ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code);",
          "content_same": false
        },
        {
          "line": 1839,
          "old_api": null,
          "new_api": "FFMAX",
          "old_text": null,
          "new_text": "FFMAX(fcode_tab[mx + MAX_MV],\n                                     fcode_tab[my + MAX_MV])",
          "old_line_content": "                                     fcode_tab[my + MAX_MV]);",
          "new_line_content": "                    int fcode= FFMAX(fcode_tab[mx + MAX_MV],",
          "content_same": false
        },
        {
          "line": 1713,
          "old_api": null,
          "new_api": "ff_estimate_motion_b",
          "old_text": null,
          "new_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code)",
          "old_line_content": "            }",
          "new_line_content": "                ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code);",
          "content_same": false
        },
        {
          "line": 1590,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])",
          "old_line_content": "        max+= 16*mb_x + 1; // +-1 is for the simpler rounding",
          "new_line_content": "        min= FFMIN(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])>>shift;",
          "content_same": false
        },
        {
          "line": 1718,
          "old_api": null,
          "new_api": "interlaced_search",
          "old_text": null,
          "new_text": "interlaced_search(s, 0,\n                                        s->b_field_mv_table[0], s->b_field_select_table[0],\n                                        s->b_forw_mv_table[xy][0], s->b_forw_mv_table[xy][1], 1)",
          "old_line_content": "                                        s->b_field_mv_table[0], s->b_field_select_table[0],",
          "new_line_content": "                interlaced_search(s, 0,",
          "content_same": false
        },
        {
          "line": 1594,
          "old_api": null,
          "new_api": "FFMAX",
          "old_text": null,
          "new_text": "FFMAX(xmin, - 16     - min)",
          "old_line_content": "",
          "new_line_content": "        xmin= FFMAX(xmin, - 16     - min);",
          "content_same": false
        },
        {
          "line": 1597,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])",
          "old_line_content": "        max+= 16*mb_y + 1; // +-1 is for the simpler rounding",
          "new_line_content": "        min= FFMIN(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])>>shift;",
          "content_same": false
        },
        {
          "line": 1725,
          "old_api": null,
          "new_api": "interlaced_search",
          "old_text": null,
          "new_text": "interlaced_search(s, 2,\n                                        s->b_field_mv_table[1], s->b_field_select_table[1],\n                                        s->b_back_mv_table[xy][0], s->b_back_mv_table[xy][1], 1)",
          "old_line_content": "                                        s->b_field_mv_table[1], s->b_field_select_table[1],",
          "new_line_content": "                interlaced_search(s, 2,",
          "content_same": false
        },
        {
          "line": 1601,
          "old_api": null,
          "new_api": "FFMAX",
          "old_text": null,
          "new_text": "FFMAX(ymin, - 16      - min)",
          "old_line_content": "",
          "new_line_content": "        ymin= FFMAX(ymin, - 16      - min);",
          "content_same": false
        },
        {
          "line": 1606,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(xmax <= 15 && ymax <= 15 && xmin >= -16 && ymin >= -16)",
          "old_line_content": "",
          "new_line_content": "    assert(xmax <= 15 && ymax <= 15 && xmin >= -16 && ymin >= -16);",
          "content_same": false
        },
        {
          "line": 1734,
          "old_api": null,
          "new_api": "direct_search",
          "old_text": null,
          "new_text": "direct_search(s, mb_x, mb_y)",
          "old_line_content": "    else",
          "new_line_content": "        dmin= direct_search(s, mb_x, mb_y);",
          "content_same": false
        },
        {
          "line": 1479,
          "old_api": null,
          "new_api": "HASH",
          "old_text": null,
          "new_text": "HASH(motion_fx,motion_fy, motion_bx, motion_by)",
          "old_line_content": "",
          "new_line_content": "    int hashidx= HASH(motion_fx,motion_fy, motion_bx, motion_by);",
          "content_same": false
        },
        {
          "line": 1482,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(map,0,sizeof(map))",
          "old_line_content": "    map[((motion_fx+fx)+17*(motion_fy+fy)+63*(motion_bx+bx)+117*(motion_by+by))&255]",
          "new_line_content": "    memset(map,0,sizeof(map));",
          "content_same": false
        },
        {
          "line": 1739,
          "old_api": null,
          "new_api": "ff_estimate_motion_b",
          "old_text": null,
          "new_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code)",
          "old_line_content": "",
          "new_line_content": "    fmin= ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code) + 3*penalty_factor;",
          "content_same": false
        },
        {
          "line": 1742,
          "old_api": null,
          "new_api": "ff_estimate_motion_b",
          "old_text": null,
          "new_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code)",
          "old_line_content": "//printf(\" %d %d \", s->b_forw_mv_table[xy][0], s->b_forw_mv_table[xy][1]);",
          "new_line_content": "    bmin= ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code) + 2*penalty_factor;",
          "content_same": false
        },
        {
          "line": 1746,
          "old_api": null,
          "new_api": "bidir_refine",
          "old_text": null,
          "new_text": "bidir_refine(s, mb_x, mb_y)",
          "old_line_content": "//printf(\"%d %d %d %d\\n\", dmin, fmin, bmin, fbmin);",
          "new_line_content": "    fbmin= bidir_refine(s, mb_x, mb_y) + penalty_factor;",
          "content_same": false
        },
        {
          "line": 1880,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(s->pict_type==FF_P_TYPE)",
          "old_line_content": "",
          "new_line_content": "    assert(s->pict_type==FF_P_TYPE);",
          "content_same": false
        },
        {
          "line": 1625,
          "old_api": null,
          "new_api": "av_clip",
          "old_text": null,
          "new_text": "av_clip(mv_table[mot_xy - 1][1], ymin<<shift, ymax<<shift)",
          "old_line_content": "",
          "new_line_content": "    P_LEFT[1]        = av_clip(mv_table[mot_xy - 1][1], ymin<<shift, ymax<<shift);",
          "content_same": false
        },
        {
          "line": 1753,
          "old_api": null,
          "new_api": "interlaced_search",
          "old_text": null,
          "new_text": "interlaced_search(s, 0,\n                                 s->b_field_mv_table[0], s->b_field_select_table[0],\n                                 s->b_forw_mv_table[xy][0], s->b_forw_mv_table[xy][1], 0)",
          "old_line_content": "                                 s->b_field_mv_table[0], s->b_field_select_table[0],",
          "new_line_content": "        fimin= interlaced_search(s, 0,",
          "content_same": false
        },
        {
          "line": 1757,
          "old_api": null,
          "new_api": "interlaced_search",
          "old_text": null,
          "new_text": "interlaced_search(s, 2,\n                                 s->b_field_mv_table[1], s->b_field_select_table[1],\n                                 s->b_back_mv_table[xy][0], s->b_back_mv_table[xy][1], 0)",
          "old_line_content": "                                 s->b_field_mv_table[1], s->b_field_select_table[1],",
          "new_line_content": "        bimin= interlaced_search(s, 2,",
          "content_same": false
        },
        {
          "line": 1885,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(range <=256 || !(s->codec_id == CODEC_ID_MPEG2VIDEO && s->avctx->strict_std_compliance >= FF_COMPLIANCE_NORMAL))",
          "old_line_content": "",
          "new_line_content": "    assert(range <=256 || !(s->codec_id == CODEC_ID_MPEG2VIDEO && s->avctx->strict_std_compliance >= FF_COMPLIANCE_NORMAL));",
          "content_same": false
        },
        {
          "line": 1632,
          "old_api": null,
          "new_api": "av_clip",
          "old_text": null,
          "new_text": "av_clip(mv_table[mot_xy - mot_stride + 1         ][1], ymin<<shift, ymax<<shift)",
          "old_line_content": "",
          "new_line_content": "        P_TOPRIGHT[1] = av_clip(mv_table[mot_xy - mot_stride + 1         ][1], ymin<<shift, ymax<<shift);",
          "content_same": false
        },
        {
          "line": 1635,
          "old_api": null,
          "new_api": "mid_pred",
          "old_text": null,
          "new_text": "mid_pred(P_LEFT[1], P_TOP[1], P_TOPRIGHT[1])",
          "old_line_content": "    }",
          "new_line_content": "        P_MEDIAN[1]= mid_pred(P_LEFT[1], P_TOP[1], P_TOPRIGHT[1]);",
          "content_same": false
        },
        {
          "line": 1638,
          "old_api": null,
          "new_api": "ff_epzs_motion_search",
          "old_text": null,
          "new_text": "ff_epzs_motion_search(s, &mx, &my, P, 0, 0, mv_table, 1<<(16-shift), 0, 16)",
          "old_line_content": "    if(c->sub_flags&FLAG_QPEL)",
          "new_line_content": "    dmin = ff_epzs_motion_search(s, &mx, &my, P, 0, 0, mv_table, 1<<(16-shift), 0, 16);",
          "content_same": false
        },
        {
          "line": 1640,
          "old_api": null,
          "new_api": "qpel_motion_search",
          "old_text": null,
          "new_text": "qpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16)",
          "old_line_content": "    else",
          "new_line_content": "        dmin = qpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16);",
          "content_same": false
        },
        {
          "line": 1642,
          "old_api": null,
          "new_api": "hpel_motion_search",
          "old_text": null,
          "new_text": "hpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16)",
          "old_line_content": "",
          "new_line_content": "        dmin = hpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16);",
          "content_same": false
        },
        {
          "line": 1645,
          "old_api": null,
          "new_api": "ff_get_mb_score",
          "old_text": null,
          "new_text": "ff_get_mb_score(s, mx, my, 0, 0, 0, 16, 1)",
          "old_line_content": "",
          "new_line_content": "        dmin= ff_get_mb_score(s, mx, my, 0, 0, 0, 16, 1);",
          "content_same": false
        },
        {
          "line": 1647,
          "old_api": null,
          "new_api": "get_limits",
          "old_text": null,
          "new_text": "get_limits(s, 16*mb_x, 16*mb_y)",
          "old_line_content": "",
          "new_line_content": "    get_limits(s, 16*mb_x, 16*mb_y); //restore c->?min/max, maybe not needed",
          "content_same": false
        },
        {
          "line": 1522,
          "old_api": null,
          "new_api": "CHECK_BIDIRR",
          "old_text": null,
          "new_text": "CHECK_BIDIRR( 0, 0, 0, 1)",
          "old_line_content": "            if(s->avctx->bidir_refine > 1){",
          "new_line_content": "            CHECK_BIDIRR( 0, 0, 0, 1)",
          "content_same": false
        },
        {
          "line": 1529,
          "old_api": null,
          "new_api": "CHECK_BIDIR2",
          "old_text": null,
          "new_text": "CHECK_BIDIR2(-1, 0, 1, 0)",
          "old_line_content": "                if(s->avctx->bidir_refine > 2){",
          "new_line_content": "                CHECK_BIDIR2(-1, 0, 1, 0)",
          "content_same": false
        },
        {
          "line": 1534,
          "old_api": null,
          "new_api": "CHECK_BIDIRR",
          "old_text": null,
          "new_text": "CHECK_BIDIRR( 0, 1, 1,-1)",
          "old_line_content": "                    if(s->avctx->bidir_refine > 3){",
          "new_line_content": "                    CHECK_BIDIRR( 0, 1, 1,-1)",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1664,
          "old_api": "init_ref",
          "new_api": null,
          "old_text": "init_ref(c, s->new_picture.data, s->last_picture.data, s->next_picture.data, 16*mb_x, 16*mb_y, 2)",
          "new_text": null,
          "old_line_content": "    init_ref(c, s->new_picture.data, s->last_picture.data, s->next_picture.data, 16*mb_x, 16*mb_y, 2);",
          "new_line_content": "    const int xy = mb_y*s->mb_stride + mb_x;",
          "content_same": false
        },
        {
          "line": 1666,
          "old_api": "get_limits",
          "new_api": null,
          "old_text": "get_limits(s, 16*mb_x, 16*mb_y)",
          "new_text": null,
          "old_line_content": "    get_limits(s, 16*mb_x, 16*mb_y);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1671,
          "old_api": "direct_search",
          "new_api": null,
          "old_text": "direct_search(s, mb_x, mb_y)",
          "new_text": null,
          "old_line_content": "        int score= direct_search(s, mb_x, mb_y); //FIXME just check 0,0",
          "new_line_content": "    if(s->codec_id == CODEC_ID_MPEG4 && s->next_picture.mbskip_table[xy]){",
          "content_same": false
        },
        {
          "line": 1682,
          "old_api": "check_input_motion",
          "new_api": null,
          "old_text": "check_input_motion(s, mb_x, mb_y, 0)",
          "new_text": null,
          "old_line_content": "        int vard= check_input_motion(s, mb_x, mb_y, 0);",
          "new_line_content": "    if(c->avctx->me_threshold){",
          "content_same": false
        },
        {
          "line": 1825,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(range, 16)",
          "new_text": null,
          "old_line_content": "            range= FFMIN(range, 16);",
          "new_line_content": "        if(s->msmpeg4_version)",
          "content_same": false
        },
        {
          "line": 1571,
          "old_api": "IS_8X8",
          "new_api": null,
          "old_text": "IS_8X8(s->next_picture.mb_type[mot_xy])",
          "new_text": null,
          "old_line_content": "    if(IS_8X8(s->next_picture.mb_type[mot_xy])){",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1827,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(range, 256)",
          "new_text": null,
          "old_line_content": "            range= FFMIN(range, 256);",
          "new_line_content": "        else if(s->codec_id == CODEC_ID_MPEG2VIDEO && s->avctx->strict_std_compliance >= FF_COMPLIANCE_NORMAL)",
          "content_same": false
        },
        {
          "line": 1704,
          "old_api": "direct_search",
          "new_api": null,
          "old_text": "direct_search(s, mb_x, mb_y)",
          "new_text": null,
          "old_line_content": "                direct_search(s, mb_x, mb_y);",
          "new_line_content": "            if(type == CANDIDATE_MB_TYPE_DIRECT){",
          "content_same": false
        },
        {
          "line": 1708,
          "old_api": "ff_estimate_motion_b",
          "new_api": null,
          "old_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code)",
          "new_text": null,
          "old_line_content": "                ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code);",
          "new_line_content": "                c->skip=0;",
          "content_same": false
        },
        {
          "line": 1838,
          "old_api": "FFMAX",
          "new_api": null,
          "old_text": "FFMAX(fcode_tab[mx + MAX_MV],\n                                     fcode_tab[my + MAX_MV])",
          "new_text": null,
          "old_line_content": "                    int fcode= FFMAX(fcode_tab[mx + MAX_MV],",
          "new_line_content": "                    int my= mv_table[xy][1];",
          "content_same": false
        },
        {
          "line": 1712,
          "old_api": "ff_estimate_motion_b",
          "new_api": null,
          "old_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code)",
          "new_text": null,
          "old_line_content": "                ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code);",
          "new_line_content": "                c->skip=0;",
          "content_same": false
        },
        {
          "line": 1588,
          "old_api": "FFMAX",
          "new_api": null,
          "old_text": "FFMAX(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])",
          "new_text": null,
          "old_line_content": "        max= FFMAX(c->direct_basis_mv[i][0], c->direct_basis_mv[i][0] - c->co_located_mv[i][0])>>shift;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1717,
          "old_api": "interlaced_search",
          "new_api": null,
          "old_text": "interlaced_search(s, 0,\n                                        s->b_field_mv_table[0], s->b_field_select_table[0],\n                                        s->b_forw_mv_table[xy][0], s->b_forw_mv_table[xy][1], 1)",
          "new_text": null,
          "old_line_content": "                interlaced_search(s, 0,",
          "new_line_content": "                c->current_mv_penalty= c->mv_penalty[s->f_code] + MAX_MV;",
          "content_same": false
        },
        {
          "line": 1592,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(xmax, s->width - max)",
          "new_text": null,
          "old_line_content": "        xmax= FFMIN(xmax, s->width - max);",
          "new_line_content": "        min+= 16*mb_x - 1;",
          "content_same": false
        },
        {
          "line": 1595,
          "old_api": "FFMAX",
          "new_api": null,
          "old_text": "FFMAX(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])",
          "new_text": null,
          "old_line_content": "        max= FFMAX(c->direct_basis_mv[i][1], c->direct_basis_mv[i][1] - c->co_located_mv[i][1])>>shift;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1724,
          "old_api": "interlaced_search",
          "new_api": null,
          "old_text": "interlaced_search(s, 2,\n                                        s->b_field_mv_table[1], s->b_field_select_table[1],\n                                        s->b_back_mv_table[xy][0], s->b_back_mv_table[xy][1], 1)",
          "new_text": null,
          "old_line_content": "                interlaced_search(s, 2,",
          "new_line_content": "                c->current_mv_penalty= c->mv_penalty[s->b_code] + MAX_MV;",
          "content_same": false
        },
        {
          "line": 1599,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(ymax, s->height - max)",
          "new_text": null,
          "old_line_content": "        ymax= FFMIN(ymax, s->height - max);",
          "new_line_content": "        min+= 16*mb_y - 1;",
          "content_same": false
        },
        {
          "line": 1605,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(xmax <= 15 && ymax <= 15 && xmin >= -16 && ymin >= -16)",
          "new_text": null,
          "old_line_content": "    assert(xmax <= 15 && ymax <= 15 && xmin >= -16 && ymin >= -16);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1733,
          "old_api": "direct_search",
          "new_api": null,
          "old_text": "direct_search(s, mb_x, mb_y)",
          "new_text": null,
          "old_line_content": "        dmin= direct_search(s, mb_x, mb_y);",
          "new_line_content": "    if (s->codec_id == CODEC_ID_MPEG4)",
          "content_same": false
        },
        {
          "line": 1480,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(map,0,sizeof(map))",
          "new_text": null,
          "old_line_content": "    memset(map,0,sizeof(map));",
          "new_line_content": "    uint8_t map[256];",
          "content_same": false
        },
        {
          "line": 1738,
          "old_api": "ff_estimate_motion_b",
          "new_api": null,
          "old_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code)",
          "new_text": null,
          "old_line_content": "    fmin= ff_estimate_motion_b(s, mb_x, mb_y, s->b_forw_mv_table, 0, s->f_code) + 3*penalty_factor;",
          "new_line_content": "    c->skip=0;",
          "content_same": false
        },
        {
          "line": 1483,
          "old_api": "BIDIR_MAP",
          "new_api": null,
          "old_text": "BIDIR_MAP(0,0,0,0)",
          "new_text": null,
          "old_line_content": "    BIDIR_MAP(0,0,0,0) = 1;",
          "new_line_content": "    map[hashidx&255] = 1;",
          "content_same": false
        },
        {
          "line": 1741,
          "old_api": "ff_estimate_motion_b",
          "new_api": null,
          "old_text": "ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code)",
          "new_text": null,
          "old_line_content": "    bmin= ff_estimate_motion_b(s, mb_x, mb_y, s->b_back_mv_table, 2, s->b_code) + 2*penalty_factor;",
          "new_line_content": "    c->skip=0;",
          "content_same": false
        },
        {
          "line": 1745,
          "old_api": "bidir_refine",
          "new_api": null,
          "old_text": "bidir_refine(s, mb_x, mb_y)",
          "new_text": null,
          "old_line_content": "    fbmin= bidir_refine(s, mb_x, mb_y) + penalty_factor;",
          "new_line_content": "    c->skip=0;",
          "content_same": false
        },
        {
          "line": 1623,
          "old_api": "av_clip",
          "new_api": null,
          "old_text": "av_clip(mv_table[mot_xy - 1][0], xmin<<shift, xmax<<shift)",
          "new_text": null,
          "old_line_content": "    P_LEFT[0]        = av_clip(mv_table[mot_xy - 1][0], xmin<<shift, xmax<<shift);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1752,
          "old_api": "interlaced_search",
          "new_api": null,
          "old_text": "interlaced_search(s, 0,\n                                 s->b_field_mv_table[0], s->b_field_select_table[0],\n                                 s->b_forw_mv_table[xy][0], s->b_forw_mv_table[xy][1], 0)",
          "new_text": null,
          "old_line_content": "        fimin= interlaced_search(s, 0,",
          "new_line_content": "        c->current_mv_penalty= c->mv_penalty[s->f_code] + MAX_MV;",
          "content_same": false
        },
        {
          "line": 1879,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(s->pict_type==FF_P_TYPE)",
          "new_text": null,
          "old_line_content": "    assert(s->pict_type==FF_P_TYPE);",
          "new_line_content": "    int y, range;",
          "content_same": false
        },
        {
          "line": 1883,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(range <= 16 || !s->msmpeg4_version)",
          "new_text": null,
          "old_line_content": "    assert(range <= 16 || !s->msmpeg4_version);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1628,
          "old_api": "av_clip",
          "new_api": null,
          "old_text": "av_clip(mv_table[mot_xy - mot_stride             ][0], xmin<<shift, xmax<<shift)",
          "new_text": null,
          "old_line_content": "        P_TOP[0]      = av_clip(mv_table[mot_xy - mot_stride             ][0], xmin<<shift, xmax<<shift);",
          "new_line_content": "    if (!s->first_slice_line) { //FIXME maybe allow this over thread boundary as it is clipped",
          "content_same": false
        },
        {
          "line": 1756,
          "old_api": "interlaced_search",
          "new_api": null,
          "old_text": "interlaced_search(s, 2,\n                                 s->b_field_mv_table[1], s->b_field_select_table[1],\n                                 s->b_back_mv_table[xy][0], s->b_back_mv_table[xy][1], 0)",
          "new_text": null,
          "old_line_content": "        bimin= interlaced_search(s, 2,",
          "new_line_content": "        c->current_mv_penalty= c->mv_penalty[s->b_code] + MAX_MV;",
          "content_same": false
        },
        {
          "line": 1633,
          "old_api": "mid_pred",
          "new_api": null,
          "old_text": "mid_pred(P_LEFT[0], P_TOP[0], P_TOPRIGHT[0])",
          "new_text": null,
          "old_line_content": "        P_MEDIAN[0]= mid_pred(P_LEFT[0], P_TOP[0], P_TOPRIGHT[0]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1637,
          "old_api": "ff_epzs_motion_search",
          "new_api": null,
          "old_text": "ff_epzs_motion_search(s, &mx, &my, P, 0, 0, mv_table, 1<<(16-shift), 0, 16)",
          "new_text": null,
          "old_line_content": "    dmin = ff_epzs_motion_search(s, &mx, &my, P, 0, 0, mv_table, 1<<(16-shift), 0, 16);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1639,
          "old_api": "qpel_motion_search",
          "new_api": null,
          "old_text": "qpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16)",
          "new_text": null,
          "old_line_content": "        dmin = qpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16);",
          "new_line_content": "    if(c->sub_flags&FLAG_QPEL)",
          "content_same": false
        },
        {
          "line": 1641,
          "old_api": "hpel_motion_search",
          "new_api": null,
          "old_text": "hpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16)",
          "new_text": null,
          "old_line_content": "        dmin = hpel_motion_search(s, &mx, &my, dmin, 0, 0, 0, 16);",
          "new_line_content": "    else",
          "content_same": false
        },
        {
          "line": 1644,
          "old_api": "ff_get_mb_score",
          "new_api": null,
          "old_text": "ff_get_mb_score(s, mx, my, 0, 0, 0, 16, 1)",
          "new_text": null,
          "old_line_content": "        dmin= ff_get_mb_score(s, mx, my, 0, 0, 0, 16, 1);",
          "new_line_content": "    if(c->avctx->me_sub_cmp != c->avctx->mb_cmp && !c->skip)",
          "content_same": false
        },
        {
          "line": 1646,
          "old_api": "get_limits",
          "new_api": null,
          "old_text": "get_limits(s, 16*mb_x, 16*mb_y)",
          "new_text": null,
          "old_line_content": "    get_limits(s, 16*mb_x, 16*mb_y); //restore c->?min/max, maybe not needed",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1521,
          "old_api": "CHECK_BIDIRR",
          "new_api": null,
          "old_text": "CHECK_BIDIRR( 0, 0, 0, 1)",
          "new_text": null,
          "old_line_content": "            CHECK_BIDIRR( 0, 0, 0, 1)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1523,
          "old_api": "CHECK_BIDIRR",
          "new_api": null,
          "old_text": "CHECK_BIDIRR( 0, 0, 1, 1)",
          "new_text": null,
          "old_line_content": "                CHECK_BIDIRR( 0, 0, 1, 1)",
          "new_line_content": "            if(s->avctx->bidir_refine > 1){",
          "content_same": false
        },
        {
          "line": 1530,
          "old_api": "CHECK_BIDIRR",
          "new_api": null,
          "old_text": "CHECK_BIDIRR( 0, 1, 1, 1)",
          "new_text": null,
          "old_line_content": "                    CHECK_BIDIRR( 0, 1, 1, 1)",
          "new_line_content": "                if(s->avctx->bidir_refine > 2){",
          "content_same": false
        },
        {
          "line": 1535,
          "old_api": "CHECK_BIDIR2",
          "new_api": null,
          "old_text": "CHECK_BIDIR2( 1, 1, 1, 1)",
          "new_text": null,
          "old_line_content": "                        CHECK_BIDIR2( 1, 1, 1, 1)",
          "new_line_content": "                    if(s->avctx->bidir_refine > 3){",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 9,
      "total_additions": 40,
      "total_deletions": 40,
      "total_api_changes": 89
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 8,
        "api_related_lines": 89,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          1478,
          1481,
          1494,
          1497,
          1500
        ]
      }
    },
    "api_calls_before": 290,
    "api_calls_after": 290,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 5,
      "total_diff_lines": 37
    }
  }
}