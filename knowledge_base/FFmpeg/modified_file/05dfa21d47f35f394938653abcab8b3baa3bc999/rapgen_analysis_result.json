{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/05dfa21d47f35f394938653abcab8b3baa3bc999",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/05dfa21d47f35f394938653abcab8b3baa3bc999/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/05dfa21d47f35f394938653abcab8b3baa3bc999/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/05dfa21d47f35f394938653abcab8b3baa3bc999/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 421,
          "old_api": "pvq_search",
          "new_api": "celt_exp_rotation",
          "old_text": "pvq->pvq_search(X, y, K, N)",
          "new_text": "celt_exp_rotation(X, N, blocks, K, spread, 1)",
          "old_line_content": "    gain /= sqrtf(pvq->pvq_search(X, y, K, N));",
          "new_line_content": "    celt_exp_rotation(X, N, blocks, K, spread, 1);",
          "content_same": false
        },
        {
          "line": 422,
          "old_api": "celt_encode_pulses",
          "new_api": "pvq_search",
          "old_text": "celt_encode_pulses(rc, y,  N, K)",
          "new_text": "pvq->pvq_search(X, y, K, N)",
          "old_line_content": "    celt_encode_pulses(rc, y,  N, K);",
          "new_line_content": "    gain /= sqrtf(pvq->pvq_search(X, y, K, N));",
          "content_same": false
        },
        {
          "line": 423,
          "old_api": "celt_normalize_residual",
          "new_api": "celt_encode_pulses",
          "old_text": "celt_normalize_residual(y, X, N, gain)",
          "new_text": "celt_encode_pulses(rc, y,  N, K)",
          "old_line_content": "    celt_normalize_residual(y, X, N, gain);",
          "new_line_content": "    celt_encode_pulses(rc, y,  N, K);",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": "celt_exp_rotation",
          "new_api": "celt_normalize_residual",
          "old_text": "celt_exp_rotation(X, N, blocks, K, spread, 0)",
          "new_text": "celt_normalize_residual(y, X, N, gain)",
          "old_line_content": "    celt_exp_rotation(X, N, blocks, K, spread, 0);",
          "new_line_content": "    celt_normalize_residual(y, X, N, gain);",
          "content_same": false
        },
        {
          "line": 425,
          "old_api": "celt_extract_collapse_mask",
          "new_api": "celt_exp_rotation",
          "old_text": "celt_extract_collapse_mask(y, N, blocks)",
          "new_text": "celt_exp_rotation(X, N, blocks, K, spread, 0)",
          "old_line_content": "    return celt_extract_collapse_mask(y, N, blocks);",
          "new_line_content": "    celt_exp_rotation(X, N, blocks, K, spread, 0);",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "celt_normalize_residual",
          "new_api": "celt_decode_pulses",
          "old_text": "celt_normalize_residual(y, X, N, gain)",
          "new_text": "celt_decode_pulses(rc, y, N, K)",
          "old_line_content": "    celt_normalize_residual(y, X, N, gain);",
          "new_line_content": "    gain /= sqrtf(celt_decode_pulses(rc, y, N, K));",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": "celt_exp_rotation",
          "new_api": "celt_normalize_residual",
          "old_text": "celt_exp_rotation(X, N, blocks, K, spread, 0)",
          "new_text": "celt_normalize_residual(y, X, N, gain)",
          "old_line_content": "    celt_exp_rotation(X, N, blocks, K, spread, 0);",
          "new_line_content": "    celt_normalize_residual(y, X, N, gain);",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": "celt_extract_collapse_mask",
          "new_api": "celt_exp_rotation",
          "old_text": "celt_extract_collapse_mask(y, N, blocks)",
          "new_text": "celt_exp_rotation(X, N, blocks, K, spread, 0)",
          "old_line_content": "    return celt_extract_collapse_mask(y, N, blocks);",
          "new_line_content": "    celt_exp_rotation(X, N, blocks, K, spread, 0);",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": "opus_rc_tell_frac",
          "new_api": "celt_compute_qn",
          "old_text": "opus_rc_tell_frac(rc)",
          "new_text": "celt_compute_qn(N, b, offset, pulse_cap, stereo)",
          "old_line_content": "        tell = opus_rc_tell_frac(rc);",
          "new_line_content": "             celt_compute_qn(N, b, offset, pulse_cap, stereo);",
          "content_same": false
        },
        {
          "line": 787,
          "old_api": "celt_pulses2bits",
          "new_api": "celt_bits2pulses",
          "old_text": "celt_pulses2bits(cache, q)",
          "new_text": "celt_bits2pulses(cache, b)",
          "old_line_content": "        uint32_t curr_bits = celt_pulses2bits(cache, q);",
          "new_line_content": "        uint32_t q         = celt_bits2pulses(cache, b);",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": "OPUS_RC_CHECKPOINT_BITS",
          "new_api": "sqrtf",
          "old_text": "OPUS_RC_CHECKPOINT_BITS(rc)",
          "new_text": "sqrtf(err_y)",
          "old_line_content": "    cost = OPUS_RC_CHECKPOINT_BITS(rc)/8.0f;",
          "new_line_content": "    dist = sqrtf(err_x) + sqrtf(err_y);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 640,
          "old_api": null,
          "new_api": "ff_opus_rc_enc_log",
          "old_text": null,
          "new_text": "ff_opus_rc_enc_log(rc, inv, 2)",
          "old_line_content": "                } else {",
          "new_line_content": "                    ff_opus_rc_enc_log(rc, inv, 2);",
          "content_same": false
        },
        {
          "line": 514,
          "old_api": null,
          "new_api": "ff_opus_rc_put_raw",
          "old_text": null,
          "new_text": "ff_opus_rc_put_raw(rc, sign, 1)",
          "old_line_content": "                } else {",
          "new_line_content": "                    ff_opus_rc_put_raw(rc, sign, 1);",
          "content_same": false
        },
        {
          "line": 771,
          "old_api": null,
          "new_api": "rec",
          "old_text": null,
          "new_text": "rec(pvq, f, rc, band, Y, NULL, N, sbits, blocks, next_lowband2,\n                         duration, NULL, next_level, gain * side, NULL, fill >> blocks)",
          "old_line_content": "                         duration, NULL, next_level, gain * side, NULL, fill >> blocks);",
          "new_line_content": "                cm = rec(pvq, f, rc, band, Y, NULL, N, sbits, blocks, next_lowband2,",
          "content_same": false
        },
        {
          "line": 516,
          "old_api": null,
          "new_api": "ff_opus_rc_get_raw",
          "old_text": null,
          "new_text": "ff_opus_rc_get_raw(rc, 1)",
          "old_line_content": "                }",
          "new_line_content": "                    sign = ff_opus_rc_get_raw(rc, 1);",
          "content_same": false
        },
        {
          "line": 645,
          "old_api": null,
          "new_api": "ff_opus_rc_dec_log",
          "old_text": null,
          "new_text": "ff_opus_rc_dec_log(rc, 2)",
          "old_line_content": "            }",
          "new_line_content": "                inv = (b > 2 << 3 && f->remaining2 > 2 << 3) ? ff_opus_rc_dec_log(rc, 2) : 0;",
          "content_same": false
        },
        {
          "line": 764,
          "old_api": null,
          "new_api": "rec",
          "old_text": null,
          "new_text": "rec(pvq, f, rc, band, Y, NULL, N, sbits, blocks, next_lowband2,\n                          duration, NULL, next_level, gain * side, NULL,\n                          fill >> blocks)",
          "old_line_content": "                          duration, NULL, next_level, gain * side, NULL,",
          "new_line_content": "                cmt = rec(pvq, f, rc, band, Y, NULL, N, sbits, blocks, next_lowband2,",
          "content_same": false
        },
        {
          "line": 903,
          "old_api": null,
          "new_api": "OPUS_RC_CHECKPOINT_SPAWN",
          "old_text": null,
          "new_text": "OPUS_RC_CHECKPOINT_SPAWN(rc)",
          "old_line_content": "",
          "new_line_content": "    OPUS_RC_CHECKPOINT_SPAWN(rc);",
          "content_same": false
        },
        {
          "line": 649,
          "old_api": null,
          "new_api": "opus_rc_tell_frac",
          "old_text": null,
          "new_text": "opus_rc_tell_frac(rc)",
          "old_line_content": "        b -= qalloc;",
          "new_line_content": "        qalloc = opus_rc_tell_frac(rc) - tell;",
          "content_same": false
        },
        {
          "line": 905,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(X, X_orig, band_size*sizeof(float))",
          "old_line_content": "    if (Y)",
          "new_line_content": "    memcpy(X, X_orig, band_size*sizeof(float));",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": null,
          "new_api": "FFABS",
          "old_text": null,
          "new_text": "FFABS(X[i])",
          "old_line_content": "            xy_new = xy_new * xy_new;",
          "new_line_content": "            float xy_new = xy_norm + 1*phase*FFABS(X[i]);",
          "content_same": false
        },
        {
          "line": 780,
          "old_api": null,
          "new_api": "rec",
          "old_text": null,
          "new_text": "rec(pvq, f, rc, band, X, NULL, N, mbits, blocks, lowband, duration,\n                          next_lowband_out1, next_level, stereo ? 1.0f : (gain * mid),\n                          lowband_scratch, fill)",
          "old_line_content": "                          next_lowband_out1, next_level, stereo ? 1.0f : (gain * mid),",
          "new_line_content": "                cm |= rec(pvq, f, rc, band, X, NULL, N, mbits, blocks, lowband, duration,",
          "content_same": false
        },
        {
          "line": 907,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(Y, Y_orig, band_size*sizeof(float))",
          "old_line_content": "",
          "new_line_content": "        memcpy(Y, Y_orig, band_size*sizeof(float));",
          "content_same": false
        },
        {
          "line": 909,
          "old_api": null,
          "new_api": "opus_rc_tell_frac",
          "old_text": null,
          "new_text": "opus_rc_tell_frac(rc)",
          "old_line_content": "    if (band <= f->coded_bands - 1) {",
          "new_line_content": "    f->remaining2 = ((f->framebits << 3) - f->anticollapse_needed) - opus_rc_tell_frac(rc) - 1;",
          "content_same": false
        },
        {
          "line": 656,
          "old_api": null,
          "new_api": "av_mod_uintp2",
          "old_text": null,
          "new_text": "av_mod_uintp2(fill, blocks)",
          "old_line_content": "            delta = -16384;",
          "new_line_content": "            fill = av_mod_uintp2(fill, blocks);",
          "content_same": false
        },
        {
          "line": 912,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(f->remaining2 + 1, f->pulses[band] + curr_balance)",
          "old_line_content": "    }",
          "new_line_content": "        b = av_clip_uintp2(FFMIN(f->remaining2 + 1, f->pulses[band] + curr_balance), 14);",
          "content_same": false
        },
        {
          "line": 788,
          "old_api": null,
          "new_api": "celt_pulses2bits",
          "old_text": null,
          "new_text": "celt_pulses2bits(cache, q)",
          "old_line_content": "        f->remaining2 -= curr_bits;",
          "new_line_content": "        uint32_t curr_bits = celt_pulses2bits(cache, q);",
          "content_same": false
        },
        {
          "line": 916,
          "old_api": null,
          "new_api": "encode_band",
          "old_text": null,
          "new_text": "pvq->encode_band(pvq, f, rc, band, X, NULL, band_size, b / 2, f->blocks, NULL,\n                         f->size, norm1, 0, 1.0f, lowband_scratch, cm[0])",
          "old_line_content": "                         f->size, norm1, 0, 1.0f, lowband_scratch, cm[0]);",
          "new_line_content": "        pvq->encode_band(pvq, f, rc, band, X, NULL, band_size, b / 2, f->blocks, NULL,",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": null,
          "new_api": "FFSIGN",
          "old_text": null,
          "new_text": "FFSIGN(X[max_idx])",
          "old_line_content": "        xy_norm += 1*phase*X[max_idx];",
          "new_line_content": "        phase *= FFSIGN(X[max_idx]);",
          "content_same": false
        },
        {
          "line": 919,
          "old_api": null,
          "new_api": "encode_band",
          "old_text": null,
          "new_text": "pvq->encode_band(pvq, f, rc, band, Y, NULL, band_size, b / 2, f->blocks, NULL,\n                         f->size, norm2, 0, 1.0f, lowband_scratch, cm[1])",
          "old_line_content": "                         f->size, norm2, 0, 1.0f, lowband_scratch, cm[1]);",
          "new_line_content": "        pvq->encode_band(pvq, f, rc, band, Y, NULL, band_size, b / 2, f->blocks, NULL,",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": null,
          "new_api": "celt_cos",
          "old_text": null,
          "new_text": "celt_cos(16384-itheta)",
          "old_line_content": "            /* This is the mid vs side allocation that minimizes squared error",
          "new_line_content": "            iside = celt_cos(16384-itheta);",
          "content_same": false
        },
        {
          "line": 794,
          "old_api": null,
          "new_api": "celt_pulses2bits",
          "old_text": null,
          "new_text": "celt_pulses2bits(cache, --q)",
          "old_line_content": "            f->remaining2 -= curr_bits;",
          "new_line_content": "            curr_bits      = celt_pulses2bits(cache, --q);",
          "content_same": false
        },
        {
          "line": 922,
          "old_api": null,
          "new_api": "encode_band",
          "old_text": null,
          "new_text": "pvq->encode_band(pvq, f, rc, band, X, Y, band_size, b, f->blocks, NULL, f->size,\n                         norm1, 0, 1.0f, lowband_scratch, cm[0] | cm[1])",
          "old_line_content": "                         norm1, 0, 1.0f, lowband_scratch, cm[0] | cm[1]);",
          "new_line_content": "        pvq->encode_band(pvq, f, rc, band, X, Y, band_size, b, f->blocks, NULL, f->size,",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": null,
          "new_api": "celt_log2tan",
          "old_text": null,
          "new_text": "celt_log2tan(iside, imid)",
          "old_line_content": "        }",
          "new_line_content": "            delta = ROUND_MUL16((N - 1) << 7, celt_log2tan(iside, imid));",
          "content_same": false
        },
        {
          "line": 544,
          "old_api": null,
          "new_api": "celt_haar1",
          "old_text": null,
          "new_text": "celt_haar1(quant ? X : lowband, N >> k, 1 << k)",
          "old_line_content": "            fill = ff_celt_bit_interleave[fill & 0xF] | ff_celt_bit_interleave[fill >> 4] << 2;",
          "new_line_content": "                celt_haar1(quant ? X : lowband, N >> k, 1 << k);",
          "content_same": false
        },
        {
          "line": 801,
          "old_api": null,
          "new_api": "celt_alg_quant",
          "old_text": null,
          "new_text": "celt_alg_quant(rc, X, N, (q < 8) ? q : (8 + (q & 7)) << ((q >> 3) - 1),\n                                    f->spread, blocks, gain, pvq)",
          "old_line_content": "                                    f->spread, blocks, gain, pvq);",
          "new_line_content": "                cm = celt_alg_quant(rc, X, N, (q < 8) ? q : (8 + (q & 7)) << ((q >> 3) - 1),",
          "content_same": false
        },
        {
          "line": 804,
          "old_api": null,
          "new_api": "celt_alg_unquant",
          "old_text": null,
          "new_text": "celt_alg_unquant(rc, X, N, (q < 8) ? q : (8 + (q & 7)) << ((q >> 3) - 1),\n                                      f->spread, blocks, gain, pvq)",
          "old_line_content": "                                      f->spread, blocks, gain, pvq);",
          "new_line_content": "                cm = celt_alg_unquant(rc, X, N, (q < 8) ? q : (8 + (q & 7)) << ((q >> 3) - 1),",
          "content_same": false
        },
        {
          "line": 932,
          "old_api": null,
          "new_api": "OPUS_RC_CHECKPOINT_BITS",
          "old_text": null,
          "new_text": "OPUS_RC_CHECKPOINT_BITS(rc)",
          "old_line_content": "    *bits += cost;",
          "new_line_content": "    cost = OPUS_RC_CHECKPOINT_BITS(rc)/8.0f;",
          "content_same": false
        },
        {
          "line": 935,
          "old_api": null,
          "new_api": "OPUS_RC_CHECKPOINT_ROLLBACK",
          "old_text": null,
          "new_text": "OPUS_RC_CHECKPOINT_ROLLBACK(rc)",
          "old_line_content": "",
          "new_line_content": "    OPUS_RC_CHECKPOINT_ROLLBACK(rc);",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": null,
          "new_api": "celt_haar1",
          "old_text": null,
          "new_text": "celt_haar1(quant ? X : lowband, N_B, blocks)",
          "old_line_content": "            fill |= fill << blocks;",
          "new_line_content": "                celt_haar1(quant ? X : lowband, N_B, blocks);",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": null,
          "new_api": "celt_extract_collapse_mask",
          "old_text": null,
          "new_text": "celt_extract_collapse_mask(y, N, blocks)",
          "old_line_content": "}",
          "new_line_content": "    return celt_extract_collapse_mask(y, N, blocks);",
          "content_same": false
        },
        {
          "line": 942,
          "old_api": null,
          "new_api": "av_malloc",
          "old_text": null,
          "new_text": "av_malloc(sizeof(CeltPVQ))",
          "old_line_content": "    if (!s)",
          "new_line_content": "    CeltPVQ *s = av_malloc(sizeof(CeltPVQ));",
          "content_same": false
        },
        {
          "line": 815,
          "old_api": null,
          "new_api": "celt_rng",
          "old_text": null,
          "new_text": "celt_rng(f)",
          "old_line_content": "                    cm = cm_mask;",
          "new_line_content": "                        X[i] = (((int32_t)celt_rng(f)) >> 20);",
          "content_same": false
        },
        {
          "line": 944,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "",
          "new_line_content": "        return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": null,
          "new_api": "celt_deinterleave_hadamard",
          "old_text": null,
          "new_text": "celt_deinterleave_hadamard(pvq->hadamard_tmp, quant ? X : lowband,\n                                       N_B >> recombine, B0 << recombine,\n                                       longblocks)",
          "old_line_content": "                                       N_B >> recombine, B0 << recombine,",
          "new_line_content": "            celt_deinterleave_hadamard(pvq->hadamard_tmp, quant ? X : lowband,",
          "content_same": false
        },
        {
          "line": 694,
          "old_api": null,
          "new_api": "ff_opus_rc_put_raw",
          "old_text": null,
          "new_text": "ff_opus_rc_put_raw(rc, sign, 1)",
          "old_line_content": "                } else {",
          "new_line_content": "                    ff_opus_rc_put_raw(rc, sign, 1);",
          "content_same": false
        },
        {
          "line": 821,
          "old_api": null,
          "new_api": "celt_rng",
          "old_text": null,
          "new_text": "celt_rng(f)",
          "old_line_content": "                    }",
          "new_line_content": "                        X[i] = lowband[i] + (((celt_rng(f)) & 0x8000) ? 1.0f / 256 : -1.0f / 256);",
          "content_same": false
        },
        {
          "line": 696,
          "old_api": null,
          "new_api": "ff_opus_rc_get_raw",
          "old_text": null,
          "new_text": "ff_opus_rc_get_raw(rc, 1)",
          "old_line_content": "                }",
          "new_line_content": "                    sign = ff_opus_rc_get_raw(rc, 1);",
          "content_same": false
        },
        {
          "line": 825,
          "old_api": null,
          "new_api": "celt_renormalize_vector",
          "old_text": null,
          "new_text": "celt_renormalize_vector(X, N, gain)",
          "old_line_content": "            } else {",
          "new_line_content": "                celt_renormalize_vector(X, N, gain);",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": null,
          "new_api": "celt_extract_collapse_mask",
          "old_text": null,
          "new_text": "celt_extract_collapse_mask(y, N, blocks)",
          "old_line_content": "}",
          "new_line_content": "    return celt_extract_collapse_mask(y, N, blocks);",
          "content_same": false
        },
        {
          "line": 827,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(X, 0, N*sizeof(float))",
          "old_line_content": "            }",
          "new_line_content": "                memset(X, 0, N*sizeof(float));",
          "content_same": false
        },
        {
          "line": 952,
          "old_api": null,
          "new_api": "ff_opus_dsp_init_x86",
          "old_text": null,
          "new_text": "ff_opus_dsp_init_x86(s)",
          "old_line_content": "",
          "new_line_content": "        ff_opus_dsp_init_x86(s);",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": null,
          "new_api": "rec",
          "old_text": null,
          "new_text": "rec(pvq, f, rc, band, x2, NULL, N, mbits, blocks, lowband, duration,\n                     lowband_out, level, gain, lowband_scratch, orig_fill)",
          "old_line_content": "                     lowband_out, level, gain, lowband_scratch, orig_fill);",
          "new_line_content": "            cm = rec(pvq, f, rc, band, x2, NULL, N, mbits, blocks, lowband, duration,",
          "content_same": false
        },
        {
          "line": 961,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(pvq)",
          "old_line_content": "}",
          "new_line_content": "    av_freep(pvq);",
          "content_same": false
        },
        {
          "line": 835,
          "old_api": null,
          "new_api": "celt_stereo_merge",
          "old_text": null,
          "new_text": "celt_stereo_merge(X, Y, mid, N)",
          "old_line_content": "        if (inv) {",
          "new_line_content": "            celt_stereo_merge(X, Y, mid, N);",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": null,
          "new_api": "celt_calc_theta",
          "old_text": null,
          "new_text": "celt_calc_theta(X, Y, stereo, N)",
          "old_line_content": "        int mbits, sbits, delta;",
          "new_line_content": "        int itheta = quant ? celt_calc_theta(X, Y, stereo, N) : 0;",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": null,
          "new_api": "sqrtf",
          "old_text": null,
          "new_text": "sqrtf(e[0])",
          "old_line_content": "}",
          "new_line_content": "    return lrintf(32768.0f*atan2f(sqrtf(e[1]), sqrtf(e[0]))/M_PI);",
          "content_same": false
        },
        {
          "line": 845,
          "old_api": null,
          "new_api": "celt_interleave_hadamard",
          "old_text": null,
          "new_text": "celt_interleave_hadamard(pvq->hadamard_tmp, X, N_B >> recombine,\n                                     B0 << recombine, longblocks)",
          "old_line_content": "                                     B0 << recombine, longblocks);",
          "new_line_content": "            celt_interleave_hadamard(pvq->hadamard_tmp, X, N_B >> recombine,",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": null,
          "new_api": "sqrtf",
          "old_text": null,
          "new_text": "sqrtf(e_l*e_l + e_r*e_r)",
          "old_line_content": "    e_l *= energy_n;",
          "new_line_content": "    const float energy_n = 1.0f/(sqrtf(e_l*e_l + e_r*e_r) + FLT_EPSILON);",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": null,
          "new_api": "opus_rc_tell_frac",
          "old_text": null,
          "new_text": "opus_rc_tell_frac(rc)",
          "old_line_content": "        if (qn != 1) {",
          "new_line_content": "        tell = opus_rc_tell_frac(rc);",
          "content_same": false
        },
        {
          "line": 855,
          "old_api": null,
          "new_api": "celt_haar1",
          "old_text": null,
          "new_text": "celt_haar1(X, N_B, blocks)",
          "old_line_content": "        }",
          "new_line_content": "            celt_haar1(X, N_B, blocks);",
          "content_same": false
        },
        {
          "line": 860,
          "old_api": null,
          "new_api": "celt_haar1",
          "old_text": null,
          "new_text": "celt_haar1(X, N0>>k, 1<<k)",
          "old_line_content": "        }",
          "new_line_content": "            celt_haar1(X, N0>>k, 1<<k);",
          "content_same": false
        },
        {
          "line": 607,
          "old_api": null,
          "new_api": "ff_opus_rc_enc_uint_step",
          "old_text": null,
          "new_text": "ff_opus_rc_enc_uint_step(rc, itheta, qn / 2)",
          "old_line_content": "                else if (stereo || B0 > 1)",
          "new_line_content": "                    ff_opus_rc_enc_uint_step(rc, itheta, qn / 2);",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(0, delta + (N << 3 >> (5 - duration)))",
          "old_line_content": "            }",
          "new_line_content": "                    delta = FFMIN(0, delta + (N << 3 >> (5 - duration)));",
          "content_same": false
        },
        {
          "line": 609,
          "old_api": null,
          "new_api": "ff_opus_rc_enc_uint",
          "old_text": null,
          "new_text": "ff_opus_rc_enc_uint(rc, itheta, qn + 1)",
          "old_line_content": "                else",
          "new_line_content": "                    ff_opus_rc_enc_uint(rc, itheta, qn + 1);",
          "content_same": false
        },
        {
          "line": 737,
          "old_api": null,
          "new_api": "av_clip",
          "old_text": null,
          "new_text": "av_clip((b - delta) / 2, 0, b)",
          "old_line_content": "            sbits = b - mbits;",
          "new_line_content": "            mbits = av_clip((b - delta) / 2, 0, b);",
          "content_same": false
        },
        {
          "line": 611,
          "old_api": null,
          "new_api": "ff_opus_rc_enc_uint_tri",
          "old_text": null,
          "new_text": "ff_opus_rc_enc_uint_tri(rc, itheta, qn)",
          "old_line_content": "                itheta = itheta * 16384 / qn;",
          "new_line_content": "                    ff_opus_rc_enc_uint_tri(rc, itheta, qn);",
          "content_same": false
        },
        {
          "line": 866,
          "old_api": null,
          "new_api": "sqrtf",
          "old_text": null,
          "new_text": "sqrtf(N0)",
          "old_line_content": "            for (i = 0; i < N0; i++)",
          "new_line_content": "            float n = sqrtf(N0);",
          "content_same": false
        },
        {
          "line": 870,
          "old_api": null,
          "new_api": "av_mod_uintp2",
          "old_text": null,
          "new_text": "av_mod_uintp2(cm, blocks)",
          "old_line_content": "    }",
          "new_line_content": "        cm = av_mod_uintp2(cm, blocks);",
          "content_same": false
        },
        {
          "line": 615,
          "old_api": null,
          "new_api": "celt_stereo_is_decouple",
          "old_text": null,
          "new_text": "celt_stereo_is_decouple(X, Y, f->block[0].lin_energy[band],\n                                                f->block[1].lin_energy[band], N)",
          "old_line_content": "                                                f->block[1].lin_energy[band], N);",
          "new_line_content": "                        celt_stereo_is_decouple(X, Y, f->block[0].lin_energy[band],",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": null,
          "new_api": "celt_stereo_ms_decouple",
          "old_text": null,
          "new_text": "celt_stereo_ms_decouple(X, Y, N)",
          "old_line_content": "                }",
          "new_line_content": "                        celt_stereo_ms_decouple(X, Y, N);",
          "content_same": false
        },
        {
          "line": 622,
          "old_api": null,
          "new_api": "ff_opus_rc_dec_uint_step",
          "old_text": null,
          "new_text": "ff_opus_rc_dec_uint_step(rc, qn / 2)",
          "old_line_content": "                else if (stereo || B0 > 1)",
          "new_line_content": "                    itheta = ff_opus_rc_dec_uint_step(rc, qn / 2);",
          "content_same": false
        },
        {
          "line": 879,
          "old_api": null,
          "new_api": "quant_band_template",
          "old_text": null,
          "new_text": "quant_band_template(pvq, f, rc, band, X, Y, N, b, blocks, lowband, duration,\n                               lowband_out, level, gain, lowband_scratch, fill, 0,\n                               pvq->decode_band)",
          "old_line_content": "                               lowband_out, level, gain, lowband_scratch, fill, 0,",
          "new_line_content": "    return quant_band_template(pvq, f, rc, band, X, Y, N, b, blocks, lowband, duration,",
          "content_same": false
        },
        {
          "line": 624,
          "old_api": null,
          "new_api": "ff_opus_rc_dec_uint",
          "old_text": null,
          "new_text": "ff_opus_rc_dec_uint(rc, qn+1)",
          "old_line_content": "                else",
          "new_line_content": "                    itheta = ff_opus_rc_dec_uint(rc, qn+1);",
          "content_same": false
        },
        {
          "line": 626,
          "old_api": null,
          "new_api": "ff_opus_rc_dec_uint_tri",
          "old_text": null,
          "new_text": "ff_opus_rc_dec_uint_tri(rc, qn)",
          "old_line_content": "                itheta = itheta * 16384 / qn;",
          "new_line_content": "                    itheta = ff_opus_rc_dec_uint_tri(rc, qn);",
          "content_same": false
        },
        {
          "line": 755,
          "old_api": null,
          "new_api": "rec",
          "old_text": null,
          "new_text": "rec(pvq, f, rc, band, X, NULL, N, mbits, blocks, lowband,\n                         duration, next_lowband_out1, next_level,\n                         stereo ? 1.0f : (gain * mid), lowband_scratch, fill)",
          "old_line_content": "                         duration, next_lowband_out1, next_level,",
          "new_line_content": "                cm = rec(pvq, f, rc, band, X, NULL, N, mbits, blocks, lowband,",
          "content_same": false
        },
        {
          "line": 886,
          "old_api": null,
          "new_api": "quant_band_template",
          "old_text": null,
          "new_text": "quant_band_template(pvq, f, rc, band, X, Y, N, b, blocks, lowband, duration,\n                               lowband_out, level, gain, lowband_scratch, fill, 1,\n                               pvq->encode_band)",
          "old_line_content": "                               lowband_out, level, gain, lowband_scratch, fill, 1,",
          "new_line_content": "    return quant_band_template(pvq, f, rc, band, X, Y, N, b, blocks, lowband, duration,",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": null,
          "new_api": "celt_stereo_is_decouple",
          "old_text": null,
          "new_text": "celt_stereo_is_decouple(X, Y, f->block[0].lin_energy[band],\n                                         f->block[1].lin_energy[band], N)",
          "old_line_content": "                                         f->block[1].lin_energy[band], N);",
          "new_line_content": "                 celt_stereo_is_decouple(X, Y, f->block[0].lin_energy[band],",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 513,
          "old_api": "ff_opus_rc_put_raw",
          "new_api": null,
          "old_text": "ff_opus_rc_put_raw(rc, sign, 1)",
          "new_text": null,
          "old_line_content": "                    ff_opus_rc_put_raw(rc, sign, 1);",
          "new_line_content": "                    sign = x[0] < 0;",
          "content_same": false
        },
        {
          "line": 770,
          "old_api": "rec",
          "new_api": null,
          "old_text": "rec(pvq, f, rc, band, Y, NULL, N, sbits, blocks, next_lowband2,\n                         duration, NULL, next_level, gain * side, NULL, fill >> blocks)",
          "new_text": null,
          "old_line_content": "                cm = rec(pvq, f, rc, band, Y, NULL, N, sbits, blocks, next_lowband2,",
          "new_line_content": "                 * so no folding will be done to the side. */",
          "content_same": false
        },
        {
          "line": 515,
          "old_api": "ff_opus_rc_get_raw",
          "new_api": null,
          "old_text": "ff_opus_rc_get_raw(rc, 1)",
          "new_text": null,
          "old_line_content": "                    sign = ff_opus_rc_get_raw(rc, 1);",
          "new_line_content": "                } else {",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": "ff_opus_rc_dec_log",
          "new_api": null,
          "old_text": "ff_opus_rc_dec_log(rc, 2)",
          "new_text": null,
          "old_line_content": "                inv = (b > 2 << 3 && f->remaining2 > 2 << 3) ? ff_opus_rc_dec_log(rc, 2) : 0;",
          "new_line_content": "            } else {",
          "content_same": false
        },
        {
          "line": 902,
          "old_api": "OPUS_RC_CHECKPOINT_SPAWN",
          "new_api": null,
          "old_text": "OPUS_RC_CHECKPOINT_SPAWN(rc)",
          "new_text": null,
          "old_line_content": "    OPUS_RC_CHECKPOINT_SPAWN(rc);",
          "new_line_content": "    float *Y_orig = f->block[1].coeffs + (ff_celt_freq_bands[band] << f->size);",
          "content_same": false
        },
        {
          "line": 648,
          "old_api": "opus_rc_tell_frac",
          "new_api": null,
          "old_text": "opus_rc_tell_frac(rc)",
          "new_text": null,
          "old_line_content": "        qalloc = opus_rc_tell_frac(rc) - tell;",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 904,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(X, X_orig, band_size*sizeof(float))",
          "new_text": null,
          "old_line_content": "    memcpy(X, X_orig, band_size*sizeof(float));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": "FFABS",
          "new_api": null,
          "old_text": "FFABS(y[i])",
          "new_text": null,
          "old_line_content": "            const int y_new = y_norm  + 2*phase*FFABS(y[i]);",
          "new_line_content": "            const int ca = 1 ^ ((y[i] == 0) & (phase < 0));",
          "content_same": false
        },
        {
          "line": 779,
          "old_api": "rec",
          "new_api": null,
          "old_text": "rec(pvq, f, rc, band, X, NULL, N, mbits, blocks, lowband, duration,\n                          next_lowband_out1, next_level, stereo ? 1.0f : (gain * mid),\n                          lowband_scratch, fill)",
          "new_text": null,
          "old_line_content": "                cm |= rec(pvq, f, rc, band, X, NULL, N, mbits, blocks, lowband, duration,",
          "new_line_content": "                 * we need the normalized mid for folding later */",
          "content_same": false
        },
        {
          "line": 906,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(Y, Y_orig, band_size*sizeof(float))",
          "new_text": null,
          "old_line_content": "        memcpy(Y, Y_orig, band_size*sizeof(float));",
          "new_line_content": "    if (Y)",
          "content_same": false
        },
        {
          "line": 908,
          "old_api": "opus_rc_tell_frac",
          "new_api": null,
          "old_text": "opus_rc_tell_frac(rc)",
          "new_text": null,
          "old_line_content": "    f->remaining2 = ((f->framebits << 3) - f->anticollapse_needed) - opus_rc_tell_frac(rc) - 1;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 910,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(3, f->coded_bands - band)",
          "new_text": null,
          "old_line_content": "        int curr_balance = f->remaining / FFMIN(3, f->coded_bands - band);",
          "new_line_content": "    if (band <= f->coded_bands - 1) {",
          "content_same": false
        },
        {
          "line": 655,
          "old_api": "av_mod_uintp2",
          "new_api": null,
          "old_text": "av_mod_uintp2(fill, blocks)",
          "new_text": null,
          "old_line_content": "            fill = av_mod_uintp2(fill, blocks);",
          "new_line_content": "            iside = 0;",
          "content_same": false
        },
        {
          "line": 786,
          "old_api": "celt_bits2pulses",
          "new_api": null,
          "old_text": "celt_bits2pulses(cache, b)",
          "new_text": null,
          "old_line_content": "        uint32_t q         = celt_bits2pulses(cache, b);",
          "new_line_content": "        /* This is the basic no-split case */",
          "content_same": false
        },
        {
          "line": 915,
          "old_api": "encode_band",
          "new_api": null,
          "old_text": "pvq->encode_band(pvq, f, rc, band, X, NULL, band_size, b / 2, f->blocks, NULL,\n                         f->size, norm1, 0, 1.0f, lowband_scratch, cm[0])",
          "new_text": null,
          "old_line_content": "        pvq->encode_band(pvq, f, rc, band, X, NULL, band_size, b / 2, f->blocks, NULL,",
          "new_line_content": "    if (f->dual_stereo) {",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": "FFSIGN",
          "new_api": null,
          "old_text": "FFSIGN(X[max_idx])",
          "new_text": null,
          "old_line_content": "        phase *= FFSIGN(X[max_idx]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 918,
          "old_api": "encode_band",
          "new_api": null,
          "old_text": "pvq->encode_band(pvq, f, rc, band, Y, NULL, band_size, b / 2, f->blocks, NULL,\n                         f->size, norm2, 0, 1.0f, lowband_scratch, cm[1])",
          "new_text": null,
          "old_line_content": "        pvq->encode_band(pvq, f, rc, band, Y, NULL, band_size, b / 2, f->blocks, NULL,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 663,
          "old_api": "celt_cos",
          "new_api": null,
          "old_text": "celt_cos(itheta)",
          "new_text": null,
          "old_line_content": "            imid = celt_cos(itheta);",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 793,
          "old_api": "celt_pulses2bits",
          "new_api": null,
          "old_text": "celt_pulses2bits(cache, --q)",
          "new_text": null,
          "old_line_content": "            curr_bits      = celt_pulses2bits(cache, --q);",
          "new_line_content": "            f->remaining2 += curr_bits;",
          "content_same": false
        },
        {
          "line": 921,
          "old_api": "encode_band",
          "new_api": null,
          "old_text": "pvq->encode_band(pvq, f, rc, band, X, Y, band_size, b, f->blocks, NULL, f->size,\n                         norm1, 0, 1.0f, lowband_scratch, cm[0] | cm[1])",
          "new_text": null,
          "old_line_content": "        pvq->encode_band(pvq, f, rc, band, X, Y, band_size, b, f->blocks, NULL, f->size,",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": "celt_log2tan",
          "new_api": null,
          "old_text": "celt_log2tan(iside, imid)",
          "new_text": null,
          "old_line_content": "            delta = ROUND_MUL16((N - 1) << 7, celt_log2tan(iside, imid));",
          "new_line_content": "            in that band. */",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": "celt_haar1",
          "new_api": null,
          "old_text": "celt_haar1(quant ? X : lowband, N >> k, 1 << k)",
          "new_text": null,
          "old_line_content": "                celt_haar1(quant ? X : lowband, N >> k, 1 << k);",
          "new_line_content": "            if (quant || lowband)",
          "content_same": false
        },
        {
          "line": 800,
          "old_api": "celt_alg_quant",
          "new_api": null,
          "old_text": "celt_alg_quant(rc, X, N, (q < 8) ? q : (8 + (q & 7)) << ((q >> 3) - 1),\n                                    f->spread, blocks, gain, pvq)",
          "new_text": null,
          "old_line_content": "                cm = celt_alg_quant(rc, X, N, (q < 8) ? q : (8 + (q & 7)) << ((q >> 3) - 1),",
          "new_line_content": "            if (quant) {",
          "content_same": false
        },
        {
          "line": 930,
          "old_api": "sqrtf",
          "new_api": null,
          "old_text": "sqrtf(err_y)",
          "new_text": null,
          "old_line_content": "    dist = sqrtf(err_x) + sqrtf(err_y);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 803,
          "old_api": "celt_alg_unquant",
          "new_api": null,
          "old_text": "celt_alg_unquant(rc, X, N, (q < 8) ? q : (8 + (q & 7)) << ((q >> 3) - 1),\n                                      f->spread, blocks, gain, pvq)",
          "new_text": null,
          "old_line_content": "                cm = celt_alg_unquant(rc, X, N, (q < 8) ? q : (8 + (q & 7)) << ((q >> 3) - 1),",
          "new_line_content": "            } else {",
          "content_same": false
        },
        {
          "line": 420,
          "old_api": "celt_exp_rotation",
          "new_api": null,
          "old_text": "celt_exp_rotation(X, N, blocks, K, spread, 1)",
          "new_text": null,
          "old_line_content": "    celt_exp_rotation(X, N, blocks, K, spread, 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": "OPUS_RC_CHECKPOINT_ROLLBACK",
          "new_api": null,
          "old_text": "OPUS_RC_CHECKPOINT_ROLLBACK(rc)",
          "new_text": null,
          "old_line_content": "    OPUS_RC_CHECKPOINT_ROLLBACK(rc);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": "celt_haar1",
          "new_api": null,
          "old_text": "celt_haar1(quant ? X : lowband, N_B, blocks)",
          "new_text": null,
          "old_line_content": "                celt_haar1(quant ? X : lowband, N_B, blocks);",
          "new_line_content": "            if (quant || lowband)",
          "content_same": false
        },
        {
          "line": 941,
          "old_api": "av_malloc",
          "new_api": null,
          "old_text": "av_malloc(sizeof(CeltPVQ))",
          "new_text": null,
          "old_line_content": "    CeltPVQ *s = av_malloc(sizeof(CeltPVQ));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 814,
          "old_api": "celt_rng",
          "new_api": null,
          "old_text": "celt_rng(f)",
          "new_text": null,
          "old_line_content": "                        X[i] = (((int32_t)celt_rng(f)) >> 20);",
          "new_line_content": "                    for (i = 0; i < N; i++)",
          "content_same": false
        },
        {
          "line": 943,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "        return AVERROR(ENOMEM);",
          "new_line_content": "    if (!s)",
          "content_same": false
        },
        {
          "line": 564,
          "old_api": "celt_deinterleave_hadamard",
          "new_api": null,
          "old_text": "celt_deinterleave_hadamard(pvq->hadamard_tmp, quant ? X : lowband,\n                                       N_B >> recombine, B0 << recombine,\n                                       longblocks)",
          "new_text": null,
          "old_line_content": "            celt_deinterleave_hadamard(pvq->hadamard_tmp, quant ? X : lowband,",
          "new_line_content": "        if (B0 > 1 && (quant || lowband))",
          "content_same": false
        },
        {
          "line": 693,
          "old_api": "ff_opus_rc_put_raw",
          "new_api": null,
          "old_text": "ff_opus_rc_put_raw(rc, sign, 1)",
          "new_text": null,
          "old_line_content": "                    ff_opus_rc_put_raw(rc, sign, 1);",
          "new_line_content": "                    sign = x2[0]*y2[1] - x2[1]*y2[0] < 0;",
          "content_same": false
        },
        {
          "line": 820,
          "old_api": "celt_rng",
          "new_api": null,
          "old_text": "celt_rng(f)",
          "new_text": null,
          "old_line_content": "                        X[i] = lowband[i] + (((celt_rng(f)) & 0x8000) ? 1.0f / 256 : -1.0f / 256);",
          "new_line_content": "                        /* About 48 dB below the \"normal\" folding level */",
          "content_same": false
        },
        {
          "line": 695,
          "old_api": "ff_opus_rc_get_raw",
          "new_api": null,
          "old_text": "ff_opus_rc_get_raw(rc, 1)",
          "new_text": null,
          "old_line_content": "                    sign = ff_opus_rc_get_raw(rc, 1);",
          "new_line_content": "                } else {",
          "content_same": false
        },
        {
          "line": 824,
          "old_api": "celt_renormalize_vector",
          "new_api": null,
          "old_text": "celt_renormalize_vector(X, N, gain)",
          "new_text": null,
          "old_line_content": "                celt_renormalize_vector(X, N, gain);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 436,
          "old_api": "celt_decode_pulses",
          "new_api": null,
          "old_text": "celt_decode_pulses(rc, y, N, K)",
          "new_text": null,
          "old_line_content": "    gain /= sqrtf(celt_decode_pulses(rc, y, N, K));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 826,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(X, 0, N*sizeof(float))",
          "new_text": null,
          "old_line_content": "                memset(X, 0, N*sizeof(float));",
          "new_line_content": "            } else {",
          "content_same": false
        },
        {
          "line": 951,
          "old_api": "ff_opus_dsp_init_x86",
          "new_api": null,
          "old_text": "ff_opus_dsp_init_x86(s)",
          "new_text": null,
          "old_line_content": "        ff_opus_dsp_init_x86(s);",
          "new_line_content": "    if (ARCH_X86)",
          "content_same": false
        },
        {
          "line": 701,
          "old_api": "rec",
          "new_api": null,
          "old_text": "rec(pvq, f, rc, band, x2, NULL, N, mbits, blocks, lowband, duration,\n                     lowband_out, level, gain, lowband_scratch, orig_fill)",
          "new_text": null,
          "old_line_content": "            cm = rec(pvq, f, rc, band, x2, NULL, N, mbits, blocks, lowband, duration,",
          "new_line_content": "            itheta==16384, we'll have cleared the low bits of fill. */",
          "content_same": false
        },
        {
          "line": 960,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(pvq)",
          "new_text": null,
          "old_line_content": "    av_freep(pvq);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 834,
          "old_api": "celt_stereo_merge",
          "new_api": null,
          "old_text": "celt_stereo_merge(X, Y, mid, N)",
          "new_text": null,
          "old_line_content": "            celt_stereo_merge(X, Y, mid, N);",
          "new_line_content": "        if (N > 2)",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": "celt_calc_theta",
          "new_api": null,
          "old_text": "celt_calc_theta(X, Y, stereo, N)",
          "new_text": null,
          "old_line_content": "        int itheta = quant ? celt_calc_theta(X, Y, stereo, N) : 0;",
          "new_line_content": "        int qn;",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": "sqrtf",
          "new_api": null,
          "old_text": "sqrtf(e[0])",
          "new_text": null,
          "old_line_content": "    return lrintf(32768.0f*atan2f(sqrtf(e[1]), sqrtf(e[0]))/M_PI);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 844,
          "old_api": "celt_interleave_hadamard",
          "new_api": null,
          "old_text": "celt_interleave_hadamard(pvq->hadamard_tmp, X, N_B >> recombine,\n                                     B0 << recombine, longblocks)",
          "new_text": null,
          "old_line_content": "            celt_interleave_hadamard(pvq->hadamard_tmp, X, N_B >> recombine,",
          "new_line_content": "        if (B0 > 1)",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "sqrtf",
          "new_api": null,
          "old_text": "sqrtf(e_l*e_l + e_r*e_r)",
          "new_text": null,
          "old_line_content": "    const float energy_n = 1.0f/(sqrtf(e_l*e_l + e_r*e_r) + FLT_EPSILON);",
          "new_line_content": "    int i;",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "celt_compute_qn",
          "new_api": null,
          "old_text": "celt_compute_qn(N, b, offset, pulse_cap, stereo)",
          "new_text": null,
          "old_line_content": "             celt_compute_qn(N, b, offset, pulse_cap, stereo);",
          "new_line_content": "        qn = (stereo && band >= f->intensity_stereo) ? 1 :",
          "content_same": false
        },
        {
          "line": 854,
          "old_api": "celt_haar1",
          "new_api": null,
          "old_text": "celt_haar1(X, N_B, blocks)",
          "new_text": null,
          "old_line_content": "            celt_haar1(X, N_B, blocks);",
          "new_line_content": "            cm |= cm >> blocks;",
          "content_same": false
        },
        {
          "line": 859,
          "old_api": "celt_haar1",
          "new_api": null,
          "old_text": "celt_haar1(X, N0>>k, 1<<k)",
          "new_text": null,
          "old_line_content": "            celt_haar1(X, N0>>k, 1<<k);",
          "new_line_content": "            cm = ff_celt_bit_deinterleave[cm];",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": "ff_opus_rc_enc_uint_step",
          "new_api": null,
          "old_text": "ff_opus_rc_enc_uint_step(rc, itheta, qn / 2)",
          "new_text": null,
          "old_line_content": "                    ff_opus_rc_enc_uint_step(rc, itheta, qn / 2);",
          "new_line_content": "                if (stereo && N > 2)",
          "content_same": false
        },
        {
          "line": 734,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(0, delta + (N << 3 >> (5 - duration)))",
          "new_text": null,
          "old_line_content": "                    delta = FFMIN(0, delta + (N << 3 >> (5 - duration)));",
          "new_line_content": "                     * 1.5 dB per 10 ms */",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": "ff_opus_rc_enc_uint",
          "new_api": null,
          "old_text": "ff_opus_rc_enc_uint(rc, itheta, qn + 1)",
          "new_text": null,
          "old_line_content": "                    ff_opus_rc_enc_uint(rc, itheta, qn + 1);",
          "new_line_content": "                else if (stereo || B0 > 1)",
          "content_same": false
        },
        {
          "line": 736,
          "old_api": "av_clip",
          "new_api": null,
          "old_text": "av_clip((b - delta) / 2, 0, b)",
          "new_text": null,
          "old_line_content": "            mbits = av_clip((b - delta) / 2, 0, b);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 610,
          "old_api": "ff_opus_rc_enc_uint_tri",
          "new_api": null,
          "old_text": "ff_opus_rc_enc_uint_tri(rc, itheta, qn)",
          "new_text": null,
          "old_line_content": "                    ff_opus_rc_enc_uint_tri(rc, itheta, qn);",
          "new_line_content": "                else",
          "content_same": false
        },
        {
          "line": 865,
          "old_api": "sqrtf",
          "new_api": null,
          "old_text": "sqrtf(N0)",
          "new_text": null,
          "old_line_content": "            float n = sqrtf(N0);",
          "new_line_content": "        if (lowband_out) {",
          "content_same": false
        },
        {
          "line": 869,
          "old_api": "av_mod_uintp2",
          "new_api": null,
          "old_text": "av_mod_uintp2(cm, blocks)",
          "new_text": null,
          "old_line_content": "        cm = av_mod_uintp2(cm, blocks);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 614,
          "old_api": "celt_stereo_is_decouple",
          "new_api": null,
          "old_text": "celt_stereo_is_decouple(X, Y, f->block[0].lin_energy[band],\n                                                f->block[1].lin_energy[band], N)",
          "new_text": null,
          "old_line_content": "                        celt_stereo_is_decouple(X, Y, f->block[0].lin_energy[band],",
          "new_line_content": "                    if (itheta == 0)",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": "celt_stereo_ms_decouple",
          "new_api": null,
          "old_text": "celt_stereo_ms_decouple(X, Y, N)",
          "new_text": null,
          "old_line_content": "                        celt_stereo_ms_decouple(X, Y, N);",
          "new_line_content": "                    else",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": "ff_opus_rc_dec_uint_step",
          "new_api": null,
          "old_text": "ff_opus_rc_dec_uint_step(rc, qn / 2)",
          "new_text": null,
          "old_line_content": "                    itheta = ff_opus_rc_dec_uint_step(rc, qn / 2);",
          "new_line_content": "                if (stereo && N > 2)",
          "content_same": false
        },
        {
          "line": 878,
          "old_api": "quant_band_template",
          "new_api": null,
          "old_text": "quant_band_template(pvq, f, rc, band, X, Y, N, b, blocks, lowband, duration,\n                               lowband_out, level, gain, lowband_scratch, fill, 0,\n                               pvq->decode_band)",
          "new_text": null,
          "old_line_content": "    return quant_band_template(pvq, f, rc, band, X, Y, N, b, blocks, lowband, duration,",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 623,
          "old_api": "ff_opus_rc_dec_uint",
          "new_api": null,
          "old_text": "ff_opus_rc_dec_uint(rc, qn+1)",
          "new_text": null,
          "old_line_content": "                    itheta = ff_opus_rc_dec_uint(rc, qn+1);",
          "new_line_content": "                else if (stereo || B0 > 1)",
          "content_same": false
        },
        {
          "line": 625,
          "old_api": "ff_opus_rc_dec_uint_tri",
          "new_api": null,
          "old_text": "ff_opus_rc_dec_uint_tri(rc, qn)",
          "new_text": null,
          "old_line_content": "                    itheta = ff_opus_rc_dec_uint_tri(rc, qn);",
          "new_line_content": "                else",
          "content_same": false
        },
        {
          "line": 754,
          "old_api": "rec",
          "new_api": null,
          "old_text": "rec(pvq, f, rc, band, X, NULL, N, mbits, blocks, lowband,\n                         duration, next_lowband_out1, next_level,\n                         stereo ? 1.0f : (gain * mid), lowband_scratch, fill)",
          "new_text": null,
          "old_line_content": "                cm = rec(pvq, f, rc, band, X, NULL, N, mbits, blocks, lowband,",
          "new_line_content": "                 * because we need the normalized mid for folding later */",
          "content_same": false
        },
        {
          "line": 885,
          "old_api": "quant_band_template",
          "new_api": null,
          "old_text": "quant_band_template(pvq, f, rc, band, X, Y, N, b, blocks, lowband, duration,\n                               lowband_out, level, gain, lowband_scratch, fill, 1,\n                               pvq->encode_band)",
          "new_text": null,
          "old_line_content": "    return quant_band_template(pvq, f, rc, band, X, Y, N, b, blocks, lowband, duration,",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 635,
          "old_api": "celt_stereo_is_decouple",
          "new_api": null,
          "old_text": "celt_stereo_is_decouple(X, Y, f->block[0].lin_energy[band],\n                                         f->block[1].lin_energy[band], N)",
          "new_text": null,
          "old_line_content": "                 celt_stereo_is_decouple(X, Y, f->block[0].lin_energy[band],",
          "new_line_content": "                 }",
          "content_same": false
        },
        {
          "line": 763,
          "old_api": "rec",
          "new_api": null,
          "old_text": "rec(pvq, f, rc, band, Y, NULL, N, sbits, blocks, next_lowband2,\n                          duration, NULL, next_level, gain * side, NULL,\n                          fill >> blocks)",
          "new_text": null,
          "old_line_content": "                cmt = rec(pvq, f, rc, band, Y, NULL, N, sbits, blocks, next_lowband2,",
          "new_line_content": "                 * so no folding will be done to the side. */",
          "content_same": false
        },
        {
          "line": 639,
          "old_api": "ff_opus_rc_enc_log",
          "new_api": null,
          "old_text": "ff_opus_rc_enc_log(rc, inv, 2)",
          "new_text": null,
          "old_line_content": "                    ff_opus_rc_enc_log(rc, inv, 2);",
          "new_line_content": "                if (b > 2 << 3 && f->remaining2 > 2 << 3) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 11,
      "total_additions": 67,
      "total_deletions": 67,
      "total_api_changes": 145
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 145,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          384,
          386
        ]
      }
    },
    "api_calls_before": 124,
    "api_calls_after": 124,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 1,
      "total_diff_lines": 16
    }
  }
}