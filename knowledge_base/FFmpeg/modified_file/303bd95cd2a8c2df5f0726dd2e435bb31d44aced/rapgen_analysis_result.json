{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/303bd95cd2a8c2df5f0726dd2e435bb31d44aced",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/303bd95cd2a8c2df5f0726dd2e435bb31d44aced/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/303bd95cd2a8c2df5f0726dd2e435bb31d44aced/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/303bd95cd2a8c2df5f0726dd2e435bb31d44aced/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 321,
          "old_api": "rand",
          "new_api": "av_log",
          "old_text": "rand()",
          "new_text": "av_log(NULL, AV_LOG_DEBUG, \"%d %d %d\\n\", c->dst_incr, c->ideal_dst_incr, c->compensation_distance)",
          "old_line_content": "        av_resample_compensate(c, rand() % (8000*2) - 8000, 8000*2);",
          "new_line_content": "av_log(NULL, AV_LOG_DEBUG, \"%d %d %d\\n\", c->dst_incr, c->ideal_dst_incr, c->compensation_distance);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 304,
          "old_api": null,
          "new_api": "FFMAX",
          "old_text": null,
          "new_text": "FFMAX(index, 0)",
          "old_line_content": "  }",
          "new_line_content": "    *consumed= FFMAX(index, 0) >> c->phase_shift;",
          "content_same": false
        },
        {
          "line": 320,
          "old_api": null,
          "new_api": "rand",
          "old_text": null,
          "new_text": "rand()",
          "old_line_content": "#undef rand",
          "new_line_content": "        av_resample_compensate(c, rand() % (8000*2) - 8000, 8000*2);",
          "content_same": false
        },
        {
          "line": 284,
          "old_api": null,
          "new_api": "lrintf",
          "old_text": null,
          "new_text": "lrintf(val)",
          "old_line_content": "#ifdef CONFIG_RESAMPLE_AUDIOPHILE_KIDDY_MODE",
          "new_line_content": "        dst[dst_index] = av_clip(lrintf(val), -32768, 32767);",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(compensation_distance > 0)",
          "old_line_content": "        compensation_distance -= dst_index;",
          "new_line_content": "        assert(compensation_distance > 0);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 305,
          "old_api": "FFMAX",
          "new_api": null,
          "old_text": "FFMAX(index, 0)",
          "new_text": null,
          "old_line_content": "    *consumed= FFMAX(index, 0) >> c->phase_shift;",
          "new_line_content": "    if(index>=0) index &= c->phase_mask;",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(NULL, AV_LOG_DEBUG, \"%d %d %d\\n\", c->dst_incr, c->ideal_dst_incr, c->compensation_distance)",
          "new_text": null,
          "old_line_content": "av_log(NULL, AV_LOG_DEBUG, \"%d %d %d\\n\", c->dst_incr, c->ideal_dst_incr, c->compensation_distance);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 285,
          "old_api": "lrintf",
          "new_api": null,
          "old_text": "lrintf(val)",
          "new_text": null,
          "old_line_content": "        dst[dst_index] = av_clip(lrintf(val), -32768, 32767);",
          "new_line_content": "#else",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(compensation_distance > 0)",
          "new_text": null,
          "old_line_content": "        assert(compensation_distance > 0);",
          "new_line_content": "    }",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 1,
      "total_additions": 4,
      "total_deletions": 4,
      "total_api_changes": 9
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 9,
        "non_api_lines": 7,
        "non_api_line_numbers": [
          271,
          272,
          273,
          274,
          275,
          276,
          277
        ]
      }
    },
    "api_calls_before": 36,
    "api_calls_after": 36,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 5,
      "total_diff_lines": 23
    }
  }
}