{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/9600486d10a9728f1503363334268ecfafa9b0e5",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/9600486d10a9728f1503363334268ecfafa9b0e5/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/9600486d10a9728f1503363334268ecfafa9b0e5/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/9600486d10a9728f1503363334268ecfafa9b0e5/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 241,
          "old_api": "flush_buffer",
          "new_api": "seek",
          "old_text": "flush_buffer(s)",
          "new_text": "s->seek(s->opaque, pos, SEEK_SET)",
          "old_line_content": "            flush_buffer(s);",
          "new_line_content": "        if ((res = s->seek(s->opaque, pos, SEEK_SET)) < 0)",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": "AVERROR",
          "new_api": "avio_seek",
          "old_text": "AVERROR(ENOSYS)",
          "new_text": "avio_seek(s, offset, SEEK_CUR)",
          "old_line_content": "        return AVERROR(ENOSYS);",
          "new_line_content": "    return avio_seek(s, offset, SEEK_CUR);",
          "content_same": false
        },
        {
          "line": 288,
          "old_api": "fill_buffer",
          "new_api": "seek",
          "old_text": "fill_buffer(s)",
          "new_text": "s->seek(s->opaque, s->pos, SEEK_SET)",
          "old_line_content": "        fill_buffer(s);",
          "new_line_content": "        s->seek(s->opaque, s->pos, SEEK_SET);",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": "avio_write",
          "new_api": "avio_w8",
          "old_text": "avio_write(s, (const unsigned char *) str, len)",
          "new_text": "avio_w8(s,           val >> 24 )",
          "old_line_content": "        avio_write(s, (const unsigned char *) str, len);",
          "new_line_content": "    avio_w8(s,           val >> 24 );",
          "content_same": false
        },
        {
          "line": 367,
          "old_api": "avio_wl32",
          "new_api": "ff_get_v_length",
          "old_text": "avio_wl32(s, (uint32_t)(val >> 32))",
          "new_text": "ff_get_v_length(val)",
          "old_line_content": "    avio_wl32(s, (uint32_t)(val >> 32));",
          "new_line_content": "    int i = ff_get_v_length(val);",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": "avio_wb32",
          "new_api": "avio_w8",
          "old_text": "avio_wb32(s, (uint32_t)(val >> 32))",
          "new_text": "avio_w8(bc, val & 127)",
          "old_line_content": "    avio_wb32(s, (uint32_t)(val >> 32));",
          "new_line_content": "    avio_w8(bc, val & 127);",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": "avio_w8",
          "new_api": "avio_wl32",
          "old_text": "avio_w8(s, (uint8_t)val)",
          "new_text": "avio_wl32(s, (uint32_t)(val >> 32))",
          "old_line_content": "    avio_w8(s, (uint8_t)val);",
          "new_line_content": "    avio_wl32(s, (uint32_t)(val >> 32));",
          "content_same": false
        },
        {
          "line": 384,
          "old_api": "avio_w8",
          "new_api": "avio_wb32",
          "old_text": "avio_w8(s, (int)val >> 8)",
          "new_text": "avio_wb32(s, (uint32_t)(val & 0xffffffff))",
          "old_line_content": "    avio_w8(s, (int)val >> 8);",
          "new_line_content": "    avio_wb32(s, (uint32_t)(val & 0xffffffff));",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": "avio_wl16",
          "new_api": "avio_w8",
          "old_text": "avio_wl16(s, val & 0xffff)",
          "new_text": "avio_w8(s, (int)val >> 8)",
          "old_line_content": "    avio_wl16(s, val & 0xffff);",
          "new_line_content": "    avio_w8(s, (int)val >> 8);",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": "avio_wb16",
          "new_api": "avio_w8",
          "old_text": "avio_wb16(s, (int)val >> 8)",
          "new_text": "avio_w8(s, (uint8_t)val)",
          "old_line_content": "    avio_wb16(s, (int)val >> 8);",
          "new_line_content": "    avio_w8(s, (uint8_t)val);",
          "content_same": false
        },
        {
          "line": 647,
          "old_api": "avio_r8",
          "new_api": "avio_rb16",
          "old_text": "avio_r8(s)",
          "new_text": "avio_rb16(s)",
          "old_line_content": "        c = avio_r8(s);",
          "new_line_content": "    val = avio_rb16(s) << 16;",
          "content_same": false
        },
        {
          "line": 777,
          "old_api": "av_malloc",
          "new_api": "av_free",
          "old_text": "av_malloc(buf_size)",
          "new_text": "av_free(s->buffer)",
          "old_line_content": "    buffer = av_malloc(buf_size);",
          "new_line_content": "    av_free(s->buffer);",
          "content_same": false
        },
        {
          "line": 889,
          "old_api": "avio_close",
          "new_api": "av_freep",
          "old_text": "avio_close(*s)",
          "new_text": "av_freep(&s->buffer)",
          "old_line_content": "    int ret = avio_close(*s);",
          "new_line_content": "    av_freep(&s->buffer);",
          "content_same": false
        },
        {
          "line": 900,
          "old_api": "va_start",
          "new_api": "avio_close",
          "old_text": "va_start(ap, fmt)",
          "new_text": "avio_close(*s)",
          "old_line_content": "    va_start(ap, fmt);",
          "new_line_content": "    int ret = avio_close(*s);",
          "content_same": false
        },
        {
          "line": 911,
          "old_api": "read_pause",
          "new_api": "va_start",
          "old_text": "s->read_pause(s->opaque, pause)",
          "new_text": "va_start(ap, fmt)",
          "old_line_content": "    return s->read_pause(s->opaque, pause);",
          "new_line_content": "    va_start(ap, fmt);",
          "content_same": false
        },
        {
          "line": 921,
          "old_api": "read_seek",
          "new_api": "AVERROR",
          "old_text": "s->read_seek(h, stream_index, timestamp, flags)",
          "new_text": "AVERROR(ENOSYS)",
          "old_line_content": "    ret = s->read_seek(h, stream_index, timestamp, flags);",
          "new_line_content": "        return AVERROR(ENOSYS);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 512,
          "old_api": null,
          "new_api": "read_packet",
          "old_text": null,
          "new_text": "s->read_packet(s->opaque, buf, size)",
          "old_line_content": "                    size -= len;",
          "new_line_content": "                    len = s->read_packet(s->opaque, buf, size);",
          "content_same": false
        },
        {
          "line": 1025,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "}",
          "new_line_content": "        return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1027,
          "old_api": null,
          "new_api": "avio_alloc_context",
          "old_text": null,
          "new_text": "avio_alloc_context(d->io_buffer, d->io_buffer_size, 1, d, NULL,\n                            max_packet_size ? dyn_packet_buf_write : dyn_buf_write,\n                            max_packet_size ? NULL : dyn_buf_seek)",
          "old_line_content": "int avio_open_dyn_buf(AVIOContext **s)",
          "new_line_content": "    *s = avio_alloc_context(d->io_buffer, d->io_buffer_size, 1, d, NULL,",
          "content_same": false
        },
        {
          "line": 1031,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(d)",
          "old_line_content": "",
          "new_line_content": "        av_free(d);",
          "content_same": false
        },
        {
          "line": 1032,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "int ffio_open_dyn_packet_buf(AVIOContext **s, int max_packet_size)",
          "new_line_content": "        return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 1040,
          "old_api": null,
          "new_api": "url_open_dyn_buf_internal",
          "old_text": null,
          "new_text": "url_open_dyn_buf_internal(s, 0)",
          "old_line_content": "{",
          "new_line_content": "    return url_open_dyn_buf_internal(s, 0);",
          "content_same": false
        },
        {
          "line": 529,
          "old_api": null,
          "new_api": "fill_buffer",
          "old_text": null,
          "new_text": "fill_buffer(s)",
          "old_line_content": "    }",
          "new_line_content": "                fill_buffer(s);",
          "content_same": false
        },
        {
          "line": 1047,
          "old_api": null,
          "new_api": "url_open_dyn_buf_internal",
          "old_text": null,
          "new_text": "url_open_dyn_buf_internal(s, max_packet_size)",
          "old_line_content": "        *pbuffer = NULL;",
          "new_line_content": "    return url_open_dyn_buf_internal(s, max_packet_size);",
          "content_same": false
        },
        {
          "line": 535,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(buf, s->buf_ptr, len)",
          "old_line_content": "}",
          "new_line_content": "            memcpy(buf, s->buf_ptr, len);",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": null,
          "new_api": "url_feof",
          "old_text": null,
          "new_text": "url_feof(s)",
          "old_line_content": "    } else {",
          "new_line_content": "        if (url_feof(s))   return AVERROR_EOF;",
          "content_same": false
        },
        {
          "line": 1065,
          "old_api": null,
          "new_api": "avio_write",
          "old_text": null,
          "new_text": "avio_write(s, padbuf, sizeof(padbuf))",
          "old_line_content": "}",
          "new_line_content": "        avio_write(s, padbuf, sizeof(padbuf));",
          "content_same": false
        },
        {
          "line": 556,
          "old_api": null,
          "new_api": "avio_read",
          "old_text": null,
          "new_text": "avio_read(s, buf, size)",
          "old_line_content": "    if (s->read_packet && s->write_flag) {",
          "new_line_content": "        return avio_read(s, buf, size);",
          "content_same": false
        },
        {
          "line": 1069,
          "old_api": null,
          "new_api": "avio_flush",
          "old_text": null,
          "new_text": "avio_flush(s)",
          "old_line_content": "    DynBuffer *d = opaque;",
          "new_line_content": "    avio_flush(s);",
          "content_same": false
        },
        {
          "line": 1073,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(d)",
          "old_line_content": "        d->size = d->pos;",
          "new_line_content": "    av_free(d);",
          "content_same": false
        },
        {
          "line": 1074,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(s)",
          "old_line_content": "    return buf_size;",
          "new_line_content": "    av_free(s);",
          "content_same": false
        },
        {
          "line": 568,
          "old_api": null,
          "new_api": "read_packet",
          "old_text": null,
          "new_text": "s->read_packet(s->opaque, buf, size)",
          "old_line_content": "         * This avoids returning partial packets at the end of the buffer,",
          "new_line_content": "        len = s->read_packet(s->opaque, buf, size);",
          "content_same": false
        },
        {
          "line": 1090,
          "old_api": null,
          "new_api": "url_open_dyn_buf_internal",
          "old_text": null,
          "new_text": "url_open_dyn_buf_internal(s, 0)",
          "old_line_content": "    int size;",
          "new_line_content": "    int ret = url_open_dyn_buf_internal(s, 0);",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": null,
          "new_api": "fill_buffer",
          "old_text": null,
          "new_text": "fill_buffer(s)",
          "old_line_content": "    return len;",
          "new_line_content": "        fill_buffer(s);",
          "content_same": false
        },
        {
          "line": 588,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(buf, s->buf_ptr, len)",
          "old_line_content": "    unsigned int val;",
          "new_line_content": "    memcpy(buf, s->buf_ptr, len);",
          "content_same": false
        },
        {
          "line": 1103,
          "old_api": null,
          "new_api": "avio_flush",
          "old_text": null,
          "new_text": "avio_flush(s)",
          "old_line_content": "",
          "new_line_content": "    avio_flush(s);",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": null,
          "new_api": "url_feof",
          "old_text": null,
          "new_text": "url_feof(s)",
          "old_line_content": "}",
          "new_line_content": "        if (url_feof(s))   return AVERROR_EOF;",
          "content_same": false
        },
        {
          "line": 1106,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(d)",
          "old_line_content": "",
          "new_line_content": "    av_free(d);",
          "content_same": false
        },
        {
          "line": 1107,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(s)",
          "old_line_content": "",
          "new_line_content": "    av_free(s);",
          "content_same": false
        },
        {
          "line": 600,
          "old_api": null,
          "new_api": "avio_r8",
          "old_text": null,
          "new_text": "avio_r8(s)",
          "old_line_content": "}",
          "new_line_content": "    val = avio_r8(s);",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": null,
          "new_api": "avio_r8",
          "old_text": null,
          "new_text": "avio_r8(s)",
          "old_line_content": "",
          "new_line_content": "    val |= avio_r8(s) << 8;",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "avio_rl16",
          "old_text": null,
          "new_text": "avio_rl16(s)",
          "old_line_content": "}",
          "new_line_content": "    val = avio_rl16(s);",
          "content_same": false
        },
        {
          "line": 609,
          "old_api": null,
          "new_api": "avio_r8",
          "old_text": null,
          "new_text": "avio_r8(s)",
          "old_line_content": "",
          "new_line_content": "    val |= avio_r8(s) << 16;",
          "content_same": false
        },
        {
          "line": 616,
          "old_api": null,
          "new_api": "avio_rl16",
          "old_text": null,
          "new_text": "avio_rl16(s)",
          "old_line_content": "}",
          "new_line_content": "    val = avio_rl16(s);",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": null,
          "new_api": "avio_rl16",
          "old_text": null,
          "new_text": "avio_rl16(s)",
          "old_line_content": "",
          "new_line_content": "    val |= avio_rl16(s) << 16;",
          "content_same": false
        },
        {
          "line": 624,
          "old_api": null,
          "new_api": "avio_rl32",
          "old_text": null,
          "new_text": "avio_rl32(s)",
          "old_line_content": "}",
          "new_line_content": "    val = (uint64_t)avio_rl32(s);",
          "content_same": false
        },
        {
          "line": 625,
          "old_api": null,
          "new_api": "avio_rl32",
          "old_text": null,
          "new_text": "avio_rl32(s)",
          "old_line_content": "",
          "new_line_content": "    val |= (uint64_t)avio_rl32(s) << 32;",
          "content_same": false
        },
        {
          "line": 632,
          "old_api": null,
          "new_api": "avio_r8",
          "old_text": null,
          "new_text": "avio_r8(s)",
          "old_line_content": "}",
          "new_line_content": "    val = avio_r8(s) << 8;",
          "content_same": false
        },
        {
          "line": 633,
          "old_api": null,
          "new_api": "avio_r8",
          "old_text": null,
          "new_text": "avio_r8(s)",
          "old_line_content": "unsigned int avio_rb32(AVIOContext *s)",
          "new_line_content": "    val |= avio_r8(s);",
          "content_same": false
        },
        {
          "line": 640,
          "old_api": null,
          "new_api": "avio_rb16",
          "old_text": null,
          "new_text": "avio_rb16(s)",
          "old_line_content": "",
          "new_line_content": "    val = avio_rb16(s) << 8;",
          "content_same": false
        },
        {
          "line": 641,
          "old_api": null,
          "new_api": "avio_r8",
          "old_text": null,
          "new_text": "avio_r8(s)",
          "old_line_content": "int ff_get_line(AVIOContext *s, char *buf, int maxlen)",
          "new_line_content": "    val |= avio_r8(s);",
          "content_same": false
        },
        {
          "line": 648,
          "old_api": null,
          "new_api": "avio_rb16",
          "old_text": null,
          "new_text": "avio_rb16(s)",
          "old_line_content": "        if (c && i < maxlen-1)",
          "new_line_content": "    val |= avio_rb16(s);",
          "content_same": false
        },
        {
          "line": 658,
          "old_api": null,
          "new_api": "avio_r8",
          "old_text": null,
          "new_text": "avio_r8(s)",
          "old_line_content": "    int i;",
          "new_line_content": "        c = avio_r8(s);",
          "content_same": false
        },
        {
          "line": 672,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(EINVAL)",
          "old_line_content": "}",
          "new_line_content": "        return AVERROR(EINVAL);",
          "content_same": false
        },
        {
          "line": 674,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(buflen - 1, maxlen)",
          "old_line_content": "#define GET_STR16(type, read) \\",
          "new_line_content": "    buflen = FFMIN(buflen - 1, maxlen);",
          "content_same": false
        },
        {
          "line": 676,
          "old_api": null,
          "new_api": "avio_r8",
          "old_text": null,
          "new_text": "avio_r8(s)",
          "old_line_content": "{\\",
          "new_line_content": "        if (!(buf[i] = avio_r8(s)))",
          "content_same": false
        },
        {
          "line": 680,
          "old_api": null,
          "new_api": "avio_r8",
          "old_text": null,
          "new_text": "avio_r8(s)",
          "old_line_content": "        return AVERROR(EINVAL); \\",
          "new_line_content": "        if (!avio_r8(s))",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": null,
          "new_api": "GET_STR16",
          "old_text": null,
          "new_text": "GET_STR16(le, avio_rl16)",
          "old_line_content": "}",
          "new_line_content": "GET_STR16(le, avio_rl16)",
          "content_same": false
        },
        {
          "line": 705,
          "old_api": null,
          "new_api": "GET_STR16",
          "old_text": null,
          "new_text": "GET_STR16(be, avio_rb16)",
          "old_line_content": "",
          "new_line_content": "GET_STR16(be, avio_rb16)",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": null,
          "new_api": "avio_rb32",
          "old_text": null,
          "new_text": "avio_rb32(s)",
          "old_line_content": "        val= (val<<7) + (tmp&127);",
          "new_line_content": "    val = (uint64_t)avio_rb32(s) << 32;",
          "content_same": false
        },
        {
          "line": 713,
          "old_api": null,
          "new_api": "avio_rb32",
          "old_text": null,
          "new_text": "avio_rb32(s)",
          "old_line_content": "    }while(tmp&128);",
          "new_line_content": "    val |= (uint64_t)avio_rb32(s);",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": null,
          "new_api": "avio_r8",
          "old_text": null,
          "new_text": "avio_r8(bc)",
          "old_line_content": "    max_packet_size = h->max_packet_size;",
          "new_line_content": "        tmp = avio_r8(bc);",
          "content_same": false
        },
        {
          "line": 739,
          "old_api": null,
          "new_api": "av_malloc",
          "old_text": null,
          "new_text": "av_malloc(buffer_size)",
          "old_line_content": "    (*s)->seekable = h->is_streamed ? 0 : AVIO_SEEKABLE_NORMAL;",
          "new_line_content": "    buffer = av_malloc(buffer_size);",
          "content_same": false
        },
        {
          "line": 741,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "    if(h->prot) {",
          "new_line_content": "        return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 743,
          "old_api": null,
          "new_api": "avio_alloc_context",
          "old_text": null,
          "new_text": "avio_alloc_context(buffer, buffer_size, h->flags & AVIO_FLAG_WRITE, h,\n                            (void*)ffurl_read, (void*)ffurl_write, (void*)ffurl_seek)",
          "old_line_content": "        (*s)->read_seek  = (int64_t (*)(void *, int, int64_t, int))h->prot->url_read_seek;",
          "new_line_content": "    *s = avio_alloc_context(buffer, buffer_size, h->flags & AVIO_FLAG_WRITE, h,",
          "content_same": false
        },
        {
          "line": 746,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(buffer)",
          "old_line_content": "    return 0;",
          "new_line_content": "        av_free(buffer);",
          "content_same": false
        },
        {
          "line": 747,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "}",
          "new_line_content": "        return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(buffer_size>>1, pos)",
          "old_line_content": "        if (s->write_flag) {",
          "new_line_content": "        pos -= FFMIN(buffer_size>>1, pos);",
          "content_same": false
        },
        {
          "line": 247,
          "old_api": null,
          "new_api": "fill_buffer",
          "old_text": null,
          "new_text": "fill_buffer(s)",
          "old_line_content": "            return res;",
          "new_line_content": "        fill_buffer(s);",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": null,
          "new_api": "avio_seek",
          "old_text": null,
          "new_text": "avio_seek(s, offset, SEEK_SET | force)",
          "old_line_content": "        s->seek_count ++;",
          "new_line_content": "        return avio_seek(s, offset, SEEK_SET | force);",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": null,
          "new_api": "flush_buffer",
          "old_text": null,
          "new_text": "flush_buffer(s)",
          "old_line_content": "        s->pos = offset;",
          "new_line_content": "            flush_buffer(s);",
          "content_same": false
        },
        {
          "line": 256,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(EPIPE)",
          "old_line_content": "}",
          "new_line_content": "            return AVERROR(EPIPE);",
          "content_same": false
        },
        {
          "line": 257,
          "old_api": null,
          "new_api": "seek",
          "old_text": null,
          "new_text": "s->seek(s->opaque, offset, SEEK_SET)",
          "old_line_content": "",
          "new_line_content": "        if ((res = s->seek(s->opaque, offset, SEEK_SET)) < 0)",
          "content_same": false
        },
        {
          "line": 770,
          "old_api": null,
          "new_api": "av_assert0",
          "old_text": null,
          "new_text": "av_assert0(!s->write_flag)",
          "old_line_content": "    s->buffer_size = buf_size;",
          "new_line_content": "    av_assert0(!s->write_flag);",
          "content_same": false
        },
        {
          "line": 772,
          "old_api": null,
          "new_api": "av_malloc",
          "old_text": null,
          "new_text": "av_malloc(buf_size)",
          "old_line_content": "}",
          "new_line_content": "    buffer = av_malloc(buf_size);",
          "content_same": false
        },
        {
          "line": 774,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "int ffio_set_buf_size(AVIOContext *s, int buf_size)",
          "new_line_content": "        return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(buffer, s->buffer, s->buffer_size)",
          "old_line_content": "    uint8_t *buffer;",
          "new_line_content": "    memcpy(buffer, s->buffer, s->buffer_size);",
          "content_same": false
        },
        {
          "line": 788,
          "old_api": null,
          "new_api": "av_malloc",
          "old_text": null,
          "new_text": "av_malloc(buf_size)",
          "old_line_content": "",
          "new_line_content": "    buffer = av_malloc(buf_size);",
          "content_same": false
        },
        {
          "line": 790,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "{",
          "new_line_content": "        return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(EINVAL)",
          "old_line_content": "    return size;",
          "new_line_content": "        return AVERROR(EINVAL);",
          "content_same": false
        },
        {
          "line": 792,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(s->buffer)",
          "old_line_content": "",
          "new_line_content": "    av_free(s->buffer);",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOSYS)",
          "old_line_content": "int url_feof(AVIOContext *s)",
          "new_line_content": "        return AVERROR(ENOSYS);",
          "content_same": false
        },
        {
          "line": 283,
          "old_api": null,
          "new_api": "seek",
          "old_text": null,
          "new_text": "s->seek(s->opaque, 0, AVSEEK_SIZE)",
          "old_line_content": "{",
          "new_line_content": "    size = s->seek(s->opaque, 0, AVSEEK_SIZE);",
          "content_same": false
        },
        {
          "line": 796,
          "old_api": null,
          "new_api": "url_resetbuf",
          "old_text": null,
          "new_text": "url_resetbuf(s, s->write_flag ? AVIO_FLAG_WRITE : AVIO_FLAG_READ)",
          "old_line_content": "    } else {",
          "new_line_content": "    url_resetbuf(s, s->write_flag ? AVIO_FLAG_WRITE : AVIO_FLAG_READ);",
          "content_same": false
        },
        {
          "line": 285,
          "old_api": null,
          "new_api": "seek",
          "old_text": null,
          "new_text": "s->seek(s->opaque, -1, SEEK_END)",
          "old_line_content": "        return 0;",
          "new_line_content": "        if ((size = s->seek(s->opaque, -1, SEEK_END)) < 0)",
          "content_same": false
        },
        {
          "line": 802,
          "old_api": null,
          "new_api": "av_assert1",
          "old_text": null,
          "new_text": "av_assert1(flags == AVIO_FLAG_WRITE || flags == AVIO_FLAG_READ)",
          "old_line_content": "",
          "new_line_content": "    av_assert1(flags == AVIO_FLAG_WRITE || flags == AVIO_FLAG_READ);",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": null,
          "new_api": "fill_buffer",
          "old_text": null,
          "new_text": "fill_buffer(s)",
          "old_line_content": "}",
          "new_line_content": "        fill_buffer(s);",
          "content_same": false
        },
        {
          "line": 307,
          "old_api": null,
          "new_api": "avio_w8",
          "old_text": null,
          "new_text": "avio_w8(s, (uint8_t)(val >> 8 ))",
          "old_line_content": "}",
          "new_line_content": "    avio_w8(s, (uint8_t)(val >> 8 ));",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": null,
          "new_api": "avio_w8",
          "old_text": null,
          "new_text": "avio_w8(s, (uint8_t)(val >> 16))",
          "old_line_content": "",
          "new_line_content": "    avio_w8(s, (uint8_t)(val >> 16));",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": null,
          "new_api": "avio_w8",
          "old_text": null,
          "new_text": "avio_w8(s,           val >> 24 )",
          "old_line_content": "int avio_put_str(AVIOContext *s, const char *str)",
          "new_line_content": "    avio_w8(s,           val >> 24 );",
          "content_same": false
        },
        {
          "line": 822,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(bufp)",
          "old_line_content": "",
          "new_line_content": "        av_freep(bufp);",
          "content_same": false
        },
        {
          "line": 823,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(EINVAL)",
          "old_line_content": "    overlap = buf_size - buffer_start;",
          "new_line_content": "        return AVERROR(EINVAL);",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": null,
          "new_api": "avio_w8",
          "old_text": null,
          "new_text": "avio_w8(s, (uint8_t)(val >> 16))",
          "old_line_content": "    } else",
          "new_line_content": "    avio_w8(s, (uint8_t)(val >> 16));",
          "content_same": false
        },
        {
          "line": 317,
          "old_api": null,
          "new_api": "avio_w8",
          "old_text": null,
          "new_text": "avio_w8(s, (uint8_t) val       )",
          "old_line_content": "    return len;",
          "new_line_content": "    avio_w8(s, (uint8_t) val       );",
          "content_same": false
        },
        {
          "line": 830,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(bufp)",
          "old_line_content": "",
          "new_line_content": "        av_freep(bufp);",
          "content_same": false
        },
        {
          "line": 831,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(EINVAL)",
          "old_line_content": "    if (new_size > buf_size) {",
          "new_line_content": "        return AVERROR(EINVAL);",
          "content_same": false
        },
        {
          "line": 324,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(str)",
          "old_line_content": "    int err = 0;",
          "new_line_content": "        len += strlen(str);",
          "content_same": false
        },
        {
          "line": 325,
          "old_api": null,
          "new_api": "avio_write",
          "old_text": null,
          "new_text": "avio_write(s, (const unsigned char *) str, len)",
          "old_line_content": "",
          "new_line_content": "        avio_write(s, (const unsigned char *) str, len);",
          "content_same": false
        },
        {
          "line": 837,
          "old_api": null,
          "new_api": "FFMAX",
          "old_text": null,
          "new_text": "FFMAX(s->buffer_size, new_size)",
          "old_line_content": "    s->buf_ptr = s->buffer = buf;",
          "new_line_content": "    alloc_size = FFMAX(s->buffer_size, new_size);",
          "content_same": false
        },
        {
          "line": 327,
          "old_api": null,
          "new_api": "avio_w8",
          "old_text": null,
          "new_text": "avio_w8(s, 0)",
          "old_line_content": "        uint32_t ch;",
          "new_line_content": "        avio_w8(s, 0);",
          "content_same": false
        },
        {
          "line": 839,
          "old_api": null,
          "new_api": "av_realloc_f",
          "old_text": null,
          "new_text": "av_realloc_f(buf, 1, alloc_size)",
          "old_line_content": "    s->pos = buf_size;",
          "new_line_content": "        if (!(buf = (*bufp) = av_realloc_f(buf, 1, alloc_size)))",
          "content_same": false
        },
        {
          "line": 840,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "    s->buf_end = s->buf_ptr + buf_size;",
          "new_line_content": "            return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 843,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(buf + buf_size, s->buffer + overlap, buffer_size - overlap)",
          "old_line_content": "",
          "new_line_content": "        memcpy(buf + buf_size, s->buffer + overlap, buffer_size - overlap);",
          "content_same": false
        },
        {
          "line": 847,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(s->buffer)",
          "old_line_content": "int avio_open(AVIOContext **s, const char *filename, int flags)",
          "new_line_content": "    av_free(s->buffer);",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": null,
          "new_api": "GET_UTF8",
          "old_text": null,
          "new_text": "GET_UTF8(ch, *q++, goto invalid;)",
          "old_line_content": "    return ret;",
          "new_line_content": "        GET_UTF8(ch, *q++, goto invalid;)",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": null,
          "new_api": "avio_wl16",
          "old_text": null,
          "new_text": "avio_wl16(s, tmp)",
          "old_line_content": "}",
          "new_line_content": "        PUT_UTF16(ch, tmp, avio_wl16(s, tmp); ret += 2;)",
          "content_same": false
        },
        {
          "line": 345,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(s, AV_LOG_ERROR, \"Invaid UTF8 sequence in avio_put_str16le\\n\")",
          "old_line_content": "{",
          "new_line_content": "        av_log(s, AV_LOG_ERROR, \"Invaid UTF8 sequence in avio_put_str16le\\n\");",
          "content_same": false
        },
        {
          "line": 346,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(EINVAL)",
          "old_line_content": "    int i = 1;",
          "new_line_content": "        err = AVERROR(EINVAL);",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": null,
          "new_api": "avio_wl16",
          "old_text": null,
          "new_text": "avio_wl16(s, 0)",
          "old_line_content": "    while (val >>= 7)",
          "new_line_content": "    avio_wl16(s, 0);",
          "content_same": false
        },
        {
          "line": 860,
          "old_api": null,
          "new_api": "avio_open2",
          "old_text": null,
          "new_text": "avio_open2(s, filename, flags, NULL, NULL)",
          "old_line_content": "        return err;",
          "new_line_content": "    return avio_open2(s, filename, flags, NULL, NULL);",
          "content_same": false
        },
        {
          "line": 869,
          "old_api": null,
          "new_api": "ffurl_open",
          "old_text": null,
          "new_text": "ffurl_open(&h, filename, flags, int_cb, options)",
          "old_line_content": "int avio_close(AVIOContext *s)",
          "new_line_content": "    err = ffurl_open(&h, filename, flags, int_cb, options);",
          "content_same": false
        },
        {
          "line": 872,
          "old_api": null,
          "new_api": "ffio_fdopen",
          "old_text": null,
          "new_text": "ffio_fdopen(s, h)",
          "old_line_content": "",
          "new_line_content": "    err = ffio_fdopen(s, h);",
          "content_same": false
        },
        {
          "line": 874,
          "old_api": null,
          "new_api": "ffurl_close",
          "old_text": null,
          "new_text": "ffurl_close(h)",
          "old_line_content": "        return 0;",
          "new_line_content": "        ffurl_close(h);",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": null,
          "new_api": "avio_w8",
          "old_text": null,
          "new_text": "avio_w8(bc, 128 | (uint8_t)(val >> (7*i)))",
          "old_line_content": "void avio_wb64(AVIOContext *s, uint64_t val)",
          "new_line_content": "        avio_w8(bc, 128 | (uint8_t)(val >> (7*i)));",
          "content_same": false
        },
        {
          "line": 887,
          "old_api": null,
          "new_api": "avio_flush",
          "old_text": null,
          "new_text": "avio_flush(s)",
          "old_line_content": "int avio_closep(AVIOContext **s)",
          "new_line_content": "    avio_flush(s);",
          "content_same": false
        },
        {
          "line": 377,
          "old_api": null,
          "new_api": "avio_wl32",
          "old_text": null,
          "new_text": "avio_wl32(s, (uint32_t)(val & 0xffffffff))",
          "old_line_content": "{",
          "new_line_content": "    avio_wl32(s, (uint32_t)(val & 0xffffffff));",
          "content_same": false
        },
        {
          "line": 891,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(s, AV_LOG_DEBUG, \"Statistics: %d seeks, %d writeouts\\n\", s->seek_count, s->writeout_count)",
          "old_line_content": "    return ret;",
          "new_line_content": "        av_log(s, AV_LOG_DEBUG, \"Statistics: %d seeks, %d writeouts\\n\", s->seek_count, s->writeout_count);",
          "content_same": false
        },
        {
          "line": 893,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(s, AV_LOG_DEBUG, \"Statistics: %\"PRId64\" bytes read, %d seeks\\n\", s->bytes_read, s->seek_count)",
          "old_line_content": "",
          "new_line_content": "        av_log(s, AV_LOG_DEBUG, \"Statistics: %\"PRId64\" bytes read, %d seeks\\n\", s->bytes_read, s->seek_count);",
          "content_same": false
        },
        {
          "line": 894,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(s)",
          "old_line_content": "int avio_printf(AVIOContext *s, const char *fmt, ...)",
          "new_line_content": "    av_free(s);",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": null,
          "new_api": "avio_wb32",
          "old_text": null,
          "new_text": "avio_wb32(s, (uint32_t)(val >> 32))",
          "old_line_content": "{",
          "new_line_content": "    avio_wb32(s, (uint32_t)(val >> 32));",
          "content_same": false
        },
        {
          "line": 895,
          "old_api": null,
          "new_api": "ffurl_close",
          "old_text": null,
          "new_text": "ffurl_close(h)",
          "old_line_content": "{",
          "new_line_content": "    return ffurl_close(h);",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": null,
          "new_api": "avio_w8",
          "old_text": null,
          "new_text": "avio_w8(s, (uint8_t)val)",
          "old_line_content": "{",
          "new_line_content": "    avio_w8(s, (uint8_t)val);",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": null,
          "new_api": "avio_w8",
          "old_text": null,
          "new_text": "avio_w8(s, (int)val >> 8)",
          "old_line_content": "{",
          "new_line_content": "    avio_w8(s, (int)val >> 8);",
          "content_same": false
        },
        {
          "line": 912,
          "old_api": null,
          "new_api": "vsnprintf",
          "old_text": null,
          "new_text": "vsnprintf(buf, sizeof(buf), fmt, ap)",
          "old_line_content": "}",
          "new_line_content": "    ret = vsnprintf(buf, sizeof(buf), fmt, ap);",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": null,
          "new_api": "avio_wl16",
          "old_text": null,
          "new_text": "avio_wl16(s, val & 0xffff)",
          "old_line_content": "",
          "new_line_content": "    avio_wl16(s, val & 0xffff);",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": null,
          "new_api": "avio_w8",
          "old_text": null,
          "new_text": "avio_w8(s, (int)val >> 16)",
          "old_line_content": "static void fill_buffer(AVIOContext *s)",
          "new_line_content": "    avio_w8(s, (int)val >> 16);",
          "content_same": false
        },
        {
          "line": 913,
          "old_api": null,
          "new_api": "va_end",
          "old_text": null,
          "new_text": "va_end(ap)",
          "old_line_content": "",
          "new_line_content": "    va_end(ap);",
          "content_same": false
        },
        {
          "line": 914,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(buf)",
          "old_line_content": "int64_t avio_seek_time(AVIOContext *s, int stream_index,",
          "new_line_content": "    avio_write(s, buf, strlen(buf));",
          "content_same": false
        },
        {
          "line": 407,
          "old_api": null,
          "new_api": "avio_wb16",
          "old_text": null,
          "new_text": "avio_wb16(s, (int)val >> 8)",
          "old_line_content": "                          s->buf_end : s->buffer;",
          "new_line_content": "    avio_wb16(s, (int)val >> 8);",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": null,
          "new_api": "avio_w8",
          "old_text": null,
          "new_text": "avio_w8(s, (uint8_t)val)",
          "old_line_content": "    int len             = s->buffer_size - (dst - s->buffer);",
          "new_line_content": "    avio_w8(s, (uint8_t)val);",
          "content_same": false
        },
        {
          "line": 922,
          "old_api": null,
          "new_api": "read_pause",
          "old_text": null,
          "new_text": "s->read_pause(s->opaque, pause)",
          "old_line_content": "    if (ret >= 0) {",
          "new_line_content": "    return s->read_pause(s->opaque, pause);",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOSYS)",
          "old_line_content": "    return ret;",
          "new_line_content": "        return AVERROR(ENOSYS);",
          "content_same": false
        },
        {
          "line": 932,
          "old_api": null,
          "new_api": "read_seek",
          "old_text": null,
          "new_text": "s->read_seek(h, stream_index, timestamp, flags)",
          "old_line_content": "}",
          "new_line_content": "    ret = s->read_seek(h, stream_index, timestamp, flags);",
          "content_same": false
        },
        {
          "line": 936,
          "old_api": null,
          "new_api": "seek",
          "old_text": null,
          "new_text": "s->seek(h, 0, SEEK_CUR)",
          "old_line_content": "typedef struct DynBuffer {",
          "new_line_content": "        pos = s->seek(h, 0, SEEK_CUR);",
          "content_same": false
        },
        {
          "line": 939,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOSYS)",
          "old_line_content": "    int io_buffer_size;",
          "new_line_content": "        else if (pos != AVERROR(ENOSYS))",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": null,
          "new_api": "update_checksum",
          "old_text": null,
          "new_text": "s->update_checksum(s->checksum, s->checksum_ptr,\n                                             s->buf_end - s->checksum_ptr)",
          "old_line_content": "        }",
          "new_line_content": "            s->checksum = s->update_checksum(s->checksum, s->checksum_ptr,",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": null,
          "new_api": "ffio_set_buf_size",
          "old_text": null,
          "new_text": "ffio_set_buf_size(s, max_buffer_size)",
          "old_line_content": "        len = 0;",
          "new_line_content": "            ffio_set_buf_size(s, max_buffer_size);",
          "content_same": false
        },
        {
          "line": 443,
          "old_api": null,
          "new_api": "av_assert0",
          "old_text": null,
          "new_text": "av_assert0(len >= max_buffer_size)",
          "old_line_content": "        s->eof_reached = 1;",
          "new_line_content": "        av_assert0(len >= max_buffer_size);",
          "content_same": false
        },
        {
          "line": 448,
          "old_api": null,
          "new_api": "read_packet",
          "old_text": null,
          "new_text": "s->read_packet(s->opaque, dst, len)",
          "old_line_content": "        s->buf_ptr = dst;",
          "new_line_content": "        len = s->read_packet(s->opaque, dst, len);",
          "content_same": false
        },
        {
          "line": 973,
          "old_api": null,
          "new_api": "av_reallocp",
          "old_text": null,
          "new_text": "av_reallocp(&d->buffer, new_allocated_size)",
          "old_line_content": "    return buf_size;",
          "new_line_content": "        if ((err = av_reallocp(&d->buffer, new_allocated_size)) < 0) {",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": null,
          "new_api": "av_crc_get_table",
          "old_text": null,
          "new_text": "av_crc_get_table(AV_CRC_32_IEEE)",
          "old_line_content": "void ffio_init_checksum(AVIOContext *s,",
          "new_line_content": "    return av_crc(av_crc_get_table(AV_CRC_32_IEEE), checksum, buf, len);",
          "content_same": false
        },
        {
          "line": 980,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(d->buffer + d->pos, buf, buf_size)",
          "old_line_content": "",
          "new_line_content": "    memcpy(d->buffer + d->pos, buf, buf_size);",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": null,
          "new_api": "update_checksum",
          "old_text": null,
          "new_text": "s->update_checksum(s->checksum, s->checksum_ptr,\n                                     s->buf_ptr - s->checksum_ptr)",
          "old_line_content": "    if (s->update_checksum) {",
          "new_line_content": "    s->checksum = s->update_checksum(s->checksum, s->checksum_ptr,",
          "content_same": false
        },
        {
          "line": 993,
          "old_api": null,
          "new_api": "AV_WB32",
          "old_text": null,
          "new_text": "AV_WB32(buf1, buf_size)",
          "old_line_content": "    DynBuffer *d = opaque;",
          "new_line_content": "    AV_WB32(buf1, buf_size);",
          "content_same": false
        },
        {
          "line": 994,
          "old_api": null,
          "new_api": "dyn_buf_write",
          "old_text": null,
          "new_text": "dyn_buf_write(opaque, buf1, 4)",
          "old_line_content": "",
          "new_line_content": "    ret = dyn_buf_write(opaque, buf1, 4);",
          "content_same": false
        },
        {
          "line": 999,
          "old_api": null,
          "new_api": "dyn_buf_write",
          "old_text": null,
          "new_text": "dyn_buf_write(opaque, buf, buf_size)",
          "old_line_content": "    if (offset < 0 || offset > 0x7fffffffLL)",
          "new_line_content": "    return dyn_buf_write(opaque, buf, buf_size);",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": null,
          "new_api": "fill_buffer",
          "old_text": null,
          "new_text": "fill_buffer(s)",
          "old_line_content": "    while (size > 0) {",
          "new_line_content": "        fill_buffer(s);",
          "content_same": false
        },
        {
          "line": 1023,
          "old_api": null,
          "new_api": "av_mallocz",
          "old_text": null,
          "new_text": "av_mallocz(sizeof(DynBuffer) + io_buffer_size)",
          "old_line_content": "    (*s)->max_packet_size = max_packet_size;",
          "new_line_content": "    d = av_mallocz(sizeof(DynBuffer) + io_buffer_size);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1029,
          "old_api": "url_open_dyn_buf_internal",
          "new_api": null,
          "old_text": "url_open_dyn_buf_internal(s, 0)",
          "new_text": null,
          "old_line_content": "    return url_open_dyn_buf_internal(s, 0);",
          "new_line_content": "                            max_packet_size ? NULL : dyn_buf_seek);",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": "fill_buffer",
          "new_api": null,
          "old_text": "fill_buffer(s)",
          "new_text": null,
          "old_line_content": "                fill_buffer(s);",
          "new_line_content": "                        s->error= len;",
          "content_same": false
        },
        {
          "line": 1036,
          "old_api": "url_open_dyn_buf_internal",
          "new_api": null,
          "old_text": "url_open_dyn_buf_internal(s, max_packet_size)",
          "new_text": null,
          "old_line_content": "    return url_open_dyn_buf_internal(s, max_packet_size);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(buf, s->buf_ptr, len)",
          "new_text": null,
          "old_line_content": "            memcpy(buf, s->buf_ptr, len);",
          "new_line_content": "                    buf += len;",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": "url_feof",
          "new_api": null,
          "old_text": "url_feof(s)",
          "new_text": null,
          "old_line_content": "        if (url_feof(s))   return AVERROR_EOF;",
          "new_line_content": "                    break;",
          "content_same": false
        },
        {
          "line": 1054,
          "old_api": "avio_write",
          "new_api": null,
          "old_text": "avio_write(s, padbuf, sizeof(padbuf))",
          "new_text": null,
          "old_line_content": "        avio_write(s, padbuf, sizeof(padbuf));",
          "new_line_content": "    static const char padbuf[FF_INPUT_BUFFER_PADDING_SIZE] = {0};",
          "content_same": false
        },
        {
          "line": 545,
          "old_api": "avio_read",
          "new_api": null,
          "old_text": "avio_read(s, buf, size)",
          "new_text": null,
          "old_line_content": "        return avio_read(s, buf, size);",
          "new_line_content": "    return size1 - size;",
          "content_same": false
        },
        {
          "line": 1058,
          "old_api": "avio_flush",
          "new_api": null,
          "old_text": "avio_flush(s)",
          "new_text": null,
          "old_line_content": "    avio_flush(s);",
          "new_line_content": "        *pbuffer = NULL;",
          "content_same": false
        },
        {
          "line": 1062,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(d)",
          "new_text": null,
          "old_line_content": "    av_free(d);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1063,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(s)",
          "new_text": null,
          "old_line_content": "    av_free(s);",
          "new_line_content": "    /* don't attempt to pad fixed-size packet buffers */",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": "read_packet",
          "new_api": null,
          "old_text": "s->read_packet(s->opaque, buf, size)",
          "new_text": null,
          "old_line_content": "        len = s->read_packet(s->opaque, buf, size);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1079,
          "old_api": "url_open_dyn_buf_internal",
          "new_api": null,
          "old_text": "url_open_dyn_buf_internal(s, 0)",
          "new_text": null,
          "old_line_content": "    int ret = url_open_dyn_buf_internal(s, 0);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": "fill_buffer",
          "new_api": null,
          "old_text": "fill_buffer(s)",
          "new_text": null,
          "old_line_content": "        fill_buffer(s);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 577,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(buf, s->buf_ptr, len)",
          "new_text": null,
          "old_line_content": "    memcpy(buf, s->buf_ptr, len);",
          "new_line_content": "         * the fill_buffer call tries to read as much data as fits into the",
          "content_same": false
        },
        {
          "line": 1092,
          "old_api": "avio_flush",
          "new_api": null,
          "old_text": "avio_flush(s)",
          "new_text": null,
          "old_line_content": "    avio_flush(s);",
          "new_line_content": "        AVIOContext *pb = *s;",
          "content_same": false
        },
        {
          "line": 581,
          "old_api": "url_feof",
          "new_api": null,
          "old_text": "url_feof(s)",
          "new_text": null,
          "old_line_content": "        if (url_feof(s))   return AVERROR_EOF;",
          "new_line_content": "         */",
          "content_same": false
        },
        {
          "line": 1095,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(d)",
          "new_text": null,
          "old_line_content": "    av_free(d);",
          "new_line_content": "    return ret;",
          "content_same": false
        },
        {
          "line": 1096,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(s)",
          "new_text": null,
          "old_line_content": "    av_free(s);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": "avio_r8",
          "new_api": null,
          "old_text": "avio_r8(s)",
          "new_text": null,
          "old_line_content": "    val = avio_r8(s);",
          "new_line_content": "    s->buf_ptr += len;",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": "avio_r8",
          "new_api": null,
          "old_text": "avio_r8(s)",
          "new_text": null,
          "old_line_content": "    val |= avio_r8(s) << 8;",
          "new_line_content": "    if (!len) {",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "avio_rl16",
          "new_api": null,
          "old_text": "avio_rl16(s)",
          "new_text": null,
          "old_line_content": "    val = avio_rl16(s);",
          "new_line_content": "unsigned int avio_rl16(AVIOContext *s)",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": "avio_r8",
          "new_api": null,
          "old_text": "avio_r8(s)",
          "new_text": null,
          "old_line_content": "    val |= avio_r8(s) << 16;",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": "avio_rl16",
          "new_api": null,
          "old_text": "avio_rl16(s)",
          "new_text": null,
          "old_line_content": "    val = avio_rl16(s);",
          "new_line_content": "unsigned int avio_rl24(AVIOContext *s)",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": "avio_rl16",
          "new_api": null,
          "old_text": "avio_rl16(s)",
          "new_text": null,
          "old_line_content": "    val |= avio_rl16(s) << 16;",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 613,
          "old_api": "avio_rl32",
          "new_api": null,
          "old_text": "avio_rl32(s)",
          "new_text": null,
          "old_line_content": "    val = (uint64_t)avio_rl32(s);",
          "new_line_content": "unsigned int avio_rl32(AVIOContext *s)",
          "content_same": false
        },
        {
          "line": 614,
          "old_api": "avio_rl32",
          "new_api": null,
          "old_text": "avio_rl32(s)",
          "new_text": null,
          "old_line_content": "    val |= (uint64_t)avio_rl32(s) << 32;",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": "avio_r8",
          "new_api": null,
          "old_text": "avio_r8(s)",
          "new_text": null,
          "old_line_content": "    val = avio_r8(s) << 8;",
          "new_line_content": "uint64_t avio_rl64(AVIOContext *s)",
          "content_same": false
        },
        {
          "line": 622,
          "old_api": "avio_r8",
          "new_api": null,
          "old_text": "avio_r8(s)",
          "new_text": null,
          "old_line_content": "    val |= avio_r8(s);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 629,
          "old_api": "avio_rb16",
          "new_api": null,
          "old_text": "avio_rb16(s)",
          "new_text": null,
          "old_line_content": "    val = avio_rb16(s) << 8;",
          "new_line_content": "unsigned int avio_rb16(AVIOContext *s)",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": "avio_r8",
          "new_api": null,
          "old_text": "avio_r8(s)",
          "new_text": null,
          "old_line_content": "    val |= avio_r8(s);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": "avio_rb16",
          "new_api": null,
          "old_text": "avio_rb16(s)",
          "new_text": null,
          "old_line_content": "    val = avio_rb16(s) << 16;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 637,
          "old_api": "avio_rb16",
          "new_api": null,
          "old_text": "avio_rb16(s)",
          "new_text": null,
          "old_line_content": "    val |= avio_rb16(s);",
          "new_line_content": "unsigned int avio_rb24(AVIOContext *s)",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EINVAL)",
          "new_text": null,
          "old_line_content": "        return AVERROR(EINVAL);",
          "new_line_content": "    } while (c != '\\n' && c);",
          "content_same": false
        },
        {
          "line": 663,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(buflen - 1, maxlen)",
          "new_text": null,
          "old_line_content": "    buflen = FFMIN(buflen - 1, maxlen);",
          "new_line_content": "    buf[i] = 0;",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": "avio_r8",
          "new_api": null,
          "old_text": "avio_r8(s)",
          "new_text": null,
          "old_line_content": "        if (!(buf[i] = avio_r8(s)))",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": "avio_r8",
          "new_api": null,
          "old_text": "avio_r8(s)",
          "new_text": null,
          "old_line_content": "        if (!avio_r8(s))",
          "new_line_content": "    int i;",
          "content_same": false
        },
        {
          "line": 693,
          "old_api": "GET_STR16",
          "new_api": null,
          "old_text": "GET_STR16(le, avio_rl16)",
          "new_text": null,
          "old_line_content": "GET_STR16(le, avio_rl16)",
          "new_line_content": "        uint8_t tmp;\\",
          "content_same": false
        },
        {
          "line": 694,
          "old_api": "GET_STR16",
          "new_api": null,
          "old_text": "GET_STR16(be, avio_rb16)",
          "new_text": null,
          "old_line_content": "GET_STR16(be, avio_rb16)",
          "new_line_content": "        uint32_t ch;\\",
          "content_same": false
        },
        {
          "line": 701,
          "old_api": "avio_rb32",
          "new_api": null,
          "old_text": "avio_rb32(s)",
          "new_text": null,
          "old_line_content": "    val = (uint64_t)avio_rb32(s) << 32;",
          "new_line_content": "    return ret;\\",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": "avio_rb32",
          "new_api": null,
          "old_text": "avio_rb32(s)",
          "new_text": null,
          "old_line_content": "    val |= (uint64_t)avio_rb32(s);",
          "new_line_content": "}\\",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": "avio_r8",
          "new_api": null,
          "old_text": "avio_r8(bc)",
          "new_text": null,
          "old_line_content": "        tmp = avio_r8(bc);",
          "new_line_content": "    uint64_t val;",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "av_malloc",
          "new_api": null,
          "old_text": "av_malloc(buffer_size)",
          "new_text": null,
          "old_line_content": "    buffer = av_malloc(buffer_size);",
          "new_line_content": "int ffio_fdopen(AVIOContext **s, URLContext *h)",
          "content_same": false
        },
        {
          "line": 730,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "        return AVERROR(ENOMEM);",
          "new_line_content": "    uint8_t *buffer;",
          "content_same": false
        },
        {
          "line": 732,
          "old_api": "avio_alloc_context",
          "new_api": null,
          "old_text": "avio_alloc_context(buffer, buffer_size, h->flags & AVIO_FLAG_WRITE, h,\n                            (void*)ffurl_read, (void*)ffurl_write, (void*)ffurl_seek)",
          "new_text": null,
          "old_line_content": "    *s = avio_alloc_context(buffer, buffer_size, h->flags & AVIO_FLAG_WRITE, h,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(buffer)",
          "new_text": null,
          "old_line_content": "        av_free(buffer);",
          "new_line_content": "        buffer_size = max_packet_size; /* no need to bufferize more than one packet */",
          "content_same": false
        },
        {
          "line": 736,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "        return AVERROR(ENOMEM);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 245,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EPIPE)",
          "new_text": null,
          "old_line_content": "            return AVERROR(EPIPE);",
          "new_line_content": "        s->pos = pos;",
          "content_same": false
        },
        {
          "line": 246,
          "old_api": "seek",
          "new_api": null,
          "old_text": "s->seek(s->opaque, offset, SEEK_SET)",
          "new_text": null,
          "old_line_content": "        if ((res = s->seek(s->opaque, offset, SEEK_SET)) < 0)",
          "new_line_content": "        s->eof_reached = 0;",
          "content_same": false
        },
        {
          "line": 759,
          "old_api": "av_assert0",
          "new_api": null,
          "old_text": "av_assert0(!s->write_flag)",
          "new_text": null,
          "old_line_content": "    av_assert0(!s->write_flag);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 761,
          "old_api": "av_malloc",
          "new_api": null,
          "old_text": "av_malloc(buf_size)",
          "new_text": null,
          "old_line_content": "    buffer = av_malloc(buf_size);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 763,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "        return AVERROR(ENOMEM);",
          "new_line_content": "    int max_buffer_size = s->max_packet_size ?",
          "content_same": false
        },
        {
          "line": 765,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(buffer, s->buffer, s->buffer_size)",
          "new_text": null,
          "old_line_content": "    memcpy(buffer, s->buffer, s->buffer_size);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(s->buffer)",
          "new_text": null,
          "old_line_content": "    av_free(s->buffer);",
          "new_line_content": "    buf_size += s->buf_ptr - s->buffer + max_buffer_size;",
          "content_same": false
        },
        {
          "line": 260,
          "old_api": "avio_seek",
          "new_api": null,
          "old_text": "avio_seek(s, offset, SEEK_CUR)",
          "new_text": null,
          "old_line_content": "    return avio_seek(s, offset, SEEK_CUR);",
          "new_line_content": "        if (!s->write_flag)",
          "content_same": false
        },
        {
          "line": 779,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "        return AVERROR(ENOMEM);",
          "new_line_content": "    s->buf_end = buffer + (s->buf_end - s->buffer);",
          "content_same": false
        },
        {
          "line": 268,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EINVAL)",
          "new_text": null,
          "old_line_content": "        return AVERROR(EINVAL);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 781,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(s->buffer)",
          "new_text": null,
          "old_line_content": "    av_free(s->buffer);",
          "new_line_content": "    s->buffer_size = buf_size;",
          "content_same": false
        },
        {
          "line": 272,
          "old_api": "seek",
          "new_api": null,
          "old_text": "s->seek(s->opaque, 0, AVSEEK_SIZE)",
          "new_text": null,
          "old_line_content": "    size = s->seek(s->opaque, 0, AVSEEK_SIZE);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 785,
          "old_api": "url_resetbuf",
          "new_api": null,
          "old_text": "url_resetbuf(s, s->write_flag ? AVIO_FLAG_WRITE : AVIO_FLAG_READ)",
          "new_text": null,
          "old_line_content": "    url_resetbuf(s, s->write_flag ? AVIO_FLAG_WRITE : AVIO_FLAG_READ);",
          "new_line_content": "int ffio_set_buf_size(AVIOContext *s, int buf_size)",
          "content_same": false
        },
        {
          "line": 274,
          "old_api": "seek",
          "new_api": null,
          "old_text": "s->seek(s->opaque, -1, SEEK_END)",
          "new_text": null,
          "old_line_content": "        if ((size = s->seek(s->opaque, -1, SEEK_END)) < 0)",
          "new_line_content": "int64_t avio_size(AVIOContext *s)",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": "seek",
          "new_api": null,
          "old_text": "s->seek(s->opaque, s->pos, SEEK_SET)",
          "new_text": null,
          "old_line_content": "        s->seek(s->opaque, s->pos, SEEK_SET);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 791,
          "old_api": "av_assert1",
          "new_api": null,
          "old_text": "av_assert1(flags == AVIO_FLAG_WRITE || flags == AVIO_FLAG_READ)",
          "new_text": null,
          "old_line_content": "    av_assert1(flags == AVIO_FLAG_WRITE || flags == AVIO_FLAG_READ);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 295,
          "old_api": "avio_w8",
          "new_api": null,
          "old_text": "avio_w8(s, (uint8_t) val       )",
          "new_text": null,
          "old_line_content": "    avio_w8(s, (uint8_t) val       );",
          "new_line_content": "    if(!s)",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": "avio_w8",
          "new_api": null,
          "old_text": "avio_w8(s, (uint8_t)(val >> 8 ))",
          "new_text": null,
          "old_line_content": "    avio_w8(s, (uint8_t)(val >> 8 ));",
          "new_line_content": "        return 0;",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": "avio_w8",
          "new_api": null,
          "old_text": "avio_w8(s, (uint8_t)(val >> 16))",
          "new_text": null,
          "old_line_content": "    avio_w8(s, (uint8_t)(val >> 16));",
          "new_line_content": "    if(s->eof_reached){",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": "avio_w8",
          "new_api": null,
          "old_text": "avio_w8(s,           val >> 24 )",
          "new_text": null,
          "old_line_content": "    avio_w8(s,           val >> 24 );",
          "new_line_content": "        s->eof_reached=0;",
          "content_same": false
        },
        {
          "line": 811,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(bufp)",
          "new_text": null,
          "old_line_content": "        av_freep(bufp);",
          "new_line_content": "    return 0;",
          "content_same": false
        },
        {
          "line": 812,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EINVAL)",
          "new_text": null,
          "old_line_content": "        return AVERROR(EINVAL);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": "avio_w8",
          "new_api": null,
          "old_text": "avio_w8(s,           val >> 24 )",
          "new_text": null,
          "old_line_content": "    avio_w8(s,           val >> 24 );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 304,
          "old_api": "avio_w8",
          "new_api": null,
          "old_text": "avio_w8(s, (uint8_t)(val >> 16))",
          "new_text": null,
          "old_line_content": "    avio_w8(s, (uint8_t)(val >> 16));",
          "new_line_content": "void avio_wl32(AVIOContext *s, unsigned int val)",
          "content_same": false
        },
        {
          "line": 305,
          "old_api": "avio_w8",
          "new_api": null,
          "old_text": "avio_w8(s, (uint8_t)(val >> 8 ))",
          "new_text": null,
          "old_line_content": "    avio_w8(s, (uint8_t)(val >> 8 ));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 819,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(bufp)",
          "new_text": null,
          "old_line_content": "        av_freep(bufp);",
          "new_line_content": "    uint8_t *buf = *bufp;",
          "content_same": false
        },
        {
          "line": 820,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EINVAL)",
          "new_text": null,
          "old_line_content": "        return AVERROR(EINVAL);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(str)",
          "new_text": null,
          "old_line_content": "        len += strlen(str);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 826,
          "old_api": "FFMAX",
          "new_api": null,
          "old_text": "FFMAX(s->buffer_size, new_size)",
          "new_text": null,
          "old_line_content": "    alloc_size = FFMAX(s->buffer_size, new_size);",
          "new_line_content": "    buffer_size = s->buf_end - s->buffer;",
          "content_same": false
        },
        {
          "line": 828,
          "old_api": "av_realloc_f",
          "new_api": null,
          "old_text": "av_realloc_f(buf, 1, alloc_size)",
          "new_text": null,
          "old_line_content": "        if (!(buf = (*bufp) = av_realloc_f(buf, 1, alloc_size)))",
          "new_line_content": "    /* the buffers must touch or overlap */",
          "content_same": false
        },
        {
          "line": 829,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "            return AVERROR(ENOMEM);",
          "new_line_content": "    if ((buffer_start = s->pos - buffer_size) > buf_size) {",
          "content_same": false
        },
        {
          "line": 832,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(buf + buf_size, s->buffer + overlap, buffer_size - overlap)",
          "new_text": null,
          "old_line_content": "        memcpy(buf + buf_size, s->buffer + overlap, buffer_size - overlap);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 836,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(s->buffer)",
          "new_text": null,
          "old_line_content": "    av_free(s->buffer);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": "GET_UTF8",
          "new_api": null,
          "old_text": "GET_UTF8(ch, *q++, goto invalid;)",
          "new_text": null,
          "old_line_content": "        GET_UTF8(ch, *q++, goto invalid;)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": "avio_wl16",
          "new_api": null,
          "old_text": "avio_wl16(s, tmp)",
          "new_text": null,
          "old_line_content": "        PUT_UTF16(ch, tmp, avio_wl16(s, tmp); ret += 2;)",
          "new_line_content": "int avio_put_str16le(AVIOContext *s, const char *str)",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(s, AV_LOG_ERROR, \"Invaid UTF8 sequence in avio_put_str16le\\n\")",
          "new_text": null,
          "old_line_content": "        av_log(s, AV_LOG_ERROR, \"Invaid UTF8 sequence in avio_put_str16le\\n\");",
          "new_line_content": "    int ret = 0;",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(EINVAL)",
          "new_text": null,
          "old_line_content": "        err = AVERROR(EINVAL);",
          "new_line_content": "    int err = 0;",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": "avio_wl16",
          "new_api": null,
          "old_text": "avio_wl16(s, 0)",
          "new_text": null,
          "old_line_content": "    avio_wl16(s, 0);",
          "new_line_content": "    while (*q) {",
          "content_same": false
        },
        {
          "line": 849,
          "old_api": "avio_open2",
          "new_api": null,
          "old_text": "avio_open2(s, filename, flags, NULL, NULL)",
          "new_text": null,
          "old_line_content": "    return avio_open2(s, filename, flags, NULL, NULL);",
          "new_line_content": "    s->buffer_size = alloc_size;",
          "content_same": false
        },
        {
          "line": 858,
          "old_api": "ffurl_open",
          "new_api": null,
          "old_text": "ffurl_open(&h, filename, flags, int_cb, options)",
          "new_text": null,
          "old_line_content": "    err = ffurl_open(&h, filename, flags, int_cb, options);",
          "new_line_content": "int avio_open(AVIOContext **s, const char *filename, int flags)",
          "content_same": false
        },
        {
          "line": 861,
          "old_api": "ffio_fdopen",
          "new_api": null,
          "old_text": "ffio_fdopen(s, h)",
          "new_text": null,
          "old_line_content": "    err = ffio_fdopen(s, h);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 863,
          "old_api": "ffurl_close",
          "new_api": null,
          "old_text": "ffurl_close(h)",
          "new_text": null,
          "old_line_content": "        ffurl_close(h);",
          "new_line_content": "int avio_open2(AVIOContext **s, const char *filename, int flags,",
          "content_same": false
        },
        {
          "line": 356,
          "old_api": "ff_get_v_length",
          "new_api": null,
          "old_text": "ff_get_v_length(val)",
          "new_text": null,
          "old_line_content": "    int i = ff_get_v_length(val);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 359,
          "old_api": "avio_w8",
          "new_api": null,
          "old_text": "avio_w8(bc, 128 | (uint8_t)(val >> (7*i)))",
          "new_text": null,
          "old_line_content": "        avio_w8(bc, 128 | (uint8_t)(val >> (7*i)));",
          "new_line_content": "    while (val >>= 7)",
          "content_same": false
        },
        {
          "line": 361,
          "old_api": "avio_w8",
          "new_api": null,
          "old_text": "avio_w8(bc, val & 127)",
          "new_text": null,
          "old_line_content": "    avio_w8(bc, val & 127);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 876,
          "old_api": "avio_flush",
          "new_api": null,
          "old_text": "avio_flush(s)",
          "new_text": null,
          "old_line_content": "    avio_flush(s);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 366,
          "old_api": "avio_wl32",
          "new_api": null,
          "old_text": "avio_wl32(s, (uint32_t)(val & 0xffffffff))",
          "new_text": null,
          "old_line_content": "    avio_wl32(s, (uint32_t)(val & 0xffffffff));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 878,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&s->buffer)",
          "new_text": null,
          "old_line_content": "    av_freep(&s->buffer);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 880,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(s, AV_LOG_DEBUG, \"Statistics: %d seeks, %d writeouts\\n\", s->seek_count, s->writeout_count)",
          "new_text": null,
          "old_line_content": "        av_log(s, AV_LOG_DEBUG, \"Statistics: %d seeks, %d writeouts\\n\", s->seek_count, s->writeout_count);",
          "new_line_content": "int avio_close(AVIOContext *s)",
          "content_same": false
        },
        {
          "line": 882,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(s, AV_LOG_DEBUG, \"Statistics: %\"PRId64\" bytes read, %d seeks\\n\", s->bytes_read, s->seek_count)",
          "new_text": null,
          "old_line_content": "        av_log(s, AV_LOG_DEBUG, \"Statistics: %\"PRId64\" bytes read, %d seeks\\n\", s->bytes_read, s->seek_count);",
          "new_line_content": "    URLContext *h;",
          "content_same": false
        },
        {
          "line": 883,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(s)",
          "new_text": null,
          "old_line_content": "    av_free(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 884,
          "old_api": "ffurl_close",
          "new_api": null,
          "old_text": "ffurl_close(h)",
          "new_text": null,
          "old_line_content": "    return ffurl_close(h);",
          "new_line_content": "    if (!s)",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": "avio_wb32",
          "new_api": null,
          "old_text": "avio_wb32(s, (uint32_t)(val & 0xffffffff))",
          "new_text": null,
          "old_line_content": "    avio_wb32(s, (uint32_t)(val & 0xffffffff));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": "avio_w8",
          "new_api": null,
          "old_text": "avio_w8(s, (int)val >> 8)",
          "new_text": null,
          "old_line_content": "    avio_w8(s, (int)val >> 8);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": "avio_w8",
          "new_api": null,
          "old_text": "avio_w8(s, (uint8_t)val)",
          "new_text": null,
          "old_line_content": "    avio_w8(s, (uint8_t)val);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 901,
          "old_api": "vsnprintf",
          "new_api": null,
          "old_text": "vsnprintf(buf, sizeof(buf), fmt, ap)",
          "new_text": null,
          "old_line_content": "    ret = vsnprintf(buf, sizeof(buf), fmt, ap);",
          "new_line_content": "    *s = NULL;",
          "content_same": false
        },
        {
          "line": 902,
          "old_api": "va_end",
          "new_api": null,
          "old_text": "va_end(ap)",
          "new_text": null,
          "old_line_content": "    va_end(ap);",
          "new_line_content": "    return ret;",
          "content_same": false
        },
        {
          "line": 391,
          "old_api": "avio_w8",
          "new_api": null,
          "old_text": "avio_w8(s, (int)val >> 16)",
          "new_text": null,
          "old_line_content": "    avio_w8(s, (int)val >> 16);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 903,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(buf)",
          "new_text": null,
          "old_line_content": "    avio_write(s, buf, strlen(buf));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": "avio_w8",
          "new_api": null,
          "old_text": "avio_w8(s, (uint8_t)val)",
          "new_text": null,
          "old_line_content": "    avio_w8(s, (uint8_t)val);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 910,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOSYS)",
          "new_text": null,
          "old_line_content": "        return AVERROR(ENOSYS);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 920,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOSYS)",
          "new_text": null,
          "old_line_content": "        return AVERROR(ENOSYS);",
          "new_line_content": "    if (!s->read_pause)",
          "content_same": false
        },
        {
          "line": 925,
          "old_api": "seek",
          "new_api": null,
          "old_text": "s->seek(h, 0, SEEK_CUR)",
          "new_text": null,
          "old_line_content": "        pos = s->seek(h, 0, SEEK_CUR);",
          "new_line_content": "int64_t avio_seek_time(AVIOContext *s, int stream_index,",
          "content_same": false
        },
        {
          "line": 928,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOSYS)",
          "new_text": null,
          "old_line_content": "        else if (pos != AVERROR(ENOSYS))",
          "new_line_content": "    URLContext *h = s->opaque;",
          "content_same": false
        },
        {
          "line": 420,
          "old_api": "update_checksum",
          "new_api": null,
          "old_text": "s->update_checksum(s->checksum, s->checksum_ptr,\n                                             s->buf_end - s->checksum_ptr)",
          "new_text": null,
          "old_line_content": "            s->checksum = s->update_checksum(s->checksum, s->checksum_ptr,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": "ffio_set_buf_size",
          "new_api": null,
          "old_text": "ffio_set_buf_size(s, max_buffer_size)",
          "new_text": null,
          "old_line_content": "            ffio_set_buf_size(s, max_buffer_size);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": "av_assert0",
          "new_api": null,
          "old_text": "av_assert0(len >= max_buffer_size)",
          "new_text": null,
          "old_line_content": "        av_assert0(len >= max_buffer_size);",
          "new_line_content": "                                             s->buf_end - s->checksum_ptr);",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "read_packet",
          "new_api": null,
          "old_text": "s->read_packet(s->opaque, dst, len)",
          "new_text": null,
          "old_line_content": "        len = s->read_packet(s->opaque, dst, len);",
          "new_line_content": "    if (s->read_packet && s->buffer_size > max_buffer_size) {",
          "content_same": false
        },
        {
          "line": 962,
          "old_api": "av_reallocp",
          "new_api": null,
          "old_text": "av_reallocp(&d->buffer, new_allocated_size)",
          "new_text": null,
          "old_line_content": "        if ((err = av_reallocp(&d->buffer, new_allocated_size)) < 0) {",
          "new_line_content": "    if (new_size < d->pos || new_size > INT_MAX/2)",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": "av_crc_get_table",
          "new_api": null,
          "old_text": "av_crc_get_table(AV_CRC_32_IEEE)",
          "new_text": null,
          "old_line_content": "    return av_crc(av_crc_get_table(AV_CRC_32_IEEE), checksum, buf, len);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 969,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(d->buffer + d->pos, buf, buf_size)",
          "new_text": null,
          "old_line_content": "    memcpy(d->buffer + d->pos, buf, buf_size);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": "update_checksum",
          "new_api": null,
          "old_text": "s->update_checksum(s->checksum, s->checksum_ptr,\n                                     s->buf_ptr - s->checksum_ptr)",
          "new_text": null,
          "old_line_content": "    s->checksum = s->update_checksum(s->checksum, s->checksum_ptr,",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 982,
          "old_api": "AV_WB32",
          "new_api": null,
          "old_text": "AV_WB32(buf1, buf_size)",
          "new_text": null,
          "old_line_content": "    AV_WB32(buf1, buf_size);",
          "new_line_content": "    if (d->pos > d->size)",
          "content_same": false
        },
        {
          "line": 983,
          "old_api": "dyn_buf_write",
          "new_api": null,
          "old_text": "dyn_buf_write(opaque, buf1, 4)",
          "new_text": null,
          "old_line_content": "    ret = dyn_buf_write(opaque, buf1, 4);",
          "new_line_content": "        d->size = d->pos;",
          "content_same": false
        },
        {
          "line": 988,
          "old_api": "dyn_buf_write",
          "new_api": null,
          "old_text": "dyn_buf_write(opaque, buf, buf_size)",
          "new_text": null,
          "old_line_content": "    return dyn_buf_write(opaque, buf, buf_size);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 483,
          "old_api": "fill_buffer",
          "new_api": null,
          "old_text": "fill_buffer(s)",
          "new_text": null,
          "old_line_content": "        fill_buffer(s);",
          "new_line_content": "    s->update_checksum = update_checksum;",
          "content_same": false
        },
        {
          "line": 1012,
          "old_api": "av_mallocz",
          "new_api": null,
          "old_text": "av_mallocz(sizeof(DynBuffer) + io_buffer_size)",
          "new_text": null,
          "old_line_content": "    d = av_mallocz(sizeof(DynBuffer) + io_buffer_size);",
          "new_line_content": "    d->pos = offset;",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": "read_packet",
          "new_api": null,
          "old_text": "s->read_packet(s->opaque, buf, size)",
          "new_text": null,
          "old_line_content": "                    len = s->read_packet(s->opaque, buf, size);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1014,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "        return AVERROR(ENOMEM);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1016,
          "old_api": "avio_alloc_context",
          "new_api": null,
          "old_text": "avio_alloc_context(d->io_buffer, d->io_buffer_size, 1, d, NULL,\n                            max_packet_size ? dyn_packet_buf_write : dyn_buf_write,\n                            max_packet_size ? NULL : dyn_buf_seek)",
          "new_text": null,
          "old_line_content": "    *s = avio_alloc_context(d->io_buffer, d->io_buffer_size, 1, d, NULL,",
          "new_line_content": "static int url_open_dyn_buf_internal(AVIOContext **s, int max_packet_size)",
          "content_same": false
        },
        {
          "line": 1020,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(d)",
          "new_text": null,
          "old_line_content": "        av_free(d);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1021,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(ENOMEM)",
          "new_text": null,
          "old_line_content": "        return AVERROR(ENOMEM);",
          "new_line_content": "    if (sizeof(DynBuffer) + io_buffer_size < io_buffer_size)",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 16,
      "total_additions": 132,
      "total_deletions": 128,
      "total_api_changes": 276
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 12,
        "api_related_lines": 276,
        "non_api_lines": 6,
        "non_api_line_numbers": [
          237,
          242,
          243,
          244,
          249,
          250
        ]
      }
    },
    "api_calls_before": 169,
    "api_calls_after": 173,
    "diff_info": {
      "added_lines": 12,
      "removed_lines": 1,
      "total_diff_lines": 27
    }
  }
}