{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/4e2c08c5516adc8d31c67fbb1192b1fcaa472ee6",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/4e2c08c5516adc8d31c67fbb1192b1fcaa472ee6/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/4e2c08c5516adc8d31c67fbb1192b1fcaa472ee6/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/4e2c08c5516adc8d31c67fbb1192b1fcaa472ee6/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [],
      "additions": [
        {
          "line": 384,
          "old_api": null,
          "new_api": "distance_limited",
          "old_text": null,
          "new_text": "distance_limited(elbg->points + i*elbg->dim, elbg->codebook + best_idx*elbg->dim, dim, INT_MAX)",
          "old_line_content": "            for (k=0; k < elbg->numCB; k++) {",
          "new_line_content": "            best_dist = distance_limited(elbg->points + i*elbg->dim, elbg->codebook + best_idx*elbg->dim, dim, INT_MAX);",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": null,
          "new_api": "vect_division",
          "old_text": null,
          "new_text": "vect_division(elbg->codebook + i*elbg->dim,\n                          elbg->codebook + i*elbg->dim, size_part[i], elbg->dim)",
          "old_line_content": "    } while(((last_error - elbg->error) > DELTA_ERR_MAX*elbg->error) &&",
          "new_line_content": "            vect_division(elbg->codebook + i*elbg->dim,",
          "content_same": false
        },
        {
          "line": 386,
          "old_api": null,
          "new_api": "distance_limited",
          "old_text": null,
          "new_text": "distance_limited(elbg->points + i*elbg->dim, elbg->codebook + k*elbg->dim, dim, best_dist)",
          "old_line_content": "                if (dist < dist_cb[i]) {",
          "new_line_content": "                dist = distance_limited(elbg->points + i*elbg->dim, elbg->codebook + k*elbg->dim, dim, best_dist);",
          "content_same": false
        },
        {
          "line": 425,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(list_buffer)",
          "old_line_content": "}",
          "new_line_content": "    av_free(list_buffer);",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(elbg->cells)",
          "old_line_content": "",
          "new_line_content": "    av_free(elbg->cells);",
          "content_same": false
        },
        {
          "line": 427,
          "old_api": null,
          "new_api": "av_free",
          "old_text": null,
          "new_text": "av_free(elbg->utility_inc)",
          "old_line_content": "",
          "new_line_content": "    av_free(elbg->utility_inc);",
          "content_same": false
        },
        {
          "line": 365,
          "old_api": null,
          "new_api": "av_malloc",
          "old_text": null,
          "new_text": "av_malloc(numCB*sizeof(int))",
          "old_line_content": "    elbg->nearest_cb = closest_cb;",
          "new_line_content": "    elbg->utility = av_malloc(numCB*sizeof(int));",
          "content_same": false
        },
        {
          "line": 368,
          "old_api": null,
          "new_api": "av_malloc",
          "old_text": null,
          "new_text": "av_malloc(numCB*sizeof(int))",
          "old_line_content": "",
          "new_line_content": "    elbg->utility_inc = av_malloc(numCB*sizeof(int));",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": null,
          "new_api": "do_shiftings",
          "old_text": null,
          "new_text": "do_shiftings(elbg)",
          "old_line_content": "",
          "new_line_content": "        do_shiftings(elbg);",
          "content_same": false
        },
        {
          "line": 404,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(size_part, 0, numCB*sizeof(int))",
          "old_line_content": "",
          "new_line_content": "        memset(size_part, 0, numCB*sizeof(int));",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(elbg->codebook, 0, elbg->numCB*dim*sizeof(int))",
          "old_line_content": "            size_part[elbg->nearest_cb[i]]++;",
          "new_line_content": "        memset(elbg->codebook, 0, elbg->numCB*dim*sizeof(int));",
          "content_same": false
        },
        {
          "line": 377,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(elbg->cells, 0, numCB*sizeof(cell *))",
          "old_line_content": "",
          "new_line_content": "        memset(elbg->cells, 0, numCB*sizeof(cell *));",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 385,
          "old_api": "distance_limited",
          "new_api": null,
          "old_text": "distance_limited(elbg->points + i*elbg->dim, elbg->codebook + k*elbg->dim, dim, dist_cb[i])",
          "new_text": null,
          "old_line_content": "                dist = distance_limited(elbg->points + i*elbg->dim, elbg->codebook + k*elbg->dim, dim, dist_cb[i]);",
          "new_line_content": "            for (k=0; k < elbg->numCB; k++) {",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(dist_cb)",
          "new_text": null,
          "old_line_content": "    av_free(dist_cb);",
          "new_line_content": "    } while(((last_error - elbg->error) > DELTA_ERR_MAX*elbg->error) &&",
          "content_same": false
        },
        {
          "line": 420,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(size_part)",
          "new_text": null,
          "old_line_content": "    av_free(size_part);",
          "new_line_content": "            (steps < max_steps));",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": "av_free",
          "new_api": null,
          "old_text": "av_free(elbg->utility)",
          "new_text": null,
          "old_line_content": "    av_free(elbg->utility);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 363,
          "old_api": "av_malloc",
          "new_api": null,
          "old_text": "av_malloc(numCB*sizeof(cell *))",
          "new_text": null,
          "old_line_content": "    elbg->cells = av_malloc(numCB*sizeof(cell *));",
          "new_line_content": "    elbg->codebook = codebook;",
          "content_same": false
        },
        {
          "line": 399,
          "old_api": "do_shiftings",
          "new_api": null,
          "old_text": "do_shiftings(elbg)",
          "new_text": null,
          "old_line_content": "        do_shiftings(elbg);",
          "new_line_content": "            free_cells++;",
          "content_same": false
        },
        {
          "line": 367,
          "old_api": "av_malloc",
          "new_api": null,
          "old_text": "av_malloc(numCB*sizeof(int))",
          "new_text": null,
          "old_line_content": "    elbg->utility_inc = av_malloc(numCB*sizeof(int));",
          "new_line_content": "    elbg->points = points;",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(size_part, 0, numCB*sizeof(int))",
          "new_text": null,
          "old_line_content": "        memset(size_part, 0, numCB*sizeof(int));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(elbg->codebook, 0, elbg->numCB*dim*sizeof(int))",
          "new_text": null,
          "old_line_content": "        memset(elbg->codebook, 0, elbg->numCB*dim*sizeof(int));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(elbg->utility, 0, numCB*sizeof(int))",
          "new_text": null,
          "old_line_content": "        memset(elbg->utility, 0, numCB*sizeof(int));",
          "new_line_content": "        steps++;",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": "vect_division",
          "new_api": null,
          "old_text": "vect_division(elbg->codebook + i*elbg->dim,\n                          elbg->codebook + i*elbg->dim, size_part[i], elbg->dim)",
          "new_text": null,
          "old_line_content": "            vect_division(elbg->codebook + i*elbg->dim,",
          "new_line_content": "        }",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 0,
      "total_additions": 12,
      "total_deletions": 11,
      "total_api_changes": 23
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 10,
        "api_related_lines": 23,
        "non_api_lines": 7,
        "non_api_line_numbers": [
          387,
          388,
          389,
          358,
          392,
          393,
          383
        ]
      }
    },
    "api_calls_before": 55,
    "api_calls_after": 56,
    "diff_info": {
      "added_lines": 8,
      "removed_lines": 5,
      "total_diff_lines": 35
    }
  }
}