{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/0e3cec9f7d9353b01ef7af0d67a39a66c4ec899c",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/0e3cec9f7d9353b01ef7af0d67a39a66c4ec899c/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/0e3cec9f7d9353b01ef7af0d67a39a66c4ec899c/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/0e3cec9f7d9353b01ef7af0d67a39a66c4ec899c/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1674,
          "old_api": "sbr_qmf_analysis",
          "new_api": "sbr_dequant",
          "old_text": "sbr_qmf_analysis(&ac->dsp, &sbr->mdct_ana, &sbr->dsp, ch ? R : L, sbr->data[ch].analysis_filterbank_samples,\n                         (float*)sbr->qmf_filter_scratch,\n                         sbr->data[ch].W)",
          "new_text": "sbr_dequant(sbr, id_aac)",
          "old_line_content": "        sbr_qmf_analysis(&ac->dsp, &sbr->mdct_ana, &sbr->dsp, ch ? R : L, sbr->data[ch].analysis_filterbank_samples,",
          "new_line_content": "        sbr_dequant(sbr, id_aac);",
          "content_same": false
        },
        {
          "line": 1681,
          "old_api": "sbr_chirp",
          "new_api": "sbr_lf_gen",
          "old_text": "sbr_chirp(sbr, &sbr->data[ch])",
          "new_text": "sbr_lf_gen(ac, sbr, sbr->X_low, sbr->data[ch].W)",
          "old_line_content": "            sbr_chirp(sbr, &sbr->data[ch]);",
          "new_line_content": "        sbr_lf_gen(ac, sbr, sbr->X_low, sbr->data[ch].W);",
          "content_same": false
        },
        {
          "line": 1691,
          "old_api": "sbr_hf_assemble",
          "new_api": "sbr_mapping",
          "old_text": "sbr_hf_assemble(sbr->data[ch].Y[sbr->data[ch].Ypos],\n                                sbr->X_high, sbr, &sbr->data[ch],\n                                sbr->data[ch].e_a)",
          "new_text": "sbr_mapping(ac, sbr, &sbr->data[ch], sbr->data[ch].e_a)",
          "old_line_content": "                sbr_hf_assemble(sbr->data[ch].Y[sbr->data[ch].Ypos],",
          "new_line_content": "            err = sbr_mapping(ac, sbr, &sbr->data[ch], sbr->data[ch].e_a);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1702,
          "old_api": null,
          "new_api": "sbr_x_gen",
          "old_text": null,
          "new_text": "sbr_x_gen(sbr, sbr->X[ch],\n                  sbr->data[ch].Y[1-sbr->data[ch].Ypos],\n                  sbr->data[ch].Y[  sbr->data[ch].Ypos],\n                  sbr->X_low, ch)",
          "old_line_content": "    }",
          "new_line_content": "        sbr_x_gen(sbr, sbr->X[ch],",
          "content_same": false
        },
        {
          "line": 1678,
          "old_api": null,
          "new_api": "sbr_qmf_analysis",
          "old_text": null,
          "new_text": "sbr_qmf_analysis(&ac->dsp, &sbr->mdct_ana, &sbr->dsp, ch ? R : L, sbr->data[ch].analysis_filterbank_samples,\n                         (float*)sbr->qmf_filter_scratch,\n                         sbr->data[ch].W)",
          "old_line_content": "        sbr->data[ch].Ypos ^= 1;",
          "new_line_content": "        sbr_qmf_analysis(&ac->dsp, &sbr->mdct_ana, &sbr->dsp, ch ? R : L, sbr->data[ch].analysis_filterbank_samples,",
          "content_same": false
        },
        {
          "line": 1710,
          "old_api": null,
          "new_api": "ff_ps_apply",
          "old_text": null,
          "new_text": "ff_ps_apply(ac->avctx, &sbr->ps, sbr->X[0], sbr->X[1], sbr->kx[1] + sbr->m[1])",
          "old_line_content": "        nch = 2;",
          "new_line_content": "            ff_ps_apply(ac->avctx, &sbr->ps, sbr->X[0], sbr->X[1], sbr->kx[1] + sbr->m[1]);",
          "content_same": false
        },
        {
          "line": 1712,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(sbr->X[1], sbr->X[0], sizeof(sbr->X[0]))",
          "old_line_content": "",
          "new_line_content": "            memcpy(sbr->X[1], sbr->X[0], sizeof(sbr->X[0]));",
          "content_same": false
        },
        {
          "line": 1684,
          "old_api": null,
          "new_api": "sbr_hf_inverse_filter",
          "old_text": null,
          "new_text": "sbr_hf_inverse_filter(&sbr->dsp, sbr->alpha0, sbr->alpha1, sbr->X_low, sbr->k[0])",
          "old_line_content": "                       sbr->data[ch].bs_num_env);",
          "new_line_content": "            sbr_hf_inverse_filter(&sbr->dsp, sbr->alpha0, sbr->alpha1, sbr->X_low, sbr->k[0]);",
          "content_same": false
        },
        {
          "line": 1685,
          "old_api": null,
          "new_api": "sbr_chirp",
          "old_text": null,
          "new_text": "sbr_chirp(sbr, &sbr->data[ch])",
          "old_line_content": "",
          "new_line_content": "            sbr_chirp(sbr, &sbr->data[ch]);",
          "content_same": false
        },
        {
          "line": 1717,
          "old_api": null,
          "new_api": "sbr_qmf_synthesis",
          "old_text": null,
          "new_text": "sbr_qmf_synthesis(&ac->dsp, &sbr->mdct, &sbr->dsp, L, sbr->X[0], sbr->qmf_filter_scratch,\n                      sbr->data[0].synthesis_filterbank_samples,\n                      &sbr->data[0].synthesis_filterbank_samples_offset,\n                      downsampled)",
          "old_line_content": "    if (nch == 2)",
          "new_line_content": "    sbr_qmf_synthesis(&ac->dsp, &sbr->mdct, &sbr->dsp, L, sbr->X[0], sbr->qmf_filter_scratch,",
          "content_same": false
        },
        {
          "line": 1686,
          "old_api": null,
          "new_api": "sbr_hf_gen",
          "old_text": null,
          "new_text": "sbr_hf_gen(ac, sbr, sbr->X_high, sbr->X_low, sbr->alpha0, sbr->alpha1,\n                       sbr->data[ch].bw_array, sbr->data[ch].t_env,\n                       sbr->data[ch].bs_num_env)",
          "old_line_content": "            // hf_adj",
          "new_line_content": "            sbr_hf_gen(ac, sbr, sbr->X_high, sbr->X_low, sbr->alpha0, sbr->alpha1,",
          "content_same": false
        },
        {
          "line": 1722,
          "old_api": null,
          "new_api": "sbr_qmf_synthesis",
          "old_text": null,
          "new_text": "sbr_qmf_synthesis(&ac->dsp, &sbr->mdct, &sbr->dsp, R, sbr->X[1], sbr->qmf_filter_scratch,\n                          sbr->data[1].synthesis_filterbank_samples,\n                          &sbr->data[1].synthesis_filterbank_samples_offset,\n                          downsampled)",
          "old_line_content": "}",
          "new_line_content": "        sbr_qmf_synthesis(&ac->dsp, &sbr->mdct, &sbr->dsp, R, sbr->X[1], sbr->qmf_filter_scratch,",
          "content_same": false
        },
        {
          "line": 1693,
          "old_api": null,
          "new_api": "sbr_env_estimate",
          "old_text": null,
          "new_text": "sbr_env_estimate(sbr->e_curr, sbr->X_high, sbr, &sbr->data[ch])",
          "old_line_content": "                                sbr->data[ch].e_a);",
          "new_line_content": "                sbr_env_estimate(sbr->e_curr, sbr->X_high, sbr, &sbr->data[ch]);",
          "content_same": false
        },
        {
          "line": 1694,
          "old_api": null,
          "new_api": "sbr_gain_calc",
          "old_text": null,
          "new_text": "sbr_gain_calc(ac, sbr, &sbr->data[ch], sbr->data[ch].e_a)",
          "old_line_content": "            }",
          "new_line_content": "                sbr_gain_calc(ac, sbr, &sbr->data[ch], sbr->data[ch].e_a);",
          "content_same": false
        },
        {
          "line": 1695,
          "old_api": null,
          "new_api": "sbr_hf_assemble",
          "old_text": null,
          "new_text": "sbr_hf_assemble(sbr->data[ch].Y[sbr->data[ch].Ypos],\n                                sbr->X_high, sbr, &sbr->data[ch],\n                                sbr->data[ch].e_a)",
          "old_line_content": "        }",
          "new_line_content": "                sbr_hf_assemble(sbr->data[ch].Y[sbr->data[ch].Ypos],",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1698,
          "old_api": "sbr_x_gen",
          "new_api": null,
          "old_text": "sbr_x_gen(sbr, sbr->X[ch],\n                  sbr->data[ch].Y[1-sbr->data[ch].Ypos],\n                  sbr->data[ch].Y[  sbr->data[ch].Ypos],\n                  sbr->X_low, ch)",
          "new_text": null,
          "old_line_content": "        sbr_x_gen(sbr, sbr->X[ch],",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1670,
          "old_api": "sbr_dequant",
          "new_api": null,
          "old_text": "sbr_dequant(sbr, id_aac)",
          "new_text": null,
          "old_line_content": "        sbr_dequant(sbr, id_aac);",
          "new_line_content": "        sbr->kx_and_m_pushed = 0;",
          "content_same": false
        },
        {
          "line": 1706,
          "old_api": "ff_ps_apply",
          "new_api": null,
          "old_text": "ff_ps_apply(ac->avctx, &sbr->ps, sbr->X[0], sbr->X[1], sbr->kx[1] + sbr->m[1])",
          "new_text": null,
          "old_line_content": "            ff_ps_apply(ac->avctx, &sbr->ps, sbr->X[0], sbr->X[1], sbr->kx[1] + sbr->m[1]);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1708,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(sbr->X[1], sbr->X[0], sizeof(sbr->X[0]))",
          "new_text": null,
          "old_line_content": "            memcpy(sbr->X[1], sbr->X[0], sizeof(sbr->X[0]));",
          "new_line_content": "    if (ac->oc[1].m4ac.ps == 1) {",
          "content_same": false
        },
        {
          "line": 1677,
          "old_api": "sbr_lf_gen",
          "new_api": null,
          "old_text": "sbr_lf_gen(ac, sbr, sbr->X_low, sbr->data[ch].W)",
          "new_text": null,
          "old_line_content": "        sbr_lf_gen(ac, sbr, sbr->X_low, sbr->data[ch].W);",
          "new_line_content": "        /* decode channel */",
          "content_same": false
        },
        {
          "line": 1680,
          "old_api": "sbr_hf_inverse_filter",
          "new_api": null,
          "old_text": "sbr_hf_inverse_filter(&sbr->dsp, sbr->alpha0, sbr->alpha1, sbr->X_low, sbr->k[0])",
          "new_text": null,
          "old_line_content": "            sbr_hf_inverse_filter(&sbr->dsp, sbr->alpha0, sbr->alpha1, sbr->X_low, sbr->k[0]);",
          "new_line_content": "                         sbr->data[ch].W);",
          "content_same": false
        },
        {
          "line": 1713,
          "old_api": "sbr_qmf_synthesis",
          "new_api": null,
          "old_text": "sbr_qmf_synthesis(&ac->dsp, &sbr->mdct, &sbr->dsp, L, sbr->X[0], sbr->qmf_filter_scratch,\n                      sbr->data[0].synthesis_filterbank_samples,\n                      &sbr->data[0].synthesis_filterbank_samples_offset,\n                      downsampled)",
          "new_text": null,
          "old_line_content": "    sbr_qmf_synthesis(&ac->dsp, &sbr->mdct, &sbr->dsp, L, sbr->X[0], sbr->qmf_filter_scratch,",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1682,
          "old_api": "sbr_hf_gen",
          "new_api": null,
          "old_text": "sbr_hf_gen(ac, sbr, sbr->X_high, sbr->X_low, sbr->alpha0, sbr->alpha1,\n                       sbr->data[ch].bw_array, sbr->data[ch].t_env,\n                       sbr->data[ch].bs_num_env)",
          "new_text": null,
          "old_line_content": "            sbr_hf_gen(ac, sbr, sbr->X_high, sbr->X_low, sbr->alpha0, sbr->alpha1,",
          "new_line_content": "        sbr->data[ch].Ypos ^= 1;",
          "content_same": false
        },
        {
          "line": 1718,
          "old_api": "sbr_qmf_synthesis",
          "new_api": null,
          "old_text": "sbr_qmf_synthesis(&ac->dsp, &sbr->mdct, &sbr->dsp, R, sbr->X[1], sbr->qmf_filter_scratch,\n                          sbr->data[1].synthesis_filterbank_samples,\n                          &sbr->data[1].synthesis_filterbank_samples_offset,\n                          downsampled)",
          "new_text": null,
          "old_line_content": "        sbr_qmf_synthesis(&ac->dsp, &sbr->mdct, &sbr->dsp, R, sbr->X[1], sbr->qmf_filter_scratch,",
          "new_line_content": "                      sbr->data[0].synthesis_filterbank_samples,",
          "content_same": false
        },
        {
          "line": 1687,
          "old_api": "sbr_mapping",
          "new_api": null,
          "old_text": "sbr_mapping(ac, sbr, &sbr->data[ch], sbr->data[ch].e_a)",
          "new_text": null,
          "old_line_content": "            err = sbr_mapping(ac, sbr, &sbr->data[ch], sbr->data[ch].e_a);",
          "new_line_content": "                       sbr->data[ch].bw_array, sbr->data[ch].t_env,",
          "content_same": false
        },
        {
          "line": 1689,
          "old_api": "sbr_env_estimate",
          "new_api": null,
          "old_text": "sbr_env_estimate(sbr->e_curr, sbr->X_high, sbr, &sbr->data[ch])",
          "new_text": null,
          "old_line_content": "                sbr_env_estimate(sbr->e_curr, sbr->X_high, sbr, &sbr->data[ch]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1690,
          "old_api": "sbr_gain_calc",
          "new_api": null,
          "old_text": "sbr_gain_calc(ac, sbr, &sbr->data[ch], sbr->data[ch].e_a)",
          "new_text": null,
          "old_line_content": "                sbr_gain_calc(ac, sbr, &sbr->data[ch], sbr->data[ch].e_a);",
          "new_line_content": "            // hf_adj",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 3,
      "total_additions": 12,
      "total_deletions": 12,
      "total_api_changes": 27
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 10,
        "api_related_lines": 27,
        "non_api_lines": 10,
        "non_api_line_numbers": [
          1638,
          1639,
          1640,
          1641,
          1642,
          1643,
          1644,
          1645,
          1647,
          1648
        ]
      }
    },
    "api_calls_before": 293,
    "api_calls_after": 293,
    "diff_info": {
      "added_lines": 10,
      "removed_lines": 6,
      "total_diff_lines": 29
    }
  }
}