{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/cc767a89690935048373151a556041fde536c6ef",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/cc767a89690935048373151a556041fde536c6ef/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/cc767a89690935048373151a556041fde536c6ef/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/cc767a89690935048373151a556041fde536c6ef/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1145,
          "old_api": "ilog",
          "new_api": "put_bits",
          "old_text": "ilog(range - 1)",
          "new_text": "put_bits(pb, 1, 1)",
          "old_line_content": "    put_bits(pb, ilog(range - 1), posts[0]);",
          "new_line_content": "    put_bits(pb, 1, 1); // non zero",
          "content_same": false
        },
        {
          "line": 1411,
          "old_api": "floor_encode",
          "new_api": "floor_fit",
          "old_text": "floor_encode(venc, fc, &pb, posts, &venc->floor[i * samples], samples)",
          "new_text": "floor_fit(venc, fc, &venc->coeffs[i * samples], posts, samples)",
          "old_line_content": "        floor_encode(venc, fc, &pb, posts, &venc->floor[i * samples], samples);",
          "new_line_content": "        floor_fit(venc, fc, &venc->coeffs[i * samples], posts, samples);",
          "content_same": false
        },
        {
          "line": 1443,
          "old_api": "put_bits_count",
          "new_api": "flush_put_bits",
          "old_text": "put_bits_count(&pb)",
          "new_text": "flush_put_bits(&pb)",
          "old_line_content": "    return (put_bits_count(&pb) + 7) / 8;",
          "new_line_content": "    flush_put_bits(&pb);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1412,
          "old_api": null,
          "new_api": "floor_encode",
          "old_text": null,
          "new_text": "floor_encode(venc, fc, &pb, posts, &venc->floor[i * samples], samples)",
          "old_line_content": "    }",
          "new_line_content": "        floor_encode(venc, fc, &pb, posts, &venc->floor[i * samples], samples);",
          "content_same": false
        },
        {
          "line": 1158,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(highroom, lowroom)",
          "old_line_content": "        if (predicted == posts[i]) {",
          "new_line_content": "        int room = FFMIN(highroom, lowroom);",
          "content_same": false
        },
        {
          "line": 1286,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(!(psize % book->ndimentions))",
          "old_line_content": "",
          "new_line_content": "                    assert(!(psize % book->ndimentions));",
          "content_same": false
        },
        {
          "line": 1290,
          "old_api": null,
          "new_api": "put_vector",
          "old_text": null,
          "new_text": "put_vector(book, pb, &buf[k])",
          "old_line_content": "                            int l;",
          "new_line_content": "                            float * a = put_vector(book, pb, &buf[k]);",
          "content_same": false
        },
        {
          "line": 1300,
          "old_api": null,
          "new_api": "put_vector",
          "old_text": null,
          "new_text": "put_vector(book, pb, vec)",
          "old_line_content": "                            for (l = s; l < s + dim; l++)",
          "new_line_content": "                            a = put_vector(book, pb, vec);",
          "content_same": false
        },
        {
          "line": 1441,
          "old_api": null,
          "new_api": "residue_encode",
          "old_text": null,
          "new_text": "residue_encode(venc, &venc->residues[mapping->residue[mapping->mux[0]]], &pb, venc->coeffs, samples, venc->channels)",
          "old_line_content": "",
          "new_line_content": "    residue_encode(venc, &venc->residues[mapping->residue[mapping->mux[0]]], &pb, venc->coeffs, samples, venc->channels);",
          "content_same": false
        },
        {
          "line": 1444,
          "old_api": null,
          "new_api": "put_bits_count",
          "old_text": null,
          "new_text": "put_bits_count(&pb)",
          "old_line_content": "}",
          "new_line_content": "    return (put_bits_count(&pb) + 7) / 8;",
          "content_same": false
        },
        {
          "line": 1190,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(l != csub)",
          "old_line_content": "                cval |= l << cshift;",
          "new_line_content": "                assert(l != csub);",
          "content_same": false
        },
        {
          "line": 1194,
          "old_api": null,
          "new_api": "put_codeword",
          "old_text": null,
          "new_text": "put_codeword(pb, book, cval)",
          "old_line_content": "        }",
          "new_line_content": "            put_codeword(pb, book, cval);",
          "content_same": false
        },
        {
          "line": 1322,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(venc->samples + channel*window_len*2, venc->saved + channel*window_len, sizeof(float)*window_len)",
          "old_line_content": "        }",
          "new_line_content": "            memcpy(venc->samples + channel*window_len*2, venc->saved + channel*window_len, sizeof(float)*window_len);",
          "content_same": false
        },
        {
          "line": 1326,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(venc->samples + channel*window_len*2, 0, sizeof(float)*window_len)",
          "old_line_content": "        }",
          "new_line_content": "            memset(venc->samples + channel*window_len*2, 0, sizeof(float)*window_len);",
          "content_same": false
        },
        {
          "line": 1457,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&venc->codebooks[i].dimentions)",
          "old_line_content": "    }",
          "new_line_content": "        av_freep(&venc->codebooks[i].dimentions);",
          "content_same": false
        },
        {
          "line": 1202,
          "old_api": null,
          "new_api": "put_codeword",
          "old_text": null,
          "new_text": "put_codeword(pb, &venc->codebooks[book], entry)",
          "old_line_content": "        }",
          "new_line_content": "            put_codeword(pb, &venc->codebooks[book], entry);",
          "content_same": false
        },
        {
          "line": 1459,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&venc->codebooks)",
          "old_line_content": "",
          "new_line_content": "    av_freep(&venc->codebooks);",
          "content_same": false
        },
        {
          "line": 1463,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&venc->floors[i].classes)",
          "old_line_content": "        if (venc->floors[i].classes)",
          "new_line_content": "        av_freep(&venc->floors[i].classes);",
          "content_same": false
        },
        {
          "line": 1211,
          "old_api": null,
          "new_api": "render_line",
          "old_text": null,
          "new_text": "render_line(lx, ly, fc->list[pos].x, posts[pos] * fc->multiplier, floor, samples)",
          "old_line_content": "            lx = fc->list[pos].x;",
          "new_line_content": "            render_line(lx, ly, fc->list[pos].x, posts[pos] * fc->multiplier, floor, samples);",
          "content_same": false
        },
        {
          "line": 1339,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(venc->samples + channel*window_len*2 + window_len, 0, sizeof(float)*window_len)",
          "old_line_content": "        }",
          "new_line_content": "            memset(venc->samples + channel*window_len*2 + window_len, 0, sizeof(float)*window_len);",
          "content_same": false
        },
        {
          "line": 1468,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&venc->floors[i].list)",
          "old_line_content": "    }",
          "new_line_content": "        av_freep(&venc->floors[i].list);",
          "content_same": false
        },
        {
          "line": 1470,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&venc->floors)",
          "old_line_content": "",
          "new_line_content": "    av_freep(&venc->floors);",
          "content_same": false
        },
        {
          "line": 1344,
          "old_api": null,
          "new_api": "ff_mdct_calc",
          "old_text": null,
          "new_text": "ff_mdct_calc(&venc->mdct[0], venc->coeffs + channel*window_len, venc->samples + channel*window_len*2, venc->floor/*tmp*/)",
          "old_line_content": "    }",
          "new_line_content": "        ff_mdct_calc(&venc->mdct[0], venc->coeffs + channel*window_len, venc->samples + channel*window_len*2, venc->floor/*tmp*/);",
          "content_same": false
        },
        {
          "line": 1217,
          "old_api": null,
          "new_api": "render_line",
          "old_text": null,
          "new_text": "render_line(lx, ly, samples, ly, floor, samples)",
          "old_line_content": "}",
          "new_line_content": "    if (lx < samples) render_line(lx, ly, samples, ly, floor, samples);",
          "content_same": false
        },
        {
          "line": 1474,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&venc->residues[i].maxes)",
          "old_line_content": "    }",
          "new_line_content": "        av_freep(&venc->residues[i].maxes);",
          "content_same": false
        },
        {
          "line": 1476,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&venc->residues)",
          "old_line_content": "",
          "new_line_content": "    av_freep(&venc->residues);",
          "content_same": false
        },
        {
          "line": 1224,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(book->dimentions)",
          "old_line_content": "    for (i = 0; i < book->nentries; i++) {",
          "new_line_content": "    assert(book->dimentions);",
          "content_same": false
        },
        {
          "line": 1481,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&venc->mappings[i].residue)",
          "old_line_content": "    }",
          "new_line_content": "        av_freep(&venc->mappings[i].residue);",
          "content_same": false
        },
        {
          "line": 1483,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&venc->mappings)",
          "old_line_content": "",
          "new_line_content": "    av_freep(&venc->mappings);",
          "content_same": false
        },
        {
          "line": 1485,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&venc->modes)",
          "old_line_content": "",
          "new_line_content": "    av_freep(&venc->modes);",
          "content_same": false
        },
        {
          "line": 1490,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&venc->coeffs)",
          "old_line_content": "",
          "new_line_content": "    av_freep(&venc->coeffs);",
          "content_same": false
        },
        {
          "line": 1493,
          "old_api": null,
          "new_api": "ff_mdct_end",
          "old_text": null,
          "new_text": "ff_mdct_end(&venc->mdct[1])",
          "old_line_content": "",
          "new_line_content": "    ff_mdct_end(&venc->mdct[1]);",
          "content_same": false
        },
        {
          "line": 1238,
          "old_api": null,
          "new_api": "put_codeword",
          "old_text": null,
          "new_text": "put_codeword(pb, book, entry)",
          "old_line_content": "    return &book->dimentions[entry * book->ndimentions];",
          "new_line_content": "    put_codeword(pb, book, entry);",
          "content_same": false
        },
        {
          "line": 1367,
          "old_api": null,
          "new_api": "create_vorbis_context",
          "old_text": null,
          "new_text": "create_vorbis_context(venc, avccontext)",
          "old_line_content": "",
          "new_line_content": "    create_vorbis_context(venc, avccontext);",
          "content_same": false
        },
        {
          "line": 1496,
          "old_api": null,
          "new_api": "av_freep",
          "old_text": null,
          "new_text": "av_freep(&avccontext->extradata)",
          "old_line_content": "",
          "new_line_content": "    av_freep(&avccontext->extradata);",
          "content_same": false
        },
        {
          "line": 1372,
          "old_api": null,
          "new_api": "put_main_header",
          "old_text": null,
          "new_text": "put_main_header(venc, (uint8_t**)&avccontext->extradata)",
          "old_line_content": "",
          "new_line_content": "    avccontext->extradata_size = put_main_header(venc, (uint8_t**)&avccontext->extradata);",
          "content_same": false
        },
        {
          "line": 1120,
          "old_api": null,
          "new_api": "get_floor_average",
          "old_text": null,
          "new_text": "get_floor_average(fc, coeffs, i)",
          "old_line_content": "    tot_average /= fc->values;",
          "new_line_content": "    for (i = 0; i < fc->values; i++) tot_average += averages[i] = get_floor_average(fc, coeffs, i);",
          "content_same": false
        },
        {
          "line": 1376,
          "old_api": null,
          "new_api": "avcodec_alloc_frame",
          "old_text": null,
          "new_text": "avcodec_alloc_frame()",
          "old_line_content": "    avccontext->coded_frame->key_frame = 1;",
          "new_line_content": "    avccontext->coded_frame = avcodec_alloc_frame();",
          "content_same": false
        },
        {
          "line": 1251,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(real_ch == 2)",
          "old_line_content": "    for (p = 0; p < partitions; p++) {",
          "new_line_content": "    assert(real_ch == 2);",
          "content_same": false
        },
        {
          "line": 1129,
          "old_api": null,
          "new_api": "pow",
          "old_text": null,
          "new_text": "pow(0.8, position/200.)",
          "old_line_content": "        for (j = 0; j < range - 1; j++) if (ff_vorbis_floor1_inverse_db_table[j * fc->multiplier] > average) break;",
          "new_line_content": "        average /= pow(average, 0.5) / tot_average * pow(0.8, position/200.); // MAGIC!",
          "content_same": false
        },
        {
          "line": 1257,
          "old_api": null,
          "new_api": "fabs",
          "old_text": null,
          "new_text": "fabs(coeffs[samples + k / real_ch])",
          "old_line_content": "        }",
          "new_line_content": "            if (fabs(coeffs[samples + k / real_ch]) > max2) max2 = fabs(coeffs[samples + k / real_ch]);",
          "content_same": false
        },
        {
          "line": 1392,
          "old_api": null,
          "new_api": "window",
          "old_text": null,
          "new_text": "window(venc, audio, samples)",
          "old_line_content": "    samples = 1 << (venc->blocksize[0] - 1);",
          "new_line_content": "    if (!window(venc, audio, samples)) return 0;",
          "content_same": false
        },
        {
          "line": 1395,
          "old_api": null,
          "new_api": "init_put_bits",
          "old_text": null,
          "new_text": "init_put_bits(&pb, packets, buf_size)",
          "old_line_content": "",
          "new_line_content": "    init_put_bits(&pb, packets, buf_size);",
          "content_same": false
        },
        {
          "line": 1397,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&pb, 1, 0)",
          "old_line_content": "",
          "new_line_content": "    put_bits(&pb, 1, 0); // magic bit",
          "content_same": false
        },
        {
          "line": 1399,
          "old_api": null,
          "new_api": "ilog",
          "old_text": null,
          "new_text": "ilog(venc->nmodes - 1)",
          "old_line_content": "",
          "new_line_content": "    put_bits(&pb, ilog(venc->nmodes - 1), 0); // 0 bits, the mode",
          "content_same": false
        },
        {
          "line": 1147,
          "old_api": null,
          "new_api": "ilog",
          "old_text": null,
          "new_text": "ilog(range - 1)",
          "old_line_content": "    coded[0] = coded[1] = 1;",
          "new_line_content": "    put_bits(pb, ilog(range - 1), posts[1]);",
          "content_same": false
        },
        {
          "line": 1276,
          "old_api": null,
          "new_api": "put_codeword",
          "old_text": null,
          "new_text": "put_codeword(pb, book, entry)",
          "old_line_content": "            }",
          "new_line_content": "                put_codeword(pb, book, entry);",
          "content_same": false
        },
        {
          "line": 1405,
          "old_api": null,
          "new_api": "put_bits",
          "old_text": null,
          "new_text": "put_bits(&pb, 1, 0)",
          "old_line_content": "    }",
          "new_line_content": "        put_bits(&pb, 1, 0);",
          "content_same": false
        },
        {
          "line": 1151,
          "old_api": null,
          "new_api": "render_point",
          "old_text": null,
          "new_text": "render_point(fc->list[fc->list[i].low].x,\n                                     posts[fc->list[i].low],\n                                     fc->list[fc->list[i].high].x,\n                                     posts[fc->list[i].high],\n                                     fc->list[i].x)",
          "old_line_content": "                                     posts[fc->list[i].low],",
          "new_line_content": "        int predicted = render_point(fc->list[fc->list[i].low].x,",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1410,
          "old_api": "floor_fit",
          "new_api": null,
          "old_text": "floor_fit(venc, fc, &venc->coeffs[i * samples], posts, samples)",
          "new_text": null,
          "old_line_content": "        floor_fit(venc, fc, &venc->coeffs[i * samples], posts, samples);",
          "new_line_content": "        int posts[fc->values];",
          "content_same": false
        },
        {
          "line": 1284,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(rc->type == 0 || rc->type == 2)",
          "new_text": null,
          "old_line_content": "                    assert(rc->type == 0 || rc->type == 2);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1157,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(highroom, lowroom)",
          "new_text": null,
          "old_line_content": "        int room = FFMIN(highroom, lowroom);",
          "new_line_content": "        int lowroom = predicted;",
          "content_same": false
        },
        {
          "line": 1289,
          "old_api": "put_vector",
          "new_api": null,
          "old_text": "put_vector(book, pb, &buf[k])",
          "new_text": null,
          "old_line_content": "                            float * a = put_vector(book, pb, &buf[k]);",
          "new_line_content": "                        for (k = 0; k < psize; k += book->ndimentions) {",
          "content_same": false
        },
        {
          "line": 1299,
          "old_api": "put_vector",
          "new_api": null,
          "old_text": "put_vector(book, pb, vec)",
          "new_text": null,
          "old_line_content": "                            a = put_vector(book, pb, vec);",
          "new_line_content": "                                *a++ = coeffs[(l % real_ch) * samples + l / real_ch];",
          "content_same": false
        },
        {
          "line": 1403,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&pb, 1, 0)",
          "new_text": null,
          "old_line_content": "        put_bits(&pb, 1, 0);",
          "new_line_content": "    if (mode->blockflag) {",
          "content_same": false
        },
        {
          "line": 1440,
          "old_api": "residue_encode",
          "new_api": null,
          "old_text": "residue_encode(venc, &venc->residues[mapping->residue[mapping->mux[0]]], &pb, venc->coeffs, samples, venc->channels)",
          "new_text": null,
          "old_line_content": "    residue_encode(venc, &venc->residues[mapping->residue[mapping->mux[0]]], &pb, venc->coeffs, samples, venc->channels);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1442,
          "old_api": "flush_put_bits",
          "new_api": null,
          "old_text": "flush_put_bits(&pb)",
          "new_text": null,
          "old_line_content": "    flush_put_bits(&pb);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1189,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(l != csub)",
          "new_text": null,
          "old_line_content": "                assert(l != csub);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1193,
          "old_api": "put_codeword",
          "new_api": null,
          "old_text": "put_codeword(pb, book, cval)",
          "new_text": null,
          "old_line_content": "            put_codeword(pb, book, cval);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1321,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(venc->samples + channel*window_len*2, venc->saved + channel*window_len, sizeof(float)*window_len)",
          "new_text": null,
          "old_line_content": "            memcpy(venc->samples + channel*window_len*2, venc->saved + channel*window_len, sizeof(float)*window_len);",
          "new_line_content": "        for (channel = 0; channel < venc->channels; channel++) {",
          "content_same": false
        },
        {
          "line": 1325,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(venc->samples + channel*window_len*2, 0, sizeof(float)*window_len)",
          "new_text": null,
          "old_line_content": "            memset(venc->samples + channel*window_len*2, 0, sizeof(float)*window_len);",
          "new_line_content": "        for (channel = 0; channel < venc->channels; channel++) {",
          "content_same": false
        },
        {
          "line": 1453,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&venc->codebooks[i].lens)",
          "new_text": null,
          "old_line_content": "        av_freep(&venc->codebooks[i].lens);",
          "new_line_content": "    if (venc->codebooks) for (i = 0; i < venc->ncodebooks; i++) {",
          "content_same": false
        },
        {
          "line": 1201,
          "old_api": "put_codeword",
          "new_api": null,
          "old_text": "put_codeword(pb, &venc->codebooks[book], entry)",
          "new_text": null,
          "old_line_content": "            put_codeword(pb, &venc->codebooks[book], entry);",
          "new_line_content": "            if (entry == -1) entry = 0;",
          "content_same": false
        },
        {
          "line": 1458,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&venc->codebooks)",
          "new_text": null,
          "old_line_content": "    av_freep(&venc->codebooks);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1462,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&venc->floors[i].classes)",
          "new_text": null,
          "old_line_content": "        av_freep(&venc->floors[i].classes);",
          "new_line_content": "        int j;",
          "content_same": false
        },
        {
          "line": 1465,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&venc->floors[i].classes[j].books)",
          "new_text": null,
          "old_line_content": "                av_freep(&venc->floors[i].classes[j].books);",
          "new_line_content": "            for (j = 0; j < venc->floors[i].nclasses; j++)",
          "content_same": false
        },
        {
          "line": 1210,
          "old_api": "render_line",
          "new_api": null,
          "old_text": "render_line(lx, ly, fc->list[pos].x, posts[pos] * fc->multiplier, floor, samples)",
          "new_text": null,
          "old_line_content": "            render_line(lx, ly, fc->list[pos].x, posts[pos] * fc->multiplier, floor, samples);",
          "new_line_content": "        if (coded[pos]) {",
          "content_same": false
        },
        {
          "line": 1338,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(venc->samples + channel*window_len*2 + window_len, 0, sizeof(float)*window_len)",
          "new_text": null,
          "old_line_content": "            memset(venc->samples + channel*window_len*2 + window_len, 0, sizeof(float)*window_len);",
          "new_line_content": "        for (channel = 0; channel < venc->channels; channel++) {",
          "content_same": false
        },
        {
          "line": 1469,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&venc->floors)",
          "new_text": null,
          "old_line_content": "    av_freep(&venc->floors);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1343,
          "old_api": "ff_mdct_calc",
          "new_api": null,
          "old_text": "ff_mdct_calc(&venc->mdct[0], venc->coeffs + channel*window_len, venc->samples + channel*window_len*2, venc->floor/*tmp*/)",
          "new_text": null,
          "old_line_content": "        ff_mdct_calc(&venc->mdct[0], venc->coeffs + channel*window_len, venc->samples + channel*window_len*2, venc->floor/*tmp*/);",
          "new_line_content": "    for (channel = 0; channel < venc->channels; channel++) {",
          "content_same": false
        },
        {
          "line": 1216,
          "old_api": "render_line",
          "new_api": null,
          "old_text": "render_line(lx, ly, samples, ly, floor, samples)",
          "new_text": null,
          "old_line_content": "    if (lx < samples) render_line(lx, ly, samples, ly, floor, samples);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1472,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&venc->residues[i].books)",
          "new_text": null,
          "old_line_content": "        av_freep(&venc->residues[i].books);",
          "new_line_content": "    if (venc->residues) for (i = 0; i < venc->nresidues; i++) {",
          "content_same": false
        },
        {
          "line": 1475,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&venc->residues)",
          "new_text": null,
          "old_line_content": "    av_freep(&venc->residues);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1478,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&venc->mappings[i].mux)",
          "new_text": null,
          "old_line_content": "        av_freep(&venc->mappings[i].mux);",
          "new_line_content": "    if (venc->mappings) for (i = 0; i < venc->nmappings; i++) {",
          "content_same": false
        },
        {
          "line": 1223,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(book->dimentions)",
          "new_text": null,
          "old_line_content": "    assert(book->dimentions);",
          "new_line_content": "    float distance = 0;",
          "content_same": false
        },
        {
          "line": 1482,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&venc->mappings)",
          "new_text": null,
          "old_line_content": "    av_freep(&venc->mappings);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1484,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&venc->modes)",
          "new_text": null,
          "old_line_content": "    av_freep(&venc->modes);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1486,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&venc->saved)",
          "new_text": null,
          "old_line_content": "    av_freep(&venc->saved);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1491,
          "old_api": "ff_mdct_end",
          "new_api": null,
          "old_text": "ff_mdct_end(&venc->mdct[0])",
          "new_text": null,
          "old_line_content": "    ff_mdct_end(&venc->mdct[0]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1237,
          "old_api": "put_codeword",
          "new_api": null,
          "old_text": "put_codeword(pb, book, entry)",
          "new_text": null,
          "old_line_content": "    put_codeword(pb, book, entry);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1366,
          "old_api": "create_vorbis_context",
          "new_api": null,
          "old_text": "create_vorbis_context(venc, avccontext)",
          "new_text": null,
          "old_line_content": "    create_vorbis_context(venc, avccontext);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1494,
          "old_api": "av_freep",
          "new_api": null,
          "old_text": "av_freep(&avccontext->coded_frame)",
          "new_text": null,
          "old_line_content": "    av_freep(&avccontext->coded_frame);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1371,
          "old_api": "put_main_header",
          "new_api": null,
          "old_text": "put_main_header(venc, (uint8_t**)&avccontext->extradata)",
          "new_text": null,
          "old_line_content": "    avccontext->extradata_size = put_main_header(venc, (uint8_t**)&avccontext->extradata);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1119,
          "old_api": "get_floor_average",
          "new_api": null,
          "old_text": "get_floor_average(fc, coeffs, i)",
          "new_text": null,
          "old_line_content": "    for (i = 0; i < fc->values; i++) tot_average += get_floor_average(fc, coeffs, i);",
          "new_line_content": "    float averages[fc->values];",
          "content_same": false
        },
        {
          "line": 1375,
          "old_api": "avcodec_alloc_frame",
          "new_api": null,
          "old_text": "avcodec_alloc_frame()",
          "new_text": null,
          "old_line_content": "    avccontext->coded_frame = avcodec_alloc_frame();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1249,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(rc->type == 2)",
          "new_text": null,
          "old_line_content": "    assert(rc->type == 2);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1125,
          "old_api": "get_floor_average",
          "new_api": null,
          "old_text": "get_floor_average(fc, coeffs, i)",
          "new_text": null,
          "old_line_content": "        float average = get_floor_average(fc, coeffs, i);",
          "new_line_content": "        int position = fc->list[fc->list[i].sort].x;",
          "content_same": false
        },
        {
          "line": 1255,
          "old_api": "fabs",
          "new_api": null,
          "old_text": "fabs(coeffs[k / real_ch])",
          "new_text": null,
          "old_line_content": "            if (fabs(coeffs[k / real_ch]) > max1) max1 = fabs(coeffs[k / real_ch]);",
          "new_line_content": "        for (k = s; k < s + psize; k += 2) {",
          "content_same": false
        },
        {
          "line": 1128,
          "old_api": "pow",
          "new_api": null,
          "old_text": "pow(0.8, position/200.)",
          "new_text": null,
          "old_line_content": "        average /= pow(average, 0.5) / tot_average * pow(0.8, position/200.); // MAGIC!",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1391,
          "old_api": "window",
          "new_api": null,
          "old_text": "window(venc, audio, samples)",
          "new_text": null,
          "old_line_content": "    if (!window(venc, audio, samples)) return 0;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1394,
          "old_api": "init_put_bits",
          "new_api": null,
          "old_text": "init_put_bits(&pb, packets, buf_size)",
          "new_text": null,
          "old_line_content": "    init_put_bits(&pb, packets, buf_size);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1396,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(&pb, 1, 0)",
          "new_text": null,
          "old_line_content": "    put_bits(&pb, 1, 0); // magic bit",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1398,
          "old_api": "ilog",
          "new_api": null,
          "old_text": "ilog(venc->nmodes - 1)",
          "new_text": null,
          "old_line_content": "    put_bits(&pb, ilog(venc->nmodes - 1), 0); // 0 bits, the mode",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1144,
          "old_api": "put_bits",
          "new_api": null,
          "old_text": "put_bits(pb, 1, 1)",
          "new_text": null,
          "old_line_content": "    put_bits(pb, 1, 1); // non zero",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1275,
          "old_api": "put_codeword",
          "new_api": null,
          "old_text": "put_codeword(pb, book, entry)",
          "new_text": null,
          "old_line_content": "                put_codeword(pb, book, entry);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1150,
          "old_api": "render_point",
          "new_api": null,
          "old_text": "render_point(fc->list[fc->list[i].low].x,\n                                     posts[fc->list[i].low],\n                                     fc->list[fc->list[i].high].x,\n                                     posts[fc->list[i].high],\n                                     fc->list[i].x)",
          "new_text": null,
          "old_line_content": "        int predicted = render_point(fc->list[fc->list[i].low].x,",
          "new_line_content": "    for (i = 2; i < fc->values; i++) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 3,
      "total_additions": 46,
      "total_deletions": 47,
      "total_api_changes": 96
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 4,
        "api_related_lines": 96,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          1126
        ]
      }
    },
    "api_calls_before": 226,
    "api_calls_after": 225,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 2,
      "total_diff_lines": 22
    }
  }
}