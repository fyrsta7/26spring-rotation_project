{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/038d291b70bffa550cde552f8325e1b9f71f0646",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/038d291b70bffa550cde552f8325e1b9f71f0646/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/038d291b70bffa550cde552f8325e1b9f71f0646/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/FFmpeg/modified_file/038d291b70bffa550cde552f8325e1b9f71f0646/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 273,
          "old_api": "av_log",
          "new_api": "av_packet_get_side_data",
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Packet is too small\\n\")",
          "new_text": "av_packet_get_side_data(avpkt, AV_PKT_DATA_PALETTE, &pal_size)",
          "old_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Packet is too small\\n\");",
          "new_line_content": "    const uint8_t *pal = av_packet_get_side_data(avpkt, AV_PKT_DATA_PALETTE, &pal_size);",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": "av_frame_move_ref",
          "new_api": "bytestream2_init",
          "old_text": "av_frame_move_ref(ref, p)",
          "new_text": "bytestream2_init(&a->buffer, avpkt->data, avpkt->size)",
          "old_line_content": "    av_frame_move_ref(ref, p);",
          "new_line_content": "    bytestream2_init(&a->buffer, avpkt->data, avpkt->size);",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": "ff_get_buffer",
          "new_api": "av_frame_unref",
          "old_text": "ff_get_buffer(avctx, p, AV_GET_BUFFER_FLAG_REF)",
          "new_text": "av_frame_unref(ref)",
          "old_line_content": "    if ((ret = ff_get_buffer(avctx, p, AV_GET_BUFFER_FLAG_REF)) < 0)",
          "new_line_content": "    av_frame_unref(ref);",
          "content_same": false
        },
        {
          "line": 285,
          "old_api": "bytestream2_skip",
          "new_api": "ff_get_buffer",
          "old_text": "bytestream2_skip(&a->buffer, 4)",
          "new_text": "ff_get_buffer(avctx, p, AV_GET_BUFFER_FLAG_REF)",
          "old_line_content": "    bytestream2_skip(&a->buffer, 4);",
          "new_line_content": "    if ((ret = ff_get_buffer(avctx, p, AV_GET_BUFFER_FLAG_REF)) < 0)",
          "content_same": false
        },
        {
          "line": 289,
          "old_api": "bytestream2_get_byte",
          "new_api": "bytestream2_get_buffer",
          "old_text": "bytestream2_get_byte(&a->buffer)",
          "new_text": "bytestream2_get_buffer(&a->buffer, ctable, 128)",
          "old_line_content": "    delta = bytestream2_get_byte(&a->buffer);",
          "new_line_content": "    bytestream2_get_buffer(&a->buffer, ctable, 128);",
          "content_same": false
        },
        {
          "line": 344,
          "old_api": "av_frame_alloc",
          "new_api": "decode_flush",
          "old_text": "av_frame_alloc()",
          "new_text": "decode_flush(avctx)",
          "old_line_content": "    a->ref = av_frame_alloc();",
          "new_line_content": "    decode_flush(avctx);",
          "content_same": false
        },
        {
          "line": 346,
          "old_api": "decode_end",
          "new_api": "av_frame_alloc",
          "old_text": "decode_end(avctx)",
          "new_text": "av_frame_alloc()",
          "old_line_content": "        decode_end(avctx);",
          "new_line_content": "    a->pic = av_frame_alloc();",
          "content_same": false
        },
        {
          "line": 347,
          "old_api": "AVERROR",
          "new_api": "av_frame_alloc",
          "old_text": "AVERROR(ENOMEM)",
          "new_text": "av_frame_alloc()",
          "old_line_content": "        return AVERROR(ENOMEM);",
          "new_line_content": "    a->ref = av_frame_alloc();",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 135,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(dst + (i * stride), refdata + (i * stride), width)",
          "old_line_content": "    }",
          "new_line_content": "            memcpy(dst + (i * stride), refdata + (i * stride), width);",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": null,
          "new_api": "bytestream2_get_bytes_left",
          "old_text": null,
          "new_text": "bytestream2_get_bytes_left(&qctx->buffer)",
          "old_line_content": "        if(delta) {",
          "new_line_content": "    while ((bytestream2_get_bytes_left(&qctx->buffer) > 0) && (height >= 0)) {",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": null,
          "new_api": "bytestream2_get_byte",
          "old_text": null,
          "new_text": "bytestream2_get_byte(&qctx->buffer)",
          "old_line_content": "            /* motion compensation */",
          "new_line_content": "        code = bytestream2_get_byte(&qctx->buffer);",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Packet is too small\\n\")",
          "old_line_content": "",
          "new_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Packet is too small\\n\");",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": null,
          "new_api": "bytestream2_get_bytes_left",
          "old_text": null,
          "new_text": "bytestream2_get_bytes_left(&qctx->buffer)",
          "old_line_content": "                    int me_w, me_h, me_x, me_y;",
          "new_line_content": "            while(bytestream2_get_bytes_left(&qctx->buffer) > 0 && (code & 0xF0) == 0xF0) {",
          "content_same": false
        },
        {
          "line": 283,
          "old_api": null,
          "new_api": "av_frame_move_ref",
          "old_text": null,
          "new_text": "av_frame_move_ref(ref, p)",
          "old_line_content": "        return ret;",
          "new_line_content": "    av_frame_move_ref(ref, p);",
          "content_same": false
        },
        {
          "line": 288,
          "old_api": null,
          "new_api": "bytestream2_skip",
          "old_text": null,
          "new_text": "bytestream2_skip(&a->buffer, 4)",
          "old_line_content": "",
          "new_line_content": "    bytestream2_skip(&a->buffer, 4);",
          "content_same": false
        },
        {
          "line": 162,
          "old_api": null,
          "new_api": "bytestream2_get_byte",
          "old_text": null,
          "new_text": "bytestream2_get_byte(&qctx->buffer)",
          "old_line_content": "                    if(val > 7)",
          "new_line_content": "                    corr = bytestream2_get_byte(&qctx->buffer);",
          "content_same": false
        },
        {
          "line": 290,
          "old_api": null,
          "new_api": "bytestream2_skip",
          "old_text": null,
          "new_text": "bytestream2_skip(&a->buffer, 1)",
          "old_line_content": "    if(delta == 0x10) {",
          "new_line_content": "    bytestream2_skip(&a->buffer, 1);",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": null,
          "new_api": "bytestream2_get_byte",
          "old_text": null,
          "new_text": "bytestream2_get_byte(&a->buffer)",
          "old_line_content": "    } else {",
          "new_line_content": "    delta = bytestream2_get_byte(&a->buffer);",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": null,
          "new_api": "qpeg_decode_intra",
          "old_text": null,
          "new_text": "qpeg_decode_intra(a, outdata, p->linesize[0], avctx->width, avctx->height)",
          "old_line_content": "    }",
          "new_line_content": "        qpeg_decode_intra(a, outdata, p->linesize[0], avctx->width, avctx->height);",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": null,
          "new_api": "qpeg_decode_inter",
          "old_text": null,
          "new_text": "qpeg_decode_inter(a, outdata, p->linesize[0], avctx->width, avctx->height, delta, ctable, ref->data[0])",
          "old_line_content": "    /* make the palette available on the way out */",
          "new_line_content": "        qpeg_decode_inter(a, outdata, p->linesize[0], avctx->width, avctx->height, delta, ctable, ref->data[0]);",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(a->pal, pal, AVPALETTE_SIZE)",
          "old_line_content": "    }",
          "new_line_content": "        memcpy(a->pal, pal, AVPALETTE_SIZE);",
          "content_same": false
        },
        {
          "line": 304,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(avctx, AV_LOG_ERROR, \"Palette size %d is wrong\\n\", pal_size)",
          "old_line_content": "",
          "new_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Palette size %d is wrong\\n\", pal_size);",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": null,
          "new_api": "av_log",
          "old_text": null,
          "new_text": "av_log(qctx->avctx, AV_LOG_ERROR, \"Bogus motion vector (%i,%i), block size %ix%i at %i,%i\\n\",\n                               me_x, me_y, me_w, me_h, filled, height)",
          "old_line_content": "                        /* do motion compensation */",
          "new_line_content": "                        av_log(qctx->avctx, AV_LOG_ERROR, \"Bogus motion vector (%i,%i), block size %ix%i at %i,%i\\n\",",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(p->data[1], a->pal, AVPALETTE_SIZE)",
          "old_line_content": "        return ret;",
          "new_line_content": "    memcpy(p->data[1], a->pal, AVPALETTE_SIZE);",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": null,
          "new_api": "av_frame_ref",
          "old_text": null,
          "new_text": "av_frame_ref(data, p)",
          "old_line_content": "    *got_frame      = 1;",
          "new_line_content": "    if ((ret = av_frame_ref(data, p)) < 0)",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": null,
          "new_api": "bytestream2_get_byte",
          "old_text": null,
          "new_text": "bytestream2_get_byte(&qctx->buffer)",
          "old_line_content": "",
          "new_line_content": "                code = bytestream2_get_byte(&qctx->buffer);",
          "content_same": false
        },
        {
          "line": 321,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(1024U, avctx->extradata_size)",
          "old_line_content": "    for (i=0; i<pal_size/4; i++)",
          "new_line_content": "    pal_size = FFMIN(1024U, avctx->extradata_size);",
          "content_same": false
        },
        {
          "line": 325,
          "old_api": null,
          "new_api": "AV_RL32",
          "old_text": null,
          "new_text": "AV_RL32(pal_src+4*i)",
          "old_line_content": "static av_cold int decode_end(AVCodecContext *avctx)",
          "new_line_content": "        a->pal[i] = 0xFFU<<24 | AV_RL32(pal_src+4*i);",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": null,
          "new_api": "bytestream2_get_byte",
          "old_text": null,
          "new_text": "bytestream2_get_byte(&qctx->buffer)",
          "old_line_content": "                if(filled >= width) {",
          "new_line_content": "            p = bytestream2_get_byte(&qctx->buffer);",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": null,
          "new_api": "av_frame_free",
          "old_text": null,
          "new_text": "av_frame_free(&a->pic)",
          "old_line_content": "    return 0;",
          "new_line_content": "    av_frame_free(&a->pic);",
          "content_same": false
        },
        {
          "line": 333,
          "old_api": null,
          "new_api": "av_frame_free",
          "old_text": null,
          "new_text": "av_frame_free(&a->ref)",
          "old_line_content": "}",
          "new_line_content": "    av_frame_free(&a->ref);",
          "content_same": false
        },
        {
          "line": 83,
          "old_api": null,
          "new_api": "FFMIN",
          "old_text": null,
          "new_text": "FFMIN(run - i, width - filled)",
          "old_line_content": "                dst[filled++] = p;",
          "new_line_content": "                int step = FFMIN(run - i, width - filled);",
          "content_same": false
        },
        {
          "line": 84,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(dst+filled, p, step)",
          "old_line_content": "                if (filled >= width) {",
          "new_line_content": "                memset(dst+filled, p, step);",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": null,
          "new_api": "bytestream2_get_bytes_left",
          "old_text": null,
          "new_text": "bytestream2_get_bytes_left(&qctx->buffer)",
          "old_line_content": "            for(i = 0; i <= code; i++) {",
          "new_line_content": "            if(code + 1 > bytestream2_get_bytes_left(&qctx->buffer))",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": null,
          "new_api": "bytestream2_get_byte",
          "old_text": null,
          "new_text": "bytestream2_get_byte(&qctx->buffer)",
          "old_line_content": "                    dst -= stride;",
          "new_line_content": "                dst[filled++] = bytestream2_get_byte(&qctx->buffer);",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(dst, p, width)",
          "old_line_content": "                        i += width;",
          "new_line_content": "                        memset(dst, p, width);",
          "content_same": false
        },
        {
          "line": 349,
          "old_api": null,
          "new_api": "decode_end",
          "old_text": null,
          "new_text": "decode_end(avctx)",
          "old_line_content": "",
          "new_line_content": "        decode_end(avctx);",
          "content_same": false
        },
        {
          "line": 350,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "    return 0;",
          "new_line_content": "        return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 358,
          "old_api": null,
          "new_api": "NULL_IF_CONFIG_SMALL",
          "old_text": null,
          "new_text": "NULL_IF_CONFIG_SMALL(\"Q-team QPEG\")",
          "old_line_content": "    .priv_data_size = sizeof(QpegContext),",
          "new_line_content": "    .long_name      = NULL_IF_CONFIG_SMALL(\"Q-team QPEG\"),",
          "content_same": false
        },
        {
          "line": 103,
          "old_api": null,
          "new_api": "bytestream2_get_byte",
          "old_text": null,
          "new_text": "bytestream2_get_byte(&qctx->buffer)",
          "old_line_content": "                    dst -= stride;",
          "new_line_content": "                dst[filled++] = bytestream2_get_byte(&qctx->buffer);",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": null,
          "new_api": "bytestream2_get_byte",
          "old_text": null,
          "new_text": "bytestream2_get_byte(&qctx->buffer)",
          "old_line_content": "            else",
          "new_line_content": "                skip = bytestream2_get_byte(&qctx->buffer) +  64;",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": null,
          "new_api": "bytestream2_get_byte",
          "old_text": null,
          "new_text": "bytestream2_get_byte(&qctx->buffer)",
          "old_line_content": "            filled += skip;",
          "new_line_content": "                skip = bytestream2_get_byte(&qctx->buffer) + 320;",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 132,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(dst + (i * stride), refdata + (i * stride), width)",
          "new_text": null,
          "old_line_content": "            memcpy(dst + (i * stride), refdata + (i * stride), width);",
          "new_line_content": "    if (refdata) {",
          "content_same": false
        },
        {
          "line": 141,
          "old_api": "bytestream2_get_bytes_left",
          "new_api": null,
          "old_text": "bytestream2_get_bytes_left(&qctx->buffer)",
          "new_text": null,
          "old_line_content": "    while ((bytestream2_get_bytes_left(&qctx->buffer) > 0) && (height >= 0)) {",
          "new_line_content": "    height--;",
          "content_same": false
        },
        {
          "line": 142,
          "old_api": "bytestream2_get_byte",
          "new_api": null,
          "old_text": "bytestream2_get_byte(&qctx->buffer)",
          "new_text": null,
          "old_line_content": "        code = bytestream2_get_byte(&qctx->buffer);",
          "new_line_content": "    dst = dst + height * stride;",
          "content_same": false
        },
        {
          "line": 270,
          "old_api": "av_packet_get_side_data",
          "new_api": null,
          "old_text": "av_packet_get_side_data(avpkt, AV_PKT_DATA_PALETTE, &pal_size)",
          "new_text": null,
          "old_line_content": "    const uint8_t *pal = av_packet_get_side_data(avpkt, AV_PKT_DATA_PALETTE, &pal_size);",
          "new_line_content": "    uint8_t* outdata;",
          "content_same": false
        },
        {
          "line": 146,
          "old_api": "bytestream2_get_bytes_left",
          "new_api": null,
          "old_text": "bytestream2_get_bytes_left(&qctx->buffer)",
          "new_text": null,
          "old_line_content": "            while(bytestream2_get_bytes_left(&qctx->buffer) > 0 && (code & 0xF0) == 0xF0) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": "bytestream2_init",
          "new_api": null,
          "old_text": "bytestream2_init(&a->buffer, avpkt->data, avpkt->size)",
          "new_text": null,
          "old_line_content": "    bytestream2_init(&a->buffer, avpkt->data, avpkt->size);",
          "new_line_content": "        return AVERROR_INVALIDDATA;",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": "av_frame_unref",
          "new_api": null,
          "old_text": "av_frame_unref(ref)",
          "new_text": null,
          "old_line_content": "    av_frame_unref(ref);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 286,
          "old_api": "bytestream2_get_buffer",
          "new_api": null,
          "old_text": "bytestream2_get_buffer(&a->buffer, ctable, 128)",
          "new_text": null,
          "old_line_content": "    bytestream2_get_buffer(&a->buffer, ctable, 128);",
          "new_line_content": "        return ret;",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": "bytestream2_skip",
          "new_api": null,
          "old_text": "bytestream2_skip(&a->buffer, 1)",
          "new_text": null,
          "old_line_content": "    bytestream2_skip(&a->buffer, 1);",
          "new_line_content": "    outdata = p->data[0];",
          "content_same": false
        },
        {
          "line": 159,
          "old_api": "bytestream2_get_byte",
          "new_api": null,
          "old_text": "bytestream2_get_byte(&qctx->buffer)",
          "new_text": null,
          "old_line_content": "                    corr = bytestream2_get_byte(&qctx->buffer);",
          "new_line_content": "                    me_h = qpeg_table_h[me_idx];",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": "qpeg_decode_intra",
          "new_api": null,
          "old_text": "qpeg_decode_intra(a, outdata, p->linesize[0], avctx->width, avctx->height)",
          "new_text": null,
          "old_line_content": "        qpeg_decode_intra(a, outdata, p->linesize[0], avctx->width, avctx->height);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": "qpeg_decode_inter",
          "new_api": null,
          "old_text": "qpeg_decode_inter(a, outdata, p->linesize[0], avctx->width, avctx->height, delta, ctable, ref->data[0])",
          "new_text": null,
          "old_line_content": "        qpeg_decode_inter(a, outdata, p->linesize[0], avctx->width, avctx->height, delta, ctable, ref->data[0]);",
          "new_line_content": "    if(delta == 0x10) {",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(a->pal, pal, AVPALETTE_SIZE)",
          "new_text": null,
          "old_line_content": "        memcpy(a->pal, pal, AVPALETTE_SIZE);",
          "new_line_content": "    /* make the palette available on the way out */",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(avctx, AV_LOG_ERROR, \"Palette size %d is wrong\\n\", pal_size)",
          "new_text": null,
          "old_line_content": "        av_log(avctx, AV_LOG_ERROR, \"Palette size %d is wrong\\n\", pal_size);",
          "new_line_content": "        p->palette_has_changed = 1;",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": "av_log",
          "new_api": null,
          "old_text": "av_log(qctx->avctx, AV_LOG_ERROR, \"Bogus motion vector (%i,%i), block size %ix%i at %i,%i\\n\",\n                               me_x, me_y, me_w, me_h, filled, height)",
          "new_text": null,
          "old_line_content": "                        av_log(qctx->avctx, AV_LOG_ERROR, \"Bogus motion vector (%i,%i), block size %ix%i at %i,%i\\n\",",
          "new_line_content": "                    if ((me_x + filled < 0) || (me_x + me_w + filled > width) ||",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(p->data[1], a->pal, AVPALETTE_SIZE)",
          "new_text": null,
          "old_line_content": "    memcpy(p->data[1], a->pal, AVPALETTE_SIZE);",
          "new_line_content": "    } else if (pal) {",
          "content_same": false
        },
        {
          "line": 305,
          "old_api": "av_frame_ref",
          "new_api": null,
          "old_text": "av_frame_ref(data, p)",
          "new_text": null,
          "old_line_content": "    if ((ret = av_frame_ref(data, p)) < 0)",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": "bytestream2_get_byte",
          "new_api": null,
          "old_text": "bytestream2_get_byte(&qctx->buffer)",
          "new_text": null,
          "old_line_content": "                code = bytestream2_get_byte(&qctx->buffer);",
          "new_line_content": "                        }",
          "content_same": false
        },
        {
          "line": 318,
          "old_api": "FFMIN",
          "new_api": null,
          "old_text": "FFMIN(1024U, avctx->extradata_size)",
          "new_text": null,
          "old_line_content": "    pal_size = FFMIN(1024U, avctx->extradata_size);",
          "new_line_content": "    int i, pal_size;",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": "AV_RL32",
          "new_api": null,
          "old_text": "AV_RL32(pal_src+4*i)",
          "new_text": null,
          "old_line_content": "        a->pal[i] = 0xFFU<<24 | AV_RL32(pal_src+4*i);",
          "new_line_content": "    pal_src = avctx->extradata + avctx->extradata_size - pal_size;",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": "bytestream2_get_byte",
          "new_api": null,
          "old_text": "bytestream2_get_byte(&qctx->buffer)",
          "new_text": null,
          "old_line_content": "            p = bytestream2_get_byte(&qctx->buffer);",
          "new_line_content": "            int p;",
          "content_same": false
        },
        {
          "line": 329,
          "old_api": "av_frame_free",
          "new_api": null,
          "old_text": "av_frame_free(&a->pic)",
          "new_text": null,
          "old_line_content": "    av_frame_free(&a->pic);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": "av_frame_free",
          "new_api": null,
          "old_text": "av_frame_free(&a->ref)",
          "new_text": null,
          "old_line_content": "    av_frame_free(&a->ref);",
          "new_line_content": "    QpegContext * const a = avctx->priv_data;",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": "bytestream2_get_bytes_left",
          "new_api": null,
          "old_text": "bytestream2_get_bytes_left(&qctx->buffer)",
          "new_text": null,
          "old_line_content": "            if(code + 1 > bytestream2_get_bytes_left(&qctx->buffer))",
          "new_line_content": "        } else if(code >= 0xC0) { /* copy code: 0xC0..0xDF */",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": "decode_flush",
          "new_api": null,
          "old_text": "decode_flush(avctx)",
          "new_text": null,
          "old_line_content": "    decode_flush(avctx);",
          "new_line_content": "    a->avctx = avctx;",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": "bytestream2_get_byte",
          "new_api": null,
          "old_text": "bytestream2_get_byte(&qctx->buffer)",
          "new_text": null,
          "old_line_content": "                dst[filled++] = bytestream2_get_byte(&qctx->buffer);",
          "new_line_content": "                break;",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": "av_frame_alloc",
          "new_api": null,
          "old_text": "av_frame_alloc()",
          "new_text": null,
          "old_line_content": "    a->pic = av_frame_alloc();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 89,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(dst, p, width)",
          "new_text": null,
          "old_line_content": "                        memset(dst, p, width);",
          "new_line_content": "                    dst -= stride;",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": "NULL_IF_CONFIG_SMALL",
          "new_api": null,
          "old_text": "NULL_IF_CONFIG_SMALL(\"Q-team QPEG\")",
          "new_text": null,
          "old_line_content": "    .long_name      = NULL_IF_CONFIG_SMALL(\"Q-team QPEG\"),",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 100,
          "old_api": "bytestream2_get_byte",
          "new_api": null,
          "old_text": "bytestream2_get_byte(&qctx->buffer)",
          "new_text": null,
          "old_line_content": "                dst[filled++] = bytestream2_get_byte(&qctx->buffer);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": "bytestream2_get_byte",
          "new_api": null,
          "old_text": "bytestream2_get_byte(&qctx->buffer)",
          "new_text": null,
          "old_line_content": "                skip = bytestream2_get_byte(&qctx->buffer) +  64;",
          "new_line_content": "            /* codes 0x80 and 0x81 are actually escape codes,",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "bytestream2_get_byte",
          "new_api": null,
          "old_text": "bytestream2_get_byte(&qctx->buffer)",
          "new_text": null,
          "old_line_content": "                skip = bytestream2_get_byte(&qctx->buffer) + 320;",
          "new_line_content": "            if(!code)",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 8,
      "total_additions": 34,
      "total_deletions": 32,
      "total_api_changes": 74
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 4,
        "api_related_lines": 74,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          85,
          86
        ]
      }
    },
    "api_calls_before": 49,
    "api_calls_after": 51,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 1,
      "total_diff_lines": 17
    }
  }
}