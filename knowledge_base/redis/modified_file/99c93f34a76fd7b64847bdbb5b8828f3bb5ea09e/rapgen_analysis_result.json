{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/99c93f34a76fd7b64847bdbb5b8828f3bb5ea09e",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/99c93f34a76fd7b64847bdbb5b8828f3bb5ea09e/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/99c93f34a76fd7b64847bdbb5b8828f3bb5ea09e/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/99c93f34a76fd7b64847bdbb5b8828f3bb5ea09e/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1276,
          "old_api": "sentinelFlushConfig",
          "new_api": "zfree",
          "old_text": "sentinelFlushConfig()",
          "new_text": "zfree(slaves)",
          "old_line_content": "            sentinelFlushConfig();",
          "new_line_content": "    zfree(slaves);",
          "content_same": false
        },
        {
          "line": 1328,
          "old_api": "dictGetVal",
          "new_api": "dictReleaseIterator",
          "old_text": "dictGetVal(de)",
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "            sentinelRedisInstance *ri = dictGetVal(de);",
          "new_line_content": "        dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 1341,
          "old_api": "atoi",
          "new_api": "createSentinelRedisInstance",
          "old_text": "atoi(argv[4])",
          "new_text": "createSentinelRedisInstance(argv[1],SRI_MASTER,argv[2],\n                                        atoi(argv[3]),quorum,NULL)",
          "old_line_content": "        int quorum = atoi(argv[4]);",
          "new_line_content": "        if (createSentinelRedisInstance(argv[1],SRI_MASTER,argv[2],",
          "content_same": false
        },
        {
          "line": 1357,
          "old_api": "atoi",
          "new_api": "sentinelPropagateDownAfterPeriod",
          "old_text": "atoi(argv[2])",
          "new_text": "sentinelPropagateDownAfterPeriod(ri)",
          "old_line_content": "        ri->down_after_period = atoi(argv[2]);",
          "new_line_content": "        sentinelPropagateDownAfterPeriod(ri);",
          "content_same": false
        },
        {
          "line": 1360,
          "old_api": "sentinelPropagateDownAfterPeriod",
          "new_api": "sentinelGetMasterByName",
          "old_text": "sentinelPropagateDownAfterPeriod(ri)",
          "new_text": "sentinelGetMasterByName(argv[1])",
          "old_line_content": "        sentinelPropagateDownAfterPeriod(ri);",
          "new_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "content_same": false
        },
        {
          "line": 1365,
          "old_api": "atoi",
          "new_api": "strcasecmp",
          "old_text": "atoi(argv[2])",
          "new_text": "strcasecmp(argv[0],\"parallel-syncs\")",
          "old_line_content": "        ri->failover_timeout = atoi(argv[2]);",
          "new_line_content": "   } else if (!strcasecmp(argv[0],\"parallel-syncs\") && argc == 3) {",
          "content_same": false
        },
        {
          "line": 1370,
          "old_api": "sentinelGetMasterByName",
          "new_api": "strcasecmp",
          "old_text": "sentinelGetMasterByName(argv[1])",
          "new_text": "strcasecmp(argv[0],\"notification-script\")",
          "old_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "new_line_content": "   } else if (!strcasecmp(argv[0],\"notification-script\") && argc == 3) {",
          "content_same": false
        },
        {
          "line": 1372,
          "old_api": "atoi",
          "new_api": "sentinelGetMasterByName",
          "old_text": "atoi(argv[2])",
          "new_text": "sentinelGetMasterByName(argv[1])",
          "old_line_content": "        ri->parallel_syncs = atoi(argv[2]);",
          "new_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "content_same": false
        },
        {
          "line": 1377,
          "old_api": "access",
          "new_api": "strcasecmp",
          "old_text": "access(argv[2],X_OK)",
          "new_text": "strcasecmp(argv[0],\"client-reconfig-script\")",
          "old_line_content": "        if (access(argv[2],X_OK) == -1)",
          "new_line_content": "   } else if (!strcasecmp(argv[0],\"client-reconfig-script\") && argc == 3) {",
          "content_same": false
        },
        {
          "line": 1379,
          "old_api": "sdsnew",
          "new_api": "sentinelGetMasterByName",
          "old_text": "sdsnew(argv[2])",
          "new_text": "sentinelGetMasterByName(argv[1])",
          "old_line_content": "        ri->notification_script = sdsnew(argv[2]);",
          "new_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "content_same": false
        },
        {
          "line": 1384,
          "old_api": "access",
          "new_api": "sdsnew",
          "old_text": "access(argv[2],X_OK)",
          "new_text": "sdsnew(argv[2])",
          "old_line_content": "        if (access(argv[2],X_OK) == -1)",
          "new_line_content": "        ri->client_reconfig_script = sdsnew(argv[2]);",
          "content_same": false
        },
        {
          "line": 1387,
          "old_api": "sdsnew",
          "new_api": "sentinelGetMasterByName",
          "old_text": "sdsnew(argv[2])",
          "new_text": "sentinelGetMasterByName(argv[1])",
          "old_line_content": "        ri->client_reconfig_script = sdsnew(argv[2]);",
          "new_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "content_same": false
        },
        {
          "line": 1390,
          "old_api": "sentinelGetMasterByName",
          "new_api": "strcasecmp",
          "old_text": "sentinelGetMasterByName(argv[1])",
          "new_text": "strcasecmp(argv[0],\"current-epoch\")",
          "old_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "new_line_content": "    } else if (!strcasecmp(argv[0],\"current-epoch\") && argc == 2) {",
          "content_same": false
        },
        {
          "line": 1392,
          "old_api": "sdsnew",
          "new_api": "strtoull",
          "old_text": "sdsnew(argv[2])",
          "new_text": "strtoull(argv[1],NULL,10)",
          "old_line_content": "        ri->auth_pass = sdsnew(argv[2]);",
          "new_line_content": "        unsigned long long current_epoch = strtoull(argv[1],NULL,10);",
          "content_same": false
        },
        {
          "line": 1395,
          "old_api": "strtoull",
          "new_api": "strcasecmp",
          "old_text": "strtoull(argv[1],NULL,10)",
          "new_text": "strcasecmp(argv[0],\"config-epoch\")",
          "old_line_content": "        unsigned long long current_epoch = strtoull(argv[1],NULL,10);",
          "new_line_content": "    } else if (!strcasecmp(argv[0],\"config-epoch\") && argc == 3) {",
          "content_same": false
        },
        {
          "line": 1410,
          "old_api": "sentinelGetMasterByName",
          "new_api": "strcasecmp",
          "old_text": "sentinelGetMasterByName(argv[1])",
          "new_text": "strcasecmp(argv[0],\"known-slave\")",
          "old_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "new_line_content": "    } else if (!strcasecmp(argv[0],\"known-slave\") && argc == 4) {",
          "content_same": false
        },
        {
          "line": 1417,
          "old_api": "sentinelGetMasterByName",
          "new_api": "atoi",
          "old_text": "sentinelGetMasterByName(argv[1])",
          "new_text": "atoi(argv[3])",
          "old_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "new_line_content": "                    atoi(argv[3]), ri->quorum, ri)) == NULL)",
          "content_same": false
        },
        {
          "line": 1429,
          "old_api": "sentinelGetMasterByName",
          "new_api": "atoi",
          "old_text": "sentinelGetMasterByName(argv[1])",
          "new_text": "atoi(argv[3])",
          "old_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "new_line_content": "                    atoi(argv[3]), ri->quorum, ri)) == NULL)",
          "content_same": false
        },
        {
          "line": 1436,
          "old_api": "sdsnew",
          "new_api": "strlen",
          "old_text": "sdsnew(argv[4])",
          "new_text": "strlen(argv[1])",
          "old_line_content": "        if (argc == 5) si->runid = sdsnew(argv[4]);",
          "new_line_content": "        if (strlen(argv[1]))",
          "content_same": false
        },
        {
          "line": 1437,
          "old_api": "strcasecmp",
          "new_api": "sdsnew",
          "old_text": "strcasecmp(argv[0],\"announce-ip\")",
          "new_text": "sdsnew(argv[1])",
          "old_line_content": "    } else if (!strcasecmp(argv[0],\"announce-ip\") && argc == 2) {",
          "new_line_content": "            sentinel.announce_ip = sdsnew(argv[1]);",
          "content_same": false
        },
        {
          "line": 1440,
          "old_api": "sdsnew",
          "new_api": "atoi",
          "old_text": "sdsnew(argv[1])",
          "new_text": "atoi(argv[1])",
          "old_line_content": "            sentinel.announce_ip = sdsnew(argv[1]);",
          "new_line_content": "        sentinel.announce_port = atoi(argv[1]);",
          "content_same": false
        },
        {
          "line": 1469,
          "old_api": "sdsempty",
          "new_api": "rewriteConfigRewriteLine",
          "old_text": "sdsempty()",
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "        line = sdscatprintf(sdsempty(),\"sentinel monitor %s %s %d %d\",",
          "new_line_content": "        rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 1476,
          "old_api": "sdsempty",
          "new_api": "rewriteConfigRewriteLine",
          "old_text": "sdsempty()",
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "            line = sdscatprintf(sdsempty(),",
          "new_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 1484,
          "old_api": "sdsempty",
          "new_api": "rewriteConfigRewriteLine",
          "old_text": "sdsempty()",
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "            line = sdscatprintf(sdsempty(),",
          "new_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 1492,
          "old_api": "sdsempty",
          "new_api": "rewriteConfigRewriteLine",
          "old_text": "sdsempty()",
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "            line = sdscatprintf(sdsempty(),",
          "new_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 1500,
          "old_api": "sdsempty",
          "new_api": "rewriteConfigRewriteLine",
          "old_text": "sdsempty()",
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "            line = sdscatprintf(sdsempty(),",
          "new_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 1508,
          "old_api": "sdsempty",
          "new_api": "rewriteConfigRewriteLine",
          "old_text": "sdsempty()",
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "            line = sdscatprintf(sdsempty(),",
          "new_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 1516,
          "old_api": "sdsempty",
          "new_api": "rewriteConfigRewriteLine",
          "old_text": "sdsempty()",
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "            line = sdscatprintf(sdsempty(),",
          "new_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 1523,
          "old_api": "sdsempty",
          "new_api": "rewriteConfigRewriteLine",
          "old_text": "sdsempty()",
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "        line = sdscatprintf(sdsempty(),",
          "new_line_content": "        rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 1526,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": "sdsempty",
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": "sdsempty()",
          "old_line_content": "        rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "        line = sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 1529,
          "old_api": "sdsempty",
          "new_api": "rewriteConfigRewriteLine",
          "old_text": "sdsempty()",
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "        line = sdscatprintf(sdsempty(),",
          "new_line_content": "        rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 1532,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": "dictGetIterator",
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": "dictGetIterator(master->slaves)",
          "old_line_content": "        rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "        di2 = dictGetIterator(master->slaves);",
          "content_same": false
        },
        {
          "line": 1536,
          "old_api": "dictNext",
          "new_api": "dictGetVal",
          "old_text": "dictNext(di2)",
          "new_text": "dictGetVal(de)",
          "old_line_content": "        while((de = dictNext(di2)) != NULL) {",
          "new_line_content": "            ri = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 1549,
          "old_api": "sdsempty",
          "new_api": "rewriteConfigRewriteLine",
          "old_text": "sdsempty()",
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "            line = sdscatprintf(sdsempty(),",
          "new_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 1554,
          "old_api": "dictReleaseIterator",
          "new_api": "dictGetIterator",
          "old_text": "dictReleaseIterator(di2)",
          "new_text": "dictGetIterator(master->sentinels)",
          "old_line_content": "        dictReleaseIterator(di2);",
          "new_line_content": "        di2 = dictGetIterator(master->sentinels);",
          "content_same": false
        },
        {
          "line": 1557,
          "old_api": "dictGetIterator",
          "new_api": "sdsempty",
          "old_text": "dictGetIterator(master->sentinels)",
          "new_text": "sdsempty()",
          "old_line_content": "        di2 = dictGetIterator(master->sentinels);",
          "new_line_content": "            line = sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 1586,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": "dictReleaseIterator",
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "        rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "    dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 1719,
          "old_api": "mstime",
          "new_api": "redisAsyncSetConnectCallback",
          "old_text": "mstime()",
          "new_text": "redisAsyncSetConnectCallback(ri->cc,\n                                            sentinelLinkEstablishedCallback)",
          "old_line_content": "            ri->cc_conn_time = mstime();",
          "new_line_content": "            redisAsyncSetConnectCallback(ri->cc,",
          "content_same": false
        },
        {
          "line": 1721,
          "old_api": "redisAeAttach",
          "new_api": "redisAsyncSetDisconnectCallback",
          "old_text": "redisAeAttach(server.el,ri->cc)",
          "new_text": "redisAsyncSetDisconnectCallback(ri->cc,\n                                            sentinelDisconnectCallback)",
          "old_line_content": "            redisAeAttach(server.el,ri->cc);",
          "new_line_content": "            redisAsyncSetDisconnectCallback(ri->cc,",
          "content_same": false
        },
        {
          "line": 1724,
          "old_api": "redisAsyncSetDisconnectCallback",
          "new_api": "sentinelSetClientName",
          "old_text": "redisAsyncSetDisconnectCallback(ri->cc,\n                                            sentinelDisconnectCallback)",
          "new_text": "sentinelSetClientName(ri,ri->cc,\"cmd\")",
          "old_line_content": "            redisAsyncSetDisconnectCallback(ri->cc,",
          "new_line_content": "            sentinelSetClientName(ri,ri->cc,\"cmd\");",
          "content_same": false
        },
        {
          "line": 1727,
          "old_api": "sentinelSetClientName",
          "new_api": "sentinelSendPing",
          "old_text": "sentinelSetClientName(ri,ri->cc,\"cmd\")",
          "new_text": "sentinelSendPing(ri)",
          "old_line_content": "            sentinelSetClientName(ri,ri->cc,\"cmd\");",
          "new_line_content": "            sentinelSendPing(ri);",
          "content_same": false
        },
        {
          "line": 1743,
          "old_api": "mstime",
          "new_api": "redisAsyncSetConnectCallback",
          "old_text": "mstime()",
          "new_text": "redisAsyncSetConnectCallback(ri->pc,\n                                            sentinelLinkEstablishedCallback)",
          "old_line_content": "            ri->pc_conn_time = mstime();",
          "new_line_content": "            redisAsyncSetConnectCallback(ri->pc,",
          "content_same": false
        },
        {
          "line": 1745,
          "old_api": "redisAeAttach",
          "new_api": "redisAsyncSetDisconnectCallback",
          "old_text": "redisAeAttach(server.el,ri->pc)",
          "new_text": "redisAsyncSetDisconnectCallback(ri->pc,\n                                            sentinelDisconnectCallback)",
          "old_line_content": "            redisAeAttach(server.el,ri->pc);",
          "new_line_content": "            redisAsyncSetDisconnectCallback(ri->pc,",
          "content_same": false
        },
        {
          "line": 1748,
          "old_api": "redisAsyncSetDisconnectCallback",
          "new_api": "sentinelSetClientName",
          "old_text": "redisAsyncSetDisconnectCallback(ri->pc,\n                                            sentinelDisconnectCallback)",
          "new_text": "sentinelSetClientName(ri,ri->pc,\"pubsub\")",
          "old_line_content": "            redisAsyncSetDisconnectCallback(ri->pc,",
          "new_line_content": "            sentinelSetClientName(ri,ri->pc,\"pubsub\");",
          "content_same": false
        },
        {
          "line": 1750,
          "old_api": "sentinelSendAuthIfNeeded",
          "new_api": "redisAsyncCommand",
          "old_text": "sentinelSendAuthIfNeeded(ri,ri->pc)",
          "new_text": "redisAsyncCommand(ri->pc,\n                sentinelReceiveHelloMessages, NULL, \"SUBSCRIBE %s\",\n                    SENTINEL_HELLO_CHANNEL)",
          "old_line_content": "            sentinelSendAuthIfNeeded(ri,ri->pc);",
          "new_line_content": "            retval = redisAsyncCommand(ri->pc,",
          "content_same": false
        },
        {
          "line": 1808,
          "old_api": "sdsnewlen",
          "new_api": "sentinelEvent",
          "old_text": "sdsnewlen(l+7,40)",
          "new_text": "sentinelEvent(REDIS_NOTICE,\"+reboot\",ri,\"%@\")",
          "old_line_content": "                ri->runid = sdsnewlen(l+7,40);",
          "new_line_content": "                    sentinelEvent(REDIS_NOTICE,\"+reboot\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 1810,
          "old_api": "strncmp",
          "new_api": "sdsnewlen",
          "old_text": "strncmp(ri->runid,l+7,40)",
          "new_text": "sdsnewlen(l+7,40)",
          "old_line_content": "                if (strncmp(ri->runid,l+7,40) != 0) {",
          "new_line_content": "                    ri->runid = sdsnewlen(l+7,40);",
          "content_same": false
        },
        {
          "line": 1839,
          "old_api": "strstr",
          "new_api": "strchr",
          "old_text": "strstr(l,\"port=\")",
          "new_text": "strchr(ip,',')",
          "old_line_content": "                port = strstr(l,\"port=\"); if (!port) continue;",
          "new_line_content": "                end = strchr(ip,','); if (end) *end = '\\0';",
          "content_same": false
        },
        {
          "line": 1849,
          "old_api": "createSentinelRedisInstance",
          "new_api": "sentinelEvent",
          "old_text": "createSentinelRedisInstance(NULL,SRI_SLAVE,ip,\n                            atoi(port), ri->quorum, ri)",
          "new_text": "sentinelEvent(REDIS_NOTICE,\"+slave\",slave,\"%@\")",
          "old_line_content": "                if ((slave = createSentinelRedisInstance(NULL,SRI_SLAVE,ip,",
          "new_line_content": "                    sentinelEvent(REDIS_NOTICE,\"+slave\",slave,\"%@\");",
          "content_same": false
        },
        {
          "line": 1858,
          "old_api": "sdslen",
          "new_api": "strtoll",
          "old_text": "sdslen(l)",
          "new_text": "strtoll(l+31,NULL,10)",
          "old_line_content": "        if (sdslen(l) >= 32 &&",
          "new_line_content": "            ri->master_link_down_time = strtoll(l+31,NULL,10)*1000;",
          "content_same": false
        },
        {
          "line": 1872,
          "old_api": "strcasecmp",
          "new_api": "sdsnew",
          "old_text": "strcasecmp(l+12,ri->slave_master_host)",
          "new_text": "sdsnew(l+12)",
          "old_line_content": "                    strcasecmp(l+12,ri->slave_master_host))",
          "new_line_content": "                    ri->slave_master_host = sdsnew(l+12);",
          "content_same": false
        },
        {
          "line": 1900,
          "old_api": "atoi",
          "new_api": "memcmp",
          "old_text": "atoi(l+15)",
          "new_text": "memcmp(l,\"slave_repl_offset:\",18)",
          "old_line_content": "                ri->slave_priority = atoi(l+15);",
          "new_line_content": "            if (sdslen(l) >= 18 && !memcmp(l,\"slave_repl_offset:\",18))",
          "content_same": false
        },
        {
          "line": 1904,
          "old_api": "strtoull",
          "new_api": "mstime",
          "old_text": "strtoull(l+18,NULL,10)",
          "new_text": "mstime()",
          "old_line_content": "                ri->slave_repl_offset = strtoull(l+18,NULL,10);",
          "new_line_content": "    ri->info_refresh = mstime();",
          "content_same": false
        },
        {
          "line": 1918,
          "old_api": "mstime",
          "new_api": "sentinelEvent",
          "old_text": "mstime()",
          "new_text": "sentinelEvent(REDIS_VERBOSE,\n            ((ri->flags & (SRI_MASTER|SRI_SLAVE)) == role) ?\n            \"+role-change\" : \"-role-change\",\n            ri, \"%@ new reported role is %s\",\n            role == SRI_MASTER ? \"master\" : \"slave\",\n            ri->flags & SRI_MASTER ? \"master\" : \"slave\")",
          "old_line_content": "        if (role == SRI_SLAVE) ri->slave_conf_change_time = mstime();",
          "new_line_content": "        sentinelEvent(REDIS_VERBOSE,",
          "content_same": false
        },
        {
          "line": 1956,
          "old_api": "mstime",
          "new_api": "sentinelEvent",
          "old_text": "mstime()",
          "new_text": "sentinelEvent(REDIS_WARNING,\"+failover-state-reconf-slaves\",\n                ri->master,\"%@\")",
          "old_line_content": "            ri->master->failover_state_change_time = mstime();",
          "new_line_content": "            sentinelEvent(REDIS_WARNING,\"+failover-state-reconf-slaves\",",
          "content_same": false
        },
        {
          "line": 1958,
          "old_api": "sentinelEvent",
          "new_api": "sentinelCallClientReconfScript",
          "old_text": "sentinelEvent(REDIS_WARNING,\"+promoted-slave\",ri,\"%@\")",
          "new_text": "sentinelCallClientReconfScript(ri->master,SENTINEL_LEADER,\n                \"start\",ri->master->addr,ri->addr)",
          "old_line_content": "            sentinelEvent(REDIS_WARNING,\"+promoted-slave\",ri,\"%@\");",
          "new_line_content": "            sentinelCallClientReconfScript(ri->master,SENTINEL_LEADER,",
          "content_same": false
        },
        {
          "line": 1972,
          "old_api": "sentinelRedisInstanceNoDownFor",
          "new_api": "sentinelSendSlaveOf",
          "old_text": "sentinelRedisInstanceNoDownFor(ri,wait_time)",
          "new_text": "sentinelSendSlaveOf(ri,\n                        ri->master->addr->ip,\n                        ri->master->addr->port)",
          "old_line_content": "                 sentinelRedisInstanceNoDownFor(ri,wait_time) &&",
          "new_line_content": "                int retval = sentinelSendSlaveOf(ri,",
          "content_same": false
        },
        {
          "line": 1995,
          "old_api": "sentinelRedisInstanceNoDownFor",
          "new_api": "sentinelSendSlaveOf",
          "old_text": "sentinelRedisInstanceNoDownFor(ri,wait_time)",
          "new_text": "sentinelSendSlaveOf(ri,\n                    ri->master->addr->ip,\n                    ri->master->addr->port)",
          "old_line_content": "            sentinelRedisInstanceNoDownFor(ri,wait_time) &&",
          "new_line_content": "            int retval = sentinelSendSlaveOf(ri,",
          "content_same": false
        },
        {
          "line": 2072,
          "old_api": "strncmp",
          "new_api": "mstime",
          "old_text": "strncmp(r->str,\"LOADING\",7)",
          "new_text": "mstime()",
          "old_line_content": "            strncmp(r->str,\"LOADING\",7) == 0 ||",
          "new_line_content": "            ri->last_avail_time = mstime();",
          "content_same": false
        },
        {
          "line": 2133,
          "old_api": "atoi",
          "new_api": "strtoull",
          "old_text": "atoi(token[6])",
          "new_text": "strtoull(token[3],NULL,10)",
          "old_line_content": "        master_port = atoi(token[6]);",
          "new_line_content": "        current_epoch = strtoull(token[3],NULL,10);",
          "content_same": false
        },
        {
          "line": 2134,
          "old_api": "getSentinelRedisInstanceByAddrAndRunID",
          "new_api": "strtoull",
          "old_text": "getSentinelRedisInstanceByAddrAndRunID(\n                        master->sentinels,token[0],port,token[2])",
          "new_text": "strtoull(token[7],NULL,10)",
          "old_line_content": "        si = getSentinelRedisInstanceByAddrAndRunID(",
          "new_line_content": "        master_config_epoch = strtoull(token[7],NULL,10);",
          "content_same": false
        },
        {
          "line": 2143,
          "old_api": "removeMatchingSentinelsFromMaster",
          "new_api": "sentinelEvent",
          "old_text": "removeMatchingSentinelsFromMaster(master,token[0],port,\n                            token[2])",
          "new_text": "sentinelEvent(REDIS_NOTICE,\"-dup-sentinel\",master,\n                    \"%@ #duplicate of %s:%d or %s\",\n                    token[0],port,token[2])",
          "old_line_content": "            removed = removeMatchingSentinelsFromMaster(master,token[0],port,",
          "new_line_content": "                sentinelEvent(REDIS_NOTICE,\"-dup-sentinel\",master,",
          "content_same": false
        },
        {
          "line": 2152,
          "old_api": "createSentinelRedisInstance",
          "new_api": "sentinelEvent",
          "old_text": "createSentinelRedisInstance(NULL,SRI_SENTINEL,\n                            token[0],port,master->quorum,master)",
          "new_text": "sentinelEvent(REDIS_NOTICE,\"+sentinel\",si,\"%@\")",
          "old_line_content": "            si = createSentinelRedisInstance(NULL,SRI_SENTINEL,",
          "new_line_content": "                sentinelEvent(REDIS_NOTICE,\"+sentinel\",si,\"%@\");",
          "content_same": false
        },
        {
          "line": 2189,
          "old_api": "sentinelCallClientReconfScript",
          "new_api": "releaseSentinelAddr",
          "old_text": "sentinelCallClientReconfScript(master,\n                    SENTINEL_OBSERVER,\"start\",\n                    old_addr,master->addr)",
          "new_text": "releaseSentinelAddr(old_addr)",
          "old_line_content": "                sentinelCallClientReconfScript(master,",
          "new_line_content": "                releaseSentinelAddr(old_addr);",
          "content_same": false
        },
        {
          "line": 2227,
          "old_api": "strcmp",
          "new_api": "strstr",
          "old_text": "strcmp(r->element[0]->str,\"message\")",
          "new_text": "strstr(r->element[2]->str,server.runid)",
          "old_line_content": "        strcmp(r->element[0]->str,\"message\") != 0) return;",
          "new_line_content": "    if (strstr(r->element[2]->str,server.runid) != NULL) return;",
          "content_same": false
        },
        {
          "line": 2384,
          "old_api": "sentinelSendPing",
          "new_api": "sentinelSendHello",
          "old_text": "sentinelSendPing(ri)",
          "new_text": "sentinelSendHello(ri)",
          "old_line_content": "        sentinelSendPing(ri);",
          "new_line_content": "        sentinelSendHello(ri);",
          "content_same": false
        },
        {
          "line": 2412,
          "old_api": "addDeferredMultiBulkLength",
          "new_api": "addReplyBulkCString",
          "old_text": "addDeferredMultiBulkLength(c)",
          "new_text": "addReplyBulkCString(c,ri->name)",
          "old_line_content": "    mbl = addDeferredMultiBulkLength(c);",
          "new_line_content": "    addReplyBulkCString(c,ri->name);",
          "content_same": false
        },
        {
          "line": 2423,
          "old_api": "addReplyBulkLongLong",
          "new_api": "addReplyBulkCString",
          "old_text": "addReplyBulkLongLong(c,ri->addr->port)",
          "new_text": "addReplyBulkCString(c,\"runid\")",
          "old_line_content": "    addReplyBulkLongLong(c,ri->addr->port);",
          "new_line_content": "    addReplyBulkCString(c,\"runid\");",
          "content_same": false
        },
        {
          "line": 2430,
          "old_api": "addReplyBulkCString",
          "new_api": "sdscat",
          "old_text": "addReplyBulkCString(c,\"flags\")",
          "new_text": "sdscat(flags,\"master,\")",
          "old_line_content": "    addReplyBulkCString(c,\"flags\");",
          "new_line_content": "    if (ri->flags & SRI_MASTER) flags = sdscat(flags,\"master,\");",
          "content_same": false
        },
        {
          "line": 2442,
          "old_api": "sdscat",
          "new_api": "sdsrange",
          "old_text": "sdscat(flags,\"reconf_inprog,\")",
          "new_text": "sdsrange(flags,0,-2)",
          "old_line_content": "    if (ri->flags & SRI_RECONF_INPROG) flags = sdscat(flags,\"reconf_inprog,\");",
          "new_line_content": "    if (sdslen(flags) != 0) sdsrange(flags,0,-2); /* remove last \",\" */",
          "content_same": false
        },
        {
          "line": 2443,
          "old_api": "sdscat",
          "new_api": "addReplyBulkCString",
          "old_text": "sdscat(flags,\"reconf_done,\")",
          "new_text": "addReplyBulkCString(c,flags)",
          "old_line_content": "    if (ri->flags & SRI_RECONF_DONE) flags = sdscat(flags,\"reconf_done,\");",
          "new_line_content": "    addReplyBulkCString(c,flags);",
          "content_same": false
        },
        {
          "line": 2447,
          "old_api": "sdsfree",
          "new_api": "addReplyBulkCString",
          "old_text": "sdsfree(flags)",
          "new_text": "addReplyBulkCString(c,\"pending-commands\")",
          "old_line_content": "    sdsfree(flags);",
          "new_line_content": "    addReplyBulkCString(c,\"pending-commands\");",
          "content_same": false
        },
        {
          "line": 2462,
          "old_api": "mstime",
          "new_api": "addReplyBulkCString",
          "old_text": "mstime()",
          "new_text": "addReplyBulkCString(c,\"last-ok-ping-reply\")",
          "old_line_content": "        ri->last_ping_time ? (mstime() - ri->last_ping_time) : 0);",
          "new_line_content": "    addReplyBulkCString(c,\"last-ok-ping-reply\");",
          "content_same": false
        },
        {
          "line": 2466,
          "old_api": "mstime",
          "new_api": "addReplyBulkCString",
          "old_text": "mstime()",
          "new_text": "addReplyBulkCString(c,\"last-ping-reply\")",
          "old_line_content": "    addReplyBulkLongLong(c,mstime() - ri->last_avail_time);",
          "new_line_content": "    addReplyBulkCString(c,\"last-ping-reply\");",
          "content_same": false
        },
        {
          "line": 2492,
          "old_api": "mstime",
          "new_api": "addReplyBulkCString",
          "old_text": "mstime()",
          "new_text": "addReplyBulkCString(c,\"role-reported\")",
          "old_line_content": "        addReplyBulkLongLong(c,mstime() - ri->info_refresh);",
          "new_line_content": "        addReplyBulkCString(c,\"role-reported\");",
          "content_same": false
        },
        {
          "line": 2508,
          "old_api": "addReplyBulkLongLong",
          "new_api": "addReplyBulkCString",
          "old_text": "addReplyBulkLongLong(c,ri->config_epoch)",
          "new_text": "addReplyBulkCString(c,\"num-slaves\")",
          "old_line_content": "        addReplyBulkLongLong(c,ri->config_epoch);",
          "new_line_content": "        addReplyBulkCString(c,\"num-slaves\");",
          "content_same": false
        },
        {
          "line": 2512,
          "old_api": "dictSize",
          "new_api": "addReplyBulkCString",
          "old_text": "dictSize(ri->slaves)",
          "new_text": "addReplyBulkCString(c,\"num-other-sentinels\")",
          "old_line_content": "        addReplyBulkLongLong(c,dictSize(ri->slaves));",
          "new_line_content": "        addReplyBulkCString(c,\"num-other-sentinels\");",
          "content_same": false
        },
        {
          "line": 2516,
          "old_api": "dictSize",
          "new_api": "addReplyBulkCString",
          "old_text": "dictSize(ri->sentinels)",
          "new_text": "addReplyBulkCString(c,\"quorum\")",
          "old_line_content": "        addReplyBulkLongLong(c,dictSize(ri->sentinels));",
          "new_line_content": "        addReplyBulkCString(c,\"quorum\");",
          "content_same": false
        },
        {
          "line": 2520,
          "old_api": "addReplyBulkLongLong",
          "new_api": "addReplyBulkCString",
          "old_text": "addReplyBulkLongLong(c,ri->quorum)",
          "new_text": "addReplyBulkCString(c,\"failover-timeout\")",
          "old_line_content": "        addReplyBulkLongLong(c,ri->quorum);",
          "new_line_content": "        addReplyBulkCString(c,\"failover-timeout\");",
          "content_same": false
        },
        {
          "line": 2524,
          "old_api": "addReplyBulkLongLong",
          "new_api": "addReplyBulkCString",
          "old_text": "addReplyBulkLongLong(c,ri->failover_timeout)",
          "new_text": "addReplyBulkCString(c,\"parallel-syncs\")",
          "old_line_content": "        addReplyBulkLongLong(c,ri->failover_timeout);",
          "new_line_content": "        addReplyBulkCString(c,\"parallel-syncs\");",
          "content_same": false
        },
        {
          "line": 2547,
          "old_api": "addReplyBulkLongLong",
          "new_api": "addReplyBulkCString",
          "old_text": "addReplyBulkLongLong(c,ri->master_link_down_time)",
          "new_text": "addReplyBulkCString(c,\"master-link-status\")",
          "old_line_content": "        addReplyBulkLongLong(c,ri->master_link_down_time);",
          "new_line_content": "        addReplyBulkCString(c,\"master-link-status\");",
          "content_same": false
        },
        {
          "line": 2562,
          "old_api": "addReplyBulkLongLong",
          "new_api": "addReplyBulkCString",
          "old_text": "addReplyBulkLongLong(c,ri->slave_master_port)",
          "new_text": "addReplyBulkCString(c,\"slave-priority\")",
          "old_line_content": "        addReplyBulkLongLong(c,ri->slave_master_port);",
          "new_line_content": "        addReplyBulkCString(c,\"slave-priority\");",
          "content_same": false
        },
        {
          "line": 2566,
          "old_api": "addReplyBulkLongLong",
          "new_api": "addReplyBulkCString",
          "old_text": "addReplyBulkLongLong(c,ri->slave_priority)",
          "new_text": "addReplyBulkCString(c,\"slave-repl-offset\")",
          "old_line_content": "        addReplyBulkLongLong(c,ri->slave_priority);",
          "new_line_content": "        addReplyBulkCString(c,\"slave-repl-offset\");",
          "content_same": false
        },
        {
          "line": 2577,
          "old_api": "mstime",
          "new_api": "addReplyBulkCString",
          "old_text": "mstime()",
          "new_text": "addReplyBulkCString(c,\"voted-leader\")",
          "old_line_content": "        addReplyBulkLongLong(c,mstime() - ri->last_hello_time);",
          "new_line_content": "        addReplyBulkCString(c,\"voted-leader\");",
          "content_same": false
        },
        {
          "line": 2598,
          "old_api": "dictGetIterator",
          "new_api": "dictGetVal",
          "old_text": "dictGetIterator(instances)",
          "new_text": "dictGetVal(de)",
          "old_line_content": "    di = dictGetIterator(instances);",
          "new_line_content": "        sentinelRedisInstance *ri = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 2600,
          "old_api": "dictNext",
          "new_api": "addReplySentinelRedisInstance",
          "old_text": "dictNext(di)",
          "new_text": "addReplySentinelRedisInstance(c,ri)",
          "old_line_content": "    while((de = dictNext(di)) != NULL) {",
          "new_line_content": "        addReplySentinelRedisInstance(c,ri);",
          "content_same": false
        },
        {
          "line": 2625,
          "old_api": "strcasecmp",
          "new_api": "addReplyDictOfRedisInstances",
          "old_text": "strcasecmp(c->argv[1]->ptr,\"masters\")",
          "new_text": "addReplyDictOfRedisInstances(c,sentinel.masters)",
          "old_line_content": "    if (!strcasecmp(c->argv[1]->ptr,\"masters\")) {",
          "new_line_content": "        addReplyDictOfRedisInstances(c,sentinel.masters);",
          "content_same": false
        },
        {
          "line": 2634,
          "old_api": "sentinelGetMasterByNameOrReplyError",
          "new_api": "strcasecmp",
          "old_text": "sentinelGetMasterByNameOrReplyError(c,c->argv[2])",
          "new_text": "strcasecmp(c->argv[1]->ptr,\"slaves\")",
          "old_line_content": "        if ((ri = sentinelGetMasterByNameOrReplyError(c,c->argv[2]))",
          "new_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"slaves\")) {",
          "content_same": false
        },
        {
          "line": 2642,
          "old_api": "sentinelGetMasterByNameOrReplyError",
          "new_api": "strcasecmp",
          "old_text": "sentinelGetMasterByNameOrReplyError(c,c->argv[2])",
          "new_text": "strcasecmp(c->argv[1]->ptr,\"sentinels\")",
          "old_line_content": "        if ((ri = sentinelGetMasterByNameOrReplyError(c,c->argv[2])) == NULL)",
          "new_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"sentinels\")) {",
          "content_same": false
        },
        {
          "line": 2650,
          "old_api": "sentinelGetMasterByNameOrReplyError",
          "new_api": "strcasecmp",
          "old_text": "sentinelGetMasterByNameOrReplyError(c,c->argv[2])",
          "new_text": "strcasecmp(c->argv[1]->ptr,\"is-master-down-by-addr\")",
          "old_line_content": "        if ((ri = sentinelGetMasterByNameOrReplyError(c,c->argv[2])) == NULL)",
          "new_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"is-master-down-by-addr\")) {",
          "content_same": false
        },
        {
          "line": 2664,
          "old_api": "getLongLongFromObjectOrReply",
          "new_api": "getSentinelRedisInstanceByAddrAndRunID",
          "old_text": "getLongLongFromObjectOrReply(c,c->argv[4],&req_epoch,NULL)",
          "new_text": "getSentinelRedisInstanceByAddrAndRunID(sentinel.masters,\n            c->argv[2]->ptr,port,NULL)",
          "old_line_content": "            getLongLongFromObjectOrReply(c,c->argv[4],&req_epoch,NULL)",
          "new_line_content": "        ri = getSentinelRedisInstanceByAddrAndRunID(sentinel.masters,",
          "content_same": false
        },
        {
          "line": 2686,
          "old_api": "addReplyMultiBulkLen",
          "new_api": "addReplyLongLong",
          "old_text": "addReplyMultiBulkLen(c,3)",
          "new_text": "addReplyLongLong(c, (long long)leader_epoch)",
          "old_line_content": "        addReplyMultiBulkLen(c,3);",
          "new_line_content": "        addReplyLongLong(c, (long long)leader_epoch);",
          "content_same": false
        },
        {
          "line": 2687,
          "old_api": "addReply",
          "new_api": "sdsfree",
          "old_text": "addReply(c, isdown ? shared.cone : shared.czero)",
          "new_text": "sdsfree(leader)",
          "old_line_content": "        addReply(c, isdown ? shared.cone : shared.czero);",
          "new_line_content": "        if (leader) sdsfree(leader);",
          "content_same": false
        },
        {
          "line": 2688,
          "old_api": "addReplyBulkCString",
          "new_api": "strcasecmp",
          "old_text": "addReplyBulkCString(c, leader ? leader : \"*\")",
          "new_text": "strcasecmp(c->argv[1]->ptr,\"reset\")",
          "old_line_content": "        addReplyBulkCString(c, leader ? leader : \"*\");",
          "new_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"reset\")) {",
          "content_same": false
        },
        {
          "line": 2691,
          "old_api": "strcasecmp",
          "new_api": "sentinelResetMastersByPattern",
          "old_text": "strcasecmp(c->argv[1]->ptr,\"reset\")",
          "new_text": "sentinelResetMastersByPattern(c->argv[2]->ptr,SENTINEL_GENERATE_EVENT)",
          "old_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"reset\")) {",
          "new_line_content": "        addReplyLongLong(c,sentinelResetMastersByPattern(c->argv[2]->ptr,SENTINEL_GENERATE_EVENT));",
          "content_same": false
        },
        {
          "line": 2704,
          "old_api": "sentinelGetCurrentMasterAddress",
          "new_api": "addReplyBulkCString",
          "old_text": "sentinelGetCurrentMasterAddress(ri)",
          "new_text": "addReplyBulkCString(c,addr->ip)",
          "old_line_content": "            sentinelAddr *addr = sentinelGetCurrentMasterAddress(ri);",
          "new_line_content": "            addReplyBulkCString(c,addr->ip);",
          "content_same": false
        },
        {
          "line": 2707,
          "old_api": "addReplyBulkCString",
          "new_api": "strcasecmp",
          "old_text": "addReplyBulkCString(c,addr->ip)",
          "new_text": "strcasecmp(c->argv[1]->ptr,\"failover\")",
          "old_line_content": "            addReplyBulkCString(c,addr->ip);",
          "new_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"failover\")) {",
          "content_same": false
        },
        {
          "line": 2715,
          "old_api": "sentinelGetMasterByNameOrReplyError",
          "new_api": "sdsnew",
          "old_text": "sentinelGetMasterByNameOrReplyError(c,c->argv[2])",
          "new_text": "sdsnew(\"-INPROG Failover already in progress\\r\\n\")",
          "old_line_content": "        if ((ri = sentinelGetMasterByNameOrReplyError(c,c->argv[2])) == NULL)",
          "new_line_content": "            addReplySds(c,sdsnew(\"-INPROG Failover already in progress\\r\\n\"));",
          "content_same": false
        },
        {
          "line": 2718,
          "old_api": "sdsnew",
          "new_api": "sentinelSelectSlave",
          "old_text": "sdsnew(\"-INPROG Failover already in progress\\r\\n\")",
          "new_text": "sentinelSelectSlave(ri)",
          "old_line_content": "            addReplySds(c,sdsnew(\"-INPROG Failover already in progress\\r\\n\"));",
          "new_line_content": "        if (sentinelSelectSlave(ri) == NULL) {",
          "content_same": false
        },
        {
          "line": 2722,
          "old_api": "sdsnew",
          "new_api": "redisLog",
          "old_text": "sdsnew(\"-NOGOODSLAVE No suitable slave to promote\\r\\n\")",
          "new_text": "redisLog(REDIS_WARNING,\"Executing user requested FAILOVER of '%s'\",\n            ri->name)",
          "old_line_content": "            addReplySds(c,sdsnew(\"-NOGOODSLAVE No suitable slave to promote\\r\\n\"));",
          "new_line_content": "        redisLog(REDIS_WARNING,\"Executing user requested FAILOVER of '%s'\",",
          "content_same": false
        },
        {
          "line": 2727,
          "old_api": "sentinelStartFailover",
          "new_api": "strcasecmp",
          "old_text": "sentinelStartFailover(ri)",
          "new_text": "strcasecmp(c->argv[1]->ptr,\"pending-scripts\")",
          "old_line_content": "        sentinelStartFailover(ri);",
          "new_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"pending-scripts\")) {",
          "content_same": false
        },
        {
          "line": 2777,
          "old_api": "sentinelEvent",
          "new_api": "strcasecmp",
          "old_text": "sentinelEvent(REDIS_WARNING,\"+monitor\",ri,\"%@ quorum %d\",ri->quorum)",
          "new_text": "strcasecmp(c->argv[1]->ptr,\"remove\")",
          "old_line_content": "            sentinelEvent(REDIS_WARNING,\"+monitor\",ri,\"%@ quorum %d\",ri->quorum);",
          "new_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"remove\")) {",
          "content_same": false
        },
        {
          "line": 2784,
          "old_api": "sentinelGetMasterByNameOrReplyError",
          "new_api": "dictDelete",
          "old_text": "sentinelGetMasterByNameOrReplyError(c,c->argv[2])",
          "new_text": "dictDelete(sentinel.masters,c->argv[2]->ptr)",
          "old_line_content": "        if ((ri = sentinelGetMasterByNameOrReplyError(c,c->argv[2]))",
          "new_line_content": "        dictDelete(sentinel.masters,c->argv[2]->ptr);",
          "content_same": false
        },
        {
          "line": 2786,
          "old_api": "sentinelEvent",
          "new_api": "addReply",
          "old_text": "sentinelEvent(REDIS_WARNING,\"-monitor\",ri,\"%@\")",
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "        sentinelEvent(REDIS_WARNING,\"-monitor\",ri,\"%@\");",
          "new_line_content": "        addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 2787,
          "old_api": "dictDelete",
          "new_api": "strcasecmp",
          "old_text": "dictDelete(sentinel.masters,c->argv[2]->ptr)",
          "new_text": "strcasecmp(c->argv[1]->ptr,\"set\")",
          "old_line_content": "        dictDelete(sentinel.masters,c->argv[2]->ptr);",
          "new_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"set\")) {",
          "content_same": false
        },
        {
          "line": 2789,
          "old_api": "addReply",
          "new_api": "sentinelSetCommand",
          "old_text": "addReply(c,shared.ok)",
          "new_text": "sentinelSetCommand(c)",
          "old_line_content": "        addReply(c,shared.ok);",
          "new_line_content": "        sentinelSetCommand(c);",
          "content_same": false
        },
        {
          "line": 2792,
          "old_api": "sentinelSetCommand",
          "new_api": "mstime",
          "old_text": "sentinelSetCommand(c)",
          "new_text": "mstime()",
          "old_line_content": "        sentinelSetCommand(c);",
          "new_line_content": "        mstime_t now = mstime();",
          "content_same": false
        },
        {
          "line": 2826,
          "old_api": "dictGetIterator",
          "new_api": "strlen",
          "old_text": "dictGetIterator(masters_local)",
          "new_text": "strlen(ri->name)",
          "old_line_content": "        di = dictGetIterator(masters_local);",
          "new_line_content": "            addReplyBulkCBuffer(c,ri->name,strlen(ri->name));",
          "content_same": false
        },
        {
          "line": 2827,
          "old_api": "dictNext",
          "new_api": "dictSize",
          "old_text": "dictNext(di)",
          "new_text": "dictSize(ri->slaves)",
          "old_line_content": "        while ((de = dictNext(di)) != NULL) {",
          "new_line_content": "            addReplyMultiBulkLen(c,dictSize(ri->slaves) + 1); /* +1 for self */",
          "content_same": false
        },
        {
          "line": 2828,
          "old_api": "dictGetVal",
          "new_api": "addReplyMultiBulkLen",
          "old_text": "dictGetVal(de)",
          "new_text": "addReplyMultiBulkLen(c,2)",
          "old_line_content": "            sentinelRedisInstance *ri = dictGetVal(de);",
          "new_line_content": "            addReplyMultiBulkLen(c,2);",
          "content_same": false
        },
        {
          "line": 2829,
          "old_api": "strlen",
          "new_api": "addReplyLongLong",
          "old_text": "strlen(ri->name)",
          "new_text": "addReplyLongLong(c, now - ri->info_refresh)",
          "old_line_content": "            addReplyBulkCBuffer(c,ri->name,strlen(ri->name));",
          "new_line_content": "            addReplyLongLong(c, now - ri->info_refresh);",
          "content_same": false
        },
        {
          "line": 2831,
          "old_api": "addReplyMultiBulkLen",
          "new_api": "sdslen",
          "old_text": "addReplyMultiBulkLen(c,2)",
          "new_text": "sdslen(ri->info)",
          "old_line_content": "            addReplyMultiBulkLen(c,2);",
          "new_line_content": "                addReplyBulkCBuffer(c,ri->info,sdslen(ri->info));",
          "content_same": false
        },
        {
          "line": 2840,
          "old_api": "dictGetIterator",
          "new_api": "addReplyMultiBulkLen",
          "old_text": "dictGetIterator(ri->slaves)",
          "new_text": "addReplyMultiBulkLen(c,2)",
          "old_line_content": "            sdi = dictGetIterator(ri->slaves);",
          "new_line_content": "                addReplyMultiBulkLen(c,2);",
          "content_same": false
        },
        {
          "line": 2841,
          "old_api": "dictNext",
          "new_api": "addReplyLongLong",
          "old_text": "dictNext(sdi)",
          "new_text": "addReplyLongLong(c, now - sri->info_refresh)",
          "old_line_content": "            while ((sde = dictNext(sdi)) != NULL) {",
          "new_line_content": "                addReplyLongLong(c, now - sri->info_refresh);",
          "content_same": false
        },
        {
          "line": 2843,
          "old_api": "addReplyMultiBulkLen",
          "new_api": "sdslen",
          "old_text": "addReplyMultiBulkLen(c,2)",
          "new_text": "sdslen(sri->info)",
          "old_line_content": "                addReplyMultiBulkLen(c,2);",
          "new_line_content": "                    addReplyBulkCBuffer(c,sri->info,sdslen(sri->info));",
          "content_same": false
        },
        {
          "line": 2850,
          "old_api": "dictReleaseIterator",
          "new_api": "dictRelease",
          "old_text": "dictReleaseIterator(sdi)",
          "new_text": "dictRelease(masters_local)",
          "old_line_content": "            dictReleaseIterator(sdi);",
          "new_line_content": "        if (masters_local != sentinel.masters) dictRelease(masters_local);",
          "content_same": false
        },
        {
          "line": 2852,
          "old_api": "dictReleaseIterator",
          "new_api": "addReplyErrorFormat",
          "old_text": "dictReleaseIterator(di)",
          "new_text": "addReplyErrorFormat(c,\"Unknown sentinel subcommand '%s'\",\n                               (char*)c->argv[1]->ptr)",
          "old_line_content": "        dictReleaseIterator(di);",
          "new_line_content": "        addReplyErrorFormat(c,\"Unknown sentinel subcommand '%s'\",",
          "content_same": false
        },
        {
          "line": 2882,
          "old_api": "sdsempty",
          "new_api": "genRedisInfoString",
          "old_text": "sdsempty()",
          "new_text": "genRedisInfoString(\"server\")",
          "old_line_content": "    sds info = sdsempty();",
          "new_line_content": "        sds serversection = genRedisInfoString(\"server\");",
          "content_same": false
        },
        {
          "line": 2883,
          "old_api": "strcasecmp",
          "new_api": "sdslen",
          "old_text": "strcasecmp(section,\"server\")",
          "new_text": "sdslen(serversection)",
          "old_line_content": "    if (defsections || allsections || !strcasecmp(section,\"server\")) {",
          "new_line_content": "        info = sdscatlen(info,serversection,sdslen(serversection));",
          "content_same": false
        },
        {
          "line": 2884,
          "old_api": "sdscat",
          "new_api": "sdsfree",
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": "sdsfree(serversection)",
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "        sdsfree(serversection);",
          "content_same": false
        },
        {
          "line": 2887,
          "old_api": "sdsfree",
          "new_api": "strcasecmp",
          "old_text": "sdsfree(serversection)",
          "new_text": "strcasecmp(section,\"sentinel\")",
          "old_line_content": "        sdsfree(serversection);",
          "new_line_content": "    if (defsections || allsections || !strcasecmp(section,\"sentinel\")) {",
          "content_same": false
        },
        {
          "line": 2902,
          "old_api": "dictSize",
          "new_api": "listLength",
          "old_text": "dictSize(sentinel.masters)",
          "new_text": "listLength(sentinel.scripts_queue)",
          "old_line_content": "            dictSize(sentinel.masters),",
          "new_line_content": "            listLength(sentinel.scripts_queue));",
          "content_same": false
        },
        {
          "line": 2905,
          "old_api": "listLength",
          "new_api": "dictNext",
          "old_text": "listLength(sentinel.scripts_queue)",
          "new_text": "dictNext(di)",
          "old_line_content": "            listLength(sentinel.scripts_queue));",
          "new_line_content": "        while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 2919,
          "old_api": "dictSize",
          "new_api": "dictReleaseIterator",
          "old_text": "dictSize(ri->slaves)",
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "                dictSize(ri->slaves),",
          "new_line_content": "        dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 2922,
          "old_api": "dictReleaseIterator",
          "new_api": "addReplyBulkSds",
          "old_text": "dictReleaseIterator(di)",
          "new_text": "addReplyBulkSds(c, info)",
          "old_line_content": "        dictReleaseIterator(di);",
          "new_line_content": "    addReplyBulkSds(c, info);",
          "content_same": false
        },
        {
          "line": 2935,
          "old_api": "addReplyBulkCBuffer",
          "new_api": "dictGetIterator",
          "old_text": "addReplyBulkCBuffer(c,\"sentinel\",8)",
          "new_text": "dictGetIterator(sentinel.masters)",
          "old_line_content": "    addReplyBulkCBuffer(c,\"sentinel\",8);",
          "new_line_content": "    di = dictGetIterator(sentinel.masters);",
          "content_same": false
        },
        {
          "line": 2936,
          "old_api": "dictSize",
          "new_api": "dictNext",
          "old_text": "dictSize(sentinel.masters)",
          "new_text": "dictNext(di)",
          "old_line_content": "    addReplyMultiBulkLen(c,dictSize(sentinel.masters));",
          "new_line_content": "    while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 2939,
          "old_api": "dictNext",
          "new_api": "addReplyBulkCString",
          "old_text": "dictNext(di)",
          "new_text": "addReplyBulkCString(c,ri->name)",
          "old_line_content": "    while((de = dictNext(di)) != NULL) {",
          "new_line_content": "        addReplyBulkCString(c,ri->name);",
          "content_same": false
        },
        {
          "line": 2965,
          "old_api": "getLongLongFromObject",
          "new_api": "sentinelPropagateDownAfterPeriod",
          "old_text": "getLongLongFromObject(o,&ll)",
          "new_text": "sentinelPropagateDownAfterPeriod(ri)",
          "old_line_content": "            if (getLongLongFromObject(o,&ll) == REDIS_ERR || ll <= 0)",
          "new_line_content": "            sentinelPropagateDownAfterPeriod(ri);",
          "content_same": false
        },
        {
          "line": 2982,
          "old_api": "strcasecmp",
          "new_api": "addReplyError",
          "old_text": "strcasecmp(option,\"notification-script\")",
          "new_text": "addReplyError(c,\n                    \"Notification script seems non existing or non executable\")",
          "old_line_content": "       } else if (!strcasecmp(option,\"notification-script\")) {",
          "new_line_content": "                addReplyError(c,",
          "content_same": false
        },
        {
          "line": 2984,
          "old_api": "access",
          "new_api": "sentinelFlushConfig",
          "old_text": "access(value,X_OK)",
          "new_text": "sentinelFlushConfig()",
          "old_line_content": "            if (strlen(value) && access(value,X_OK) == -1) {",
          "new_line_content": "                if (changes) sentinelFlushConfig();",
          "content_same": false
        },
        {
          "line": 2987,
          "old_api": "sentinelFlushConfig",
          "new_api": "sdsfree",
          "old_text": "sentinelFlushConfig()",
          "new_text": "sdsfree(ri->notification_script)",
          "old_line_content": "                if (changes) sentinelFlushConfig();",
          "new_line_content": "            sdsfree(ri->notification_script);",
          "content_same": false
        },
        {
          "line": 2990,
          "old_api": "sdsfree",
          "new_api": "strcasecmp",
          "old_text": "sdsfree(ri->notification_script)",
          "new_text": "strcasecmp(option,\"client-reconfig-script\")",
          "old_line_content": "            sdsfree(ri->notification_script);",
          "new_line_content": "       } else if (!strcasecmp(option,\"client-reconfig-script\")) {",
          "content_same": false
        },
        {
          "line": 2993,
          "old_api": "strcasecmp",
          "new_api": "addReplyError",
          "old_text": "strcasecmp(option,\"client-reconfig-script\")",
          "new_text": "addReplyError(c,\n                    \"Client reconfiguration script seems non existing or \"\n                    \"non executable\")",
          "old_line_content": "       } else if (!strcasecmp(option,\"client-reconfig-script\")) {",
          "new_line_content": "                addReplyError(c,",
          "content_same": false
        },
        {
          "line": 2996,
          "old_api": "addReplyError",
          "new_api": "sentinelFlushConfig",
          "old_text": "addReplyError(c,\n                    \"Client reconfiguration script seems non existing or \"\n                    \"non executable\")",
          "new_text": "sentinelFlushConfig()",
          "old_line_content": "                addReplyError(c,",
          "new_line_content": "                if (changes) sentinelFlushConfig();",
          "content_same": false
        },
        {
          "line": 2999,
          "old_api": "sentinelFlushConfig",
          "new_api": "sdsfree",
          "old_text": "sentinelFlushConfig()",
          "new_text": "sdsfree(ri->client_reconfig_script)",
          "old_line_content": "                if (changes) sentinelFlushConfig();",
          "new_line_content": "            sdsfree(ri->client_reconfig_script);",
          "content_same": false
        },
        {
          "line": 3002,
          "old_api": "sdsfree",
          "new_api": "strcasecmp",
          "old_text": "sdsfree(ri->client_reconfig_script)",
          "new_text": "strcasecmp(option,\"auth-pass\")",
          "old_line_content": "            sdsfree(ri->client_reconfig_script);",
          "new_line_content": "       } else if (!strcasecmp(option,\"auth-pass\")) {",
          "content_same": false
        },
        {
          "line": 3005,
          "old_api": "strcasecmp",
          "new_api": "sdsnew",
          "old_text": "strcasecmp(option,\"auth-pass\")",
          "new_text": "sdsnew(value)",
          "old_line_content": "       } else if (!strcasecmp(option,\"auth-pass\")) {",
          "new_line_content": "            ri->auth_pass = strlen(value) ? sdsnew(value) : NULL;",
          "content_same": false
        },
        {
          "line": 3007,
          "old_api": "sdsfree",
          "new_api": "strcasecmp",
          "old_text": "sdsfree(ri->auth_pass)",
          "new_text": "strcasecmp(option,\"quorum\")",
          "old_line_content": "            sdsfree(ri->auth_pass);",
          "new_line_content": "       } else if (!strcasecmp(option,\"quorum\")) {",
          "content_same": false
        },
        {
          "line": 3019,
          "old_api": "sentinelFlushConfig",
          "new_api": "sentinelEvent",
          "old_text": "sentinelFlushConfig()",
          "new_text": "sentinelEvent(REDIS_WARNING,\"+set\",ri,\"%@ %s %s\",option,value)",
          "old_line_content": "            if (changes) sentinelFlushConfig();",
          "new_line_content": "        sentinelEvent(REDIS_WARNING,\"+set\",ri,\"%@ %s %s\",option,value);",
          "content_same": false
        },
        {
          "line": 3022,
          "old_api": "sentinelEvent",
          "new_api": "sentinelFlushConfig",
          "old_text": "sentinelEvent(REDIS_WARNING,\"+set\",ri,\"%@ %s %s\",option,value)",
          "new_text": "sentinelFlushConfig()",
          "old_line_content": "        sentinelEvent(REDIS_WARNING,\"+set\",ri,\"%@ %s %s\",option,value);",
          "new_line_content": "    if (changes) sentinelFlushConfig();",
          "content_same": false
        },
        {
          "line": 3043,
          "old_api": "addReplyError",
          "new_api": "sdslen",
          "old_text": "addReplyError(c, \"Only HELLO messages are accepted by Sentinel instances.\")",
          "new_text": "sdslen(c->argv[2]->ptr)",
          "old_line_content": "        addReplyError(c, \"Only HELLO messages are accepted by Sentinel instances.\");",
          "new_line_content": "    sentinelProcessHelloMessage(c->argv[2]->ptr,sdslen(c->argv[2]->ptr));",
          "content_same": false
        },
        {
          "line": 3070,
          "old_api": "mstime",
          "new_api": "sentinelKillLink",
          "old_text": "mstime()",
          "new_text": "sentinelKillLink(ri,ri->cc)",
          "old_line_content": "        (mstime() - ri->last_ping_time) > (ri->down_after_period/2) &&",
          "new_line_content": "        sentinelKillLink(ri,ri->cc);",
          "content_same": false
        },
        {
          "line": 3082,
          "old_api": "mstime",
          "new_api": "sentinelKillLink",
          "old_text": "mstime()",
          "new_text": "sentinelKillLink(ri,ri->pc)",
          "old_line_content": "        (mstime() - ri->pc_conn_time) > SENTINEL_MIN_LINK_RECONNECT_PERIOD &&",
          "new_line_content": "        sentinelKillLink(ri,ri->pc);",
          "content_same": false
        },
        {
          "line": 3143,
          "old_api": "sentinelEvent",
          "new_api": "mstime",
          "old_text": "sentinelEvent(REDIS_WARNING,\"+odown\",master,\"%@ #quorum %d/%d\",\n                quorum, master->quorum)",
          "new_text": "mstime()",
          "old_line_content": "            sentinelEvent(REDIS_WARNING,\"+odown\",master,\"%@ #quorum %d/%d\",",
          "new_line_content": "            master->o_down_since_time = mstime();",
          "content_same": false
        },
        {
          "line": 3181,
          "old_api": "strcmp",
          "new_api": "sdsfree",
          "old_text": "strcmp(r->element[1]->str,\"*\")",
          "new_text": "sdsfree(ri->leader)",
          "old_line_content": "        if (strcmp(r->element[1]->str,\"*\")) {",
          "new_line_content": "            sdsfree(ri->leader);",
          "content_same": false
        },
        {
          "line": 3205,
          "old_api": "dictGetIterator",
          "new_api": "mstime",
          "old_text": "dictGetIterator(master->sentinels)",
          "new_text": "mstime()",
          "old_line_content": "    di = dictGetIterator(master->sentinels);",
          "new_line_content": "        mstime_t elapsed = mstime() - ri->last_master_down_reply_time;",
          "content_same": false
        },
        {
          "line": 3261,
          "old_api": "sdsfree",
          "new_api": "sentinelFlushConfig",
          "old_text": "sdsfree(master->leader)",
          "new_text": "sentinelFlushConfig()",
          "old_line_content": "        sdsfree(master->leader);",
          "new_line_content": "        sentinelFlushConfig();",
          "content_same": false
        },
        {
          "line": 3262,
          "old_api": "sdsnew",
          "new_api": "sentinelEvent",
          "old_text": "sdsnew(req_runid)",
          "new_text": "sentinelEvent(REDIS_WARNING,\"+vote-for-leader\",master,\"%s %llu\",\n            master->leader, (unsigned long long) master->leader_epoch)",
          "old_line_content": "        master->leader = sdsnew(req_runid);",
          "new_line_content": "        sentinelEvent(REDIS_WARNING,\"+vote-for-leader\",master,\"%s %llu\",",
          "content_same": false
        },
        {
          "line": 3291,
          "old_api": "dictSetUnsignedIntegerVal",
          "new_api": "dictAddRaw",
          "old_text": "dictSetUnsignedIntegerVal(de,oldval+1)",
          "new_text": "dictAddRaw(counters,runid)",
          "old_line_content": "        dictSetUnsignedIntegerVal(de,oldval+1);",
          "new_line_content": "        de = dictAddRaw(counters,runid);",
          "content_same": false
        },
        {
          "line": 3317,
          "old_api": "redisAssert",
          "new_api": "dictSize",
          "old_text": "redisAssert(master->flags & (SRI_O_DOWN|SRI_FAILOVER_IN_PROGRESS))",
          "new_text": "dictSize(master->sentinels)",
          "old_line_content": "    redisAssert(master->flags & (SRI_O_DOWN|SRI_FAILOVER_IN_PROGRESS));",
          "new_line_content": "    voters = dictSize(master->sentinels)+1; /* All the other sentinels and me. */",
          "content_same": false
        },
        {
          "line": 3320,
          "old_api": "dictSize",
          "new_api": "dictGetIterator",
          "old_text": "dictSize(master->sentinels)",
          "new_text": "dictGetIterator(master->sentinels)",
          "old_line_content": "    voters = dictSize(master->sentinels)+1; /* All the other sentinels and me. */",
          "new_line_content": "    di = dictGetIterator(master->sentinels);",
          "content_same": false
        },
        {
          "line": 3324,
          "old_api": "dictNext",
          "new_api": "sentinelLeaderIncr",
          "old_text": "dictNext(di)",
          "new_text": "sentinelLeaderIncr(counters,ri->leader)",
          "old_line_content": "    while((de = dictNext(di)) != NULL) {",
          "new_line_content": "            sentinelLeaderIncr(counters,ri->leader);",
          "content_same": false
        },
        {
          "line": 3340,
          "old_api": "dictGetKey",
          "new_api": "dictReleaseIterator",
          "old_text": "dictGetKey(de)",
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "            winner = dictGetKey(de);",
          "new_line_content": "    dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 3351,
          "old_api": "sentinelVoteLeader",
          "new_api": "sentinelLeaderIncr",
          "old_text": "sentinelVoteLeader(master,epoch,server.runid,&leader_epoch)",
          "new_text": "sentinelLeaderIncr(counters,myvote)",
          "old_line_content": "        myvote = sentinelVoteLeader(master,epoch,server.runid,&leader_epoch);",
          "new_line_content": "        uint64_t votes = sentinelLeaderIncr(counters,myvote);",
          "content_same": false
        },
        {
          "line": 3445,
          "old_api": "sentinelEvent",
          "new_api": "rand",
          "old_text": "sentinelEvent(REDIS_WARNING,\"+new-epoch\",master,\"%llu\",\n        (unsigned long long) sentinel.current_epoch)",
          "new_text": "rand()",
          "old_line_content": "    sentinelEvent(REDIS_WARNING,\"+new-epoch\",master,\"%llu\",",
          "new_line_content": "    master->failover_start_time = mstime()+rand()%SENTINEL_MAX_DESYNC;",
          "content_same": false
        },
        {
          "line": 3479,
          "old_api": "ctime_r",
          "new_api": "redisLog",
          "old_text": "ctime_r(&clock,ctimebuf)",
          "new_text": "redisLog(REDIS_WARNING,\n                \"Next failover delay: I will not start a failover before %s\",\n                ctimebuf)",
          "old_line_content": "            ctime_r(&clock,ctimebuf);",
          "new_line_content": "            redisLog(REDIS_WARNING,",
          "content_same": false
        },
        {
          "line": 3563,
          "old_api": "mstime",
          "new_api": "dictGetIterator",
          "old_text": "mstime()",
          "new_text": "dictGetIterator(master->slaves)",
          "old_line_content": "        max_master_down_time += mstime() - master->s_down_since_time;",
          "new_line_content": "    di = dictGetIterator(master->slaves);",
          "content_same": false
        },
        {
          "line": 3667,
          "old_api": "sentinelEvent",
          "new_api": "mstime",
          "old_text": "sentinelEvent(REDIS_NOTICE, \"+failover-state-wait-promotion\",\n        ri->promoted_slave,\"%@\")",
          "new_text": "mstime()",
          "old_line_content": "    sentinelEvent(REDIS_NOTICE, \"+failover-state-wait-promotion\",",
          "new_line_content": "    ri->failover_state_change_time = mstime();",
          "content_same": false
        },
        {
          "line": 3778,
          "old_api": "mstime",
          "new_api": "sentinelEvent",
          "old_text": "mstime()",
          "new_text": "sentinelEvent(REDIS_NOTICE,\"-slave-reconf-sent-timeout\",slave,\"%@\")",
          "old_line_content": "            (mstime() - slave->slave_reconf_sent_time) >",
          "new_line_content": "            sentinelEvent(REDIS_NOTICE,\"-slave-reconf-sent-timeout\",slave,\"%@\");",
          "content_same": false
        },
        {
          "line": 3802,
          "old_api": "dictReleaseIterator",
          "new_api": "sentinelFailoverDetectEnd",
          "old_text": "dictReleaseIterator(di)",
          "new_text": "sentinelFailoverDetectEnd(master)",
          "old_line_content": "    dictReleaseIterator(di);",
          "new_line_content": "    sentinelFailoverDetectEnd(master);",
          "content_same": false
        },
        {
          "line": 3829,
          "old_api": "sentinelFailoverWaitStart",
          "new_api": "sentinelFailoverSelectSlave",
          "old_text": "sentinelFailoverWaitStart(ri)",
          "new_text": "sentinelFailoverSelectSlave(ri)",
          "old_line_content": "            sentinelFailoverWaitStart(ri);",
          "new_line_content": "            sentinelFailoverSelectSlave(ri);",
          "content_same": false
        },
        {
          "line": 3832,
          "old_api": "sentinelFailoverSelectSlave",
          "new_api": "sentinelFailoverSendSlaveOfNoOne",
          "old_text": "sentinelFailoverSelectSlave(ri)",
          "new_text": "sentinelFailoverSendSlaveOfNoOne(ri)",
          "old_line_content": "            sentinelFailoverSelectSlave(ri);",
          "new_line_content": "            sentinelFailoverSendSlaveOfNoOne(ri);",
          "content_same": false
        },
        {
          "line": 3835,
          "old_api": "sentinelFailoverSendSlaveOfNoOne",
          "new_api": "sentinelFailoverWaitPromotion",
          "old_text": "sentinelFailoverSendSlaveOfNoOne(ri)",
          "new_text": "sentinelFailoverWaitPromotion(ri)",
          "old_line_content": "            sentinelFailoverSendSlaveOfNoOne(ri);",
          "new_line_content": "            sentinelFailoverWaitPromotion(ri);",
          "content_same": false
        },
        {
          "line": 3838,
          "old_api": "sentinelFailoverWaitPromotion",
          "new_api": "sentinelFailoverReconfNextSlave",
          "old_text": "sentinelFailoverWaitPromotion(ri)",
          "new_text": "sentinelFailoverReconfNextSlave(ri)",
          "old_line_content": "            sentinelFailoverWaitPromotion(ri);",
          "new_line_content": "            sentinelFailoverReconfNextSlave(ri);",
          "content_same": false
        },
        {
          "line": 3896,
          "old_api": "sentinelCheckObjectivelyDown",
          "new_api": "sentinelFailoverStateMachine",
          "old_text": "sentinelCheckObjectivelyDown(ri)",
          "new_text": "sentinelFailoverStateMachine(ri)",
          "old_line_content": "        sentinelCheckObjectivelyDown(ri);",
          "new_line_content": "        sentinelFailoverStateMachine(ri);",
          "content_same": false
        },
        {
          "line": 3897,
          "old_api": "sentinelStartFailoverIfNeeded",
          "new_api": "sentinelAskMasterStateToOtherSentinels",
          "old_text": "sentinelStartFailoverIfNeeded(ri)",
          "new_text": "sentinelAskMasterStateToOtherSentinels(ri,SENTINEL_NO_FLAGS)",
          "old_line_content": "        if (sentinelStartFailoverIfNeeded(ri))",
          "new_line_content": "        sentinelAskMasterStateToOtherSentinels(ri,SENTINEL_NO_FLAGS);",
          "content_same": false
        },
        {
          "line": 3913,
          "old_api": "dictNext",
          "new_api": "sentinelHandleRedisInstance",
          "old_text": "dictNext(di)",
          "new_text": "sentinelHandleRedisInstance(ri)",
          "old_line_content": "    while((de = dictNext(di)) != NULL) {",
          "new_line_content": "        sentinelHandleRedisInstance(ri);",
          "content_same": false
        },
        {
          "line": 3916,
          "old_api": "sentinelHandleRedisInstance",
          "new_api": "sentinelHandleDictOfRedisInstances",
          "old_text": "sentinelHandleRedisInstance(ri)",
          "new_text": "sentinelHandleDictOfRedisInstances(ri->sentinels)",
          "old_line_content": "        sentinelHandleRedisInstance(ri);",
          "new_line_content": "            sentinelHandleDictOfRedisInstances(ri->sentinels);",
          "content_same": false
        },
        {
          "line": 3962,
          "old_api": "sentinelCheckTiltCondition",
          "new_api": "sentinelCollectTerminatedScripts",
          "old_text": "sentinelCheckTiltCondition()",
          "new_text": "sentinelCollectTerminatedScripts()",
          "old_line_content": "    sentinelCheckTiltCondition();",
          "new_line_content": "    sentinelCollectTerminatedScripts();",
          "content_same": false
        },
        {
          "line": 3963,
          "old_api": "sentinelHandleDictOfRedisInstances",
          "new_api": "sentinelKillTimedoutScripts",
          "old_text": "sentinelHandleDictOfRedisInstances(sentinel.masters)",
          "new_text": "sentinelKillTimedoutScripts()",
          "old_line_content": "    sentinelHandleDictOfRedisInstances(sentinel.masters);",
          "new_line_content": "    sentinelKillTimedoutScripts();",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 2049,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(reply)",
          "old_line_content": " * value of the command but its effects directly. */",
          "new_line_content": "    REDIS_NOTUSED(reply);",
          "content_same": false
        },
        {
          "line": 2050,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(privdata)",
          "old_line_content": "void sentinelDiscardReplyCallback(redisAsyncContext *c, void *reply, void *privdata) {",
          "new_line_content": "    REDIS_NOTUSED(privdata);",
          "content_same": false
        },
        {
          "line": 2058,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(privdata)",
          "old_line_content": "void sentinelPingReplyCallback(redisAsyncContext *c, void *reply, void *privdata) {",
          "new_line_content": "    REDIS_NOTUSED(privdata);",
          "content_same": false
        },
        {
          "line": 2068,
          "old_api": null,
          "new_api": "strncmp",
          "old_text": null,
          "new_text": "strncmp(r->str,\"PONG\",4)",
          "old_line_content": "        r->type == REDIS_REPLY_ERROR) {",
          "new_line_content": "        if (strncmp(r->str,\"PONG\",4) == 0 ||",
          "content_same": false
        },
        {
          "line": 2069,
          "old_api": null,
          "new_api": "strncmp",
          "old_text": null,
          "new_text": "strncmp(r->str,\"LOADING\",7)",
          "old_line_content": "        /* Update the \"instance available\" field only if this is an",
          "new_line_content": "            strncmp(r->str,\"LOADING\",7) == 0 ||",
          "content_same": false
        },
        {
          "line": 2070,
          "old_api": null,
          "new_api": "strncmp",
          "old_text": null,
          "new_text": "strncmp(r->str,\"MASTERDOWN\",10)",
          "old_line_content": "         * acceptable reply. */",
          "new_line_content": "            strncmp(r->str,\"MASTERDOWN\",10) == 0)",
          "content_same": false
        },
        {
          "line": 2077,
          "old_api": null,
          "new_api": "strncmp",
          "old_text": null,
          "new_text": "strncmp(r->str,\"BUSY\",4)",
          "old_line_content": "        } else {",
          "new_line_content": "            if (strncmp(r->str,\"BUSY\",4) == 0 &&",
          "content_same": false
        },
        {
          "line": 2081,
          "old_api": null,
          "new_api": "redisAsyncCommand",
          "old_text": null,
          "new_text": "redisAsyncCommand(ri->cc,\n                        sentinelDiscardReplyCallback, NULL,\n                        \"SCRIPT KILL\")",
          "old_line_content": "                (ri->flags & SRI_S_DOWN) &&",
          "new_line_content": "                if (redisAsyncCommand(ri->cc,",
          "content_same": false
        },
        {
          "line": 2089,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "            }",
          "new_line_content": "    ri->last_pong_time = mstime();",
          "content_same": false
        },
        {
          "line": 2097,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(privdata)",
          "old_line_content": "void sentinelPublishReplyCallback(redisAsyncContext *c, void *reply, void *privdata) {",
          "new_line_content": "    REDIS_NOTUSED(privdata);",
          "content_same": false
        },
        {
          "line": 2106,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    /* Only update pub_time if we actually published our message. Otherwise",
          "new_line_content": "        ri->last_pub_time = mstime();",
          "content_same": false
        },
        {
          "line": 2120,
          "old_api": null,
          "new_api": "sdssplitlen",
          "old_text": null,
          "new_text": "sdssplitlen(hello, hello_len, \",\", 1, &numtokens)",
          "old_line_content": "     * 5=master_ip,6=master_port,7=master_config_epoch. */",
          "new_line_content": "    char **token = sdssplitlen(hello, hello_len, \",\", 1, &numtokens);",
          "content_same": false
        },
        {
          "line": 2125,
          "old_api": null,
          "new_api": "sentinelGetMasterByName",
          "old_text": null,
          "new_text": "sentinelGetMasterByName(token[4])",
          "old_line_content": "",
          "new_line_content": "        master = sentinelGetMasterByName(token[4]);",
          "content_same": false
        },
        {
          "line": 2129,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(token[1])",
          "old_line_content": "        if (!master) goto cleanup; /* Unknown master, skip the message. */",
          "new_line_content": "        port = atoi(token[1]);",
          "content_same": false
        },
        {
          "line": 2130,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(token[6])",
          "old_line_content": "",
          "new_line_content": "        master_port = atoi(token[6]);",
          "content_same": false
        },
        {
          "line": 2131,
          "old_api": null,
          "new_api": "getSentinelRedisInstanceByAddrAndRunID",
          "old_text": null,
          "new_text": "getSentinelRedisInstanceByAddrAndRunID(\n                        master->sentinels,token[0],port,token[2])",
          "old_line_content": "        /* First, try to see if we already have this sentinel. */",
          "new_line_content": "        si = getSentinelRedisInstanceByAddrAndRunID(",
          "content_same": false
        },
        {
          "line": 2140,
          "old_api": null,
          "new_api": "removeMatchingSentinelsFromMaster",
          "old_text": null,
          "new_text": "removeMatchingSentinelsFromMaster(master,token[0],port,\n                            token[2])",
          "old_line_content": "            /* If not, remove all the sentinels that have the same runid",
          "new_line_content": "            removed = removeMatchingSentinelsFromMaster(master,token[0],port,",
          "content_same": false
        },
        {
          "line": 2149,
          "old_api": null,
          "new_api": "createSentinelRedisInstance",
          "old_text": null,
          "new_text": "createSentinelRedisInstance(NULL,SRI_SENTINEL,\n                            token[0],port,master->quorum,master)",
          "old_line_content": "            }",
          "new_line_content": "            si = createSentinelRedisInstance(NULL,SRI_SENTINEL,",
          "content_same": false
        },
        {
          "line": 2156,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(token[2])",
          "old_line_content": "                /* The runid is NULL after a new instance creation and",
          "new_line_content": "                si->runid = sdsnew(token[2]);",
          "content_same": false
        },
        {
          "line": 2157,
          "old_api": null,
          "new_api": "sentinelFlushConfig",
          "old_text": null,
          "new_text": "sentinelFlushConfig()",
          "old_line_content": "                 * for Sentinels we don't have a later chance to fill it,",
          "new_line_content": "                sentinelFlushConfig();",
          "content_same": false
        },
        {
          "line": 2164,
          "old_api": null,
          "new_api": "sentinelFlushConfig",
          "old_text": null,
          "new_text": "sentinelFlushConfig()",
          "old_line_content": "        /* Update local current_epoch if received current_epoch is greater.*/",
          "new_line_content": "            sentinelFlushConfig();",
          "content_same": false
        },
        {
          "line": 2165,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+new-epoch\",master,\"%llu\",\n                (unsigned long long) sentinel.current_epoch)",
          "old_line_content": "        if (current_epoch > sentinel.current_epoch) {",
          "new_line_content": "            sentinelEvent(REDIS_WARNING,\"+new-epoch\",master,\"%llu\",",
          "content_same": false
        },
        {
          "line": 2173,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(master->addr->ip, token[5])",
          "old_line_content": "        if (master->config_epoch < master_config_epoch) {",
          "new_line_content": "                strcmp(master->addr->ip, token[5]))",
          "content_same": false
        },
        {
          "line": 2177,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+config-update-from\",si,\"%@\")",
          "old_line_content": "            {",
          "new_line_content": "                sentinelEvent(REDIS_WARNING,\"+config-update-from\",si,\"%@\");",
          "content_same": false
        },
        {
          "line": 2178,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+switch-master\",\n                    master,\"%s %s %d %s %d\",\n                    master->name,\n                    master->addr->ip, master->addr->port,\n                    token[5], master_port)",
          "old_line_content": "                sentinelAddr *old_addr;",
          "new_line_content": "                sentinelEvent(REDIS_WARNING,\"+switch-master\",",
          "content_same": false
        },
        {
          "line": 2184,
          "old_api": null,
          "new_api": "dupSentinelAddr",
          "old_text": null,
          "new_text": "dupSentinelAddr(master->addr)",
          "old_line_content": "                    master->addr->ip, master->addr->port,",
          "new_line_content": "                old_addr = dupSentinelAddr(master->addr);",
          "content_same": false
        },
        {
          "line": 2185,
          "old_api": null,
          "new_api": "sentinelResetMasterAndChangeAddress",
          "old_text": null,
          "new_text": "sentinelResetMasterAndChangeAddress(master, token[5], master_port)",
          "old_line_content": "                    token[5], master_port);",
          "new_line_content": "                sentinelResetMasterAndChangeAddress(master, token[5], master_port);",
          "content_same": false
        },
        {
          "line": 2186,
          "old_api": null,
          "new_api": "sentinelCallClientReconfScript",
          "old_text": null,
          "new_text": "sentinelCallClientReconfScript(master,\n                    SENTINEL_OBSERVER,\"start\",\n                    old_addr,master->addr)",
          "old_line_content": "",
          "new_line_content": "                sentinelCallClientReconfScript(master,",
          "content_same": false
        },
        {
          "line": 2194,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        }",
          "new_line_content": "        if (si) si->last_hello_time = mstime();",
          "content_same": false
        },
        {
          "line": 2198,
          "old_api": null,
          "new_api": "sdsfreesplitres",
          "old_text": null,
          "new_text": "sdsfreesplitres(token,numtokens)",
          "old_line_content": "    }",
          "new_line_content": "    sdsfreesplitres(token,numtokens);",
          "content_same": false
        },
        {
          "line": 2207,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(privdata)",
          "old_line_content": "void sentinelReceiveHelloMessages(redisAsyncContext *c, void *reply, void *privdata) {",
          "new_line_content": "    REDIS_NOTUSED(privdata);",
          "content_same": false
        },
        {
          "line": 2215,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    /* Update the last activity in the pubsub channel. Note that since we",
          "new_line_content": "    ri->pc_last_activity = mstime();",
          "content_same": false
        },
        {
          "line": 2224,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(r->element[0]->str,\"message\")",
          "old_line_content": "        r->element[0]->type != REDIS_REPLY_STRING ||",
          "new_line_content": "        strcmp(r->element[0]->str,\"message\") != 0) return;",
          "content_same": false
        },
        {
          "line": 2229,
          "old_api": null,
          "new_api": "sentinelProcessHelloMessage",
          "old_text": null,
          "new_text": "sentinelProcessHelloMessage(r->element[2]->str, r->element[2]->len)",
          "old_line_content": "    /* We are not interested in meeting ourselves */",
          "new_line_content": "    sentinelProcessHelloMessage(r->element[2]->str, r->element[2]->len);",
          "content_same": false
        },
        {
          "line": 2250,
          "old_api": null,
          "new_api": "sentinelGetCurrentMasterAddress",
          "old_text": null,
          "new_text": "sentinelGetCurrentMasterAddress(master)",
          "old_line_content": "    char *announce_ip;",
          "new_line_content": "    sentinelAddr *master_addr = sentinelGetCurrentMasterAddress(master);",
          "content_same": false
        },
        {
          "line": 2259,
          "old_api": null,
          "new_api": "anetSockName",
          "old_text": null,
          "new_text": "anetSockName(ri->cc->c.fd,ip,sizeof(ip),NULL)",
          "old_line_content": "    if (sentinel.announce_ip) {",
          "new_line_content": "        if (anetSockName(ri->cc->c.fd,ip,sizeof(ip),NULL) == -1)",
          "content_same": false
        },
        {
          "line": 2267,
          "old_api": null,
          "new_api": "snprintf",
          "old_text": null,
          "new_text": "snprintf(payload,sizeof(payload),\n        \"%s,%d,%s,%llu,\" /* Info about this sentinel. */\n        \"%s,%s,%d,%llu\", /* Info about current master. */\n        announce_ip, announce_port, server.runid,\n        (unsigned long long) sentinel.current_epoch,\n        /* --- */\n        master->name,master_addr->ip,master_addr->port,\n        (unsigned long long) master->config_epoch)",
          "old_line_content": "                    sentinel.announce_port : server.port;",
          "new_line_content": "    snprintf(payload,sizeof(payload),",
          "content_same": false
        },
        {
          "line": 2275,
          "old_api": null,
          "new_api": "redisAsyncCommand",
          "old_text": null,
          "new_text": "redisAsyncCommand(ri->cc,\n        sentinelPublishReplyCallback, NULL, \"PUBLISH %s %s\",\n            SENTINEL_HELLO_CHANNEL,payload)",
          "old_line_content": "        /* --- */",
          "new_line_content": "    retval = redisAsyncCommand(ri->cc,",
          "content_same": false
        },
        {
          "line": 2289,
          "old_api": null,
          "new_api": "dictGetSafeIterator",
          "old_text": null,
          "new_text": "dictGetSafeIterator(instances)",
          "old_line_content": "    dictIterator *di;",
          "new_line_content": "    di = dictGetSafeIterator(instances);",
          "content_same": false
        },
        {
          "line": 2290,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "    dictEntry *de;",
          "new_line_content": "    while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 2291,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "",
          "new_line_content": "        sentinelRedisInstance *ri = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 2295,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "        if (ri->last_pub_time >= (SENTINEL_PUBLISH_PERIOD+1))",
          "new_line_content": "    dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 2310,
          "old_api": null,
          "new_api": "sentinelForceHelloUpdateDictOfRedisInstances",
          "old_text": null,
          "new_text": "sentinelForceHelloUpdateDictOfRedisInstances(master->sentinels)",
          "old_line_content": "    if (!(master->flags & SRI_MASTER)) return REDIS_ERR;",
          "new_line_content": "    sentinelForceHelloUpdateDictOfRedisInstances(master->sentinels);",
          "content_same": false
        },
        {
          "line": 2311,
          "old_api": null,
          "new_api": "sentinelForceHelloUpdateDictOfRedisInstances",
          "old_text": null,
          "new_text": "sentinelForceHelloUpdateDictOfRedisInstances(master->slaves)",
          "old_line_content": "    if (master->last_pub_time >= (SENTINEL_PUBLISH_PERIOD+1))",
          "new_line_content": "    sentinelForceHelloUpdateDictOfRedisInstances(master->slaves);",
          "content_same": false
        },
        {
          "line": 2321,
          "old_api": null,
          "new_api": "redisAsyncCommand",
          "old_text": null,
          "new_text": "redisAsyncCommand(ri->cc,\n        sentinelPingReplyCallback, NULL, \"PING\")",
          "old_line_content": " * On error zero is returned, and we can't consider the PING command",
          "new_line_content": "    int retval = redisAsyncCommand(ri->cc,",
          "content_same": false
        },
        {
          "line": 2328,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        /* We update the ping time only if we received the pong for",
          "new_line_content": "        if (ri->last_ping_time == 0) ri->last_ping_time = mstime();",
          "content_same": false
        },
        {
          "line": 2338,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "/* Send periodic PING, INFO, and PUBLISH to the Hello channel to",
          "new_line_content": "    mstime_t now = mstime();",
          "content_same": false
        },
        {
          "line": 2376,
          "old_api": null,
          "new_api": "redisAsyncCommand",
          "old_text": null,
          "new_text": "redisAsyncCommand(ri->cc,\n            sentinelInfoReplyCallback, NULL, \"INFO\")",
          "old_line_content": "        (now - ri->info_refresh) > info_period))",
          "new_line_content": "        retval = redisAsyncCommand(ri->cc,",
          "content_same": false
        },
        {
          "line": 2381,
          "old_api": null,
          "new_api": "sentinelSendPing",
          "old_text": null,
          "new_text": "sentinelSendPing(ri)",
          "old_line_content": "        if (retval == REDIS_OK) ri->pending_commands++;",
          "new_line_content": "        sentinelSendPing(ri);",
          "content_same": false
        },
        {
          "line": 2405,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "",
          "new_line_content": "    char *flags = sdsempty();",
          "content_same": false
        },
        {
          "line": 2409,
          "old_api": null,
          "new_api": "addDeferredMultiBulkLength",
          "old_text": null,
          "new_text": "addDeferredMultiBulkLength(c)",
          "old_line_content": "    void *mbl;",
          "new_line_content": "    mbl = addDeferredMultiBulkLength(c);",
          "content_same": false
        },
        {
          "line": 2411,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"name\")",
          "old_line_content": "",
          "new_line_content": "    addReplyBulkCString(c,\"name\");",
          "content_same": false
        },
        {
          "line": 2416,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,ri->addr->ip)",
          "old_line_content": "    fields++;",
          "new_line_content": "    addReplyBulkCString(c,ri->addr->ip);",
          "content_same": false
        },
        {
          "line": 2420,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,ri->addr->port)",
          "old_line_content": "    fields++;",
          "new_line_content": "    addReplyBulkLongLong(c,ri->addr->port);",
          "content_same": false
        },
        {
          "line": 2424,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,ri->runid ? ri->runid : \"\")",
          "old_line_content": "    fields++;",
          "new_line_content": "    addReplyBulkCString(c,ri->runid ? ri->runid : \"\");",
          "content_same": false
        },
        {
          "line": 2428,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(flags,\"s_down,\")",
          "old_line_content": "    fields++;",
          "new_line_content": "    if (ri->flags & SRI_S_DOWN) flags = sdscat(flags,\"s_down,\");",
          "content_same": false
        },
        {
          "line": 2429,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(flags,\"o_down,\")",
          "old_line_content": "",
          "new_line_content": "    if (ri->flags & SRI_O_DOWN) flags = sdscat(flags,\"o_down,\");",
          "content_same": false
        },
        {
          "line": 2438,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(flags,\"reconf_sent,\")",
          "old_line_content": "    if (ri->flags & SRI_FAILOVER_IN_PROGRESS)",
          "new_line_content": "    if (ri->flags & SRI_RECONF_SENT) flags = sdscat(flags,\"reconf_sent,\");",
          "content_same": false
        },
        {
          "line": 2444,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(flags)",
          "old_line_content": "",
          "new_line_content": "    sdsfree(flags);",
          "content_same": false
        },
        {
          "line": 2448,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,ri->pending_commands)",
          "old_line_content": "    fields++;",
          "new_line_content": "    addReplyBulkLongLong(c,ri->pending_commands);",
          "content_same": false
        },
        {
          "line": 2452,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"failover-state\")",
          "old_line_content": "    fields++;",
          "new_line_content": "        addReplyBulkCString(c,\"failover-state\");",
          "content_same": false
        },
        {
          "line": 2453,
          "old_api": null,
          "new_api": "sentinelFailoverStateStr",
          "old_text": null,
          "new_text": "sentinelFailoverStateStr(ri->failover_state)",
          "old_line_content": "",
          "new_line_content": "        addReplyBulkCString(c,(char*)sentinelFailoverStateStr(ri->failover_state));",
          "content_same": false
        },
        {
          "line": 2457,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"last-ping-sent\")",
          "old_line_content": "        fields++;",
          "new_line_content": "    addReplyBulkCString(c,\"last-ping-sent\");",
          "content_same": false
        },
        {
          "line": 2458,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,\n        ri->last_ping_time ? (mstime() - ri->last_ping_time) : 0)",
          "old_line_content": "    }",
          "new_line_content": "    addReplyBulkLongLong(c,",
          "content_same": false
        },
        {
          "line": 2459,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "",
          "new_line_content": "        ri->last_ping_time ? (mstime() - ri->last_ping_time) : 0);",
          "content_same": false
        },
        {
          "line": 2463,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    fields++;",
          "new_line_content": "    addReplyBulkLongLong(c,mstime() - ri->last_avail_time);",
          "content_same": false
        },
        {
          "line": 2467,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    fields++;",
          "new_line_content": "    addReplyBulkLongLong(c,mstime() - ri->last_pong_time);",
          "content_same": false
        },
        {
          "line": 2471,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"s-down-time\")",
          "old_line_content": "    fields++;",
          "new_line_content": "        addReplyBulkCString(c,\"s-down-time\");",
          "content_same": false
        },
        {
          "line": 2472,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "",
          "new_line_content": "        addReplyBulkLongLong(c,mstime()-ri->s_down_since_time);",
          "content_same": false
        },
        {
          "line": 2477,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"o-down-time\")",
          "old_line_content": "    }",
          "new_line_content": "        addReplyBulkCString(c,\"o-down-time\");",
          "content_same": false
        },
        {
          "line": 2478,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "",
          "new_line_content": "        addReplyBulkLongLong(c,mstime()-ri->o_down_since_time);",
          "content_same": false
        },
        {
          "line": 2482,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"down-after-milliseconds\")",
          "old_line_content": "        fields++;",
          "new_line_content": "    addReplyBulkCString(c,\"down-after-milliseconds\");",
          "content_same": false
        },
        {
          "line": 2483,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,ri->down_after_period)",
          "old_line_content": "    }",
          "new_line_content": "    addReplyBulkLongLong(c,ri->down_after_period);",
          "content_same": false
        },
        {
          "line": 2488,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"info-refresh\")",
          "old_line_content": "",
          "new_line_content": "        addReplyBulkCString(c,\"info-refresh\");",
          "content_same": false
        },
        {
          "line": 2489,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    /* Masters and Slaves */",
          "new_line_content": "        addReplyBulkLongLong(c,mstime() - ri->info_refresh);",
          "content_same": false
        },
        {
          "line": 2493,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c, (ri->role_reported == SRI_MASTER) ? \"master\" :\n                                                                   \"slave\")",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkCString(c, (ri->role_reported == SRI_MASTER) ? \"master\" :",
          "content_same": false
        },
        {
          "line": 2497,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"role-reported-time\")",
          "old_line_content": "                                                                   \"slave\");",
          "new_line_content": "        addReplyBulkCString(c,\"role-reported-time\");",
          "content_same": false
        },
        {
          "line": 2498,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkLongLong(c,mstime() - ri->role_reported_time);",
          "content_same": false
        },
        {
          "line": 2504,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"config-epoch\")",
          "old_line_content": "",
          "new_line_content": "        addReplyBulkCString(c,\"config-epoch\");",
          "content_same": false
        },
        {
          "line": 2505,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,ri->config_epoch)",
          "old_line_content": "    /* Only masters */",
          "new_line_content": "        addReplyBulkLongLong(c,ri->config_epoch);",
          "content_same": false
        },
        {
          "line": 2509,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(ri->slaves)",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkLongLong(c,dictSize(ri->slaves));",
          "content_same": false
        },
        {
          "line": 2513,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(ri->sentinels)",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkLongLong(c,dictSize(ri->sentinels));",
          "content_same": false
        },
        {
          "line": 2517,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,ri->quorum)",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkLongLong(c,ri->quorum);",
          "content_same": false
        },
        {
          "line": 2521,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,ri->failover_timeout)",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkLongLong(c,ri->failover_timeout);",
          "content_same": false
        },
        {
          "line": 2525,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,ri->parallel_syncs)",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkLongLong(c,ri->parallel_syncs);",
          "content_same": false
        },
        {
          "line": 2529,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"notification-script\")",
          "old_line_content": "        fields++;",
          "new_line_content": "            addReplyBulkCString(c,\"notification-script\");",
          "content_same": false
        },
        {
          "line": 2530,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,ri->notification_script)",
          "old_line_content": "",
          "new_line_content": "            addReplyBulkCString(c,ri->notification_script);",
          "content_same": false
        },
        {
          "line": 2535,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"client-reconfig-script\")",
          "old_line_content": "        }",
          "new_line_content": "            addReplyBulkCString(c,\"client-reconfig-script\");",
          "content_same": false
        },
        {
          "line": 2536,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,ri->client_reconfig_script)",
          "old_line_content": "",
          "new_line_content": "            addReplyBulkCString(c,ri->client_reconfig_script);",
          "content_same": false
        },
        {
          "line": 2543,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"master-link-down-time\")",
          "old_line_content": "",
          "new_line_content": "        addReplyBulkCString(c,\"master-link-down-time\");",
          "content_same": false
        },
        {
          "line": 2544,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,ri->master_link_down_time)",
          "old_line_content": "    /* Only slaves */",
          "new_line_content": "        addReplyBulkLongLong(c,ri->master_link_down_time);",
          "content_same": false
        },
        {
          "line": 2548,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\n            (ri->slave_master_link_status == SENTINEL_MASTER_LINK_STATUS_UP) ?\n            \"ok\" : \"err\")",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkCString(c,",
          "content_same": false
        },
        {
          "line": 2553,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"master-host\")",
          "old_line_content": "            \"ok\" : \"err\");",
          "new_line_content": "        addReplyBulkCString(c,\"master-host\");",
          "content_same": false
        },
        {
          "line": 2554,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\n            ri->slave_master_host ? ri->slave_master_host : \"?\")",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkCString(c,",
          "content_same": false
        },
        {
          "line": 2558,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"master-port\")",
          "old_line_content": "            ri->slave_master_host ? ri->slave_master_host : \"?\");",
          "new_line_content": "        addReplyBulkCString(c,\"master-port\");",
          "content_same": false
        },
        {
          "line": 2559,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,ri->slave_master_port)",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkLongLong(c,ri->slave_master_port);",
          "content_same": false
        },
        {
          "line": 2563,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,ri->slave_priority)",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkLongLong(c,ri->slave_priority);",
          "content_same": false
        },
        {
          "line": 2567,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,ri->slave_repl_offset)",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkLongLong(c,ri->slave_repl_offset);",
          "content_same": false
        },
        {
          "line": 2573,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"last-hello-message\")",
          "old_line_content": "",
          "new_line_content": "        addReplyBulkCString(c,\"last-hello-message\");",
          "content_same": false
        },
        {
          "line": 2574,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    /* Only sentinels */",
          "new_line_content": "        addReplyBulkLongLong(c,mstime() - ri->last_hello_time);",
          "content_same": false
        },
        {
          "line": 2578,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,ri->leader ? ri->leader : \"?\")",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkCString(c,ri->leader ? ri->leader : \"?\");",
          "content_same": false
        },
        {
          "line": 2582,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,ri->leader_epoch)",
          "old_line_content": "        fields++;",
          "new_line_content": "        addReplyBulkLongLong(c,ri->leader_epoch);",
          "content_same": false
        },
        {
          "line": 2586,
          "old_api": null,
          "new_api": "setDeferredMultiBulkLength",
          "old_text": null,
          "new_text": "setDeferredMultiBulkLength(c,mbl,fields*2)",
          "old_line_content": "        fields++;",
          "new_line_content": "    setDeferredMultiBulkLength(c,mbl,fields*2);",
          "content_same": false
        },
        {
          "line": 2595,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(instances)",
          "old_line_content": "    dictIterator *di;",
          "new_line_content": "    di = dictGetIterator(instances);",
          "content_same": false
        },
        {
          "line": 2596,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(instances)",
          "old_line_content": "    dictEntry *de;",
          "new_line_content": "    addReplyMultiBulkLen(c,dictSize(instances));",
          "content_same": false
        },
        {
          "line": 2597,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "",
          "new_line_content": "    while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 2602,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "",
          "new_line_content": "    dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 2613,
          "old_api": null,
          "new_api": "dictFetchValue",
          "old_text": null,
          "new_text": "dictFetchValue(sentinel.masters,name->ptr)",
          "old_line_content": "{",
          "new_line_content": "    ri = dictFetchValue(sentinel.masters,name->ptr);",
          "content_same": false
        },
        {
          "line": 2615,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c,\"No such master with that name\")",
          "old_line_content": "",
          "new_line_content": "        addReplyError(c,\"No such master with that name\");",
          "content_same": false
        },
        {
          "line": 2622,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(c->argv[1]->ptr,\"masters\")",
          "old_line_content": "}",
          "new_line_content": "    if (!strcasecmp(c->argv[1]->ptr,\"masters\")) {",
          "content_same": false
        },
        {
          "line": 2626,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(c->argv[1]->ptr,\"master\")",
          "old_line_content": "        /* SENTINEL MASTERS */",
          "new_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"master\")) {",
          "content_same": false
        },
        {
          "line": 2631,
          "old_api": null,
          "new_api": "sentinelGetMasterByNameOrReplyError",
          "old_text": null,
          "new_text": "sentinelGetMasterByNameOrReplyError(c,c->argv[2])",
          "old_line_content": "        sentinelRedisInstance *ri;",
          "new_line_content": "        if ((ri = sentinelGetMasterByNameOrReplyError(c,c->argv[2]))",
          "content_same": false
        },
        {
          "line": 2633,
          "old_api": null,
          "new_api": "addReplySentinelRedisInstance",
          "old_text": null,
          "new_text": "addReplySentinelRedisInstance(c,ri)",
          "old_line_content": "        if (c->argc != 3) goto numargserr;",
          "new_line_content": "        addReplySentinelRedisInstance(c,ri);",
          "content_same": false
        },
        {
          "line": 2639,
          "old_api": null,
          "new_api": "sentinelGetMasterByNameOrReplyError",
          "old_text": null,
          "new_text": "sentinelGetMasterByNameOrReplyError(c,c->argv[2])",
          "old_line_content": "        sentinelRedisInstance *ri;",
          "new_line_content": "        if ((ri = sentinelGetMasterByNameOrReplyError(c,c->argv[2])) == NULL)",
          "content_same": false
        },
        {
          "line": 2641,
          "old_api": null,
          "new_api": "addReplyDictOfRedisInstances",
          "old_text": null,
          "new_text": "addReplyDictOfRedisInstances(c,ri->slaves)",
          "old_line_content": "        if (c->argc != 3) goto numargserr;",
          "new_line_content": "        addReplyDictOfRedisInstances(c,ri->slaves);",
          "content_same": false
        },
        {
          "line": 2647,
          "old_api": null,
          "new_api": "sentinelGetMasterByNameOrReplyError",
          "old_text": null,
          "new_text": "sentinelGetMasterByNameOrReplyError(c,c->argv[2])",
          "old_line_content": "        sentinelRedisInstance *ri;",
          "new_line_content": "        if ((ri = sentinelGetMasterByNameOrReplyError(c,c->argv[2])) == NULL)",
          "content_same": false
        },
        {
          "line": 2649,
          "old_api": null,
          "new_api": "addReplyDictOfRedisInstances",
          "old_text": null,
          "new_text": "addReplyDictOfRedisInstances(c,ri->sentinels)",
          "old_line_content": "        if (c->argc != 3) goto numargserr;",
          "new_line_content": "        addReplyDictOfRedisInstances(c,ri->sentinels);",
          "content_same": false
        },
        {
          "line": 2660,
          "old_api": null,
          "new_api": "getLongFromObjectOrReply",
          "old_text": null,
          "new_text": "getLongFromObjectOrReply(c,c->argv[3],&port,NULL)",
          "old_line_content": "        int isdown = 0;",
          "new_line_content": "        if (getLongFromObjectOrReply(c,c->argv[3],&port,NULL) != REDIS_OK ||",
          "content_same": false
        },
        {
          "line": 2661,
          "old_api": null,
          "new_api": "getLongLongFromObjectOrReply",
          "old_text": null,
          "new_text": "getLongLongFromObjectOrReply(c,c->argv[4],&req_epoch,NULL)",
          "old_line_content": "",
          "new_line_content": "            getLongLongFromObjectOrReply(c,c->argv[4],&req_epoch,NULL)",
          "content_same": false
        },
        {
          "line": 2675,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(c->argv[5]->ptr,\"*\")",
          "old_line_content": "",
          "new_line_content": "        if (ri && ri->flags & SRI_MASTER && strcasecmp(c->argv[5]->ptr,\"*\")) {",
          "content_same": false
        },
        {
          "line": 2676,
          "old_api": null,
          "new_api": "sentinelVoteLeader",
          "old_text": null,
          "new_text": "sentinelVoteLeader(ri,(uint64_t)req_epoch,\n                                            c->argv[5]->ptr,\n                                            &leader_epoch)",
          "old_line_content": "        /* Vote for the master (or fetch the previous vote) if the request",
          "new_line_content": "            leader = sentinelVoteLeader(ri,(uint64_t)req_epoch,",
          "content_same": false
        },
        {
          "line": 2683,
          "old_api": null,
          "new_api": "addReplyMultiBulkLen",
          "old_text": null,
          "new_text": "addReplyMultiBulkLen(c,3)",
          "old_line_content": "",
          "new_line_content": "        addReplyMultiBulkLen(c,3);",
          "content_same": false
        },
        {
          "line": 2684,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c, isdown ? shared.cone : shared.czero)",
          "old_line_content": "        /* Reply with a three-elements multi-bulk reply:",
          "new_line_content": "        addReply(c, isdown ? shared.cone : shared.czero);",
          "content_same": false
        },
        {
          "line": 2685,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c, leader ? leader : \"*\")",
          "old_line_content": "         * down state, leader, vote epoch. */",
          "new_line_content": "        addReplyBulkCString(c, leader ? leader : \"*\");",
          "content_same": false
        },
        {
          "line": 2692,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(c->argv[1]->ptr,\"get-master-addr-by-name\")",
          "old_line_content": "        /* SENTINEL RESET <pattern> */",
          "new_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"get-master-addr-by-name\")) {",
          "content_same": false
        },
        {
          "line": 2697,
          "old_api": null,
          "new_api": "sentinelGetMasterByName",
          "old_text": null,
          "new_text": "sentinelGetMasterByName(c->argv[2]->ptr)",
          "old_line_content": "        sentinelRedisInstance *ri;",
          "new_line_content": "        ri = sentinelGetMasterByName(c->argv[2]->ptr);",
          "content_same": false
        },
        {
          "line": 2699,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.nullmultibulk)",
          "old_line_content": "        if (c->argc != 3) goto numargserr;",
          "new_line_content": "            addReply(c,shared.nullmultibulk);",
          "content_same": false
        },
        {
          "line": 2701,
          "old_api": null,
          "new_api": "sentinelGetCurrentMasterAddress",
          "old_text": null,
          "new_text": "sentinelGetCurrentMasterAddress(ri)",
          "old_line_content": "        if (ri == NULL) {",
          "new_line_content": "            sentinelAddr *addr = sentinelGetCurrentMasterAddress(ri);",
          "content_same": false
        },
        {
          "line": 2703,
          "old_api": null,
          "new_api": "addReplyMultiBulkLen",
          "old_text": null,
          "new_text": "addReplyMultiBulkLen(c,2)",
          "old_line_content": "        } else {",
          "new_line_content": "            addReplyMultiBulkLen(c,2);",
          "content_same": false
        },
        {
          "line": 2705,
          "old_api": null,
          "new_api": "addReplyBulkLongLong",
          "old_text": null,
          "new_text": "addReplyBulkLongLong(c,addr->port)",
          "old_line_content": "",
          "new_line_content": "            addReplyBulkLongLong(c,addr->port);",
          "content_same": false
        },
        {
          "line": 2712,
          "old_api": null,
          "new_api": "sentinelGetMasterByNameOrReplyError",
          "old_text": null,
          "new_text": "sentinelGetMasterByNameOrReplyError(c,c->argv[2])",
          "old_line_content": "        sentinelRedisInstance *ri;",
          "new_line_content": "        if ((ri = sentinelGetMasterByNameOrReplyError(c,c->argv[2])) == NULL)",
          "content_same": false
        },
        {
          "line": 2719,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(\"-NOGOODSLAVE No suitable slave to promote\\r\\n\")",
          "old_line_content": "            return;",
          "new_line_content": "            addReplySds(c,sdsnew(\"-NOGOODSLAVE No suitable slave to promote\\r\\n\"));",
          "content_same": false
        },
        {
          "line": 2724,
          "old_api": null,
          "new_api": "sentinelStartFailover",
          "old_text": null,
          "new_text": "sentinelStartFailover(ri)",
          "old_line_content": "        }",
          "new_line_content": "        sentinelStartFailover(ri);",
          "content_same": false
        },
        {
          "line": 2726,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "            ri->name);",
          "new_line_content": "        addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 2731,
          "old_api": null,
          "new_api": "sentinelPendingScriptsCommand",
          "old_text": null,
          "new_text": "sentinelPendingScriptsCommand(c)",
          "old_line_content": "        /* SENTINEL PENDING-SCRIPTS */",
          "new_line_content": "        sentinelPendingScriptsCommand(c);",
          "content_same": false
        },
        {
          "line": 2732,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(c->argv[1]->ptr,\"monitor\")",
          "old_line_content": "",
          "new_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"monitor\")) {",
          "content_same": false
        },
        {
          "line": 2739,
          "old_api": null,
          "new_api": "getLongFromObjectOrReply",
          "old_text": null,
          "new_text": "getLongFromObjectOrReply(c,c->argv[5],&quorum,\"Invalid quorum\")",
          "old_line_content": "        char ip[REDIS_IP_STR_LEN];",
          "new_line_content": "        if (getLongFromObjectOrReply(c,c->argv[5],&quorum,\"Invalid quorum\")",
          "content_same": false
        },
        {
          "line": 2741,
          "old_api": null,
          "new_api": "getLongFromObjectOrReply",
          "old_text": null,
          "new_text": "getLongFromObjectOrReply(c,c->argv[4],&port,\"Invalid port\")",
          "old_line_content": "        if (c->argc != 6) goto numargserr;",
          "new_line_content": "        if (getLongFromObjectOrReply(c,c->argv[4],&port,\"Invalid port\")",
          "content_same": false
        },
        {
          "line": 2745,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c, \"Quorum must be 1 or greater.\")",
          "old_line_content": "            != REDIS_OK) return;",
          "new_line_content": "            addReplyError(c, \"Quorum must be 1 or greater.\");",
          "content_same": false
        },
        {
          "line": 2752,
          "old_api": null,
          "new_api": "anetResolveIP",
          "old_text": null,
          "new_text": "anetResolveIP(NULL,c->argv[3]->ptr,ip,sizeof(ip))",
          "old_line_content": "        /* Make sure the IP field is actually a valid IP before passing it",
          "new_line_content": "        if (anetResolveIP(NULL,c->argv[3]->ptr,ip,sizeof(ip)) == ANET_ERR) {",
          "content_same": false
        },
        {
          "line": 2753,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c,\"Invalid IP address specified\")",
          "old_line_content": "         * to createSentinelRedisInstance(), otherwise we may trigger a",
          "new_line_content": "            addReplyError(c,\"Invalid IP address specified\");",
          "content_same": false
        },
        {
          "line": 2758,
          "old_api": null,
          "new_api": "createSentinelRedisInstance",
          "old_text": null,
          "new_text": "createSentinelRedisInstance(c->argv[2]->ptr,SRI_MASTER,\n                c->argv[3]->ptr,port,quorum,NULL)",
          "old_line_content": "        }",
          "new_line_content": "        ri = createSentinelRedisInstance(c->argv[2]->ptr,SRI_MASTER,",
          "content_same": false
        },
        {
          "line": 2763,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c,\"Duplicated master name\")",
          "old_line_content": "        if (ri == NULL) {",
          "new_line_content": "                addReplyError(c,\"Duplicated master name\");",
          "content_same": false
        },
        {
          "line": 2773,
          "old_api": null,
          "new_api": "sentinelFlushConfig",
          "old_text": null,
          "new_text": "sentinelFlushConfig()",
          "old_line_content": "                break;",
          "new_line_content": "            sentinelFlushConfig();",
          "content_same": false
        },
        {
          "line": 2774,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+monitor\",ri,\"%@ quorum %d\",ri->quorum)",
          "old_line_content": "            }",
          "new_line_content": "            sentinelEvent(REDIS_WARNING,\"+monitor\",ri,\"%@ quorum %d\",ri->quorum);",
          "content_same": false
        },
        {
          "line": 2775,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "        } else {",
          "new_line_content": "            addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 2781,
          "old_api": null,
          "new_api": "sentinelGetMasterByNameOrReplyError",
          "old_text": null,
          "new_text": "sentinelGetMasterByNameOrReplyError(c,c->argv[2])",
          "old_line_content": "        /* SENTINEL REMOVE <name> */",
          "new_line_content": "        if ((ri = sentinelGetMasterByNameOrReplyError(c,c->argv[2]))",
          "content_same": false
        },
        {
          "line": 2783,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"-monitor\",ri,\"%@\")",
          "old_line_content": "",
          "new_line_content": "        sentinelEvent(REDIS_WARNING,\"-monitor\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 2785,
          "old_api": null,
          "new_api": "sentinelFlushConfig",
          "old_text": null,
          "new_text": "sentinelFlushConfig()",
          "old_line_content": "            == NULL) return;",
          "new_line_content": "        sentinelFlushConfig();",
          "content_same": false
        },
        {
          "line": 2801,
          "old_api": null,
          "new_api": "dictCreate",
          "old_text": null,
          "new_text": "dictCreate(&copy_keeper, NULL)",
          "old_line_content": "        copy_keeper.valDestructor = NULL;",
          "new_line_content": "            masters_local = dictCreate(&copy_keeper, NULL);",
          "content_same": false
        },
        {
          "line": 2805,
          "old_api": null,
          "new_api": "sentinelGetMasterByName",
          "old_text": null,
          "new_text": "sentinelGetMasterByName(c->argv[i]->ptr)",
          "old_line_content": "",
          "new_line_content": "                ri = sentinelGetMasterByName(c->argv[i]->ptr);",
          "content_same": false
        },
        {
          "line": 2807,
          "old_api": null,
          "new_api": "dictAdd",
          "old_text": null,
          "new_text": "dictAdd(masters_local, ri->name, ri)",
          "old_line_content": "                sentinelRedisInstance *ri;",
          "new_line_content": "                dictAdd(masters_local, ri->name, ri);",
          "content_same": false
        },
        {
          "line": 2819,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(masters_local)",
          "old_line_content": "         *   3.) other master name",
          "new_line_content": "        addReplyMultiBulkLen(c,dictSize(masters_local) * 2);",
          "content_same": false
        },
        {
          "line": 2823,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(masters_local)",
          "old_line_content": "",
          "new_line_content": "        di = dictGetIterator(masters_local);",
          "content_same": false
        },
        {
          "line": 2824,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "        dictIterator  *di;",
          "new_line_content": "        while ((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 2825,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "        dictEntry *de;",
          "new_line_content": "            sentinelRedisInstance *ri = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 2833,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.nullbulk)",
          "old_line_content": "            if (ri->info)",
          "new_line_content": "                addReply(c,shared.nullbulk);",
          "content_same": false
        },
        {
          "line": 2837,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(ri->slaves)",
          "old_line_content": "",
          "new_line_content": "            sdi = dictGetIterator(ri->slaves);",
          "content_same": false
        },
        {
          "line": 2838,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(sdi)",
          "old_line_content": "            dictIterator *sdi;",
          "new_line_content": "            while ((sde = dictNext(sdi)) != NULL) {",
          "content_same": false
        },
        {
          "line": 2839,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(sde)",
          "old_line_content": "            dictEntry *sde;",
          "new_line_content": "                sentinelRedisInstance *sri = dictGetVal(sde);",
          "content_same": false
        },
        {
          "line": 2845,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.nullbulk)",
          "old_line_content": "                if (sri->info)",
          "new_line_content": "                    addReply(c,shared.nullbulk);",
          "content_same": false
        },
        {
          "line": 2847,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(sdi)",
          "old_line_content": "                else",
          "new_line_content": "            dictReleaseIterator(sdi);",
          "content_same": false
        },
        {
          "line": 2849,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "            }",
          "new_line_content": "        dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 2858,
          "old_api": null,
          "new_api": "addReplyErrorFormat",
          "old_text": null,
          "new_text": "addReplyErrorFormat(c,\"Wrong number of arguments for 'sentinel %s'\",\n                          (char*)c->argv[1]->ptr)",
          "old_line_content": "    return;",
          "new_line_content": "    addReplyErrorFormat(c,\"Wrong number of arguments for 'sentinel %s'\",",
          "content_same": false
        },
        {
          "line": 2865,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.syntaxerr)",
          "old_line_content": "/* SENTINEL INFO [section] */",
          "new_line_content": "        addReply(c,shared.syntaxerr);",
          "content_same": false
        },
        {
          "line": 2872,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"all\")",
          "old_line_content": "    int defsections = 0, allsections = 0;",
          "new_line_content": "        allsections = !strcasecmp(section,\"all\");",
          "content_same": false
        },
        {
          "line": 2873,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"default\")",
          "old_line_content": "    char *section = c->argc == 2 ? c->argv[1]->ptr : NULL;",
          "new_line_content": "        defsections = !strcasecmp(section,\"default\");",
          "content_same": false
        },
        {
          "line": 2879,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "    }",
          "new_line_content": "    sds info = sdsempty();",
          "content_same": false
        },
        {
          "line": 2880,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"server\")",
          "old_line_content": "",
          "new_line_content": "    if (defsections || allsections || !strcasecmp(section,\"server\")) {",
          "content_same": false
        },
        {
          "line": 2881,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "    int sections = 0;",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 2892,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "        dictEntry *de;",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 2893,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"# Sentinel\\r\\n\"\n            \"sentinel_masters:%lu\\r\\n\"\n            \"sentinel_tilt:%d\\r\\n\"\n            \"sentinel_running_scripts:%d\\r\\n\"\n            \"sentinel_scripts_queue_length:%ld\\r\\n\",\n            dictSize(sentinel.masters),\n            sentinel.tilt,\n            sentinel.running_scripts,\n            listLength(sentinel.scripts_queue))",
          "old_line_content": "        int master_id = 0;",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 2899,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(sentinel.masters)",
          "old_line_content": "            \"sentinel_tilt:%d\\r\\n\"",
          "new_line_content": "            dictSize(sentinel.masters),",
          "content_same": false
        },
        {
          "line": 2904,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(sentinel.masters)",
          "old_line_content": "            sentinel.running_scripts,",
          "new_line_content": "        di = dictGetIterator(sentinel.masters);",
          "content_same": false
        },
        {
          "line": 2906,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "",
          "new_line_content": "            sentinelRedisInstance *ri = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 2911,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                \"master%d:name=%s,status=%s,address=%s:%d,\"\n                \"slaves=%lu,sentinels=%lu\\r\\n\",\n                master_id++, ri->name, status,\n                ri->addr->ip, ri->addr->port,\n                dictSize(ri->slaves),\n                dictSize(ri->sentinels)+1)",
          "old_line_content": "",
          "new_line_content": "            info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 2916,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(ri->slaves)",
          "old_line_content": "                \"slaves=%lu,sentinels=%lu\\r\\n\",",
          "new_line_content": "                dictSize(ri->slaves),",
          "content_same": false
        },
        {
          "line": 2917,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(ri->sentinels)",
          "old_line_content": "                master_id++, ri->name, status,",
          "new_line_content": "                dictSize(ri->sentinels)+1);",
          "content_same": false
        },
        {
          "line": 2931,
          "old_api": null,
          "new_api": "addReplyMultiBulkLen",
          "old_text": null,
          "new_text": "addReplyMultiBulkLen(c,2)",
          "old_line_content": "    dictIterator *di;",
          "new_line_content": "    addReplyMultiBulkLen(c,2);",
          "content_same": false
        },
        {
          "line": 2932,
          "old_api": null,
          "new_api": "addReplyBulkCBuffer",
          "old_text": null,
          "new_text": "addReplyBulkCBuffer(c,\"sentinel\",8)",
          "old_line_content": "    dictEntry *de;",
          "new_line_content": "    addReplyBulkCBuffer(c,\"sentinel\",8);",
          "content_same": false
        },
        {
          "line": 2933,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(sentinel.masters)",
          "old_line_content": "",
          "new_line_content": "    addReplyMultiBulkLen(c,dictSize(sentinel.masters));",
          "content_same": false
        },
        {
          "line": 2937,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "",
          "new_line_content": "        sentinelRedisInstance *ri = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 2941,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "",
          "new_line_content": "    dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 2950,
          "old_api": null,
          "new_api": "sentinelGetMasterByNameOrReplyError",
          "old_text": null,
          "new_text": "sentinelGetMasterByNameOrReplyError(c,c->argv[2])",
          "old_line_content": "    int j, changes = 0;",
          "new_line_content": "    if ((ri = sentinelGetMasterByNameOrReplyError(c,c->argv[2]))",
          "content_same": false
        },
        {
          "line": 2960,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(option,\"down-after-milliseconds\")",
          "old_line_content": "        robj *o = c->argv[j+1];",
          "new_line_content": "        if (!strcasecmp(option,\"down-after-milliseconds\")) {",
          "content_same": false
        },
        {
          "line": 2962,
          "old_api": null,
          "new_api": "getLongLongFromObject",
          "old_text": null,
          "new_text": "getLongLongFromObject(o,&ll)",
          "old_line_content": "",
          "new_line_content": "            if (getLongLongFromObject(o,&ll) == REDIS_ERR || ll <= 0)",
          "content_same": false
        },
        {
          "line": 2967,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(option,\"failover-timeout\")",
          "old_line_content": "            ri->down_after_period = ll;",
          "new_line_content": "        } else if (!strcasecmp(option,\"failover-timeout\")) {",
          "content_same": false
        },
        {
          "line": 2969,
          "old_api": null,
          "new_api": "getLongLongFromObject",
          "old_text": null,
          "new_text": "getLongLongFromObject(o,&ll)",
          "old_line_content": "            changes++;",
          "new_line_content": "            if (getLongLongFromObject(o,&ll) == REDIS_ERR || ll <= 0)",
          "content_same": false
        },
        {
          "line": 2973,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(option,\"parallel-syncs\")",
          "old_line_content": "                goto badfmt;",
          "new_line_content": "       } else if (!strcasecmp(option,\"parallel-syncs\")) {",
          "content_same": false
        },
        {
          "line": 2975,
          "old_api": null,
          "new_api": "getLongLongFromObject",
          "old_text": null,
          "new_text": "getLongLongFromObject(o,&ll)",
          "old_line_content": "            changes++;",
          "new_line_content": "            if (getLongLongFromObject(o,&ll) == REDIS_ERR || ll <= 0)",
          "content_same": false
        },
        {
          "line": 2979,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(option,\"notification-script\")",
          "old_line_content": "                goto badfmt;",
          "new_line_content": "       } else if (!strcasecmp(option,\"notification-script\")) {",
          "content_same": false
        },
        {
          "line": 2981,
          "old_api": null,
          "new_api": "access",
          "old_text": null,
          "new_text": "access(value,X_OK)",
          "old_line_content": "            changes++;",
          "new_line_content": "            if (strlen(value) && access(value,X_OK) == -1) {",
          "content_same": false
        },
        {
          "line": 2988,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(value)",
          "old_line_content": "                return;",
          "new_line_content": "            ri->notification_script = strlen(value) ? sdsnew(value) : NULL;",
          "content_same": false
        },
        {
          "line": 2992,
          "old_api": null,
          "new_api": "access",
          "old_text": null,
          "new_text": "access(value,X_OK)",
          "old_line_content": "            changes++;",
          "new_line_content": "            if (strlen(value) && access(value,X_OK) == -1) {",
          "content_same": false
        },
        {
          "line": 3000,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(value)",
          "old_line_content": "                return;",
          "new_line_content": "            ri->client_reconfig_script = strlen(value) ? sdsnew(value) : NULL;",
          "content_same": false
        },
        {
          "line": 3004,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(ri->auth_pass)",
          "old_line_content": "            changes++;",
          "new_line_content": "            sdsfree(ri->auth_pass);",
          "content_same": false
        },
        {
          "line": 3009,
          "old_api": null,
          "new_api": "getLongLongFromObject",
          "old_text": null,
          "new_text": "getLongLongFromObject(o,&ll)",
          "old_line_content": "            changes++;",
          "new_line_content": "            if (getLongLongFromObject(o,&ll) == REDIS_ERR || ll <= 0)",
          "content_same": false
        },
        {
          "line": 3014,
          "old_api": null,
          "new_api": "addReplyErrorFormat",
          "old_text": null,
          "new_text": "addReplyErrorFormat(c,\"Unknown option '%s' for SENTINEL SET\",\n                option)",
          "old_line_content": "            ri->quorum = ll;",
          "new_line_content": "            addReplyErrorFormat(c,\"Unknown option '%s' for SENTINEL SET\",",
          "content_same": false
        },
        {
          "line": 3016,
          "old_api": null,
          "new_api": "sentinelFlushConfig",
          "old_text": null,
          "new_text": "sentinelFlushConfig()",
          "old_line_content": "        } else {",
          "new_line_content": "            if (changes) sentinelFlushConfig();",
          "content_same": false
        },
        {
          "line": 3023,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "    }",
          "new_line_content": "    addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 3027,
          "old_api": null,
          "new_api": "sentinelFlushConfig",
          "old_text": null,
          "new_text": "sentinelFlushConfig()",
          "old_line_content": "    return;",
          "new_line_content": "    if (changes) sentinelFlushConfig();",
          "content_same": false
        },
        {
          "line": 3028,
          "old_api": null,
          "new_api": "addReplyErrorFormat",
          "old_text": null,
          "new_text": "addReplyErrorFormat(c,\"Invalid argument '%s' for SENTINEL SET '%s'\",\n            value, option)",
          "old_line_content": "",
          "new_line_content": "    addReplyErrorFormat(c,\"Invalid argument '%s' for SENTINEL SET '%s'\",",
          "content_same": false
        },
        {
          "line": 3039,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(c->argv[1]->ptr,SENTINEL_HELLO_CHANNEL)",
          "old_line_content": " * Because we have a Sentinel PUBLISH, the code to send hello messages is the same",
          "new_line_content": "    if (strcmp(c->argv[1]->ptr,SENTINEL_HELLO_CHANNEL)) {",
          "content_same": false
        },
        {
          "line": 3040,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c, \"Only HELLO messages are accepted by Sentinel instances.\")",
          "old_line_content": " * for all the three kind of instances: masters, slaves, sentinels. */",
          "new_line_content": "        addReplyError(c, \"Only HELLO messages are accepted by Sentinel instances.\");",
          "content_same": false
        },
        {
          "line": 3044,
          "old_api": null,
          "new_api": "addReplyLongLong",
          "old_text": null,
          "new_text": "addReplyLongLong(c,1)",
          "old_line_content": "        return;",
          "new_line_content": "    addReplyLongLong(c,1);",
          "content_same": false
        },
        {
          "line": 3054,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    mstime_t elapsed = 0;",
          "new_line_content": "        elapsed = mstime() - ri->last_ping_time;",
          "content_same": false
        },
        {
          "line": 3063,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "     *    than SENTINEL_MIN_LINK_RECONNECT_PERIOD, but still we have a",
          "new_line_content": "        (mstime() - ri->cc_conn_time) > SENTINEL_MIN_LINK_RECONNECT_PERIOD &&",
          "content_same": false
        },
        {
          "line": 3067,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        ri->last_ping_time != 0 && /* Ther is a pending ping... */",
          "new_line_content": "        (mstime() - ri->last_ping_time) > (ri->down_after_period/2) &&",
          "content_same": false
        },
        {
          "line": 3068,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        /* The pending ping is delayed, and we did not received",
          "new_line_content": "        (mstime() - ri->last_pong_time) > (ri->down_after_period/2))",
          "content_same": false
        },
        {
          "line": 3079,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "     *    SENTINEL_PUBLISH_PERIOD * 3.",
          "new_line_content": "        (mstime() - ri->pc_conn_time) > SENTINEL_MIN_LINK_RECONNECT_PERIOD &&",
          "content_same": false
        },
        {
          "line": 3080,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "     */",
          "new_line_content": "        (mstime() - ri->pc_last_activity) > (SENTINEL_PUBLISH_PERIOD*3))",
          "content_same": false
        },
        {
          "line": 3094,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    if (elapsed > ri->down_after_period ||",
          "new_line_content": "         mstime() - ri->role_reported_time >",
          "content_same": false
        },
        {
          "line": 3099,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+sdown\",ri,\"%@\")",
          "old_line_content": "    {",
          "new_line_content": "            sentinelEvent(REDIS_WARNING,\"+sdown\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 3100,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        /* Is subjectively down */",
          "new_line_content": "            ri->s_down_since_time = mstime();",
          "content_same": false
        },
        {
          "line": 3106,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"-sdown\",ri,\"%@\")",
          "old_line_content": "    } else {",
          "new_line_content": "            sentinelEvent(REDIS_WARNING,\"-sdown\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 3127,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(master->sentinels)",
          "old_line_content": "        /* Is down for enough sentinels? */",
          "new_line_content": "        di = dictGetIterator(master->sentinels);",
          "content_same": false
        },
        {
          "line": 3128,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "        quorum = 1; /* the current sentinel. */",
          "new_line_content": "        while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 3129,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "        /* Count all the other sentinels. */",
          "new_line_content": "            sentinelRedisInstance *ri = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 3133,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "",
          "new_line_content": "        dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 3140,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+odown\",master,\"%@ #quorum %d/%d\",\n                quorum, master->quorum)",
          "old_line_content": "    /* Set the flag accordingly to the outcome. */",
          "new_line_content": "            sentinelEvent(REDIS_WARNING,\"+odown\",master,\"%@ #quorum %d/%d\",",
          "content_same": false
        },
        {
          "line": 3147,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"-odown\",master,\"%@\")",
          "old_line_content": "        }",
          "new_line_content": "            sentinelEvent(REDIS_WARNING,\"-odown\",master,\"%@\");",
          "content_same": false
        },
        {
          "line": 3158,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(privdata)",
          "old_line_content": "void sentinelReceiveIsMasterDownReply(redisAsyncContext *c, void *reply, void *privdata) {",
          "new_line_content": "    REDIS_NOTUSED(privdata);",
          "content_same": false
        },
        {
          "line": 3172,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        r->element[1]->type == REDIS_REPLY_STRING &&",
          "new_line_content": "        ri->last_master_down_reply_time = mstime();",
          "content_same": false
        },
        {
          "line": 3178,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(r->element[1]->str,\"*\")",
          "old_line_content": "        } else {",
          "new_line_content": "        if (strcmp(r->element[1]->str,\"*\")) {",
          "content_same": false
        },
        {
          "line": 3183,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\n                    \"%s voted for %s %llu\", ri->name,\n                    r->element[1]->str,\n                    (unsigned long long) r->element[2]->integer)",
          "old_line_content": "             * replied with a vote. */",
          "new_line_content": "                redisLog(REDIS_WARNING,",
          "content_same": false
        },
        {
          "line": 3187,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(r->element[1]->str)",
          "old_line_content": "                    \"%s voted for %s %llu\", ri->name,",
          "new_line_content": "            ri->leader = sdsnew(r->element[1]->str);",
          "content_same": false
        },
        {
          "line": 3202,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(master->sentinels)",
          "old_line_content": "    dictIterator *di;",
          "new_line_content": "    di = dictGetIterator(master->sentinels);",
          "content_same": false
        },
        {
          "line": 3203,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "    dictEntry *de;",
          "new_line_content": "    while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 3204,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "",
          "new_line_content": "        sentinelRedisInstance *ri = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 3212,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(ri->leader)",
          "old_line_content": "        /* If the master state from other sentinel is too old, we clear it. */",
          "new_line_content": "            sdsfree(ri->leader);",
          "content_same": false
        },
        {
          "line": 3224,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        if ((master->flags & SRI_S_DOWN) == 0) continue;",
          "new_line_content": "            mstime() - ri->last_master_down_reply_time < SENTINEL_ASK_PERIOD)",
          "content_same": false
        },
        {
          "line": 3228,
          "old_api": null,
          "new_api": "ll2string",
          "old_text": null,
          "new_text": "ll2string(port,sizeof(port),master->addr->port)",
          "old_line_content": "            continue;",
          "new_line_content": "        ll2string(port,sizeof(port),master->addr->port);",
          "content_same": false
        },
        {
          "line": 3229,
          "old_api": null,
          "new_api": "redisAsyncCommand",
          "old_text": null,
          "new_text": "redisAsyncCommand(ri->cc,\n                    sentinelReceiveIsMasterDownReply, NULL,\n                    \"SENTINEL is-master-down-by-addr %s %s %llu %s\",\n                    master->addr->ip, port,\n                    sentinel.current_epoch,\n                    (master->failover_state > SENTINEL_FAILOVER_STATE_NONE) ?\n                    server.runid : \"*\")",
          "old_line_content": "",
          "new_line_content": "        retval = redisAsyncCommand(ri->cc,",
          "content_same": false
        },
        {
          "line": 3238,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "                    server.runid : \"*\");",
          "new_line_content": "    dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 3251,
          "old_api": null,
          "new_api": "sentinelFlushConfig",
          "old_text": null,
          "new_text": "sentinelFlushConfig()",
          "old_line_content": "char *sentinelVoteLeader(sentinelRedisInstance *master, uint64_t req_epoch, char *req_runid, uint64_t *leader_epoch) {",
          "new_line_content": "        sentinelFlushConfig();",
          "content_same": false
        },
        {
          "line": 3252,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+new-epoch\",master,\"%llu\",\n            (unsigned long long) sentinel.current_epoch)",
          "old_line_content": "    if (req_epoch > sentinel.current_epoch) {",
          "new_line_content": "        sentinelEvent(REDIS_WARNING,\"+new-epoch\",master,\"%llu\",",
          "content_same": false
        },
        {
          "line": 3258,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(master->leader)",
          "old_line_content": "",
          "new_line_content": "        sdsfree(master->leader);",
          "content_same": false
        },
        {
          "line": 3259,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(req_runid)",
          "old_line_content": "    if (master->leader_epoch < req_epoch && sentinel.current_epoch <= req_epoch)",
          "new_line_content": "        master->leader = sdsnew(req_runid);",
          "content_same": false
        },
        {
          "line": 3267,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(master->leader,server.runid)",
          "old_line_content": "        /* If we did not voted for ourselves, set the master failover start",
          "new_line_content": "        if (strcasecmp(master->leader,server.runid))",
          "content_same": false
        },
        {
          "line": 3268,
          "old_api": null,
          "new_api": "rand",
          "old_text": null,
          "new_text": "rand()",
          "old_line_content": "         * time to now, in order to force a delay before we can start a",
          "new_line_content": "            master->failover_start_time = mstime()+rand()%SENTINEL_MAX_DESYNC;",
          "content_same": false
        },
        {
          "line": 3272,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(master->leader)",
          "old_line_content": "    }",
          "new_line_content": "    return master->leader ? sdsnew(master->leader) : NULL;",
          "content_same": false
        },
        {
          "line": 3283,
          "old_api": null,
          "new_api": "dictFind",
          "old_text": null,
          "new_text": "dictFind(counters,runid)",
          "old_line_content": "/* Helper function for sentinelGetLeader, increment the counter",
          "new_line_content": "    dictEntry *de = dictFind(counters,runid);",
          "content_same": false
        },
        {
          "line": 3287,
          "old_api": null,
          "new_api": "dictGetUnsignedIntegerVal",
          "old_text": null,
          "new_text": "dictGetUnsignedIntegerVal(de)",
          "old_line_content": "    uint64_t oldval;",
          "new_line_content": "        oldval = dictGetUnsignedIntegerVal(de);",
          "content_same": false
        },
        {
          "line": 3288,
          "old_api": null,
          "new_api": "dictSetUnsignedIntegerVal",
          "old_text": null,
          "new_text": "dictSetUnsignedIntegerVal(de,oldval+1)",
          "old_line_content": "",
          "new_line_content": "        dictSetUnsignedIntegerVal(de,oldval+1);",
          "content_same": false
        },
        {
          "line": 3292,
          "old_api": null,
          "new_api": "redisAssert",
          "old_text": null,
          "new_text": "redisAssert(de != NULL)",
          "old_line_content": "        return oldval+1;",
          "new_line_content": "        redisAssert(de != NULL);",
          "content_same": false
        },
        {
          "line": 3293,
          "old_api": null,
          "new_api": "dictSetUnsignedIntegerVal",
          "old_text": null,
          "new_text": "dictSetUnsignedIntegerVal(de,1)",
          "old_line_content": "    } else {",
          "new_line_content": "        dictSetUnsignedIntegerVal(de,1);",
          "content_same": false
        },
        {
          "line": 3314,
          "old_api": null,
          "new_api": "redisAssert",
          "old_text": null,
          "new_text": "redisAssert(master->flags & (SRI_O_DOWN|SRI_FAILOVER_IN_PROGRESS))",
          "old_line_content": "    uint64_t leader_epoch;",
          "new_line_content": "    redisAssert(master->flags & (SRI_O_DOWN|SRI_FAILOVER_IN_PROGRESS));",
          "content_same": false
        },
        {
          "line": 3315,
          "old_api": null,
          "new_api": "dictCreate",
          "old_text": null,
          "new_text": "dictCreate(&leaderVotesDictType,NULL)",
          "old_line_content": "    uint64_t max_votes = 0;",
          "new_line_content": "    counters = dictCreate(&leaderVotesDictType,NULL);",
          "content_same": false
        },
        {
          "line": 3321,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "",
          "new_line_content": "    while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 1274,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_NOTICE,\"+slave\",slave,\"%@\")",
          "old_line_content": "        if (slave) {",
          "new_line_content": "        if (slave) sentinelEvent(REDIS_NOTICE,\"+slave\",slave,\"%@\");",
          "content_same": false
        },
        {
          "line": 3322,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "    /* Count other sentinels votes */",
          "new_line_content": "        sentinelRedisInstance *ri = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 3326,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "        if (ri->leader != NULL && ri->leader_epoch == sentinel.current_epoch)",
          "new_line_content": "    dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 1280,
          "old_api": null,
          "new_api": "releaseSentinelAddr",
          "old_text": null,
          "new_text": "releaseSentinelAddr(oldaddr)",
          "old_line_content": "",
          "new_line_content": "    releaseSentinelAddr(oldaddr);",
          "content_same": false
        },
        {
          "line": 1281,
          "old_api": null,
          "new_api": "sentinelFlushConfig",
          "old_text": null,
          "new_text": "sentinelFlushConfig()",
          "old_line_content": "    /* Release the old address at the end so we are safe even if the function",
          "new_line_content": "    sentinelFlushConfig();",
          "content_same": false
        },
        {
          "line": 3331,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(counters)",
          "old_line_content": "    /* Check what's the winner. For the winner to win, it needs two conditions:",
          "new_line_content": "    di = dictGetIterator(counters);",
          "content_same": false
        },
        {
          "line": 3332,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "     * 1) Absolute majority between voters (50% + 1).",
          "new_line_content": "    while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 3333,
          "old_api": null,
          "new_api": "dictGetUnsignedIntegerVal",
          "old_text": null,
          "new_text": "dictGetUnsignedIntegerVal(de)",
          "old_line_content": "     * 2) And anyway at least master->quorum votes. */",
          "new_line_content": "        uint64_t votes = dictGetUnsignedIntegerVal(de);",
          "content_same": false
        },
        {
          "line": 3337,
          "old_api": null,
          "new_api": "dictGetKey",
          "old_text": null,
          "new_text": "dictGetKey(de)",
          "old_line_content": "",
          "new_line_content": "            winner = dictGetKey(de);",
          "content_same": false
        },
        {
          "line": 1293,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    most_recent = ri->s_down_since_time;",
          "new_line_content": "    return most_recent == 0 || (mstime() - most_recent) > ms;",
          "content_same": false
        },
        {
          "line": 3346,
          "old_api": null,
          "new_api": "sentinelVoteLeader",
          "old_text": null,
          "new_text": "sentinelVoteLeader(master,epoch,winner,&leader_epoch)",
          "old_line_content": "     * if this Sentinel did not voted yet, either vote for the most",
          "new_line_content": "        myvote = sentinelVoteLeader(master,epoch,winner,&leader_epoch);",
          "content_same": false
        },
        {
          "line": 3348,
          "old_api": null,
          "new_api": "sentinelVoteLeader",
          "old_text": null,
          "new_text": "sentinelVoteLeader(master,epoch,server.runid,&leader_epoch)",
          "old_line_content": "    if (winner)",
          "new_line_content": "        myvote = sentinelVoteLeader(master,epoch,server.runid,&leader_epoch);",
          "content_same": false
        },
        {
          "line": 3363,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(winner)",
          "old_line_content": "    if (winner && (max_votes < voters_quorum || max_votes < master->quorum))",
          "new_line_content": "    winner = winner ? sdsnew(winner) : NULL;",
          "content_same": false
        },
        {
          "line": 3364,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(myvote)",
          "old_line_content": "        winner = NULL;",
          "new_line_content": "    sdsfree(myvote);",
          "content_same": false
        },
        {
          "line": 3365,
          "old_api": null,
          "new_api": "dictRelease",
          "old_text": null,
          "new_text": "dictRelease(counters)",
          "old_line_content": "",
          "new_line_content": "    dictRelease(counters);",
          "content_same": false
        },
        {
          "line": 1323,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(d[j])",
          "old_line_content": "    dict *d[] = {master->slaves, master->sentinels, NULL};",
          "new_line_content": "        di = dictGetIterator(d[j]);",
          "content_same": false
        },
        {
          "line": 1324,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "",
          "new_line_content": "        while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 1325,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "    for (j = 0; d[j]; j++) {",
          "new_line_content": "            sentinelRedisInstance *ri = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 3383,
          "old_api": null,
          "new_api": "ll2string",
          "old_text": null,
          "new_text": "ll2string(portstr,sizeof(portstr),port)",
          "old_line_content": "    char portstr[32];",
          "new_line_content": "    ll2string(portstr,sizeof(portstr),port);",
          "content_same": false
        },
        {
          "line": 1336,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(argv[0],\"monitor\")",
          "old_line_content": "char *sentinelHandleConfiguration(char **argv, int argc) {",
          "new_line_content": "    if (!strcasecmp(argv[0],\"monitor\") && argc == 5) {",
          "content_same": false
        },
        {
          "line": 1338,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(argv[4])",
          "old_line_content": "",
          "new_line_content": "        int quorum = atoi(argv[4]);",
          "content_same": false
        },
        {
          "line": 3389,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(portstr,\"ONE\",4)",
          "old_line_content": "     * into a master. */",
          "new_line_content": "        memcpy(portstr,\"ONE\",4);",
          "content_same": false
        },
        {
          "line": 1342,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(argv[3])",
          "old_line_content": "",
          "new_line_content": "                                        atoi(argv[3]),quorum,NULL) == NULL)",
          "content_same": false
        },
        {
          "line": 1350,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(argv[0],\"down-after-milliseconds\")",
          "old_line_content": "            case EINVAL: return \"Invalid port number\";",
          "new_line_content": "    } else if (!strcasecmp(argv[0],\"down-after-milliseconds\") && argc == 3) {",
          "content_same": false
        },
        {
          "line": 1352,
          "old_api": null,
          "new_api": "sentinelGetMasterByName",
          "old_text": null,
          "new_text": "sentinelGetMasterByName(argv[1])",
          "old_line_content": "        }",
          "new_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "content_same": false
        },
        {
          "line": 1354,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(argv[2])",
          "old_line_content": "        /* down-after-milliseconds <name> <milliseconds> */",
          "new_line_content": "        ri->down_after_period = atoi(argv[2]);",
          "content_same": false
        },
        {
          "line": 3402,
          "old_api": null,
          "new_api": "redisAsyncCommand",
          "old_text": null,
          "new_text": "redisAsyncCommand(ri->cc,\n        sentinelDiscardReplyCallback, NULL, \"MULTI\")",
          "old_line_content": "     *",
          "new_line_content": "    retval = redisAsyncCommand(ri->cc,",
          "content_same": false
        },
        {
          "line": 1358,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(argv[0],\"failover-timeout\")",
          "old_line_content": "        if (ri->down_after_period <= 0)",
          "new_line_content": "    } else if (!strcasecmp(argv[0],\"failover-timeout\") && argc == 3) {",
          "content_same": false
        },
        {
          "line": 3407,
          "old_api": null,
          "new_api": "redisAsyncCommand",
          "old_text": null,
          "new_text": "redisAsyncCommand(ri->cc,\n        sentinelDiscardReplyCallback, NULL, \"SLAVEOF %s %s\", host, portstr)",
          "old_line_content": "    if (retval == REDIS_ERR) return retval;",
          "new_line_content": "    retval = redisAsyncCommand(ri->cc,",
          "content_same": false
        },
        {
          "line": 1362,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(argv[2])",
          "old_line_content": "        /* failover-timeout <name> <milliseconds> */",
          "new_line_content": "        ri->failover_timeout = atoi(argv[2]);",
          "content_same": false
        },
        {
          "line": 3412,
          "old_api": null,
          "new_api": "redisAsyncCommand",
          "old_text": null,
          "new_text": "redisAsyncCommand(ri->cc,\n        sentinelDiscardReplyCallback, NULL, \"CONFIG REWRITE\")",
          "old_line_content": "    if (retval == REDIS_ERR) return retval;",
          "new_line_content": "    retval = redisAsyncCommand(ri->cc,",
          "content_same": false
        },
        {
          "line": 1367,
          "old_api": null,
          "new_api": "sentinelGetMasterByName",
          "old_text": null,
          "new_text": "sentinelGetMasterByName(argv[1])",
          "old_line_content": "            return \"negative or zero time parameter.\";",
          "new_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "content_same": false
        },
        {
          "line": 1369,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(argv[2])",
          "old_line_content": "        /* parallel-syncs <name> <milliseconds> */",
          "new_line_content": "        ri->parallel_syncs = atoi(argv[2]);",
          "content_same": false
        },
        {
          "line": 1374,
          "old_api": null,
          "new_api": "access",
          "old_text": null,
          "new_text": "access(argv[2],X_OK)",
          "old_line_content": "        /* notification-script <name> <path> */",
          "new_line_content": "        if (access(argv[2],X_OK) == -1)",
          "content_same": false
        },
        {
          "line": 3422,
          "old_api": null,
          "new_api": "redisAsyncCommand",
          "old_text": null,
          "new_text": "redisAsyncCommand(ri->cc,\n        sentinelDiscardReplyCallback, NULL, \"CLIENT KILL TYPE normal\")",
          "old_line_content": "     * an issue because CLIENT is variadic command, so Redis will not",
          "new_line_content": "    retval = redisAsyncCommand(ri->cc,",
          "content_same": false
        },
        {
          "line": 1376,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(argv[2])",
          "old_line_content": "        if (!ri) return \"No such master with specified name.\";",
          "new_line_content": "        ri->notification_script = sdsnew(argv[2]);",
          "content_same": false
        },
        {
          "line": 3427,
          "old_api": null,
          "new_api": "redisAsyncCommand",
          "old_text": null,
          "new_text": "redisAsyncCommand(ri->cc,\n        sentinelDiscardReplyCallback, NULL, \"EXEC\")",
          "old_line_content": "    if (retval == REDIS_ERR) return retval;",
          "new_line_content": "    retval = redisAsyncCommand(ri->cc,",
          "content_same": false
        },
        {
          "line": 1381,
          "old_api": null,
          "new_api": "access",
          "old_text": null,
          "new_text": "access(argv[2],X_OK)",
          "old_line_content": "        /* client-reconfig-script <name> <path> */",
          "new_line_content": "        if (access(argv[2],X_OK) == -1)",
          "content_same": false
        },
        {
          "line": 1385,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(argv[0],\"auth-pass\")",
          "old_line_content": "            return \"Client reconfiguration script seems non existing or \"",
          "new_line_content": "   } else if (!strcasecmp(argv[0],\"auth-pass\") && argc == 3) {",
          "content_same": false
        },
        {
          "line": 1389,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(argv[2])",
          "old_line_content": "        /* auth-pass <name> <password> */",
          "new_line_content": "        ri->auth_pass = sdsnew(argv[2]);",
          "content_same": false
        },
        {
          "line": 3437,
          "old_api": null,
          "new_api": "redisAssert",
          "old_text": null,
          "new_text": "redisAssert(master->flags & SRI_MASTER)",
          "old_line_content": "",
          "new_line_content": "    redisAssert(master->flags & SRI_MASTER);",
          "content_same": false
        },
        {
          "line": 3442,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+new-epoch\",master,\"%llu\",\n        (unsigned long long) sentinel.current_epoch)",
          "old_line_content": "    master->failover_state = SENTINEL_FAILOVER_STATE_WAIT_START;",
          "new_line_content": "    sentinelEvent(REDIS_WARNING,\"+new-epoch\",master,\"%llu\",",
          "content_same": false
        },
        {
          "line": 3444,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+try-failover\",master,\"%@\")",
          "old_line_content": "    master->failover_epoch = ++sentinel.current_epoch;",
          "new_line_content": "    sentinelEvent(REDIS_WARNING,\"+try-failover\",master,\"%@\");",
          "content_same": false
        },
        {
          "line": 1397,
          "old_api": null,
          "new_api": "sentinelGetMasterByName",
          "old_text": null,
          "new_text": "sentinelGetMasterByName(argv[1])",
          "old_line_content": "            sentinel.current_epoch = current_epoch;",
          "new_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "content_same": false
        },
        {
          "line": 3446,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        (unsigned long long) sentinel.current_epoch);",
          "new_line_content": "    master->failover_state_change_time = mstime();",
          "content_same": false
        },
        {
          "line": 1399,
          "old_api": null,
          "new_api": "strtoull",
          "old_text": null,
          "new_text": "strtoull(argv[2],NULL,10)",
          "old_line_content": "        /* config-epoch <name> <epoch> */",
          "new_line_content": "        ri->config_epoch = strtoull(argv[2],NULL,10);",
          "content_same": false
        },
        {
          "line": 1405,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(argv[0],\"leader-epoch\")",
          "old_line_content": "         * we leave this check here for redundancy. */",
          "new_line_content": "    } else if (!strcasecmp(argv[0],\"leader-epoch\") && argc == 3) {",
          "content_same": false
        },
        {
          "line": 1407,
          "old_api": null,
          "new_api": "sentinelGetMasterByName",
          "old_text": null,
          "new_text": "sentinelGetMasterByName(argv[1])",
          "old_line_content": "            sentinel.current_epoch = ri->config_epoch;",
          "new_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "content_same": false
        },
        {
          "line": 1409,
          "old_api": null,
          "new_api": "strtoull",
          "old_text": null,
          "new_text": "strtoull(argv[2],NULL,10)",
          "old_line_content": "        /* leader-epoch <name> <epoch> */",
          "new_line_content": "        ri->leader_epoch = strtoull(argv[2],NULL,10);",
          "content_same": false
        },
        {
          "line": 1414,
          "old_api": null,
          "new_api": "sentinelGetMasterByName",
          "old_text": null,
          "new_text": "sentinelGetMasterByName(argv[1])",
          "old_line_content": "        sentinelRedisInstance *slave;",
          "new_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "content_same": false
        },
        {
          "line": 1416,
          "old_api": null,
          "new_api": "createSentinelRedisInstance",
          "old_text": null,
          "new_text": "createSentinelRedisInstance(NULL,SRI_SLAVE,argv[2],\n                    atoi(argv[3]), ri->quorum, ri)",
          "old_line_content": "        /* known-slave <name> <ip> <port> */",
          "new_line_content": "        if ((slave = createSentinelRedisInstance(NULL,SRI_SLAVE,argv[2],",
          "content_same": false
        },
        {
          "line": 3468,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    if (master->flags & SRI_FAILOVER_IN_PROGRESS) return 0;",
          "new_line_content": "    if (mstime() - master->failover_start_time <",
          "content_same": false
        },
        {
          "line": 1421,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(argv[0],\"known-sentinel\")",
          "old_line_content": "        {",
          "new_line_content": "    } else if (!strcasecmp(argv[0],\"known-sentinel\") &&",
          "content_same": false
        },
        {
          "line": 1426,
          "old_api": null,
          "new_api": "sentinelGetMasterByName",
          "old_text": null,
          "new_text": "sentinelGetMasterByName(argv[1])",
          "old_line_content": "        sentinelRedisInstance *si;",
          "new_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "content_same": false
        },
        {
          "line": 1428,
          "old_api": null,
          "new_api": "createSentinelRedisInstance",
          "old_text": null,
          "new_text": "createSentinelRedisInstance(NULL,SRI_SENTINEL,argv[2],\n                    atoi(argv[3]), ri->quorum, ri)",
          "old_line_content": "        /* known-sentinel <name> <ip> <port> [runid] */",
          "new_line_content": "        if ((si = createSentinelRedisInstance(NULL,SRI_SENTINEL,argv[2],",
          "content_same": false
        },
        {
          "line": 3476,
          "old_api": null,
          "new_api": "ctime_r",
          "old_text": null,
          "new_text": "ctime_r(&clock,ctimebuf)",
          "old_line_content": "                            master->failover_timeout*2) / 1000;",
          "new_line_content": "            ctime_r(&clock,ctimebuf);",
          "content_same": false
        },
        {
          "line": 1433,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(argv[4])",
          "old_line_content": "        {",
          "new_line_content": "        if (argc == 5) si->runid = sdsnew(argv[4]);",
          "content_same": false
        },
        {
          "line": 1434,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(argv[0],\"announce-ip\")",
          "old_line_content": "            return \"Wrong hostname or port for sentinel.\";",
          "new_line_content": "    } else if (!strcasecmp(argv[0],\"announce-ip\") && argc == 2) {",
          "content_same": false
        },
        {
          "line": 1438,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(argv[0],\"announce-port\")",
          "old_line_content": "        /* announce-ip <ip-address> */",
          "new_line_content": "    } else if (!strcasecmp(argv[0],\"announce-port\") && argc == 2) {",
          "content_same": false
        },
        {
          "line": 3486,
          "old_api": null,
          "new_api": "sentinelStartFailover",
          "old_text": null,
          "new_text": "sentinelStartFailover(master)",
          "old_line_content": "        return 0;",
          "new_line_content": "    sentinelStartFailover(master);",
          "content_same": false
        },
        {
          "line": 1458,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(sentinel.masters)",
          "old_line_content": "    sds line;",
          "new_line_content": "    di = dictGetIterator(sentinel.masters);",
          "content_same": false
        },
        {
          "line": 1459,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "",
          "new_line_content": "    while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 1464,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "        sentinelAddr *master_addr;",
          "new_line_content": "        master = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 1465,
          "old_api": null,
          "new_api": "sentinelGetCurrentMasterAddress",
          "old_text": null,
          "new_text": "sentinelGetCurrentMasterAddress(master)",
          "old_line_content": "",
          "new_line_content": "        master_addr = sentinelGetCurrentMasterAddress(master);",
          "content_same": false
        },
        {
          "line": 1466,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "        /* sentinel monitor */",
          "new_line_content": "        line = sdscatprintf(sdsempty(),\"sentinel monitor %s %s %d %d\",",
          "content_same": false
        },
        {
          "line": 1473,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "",
          "new_line_content": "            line = sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 1481,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "",
          "new_line_content": "            line = sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 1489,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "",
          "new_line_content": "            line = sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 1497,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "",
          "new_line_content": "            line = sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 3547,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(sa_runid, sb_runid)",
          "old_line_content": "    if (sa_runid == NULL && sb_runid == NULL) return 0;",
          "new_line_content": "    return strcasecmp(sa_runid, sb_runid);",
          "content_same": false
        },
        {
          "line": 3552,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(master->slaves)",
          "old_line_content": "",
          "new_line_content": "        zmalloc(sizeof(instance[0])*dictSize(master->slaves));",
          "content_same": false
        },
        {
          "line": 1505,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "",
          "new_line_content": "            line = sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 3560,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    mstime_t max_master_down_time = 0;",
          "new_line_content": "        max_master_down_time += mstime() - master->s_down_since_time;",
          "content_same": false
        },
        {
          "line": 1513,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "",
          "new_line_content": "            line = sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 3564,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "    max_master_down_time += master->down_after_period * 10;",
          "new_line_content": "    while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 3565,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "",
          "new_line_content": "        sentinelRedisInstance *slave = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 1520,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "        }",
          "new_line_content": "        line = sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 3569,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        mstime_t info_validity_time;",
          "new_line_content": "        if (mstime() - slave->last_avail_time > SENTINEL_PING_PERIOD*5) continue;",
          "content_same": false
        },
        {
          "line": 3579,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "            info_validity_time = SENTINEL_PING_PERIOD*5;",
          "new_line_content": "        if (mstime() - slave->info_refresh > info_validity_time) continue;",
          "content_same": false
        },
        {
          "line": 1533,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di2)",
          "old_line_content": "",
          "new_line_content": "        while((de = dictNext(di2)) != NULL) {",
          "content_same": false
        },
        {
          "line": 3583,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "        if (slave->master_link_down_time > max_master_down_time) continue;",
          "new_line_content": "    dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 3585,
          "old_api": null,
          "new_api": "qsort",
          "old_text": null,
          "new_text": "qsort(instance,instances,sizeof(sentinelRedisInstance*),\n            compareSlavesForPromotion)",
          "old_line_content": "    }",
          "new_line_content": "        qsort(instance,instances,sizeof(sentinelRedisInstance*),",
          "content_same": false
        },
        {
          "line": 3589,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(instance)",
          "old_line_content": "            compareSlavesForPromotion);",
          "new_line_content": "    zfree(instance);",
          "content_same": false
        },
        {
          "line": 1544,
          "old_api": null,
          "new_api": "sentinelAddrIsEqual",
          "old_text": null,
          "new_text": "sentinelAddrIsEqual(slave_addr,master_addr)",
          "old_line_content": "             * slave's address, a failover is in progress and the slave was",
          "new_line_content": "            if (sentinelAddrIsEqual(slave_addr,master_addr))",
          "content_same": false
        },
        {
          "line": 1546,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "             * we use the old master address instead. */",
          "new_line_content": "            line = sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 1551,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di2)",
          "old_line_content": "                master->name, ri->addr->ip, ri->addr->port);",
          "new_line_content": "        dictReleaseIterator(di2);",
          "content_same": false
        },
        {
          "line": 3599,
          "old_api": null,
          "new_api": "sentinelGetLeader",
          "old_text": null,
          "new_text": "sentinelGetLeader(ri, ri->failover_epoch)",
          "old_line_content": "    int isleader;",
          "new_line_content": "    leader = sentinelGetLeader(ri, ri->failover_epoch);",
          "content_same": false
        },
        {
          "line": 3600,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(leader,server.runid)",
          "old_line_content": "",
          "new_line_content": "    isleader = leader && strcasecmp(leader,server.runid) == 0;",
          "content_same": false
        },
        {
          "line": 3601,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(leader)",
          "old_line_content": "    /* Check if we are the leader for the failover epoch. */",
          "new_line_content": "    sdsfree(leader);",
          "content_same": false
        },
        {
          "line": 1555,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di2)",
          "old_line_content": "",
          "new_line_content": "        while((de = dictNext(di2)) != NULL) {",
          "content_same": false
        },
        {
          "line": 1556,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "        /* sentinel known-sentinel */",
          "new_line_content": "            ri = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 1562,
          "old_api": null,
          "new_api": "rewriteConfigRewriteLine",
          "old_text": null,
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "                master->name, ri->addr->ip, ri->addr->port,",
          "new_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 1564,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di2)",
          "old_line_content": "                ri->runid ? ri->runid : \"\");",
          "new_line_content": "        dictReleaseIterator(di2);",
          "content_same": false
        },
        {
          "line": 3613,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        if (election_timeout > ri->failover_timeout)",
          "new_line_content": "        if (mstime() - ri->failover_start_time > election_timeout) {",
          "content_same": false
        },
        {
          "line": 3614,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"-failover-abort-not-elected\",ri,\"%@\")",
          "old_line_content": "            election_timeout = ri->failover_timeout;",
          "new_line_content": "            sentinelEvent(REDIS_WARNING,\"-failover-abort-not-elected\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 3615,
          "old_api": null,
          "new_api": "sentinelAbortFailover",
          "old_text": null,
          "new_text": "sentinelAbortFailover(ri)",
          "old_line_content": "        /* Abort the failover if I'm not the leader after some time. */",
          "new_line_content": "            sentinelAbortFailover(ri);",
          "content_same": false
        },
        {
          "line": 1568,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "    }",
          "new_line_content": "    line = sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 1570,
          "old_api": null,
          "new_api": "rewriteConfigRewriteLine",
          "old_text": null,
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "    /* sentinel current-epoch is a global state valid for all the masters. */",
          "new_line_content": "    rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 3619,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+elected-leader\",ri,\"%@\")",
          "old_line_content": "        }",
          "new_line_content": "    sentinelEvent(REDIS_WARNING,\"+elected-leader\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 3621,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    }",
          "new_line_content": "    ri->failover_state_change_time = mstime();",
          "content_same": false
        },
        {
          "line": 1574,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(\"sentinel announce-ip \")",
          "old_line_content": "",
          "new_line_content": "        line = sdsnew(\"sentinel announce-ip \");",
          "content_same": false
        },
        {
          "line": 1575,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(sentinel.announce_ip)",
          "old_line_content": "    /* sentinel announce-ip. */",
          "new_line_content": "        line = sdscatrepr(line, sentinel.announce_ip, sdslen(sentinel.announce_ip));",
          "content_same": false
        },
        {
          "line": 1576,
          "old_api": null,
          "new_api": "rewriteConfigRewriteLine",
          "old_text": null,
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "    if (sentinel.announce_ip) {",
          "new_line_content": "        rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 3626,
          "old_api": null,
          "new_api": "sentinelSelectSlave",
          "old_text": null,
          "new_text": "sentinelSelectSlave(ri)",
          "old_line_content": "}",
          "new_line_content": "    sentinelRedisInstance *slave = sentinelSelectSlave(ri);",
          "content_same": false
        },
        {
          "line": 1581,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "",
          "new_line_content": "        line = sdscatprintf(sdsempty(),\"sentinel announce-port %d\",",
          "content_same": false
        },
        {
          "line": 1583,
          "old_api": null,
          "new_api": "rewriteConfigRewriteLine",
          "old_text": null,
          "new_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "old_line_content": "    if (sentinel.announce_port) {",
          "new_line_content": "        rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "content_same": false
        },
        {
          "line": 3631,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"-failover-abort-no-good-slave\",ri,\"%@\")",
          "old_line_content": "    /* We don't handle the timeout in this state as the function aborts",
          "new_line_content": "        sentinelEvent(REDIS_WARNING,\"-failover-abort-no-good-slave\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 3632,
          "old_api": null,
          "new_api": "sentinelAbortFailover",
          "old_text": null,
          "new_text": "sentinelAbortFailover(ri)",
          "old_line_content": "     * the failover or go forward in the next state. */",
          "new_line_content": "        sentinelAbortFailover(ri);",
          "content_same": false
        },
        {
          "line": 3638,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        slave->flags |= SRI_PROMOTED;",
          "new_line_content": "        ri->failover_state_change_time = mstime();",
          "content_same": false
        },
        {
          "line": 3639,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_NOTICE,\"+failover-state-send-slaveof-noone\",\n            slave, \"%@\")",
          "old_line_content": "        ri->promoted_slave = slave;",
          "new_line_content": "        sentinelEvent(REDIS_NOTICE,\"+failover-state-send-slaveof-noone\",",
          "content_same": false
        },
        {
          "line": 1602,
          "old_api": null,
          "new_api": "rewriteConfig",
          "old_text": null,
          "new_text": "rewriteConfig(server.configfile)",
          "old_line_content": "    int rewrite_status;",
          "new_line_content": "    rewrite_status = rewriteConfig(server.configfile);",
          "content_same": false
        },
        {
          "line": 3651,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "     * disconnected. Retry again and again with this state until the timeout",
          "new_line_content": "        if (mstime() - ri->failover_state_change_time > ri->failover_timeout) {",
          "content_same": false
        },
        {
          "line": 3652,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"-failover-abort-slave-timeout\",ri,\"%@\")",
          "old_line_content": "     * is reached, then abort the failover. */",
          "new_line_content": "            sentinelEvent(REDIS_WARNING,\"-failover-abort-slave-timeout\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 3653,
          "old_api": null,
          "new_api": "sentinelAbortFailover",
          "old_text": null,
          "new_text": "sentinelAbortFailover(ri)",
          "old_line_content": "    if (ri->promoted_slave->flags & SRI_DISCONNECTED) {",
          "new_line_content": "            sentinelAbortFailover(ri);",
          "content_same": false
        },
        {
          "line": 1606,
          "old_api": null,
          "new_api": "open",
          "old_text": null,
          "new_text": "open(server.configfile,O_RDONLY)",
          "old_line_content": "    server.hz = saved_hz;",
          "new_line_content": "    if ((fd = open(server.configfile,O_RDONLY)) == -1) goto werr;",
          "content_same": false
        },
        {
          "line": 1607,
          "old_api": null,
          "new_api": "fsync",
          "old_text": null,
          "new_text": "fsync(fd)",
          "old_line_content": "",
          "new_line_content": "    if (fsync(fd) == -1) goto werr;",
          "content_same": false
        },
        {
          "line": 1608,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "    if (rewrite_status == -1) goto werr;",
          "new_line_content": "    if (close(fd) == EOF) goto werr;",
          "content_same": false
        },
        {
          "line": 1612,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "    return;",
          "new_line_content": "    if (fd != -1) close(fd);",
          "content_same": false
        },
        {
          "line": 1613,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "",
          "new_line_content": "    redisLog(REDIS_WARNING,\"WARNING: Sentinel was not able to save the new configuration on disk!!!: %s\", strerror(errno));",
          "content_same": false
        },
        {
          "line": 3662,
          "old_api": null,
          "new_api": "sentinelSendSlaveOf",
          "old_text": null,
          "new_text": "sentinelSendSlaveOf(ri->promoted_slave,NULL,0)",
          "old_line_content": "     * We actually register a generic callback for this command as we don't",
          "new_line_content": "    retval = sentinelSendSlaveOf(ri->promoted_slave,NULL,0);",
          "content_same": false
        },
        {
          "line": 3664,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_NOTICE, \"+failover-state-wait-promotion\",\n        ri->promoted_slave,\"%@\")",
          "old_line_content": "     * if INFO returns a different role (master instead of slave). */",
          "new_line_content": "    sentinelEvent(REDIS_NOTICE, \"+failover-state-wait-promotion\",",
          "content_same": false
        },
        {
          "line": 1627,
          "old_api": null,
          "new_api": "redisAsyncFree",
          "old_text": null,
          "new_text": "redisAsyncFree(c)",
          "old_line_content": "    if (ri->pc == c) ri->pc = NULL;",
          "new_line_content": "    redisAsyncFree(c);",
          "content_same": false
        },
        {
          "line": 3675,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "void sentinelFailoverWaitPromotion(sentinelRedisInstance *ri) {",
          "new_line_content": "    if (mstime() - ri->failover_state_change_time > ri->failover_timeout) {",
          "content_same": false
        },
        {
          "line": 3676,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"-failover-abort-slave-timeout\",ri,\"%@\")",
          "old_line_content": "    /* Just handle the timeout. Switching to the next state is handled",
          "new_line_content": "        sentinelEvent(REDIS_WARNING,\"-failover-abort-slave-timeout\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 3677,
          "old_api": null,
          "new_api": "sentinelAbortFailover",
          "old_text": null,
          "new_text": "sentinelAbortFailover(ri)",
          "old_line_content": "     * by the function parsing the INFO command of the promoted slave. */",
          "new_line_content": "        sentinelAbortFailover(ri);",
          "content_same": false
        },
        {
          "line": 3685,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    int not_reconfigured = 0, timeout = 0;",
          "new_line_content": "    mstime_t elapsed = mstime() - master->failover_state_change_time;",
          "content_same": false
        },
        {
          "line": 1643,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_DEBUG, pubsub ? \"-pubsub-link\" : \"-cmd-link\", ri,\n        \"%@ #%s\", c->errstr)",
          "old_line_content": "    if (ri == NULL) return; /* The instance no longer exists. */",
          "new_line_content": "    sentinelEvent(REDIS_DEBUG, pubsub ? \"-pubsub-link\" : \"-cmd-link\", ri,",
          "content_same": false
        },
        {
          "line": 3694,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(master->slaves)",
          "old_line_content": "",
          "new_line_content": "    di = dictGetIterator(master->slaves);",
          "content_same": false
        },
        {
          "line": 3695,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "    /* The failover terminates once all the reachable slaves are properly",
          "new_line_content": "    while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 3696,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "     * configured. */",
          "new_line_content": "        sentinelRedisInstance *slave = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 1654,
          "old_api": null,
          "new_api": "sentinelDisconnectInstanceFromContext",
          "old_text": null,
          "new_text": "sentinelDisconnectInstanceFromContext(c)",
          "old_line_content": "",
          "new_line_content": "        sentinelDisconnectInstanceFromContext(c);",
          "content_same": false
        },
        {
          "line": 3702,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "        if (slave->flags & SRI_S_DOWN) continue;",
          "new_line_content": "    dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 1659,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_DEBUG, pubsub ? \"+pubsub-link\" : \"+cmd-link\", ri,\n            \"%@\")",
          "old_line_content": "        sentinelRedisInstance *ri = c->data;",
          "new_line_content": "        sentinelEvent(REDIS_DEBUG, pubsub ? \"+pubsub-link\" : \"+cmd-link\", ri,",
          "content_same": false
        },
        {
          "line": 3708,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+failover-end-for-timeout\",master,\"%@\")",
          "old_line_content": "    if (elapsed > master->failover_timeout) {",
          "new_line_content": "        sentinelEvent(REDIS_WARNING,\"+failover-end-for-timeout\",master,\"%@\");",
          "content_same": false
        },
        {
          "line": 3712,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+failover-end\",master,\"%@\")",
          "old_line_content": "    }",
          "new_line_content": "        sentinelEvent(REDIS_WARNING,\"+failover-end\",master,\"%@\");",
          "content_same": false
        },
        {
          "line": 1665,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(status)",
          "old_line_content": "}",
          "new_line_content": "    REDIS_NOTUSED(status);",
          "content_same": false
        },
        {
          "line": 1666,
          "old_api": null,
          "new_api": "sentinelDisconnectInstanceFromContext",
          "old_text": null,
          "new_text": "sentinelDisconnectInstanceFromContext(c)",
          "old_line_content": "",
          "new_line_content": "    sentinelDisconnectInstanceFromContext(c);",
          "content_same": false
        },
        {
          "line": 3714,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    if (not_reconfigured == 0) {",
          "new_line_content": "        master->failover_state_change_time = mstime();",
          "content_same": false
        },
        {
          "line": 3724,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(master->slaves)",
          "old_line_content": "        dictIterator *di;",
          "new_line_content": "        di = dictGetIterator(master->slaves);",
          "content_same": false
        },
        {
          "line": 3725,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "        dictEntry *de;",
          "new_line_content": "        while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 3726,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "",
          "new_line_content": "            sentinelRedisInstance *slave = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 1680,
          "old_api": null,
          "new_api": "redisAsyncCommand",
          "old_text": null,
          "new_text": "redisAsyncCommand(c, sentinelDiscardReplyCallback, NULL, \"AUTH %s\",\n            auth_pass)",
          "old_line_content": "                                                 ri->master->auth_pass;",
          "new_line_content": "        if (redisAsyncCommand(c, sentinelDiscardReplyCallback, NULL, \"AUTH %s\",",
          "content_same": false
        },
        {
          "line": 3732,
          "old_api": null,
          "new_api": "sentinelSendSlaveOf",
          "old_text": null,
          "new_text": "sentinelSendSlaveOf(slave,\n                    master->promoted_slave->addr->ip,\n                    master->promoted_slave->addr->port)",
          "old_line_content": "            if (slave->flags &",
          "new_line_content": "            retval = sentinelSendSlaveOf(slave,",
          "content_same": false
        },
        {
          "line": 3736,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_NOTICE,\"+slave-reconf-sent-be\",slave,\"%@\")",
          "old_line_content": "                    master->promoted_slave->addr->ip,",
          "new_line_content": "                sentinelEvent(REDIS_NOTICE,\"+slave-reconf-sent-be\",slave,\"%@\");",
          "content_same": false
        },
        {
          "line": 3740,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "                slave->flags |= SRI_RECONF_SENT;",
          "new_line_content": "        dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 1694,
          "old_api": null,
          "new_api": "snprintf",
          "old_text": null,
          "new_text": "snprintf(name,sizeof(name),\"sentinel-%.8s-%s\",server.runid,type)",
          "old_line_content": "void sentinelSetClientName(sentinelRedisInstance *ri, redisAsyncContext *c, char *type) {",
          "new_line_content": "    snprintf(name,sizeof(name),\"sentinel-%.8s-%s\",server.runid,type);",
          "content_same": false
        },
        {
          "line": 1695,
          "old_api": null,
          "new_api": "redisAsyncCommand",
          "old_text": null,
          "new_text": "redisAsyncCommand(c, sentinelDiscardReplyCallback, NULL,\n        \"CLIENT SETNAME %s\", name)",
          "old_line_content": "    char name[64];",
          "new_line_content": "    if (redisAsyncCommand(c, sentinelDiscardReplyCallback, NULL,",
          "content_same": false
        },
        {
          "line": 3751,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(master->slaves)",
          "old_line_content": "    dictEntry *de;",
          "new_line_content": "    di = dictGetIterator(master->slaves);",
          "content_same": false
        },
        {
          "line": 3752,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "    int in_progress = 0;",
          "new_line_content": "    while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 3753,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "",
          "new_line_content": "        sentinelRedisInstance *slave = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 1710,
          "old_api": null,
          "new_api": "redisAsyncConnectBind",
          "old_text": null,
          "new_text": "redisAsyncConnectBind(ri->addr->ip,ri->addr->port,REDIS_BIND_ADDR)",
          "old_line_content": "",
          "new_line_content": "        ri->cc = redisAsyncConnectBind(ri->addr->ip,ri->addr->port,REDIS_BIND_ADDR);",
          "content_same": false
        },
        {
          "line": 3758,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "        if (slave->flags & (SRI_RECONF_SENT|SRI_RECONF_INPROG))",
          "new_line_content": "    dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 1712,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_DEBUG,\"-cmd-link-reconnection\",ri,\"%@ #%s\",\n                ri->cc->errstr)",
          "old_line_content": "    if (ri->cc == NULL) {",
          "new_line_content": "            sentinelEvent(REDIS_DEBUG,\"-cmd-link-reconnection\",ri,\"%@ #%s\",",
          "content_same": false
        },
        {
          "line": 3760,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(master->slaves)",
          "old_line_content": "    }",
          "new_line_content": "    di = dictGetIterator(master->slaves);",
          "content_same": false
        },
        {
          "line": 1714,
          "old_api": null,
          "new_api": "sentinelKillLink",
          "old_text": null,
          "new_text": "sentinelKillLink(ri,ri->cc)",
          "old_line_content": "        if (ri->cc->err) {",
          "new_line_content": "            sentinelKillLink(ri,ri->cc);",
          "content_same": false
        },
        {
          "line": 3762,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "",
          "new_line_content": "          (de = dictNext(di)) != NULL)",
          "content_same": false
        },
        {
          "line": 1716,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "                ri->cc->errstr);",
          "new_line_content": "            ri->cc_conn_time = mstime();",
          "content_same": false
        },
        {
          "line": 3764,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "    while(in_progress < master->parallel_syncs &&",
          "new_line_content": "        sentinelRedisInstance *slave = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 1718,
          "old_api": null,
          "new_api": "redisAeAttach",
          "old_text": null,
          "new_text": "redisAeAttach(server.el,ri->cc)",
          "old_line_content": "        } else {",
          "new_line_content": "            redisAeAttach(server.el,ri->cc);",
          "content_same": false
        },
        {
          "line": 1723,
          "old_api": null,
          "new_api": "sentinelSendAuthIfNeeded",
          "old_text": null,
          "new_text": "sentinelSendAuthIfNeeded(ri,ri->cc)",
          "old_line_content": "                                            sentinelLinkEstablishedCallback);",
          "new_line_content": "            sentinelSendAuthIfNeeded(ri,ri->cc);",
          "content_same": false
        },
        {
          "line": 3775,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "         * Sentinels will detect the slave as misconfigured and fix its",
          "new_line_content": "            (mstime() - slave->slave_reconf_sent_time) >",
          "content_same": false
        },
        {
          "line": 1732,
          "old_api": null,
          "new_api": "redisAsyncConnectBind",
          "old_text": null,
          "new_text": "redisAsyncConnectBind(ri->addr->ip,ri->addr->port,REDIS_BIND_ADDR)",
          "old_line_content": "    }",
          "new_line_content": "        ri->pc = redisAsyncConnectBind(ri->addr->ip,ri->addr->port,REDIS_BIND_ADDR);",
          "content_same": false
        },
        {
          "line": 1734,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_DEBUG,\"-pubsub-link-reconnection\",ri,\"%@ #%s\",\n                ri->pc->errstr)",
          "old_line_content": "    if ((ri->flags & (SRI_MASTER|SRI_SLAVE)) && ri->pc == NULL) {",
          "new_line_content": "            sentinelEvent(REDIS_DEBUG,\"-pubsub-link-reconnection\",ri,\"%@ #%s\",",
          "content_same": false
        },
        {
          "line": 1736,
          "old_api": null,
          "new_api": "sentinelKillLink",
          "old_text": null,
          "new_text": "sentinelKillLink(ri,ri->pc)",
          "old_line_content": "        if (ri->pc->err) {",
          "new_line_content": "            sentinelKillLink(ri,ri->pc);",
          "content_same": false
        },
        {
          "line": 1740,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        } else {",
          "new_line_content": "            ri->pc_conn_time = mstime();",
          "content_same": false
        },
        {
          "line": 3789,
          "old_api": null,
          "new_api": "sentinelSendSlaveOf",
          "old_text": null,
          "new_text": "sentinelSendSlaveOf(slave,\n                master->promoted_slave->addr->ip,\n                master->promoted_slave->addr->port)",
          "old_line_content": "            continue;",
          "new_line_content": "        retval = sentinelSendSlaveOf(slave,",
          "content_same": false
        },
        {
          "line": 1742,
          "old_api": null,
          "new_api": "redisAeAttach",
          "old_text": null,
          "new_text": "redisAeAttach(server.el,ri->pc)",
          "old_line_content": "",
          "new_line_content": "            redisAeAttach(server.el,ri->pc);",
          "content_same": false
        },
        {
          "line": 3794,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "                master->promoted_slave->addr->port);",
          "new_line_content": "            slave->slave_reconf_sent_time = mstime();",
          "content_same": false
        },
        {
          "line": 1747,
          "old_api": null,
          "new_api": "sentinelSendAuthIfNeeded",
          "old_text": null,
          "new_text": "sentinelSendAuthIfNeeded(ri,ri->pc)",
          "old_line_content": "                                            sentinelLinkEstablishedCallback);",
          "new_line_content": "            sentinelSendAuthIfNeeded(ri,ri->pc);",
          "content_same": false
        },
        {
          "line": 3795,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_NOTICE,\"+slave-reconf-sent\",slave,\"%@\")",
          "old_line_content": "        if (retval == REDIS_OK) {",
          "new_line_content": "            sentinelEvent(REDIS_NOTICE,\"+slave-reconf-sent\",slave,\"%@\");",
          "content_same": false
        },
        {
          "line": 3799,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "            in_progress++;",
          "new_line_content": "    dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 1756,
          "old_api": null,
          "new_api": "sentinelKillLink",
          "old_text": null,
          "new_text": "sentinelKillLink(ri,ri->pc)",
          "old_line_content": "            if (retval != REDIS_OK) {",
          "new_line_content": "                sentinelKillLink(ri,ri->pc);",
          "content_same": false
        },
        {
          "line": 3812,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+switch-master\",master,\"%s %s %d %s %d\",\n        master->name, master->addr->ip, master->addr->port,\n        ref->addr->ip, ref->addr->port)",
          "old_line_content": "    sentinelRedisInstance *ref = master->promoted_slave ?",
          "new_line_content": "    sentinelEvent(REDIS_WARNING,\"+switch-master\",master,\"%s %s %d %s %d\",",
          "content_same": false
        },
        {
          "line": 3816,
          "old_api": null,
          "new_api": "sentinelResetMasterAndChangeAddress",
          "old_text": null,
          "new_text": "sentinelResetMasterAndChangeAddress(master,ref->addr->ip,ref->addr->port)",
          "old_line_content": "        master->name, master->addr->ip, master->addr->port,",
          "new_line_content": "    sentinelResetMasterAndChangeAddress(master,ref->addr->ip,ref->addr->port);",
          "content_same": false
        },
        {
          "line": 3820,
          "old_api": null,
          "new_api": "redisAssert",
          "old_text": null,
          "new_text": "redisAssert(ri->flags & SRI_MASTER)",
          "old_line_content": "}",
          "new_line_content": "    redisAssert(ri->flags & SRI_MASTER);",
          "content_same": false
        },
        {
          "line": 3826,
          "old_api": null,
          "new_api": "sentinelFailoverWaitStart",
          "old_text": null,
          "new_text": "sentinelFailoverWaitStart(ri)",
          "old_line_content": "",
          "new_line_content": "            sentinelFailoverWaitStart(ri);",
          "content_same": false
        },
        {
          "line": 1779,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "        master->flags & SRI_MASTER &&",
          "new_line_content": "        (mstime() - master->info_refresh) < SENTINEL_INFO_PERIOD*2;",
          "content_same": false
        },
        {
          "line": 1789,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(ri->info)",
          "old_line_content": "    int role = 0;",
          "new_line_content": "    sdsfree(ri->info);",
          "content_same": false
        },
        {
          "line": 1790,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(info)",
          "old_line_content": "",
          "new_line_content": "    ri->info = sdsnew(info);",
          "content_same": false
        },
        {
          "line": 1797,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(info)",
          "old_line_content": "    ri->master_link_down_time = 0;",
          "new_line_content": "    lines = sdssplitlen(info,strlen(info),\"\\r\\n\",2,&numlines);",
          "content_same": false
        },
        {
          "line": 3849,
          "old_api": null,
          "new_api": "redisAssert",
          "old_text": null,
          "new_text": "redisAssert(ri->flags & SRI_FAILOVER_IN_PROGRESS)",
          "old_line_content": " * the slave -> master switch. Otherwise the failover can't be aborted and",
          "new_line_content": "    redisAssert(ri->flags & SRI_FAILOVER_IN_PROGRESS);",
          "content_same": false
        },
        {
          "line": 3850,
          "old_api": null,
          "new_api": "redisAssert",
          "old_text": null,
          "new_text": "redisAssert(ri->failover_state <= SENTINEL_FAILOVER_STATE_WAIT_PROMOTION)",
          "old_line_content": " * will reach its end (possibly by timeout). */",
          "new_line_content": "    redisAssert(ri->failover_state <= SENTINEL_FAILOVER_STATE_WAIT_PROMOTION);",
          "content_same": false
        },
        {
          "line": 1803,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(l,\"run_id:\",7)",
          "old_line_content": "        sds l = lines[j];",
          "new_line_content": "        if (sdslen(l) >= 47 && !memcmp(l,\"run_id:\",7)) {",
          "content_same": false
        },
        {
          "line": 1805,
          "old_api": null,
          "new_api": "sdsnewlen",
          "old_text": null,
          "new_text": "sdsnewlen(l+7,40)",
          "old_line_content": "        /* run_id:<40 hex chars>*/",
          "new_line_content": "                ri->runid = sdsnewlen(l+7,40);",
          "content_same": false
        },
        {
          "line": 3854,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "",
          "new_line_content": "    ri->failover_state_change_time = mstime();",
          "content_same": false
        },
        {
          "line": 1807,
          "old_api": null,
          "new_api": "strncmp",
          "old_text": null,
          "new_text": "strncmp(ri->runid,l+7,40)",
          "old_line_content": "            if (ri->runid == NULL) {",
          "new_line_content": "                if (strncmp(ri->runid,l+7,40) != 0) {",
          "content_same": false
        },
        {
          "line": 1809,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(ri->runid)",
          "old_line_content": "            } else {",
          "new_line_content": "                    sdsfree(ri->runid);",
          "content_same": false
        },
        {
          "line": 1818,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(l)",
          "old_line_content": "        /* old versions: slave0:<ip>,<port>,<state>",
          "new_line_content": "            sdslen(l) >= 7 &&",
          "content_same": false
        },
        {
          "line": 1819,
          "old_api": null,
          "new_api": "isdigit",
          "old_text": null,
          "new_text": "isdigit(l[5])",
          "old_line_content": "         * new versions: slave0:ip=127.0.0.1,port=9999,... */",
          "new_line_content": "            !memcmp(l,\"slave\",5) && isdigit(l[5]))",
          "content_same": false
        },
        {
          "line": 3870,
          "old_api": null,
          "new_api": "sentinelReconnectInstance",
          "old_text": null,
          "new_text": "sentinelReconnectInstance(ri)",
          "old_line_content": "void sentinelHandleRedisInstance(sentinelRedisInstance *ri) {",
          "new_line_content": "    sentinelReconnectInstance(ri);",
          "content_same": false
        },
        {
          "line": 1823,
          "old_api": null,
          "new_api": "strstr",
          "old_text": null,
          "new_text": "strstr(l,\"ip=\")",
          "old_line_content": "        {",
          "new_line_content": "            if (strstr(l,\"ip=\") == NULL) {",
          "content_same": false
        },
        {
          "line": 3871,
          "old_api": null,
          "new_api": "sentinelSendPeriodicCommands",
          "old_text": null,
          "new_text": "sentinelSendPeriodicCommands(ri)",
          "old_line_content": "    /* ========== MONITORING HALF ============ */",
          "new_line_content": "    sentinelSendPeriodicCommands(ri);",
          "content_same": false
        },
        {
          "line": 1825,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(l,':')",
          "old_line_content": "",
          "new_line_content": "                ip = strchr(l,':'); if (!ip) continue;",
          "content_same": false
        },
        {
          "line": 1827,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(ip,',')",
          "old_line_content": "                /* Old format. */",
          "new_line_content": "                port = strchr(ip,','); if (!port) continue;",
          "content_same": false
        },
        {
          "line": 3878,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "     * TILT happens when we find something odd with the time, like a",
          "new_line_content": "        if (mstime()-sentinel.tilt_start_time < SENTINEL_TILT_PERIOD) return;",
          "content_same": false
        },
        {
          "line": 3880,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"-tilt\",NULL,\"#tilt mode exited\")",
          "old_line_content": "    if (sentinel.tilt) {",
          "new_line_content": "        sentinelEvent(REDIS_WARNING,\"-tilt\",NULL,\"#tilt mode exited\");",
          "content_same": false
        },
        {
          "line": 1834,
          "old_api": null,
          "new_api": "strstr",
          "old_text": null,
          "new_text": "strstr(l,\"ip=\")",
          "old_line_content": "                *end = '\\0'; /* nul term for easy access. */",
          "new_line_content": "                ip = strstr(l,\"ip=\"); if (!ip) continue;",
          "content_same": false
        },
        {
          "line": 1836,
          "old_api": null,
          "new_api": "strstr",
          "old_text": null,
          "new_text": "strstr(l,\"port=\")",
          "old_line_content": "                /* New format. */",
          "new_line_content": "                port = strstr(l,\"port=\"); if (!port) continue;",
          "content_same": false
        },
        {
          "line": 3884,
          "old_api": null,
          "new_api": "sentinelCheckSubjectivelyDown",
          "old_text": null,
          "new_text": "sentinelCheckSubjectivelyDown(ri)",
          "old_line_content": "    }",
          "new_line_content": "    sentinelCheckSubjectivelyDown(ri);",
          "content_same": false
        },
        {
          "line": 1840,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(port,',')",
          "old_line_content": "                port += 5; /* Now port points to start of port number. */",
          "new_line_content": "                end = strchr(port,','); if (end) *end = '\\0';",
          "content_same": false
        },
        {
          "line": 1845,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(port)",
          "old_line_content": "",
          "new_line_content": "            if (sentinelRedisInstanceLookupSlave(ri,ip,atoi(port)) == NULL) {",
          "content_same": false
        },
        {
          "line": 1846,
          "old_api": null,
          "new_api": "createSentinelRedisInstance",
          "old_text": null,
          "new_text": "createSentinelRedisInstance(NULL,SRI_SLAVE,ip,\n                            atoi(port), ri->quorum, ri)",
          "old_line_content": "            /* Check if we already have this slave into our table,",
          "new_line_content": "                if ((slave = createSentinelRedisInstance(NULL,SRI_SLAVE,ip,",
          "content_same": false
        },
        {
          "line": 1847,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(port)",
          "old_line_content": "             * otherwise add it. */",
          "new_line_content": "                            atoi(port), ri->quorum, ri)) != NULL)",
          "content_same": false
        },
        {
          "line": 3893,
          "old_api": null,
          "new_api": "sentinelCheckObjectivelyDown",
          "old_text": null,
          "new_text": "sentinelCheckObjectivelyDown(ri)",
          "old_line_content": "",
          "new_line_content": "        sentinelCheckObjectivelyDown(ri);",
          "content_same": false
        },
        {
          "line": 3894,
          "old_api": null,
          "new_api": "sentinelStartFailoverIfNeeded",
          "old_text": null,
          "new_text": "sentinelStartFailoverIfNeeded(ri)",
          "old_line_content": "    /* Only masters */",
          "new_line_content": "        if (sentinelStartFailoverIfNeeded(ri))",
          "content_same": false
        },
        {
          "line": 3895,
          "old_api": null,
          "new_api": "sentinelAskMasterStateToOtherSentinels",
          "old_text": null,
          "new_text": "sentinelAskMasterStateToOtherSentinels(ri,SENTINEL_ASK_FORCED)",
          "old_line_content": "    if (ri->flags & SRI_MASTER) {",
          "new_line_content": "            sentinelAskMasterStateToOtherSentinels(ri,SENTINEL_ASK_FORCED);",
          "content_same": false
        },
        {
          "line": 1855,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(l)",
          "old_line_content": "        }",
          "new_line_content": "        if (sdslen(l) >= 32 &&",
          "content_same": false
        },
        {
          "line": 1856,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(l,\"master_link_down_since_seconds\",30)",
          "old_line_content": "",
          "new_line_content": "            !memcmp(l,\"master_link_down_since_seconds\",30))",
          "content_same": false
        },
        {
          "line": 3909,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(instances)",
          "old_line_content": "    sentinelRedisInstance *switch_to_promoted = NULL;",
          "new_line_content": "    di = dictGetIterator(instances);",
          "content_same": false
        },
        {
          "line": 1862,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(l,\"role:master\",11)",
          "old_line_content": "        }",
          "new_line_content": "        if (!memcmp(l,\"role:master\",11)) role = SRI_MASTER;",
          "content_same": false
        },
        {
          "line": 1863,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(l,\"role:slave\",10)",
          "old_line_content": "",
          "new_line_content": "        else if (!memcmp(l,\"role:slave\",10)) role = SRI_SLAVE;",
          "content_same": false
        },
        {
          "line": 3910,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "",
          "new_line_content": "    while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 3911,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "    /* There are a number of things we need to perform against every master. */",
          "new_line_content": "        sentinelRedisInstance *ri = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 1867,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(l,\"master_host:\",12)",
          "old_line_content": "",
          "new_line_content": "            if (sdslen(l) >= 12 && !memcmp(l,\"master_host:\",12)) {",
          "content_same": false
        },
        {
          "line": 3915,
          "old_api": null,
          "new_api": "sentinelHandleDictOfRedisInstances",
          "old_text": null,
          "new_text": "sentinelHandleDictOfRedisInstances(ri->slaves)",
          "old_line_content": "",
          "new_line_content": "            sentinelHandleDictOfRedisInstances(ri->slaves);",
          "content_same": false
        },
        {
          "line": 1869,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(l+12,ri->slave_master_host)",
          "old_line_content": "            /* master_host:<host> */",
          "new_line_content": "                    strcasecmp(l+12,ri->slave_master_host))",
          "content_same": false
        },
        {
          "line": 1871,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(ri->slave_master_host)",
          "old_line_content": "                if (ri->slave_master_host == NULL ||",
          "new_line_content": "                    sdsfree(ri->slave_master_host);",
          "content_same": false
        },
        {
          "line": 1873,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "                {",
          "new_line_content": "                    ri->slave_conf_change_time = mstime();",
          "content_same": false
        },
        {
          "line": 3923,
          "old_api": null,
          "new_api": "sentinelFailoverSwitchToPromotedSlave",
          "old_text": null,
          "new_text": "sentinelFailoverSwitchToPromotedSlave(switch_to_promoted)",
          "old_line_content": "        }",
          "new_line_content": "        sentinelFailoverSwitchToPromotedSlave(switch_to_promoted);",
          "content_same": false
        },
        {
          "line": 3924,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "    }",
          "new_line_content": "    dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 1878,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(l,\"master_port:\",12)",
          "old_line_content": "            }",
          "new_line_content": "            if (sdslen(l) >= 12 && !memcmp(l,\"master_port:\",12)) {",
          "content_same": false
        },
        {
          "line": 1879,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(l+12)",
          "old_line_content": "",
          "new_line_content": "                int slave_master_port = atoi(l+12);",
          "content_same": false
        },
        {
          "line": 1883,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "",
          "new_line_content": "                    ri->slave_conf_change_time = mstime();",
          "content_same": false
        },
        {
          "line": 1888,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(l,\"master_link_status:\",19)",
          "old_line_content": "            }",
          "new_line_content": "            if (sdslen(l) >= 19 && !memcmp(l,\"master_link_status:\",19)) {",
          "content_same": false
        },
        {
          "line": 1890,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(l+19,\"up\")",
          "old_line_content": "            /* master_link_status:<status> */",
          "new_line_content": "                    (strcasecmp(l+19,\"up\") == 0) ?",
          "content_same": false
        },
        {
          "line": 1896,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(l,\"slave_priority:\",15)",
          "old_line_content": "            }",
          "new_line_content": "            if (sdslen(l) >= 15 && !memcmp(l,\"slave_priority:\",15))",
          "content_same": false
        },
        {
          "line": 1897,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(l+15)",
          "old_line_content": "",
          "new_line_content": "                ri->slave_priority = atoi(l+15);",
          "content_same": false
        },
        {
          "line": 3947,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": " *",
          "new_line_content": "    mstime_t now = mstime();",
          "content_same": false
        },
        {
          "line": 1901,
          "old_api": null,
          "new_api": "strtoull",
          "old_text": null,
          "new_text": "strtoull(l+18,NULL,10)",
          "old_line_content": "",
          "new_line_content": "                ri->slave_repl_offset = strtoull(l+18,NULL,10);",
          "content_same": false
        },
        {
          "line": 3952,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "",
          "new_line_content": "        sentinel.tilt_start_time = mstime();",
          "content_same": false
        },
        {
          "line": 1905,
          "old_api": null,
          "new_api": "sdsfreesplitres",
          "old_text": null,
          "new_text": "sdsfreesplitres(lines,numlines)",
          "old_line_content": "        }",
          "new_line_content": "    sdsfreesplitres(lines,numlines);",
          "content_same": false
        },
        {
          "line": 3953,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+tilt\",NULL,\"#tilt mode entered\")",
          "old_line_content": "    if (delta < 0 || delta > SENTINEL_TILT_TRIGGER) {",
          "new_line_content": "        sentinelEvent(REDIS_WARNING,\"+tilt\",NULL,\"#tilt mode entered\");",
          "content_same": false
        },
        {
          "line": 3959,
          "old_api": null,
          "new_api": "sentinelCheckTiltCondition",
          "old_text": null,
          "new_text": "sentinelCheckTiltCondition()",
          "old_line_content": "}",
          "new_line_content": "    sentinelCheckTiltCondition();",
          "content_same": false
        },
        {
          "line": 3960,
          "old_api": null,
          "new_api": "sentinelHandleDictOfRedisInstances",
          "old_text": null,
          "new_text": "sentinelHandleDictOfRedisInstances(sentinel.masters)",
          "old_line_content": "",
          "new_line_content": "    sentinelHandleDictOfRedisInstances(sentinel.masters);",
          "content_same": false
        },
        {
          "line": 1913,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "",
          "new_line_content": "        ri->role_reported_time = mstime();",
          "content_same": false
        },
        {
          "line": 3961,
          "old_api": null,
          "new_api": "sentinelRunPendingScripts",
          "old_text": null,
          "new_text": "sentinelRunPendingScripts()",
          "old_line_content": "void sentinelTimer(void) {",
          "new_line_content": "    sentinelRunPendingScripts();",
          "content_same": false
        },
        {
          "line": 1915,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "    if (role != ri->role_reported) {",
          "new_line_content": "        if (role == SRI_SLAVE) ri->slave_conf_change_time = mstime();",
          "content_same": false
        },
        {
          "line": 3971,
          "old_api": null,
          "new_api": "rand",
          "old_text": null,
          "new_text": "rand()",
          "old_line_content": "     * exactly continue to stay synchronized asking to be voted at the",
          "new_line_content": "    server.hz = REDIS_DEFAULT_HZ + rand() % REDIS_DEFAULT_HZ;",
          "content_same": false
        },
        {
          "line": 1953,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "             * a newer one already available). */",
          "new_line_content": "            ri->master->failover_state_change_time = mstime();",
          "content_same": false
        },
        {
          "line": 1954,
          "old_api": null,
          "new_api": "sentinelFlushConfig",
          "old_text": null,
          "new_text": "sentinelFlushConfig()",
          "old_line_content": "            ri->master->config_epoch = ri->master->failover_epoch;",
          "new_line_content": "            sentinelFlushConfig();",
          "content_same": false
        },
        {
          "line": 1955,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_WARNING,\"+promoted-slave\",ri,\"%@\")",
          "old_line_content": "            ri->master->failover_state = SENTINEL_FAILOVER_STATE_RECONF_SLAVES;",
          "new_line_content": "            sentinelEvent(REDIS_WARNING,\"+promoted-slave\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 1960,
          "old_api": null,
          "new_api": "sentinelForceHelloUpdateForMaster",
          "old_text": null,
          "new_text": "sentinelForceHelloUpdateForMaster(ri->master)",
          "old_line_content": "                ri->master,\"%@\");",
          "new_line_content": "            sentinelForceHelloUpdateForMaster(ri->master);",
          "content_same": false
        },
        {
          "line": 1968,
          "old_api": null,
          "new_api": "sentinelMasterLooksSane",
          "old_text": null,
          "new_text": "sentinelMasterLooksSane(ri->master)",
          "old_line_content": "            mstime_t wait_time = SENTINEL_PUBLISH_PERIOD*4;",
          "new_line_content": "                 sentinelMasterLooksSane(ri->master) &&",
          "content_same": false
        },
        {
          "line": 1969,
          "old_api": null,
          "new_api": "sentinelRedisInstanceNoDownFor",
          "old_text": null,
          "new_text": "sentinelRedisInstanceNoDownFor(ri,wait_time)",
          "old_line_content": "",
          "new_line_content": "                 sentinelRedisInstanceNoDownFor(ri,wait_time) &&",
          "content_same": false
        },
        {
          "line": 1970,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "            if (!(ri->flags & SRI_PROMOTED) &&",
          "new_line_content": "                 mstime() - ri->role_reported_time > wait_time)",
          "content_same": false
        },
        {
          "line": 1976,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_NOTICE,\"+convert-to-slave\",ri,\"%@\")",
          "old_line_content": "                        ri->master->addr->ip,",
          "new_line_content": "                    sentinelEvent(REDIS_NOTICE,\"+convert-to-slave\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 1985,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(ri->slave_master_host,ri->master->addr->ip)",
          "old_line_content": "    if ((ri->flags & SRI_SLAVE) &&",
          "new_line_content": "         strcasecmp(ri->slave_master_host,ri->master->addr->ip)))",
          "content_same": false
        },
        {
          "line": 1991,
          "old_api": null,
          "new_api": "sentinelMasterLooksSane",
          "old_text": null,
          "new_text": "sentinelMasterLooksSane(ri->master)",
          "old_line_content": "",
          "new_line_content": "        if (sentinelMasterLooksSane(ri->master) &&",
          "content_same": false
        },
        {
          "line": 1992,
          "old_api": null,
          "new_api": "sentinelRedisInstanceNoDownFor",
          "old_text": null,
          "new_text": "sentinelRedisInstanceNoDownFor(ri,wait_time)",
          "old_line_content": "        /* Make sure the master is sane before reconfiguring this instance",
          "new_line_content": "            sentinelRedisInstanceNoDownFor(ri,wait_time) &&",
          "content_same": false
        },
        {
          "line": 1993,
          "old_api": null,
          "new_api": "mstime",
          "old_text": null,
          "new_text": "mstime()",
          "old_line_content": "         * into a slave. */",
          "new_line_content": "            mstime() - ri->slave_conf_change_time > wait_time)",
          "content_same": false
        },
        {
          "line": 1999,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_NOTICE,\"+fix-slave-config\",ri,\"%@\")",
          "old_line_content": "                    ri->master->addr->ip,",
          "new_line_content": "                sentinelEvent(REDIS_NOTICE,\"+fix-slave-config\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 2011,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(ri->slave_master_host,\n                    ri->master->promoted_slave->addr->ip)",
          "old_line_content": "        /* SRI_RECONF_SENT -> SRI_RECONF_INPROG. */",
          "new_line_content": "            strcmp(ri->slave_master_host,",
          "content_same": false
        },
        {
          "line": 2017,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_NOTICE,\"+slave-reconf-inprog\",ri,\"%@\")",
          "old_line_content": "        {",
          "new_line_content": "            sentinelEvent(REDIS_NOTICE,\"+slave-reconf-inprog\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 2026,
          "old_api": null,
          "new_api": "sentinelEvent",
          "old_text": null,
          "new_text": "sentinelEvent(REDIS_NOTICE,\"+slave-reconf-done\",ri,\"%@\")",
          "old_line_content": "        {",
          "new_line_content": "            sentinelEvent(REDIS_NOTICE,\"+slave-reconf-done\",ri,\"%@\");",
          "content_same": false
        },
        {
          "line": 2034,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(privdata)",
          "old_line_content": "void sentinelInfoReplyCallback(redisAsyncContext *c, void *reply, void *privdata) {",
          "new_line_content": "    REDIS_NOTUSED(privdata);",
          "content_same": false
        },
        {
          "line": 2041,
          "old_api": null,
          "new_api": "sentinelRefreshInstanceInfo",
          "old_text": null,
          "new_text": "sentinelRefreshInstanceInfo(ri,r->str)",
          "old_line_content": "    r = reply;",
          "new_line_content": "        sentinelRefreshInstanceInfo(ri,r->str);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 2052,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(reply)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(reply);",
          "new_line_content": "    if (ri) ri->pending_commands--;",
          "content_same": false
        },
        {
          "line": 2053,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(privdata)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(privdata);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2061,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(privdata)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(privdata);",
          "new_line_content": "    if (!reply || !ri) return;",
          "content_same": false
        },
        {
          "line": 2071,
          "old_api": "strncmp",
          "new_api": null,
          "old_text": "strncmp(r->str,\"PONG\",4)",
          "new_text": null,
          "old_line_content": "        if (strncmp(r->str,\"PONG\",4) == 0 ||",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 2073,
          "old_api": "strncmp",
          "new_api": null,
          "old_text": "strncmp(r->str,\"MASTERDOWN\",10)",
          "new_text": null,
          "old_line_content": "            strncmp(r->str,\"MASTERDOWN\",10) == 0)",
          "new_line_content": "            ri->last_ping_time = 0; /* Flag the pong as received. */",
          "content_same": false
        },
        {
          "line": 2075,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "            ri->last_avail_time = mstime();",
          "new_line_content": "            /* Send a SCRIPT KILL command if the instance appears to be",
          "content_same": false
        },
        {
          "line": 2080,
          "old_api": "strncmp",
          "new_api": null,
          "old_text": "strncmp(r->str,\"BUSY\",4)",
          "new_text": null,
          "old_line_content": "            if (strncmp(r->str,\"BUSY\",4) == 0 &&",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 2084,
          "old_api": "redisAsyncCommand",
          "new_api": null,
          "old_text": "redisAsyncCommand(ri->cc,\n                        sentinelDiscardReplyCallback, NULL,\n                        \"SCRIPT KILL\")",
          "new_text": null,
          "old_line_content": "                if (redisAsyncCommand(ri->cc,",
          "new_line_content": "                    ri->pending_commands++;",
          "content_same": false
        },
        {
          "line": 2092,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    ri->last_pong_time = mstime();",
          "new_line_content": "/* This is called when we get the reply about the PUBLISH command we send",
          "content_same": false
        },
        {
          "line": 2100,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(privdata)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(privdata);",
          "new_line_content": "    if (!reply || !ri) return;",
          "content_same": false
        },
        {
          "line": 2109,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        ri->last_pub_time = mstime();",
          "new_line_content": "/* Process an hello message received via Pub/Sub in master or slave instance,",
          "content_same": false
        },
        {
          "line": 2123,
          "old_api": "sdssplitlen",
          "new_api": null,
          "old_text": "sdssplitlen(hello, hello_len, \",\", 1, &numtokens)",
          "new_text": null,
          "old_line_content": "    char **token = sdssplitlen(hello, hello_len, \",\", 1, &numtokens);",
          "new_line_content": "    if (numtokens == 8) {",
          "content_same": false
        },
        {
          "line": 2128,
          "old_api": "sentinelGetMasterByName",
          "new_api": null,
          "old_text": "sentinelGetMasterByName(token[4])",
          "new_text": null,
          "old_line_content": "        master = sentinelGetMasterByName(token[4]);",
          "new_line_content": "        /* First, try to see if we already have this sentinel. */",
          "content_same": false
        },
        {
          "line": 2132,
          "old_api": "atoi",
          "new_api": null,
          "old_text": "atoi(token[1])",
          "new_text": null,
          "old_line_content": "        port = atoi(token[1]);",
          "new_line_content": "                        master->sentinels,token[0],port,token[2]);",
          "content_same": false
        },
        {
          "line": 2136,
          "old_api": "strtoull",
          "new_api": null,
          "old_text": "strtoull(token[3],NULL,10)",
          "new_text": null,
          "old_line_content": "        current_epoch = strtoull(token[3],NULL,10);",
          "new_line_content": "        if (!si) {",
          "content_same": false
        },
        {
          "line": 2137,
          "old_api": "strtoull",
          "new_api": null,
          "old_text": "strtoull(token[7],NULL,10)",
          "new_text": null,
          "old_line_content": "        master_config_epoch = strtoull(token[7],NULL,10);",
          "new_line_content": "            /* If not, remove all the sentinels that have the same runid",
          "content_same": false
        },
        {
          "line": 2146,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_NOTICE,\"-dup-sentinel\",master,\n                    \"%@ #duplicate of %s:%d or %s\",\n                    token[0],port,token[2])",
          "new_text": null,
          "old_line_content": "                sentinelEvent(REDIS_NOTICE,\"-dup-sentinel\",master,",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2155,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_NOTICE,\"+sentinel\",si,\"%@\")",
          "new_text": null,
          "old_line_content": "                sentinelEvent(REDIS_NOTICE,\"+sentinel\",si,\"%@\");",
          "new_line_content": "                 * so do it now. */",
          "content_same": false
        },
        {
          "line": 2159,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(token[2])",
          "new_text": null,
          "old_line_content": "                si->runid = sdsnew(token[2]);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2160,
          "old_api": "sentinelFlushConfig",
          "new_api": null,
          "old_text": "sentinelFlushConfig()",
          "new_text": null,
          "old_line_content": "                sentinelFlushConfig();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2167,
          "old_api": "sentinelFlushConfig",
          "new_api": null,
          "old_text": "sentinelFlushConfig()",
          "new_text": null,
          "old_line_content": "            sentinelFlushConfig();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2168,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+new-epoch\",master,\"%llu\",\n                (unsigned long long) sentinel.current_epoch)",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_WARNING,\"+new-epoch\",master,\"%llu\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2176,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(master->addr->ip, token[5])",
          "new_text": null,
          "old_line_content": "                strcmp(master->addr->ip, token[5]))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2180,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+config-update-from\",si,\"%@\")",
          "new_text": null,
          "old_line_content": "                sentinelEvent(REDIS_WARNING,\"+config-update-from\",si,\"%@\");",
          "new_line_content": "                    master->name,",
          "content_same": false
        },
        {
          "line": 2181,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+switch-master\",\n                    master,\"%s %s %d %s %d\",\n                    master->name,\n                    master->addr->ip, master->addr->port,\n                    token[5], master_port)",
          "new_text": null,
          "old_line_content": "                sentinelEvent(REDIS_WARNING,\"+switch-master\",",
          "new_line_content": "                    master->addr->ip, master->addr->port,",
          "content_same": false
        },
        {
          "line": 2187,
          "old_api": "dupSentinelAddr",
          "new_api": null,
          "old_text": "dupSentinelAddr(master->addr)",
          "new_text": null,
          "old_line_content": "                old_addr = dupSentinelAddr(master->addr);",
          "new_line_content": "                    SENTINEL_OBSERVER,\"start\",",
          "content_same": false
        },
        {
          "line": 2188,
          "old_api": "sentinelResetMasterAndChangeAddress",
          "new_api": null,
          "old_text": "sentinelResetMasterAndChangeAddress(master, token[5], master_port)",
          "new_text": null,
          "old_line_content": "                sentinelResetMasterAndChangeAddress(master, token[5], master_port);",
          "new_line_content": "                    old_addr,master->addr);",
          "content_same": false
        },
        {
          "line": 2192,
          "old_api": "releaseSentinelAddr",
          "new_api": null,
          "old_text": "releaseSentinelAddr(old_addr)",
          "new_text": null,
          "old_line_content": "                releaseSentinelAddr(old_addr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2197,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        if (si) si->last_hello_time = mstime();",
          "new_line_content": "cleanup:",
          "content_same": false
        },
        {
          "line": 2201,
          "old_api": "sdsfreesplitres",
          "new_api": null,
          "old_text": "sdsfreesplitres(token,numtokens)",
          "new_text": null,
          "old_line_content": "    sdsfreesplitres(token,numtokens);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2210,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(privdata)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(privdata);",
          "new_line_content": "    r = reply;",
          "content_same": false
        },
        {
          "line": 2218,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    ri->pc_last_activity = mstime();",
          "new_line_content": "     * can avoid to check for details. */",
          "content_same": false
        },
        {
          "line": 2230,
          "old_api": "strstr",
          "new_api": null,
          "old_text": "strstr(r->element[2]->str,server.runid)",
          "new_text": null,
          "old_line_content": "    if (strstr(r->element[2]->str,server.runid) != NULL) return;",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2232,
          "old_api": "sentinelProcessHelloMessage",
          "new_api": null,
          "old_text": "sentinelProcessHelloMessage(r->element[2]->str, r->element[2]->len)",
          "new_text": null,
          "old_line_content": "    sentinelProcessHelloMessage(r->element[2]->str, r->element[2]->len);",
          "new_line_content": "/* Send an \"Hello\" message via Pub/Sub to the specified 'ri' Redis",
          "content_same": false
        },
        {
          "line": 2253,
          "old_api": "sentinelGetCurrentMasterAddress",
          "new_api": null,
          "old_text": "sentinelGetCurrentMasterAddress(master)",
          "new_text": null,
          "old_line_content": "    sentinelAddr *master_addr = sentinelGetCurrentMasterAddress(master);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2262,
          "old_api": "anetSockName",
          "new_api": null,
          "old_text": "anetSockName(ri->cc->c.fd,ip,sizeof(ip),NULL)",
          "new_text": null,
          "old_line_content": "        if (anetSockName(ri->cc->c.fd,ip,sizeof(ip),NULL) == -1)",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2270,
          "old_api": "snprintf",
          "new_api": null,
          "old_text": "snprintf(payload,sizeof(payload),\n        \"%s,%d,%s,%llu,\" /* Info about this sentinel. */\n        \"%s,%s,%d,%llu\", /* Info about current master. */\n        announce_ip, announce_port, server.runid,\n        (unsigned long long) sentinel.current_epoch,\n        /* --- */\n        master->name,master_addr->ip,master_addr->port,\n        (unsigned long long) master->config_epoch)",
          "new_text": null,
          "old_line_content": "    snprintf(payload,sizeof(payload),",
          "new_line_content": "        announce_ip, announce_port, server.runid,",
          "content_same": false
        },
        {
          "line": 2278,
          "old_api": "redisAsyncCommand",
          "new_api": null,
          "old_text": "redisAsyncCommand(ri->cc,\n        sentinelPublishReplyCallback, NULL, \"PUBLISH %s %s\",\n            SENTINEL_HELLO_CHANNEL,payload)",
          "new_text": null,
          "old_line_content": "    retval = redisAsyncCommand(ri->cc,",
          "new_line_content": "    if (retval != REDIS_OK) return REDIS_ERR;",
          "content_same": false
        },
        {
          "line": 2292,
          "old_api": "dictGetSafeIterator",
          "new_api": null,
          "old_text": "dictGetSafeIterator(instances)",
          "new_text": null,
          "old_line_content": "    di = dictGetSafeIterator(instances);",
          "new_line_content": "        if (ri->last_pub_time >= (SENTINEL_PUBLISH_PERIOD+1))",
          "content_same": false
        },
        {
          "line": 2293,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "    while((de = dictNext(di)) != NULL) {",
          "new_line_content": "            ri->last_pub_time -= (SENTINEL_PUBLISH_PERIOD+1);",
          "content_same": false
        },
        {
          "line": 2294,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "        sentinelRedisInstance *ri = dictGetVal(de);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2298,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "    dictReleaseIterator(di);",
          "new_line_content": "/* This function forces the delivery of an \"Hello\" message (see",
          "content_same": false
        },
        {
          "line": 2313,
          "old_api": "sentinelForceHelloUpdateDictOfRedisInstances",
          "new_api": null,
          "old_text": "sentinelForceHelloUpdateDictOfRedisInstances(master->sentinels)",
          "new_text": null,
          "old_line_content": "    sentinelForceHelloUpdateDictOfRedisInstances(master->sentinels);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2314,
          "old_api": "sentinelForceHelloUpdateDictOfRedisInstances",
          "new_api": null,
          "old_text": "sentinelForceHelloUpdateDictOfRedisInstances(master->slaves)",
          "new_text": null,
          "old_line_content": "    sentinelForceHelloUpdateDictOfRedisInstances(master->slaves);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2324,
          "old_api": "redisAsyncCommand",
          "new_api": null,
          "old_text": "redisAsyncCommand(ri->cc,\n        sentinelPingReplyCallback, NULL, \"PING\")",
          "new_text": null,
          "old_line_content": "    int retval = redisAsyncCommand(ri->cc,",
          "new_line_content": "        ri->pending_commands++;",
          "content_same": false
        },
        {
          "line": 2331,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        if (ri->last_ping_time == 0) ri->last_ping_time = mstime();",
          "new_line_content": "        return 0;",
          "content_same": false
        },
        {
          "line": 2341,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    mstime_t now = mstime();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2379,
          "old_api": "redisAsyncCommand",
          "new_api": null,
          "old_text": "redisAsyncCommand(ri->cc,\n            sentinelInfoReplyCallback, NULL, \"INFO\")",
          "new_text": null,
          "old_line_content": "        retval = redisAsyncCommand(ri->cc,",
          "new_line_content": "    } else if ((now - ri->last_pong_time) > ping_period) {",
          "content_same": false
        },
        {
          "line": 2387,
          "old_api": "sentinelSendHello",
          "new_api": null,
          "old_text": "sentinelSendHello(ri)",
          "new_text": null,
          "old_line_content": "        sentinelSendHello(ri);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2408,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "    char *flags = sdsempty();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2414,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"name\")",
          "new_text": null,
          "old_line_content": "    addReplyBulkCString(c,\"name\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2418,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"ip\")",
          "new_text": null,
          "old_line_content": "    addReplyBulkCString(c,\"ip\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2422,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"port\")",
          "new_text": null,
          "old_line_content": "    addReplyBulkCString(c,\"port\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2426,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"runid\")",
          "new_text": null,
          "old_line_content": "    addReplyBulkCString(c,\"runid\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2435,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(flags,\"sentinel,\")",
          "new_text": null,
          "old_line_content": "    if (ri->flags & SRI_SENTINEL) flags = sdscat(flags,\"sentinel,\");",
          "new_line_content": "    if (ri->flags & SRI_FAILOVER_IN_PROGRESS)",
          "content_same": false
        },
        {
          "line": 2441,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(flags,\"reconf_sent,\")",
          "new_text": null,
          "old_line_content": "    if (ri->flags & SRI_RECONF_SENT) flags = sdscat(flags,\"reconf_sent,\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2445,
          "old_api": "sdsrange",
          "new_api": null,
          "old_text": "sdsrange(flags,0,-2)",
          "new_text": null,
          "old_line_content": "    if (sdslen(flags) != 0) sdsrange(flags,0,-2); /* remove last \",\" */",
          "new_line_content": "    fields++;",
          "content_same": false
        },
        {
          "line": 2446,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,flags)",
          "new_text": null,
          "old_line_content": "    addReplyBulkCString(c,flags);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2450,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"pending-commands\")",
          "new_text": null,
          "old_line_content": "    addReplyBulkCString(c,\"pending-commands\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2451,
          "old_api": "addReplyBulkLongLong",
          "new_api": null,
          "old_text": "addReplyBulkLongLong(c,ri->pending_commands)",
          "new_text": null,
          "old_line_content": "    addReplyBulkLongLong(c,ri->pending_commands);",
          "new_line_content": "    if (ri->flags & SRI_FAILOVER_IN_PROGRESS) {",
          "content_same": false
        },
        {
          "line": 2455,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"failover-state\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"failover-state\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2456,
          "old_api": "sentinelFailoverStateStr",
          "new_api": null,
          "old_text": "sentinelFailoverStateStr(ri->failover_state)",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,(char*)sentinelFailoverStateStr(ri->failover_state));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2460,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"last-ping-sent\")",
          "new_text": null,
          "old_line_content": "    addReplyBulkCString(c,\"last-ping-sent\");",
          "new_line_content": "    fields++;",
          "content_same": false
        },
        {
          "line": 2461,
          "old_api": "addReplyBulkLongLong",
          "new_api": null,
          "old_text": "addReplyBulkLongLong(c,\n        ri->last_ping_time ? (mstime() - ri->last_ping_time) : 0)",
          "new_text": null,
          "old_line_content": "    addReplyBulkLongLong(c,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2465,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"last-ok-ping-reply\")",
          "new_text": null,
          "old_line_content": "    addReplyBulkCString(c,\"last-ok-ping-reply\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2469,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"last-ping-reply\")",
          "new_text": null,
          "old_line_content": "    addReplyBulkCString(c,\"last-ping-reply\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2470,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    addReplyBulkLongLong(c,mstime() - ri->last_pong_time);",
          "new_line_content": "    if (ri->flags & SRI_S_DOWN) {",
          "content_same": false
        },
        {
          "line": 2474,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"s-down-time\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"s-down-time\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2475,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        addReplyBulkLongLong(c,mstime()-ri->s_down_since_time);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2480,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"o-down-time\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"o-down-time\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2481,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        addReplyBulkLongLong(c,mstime()-ri->o_down_since_time);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2485,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"down-after-milliseconds\")",
          "new_text": null,
          "old_line_content": "    addReplyBulkCString(c,\"down-after-milliseconds\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2486,
          "old_api": "addReplyBulkLongLong",
          "new_api": null,
          "old_text": "addReplyBulkLongLong(c,ri->down_after_period)",
          "new_text": null,
          "old_line_content": "    addReplyBulkLongLong(c,ri->down_after_period);",
          "new_line_content": "    /* Masters and Slaves */",
          "content_same": false
        },
        {
          "line": 2491,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"info-refresh\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"info-refresh\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2495,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"role-reported\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"role-reported\");",
          "new_line_content": "        fields++;",
          "content_same": false
        },
        {
          "line": 2496,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c, (ri->role_reported == SRI_MASTER) ? \"master\" :\n                                                                   \"slave\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c, (ri->role_reported == SRI_MASTER) ? \"master\" :",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2500,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"role-reported-time\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"role-reported-time\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2501,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        addReplyBulkLongLong(c,mstime() - ri->role_reported_time);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2507,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"config-epoch\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"config-epoch\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2511,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"num-slaves\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"num-slaves\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2515,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"num-other-sentinels\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"num-other-sentinels\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2519,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"quorum\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"quorum\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2523,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"failover-timeout\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"failover-timeout\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2527,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"parallel-syncs\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"parallel-syncs\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2528,
          "old_api": "addReplyBulkLongLong",
          "new_api": null,
          "old_text": "addReplyBulkLongLong(c,ri->parallel_syncs)",
          "new_text": null,
          "old_line_content": "        addReplyBulkLongLong(c,ri->parallel_syncs);",
          "new_line_content": "        if (ri->notification_script) {",
          "content_same": false
        },
        {
          "line": 2532,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"notification-script\")",
          "new_text": null,
          "old_line_content": "            addReplyBulkCString(c,\"notification-script\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2533,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,ri->notification_script)",
          "new_text": null,
          "old_line_content": "            addReplyBulkCString(c,ri->notification_script);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2538,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"client-reconfig-script\")",
          "new_text": null,
          "old_line_content": "            addReplyBulkCString(c,\"client-reconfig-script\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2539,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,ri->client_reconfig_script)",
          "new_text": null,
          "old_line_content": "            addReplyBulkCString(c,ri->client_reconfig_script);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2546,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"master-link-down-time\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"master-link-down-time\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2550,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"master-link-status\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"master-link-status\");",
          "new_line_content": "            \"ok\" : \"err\");",
          "content_same": false
        },
        {
          "line": 2551,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\n            (ri->slave_master_link_status == SENTINEL_MASTER_LINK_STATUS_UP) ?\n            \"ok\" : \"err\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,",
          "new_line_content": "        fields++;",
          "content_same": false
        },
        {
          "line": 2556,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"master-host\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"master-host\");",
          "new_line_content": "        fields++;",
          "content_same": false
        },
        {
          "line": 2557,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\n            ri->slave_master_host ? ri->slave_master_host : \"?\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2561,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"master-port\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"master-port\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2565,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"slave-priority\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"slave-priority\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2569,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"slave-repl-offset\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"slave-repl-offset\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2570,
          "old_api": "addReplyBulkLongLong",
          "new_api": null,
          "old_text": "addReplyBulkLongLong(c,ri->slave_repl_offset)",
          "new_text": null,
          "old_line_content": "        addReplyBulkLongLong(c,ri->slave_repl_offset);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2576,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"last-hello-message\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"last-hello-message\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2580,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"voted-leader\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"voted-leader\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2584,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"voted-leader-epoch\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"voted-leader-epoch\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2585,
          "old_api": "addReplyBulkLongLong",
          "new_api": null,
          "old_text": "addReplyBulkLongLong(c,ri->leader_epoch)",
          "new_text": null,
          "old_line_content": "        addReplyBulkLongLong(c,ri->leader_epoch);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2589,
          "old_api": "setDeferredMultiBulkLength",
          "new_api": null,
          "old_text": "setDeferredMultiBulkLength(c,mbl,fields*2)",
          "new_text": null,
          "old_line_content": "    setDeferredMultiBulkLength(c,mbl,fields*2);",
          "new_line_content": "/* Output a number of instances contained inside a dictionary as",
          "content_same": false
        },
        {
          "line": 2599,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(instances)",
          "new_text": null,
          "old_line_content": "    addReplyMultiBulkLen(c,dictSize(instances));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2601,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "        sentinelRedisInstance *ri = dictGetVal(de);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2603,
          "old_api": "addReplySentinelRedisInstance",
          "new_api": null,
          "old_text": "addReplySentinelRedisInstance(c,ri)",
          "new_text": null,
          "old_line_content": "        addReplySentinelRedisInstance(c,ri);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2605,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "    dictReleaseIterator(di);",
          "new_line_content": "/* Lookup the named master into sentinel.masters.",
          "content_same": false
        },
        {
          "line": 2616,
          "old_api": "dictFetchValue",
          "new_api": null,
          "old_text": "dictFetchValue(sentinel.masters,name->ptr)",
          "new_text": null,
          "old_line_content": "    ri = dictFetchValue(sentinel.masters,name->ptr);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 2618,
          "old_api": "addReplyError",
          "new_api": null,
          "old_text": "addReplyError(c,\"No such master with that name\")",
          "new_text": null,
          "old_line_content": "        addReplyError(c,\"No such master with that name\");",
          "new_line_content": "    return ri;",
          "content_same": false
        },
        {
          "line": 2628,
          "old_api": "addReplyDictOfRedisInstances",
          "new_api": null,
          "old_text": "addReplyDictOfRedisInstances(c,sentinel.masters)",
          "new_text": null,
          "old_line_content": "        addReplyDictOfRedisInstances(c,sentinel.masters);",
          "new_line_content": "        sentinelRedisInstance *ri;",
          "content_same": false
        },
        {
          "line": 2629,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[1]->ptr,\"master\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"master\")) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2636,
          "old_api": "addReplySentinelRedisInstance",
          "new_api": null,
          "old_text": "addReplySentinelRedisInstance(c,ri)",
          "new_text": null,
          "old_line_content": "        addReplySentinelRedisInstance(c,ri);",
          "new_line_content": "        sentinelRedisInstance *ri;",
          "content_same": false
        },
        {
          "line": 2637,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[1]->ptr,\"slaves\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"slaves\")) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2644,
          "old_api": "addReplyDictOfRedisInstances",
          "new_api": null,
          "old_text": "addReplyDictOfRedisInstances(c,ri->slaves)",
          "new_text": null,
          "old_line_content": "        addReplyDictOfRedisInstances(c,ri->slaves);",
          "new_line_content": "        sentinelRedisInstance *ri;",
          "content_same": false
        },
        {
          "line": 2645,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[1]->ptr,\"sentinels\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"sentinels\")) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2652,
          "old_api": "addReplyDictOfRedisInstances",
          "new_api": null,
          "old_text": "addReplyDictOfRedisInstances(c,ri->sentinels)",
          "new_text": null,
          "old_line_content": "        addReplyDictOfRedisInstances(c,ri->sentinels);",
          "new_line_content": "        sentinelRedisInstance *ri;",
          "content_same": false
        },
        {
          "line": 2653,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[1]->ptr,\"is-master-down-by-addr\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"is-master-down-by-addr\")) {",
          "new_line_content": "        long long req_epoch;",
          "content_same": false
        },
        {
          "line": 2663,
          "old_api": "getLongFromObjectOrReply",
          "new_api": null,
          "old_text": "getLongFromObjectOrReply(c,c->argv[3],&port,NULL)",
          "new_text": null,
          "old_line_content": "        if (getLongFromObjectOrReply(c,c->argv[3],&port,NULL) != REDIS_OK ||",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 2667,
          "old_api": "getSentinelRedisInstanceByAddrAndRunID",
          "new_api": null,
          "old_text": "getSentinelRedisInstanceByAddrAndRunID(sentinel.masters,\n            c->argv[2]->ptr,port,NULL)",
          "new_text": null,
          "old_line_content": "        ri = getSentinelRedisInstanceByAddrAndRunID(sentinel.masters,",
          "new_line_content": "        /* It exists? Is actually a master? Is subjectively down? It's down.",
          "content_same": false
        },
        {
          "line": 2678,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[5]->ptr,\"*\")",
          "new_text": null,
          "old_line_content": "        if (ri && ri->flags & SRI_MASTER && strcasecmp(c->argv[5]->ptr,\"*\")) {",
          "new_line_content": "                                            &leader_epoch);",
          "content_same": false
        },
        {
          "line": 2679,
          "old_api": "sentinelVoteLeader",
          "new_api": null,
          "old_text": "sentinelVoteLeader(ri,(uint64_t)req_epoch,\n                                            c->argv[5]->ptr,\n                                            &leader_epoch)",
          "new_text": null,
          "old_line_content": "            leader = sentinelVoteLeader(ri,(uint64_t)req_epoch,",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2689,
          "old_api": "addReplyLongLong",
          "new_api": null,
          "old_text": "addReplyLongLong(c, (long long)leader_epoch)",
          "new_text": null,
          "old_line_content": "        addReplyLongLong(c, (long long)leader_epoch);",
          "new_line_content": "        /* SENTINEL RESET <pattern> */",
          "content_same": false
        },
        {
          "line": 2690,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(leader)",
          "new_text": null,
          "old_line_content": "        if (leader) sdsfree(leader);",
          "new_line_content": "        if (c->argc != 3) goto numargserr;",
          "content_same": false
        },
        {
          "line": 2694,
          "old_api": "sentinelResetMastersByPattern",
          "new_api": null,
          "old_text": "sentinelResetMastersByPattern(c->argv[2]->ptr,SENTINEL_GENERATE_EVENT)",
          "new_text": null,
          "old_line_content": "        addReplyLongLong(c,sentinelResetMastersByPattern(c->argv[2]->ptr,SENTINEL_GENERATE_EVENT));",
          "new_line_content": "        sentinelRedisInstance *ri;",
          "content_same": false
        },
        {
          "line": 2695,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[1]->ptr,\"get-master-addr-by-name\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"get-master-addr-by-name\")) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2700,
          "old_api": "sentinelGetMasterByName",
          "new_api": null,
          "old_text": "sentinelGetMasterByName(c->argv[2]->ptr)",
          "new_text": null,
          "old_line_content": "        ri = sentinelGetMasterByName(c->argv[2]->ptr);",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 2702,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.nullmultibulk)",
          "new_text": null,
          "old_line_content": "            addReply(c,shared.nullmultibulk);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2706,
          "old_api": "addReplyMultiBulkLen",
          "new_api": null,
          "old_text": "addReplyMultiBulkLen(c,2)",
          "new_text": null,
          "old_line_content": "            addReplyMultiBulkLen(c,2);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2708,
          "old_api": "addReplyBulkLongLong",
          "new_api": null,
          "old_text": "addReplyBulkLongLong(c,addr->port)",
          "new_text": null,
          "old_line_content": "            addReplyBulkLongLong(c,addr->port);",
          "new_line_content": "        /* SENTINEL FAILOVER <master-name> */",
          "content_same": false
        },
        {
          "line": 2710,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[1]->ptr,\"failover\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"failover\")) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2721,
          "old_api": "sentinelSelectSlave",
          "new_api": null,
          "old_text": "sentinelSelectSlave(ri)",
          "new_text": null,
          "old_line_content": "        if (sentinelSelectSlave(ri) == NULL) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2725,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"Executing user requested FAILOVER of '%s'\",\n            ri->name)",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_WARNING,\"Executing user requested FAILOVER of '%s'\",",
          "new_line_content": "        ri->flags |= SRI_FORCE_FAILOVER;",
          "content_same": false
        },
        {
          "line": 2729,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.ok)",
          "new_text": null,
          "old_line_content": "        addReply(c,shared.ok);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2730,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[1]->ptr,\"pending-scripts\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"pending-scripts\")) {",
          "new_line_content": "        if (c->argc != 2) goto numargserr;",
          "content_same": false
        },
        {
          "line": 2734,
          "old_api": "sentinelPendingScriptsCommand",
          "new_api": null,
          "old_text": "sentinelPendingScriptsCommand(c)",
          "new_text": null,
          "old_line_content": "        sentinelPendingScriptsCommand(c);",
          "new_line_content": "        sentinelRedisInstance *ri;",
          "content_same": false
        },
        {
          "line": 2735,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[1]->ptr,\"monitor\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"monitor\")) {",
          "new_line_content": "        long quorum, port;",
          "content_same": false
        },
        {
          "line": 2742,
          "old_api": "getLongFromObjectOrReply",
          "new_api": null,
          "old_text": "getLongFromObjectOrReply(c,c->argv[5],&quorum,\"Invalid quorum\")",
          "new_text": null,
          "old_line_content": "        if (getLongFromObjectOrReply(c,c->argv[5],&quorum,\"Invalid quorum\")",
          "new_line_content": "            != REDIS_OK) return;",
          "content_same": false
        },
        {
          "line": 2744,
          "old_api": "getLongFromObjectOrReply",
          "new_api": null,
          "old_text": "getLongFromObjectOrReply(c,c->argv[4],&port,\"Invalid port\")",
          "new_text": null,
          "old_line_content": "        if (getLongFromObjectOrReply(c,c->argv[4],&port,\"Invalid port\")",
          "new_line_content": "        if (quorum <= 0) {",
          "content_same": false
        },
        {
          "line": 2748,
          "old_api": "addReplyError",
          "new_api": null,
          "old_text": "addReplyError(c, \"Quorum must be 1 or greater.\")",
          "new_text": null,
          "old_line_content": "            addReplyError(c, \"Quorum must be 1 or greater.\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2755,
          "old_api": "anetResolveIP",
          "new_api": null,
          "old_text": "anetResolveIP(NULL,c->argv[3]->ptr,ip,sizeof(ip))",
          "new_text": null,
          "old_line_content": "        if (anetResolveIP(NULL,c->argv[3]->ptr,ip,sizeof(ip)) == ANET_ERR) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2756,
          "old_api": "addReplyError",
          "new_api": null,
          "old_text": "addReplyError(c,\"Invalid IP address specified\")",
          "new_text": null,
          "old_line_content": "            addReplyError(c,\"Invalid IP address specified\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2761,
          "old_api": "createSentinelRedisInstance",
          "new_api": null,
          "old_text": "createSentinelRedisInstance(c->argv[2]->ptr,SRI_MASTER,\n                c->argv[3]->ptr,port,quorum,NULL)",
          "new_text": null,
          "old_line_content": "        ri = createSentinelRedisInstance(c->argv[2]->ptr,SRI_MASTER,",
          "new_line_content": "            switch(errno) {",
          "content_same": false
        },
        {
          "line": 2772,
          "old_api": "addReplyError",
          "new_api": null,
          "old_text": "addReplyError(c,\"Unspecified error adding the instance\")",
          "new_text": null,
          "old_line_content": "                addReplyError(c,\"Unspecified error adding the instance\");",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 2776,
          "old_api": "sentinelFlushConfig",
          "new_api": null,
          "old_text": "sentinelFlushConfig()",
          "new_text": null,
          "old_line_content": "            sentinelFlushConfig();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2778,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.ok)",
          "new_text": null,
          "old_line_content": "            addReply(c,shared.ok);",
          "new_line_content": "        /* SENTINEL REMOVE <name> */",
          "content_same": false
        },
        {
          "line": 2780,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[1]->ptr,\"remove\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"remove\")) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2788,
          "old_api": "sentinelFlushConfig",
          "new_api": null,
          "old_text": "sentinelFlushConfig()",
          "new_text": null,
          "old_line_content": "        sentinelFlushConfig();",
          "new_line_content": "        if (c->argc < 3 || c->argc % 2 == 0) goto numargserr;",
          "content_same": false
        },
        {
          "line": 2793,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[1]->ptr,\"info-cache\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"info-cache\")) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2795,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        mstime_t now = mstime();",
          "new_line_content": "         * a dictionary composed of just the master groups the user",
          "content_same": false
        },
        {
          "line": 2804,
          "old_api": "dictCreate",
          "new_api": null,
          "old_text": "dictCreate(&copy_keeper, NULL)",
          "new_text": null,
          "old_line_content": "            masters_local = dictCreate(&copy_keeper, NULL);",
          "new_line_content": "                sentinelRedisInstance *ri;",
          "content_same": false
        },
        {
          "line": 2808,
          "old_api": "sentinelGetMasterByName",
          "new_api": null,
          "old_text": "sentinelGetMasterByName(c->argv[i]->ptr)",
          "new_text": null,
          "old_line_content": "                ri = sentinelGetMasterByName(c->argv[i]->ptr);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2810,
          "old_api": "dictAdd",
          "new_api": null,
          "old_text": "dictAdd(masters_local, ri->name, ri)",
          "new_text": null,
          "old_line_content": "                dictAdd(masters_local, ri->name, ri);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2822,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(masters_local)",
          "new_text": null,
          "old_line_content": "        addReplyMultiBulkLen(c,dictSize(masters_local) * 2);",
          "new_line_content": "        dictEntry *de;",
          "content_same": false
        },
        {
          "line": 2830,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(ri->slaves)",
          "new_text": null,
          "old_line_content": "            addReplyMultiBulkLen(c,dictSize(ri->slaves) + 1); /* +1 for self */",
          "new_line_content": "            if (ri->info)",
          "content_same": false
        },
        {
          "line": 2832,
          "old_api": "addReplyLongLong",
          "new_api": null,
          "old_text": "addReplyLongLong(c, now - ri->info_refresh)",
          "new_text": null,
          "old_line_content": "            addReplyLongLong(c, now - ri->info_refresh);",
          "new_line_content": "            else",
          "content_same": false
        },
        {
          "line": 2834,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(ri->info)",
          "new_text": null,
          "old_line_content": "                addReplyBulkCBuffer(c,ri->info,sdslen(ri->info));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2836,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.nullbulk)",
          "new_text": null,
          "old_line_content": "                addReply(c,shared.nullbulk);",
          "new_line_content": "            dictEntry *sde;",
          "content_same": false
        },
        {
          "line": 2842,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(sde)",
          "new_text": null,
          "old_line_content": "                sentinelRedisInstance *sri = dictGetVal(sde);",
          "new_line_content": "                if (sri->info)",
          "content_same": false
        },
        {
          "line": 2844,
          "old_api": "addReplyLongLong",
          "new_api": null,
          "old_text": "addReplyLongLong(c, now - sri->info_refresh)",
          "new_text": null,
          "old_line_content": "                addReplyLongLong(c, now - sri->info_refresh);",
          "new_line_content": "                else",
          "content_same": false
        },
        {
          "line": 2846,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(sri->info)",
          "new_text": null,
          "old_line_content": "                    addReplyBulkCBuffer(c,sri->info,sdslen(sri->info));",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2848,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.nullbulk)",
          "new_text": null,
          "old_line_content": "                    addReply(c,shared.nullbulk);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2853,
          "old_api": "dictRelease",
          "new_api": null,
          "old_text": "dictRelease(masters_local)",
          "new_text": null,
          "old_line_content": "        if (masters_local != sentinel.masters) dictRelease(masters_local);",
          "new_line_content": "                               (char*)c->argv[1]->ptr);",
          "content_same": false
        },
        {
          "line": 2855,
          "old_api": "addReplyErrorFormat",
          "new_api": null,
          "old_text": "addReplyErrorFormat(c,\"Unknown sentinel subcommand '%s'\",\n                               (char*)c->argv[1]->ptr)",
          "new_text": null,
          "old_line_content": "        addReplyErrorFormat(c,\"Unknown sentinel subcommand '%s'\",",
          "new_line_content": "    return;",
          "content_same": false
        },
        {
          "line": 2861,
          "old_api": "addReplyErrorFormat",
          "new_api": null,
          "old_text": "addReplyErrorFormat(c,\"Wrong number of arguments for 'sentinel %s'\",\n                          (char*)c->argv[1]->ptr)",
          "new_text": null,
          "old_line_content": "    addReplyErrorFormat(c,\"Wrong number of arguments for 'sentinel %s'\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2868,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.syntaxerr)",
          "new_text": null,
          "old_line_content": "        addReply(c,shared.syntaxerr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2875,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"all\")",
          "new_text": null,
          "old_line_content": "        allsections = !strcasecmp(section,\"all\");",
          "new_line_content": "        defsections = 1;",
          "content_same": false
        },
        {
          "line": 2876,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"default\")",
          "new_text": null,
          "old_line_content": "        defsections = !strcasecmp(section,\"default\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2885,
          "old_api": "genRedisInfoString",
          "new_api": null,
          "old_text": "genRedisInfoString(\"server\")",
          "new_text": null,
          "old_line_content": "        sds serversection = genRedisInfoString(\"server\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2886,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(serversection)",
          "new_text": null,
          "old_line_content": "        info = sdscatlen(info,serversection,sdslen(serversection));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2890,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"sentinel\")",
          "new_text": null,
          "old_line_content": "    if (defsections || allsections || !strcasecmp(section,\"sentinel\")) {",
          "new_line_content": "        int master_id = 0;",
          "content_same": false
        },
        {
          "line": 2895,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "            \"sentinel_masters:%lu\\r\\n\"",
          "content_same": false
        },
        {
          "line": 2896,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"# Sentinel\\r\\n\"\n            \"sentinel_masters:%lu\\r\\n\"\n            \"sentinel_tilt:%d\\r\\n\"\n            \"sentinel_running_scripts:%d\\r\\n\"\n            \"sentinel_scripts_queue_length:%ld\\r\\n\",\n            dictSize(sentinel.masters),\n            sentinel.tilt,\n            sentinel.running_scripts,\n            listLength(sentinel.scripts_queue))",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "            \"sentinel_tilt:%d\\r\\n\"",
          "content_same": false
        },
        {
          "line": 2907,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(sentinel.masters)",
          "new_text": null,
          "old_line_content": "        di = dictGetIterator(sentinel.masters);",
          "new_line_content": "            char *status = \"ok\";",
          "content_same": false
        },
        {
          "line": 2908,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "        while((de = dictNext(di)) != NULL) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2909,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "            sentinelRedisInstance *ri = dictGetVal(de);",
          "new_line_content": "            if (ri->flags & SRI_O_DOWN) status = \"odown\";",
          "content_same": false
        },
        {
          "line": 2914,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                \"master%d:name=%s,status=%s,address=%s:%d,\"\n                \"slaves=%lu,sentinels=%lu\\r\\n\",\n                master_id++, ri->name, status,\n                ri->addr->ip, ri->addr->port,\n                dictSize(ri->slaves),\n                dictSize(ri->sentinels)+1)",
          "new_text": null,
          "old_line_content": "            info = sdscatprintf(info,",
          "new_line_content": "                master_id++, ri->name, status,",
          "content_same": false
        },
        {
          "line": 2920,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(ri->sentinels)",
          "new_text": null,
          "old_line_content": "                dictSize(ri->sentinels)+1);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2925,
          "old_api": "addReplyBulkSds",
          "new_api": null,
          "old_text": "addReplyBulkSds(c, info)",
          "new_text": null,
          "old_line_content": "    addReplyBulkSds(c, info);",
          "new_line_content": "/* Implements Sentinel verison of the ROLE command. The output is",
          "content_same": false
        },
        {
          "line": 2934,
          "old_api": "addReplyMultiBulkLen",
          "new_api": null,
          "old_text": "addReplyMultiBulkLen(c,2)",
          "new_text": null,
          "old_line_content": "    addReplyMultiBulkLen(c,2);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2938,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(sentinel.masters)",
          "new_text": null,
          "old_line_content": "    di = dictGetIterator(sentinel.masters);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2940,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "        sentinelRedisInstance *ri = dictGetVal(de);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2942,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,ri->name)",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,ri->name);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2944,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "    dictReleaseIterator(di);",
          "new_line_content": "/* SENTINEL SET <mastername> [<option> <value> ...] */",
          "content_same": false
        },
        {
          "line": 2953,
          "old_api": "sentinelGetMasterByNameOrReplyError",
          "new_api": null,
          "old_text": "sentinelGetMasterByNameOrReplyError(c,c->argv[2])",
          "new_text": null,
          "old_line_content": "    if ((ri = sentinelGetMasterByNameOrReplyError(c,c->argv[2]))",
          "new_line_content": "    /* Process option - value pairs. */",
          "content_same": false
        },
        {
          "line": 2963,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(option,\"down-after-milliseconds\")",
          "new_text": null,
          "old_line_content": "        if (!strcasecmp(option,\"down-after-milliseconds\")) {",
          "new_line_content": "                goto badfmt;",
          "content_same": false
        },
        {
          "line": 2968,
          "old_api": "sentinelPropagateDownAfterPeriod",
          "new_api": null,
          "old_text": "sentinelPropagateDownAfterPeriod(ri)",
          "new_text": null,
          "old_line_content": "            sentinelPropagateDownAfterPeriod(ri);",
          "new_line_content": "            /* failover-timeout <milliseconds> */",
          "content_same": false
        },
        {
          "line": 2970,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(option,\"failover-timeout\")",
          "new_text": null,
          "old_line_content": "        } else if (!strcasecmp(option,\"failover-timeout\")) {",
          "new_line_content": "                goto badfmt;",
          "content_same": false
        },
        {
          "line": 2972,
          "old_api": "getLongLongFromObject",
          "new_api": null,
          "old_text": "getLongLongFromObject(o,&ll)",
          "new_text": null,
          "old_line_content": "            if (getLongLongFromObject(o,&ll) == REDIS_ERR || ll <= 0)",
          "new_line_content": "            changes++;",
          "content_same": false
        },
        {
          "line": 2976,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(option,\"parallel-syncs\")",
          "new_text": null,
          "old_line_content": "       } else if (!strcasecmp(option,\"parallel-syncs\")) {",
          "new_line_content": "                goto badfmt;",
          "content_same": false
        },
        {
          "line": 2978,
          "old_api": "getLongLongFromObject",
          "new_api": null,
          "old_text": "getLongLongFromObject(o,&ll)",
          "new_text": null,
          "old_line_content": "            if (getLongLongFromObject(o,&ll) == REDIS_ERR || ll <= 0)",
          "new_line_content": "            changes++;",
          "content_same": false
        },
        {
          "line": 2985,
          "old_api": "addReplyError",
          "new_api": null,
          "old_text": "addReplyError(c,\n                    \"Notification script seems non existing or non executable\")",
          "new_text": null,
          "old_line_content": "                addReplyError(c,",
          "new_line_content": "                return;",
          "content_same": false
        },
        {
          "line": 2991,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(value)",
          "new_text": null,
          "old_line_content": "            ri->notification_script = strlen(value) ? sdsnew(value) : NULL;",
          "new_line_content": "            /* client-reconfig-script <path> */",
          "content_same": false
        },
        {
          "line": 2995,
          "old_api": "access",
          "new_api": null,
          "old_text": "access(value,X_OK)",
          "new_text": null,
          "old_line_content": "            if (strlen(value) && access(value,X_OK) == -1) {",
          "new_line_content": "                    \"non executable\");",
          "content_same": false
        },
        {
          "line": 3003,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(value)",
          "new_text": null,
          "old_line_content": "            ri->client_reconfig_script = strlen(value) ? sdsnew(value) : NULL;",
          "new_line_content": "            /* auth-pass <password> */",
          "content_same": false
        },
        {
          "line": 3008,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(value)",
          "new_text": null,
          "old_line_content": "            ri->auth_pass = strlen(value) ? sdsnew(value) : NULL;",
          "new_line_content": "            /* quorum <count> */",
          "content_same": false
        },
        {
          "line": 3010,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(option,\"quorum\")",
          "new_text": null,
          "old_line_content": "       } else if (!strcasecmp(option,\"quorum\")) {",
          "new_line_content": "                goto badfmt;",
          "content_same": false
        },
        {
          "line": 3012,
          "old_api": "getLongLongFromObject",
          "new_api": null,
          "old_text": "getLongLongFromObject(o,&ll)",
          "new_text": null,
          "old_line_content": "            if (getLongLongFromObject(o,&ll) == REDIS_ERR || ll <= 0)",
          "new_line_content": "            changes++;",
          "content_same": false
        },
        {
          "line": 3017,
          "old_api": "addReplyErrorFormat",
          "new_api": null,
          "old_text": "addReplyErrorFormat(c,\"Unknown option '%s' for SENTINEL SET\",\n                option)",
          "new_text": null,
          "old_line_content": "            addReplyErrorFormat(c,\"Unknown option '%s' for SENTINEL SET\",",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 3025,
          "old_api": "sentinelFlushConfig",
          "new_api": null,
          "old_text": "sentinelFlushConfig()",
          "new_text": null,
          "old_line_content": "    if (changes) sentinelFlushConfig();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3026,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.ok)",
          "new_text": null,
          "old_line_content": "    addReply(c,shared.ok);",
          "new_line_content": "badfmt: /* Bad format errors */",
          "content_same": false
        },
        {
          "line": 3030,
          "old_api": "sentinelFlushConfig",
          "new_api": null,
          "old_text": "sentinelFlushConfig()",
          "new_text": null,
          "old_line_content": "    if (changes) sentinelFlushConfig();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3031,
          "old_api": "addReplyErrorFormat",
          "new_api": null,
          "old_text": "addReplyErrorFormat(c,\"Invalid argument '%s' for SENTINEL SET '%s'\",\n            value, option)",
          "new_text": null,
          "old_line_content": "    addReplyErrorFormat(c,\"Invalid argument '%s' for SENTINEL SET '%s'\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3042,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(c->argv[1]->ptr,SENTINEL_HELLO_CHANNEL)",
          "new_text": null,
          "old_line_content": "    if (strcmp(c->argv[1]->ptr,SENTINEL_HELLO_CHANNEL)) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3046,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(c->argv[2]->ptr)",
          "new_text": null,
          "old_line_content": "    sentinelProcessHelloMessage(c->argv[2]->ptr,sdslen(c->argv[2]->ptr));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3047,
          "old_api": "addReplyLongLong",
          "new_api": null,
          "old_text": "addReplyLongLong(c,1)",
          "new_text": null,
          "old_line_content": "    addReplyLongLong(c,1);",
          "new_line_content": "/* ===================== SENTINEL availability checks ======================= */",
          "content_same": false
        },
        {
          "line": 3057,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        elapsed = mstime() - ri->last_ping_time;",
          "new_line_content": "     * links, because we are detecting low activity.",
          "content_same": false
        },
        {
          "line": 3066,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        (mstime() - ri->cc_conn_time) > SENTINEL_MIN_LINK_RECONNECT_PERIOD &&",
          "new_line_content": "         * error replies as well. */",
          "content_same": false
        },
        {
          "line": 3071,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        (mstime() - ri->last_pong_time) > (ri->down_after_period/2))",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3073,
          "old_api": "sentinelKillLink",
          "new_api": null,
          "old_text": "sentinelKillLink(ri,ri->cc)",
          "new_text": null,
          "old_line_content": "        sentinelKillLink(ri,ri->cc);",
          "new_line_content": "    /* 2) Check if the pubsub link seems connected, was connected not less",
          "content_same": false
        },
        {
          "line": 3083,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        (mstime() - ri->pc_last_activity) > (SENTINEL_PUBLISH_PERIOD*3))",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3085,
          "old_api": "sentinelKillLink",
          "new_api": null,
          "old_text": "sentinelKillLink(ri,ri->pc)",
          "new_text": null,
          "old_line_content": "        sentinelKillLink(ri,ri->pc);",
          "new_line_content": "    /* Update the SDOWN flag. We believe the instance is SDOWN if:",
          "content_same": false
        },
        {
          "line": 3097,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "         mstime() - ri->role_reported_time >",
          "new_line_content": "        /* Is subjectively down */",
          "content_same": false
        },
        {
          "line": 3102,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+sdown\",ri,\"%@\")",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_WARNING,\"+sdown\",ri,\"%@\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3103,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "            ri->s_down_since_time = mstime();",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 3109,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"-sdown\",ri,\"%@\")",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_WARNING,\"-sdown\",ri,\"%@\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3130,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(master->sentinels)",
          "new_text": null,
          "old_line_content": "        di = dictGetIterator(master->sentinels);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3131,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "        while((de = dictNext(di)) != NULL) {",
          "new_line_content": "            if (ri->flags & SRI_MASTER_DOWN) quorum++;",
          "content_same": false
        },
        {
          "line": 3132,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "            sentinelRedisInstance *ri = dictGetVal(de);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3136,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "        dictReleaseIterator(di);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3146,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "            master->o_down_since_time = mstime();",
          "new_line_content": "        if (master->flags & SRI_O_DOWN) {",
          "content_same": false
        },
        {
          "line": 3150,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"-odown\",master,\"%@\")",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_WARNING,\"-odown\",master,\"%@\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3161,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(privdata)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(privdata);",
          "new_line_content": "    if (!reply || !ri) return;",
          "content_same": false
        },
        {
          "line": 3175,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        ri->last_master_down_reply_time = mstime();",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 3184,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(ri->leader)",
          "new_text": null,
          "old_line_content": "            sdsfree(ri->leader);",
          "new_line_content": "                    \"%s voted for %s %llu\", ri->name,",
          "content_same": false
        },
        {
          "line": 3186,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\n                    \"%s voted for %s %llu\", ri->name,\n                    r->element[1]->str,\n                    (unsigned long long) r->element[2]->integer)",
          "new_text": null,
          "old_line_content": "                redisLog(REDIS_WARNING,",
          "new_line_content": "                    (unsigned long long) r->element[2]->integer);",
          "content_same": false
        },
        {
          "line": 3190,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(r->element[1]->str)",
          "new_text": null,
          "old_line_content": "            ri->leader = sdsnew(r->element[1]->str);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3206,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "    while((de = dictNext(di)) != NULL) {",
          "new_line_content": "        char port[32];",
          "content_same": false
        },
        {
          "line": 3207,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "        sentinelRedisInstance *ri = dictGetVal(de);",
          "new_line_content": "        int retval;",
          "content_same": false
        },
        {
          "line": 3208,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        mstime_t elapsed = mstime() - ri->last_master_down_reply_time;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3215,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(ri->leader)",
          "new_text": null,
          "old_line_content": "            sdsfree(ri->leader);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3227,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "            mstime() - ri->last_master_down_reply_time < SENTINEL_ASK_PERIOD)",
          "new_line_content": "        /* Ask */",
          "content_same": false
        },
        {
          "line": 3231,
          "old_api": "ll2string",
          "new_api": null,
          "old_text": "ll2string(port,sizeof(port),master->addr->port)",
          "new_text": null,
          "old_line_content": "        ll2string(port,sizeof(port),master->addr->port);",
          "new_line_content": "                    \"SENTINEL is-master-down-by-addr %s %s %llu %s\",",
          "content_same": false
        },
        {
          "line": 3232,
          "old_api": "redisAsyncCommand",
          "new_api": null,
          "old_text": "redisAsyncCommand(ri->cc,\n                    sentinelReceiveIsMasterDownReply, NULL,\n                    \"SENTINEL is-master-down-by-addr %s %s %llu %s\",\n                    master->addr->ip, port,\n                    sentinel.current_epoch,\n                    (master->failover_state > SENTINEL_FAILOVER_STATE_NONE) ?\n                    server.runid : \"*\")",
          "new_text": null,
          "old_line_content": "        retval = redisAsyncCommand(ri->cc,",
          "new_line_content": "                    master->addr->ip, port,",
          "content_same": false
        },
        {
          "line": 3241,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "    dictReleaseIterator(di);",
          "new_line_content": "/* =============================== FAILOVER ================================= */",
          "content_same": false
        },
        {
          "line": 3254,
          "old_api": "sentinelFlushConfig",
          "new_api": null,
          "old_text": "sentinelFlushConfig()",
          "new_text": null,
          "old_line_content": "        sentinelFlushConfig();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3255,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+new-epoch\",master,\"%llu\",\n            (unsigned long long) sentinel.current_epoch)",
          "new_text": null,
          "old_line_content": "        sentinelEvent(REDIS_WARNING,\"+new-epoch\",master,\"%llu\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3264,
          "old_api": "sentinelFlushConfig",
          "new_api": null,
          "old_text": "sentinelFlushConfig()",
          "new_text": null,
          "old_line_content": "        sentinelFlushConfig();",
          "new_line_content": "        /* If we did not voted for ourselves, set the master failover start",
          "content_same": false
        },
        {
          "line": 3265,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+vote-for-leader\",master,\"%s %llu\",\n            master->leader, (unsigned long long) master->leader_epoch)",
          "new_text": null,
          "old_line_content": "        sentinelEvent(REDIS_WARNING,\"+vote-for-leader\",master,\"%s %llu\",",
          "new_line_content": "         * time to now, in order to force a delay before we can start a",
          "content_same": false
        },
        {
          "line": 3270,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(master->leader,server.runid)",
          "new_text": null,
          "old_line_content": "        if (strcasecmp(master->leader,server.runid))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3271,
          "old_api": "rand",
          "new_api": null,
          "old_text": "rand()",
          "new_text": null,
          "old_line_content": "            master->failover_start_time = mstime()+rand()%SENTINEL_MAX_DESYNC;",
          "new_line_content": "    *leader_epoch = master->leader_epoch;",
          "content_same": false
        },
        {
          "line": 3275,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(master->leader)",
          "new_text": null,
          "old_line_content": "    return master->leader ? sdsnew(master->leader) : NULL;",
          "new_line_content": "struct sentinelLeader {",
          "content_same": false
        },
        {
          "line": 3286,
          "old_api": "dictFind",
          "new_api": null,
          "old_text": "dictFind(counters,runid)",
          "new_text": null,
          "old_line_content": "    dictEntry *de = dictFind(counters,runid);",
          "new_line_content": "    if (de) {",
          "content_same": false
        },
        {
          "line": 3290,
          "old_api": "dictGetUnsignedIntegerVal",
          "new_api": null,
          "old_text": "dictGetUnsignedIntegerVal(de)",
          "new_text": null,
          "old_line_content": "        oldval = dictGetUnsignedIntegerVal(de);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 3294,
          "old_api": "dictAddRaw",
          "new_api": null,
          "old_text": "dictAddRaw(counters,runid)",
          "new_text": null,
          "old_line_content": "        de = dictAddRaw(counters,runid);",
          "new_line_content": "        return 1;",
          "content_same": false
        },
        {
          "line": 3295,
          "old_api": "redisAssert",
          "new_api": null,
          "old_text": "redisAssert(de != NULL)",
          "new_text": null,
          "old_line_content": "        redisAssert(de != NULL);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3296,
          "old_api": "dictSetUnsignedIntegerVal",
          "new_api": null,
          "old_text": "dictSetUnsignedIntegerVal(de,1)",
          "new_text": null,
          "old_line_content": "        dictSetUnsignedIntegerVal(de,1);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3318,
          "old_api": "dictCreate",
          "new_api": null,
          "old_text": "dictCreate(&leaderVotesDictType,NULL)",
          "new_text": null,
          "old_line_content": "    counters = dictCreate(&leaderVotesDictType,NULL);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1275,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_NOTICE,\"+slave\",slave,\"%@\")",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_NOTICE,\"+slave\",slave,\"%@\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3323,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(master->sentinels)",
          "new_text": null,
          "old_line_content": "    di = dictGetIterator(master->sentinels);",
          "new_line_content": "        if (ri->leader != NULL && ri->leader_epoch == sentinel.current_epoch)",
          "content_same": false
        },
        {
          "line": 3325,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "        sentinelRedisInstance *ri = dictGetVal(de);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1279,
          "old_api": "zfree",
          "new_api": null,
          "old_text": "zfree(slaves)",
          "new_text": null,
          "old_line_content": "    zfree(slaves);",
          "new_line_content": "     * gets the master->addr->ip and master->addr->port as arguments. */",
          "content_same": false
        },
        {
          "line": 3327,
          "old_api": "sentinelLeaderIncr",
          "new_api": null,
          "old_text": "sentinelLeaderIncr(counters,ri->leader)",
          "new_text": null,
          "old_line_content": "            sentinelLeaderIncr(counters,ri->leader);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3329,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "    dictReleaseIterator(di);",
          "new_line_content": "     * 1) Absolute majority between voters (50% + 1).",
          "content_same": false
        },
        {
          "line": 1283,
          "old_api": "releaseSentinelAddr",
          "new_api": null,
          "old_text": "releaseSentinelAddr(oldaddr)",
          "new_text": null,
          "old_line_content": "    releaseSentinelAddr(oldaddr);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1284,
          "old_api": "sentinelFlushConfig",
          "new_api": null,
          "old_text": "sentinelFlushConfig()",
          "new_text": null,
          "old_line_content": "    sentinelFlushConfig();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3334,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(counters)",
          "new_text": null,
          "old_line_content": "    di = dictGetIterator(counters);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3335,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "    while((de = dictNext(di)) != NULL) {",
          "new_line_content": "        if (votes > max_votes) {",
          "content_same": false
        },
        {
          "line": 3336,
          "old_api": "dictGetUnsignedIntegerVal",
          "new_api": null,
          "old_text": "dictGetUnsignedIntegerVal(de)",
          "new_text": null,
          "old_line_content": "        uint64_t votes = dictGetUnsignedIntegerVal(de);",
          "new_line_content": "            max_votes = votes;",
          "content_same": false
        },
        {
          "line": 3343,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "    dictReleaseIterator(di);",
          "new_line_content": "     * if this Sentinel did not voted yet, either vote for the most",
          "content_same": false
        },
        {
          "line": 1296,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    return most_recent == 0 || (mstime() - most_recent) > ms;",
          "new_line_content": "/* Return the current master address, that is, its address or the address",
          "content_same": false
        },
        {
          "line": 3349,
          "old_api": "sentinelVoteLeader",
          "new_api": null,
          "old_text": "sentinelVoteLeader(master,epoch,winner,&leader_epoch)",
          "new_text": null,
          "old_line_content": "        myvote = sentinelVoteLeader(master,epoch,winner,&leader_epoch);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3354,
          "old_api": "sentinelLeaderIncr",
          "new_api": null,
          "old_text": "sentinelLeaderIncr(counters,myvote)",
          "new_text": null,
          "old_line_content": "        uint64_t votes = sentinelLeaderIncr(counters,myvote);",
          "new_line_content": "            max_votes = votes;",
          "content_same": false
        },
        {
          "line": 3366,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(winner)",
          "new_text": null,
          "old_line_content": "    winner = winner ? sdsnew(winner) : NULL;",
          "new_line_content": "    return winner;",
          "content_same": false
        },
        {
          "line": 3367,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(myvote)",
          "new_text": null,
          "old_line_content": "    sdsfree(myvote);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3368,
          "old_api": "dictRelease",
          "new_api": null,
          "old_text": "dictRelease(counters)",
          "new_text": null,
          "old_line_content": "    dictRelease(counters);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1326,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(d[j])",
          "new_text": null,
          "old_line_content": "        di = dictGetIterator(d[j]);",
          "new_line_content": "            ri->down_after_period = master->down_after_period;",
          "content_same": false
        },
        {
          "line": 1327,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "        while((de = dictNext(di)) != NULL) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1331,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "        dictReleaseIterator(di);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3386,
          "old_api": "ll2string",
          "new_api": null,
          "old_text": "ll2string(portstr,sizeof(portstr),port)",
          "new_text": null,
          "old_line_content": "    ll2string(portstr,sizeof(portstr),port);",
          "new_line_content": "     * into a master. */",
          "content_same": false
        },
        {
          "line": 1339,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"monitor\")",
          "new_text": null,
          "old_line_content": "    if (!strcasecmp(argv[0],\"monitor\") && argc == 5) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1344,
          "old_api": "createSentinelRedisInstance",
          "new_api": null,
          "old_text": "createSentinelRedisInstance(argv[1],SRI_MASTER,argv[2],\n                                        atoi(argv[3]),quorum,NULL)",
          "new_text": null,
          "old_line_content": "        if (createSentinelRedisInstance(argv[1],SRI_MASTER,argv[2],",
          "new_line_content": "            switch(errno) {",
          "content_same": false
        },
        {
          "line": 1345,
          "old_api": "atoi",
          "new_api": null,
          "old_text": "atoi(argv[3])",
          "new_text": null,
          "old_line_content": "                                        atoi(argv[3]),quorum,NULL) == NULL)",
          "new_line_content": "            case EBUSY: return \"Duplicated master name.\";",
          "content_same": false
        },
        {
          "line": 3392,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(portstr,\"ONE\",4)",
          "new_text": null,
          "old_line_content": "        memcpy(portstr,\"ONE\",4);",
          "new_line_content": "    /* In order to send SLAVEOF in a safe way, we send a transaction performing",
          "content_same": false
        },
        {
          "line": 1353,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"down-after-milliseconds\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(argv[0],\"down-after-milliseconds\") && argc == 3) {",
          "new_line_content": "        if (!ri) return \"No such master with specified name.\";",
          "content_same": false
        },
        {
          "line": 1355,
          "old_api": "sentinelGetMasterByName",
          "new_api": null,
          "old_text": "sentinelGetMasterByName(argv[1])",
          "new_text": null,
          "old_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "new_line_content": "        if (ri->down_after_period <= 0)",
          "content_same": false
        },
        {
          "line": 3405,
          "old_api": "redisAsyncCommand",
          "new_api": null,
          "old_text": "redisAsyncCommand(ri->cc,\n        sentinelDiscardReplyCallback, NULL, \"MULTI\")",
          "new_text": null,
          "old_line_content": "    retval = redisAsyncCommand(ri->cc,",
          "new_line_content": "    ri->pending_commands++;",
          "content_same": false
        },
        {
          "line": 1361,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"failover-timeout\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(argv[0],\"failover-timeout\") && argc == 3) {",
          "new_line_content": "        if (!ri) return \"No such master with specified name.\";",
          "content_same": false
        },
        {
          "line": 3410,
          "old_api": "redisAsyncCommand",
          "new_api": null,
          "old_text": "redisAsyncCommand(ri->cc,\n        sentinelDiscardReplyCallback, NULL, \"SLAVEOF %s %s\", host, portstr)",
          "new_text": null,
          "old_line_content": "    retval = redisAsyncCommand(ri->cc,",
          "new_line_content": "    ri->pending_commands++;",
          "content_same": false
        },
        {
          "line": 1363,
          "old_api": "sentinelGetMasterByName",
          "new_api": null,
          "old_text": "sentinelGetMasterByName(argv[1])",
          "new_text": null,
          "old_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "new_line_content": "        if (ri->failover_timeout <= 0)",
          "content_same": false
        },
        {
          "line": 3415,
          "old_api": "redisAsyncCommand",
          "new_api": null,
          "old_text": "redisAsyncCommand(ri->cc,\n        sentinelDiscardReplyCallback, NULL, \"CONFIG REWRITE\")",
          "new_text": null,
          "old_line_content": "    retval = redisAsyncCommand(ri->cc,",
          "new_line_content": "    ri->pending_commands++;",
          "content_same": false
        },
        {
          "line": 1368,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"parallel-syncs\")",
          "new_text": null,
          "old_line_content": "   } else if (!strcasecmp(argv[0],\"parallel-syncs\") && argc == 3) {",
          "new_line_content": "        if (!ri) return \"No such master with specified name.\";",
          "content_same": false
        },
        {
          "line": 1373,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"notification-script\")",
          "new_text": null,
          "old_line_content": "   } else if (!strcasecmp(argv[0],\"notification-script\") && argc == 3) {",
          "new_line_content": "        if (!ri) return \"No such master with specified name.\";",
          "content_same": false
        },
        {
          "line": 1375,
          "old_api": "sentinelGetMasterByName",
          "new_api": null,
          "old_text": "sentinelGetMasterByName(argv[1])",
          "new_text": null,
          "old_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "new_line_content": "            return \"Notification script seems non existing or non executable.\";",
          "content_same": false
        },
        {
          "line": 3425,
          "old_api": "redisAsyncCommand",
          "new_api": null,
          "old_text": "redisAsyncCommand(ri->cc,\n        sentinelDiscardReplyCallback, NULL, \"CLIENT KILL TYPE normal\")",
          "new_text": null,
          "old_line_content": "    retval = redisAsyncCommand(ri->cc,",
          "new_line_content": "    ri->pending_commands++;",
          "content_same": false
        },
        {
          "line": 1380,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"client-reconfig-script\")",
          "new_text": null,
          "old_line_content": "   } else if (!strcasecmp(argv[0],\"client-reconfig-script\") && argc == 3) {",
          "new_line_content": "        if (!ri) return \"No such master with specified name.\";",
          "content_same": false
        },
        {
          "line": 1382,
          "old_api": "sentinelGetMasterByName",
          "new_api": null,
          "old_text": "sentinelGetMasterByName(argv[1])",
          "new_text": null,
          "old_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "new_line_content": "            return \"Client reconfiguration script seems non existing or \"",
          "content_same": false
        },
        {
          "line": 3430,
          "old_api": "redisAsyncCommand",
          "new_api": null,
          "old_text": "redisAsyncCommand(ri->cc,\n        sentinelDiscardReplyCallback, NULL, \"EXEC\")",
          "new_text": null,
          "old_line_content": "    retval = redisAsyncCommand(ri->cc,",
          "new_line_content": "    ri->pending_commands++;",
          "content_same": false
        },
        {
          "line": 1388,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"auth-pass\")",
          "new_text": null,
          "old_line_content": "   } else if (!strcasecmp(argv[0],\"auth-pass\") && argc == 3) {",
          "new_line_content": "        if (!ri) return \"No such master with specified name.\";",
          "content_same": false
        },
        {
          "line": 3440,
          "old_api": "redisAssert",
          "new_api": null,
          "old_text": "redisAssert(master->flags & SRI_MASTER)",
          "new_text": null,
          "old_line_content": "    redisAssert(master->flags & SRI_MASTER);",
          "new_line_content": "    master->flags |= SRI_FAILOVER_IN_PROGRESS;",
          "content_same": false
        },
        {
          "line": 1393,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"current-epoch\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(argv[0],\"current-epoch\") && argc == 2) {",
          "new_line_content": "        if (current_epoch > sentinel.current_epoch)",
          "content_same": false
        },
        {
          "line": 1398,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"config-epoch\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(argv[0],\"config-epoch\") && argc == 3) {",
          "new_line_content": "        if (!ri) return \"No such master with specified name.\";",
          "content_same": false
        },
        {
          "line": 3447,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+try-failover\",master,\"%@\")",
          "new_text": null,
          "old_line_content": "    sentinelEvent(REDIS_WARNING,\"+try-failover\",master,\"%@\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1400,
          "old_api": "sentinelGetMasterByName",
          "new_api": null,
          "old_text": "sentinelGetMasterByName(argv[1])",
          "new_text": null,
          "old_line_content": "        ri = sentinelGetMasterByName(argv[1]);",
          "new_line_content": "        /* The following update of current_epoch is not really useful as",
          "content_same": false
        },
        {
          "line": 3448,
          "old_api": "rand",
          "new_api": null,
          "old_text": "rand()",
          "new_text": null,
          "old_line_content": "    master->failover_start_time = mstime()+rand()%SENTINEL_MAX_DESYNC;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1402,
          "old_api": "strtoull",
          "new_api": null,
          "old_text": "strtoull(argv[2],NULL,10)",
          "new_text": null,
          "old_line_content": "        ri->config_epoch = strtoull(argv[2],NULL,10);",
          "new_line_content": "         * we leave this check here for redundancy. */",
          "content_same": false
        },
        {
          "line": 3449,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    master->failover_state_change_time = mstime();",
          "new_line_content": "/* This function checks if there are the conditions to start the failover,",
          "content_same": false
        },
        {
          "line": 1408,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"leader-epoch\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(argv[0],\"leader-epoch\") && argc == 3) {",
          "new_line_content": "        if (!ri) return \"No such master with specified name.\";",
          "content_same": false
        },
        {
          "line": 1412,
          "old_api": "strtoull",
          "new_api": null,
          "old_text": "strtoull(argv[2],NULL,10)",
          "new_text": null,
          "old_line_content": "        ri->leader_epoch = strtoull(argv[2],NULL,10);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1413,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"known-slave\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(argv[0],\"known-slave\") && argc == 4) {",
          "new_line_content": "        /* known-slave <name> <ip> <port> */",
          "content_same": false
        },
        {
          "line": 1419,
          "old_api": "createSentinelRedisInstance",
          "new_api": null,
          "old_text": "createSentinelRedisInstance(NULL,SRI_SLAVE,argv[2],\n                    atoi(argv[3]), ri->quorum, ri)",
          "new_text": null,
          "old_line_content": "        if ((slave = createSentinelRedisInstance(NULL,SRI_SLAVE,argv[2],",
          "new_line_content": "            return \"Wrong hostname or port for slave.\";",
          "content_same": false
        },
        {
          "line": 1420,
          "old_api": "atoi",
          "new_api": null,
          "old_text": "atoi(argv[3])",
          "new_text": null,
          "old_line_content": "                    atoi(argv[3]), ri->quorum, ri)) == NULL)",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3471,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    if (mstime() - master->failover_start_time <",
          "new_line_content": "        if (master->failover_delay_logged != master->failover_start_time) {",
          "content_same": false
        },
        {
          "line": 1424,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"known-sentinel\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(argv[0],\"known-sentinel\") &&",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1431,
          "old_api": "createSentinelRedisInstance",
          "new_api": null,
          "old_text": "createSentinelRedisInstance(NULL,SRI_SENTINEL,argv[2],\n                    atoi(argv[3]), ri->quorum, ri)",
          "new_text": null,
          "old_line_content": "        if ((si = createSentinelRedisInstance(NULL,SRI_SENTINEL,argv[2],",
          "new_line_content": "            return \"Wrong hostname or port for sentinel.\";",
          "content_same": false
        },
        {
          "line": 1432,
          "old_api": "atoi",
          "new_api": null,
          "old_text": "atoi(argv[3])",
          "new_text": null,
          "old_line_content": "                    atoi(argv[3]), ri->quorum, ri)) == NULL)",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3482,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\n                \"Next failover delay: I will not start a failover before %s\",\n                ctimebuf)",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_WARNING,",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1439,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(argv[1])",
          "new_text": null,
          "old_line_content": "        if (strlen(argv[1]))",
          "new_line_content": "        /* announce-port <port> */",
          "content_same": false
        },
        {
          "line": 1441,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"announce-port\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(argv[0],\"announce-port\") && argc == 2) {",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 3489,
          "old_api": "sentinelStartFailover",
          "new_api": null,
          "old_text": "sentinelStartFailover(master)",
          "new_text": null,
          "old_line_content": "    sentinelStartFailover(master);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1443,
          "old_api": "atoi",
          "new_api": null,
          "old_text": "atoi(argv[1])",
          "new_text": null,
          "old_line_content": "        sentinel.announce_port = atoi(argv[1]);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1461,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(sentinel.masters)",
          "new_text": null,
          "old_line_content": "    di = dictGetIterator(sentinel.masters);",
          "new_line_content": "        sentinelAddr *master_addr;",
          "content_same": false
        },
        {
          "line": 1462,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "    while((de = dictNext(di)) != NULL) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1467,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "        master = dictGetVal(de);",
          "new_line_content": "            master->name, master_addr->ip, master_addr->port,",
          "content_same": false
        },
        {
          "line": 1468,
          "old_api": "sentinelGetCurrentMasterAddress",
          "new_api": null,
          "old_text": "sentinelGetCurrentMasterAddress(master)",
          "new_text": null,
          "old_line_content": "        master_addr = sentinelGetCurrentMasterAddress(master);",
          "new_line_content": "            master->quorum);",
          "content_same": false
        },
        {
          "line": 1472,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": null,
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": null,
          "old_line_content": "        rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "        if (master->down_after_period != SENTINEL_DEFAULT_DOWN_AFTER) {",
          "content_same": false
        },
        {
          "line": 1479,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": null,
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": null,
          "old_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "        /* sentinel failover-timeout */",
          "content_same": false
        },
        {
          "line": 1487,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": null,
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": null,
          "old_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "        /* sentinel parallel-syncs */",
          "content_same": false
        },
        {
          "line": 1495,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": null,
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": null,
          "old_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "        /* sentinel notification-script */",
          "content_same": false
        },
        {
          "line": 3550,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(sa_runid, sb_runid)",
          "new_text": null,
          "old_line_content": "    return strcasecmp(sa_runid, sb_runid);",
          "new_line_content": "sentinelRedisInstance *sentinelSelectSlave(sentinelRedisInstance *master) {",
          "content_same": false
        },
        {
          "line": 1503,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": null,
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": null,
          "old_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "        /* sentinel client-reconfig-script */",
          "content_same": false
        },
        {
          "line": 3555,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(master->slaves)",
          "new_text": null,
          "old_line_content": "        zmalloc(sizeof(instance[0])*dictSize(master->slaves));",
          "new_line_content": "    dictIterator *di;",
          "content_same": false
        },
        {
          "line": 1511,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": null,
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": null,
          "old_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "        /* sentinel auth-pass */",
          "content_same": false
        },
        {
          "line": 3566,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(master->slaves)",
          "new_text": null,
          "old_line_content": "    di = dictGetIterator(master->slaves);",
          "new_line_content": "        mstime_t info_validity_time;",
          "content_same": false
        },
        {
          "line": 1519,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": null,
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": null,
          "old_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "        /* sentinel config-epoch */",
          "content_same": false
        },
        {
          "line": 3567,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "    while((de = dictNext(di)) != NULL) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3568,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "        sentinelRedisInstance *slave = dictGetVal(de);",
          "new_line_content": "        if (slave->flags & (SRI_S_DOWN|SRI_O_DOWN|SRI_DISCONNECTED)) continue;",
          "content_same": false
        },
        {
          "line": 3572,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        if (mstime() - slave->last_avail_time > SENTINEL_PING_PERIOD*5) continue;",
          "new_line_content": "        /* If the master is in SDOWN state we get INFO for slaves every second.",
          "content_same": false
        },
        {
          "line": 3582,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        if (mstime() - slave->info_refresh > info_validity_time) continue;",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1535,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(master->slaves)",
          "new_text": null,
          "old_line_content": "        di2 = dictGetIterator(master->slaves);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3586,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "    dictReleaseIterator(di);",
          "new_line_content": "            compareSlavesForPromotion);",
          "content_same": false
        },
        {
          "line": 1539,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "            ri = dictGetVal(de);",
          "new_line_content": "            /* If master_addr (obtained using sentinelGetCurrentMasterAddress()",
          "content_same": false
        },
        {
          "line": 3588,
          "old_api": "qsort",
          "new_api": null,
          "old_text": "qsort(instance,instances,sizeof(sentinelRedisInstance*),\n            compareSlavesForPromotion)",
          "new_text": null,
          "old_line_content": "        qsort(instance,instances,sizeof(sentinelRedisInstance*),",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3592,
          "old_api": "zfree",
          "new_api": null,
          "old_text": "zfree(instance)",
          "new_text": null,
          "old_line_content": "    zfree(instance);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1547,
          "old_api": "sentinelAddrIsEqual",
          "new_api": null,
          "old_text": "sentinelAddrIsEqual(slave_addr,master_addr)",
          "new_text": null,
          "old_line_content": "            if (sentinelAddrIsEqual(slave_addr,master_addr))",
          "new_line_content": "                \"sentinel known-slave %s %s %d\",",
          "content_same": false
        },
        {
          "line": 1552,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": null,
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": null,
          "old_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3602,
          "old_api": "sentinelGetLeader",
          "new_api": null,
          "old_text": "sentinelGetLeader(ri, ri->failover_epoch)",
          "new_text": null,
          "old_line_content": "    leader = sentinelGetLeader(ri, ri->failover_epoch);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3603,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(leader,server.runid)",
          "new_text": null,
          "old_line_content": "    isleader = leader && strcasecmp(leader,server.runid) == 0;",
          "new_line_content": "    /* If I'm not the leader, and it is not a forced failover via",
          "content_same": false
        },
        {
          "line": 3604,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(leader)",
          "new_text": null,
          "old_line_content": "    sdsfree(leader);",
          "new_line_content": "     * SENTINEL FAILOVER, then I can't continue with the failover. */",
          "content_same": false
        },
        {
          "line": 1558,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di2)",
          "new_text": null,
          "old_line_content": "        while((de = dictNext(di2)) != NULL) {",
          "new_line_content": "                \"sentinel known-sentinel %s %s %d%s%s\",",
          "content_same": false
        },
        {
          "line": 1559,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "            ri = dictGetVal(de);",
          "new_line_content": "                master->name, ri->addr->ip, ri->addr->port,",
          "content_same": false
        },
        {
          "line": 1560,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "            line = sdscatprintf(sdsempty(),",
          "new_line_content": "                ri->runid ? \" \" : \"\",",
          "content_same": false
        },
        {
          "line": 1565,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": null,
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": null,
          "old_line_content": "            rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1567,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di2)",
          "new_text": null,
          "old_line_content": "        dictReleaseIterator(di2);",
          "new_line_content": "    /* sentinel current-epoch is a global state valid for all the masters. */",
          "content_same": false
        },
        {
          "line": 3616,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        if (mstime() - ri->failover_start_time > election_timeout) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3617,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"-failover-abort-not-elected\",ri,\"%@\")",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_WARNING,\"-failover-abort-not-elected\",ri,\"%@\");",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 3618,
          "old_api": "sentinelAbortFailover",
          "new_api": null,
          "old_text": "sentinelAbortFailover(ri)",
          "new_text": null,
          "old_line_content": "            sentinelAbortFailover(ri);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1571,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "    line = sdscatprintf(sdsempty(),",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1573,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": null,
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": null,
          "old_line_content": "    rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "    if (sentinel.announce_ip) {",
          "content_same": false
        },
        {
          "line": 3624,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    ri->failover_state_change_time = mstime();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1577,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(\"sentinel announce-ip \")",
          "new_text": null,
          "old_line_content": "        line = sdsnew(\"sentinel announce-ip \");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1578,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(sentinel.announce_ip)",
          "new_text": null,
          "old_line_content": "        line = sdscatrepr(line, sentinel.announce_ip, sdslen(sentinel.announce_ip));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1579,
          "old_api": "rewriteConfigRewriteLine",
          "new_api": null,
          "old_text": "rewriteConfigRewriteLine(state,\"sentinel\",line,1)",
          "new_text": null,
          "old_line_content": "        rewriteConfigRewriteLine(state,\"sentinel\",line,1);",
          "new_line_content": "    /* sentinel announce-port. */",
          "content_same": false
        },
        {
          "line": 3625,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+failover-state-select-slave\",ri,\"%@\")",
          "new_text": null,
          "old_line_content": "    sentinelEvent(REDIS_WARNING,\"+failover-state-select-slave\",ri,\"%@\");",
          "new_line_content": "void sentinelFailoverSelectSlave(sentinelRedisInstance *ri) {",
          "content_same": false
        },
        {
          "line": 3629,
          "old_api": "sentinelSelectSlave",
          "new_api": null,
          "old_text": "sentinelSelectSlave(ri)",
          "new_text": null,
          "old_line_content": "    sentinelRedisInstance *slave = sentinelSelectSlave(ri);",
          "new_line_content": "     * the failover or go forward in the next state. */",
          "content_same": false
        },
        {
          "line": 1584,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "        line = sdscatprintf(sdsempty(),\"sentinel announce-port %d\",",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3635,
          "old_api": "sentinelAbortFailover",
          "new_api": null,
          "old_text": "sentinelAbortFailover(ri)",
          "new_text": null,
          "old_line_content": "        sentinelAbortFailover(ri);",
          "new_line_content": "        slave->flags |= SRI_PROMOTED;",
          "content_same": false
        },
        {
          "line": 1589,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "    dictReleaseIterator(di);",
          "new_line_content": "/* This function uses the config rewriting Redis engine in order to persist",
          "content_same": false
        },
        {
          "line": 3637,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+selected-slave\",slave,\"%@\")",
          "new_text": null,
          "old_line_content": "        sentinelEvent(REDIS_WARNING,\"+selected-slave\",slave,\"%@\");",
          "new_line_content": "        ri->failover_state = SENTINEL_FAILOVER_STATE_SEND_SLAVEOF_NOONE;",
          "content_same": false
        },
        {
          "line": 3641,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        ri->failover_state_change_time = mstime();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3642,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_NOTICE,\"+failover-state-send-slaveof-noone\",\n            slave, \"%@\")",
          "new_text": null,
          "old_line_content": "        sentinelEvent(REDIS_NOTICE,\"+failover-state-send-slaveof-noone\",",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1605,
          "old_api": "rewriteConfig",
          "new_api": null,
          "old_text": "rewriteConfig(server.configfile)",
          "new_text": null,
          "old_line_content": "    rewrite_status = rewriteConfig(server.configfile);",
          "new_line_content": "    if (rewrite_status == -1) goto werr;",
          "content_same": false
        },
        {
          "line": 3654,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        if (mstime() - ri->failover_state_change_time > ri->failover_timeout) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3655,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"-failover-abort-slave-timeout\",ri,\"%@\")",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_WARNING,\"-failover-abort-slave-timeout\",ri,\"%@\");",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 3656,
          "old_api": "sentinelAbortFailover",
          "new_api": null,
          "old_text": "sentinelAbortFailover(ri)",
          "new_text": null,
          "old_line_content": "            sentinelAbortFailover(ri);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1609,
          "old_api": "open",
          "new_api": null,
          "old_text": "open(server.configfile,O_RDONLY)",
          "new_text": null,
          "old_line_content": "    if ((fd = open(server.configfile,O_RDONLY)) == -1) goto werr;",
          "new_line_content": "    return;",
          "content_same": false
        },
        {
          "line": 1610,
          "old_api": "fsync",
          "new_api": null,
          "old_text": "fsync(fd)",
          "new_text": null,
          "old_line_content": "    if (fsync(fd) == -1) goto werr;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1611,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fd)",
          "new_text": null,
          "old_line_content": "    if (close(fd) == EOF) goto werr;",
          "new_line_content": "werr:",
          "content_same": false
        },
        {
          "line": 1615,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fd)",
          "new_text": null,
          "old_line_content": "    if (fd != -1) close(fd);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1616,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "    redisLog(REDIS_WARNING,\"WARNING: Sentinel was not able to save the new configuration on disk!!!: %s\", strerror(errno));",
          "new_line_content": "/* ====================== hiredis connection handling ======================= */",
          "content_same": false
        },
        {
          "line": 3665,
          "old_api": "sentinelSendSlaveOf",
          "new_api": null,
          "old_text": "sentinelSendSlaveOf(ri->promoted_slave,NULL,0)",
          "new_text": null,
          "old_line_content": "    retval = sentinelSendSlaveOf(ri->promoted_slave,NULL,0);",
          "new_line_content": "        ri->promoted_slave,\"%@\");",
          "content_same": false
        },
        {
          "line": 3670,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    ri->failover_state_change_time = mstime();",
          "new_line_content": "/* We actually wait for promotion indirectly checking with INFO when the",
          "content_same": false
        },
        {
          "line": 1630,
          "old_api": "redisAsyncFree",
          "new_api": null,
          "old_text": "redisAsyncFree(c)",
          "new_text": null,
          "old_line_content": "    redisAsyncFree(c);",
          "new_line_content": "/* This function takes a hiredis context that is in an error condition",
          "content_same": false
        },
        {
          "line": 3678,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    if (mstime() - ri->failover_state_change_time > ri->failover_timeout) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3679,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"-failover-abort-slave-timeout\",ri,\"%@\")",
          "new_text": null,
          "old_line_content": "        sentinelEvent(REDIS_WARNING,\"-failover-abort-slave-timeout\",ri,\"%@\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3680,
          "old_api": "sentinelAbortFailover",
          "new_api": null,
          "old_text": "sentinelAbortFailover(ri)",
          "new_text": null,
          "old_line_content": "        sentinelAbortFailover(ri);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3688,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    mstime_t elapsed = mstime() - master->failover_state_change_time;",
          "new_line_content": "     * not reachable. */",
          "content_same": false
        },
        {
          "line": 1646,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_DEBUG, pubsub ? \"-pubsub-link\" : \"-cmd-link\", ri,\n        \"%@ #%s\", c->errstr)",
          "new_text": null,
          "old_line_content": "    sentinelEvent(REDIS_DEBUG, pubsub ? \"-pubsub-link\" : \"-cmd-link\", ri,",
          "new_line_content": "        ri->pc = NULL;",
          "content_same": false
        },
        {
          "line": 3697,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(master->slaves)",
          "new_text": null,
          "old_line_content": "    di = dictGetIterator(master->slaves);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3698,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "    while((de = dictNext(di)) != NULL) {",
          "new_line_content": "        if (slave->flags & (SRI_PROMOTED|SRI_RECONF_DONE)) continue;",
          "content_same": false
        },
        {
          "line": 3699,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "        sentinelRedisInstance *slave = dictGetVal(de);",
          "new_line_content": "        if (slave->flags & SRI_S_DOWN) continue;",
          "content_same": false
        },
        {
          "line": 1657,
          "old_api": "sentinelDisconnectInstanceFromContext",
          "new_api": null,
          "old_text": "sentinelDisconnectInstanceFromContext(c)",
          "new_text": null,
          "old_line_content": "        sentinelDisconnectInstanceFromContext(c);",
          "new_line_content": "        int pubsub = (ri->pc == c);",
          "content_same": false
        },
        {
          "line": 3705,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "    dictReleaseIterator(di);",
          "new_line_content": "    if (elapsed > master->failover_timeout) {",
          "content_same": false
        },
        {
          "line": 1662,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_DEBUG, pubsub ? \"+pubsub-link\" : \"+cmd-link\", ri,\n            \"%@\")",
          "new_text": null,
          "old_line_content": "        sentinelEvent(REDIS_DEBUG, pubsub ? \"+pubsub-link\" : \"+cmd-link\", ri,",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3711,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+failover-end-for-timeout\",master,\"%@\")",
          "new_text": null,
          "old_line_content": "        sentinelEvent(REDIS_WARNING,\"+failover-end-for-timeout\",master,\"%@\");",
          "new_line_content": "    if (not_reconfigured == 0) {",
          "content_same": false
        },
        {
          "line": 3715,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+failover-end\",master,\"%@\")",
          "new_text": null,
          "old_line_content": "        sentinelEvent(REDIS_WARNING,\"+failover-end\",master,\"%@\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1668,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(status)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(status);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1669,
          "old_api": "sentinelDisconnectInstanceFromContext",
          "new_api": null,
          "old_text": "sentinelDisconnectInstanceFromContext(c)",
          "new_text": null,
          "old_line_content": "    sentinelDisconnectInstanceFromContext(c);",
          "new_line_content": "/* Send the AUTH command with the specified master password if needed.",
          "content_same": false
        },
        {
          "line": 3717,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        master->failover_state_change_time = mstime();",
          "new_line_content": "    /* If I'm the leader it is a good idea to send a best effort SLAVEOF",
          "content_same": false
        },
        {
          "line": 3727,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(master->slaves)",
          "new_text": null,
          "old_line_content": "        di = dictGetIterator(master->slaves);",
          "new_line_content": "            int retval;",
          "content_same": false
        },
        {
          "line": 3728,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "        while((de = dictNext(di)) != NULL) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3729,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "            sentinelRedisInstance *slave = dictGetVal(de);",
          "new_line_content": "            if (slave->flags &",
          "content_same": false
        },
        {
          "line": 1683,
          "old_api": "redisAsyncCommand",
          "new_api": null,
          "old_text": "redisAsyncCommand(c, sentinelDiscardReplyCallback, NULL, \"AUTH %s\",\n            auth_pass)",
          "new_text": null,
          "old_line_content": "        if (redisAsyncCommand(c, sentinelDiscardReplyCallback, NULL, \"AUTH %s\",",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3735,
          "old_api": "sentinelSendSlaveOf",
          "new_api": null,
          "old_text": "sentinelSendSlaveOf(slave,\n                    master->promoted_slave->addr->ip,\n                    master->promoted_slave->addr->port)",
          "new_text": null,
          "old_line_content": "            retval = sentinelSendSlaveOf(slave,",
          "new_line_content": "            if (retval == REDIS_OK) {",
          "content_same": false
        },
        {
          "line": 3739,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_NOTICE,\"+slave-reconf-sent-be\",slave,\"%@\")",
          "new_text": null,
          "old_line_content": "                sentinelEvent(REDIS_NOTICE,\"+slave-reconf-sent-be\",slave,\"%@\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3743,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "        dictReleaseIterator(di);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1697,
          "old_api": "snprintf",
          "new_api": null,
          "old_text": "snprintf(name,sizeof(name),\"sentinel-%.8s-%s\",server.runid,type)",
          "new_text": null,
          "old_line_content": "    snprintf(name,sizeof(name),\"sentinel-%.8s-%s\",server.runid,type);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 1698,
          "old_api": "redisAsyncCommand",
          "new_api": null,
          "old_text": "redisAsyncCommand(c, sentinelDiscardReplyCallback, NULL,\n        \"CLIENT SETNAME %s\", name)",
          "new_text": null,
          "old_line_content": "    if (redisAsyncCommand(c, sentinelDiscardReplyCallback, NULL,",
          "new_line_content": "        ri->pending_commands++;",
          "content_same": false
        },
        {
          "line": 3754,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(master->slaves)",
          "new_text": null,
          "old_line_content": "    di = dictGetIterator(master->slaves);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3755,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "    while((de = dictNext(di)) != NULL) {",
          "new_line_content": "        if (slave->flags & (SRI_RECONF_SENT|SRI_RECONF_INPROG))",
          "content_same": false
        },
        {
          "line": 3756,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "        sentinelRedisInstance *slave = dictGetVal(de);",
          "new_line_content": "            in_progress++;",
          "content_same": false
        },
        {
          "line": 1713,
          "old_api": "redisAsyncConnectBind",
          "new_api": null,
          "old_text": "redisAsyncConnectBind(ri->addr->ip,ri->addr->port,REDIS_BIND_ADDR)",
          "new_text": null,
          "old_line_content": "        ri->cc = redisAsyncConnectBind(ri->addr->ip,ri->addr->port,REDIS_BIND_ADDR);",
          "new_line_content": "                ri->cc->errstr);",
          "content_same": false
        },
        {
          "line": 3761,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "    dictReleaseIterator(di);",
          "new_line_content": "    while(in_progress < master->parallel_syncs &&",
          "content_same": false
        },
        {
          "line": 1715,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_DEBUG,\"-cmd-link-reconnection\",ri,\"%@ #%s\",\n                ri->cc->errstr)",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_DEBUG,\"-cmd-link-reconnection\",ri,\"%@ #%s\",",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 3763,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(master->slaves)",
          "new_text": null,
          "old_line_content": "    di = dictGetIterator(master->slaves);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 1717,
          "old_api": "sentinelKillLink",
          "new_api": null,
          "old_text": "sentinelKillLink(ri,ri->cc)",
          "new_text": null,
          "old_line_content": "            sentinelKillLink(ri,ri->cc);",
          "new_line_content": "            ri->cc->data = ri;",
          "content_same": false
        },
        {
          "line": 3765,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "          (de = dictNext(di)) != NULL)",
          "new_line_content": "        int retval;",
          "content_same": false
        },
        {
          "line": 3767,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "        sentinelRedisInstance *slave = dictGetVal(de);",
          "new_line_content": "        /* Skip the promoted slave, and already configured slaves. */",
          "content_same": false
        },
        {
          "line": 1722,
          "old_api": "redisAsyncSetConnectCallback",
          "new_api": null,
          "old_text": "redisAsyncSetConnectCallback(ri->cc,\n                                            sentinelLinkEstablishedCallback)",
          "new_text": null,
          "old_line_content": "            redisAsyncSetConnectCallback(ri->cc,",
          "new_line_content": "                                            sentinelDisconnectCallback);",
          "content_same": false
        },
        {
          "line": 1726,
          "old_api": "sentinelSendAuthIfNeeded",
          "new_api": null,
          "old_text": "sentinelSendAuthIfNeeded(ri,ri->cc)",
          "new_text": null,
          "old_line_content": "            sentinelSendAuthIfNeeded(ri,ri->cc);",
          "new_line_content": "            /* Send a PING ASAP when reconnecting. */",
          "content_same": false
        },
        {
          "line": 1730,
          "old_api": "sentinelSendPing",
          "new_api": null,
          "old_text": "sentinelSendPing(ri)",
          "new_text": null,
          "old_line_content": "            sentinelSendPing(ri);",
          "new_line_content": "    /* Pub / Sub */",
          "content_same": false
        },
        {
          "line": 3781,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_NOTICE,\"-slave-reconf-sent-timeout\",slave,\"%@\")",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_NOTICE,\"-slave-reconf-sent-timeout\",slave,\"%@\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1735,
          "old_api": "redisAsyncConnectBind",
          "new_api": null,
          "old_text": "redisAsyncConnectBind(ri->addr->ip,ri->addr->port,REDIS_BIND_ADDR)",
          "new_text": null,
          "old_line_content": "        ri->pc = redisAsyncConnectBind(ri->addr->ip,ri->addr->port,REDIS_BIND_ADDR);",
          "new_line_content": "                ri->pc->errstr);",
          "content_same": false
        },
        {
          "line": 1737,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_DEBUG,\"-pubsub-link-reconnection\",ri,\"%@ #%s\",\n                ri->pc->errstr)",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_DEBUG,\"-pubsub-link-reconnection\",ri,\"%@ #%s\",",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 1739,
          "old_api": "sentinelKillLink",
          "new_api": null,
          "old_text": "sentinelKillLink(ri,ri->pc)",
          "new_text": null,
          "old_line_content": "            sentinelKillLink(ri,ri->pc);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3792,
          "old_api": "sentinelSendSlaveOf",
          "new_api": null,
          "old_text": "sentinelSendSlaveOf(slave,\n                master->promoted_slave->addr->ip,\n                master->promoted_slave->addr->port)",
          "new_text": null,
          "old_line_content": "        retval = sentinelSendSlaveOf(slave,",
          "new_line_content": "        if (retval == REDIS_OK) {",
          "content_same": false
        },
        {
          "line": 1746,
          "old_api": "redisAsyncSetConnectCallback",
          "new_api": null,
          "old_text": "redisAsyncSetConnectCallback(ri->pc,\n                                            sentinelLinkEstablishedCallback)",
          "new_text": null,
          "old_line_content": "            redisAsyncSetConnectCallback(ri->pc,",
          "new_line_content": "                                            sentinelDisconnectCallback);",
          "content_same": false
        },
        {
          "line": 3797,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "            slave->slave_reconf_sent_time = mstime();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3798,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_NOTICE,\"+slave-reconf-sent\",slave,\"%@\")",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_NOTICE,\"+slave-reconf-sent\",slave,\"%@\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1751,
          "old_api": "sentinelSetClientName",
          "new_api": null,
          "old_text": "sentinelSetClientName(ri,ri->pc,\"pubsub\")",
          "new_text": null,
          "old_line_content": "            sentinelSetClientName(ri,ri->pc,\"pubsub\");",
          "new_line_content": "                sentinelReceiveHelloMessages, NULL, \"SUBSCRIBE %s\",",
          "content_same": false
        },
        {
          "line": 1753,
          "old_api": "redisAsyncCommand",
          "new_api": null,
          "old_text": "redisAsyncCommand(ri->pc,\n                sentinelReceiveHelloMessages, NULL, \"SUBSCRIBE %s\",\n                    SENTINEL_HELLO_CHANNEL)",
          "new_text": null,
          "old_line_content": "            retval = redisAsyncCommand(ri->pc,",
          "new_line_content": "            if (retval != REDIS_OK) {",
          "content_same": false
        },
        {
          "line": 3805,
          "old_api": "sentinelFailoverDetectEnd",
          "new_api": null,
          "old_text": "sentinelFailoverDetectEnd(master)",
          "new_text": null,
          "old_line_content": "    sentinelFailoverDetectEnd(master);",
          "new_line_content": "/* This function is called when the slave is in",
          "content_same": false
        },
        {
          "line": 1759,
          "old_api": "sentinelKillLink",
          "new_api": null,
          "old_text": "sentinelKillLink(ri,ri->pc)",
          "new_text": null,
          "old_line_content": "                sentinelKillLink(ri,ri->pc);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3815,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+switch-master\",master,\"%s %s %d %s %d\",\n        master->name, master->addr->ip, master->addr->port,\n        ref->addr->ip, ref->addr->port)",
          "new_text": null,
          "old_line_content": "    sentinelEvent(REDIS_WARNING,\"+switch-master\",master,\"%s %s %d %s %d\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3819,
          "old_api": "sentinelResetMasterAndChangeAddress",
          "new_api": null,
          "old_text": "sentinelResetMasterAndChangeAddress(master,ref->addr->ip,ref->addr->port)",
          "new_text": null,
          "old_line_content": "    sentinelResetMasterAndChangeAddress(master,ref->addr->ip,ref->addr->port);",
          "new_line_content": "void sentinelFailoverStateMachine(sentinelRedisInstance *ri) {",
          "content_same": false
        },
        {
          "line": 3823,
          "old_api": "redisAssert",
          "new_api": null,
          "old_text": "redisAssert(ri->flags & SRI_MASTER)",
          "new_text": null,
          "old_line_content": "    redisAssert(ri->flags & SRI_MASTER);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1782,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        (mstime() - master->info_refresh) < SENTINEL_INFO_PERIOD*2;",
          "new_line_content": "/* Process the INFO output from masters. */",
          "content_same": false
        },
        {
          "line": 1792,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(ri->info)",
          "new_text": null,
          "old_line_content": "    sdsfree(ri->info);",
          "new_line_content": "    /* The following fields must be reset to a given value in the case they",
          "content_same": false
        },
        {
          "line": 1793,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(info)",
          "new_text": null,
          "old_line_content": "    ri->info = sdsnew(info);",
          "new_line_content": "     * are not found at all in the INFO output. */",
          "content_same": false
        },
        {
          "line": 3841,
          "old_api": "sentinelFailoverReconfNextSlave",
          "new_api": null,
          "old_text": "sentinelFailoverReconfNextSlave(ri)",
          "new_text": null,
          "old_line_content": "            sentinelFailoverReconfNextSlave(ri);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1800,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(info)",
          "new_text": null,
          "old_line_content": "    lines = sdssplitlen(info,strlen(info),\"\\r\\n\",2,&numlines);",
          "new_line_content": "        sds l = lines[j];",
          "content_same": false
        },
        {
          "line": 3852,
          "old_api": "redisAssert",
          "new_api": null,
          "old_text": "redisAssert(ri->flags & SRI_FAILOVER_IN_PROGRESS)",
          "new_text": null,
          "old_line_content": "    redisAssert(ri->flags & SRI_FAILOVER_IN_PROGRESS);",
          "new_line_content": "    ri->flags &= ~(SRI_FAILOVER_IN_PROGRESS|SRI_FORCE_FAILOVER);",
          "content_same": false
        },
        {
          "line": 3853,
          "old_api": "redisAssert",
          "new_api": null,
          "old_text": "redisAssert(ri->failover_state <= SENTINEL_FAILOVER_STATE_WAIT_PROMOTION)",
          "new_text": null,
          "old_line_content": "    redisAssert(ri->failover_state <= SENTINEL_FAILOVER_STATE_WAIT_PROMOTION);",
          "new_line_content": "    ri->failover_state = SENTINEL_FAILOVER_STATE_NONE;",
          "content_same": false
        },
        {
          "line": 1806,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(l,\"run_id:\",7)",
          "new_text": null,
          "old_line_content": "        if (sdslen(l) >= 47 && !memcmp(l,\"run_id:\",7)) {",
          "new_line_content": "            } else {",
          "content_same": false
        },
        {
          "line": 3857,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    ri->failover_state_change_time = mstime();",
          "new_line_content": "        ri->promoted_slave = NULL;",
          "content_same": false
        },
        {
          "line": 1811,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_NOTICE,\"+reboot\",ri,\"%@\")",
          "new_text": null,
          "old_line_content": "                    sentinelEvent(REDIS_NOTICE,\"+reboot\",ri,\"%@\");",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1812,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(ri->runid)",
          "new_text": null,
          "old_line_content": "                    sdsfree(ri->runid);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1813,
          "old_api": "sdsnewlen",
          "new_api": null,
          "old_text": "sdsnewlen(l+7,40)",
          "new_text": null,
          "old_line_content": "                    ri->runid = sdsnewlen(l+7,40);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1821,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(l)",
          "new_text": null,
          "old_line_content": "            sdslen(l) >= 7 &&",
          "new_line_content": "            char *ip, *port, *end;",
          "content_same": false
        },
        {
          "line": 1822,
          "old_api": "isdigit",
          "new_api": null,
          "old_text": "isdigit(l[5])",
          "new_text": null,
          "old_line_content": "            !memcmp(l,\"slave\",5) && isdigit(l[5]))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3873,
          "old_api": "sentinelReconnectInstance",
          "new_api": null,
          "old_text": "sentinelReconnectInstance(ri)",
          "new_text": null,
          "old_line_content": "    sentinelReconnectInstance(ri);",
          "new_line_content": "    /* ============== ACTING HALF ============= */",
          "content_same": false
        },
        {
          "line": 1826,
          "old_api": "strstr",
          "new_api": null,
          "old_text": "strstr(l,\"ip=\")",
          "new_text": null,
          "old_line_content": "            if (strstr(l,\"ip=\") == NULL) {",
          "new_line_content": "                ip++; /* Now ip points to start of ip address. */",
          "content_same": false
        },
        {
          "line": 3874,
          "old_api": "sentinelSendPeriodicCommands",
          "new_api": null,
          "old_text": "sentinelSendPeriodicCommands(ri)",
          "new_text": null,
          "old_line_content": "    sentinelSendPeriodicCommands(ri);",
          "new_line_content": "    /* We don't proceed with the acting half if we are in TILT mode.",
          "content_same": false
        },
        {
          "line": 1828,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(l,':')",
          "new_text": null,
          "old_line_content": "                ip = strchr(l,':'); if (!ip) continue;",
          "new_line_content": "                *port = '\\0'; /* nul term for easy access. */",
          "content_same": false
        },
        {
          "line": 1833,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(port,',')",
          "new_text": null,
          "old_line_content": "                end = strchr(port,','); if (!end) continue;",
          "new_line_content": "                /* New format. */",
          "content_same": false
        },
        {
          "line": 3881,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        if (mstime()-sentinel.tilt_start_time < SENTINEL_TILT_PERIOD) return;",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3883,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"-tilt\",NULL,\"#tilt mode exited\")",
          "new_text": null,
          "old_line_content": "        sentinelEvent(REDIS_WARNING,\"-tilt\",NULL,\"#tilt mode exited\");",
          "new_line_content": "    /* Every kind of instance */",
          "content_same": false
        },
        {
          "line": 1837,
          "old_api": "strstr",
          "new_api": null,
          "old_text": "strstr(l,\"ip=\")",
          "new_text": null,
          "old_line_content": "                ip = strstr(l,\"ip=\"); if (!ip) continue;",
          "new_line_content": "                port += 5; /* Now port points to start of port number. */",
          "content_same": false
        },
        {
          "line": 3887,
          "old_api": "sentinelCheckSubjectivelyDown",
          "new_api": null,
          "old_text": "sentinelCheckSubjectivelyDown(ri)",
          "new_text": null,
          "old_line_content": "    sentinelCheckSubjectivelyDown(ri);",
          "new_line_content": "    if (ri->flags & (SRI_MASTER|SRI_SLAVE)) {",
          "content_same": false
        },
        {
          "line": 1842,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(ip,',')",
          "new_text": null,
          "old_line_content": "                end = strchr(ip,','); if (end) *end = '\\0';",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1843,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(port,',')",
          "new_text": null,
          "old_line_content": "                end = strchr(port,','); if (end) *end = '\\0';",
          "new_line_content": "            /* Check if we already have this slave into our table,",
          "content_same": false
        },
        {
          "line": 1848,
          "old_api": "atoi",
          "new_api": null,
          "old_text": "atoi(port)",
          "new_text": null,
          "old_line_content": "            if (sentinelRedisInstanceLookupSlave(ri,ip,atoi(port)) == NULL) {",
          "new_line_content": "                {",
          "content_same": false
        },
        {
          "line": 1850,
          "old_api": "atoi",
          "new_api": null,
          "old_text": "atoi(port)",
          "new_text": null,
          "old_line_content": "                            atoi(port), ri->quorum, ri)) != NULL)",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 3898,
          "old_api": "sentinelAskMasterStateToOtherSentinels",
          "new_api": null,
          "old_text": "sentinelAskMasterStateToOtherSentinels(ri,SENTINEL_ASK_FORCED)",
          "new_text": null,
          "old_line_content": "            sentinelAskMasterStateToOtherSentinels(ri,SENTINEL_ASK_FORCED);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1852,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_NOTICE,\"+slave\",slave,\"%@\")",
          "new_text": null,
          "old_line_content": "                    sentinelEvent(REDIS_NOTICE,\"+slave\",slave,\"%@\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3899,
          "old_api": "sentinelFailoverStateMachine",
          "new_api": null,
          "old_text": "sentinelFailoverStateMachine(ri)",
          "new_text": null,
          "old_line_content": "        sentinelFailoverStateMachine(ri);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3900,
          "old_api": "sentinelAskMasterStateToOtherSentinels",
          "new_api": null,
          "old_text": "sentinelAskMasterStateToOtherSentinels(ri,SENTINEL_NO_FLAGS)",
          "new_text": null,
          "old_line_content": "        sentinelAskMasterStateToOtherSentinels(ri,SENTINEL_NO_FLAGS);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1859,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(l,\"master_link_down_since_seconds\",30)",
          "new_text": null,
          "old_line_content": "            !memcmp(l,\"master_link_down_since_seconds\",30))",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1861,
          "old_api": "strtoll",
          "new_api": null,
          "old_text": "strtoll(l+31,NULL,10)",
          "new_text": null,
          "old_line_content": "            ri->master_link_down_time = strtoll(l+31,NULL,10)*1000;",
          "new_line_content": "        /* role:<role> */",
          "content_same": false
        },
        {
          "line": 3912,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(instances)",
          "new_text": null,
          "old_line_content": "    di = dictGetIterator(instances);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1865,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(l,\"role:master\",11)",
          "new_text": null,
          "old_line_content": "        if (!memcmp(l,\"role:master\",11)) role = SRI_MASTER;",
          "new_line_content": "        if (role == SRI_SLAVE) {",
          "content_same": false
        },
        {
          "line": 1866,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(l,\"role:slave\",10)",
          "new_text": null,
          "old_line_content": "        else if (!memcmp(l,\"role:slave\",10)) role = SRI_SLAVE;",
          "new_line_content": "            /* master_host:<host> */",
          "content_same": false
        },
        {
          "line": 3914,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "        sentinelRedisInstance *ri = dictGetVal(de);",
          "new_line_content": "        if (ri->flags & SRI_MASTER) {",
          "content_same": false
        },
        {
          "line": 1870,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(l,\"master_host:\",12)",
          "new_text": null,
          "old_line_content": "            if (sdslen(l) >= 12 && !memcmp(l,\"master_host:\",12)) {",
          "new_line_content": "                {",
          "content_same": false
        },
        {
          "line": 3918,
          "old_api": "sentinelHandleDictOfRedisInstances",
          "new_api": null,
          "old_text": "sentinelHandleDictOfRedisInstances(ri->slaves)",
          "new_text": null,
          "old_line_content": "            sentinelHandleDictOfRedisInstances(ri->slaves);",
          "new_line_content": "                switch_to_promoted = ri;",
          "content_same": false
        },
        {
          "line": 3919,
          "old_api": "sentinelHandleDictOfRedisInstances",
          "new_api": null,
          "old_text": "sentinelHandleDictOfRedisInstances(ri->sentinels)",
          "new_text": null,
          "old_line_content": "            sentinelHandleDictOfRedisInstances(ri->sentinels);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1874,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(ri->slave_master_host)",
          "new_text": null,
          "old_line_content": "                    sdsfree(ri->slave_master_host);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1875,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(l+12)",
          "new_text": null,
          "old_line_content": "                    ri->slave_master_host = sdsnew(l+12);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1876,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "                    ri->slave_conf_change_time = mstime();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3926,
          "old_api": "sentinelFailoverSwitchToPromotedSlave",
          "new_api": null,
          "old_text": "sentinelFailoverSwitchToPromotedSlave(switch_to_promoted)",
          "new_text": null,
          "old_line_content": "        sentinelFailoverSwitchToPromotedSlave(switch_to_promoted);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3927,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "    dictReleaseIterator(di);",
          "new_line_content": "/* This function checks if we need to enter the TITL mode.",
          "content_same": false
        },
        {
          "line": 1881,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(l,\"master_port:\",12)",
          "new_text": null,
          "old_line_content": "            if (sdslen(l) >= 12 && !memcmp(l,\"master_port:\",12)) {",
          "new_line_content": "                if (ri->slave_master_port != slave_master_port) {",
          "content_same": false
        },
        {
          "line": 1882,
          "old_api": "atoi",
          "new_api": null,
          "old_text": "atoi(l+12)",
          "new_text": null,
          "old_line_content": "                int slave_master_port = atoi(l+12);",
          "new_line_content": "                    ri->slave_master_port = slave_master_port;",
          "content_same": false
        },
        {
          "line": 1886,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "                    ri->slave_conf_change_time = mstime();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1891,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(l,\"master_link_status:\",19)",
          "new_text": null,
          "old_line_content": "            if (sdslen(l) >= 19 && !memcmp(l,\"master_link_status:\",19)) {",
          "new_line_content": "                    SENTINEL_MASTER_LINK_STATUS_UP :",
          "content_same": false
        },
        {
          "line": 1893,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(l+19,\"up\")",
          "new_text": null,
          "old_line_content": "                    (strcasecmp(l+19,\"up\") == 0) ?",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1899,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(l,\"slave_priority:\",15)",
          "new_text": null,
          "old_line_content": "            if (sdslen(l) >= 15 && !memcmp(l,\"slave_priority:\",15))",
          "new_line_content": "            /* slave_repl_offset:<offset> */",
          "content_same": false
        },
        {
          "line": 3950,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    mstime_t now = mstime();",
          "new_line_content": "    if (delta < 0 || delta > SENTINEL_TILT_TRIGGER) {",
          "content_same": false
        },
        {
          "line": 1903,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(l,\"slave_repl_offset:\",18)",
          "new_text": null,
          "old_line_content": "            if (sdslen(l) >= 18 && !memcmp(l,\"slave_repl_offset:\",18))",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1907,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    ri->info_refresh = mstime();",
          "new_line_content": "    /* ---------------------------- Acting half -----------------------------",
          "content_same": false
        },
        {
          "line": 1908,
          "old_api": "sdsfreesplitres",
          "new_api": null,
          "old_text": "sdsfreesplitres(lines,numlines)",
          "new_text": null,
          "old_line_content": "    sdsfreesplitres(lines,numlines);",
          "new_line_content": "     * Some things will not happen if sentinel.tilt is true, but some will",
          "content_same": false
        },
        {
          "line": 3956,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+tilt\",NULL,\"#tilt mode entered\")",
          "new_text": null,
          "old_line_content": "        sentinelEvent(REDIS_WARNING,\"+tilt\",NULL,\"#tilt mode entered\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3958,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "    sentinel.previous_time = mstime();",
          "new_line_content": "void sentinelTimer(void) {",
          "content_same": false
        },
        {
          "line": 1916,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "        ri->role_reported_time = mstime();",
          "new_line_content": "        /* Log the event with +role-change if the new role is coherent or",
          "content_same": false
        },
        {
          "line": 3964,
          "old_api": "sentinelRunPendingScripts",
          "new_api": null,
          "old_text": "sentinelRunPendingScripts()",
          "new_text": null,
          "old_line_content": "    sentinelRunPendingScripts();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3965,
          "old_api": "sentinelCollectTerminatedScripts",
          "new_api": null,
          "old_text": "sentinelCollectTerminatedScripts()",
          "new_text": null,
          "old_line_content": "    sentinelCollectTerminatedScripts();",
          "new_line_content": "    /* We continuously change the frequency of the Redis \"timer interrupt\"",
          "content_same": false
        },
        {
          "line": 3966,
          "old_api": "sentinelKillTimedoutScripts",
          "new_api": null,
          "old_text": "sentinelKillTimedoutScripts()",
          "new_text": null,
          "old_line_content": "    sentinelKillTimedoutScripts();",
          "new_line_content": "     * in order to desynchronize every Sentinel from every other.",
          "content_same": false
        },
        {
          "line": 1921,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_VERBOSE,\n            ((ri->flags & (SRI_MASTER|SRI_SLAVE)) == role) ?\n            \"+role-change\" : \"-role-change\",\n            ri, \"%@ new reported role is %s\",\n            role == SRI_MASTER ? \"master\" : \"slave\",\n            ri->flags & SRI_MASTER ? \"master\" : \"slave\")",
          "new_text": null,
          "old_line_content": "        sentinelEvent(REDIS_VERBOSE,",
          "new_line_content": "            ri, \"%@ new reported role is %s\",",
          "content_same": false
        },
        {
          "line": 3974,
          "old_api": "rand",
          "new_api": null,
          "old_text": "rand()",
          "new_text": null,
          "old_line_content": "    server.hz = REDIS_DEFAULT_HZ + rand() % REDIS_DEFAULT_HZ;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1957,
          "old_api": "sentinelFlushConfig",
          "new_api": null,
          "old_text": "sentinelFlushConfig()",
          "new_text": null,
          "old_line_content": "            sentinelFlushConfig();",
          "new_line_content": "                ri->master,\"%@\");",
          "content_same": false
        },
        {
          "line": 1959,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_WARNING,\"+failover-state-reconf-slaves\",\n                ri->master,\"%@\")",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_WARNING,\"+failover-state-reconf-slaves\",",
          "new_line_content": "                \"start\",ri->master->addr,ri->addr);",
          "content_same": false
        },
        {
          "line": 1961,
          "old_api": "sentinelCallClientReconfScript",
          "new_api": null,
          "old_text": "sentinelCallClientReconfScript(ri->master,SENTINEL_LEADER,\n                \"start\",ri->master->addr,ri->addr)",
          "new_text": null,
          "old_line_content": "            sentinelCallClientReconfScript(ri->master,SENTINEL_LEADER,",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 1963,
          "old_api": "sentinelForceHelloUpdateForMaster",
          "new_api": null,
          "old_text": "sentinelForceHelloUpdateForMaster(ri->master)",
          "new_text": null,
          "old_line_content": "            sentinelForceHelloUpdateForMaster(ri->master);",
          "new_line_content": "             * reconfigure as slave. Wait some time after the change before",
          "content_same": false
        },
        {
          "line": 1971,
          "old_api": "sentinelMasterLooksSane",
          "new_api": null,
          "old_text": "sentinelMasterLooksSane(ri->master)",
          "new_text": null,
          "old_line_content": "                 sentinelMasterLooksSane(ri->master) &&",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 1973,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "                 mstime() - ri->role_reported_time > wait_time)",
          "new_line_content": "                        ri->master->addr->ip,",
          "content_same": false
        },
        {
          "line": 1975,
          "old_api": "sentinelSendSlaveOf",
          "new_api": null,
          "old_text": "sentinelSendSlaveOf(ri,\n                        ri->master->addr->ip,\n                        ri->master->addr->port)",
          "new_text": null,
          "old_line_content": "                int retval = sentinelSendSlaveOf(ri,",
          "new_line_content": "                if (retval == REDIS_OK)",
          "content_same": false
        },
        {
          "line": 1979,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_NOTICE,\"+convert-to-slave\",ri,\"%@\")",
          "new_text": null,
          "old_line_content": "                    sentinelEvent(REDIS_NOTICE,\"+convert-to-slave\",ri,\"%@\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1988,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(ri->slave_master_host,ri->master->addr->ip)",
          "new_text": null,
          "old_line_content": "         strcasecmp(ri->slave_master_host,ri->master->addr->ip)))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1994,
          "old_api": "sentinelMasterLooksSane",
          "new_api": null,
          "old_text": "sentinelMasterLooksSane(ri->master)",
          "new_text": null,
          "old_line_content": "        if (sentinelMasterLooksSane(ri->master) &&",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 1996,
          "old_api": "mstime",
          "new_api": null,
          "old_text": "mstime()",
          "new_text": null,
          "old_line_content": "            mstime() - ri->slave_conf_change_time > wait_time)",
          "new_line_content": "                    ri->master->addr->ip,",
          "content_same": false
        },
        {
          "line": 1998,
          "old_api": "sentinelSendSlaveOf",
          "new_api": null,
          "old_text": "sentinelSendSlaveOf(ri,\n                    ri->master->addr->ip,\n                    ri->master->addr->port)",
          "new_text": null,
          "old_line_content": "            int retval = sentinelSendSlaveOf(ri,",
          "new_line_content": "            if (retval == REDIS_OK)",
          "content_same": false
        },
        {
          "line": 2002,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_NOTICE,\"+fix-slave-config\",ri,\"%@\")",
          "new_text": null,
          "old_line_content": "                sentinelEvent(REDIS_NOTICE,\"+fix-slave-config\",ri,\"%@\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2014,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(ri->slave_master_host,\n                    ri->master->promoted_slave->addr->ip)",
          "new_text": null,
          "old_line_content": "            strcmp(ri->slave_master_host,",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 2020,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_NOTICE,\"+slave-reconf-inprog\",ri,\"%@\")",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_NOTICE,\"+slave-reconf-inprog\",ri,\"%@\");",
          "new_line_content": "        /* SRI_RECONF_INPROG -> SRI_RECONF_DONE */",
          "content_same": false
        },
        {
          "line": 2029,
          "old_api": "sentinelEvent",
          "new_api": null,
          "old_text": "sentinelEvent(REDIS_NOTICE,\"+slave-reconf-done\",ri,\"%@\")",
          "new_text": null,
          "old_line_content": "            sentinelEvent(REDIS_NOTICE,\"+slave-reconf-done\",ri,\"%@\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2037,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(privdata)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(privdata);",
          "new_line_content": "    if (!reply || !ri) return;",
          "content_same": false
        },
        {
          "line": 2044,
          "old_api": "sentinelRefreshInstanceInfo",
          "new_api": null,
          "old_text": "sentinelRefreshInstanceInfo(ri,r->str)",
          "new_text": null,
          "old_line_content": "        sentinelRefreshInstanceInfo(ri,r->str);",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 171,
      "total_additions": 505,
      "total_deletions": 506,
      "total_api_changes": 1182
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 4,
        "api_related_lines": 1182,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          1277
        ]
      }
    },
    "api_calls_before": 978,
    "api_calls_after": 977,
    "diff_info": {
      "added_lines": 1,
      "removed_lines": 4,
      "total_diff_lines": 17
    }
  }
}