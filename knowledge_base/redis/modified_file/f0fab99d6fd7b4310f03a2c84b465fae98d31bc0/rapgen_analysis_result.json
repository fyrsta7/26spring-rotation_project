{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/f0fab99d6fd7b4310f03a2c84b465fae98d31bc0",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/f0fab99d6fd7b4310f03a2c84b465fae98d31bc0/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/f0fab99d6fd7b4310f03a2c84b465fae98d31bc0/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/f0fab99d6fd7b4310f03a2c84b465fae98d31bc0/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 422,
          "old_api": "zmalloc_used_memory",
          "new_api": "freeMemoryGetNotCountedMemory",
          "old_text": "zmalloc_used_memory()",
          "new_text": "freeMemoryGetNotCountedMemory()",
          "old_line_content": "    size_t mem_used = zmalloc_used_memory();",
          "new_line_content": "    size_t overhead = freeMemoryGetNotCountedMemory();",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": "UNUSED",
          "new_api": "performEvictions",
          "old_text": "UNUSED(id)",
          "new_text": "performEvictions()",
          "old_line_content": "    UNUSED(id);",
          "new_line_content": "    if (performEvictions() == EVICT_RUNNING) return 0;  /* keep evicting */",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": "listLength",
          "new_api": "getMaxmemoryState",
          "old_text": "listLength(server.slaves)",
          "new_text": "getMaxmemoryState(&mem_reported,NULL,&mem_tofree,NULL)",
          "old_line_content": "    int slaves = listLength(server.slaves);",
          "new_line_content": "    if (getMaxmemoryState(&mem_reported,NULL,&mem_tofree,NULL) == C_OK) {",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": "latencyStartMonitor",
          "new_api": "elapsedStart",
          "old_text": "latencyStartMonitor(latency)",
          "new_text": "elapsedStart(&evictionTimer)",
          "old_line_content": "    latencyStartMonitor(latency);",
          "new_line_content": "    elapsedStart(&evictionTimer);",
          "content_same": false
        },
        {
          "line": 642,
          "old_api": "zmalloc_used_memory",
          "new_api": "dbAsyncDelete",
          "old_text": "zmalloc_used_memory()",
          "new_text": "dbAsyncDelete(db,keyobj)",
          "old_line_content": "            delta = (long long) zmalloc_used_memory();",
          "new_line_content": "                dbAsyncDelete(db,keyobj);",
          "content_same": false
        },
        {
          "line": 645,
          "old_api": "dbAsyncDelete",
          "new_api": "latencyEndMonitor",
          "old_text": "dbAsyncDelete(db,keyobj)",
          "new_text": "latencyEndMonitor(eviction_latency)",
          "old_line_content": "                dbAsyncDelete(db,keyobj);",
          "new_line_content": "            latencyEndMonitor(eviction_latency);",
          "content_same": false
        },
        {
          "line": 647,
          "old_api": "dbSyncDelete",
          "new_api": "zmalloc_used_memory",
          "old_text": "dbSyncDelete(db,keyobj)",
          "new_text": "zmalloc_used_memory()",
          "old_line_content": "                dbSyncDelete(db,keyobj);",
          "new_line_content": "            delta -= (long long) zmalloc_used_memory();",
          "content_same": false
        },
        {
          "line": 650,
          "old_api": "zmalloc_used_memory",
          "new_api": "signalModifiedKey",
          "old_text": "zmalloc_used_memory()",
          "new_text": "signalModifiedKey(NULL,db,keyobj)",
          "old_line_content": "            delta -= (long long) zmalloc_used_memory();",
          "new_line_content": "            signalModifiedKey(NULL,db,keyobj);",
          "content_same": false
        },
        {
          "line": 653,
          "old_api": "signalModifiedKey",
          "new_api": "decrRefCount",
          "old_text": "signalModifiedKey(NULL,db,keyobj)",
          "new_text": "decrRefCount(keyobj)",
          "old_line_content": "            signalModifiedKey(NULL,db,keyobj);",
          "new_line_content": "            decrRefCount(keyobj);",
          "content_same": false
        },
        {
          "line": 718,
          "old_api": "elapsedStart",
          "new_api": "elapsedUs",
          "old_text": "elapsedStart(&server.stat_last_eviction_exceeded_time)",
          "new_text": "elapsedUs(server.stat_last_eviction_exceeded_time)",
          "old_line_content": "            elapsedStart(&server.stat_last_eviction_exceeded_time);",
          "new_line_content": "            server.stat_total_eviction_exceeded_time += elapsedUs(server.stat_last_eviction_exceeded_time);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 512,
          "old_api": null,
          "new_api": "isSafeToPerformEvictions",
          "old_text": null,
          "new_text": "isSafeToPerformEvictions()",
          "old_line_content": "int performEvictions(void) {",
          "new_line_content": "    if (!isSafeToPerformEvictions()) return EVICT_OK;",
          "content_same": false
        },
        {
          "line": 640,
          "old_api": null,
          "new_api": "latencyStartMonitor",
          "old_text": null,
          "new_text": "latencyStartMonitor(eviction_latency)",
          "old_line_content": "             * AOF and Output buffer memory will be freed eventually so",
          "new_line_content": "            latencyStartMonitor(eviction_latency);",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": null,
          "new_api": "dbSyncDelete",
          "old_text": null,
          "new_text": "dbSyncDelete(db,keyobj)",
          "old_line_content": "            if (server.lazyfree_lazy_eviction)",
          "new_line_content": "                dbSyncDelete(db,keyobj);",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": null,
          "new_api": "latencyAddSampleIfNeeded",
          "old_text": null,
          "new_text": "latencyAddSampleIfNeeded(\"eviction-del\",eviction_latency)",
          "old_line_content": "            else",
          "new_line_content": "            latencyAddSampleIfNeeded(\"eviction-del\",eviction_latency);",
          "content_same": false
        },
        {
          "line": 519,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(server.slaves)",
          "old_line_content": "    long long mem_freed; /* May be negative */",
          "new_line_content": "    int slaves = listLength(server.slaves);",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": null,
          "new_api": "freeMemoryGetNotCountedMemory",
          "old_text": null,
          "new_text": "freeMemoryGetNotCountedMemory()",
          "old_line_content": "    /* Compute the ratio of memory usage. */",
          "new_line_content": "    size_t overhead = freeMemoryGetNotCountedMemory();",
          "content_same": false
        },
        {
          "line": 651,
          "old_api": null,
          "new_api": "notifyKeyspaceEvent",
          "old_text": null,
          "new_text": "notifyKeyspaceEvent(NOTIFY_EVICTED, \"evicted\",\n                keyobj, db->id)",
          "old_line_content": "            mem_freed += delta;",
          "new_line_content": "            notifyKeyspaceEvent(NOTIFY_EVICTED, \"evicted\",",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": null,
          "new_api": "evictionTimeLimitUs",
          "old_text": null,
          "new_text": "evictionTimeLimitUs()",
          "old_line_content": "        goto update_metrics;",
          "new_line_content": "    unsigned long eviction_time_limit_us = evictionTimeLimitUs();",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": null,
          "new_api": "flushSlavesOutputBuffers",
          "old_text": null,
          "new_text": "flushSlavesOutputBuffers()",
          "old_line_content": "                 * start spending so much time here that is impossible to",
          "new_line_content": "                if (slaves) flushSlavesOutputBuffers();",
          "content_same": false
        },
        {
          "line": 536,
          "old_api": null,
          "new_api": "latencyStartMonitor",
          "old_text": null,
          "new_text": "latencyStartMonitor(latency)",
          "old_line_content": "",
          "new_line_content": "    latencyStartMonitor(latency);",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": null,
          "new_api": "getMaxmemoryState",
          "old_text": null,
          "new_text": "getMaxmemoryState(NULL,NULL,NULL,NULL)",
          "old_line_content": "                 * across the dbAsyncDelete() call, while the thread can",
          "new_line_content": "                    if (getMaxmemoryState(NULL,NULL,NULL,NULL) == C_OK) {",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": null,
          "new_api": "zmalloc_used_memory",
          "old_text": null,
          "new_text": "zmalloc_used_memory()",
          "old_line_content": "    if (!server.maxmemory) return  0; /* No limit. */",
          "new_line_content": "    size_t mem_used = zmalloc_used_memory();",
          "content_same": false
        },
        {
          "line": 679,
          "old_api": null,
          "new_api": "elapsedUs",
          "old_text": null,
          "new_text": "elapsedUs(evictionTimer)",
          "old_line_content": "                /* After some time, exit the loop early - even if memory limit",
          "new_line_content": "                if (elapsedUs(evictionTimer) > eviction_time_limit_us) {",
          "content_same": false
        },
        {
          "line": 683,
          "old_api": null,
          "new_api": "aeCreateTimeEvent",
          "old_text": null,
          "new_text": "aeCreateTimeEvent(server.el, 0,\n                                evictionTimeProc, NULL, NULL)",
          "old_line_content": "                    // We still need to free memory - start eviction timer proc",
          "new_line_content": "                        aeCreateTimeEvent(server.el, 0,",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": null,
          "new_api": "UNUSED",
          "old_text": null,
          "new_text": "UNUSED(eventLoop)",
          "old_line_content": "static int isEvictionProcRunning = 0;",
          "new_line_content": "    UNUSED(eventLoop);",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": null,
          "new_api": "UNUSED",
          "old_text": null,
          "new_text": "UNUSED(id)",
          "old_line_content": "static int evictionTimeProc(",
          "new_line_content": "    UNUSED(id);",
          "content_same": false
        },
        {
          "line": 436,
          "old_api": null,
          "new_api": "UNUSED",
          "old_text": null,
          "new_text": "UNUSED(clientData)",
          "old_line_content": "        struct aeEventLoop *eventLoop, long long id, void *clientData) {",
          "new_line_content": "    UNUSED(clientData);",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(dict)",
          "old_line_content": "                    db = server.db+i;",
          "new_line_content": "                    if ((keys = dictSize(dict)) != 0) {",
          "content_same": false
        },
        {
          "line": 566,
          "old_api": null,
          "new_api": "evictionPoolPopulate",
          "old_text": null,
          "new_text": "evictionPoolPopulate(i, dict, db->dict, pool)",
          "old_line_content": "                    dict = (server.maxmemory_policy & MAXMEMORY_FLAG_ALLKEYS) ?",
          "new_line_content": "                        evictionPoolPopulate(i, dict, db->dict, pool);",
          "content_same": false
        },
        {
          "line": 701,
          "old_api": null,
          "new_api": "bioPendingJobsOfType",
          "old_text": null,
          "new_text": "bioPendingJobsOfType(BIO_LAZY_FREE)",
          "old_line_content": "        /* At this point, we have run out of evictable items.  It's possible",
          "new_line_content": "        if (bioPendingJobsOfType(BIO_LAZY_FREE)) {",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": null,
          "new_api": "usleep",
          "old_text": null,
          "new_text": "usleep(eviction_time_limit_us)",
          "old_line_content": "         * that some items are being freed in the lazyfree thread.  Perform a",
          "new_line_content": "            usleep(eviction_time_limit_us);",
          "content_same": false
        },
        {
          "line": 703,
          "old_api": null,
          "new_api": "getMaxmemoryState",
          "old_text": null,
          "new_text": "getMaxmemoryState(NULL,NULL,NULL,NULL)",
          "old_line_content": "         * short wait here if such jobs exist, but don't wait long.  */",
          "new_line_content": "            if (getMaxmemoryState(NULL,NULL,NULL,NULL) == C_OK) {",
          "content_same": false
        },
        {
          "line": 578,
          "old_api": null,
          "new_api": "dictFind",
          "old_text": null,
          "new_text": "dictFind(server.db[bestdbid].dict,\n                            pool[k].key)",
          "old_line_content": "                    bestdbid = pool[k].dbid;",
          "new_line_content": "                        de = dictFind(server.db[bestdbid].dict,",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": null,
          "new_api": "latencyEndMonitor",
          "old_text": null,
          "new_text": "latencyEndMonitor(latency)",
          "old_line_content": "        }",
          "new_line_content": "    latencyEndMonitor(latency);",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": null,
          "new_api": "latencyAddSampleIfNeeded",
          "old_text": null,
          "new_text": "latencyAddSampleIfNeeded(\"eviction-cycle\",latency)",
          "old_line_content": "    }",
          "new_line_content": "    latencyAddSampleIfNeeded(\"eviction-cycle\",latency);",
          "content_same": false
        },
        {
          "line": 587,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(pool[k].key)",
          "old_line_content": "",
          "new_line_content": "                        sdsfree(pool[k].key);",
          "content_same": false
        },
        {
          "line": 715,
          "old_api": null,
          "new_api": "elapsedStart",
          "old_text": null,
          "new_text": "elapsedStart(&server.stat_last_eviction_exceeded_time)",
          "old_line_content": "update_metrics:",
          "new_line_content": "            elapsedStart(&server.stat_last_eviction_exceeded_time);",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": null,
          "new_api": "checkClientPauseTimeoutAndReturnIfPaused",
          "old_text": null,
          "new_text": "checkClientPauseTimeoutAndReturnIfPaused()",
          "old_line_content": "    /* When clients are paused the dataset should be static not just from the",
          "new_line_content": "    if (checkClientPauseTimeoutAndReturnIfPaused()) return 0;",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": null,
          "new_api": "dictGetKey",
          "old_text": null,
          "new_text": "dictGetKey(de)",
          "old_line_content": "                    /* If the key exists, is our pick. Otherwise it is",
          "new_line_content": "                        bestkey = dictGetKey(de);",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": null,
          "new_api": "serverAssert",
          "old_text": null,
          "new_text": "serverAssert(server.maxmemory_eviction_tenacity >= 0)",
          "old_line_content": "",
          "new_line_content": "    serverAssert(server.maxmemory_eviction_tenacity >= 0);",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": null,
          "new_api": "serverAssert",
          "old_text": null,
          "new_text": "serverAssert(server.maxmemory_eviction_tenacity <= 100)",
          "old_line_content": "/* Algorithm for converting tenacity (0-100) to a time limit.  */",
          "new_line_content": "    serverAssert(server.maxmemory_eviction_tenacity <= 100);",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": null,
          "new_api": "pow",
          "old_text": null,
          "new_text": "pow(1.15, server.maxmemory_eviction_tenacity - 10.0)",
          "old_line_content": "",
          "new_line_content": "        return (unsigned long)(500.0 * pow(1.15, server.maxmemory_eviction_tenacity - 10.0));",
          "content_same": false
        },
        {
          "line": 615,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(dict)",
          "old_line_content": "                db = server.db+j;",
          "new_line_content": "                if (dictSize(dict) != 0) {",
          "content_same": false
        },
        {
          "line": 616,
          "old_api": null,
          "new_api": "dictGetRandomKey",
          "old_text": null,
          "new_text": "dictGetRandomKey(dict)",
          "old_line_content": "                dict = (server.maxmemory_policy == MAXMEMORY_ALLKEYS_RANDOM) ?",
          "new_line_content": "                    de = dictGetRandomKey(dict);",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": null,
          "new_api": "dictGetKey",
          "old_text": null,
          "new_text": "dictGetKey(de)",
          "old_line_content": "                        db->dict : db->expires;",
          "new_line_content": "                    bestkey = dictGetKey(de);",
          "content_same": false
        },
        {
          "line": 627,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(bestkey)",
          "old_line_content": "        /* Finally remove the selected key. */",
          "new_line_content": "            robj *keyobj = createStringObject(bestkey,sdslen(bestkey));",
          "content_same": false
        },
        {
          "line": 628,
          "old_api": null,
          "new_api": "propagateExpire",
          "old_text": null,
          "new_text": "propagateExpire(db,keyobj,server.lazyfree_lazy_eviction)",
          "old_line_content": "        if (bestkey) {",
          "new_line_content": "            propagateExpire(db,keyobj,server.lazyfree_lazy_eviction);",
          "content_same": false
        },
        {
          "line": 639,
          "old_api": null,
          "new_api": "zmalloc_used_memory",
          "old_text": null,
          "new_text": "zmalloc_used_memory()",
          "old_line_content": "             *",
          "new_line_content": "            delta = (long long) zmalloc_used_memory();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 515,
          "old_api": "isSafeToPerformEvictions",
          "new_api": null,
          "old_text": "isSafeToPerformEvictions()",
          "new_text": null,
          "old_line_content": "    if (!isSafeToPerformEvictions()) return EVICT_OK;",
          "new_line_content": "    size_t mem_reported, mem_tofree;",
          "content_same": false
        },
        {
          "line": 643,
          "old_api": "latencyStartMonitor",
          "new_api": null,
          "old_text": "latencyStartMonitor(eviction_latency)",
          "new_text": null,
          "old_line_content": "            latencyStartMonitor(eviction_latency);",
          "new_line_content": "            else",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": "freeMemoryGetNotCountedMemory",
          "new_api": null,
          "old_text": "freeMemoryGetNotCountedMemory()",
          "new_text": null,
          "old_line_content": "    size_t overhead = freeMemoryGetNotCountedMemory();",
          "new_line_content": "    /* Remove the size of slaves output buffers and AOF buffer from the",
          "content_same": false
        },
        {
          "line": 648,
          "old_api": "latencyEndMonitor",
          "new_api": null,
          "old_text": "latencyEndMonitor(eviction_latency)",
          "new_text": null,
          "old_line_content": "            latencyEndMonitor(eviction_latency);",
          "new_line_content": "            mem_freed += delta;",
          "content_same": false
        },
        {
          "line": 649,
          "old_api": "latencyAddSampleIfNeeded",
          "new_api": null,
          "old_text": "latencyAddSampleIfNeeded(\"eviction-del\",eviction_latency)",
          "new_text": null,
          "old_line_content": "            latencyAddSampleIfNeeded(\"eviction-del\",eviction_latency);",
          "new_line_content": "            server.stat_evictedkeys++;",
          "content_same": false
        },
        {
          "line": 525,
          "old_api": "getMaxmemoryState",
          "new_api": null,
          "old_text": "getMaxmemoryState(&mem_reported,NULL,&mem_tofree,NULL)",
          "new_text": null,
          "old_line_content": "    if (getMaxmemoryState(&mem_reported,NULL,&mem_tofree,NULL) == C_OK) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 654,
          "old_api": "notifyKeyspaceEvent",
          "new_api": null,
          "old_text": "notifyKeyspaceEvent(NOTIFY_EVICTED, \"evicted\",\n                keyobj, db->id)",
          "new_text": null,
          "old_line_content": "            notifyKeyspaceEvent(NOTIFY_EVICTED, \"evicted\",",
          "new_line_content": "            keys_freed++;",
          "content_same": false
        },
        {
          "line": 656,
          "old_api": "decrRefCount",
          "new_api": null,
          "old_text": "decrRefCount(keyobj)",
          "new_text": null,
          "old_line_content": "            decrRefCount(keyobj);",
          "new_line_content": "            if (keys_freed % 16 == 0) {",
          "content_same": false
        },
        {
          "line": 535,
          "old_api": "evictionTimeLimitUs",
          "new_api": null,
          "old_text": "evictionTimeLimitUs()",
          "new_text": null,
          "old_line_content": "    unsigned long eviction_time_limit_us = evictionTimeLimitUs();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 664,
          "old_api": "flushSlavesOutputBuffers",
          "new_api": null,
          "old_text": "flushSlavesOutputBuffers()",
          "new_text": null,
          "old_line_content": "                if (slaves) flushSlavesOutputBuffers();",
          "new_line_content": "                 * a fixed, pre-computed amount of memory. However when we",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": "elapsedStart",
          "new_api": null,
          "old_text": "elapsedStart(&evictionTimer)",
          "new_text": null,
          "old_line_content": "    elapsedStart(&evictionTimer);",
          "new_line_content": "        int j, k, i;",
          "content_same": false
        },
        {
          "line": 674,
          "old_api": "getMaxmemoryState",
          "new_api": null,
          "old_text": "getMaxmemoryState(NULL,NULL,NULL,NULL)",
          "new_text": null,
          "old_line_content": "                    if (getMaxmemoryState(NULL,NULL,NULL,NULL) == C_OK) {",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 425,
          "old_api": "freeMemoryGetNotCountedMemory",
          "new_api": null,
          "old_text": "freeMemoryGetNotCountedMemory()",
          "new_text": null,
          "old_line_content": "    size_t overhead = freeMemoryGetNotCountedMemory();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": "elapsedUs",
          "new_api": null,
          "old_text": "elapsedUs(evictionTimer)",
          "new_text": null,
          "old_line_content": "                if (elapsedUs(evictionTimer) > eviction_time_limit_us) {",
          "new_line_content": "                        isEvictionProcRunning = 1;",
          "content_same": false
        },
        {
          "line": 686,
          "old_api": "aeCreateTimeEvent",
          "new_api": null,
          "old_text": "aeCreateTimeEvent(server.el, 0,\n                                evictionTimeProc, NULL, NULL)",
          "new_text": null,
          "old_line_content": "                        aeCreateTimeEvent(server.el, 0,",
          "new_line_content": "                    break;",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "UNUSED",
          "new_api": null,
          "old_text": "UNUSED(eventLoop)",
          "new_text": null,
          "old_line_content": "    UNUSED(eventLoop);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": "UNUSED",
          "new_api": null,
          "old_text": "UNUSED(clientData)",
          "new_text": null,
          "old_line_content": "    UNUSED(clientData);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 568,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(dict)",
          "new_text": null,
          "old_line_content": "                    if ((keys = dictSize(dict)) != 0) {",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "evictionPoolPopulate",
          "new_api": null,
          "old_text": "evictionPoolPopulate(i, dict, db->dict, pool)",
          "new_text": null,
          "old_line_content": "                        evictionPoolPopulate(i, dict, db->dict, pool);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": "performEvictions",
          "new_api": null,
          "old_text": "performEvictions()",
          "new_text": null,
          "old_line_content": "    if (performEvictions() == EVICT_RUNNING) return 0;  /* keep evicting */",
          "new_line_content": "     * For EVICT_FAIL - there is nothing left to evict.  */",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": "bioPendingJobsOfType",
          "new_api": null,
          "old_text": "bioPendingJobsOfType(BIO_LAZY_FREE)",
          "new_text": null,
          "old_line_content": "        if (bioPendingJobsOfType(BIO_LAZY_FREE)) {",
          "new_line_content": "                result = EVICT_OK;",
          "content_same": false
        },
        {
          "line": 705,
          "old_api": "usleep",
          "new_api": null,
          "old_text": "usleep(eviction_time_limit_us)",
          "new_text": null,
          "old_line_content": "            usleep(eviction_time_limit_us);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 706,
          "old_api": "getMaxmemoryState",
          "new_api": null,
          "old_text": "getMaxmemoryState(NULL,NULL,NULL,NULL)",
          "new_text": null,
          "old_line_content": "            if (getMaxmemoryState(NULL,NULL,NULL,NULL) == C_OK) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": "dictFind",
          "new_api": null,
          "old_text": "dictFind(server.db[bestdbid].expires,\n                            pool[k].key)",
          "new_text": null,
          "old_line_content": "                        de = dictFind(server.db[bestdbid].expires,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": "latencyEndMonitor",
          "new_api": null,
          "old_text": "latencyEndMonitor(latency)",
          "new_text": null,
          "old_line_content": "    latencyEndMonitor(latency);",
          "new_line_content": "update_metrics:",
          "content_same": false
        },
        {
          "line": 713,
          "old_api": "latencyAddSampleIfNeeded",
          "new_api": null,
          "old_text": "latencyAddSampleIfNeeded(\"eviction-cycle\",latency)",
          "new_text": null,
          "old_line_content": "    latencyAddSampleIfNeeded(\"eviction-cycle\",latency);",
          "new_line_content": "    if (result == EVICT_RUNNING || result == EVICT_FAIL) {",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(pool[k].key)",
          "new_text": null,
          "old_line_content": "                        sdsfree(pool[k].key);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": "elapsedUs",
          "new_api": null,
          "old_text": "elapsedUs(server.stat_last_eviction_exceeded_time)",
          "new_text": null,
          "old_line_content": "            server.stat_total_eviction_exceeded_time += elapsedUs(server.stat_last_eviction_exceeded_time);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": "checkClientPauseTimeoutAndReturnIfPaused",
          "new_api": null,
          "old_text": "checkClientPauseTimeoutAndReturnIfPaused()",
          "new_text": null,
          "old_line_content": "    if (checkClientPauseTimeoutAndReturnIfPaused()) return 0;",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "dictGetKey",
          "new_api": null,
          "old_text": "dictGetKey(de)",
          "new_text": null,
          "old_line_content": "                        bestkey = dictGetKey(de);",
          "new_line_content": "                        /* Ghost... Iterate again. */",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": "serverAssert",
          "new_api": null,
          "old_text": "serverAssert(server.maxmemory_eviction_tenacity >= 0)",
          "new_text": null,
          "old_line_content": "    serverAssert(server.maxmemory_eviction_tenacity >= 0);",
          "new_line_content": "    if (server.maxmemory_eviction_tenacity <= 10) {",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": "serverAssert",
          "new_api": null,
          "old_text": "serverAssert(server.maxmemory_eviction_tenacity <= 100)",
          "new_text": null,
          "old_line_content": "    serverAssert(server.maxmemory_eviction_tenacity <= 100);",
          "new_line_content": "        /* A linear progression from 0..500us */",
          "content_same": false
        },
        {
          "line": 482,
          "old_api": "pow",
          "new_api": null,
          "old_text": "pow(1.15, server.maxmemory_eviction_tenacity - 10.0)",
          "new_text": null,
          "old_line_content": "        return (unsigned long)(500.0 * pow(1.15, server.maxmemory_eviction_tenacity - 10.0));",
          "new_line_content": "    return ULONG_MAX;   /* No limit to eviction time */",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(dict)",
          "new_text": null,
          "old_line_content": "                if (dictSize(dict) != 0) {",
          "new_line_content": "                    bestdbid = j;",
          "content_same": false
        },
        {
          "line": 619,
          "old_api": "dictGetRandomKey",
          "new_api": null,
          "old_text": "dictGetRandomKey(dict)",
          "new_text": null,
          "old_line_content": "                    de = dictGetRandomKey(dict);",
          "new_line_content": "                    break;",
          "content_same": false
        },
        {
          "line": 620,
          "old_api": "dictGetKey",
          "new_api": null,
          "old_text": "dictGetKey(de)",
          "new_text": null,
          "old_line_content": "                    bestkey = dictGetKey(de);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(bestkey)",
          "new_text": null,
          "old_line_content": "            robj *keyobj = createStringObject(bestkey,sdslen(bestkey));",
          "new_line_content": "             * It is possible that actually the memory needed to propagate",
          "content_same": false
        },
        {
          "line": 631,
          "old_api": "propagateExpire",
          "new_api": null,
          "old_text": "propagateExpire(db,keyobj,server.lazyfree_lazy_eviction)",
          "new_text": null,
          "old_line_content": "            propagateExpire(db,keyobj,server.lazyfree_lazy_eviction);",
          "new_line_content": "             * the DEL in AOF and replication link is greater than the one",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 10,
      "total_additions": 38,
      "total_deletions": 38,
      "total_api_changes": 86
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 13,
        "api_related_lines": 86,
        "non_api_lines": 13,
        "non_api_line_numbers": [
          384,
          385,
          386,
          387,
          393,
          394,
          395,
          396,
          397,
          398,
          399,
          401,
          383
        ]
      }
    },
    "api_calls_before": 82,
    "api_calls_after": 82,
    "diff_info": {
      "added_lines": 7,
      "removed_lines": 10,
      "total_diff_lines": 37
    }
  }
}