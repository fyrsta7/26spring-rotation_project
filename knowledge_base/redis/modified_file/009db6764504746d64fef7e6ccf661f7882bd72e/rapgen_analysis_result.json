{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/009db6764504746d64fef7e6ccf661f7882bd72e",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/009db6764504746d64fef7e6ccf661f7882bd72e/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/009db6764504746d64fef7e6ccf661f7882bd72e/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/009db6764504746d64fef7e6ccf661f7882bd72e/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 355,
          "old_api": "addReplyBulkLen",
          "new_api": "_addReplyLongLong",
          "old_text": "addReplyBulkLen(c,obj)",
          "new_text": "_addReplyLongLong(c,len,'$')",
          "old_line_content": "    addReplyBulkLen(c,obj);",
          "new_line_content": "    _addReplyLongLong(c,len,'$');",
          "content_same": false
        },
        {
          "line": 362,
          "old_api": "_addReplyLongLong",
          "new_api": "addReply",
          "old_text": "_addReplyLongLong(c,len,'$')",
          "new_text": "addReply(c,shared.crlf)",
          "old_line_content": "    _addReplyLongLong(c,len,'$');",
          "new_line_content": "    addReply(c,shared.crlf);",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": "createClient",
          "new_api": "addReplyBulkCBuffer",
          "old_text": "createClient(fd)",
          "new_text": "addReplyBulkCBuffer(c,buf,len)",
          "old_line_content": "    if ((c = createClient(fd)) == NULL) {",
          "new_line_content": "    addReplyBulkCBuffer(c,buf,len);",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": "redisLog",
          "new_api": "REDIS_NOTUSED",
          "old_text": "redisLog(REDIS_VERBOSE,\"Accepting client connection: %s\", server.neterr)",
          "new_text": "REDIS_NOTUSED(mask)",
          "old_line_content": "        redisLog(REDIS_VERBOSE,\"Accepting client connection: %s\", server.neterr);",
          "new_line_content": "    REDIS_NOTUSED(mask);",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": "redisLog",
          "new_api": "anetTcpAccept",
          "old_text": "redisLog(REDIS_VERBOSE,\"Accepted %s:%d\", cip, cport)",
          "new_text": "anetTcpAccept(server.neterr, fd, cip, &cport)",
          "old_line_content": "    redisLog(REDIS_VERBOSE,\"Accepted %s:%d\", cip, cport);",
          "new_line_content": "    cfd = anetTcpAccept(server.neterr, fd, cip, &cport);",
          "content_same": false
        },
        {
          "line": 427,
          "old_api": "REDIS_NOTUSED",
          "new_api": "acceptCommonHandler",
          "old_text": "REDIS_NOTUSED(el)",
          "new_text": "acceptCommonHandler(cfd)",
          "old_line_content": "    REDIS_NOTUSED(el);",
          "new_line_content": "    acceptCommonHandler(cfd);",
          "content_same": false
        },
        {
          "line": 433,
          "old_api": "redisLog",
          "new_api": "REDIS_NOTUSED",
          "old_text": "redisLog(REDIS_VERBOSE,\"Accepting client connection: %s\", server.neterr)",
          "new_text": "REDIS_NOTUSED(mask)",
          "old_line_content": "        redisLog(REDIS_VERBOSE,\"Accepting client connection: %s\", server.neterr);",
          "new_line_content": "    REDIS_NOTUSED(mask);",
          "content_same": false
        },
        {
          "line": 436,
          "old_api": "redisLog",
          "new_api": "anetUnixAccept",
          "old_text": "redisLog(REDIS_VERBOSE,\"Accepted connection to %s\", server.unixsocket)",
          "new_text": "anetUnixAccept(server.neterr, fd)",
          "old_line_content": "    redisLog(REDIS_VERBOSE,\"Accepted connection to %s\", server.unixsocket);",
          "new_line_content": "    cfd = anetUnixAccept(server.neterr, fd);",
          "content_same": false
        },
        {
          "line": 467,
          "old_api": "dictRelease",
          "new_api": "unwatchAllKeys",
          "old_text": "dictRelease(c->pubsub_channels)",
          "new_text": "unwatchAllKeys(c)",
          "old_line_content": "    dictRelease(c->pubsub_channels);",
          "new_line_content": "    unwatchAllKeys(c);",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": "aeDeleteFileEvent",
          "new_api": "pubsubUnsubscribeAllChannels",
          "old_text": "aeDeleteFileEvent(server.el,c->fd,AE_READABLE)",
          "new_text": "pubsubUnsubscribeAllChannels(c,0)",
          "old_line_content": "    aeDeleteFileEvent(server.el,c->fd,AE_READABLE);",
          "new_line_content": "    pubsubUnsubscribeAllChannels(c,0);",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": "aeDeleteFileEvent",
          "new_api": "pubsubUnsubscribeAllPatterns",
          "old_text": "aeDeleteFileEvent(server.el,c->fd,AE_WRITABLE)",
          "new_text": "pubsubUnsubscribeAllPatterns(c,0)",
          "old_line_content": "    aeDeleteFileEvent(server.el,c->fd,AE_WRITABLE);",
          "new_line_content": "    pubsubUnsubscribeAllPatterns(c,0);",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": "listRelease",
          "new_api": "dictRelease",
          "old_text": "listRelease(c->reply)",
          "new_text": "dictRelease(c->pubsub_channels)",
          "old_line_content": "    listRelease(c->reply);",
          "new_line_content": "    dictRelease(c->pubsub_channels);",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": "freeClientArgv",
          "new_api": "listRelease",
          "old_text": "freeClientArgv(c)",
          "new_text": "listRelease(c->pubsub_patterns)",
          "old_line_content": "    freeClientArgv(c);",
          "new_line_content": "    listRelease(c->pubsub_patterns);",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": "listSearchKey",
          "new_api": "aeDeleteFileEvent",
          "old_text": "listSearchKey(server.clients,c)",
          "new_text": "aeDeleteFileEvent(server.el,c->fd,AE_WRITABLE)",
          "old_line_content": "    ln = listSearchKey(server.clients,c);",
          "new_line_content": "    aeDeleteFileEvent(server.el,c->fd,AE_WRITABLE);",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": "redisAssert",
          "new_api": "listRelease",
          "old_text": "redisAssert(ln != NULL)",
          "new_text": "listRelease(c->reply)",
          "old_line_content": "    redisAssert(ln != NULL);",
          "new_line_content": "    listRelease(c->reply);",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": "listDelNode",
          "new_api": "freeClientArgv",
          "old_text": "listDelNode(server.clients,ln)",
          "new_text": "freeClientArgv(c)",
          "old_line_content": "    listDelNode(server.clients,ln);",
          "new_line_content": "    freeClientArgv(c);",
          "content_same": false
        },
        {
          "line": 482,
          "old_api": "listSearchKey",
          "new_api": "redisAssert",
          "old_text": "listSearchKey(server.unblocked_clients,c)",
          "new_text": "redisAssert(ln != NULL)",
          "old_line_content": "        ln = listSearchKey(server.unblocked_clients,c);",
          "new_line_content": "    redisAssert(ln != NULL);",
          "content_same": false
        },
        {
          "line": 483,
          "old_api": "redisAssert",
          "new_api": "listDelNode",
          "old_text": "redisAssert(ln != NULL)",
          "new_text": "listDelNode(server.clients,ln)",
          "old_line_content": "        redisAssert(ln != NULL);",
          "new_line_content": "    listDelNode(server.clients,ln);",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": "redisAssert",
          "new_api": "listDelNode",
          "old_text": "redisAssert(server.ds_enabled)",
          "new_text": "listDelNode(server.unblocked_clients,ln)",
          "old_line_content": "        redisAssert(server.ds_enabled);",
          "new_line_content": "        listDelNode(server.unblocked_clients,ln);",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": "redisAssert",
          "new_api": "listLength",
          "old_text": "redisAssert(ln != NULL)",
          "new_text": "listLength(c->io_keys)",
          "old_line_content": "            redisAssert(ln != NULL);",
          "new_line_content": "        if (listLength(c->io_keys) == 0) {",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": "listDelNode",
          "new_api": "listSearchKey",
          "old_text": "listDelNode(server.io_ready_clients,ln)",
          "new_text": "listSearchKey(server.io_ready_clients,c)",
          "old_line_content": "            listDelNode(server.io_ready_clients,ln);",
          "new_line_content": "            ln = listSearchKey(server.io_ready_clients,c);",
          "content_same": false
        },
        {
          "line": 500,
          "old_api": "dontWaitForSwappedKey",
          "new_api": "redisAssert",
          "old_text": "dontWaitForSwappedKey(c,ln->value)",
          "new_text": "redisAssert(ln != NULL)",
          "old_line_content": "                dontWaitForSwappedKey(c,ln->value);",
          "new_line_content": "            redisAssert(ln != NULL);",
          "content_same": false
        },
        {
          "line": 505,
          "old_api": "listRelease",
          "new_api": "dontWaitForSwappedKey",
          "old_text": "listRelease(c->io_keys)",
          "new_text": "dontWaitForSwappedKey(c,ln->value)",
          "old_line_content": "    listRelease(c->io_keys);",
          "new_line_content": "                dontWaitForSwappedKey(c,ln->value);",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": "close",
          "new_api": "listRelease",
          "old_text": "close(c->repldbfd)",
          "new_text": "listRelease(c->io_keys)",
          "old_line_content": "            close(c->repldbfd);",
          "new_line_content": "    listRelease(c->io_keys);",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": "zfree",
          "new_api": "listFirst",
          "old_text": "zfree(c->argv)",
          "new_text": "listFirst(server.slaves)",
          "old_line_content": "    zfree(c->argv);",
          "new_line_content": "            ln = listFirst(server.slaves);",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": "freeClientMultiState",
          "new_api": "freeClient",
          "old_text": "freeClientMultiState(c)",
          "new_text": "freeClient((redisClient*)ln->value)",
          "old_line_content": "    freeClientMultiState(c);",
          "new_line_content": "            freeClient((redisClient*)ln->value);",
          "content_same": false
        },
        {
          "line": 604,
          "old_api": "time",
          "new_api": "strerror",
          "old_text": "time(NULL)",
          "new_text": "strerror(errno)",
          "old_line_content": "    if (totwritten > 0) c->lastinteraction = time(NULL);",
          "new_line_content": "                \"Error writing to client: %s\", strerror(errno));",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": "listLength",
          "new_api": "freeClient",
          "old_text": "listLength(c->reply)",
          "new_text": "freeClient(c)",
          "old_line_content": "    if (listLength(c->reply) == 0) {",
          "new_line_content": "            freeClient(c);",
          "content_same": false
        },
        {
          "line": 610,
          "old_api": "freeClient",
          "new_api": "listLength",
          "old_text": "freeClient(c)",
          "new_text": "listLength(c->reply)",
          "old_line_content": "        if (c->flags & REDIS_CLOSE_AFTER_REPLY) freeClient(c);",
          "new_line_content": "    if (listLength(c->reply) == 0) {",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": "listNodeValue",
          "new_api": "time",
          "old_text": "listNodeValue(ln)",
          "new_text": "time(NULL)",
          "old_line_content": "        c = listNodeValue(ln);",
          "new_line_content": "    time_t now = time(NULL);",
          "content_same": false
        },
        {
          "line": 635,
          "old_api": "dictSize",
          "new_api": "listNodeValue",
          "old_text": "dictSize(c->pubsub_channels)",
          "new_text": "listNodeValue(ln)",
          "old_line_content": "            dictSize(c->pubsub_channels) == 0 && /* no timeout for pubsub */",
          "new_line_content": "        c = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 640,
          "old_api": "freeClient",
          "new_api": "dictSize",
          "old_text": "freeClient(c)",
          "new_text": "dictSize(c->pubsub_channels)",
          "old_line_content": "            freeClient(c);",
          "new_line_content": "            dictSize(c->pubsub_channels) == 0 && /* no timeout for pubsub */",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": "unblockClientWaitingData",
          "new_api": "redisLog",
          "old_text": "unblockClientWaitingData(c)",
          "new_text": "redisLog(REDIS_VERBOSE,\"Closing idle client\")",
          "old_line_content": "                unblockClientWaitingData(c);",
          "new_line_content": "            redisLog(REDIS_VERBOSE,\"Closing idle client\");",
          "content_same": false
        },
        {
          "line": 673,
          "old_api": "sdslen",
          "new_api": "zfree",
          "old_text": "sdslen(argv[j])",
          "new_text": "zfree(c->argv)",
          "old_line_content": "        if (sdslen(argv[j])) {",
          "new_line_content": "    if (c->argv) zfree(c->argv);",
          "content_same": false
        },
        {
          "line": 674,
          "old_api": "createObject",
          "new_api": "zmalloc",
          "old_text": "createObject(REDIS_STRING,argv[j])",
          "new_text": "zmalloc(sizeof(robj*)*argc)",
          "old_line_content": "            c->argv[c->argc] = createObject(REDIS_STRING,argv[j]);",
          "new_line_content": "    c->argv = zmalloc(sizeof(robj*)*argc);",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": "zfree",
          "new_api": "setProtocolError",
          "old_text": "zfree(c->argv)",
          "new_text": "setProtocolError(c,pos)",
          "old_line_content": "        if (c->argv) zfree(c->argv);",
          "new_line_content": "            setProtocolError(c,pos);",
          "content_same": false
        },
        {
          "line": 747,
          "old_api": "addReplyError",
          "new_api": "strtol",
          "old_text": "addReplyError(c,\"Protocol error: invalid bulk length\")",
          "new_text": "strtol(c->querybuf+pos+1,&eptr,10)",
          "old_line_content": "                    addReplyError(c,\"Protocol error: invalid bulk length\");",
          "new_line_content": "                bulklen = strtol(c->querybuf+pos+1,&eptr,10);",
          "content_same": false
        },
        {
          "line": 811,
          "old_api": "resetClient",
          "new_api": "redisPanic",
          "old_text": "resetClient(c)",
          "new_text": "redisPanic(\"Unknown request type\")",
          "old_line_content": "            resetClient(c);",
          "new_line_content": "            redisPanic(\"Unknown request type\");",
          "content_same": false
        },
        {
          "line": 832,
          "old_api": "strerror",
          "new_api": "read",
          "old_text": "strerror(errno)",
          "new_text": "read(fd, buf, REDIS_IOBUF_LEN)",
          "old_line_content": "            redisLog(REDIS_VERBOSE, \"Reading from client: %s\",strerror(errno));",
          "new_line_content": "    nread = read(fd, buf, REDIS_IOBUF_LEN);",
          "content_same": false
        },
        {
          "line": 837,
          "old_api": "redisLog",
          "new_api": "strerror",
          "old_text": "redisLog(REDIS_VERBOSE, \"Client closed connection\")",
          "new_text": "strerror(errno)",
          "old_line_content": "        redisLog(REDIS_VERBOSE, \"Client closed connection\");",
          "new_line_content": "            redisLog(REDIS_VERBOSE, \"Reading from client: %s\",strerror(errno));",
          "content_same": false
        },
        {
          "line": 842,
          "old_api": "sdscatlen",
          "new_api": "redisLog",
          "old_text": "sdscatlen(c->querybuf,buf,nread)",
          "new_text": "redisLog(REDIS_VERBOSE, \"Client closed connection\")",
          "old_line_content": "        c->querybuf = sdscatlen(c->querybuf,buf,nread);",
          "new_line_content": "        redisLog(REDIS_VERBOSE, \"Client closed connection\");",
          "content_same": false
        },
        {
          "line": 843,
          "old_api": "time",
          "new_api": "freeClient",
          "old_text": "time(NULL)",
          "new_text": "freeClient(c)",
          "old_line_content": "        c->lastinteraction = time(NULL);",
          "new_line_content": "        freeClient(c);",
          "content_same": false
        },
        {
          "line": 847,
          "old_api": "processInputBuffer",
          "new_api": "sdscatlen",
          "old_text": "processInputBuffer(c)",
          "new_text": "sdscatlen(c->querybuf,buf,nread)",
          "old_line_content": "    processInputBuffer(c);",
          "new_line_content": "        c->querybuf = sdscatlen(c->querybuf,buf,nread);",
          "content_same": false
        },
        {
          "line": 862,
          "old_api": "sdslen",
          "new_api": "listRewind",
          "old_text": "sdslen(c->querybuf)",
          "new_text": "listRewind(server.clients,&li)",
          "old_line_content": "        if (sdslen(c->querybuf) > bib) bib = sdslen(c->querybuf);",
          "new_line_content": "    listRewind(server.clients,&li);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 515,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(c->repldbfd)",
          "old_line_content": "    }",
          "new_line_content": "            close(c->repldbfd);",
          "content_same": false
        },
        {
          "line": 517,
          "old_api": null,
          "new_api": "listSearchKey",
          "old_text": null,
          "new_text": "listSearchKey(l,c)",
          "old_line_content": "    /* Case 2: we lost the connection with the master. */",
          "new_line_content": "        ln = listSearchKey(l,c);",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": null,
          "new_api": "redisAssert",
          "old_text": null,
          "new_text": "redisAssert(ln != NULL)",
          "old_line_content": "    if (c->flags & REDIS_MASTER) {",
          "new_line_content": "        redisAssert(ln != NULL);",
          "content_same": false
        },
        {
          "line": 519,
          "old_api": null,
          "new_api": "listDelNode",
          "old_text": null,
          "new_text": "listDelNode(l,ln)",
          "old_line_content": "        server.master = NULL;",
          "new_line_content": "        listDelNode(l,ln);",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(server.slaves)",
          "old_line_content": "    /* Release memory */",
          "new_line_content": "        while (listLength(server.slaves)) {",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(c->argv)",
          "old_line_content": "void sendReplyToClient(aeEventLoop *el, int fd, void *privdata, int mask) {",
          "new_line_content": "    zfree(c->argv);",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": null,
          "new_api": "freeClientMultiState",
          "old_text": null,
          "new_text": "freeClientMultiState(c)",
          "old_line_content": "    redisClient *c = privdata;",
          "new_line_content": "    freeClientMultiState(c);",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(c)",
          "old_line_content": "    int nwritten = 0, totwritten = 0, objlen;",
          "new_line_content": "    zfree(c);",
          "content_same": false
        },
        {
          "line": 546,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(el)",
          "old_line_content": "            if (c->flags & REDIS_MASTER) {",
          "new_line_content": "    REDIS_NOTUSED(el);",
          "content_same": false
        },
        {
          "line": 547,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(mask)",
          "old_line_content": "                /* Don't reply to a master */",
          "new_line_content": "    REDIS_NOTUSED(mask);",
          "content_same": false
        },
        {
          "line": 549,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(c->reply)",
          "old_line_content": "            } else {",
          "new_line_content": "    while(c->bufpos > 0 || listLength(c->reply)) {",
          "content_same": false
        },
        {
          "line": 555,
          "old_api": null,
          "new_api": "write",
          "old_text": null,
          "new_text": "write(fd,c->buf+c->sentlen,c->bufpos-c->sentlen)",
          "old_line_content": "",
          "new_line_content": "                nwritten = write(fd,c->buf+c->sentlen,c->bufpos-c->sentlen);",
          "content_same": false
        },
        {
          "line": 568,
          "old_api": null,
          "new_api": "listFirst",
          "old_text": null,
          "new_text": "listFirst(c->reply)",
          "old_line_content": "                continue;",
          "new_line_content": "            o = listNodeValue(listFirst(c->reply));",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(o->ptr)",
          "old_line_content": "            }",
          "new_line_content": "            objlen = sdslen(o->ptr);",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": null,
          "new_api": "listFirst",
          "old_text": null,
          "new_text": "listFirst(c->reply)",
          "old_line_content": "                /* Don't reply to a master */",
          "new_line_content": "                listDelNode(c->reply,listFirst(c->reply));",
          "content_same": false
        },
        {
          "line": 580,
          "old_api": null,
          "new_api": "write",
          "old_text": null,
          "new_text": "write(fd, ((char*)o->ptr)+c->sentlen,objlen-c->sentlen)",
          "old_line_content": "",
          "new_line_content": "                nwritten = write(fd, ((char*)o->ptr)+c->sentlen,objlen-c->sentlen);",
          "content_same": false
        },
        {
          "line": 588,
          "old_api": null,
          "new_api": "listFirst",
          "old_text": null,
          "new_text": "listFirst(c->reply)",
          "old_line_content": "         * bytes, in a single threaded server it's a good idea to serve",
          "new_line_content": "                listDelNode(c->reply,listFirst(c->reply));",
          "content_same": false
        },
        {
          "line": 603,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_VERBOSE,\n                \"Error writing to client: %s\", strerror(errno))",
          "old_line_content": "    }",
          "new_line_content": "            redisLog(REDIS_VERBOSE,",
          "content_same": false
        },
        {
          "line": 609,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "        /* Close connection after entire reply has been sent. */",
          "new_line_content": "    if (totwritten > 0) c->lastinteraction = time(NULL);",
          "content_same": false
        },
        {
          "line": 612,
          "old_api": null,
          "new_api": "aeDeleteFileEvent",
          "old_text": null,
          "new_text": "aeDeleteFileEvent(server.el,c->fd,AE_WRITABLE)",
          "old_line_content": "}",
          "new_line_content": "        aeDeleteFileEvent(server.el,c->fd,AE_WRITABLE);",
          "content_same": false
        },
        {
          "line": 615,
          "old_api": null,
          "new_api": "freeClient",
          "old_text": null,
          "new_text": "freeClient(c)",
          "old_line_content": "void resetClient(redisClient *c) {",
          "new_line_content": "        if (c->flags & REDIS_CLOSE_AFTER_REPLY) freeClient(c);",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": null,
          "new_api": "freeClientArgv",
          "old_text": null,
          "new_text": "freeClientArgv(c)",
          "old_line_content": "",
          "new_line_content": "    freeClientArgv(c);",
          "content_same": false
        },
        {
          "line": 633,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(server.clients,&li)",
          "old_line_content": "            !(c->flags & REDIS_MASTER) &&   /* no timeout for masters */",
          "new_line_content": "    listRewind(server.clients,&li);",
          "content_same": false
        },
        {
          "line": 634,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "            !(c->flags & REDIS_BLOCKED) &&  /* no timeout for BLPOP */",
          "new_line_content": "    while ((ln = listNext(&li)) != NULL) {",
          "content_same": false
        },
        {
          "line": 641,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(c->pubsub_patterns)",
          "old_line_content": "        } else if (c->flags & REDIS_BLOCKED) {",
          "new_line_content": "            listLength(c->pubsub_patterns) == 0 &&",
          "content_same": false
        },
        {
          "line": 645,
          "old_api": null,
          "new_api": "freeClient",
          "old_text": null,
          "new_text": "freeClient(c)",
          "old_line_content": "            }",
          "new_line_content": "            freeClient(c);",
          "content_same": false
        },
        {
          "line": 648,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.nullmultibulk)",
          "old_line_content": "}",
          "new_line_content": "                addReply(c,shared.nullmultibulk);",
          "content_same": false
        },
        {
          "line": 649,
          "old_api": null,
          "new_api": "unblockClientWaitingData",
          "old_text": null,
          "new_text": "unblockClientWaitingData(c)",
          "old_line_content": "",
          "new_line_content": "                unblockClientWaitingData(c);",
          "content_same": false
        },
        {
          "line": 656,
          "old_api": null,
          "new_api": "strstr",
          "old_text": null,
          "new_text": "strstr(c->querybuf,\"\\r\\n\")",
          "old_line_content": "    /* Nothing to do without a \\r\\n */",
          "new_line_content": "    char *newline = strstr(c->querybuf,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": null,
          "new_api": "sdssplitlen",
          "old_text": null,
          "new_text": "sdssplitlen(c->querybuf,querylen,\" \",1,&argc)",
          "old_line_content": "    /* Setup argv array on client structure */",
          "new_line_content": "    argv = sdssplitlen(c->querybuf,querylen,\" \",1,&argc);",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": null,
          "new_api": "sdsrange",
          "old_text": null,
          "new_text": "sdsrange(c->querybuf,querylen+2,-1)",
          "old_line_content": "",
          "new_line_content": "    c->querybuf = sdsrange(c->querybuf,querylen+2,-1);",
          "content_same": false
        },
        {
          "line": 678,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(argv[j])",
          "old_line_content": "        }",
          "new_line_content": "        if (sdslen(argv[j])) {",
          "content_same": false
        },
        {
          "line": 679,
          "old_api": null,
          "new_api": "createObject",
          "old_text": null,
          "new_text": "createObject(REDIS_STRING,argv[j])",
          "old_line_content": "    }",
          "new_line_content": "            c->argv[c->argc] = createObject(REDIS_STRING,argv[j]);",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(argv[j])",
          "old_line_content": "}",
          "new_line_content": "            sdsfree(argv[j]);",
          "content_same": false
        },
        {
          "line": 685,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(argv)",
          "old_line_content": " * multi bulk requests idempotent. */",
          "new_line_content": "    zfree(argv);",
          "content_same": false
        },
        {
          "line": 693,
          "old_api": null,
          "new_api": "sdsrange",
          "old_text": null,
          "new_text": "sdsrange(c->querybuf,pos,-1)",
          "old_line_content": "    char *eptr;",
          "new_line_content": "    c->querybuf = sdsrange(c->querybuf,pos,-1);",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": null,
          "new_api": "redisAssert",
          "old_text": null,
          "new_text": "redisAssert(c->argc == 0)",
          "old_line_content": "            return REDIS_ERR;",
          "new_line_content": "        redisAssert(c->argc == 0);",
          "content_same": false
        },
        {
          "line": 707,
          "old_api": null,
          "new_api": "strstr",
          "old_text": null,
          "new_text": "strstr(c->querybuf,\"\\r\\n\")",
          "old_line_content": "         * so go ahead and find out the multi bulk length. */",
          "new_line_content": "        newline = strstr(c->querybuf,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 713,
          "old_api": null,
          "new_api": "redisAssert",
          "old_text": null,
          "new_text": "redisAssert(c->querybuf[0] == '*')",
          "old_line_content": "            return REDIS_OK;",
          "new_line_content": "        redisAssert(c->querybuf[0] == '*');",
          "content_same": false
        },
        {
          "line": 714,
          "old_api": null,
          "new_api": "strtol",
          "old_text": null,
          "new_text": "strtol(c->querybuf+1,&eptr,10)",
          "old_line_content": "        } else if (c->multibulklen > 1024*1024) {",
          "new_line_content": "        c->multibulklen = strtol(c->querybuf+1,&eptr,10);",
          "content_same": false
        },
        {
          "line": 717,
          "old_api": null,
          "new_api": "sdsrange",
          "old_text": null,
          "new_text": "sdsrange(c->querybuf,pos,-1)",
          "old_line_content": "            return REDIS_ERR;",
          "new_line_content": "            c->querybuf = sdsrange(c->querybuf,pos,-1);",
          "content_same": false
        },
        {
          "line": 720,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c,\"Protocol error: invalid multibulk length\")",
          "old_line_content": "        /* Setup argv array on client structure */",
          "new_line_content": "            addReplyError(c,\"Protocol error: invalid multibulk length\");",
          "content_same": false
        },
        {
          "line": 726,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(c->argv)",
          "old_line_content": "    }",
          "new_line_content": "        if (c->argv) zfree(c->argv);",
          "content_same": false
        },
        {
          "line": 727,
          "old_api": null,
          "new_api": "zmalloc",
          "old_text": null,
          "new_text": "zmalloc(sizeof(robj*)*c->multibulklen)",
          "old_line_content": "",
          "new_line_content": "        c->argv = zmalloc(sizeof(robj*)*c->multibulklen);",
          "content_same": false
        },
        {
          "line": 730,
          "old_api": null,
          "new_api": "strstr",
          "old_text": null,
          "new_text": "strstr(c->querybuf+pos,\"\\r\\n\")",
          "old_line_content": "        /* Read bulk length if unknown */",
          "new_line_content": "        newline = strstr(c->querybuf+pos,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 733,
          "old_api": null,
          "new_api": "redisAssert",
          "old_text": null,
          "new_text": "redisAssert(c->multibulklen > 0)",
          "old_line_content": "            if (newline != NULL) {",
          "new_line_content": "    redisAssert(c->multibulklen > 0);",
          "content_same": false
        },
        {
          "line": 737,
          "old_api": null,
          "new_api": "strstr",
          "old_text": null,
          "new_text": "strstr(c->querybuf+pos,\"\\r\\n\")",
          "old_line_content": "                        c->querybuf[pos]);",
          "new_line_content": "            newline = strstr(c->querybuf+pos,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 740,
          "old_api": null,
          "new_api": "addReplyErrorFormat",
          "old_text": null,
          "new_text": "addReplyErrorFormat(c,\n                        \"Protocol error: expected '$', got '%c'\",\n                        c->querybuf[pos])",
          "old_line_content": "                }",
          "new_line_content": "                    addReplyErrorFormat(c,",
          "content_same": false
        },
        {
          "line": 743,
          "old_api": null,
          "new_api": "setProtocolError",
          "old_text": null,
          "new_text": "setProtocolError(c,pos)",
          "old_line_content": "                tolerr = (eptr[0] != '\\r');",
          "new_line_content": "                    setProtocolError(c,pos);",
          "content_same": false
        },
        {
          "line": 752,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c,\"Protocol error: invalid bulk length\")",
          "old_line_content": "                c->bulklen = bulklen;",
          "new_line_content": "                    addReplyError(c,\"Protocol error: invalid bulk length\");",
          "content_same": false
        },
        {
          "line": 753,
          "old_api": null,
          "new_api": "setProtocolError",
          "old_text": null,
          "new_text": "setProtocolError(c,pos)",
          "old_line_content": "            } else {",
          "new_line_content": "                    setProtocolError(c,pos);",
          "content_same": false
        },
        {
          "line": 765,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(c->querybuf)",
          "old_line_content": "            pos += c->bulklen+2;",
          "new_line_content": "        if (sdslen(c->querybuf)-pos < (unsigned)(c->bulklen+2)) {",
          "content_same": false
        },
        {
          "line": 769,
          "old_api": null,
          "new_api": "createStringObject",
          "old_text": null,
          "new_text": "createStringObject(c->querybuf+pos,c->bulklen)",
          "old_line_content": "    }",
          "new_line_content": "            c->argv[c->argc++] = createStringObject(c->querybuf+pos,c->bulklen);",
          "content_same": false
        },
        {
          "line": 777,
          "old_api": null,
          "new_api": "sdsrange",
          "old_text": null,
          "new_text": "sdsrange(c->querybuf,pos,-1)",
          "old_line_content": "    }",
          "new_line_content": "    c->querybuf = sdsrange(c->querybuf,pos,-1);",
          "content_same": false
        },
        {
          "line": 788,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(c->querybuf)",
          "old_line_content": "         * written to the client. Make sure to not let the reply grow after",
          "new_line_content": "    while(sdslen(c->querybuf)) {",
          "content_same": false
        },
        {
          "line": 807,
          "old_api": null,
          "new_api": "processInlineBuffer",
          "old_text": null,
          "new_text": "processInlineBuffer(c)",
          "old_line_content": "        }",
          "new_line_content": "            if (processInlineBuffer(c) != REDIS_OK) break;",
          "content_same": false
        },
        {
          "line": 809,
          "old_api": null,
          "new_api": "processMultibulkBuffer",
          "old_text": null,
          "new_text": "processMultibulkBuffer(c)",
          "old_line_content": "        /* Multibulk processing could see a <= 0 length. */",
          "new_line_content": "            if (processMultibulkBuffer(c) != REDIS_OK) break;",
          "content_same": false
        },
        {
          "line": 816,
          "old_api": null,
          "new_api": "resetClient",
          "old_text": null,
          "new_text": "resetClient(c)",
          "old_line_content": "        }",
          "new_line_content": "            resetClient(c);",
          "content_same": false
        },
        {
          "line": 819,
          "old_api": null,
          "new_api": "processCommand",
          "old_text": null,
          "new_text": "processCommand(c)",
          "old_line_content": "",
          "new_line_content": "            if (processCommand(c) == REDIS_OK)",
          "content_same": false
        },
        {
          "line": 820,
          "old_api": null,
          "new_api": "resetClient",
          "old_text": null,
          "new_text": "resetClient(c)",
          "old_line_content": "void readQueryFromClient(aeEventLoop *el, int fd, void *privdata, int mask) {",
          "new_line_content": "                resetClient(c);",
          "content_same": false
        },
        {
          "line": 829,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(el)",
          "old_line_content": "        if (errno == EAGAIN) {",
          "new_line_content": "    REDIS_NOTUSED(el);",
          "content_same": false
        },
        {
          "line": 830,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(mask)",
          "old_line_content": "            nread = 0;",
          "new_line_content": "    REDIS_NOTUSED(mask);",
          "content_same": false
        },
        {
          "line": 325,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.czero)",
          "old_line_content": "}",
          "new_line_content": "        addReply(c,shared.czero);",
          "content_same": false
        },
        {
          "line": 327,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.cone)",
          "old_line_content": "void addReplyMultiBulkLen(redisClient *c, long length) {",
          "new_line_content": "        addReply(c,shared.cone);",
          "content_same": false
        },
        {
          "line": 329,
          "old_api": null,
          "new_api": "_addReplyLongLong",
          "old_text": null,
          "new_text": "_addReplyLongLong(c,ll,':')",
          "old_line_content": "}",
          "new_line_content": "        _addReplyLongLong(c,ll,':');",
          "content_same": false
        },
        {
          "line": 333,
          "old_api": null,
          "new_api": "_addReplyLongLong",
          "old_text": null,
          "new_text": "_addReplyLongLong(c,length,'*')",
          "old_line_content": "    size_t len;",
          "new_line_content": "    _addReplyLongLong(c,length,'*');",
          "content_same": false
        },
        {
          "line": 848,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "}",
          "new_line_content": "        c->lastinteraction = time(NULL);",
          "content_same": false
        },
        {
          "line": 852,
          "old_api": null,
          "new_api": "processInputBuffer",
          "old_text": null,
          "new_text": "processInputBuffer(c)",
          "old_line_content": "    redisClient *c;",
          "new_line_content": "    processInputBuffer(c);",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(obj->ptr)",
          "old_line_content": "        len = 1;",
          "new_line_content": "        len = sdslen(obj->ptr);",
          "content_same": false
        },
        {
          "line": 863,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "    }",
          "new_line_content": "    while ((ln = listNext(&li)) != NULL) {",
          "content_same": false
        },
        {
          "line": 864,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "    *longest_output_list = lol;",
          "new_line_content": "        c = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 866,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(c->reply)",
          "old_line_content": "}",
          "new_line_content": "        if (listLength(c->reply) > lol) lol = listLength(c->reply);",
          "content_same": false
        },
        {
          "line": 867,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(c->querybuf)",
          "old_line_content": "",
          "new_line_content": "        if (sdslen(c->querybuf) > bib) bib = sdslen(c->querybuf);",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": null,
          "new_api": "addReplyBulkLen",
          "old_text": null,
          "new_text": "addReplyBulkLen(c,obj)",
          "old_line_content": "/* Add a C buffer as bulk reply */",
          "new_line_content": "    addReplyBulkLen(c,obj);",
          "content_same": false
        },
        {
          "line": 361,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,obj)",
          "old_line_content": "void addReplyBulkCBuffer(redisClient *c, void *p, size_t len) {",
          "new_line_content": "    addReply(c,obj);",
          "content_same": false
        },
        {
          "line": 367,
          "old_api": null,
          "new_api": "_addReplyLongLong",
          "old_text": null,
          "new_text": "_addReplyLongLong(c,len,'$')",
          "old_line_content": "/* Add a C nul term string as bulk reply */",
          "new_line_content": "    _addReplyLongLong(c,len,'$');",
          "content_same": false
        },
        {
          "line": 368,
          "old_api": null,
          "new_api": "addReplyString",
          "old_text": null,
          "new_text": "addReplyString(c,p,len)",
          "old_line_content": "void addReplyBulkCString(redisClient *c, char *s) {",
          "new_line_content": "    addReplyString(c,p,len);",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.crlf)",
          "old_line_content": "    if (s == NULL) {",
          "new_line_content": "    addReply(c,shared.crlf);",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.nullbulk)",
          "old_line_content": "",
          "new_line_content": "        addReply(c,shared.nullbulk);",
          "content_same": false
        },
        {
          "line": 377,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(s)",
          "old_line_content": "void addReplyBulkLongLong(redisClient *c, long long ll) {",
          "new_line_content": "        addReplyBulkCBuffer(c,s,strlen(s));",
          "content_same": false
        },
        {
          "line": 386,
          "old_api": null,
          "new_api": "ll2string",
          "old_text": null,
          "new_text": "ll2string(buf,64,ll)",
          "old_line_content": "    redisClient *c;",
          "new_line_content": "    len = ll2string(buf,64,ll);",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": null,
          "new_api": "createClient",
          "old_text": null,
          "new_text": "createClient(fd)",
          "old_line_content": "    /* If maxclient directive is set and this is one client more... close the",
          "new_line_content": "    if ((c = createClient(fd)) == NULL) {",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"Error allocating resoures for the client\")",
          "old_line_content": "     * connection. Note that we create the client instead to check before",
          "new_line_content": "        redisLog(REDIS_WARNING,\"Error allocating resoures for the client\");",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "     * for this condition, since now the socket is already set in nonblocking",
          "new_line_content": "        close(fd); /* May be already closed, just ingore errors */",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(server.clients)",
          "old_line_content": "            /* Nothing to do, Just to avoid the warning... */",
          "new_line_content": "    if (server.maxclients && listLength(server.clients) > server.maxclients) {",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(err)",
          "old_line_content": "    }",
          "new_line_content": "        if (write(c->fd,err,strlen(err)) == -1) {",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": null,
          "new_api": "freeClient",
          "old_text": null,
          "new_text": "freeClient(c)",
          "old_line_content": "",
          "new_line_content": "        freeClient(c);",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(el)",
          "old_line_content": "    if (cfd == AE_ERR) {",
          "new_line_content": "    REDIS_NOTUSED(el);",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(privdata)",
          "old_line_content": "        return;",
          "new_line_content": "    REDIS_NOTUSED(privdata);",
          "content_same": false
        },
        {
          "line": 423,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_VERBOSE,\"Accepting client connection: %s\", server.neterr)",
          "old_line_content": "}",
          "new_line_content": "        redisLog(REDIS_VERBOSE,\"Accepting client connection: %s\", server.neterr);",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_VERBOSE,\"Accepted %s:%d\", cip, cport)",
          "old_line_content": "    int cfd;",
          "new_line_content": "    redisLog(REDIS_VERBOSE,\"Accepted %s:%d\", cip, cport);",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(el)",
          "old_line_content": "    if (cfd == AE_ERR) {",
          "new_line_content": "    REDIS_NOTUSED(el);",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(privdata)",
          "old_line_content": "        return;",
          "new_line_content": "    REDIS_NOTUSED(privdata);",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_VERBOSE,\"Accepting client connection: %s\", server.neterr)",
          "old_line_content": "}",
          "new_line_content": "        redisLog(REDIS_VERBOSE,\"Accepting client connection: %s\", server.neterr);",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_VERBOSE,\"Accepted connection to %s\", server.unixsocket)",
          "old_line_content": "static void freeClientArgv(redisClient *c) {",
          "new_line_content": "    redisLog(REDIS_VERBOSE,\"Accepted connection to %s\", server.unixsocket);",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": null,
          "new_api": "acceptCommonHandler",
          "old_text": null,
          "new_text": "acceptCommonHandler(cfd)",
          "old_line_content": "    int j;",
          "new_line_content": "    acceptCommonHandler(cfd);",
          "content_same": false
        },
        {
          "line": 449,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(c->argv[j])",
          "old_line_content": "    listNode *ln;",
          "new_line_content": "        decrRefCount(c->argv[j]);",
          "content_same": false
        },
        {
          "line": 461,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(c->querybuf)",
          "old_line_content": "    /* UNWATCH all the keys */",
          "new_line_content": "    sdsfree(c->querybuf);",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": null,
          "new_api": "unblockClientWaitingData",
          "old_text": null,
          "new_text": "unblockClientWaitingData(c)",
          "old_line_content": "    /* Unsubscribe from all the pubsub channels */",
          "new_line_content": "        unblockClientWaitingData(c);",
          "content_same": false
        },
        {
          "line": 475,
          "old_api": null,
          "new_api": "aeDeleteFileEvent",
          "old_text": null,
          "new_text": "aeDeleteFileEvent(server.el,c->fd,AE_READABLE)",
          "old_line_content": "    /* Remove from the list of clients */",
          "new_line_content": "    aeDeleteFileEvent(server.el,c->fd,AE_READABLE);",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(c->fd)",
          "old_line_content": "    /* When client was just unblocked because of a blocking operation,",
          "new_line_content": "    close(c->fd);",
          "content_same": false
        },
        {
          "line": 481,
          "old_api": null,
          "new_api": "listSearchKey",
          "old_text": null,
          "new_text": "listSearchKey(server.clients,c)",
          "old_line_content": "    if (c->flags & REDIS_UNBLOCKED) {",
          "new_line_content": "    ln = listSearchKey(server.clients,c);",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": null,
          "new_api": "listSearchKey",
          "old_text": null,
          "new_text": "listSearchKey(server.unblocked_clients,c)",
          "old_line_content": "     * to be restarted, but not yet woken up again. */",
          "new_line_content": "        ln = listSearchKey(server.unblocked_clients,c);",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": null,
          "new_api": "redisAssert",
          "old_text": null,
          "new_text": "redisAssert(ln != NULL)",
          "old_line_content": "    if (c->flags & REDIS_IO_WAIT) {",
          "new_line_content": "        redisAssert(ln != NULL);",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": null,
          "new_api": "redisAssert",
          "old_text": null,
          "new_text": "redisAssert(server.ds_enabled)",
          "old_line_content": "             * it should be present in the list io_ready_clients */",
          "new_line_content": "        redisAssert(server.ds_enabled);",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": null,
          "new_api": "listDelNode",
          "old_text": null,
          "new_text": "listDelNode(server.io_ready_clients,ln)",
          "old_line_content": "            }",
          "new_line_content": "            listDelNode(server.io_ready_clients,ln);",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(c->io_keys)",
          "old_line_content": "        server.cache_blocked_clients--;",
          "new_line_content": "            while (listLength(c->io_keys)) {",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": null,
          "new_api": "listFirst",
          "old_text": null,
          "new_text": "listFirst(c->io_keys)",
          "old_line_content": "    }",
          "new_line_content": "                ln = listFirst(c->io_keys);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 512,
          "old_api": "listSearchKey",
          "new_api": null,
          "old_text": "listSearchKey(l,c)",
          "new_text": null,
          "old_line_content": "        ln = listSearchKey(l,c);",
          "new_line_content": "     * Case 1: we lost the connection with a slave. */",
          "content_same": false
        },
        {
          "line": 513,
          "old_api": "redisAssert",
          "new_api": null,
          "old_text": "redisAssert(ln != NULL)",
          "new_text": null,
          "old_line_content": "        redisAssert(ln != NULL);",
          "new_line_content": "    if (c->flags & REDIS_SLAVE) {",
          "content_same": false
        },
        {
          "line": 514,
          "old_api": "listDelNode",
          "new_api": null,
          "old_text": "listDelNode(l,ln)",
          "new_text": null,
          "old_line_content": "        listDelNode(l,ln);",
          "new_line_content": "        if (c->replstate == REDIS_REPL_SEND_BULK && c->repldbfd != -1)",
          "content_same": false
        },
        {
          "line": 526,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(server.slaves)",
          "new_text": null,
          "old_line_content": "        while (listLength(server.slaves)) {",
          "new_line_content": "        /* Since we lost the connection with the master, we should also",
          "content_same": false
        },
        {
          "line": 527,
          "old_api": "listFirst",
          "new_api": null,
          "old_text": "listFirst(server.slaves)",
          "new_text": null,
          "old_line_content": "            ln = listFirst(server.slaves);",
          "new_line_content": "         * close the connection with all our slaves if we have any, so",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient((redisClient*)ln->value)",
          "new_text": null,
          "old_line_content": "            freeClient((redisClient*)ln->value);",
          "new_line_content": "         * when we'll resync with the master the other slaves will sync again",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": "zfree",
          "new_api": null,
          "old_text": "zfree(c)",
          "new_text": null,
          "old_line_content": "    zfree(c);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(el)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(el);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(mask)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(mask);",
          "new_line_content": "void sendReplyToClient(aeEventLoop *el, int fd, void *privdata, int mask) {",
          "content_same": false
        },
        {
          "line": 544,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(c->reply)",
          "new_text": null,
          "old_line_content": "    while(c->bufpos > 0 || listLength(c->reply)) {",
          "new_line_content": "    int nwritten = 0, totwritten = 0, objlen;",
          "content_same": false
        },
        {
          "line": 550,
          "old_api": "write",
          "new_api": null,
          "old_text": "write(fd,c->buf+c->sentlen,c->bufpos-c->sentlen)",
          "new_text": null,
          "old_line_content": "                nwritten = write(fd,c->buf+c->sentlen,c->bufpos-c->sentlen);",
          "new_line_content": "        if (c->bufpos > 0) {",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": "listFirst",
          "new_api": null,
          "old_text": "listFirst(c->reply)",
          "new_text": null,
          "old_line_content": "            o = listNodeValue(listFirst(c->reply));",
          "new_line_content": "            if (c->sentlen == c->bufpos) {",
          "content_same": false
        },
        {
          "line": 564,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(o->ptr)",
          "new_text": null,
          "old_line_content": "            objlen = sdslen(o->ptr);",
          "new_line_content": "                c->bufpos = 0;",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": "listFirst",
          "new_api": null,
          "old_text": "listFirst(c->reply)",
          "new_text": null,
          "old_line_content": "                listDelNode(c->reply,listFirst(c->reply));",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": "write",
          "new_api": null,
          "old_text": "write(fd, ((char*)o->ptr)+c->sentlen,objlen-c->sentlen)",
          "new_text": null,
          "old_line_content": "                nwritten = write(fd, ((char*)o->ptr)+c->sentlen,objlen-c->sentlen);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": "listFirst",
          "new_api": null,
          "old_text": "listFirst(c->reply)",
          "new_text": null,
          "old_line_content": "                listDelNode(c->reply,listFirst(c->reply));",
          "new_line_content": "            c->sentlen += nwritten;",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_VERBOSE,\n                \"Error writing to client: %s\", strerror(errno))",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_VERBOSE,",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "                \"Error writing to client: %s\", strerror(errno));",
          "new_line_content": "    if (nwritten == -1) {",
          "content_same": false
        },
        {
          "line": 600,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient(c)",
          "new_text": null,
          "old_line_content": "            freeClient(c);",
          "new_line_content": "        if (errno == EAGAIN) {",
          "content_same": false
        },
        {
          "line": 607,
          "old_api": "aeDeleteFileEvent",
          "new_api": null,
          "old_text": "aeDeleteFileEvent(server.el,c->fd,AE_WRITABLE)",
          "new_text": null,
          "old_line_content": "        aeDeleteFileEvent(server.el,c->fd,AE_WRITABLE);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 616,
          "old_api": "freeClientArgv",
          "new_api": null,
          "old_text": "freeClientArgv(c)",
          "new_text": null,
          "old_line_content": "    freeClientArgv(c);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 625,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "    time_t now = time(NULL);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 628,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(server.clients,&li)",
          "new_text": null,
          "old_line_content": "    listRewind(server.clients,&li);",
          "new_line_content": "    redisClient *c;",
          "content_same": false
        },
        {
          "line": 629,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "    while ((ln = listNext(&li)) != NULL) {",
          "new_line_content": "    listNode *ln;",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(c->pubsub_patterns)",
          "new_text": null,
          "old_line_content": "            listLength(c->pubsub_patterns) == 0 &&",
          "new_line_content": "        if (server.maxidletime &&",
          "content_same": false
        },
        {
          "line": 639,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_VERBOSE,\"Closing idle client\")",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_VERBOSE,\"Closing idle client\");",
          "new_line_content": "            !(c->flags & REDIS_BLOCKED) &&  /* no timeout for BLPOP */",
          "content_same": false
        },
        {
          "line": 643,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.nullmultibulk)",
          "new_text": null,
          "old_line_content": "                addReply(c,shared.nullmultibulk);",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 651,
          "old_api": "strstr",
          "new_api": null,
          "old_text": "strstr(c->querybuf,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "    char *newline = strstr(c->querybuf,\"\\r\\n\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": "sdssplitlen",
          "new_api": null,
          "old_text": "sdssplitlen(c->querybuf,querylen,\" \",1,&argc)",
          "new_text": null,
          "old_line_content": "    argv = sdssplitlen(c->querybuf,querylen,\" \",1,&argc);",
          "new_line_content": "    if (newline == NULL)",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": "sdsrange",
          "new_api": null,
          "old_text": "sdsrange(c->querybuf,querylen+2,-1)",
          "new_text": null,
          "old_line_content": "    c->querybuf = sdsrange(c->querybuf,querylen+2,-1);",
          "new_line_content": "    /* Split the input buffer up to the \\r\\n */",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": "zfree",
          "new_api": null,
          "old_text": "zfree(c->argv)",
          "new_text": null,
          "old_line_content": "    if (c->argv) zfree(c->argv);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": "zmalloc",
          "new_api": null,
          "old_text": "zmalloc(sizeof(robj*)*argc)",
          "new_text": null,
          "old_line_content": "    c->argv = zmalloc(sizeof(robj*)*argc);",
          "new_line_content": "    /* Leave data after the first line of the query in the buffer */",
          "content_same": false
        },
        {
          "line": 677,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(argv[j])",
          "new_text": null,
          "old_line_content": "            sdsfree(argv[j]);",
          "new_line_content": "    for (c->argc = 0, j = 0; j < argc; j++) {",
          "content_same": false
        },
        {
          "line": 680,
          "old_api": "zfree",
          "new_api": null,
          "old_text": "zfree(argv)",
          "new_text": null,
          "old_line_content": "    zfree(argv);",
          "new_line_content": "            c->argc++;",
          "content_same": false
        },
        {
          "line": 688,
          "old_api": "sdsrange",
          "new_api": null,
          "old_text": "sdsrange(c->querybuf,pos,-1)",
          "new_text": null,
          "old_line_content": "    c->querybuf = sdsrange(c->querybuf,pos,-1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 699,
          "old_api": "redisAssert",
          "new_api": null,
          "old_text": "redisAssert(c->argc == 0)",
          "new_text": null,
          "old_line_content": "        redisAssert(c->argc == 0);",
          "new_line_content": "    int pos = 0, tolerr;",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": "strstr",
          "new_api": null,
          "old_text": "strstr(c->querybuf,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        newline = strstr(c->querybuf,\"\\r\\n\");",
          "new_line_content": "    if (c->multibulklen == 0) {",
          "content_same": false
        },
        {
          "line": 708,
          "old_api": "redisAssert",
          "new_api": null,
          "old_text": "redisAssert(c->querybuf[0] == '*')",
          "new_text": null,
          "old_line_content": "        redisAssert(c->querybuf[0] == '*');",
          "new_line_content": "        if (newline == NULL)",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": "strtol",
          "new_api": null,
          "old_text": "strtol(c->querybuf+1,&eptr,10)",
          "new_text": null,
          "old_line_content": "        c->multibulklen = strtol(c->querybuf+1,&eptr,10);",
          "new_line_content": "            return REDIS_ERR;",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": "sdsrange",
          "new_api": null,
          "old_text": "sdsrange(c->querybuf,pos,-1)",
          "new_text": null,
          "old_line_content": "            c->querybuf = sdsrange(c->querybuf,pos,-1);",
          "new_line_content": "         * so go ahead and find out the multi bulk length. */",
          "content_same": false
        },
        {
          "line": 715,
          "old_api": "addReplyError",
          "new_api": null,
          "old_text": "addReplyError(c,\"Protocol error: invalid multibulk length\")",
          "new_text": null,
          "old_line_content": "            addReplyError(c,\"Protocol error: invalid multibulk length\");",
          "new_line_content": "        pos = (newline-c->querybuf)+2;",
          "content_same": false
        },
        {
          "line": 716,
          "old_api": "setProtocolError",
          "new_api": null,
          "old_text": "setProtocolError(c,pos)",
          "new_text": null,
          "old_line_content": "            setProtocolError(c,pos);",
          "new_line_content": "        if (c->multibulklen <= 0) {",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": "zmalloc",
          "new_api": null,
          "old_text": "zmalloc(sizeof(robj*)*c->multibulklen)",
          "new_text": null,
          "old_line_content": "        c->argv = zmalloc(sizeof(robj*)*c->multibulklen);",
          "new_line_content": "            return REDIS_ERR;",
          "content_same": false
        },
        {
          "line": 725,
          "old_api": "strstr",
          "new_api": null,
          "old_text": "strstr(c->querybuf+pos,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        newline = strstr(c->querybuf+pos,\"\\r\\n\");",
          "new_line_content": "        /* Setup argv array on client structure */",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "redisAssert",
          "new_api": null,
          "old_text": "redisAssert(c->multibulklen > 0)",
          "new_text": null,
          "old_line_content": "    redisAssert(c->multibulklen > 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 732,
          "old_api": "strstr",
          "new_api": null,
          "old_text": "strstr(c->querybuf+pos,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "            newline = strstr(c->querybuf+pos,\"\\r\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": "addReplyErrorFormat",
          "new_api": null,
          "old_text": "addReplyErrorFormat(c,\n                        \"Protocol error: expected '$', got '%c'\",\n                        c->querybuf[pos])",
          "new_text": null,
          "old_line_content": "                    addReplyErrorFormat(c,",
          "new_line_content": "        /* Read bulk length if unknown */",
          "content_same": false
        },
        {
          "line": 738,
          "old_api": "setProtocolError",
          "new_api": null,
          "old_text": "setProtocolError(c,pos)",
          "new_text": null,
          "old_line_content": "                    setProtocolError(c,pos);",
          "new_line_content": "            if (newline != NULL) {",
          "content_same": false
        },
        {
          "line": 742,
          "old_api": "strtol",
          "new_api": null,
          "old_text": "strtol(c->querybuf+pos+1,&eptr,10)",
          "new_text": null,
          "old_line_content": "                bulklen = strtol(c->querybuf+pos+1,&eptr,10);",
          "new_line_content": "                        c->querybuf[pos]);",
          "content_same": false
        },
        {
          "line": 748,
          "old_api": "setProtocolError",
          "new_api": null,
          "old_text": "setProtocolError(c,pos)",
          "new_text": null,
          "old_line_content": "                    setProtocolError(c,pos);",
          "new_line_content": "                tolerr = (eptr[0] != '\\r');",
          "content_same": false
        },
        {
          "line": 760,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(c->querybuf)",
          "new_text": null,
          "old_line_content": "        if (sdslen(c->querybuf)-pos < (unsigned)(c->bulklen+2)) {",
          "new_line_content": "                break;",
          "content_same": false
        },
        {
          "line": 764,
          "old_api": "createStringObject",
          "new_api": null,
          "old_text": "createStringObject(c->querybuf+pos,c->bulklen)",
          "new_text": null,
          "old_line_content": "            c->argv[c->argc++] = createStringObject(c->querybuf+pos,c->bulklen);",
          "new_line_content": "        /* Read bulk argument */",
          "content_same": false
        },
        {
          "line": 772,
          "old_api": "sdsrange",
          "new_api": null,
          "old_text": "sdsrange(c->querybuf,pos,-1)",
          "new_text": null,
          "old_line_content": "    c->querybuf = sdsrange(c->querybuf,pos,-1);",
          "new_line_content": "            c->multibulklen--;",
          "content_same": false
        },
        {
          "line": 783,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(c->querybuf)",
          "new_text": null,
          "old_line_content": "    while(sdslen(c->querybuf)) {",
          "new_line_content": "    return REDIS_ERR;",
          "content_same": false
        },
        {
          "line": 802,
          "old_api": "processInlineBuffer",
          "new_api": null,
          "old_text": "processInlineBuffer(c)",
          "new_text": null,
          "old_line_content": "            if (processInlineBuffer(c) != REDIS_OK) break;",
          "new_line_content": "                c->reqtype = REDIS_REQ_INLINE;",
          "content_same": false
        },
        {
          "line": 804,
          "old_api": "processMultibulkBuffer",
          "new_api": null,
          "old_text": "processMultibulkBuffer(c)",
          "new_text": null,
          "old_line_content": "            if (processMultibulkBuffer(c) != REDIS_OK) break;",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 806,
          "old_api": "redisPanic",
          "new_api": null,
          "old_text": "redisPanic(\"Unknown request type\")",
          "new_text": null,
          "old_line_content": "            redisPanic(\"Unknown request type\");",
          "new_line_content": "        if (c->reqtype == REDIS_REQ_INLINE) {",
          "content_same": false
        },
        {
          "line": 814,
          "old_api": "processCommand",
          "new_api": null,
          "old_text": "processCommand(c)",
          "new_text": null,
          "old_line_content": "            if (processCommand(c) == REDIS_OK)",
          "new_line_content": "        /* Multibulk processing could see a <= 0 length. */",
          "content_same": false
        },
        {
          "line": 815,
          "old_api": "resetClient",
          "new_api": null,
          "old_text": "resetClient(c)",
          "new_text": null,
          "old_line_content": "                resetClient(c);",
          "new_line_content": "        if (c->argc == 0) {",
          "content_same": false
        },
        {
          "line": 824,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(el)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(el);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 825,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(mask)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(mask);",
          "new_line_content": "void readQueryFromClient(aeEventLoop *el, int fd, void *privdata, int mask) {",
          "content_same": false
        },
        {
          "line": 827,
          "old_api": "read",
          "new_api": null,
          "old_text": "read(fd, buf, REDIS_IOBUF_LEN)",
          "new_text": null,
          "old_line_content": "    nread = read(fd, buf, REDIS_IOBUF_LEN);",
          "new_line_content": "    char buf[REDIS_IOBUF_LEN];",
          "content_same": false
        },
        {
          "line": 833,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient(c)",
          "new_text": null,
          "old_line_content": "            freeClient(c);",
          "new_line_content": "    if (nread == -1) {",
          "content_same": false
        },
        {
          "line": 324,
          "old_api": "_addReplyLongLong",
          "new_api": null,
          "old_text": "_addReplyLongLong(c,ll,':')",
          "new_text": null,
          "old_line_content": "    _addReplyLongLong(c,ll,':');",
          "new_line_content": "    if (ll == 0)",
          "content_same": false
        },
        {
          "line": 328,
          "old_api": "_addReplyLongLong",
          "new_api": null,
          "old_text": "_addReplyLongLong(c,length,'*')",
          "new_text": null,
          "old_line_content": "    _addReplyLongLong(c,length,'*');",
          "new_line_content": "    else",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(obj->ptr)",
          "new_text": null,
          "old_line_content": "        len = sdslen(obj->ptr);",
          "new_line_content": "/* Create the length prefix of a bulk reply, example: $2234 */",
          "content_same": false
        },
        {
          "line": 857,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(server.clients,&li)",
          "new_text": null,
          "old_line_content": "    listRewind(server.clients,&li);",
          "new_line_content": "    redisClient *c;",
          "content_same": false
        },
        {
          "line": 858,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "    while ((ln = listNext(&li)) != NULL) {",
          "new_line_content": "    listNode *ln;",
          "content_same": false
        },
        {
          "line": 859,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "        c = listNodeValue(ln);",
          "new_line_content": "    listIter li;",
          "content_same": false
        },
        {
          "line": 861,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(c->reply)",
          "new_text": null,
          "old_line_content": "        if (listLength(c->reply) > lol) lol = listLength(c->reply);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 350,
          "old_api": "_addReplyLongLong",
          "new_api": null,
          "old_text": "_addReplyLongLong(c,len,'$')",
          "new_text": null,
          "old_line_content": "    _addReplyLongLong(c,len,'$');",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 356,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,obj)",
          "new_text": null,
          "old_line_content": "    addReply(c,obj);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.crlf)",
          "new_text": null,
          "old_line_content": "    addReply(c,shared.crlf);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 363,
          "old_api": "addReplyString",
          "new_api": null,
          "old_text": "addReplyString(c,p,len)",
          "new_text": null,
          "old_line_content": "    addReplyString(c,p,len);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 364,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.crlf)",
          "new_text": null,
          "old_line_content": "    addReply(c,shared.crlf);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.nullbulk)",
          "new_text": null,
          "old_line_content": "        addReply(c,shared.nullbulk);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(s)",
          "new_text": null,
          "old_line_content": "        addReplyBulkCBuffer(c,s,strlen(s));",
          "new_line_content": "/* Add a C nul term string as bulk reply */",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": "ll2string",
          "new_api": null,
          "old_text": "ll2string(buf,64,ll)",
          "new_text": null,
          "old_line_content": "    len = ll2string(buf,64,ll);",
          "new_line_content": "/* Add a long long as a bulk reply */",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": "addReplyBulkCBuffer",
          "new_api": null,
          "old_text": "addReplyBulkCBuffer(c,buf,len)",
          "new_text": null,
          "old_line_content": "    addReplyBulkCBuffer(c,buf,len);",
          "new_line_content": "void addReplyBulkLongLong(redisClient *c, long long ll) {",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"Error allocating resoures for the client\")",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_WARNING,\"Error allocating resoures for the client\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fd)",
          "new_text": null,
          "old_line_content": "        close(fd); /* May be already closed, just ingore errors */",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(server.clients)",
          "new_text": null,
          "old_line_content": "    if (server.maxclients && listLength(server.clients) > server.maxclients) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(err)",
          "new_text": null,
          "old_line_content": "        if (write(c->fd,err,strlen(err)) == -1) {",
          "new_line_content": "     * mode and we can send an error for free using the Kernel I/O */",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient(c)",
          "new_text": null,
          "old_line_content": "        freeClient(c);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(el)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(el);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(mask)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(mask);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(privdata)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(privdata);",
          "new_line_content": "void acceptTcpHandler(aeEventLoop *el, int fd, void *privdata, int mask) {",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": "anetTcpAccept",
          "new_api": null,
          "old_text": "anetTcpAccept(server.neterr, fd, cip, &cport)",
          "new_text": null,
          "old_line_content": "    cfd = anetTcpAccept(server.neterr, fd, cip, &cport);",
          "new_line_content": "    char cip[128];",
          "content_same": false
        },
        {
          "line": 422,
          "old_api": "acceptCommonHandler",
          "new_api": null,
          "old_text": "acceptCommonHandler(cfd)",
          "new_text": null,
          "old_line_content": "    acceptCommonHandler(cfd);",
          "new_line_content": "    if (cfd == AE_ERR) {",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(mask)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(mask);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 429,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(privdata)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(privdata);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": "anetUnixAccept",
          "new_api": null,
          "old_text": "anetUnixAccept(server.neterr, fd)",
          "new_text": null,
          "old_line_content": "    cfd = anetUnixAccept(server.neterr, fd);",
          "new_line_content": "    int cfd;",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "acceptCommonHandler",
          "new_api": null,
          "old_text": "acceptCommonHandler(cfd)",
          "new_text": null,
          "old_line_content": "    acceptCommonHandler(cfd);",
          "new_line_content": "    if (cfd == AE_ERR) {",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": "decrRefCount",
          "new_api": null,
          "old_text": "decrRefCount(c->argv[j])",
          "new_text": null,
          "old_line_content": "        decrRefCount(c->argv[j]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(c->querybuf)",
          "new_text": null,
          "old_line_content": "    sdsfree(c->querybuf);",
          "new_line_content": "    /* Note that if the client we are freeing is blocked into a blocking",
          "content_same": false
        },
        {
          "line": 459,
          "old_api": "unblockClientWaitingData",
          "new_api": null,
          "old_text": "unblockClientWaitingData(c)",
          "new_text": null,
          "old_line_content": "        unblockClientWaitingData(c);",
          "new_line_content": "     * called. Also it is important to remove the file events after",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": "unwatchAllKeys",
          "new_api": null,
          "old_text": "unwatchAllKeys(c)",
          "new_text": null,
          "old_line_content": "    unwatchAllKeys(c);",
          "new_line_content": "    c->querybuf = NULL;",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "listRelease",
          "new_api": null,
          "old_text": "listRelease(c->watched_keys)",
          "new_text": null,
          "old_line_content": "    listRelease(c->watched_keys);",
          "new_line_content": "    if (c->flags & REDIS_BLOCKED)",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": "pubsubUnsubscribeAllChannels",
          "new_api": null,
          "old_text": "pubsubUnsubscribeAllChannels(c,0)",
          "new_text": null,
          "old_line_content": "    pubsubUnsubscribeAllChannels(c,0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": "pubsubUnsubscribeAllPatterns",
          "new_api": null,
          "old_text": "pubsubUnsubscribeAllPatterns(c,0)",
          "new_text": null,
          "old_line_content": "    pubsubUnsubscribeAllPatterns(c,0);",
          "new_line_content": "    /* UNWATCH all the keys */",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(c->fd)",
          "new_text": null,
          "old_line_content": "    close(c->fd);",
          "new_line_content": "    /* Obvious cleanup */",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": "listDelNode",
          "new_api": null,
          "old_text": "listDelNode(server.unblocked_clients,ln)",
          "new_text": null,
          "old_line_content": "        listDelNode(server.unblocked_clients,ln);",
          "new_line_content": "    /* When client was just unblocked because of a blocking operation,",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(c->io_keys)",
          "new_text": null,
          "old_line_content": "        if (listLength(c->io_keys) == 0) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": "listSearchKey",
          "new_api": null,
          "old_text": "listSearchKey(server.io_ready_clients,c)",
          "new_text": null,
          "old_line_content": "            ln = listSearchKey(server.io_ready_clients,c);",
          "new_line_content": "    /* Remove from the list of clients waiting for swapped keys, or ready",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(c->io_keys)",
          "new_text": null,
          "old_line_content": "            while (listLength(c->io_keys)) {",
          "new_line_content": "            /* When this client is waiting to be woken up (REDIS_IO_WAIT),",
          "content_same": false
        },
        {
          "line": 499,
          "old_api": "listFirst",
          "new_api": null,
          "old_text": "listFirst(c->io_keys)",
          "new_text": null,
          "old_line_content": "                ln = listFirst(c->io_keys);",
          "new_line_content": "             * it should be present in the list io_ready_clients */",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 44,
      "total_additions": 108,
      "total_deletions": 106,
      "total_api_changes": 258
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 6,
        "api_related_lines": 258,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          326
        ]
      }
    },
    "api_calls_before": 288,
    "api_calls_after": 290,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 1,
      "total_diff_lines": 19
    }
  }
}