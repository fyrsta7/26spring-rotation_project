{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/1b6bdff48dcc333affab02b945821eb865529de2",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/1b6bdff48dcc333affab02b945821eb865529de2/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/1b6bdff48dcc333affab02b945821eb865529de2/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/1b6bdff48dcc333affab02b945821eb865529de2/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1886,
          "old_api": "listNodeValue",
          "new_api": "listCreate",
          "old_text": "listNodeValue(lpn)",
          "new_text": "listCreate()",
          "old_line_content": "            listAddNodeTail(upcoming, listNodeValue(lpn));",
          "new_line_content": "    list *upcoming = listCreate();",
          "content_same": false
        },
        {
          "line": 1891,
          "old_api": "listRewind",
          "new_api": "listNext",
          "old_text": "listRewind(original->selectors,&li)",
          "new_text": "listNext(&lpi)",
          "old_line_content": "    listRewind(original->selectors,&li);",
          "new_line_content": "        while((lpn = listNext(&lpi))) {",
          "content_same": false
        },
        {
          "line": 1892,
          "old_api": "listNext",
          "new_api": "listNodeValue",
          "old_text": "listNext(&li)",
          "new_text": "listNodeValue(lpn)",
          "old_line_content": "    while((ln = listNext(&li)) && match) {",
          "new_line_content": "            listAddNodeTail(upcoming, listNodeValue(lpn));",
          "content_same": false
        },
        {
          "line": 1926,
          "old_api": "dictGetIterator",
          "new_api": "listNext",
          "old_text": "dictGetIterator(c->pubsub_patterns)",
          "new_text": "listNext(&li)",
          "old_line_content": "            dictIterator *di = dictGetIterator(c->pubsub_patterns);",
          "new_line_content": "    while ((ln = listNext(&li)) != NULL) {",
          "content_same": false
        },
        {
          "line": 1930,
          "old_api": "sdslen",
          "new_api": "getClientType",
          "old_text": "sdslen(o->ptr)",
          "new_text": "getClientType(c)",
          "old_line_content": "                int res = ACLCheckChannelAgainstList(upcoming, o->ptr, sdslen(o->ptr), 1);",
          "new_line_content": "        if (c->user == original && getClientType(c) == CLIENT_TYPE_PUBSUB) {",
          "content_same": false
        },
        {
          "line": 1939,
          "old_api": "dictNext",
          "new_api": "dictReleaseIterator",
          "old_text": "dictNext(di)",
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "                while (!kill && ((de = dictNext(di)) != NULL)) {",
          "new_line_content": "            dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 1944,
          "old_api": "dictReleaseIterator",
          "new_api": "dictGetIterator",
          "old_text": "dictReleaseIterator(di)",
          "new_text": "dictGetIterator(c->pubsub_channels)",
          "old_line_content": "                dictReleaseIterator(di);",
          "new_line_content": "                di = dictGetIterator(c->pubsub_channels);",
          "content_same": false
        },
        {
          "line": 1950,
          "old_api": "dictNext",
          "new_api": "dictReleaseIterator",
          "old_text": "dictNext(di)",
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "                while (!kill && ((de = dictNext(di)) != NULL)) {",
          "new_line_content": "                dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 1955,
          "old_api": "dictReleaseIterator",
          "new_api": "dictGetIterator",
          "old_text": "dictReleaseIterator(di)",
          "new_text": "dictGetIterator(c->pubsubshard_channels)",
          "old_line_content": "                dictReleaseIterator(di);",
          "new_line_content": "                di = dictGetIterator(c->pubsubshard_channels);",
          "content_same": false
        },
        {
          "line": 2001,
          "old_api": "sdscatfmt",
          "new_api": "sdsdup",
          "old_text": "sdscatfmt(selector, \" %s\", op)",
          "new_text": "sdsdup(argv[j])",
          "old_line_content": "            selector = sdscatfmt(selector, \" %s\", op);",
          "new_line_content": "            selector = sdsdup(argv[j]);",
          "content_same": false
        },
        {
          "line": 2016,
          "old_api": "zfree",
          "new_api": "sdsdup",
          "old_text": "zfree(acl_args)",
          "new_text": "sdsdup(argv[j])",
          "old_line_content": "        zfree(acl_args);",
          "new_line_content": "        acl_args[*merged_argc] = sdsdup(argv[j]);",
          "content_same": false
        },
        {
          "line": 2054,
          "old_api": "sdslen",
          "new_api": "ACLCreateUnlinkedUser",
          "old_text": "sdslen(acl_args[j])",
          "new_text": "ACLCreateUnlinkedUser()",
          "old_line_content": "        if (ACLSetUser(tempu,acl_args[j],(ssize_t) sdslen(acl_args[j])) != C_OK) {",
          "new_line_content": "    user *tempu = ACLCreateUnlinkedUser();",
          "content_same": false
        },
        {
          "line": 2056,
          "old_api": "sdsempty",
          "new_api": "ACLCopyUser",
          "old_text": "sdsempty()",
          "new_text": "ACLCopyUser(tempu, u)",
          "old_line_content": "            error = sdscatfmt(sdsempty(),",
          "new_line_content": "        ACLCopyUser(tempu, u);",
          "content_same": false
        },
        {
          "line": 2148,
          "old_api": "sdsfree",
          "new_api": "zmalloc",
          "old_text": "sdsfree(acl_args[i])",
          "new_text": "zmalloc(sizeof(sds)*(merged_argc + 2))",
          "old_line_content": "    for (int i = 0; i < merged_argc; i++) sdsfree(acl_args[i]);",
          "new_line_content": "    sds *copy = zmalloc(sizeof(sds)*(merged_argc + 2));",
          "content_same": false
        },
        {
          "line": 2149,
          "old_api": "zfree",
          "new_api": "sdsdup",
          "old_text": "zfree(acl_args)",
          "new_text": "sdsdup(argv[1])",
          "old_line_content": "    zfree(acl_args);",
          "new_line_content": "    copy[0] = sdsdup(argv[1]);",
          "content_same": false
        },
        {
          "line": 2165,
          "old_api": "serverLog",
          "new_api": "listRewind",
          "old_text": "serverLog(LL_WARNING,\"Spaces not allowed in ACL usernames\")",
          "new_text": "listRewind(UsersToLoad,&li)",
          "old_line_content": "            serverLog(LL_WARNING,\"Spaces not allowed in ACL usernames\");",
          "new_line_content": "    listRewind(UsersToLoad,&li);",
          "content_same": false
        },
        {
          "line": 2179,
          "old_api": "sdslen",
          "new_api": "ACLGetUserByName",
          "old_text": "sdslen(aclrules[j])",
          "new_text": "ACLGetUserByName(\"default\",7)",
          "old_line_content": "            if (ACLSetUser(u,aclrules[j],sdslen(aclrules[j])) != C_OK) {",
          "new_line_content": "            u = ACLGetUserByName(\"default\",7);",
          "content_same": false
        },
        {
          "line": 2180,
          "old_api": "ACLSetUserStringError",
          "new_api": "ACLSetUser",
          "old_text": "ACLSetUserStringError()",
          "new_text": "ACLSetUser(u,\"reset\",-1)",
          "old_line_content": "                const char *errmsg = ACLSetUserStringError();",
          "new_line_content": "            ACLSetUser(u,\"reset\",-1);",
          "content_same": false
        },
        {
          "line": 2237,
          "old_api": "fgets",
          "new_api": "strerror",
          "old_text": "fgets(buf,sizeof(buf),fp)",
          "new_text": "strerror(errno)",
          "old_line_content": "    while(fgets(buf,sizeof(buf),fp) != NULL)",
          "new_line_content": "            filename, strerror(errno));",
          "content_same": false
        },
        {
          "line": 2243,
          "old_api": "sdsempty",
          "new_api": "fgets",
          "old_text": "sdsempty()",
          "new_text": "fgets(buf,sizeof(buf),fp)",
          "old_line_content": "    sds *lines, errors = sdsempty();",
          "new_line_content": "    while(fgets(buf,sizeof(buf),fp) != NULL)",
          "content_same": false
        },
        {
          "line": 2244,
          "old_api": "strlen",
          "new_api": "sdscat",
          "old_text": "strlen(acls)",
          "new_text": "sdscat(acls,buf)",
          "old_line_content": "    lines = sdssplitlen(acls,strlen(acls),\"\\n\",1,&totlines);",
          "new_line_content": "        acls = sdscat(acls,buf);",
          "content_same": false
        },
        {
          "line": 2245,
          "old_api": "sdsfree",
          "new_api": "fclose",
          "old_text": "sdsfree(acls)",
          "new_text": "fclose(fp)",
          "old_line_content": "    sdsfree(acls);",
          "new_line_content": "    fclose(fp);",
          "content_same": false
        },
        {
          "line": 2251,
          "old_api": "raxNew",
          "new_api": "sdsfree",
          "old_text": "raxNew()",
          "new_text": "sdsfree(acls)",
          "old_line_content": "    Users = raxNew();",
          "new_line_content": "    sdsfree(acls);",
          "content_same": false
        },
        {
          "line": 2265,
          "old_api": "sdslen",
          "new_api": "sdstrim",
          "old_text": "sdslen(lines[i])",
          "new_text": "sdstrim(lines[i],\" \\t\\r\\n\")",
          "old_line_content": "        argv = sdssplitlen(lines[i],sdslen(lines[i]),\" \",1,&argc);",
          "new_line_content": "        lines[i] = sdstrim(lines[i],\" \\t\\r\\n\");",
          "content_same": false
        },
        {
          "line": 2281,
          "old_api": "sdscatprintf",
          "new_api": "sdsfreesplitres",
          "old_text": "sdscatprintf(errors,\n                     \"%s:%d should start with user keyword followed \"\n                     \"by the username. \", server.acl_filename,\n                     linenum)",
          "new_text": "sdsfreesplitres(argv,argc)",
          "old_line_content": "            errors = sdscatprintf(errors,",
          "new_line_content": "            sdsfreesplitres(argv,argc);",
          "content_same": false
        },
        {
          "line": 2291,
          "old_api": "sdscatprintf",
          "new_api": "sdsfreesplitres",
          "old_text": "sdscatprintf(errors,\n                     \"'%s:%d: username '%s' contains invalid characters. \",\n                     server.acl_filename, linenum, argv[1])",
          "new_text": "sdsfreesplitres(argv,argc)",
          "old_line_content": "            errors = sdscatprintf(errors,",
          "new_line_content": "            sdsfreesplitres(argv,argc);",
          "content_same": false
        },
        {
          "line": 2327,
          "old_api": "sdscatprintf",
          "new_api": "sdstrim",
          "old_text": "sdscatprintf(errors,\n                            \"%s:%d: Error in applying operation '%s': %s. \",\n                            server.acl_filename, linenum, acl_args[j], errmsg)",
          "new_text": "sdstrim(acl_args[j],\"\\t\\r\\n\")",
          "old_line_content": "                    errors = sdscatprintf(errors,",
          "new_line_content": "            acl_args[j] = sdstrim(acl_args[j],\"\\t\\r\\n\");",
          "content_same": false
        },
        {
          "line": 2347,
          "old_api": "sdslen",
          "new_api": "sdsfree",
          "old_text": "sdslen(errors)",
          "new_text": "sdsfree(acl_args[i])",
          "old_line_content": "        if (sdslen(errors) != 0) {",
          "new_line_content": "        for (int i = 0; i < merged_argc; i++) sdsfree(acl_args[i]);",
          "content_same": false
        },
        {
          "line": 2348,
          "old_api": "sdsfreesplitres",
          "new_api": "zfree",
          "old_text": "sdsfreesplitres(argv,argc)",
          "new_text": "zfree(acl_args)",
          "old_line_content": "            sdsfreesplitres(argv,argc);",
          "new_line_content": "        zfree(acl_args);",
          "content_same": false
        },
        {
          "line": 2358,
          "old_api": "sdslen",
          "new_api": "sdsfreesplitres",
          "old_text": "sdslen(errors)",
          "new_text": "sdsfreesplitres(argv,argc)",
          "old_line_content": "    if (sdslen(errors) == 0) {",
          "new_line_content": "        sdsfreesplitres(argv,argc);",
          "content_same": false
        },
        {
          "line": 2364,
          "old_api": "ACLCreateDefaultUser",
          "new_api": "sdslen",
          "old_text": "ACLCreateDefaultUser()",
          "new_text": "sdslen(errors)",
          "old_line_content": "            new_default = ACLCreateDefaultUser();",
          "new_line_content": "    if (sdslen(errors) == 0) {",
          "content_same": false
        },
        {
          "line": 2368,
          "old_api": "ACLFreeUser",
          "new_api": "ACLGetUserByName",
          "old_text": "ACLFreeUser(new_default)",
          "new_text": "ACLGetUserByName(\"default\",7)",
          "old_line_content": "        ACLFreeUser(new_default);",
          "new_line_content": "        user *new_default = ACLGetUserByName(\"default\",7);",
          "content_same": false
        },
        {
          "line": 2370,
          "old_api": "raxRemove",
          "new_api": "ACLCreateDefaultUser",
          "old_text": "raxRemove(old_users,(unsigned char*)\"default\",7,NULL)",
          "new_text": "ACLCreateDefaultUser()",
          "old_line_content": "        raxRemove(old_users,(unsigned char*)\"default\",7,NULL);",
          "new_line_content": "            new_default = ACLCreateDefaultUser();",
          "content_same": false
        },
        {
          "line": 2375,
          "old_api": "ACLFreeUsersSet",
          "new_api": "raxInsert",
          "old_text": "ACLFreeUsersSet(Users)",
          "new_text": "raxInsert(Users,(unsigned char*)\"default\",7,DefaultUser,NULL)",
          "old_line_content": "        ACLFreeUsersSet(Users);",
          "new_line_content": "        raxInsert(Users,(unsigned char*)\"default\",7,DefaultUser,NULL);",
          "content_same": false
        },
        {
          "line": 2377,
          "old_api": "sdscat",
          "new_api": "ACLFreeUsersSet",
          "old_text": "sdscat(errors,\"WARNING: ACL errors detected, no change to the previously active ACL rules was performed\")",
          "new_text": "ACLFreeUsersSet(old_users)",
          "old_line_content": "        errors = sdscat(errors,\"WARNING: ACL errors detected, no change to the previously active ACL rules was performed\");",
          "new_line_content": "        ACLFreeUsersSet(old_users);",
          "content_same": false
        },
        {
          "line": 2400,
          "old_api": "sdscatsds",
          "new_api": "raxStart",
          "old_text": "sdscatsds(user,u->name)",
          "new_text": "raxStart(&ri,Users)",
          "old_line_content": "        user = sdscatsds(user,u->name);",
          "new_line_content": "    raxStart(&ri,Users);",
          "content_same": false
        },
        {
          "line": 2401,
          "old_api": "sdscatlen",
          "new_api": "raxSeek",
          "old_text": "sdscatlen(user,\" \",1)",
          "new_text": "raxSeek(&ri,\"^\",NULL,0)",
          "old_line_content": "        user = sdscatlen(user,\" \",1);",
          "new_line_content": "    raxSeek(&ri,\"^\",NULL,0);",
          "content_same": false
        },
        {
          "line": 2402,
          "old_api": "ACLDescribeUser",
          "new_api": "raxNext",
          "old_text": "ACLDescribeUser(u)",
          "new_text": "raxNext(&ri)",
          "old_line_content": "        robj *descr = ACLDescribeUser(u);",
          "new_line_content": "    while(raxNext(&ri)) {",
          "content_same": false
        },
        {
          "line": 2405,
          "old_api": "sdscatsds",
          "new_api": "sdsnew",
          "old_text": "sdscatsds(acl,user)",
          "new_text": "sdsnew(\"user \")",
          "old_line_content": "        acl = sdscatsds(acl,user);",
          "new_line_content": "        sds user = sdsnew(\"user \");",
          "content_same": false
        },
        {
          "line": 2406,
          "old_api": "sdscatlen",
          "new_api": "sdscatsds",
          "old_text": "sdscatlen(acl,\"\\n\",1)",
          "new_text": "sdscatsds(user,u->name)",
          "old_line_content": "        acl = sdscatlen(acl,\"\\n\",1);",
          "new_line_content": "        user = sdscatsds(user,u->name);",
          "content_same": false
        },
        {
          "line": 2407,
          "old_api": "sdsfree",
          "new_api": "sdscatlen",
          "old_text": "sdsfree(user)",
          "new_text": "sdscatlen(user,\" \",1)",
          "old_line_content": "        sdsfree(user);",
          "new_line_content": "        user = sdscatlen(user,\" \",1);",
          "content_same": false
        },
        {
          "line": 2409,
          "old_api": "raxStop",
          "new_api": "sdscatsds",
          "old_text": "raxStop(&ri)",
          "new_text": "sdscatsds(user,descr->ptr)",
          "old_line_content": "    raxStop(&ri);",
          "new_line_content": "        user = sdscatsds(user,descr->ptr);",
          "content_same": false
        },
        {
          "line": 2412,
          "old_api": "sdsnew",
          "new_api": "sdscatlen",
          "old_text": "sdsnew(filename)",
          "new_text": "sdscatlen(acl,\"\\n\",1)",
          "old_line_content": "    tmpfilename = sdsnew(filename);",
          "new_line_content": "        acl = sdscatlen(acl,\"\\n\",1);",
          "content_same": false
        },
        {
          "line": 2413,
          "old_api": "sdscatfmt",
          "new_api": "sdsfree",
          "old_text": "sdscatfmt(tmpfilename,\".tmp-%i-%I\",\n        (int) getpid(),commandTimeSnapshot())",
          "new_text": "sdsfree(user)",
          "old_line_content": "    tmpfilename = sdscatfmt(tmpfilename,\".tmp-%i-%I\",",
          "new_line_content": "        sdsfree(user);",
          "content_same": false
        },
        {
          "line": 2415,
          "old_api": "open",
          "new_api": "raxStop",
          "old_text": "open(tmpfilename,O_WRONLY|O_CREAT,0644)",
          "new_text": "raxStop(&ri)",
          "old_line_content": "    if ((fd = open(tmpfilename,O_WRONLY|O_CREAT,0644)) == -1) {",
          "new_line_content": "    raxStop(&ri);",
          "content_same": false
        },
        {
          "line": 2423,
          "old_api": "sdslen",
          "new_api": "strerror",
          "old_text": "sdslen(acl)",
          "new_text": "strerror(errno)",
          "old_line_content": "    while (offset < sdslen(acl)) {",
          "new_line_content": "            strerror(errno));",
          "content_same": false
        },
        {
          "line": 2433,
          "old_api": "redis_fsync",
          "new_api": "serverLog",
          "old_text": "redis_fsync(fd)",
          "new_text": "serverLog(LL_WARNING,\"Writing ACL file for ACL SAVE: %s\",\n                strerror(errno))",
          "old_line_content": "    if (redis_fsync(fd) == -1) {",
          "new_line_content": "            serverLog(LL_WARNING,\"Writing ACL file for ACL SAVE: %s\",",
          "content_same": false
        },
        {
          "line": 2434,
          "old_api": "serverLog",
          "new_api": "strerror",
          "old_text": "serverLog(LL_WARNING,\"Syncing ACL file for ACL SAVE: %s\",\n            strerror(errno))",
          "new_text": "strerror(errno)",
          "old_line_content": "        serverLog(LL_WARNING,\"Syncing ACL file for ACL SAVE: %s\",",
          "new_line_content": "                strerror(errno));",
          "content_same": false
        },
        {
          "line": 2441,
          "old_api": "rename",
          "new_api": "strerror",
          "old_text": "rename(tmpfilename,filename)",
          "new_text": "strerror(errno)",
          "old_line_content": "    if (rename(tmpfilename,filename) == -1) {",
          "new_line_content": "            strerror(errno));",
          "content_same": false
        },
        {
          "line": 2447,
          "old_api": "serverLog",
          "new_api": "rename",
          "old_text": "serverLog(LL_WARNING,\"Syncing ACL directory for ACL SAVE: %s\",\n            strerror(errno))",
          "new_text": "rename(tmpfilename,filename)",
          "old_line_content": "        serverLog(LL_WARNING,\"Syncing ACL directory for ACL SAVE: %s\",",
          "new_line_content": "    if (rename(tmpfilename,filename) == -1) {",
          "content_same": false
        },
        {
          "line": 2448,
          "old_api": "strerror",
          "new_api": "serverLog",
          "old_text": "strerror(errno)",
          "new_text": "serverLog(LL_WARNING,\"Renaming ACL file for ACL SAVE: %s\",\n            strerror(errno))",
          "old_line_content": "            strerror(errno));",
          "new_line_content": "        serverLog(LL_WARNING,\"Renaming ACL file for ACL SAVE: %s\",",
          "content_same": false
        },
        {
          "line": 2475,
          "old_api": "exit",
          "new_api": "serverLog",
          "old_text": "exit(1)",
          "new_text": "serverLog(LL_WARNING,\n            \"Configuring Redis with users defined in redis.conf and at \"\n            \"the same setting an ACL file path is invalid. This setup \"\n            \"is very likely to lead to configuration errors and security \"\n            \"holes, please define either an ACL file or declare users \"\n            \"directly in your redis.conf, but not both.\")",
          "old_line_content": "        exit(1);",
          "new_line_content": "        serverLog(LL_WARNING,",
          "content_same": false
        },
        {
          "line": 2485,
          "old_api": "ACLLoadFromFile",
          "new_api": "serverLog",
          "old_text": "ACLLoadFromFile(server.acl_filename)",
          "new_text": "serverLog(LL_WARNING,\n            \"Critical error while loading ACLs. Exiting.\")",
          "old_line_content": "        sds errors = ACLLoadFromFile(server.acl_filename);",
          "new_line_content": "        serverLog(LL_WARNING,",
          "content_same": false
        },
        {
          "line": 2487,
          "old_api": "serverLog",
          "new_api": "exit",
          "old_text": "serverLog(LL_WARNING,\n                \"Aborting Redis startup because of ACL errors: %s\", errors)",
          "new_text": "exit(1)",
          "old_line_content": "            serverLog(LL_WARNING,",
          "new_line_content": "        exit(1);",
          "content_same": false
        },
        {
          "line": 2576,
          "old_api": "sdsdup",
          "new_api": "ACLUpdateInfoMetrics",
          "old_text": "sdsdup(username ? username : c->user->name)",
          "new_text": "ACLUpdateInfoMetrics(reason)",
          "old_line_content": "    le->username = sdsdup(username ? username : c->user->name);",
          "new_line_content": "    ACLUpdateInfoMetrics(reason);",
          "content_same": false
        },
        {
          "line": 2610,
          "old_api": "listDelNode",
          "new_api": "listRewind",
          "old_text": "listDelNode(ACLLog,ln)",
          "new_text": "listRewind(ACLLog,&li)",
          "old_line_content": "            listDelNode(ACLLog,ln);",
          "new_line_content": "    listRewind(ACLLog,&li);",
          "content_same": false
        },
        {
          "line": 2634,
          "old_api": "listLength",
          "new_api": "ACLFreeLogEntry",
          "old_text": "listLength(ACLLog)",
          "new_text": "ACLFreeLogEntry(le)",
          "old_line_content": "        while(listLength(ACLLog) > server.acllog_max_len) {",
          "new_line_content": "        ACLFreeLogEntry(le);",
          "content_same": false
        },
        {
          "line": 2663,
          "old_api": "serverPanic",
          "new_api": "sdsempty",
          "old_text": "serverPanic(\"Reached deadcode on getAclErrorMessage\")",
          "new_text": "sdsempty()",
          "old_line_content": "    serverPanic(\"Reached deadcode on getAclErrorMessage\");",
          "new_line_content": "            return sdscatfmt(sdsempty(), \"User %S has no permissions to access \"",
          "content_same": false
        },
        {
          "line": 2679,
          "old_api": "sdslen",
          "new_api": "dictGetIterator",
          "old_text": "sdslen(cmd->fullname)",
          "new_text": "dictGetIterator(commands)",
          "old_line_content": "            addReplyBulkCBuffer(c, cmd->fullname, sdslen(cmd->fullname));",
          "new_line_content": "    dictIterator *di = dictGetIterator(commands);",
          "content_same": false
        },
        {
          "line": 2708,
          "old_api": "addReplyBulkCBuffer",
          "new_api": "ACLDescribeSelectorCommandRules",
          "old_text": "addReplyBulkCBuffer(c,\"~*\",2)",
          "new_text": "ACLDescribeSelectorCommandRules(s)",
          "old_line_content": "        addReplyBulkCBuffer(c,\"~*\",2);",
          "new_line_content": "    sds cmddescr = ACLDescribeSelectorCommandRules(s);",
          "content_same": false
        },
        {
          "line": 2712,
          "old_api": "listNext",
          "new_api": "addReplyBulkCString",
          "old_text": "listNext(&li)",
          "new_text": "addReplyBulkCString(c,\"keys\")",
          "old_line_content": "        while((ln = listNext(&li))) {",
          "new_line_content": "    addReplyBulkCString(c,\"keys\");",
          "content_same": false
        },
        {
          "line": 2714,
          "old_api": "sdscat",
          "new_api": "addReplyBulkCBuffer",
          "old_text": "sdscat(dsl, \" \")",
          "new_text": "addReplyBulkCBuffer(c,\"~*\",2)",
          "old_line_content": "            if (ln != listFirst(s->patterns)) dsl = sdscat(dsl, \" \");",
          "new_line_content": "        addReplyBulkCBuffer(c,\"~*\",2);",
          "content_same": false
        },
        {
          "line": 2717,
          "old_api": "addReplyBulkSds",
          "new_api": "listRewind",
          "old_text": "addReplyBulkSds(c, dsl)",
          "new_text": "listRewind(s->patterns,&li)",
          "old_line_content": "        addReplyBulkSds(c, dsl);",
          "new_line_content": "        listRewind(s->patterns,&li);",
          "content_same": false
        },
        {
          "line": 2721,
          "old_api": "addReplyBulkCString",
          "new_api": "sdsCatPatternString",
          "old_text": "addReplyBulkCString(c,\"channels\")",
          "new_text": "sdsCatPatternString(dsl, thispat)",
          "old_line_content": "    addReplyBulkCString(c,\"channels\");",
          "new_line_content": "            dsl = sdsCatPatternString(dsl, thispat);",
          "content_same": false
        },
        {
          "line": 2723,
          "old_api": "addReplyBulkCBuffer",
          "new_api": "addReplyBulkSds",
          "old_text": "addReplyBulkCBuffer(c,\"&*\",2)",
          "new_text": "addReplyBulkSds(c, dsl)",
          "old_line_content": "        addReplyBulkCBuffer(c,\"&*\",2);",
          "new_line_content": "        addReplyBulkSds(c, dsl);",
          "content_same": false
        },
        {
          "line": 2727,
          "old_api": "listNext",
          "new_api": "addReplyBulkCString",
          "old_text": "listNext(&li)",
          "new_text": "addReplyBulkCString(c,\"channels\")",
          "old_line_content": "        while((ln = listNext(&li))) {",
          "new_line_content": "    addReplyBulkCString(c,\"channels\");",
          "content_same": false
        },
        {
          "line": 2729,
          "old_api": "sdscat",
          "new_api": "addReplyBulkCBuffer",
          "old_text": "sdscat(dsl, \" \")",
          "new_text": "addReplyBulkCBuffer(c,\"&*\",2)",
          "old_line_content": "            if (ln != listFirst(s->channels)) dsl = sdscat(dsl, \" \");",
          "new_line_content": "        addReplyBulkCBuffer(c,\"&*\",2);",
          "content_same": false
        },
        {
          "line": 2732,
          "old_api": "addReplyBulkSds",
          "new_api": "listRewind",
          "old_text": "addReplyBulkSds(c, dsl)",
          "new_text": "listRewind(s->channels,&li)",
          "old_line_content": "        addReplyBulkSds(c, dsl);",
          "new_line_content": "        listRewind(s->channels,&li);",
          "content_same": false
        },
        {
          "line": 2763,
          "old_api": "addReplyErrorFormat",
          "new_api": "redactClientCommandArgument",
          "old_text": "addReplyErrorFormat(c,\n                \"Usernames can't contain spaces or null characters\")",
          "new_text": "redactClientCommandArgument(c, j)",
          "old_line_content": "            addReplyErrorFormat(c,",
          "new_line_content": "            redactClientCommandArgument(c, j);",
          "content_same": false
        },
        {
          "line": 2774,
          "old_api": "zfree",
          "new_api": "sdslen",
          "old_text": "zfree(temp_argv)",
          "new_text": "sdslen(username)",
          "old_line_content": "        zfree(temp_argv);",
          "new_line_content": "        user *u = ACLGetUserByName(username,sdslen(username));",
          "content_same": false
        },
        {
          "line": 2776,
          "old_api": "addReply",
          "new_api": "zmalloc",
          "old_text": "addReply(c,shared.ok)",
          "new_text": "zmalloc(c->argc * sizeof(sds))",
          "old_line_content": "            addReply(c,shared.ok);",
          "new_line_content": "        sds *temp_argv = zmalloc(c->argc * sizeof(sds));",
          "content_same": false
        },
        {
          "line": 2804,
          "old_api": "sdslen",
          "new_api": "ACLFreeUserAndKillClients",
          "old_text": "sdslen(c->argv[2]->ptr)",
          "new_text": "ACLFreeUserAndKillClients(u)",
          "old_line_content": "        user *u = ACLGetUserByName(c->argv[2]->ptr,sdslen(c->argv[2]->ptr));",
          "new_line_content": "                ACLFreeUserAndKillClients(u);",
          "content_same": false
        },
        {
          "line": 2810,
          "old_api": "addReplyDeferredLen",
          "new_api": "sdslen",
          "old_text": "addReplyDeferredLen(c)",
          "new_text": "sdslen(c->argv[2]->ptr)",
          "old_line_content": "        void *ufields = addReplyDeferredLen(c);",
          "new_line_content": "        user *u = ACLGetUserByName(c->argv[2]->ptr,sdslen(c->argv[2]->ptr));",
          "content_same": false
        },
        {
          "line": 2832,
          "old_api": "listNodeValue",
          "new_api": "addReplyBulkCString",
          "old_text": "listNodeValue(ln)",
          "new_text": "addReplyBulkCString(c,\"passwords\")",
          "old_line_content": "            sds thispass = listNodeValue(ln);",
          "new_line_content": "        addReplyBulkCString(c,\"passwords\");",
          "content_same": false
        },
        {
          "line": 2833,
          "old_api": "sdslen",
          "new_api": "listLength",
          "old_text": "sdslen(thispass)",
          "new_text": "listLength(u->passwords)",
          "old_line_content": "            addReplyBulkCBuffer(c,thispass,sdslen(thispass));",
          "new_line_content": "        addReplyArrayLen(c,listLength(u->passwords));",
          "content_same": false
        },
        {
          "line": 2836,
          "old_api": "ACLUserGetRootSelector",
          "new_api": "listRewind",
          "old_text": "ACLUserGetRootSelector(u)",
          "new_text": "listRewind(u->passwords,&li)",
          "old_line_content": "        fields += aclAddReplySelectorDescription(c, ACLUserGetRootSelector(u));",
          "new_line_content": "        listRewind(u->passwords,&li);",
          "content_same": false
        },
        {
          "line": 2839,
          "old_api": "addReplyBulkCString",
          "new_api": "sdslen",
          "old_text": "addReplyBulkCString(c,\"selectors\")",
          "new_text": "sdslen(thispass)",
          "old_line_content": "        addReplyBulkCString(c,\"selectors\");",
          "new_line_content": "            addReplyBulkCBuffer(c,thispass,sdslen(thispass));",
          "content_same": false
        },
        {
          "line": 2842,
          "old_api": "listNext",
          "new_api": "ACLUserGetRootSelector",
          "old_text": "listNext(&li)",
          "new_text": "ACLUserGetRootSelector(u)",
          "old_line_content": "        serverAssert(listNext(&li));",
          "new_line_content": "        fields += aclAddReplySelectorDescription(c, ACLUserGetRootSelector(u));",
          "content_same": false
        },
        {
          "line": 2845,
          "old_api": "listNodeValue",
          "new_api": "addReplyBulkCString",
          "old_text": "listNodeValue(ln)",
          "new_text": "addReplyBulkCString(c,\"selectors\")",
          "old_line_content": "            int sfields = aclAddReplySelectorDescription(c, (aclSelector *)listNodeValue(ln));",
          "new_line_content": "        addReplyBulkCString(c,\"selectors\");",
          "content_same": false
        },
        {
          "line": 2846,
          "old_api": "setDeferredMapLen",
          "new_api": "listLength",
          "old_text": "setDeferredMapLen(c, slen, sfields)",
          "new_text": "listLength(u->selectors)",
          "old_line_content": "            setDeferredMapLen(c, slen, sfields);",
          "new_line_content": "        addReplyArrayLen(c, listLength(u->selectors) - 1);",
          "content_same": false
        },
        {
          "line": 2848,
          "old_api": "setDeferredMapLen",
          "new_api": "listNext",
          "old_text": "setDeferredMapLen(c, ufields, fields)",
          "new_text": "listNext(&li)",
          "old_line_content": "        setDeferredMapLen(c, ufields, fields);",
          "new_line_content": "        serverAssert(listNext(&li));",
          "content_same": false
        },
        {
          "line": 2849,
          "old_api": "strcasecmp",
          "new_api": "listNext",
          "old_text": "strcasecmp(sub,\"users\")",
          "new_text": "listNext(&li)",
          "old_line_content": "    } else if ((!strcasecmp(sub,\"list\") || !strcasecmp(sub,\"users\")) &&",
          "new_line_content": "        while((ln = listNext(&li))) {",
          "content_same": false
        },
        {
          "line": 2852,
          "old_api": "strcasecmp",
          "new_api": "setDeferredMapLen",
          "old_text": "strcasecmp(sub,\"users\")",
          "new_text": "setDeferredMapLen(c, slen, sfields)",
          "old_line_content": "        int justnames = !strcasecmp(sub,\"users\");",
          "new_line_content": "            setDeferredMapLen(c, slen, sfields);",
          "content_same": false
        },
        {
          "line": 2855,
          "old_api": "raxStart",
          "new_api": "strcasecmp",
          "old_text": "raxStart(&ri,Users)",
          "new_text": "strcasecmp(sub,\"users\")",
          "old_line_content": "        raxStart(&ri,Users);",
          "new_line_content": "    } else if ((!strcasecmp(sub,\"list\") || !strcasecmp(sub,\"users\")) &&",
          "content_same": false
        },
        {
          "line": 2863,
          "old_api": "sdsnew",
          "new_api": "raxNext",
          "old_text": "sdsnew(\"user \")",
          "new_text": "raxNext(&ri)",
          "old_line_content": "                sds config = sdsnew(\"user \");",
          "new_line_content": "        while(raxNext(&ri)) {",
          "content_same": false
        },
        {
          "line": 2866,
          "old_api": "ACLDescribeUser",
          "new_api": "sdslen",
          "old_text": "ACLDescribeUser(u)",
          "new_text": "sdslen(u->name)",
          "old_line_content": "                robj *descr = ACLDescribeUser(u);",
          "new_line_content": "                addReplyBulkCBuffer(c,u->name,sdslen(u->name));",
          "content_same": false
        },
        {
          "line": 2869,
          "old_api": "addReplyBulkSds",
          "new_api": "sdsnew",
          "old_text": "addReplyBulkSds(c,config)",
          "new_text": "sdsnew(\"user \")",
          "old_line_content": "                addReplyBulkSds(c,config);",
          "new_line_content": "                sds config = sdsnew(\"user \");",
          "content_same": false
        },
        {
          "line": 2872,
          "old_api": "raxStop",
          "new_api": "ACLDescribeUser",
          "old_text": "raxStop(&ri)",
          "new_text": "ACLDescribeUser(u)",
          "old_line_content": "        raxStop(&ri);",
          "new_line_content": "                robj *descr = ACLDescribeUser(u);",
          "content_same": false
        },
        {
          "line": 2873,
          "old_api": "strcasecmp",
          "new_api": "sdscatsds",
          "old_text": "strcasecmp(sub,\"whoami\")",
          "new_text": "sdscatsds(config,descr->ptr)",
          "old_line_content": "    } else if (!strcasecmp(sub,\"whoami\") && c->argc == 2) {",
          "new_line_content": "                config = sdscatsds(config,descr->ptr);",
          "content_same": false
        },
        {
          "line": 2875,
          "old_api": "sdslen",
          "new_api": "addReplyBulkSds",
          "old_text": "sdslen(c->user->name)",
          "new_text": "addReplyBulkSds(c,config)",
          "old_line_content": "            addReplyBulkCBuffer(c,c->user->name,sdslen(c->user->name));",
          "new_line_content": "                addReplyBulkSds(c,config);",
          "content_same": false
        },
        {
          "line": 2890,
          "old_api": "sdsfree",
          "new_api": "strcasecmp",
          "old_text": "sdsfree(errors)",
          "new_text": "strcasecmp(sub,\"load\")",
          "old_line_content": "            sdsfree(errors);",
          "new_line_content": "    } else if (!strcasecmp(sub,\"load\") && c->argc == 2) {",
          "content_same": false
        },
        {
          "line": 2893,
          "old_api": "ACLSaveToFile",
          "new_api": "addReply",
          "old_text": "ACLSaveToFile(server.acl_filename)",
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "        if (ACLSaveToFile(server.acl_filename) == C_OK) {",
          "new_line_content": "            addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 2896,
          "old_api": "addReplyError",
          "new_api": "sdsfree",
          "old_text": "addReplyError(c,\"There was an error trying to save the ACLs. \"\n                            \"Please check the server logs for more \"\n                            \"information\")",
          "new_text": "sdsfree(errors)",
          "old_line_content": "            addReplyError(c,\"There was an error trying to save the ACLs. \"",
          "new_line_content": "            sdsfree(errors);",
          "content_same": false
        },
        {
          "line": 2900,
          "old_api": "strcasecmp",
          "new_api": "addReply",
          "old_text": "strcasecmp(sub,\"cat\")",
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "    } else if (!strcasecmp(sub,\"cat\") && c->argc == 2) {",
          "new_line_content": "            addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 2907,
          "old_api": "ACLGetCommandCategoryFlagByName",
          "new_api": "addReplyDeferredLen",
          "old_text": "ACLGetCommandCategoryFlagByName(c->argv[2]->ptr)",
          "new_text": "addReplyDeferredLen(c)",
          "old_line_content": "        uint64_t cflag = ACLGetCommandCategoryFlagByName(c->argv[2]->ptr);",
          "new_line_content": "        void *dl = addReplyDeferredLen(c);",
          "content_same": false
        },
        {
          "line": 2913,
          "old_api": "addReplyDeferredLen",
          "new_api": "ACLGetCommandCategoryFlagByName",
          "old_text": "addReplyDeferredLen(c)",
          "new_text": "ACLGetCommandCategoryFlagByName(c->argv[2]->ptr)",
          "old_line_content": "        void *dl = addReplyDeferredLen(c);",
          "new_line_content": "        uint64_t cflag = ACLGetCommandCategoryFlagByName(c->argv[2]->ptr);",
          "content_same": false
        },
        {
          "line": 2915,
          "old_api": "setDeferredArrayLen",
          "new_api": "addReplyErrorFormat",
          "old_text": "setDeferredArrayLen(c,dl,arraylen)",
          "new_text": "addReplyErrorFormat(c, \"Unknown category '%.128s'\", (char*)c->argv[2]->ptr)",
          "old_line_content": "        setDeferredArrayLen(c,dl,arraylen);",
          "new_line_content": "            addReplyErrorFormat(c, \"Unknown category '%.128s'\", (char*)c->argv[2]->ptr);",
          "content_same": false
        },
        {
          "line": 2921,
          "old_api": "getLongFromObjectOrReply",
          "new_api": "setDeferredArrayLen",
          "old_text": "getLongFromObjectOrReply(c,c->argv[2],&bits,NULL)",
          "new_text": "setDeferredArrayLen(c,dl,arraylen)",
          "old_line_content": "        if (c->argc == 3 && getLongFromObjectOrReply(c,c->argv[2],&bits,NULL)",
          "new_line_content": "        setDeferredArrayLen(c,dl,arraylen);",
          "content_same": false
        },
        {
          "line": 2948,
          "old_api": "getLongFromObjectOrReply",
          "new_api": "strcasecmp",
          "old_text": "getLongFromObjectOrReply(c,c->argv[2],&count,NULL)",
          "new_text": "strcasecmp(c->argv[2]->ptr,\"reset\")",
          "old_line_content": "            } else if (getLongFromObjectOrReply(c,c->argv[2],&count,NULL)",
          "new_line_content": "            if (!strcasecmp(c->argv[2]->ptr,\"reset\")) {",
          "content_same": false
        },
        {
          "line": 2963,
          "old_api": "listRewind",
          "new_api": "listLength",
          "old_text": "listRewind(ACLLog,&li)",
          "new_text": "listLength(ACLLog)",
          "old_line_content": "        listRewind(ACLLog,&li);",
          "new_line_content": "        if ((size_t)count > listLength(ACLLog))",
          "content_same": false
        },
        {
          "line": 2964,
          "old_api": "commandTimeSnapshot",
          "new_api": "listLength",
          "old_text": "commandTimeSnapshot()",
          "new_text": "listLength(ACLLog)",
          "old_line_content": "        mstime_t now = commandTimeSnapshot();",
          "new_line_content": "            count = listLength(ACLLog);",
          "content_same": false
        },
        {
          "line": 2966,
          "old_api": "listNodeValue",
          "new_api": "addReplyArrayLen",
          "old_text": "listNodeValue(ln)",
          "new_text": "addReplyArrayLen(c,count)",
          "old_line_content": "            ACLLogEntry *le = listNodeValue(ln);",
          "new_line_content": "        addReplyArrayLen(c,count);",
          "content_same": false
        },
        {
          "line": 2969,
          "old_api": "addReplyLongLong",
          "new_api": "listRewind",
          "old_text": "addReplyLongLong(c,le->count)",
          "new_text": "listRewind(ACLLog,&li)",
          "old_line_content": "            addReplyLongLong(c,le->count);",
          "new_line_content": "        listRewind(ACLLog,&li);",
          "content_same": false
        },
        {
          "line": 2971,
          "old_api": "addReplyBulkCString",
          "new_api": "listNext",
          "old_text": "addReplyBulkCString(c,\"reason\")",
          "new_text": "listNext(&li)",
          "old_line_content": "            addReplyBulkCString(c,\"reason\");",
          "new_line_content": "        while (count-- && (ln = listNext(&li)) != NULL) {",
          "content_same": false
        },
        {
          "line": 2999,
          "old_api": "addReplyDouble",
          "new_api": "addReplyBulkCString",
          "old_text": "addReplyDouble(c,age)",
          "new_text": "addReplyBulkCString(c,\"object\")",
          "old_line_content": "            addReplyDouble(c,age);",
          "new_line_content": "            addReplyBulkCString(c,\"object\");",
          "content_same": false
        },
        {
          "line": 3000,
          "old_api": "addReplyBulkCString",
          "new_api": "sdslen",
          "old_text": "addReplyBulkCString(c,\"client-info\")",
          "new_text": "sdslen(le->object)",
          "old_line_content": "            addReplyBulkCString(c,\"client-info\");",
          "new_line_content": "            addReplyBulkCBuffer(c,le->object,sdslen(le->object));",
          "content_same": false
        },
        {
          "line": 3001,
          "old_api": "sdslen",
          "new_api": "addReplyBulkCString",
          "old_text": "sdslen(le->cinfo)",
          "new_text": "addReplyBulkCString(c,\"username\")",
          "old_line_content": "            addReplyBulkCBuffer(c,le->cinfo,sdslen(le->cinfo));",
          "new_line_content": "            addReplyBulkCString(c,\"username\");",
          "content_same": false
        },
        {
          "line": 3002,
          "old_api": "addReplyBulkCString",
          "new_api": "sdslen",
          "old_text": "addReplyBulkCString(c, \"entry-id\")",
          "new_text": "sdslen(le->username)",
          "old_line_content": "            addReplyBulkCString(c, \"entry-id\");",
          "new_line_content": "            addReplyBulkCBuffer(c,le->username,sdslen(le->username));",
          "content_same": false
        },
        {
          "line": 3003,
          "old_api": "addReplyLongLong",
          "new_api": "addReplyBulkCString",
          "old_text": "addReplyLongLong(c, le->entry_id)",
          "new_text": "addReplyBulkCString(c,\"age-seconds\")",
          "old_line_content": "            addReplyLongLong(c, le->entry_id);",
          "new_line_content": "            addReplyBulkCString(c,\"age-seconds\");",
          "content_same": false
        },
        {
          "line": 3005,
          "old_api": "addReplyLongLong",
          "new_api": "addReplyDouble",
          "old_text": "addReplyLongLong(c, le->timestamp_created)",
          "new_text": "addReplyDouble(c,age)",
          "old_line_content": "            addReplyLongLong(c, le->timestamp_created);",
          "new_line_content": "            addReplyDouble(c,age);",
          "content_same": false
        },
        {
          "line": 3007,
          "old_api": "addReplyLongLong",
          "new_api": "sdslen",
          "old_text": "addReplyLongLong(c, le->ctime)",
          "new_text": "sdslen(le->cinfo)",
          "old_line_content": "            addReplyLongLong(c, le->ctime);",
          "new_line_content": "            addReplyBulkCBuffer(c,le->cinfo,sdslen(le->cinfo));",
          "content_same": false
        },
        {
          "line": 3009,
          "old_api": "strcasecmp",
          "new_api": "addReplyLongLong",
          "old_text": "strcasecmp(sub,\"dryrun\")",
          "new_text": "addReplyLongLong(c, le->entry_id)",
          "old_line_content": "    } else if (!strcasecmp(sub,\"dryrun\") && c->argc >= 4) {",
          "new_line_content": "            addReplyLongLong(c, le->entry_id);",
          "content_same": false
        },
        {
          "line": 3011,
          "old_api": "sdslen",
          "new_api": "addReplyLongLong",
          "old_text": "sdslen(c->argv[2]->ptr)",
          "new_text": "addReplyLongLong(c, le->timestamp_created)",
          "old_line_content": "        user *u = ACLGetUserByName(c->argv[2]->ptr,sdslen(c->argv[2]->ptr));",
          "new_line_content": "            addReplyLongLong(c, le->timestamp_created);",
          "content_same": false
        },
        {
          "line": 3013,
          "old_api": "addReplyErrorFormat",
          "new_api": "addReplyLongLong",
          "old_text": "addReplyErrorFormat(c, \"User '%s' not found\", (char *)c->argv[2]->ptr)",
          "new_text": "addReplyLongLong(c, le->ctime)",
          "old_line_content": "            addReplyErrorFormat(c, \"User '%s' not found\", (char *)c->argv[2]->ptr);",
          "new_line_content": "            addReplyLongLong(c, le->ctime);",
          "content_same": false
        },
        {
          "line": 3017,
          "old_api": "lookupCommand",
          "new_api": "sdslen",
          "old_text": "lookupCommand(c->argv + 3, c->argc - 3)",
          "new_text": "sdslen(c->argv[2]->ptr)",
          "old_line_content": "        if ((cmd = lookupCommand(c->argv + 3, c->argc - 3)) == NULL) {",
          "new_line_content": "        user *u = ACLGetUserByName(c->argv[2]->ptr,sdslen(c->argv[2]->ptr));",
          "content_same": false
        },
        {
          "line": 3038,
          "old_api": "strcasecmp",
          "new_api": "getAclErrorMessage",
          "old_text": "strcasecmp(sub,\"help\")",
          "new_text": "getAclErrorMessage(result, u, cmd,  c->argv[idx+3]->ptr, 1)",
          "old_line_content": "    } else if (c->argc == 2 && !strcasecmp(sub,\"help\")) {",
          "new_line_content": "            sds err = getAclErrorMessage(result, u, cmd,  c->argv[idx+3]->ptr, 1);",
          "content_same": false
        },
        {
          "line": 3076,
          "old_api": "addReplyDeferredLen",
          "new_api": "addReplySubcommandSyntaxError",
          "old_text": "addReplyDeferredLen(c)",
          "new_text": "addReplySubcommandSyntaxError(c)",
          "old_line_content": "    void *flaglen = addReplyDeferredLen(c);",
          "new_line_content": "        addReplySubcommandSyntaxError(c);",
          "content_same": false
        },
        {
          "line": 3124,
          "old_api": "addReply",
          "new_api": "redactClientCommandArgument",
          "old_text": "addReply(c, shared.ok)",
          "new_text": "redactClientCommandArgument(c, 2)",
          "old_line_content": "        addReply(c, shared.ok);",
          "new_line_content": "        redactClientCommandArgument(c, 2);",
          "content_same": false
        },
        {
          "line": 3128,
          "old_api": "decrRefCount",
          "new_api": "ACLAuthenticateUser",
          "old_text": "decrRefCount(err)",
          "new_text": "ACLAuthenticateUser(c, username, password, &err)",
          "old_line_content": "    if (err) decrRefCount(err);",
          "new_line_content": "    int result = ACLAuthenticateUser(c, username, password, &err);",
          "content_same": false
        },
        {
          "line": 3134,
          "old_api": "ACLSetUser",
          "new_api": "decrRefCount",
          "old_text": "ACLSetUser(DefaultUser,\"resetpass\",-1)",
          "new_text": "decrRefCount(err)",
          "old_line_content": "    ACLSetUser(DefaultUser,\"resetpass\",-1);",
          "new_line_content": "    if (err) decrRefCount(err);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 3074,
          "old_api": null,
          "new_api": "addReplyHelp",
          "old_text": null,
          "new_text": "addReplyHelp(c,help)",
          "old_line_content": "void addReplyCommandCategories(client *c, struct redisCommand *cmd) {",
          "new_line_content": "        addReplyHelp(c,help);",
          "content_same": false
        },
        {
          "line": 3082,
          "old_api": null,
          "new_api": "addReplyDeferredLen",
          "old_text": null,
          "new_text": "addReplyDeferredLen(c)",
          "old_line_content": "    }",
          "new_line_content": "    void *flaglen = addReplyDeferredLen(c);",
          "content_same": false
        },
        {
          "line": 2060,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(acl_args[j])",
          "old_line_content": "        }",
          "new_line_content": "        if (ACLSetUser(tempu,acl_args[j],(ssize_t) sdslen(acl_args[j])) != C_OK) {",
          "content_same": false
        },
        {
          "line": 2061,
          "old_api": null,
          "new_api": "ACLSetUserStringError",
          "old_text": null,
          "new_text": "ACLSetUserStringError()",
          "old_line_content": "    }",
          "new_line_content": "            const char *errmsg = ACLSetUserStringError();",
          "content_same": false
        },
        {
          "line": 2062,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "",
          "new_line_content": "            error = sdscatfmt(sdsempty(),",
          "content_same": false
        },
        {
          "line": 3085,
          "old_api": null,
          "new_api": "addReplyStatusFormat",
          "old_text": null,
          "new_text": "addReplyStatusFormat(c, \"@%s\", ACLCommandCategories[j].name)",
          "old_line_content": "",
          "new_line_content": "            addReplyStatusFormat(c, \"@%s\", ACLCommandCategories[j].name);",
          "content_same": false
        },
        {
          "line": 3089,
          "old_api": null,
          "new_api": "setDeferredSetLen",
          "old_text": null,
          "new_text": "setDeferredSetLen(c, flaglen, flagcount)",
          "old_line_content": " * When the user is omitted it means that we are trying to authenticate",
          "new_line_content": "    setDeferredSetLen(c, flaglen, flagcount);",
          "content_same": false
        },
        {
          "line": 2579,
          "old_api": null,
          "new_api": "zmalloc",
          "old_text": null,
          "new_text": "zmalloc(sizeof(*le))",
          "old_line_content": "    le->timestamp_created = le->ctime;",
          "new_line_content": "    struct ACLLogEntry *le = zmalloc(sizeof(*le));",
          "content_same": false
        },
        {
          "line": 2582,
          "old_api": null,
          "new_api": "sdsdup",
          "old_text": null,
          "new_text": "sdsdup(username ? username : c->user->name)",
          "old_line_content": "        le->object = object;",
          "new_line_content": "    le->username = sdsdup(username ? username : c->user->name);",
          "content_same": false
        },
        {
          "line": 2583,
          "old_api": null,
          "new_api": "commandTimeSnapshot",
          "old_text": null,
          "new_text": "commandTimeSnapshot()",
          "old_line_content": "    } else {",
          "new_line_content": "    le->ctime = commandTimeSnapshot();",
          "content_same": false
        },
        {
          "line": 2072,
          "old_api": null,
          "new_api": "ACLKillPubsubClientsIfNeeded",
          "old_text": null,
          "new_text": "ACLKillPubsubClientsIfNeeded(tempu, u)",
          "old_line_content": "    }",
          "new_line_content": "        ACLKillPubsubClientsIfNeeded(tempu, u);",
          "content_same": false
        },
        {
          "line": 3100,
          "old_api": null,
          "new_api": "addReplyErrorObject",
          "old_text": null,
          "new_text": "addReplyErrorObject(c,shared.syntaxerr)",
          "old_line_content": "    /* Handle the two different forms here. The form with two arguments",
          "new_line_content": "        addReplyErrorObject(c,shared.syntaxerr);",
          "content_same": false
        },
        {
          "line": 2077,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(username)",
          "old_line_content": "cleanup:",
          "new_line_content": "        u = ACLCreateUser(username,sdslen(username));",
          "content_same": false
        },
        {
          "line": 2079,
          "old_api": null,
          "new_api": "serverAssert",
          "old_text": null,
          "new_text": "serverAssert(u != NULL)",
          "old_line_content": "    for (int i = 0; i < merged_argc; i++) {",
          "new_line_content": "    serverAssert(u != NULL);",
          "content_same": false
        },
        {
          "line": 2591,
          "old_api": null,
          "new_api": "sdsdup",
          "old_text": null,
          "new_text": "sdsdup(c->cmd->fullname)",
          "old_line_content": "    }",
          "new_line_content": "            case ACL_DENIED_CMD: le->object = sdsdup(c->cmd->fullname); break;",
          "content_same": false
        },
        {
          "line": 2081,
          "old_api": null,
          "new_api": "ACLCopyUser",
          "old_text": null,
          "new_text": "ACLCopyUser(u, tempu)",
          "old_line_content": "    }",
          "new_line_content": "    ACLCopyUser(u, tempu);",
          "content_same": false
        },
        {
          "line": 2592,
          "old_api": null,
          "new_api": "sdsdup",
          "old_text": null,
          "new_text": "sdsdup(c->argv[argpos]->ptr)",
          "old_line_content": "",
          "new_line_content": "            case ACL_DENIED_KEY: le->object = sdsdup(c->argv[argpos]->ptr); break;",
          "content_same": false
        },
        {
          "line": 2593,
          "old_api": null,
          "new_api": "sdsdup",
          "old_text": null,
          "new_text": "sdsdup(c->argv[argpos]->ptr)",
          "old_line_content": "    /* if we have a real client from the network, use it (could be missing on module timers) */",
          "new_line_content": "            case ACL_DENIED_CHANNEL: le->object = sdsdup(c->argv[argpos]->ptr); break;",
          "content_same": false
        },
        {
          "line": 2084,
          "old_api": null,
          "new_api": "ACLFreeUser",
          "old_text": null,
          "new_text": "ACLFreeUser(tempu)",
          "old_line_content": "    return error;",
          "new_line_content": "    ACLFreeUser(tempu);",
          "content_same": false
        },
        {
          "line": 2594,
          "old_api": null,
          "new_api": "sdsdup",
          "old_text": null,
          "new_text": "sdsdup(c->argv[0]->ptr)",
          "old_line_content": "    client *realclient = server.current_client? server.current_client : c;",
          "new_line_content": "            case ACL_DENIED_AUTH: le->object = sdsdup(c->argv[0]->ptr); break;",
          "content_same": false
        },
        {
          "line": 2086,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(acl_args[i])",
          "old_line_content": "",
          "new_line_content": "        sdsfree(acl_args[i]);",
          "content_same": false
        },
        {
          "line": 2595,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "",
          "new_line_content": "            default: le->object = sdsempty();",
          "content_same": false
        },
        {
          "line": 2088,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(acl_args)",
          "old_line_content": " *",
          "new_line_content": "    zfree(acl_args);",
          "content_same": false
        },
        {
          "line": 3104,
          "old_api": null,
          "new_api": "redactClientCommandArgument",
          "old_text": null,
          "new_text": "redactClientCommandArgument(c, 1)",
          "old_line_content": "        /* Mimic the old behavior of giving an error for the two argument",
          "new_line_content": "    redactClientCommandArgument(c, 1);",
          "content_same": false
        },
        {
          "line": 2602,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "    listIter li;",
          "new_line_content": "    le->cinfo = catClientInfoString(sdsempty(),realclient);",
          "content_same": false
        },
        {
          "line": 3113,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c,\"AUTH <password> called without any password \"\n                            \"configured for the default user. Are you sure \"\n                            \"your configuration is correct?\")",
          "old_line_content": "        username = shared.default_username; ",
          "new_line_content": "            addReplyError(c,\"AUTH <password> called without any password \"",
          "content_same": false
        },
        {
          "line": 2612,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "            break;",
          "new_line_content": "    while (toscan-- && (ln = listNext(&li)) != NULL) {",
          "content_same": false
        },
        {
          "line": 2613,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "        }",
          "new_line_content": "        ACLLogEntry *current = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 2614,
          "old_api": null,
          "new_api": "ACLLogMatchEntry",
          "old_text": null,
          "new_text": "ACLLogMatchEntry(current,le)",
          "old_line_content": "    }",
          "new_line_content": "        if (ACLLogMatchEntry(current,le)) {",
          "content_same": false
        },
        {
          "line": 2616,
          "old_api": null,
          "new_api": "listDelNode",
          "old_text": null,
          "new_text": "listDelNode(ACLLog,ln)",
          "old_line_content": "    /* If there is a match update the entry, otherwise add it as a",
          "new_line_content": "            listDelNode(ACLLog,ln);",
          "content_same": false
        },
        {
          "line": 2617,
          "old_api": null,
          "new_api": "listAddNodeHead",
          "old_text": null,
          "new_text": "listAddNodeHead(ACLLog,current)",
          "old_line_content": "     * new one. */",
          "new_line_content": "            listAddNodeHead(ACLLog,current);",
          "content_same": false
        },
        {
          "line": 3130,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c, shared.ok)",
          "old_line_content": "",
          "new_line_content": "        addReply(c, shared.ok);",
          "content_same": false
        },
        {
          "line": 3132,
          "old_api": null,
          "new_api": "addAuthErrReply",
          "old_text": null,
          "new_text": "addAuthErrReply(c, err)",
          "old_line_content": " * requirepass config, so passing in NULL will set the user to be nopass. */",
          "new_line_content": "        addAuthErrReply(c, err);",
          "content_same": false
        },
        {
          "line": 2112,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(argv[0],\"user\")",
          "old_line_content": "        if (argc_err) *argc_err = 1;",
          "new_line_content": "    if (argc < 2 || strcasecmp(argv[0],\"user\")) {",
          "content_same": false
        },
        {
          "line": 2627,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(match->cinfo)",
          "old_line_content": "        le->cinfo = NULL;",
          "new_line_content": "        sdsfree(match->cinfo);",
          "content_same": false
        },
        {
          "line": 1947,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(o->ptr)",
          "old_line_content": "            if (!kill) {",
          "new_line_content": "                    int res = ACLCheckChannelAgainstList(upcoming, o->ptr, sdslen(o->ptr), 0);",
          "content_same": false
        },
        {
          "line": 2117,
          "old_api": null,
          "new_api": "listSearchKey",
          "old_text": null,
          "new_text": "listSearchKey(UsersToLoad, argv[1])",
          "old_line_content": "    /* Merged selectors before trying to process */",
          "new_line_content": "    if (listSearchKey(UsersToLoad, argv[1])) {",
          "content_same": false
        },
        {
          "line": 3142,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(password)",
          "old_line_content": "}",
          "new_line_content": "        sds aclop = sdscatlen(sdsnew(\">\"), password, sdslen(password));",
          "content_same": false
        },
        {
          "line": 3143,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(aclop)",
          "old_line_content": "",
          "new_line_content": "        ACLSetUser(DefaultUser,aclop,sdslen(aclop));",
          "content_same": false
        },
        {
          "line": 3144,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(aclop)",
          "old_line_content": "",
          "new_line_content": "        sdsfree(aclop);",
          "content_same": false
        },
        {
          "line": 3146,
          "old_api": null,
          "new_api": "ACLSetUser",
          "old_text": null,
          "new_text": "ACLSetUser(DefaultUser,\"nopass\",-1)",
          "old_line_content": "",
          "new_line_content": "        ACLSetUser(DefaultUser,\"nopass\",-1);",
          "content_same": false
        },
        {
          "line": 2125,
          "old_api": null,
          "new_api": "ACLMergeSelectorArguments",
          "old_text": null,
          "new_text": "ACLMergeSelectorArguments(argv + 2, argc - 2, &merged_argc, argc_err)",
          "old_line_content": "    /* Try to apply the user rules in a fake user to see if they",
          "new_line_content": "    sds *acl_args = ACLMergeSelectorArguments(argv + 2, argc - 2, &merged_argc, argc_err);",
          "content_same": false
        },
        {
          "line": 2639,
          "old_api": null,
          "new_api": "listAddNodeHead",
          "old_text": null,
          "new_text": "listAddNodeHead(ACLLog, le)",
          "old_line_content": "        }",
          "new_line_content": "        listAddNodeHead(ACLLog, le);",
          "content_same": false
        },
        {
          "line": 2640,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(ACLLog)",
          "old_line_content": "    }",
          "new_line_content": "        while(listLength(ACLLog) > server.acllog_max_len) {",
          "content_same": false
        },
        {
          "line": 2641,
          "old_api": null,
          "new_api": "listLast",
          "old_text": null,
          "new_text": "listLast(ACLLog)",
          "old_line_content": "}",
          "new_line_content": "            listNode *ln = listLast(ACLLog);",
          "content_same": false
        },
        {
          "line": 2642,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "",
          "new_line_content": "            ACLLogEntry *le = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 2643,
          "old_api": null,
          "new_api": "ACLFreeLogEntry",
          "old_text": null,
          "new_text": "ACLFreeLogEntry(le)",
          "old_line_content": "sds getAclErrorMessage(int acl_res, user *user, struct redisCommand *cmd, sds errored_val, int verbose) {",
          "new_line_content": "            ACLFreeLogEntry(le);",
          "content_same": false
        },
        {
          "line": 2644,
          "old_api": null,
          "new_api": "listDelNode",
          "old_text": null,
          "new_text": "listDelNode(ACLLog,ln)",
          "old_line_content": "    switch (acl_res) {",
          "new_line_content": "            listDelNode(ACLLog,ln);",
          "content_same": false
        },
        {
          "line": 2133,
          "old_api": null,
          "new_api": "ACLCreateUnlinkedUser",
          "old_text": null,
          "new_text": "ACLCreateUnlinkedUser()",
          "old_line_content": "                if (argc_err) *argc_err = j;",
          "new_line_content": "    user *fakeuser = ACLCreateUnlinkedUser();",
          "content_same": false
        },
        {
          "line": 2136,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(acl_args[j])",
          "old_line_content": "                return C_ERR;",
          "new_line_content": "        if (ACLSetUser(fakeuser,acl_args[j],sdslen(acl_args[j])) == C_ERR) {",
          "content_same": false
        },
        {
          "line": 2138,
          "old_api": null,
          "new_api": "ACLFreeUser",
          "old_text": null,
          "new_text": "ACLFreeUser(fakeuser)",
          "old_line_content": "        }",
          "new_line_content": "                ACLFreeUser(fakeuser);",
          "content_same": false
        },
        {
          "line": 2140,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(acl_args[i])",
          "old_line_content": "",
          "new_line_content": "                for (int i = 0; i < merged_argc; i++) sdsfree(acl_args[i]);",
          "content_same": false
        },
        {
          "line": 2141,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(acl_args)",
          "old_line_content": "    /* Rules look valid, let's append the user to the list. */",
          "new_line_content": "                zfree(acl_args);",
          "content_same": false
        },
        {
          "line": 2652,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "        } else {",
          "new_line_content": "        return sdscatfmt(sdsempty(), \"User %S has no permissions to run \"",
          "content_same": false
        },
        {
          "line": 2656,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "        if (verbose) {",
          "new_line_content": "            return sdscatfmt(sdsempty(), \"User %S has no permissions to access \"",
          "content_same": false
        },
        {
          "line": 2659,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(\"No permissions to access a key\")",
          "old_line_content": "        } else {",
          "new_line_content": "            return sdsnew(\"No permissions to access a key\");",
          "content_same": false
        },
        {
          "line": 2150,
          "old_api": null,
          "new_api": "sdsdup",
          "old_text": null,
          "new_text": "sdsdup(acl_args[j])",
          "old_line_content": "    return C_OK;",
          "new_line_content": "    for (int j = 0; j < merged_argc; j++) copy[j+1] = sdsdup(acl_args[j]);",
          "content_same": false
        },
        {
          "line": 2152,
          "old_api": null,
          "new_api": "listAddNodeTail",
          "old_text": null,
          "new_text": "listAddNodeTail(UsersToLoad,copy)",
          "old_line_content": "",
          "new_line_content": "    listAddNodeTail(UsersToLoad,copy);",
          "content_same": false
        },
        {
          "line": 2153,
          "old_api": null,
          "new_api": "ACLFreeUser",
          "old_text": null,
          "new_text": "ACLFreeUser(fakeuser)",
          "old_line_content": "/* This function will load the configured users appended to the server",
          "new_line_content": "    ACLFreeUser(fakeuser);",
          "content_same": false
        },
        {
          "line": 2154,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(acl_args[i])",
          "old_line_content": " * configuration via ACLAppendUserForLoading(). On loading errors it will",
          "new_line_content": "    for (int i = 0; i < merged_argc; i++) sdsfree(acl_args[i]);",
          "content_same": false
        },
        {
          "line": 2155,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(acl_args)",
          "old_line_content": " * log an error and return C_ERR, otherwise C_OK will be returned. */",
          "new_line_content": "    zfree(acl_args);",
          "content_same": false
        },
        {
          "line": 2666,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(\"No permissions to access a channel\")",
          "old_line_content": "/* =============================================================================",
          "new_line_content": "            return sdsnew(\"No permissions to access a channel\");",
          "content_same": false
        },
        {
          "line": 2669,
          "old_api": null,
          "new_api": "serverPanic",
          "old_text": null,
          "new_text": "serverPanic(\"Reached deadcode on getAclErrorMessage\")",
          "old_line_content": "",
          "new_line_content": "    serverPanic(\"Reached deadcode on getAclErrorMessage\");",
          "content_same": false
        },
        {
          "line": 2166,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "            return C_ERR;",
          "new_line_content": "    while ((ln = listNext(&li)) != NULL) {",
          "content_same": false
        },
        {
          "line": 2167,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "        }",
          "new_line_content": "        sds *aclrules = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 2681,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "        }",
          "new_line_content": "    while ((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 2170,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(aclrules[0])",
          "old_line_content": "        if (!u) {",
          "new_line_content": "        if (ACLStringHasSpaces(aclrules[0],sdslen(aclrules[0]))) {",
          "content_same": false
        },
        {
          "line": 2171,
          "old_api": null,
          "new_api": "serverLog",
          "old_text": null,
          "new_text": "serverLog(LL_WARNING,\"Spaces not allowed in ACL usernames\")",
          "old_line_content": "            /* Only valid duplicate user is the default one. */",
          "new_line_content": "            serverLog(LL_WARNING,\"Spaces not allowed in ACL usernames\");",
          "content_same": false
        },
        {
          "line": 2682,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "",
          "new_line_content": "        struct redisCommand *cmd = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 2685,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(cmd->fullname)",
          "old_line_content": "        }",
          "new_line_content": "            addReplyBulkCBuffer(c, cmd->fullname, sdslen(cmd->fullname));",
          "content_same": false
        },
        {
          "line": 2175,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(username)",
          "old_line_content": "        }",
          "new_line_content": "        user *u = ACLCreateUser(username,sdslen(username));",
          "content_same": false
        },
        {
          "line": 2178,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(username, \"default\")",
          "old_line_content": "        for (int j = 1; aclrules[j]; j++) {",
          "new_line_content": "            serverAssert(!strcmp(username, \"default\"));",
          "content_same": false
        },
        {
          "line": 2690,
          "old_api": null,
          "new_api": "aclCatWithFlags",
          "old_text": null,
          "new_text": "aclCatWithFlags(c, cmd->subcommands_dict, cflag, arraylen)",
          "old_line_content": "/* Add the formatted response from a single selector to the ACL GETUSER",
          "new_line_content": "            aclCatWithFlags(c, cmd->subcommands_dict, cflag, arraylen);",
          "content_same": false
        },
        {
          "line": 2693,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": " * Setting verbose to 1 means that the full qualifier for key and channel",
          "new_line_content": "    dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 2185,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(aclrules[j])",
          "old_line_content": "            }",
          "new_line_content": "            if (ACLSetUser(u,aclrules[j],sdslen(aclrules[j])) != C_OK) {",
          "content_same": false
        },
        {
          "line": 2186,
          "old_api": null,
          "new_api": "ACLSetUserStringError",
          "old_text": null,
          "new_text": "ACLSetUserStringError()",
          "old_line_content": "        }",
          "new_line_content": "                const char *errmsg = ACLSetUserStringError();",
          "content_same": false
        },
        {
          "line": 2187,
          "old_api": null,
          "new_api": "serverLog",
          "old_text": null,
          "new_text": "serverLog(LL_WARNING,\"Error loading ACL rule '%s' for \"\n                                     \"the user named '%s': %s\",\n                          aclrules[j],aclrules[0],errmsg)",
          "old_line_content": "",
          "new_line_content": "                serverLog(LL_WARNING,\"Error loading ACL rule '%s' for \"",
          "content_same": false
        },
        {
          "line": 2707,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"commands\")",
          "old_line_content": "    if (s->flags & SELECTOR_FLAG_ALLKEYS) {",
          "new_line_content": "    addReplyBulkCString(c,\"commands\");",
          "content_same": false
        },
        {
          "line": 2197,
          "old_api": null,
          "new_api": "serverLog",
          "old_text": null,
          "new_text": "serverLog(LL_NOTICE, \"The user '%s' is disabled (there is no \"\n                                 \"'on' modifier in the user description). Make \"\n                                 \"sure this is not a configuration error.\",\n                      aclrules[0])",
          "old_line_content": "    return C_OK;",
          "new_line_content": "            serverLog(LL_NOTICE, \"The user '%s' is disabled (there is no \"",
          "content_same": false
        },
        {
          "line": 2709,
          "old_api": null,
          "new_api": "addReplyBulkSds",
          "old_text": null,
          "new_text": "addReplyBulkSds(c,cmddescr)",
          "old_line_content": "    } else {",
          "new_line_content": "    addReplyBulkSds(c,cmddescr);",
          "content_same": false
        },
        {
          "line": 2716,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "        }",
          "new_line_content": "        sds dsl = sdsempty();",
          "content_same": false
        },
        {
          "line": 2718,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "    }",
          "new_line_content": "        while((ln = listNext(&li))) {",
          "content_same": false
        },
        {
          "line": 2719,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "",
          "new_line_content": "            keyPattern *thispat = (keyPattern *) listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 2720,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(dsl, \" \")",
          "old_line_content": "    /* Pub/sub patterns */",
          "new_line_content": "            if (ln != listFirst(s->patterns)) dsl = sdscat(dsl, \" \");",
          "content_same": false
        },
        {
          "line": 2731,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "        }",
          "new_line_content": "        sds dsl = sdsempty();",
          "content_same": false
        },
        {
          "line": 2733,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "    }",
          "new_line_content": "        while((ln = listNext(&li))) {",
          "content_same": false
        },
        {
          "line": 2734,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "    return 3;",
          "new_line_content": "            sds thispat = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 2735,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(dsl, \" \")",
          "old_line_content": "}",
          "new_line_content": "            if (ln != listFirst(s->channels)) dsl = sdscat(dsl, \" \");",
          "content_same": false
        },
        {
          "line": 2736,
          "old_api": null,
          "new_api": "sdscatfmt",
          "old_text": null,
          "new_text": "sdscatfmt(dsl, \"&%S\", thispat)",
          "old_line_content": "",
          "new_line_content": "            dsl = sdscatfmt(dsl, \"&%S\", thispat);",
          "content_same": false
        },
        {
          "line": 2738,
          "old_api": null,
          "new_api": "addReplyBulkSds",
          "old_text": null,
          "new_text": "addReplyBulkSds(c, dsl)",
          "old_line_content": " * ACL HELP",
          "new_line_content": "        addReplyBulkSds(c, dsl);",
          "content_same": false
        },
        {
          "line": 2234,
          "old_api": null,
          "new_api": "fopen",
          "old_text": null,
          "new_text": "fopen(filename,\"r\")",
          "old_line_content": "",
          "new_line_content": "    if ((fp = fopen(filename,\"r\")) == NULL) {",
          "content_same": false
        },
        {
          "line": 2235,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "    /* Load the whole file as a single string in memory. */",
          "new_line_content": "        sds errors = sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 2242,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "    int totlines;",
          "new_line_content": "    sds acls = sdsempty();",
          "content_same": false
        },
        {
          "line": 2759,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(sub,\"setuser\")",
          "old_line_content": "",
          "new_line_content": "    if (!strcasecmp(sub,\"setuser\") && c->argc >= 3) {",
          "content_same": false
        },
        {
          "line": 2249,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "     * old version. */",
          "new_line_content": "    sds *lines, errors = sdsempty();",
          "content_same": false
        },
        {
          "line": 2250,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(acls)",
          "old_line_content": "    rax *old_users = Users;",
          "new_line_content": "    lines = sdssplitlen(acls,strlen(acls),\"\\n\",1,&totlines);",
          "content_same": false
        },
        {
          "line": 2257,
          "old_api": null,
          "new_api": "raxNew",
          "old_text": null,
          "new_text": "raxNew()",
          "old_line_content": "        int linenum = i+1;",
          "new_line_content": "    Users = raxNew();",
          "content_same": false
        },
        {
          "line": 2769,
          "old_api": null,
          "new_api": "addReplyErrorFormat",
          "old_text": null,
          "new_text": "addReplyErrorFormat(c,\n                \"Usernames can't contain spaces or null characters\")",
          "old_line_content": "",
          "new_line_content": "            addReplyErrorFormat(c,",
          "content_same": false
        },
        {
          "line": 2779,
          "old_api": null,
          "new_api": "ACLStringSetUser",
          "old_text": null,
          "new_text": "ACLStringSetUser(u, username, temp_argv, c->argc - 3)",
          "old_line_content": "        }",
          "new_line_content": "        sds error = ACLStringSetUser(u, username, temp_argv, c->argc - 3);",
          "content_same": false
        },
        {
          "line": 2780,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(temp_argv)",
          "old_line_content": "        return;",
          "new_line_content": "        zfree(temp_argv);",
          "content_same": false
        },
        {
          "line": 2782,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "        int deleted = 0;",
          "new_line_content": "            addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 2271,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(lines[i])",
          "old_line_content": "        }",
          "new_line_content": "        argv = sdssplitlen(lines[i],sdslen(lines[i]),\" \",1,&argc);",
          "content_same": false
        },
        {
          "line": 2784,
          "old_api": null,
          "new_api": "addReplyErrorSdsSafe",
          "old_text": null,
          "new_text": "addReplyErrorSdsSafe(c, error)",
          "old_line_content": "            sds username = c->argv[j]->ptr;",
          "new_line_content": "            addReplyErrorSdsSafe(c, error);",
          "content_same": false
        },
        {
          "line": 2273,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(errors,\n                     \"%s:%d: unbalanced quotes in acl line. \",\n                     server.acl_filename, linenum)",
          "old_line_content": "        /* Skip this line if the resulting command vector is empty. */",
          "new_line_content": "            errors = sdscatprintf(errors,",
          "content_same": false
        },
        {
          "line": 2787,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(sub,\"deluser\")",
          "old_line_content": "                return;",
          "new_line_content": "    } else if (!strcasecmp(sub,\"deluser\") && c->argc >= 3) {",
          "content_same": false
        },
        {
          "line": 2791,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(username,\"default\")",
          "old_line_content": "        for (int j = 2; j < c->argc; j++) {",
          "new_line_content": "            if (!strcmp(username,\"default\")) {",
          "content_same": false
        },
        {
          "line": 2792,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c,\"The 'default' user cannot be removed\")",
          "old_line_content": "            sds username = c->argv[j]->ptr;",
          "new_line_content": "                addReplyError(c,\"The 'default' user cannot be removed\");",
          "content_same": false
        },
        {
          "line": 2286,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(argv[0],\"user\")",
          "old_line_content": "            continue;",
          "new_line_content": "        if (strcmp(argv[0],\"user\") || argc < 2) {",
          "content_same": false
        },
        {
          "line": 2287,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(errors,\n                     \"%s:%d should start with user keyword followed \"\n                     \"by the username. \", server.acl_filename,\n                     linenum)",
          "old_line_content": "        }",
          "new_line_content": "            errors = sdscatprintf(errors,",
          "content_same": false
        },
        {
          "line": 2800,
          "old_api": null,
          "new_api": "raxRemove",
          "old_text": null,
          "new_text": "raxRemove(Users,(unsigned char*)username,\n                          sdslen(username),\n                          (void**)&u)",
          "old_line_content": "            }",
          "new_line_content": "            if (raxRemove(Users,(unsigned char*)username,",
          "content_same": false
        },
        {
          "line": 2801,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(username)",
          "old_line_content": "        }",
          "new_line_content": "                          sdslen(username),",
          "content_same": false
        },
        {
          "line": 2296,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(argv[1])",
          "old_line_content": "        }",
          "new_line_content": "        if (ACLStringHasSpaces(argv[1],sdslen(argv[1]))) {",
          "content_same": false
        },
        {
          "line": 2297,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(errors,\n                     \"'%s:%d: username '%s' contains invalid characters. \",\n                     server.acl_filename, linenum, argv[1])",
          "old_line_content": "",
          "new_line_content": "            errors = sdscatprintf(errors,",
          "content_same": false
        },
        {
          "line": 2808,
          "old_api": null,
          "new_api": "addReplyLongLong",
          "old_text": null,
          "new_text": "addReplyLongLong(c,deleted)",
          "old_line_content": "        }",
          "new_line_content": "        addReplyLongLong(c,deleted);",
          "content_same": false
        },
        {
          "line": 2809,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(sub,\"getuser\")",
          "old_line_content": "",
          "new_line_content": "    } else if (!strcasecmp(sub,\"getuser\") && c->argc == 3) {",
          "content_same": false
        },
        {
          "line": 2300,
          "old_api": null,
          "new_api": "sdsfreesplitres",
          "old_text": null,
          "new_text": "sdsfreesplitres(argv,argc)",
          "old_line_content": "        /* If the user already exists we assume it's an error and abort. */",
          "new_line_content": "            sdsfreesplitres(argv,argc);",
          "content_same": false
        },
        {
          "line": 2812,
          "old_api": null,
          "new_api": "addReplyNull",
          "old_text": null,
          "new_text": "addReplyNull(c)",
          "old_line_content": "",
          "new_line_content": "            addReplyNull(c);",
          "content_same": false
        },
        {
          "line": 2304,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(argv[1])",
          "old_line_content": "            continue;",
          "new_line_content": "        user *u = ACLCreateUser(argv[1],sdslen(argv[1]));",
          "content_same": false
        },
        {
          "line": 2816,
          "old_api": null,
          "new_api": "addReplyDeferredLen",
          "old_text": null,
          "new_text": "addReplyDeferredLen(c)",
          "old_line_content": "        int numflags = 0;",
          "new_line_content": "        void *ufields = addReplyDeferredLen(c);",
          "content_same": false
        },
        {
          "line": 2308,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(errors,\"WARNING: Duplicate user '%s' found on line %d. \", argv[1], linenum)",
          "old_line_content": "         * be cleanly applied to the user. If any option fails",
          "new_line_content": "            errors = sdscatprintf(errors,\"WARNING: Duplicate user '%s' found on line %d. \", argv[1], linenum);",
          "content_same": false
        },
        {
          "line": 2309,
          "old_api": null,
          "new_api": "sdsfreesplitres",
          "old_text": null,
          "new_text": "sdsfreesplitres(argv,argc)",
          "old_line_content": "         * to apply, the other values won't be applied since",
          "new_line_content": "            sdsfreesplitres(argv,argc);",
          "content_same": false
        },
        {
          "line": 2820,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"flags\")",
          "old_line_content": "                numflags++;",
          "new_line_content": "        addReplyBulkCString(c,\"flags\");",
          "content_same": false
        },
        {
          "line": 2821,
          "old_api": null,
          "new_api": "addReplyDeferredLen",
          "old_text": null,
          "new_text": "addReplyDeferredLen(c)",
          "old_line_content": "            }",
          "new_line_content": "        void *deflen = addReplyDeferredLen(c);",
          "content_same": false
        },
        {
          "line": 2825,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,ACLUserFlags[j].name)",
          "old_line_content": "        /* Passwords */",
          "new_line_content": "                addReplyBulkCString(c,ACLUserFlags[j].name);",
          "content_same": false
        },
        {
          "line": 2829,
          "old_api": null,
          "new_api": "setDeferredSetLen",
          "old_text": null,
          "new_text": "setDeferredSetLen(c,deflen,numflags)",
          "old_line_content": "        listNode *ln;",
          "new_line_content": "        setDeferredSetLen(c,deflen,numflags);",
          "content_same": false
        },
        {
          "line": 2318,
          "old_api": null,
          "new_api": "ACLMergeSelectorArguments",
          "old_text": null,
          "new_text": "ACLMergeSelectorArguments(argv + 2, argc - 2, &merged_argc, NULL)",
          "old_line_content": "",
          "new_line_content": "        sds *acl_args = ACLMergeSelectorArguments(argv + 2, argc - 2, &merged_argc, NULL);",
          "content_same": false
        },
        {
          "line": 2320,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(errors,\n                    \"%s:%d: Unmatched parenthesis in selector definition.\",\n                    server.acl_filename, linenum)",
          "old_line_content": "        for (int j = 0; j < merged_argc; j++) {",
          "new_line_content": "            errors = sdscatprintf(errors,",
          "content_same": false
        },
        {
          "line": 2837,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "",
          "new_line_content": "        while((ln = listNext(&li))) {",
          "content_same": false
        },
        {
          "line": 2838,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "        /* Describe all of the selectors on this user, including duplicating the root selector */",
          "new_line_content": "            sds thispass = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 2328,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(acl_args[j])",
          "old_line_content": "                            \"%s:%d: Error in applying operation '%s': %s. \",",
          "new_line_content": "            if (ACLSetUser(u,acl_args[j],sdslen(acl_args[j])) != C_OK) {",
          "content_same": false
        },
        {
          "line": 2329,
          "old_api": null,
          "new_api": "ACLSetUserStringError",
          "old_text": null,
          "new_text": "ACLSetUserStringError()",
          "old_line_content": "                            server.acl_filename, linenum, acl_args[j], errmsg);",
          "new_line_content": "                const char *errmsg = ACLSetUserStringError();",
          "content_same": false
        },
        {
          "line": 2847,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(u->selectors,&li)",
          "old_line_content": "        } ",
          "new_line_content": "        listRewind(u->selectors,&li);",
          "content_same": false
        },
        {
          "line": 2850,
          "old_api": null,
          "new_api": "addReplyDeferredLen",
          "old_text": null,
          "new_text": "addReplyDeferredLen(c)",
          "old_line_content": "               c->argc == 2)",
          "new_line_content": "            void *slen = addReplyDeferredLen(c);",
          "content_same": false
        },
        {
          "line": 2851,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "    {",
          "new_line_content": "            int sfields = aclAddReplySelectorDescription(c, (aclSelector *)listNodeValue(ln));",
          "content_same": false
        },
        {
          "line": 2339,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(errors,\n                            \"%s:%d: %s. \",\n                            server.acl_filename, linenum, errmsg)",
          "old_line_content": "        }",
          "new_line_content": "                    errors = sdscatprintf(errors,",
          "content_same": false
        },
        {
          "line": 2854,
          "old_api": null,
          "new_api": "setDeferredMapLen",
          "old_text": null,
          "new_text": "setDeferredMapLen(c, ufields, fields)",
          "old_line_content": "        raxIterator ri;",
          "new_line_content": "        setDeferredMapLen(c, ufields, fields);",
          "content_same": false
        },
        {
          "line": 2858,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(sub,\"users\")",
          "old_line_content": "            user *u = ri.data;",
          "new_line_content": "        int justnames = !strcasecmp(sub,\"users\");",
          "content_same": false
        },
        {
          "line": 2859,
          "old_api": null,
          "new_api": "raxSize",
          "old_text": null,
          "new_text": "raxSize(Users)",
          "old_line_content": "            if (justnames) {",
          "new_line_content": "        addReplyArrayLen(c,raxSize(Users));",
          "content_same": false
        },
        {
          "line": 2861,
          "old_api": null,
          "new_api": "raxStart",
          "old_text": null,
          "new_text": "raxStart(&ri,Users)",
          "old_line_content": "            } else {",
          "new_line_content": "        raxStart(&ri,Users);",
          "content_same": false
        },
        {
          "line": 2862,
          "old_api": null,
          "new_api": "raxSeek",
          "old_text": null,
          "new_text": "raxSeek(&ri,\"^\",NULL,0)",
          "old_line_content": "                /* Return information in the configuration file format. */",
          "new_line_content": "        raxSeek(&ri,\"^\",NULL,0);",
          "content_same": false
        },
        {
          "line": 2353,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(errors)",
          "old_line_content": "    }",
          "new_line_content": "        if (sdslen(errors) != 0) {",
          "content_same": false
        },
        {
          "line": 2354,
          "old_api": null,
          "new_api": "sdsfreesplitres",
          "old_text": null,
          "new_text": "sdsfreesplitres(argv,argc)",
          "old_line_content": "",
          "new_line_content": "            sdsfreesplitres(argv,argc);",
          "content_same": false
        },
        {
          "line": 2870,
          "old_api": null,
          "new_api": "sdscatsds",
          "old_text": null,
          "new_text": "sdscatsds(config,u->name)",
          "old_line_content": "            }",
          "new_line_content": "                config = sdscatsds(config,u->name);",
          "content_same": false
        },
        {
          "line": 2871,
          "old_api": null,
          "new_api": "sdscatlen",
          "old_text": null,
          "new_text": "sdscatlen(config,\" \",1)",
          "old_line_content": "        }",
          "new_line_content": "                config = sdscatlen(config,\" \",1);",
          "content_same": false
        },
        {
          "line": 2361,
          "old_api": null,
          "new_api": "sdsfreesplitres",
          "old_text": null,
          "new_text": "sdsfreesplitres(lines,totlines)",
          "old_line_content": "         * default user configuration in the old one. */",
          "new_line_content": "    sdsfreesplitres(lines,totlines);",
          "content_same": false
        },
        {
          "line": 2874,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(descr)",
          "old_line_content": "        if (c->user != NULL) {",
          "new_line_content": "                decrRefCount(descr);",
          "content_same": false
        },
        {
          "line": 2878,
          "old_api": null,
          "new_api": "raxStop",
          "old_text": null,
          "new_text": "raxStop(&ri)",
          "old_line_content": "        }",
          "new_line_content": "        raxStop(&ri);",
          "content_same": false
        },
        {
          "line": 2879,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(sub,\"whoami\")",
          "old_line_content": "    } else if (server.acl_filename[0] == '\\0' &&",
          "new_line_content": "    } else if (!strcasecmp(sub,\"whoami\") && c->argc == 2) {",
          "content_same": false
        },
        {
          "line": 2881,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(c->user->name)",
          "old_line_content": "    {",
          "new_line_content": "            addReplyBulkCBuffer(c,c->user->name,sdslen(c->user->name));",
          "content_same": false
        },
        {
          "line": 2883,
          "old_api": null,
          "new_api": "addReplyNull",
          "old_text": null,
          "new_text": "addReplyNull(c)",
          "old_line_content": "        return;",
          "new_line_content": "            addReplyNull(c);",
          "content_same": false
        },
        {
          "line": 2373,
          "old_api": null,
          "new_api": "ACLCopyUser",
          "old_text": null,
          "new_text": "ACLCopyUser(DefaultUser,new_default)",
          "old_line_content": "        return NULL;",
          "new_line_content": "        ACLCopyUser(DefaultUser,new_default);",
          "content_same": false
        },
        {
          "line": 2374,
          "old_api": null,
          "new_api": "ACLFreeUser",
          "old_text": null,
          "new_text": "ACLFreeUser(new_default)",
          "old_line_content": "    } else {",
          "new_line_content": "        ACLFreeUser(new_default);",
          "content_same": false
        },
        {
          "line": 2886,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(sub,\"save\")",
          "old_line_content": "        if (errors == NULL) {",
          "new_line_content": "               (!strcasecmp(sub,\"load\") || !strcasecmp(sub,\"save\")))",
          "content_same": false
        },
        {
          "line": 2376,
          "old_api": null,
          "new_api": "raxRemove",
          "old_text": null,
          "new_text": "raxRemove(old_users,(unsigned char*)\"default\",7,NULL)",
          "old_line_content": "        Users = old_users;",
          "new_line_content": "        raxRemove(old_users,(unsigned char*)\"default\",7,NULL);",
          "content_same": false
        },
        {
          "line": 2888,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c,\"This Redis instance is not configured to use an ACL file. You may want to specify users via the ACL SETUSER command and then issue a CONFIG REWRITE (assuming you have a Redis configuration file set) in order to store users in the Redis configuration.\")",
          "old_line_content": "        } else {",
          "new_line_content": "        addReplyError(c,\"This Redis instance is not configured to use an ACL file. You may want to specify users via the ACL SETUSER command and then issue a CONFIG REWRITE (assuming you have a Redis configuration file set) in order to store users in the Redis configuration.\");",
          "content_same": false
        },
        {
          "line": 2378,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(errors)",
          "old_line_content": "        return errors;",
          "new_line_content": "        sdsfree(errors);",
          "content_same": false
        },
        {
          "line": 2891,
          "old_api": null,
          "new_api": "ACLLoadFromFile",
          "old_text": null,
          "new_text": "ACLLoadFromFile(server.acl_filename)",
          "old_line_content": "        }",
          "new_line_content": "        sds errors = ACLLoadFromFile(server.acl_filename);",
          "content_same": false
        },
        {
          "line": 1863,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(server.pubsub_patterns)",
          "old_line_content": "    listNode *ln, *lpn;",
          "new_line_content": "    if (!dictSize(server.pubsub_patterns) &&",
          "content_same": false
        },
        {
          "line": 2381,
          "old_api": null,
          "new_api": "ACLFreeUsersSet",
          "old_text": null,
          "new_text": "ACLFreeUsersSet(Users)",
          "old_line_content": "",
          "new_line_content": "        ACLFreeUsersSet(Users);",
          "content_same": false
        },
        {
          "line": 1864,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(server.pubsub_channels)",
          "old_line_content": "    robj *o;",
          "new_line_content": "        !dictSize(server.pubsub_channels) &&",
          "content_same": false
        },
        {
          "line": 2383,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(errors,\"WARNING: ACL errors detected, no change to the previously active ACL rules was performed\")",
          "old_line_content": " * Returns C_OK on success or C_ERR if there was an error during the I/O.",
          "new_line_content": "        errors = sdscat(errors,\"WARNING: ACL errors detected, no change to the previously active ACL rules was performed\");",
          "content_same": false
        },
        {
          "line": 2895,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c,errors)",
          "old_line_content": "        } else {",
          "new_line_content": "            addReplyError(c,errors);",
          "content_same": false
        },
        {
          "line": 1865,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(server.pubsubshard_channels)",
          "old_line_content": "    int kill = 0;",
          "new_line_content": "        !dictSize(server.pubsubshard_channels))",
          "content_same": false
        },
        {
          "line": 2898,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(sub,\"save\")",
          "old_line_content": "                            \"information\");",
          "new_line_content": "    } else if (!strcasecmp(sub,\"save\") && c->argc == 2) {",
          "content_same": false
        },
        {
          "line": 2899,
          "old_api": null,
          "new_api": "ACLSaveToFile",
          "old_text": null,
          "new_text": "ACLSaveToFile(server.acl_filename)",
          "old_line_content": "        }",
          "new_line_content": "        if (ACLSaveToFile(server.acl_filename) == C_OK) {",
          "content_same": false
        },
        {
          "line": 1875,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(new->selectors,&li)",
          "old_line_content": "    /* Second optimization is to check if the new list of channels",
          "new_line_content": "    listRewind(new->selectors,&li);",
          "content_same": false
        },
        {
          "line": 1876,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "     * is a strict superset of the original. This is done by",
          "new_line_content": "    while((ln = listNext(&li))) {",
          "content_same": false
        },
        {
          "line": 2902,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c,\"There was an error trying to save the ACLs. \"\n                            \"Please check the server logs for more \"\n                            \"information\")",
          "old_line_content": "        int j;",
          "new_line_content": "            addReplyError(c,\"There was an error trying to save the ACLs. \"",
          "content_same": false
        },
        {
          "line": 1877,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "     * created an \"upcoming\" list of all channels that are in",
          "new_line_content": "        aclSelector *s = (aclSelector *) listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 2392,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "     * ACL file. */",
          "new_line_content": "    sds acl = sdsempty();",
          "content_same": false
        },
        {
          "line": 2910,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,ACLCommandCategories[j].name)",
          "old_line_content": "            return;",
          "new_line_content": "            addReplyBulkCString(c,ACLCommandCategories[j].name);",
          "content_same": false
        },
        {
          "line": 2911,
          "old_api": null,
          "new_api": "setDeferredArrayLen",
          "old_text": null,
          "new_text": "setDeferredArrayLen(c,dl,j)",
          "old_line_content": "        }",
          "new_line_content": "        setDeferredArrayLen(c,dl,j);",
          "content_same": false
        },
        {
          "line": 2912,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(sub,\"cat\")",
          "old_line_content": "        int arraylen = 0;",
          "new_line_content": "    } else if (!strcasecmp(sub,\"cat\") && c->argc == 3) {",
          "content_same": false
        },
        {
          "line": 1887,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(new->selectors,&li)",
          "old_line_content": "        }",
          "new_line_content": "    listRewind(new->selectors,&li);",
          "content_same": false
        },
        {
          "line": 1888,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "    }",
          "new_line_content": "    while((ln = listNext(&li))) {",
          "content_same": false
        },
        {
          "line": 1889,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "",
          "new_line_content": "        aclSelector *s = (aclSelector *) listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 1890,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(s->channels, &lpi)",
          "old_line_content": "    int match = 1;",
          "new_line_content": "        listRewind(s->channels, &lpi);",
          "content_same": false
        },
        {
          "line": 2919,
          "old_api": null,
          "new_api": "addReplyDeferredLen",
          "old_text": null,
          "new_text": "addReplyDeferredLen(c)",
          "old_line_content": "        long bits = 256; /* By default generate 256 bits passwords. */",
          "new_line_content": "        void *dl = addReplyDeferredLen(c);",
          "content_same": false
        },
        {
          "line": 2408,
          "old_api": null,
          "new_api": "ACLDescribeUser",
          "old_text": null,
          "new_text": "ACLDescribeUser(u)",
          "old_line_content": "    }",
          "new_line_content": "        robj *descr = ACLDescribeUser(u);",
          "content_same": false
        },
        {
          "line": 2920,
          "old_api": null,
          "new_api": "aclCatWithFlags",
          "old_text": null,
          "new_text": "aclCatWithFlags(c, server.orig_commands, cflag, &arraylen)",
          "old_line_content": "",
          "new_line_content": "        aclCatWithFlags(c, server.orig_commands, cflag, &arraylen);",
          "content_same": false
        },
        {
          "line": 2410,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(descr)",
          "old_line_content": "",
          "new_line_content": "        decrRefCount(descr);",
          "content_same": false
        },
        {
          "line": 2411,
          "old_api": null,
          "new_api": "sdscatsds",
          "old_text": null,
          "new_text": "sdscatsds(acl,user)",
          "old_line_content": "    /* Create a temp file with the new content. */",
          "new_line_content": "        acl = sdscatsds(acl,user);",
          "content_same": false
        },
        {
          "line": 2922,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(sub,\"genpass\")",
          "old_line_content": "            != C_OK) return;",
          "new_line_content": "    } else if (!strcasecmp(sub,\"genpass\") && (c->argc == 2 || c->argc == 3)) {",
          "content_same": false
        },
        {
          "line": 1897,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(original->selectors,&li)",
          "old_line_content": "        if (s->flags & SELECTOR_FLAG_ALLCHANNELS) {",
          "new_line_content": "    listRewind(original->selectors,&li);",
          "content_same": false
        },
        {
          "line": 1898,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "            match = 0;",
          "new_line_content": "    while((ln = listNext(&li)) && match) {",
          "content_same": false
        },
        {
          "line": 2927,
          "old_api": null,
          "new_api": "getLongFromObjectOrReply",
          "old_text": null,
          "new_text": "getLongFromObjectOrReply(c,c->argv[2],&bits,NULL)",
          "old_line_content": "                \"bits for the output password, a positive number \"",
          "new_line_content": "        if (c->argc == 3 && getLongFromObjectOrReply(c,c->argv[2],&bits,NULL)",
          "content_same": false
        },
        {
          "line": 1899,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "            break;",
          "new_line_content": "        aclSelector *s = (aclSelector *) listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 2418,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(filename)",
          "old_line_content": "        goto cleanup;",
          "new_line_content": "    tmpfilename = sdsnew(filename);",
          "content_same": false
        },
        {
          "line": 2419,
          "old_api": null,
          "new_api": "sdscatfmt",
          "old_text": null,
          "new_text": "sdscatfmt(tmpfilename,\".tmp-%i-%I\",\n        (int) getpid(),commandTimeSnapshot())",
          "old_line_content": "    }",
          "new_line_content": "    tmpfilename = sdscatfmt(tmpfilename,\".tmp-%i-%I\",",
          "content_same": false
        },
        {
          "line": 2420,
          "old_api": null,
          "new_api": "commandTimeSnapshot",
          "old_text": null,
          "new_text": "commandTimeSnapshot()",
          "old_line_content": "",
          "new_line_content": "        (int) getpid(),commandTimeSnapshot());",
          "content_same": false
        },
        {
          "line": 2421,
          "old_api": null,
          "new_api": "open",
          "old_text": null,
          "new_text": "open(tmpfilename,O_WRONLY|O_CREAT,0644)",
          "old_line_content": "    /* Write it. */",
          "new_line_content": "    if ((fd = open(tmpfilename,O_WRONLY|O_CREAT,0644)) == -1) {",
          "content_same": false
        },
        {
          "line": 2422,
          "old_api": null,
          "new_api": "serverLog",
          "old_text": null,
          "new_text": "serverLog(LL_WARNING,\"Opening temp ACL file for ACL SAVE: %s\",\n            strerror(errno))",
          "old_line_content": "    size_t offset = 0;",
          "new_line_content": "        serverLog(LL_WARNING,\"Opening temp ACL file for ACL SAVE: %s\",",
          "content_same": false
        },
        {
          "line": 2931,
          "old_api": null,
          "new_api": "addReplyErrorFormat",
          "old_text": null,
          "new_text": "addReplyErrorFormat(c,\n                \"ACL GENPASS argument must be the number of \"\n                \"bits for the output password, a positive number \"\n                \"up to %d\",GENPASS_MAX_BITS)",
          "old_line_content": "",
          "new_line_content": "            addReplyErrorFormat(c,",
          "content_same": false
        },
        {
          "line": 1907,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(s->channels, &lpi)",
          "old_line_content": "        }",
          "new_line_content": "        listRewind(s->channels, &lpi);",
          "content_same": false
        },
        {
          "line": 1908,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&lpi)",
          "old_line_content": "    }",
          "new_line_content": "        while((lpn = listNext(&lpi)) && match) {",
          "content_same": false
        },
        {
          "line": 1909,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(lpn)",
          "old_line_content": "",
          "new_line_content": "            if (!listSearchKey(upcoming, listNodeValue(lpn))) {",
          "content_same": false
        },
        {
          "line": 2939,
          "old_api": null,
          "new_api": "getRandomHexChars",
          "old_text": null,
          "new_text": "getRandomHexChars(pass,chars)",
          "old_line_content": "         * the number of entries the user wants to display, or alternatively",
          "new_line_content": "        getRandomHexChars(pass,chars);",
          "content_same": false
        },
        {
          "line": 2940,
          "old_api": null,
          "new_api": "addReplyBulkCBuffer",
          "old_text": null,
          "new_text": "addReplyBulkCBuffer(c,pass,chars)",
          "old_line_content": "         * the \"RESET\" command in order to flush the old entries. */",
          "new_line_content": "        addReplyBulkCBuffer(c,pass,chars);",
          "content_same": false
        },
        {
          "line": 2429,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(acl)",
          "old_line_content": "            goto cleanup;",
          "new_line_content": "    while (offset < sdslen(acl)) {",
          "content_same": false
        },
        {
          "line": 2430,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(acl)",
          "old_line_content": "        }",
          "new_line_content": "        ssize_t written_bytes = write(fd,acl + offset,sdslen(acl) - offset);",
          "content_same": false
        },
        {
          "line": 2941,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(sub,\"log\")",
          "old_line_content": "        if (c->argc == 3) {",
          "new_line_content": "    } else if (!strcasecmp(sub,\"log\") && (c->argc == 2 || c->argc ==3)) {",
          "content_same": false
        },
        {
          "line": 1918,
          "old_api": null,
          "new_api": "listRelease",
          "old_text": null,
          "new_text": "listRelease(upcoming)",
          "old_line_content": "     * Scan all connected clients to find the user's pub/subs. */",
          "new_line_content": "        listRelease(upcoming);",
          "content_same": false
        },
        {
          "line": 2949,
          "old_api": null,
          "new_api": "listSetFreeMethod",
          "old_text": null,
          "new_text": "listSetFreeMethod(ACLLog,ACLFreeLogEntry)",
          "old_line_content": "                       != C_OK)",
          "new_line_content": "                listSetFreeMethod(ACLLog,ACLFreeLogEntry);",
          "content_same": false
        },
        {
          "line": 2950,
          "old_api": null,
          "new_api": "listEmpty",
          "old_text": null,
          "new_text": "listEmpty(ACLLog)",
          "old_line_content": "            {",
          "new_line_content": "                listEmpty(ACLLog);",
          "content_same": false
        },
        {
          "line": 2439,
          "old_api": null,
          "new_api": "redis_fsync",
          "old_text": null,
          "new_text": "redis_fsync(fd)",
          "old_line_content": "",
          "new_line_content": "    if (redis_fsync(fd) == -1) {",
          "content_same": false
        },
        {
          "line": 2440,
          "old_api": null,
          "new_api": "serverLog",
          "old_text": null,
          "new_text": "serverLog(LL_WARNING,\"Syncing ACL file for ACL SAVE: %s\",\n            strerror(errno))",
          "old_line_content": "    /* Let's replace the new file with the old one. */",
          "new_line_content": "        serverLog(LL_WARNING,\"Syncing ACL file for ACL SAVE: %s\",",
          "content_same": false
        },
        {
          "line": 2951,
          "old_api": null,
          "new_api": "listSetFreeMethod",
          "old_text": null,
          "new_text": "listSetFreeMethod(ACLLog,NULL)",
          "old_line_content": "                return;",
          "new_line_content": "                listSetFreeMethod(ACLLog,NULL);",
          "content_same": false
        },
        {
          "line": 2952,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "            }",
          "new_line_content": "                addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 2954,
          "old_api": null,
          "new_api": "getLongFromObjectOrReply",
          "old_text": null,
          "new_text": "getLongFromObjectOrReply(c,c->argv[2],&count,NULL)",
          "old_line_content": "        }",
          "new_line_content": "            } else if (getLongFromObjectOrReply(c,c->argv[2],&count,NULL)",
          "content_same": false
        },
        {
          "line": 2444,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "        goto cleanup;",
          "new_line_content": "    close(fd); fd = -1;",
          "content_same": false
        },
        {
          "line": 1925,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(server.clients,&li)",
          "old_line_content": "            /* Check for pattern violations. */",
          "new_line_content": "    listRewind(server.clients,&li);",
          "content_same": false
        },
        {
          "line": 1927,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "            dictEntry *de;",
          "new_line_content": "        client *c = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 1932,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(c->pubsub_patterns)",
          "old_line_content": "            }",
          "new_line_content": "            dictIterator *di = dictGetIterator(c->pubsub_patterns);",
          "content_same": false
        },
        {
          "line": 1934,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "",
          "new_line_content": "            while (!kill && ((de = dictNext(di)) != NULL)) {",
          "content_same": false
        },
        {
          "line": 2449,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "        goto cleanup;",
          "new_line_content": "            strerror(errno));",
          "content_same": false
        },
        {
          "line": 1935,
          "old_api": null,
          "new_api": "dictGetKey",
          "old_text": null,
          "new_text": "dictGetKey(de)",
          "old_line_content": "            /* Check for channel violations. */",
          "new_line_content": "                o = dictGetKey(de);",
          "content_same": false
        },
        {
          "line": 1936,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(o->ptr)",
          "old_line_content": "            if (!kill) {",
          "new_line_content": "                int res = ACLCheckChannelAgainstList(upcoming, o->ptr, sdslen(o->ptr), 1);",
          "content_same": false
        },
        {
          "line": 2452,
          "old_api": null,
          "new_api": "fsyncFileDir",
          "old_text": null,
          "new_text": "fsyncFileDir(filename)",
          "old_line_content": "    retval = C_OK; /* If we reached this point, everything is fine. */",
          "new_line_content": "    if (fsyncFileDir(filename) == -1) {",
          "content_same": false
        },
        {
          "line": 2453,
          "old_api": null,
          "new_api": "serverLog",
          "old_text": null,
          "new_text": "serverLog(LL_WARNING,\"Syncing ACL directory for ACL SAVE: %s\",\n            strerror(errno))",
          "old_line_content": "",
          "new_line_content": "        serverLog(LL_WARNING,\"Syncing ACL directory for ACL SAVE: %s\",",
          "content_same": false
        },
        {
          "line": 2454,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "cleanup:",
          "new_line_content": "            strerror(errno));",
          "content_same": false
        },
        {
          "line": 1945,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "            }",
          "new_line_content": "                while (!kill && ((de = dictNext(di)) != NULL)) {",
          "content_same": false
        },
        {
          "line": 2970,
          "old_api": null,
          "new_api": "commandTimeSnapshot",
          "old_text": null,
          "new_text": "commandTimeSnapshot()",
          "old_line_content": "",
          "new_line_content": "        mstime_t now = commandTimeSnapshot();",
          "content_same": false
        },
        {
          "line": 1946,
          "old_api": null,
          "new_api": "dictGetKey",
          "old_text": null,
          "new_text": "dictGetKey(de)",
          "old_line_content": "",
          "new_line_content": "                    o = dictGetKey(de);",
          "content_same": false
        },
        {
          "line": 2972,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "            char *reasonstr;",
          "new_line_content": "            ACLLogEntry *le = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 2461,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "",
          "new_line_content": "    if (fd != -1) close(fd);",
          "content_same": false
        },
        {
          "line": 2462,
          "old_api": null,
          "new_api": "unlink",
          "old_text": null,
          "new_text": "unlink(tmpfilename)",
          "old_line_content": "/* This function is called once the server is already running, modules are",
          "new_line_content": "    if (tmpfilename) unlink(tmpfilename);",
          "content_same": false
        },
        {
          "line": 2463,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(tmpfilename)",
          "old_line_content": " * loaded, and we are ready to start, in order to load the ACLs either from",
          "new_line_content": "    sdsfree(tmpfilename);",
          "content_same": false
        },
        {
          "line": 2464,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(acl)",
          "old_line_content": " * the pending list of users defined in redis.conf, or from the ACL file.",
          "new_line_content": "    sdsfree(acl);",
          "content_same": false
        },
        {
          "line": 2973,
          "old_api": null,
          "new_api": "addReplyMapLen",
          "old_text": null,
          "new_text": "addReplyMapLen(c,10)",
          "old_line_content": "            switch(le->reason) {",
          "new_line_content": "            addReplyMapLen(c,10);",
          "content_same": false
        },
        {
          "line": 2974,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"count\")",
          "old_line_content": "            case ACL_DENIED_CMD: reasonstr=\"command\"; break;",
          "new_line_content": "            addReplyBulkCString(c,\"count\");",
          "content_same": false
        },
        {
          "line": 2975,
          "old_api": null,
          "new_api": "addReplyLongLong",
          "old_text": null,
          "new_text": "addReplyLongLong(c,le->count)",
          "old_line_content": "            case ACL_DENIED_KEY: reasonstr=\"key\"; break;",
          "new_line_content": "            addReplyLongLong(c,le->count);",
          "content_same": false
        },
        {
          "line": 2977,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"reason\")",
          "old_line_content": "            case ACL_DENIED_AUTH: reasonstr=\"auth\"; break;",
          "new_line_content": "            addReplyBulkCString(c,\"reason\");",
          "content_same": false
        },
        {
          "line": 1956,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "            }",
          "new_line_content": "                while (!kill && ((de = dictNext(di)) != NULL)) {",
          "content_same": false
        },
        {
          "line": 1957,
          "old_api": null,
          "new_api": "dictGetKey",
          "old_text": null,
          "new_text": "dictGetKey(de)",
          "old_line_content": "",
          "new_line_content": "                    o = dictGetKey(de);",
          "content_same": false
        },
        {
          "line": 1958,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(o->ptr)",
          "old_line_content": "            /* Kill it. */",
          "new_line_content": "                    int res = ACLCheckChannelAgainstList(upcoming, o->ptr, sdslen(o->ptr), 0);",
          "content_same": false
        },
        {
          "line": 1961,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "            }",
          "new_line_content": "                dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 2474,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(UsersToLoad)",
          "old_line_content": "            \"directly in your redis.conf, but not both.\");",
          "new_line_content": "    if (server.acl_filename[0] != '\\0' && listLength(UsersToLoad) != 0) {",
          "content_same": false
        },
        {
          "line": 2986,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,reasonstr)",
          "old_line_content": "            case ACL_LOG_CTX_MULTI: ctxstr=\"multi\"; break;",
          "new_line_content": "            addReplyBulkCString(c,reasonstr);",
          "content_same": false
        },
        {
          "line": 2988,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c,\"context\")",
          "old_line_content": "            case ACL_LOG_CTX_MODULE: ctxstr=\"module\"; break;",
          "new_line_content": "            addReplyBulkCString(c,\"context\");",
          "content_same": false
        },
        {
          "line": 1966,
          "old_api": null,
          "new_api": "freeClient",
          "old_text": null,
          "new_text": "freeClient(c)",
          "old_line_content": "",
          "new_line_content": "                freeClient(c);",
          "content_same": false
        },
        {
          "line": 1970,
          "old_api": null,
          "new_api": "listRelease",
          "old_text": null,
          "new_text": "listRelease(upcoming)",
          "old_line_content": "",
          "new_line_content": "    listRelease(upcoming);",
          "content_same": false
        },
        {
          "line": 2484,
          "old_api": null,
          "new_api": "ACLLoadConfiguredUsers",
          "old_text": null,
          "new_text": "ACLLoadConfiguredUsers()",
          "old_line_content": "    if (server.acl_filename[0] != '\\0') {",
          "new_line_content": "    if (ACLLoadConfiguredUsers() == C_ERR) {",
          "content_same": false
        },
        {
          "line": 2491,
          "old_api": null,
          "new_api": "ACLLoadFromFile",
          "old_text": null,
          "new_text": "ACLLoadFromFile(server.acl_filename)",
          "old_line_content": "        }",
          "new_line_content": "        sds errors = ACLLoadFromFile(server.acl_filename);",
          "content_same": false
        },
        {
          "line": 2493,
          "old_api": null,
          "new_api": "serverLog",
          "old_text": null,
          "new_text": "serverLog(LL_WARNING,\n                \"Aborting Redis startup because of ACL errors: %s\", errors)",
          "old_line_content": "}",
          "new_line_content": "            serverLog(LL_WARNING,",
          "content_same": false
        },
        {
          "line": 2495,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(errors)",
          "old_line_content": "/* =============================================================================",
          "new_line_content": "            sdsfree(errors);",
          "content_same": false
        },
        {
          "line": 2496,
          "old_api": null,
          "new_api": "exit",
          "old_text": null,
          "new_text": "exit(1)",
          "old_line_content": " * ACL log",
          "new_line_content": "            exit(1);",
          "content_same": false
        },
        {
          "line": 3008,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c, \"entry-id\")",
          "old_line_content": "        }",
          "new_line_content": "            addReplyBulkCString(c, \"entry-id\");",
          "content_same": false
        },
        {
          "line": 3010,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c, \"timestamp-created\")",
          "old_line_content": "        struct redisCommand *cmd;",
          "new_line_content": "            addReplyBulkCString(c, \"timestamp-created\");",
          "content_same": false
        },
        {
          "line": 3012,
          "old_api": null,
          "new_api": "addReplyBulkCString",
          "old_text": null,
          "new_text": "addReplyBulkCString(c, \"timestamp-last-updated\")",
          "old_line_content": "        if (u == NULL) {",
          "new_line_content": "            addReplyBulkCString(c, \"timestamp-last-updated\");",
          "content_same": false
        },
        {
          "line": 3015,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(sub,\"dryrun\")",
          "old_line_content": "        }",
          "new_line_content": "    } else if (!strcasecmp(sub,\"dryrun\") && c->argc >= 4) {",
          "content_same": false
        },
        {
          "line": 1993,
          "old_api": null,
          "new_api": "zmalloc",
          "old_text": null,
          "new_text": "zmalloc(sizeof(sds) * argc)",
          "old_line_content": "        if (open_bracket_start == -1 &&",
          "new_line_content": "    sds *acl_args = (sds *) zmalloc(sizeof(sds) * argc);",
          "content_same": false
        },
        {
          "line": 3019,
          "old_api": null,
          "new_api": "addReplyErrorFormat",
          "old_text": null,
          "new_text": "addReplyErrorFormat(c, \"User '%s' not found\", (char *)c->argv[2]->ptr)",
          "old_line_content": "            return;",
          "new_line_content": "            addReplyErrorFormat(c, \"User '%s' not found\", (char *)c->argv[2]->ptr);",
          "content_same": false
        },
        {
          "line": 3023,
          "old_api": null,
          "new_api": "lookupCommand",
          "old_text": null,
          "new_text": "lookupCommand(c->argv + 3, c->argc - 3)",
          "old_line_content": "            (c->argc-3 < -cmd->arity))",
          "new_line_content": "        if ((cmd = lookupCommand(c->argv + 3, c->argc - 3)) == NULL) {",
          "content_same": false
        },
        {
          "line": 3024,
          "old_api": null,
          "new_api": "addReplyErrorFormat",
          "old_text": null,
          "new_text": "addReplyErrorFormat(c, \"Command '%s' not found\", (char *)c->argv[3]->ptr)",
          "old_line_content": "        {",
          "new_line_content": "            addReplyErrorFormat(c, \"Command '%s' not found\", (char *)c->argv[3]->ptr);",
          "content_same": false
        },
        {
          "line": 2000,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(op)",
          "old_line_content": "        if (open_bracket_start != -1) {",
          "new_line_content": "            (op[0] == '(' && op[sdslen(op) - 1] != ')')) {",
          "content_same": false
        },
        {
          "line": 3031,
          "old_api": null,
          "new_api": "addReplyErrorFormat",
          "old_text": null,
          "new_text": "addReplyErrorFormat(c,\"wrong number of arguments for '%s' command\", cmd->fullname)",
          "old_line_content": "        if (result != ACL_OK) {",
          "new_line_content": "            addReplyErrorFormat(c,\"wrong number of arguments for '%s' command\", cmd->fullname);",
          "content_same": false
        },
        {
          "line": 2007,
          "old_api": null,
          "new_api": "sdscatfmt",
          "old_text": null,
          "new_text": "sdscatfmt(selector, \" %s\", op)",
          "old_line_content": "            continue;",
          "new_line_content": "            selector = sdscatfmt(selector, \" %s\", op);",
          "content_same": false
        },
        {
          "line": 2008,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(op)",
          "old_line_content": "        }",
          "new_line_content": "            if (op[sdslen(op) - 1] == ')') {",
          "content_same": false
        },
        {
          "line": 3036,
          "old_api": null,
          "new_api": "ACLCheckAllUserCommandPerm",
          "old_text": null,
          "new_text": "ACLCheckAllUserCommandPerm(u, cmd, c->argv + 3, c->argc - 3, &idx)",
          "old_line_content": "",
          "new_line_content": "        int result = ACLCheckAllUserCommandPerm(u, cmd, c->argv + 3, c->argc - 3, &idx);",
          "content_same": false
        },
        {
          "line": 3039,
          "old_api": null,
          "new_api": "addReplyBulkSds",
          "old_text": null,
          "new_text": "addReplyBulkSds(c, err)",
          "old_line_content": "        const char *help[] = {",
          "new_line_content": "            addReplyBulkSds(c, err);",
          "content_same": false
        },
        {
          "line": 2530,
          "old_api": null,
          "new_api": "sdscmp",
          "old_text": null,
          "new_text": "sdscmp(a->object,b->object)",
          "old_line_content": "void ACLFreeLogEntry(void *leptr) {",
          "new_line_content": "    if (sdscmp(a->object,b->object) != 0) return 0;",
          "content_same": false
        },
        {
          "line": 2531,
          "old_api": null,
          "new_api": "sdscmp",
          "old_text": null,
          "new_text": "sdscmp(a->username,b->username)",
          "old_line_content": "    ACLLogEntry *le = leptr;",
          "new_line_content": "    if (sdscmp(a->username,b->username) != 0) return 0;",
          "content_same": false
        },
        {
          "line": 3043,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "\"DELUSER <username> [<username> ...]\",",
          "new_line_content": "        addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 3044,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(sub,\"help\")",
          "old_line_content": "\"    Delete a list of users.\",",
          "new_line_content": "    } else if (c->argc == 2 && !strcasecmp(sub,\"help\")) {",
          "content_same": false
        },
        {
          "line": 2021,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(acl_args[i])",
          "old_line_content": "",
          "new_line_content": "        for (int i = 0; i < *merged_argc; i++) sdsfree(acl_args[i]);",
          "content_same": false
        },
        {
          "line": 2022,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(acl_args)",
          "old_line_content": "    return acl_args;",
          "new_line_content": "        zfree(acl_args);",
          "content_same": false
        },
        {
          "line": 2023,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(selector)",
          "old_line_content": "}",
          "new_line_content": "        sdsfree(selector);",
          "content_same": false
        },
        {
          "line": 2538,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(le->object)",
          "old_line_content": "/* Update the relevant counter by the reason */",
          "new_line_content": "    sdsfree(le->object);",
          "content_same": false
        },
        {
          "line": 2539,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(le->username)",
          "old_line_content": "void ACLUpdateInfoMetrics(int reason){",
          "new_line_content": "    sdsfree(le->username);",
          "content_same": false
        },
        {
          "line": 2540,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(le->cinfo)",
          "old_line_content": "    if (reason == ACL_DENIED_AUTH) {",
          "new_line_content": "    sdsfree(le->cinfo);",
          "content_same": false
        },
        {
          "line": 2541,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(le)",
          "old_line_content": "        server.acl_info.user_auth_failures++;",
          "new_line_content": "    zfree(le);",
          "content_same": false
        },
        {
          "line": 2037,
          "old_api": null,
          "new_api": "serverAssert",
          "old_text": null,
          "new_text": "serverAssert(u != NULL || username != NULL)",
          "old_line_content": "",
          "new_line_content": "    serverAssert(u != NULL || username != NULL);",
          "content_same": false
        },
        {
          "line": 2042,
          "old_api": null,
          "new_api": "ACLMergeSelectorArguments",
          "old_text": null,
          "new_text": "ACLMergeSelectorArguments(argv, argc, &merged_argc, &invalid_idx)",
          "old_line_content": "    }",
          "new_line_content": "    sds *acl_args = ACLMergeSelectorArguments(argv, argc, &merged_argc, &invalid_idx);",
          "content_same": false
        },
        {
          "line": 2555,
          "old_api": null,
          "new_api": "serverPanic",
          "old_text": null,
          "new_text": "serverPanic(\"Unknown ACL_DENIED encoding\")",
          "old_line_content": " * to find similar entries in the current log in order to bump the counter of",
          "new_line_content": "        serverPanic(\"Unknown ACL_DENIED encoding\");",
          "content_same": false
        },
        {
          "line": 2045,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "     * before applying to an existing user or creating a new user. If all",
          "new_line_content": "        return sdscatfmt(sdsempty(),",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 2048,
          "old_api": "ACLCreateUnlinkedUser",
          "new_api": null,
          "old_text": "ACLCreateUnlinkedUser()",
          "new_text": null,
          "old_line_content": "    user *tempu = ACLCreateUnlinkedUser();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2050,
          "old_api": "ACLCopyUser",
          "new_api": null,
          "old_text": "ACLCopyUser(tempu, u)",
          "new_text": null,
          "old_line_content": "        ACLCopyUser(tempu, u);",
          "new_line_content": "    /* Create a temporary user to validate and stage all changes against",
          "content_same": false
        },
        {
          "line": 2055,
          "old_api": "ACLSetUserStringError",
          "new_api": null,
          "old_text": "ACLSetUserStringError()",
          "new_text": null,
          "old_line_content": "            const char *errmsg = ACLSetUserStringError();",
          "new_line_content": "    if (u) {",
          "content_same": false
        },
        {
          "line": 3079,
          "old_api": "addReplyStatusFormat",
          "new_api": null,
          "old_text": "addReplyStatusFormat(c, \"@%s\", ACLCommandCategories[j].name)",
          "new_text": null,
          "old_line_content": "            addReplyStatusFormat(c, \"@%s\", ACLCommandCategories[j].name);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2570,
          "old_api": "ACLUpdateInfoMetrics",
          "new_api": null,
          "old_text": "ACLUpdateInfoMetrics(reason)",
          "new_text": null,
          "old_line_content": "    ACLUpdateInfoMetrics(reason);",
          "new_line_content": " * ones which depend on the client and reason arguments (use NULL for default).",
          "content_same": false
        },
        {
          "line": 3083,
          "old_api": "setDeferredSetLen",
          "new_api": null,
          "old_text": "setDeferredSetLen(c, flaglen, flagcount)",
          "new_text": null,
          "old_line_content": "    setDeferredSetLen(c, flaglen, flagcount);",
          "new_line_content": "    for (int j = 0; ACLCommandCategories[j].flag != 0; j++) {",
          "content_same": false
        },
        {
          "line": 2573,
          "old_api": "zmalloc",
          "new_api": null,
          "old_text": "zmalloc(sizeof(*le))",
          "new_text": null,
          "old_line_content": "    struct ACLLogEntry *le = zmalloc(sizeof(*le));",
          "new_line_content": " */",
          "content_same": false
        },
        {
          "line": 2577,
          "old_api": "commandTimeSnapshot",
          "new_api": null,
          "old_text": "commandTimeSnapshot()",
          "new_text": null,
          "old_line_content": "    le->ctime = commandTimeSnapshot();",
          "new_line_content": "    ",
          "content_same": false
        },
        {
          "line": 2066,
          "old_api": "ACLKillPubsubClientsIfNeeded",
          "new_api": null,
          "old_text": "ACLKillPubsubClientsIfNeeded(tempu, u)",
          "new_text": null,
          "old_line_content": "        ACLKillPubsubClientsIfNeeded(tempu, u);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3094,
          "old_api": "addReplyErrorObject",
          "new_api": null,
          "old_text": "addReplyErrorObject(c,shared.syntaxerr)",
          "new_text": null,
          "old_line_content": "        addReplyErrorObject(c,shared.syntaxerr);",
          "new_line_content": " *",
          "content_same": false
        },
        {
          "line": 2071,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(username)",
          "new_text": null,
          "old_line_content": "        u = ACLCreateUser(username,sdslen(username));",
          "new_line_content": "    if (u) {",
          "content_same": false
        },
        {
          "line": 2073,
          "old_api": "serverAssert",
          "new_api": null,
          "old_text": "serverAssert(u != NULL)",
          "new_text": null,
          "old_line_content": "    serverAssert(u != NULL);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2585,
          "old_api": "sdsdup",
          "new_api": null,
          "old_text": "sdsdup(c->cmd->fullname)",
          "new_text": null,
          "old_line_content": "            case ACL_DENIED_CMD: le->object = sdsdup(c->cmd->fullname); break;",
          "new_line_content": "    le->timestamp_created = le->ctime;",
          "content_same": false
        },
        {
          "line": 2075,
          "old_api": "ACLCopyUser",
          "new_api": null,
          "old_text": "ACLCopyUser(u, tempu)",
          "new_text": null,
          "old_line_content": "    ACLCopyUser(u, tempu);",
          "new_line_content": "    /* Overwrite the user with the temporary user we modified above. */",
          "content_same": false
        },
        {
          "line": 2586,
          "old_api": "sdsdup",
          "new_api": null,
          "old_text": "sdsdup(c->argv[argpos]->ptr)",
          "new_text": null,
          "old_line_content": "            case ACL_DENIED_KEY: le->object = sdsdup(c->argv[argpos]->ptr); break;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2587,
          "old_api": "sdsdup",
          "new_api": null,
          "old_text": "sdsdup(c->argv[argpos]->ptr)",
          "new_text": null,
          "old_line_content": "            case ACL_DENIED_CHANNEL: le->object = sdsdup(c->argv[argpos]->ptr); break;",
          "new_line_content": "    if (object) {",
          "content_same": false
        },
        {
          "line": 2078,
          "old_api": "ACLFreeUser",
          "new_api": null,
          "old_text": "ACLFreeUser(tempu)",
          "new_text": null,
          "old_line_content": "    ACLFreeUser(tempu);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2588,
          "old_api": "sdsdup",
          "new_api": null,
          "old_text": "sdsdup(c->argv[0]->ptr)",
          "new_text": null,
          "old_line_content": "            case ACL_DENIED_AUTH: le->object = sdsdup(c->argv[0]->ptr); break;",
          "new_line_content": "        le->object = object;",
          "content_same": false
        },
        {
          "line": 2080,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(acl_args[i])",
          "new_text": null,
          "old_line_content": "        sdsfree(acl_args[i]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2589,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "            default: le->object = sdsempty();",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 2082,
          "old_api": "zfree",
          "new_api": null,
          "old_text": "zfree(acl_args)",
          "new_text": null,
          "old_line_content": "    zfree(acl_args);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3098,
          "old_api": "redactClientCommandArgument",
          "new_api": null,
          "old_text": "redactClientCommandArgument(c, 1)",
          "new_text": null,
          "old_line_content": "    redactClientCommandArgument(c, 1);",
          "new_line_content": "    /* Only two or three argument forms are allowed. */",
          "content_same": false
        },
        {
          "line": 2596,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "    le->cinfo = catClientInfoString(sdsempty(),realclient);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3107,
          "old_api": "addReplyError",
          "new_api": null,
          "old_text": "addReplyError(c,\"AUTH <password> called without any password \"\n                            \"configured for the default user. Are you sure \"\n                            \"your configuration is correct?\")",
          "new_text": null,
          "old_line_content": "            addReplyError(c,\"AUTH <password> called without any password \"",
          "new_line_content": "     * will just use \"default\" as username. */",
          "content_same": false
        },
        {
          "line": 2604,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(ACLLog,&li)",
          "new_text": null,
          "old_line_content": "    listRewind(ACLLog,&li);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2606,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "    while (toscan-- && (ln = listNext(&li)) != NULL) {",
          "new_line_content": "     * update an existing entry instead of creating a new one. */",
          "content_same": false
        },
        {
          "line": 2607,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "        ACLLogEntry *current = listNodeValue(ln);",
          "new_line_content": "    long toscan = 10; /* Do a limited work trying to find duplicated. */",
          "content_same": false
        },
        {
          "line": 2608,
          "old_api": "ACLLogMatchEntry",
          "new_api": null,
          "old_text": "ACLLogMatchEntry(current,le)",
          "new_text": null,
          "old_line_content": "        if (ACLLogMatchEntry(current,le)) {",
          "new_line_content": "    listIter li;",
          "content_same": false
        },
        {
          "line": 3118,
          "old_api": "redactClientCommandArgument",
          "new_api": null,
          "old_text": "redactClientCommandArgument(c, 2)",
          "new_text": null,
          "old_line_content": "        redactClientCommandArgument(c, 2);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3122,
          "old_api": "ACLAuthenticateUser",
          "new_api": null,
          "old_text": "ACLAuthenticateUser(c, username, password, &err)",
          "new_text": null,
          "old_line_content": "    int result = ACLAuthenticateUser(c, username, password, &err);",
          "new_line_content": "        username = c->argv[1];",
          "content_same": false
        },
        {
          "line": 2611,
          "old_api": "listAddNodeHead",
          "new_api": null,
          "old_text": "listAddNodeHead(ACLLog,current)",
          "new_text": null,
          "old_line_content": "            listAddNodeHead(ACLLog,current);",
          "new_line_content": "    ACLLogEntry *match = NULL;",
          "content_same": false
        },
        {
          "line": 3126,
          "old_api": "addAuthErrReply",
          "new_api": null,
          "old_text": "addAuthErrReply(c, err)",
          "new_text": null,
          "old_line_content": "        addAuthErrReply(c, err);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2106,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(argv[0],\"user\")",
          "new_text": null,
          "old_line_content": "    if (argc < 2 || strcasecmp(argv[0],\"user\")) {",
          "new_line_content": " * commands may be defined later once modules are loaded.",
          "content_same": false
        },
        {
          "line": 2621,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(match->cinfo)",
          "new_text": null,
          "old_line_content": "        sdsfree(match->cinfo);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2111,
          "old_api": "listSearchKey",
          "new_api": null,
          "old_text": "listSearchKey(UsersToLoad, argv[1])",
          "new_text": null,
          "old_line_content": "    if (listSearchKey(UsersToLoad, argv[1])) {",
          "new_line_content": "int ACLAppendUserForLoading(sds *argv, int argc, int *argc_err) {",
          "content_same": false
        },
        {
          "line": 3136,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(password)",
          "new_text": null,
          "old_line_content": "        sds aclop = sdscatlen(sdsnew(\">\"), password, sdslen(password));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3137,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(aclop)",
          "new_text": null,
          "old_line_content": "        ACLSetUser(DefaultUser,aclop,sdslen(aclop));",
          "new_line_content": "/* Set the password for the \"default\" ACL user. This implements supports for",
          "content_same": false
        },
        {
          "line": 3138,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(aclop)",
          "new_text": null,
          "old_line_content": "        sdsfree(aclop);",
          "new_line_content": " * requirepass config, so passing in NULL will set the user to be nopass. */",
          "content_same": false
        },
        {
          "line": 2628,
          "old_api": "ACLFreeLogEntry",
          "new_api": null,
          "old_text": "ACLFreeLogEntry(le)",
          "new_text": null,
          "old_line_content": "        ACLFreeLogEntry(le);",
          "new_line_content": "        match->cinfo = le->cinfo;",
          "content_same": false
        },
        {
          "line": 2119,
          "old_api": "ACLMergeSelectorArguments",
          "new_api": null,
          "old_text": "ACLMergeSelectorArguments(argv + 2, argc - 2, &merged_argc, argc_err)",
          "new_text": null,
          "old_line_content": "    sds *acl_args = ACLMergeSelectorArguments(argv + 2, argc - 2, &merged_argc, argc_err);",
          "new_line_content": "        errno = EALREADY;",
          "content_same": false
        },
        {
          "line": 2633,
          "old_api": "listAddNodeHead",
          "new_api": null,
          "old_text": "listAddNodeHead(ACLLog, le)",
          "new_text": null,
          "old_line_content": "        listAddNodeHead(ACLLog, le);",
          "new_line_content": "        le->cinfo = NULL;",
          "content_same": false
        },
        {
          "line": 2635,
          "old_api": "listLast",
          "new_api": null,
          "old_text": "listLast(ACLLog)",
          "new_text": null,
          "old_line_content": "            listNode *ln = listLast(ACLLog);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 2636,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "            ACLLogEntry *le = listNodeValue(ln);",
          "new_line_content": "        /* Add it to our list of entries. We'll have to trim the list",
          "content_same": false
        },
        {
          "line": 2637,
          "old_api": "ACLFreeLogEntry",
          "new_api": null,
          "old_text": "ACLFreeLogEntry(le)",
          "new_text": null,
          "old_line_content": "            ACLFreeLogEntry(le);",
          "new_line_content": "         * to its maximum size. */",
          "content_same": false
        },
        {
          "line": 2638,
          "old_api": "listDelNode",
          "new_api": null,
          "old_text": "listDelNode(ACLLog,ln)",
          "new_text": null,
          "old_line_content": "            listDelNode(ACLLog,ln);",
          "new_line_content": "        ACLLogEntryCount++; /* Incrementing the entry_id count to make each record in the log unique. */",
          "content_same": false
        },
        {
          "line": 2127,
          "old_api": "ACLCreateUnlinkedUser",
          "new_api": null,
          "old_text": "ACLCreateUnlinkedUser()",
          "new_text": null,
          "old_line_content": "    user *fakeuser = ACLCreateUnlinkedUser();",
          "new_line_content": "    if (!acl_args) {",
          "content_same": false
        },
        {
          "line": 2130,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(acl_args[j])",
          "new_text": null,
          "old_line_content": "        if (ACLSetUser(fakeuser,acl_args[j],sdslen(acl_args[j])) == C_ERR) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2132,
          "old_api": "ACLFreeUser",
          "new_api": null,
          "old_text": "ACLFreeUser(fakeuser)",
          "new_text": null,
          "old_line_content": "                ACLFreeUser(fakeuser);",
          "new_line_content": "     * are actually valid. */",
          "content_same": false
        },
        {
          "line": 2134,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(acl_args[i])",
          "new_text": null,
          "old_line_content": "                for (int i = 0; i < merged_argc; i++) sdsfree(acl_args[i]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2135,
          "old_api": "zfree",
          "new_api": null,
          "old_text": "zfree(acl_args)",
          "new_text": null,
          "old_line_content": "                zfree(acl_args);",
          "new_line_content": "    for (int j = 0; j < merged_argc; j++) {",
          "content_same": false
        },
        {
          "line": 2646,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "        return sdscatfmt(sdsempty(), \"User %S has no permissions to run \"",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2650,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "            return sdscatfmt(sdsempty(), \"User %S has no permissions to access \"",
          "new_line_content": "    switch (acl_res) {",
          "content_same": false
        },
        {
          "line": 2653,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(\"No permissions to access a key\")",
          "new_text": null,
          "old_line_content": "            return sdsnew(\"No permissions to access a key\");",
          "new_line_content": "                                     \"the '%S' command\", user->name, cmd->fullname);",
          "content_same": false
        },
        {
          "line": 2142,
          "old_api": "zmalloc",
          "new_api": null,
          "old_text": "zmalloc(sizeof(sds)*(merged_argc + 2))",
          "new_text": null,
          "old_line_content": "    sds *copy = zmalloc(sizeof(sds)*(merged_argc + 2));",
          "new_line_content": "                return C_ERR;",
          "content_same": false
        },
        {
          "line": 2143,
          "old_api": "sdsdup",
          "new_api": null,
          "old_text": "sdsdup(argv[1])",
          "new_text": null,
          "old_line_content": "    copy[0] = sdsdup(argv[1]);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2144,
          "old_api": "sdsdup",
          "new_api": null,
          "old_text": "sdsdup(acl_args[j])",
          "new_text": null,
          "old_line_content": "    for (int j = 0; j < merged_argc; j++) copy[j+1] = sdsdup(acl_args[j]);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2657,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "            return sdscatfmt(sdsempty(), \"User %S has no permissions to access \"",
          "new_line_content": "                                         \"the '%S' key\", user->name, errored_val);",
          "content_same": false
        },
        {
          "line": 2146,
          "old_api": "listAddNodeTail",
          "new_api": null,
          "old_text": "listAddNodeTail(UsersToLoad,copy)",
          "new_text": null,
          "old_line_content": "    listAddNodeTail(UsersToLoad,copy);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2147,
          "old_api": "ACLFreeUser",
          "new_api": null,
          "old_text": "ACLFreeUser(fakeuser)",
          "new_text": null,
          "old_line_content": "    ACLFreeUser(fakeuser);",
          "new_line_content": "    /* Rules look valid, let's append the user to the list. */",
          "content_same": false
        },
        {
          "line": 2660,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(\"No permissions to access a channel\")",
          "new_text": null,
          "old_line_content": "            return sdsnew(\"No permissions to access a channel\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2159,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(UsersToLoad,&li)",
          "new_text": null,
          "old_line_content": "    listRewind(UsersToLoad,&li);",
          "new_line_content": "/* This function will load the configured users appended to the server",
          "content_same": false
        },
        {
          "line": 2160,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "    while ((ln = listNext(&li)) != NULL) {",
          "new_line_content": " * configuration via ACLAppendUserForLoading(). On loading errors it will",
          "content_same": false
        },
        {
          "line": 2161,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "        sds *aclrules = listNodeValue(ln);",
          "new_line_content": " * log an error and return C_ERR, otherwise C_OK will be returned. */",
          "content_same": false
        },
        {
          "line": 2673,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(commands)",
          "new_text": null,
          "old_line_content": "    dictIterator *di = dictGetIterator(commands);",
          "new_line_content": " * ACL related commands",
          "content_same": false
        },
        {
          "line": 2675,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "    while ((de = dictNext(di)) != NULL) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2164,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(aclrules[0])",
          "new_text": null,
          "old_line_content": "        if (ACLStringHasSpaces(aclrules[0],sdslen(aclrules[0]))) {",
          "new_line_content": "    listNode *ln;",
          "content_same": false
        },
        {
          "line": 2676,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "        struct redisCommand *cmd = dictGetVal(de);",
          "new_line_content": "/* ACL CAT category */",
          "content_same": false
        },
        {
          "line": 2169,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(username)",
          "new_text": null,
          "old_line_content": "        user *u = ACLCreateUser(username,sdslen(username));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2172,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(username, \"default\")",
          "new_text": null,
          "old_line_content": "            serverAssert(!strcmp(username, \"default\"));",
          "new_line_content": "            return C_ERR;",
          "content_same": false
        },
        {
          "line": 2173,
          "old_api": "ACLGetUserByName",
          "new_api": null,
          "old_text": "ACLGetUserByName(\"default\",7)",
          "new_text": null,
          "old_line_content": "            u = ACLGetUserByName(\"default\",7);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2174,
          "old_api": "ACLSetUser",
          "new_api": null,
          "old_text": "ACLSetUser(u,\"reset\",-1)",
          "new_text": null,
          "old_line_content": "            ACLSetUser(u,\"reset\",-1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2684,
          "old_api": "aclCatWithFlags",
          "new_api": null,
          "old_text": "aclCatWithFlags(c, cmd->subcommands_dict, cflag, arraylen)",
          "new_text": null,
          "old_line_content": "            aclCatWithFlags(c, cmd->subcommands_dict, cflag, arraylen);",
          "new_line_content": "        if (cmd->acl_categories & cflag) {",
          "content_same": false
        },
        {
          "line": 2687,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "    dictReleaseIterator(di);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2181,
          "old_api": "serverLog",
          "new_api": null,
          "old_text": "serverLog(LL_WARNING,\"Error loading ACL rule '%s' for \"\n                                     \"the user named '%s': %s\",\n                          aclrules[j],aclrules[0],errmsg)",
          "new_text": null,
          "old_line_content": "                serverLog(LL_WARNING,\"Error loading ACL rule '%s' for \"",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2701,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"commands\")",
          "new_text": null,
          "old_line_content": "    addReplyBulkCString(c,\"commands\");",
          "new_line_content": " */",
          "content_same": false
        },
        {
          "line": 2702,
          "old_api": "ACLDescribeSelectorCommandRules",
          "new_api": null,
          "old_text": "ACLDescribeSelectorCommandRules(s)",
          "new_text": null,
          "old_line_content": "    sds cmddescr = ACLDescribeSelectorCommandRules(s);",
          "new_line_content": "int aclAddReplySelectorDescription(client *c, aclSelector *s) {",
          "content_same": false
        },
        {
          "line": 2191,
          "old_api": "serverLog",
          "new_api": null,
          "old_text": "serverLog(LL_NOTICE, \"The user '%s' is disabled (there is no \"\n                                 \"'on' modifier in the user description). Make \"\n                                 \"sure this is not a configuration error.\",\n                      aclrules[0])",
          "new_text": null,
          "old_line_content": "            serverLog(LL_NOTICE, \"The user '%s' is disabled (there is no \"",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2703,
          "old_api": "addReplyBulkSds",
          "new_api": null,
          "old_text": "addReplyBulkSds(c,cmddescr)",
          "new_text": null,
          "old_line_content": "    addReplyBulkSds(c,cmddescr);",
          "new_line_content": "    listIter li;",
          "content_same": false
        },
        {
          "line": 2706,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"keys\")",
          "new_text": null,
          "old_line_content": "    addReplyBulkCString(c,\"keys\");",
          "new_line_content": "    /* Commands */",
          "content_same": false
        },
        {
          "line": 2710,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "        sds dsl = sdsempty();",
          "new_line_content": "    ",
          "content_same": false
        },
        {
          "line": 2711,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(s->patterns,&li)",
          "new_text": null,
          "old_line_content": "        listRewind(s->patterns,&li);",
          "new_line_content": "    /* Key patterns */",
          "content_same": false
        },
        {
          "line": 2713,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "            keyPattern *thispat = (keyPattern *) listNodeValue(ln);",
          "new_line_content": "    if (s->flags & SELECTOR_FLAG_ALLKEYS) {",
          "content_same": false
        },
        {
          "line": 2715,
          "old_api": "sdsCatPatternString",
          "new_api": null,
          "old_text": "sdsCatPatternString(dsl, thispat)",
          "new_text": null,
          "old_line_content": "            dsl = sdsCatPatternString(dsl, thispat);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 2725,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "        sds dsl = sdsempty();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2726,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(s->channels,&li)",
          "new_text": null,
          "old_line_content": "        listRewind(s->channels,&li);",
          "new_line_content": "    /* Pub/sub patterns */",
          "content_same": false
        },
        {
          "line": 2728,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "            sds thispat = listNodeValue(ln);",
          "new_line_content": "    if (s->flags & SELECTOR_FLAG_ALLCHANNELS) {",
          "content_same": false
        },
        {
          "line": 2730,
          "old_api": "sdscatfmt",
          "new_api": null,
          "old_text": "sdscatfmt(dsl, \"&%S\", thispat)",
          "new_text": null,
          "old_line_content": "            dsl = sdscatfmt(dsl, \"&%S\", thispat);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 2228,
          "old_api": "fopen",
          "new_api": null,
          "old_text": "fopen(filename,\"r\")",
          "new_text": null,
          "old_line_content": "    if ((fp = fopen(filename,\"r\")) == NULL) {",
          "new_line_content": " * a description of all the issues found is returned. */",
          "content_same": false
        },
        {
          "line": 2229,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "        sds errors = sdscatprintf(sdsempty(),",
          "new_line_content": "sds ACLLoadFromFile(const char *filename) {",
          "content_same": false
        },
        {
          "line": 2231,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "            filename, strerror(errno));",
          "new_line_content": "    char buf[1024];",
          "content_same": false
        },
        {
          "line": 2236,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "    sds acls = sdsempty();",
          "new_line_content": "            \"Error loading ACLs, opening file '%s': %s\",",
          "content_same": false
        },
        {
          "line": 2238,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(acls,buf)",
          "new_text": null,
          "old_line_content": "        acls = sdscat(acls,buf);",
          "new_line_content": "        return errors;",
          "content_same": false
        },
        {
          "line": 2239,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(fp)",
          "new_text": null,
          "old_line_content": "    fclose(fp);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2753,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(sub,\"setuser\")",
          "new_text": null,
          "old_line_content": "    if (!strcasecmp(sub,\"setuser\") && c->argc >= 3) {",
          "new_line_content": " * ACL GENPASS [<bits>]",
          "content_same": false
        },
        {
          "line": 2757,
          "old_api": "redactClientCommandArgument",
          "new_api": null,
          "old_text": "redactClientCommandArgument(c, j)",
          "new_text": null,
          "old_line_content": "            redactClientCommandArgument(c, j);",
          "new_line_content": "void aclCommand(client *c) {",
          "content_same": false
        },
        {
          "line": 2762,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(username)",
          "new_text": null,
          "old_line_content": "        if (ACLStringHasSpaces(username,sdslen(username))) {",
          "new_line_content": "        for (int j = 2; j < c->argc; j++) {",
          "content_same": false
        },
        {
          "line": 2770,
          "old_api": "zmalloc",
          "new_api": null,
          "old_text": "zmalloc(c->argc * sizeof(sds))",
          "new_text": null,
          "old_line_content": "        sds *temp_argv = zmalloc(c->argc * sizeof(sds));",
          "new_line_content": "                \"Usernames can't contain spaces or null characters\");",
          "content_same": false
        },
        {
          "line": 2259,
          "old_api": "sdstrim",
          "new_api": null,
          "old_text": "sdstrim(lines[i],\" \\t\\r\\n\")",
          "new_text": null,
          "old_line_content": "        lines[i] = sdstrim(lines[i],\" \\t\\r\\n\");",
          "new_line_content": "    /* Load each line of the file. */",
          "content_same": false
        },
        {
          "line": 2773,
          "old_api": "ACLStringSetUser",
          "new_api": null,
          "old_text": "ACLStringSetUser(u, username, temp_argv, c->argc - 3)",
          "new_text": null,
          "old_line_content": "        sds error = ACLStringSetUser(u, username, temp_argv, c->argc - 3);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2778,
          "old_api": "addReplyErrorSdsSafe",
          "new_api": null,
          "old_text": "addReplyErrorSdsSafe(c, error)",
          "new_text": null,
          "old_line_content": "            addReplyErrorSdsSafe(c, error);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2267,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(errors,\n                     \"%s:%d: unbalanced quotes in acl line. \",\n                     server.acl_filename, linenum)",
          "new_text": null,
          "old_line_content": "            errors = sdscatprintf(errors,",
          "new_line_content": "        /* Skip blank lines */",
          "content_same": false
        },
        {
          "line": 2781,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(sub,\"deluser\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(sub,\"deluser\") && c->argc >= 3) {",
          "new_line_content": "        if (error == NULL) {",
          "content_same": false
        },
        {
          "line": 2785,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(username,\"default\")",
          "new_text": null,
          "old_line_content": "            if (!strcmp(username,\"default\")) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2786,
          "old_api": "addReplyError",
          "new_api": null,
          "old_text": "addReplyError(c,\"The 'default' user cannot be removed\")",
          "new_text": null,
          "old_line_content": "                addReplyError(c,\"The 'default' user cannot be removed\");",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 2275,
          "old_api": "sdsfreesplitres",
          "new_api": null,
          "old_text": "sdsfreesplitres(argv,argc)",
          "new_text": null,
          "old_line_content": "            sdsfreesplitres(argv,argc);",
          "new_line_content": "                     server.acl_filename, linenum);",
          "content_same": false
        },
        {
          "line": 2280,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(argv[0],\"user\")",
          "new_text": null,
          "old_line_content": "        if (strcmp(argv[0],\"user\") || argc < 2) {",
          "new_line_content": "        if (argc == 0) {",
          "content_same": false
        },
        {
          "line": 2794,
          "old_api": "raxRemove",
          "new_api": null,
          "old_text": "raxRemove(Users,(unsigned char*)username,\n                          sdslen(username),\n                          (void**)&u)",
          "new_text": null,
          "old_line_content": "            if (raxRemove(Users,(unsigned char*)username,",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2795,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(username)",
          "new_text": null,
          "old_line_content": "                          sdslen(username),",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2285,
          "old_api": "sdsfreesplitres",
          "new_api": null,
          "old_text": "sdsfreesplitres(argv,argc)",
          "new_text": null,
          "old_line_content": "            sdsfreesplitres(argv,argc);",
          "new_line_content": "        /* The line should start with the \"user\" keyword. */",
          "content_same": false
        },
        {
          "line": 2798,
          "old_api": "ACLFreeUserAndKillClients",
          "new_api": null,
          "old_text": "ACLFreeUserAndKillClients(u)",
          "new_text": null,
          "old_line_content": "                ACLFreeUserAndKillClients(u);",
          "new_line_content": "            sds username = c->argv[j]->ptr;",
          "content_same": false
        },
        {
          "line": 2290,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(argv[1])",
          "new_text": null,
          "old_line_content": "        if (ACLStringHasSpaces(argv[1],sdslen(argv[1]))) {",
          "new_line_content": "                     linenum);",
          "content_same": false
        },
        {
          "line": 2802,
          "old_api": "addReplyLongLong",
          "new_api": null,
          "old_text": "addReplyLongLong(c,deleted)",
          "new_text": null,
          "old_line_content": "        addReplyLongLong(c,deleted);",
          "new_line_content": "                          (void**)&u))",
          "content_same": false
        },
        {
          "line": 2803,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(sub,\"getuser\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(sub,\"getuser\") && c->argc == 3) {",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 2294,
          "old_api": "sdsfreesplitres",
          "new_api": null,
          "old_text": "sdsfreesplitres(argv,argc)",
          "new_text": null,
          "old_line_content": "            sdsfreesplitres(argv,argc);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2806,
          "old_api": "addReplyNull",
          "new_api": null,
          "old_text": "addReplyNull(c)",
          "new_text": null,
          "old_line_content": "            addReplyNull(c);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2298,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(argv[1])",
          "new_text": null,
          "old_line_content": "        user *u = ACLCreateUser(argv[1],sdslen(argv[1]));",
          "new_line_content": "                     \"'%s:%d: username '%s' contains invalid characters. \",",
          "content_same": false
        },
        {
          "line": 2302,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(errors,\"WARNING: Duplicate user '%s' found on line %d. \", argv[1], linenum)",
          "new_text": null,
          "old_line_content": "            errors = sdscatprintf(errors,\"WARNING: Duplicate user '%s' found on line %d. \", argv[1], linenum);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2303,
          "old_api": "sdsfreesplitres",
          "new_api": null,
          "old_text": "sdsfreesplitres(argv,argc)",
          "new_text": null,
          "old_line_content": "            sdsfreesplitres(argv,argc);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2814,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"flags\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"flags\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2815,
          "old_api": "addReplyDeferredLen",
          "new_api": null,
          "old_text": "addReplyDeferredLen(c)",
          "new_text": null,
          "old_line_content": "        void *deflen = addReplyDeferredLen(c);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1883,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "        aclSelector *s = (aclSelector *) listNodeValue(ln);",
          "new_line_content": "     * created an \"upcoming\" list of all channels that are in",
          "content_same": false
        },
        {
          "line": 2819,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,ACLUserFlags[j].name)",
          "new_text": null,
          "old_line_content": "                addReplyBulkCString(c,ACLUserFlags[j].name);",
          "new_line_content": "        /* Flags */",
          "content_same": false
        },
        {
          "line": 2823,
          "old_api": "setDeferredSetLen",
          "new_api": null,
          "old_text": "setDeferredSetLen(c,deflen,numflags)",
          "new_text": null,
          "old_line_content": "        setDeferredSetLen(c,deflen,numflags);",
          "new_line_content": "        for (int j = 0; ACLUserFlags[j].flag; j++) {",
          "content_same": false
        },
        {
          "line": 2312,
          "old_api": "ACLMergeSelectorArguments",
          "new_api": null,
          "old_text": "ACLMergeSelectorArguments(argv + 2, argc - 2, &merged_argc, NULL)",
          "new_text": null,
          "old_line_content": "        sds *acl_args = ACLMergeSelectorArguments(argv + 2, argc - 2, &merged_argc, NULL);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1884,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(s->channels, &lpi)",
          "new_text": null,
          "old_line_content": "        listRewind(s->channels, &lpi);",
          "new_line_content": "     * the new user and checking each of the existing channels",
          "content_same": false
        },
        {
          "line": 2314,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(errors,\n                    \"%s:%d: Unmatched parenthesis in selector definition.\",\n                    server.acl_filename, linenum)",
          "new_text": null,
          "old_line_content": "            errors = sdscatprintf(errors,",
          "new_line_content": "         * be cleanly applied to the user. If any option fails",
          "content_same": false
        },
        {
          "line": 2826,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"passwords\")",
          "new_text": null,
          "old_line_content": "        addReplyBulkCString(c,\"passwords\");",
          "new_line_content": "                numflags++;",
          "content_same": false
        },
        {
          "line": 2827,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(u->passwords)",
          "new_text": null,
          "old_line_content": "        addReplyArrayLen(c,listLength(u->passwords));",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2830,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(u->passwords,&li)",
          "new_text": null,
          "old_line_content": "        listRewind(u->passwords,&li);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2831,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "        while((ln = listNext(&li))) {",
          "new_line_content": "        /* Passwords */",
          "content_same": false
        },
        {
          "line": 2321,
          "old_api": "sdstrim",
          "new_api": null,
          "old_text": "sdstrim(acl_args[j],\"\\t\\r\\n\")",
          "new_text": null,
          "old_line_content": "            acl_args[j] = sdstrim(acl_args[j],\"\\t\\r\\n\");",
          "new_line_content": "                    \"%s:%d: Unmatched parenthesis in selector definition.\",",
          "content_same": false
        },
        {
          "line": 2322,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(acl_args[j])",
          "new_text": null,
          "old_line_content": "            if (ACLSetUser(u,acl_args[j],sdslen(acl_args[j])) != C_OK) {",
          "new_line_content": "                    server.acl_filename, linenum);",
          "content_same": false
        },
        {
          "line": 2323,
          "old_api": "ACLSetUserStringError",
          "new_api": null,
          "old_text": "ACLSetUserStringError()",
          "new_text": null,
          "old_line_content": "                const char *errmsg = ACLSetUserStringError();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2840,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(u->selectors)",
          "new_text": null,
          "old_line_content": "        addReplyArrayLen(c, listLength(u->selectors) - 1);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2841,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(u->selectors,&li)",
          "new_text": null,
          "old_line_content": "        listRewind(u->selectors,&li);",
          "new_line_content": "        /* Include the root selector at the top level for backwards compatibility */",
          "content_same": false
        },
        {
          "line": 2843,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "        while((ln = listNext(&li))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2844,
          "old_api": "addReplyDeferredLen",
          "new_api": null,
          "old_text": "addReplyDeferredLen(c)",
          "new_text": null,
          "old_line_content": "            void *slen = addReplyDeferredLen(c);",
          "new_line_content": "        /* Describe all of the selectors on this user, including duplicating the root selector */",
          "content_same": false
        },
        {
          "line": 2341,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(acl_args[i])",
          "new_text": null,
          "old_line_content": "        for (int i = 0; i < merged_argc; i++) sdsfree(acl_args[i]);",
          "new_line_content": "                            server.acl_filename, linenum, errmsg);",
          "content_same": false
        },
        {
          "line": 2342,
          "old_api": "zfree",
          "new_api": null,
          "old_text": "zfree(acl_args)",
          "new_text": null,
          "old_line_content": "        zfree(acl_args);",
          "new_line_content": "                    syntax_error = 1;",
          "content_same": false
        },
        {
          "line": 2853,
          "old_api": "raxSize",
          "new_api": null,
          "old_text": "raxSize(Users)",
          "new_text": null,
          "old_line_content": "        addReplyArrayLen(c,raxSize(Users));",
          "new_line_content": "        } ",
          "content_same": false
        },
        {
          "line": 2856,
          "old_api": "raxSeek",
          "new_api": null,
          "old_text": "raxSeek(&ri,\"^\",NULL,0)",
          "new_text": null,
          "old_line_content": "        raxSeek(&ri,\"^\",NULL,0);",
          "new_line_content": "               c->argc == 2)",
          "content_same": false
        },
        {
          "line": 2857,
          "old_api": "raxNext",
          "new_api": null,
          "old_text": "raxNext(&ri)",
          "new_text": null,
          "old_line_content": "        while(raxNext(&ri)) {",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 2860,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(u->name)",
          "new_text": null,
          "old_line_content": "                addReplyBulkCBuffer(c,u->name,sdslen(u->name));",
          "new_line_content": "        raxIterator ri;",
          "content_same": false
        },
        {
          "line": 2352,
          "old_api": "sdsfreesplitres",
          "new_api": null,
          "old_text": "sdsfreesplitres(argv,argc)",
          "new_text": null,
          "old_line_content": "        sdsfreesplitres(argv,argc);",
          "new_line_content": "         * to discard the new users set anyway. */",
          "content_same": false
        },
        {
          "line": 2864,
          "old_api": "sdscatsds",
          "new_api": null,
          "old_text": "sdscatsds(config,u->name)",
          "new_text": null,
          "old_line_content": "                config = sdscatsds(config,u->name);",
          "new_line_content": "            user *u = ri.data;",
          "content_same": false
        },
        {
          "line": 2865,
          "old_api": "sdscatlen",
          "new_api": null,
          "old_text": "sdscatlen(config,\" \",1)",
          "new_text": null,
          "old_line_content": "                config = sdscatlen(config,\" \",1);",
          "new_line_content": "            if (justnames) {",
          "content_same": false
        },
        {
          "line": 2355,
          "old_api": "sdsfreesplitres",
          "new_api": null,
          "old_text": "sdsfreesplitres(lines,totlines)",
          "new_text": null,
          "old_line_content": "    sdsfreesplitres(lines,totlines);",
          "new_line_content": "            continue;",
          "content_same": false
        },
        {
          "line": 2867,
          "old_api": "sdscatsds",
          "new_api": null,
          "old_text": "sdscatsds(config,descr->ptr)",
          "new_text": null,
          "old_line_content": "                config = sdscatsds(config,descr->ptr);",
          "new_line_content": "            } else {",
          "content_same": false
        },
        {
          "line": 2868,
          "old_api": "decrRefCount",
          "new_api": null,
          "old_text": "decrRefCount(descr)",
          "new_text": null,
          "old_line_content": "                decrRefCount(descr);",
          "new_line_content": "                /* Return information in the configuration file format. */",
          "content_same": false
        },
        {
          "line": 2362,
          "old_api": "ACLGetUserByName",
          "new_api": null,
          "old_text": "ACLGetUserByName(\"default\",7)",
          "new_text": null,
          "old_line_content": "        user *new_default = ACLGetUserByName(\"default\",7);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2877,
          "old_api": "addReplyNull",
          "new_api": null,
          "old_text": "addReplyNull(c)",
          "new_text": null,
          "old_line_content": "            addReplyNull(c);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2367,
          "old_api": "ACLCopyUser",
          "new_api": null,
          "old_text": "ACLCopyUser(DefaultUser,new_default)",
          "new_text": null,
          "old_line_content": "        ACLCopyUser(DefaultUser,new_default);",
          "new_line_content": "         * default user configuration in the old one. */",
          "content_same": false
        },
        {
          "line": 2880,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(sub,\"save\")",
          "new_text": null,
          "old_line_content": "               (!strcasecmp(sub,\"load\") || !strcasecmp(sub,\"save\")))",
          "new_line_content": "        if (c->user != NULL) {",
          "content_same": false
        },
        {
          "line": 2369,
          "old_api": "raxInsert",
          "new_api": null,
          "old_text": "raxInsert(Users,(unsigned char*)\"default\",7,DefaultUser,NULL)",
          "new_text": null,
          "old_line_content": "        raxInsert(Users,(unsigned char*)\"default\",7,DefaultUser,NULL);",
          "new_line_content": "        if (!new_default) {",
          "content_same": false
        },
        {
          "line": 2882,
          "old_api": "addReplyError",
          "new_api": null,
          "old_text": "addReplyError(c,\"This Redis instance is not configured to use an ACL file. You may want to specify users via the ACL SETUSER command and then issue a CONFIG REWRITE (assuming you have a Redis configuration file set) in order to store users in the Redis configuration.\")",
          "new_text": null,
          "old_line_content": "        addReplyError(c,\"This Redis instance is not configured to use an ACL file. You may want to specify users via the ACL SETUSER command and then issue a CONFIG REWRITE (assuming you have a Redis configuration file set) in order to store users in the Redis configuration.\");",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 2371,
          "old_api": "ACLFreeUsersSet",
          "new_api": null,
          "old_text": "ACLFreeUsersSet(old_users)",
          "new_text": null,
          "old_line_content": "        ACLFreeUsersSet(old_users);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2372,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(errors)",
          "new_text": null,
          "old_line_content": "        sdsfree(errors);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2884,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(sub,\"load\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(sub,\"load\") && c->argc == 2) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2885,
          "old_api": "ACLLoadFromFile",
          "new_api": null,
          "old_text": "ACLLoadFromFile(server.acl_filename)",
          "new_text": null,
          "old_line_content": "        sds errors = ACLLoadFromFile(server.acl_filename);",
          "new_line_content": "    } else if (server.acl_filename[0] == '\\0' &&",
          "content_same": false
        },
        {
          "line": 2887,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.ok)",
          "new_text": null,
          "old_line_content": "            addReply(c,shared.ok);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 2889,
          "old_api": "addReplyError",
          "new_api": null,
          "old_text": "addReplyError(c,errors)",
          "new_text": null,
          "old_line_content": "            addReplyError(c,errors);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 2892,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(sub,\"save\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(sub,\"save\") && c->argc == 2) {",
          "new_line_content": "        if (errors == NULL) {",
          "content_same": false
        },
        {
          "line": 1869,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(new->selectors,&li)",
          "new_text": null,
          "old_line_content": "    listRewind(new->selectors,&li);",
          "new_line_content": "    listNode *ln, *lpn;",
          "content_same": false
        },
        {
          "line": 2894,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.ok)",
          "new_text": null,
          "old_line_content": "            addReply(c,shared.ok);",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 1870,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "    while((ln = listNext(&li))) {",
          "new_line_content": "    robj *o;",
          "content_same": false
        },
        {
          "line": 1871,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "        aclSelector *s = (aclSelector *) listNodeValue(ln);",
          "new_line_content": "    int kill = 0;",
          "content_same": false
        },
        {
          "line": 2386,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "    sds acl = sdsempty();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2901,
          "old_api": "addReplyDeferredLen",
          "new_api": null,
          "old_text": "addReplyDeferredLen(c)",
          "new_text": null,
          "old_line_content": "        void *dl = addReplyDeferredLen(c);",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 2904,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,ACLCommandCategories[j].name)",
          "new_text": null,
          "old_line_content": "            addReplyBulkCString(c,ACLCommandCategories[j].name);",
          "new_line_content": "                            \"information\");",
          "content_same": false
        },
        {
          "line": 2905,
          "old_api": "setDeferredArrayLen",
          "new_api": null,
          "old_text": "setDeferredArrayLen(c,dl,j)",
          "new_text": null,
          "old_line_content": "        setDeferredArrayLen(c,dl,j);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2394,
          "old_api": "raxStart",
          "new_api": null,
          "old_text": "raxStart(&ri,Users)",
          "new_text": null,
          "old_line_content": "    raxStart(&ri,Users);",
          "new_line_content": "    sds tmpfilename = NULL;",
          "content_same": false
        },
        {
          "line": 2395,
          "old_api": "raxSeek",
          "new_api": null,
          "old_text": "raxSeek(&ri,\"^\",NULL,0)",
          "new_text": null,
          "old_line_content": "    raxSeek(&ri,\"^\",NULL,0);",
          "new_line_content": "    int retval = C_ERR;",
          "content_same": false
        },
        {
          "line": 2396,
          "old_api": "raxNext",
          "new_api": null,
          "old_text": "raxNext(&ri)",
          "new_text": null,
          "old_line_content": "    while(raxNext(&ri)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2909,
          "old_api": "addReplyErrorFormat",
          "new_api": null,
          "old_text": "addReplyErrorFormat(c, \"Unknown category '%.128s'\", (char*)c->argv[2]->ptr)",
          "new_text": null,
          "old_line_content": "            addReplyErrorFormat(c, \"Unknown category '%.128s'\", (char*)c->argv[2]->ptr);",
          "new_line_content": "        for (j = 0; ACLCommandCategories[j].flag != 0; j++)",
          "content_same": false
        },
        {
          "line": 1880,
          "old_api": "listCreate",
          "new_api": null,
          "old_text": "listCreate()",
          "new_text": null,
          "old_line_content": "    list *upcoming = listCreate();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2399,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(\"user \")",
          "new_text": null,
          "old_line_content": "        sds user = sdsnew(\"user \");",
          "new_line_content": "    raxIterator ri;",
          "content_same": false
        },
        {
          "line": 1881,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(new->selectors,&li)",
          "new_text": null,
          "old_line_content": "    listRewind(new->selectors,&li);",
          "new_line_content": "    /* Second optimization is to check if the new list of channels",
          "content_same": false
        },
        {
          "line": 1882,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "    while((ln = listNext(&li))) {",
          "new_line_content": "     * is a strict superset of the original. This is done by",
          "content_same": false
        },
        {
          "line": 2914,
          "old_api": "aclCatWithFlags",
          "new_api": null,
          "old_text": "aclCatWithFlags(c, server.orig_commands, cflag, &arraylen)",
          "new_text": null,
          "old_line_content": "        aclCatWithFlags(c, server.orig_commands, cflag, &arraylen);",
          "new_line_content": "        if (cflag == 0) {",
          "content_same": false
        },
        {
          "line": 2403,
          "old_api": "sdscatsds",
          "new_api": null,
          "old_text": "sdscatsds(user,descr->ptr)",
          "new_text": null,
          "old_line_content": "        user = sdscatsds(user,descr->ptr);",
          "new_line_content": "        user *u = ri.data;",
          "content_same": false
        },
        {
          "line": 2404,
          "old_api": "decrRefCount",
          "new_api": null,
          "old_text": "decrRefCount(descr)",
          "new_text": null,
          "old_line_content": "        decrRefCount(descr);",
          "new_line_content": "        /* Return information in the configuration file format. */",
          "content_same": false
        },
        {
          "line": 2916,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(sub,\"genpass\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(sub,\"genpass\") && (c->argc == 2 || c->argc == 3)) {",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 1885,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&lpi)",
          "new_text": null,
          "old_line_content": "        while((lpn = listNext(&lpi))) {",
          "new_line_content": "     * against it.  */",
          "content_same": false
        },
        {
          "line": 1893,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "        aclSelector *s = (aclSelector *) listNodeValue(ln);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2925,
          "old_api": "addReplyErrorFormat",
          "new_api": null,
          "old_text": "addReplyErrorFormat(c,\n                \"ACL GENPASS argument must be the number of \"\n                \"bits for the output password, a positive number \"\n                \"up to %d\",GENPASS_MAX_BITS)",
          "new_text": null,
          "old_line_content": "            addReplyErrorFormat(c,",
          "new_line_content": "        long bits = 256; /* By default generate 256 bits passwords. */",
          "content_same": false
        },
        {
          "line": 2414,
          "old_api": "commandTimeSnapshot",
          "new_api": null,
          "old_text": "commandTimeSnapshot()",
          "new_text": null,
          "old_line_content": "        (int) getpid(),commandTimeSnapshot());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1901,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(s->channels, &lpi)",
          "new_text": null,
          "old_line_content": "        listRewind(s->channels, &lpi);",
          "new_line_content": "         * the new ones don't (this is checked earlier in this function), then the",
          "content_same": false
        },
        {
          "line": 2416,
          "old_api": "serverLog",
          "new_api": null,
          "old_text": "serverLog(LL_WARNING,\"Opening temp ACL file for ACL SAVE: %s\",\n            strerror(errno))",
          "new_text": null,
          "old_line_content": "        serverLog(LL_WARNING,\"Opening temp ACL file for ACL SAVE: %s\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2417,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "            strerror(errno));",
          "new_line_content": "    /* Create a temp file with the new content. */",
          "content_same": false
        },
        {
          "line": 1902,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&lpi)",
          "new_text": null,
          "old_line_content": "        while((lpn = listNext(&lpi)) && match) {",
          "new_line_content": "         * new list is not a strict superset of the original.  */",
          "content_same": false
        },
        {
          "line": 1903,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(lpn)",
          "new_text": null,
          "old_line_content": "            if (!listSearchKey(upcoming, listNodeValue(lpn))) {",
          "new_line_content": "        if (s->flags & SELECTOR_FLAG_ALLCHANNELS) {",
          "content_same": false
        },
        {
          "line": 2933,
          "old_api": "getRandomHexChars",
          "new_api": null,
          "old_text": "getRandomHexChars(pass,chars)",
          "new_text": null,
          "old_line_content": "        getRandomHexChars(pass,chars);",
          "new_line_content": "                \"bits for the output password, a positive number \"",
          "content_same": false
        },
        {
          "line": 2934,
          "old_api": "addReplyBulkCBuffer",
          "new_api": null,
          "old_text": "addReplyBulkCBuffer(c,pass,chars)",
          "new_text": null,
          "old_line_content": "        addReplyBulkCBuffer(c,pass,chars);",
          "new_line_content": "                \"up to %d\",GENPASS_MAX_BITS);",
          "content_same": false
        },
        {
          "line": 2935,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(sub,\"log\")",
          "new_text": null,
          "old_line_content": "    } else if (!strcasecmp(sub,\"log\") && (c->argc == 2 || c->argc ==3)) {",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 2424,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(acl)",
          "new_text": null,
          "old_line_content": "        ssize_t written_bytes = write(fd,acl + offset,sdslen(acl) - offset);",
          "new_line_content": "        goto cleanup;",
          "content_same": false
        },
        {
          "line": 1912,
          "old_api": "listRelease",
          "new_api": null,
          "old_text": "listRelease(upcoming)",
          "new_text": null,
          "old_line_content": "        listRelease(upcoming);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2427,
          "old_api": "serverLog",
          "new_api": null,
          "old_text": "serverLog(LL_WARNING,\"Writing ACL file for ACL SAVE: %s\",\n                strerror(errno))",
          "new_text": null,
          "old_line_content": "            serverLog(LL_WARNING,\"Writing ACL file for ACL SAVE: %s\",",
          "new_line_content": "    /* Write it. */",
          "content_same": false
        },
        {
          "line": 2428,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "                strerror(errno));",
          "new_line_content": "    size_t offset = 0;",
          "content_same": false
        },
        {
          "line": 2942,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[2]->ptr,\"reset\")",
          "new_text": null,
          "old_line_content": "            if (!strcasecmp(c->argv[2]->ptr,\"reset\")) {",
          "new_line_content": "        long count = 10; /* Number of entries to emit by default. */",
          "content_same": false
        },
        {
          "line": 2943,
          "old_api": "listSetFreeMethod",
          "new_api": null,
          "old_text": "listSetFreeMethod(ACLLog,ACLFreeLogEntry)",
          "new_text": null,
          "old_line_content": "                listSetFreeMethod(ACLLog,ACLFreeLogEntry);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2944,
          "old_api": "listEmpty",
          "new_api": null,
          "old_text": "listEmpty(ACLLog)",
          "new_text": null,
          "old_line_content": "                listEmpty(ACLLog);",
          "new_line_content": "        /* Parse the only argument that LOG may have: it could be either",
          "content_same": false
        },
        {
          "line": 2945,
          "old_api": "listSetFreeMethod",
          "new_api": null,
          "old_text": "listSetFreeMethod(ACLLog,NULL)",
          "new_text": null,
          "old_line_content": "                listSetFreeMethod(ACLLog,NULL);",
          "new_line_content": "         * the number of entries the user wants to display, or alternatively",
          "content_same": false
        },
        {
          "line": 2946,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.ok)",
          "new_text": null,
          "old_line_content": "                addReply(c,shared.ok);",
          "new_line_content": "         * the \"RESET\" command in order to flush the old entries. */",
          "content_same": false
        },
        {
          "line": 2435,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "            strerror(errno));",
          "new_line_content": "            goto cleanup;",
          "content_same": false
        },
        {
          "line": 1919,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(server.clients,&li)",
          "new_text": null,
          "old_line_content": "    listRewind(server.clients,&li);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 1920,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "    while ((ln = listNext(&li)) != NULL) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2438,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fd)",
          "new_text": null,
          "old_line_content": "    close(fd); fd = -1;",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1921,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "        client *c = listNodeValue(ln);",
          "new_line_content": "    ",
          "content_same": false
        },
        {
          "line": 1924,
          "old_api": "getClientType",
          "new_api": null,
          "old_text": "getClientType(c)",
          "new_text": null,
          "old_line_content": "        if (c->user == original && getClientType(c) == CLIENT_TYPE_PUBSUB) {",
          "new_line_content": "     * Scan all connected clients to find the user's pub/subs. */",
          "content_same": false
        },
        {
          "line": 1928,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "            while (!kill && ((de = dictNext(di)) != NULL)) {",
          "new_line_content": "        kill = 0;",
          "content_same": false
        },
        {
          "line": 2442,
          "old_api": "serverLog",
          "new_api": null,
          "old_text": "serverLog(LL_WARNING,\"Renaming ACL file for ACL SAVE: %s\",\n            strerror(errno))",
          "new_text": null,
          "old_line_content": "        serverLog(LL_WARNING,\"Renaming ACL file for ACL SAVE: %s\",",
          "new_line_content": "        goto cleanup;",
          "content_same": false
        },
        {
          "line": 2443,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "            strerror(errno));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1929,
          "old_api": "dictGetKey",
          "new_api": null,
          "old_text": "dictGetKey(de)",
          "new_text": null,
          "old_line_content": "                o = dictGetKey(de);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2957,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(ACLLog)",
          "new_text": null,
          "old_line_content": "        if ((size_t)count > listLength(ACLLog))",
          "new_line_content": "                return;",
          "content_same": false
        },
        {
          "line": 2446,
          "old_api": "fsyncFileDir",
          "new_api": null,
          "old_text": "fsyncFileDir(filename)",
          "new_text": null,
          "old_line_content": "    if (fsyncFileDir(filename) == -1) {",
          "new_line_content": "    /* Let's replace the new file with the old one. */",
          "content_same": false
        },
        {
          "line": 2958,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(ACLLog)",
          "new_text": null,
          "old_line_content": "            count = listLength(ACLLog);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2960,
          "old_api": "addReplyArrayLen",
          "new_api": null,
          "old_text": "addReplyArrayLen(c,count)",
          "new_text": null,
          "old_line_content": "        addReplyArrayLen(c,count);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1933,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "            dictReleaseIterator(di);",
          "new_line_content": "            dictEntry *de;",
          "content_same": false
        },
        {
          "line": 1938,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(c->pubsub_channels)",
          "new_text": null,
          "old_line_content": "                di = dictGetIterator(c->pubsub_channels);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2451,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(tmpfilename)",
          "new_text": null,
          "old_line_content": "    sdsfree(tmpfilename); tmpfilename = NULL;",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1940,
          "old_api": "dictGetKey",
          "new_api": null,
          "old_text": "dictGetKey(de)",
          "new_text": null,
          "old_line_content": "                    o = dictGetKey(de);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2965,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "        while (count-- && (ln = listNext(&li)) != NULL) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1941,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(o->ptr)",
          "new_text": null,
          "old_line_content": "                    int res = ACLCheckChannelAgainstList(upcoming, o->ptr, sdslen(o->ptr), 0);",
          "new_line_content": "            /* Check for channel violations. */",
          "content_same": false
        },
        {
          "line": 2455,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fd)",
          "new_text": null,
          "old_line_content": "    if (fd != -1) close(fd);",
          "new_line_content": "        goto cleanup;",
          "content_same": false
        },
        {
          "line": 2456,
          "old_api": "unlink",
          "new_api": null,
          "old_text": "unlink(tmpfilename)",
          "new_text": null,
          "old_line_content": "    if (tmpfilename) unlink(tmpfilename);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2967,
          "old_api": "addReplyMapLen",
          "new_api": null,
          "old_text": "addReplyMapLen(c,10)",
          "new_text": null,
          "old_line_content": "            addReplyMapLen(c,10);",
          "new_line_content": "        listIter li;",
          "content_same": false
        },
        {
          "line": 2458,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(acl)",
          "new_text": null,
          "old_line_content": "    sdsfree(acl);",
          "new_line_content": "    retval = C_OK; /* If we reached this point, everything is fine. */",
          "content_same": false
        },
        {
          "line": 2968,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"count\")",
          "new_text": null,
          "old_line_content": "            addReplyBulkCString(c,\"count\");",
          "new_line_content": "        listNode *ln;",
          "content_same": false
        },
        {
          "line": 1949,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(c->pubsubshard_channels)",
          "new_text": null,
          "old_line_content": "                di = dictGetIterator(c->pubsubshard_channels);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1951,
          "old_api": "dictGetKey",
          "new_api": null,
          "old_text": "dictGetKey(de)",
          "new_text": null,
          "old_line_content": "                    o = dictGetKey(de);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1952,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(o->ptr)",
          "new_text": null,
          "old_line_content": "                    int res = ACLCheckChannelAgainstList(upcoming, o->ptr, sdslen(o->ptr), 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2468,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(UsersToLoad)",
          "new_text": null,
          "old_line_content": "    if (server.acl_filename[0] != '\\0' && listLength(UsersToLoad) != 0) {",
          "new_line_content": "/* This function is called once the server is already running, modules are",
          "content_same": false
        },
        {
          "line": 2469,
          "old_api": "serverLog",
          "new_api": null,
          "old_text": "serverLog(LL_WARNING,\n            \"Configuring Redis with users defined in redis.conf and at \"\n            \"the same setting an ACL file path is invalid. This setup \"\n            \"is very likely to lead to configuration errors and security \"\n            \"holes, please define either an ACL file or declare users \"\n            \"directly in your redis.conf, but not both.\")",
          "new_text": null,
          "old_line_content": "        serverLog(LL_WARNING,",
          "new_line_content": " * loaded, and we are ready to start, in order to load the ACLs either from",
          "content_same": false
        },
        {
          "line": 2980,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,reasonstr)",
          "new_text": null,
          "old_line_content": "            addReplyBulkCString(c,reasonstr);",
          "new_line_content": "            case ACL_DENIED_CMD: reasonstr=\"command\"; break;",
          "content_same": false
        },
        {
          "line": 2982,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"context\")",
          "new_text": null,
          "old_line_content": "            addReplyBulkCString(c,\"context\");",
          "new_line_content": "            case ACL_DENIED_CHANNEL: reasonstr=\"channel\"; break;",
          "content_same": false
        },
        {
          "line": 1960,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient(c)",
          "new_text": null,
          "old_line_content": "                freeClient(c);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1964,
          "old_api": "listRelease",
          "new_api": null,
          "old_text": "listRelease(upcoming)",
          "new_text": null,
          "old_line_content": "    listRelease(upcoming);",
          "new_line_content": "            /* Kill it. */",
          "content_same": false
        },
        {
          "line": 2478,
          "old_api": "ACLLoadConfiguredUsers",
          "new_api": null,
          "old_text": "ACLLoadConfiguredUsers()",
          "new_text": null,
          "old_line_content": "    if (ACLLoadConfiguredUsers() == C_ERR) {",
          "new_line_content": "            \"is very likely to lead to configuration errors and security \"",
          "content_same": false
        },
        {
          "line": 2479,
          "old_api": "serverLog",
          "new_api": null,
          "old_text": "serverLog(LL_WARNING,\n            \"Critical error while loading ACLs. Exiting.\")",
          "new_text": null,
          "old_line_content": "        serverLog(LL_WARNING,",
          "new_line_content": "            \"holes, please define either an ACL file or declare users \"",
          "content_same": false
        },
        {
          "line": 2991,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,ctxstr)",
          "new_text": null,
          "old_line_content": "            addReplyBulkCString(c,ctxstr);",
          "new_line_content": "            case ACL_LOG_CTX_TOPLEVEL: ctxstr=\"toplevel\"; break;",
          "content_same": false
        },
        {
          "line": 2993,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"object\")",
          "new_text": null,
          "old_line_content": "            addReplyBulkCString(c,\"object\");",
          "new_line_content": "            case ACL_LOG_CTX_LUA: ctxstr=\"lua\"; break;",
          "content_same": false
        },
        {
          "line": 2994,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(le->object)",
          "new_text": null,
          "old_line_content": "            addReplyBulkCBuffer(c,le->object,sdslen(le->object));",
          "new_line_content": "            case ACL_LOG_CTX_MODULE: ctxstr=\"module\"; break;",
          "content_same": false
        },
        {
          "line": 2995,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c,\"username\")",
          "new_text": null,
          "old_line_content": "            addReplyBulkCString(c,\"username\");",
          "new_line_content": "            default: ctxstr=\"unknown\";",
          "content_same": false
        },
        {
          "line": 2996,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(le->username)",
          "new_text": null,
          "old_line_content": "            addReplyBulkCBuffer(c,le->username,sdslen(le->username));",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2489,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(errors)",
          "new_text": null,
          "old_line_content": "            sdsfree(errors);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2490,
          "old_api": "exit",
          "new_api": null,
          "old_text": "exit(1)",
          "new_text": null,
          "old_line_content": "            exit(1);",
          "new_line_content": "    if (server.acl_filename[0] != '\\0') {",
          "content_same": false
        },
        {
          "line": 3004,
          "old_api": "addReplyBulkCString",
          "new_api": null,
          "old_text": "addReplyBulkCString(c, \"timestamp-created\")",
          "new_text": null,
          "old_line_content": "            addReplyBulkCString(c, \"timestamp-created\");",
          "new_line_content": "            double age = (double)(now - le->ctime)/1000;",
          "content_same": false
        },
        {
          "line": 1987,
          "old_api": "zmalloc",
          "new_api": null,
          "old_text": "zmalloc(sizeof(sds) * argc)",
          "new_text": null,
          "old_line_content": "    sds *acl_args = (sds *) zmalloc(sizeof(sds) * argc);",
          "new_line_content": " * is returned and invalid_idx is set to the argument with the start of the opening",
          "content_same": false
        },
        {
          "line": 3018,
          "old_api": "addReplyErrorFormat",
          "new_api": null,
          "old_text": "addReplyErrorFormat(c, \"Command '%s' not found\", (char *)c->argv[3]->ptr)",
          "new_text": null,
          "old_line_content": "            addReplyErrorFormat(c, \"Command '%s' not found\", (char *)c->argv[3]->ptr);",
          "new_line_content": "        if (u == NULL) {",
          "content_same": false
        },
        {
          "line": 1994,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(op)",
          "new_text": null,
          "old_line_content": "            (op[0] == '(' && op[sdslen(op) - 1] != ')')) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1995,
          "old_api": "sdsdup",
          "new_api": null,
          "old_text": "sdsdup(argv[j])",
          "new_text": null,
          "old_line_content": "            selector = sdsdup(argv[j]);",
          "new_line_content": "    sds selector = NULL;",
          "content_same": false
        },
        {
          "line": 3025,
          "old_api": "addReplyErrorFormat",
          "new_api": null,
          "old_text": "addReplyErrorFormat(c,\"wrong number of arguments for '%s' command\", cmd->fullname)",
          "new_text": null,
          "old_line_content": "            addReplyErrorFormat(c,\"wrong number of arguments for '%s' command\", cmd->fullname);",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 2002,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(op)",
          "new_text": null,
          "old_line_content": "            if (op[sdslen(op) - 1] == ')') {",
          "new_line_content": "            open_bracket_start = j;",
          "content_same": false
        },
        {
          "line": 3030,
          "old_api": "ACLCheckAllUserCommandPerm",
          "new_api": null,
          "old_text": "ACLCheckAllUserCommandPerm(u, cmd, c->argv + 3, c->argc - 3, &idx)",
          "new_text": null,
          "old_line_content": "        int result = ACLCheckAllUserCommandPerm(u, cmd, c->argv + 3, c->argc - 3, &idx);",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 3032,
          "old_api": "getAclErrorMessage",
          "new_api": null,
          "old_text": "getAclErrorMessage(result, u, cmd,  c->argv[idx+3]->ptr, 1)",
          "new_text": null,
          "old_line_content": "            sds err = getAclErrorMessage(result, u, cmd,  c->argv[idx+3]->ptr, 1);",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 3033,
          "old_api": "addReplyBulkSds",
          "new_api": null,
          "old_text": "addReplyBulkSds(c, err)",
          "new_text": null,
          "old_line_content": "            addReplyBulkSds(c, err);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2010,
          "old_api": "sdsdup",
          "new_api": null,
          "old_text": "sdsdup(argv[j])",
          "new_text": null,
          "old_line_content": "        acl_args[*merged_argc] = sdsdup(argv[j]);",
          "new_line_content": "                acl_args[*merged_argc] = selector;                        ",
          "content_same": false
        },
        {
          "line": 2524,
          "old_api": "sdscmp",
          "new_api": null,
          "old_text": "sdscmp(a->object,b->object)",
          "new_text": null,
          "old_line_content": "    if (sdscmp(a->object,b->object) != 0) return 0;",
          "new_line_content": "int ACLLogMatchEntry(ACLLogEntry *a, ACLLogEntry *b) {",
          "content_same": false
        },
        {
          "line": 2525,
          "old_api": "sdscmp",
          "new_api": null,
          "old_text": "sdscmp(a->username,b->username)",
          "new_text": null,
          "old_line_content": "    if (sdscmp(a->username,b->username) != 0) return 0;",
          "new_line_content": "    if (a->reason != b->reason) return 0;",
          "content_same": false
        },
        {
          "line": 3037,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.ok)",
          "new_text": null,
          "old_line_content": "        addReply(c,shared.ok);",
          "new_line_content": "        if (result != ACL_OK) {",
          "content_same": false
        },
        {
          "line": 2015,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(acl_args[i])",
          "new_text": null,
          "old_line_content": "        for (int i = 0; i < *merged_argc; i++) sdsfree(acl_args[i]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2017,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(selector)",
          "new_text": null,
          "old_line_content": "        sdsfree(selector);",
          "new_line_content": "        (*merged_argc)++;",
          "content_same": false
        },
        {
          "line": 2532,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(le->object)",
          "new_text": null,
          "old_line_content": "    sdsfree(le->object);",
          "new_line_content": "    return 1;",
          "content_same": false
        },
        {
          "line": 2533,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(le->username)",
          "new_text": null,
          "old_line_content": "    sdsfree(le->username);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2534,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(le->cinfo)",
          "new_text": null,
          "old_line_content": "    sdsfree(le->cinfo);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2535,
          "old_api": "zfree",
          "new_api": null,
          "old_text": "zfree(le)",
          "new_text": null,
          "old_line_content": "    zfree(le);",
          "new_line_content": "/* Release an ACL log entry. */",
          "content_same": false
        },
        {
          "line": 2031,
          "old_api": "serverAssert",
          "new_api": null,
          "old_text": "serverAssert(u != NULL || username != NULL)",
          "new_text": null,
          "old_line_content": "    serverAssert(u != NULL || username != NULL);",
          "new_line_content": "/* takes an acl string already split on spaces and adds it to the given user",
          "content_same": false
        },
        {
          "line": 2036,
          "old_api": "ACLMergeSelectorArguments",
          "new_api": null,
          "old_text": "ACLMergeSelectorArguments(argv, argc, &merged_argc, &invalid_idx)",
          "new_text": null,
          "old_line_content": "    sds *acl_args = ACLMergeSelectorArguments(argv, argc, &merged_argc, &invalid_idx);",
          "new_line_content": "sds ACLStringSetUser(user *u, sds username, sds *argv, int argc) {",
          "content_same": false
        },
        {
          "line": 2549,
          "old_api": "serverPanic",
          "new_api": null,
          "old_text": "serverPanic(\"Unknown ACL_DENIED encoding\")",
          "new_text": null,
          "old_line_content": "        serverPanic(\"Unknown ACL_DENIED encoding\");",
          "new_line_content": "        server.acl_info.invalid_cmd_accesses++;",
          "content_same": false
        },
        {
          "line": 2039,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "        return sdscatfmt(sdsempty(),",
          "new_line_content": "    sds error = NULL;",
          "content_same": false
        },
        {
          "line": 3068,
          "old_api": "addReplyHelp",
          "new_api": null,
          "old_text": "addReplyHelp(c,help)",
          "new_text": null,
          "old_line_content": "        addReplyHelp(c,help);",
          "new_line_content": "\"USERS\",",
          "content_same": false
        },
        {
          "line": 3070,
          "old_api": "addReplySubcommandSyntaxError",
          "new_api": null,
          "old_text": "addReplySubcommandSyntaxError(c)",
          "new_text": null,
          "old_line_content": "        addReplySubcommandSyntaxError(c);",
          "new_line_content": "\"WHOAMI\",",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 120,
      "total_additions": 275,
      "total_deletions": 272,
      "total_api_changes": 667
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 6,
        "api_related_lines": 667,
        "non_api_lines": 3,
        "non_api_line_numbers": [
          1866,
          1867,
          1862
        ]
      }
    },
    "api_calls_before": 869,
    "api_calls_after": 872,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 0,
      "total_diff_lines": 18
    }
  }
}