{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/f1c9a203b2eda46c2980582d3bdb12b6e66f4aaf",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/f1c9a203b2eda46c2980582d3bdb12b6e66f4aaf/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/f1c9a203b2eda46c2980582d3bdb12b6e66f4aaf/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/f1c9a203b2eda46c2980582d3bdb12b6e66f4aaf/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 2466,
          "old_api": "intmax_t)((server.aof_child_pid == -1) ?\n                -1 : time(NULL)-server.aof_rewrite_time_start)",
          "new_api": "time",
          "old_text": "intmax_t)((server.aof_child_pid == -1) ?\n                -1 : time(NULL)-server.aof_rewrite_time_start)",
          "new_text": "time(NULL)",
          "old_line_content": "            (intmax_t)((server.aof_child_pid == -1) ?",
          "new_line_content": "                -1 : time(NULL)-server.rdb_save_time_start),",
          "content_same": false
        },
        {
          "line": 2472,
          "old_api": "sdscatprintf",
          "new_api": "time",
          "old_text": "sdscatprintf(info,\n                \"aof_current_size:%lld\\r\\n\"\n                \"aof_base_size:%lld\\r\\n\"\n                \"aof_pending_rewrite:%d\\r\\n\"\n                \"aof_buffer_length:%zu\\r\\n\"\n                \"aof_rewrite_buffer_length:%lu\\r\\n\"\n                \"aof_pending_bio_fsync:%llu\\r\\n\"\n                \"aof_delayed_fsync:%lu\\r\\n\",\n                (long long) server.aof_current_size,\n                (long long) server.aof_rewrite_base_size,\n                server.aof_rewrite_scheduled,\n                sdslen(server.aof_buf),\n                aofRewriteBufferSize(),\n                bioPendingJobsOfType(REDIS_BIO_AOF_FSYNC),\n                server.aof_delayed_fsync)",
          "new_text": "time(NULL)",
          "old_line_content": "            info = sdscatprintf(info,",
          "new_line_content": "                -1 : time(NULL)-server.aof_rewrite_time_start),",
          "content_same": false
        },
        {
          "line": 2560,
          "old_api": "sdscat",
          "new_api": "dictSize",
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": "dictSize(server.migrate_cached_sockets)",
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "            dictSize(server.migrate_cached_sockets));",
          "content_same": false
        },
        {
          "line": 2625,
          "old_api": "listLength",
          "new_api": "sdscatprintf",
          "old_text": "listLength(server.slaves)",
          "new_text": "sdscatprintf(info,\n                \"min_slaves_good_slaves:%d\\r\\n\",\n                server.repl_good_slaves_count)",
          "old_line_content": "        if (listLength(server.slaves)) {",
          "new_line_content": "            info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 2630,
          "old_api": "listRewind",
          "new_api": "listLength",
          "old_text": "listRewind(server.slaves,&li)",
          "new_text": "listLength(server.slaves)",
          "old_line_content": "            listRewind(server.slaves,&li);",
          "new_line_content": "        if (listLength(server.slaves)) {",
          "content_same": false
        },
        {
          "line": 2723,
          "old_api": "dictSize",
          "new_api": "sdscat",
          "old_text": "dictSize(server.db[j].dict)",
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "            keys = dictSize(server.db[j].dict);",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 2724,
          "old_api": "dictSize",
          "new_api": "sdscatprintf",
          "old_text": "dictSize(server.db[j].expires)",
          "new_text": "sdscatprintf(info, \"# Keyspace\\r\\n\")",
          "old_line_content": "            vkeys = dictSize(server.db[j].expires);",
          "new_line_content": "        info = sdscatprintf(info, \"# Keyspace\\r\\n\");",
          "content_same": false
        },
        {
          "line": 2744,
          "old_api": "sdslen",
          "new_api": "addReply",
          "old_text": "sdslen(info)",
          "new_text": "addReply(c,shared.syntaxerr)",
          "old_line_content": "        (unsigned long)sdslen(info)));",
          "new_line_content": "        addReply(c,shared.syntaxerr);",
          "content_same": false
        },
        {
          "line": 2786,
          "old_api": "listRewind",
          "new_api": "zmalloc_used_memory",
          "old_text": "listRewind(server.slaves,&li)",
          "new_text": "zmalloc_used_memory()",
          "old_line_content": "        listRewind(server.slaves,&li);",
          "new_line_content": "    mem_used = zmalloc_used_memory();",
          "content_same": false
        },
        {
          "line": 2851,
          "old_api": "dictFind",
          "new_api": "dictGetRandomKey",
          "old_text": "dictFind(db->dict, thiskey)",
          "new_text": "dictGetRandomKey(dict)",
          "old_line_content": "                        de = dictFind(db->dict, thiskey);",
          "new_line_content": "                    de = dictGetRandomKey(dict);",
          "content_same": false
        },
        {
          "line": 2852,
          "old_api": "dictGetVal",
          "new_api": "dictGetKey",
          "old_text": "dictGetVal(de)",
          "new_text": "dictGetKey(de)",
          "old_line_content": "                    o = dictGetVal(de);",
          "new_line_content": "                    thiskey = dictGetKey(de);",
          "content_same": false
        },
        {
          "line": 2901,
          "old_api": "notifyKeyspaceEvent",
          "new_api": "zmalloc_used_memory",
          "old_text": "notifyKeyspaceEvent(REDIS_NOTIFY_EVICTED, \"evicted\",\n                    keyobj, db->id)",
          "new_text": "zmalloc_used_memory()",
          "old_line_content": "                notifyKeyspaceEvent(REDIS_NOTIFY_EVICTED, \"evicted\",",
          "new_line_content": "                delta = (long long) zmalloc_used_memory();",
          "content_same": false
        },
        {
          "line": 2903,
          "old_api": "decrRefCount",
          "new_api": "zmalloc_used_memory",
          "old_text": "decrRefCount(keyobj)",
          "new_text": "zmalloc_used_memory()",
          "old_line_content": "                decrRefCount(keyobj);",
          "new_line_content": "                delta -= (long long) zmalloc_used_memory();",
          "content_same": false
        },
        {
          "line": 2927,
          "old_api": "fclose",
          "new_api": "fopen",
          "old_text": "fclose(fp)",
          "new_text": "fopen(\"/proc/sys/vm/overcommit_memory\",\"r\")",
          "old_line_content": "        fclose(fp);",
          "new_line_content": "    FILE *fp = fopen(\"/proc/sys/vm/overcommit_memory\",\"r\");",
          "content_same": false
        },
        {
          "line": 2932,
          "old_api": "atoi",
          "new_api": "fclose",
          "old_text": "atoi(buf)",
          "new_text": "fclose(fp)",
          "old_line_content": "    return atoi(buf);",
          "new_line_content": "        fclose(fp);",
          "content_same": false
        },
        {
          "line": 2937,
          "old_api": "redisLog",
          "new_api": "atoi",
          "old_text": "redisLog(REDIS_WARNING,\"WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.\")",
          "new_text": "atoi(buf)",
          "old_line_content": "        redisLog(REDIS_WARNING,\"WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.\");",
          "new_line_content": "    return atoi(buf);",
          "content_same": false
        },
        {
          "line": 2960,
          "old_api": "open",
          "new_api": "setsid",
          "old_text": "open(\"/dev/null\", O_RDWR, 0)",
          "new_text": "setsid()",
          "old_line_content": "    if ((fd = open(\"/dev/null\", O_RDWR, 0)) != -1) {",
          "new_line_content": "    setsid(); /* create a new session */",
          "content_same": false
        },
        {
          "line": 2969,
          "old_api": "printf",
          "new_api": "close",
          "old_text": "printf(\"Redis server v=%s sha=%s:%d malloc=%s bits=%d build=%llx\\n\",\n        REDIS_VERSION,\n        redisGitSHA1(),\n        atoi(redisGitDirty()) > 0,\n        ZMALLOC_LIB,\n        sizeof(long) == 4 ? 32 : 64,\n        (unsigned long long) redisBuildId())",
          "new_text": "close(fd)",
          "old_line_content": "    printf(\"Redis server v=%s sha=%s:%d malloc=%s bits=%d build=%llx\\n\",",
          "new_line_content": "        if (fd > STDERR_FILENO) close(fd);",
          "content_same": false
        },
        {
          "line": 2976,
          "old_api": "exit",
          "new_api": "redisGitSHA1",
          "old_text": "exit(0)",
          "new_text": "redisGitSHA1()",
          "old_line_content": "    exit(0);",
          "new_line_content": "        redisGitSHA1(),",
          "content_same": false
        },
        {
          "line": 2980,
          "old_api": "fprintf",
          "new_api": "redisBuildId",
          "old_text": "fprintf(stderr,\"Usage: ./redis-server [/path/to/redis.conf] [options]\\n\")",
          "new_text": "redisBuildId()",
          "old_line_content": "    fprintf(stderr,\"Usage: ./redis-server [/path/to/redis.conf] [options]\\n\");",
          "new_line_content": "        (unsigned long long) redisBuildId());",
          "content_same": false
        },
        {
          "line": 2981,
          "old_api": "fprintf",
          "new_api": "exit",
          "old_text": "fprintf(stderr,\"       ./redis-server - (read config from stdin)\\n\")",
          "new_text": "exit(0)",
          "old_line_content": "    fprintf(stderr,\"       ./redis-server - (read config from stdin)\\n\");",
          "new_line_content": "    exit(0);",
          "content_same": false
        },
        {
          "line": 2993,
          "old_api": "exit",
          "new_api": "fprintf",
          "old_text": "exit(1)",
          "new_text": "fprintf(stderr,\"       ./redis-server --port 7777\\n\")",
          "old_line_content": "    exit(1);",
          "new_line_content": "    fprintf(stderr,\"       ./redis-server --port 7777\\n\");",
          "content_same": false
        },
        {
          "line": 2998,
          "old_api": "zmalloc",
          "new_api": "exit",
          "old_text": "zmalloc(1024*16)",
          "new_text": "exit(1)",
          "old_line_content": "    char *buf = zmalloc(1024*16);",
          "new_line_content": "    exit(1);",
          "content_same": false
        },
        {
          "line": 3012,
          "old_api": "redisLogRaw",
          "new_api": "redisGitDirty",
          "old_text": "redisLogRaw(REDIS_NOTICE|REDIS_LOG_RAW,buf)",
          "new_text": "redisGitDirty()",
          "old_line_content": "    redisLogRaw(REDIS_NOTICE|REDIS_LOG_RAW,buf);",
          "new_line_content": "        strtol(redisGitDirty(),NULL,10) > 0,",
          "content_same": false
        },
        {
          "line": 3017,
          "old_api": "REDIS_NOTUSED",
          "new_api": "redisLogRaw",
          "old_text": "REDIS_NOTUSED(sig)",
          "new_text": "redisLogRaw(REDIS_NOTICE|REDIS_LOG_RAW,buf)",
          "old_line_content": "    REDIS_NOTUSED(sig);",
          "new_line_content": "    redisLogRaw(REDIS_NOTICE|REDIS_LOG_RAW,buf);",
          "content_same": false
        },
        {
          "line": 3039,
          "old_api": "sigaction",
          "new_api": "sigemptyset",
          "old_text": "sigaction(SIGFPE, &act, NULL)",
          "new_text": "sigemptyset(&act.sa_mask)",
          "old_line_content": "    sigaction(SIGFPE, &act, NULL);",
          "new_line_content": "    sigemptyset(&act.sa_mask);",
          "content_same": false
        },
        {
          "line": 3065,
          "old_api": "rdbLoad",
          "new_api": "ustime",
          "old_text": "rdbLoad(server.rdb_filename)",
          "new_text": "ustime()",
          "old_line_content": "        if (rdbLoad(server.rdb_filename) == REDIS_OK) {",
          "new_line_content": "    long long start = ustime();",
          "content_same": false
        },
        {
          "line": 3067,
          "old_api": "ustime",
          "new_api": "loadAppendOnlyFile",
          "old_text": "ustime()",
          "new_text": "loadAppendOnlyFile(server.aof_filename)",
          "old_line_content": "                (float)(ustime()-start)/1000000);",
          "new_line_content": "        if (loadAppendOnlyFile(server.aof_filename) == REDIS_OK)",
          "content_same": false
        },
        {
          "line": 3070,
          "old_api": "exit",
          "new_api": "rdbLoad",
          "old_text": "exit(1)",
          "new_text": "rdbLoad(server.rdb_filename)",
          "old_line_content": "            exit(1);",
          "new_line_content": "        if (rdbLoad(server.rdb_filename) == REDIS_OK) {",
          "content_same": false
        },
        {
          "line": 3107,
          "old_api": "getpid",
          "new_api": "spt_init",
          "old_text": "getpid()",
          "new_text": "spt_init(argc, argv)",
          "old_line_content": "    srand(time(NULL)^getpid());",
          "new_line_content": "    spt_init(argc, argv);",
          "content_same": false
        },
        {
          "line": 3109,
          "old_api": "getpid",
          "new_api": "setlocale",
          "old_text": "getpid()",
          "new_text": "setlocale(LC_COLLATE,\"\")",
          "old_line_content": "    dictSetHashFunctionSeed(tv.tv_sec^tv.tv_usec^getpid());",
          "new_line_content": "    setlocale(LC_COLLATE,\"\");",
          "content_same": false
        },
        {
          "line": 3110,
          "old_api": "checkForSentinelMode",
          "new_api": "zmalloc_enable_thread_safeness",
          "old_text": "checkForSentinelMode(argc,argv)",
          "new_text": "zmalloc_enable_thread_safeness()",
          "old_line_content": "    server.sentinel_mode = checkForSentinelMode(argc,argv);",
          "new_line_content": "    zmalloc_enable_thread_safeness();",
          "content_same": false
        },
        {
          "line": 3111,
          "old_api": "initServerConfig",
          "new_api": "zmalloc_set_oom_handler",
          "old_text": "initServerConfig()",
          "new_text": "zmalloc_set_oom_handler(redisOutOfMemoryHandler)",
          "old_line_content": "    initServerConfig();",
          "new_line_content": "    zmalloc_set_oom_handler(redisOutOfMemoryHandler);",
          "content_same": false
        },
        {
          "line": 3123,
          "old_api": "sdsempty",
          "new_api": "initSentinel",
          "old_text": "sdsempty()",
          "new_text": "initSentinel()",
          "old_line_content": "        sds options = sdsempty();",
          "new_line_content": "        initSentinel();",
          "content_same": false
        },
        {
          "line": 3128,
          "old_api": "version",
          "new_api": "sdsempty",
          "old_text": "version()",
          "new_text": "sdsempty()",
          "old_line_content": "            strcmp(argv[1], \"--version\") == 0) version();",
          "new_line_content": "        sds options = sdsempty();",
          "content_same": false
        },
        {
          "line": 3133,
          "old_api": "atoi",
          "new_api": "version",
          "old_text": "atoi(argv[2])",
          "new_text": "version()",
          "old_line_content": "                memtest(atoi(argv[2]),50);",
          "new_line_content": "            strcmp(argv[1], \"--version\") == 0) version();",
          "content_same": false
        },
        {
          "line": 3134,
          "old_api": "exit",
          "new_api": "strcmp",
          "old_text": "exit(0)",
          "new_text": "strcmp(argv[1], \"--help\")",
          "old_line_content": "                exit(0);",
          "new_line_content": "        if (strcmp(argv[1], \"--help\") == 0 ||",
          "content_same": false
        },
        {
          "line": 3136,
          "old_api": "fprintf",
          "new_api": "strcmp",
          "old_text": "fprintf(stderr,\"Please specify the amount of memory to test in megabytes.\\n\")",
          "new_text": "strcmp(argv[1], \"--test-memory\")",
          "old_line_content": "                fprintf(stderr,\"Please specify the amount of memory to test in megabytes.\\n\");",
          "new_line_content": "        if (strcmp(argv[1], \"--test-memory\") == 0) {",
          "content_same": false
        },
        {
          "line": 3138,
          "old_api": "exit",
          "new_api": "atoi",
          "old_text": "exit(1)",
          "new_text": "atoi(argv[2])",
          "old_line_content": "                exit(1);",
          "new_line_content": "                memtest(atoi(argv[2]),50);",
          "content_same": false
        },
        {
          "line": 3157,
          "old_api": "strlen",
          "new_api": "sdscat",
          "old_text": "strlen(argv[j])",
          "new_text": "sdscat(options,\"\\n\")",
          "old_line_content": "                options = sdscatrepr(options,argv[j],strlen(argv[j]));",
          "new_line_content": "                if (sdslen(options)) options = sdscat(options,\"\\n\");",
          "content_same": false
        },
        {
          "line": 3162,
          "old_api": "getAbsolutePath",
          "new_api": "strlen",
          "old_text": "getAbsolutePath(configfile)",
          "new_text": "strlen(argv[j])",
          "old_line_content": "        if (configfile) server.configfile = getAbsolutePath(configfile);",
          "new_line_content": "                options = sdscatrepr(options,argv[j],strlen(argv[j]));",
          "content_same": false
        },
        {
          "line": 3163,
          "old_api": "resetServerSaveParams",
          "new_api": "sdscat",
          "old_text": "resetServerSaveParams()",
          "new_text": "sdscat(options,\" \")",
          "old_line_content": "        resetServerSaveParams();",
          "new_line_content": "                options = sdscat(options,\" \");",
          "content_same": false
        },
        {
          "line": 3167,
          "old_api": "redisLog",
          "new_api": "getAbsolutePath",
          "old_text": "redisLog(REDIS_WARNING, \"Warning: no config file specified, using the default config. In order to specify a config file use %s /path/to/%s.conf\", argv[0], server.sentinel_mode ? \"sentinel\" : \"redis\")",
          "new_text": "getAbsolutePath(configfile)",
          "old_line_content": "        redisLog(REDIS_WARNING, \"Warning: no config file specified, using the default config. In order to specify a config file use %s /path/to/%s.conf\", argv[0], server.sentinel_mode ? \"sentinel\" : \"redis\");",
          "new_line_content": "        if (configfile) server.configfile = getAbsolutePath(configfile);",
          "content_same": false
        },
        {
          "line": 3169,
          "old_api": "daemonize",
          "new_api": "loadServerConfig",
          "old_text": "daemonize()",
          "new_text": "loadServerConfig(configfile,options)",
          "old_line_content": "    if (server.daemonize) daemonize();",
          "new_line_content": "        loadServerConfig(configfile,options);",
          "content_same": false
        },
        {
          "line": 3170,
          "old_api": "initServer",
          "new_api": "sdsfree",
          "old_text": "initServer()",
          "new_text": "sdsfree(options)",
          "old_line_content": "    initServer();",
          "new_line_content": "        sdsfree(options);",
          "content_same": false
        },
        {
          "line": 3172,
          "old_api": "redisSetProcTitle",
          "new_api": "redisLog",
          "old_text": "redisSetProcTitle(argv[0])",
          "new_text": "redisLog(REDIS_WARNING, \"Warning: no config file specified, using the default config. In order to specify a config file use %s /path/to/%s.conf\", argv[0], server.sentinel_mode ? \"sentinel\" : \"redis\")",
          "old_line_content": "    redisSetProcTitle(argv[0]);",
          "new_line_content": "        redisLog(REDIS_WARNING, \"Warning: no config file specified, using the default config. In order to specify a config file use %s /path/to/%s.conf\", argv[0], server.sentinel_mode ? \"sentinel\" : \"redis\");",
          "content_same": false
        },
        {
          "line": 3177,
          "old_api": "redisLog",
          "new_api": "redisSetProcTitle",
          "old_text": "redisLog(REDIS_WARNING,\"Server started, Redis version \" REDIS_VERSION)",
          "new_text": "redisSetProcTitle(argv[0])",
          "old_line_content": "        redisLog(REDIS_WARNING,\"Server started, Redis version \" REDIS_VERSION);",
          "new_line_content": "    redisSetProcTitle(argv[0]);",
          "content_same": false
        },
        {
          "line": 3184,
          "old_api": "redisLog",
          "new_api": "linuxOvercommitMemoryWarning",
          "old_text": "redisLog(REDIS_WARNING,\n                    \"You can't have keys in a DB different than DB 0 when in \"\n                    \"Cluster mode. Exiting.\")",
          "new_text": "linuxOvercommitMemoryWarning()",
          "old_line_content": "                redisLog(REDIS_WARNING,",
          "new_line_content": "        linuxOvercommitMemoryWarning();",
          "content_same": false
        },
        {
          "line": 3200,
          "old_api": "redisLog",
          "new_api": "sentinelIsRunning",
          "old_text": "redisLog(REDIS_WARNING,\"WARNING: You specified a maxmemory value that is less than 1MB (current value is %llu bytes). Are you sure this is what you really want?\", server.maxmemory)",
          "new_text": "sentinelIsRunning()",
          "old_line_content": "        redisLog(REDIS_WARNING,\"WARNING: You specified a maxmemory value that is less than 1MB (current value is %llu bytes). Are you sure this is what you really want?\", server.maxmemory);",
          "new_line_content": "        sentinelIsRunning();",
          "content_same": false
        },
        {
          "line": 3205,
          "old_api": "aeDeleteEventLoop",
          "new_api": "redisLog",
          "old_text": "aeDeleteEventLoop(server.el)",
          "new_text": "redisLog(REDIS_WARNING,\"WARNING: You specified a maxmemory value that is less than 1MB (current value is %llu bytes). Are you sure this is what you really want?\", server.maxmemory)",
          "old_line_content": "    aeDeleteEventLoop(server.el);",
          "new_line_content": "        redisLog(REDIS_WARNING,\"WARNING: You specified a maxmemory value that is less than 1MB (current value is %llu bytes). Are you sure this is what you really want?\", server.maxmemory);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 3072,
          "old_api": null,
          "new_api": "ustime",
          "old_text": null,
          "new_text": "ustime()",
          "old_line_content": "    }",
          "new_line_content": "                (float)(ustime()-start)/1000000);",
          "content_same": false
        },
        {
          "line": 3074,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "",
          "new_line_content": "            redisLog(REDIS_WARNING,\"Fatal error loading the DB: %s. Exiting.\",strerror(errno));",
          "content_same": false
        },
        {
          "line": 3075,
          "old_api": null,
          "new_api": "exit",
          "old_text": null,
          "new_text": "exit(1)",
          "old_line_content": "void redisOutOfMemoryHandler(size_t allocation_size) {",
          "new_line_content": "            exit(1);",
          "content_same": false
        },
        {
          "line": 2564,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"replication\")",
          "old_line_content": "            server.masterhost == NULL ? \"master\" : \"slave\");",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"replication\")) {",
          "content_same": false
        },
        {
          "line": 2565,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "        if (server.masterhost) {",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 2566,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"# Replication\\r\\n\"\n            \"role:%s\\r\\n\",\n            server.masterhost == NULL ? \"master\" : \"slave\")",
          "old_line_content": "            long long slave_repl_offset = 1;",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 3081,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"Out Of Memory allocating %zu bytes!\",\n        allocation_size)",
          "old_line_content": "void redisSetProcTitle(char *title) {",
          "new_line_content": "    redisLog(REDIS_WARNING,\"Out Of Memory allocating %zu bytes!\",",
          "content_same": false
        },
        {
          "line": 3083,
          "old_api": null,
          "new_api": "redisPanic",
          "old_text": null,
          "new_text": "redisPanic(\"Redis aborting for OUT OF MEMORY\")",
          "old_line_content": "    char *server_mode = \"\";",
          "new_line_content": "    redisPanic(\"Redis aborting for OUT OF MEMORY\");",
          "content_same": false
        },
        {
          "line": 2578,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                \"master_host:%s\\r\\n\"\n                \"master_port:%d\\r\\n\"\n                \"master_link_status:%s\\r\\n\"\n                \"master_last_io_seconds_ago:%d\\r\\n\"\n                \"master_sync_in_progress:%d\\r\\n\"\n                \"slave_repl_offset:%lld\\r\\n\"\n                ,server.masterhost,\n                server.masterport,\n                (server.repl_state == REDIS_REPL_CONNECTED) ?\n                    \"up\" : \"down\",\n                server.master ?\n                ((int)(server.unixtime-server.master->lastinteraction)) : -1,\n                server.repl_state == REDIS_REPL_TRANSFER,\n                slave_repl_offset\n            )",
          "old_line_content": "                \"master_sync_in_progress:%d\\r\\n\"",
          "new_line_content": "            info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 3092,
          "old_api": null,
          "new_api": "setproctitle",
          "old_text": null,
          "new_text": "setproctitle(\"%s %s:%d%s\",\n        title,\n        server.bindaddr_count ? server.bindaddr[0] : \"*\",\n        server.port,\n        server_mode)",
          "old_line_content": "#else",
          "new_line_content": "    setproctitle(\"%s %s:%d%s\",",
          "content_same": false
        },
        {
          "line": 3098,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(title)",
          "old_line_content": "    struct timeval tv;",
          "new_line_content": "    REDIS_NOTUSED(title);",
          "content_same": false
        },
        {
          "line": 2596,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                    \"master_sync_left_bytes:%lld\\r\\n\"\n                    \"master_sync_last_io_seconds_ago:%d\\r\\n\"\n                    , (long long)\n                        (server.repl_transfer_size - server.repl_transfer_read),\n                    (int)(server.unixtime-server.repl_transfer_lastio)\n                )",
          "old_line_content": "                    (int)(server.unixtime-server.repl_transfer_lastio)",
          "new_line_content": "                info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 3112,
          "old_api": null,
          "new_api": "getpid",
          "old_text": null,
          "new_text": "getpid()",
          "old_line_content": "",
          "new_line_content": "    srand(time(NULL)^getpid());",
          "content_same": false
        },
        {
          "line": 3113,
          "old_api": null,
          "new_api": "gettimeofday",
          "old_text": null,
          "new_text": "gettimeofday(&tv,NULL)",
          "old_line_content": "    /* We need to init sentinel right now as parsing the configuration file",
          "new_line_content": "    gettimeofday(&tv,NULL);",
          "content_same": false
        },
        {
          "line": 3114,
          "old_api": null,
          "new_api": "getpid",
          "old_text": null,
          "new_text": "getpid()",
          "old_line_content": "     * in sentinel mode will have the effect of populating the sentinel",
          "new_line_content": "    dictSetHashFunctionSeed(tv.tv_sec^tv.tv_usec^getpid());",
          "content_same": false
        },
        {
          "line": 3115,
          "old_api": null,
          "new_api": "checkForSentinelMode",
          "old_text": null,
          "new_text": "checkForSentinelMode(argc,argv)",
          "old_line_content": "     * data structures with master nodes to monitor. */",
          "new_line_content": "    server.sentinel_mode = checkForSentinelMode(argc,argv);",
          "content_same": false
        },
        {
          "line": 3116,
          "old_api": null,
          "new_api": "initServerConfig",
          "old_text": null,
          "new_text": "initServerConfig()",
          "old_line_content": "    if (server.sentinel_mode) {",
          "new_line_content": "    initServerConfig();",
          "content_same": false
        },
        {
          "line": 2606,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                    \"master_link_down_since_seconds:%jd\\r\\n\",\n                    (intmax_t)server.unixtime-server.repl_down_since)",
          "old_line_content": "                \"slave_priority:%d\\r\\n\"",
          "new_line_content": "                info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 2610,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                \"slave_priority:%d\\r\\n\"\n                \"slave_read_only:%d\\r\\n\",\n                server.slave_priority,\n                server.repl_slave_ro)",
          "old_line_content": "        }",
          "new_line_content": "            info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 3122,
          "old_api": null,
          "new_api": "initSentinelConfig",
          "old_text": null,
          "new_text": "initSentinelConfig()",
          "old_line_content": "        int j = 1; /* First option to parse in argv[] */",
          "new_line_content": "        initSentinelConfig();",
          "content_same": false
        },
        {
          "line": 2617,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"connected_slaves:%lu\\r\\n\",\n            listLength(server.slaves))",
          "old_line_content": "         * currently considered 'good'. */",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 2619,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(server.slaves)",
          "old_line_content": "            server.repl_min_slaves_max_lag) {",
          "new_line_content": "            listLength(server.slaves));",
          "content_same": false
        },
        {
          "line": 3132,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(argv[1], \"-v\")",
          "old_line_content": "            if (argc == 3) {",
          "new_line_content": "        if (strcmp(argv[1], \"-v\") == 0 ||",
          "content_same": false
        },
        {
          "line": 3135,
          "old_api": null,
          "new_api": "usage",
          "old_text": null,
          "new_text": "usage()",
          "old_line_content": "            } else {",
          "new_line_content": "            strcmp(argv[1], \"-h\") == 0) usage();",
          "content_same": false
        },
        {
          "line": 3139,
          "old_api": null,
          "new_api": "exit",
          "old_text": null,
          "new_text": "exit(0)",
          "old_line_content": "            }",
          "new_line_content": "                exit(0);",
          "content_same": false
        },
        {
          "line": 3141,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr,\"Please specify the amount of memory to test in megabytes.\\n\")",
          "old_line_content": "",
          "new_line_content": "                fprintf(stderr,\"Please specify the amount of memory to test in megabytes.\\n\");",
          "content_same": false
        },
        {
          "line": 3142,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr,\"Example: ./redis-server --test-memory 4096\\n\\n\")",
          "old_line_content": "        /* First argument is the config file name? */",
          "new_line_content": "                fprintf(stderr,\"Example: ./redis-server --test-memory 4096\\n\\n\");",
          "content_same": false
        },
        {
          "line": 3143,
          "old_api": null,
          "new_api": "exit",
          "old_text": null,
          "new_text": "exit(1)",
          "old_line_content": "        if (argv[j][0] != '-' || argv[j][1] != '-')",
          "new_line_content": "                exit(1);",
          "content_same": false
        },
        {
          "line": 2635,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(server.slaves,&li)",
          "old_line_content": "                int port;",
          "new_line_content": "            listRewind(server.slaves,&li);",
          "content_same": false
        },
        {
          "line": 2636,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "                long lag = 0;",
          "new_line_content": "            while((ln = listNext(&li))) {",
          "content_same": false
        },
        {
          "line": 2637,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "",
          "new_line_content": "                redisClient *slave = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 2643,
          "old_api": null,
          "new_api": "anetPeerToString",
          "old_text": null,
          "new_text": "anetPeerToString(slave->fd,ip,sizeof(ip),&port)",
          "old_line_content": "                    break;",
          "new_line_content": "                if (anetPeerToString(slave->fd,ip,sizeof(ip),&port) == -1) continue;",
          "content_same": false
        },
        {
          "line": 3159,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(options,\" \")",
          "old_line_content": "            }",
          "new_line_content": "                options = sdscat(options,\" \");",
          "content_same": false
        },
        {
          "line": 3168,
          "old_api": null,
          "new_api": "resetServerSaveParams",
          "old_text": null,
          "new_text": "resetServerSaveParams()",
          "old_line_content": "    }",
          "new_line_content": "        resetServerSaveParams();",
          "content_same": false
        },
        {
          "line": 2658,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "                    slaveid,ip,slave->slave_listening_port,state,",
          "new_line_content": "                    lag = time(NULL) - slave->repl_ack_time;",
          "content_same": false
        },
        {
          "line": 2660,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                    \"slave%d:ip=%s,port=%d,state=%s,\"\n                    \"offset=%lld,lag=%ld\\r\\n\",\n                    slaveid,ip,slave->slave_listening_port,state,\n                    slave->repl_ack_off, lag)",
          "old_line_content": "                slaveid++;",
          "new_line_content": "                info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 3174,
          "old_api": null,
          "new_api": "daemonize",
          "old_text": null,
          "new_text": "daemonize()",
          "old_line_content": "",
          "new_line_content": "    if (server.daemonize) daemonize();",
          "content_same": false
        },
        {
          "line": 3175,
          "old_api": null,
          "new_api": "initServer",
          "old_text": null,
          "new_text": "initServer()",
          "old_line_content": "    if (!server.sentinel_mode) {",
          "new_line_content": "    initServer();",
          "content_same": false
        },
        {
          "line": 3176,
          "old_api": null,
          "new_api": "createPidFile",
          "old_text": null,
          "new_text": "createPidFile()",
          "old_line_content": "        /* Things not needed when running in Sentinel mode. */",
          "new_line_content": "    if (server.daemonize) createPidFile();",
          "content_same": false
        },
        {
          "line": 3178,
          "old_api": null,
          "new_api": "redisAsciiArt",
          "old_text": null,
          "new_text": "redisAsciiArt()",
          "old_line_content": "    #ifdef __linux__",
          "new_line_content": "    redisAsciiArt();",
          "content_same": false
        },
        {
          "line": 2668,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"master_repl_offset:%lld\\r\\n\"\n            \"repl_backlog_active:%d\\r\\n\"\n            \"repl_backlog_size:%lld\\r\\n\"\n            \"repl_backlog_first_byte_offset:%lld\\r\\n\"\n            \"repl_backlog_histlen:%lld\\r\\n\",\n            server.master_repl_offset,\n            server.repl_backlog != NULL,\n            server.repl_backlog_size,\n            server.repl_backlog_off,\n            server.repl_backlog_histlen)",
          "old_line_content": "            \"repl_backlog_histlen:%lld\\r\\n\",",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 3182,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"Server started, Redis version \" REDIS_VERSION)",
          "old_line_content": "        if (server.cluster_enabled) {",
          "new_line_content": "        redisLog(REDIS_WARNING,\"Server started, Redis version \" REDIS_VERSION);",
          "content_same": false
        },
        {
          "line": 3186,
          "old_api": null,
          "new_api": "loadDataFromDisk",
          "old_text": null,
          "new_text": "loadDataFromDisk()",
          "old_line_content": "                    \"Cluster mode. Exiting.\");",
          "new_line_content": "        loadDataFromDisk();",
          "content_same": false
        },
        {
          "line": 3188,
          "old_api": null,
          "new_api": "verifyClusterConfigWithData",
          "old_text": null,
          "new_text": "verifyClusterConfigWithData()",
          "old_line_content": "            }",
          "new_line_content": "            if (verifyClusterConfigWithData() == REDIS_ERR) {",
          "content_same": false
        },
        {
          "line": 3189,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\n                    \"You can't have keys in a DB different than DB 0 when in \"\n                    \"Cluster mode. Exiting.\")",
          "old_line_content": "        }",
          "new_line_content": "                redisLog(REDIS_WARNING,",
          "content_same": false
        },
        {
          "line": 3192,
          "old_api": null,
          "new_api": "exit",
          "old_text": null,
          "new_text": "exit(1)",
          "old_line_content": "        if (server.sofd > 0)",
          "new_line_content": "                exit(1);",
          "content_same": false
        },
        {
          "line": 2682,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"cpu\")",
          "old_line_content": "        \"used_cpu_user:%.2f\\r\\n\"",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"cpu\")) {",
          "content_same": false
        },
        {
          "line": 2683,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "        \"used_cpu_sys_children:%.2f\\r\\n\"",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 2684,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n        \"# CPU\\r\\n\"\n        \"used_cpu_sys:%.2f\\r\\n\"\n        \"used_cpu_user:%.2f\\r\\n\"\n        \"used_cpu_sys_children:%.2f\\r\\n\"\n        \"used_cpu_user_children:%.2f\\r\\n\",\n        (float)self_ru.ru_stime.tv_sec+(float)self_ru.ru_stime.tv_usec/1000000,\n        (float)self_ru.ru_utime.tv_sec+(float)self_ru.ru_utime.tv_usec/1000000,\n        (float)c_ru.ru_stime.tv_sec+(float)c_ru.ru_stime.tv_usec/1000000,\n        (float)c_ru.ru_utime.tv_sec+(float)c_ru.ru_utime.tv_usec/1000000)",
          "old_line_content": "        \"used_cpu_user_children:%.2f\\r\\n\",",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 3196,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_NOTICE,\"The server is now ready to accept connections on port %d\", server.port)",
          "old_line_content": "    }",
          "new_line_content": "            redisLog(REDIS_NOTICE,\"The server is now ready to accept connections on port %d\", server.port);",
          "content_same": false
        },
        {
          "line": 3198,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_NOTICE,\"The server is now ready to accept connections at %s\", server.unixsocket)",
          "old_line_content": "    /* Warning the user about suspicious maxmemory setting. */",
          "new_line_content": "            redisLog(REDIS_NOTICE,\"The server is now ready to accept connections at %s\", server.unixsocket);",
          "content_same": false
        },
        {
          "line": 3208,
          "old_api": null,
          "new_api": "aeSetBeforeSleepProc",
          "old_text": null,
          "new_text": "aeSetBeforeSleepProc(server.el,beforeSleep)",
          "old_line_content": "",
          "new_line_content": "    aeSetBeforeSleepProc(server.el,beforeSleep);",
          "content_same": false
        },
        {
          "line": 2697,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"commandstats\")",
          "old_line_content": "            struct redisCommand *c = redisCommandTable+j;",
          "new_line_content": "    if (allsections || !strcasecmp(section,\"commandstats\")) {",
          "content_same": false
        },
        {
          "line": 2698,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 2699,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info, \"# Commandstats\\r\\n\")",
          "old_line_content": "            if (!c->calls) continue;",
          "new_line_content": "        info = sdscatprintf(info, \"# Commandstats\\r\\n\");",
          "content_same": false
        },
        {
          "line": 3209,
          "old_api": null,
          "new_api": "aeMain",
          "old_text": null,
          "new_text": "aeMain(server.el)",
          "old_line_content": "/* The End */",
          "new_line_content": "    aeMain(server.el);",
          "content_same": false
        },
        {
          "line": 3210,
          "old_api": null,
          "new_api": "aeDeleteEventLoop",
          "old_text": null,
          "new_text": "aeDeleteEventLoop(server.el)",
          "old_line_content": "",
          "new_line_content": "    aeDeleteEventLoop(server.el);",
          "content_same": false
        },
        {
          "line": 2705,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                \"cmdstat_%s:calls=%lld,usec=%lld,usec_per_call=%.2f\\r\\n\",\n                c->name, c->calls, c->microseconds,\n                (c->calls == 0) ? 0 : ((float)c->microseconds/c->calls))",
          "old_line_content": "    }",
          "new_line_content": "            info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 2713,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"cluster\")",
          "old_line_content": "        server.cluster_enabled);",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"cluster\")) {",
          "content_same": false
        },
        {
          "line": 2714,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "    }",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 2715,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n        \"# Cluster\\r\\n\"\n        \"cluster_enabled:%d\\r\\n\",\n        server.cluster_enabled)",
          "old_line_content": "",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 2722,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"keyspace\")",
          "old_line_content": "",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"keyspace\")) {",
          "content_same": false
        },
        {
          "line": 2728,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(server.db[j].dict)",
          "old_line_content": "                    j, keys, vkeys, server.db[j].avg_ttl);",
          "new_line_content": "            keys = dictSize(server.db[j].dict);",
          "content_same": false
        },
        {
          "line": 2729,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(server.db[j].expires)",
          "old_line_content": "            }",
          "new_line_content": "            vkeys = dictSize(server.db[j].expires);",
          "content_same": false
        },
        {
          "line": 2731,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                    \"db%d:keys=%lld,expires=%lld,avg_ttl=%lld\\r\\n\",\n                    j, keys, vkeys, server.db[j].avg_ttl)",
          "old_line_content": "    }",
          "new_line_content": "                info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 2747,
          "old_api": null,
          "new_api": "genRedisInfoString",
          "old_text": null,
          "new_text": "genRedisInfoString(section)",
          "old_line_content": "}",
          "new_line_content": "    sds info = genRedisInfoString(section);",
          "content_same": false
        },
        {
          "line": 2748,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "",
          "new_line_content": "    addReplySds(c,sdscatprintf(sdsempty(),\"$%lu\\r\\n\",",
          "content_same": false
        },
        {
          "line": 2749,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(info)",
          "old_line_content": "void monitorCommand(redisClient *c) {",
          "new_line_content": "        (unsigned long)sdslen(info)));",
          "content_same": false
        },
        {
          "line": 2750,
          "old_api": null,
          "new_api": "addReplySds",
          "old_text": null,
          "new_text": "addReplySds(c,info)",
          "old_line_content": "    /* ignore MONITOR if already slave or in monitor mode */",
          "new_line_content": "    addReplySds(c,info);",
          "content_same": false
        },
        {
          "line": 2751,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.crlf)",
          "old_line_content": "    if (c->flags & REDIS_SLAVE) return;",
          "new_line_content": "    addReply(c,shared.crlf);",
          "content_same": false
        },
        {
          "line": 2759,
          "old_api": null,
          "new_api": "listAddNodeTail",
          "old_text": null,
          "new_text": "listAddNodeTail(server.monitors,c)",
          "old_line_content": "",
          "new_line_content": "    listAddNodeTail(server.monitors,c);",
          "content_same": false
        },
        {
          "line": 2760,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "/* This function gets called when 'maxmemory' is set on the config file to limit",
          "new_line_content": "    addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 2782,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(server.slaves)",
          "old_line_content": "    if (slaves) {",
          "new_line_content": "    int slaves = listLength(server.slaves);",
          "content_same": false
        },
        {
          "line": 2791,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(server.slaves,&li)",
          "old_line_content": "                mem_used = 0;",
          "new_line_content": "        listRewind(server.slaves,&li);",
          "content_same": false
        },
        {
          "line": 2792,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "            else",
          "new_line_content": "        while((ln = listNext(&li))) {",
          "content_same": false
        },
        {
          "line": 2793,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "                mem_used -= obuf_bytes;",
          "new_line_content": "            redisClient *slave = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 2794,
          "old_api": null,
          "new_api": "getClientOutputBufferMemoryUsage",
          "old_text": null,
          "new_text": "getClientOutputBufferMemoryUsage(slave)",
          "old_line_content": "        }",
          "new_line_content": "            unsigned long obuf_bytes = getClientOutputBufferMemoryUsage(slave);",
          "content_same": false
        },
        {
          "line": 2802,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(server.aof_buf)",
          "old_line_content": "    if (mem_used <= server.maxmemory) return REDIS_OK;",
          "new_line_content": "        mem_used -= sdslen(server.aof_buf);",
          "content_same": false
        },
        {
          "line": 2803,
          "old_api": null,
          "new_api": "aofRewriteBufferSize",
          "old_text": null,
          "new_text": "aofRewriteBufferSize()",
          "old_line_content": "",
          "new_line_content": "        mem_used -= aofRewriteBufferSize();",
          "content_same": false
        },
        {
          "line": 2832,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(dict)",
          "old_line_content": "            {",
          "new_line_content": "            if (dictSize(dict) == 0) continue;",
          "content_same": false
        },
        {
          "line": 2838,
          "old_api": null,
          "new_api": "dictGetRandomKey",
          "old_text": null,
          "new_text": "dictGetRandomKey(dict)",
          "old_line_content": "            else if (server.maxmemory_policy == REDIS_MAXMEMORY_ALLKEYS_LRU ||",
          "new_line_content": "                de = dictGetRandomKey(dict);",
          "content_same": false
        },
        {
          "line": 2839,
          "old_api": null,
          "new_api": "dictGetKey",
          "old_text": null,
          "new_text": "dictGetKey(de)",
          "old_line_content": "                server.maxmemory_policy == REDIS_MAXMEMORY_VOLATILE_LRU)",
          "new_line_content": "                bestkey = dictGetKey(de);",
          "content_same": false
        },
        {
          "line": 2856,
          "old_api": null,
          "new_api": "dictFind",
          "old_text": null,
          "new_text": "dictFind(db->dict, thiskey)",
          "old_line_content": "                    if (bestkey == NULL || thisval > bestval) {",
          "new_line_content": "                        de = dictFind(db->dict, thiskey);",
          "content_same": false
        },
        {
          "line": 2857,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "                        bestkey = thiskey;",
          "new_line_content": "                    o = dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 2858,
          "old_api": null,
          "new_api": "estimateObjectIdleTime",
          "old_text": null,
          "new_text": "estimateObjectIdleTime(o)",
          "old_line_content": "                        bestval = thisval;",
          "new_line_content": "                    thisval = estimateObjectIdleTime(o);",
          "content_same": false
        },
        {
          "line": 2874,
          "old_api": null,
          "new_api": "dictGetRandomKey",
          "old_text": null,
          "new_text": "dictGetRandomKey(dict)",
          "old_line_content": "                     * candidate for deletion */",
          "new_line_content": "                    de = dictGetRandomKey(dict);",
          "content_same": false
        },
        {
          "line": 2875,
          "old_api": null,
          "new_api": "dictGetKey",
          "old_text": null,
          "new_text": "dictGetKey(de)",
          "old_line_content": "                    if (bestkey == NULL || thisval < bestval) {",
          "new_line_content": "                    thiskey = dictGetKey(de);",
          "content_same": false
        },
        {
          "line": 2876,
          "old_api": null,
          "new_api": "dictGetVal",
          "old_text": null,
          "new_text": "dictGetVal(de)",
          "old_line_content": "                        bestkey = thiskey;",
          "new_line_content": "                    thisval = (long) dictGetVal(de);",
          "content_same": false
        },
        {
          "line": 2891,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(bestkey)",
          "old_line_content": "                 * we are freeing removing the key, but we can't account for",
          "new_line_content": "                robj *keyobj = createStringObject(bestkey,sdslen(bestkey));",
          "content_same": false
        },
        {
          "line": 2892,
          "old_api": null,
          "new_api": "propagateExpire",
          "old_text": null,
          "new_text": "propagateExpire(db,keyobj)",
          "old_line_content": "                 * that otherwise we would never exit the loop.",
          "new_line_content": "                propagateExpire(db,keyobj);",
          "content_same": false
        },
        {
          "line": 2902,
          "old_api": null,
          "new_api": "dbDelete",
          "old_text": null,
          "new_text": "dbDelete(db,keyobj)",
          "old_line_content": "                    keyobj, db->id);",
          "new_line_content": "                dbDelete(db,keyobj);",
          "content_same": false
        },
        {
          "line": 2906,
          "old_api": null,
          "new_api": "notifyKeyspaceEvent",
          "old_text": null,
          "new_text": "notifyKeyspaceEvent(REDIS_NOTIFY_EVICTED, \"evicted\",\n                    keyobj, db->id)",
          "old_line_content": "                /* When the memory to free starts to be big enough, we may",
          "new_line_content": "                notifyKeyspaceEvent(REDIS_NOTIFY_EVICTED, \"evicted\",",
          "content_same": false
        },
        {
          "line": 2908,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(keyobj)",
          "old_line_content": "                 * deliver data to the slaves fast enough, so we force the",
          "new_line_content": "                decrRefCount(keyobj);",
          "content_same": false
        },
        {
          "line": 2915,
          "old_api": null,
          "new_api": "flushSlavesOutputBuffers",
          "old_text": null,
          "new_text": "flushSlavesOutputBuffers()",
          "old_line_content": "    return REDIS_OK;",
          "new_line_content": "                if (slaves) flushSlavesOutputBuffers();",
          "content_same": false
        },
        {
          "line": 2410,
          "old_api": null,
          "new_api": "zmalloc_used_memory",
          "old_text": null,
          "new_text": "zmalloc_used_memory()",
          "old_line_content": "",
          "new_line_content": "        size_t zmalloc_used = zmalloc_used_memory();",
          "content_same": false
        },
        {
          "line": 2416,
          "old_api": null,
          "new_api": "bytesToHuman",
          "old_text": null,
          "new_text": "bytesToHuman(hmem,zmalloc_used)",
          "old_line_content": "            \"used_memory:%zu\\r\\n\"",
          "new_line_content": "        bytesToHuman(hmem,zmalloc_used);",
          "content_same": false
        },
        {
          "line": 2417,
          "old_api": null,
          "new_api": "bytesToHuman",
          "old_text": null,
          "new_text": "bytesToHuman(peak_hmem,server.stat_peak_memory)",
          "old_line_content": "            \"used_memory_human:%s\\r\\n\"",
          "new_line_content": "        bytesToHuman(peak_hmem,server.stat_peak_memory);",
          "content_same": false
        },
        {
          "line": 2418,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "            \"used_memory_rss:%zu\\r\\n\"",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 2419,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"# Memory\\r\\n\"\n            \"used_memory:%zu\\r\\n\"\n            \"used_memory_human:%s\\r\\n\"\n            \"used_memory_rss:%zu\\r\\n\"\n            \"used_memory_peak:%zu\\r\\n\"\n            \"used_memory_peak_human:%s\\r\\n\"\n            \"used_memory_lua:%lld\\r\\n\"\n            \"mem_fragmentation_ratio:%.2f\\r\\n\"\n            \"mem_allocator:%s\\r\\n\",\n            zmalloc_used,\n            hmem,\n            zmalloc_get_rss(),\n            server.stat_peak_memory,\n            peak_hmem,\n            ((long long)lua_gc(server.lua,LUA_GCCOUNT,0))*1024LL,\n            zmalloc_get_fragmentation_ratio(),\n            ZMALLOC_LIB\n            )",
          "old_line_content": "            \"used_memory_peak:%zu\\r\\n\"",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 2931,
          "old_api": null,
          "new_api": "fgets",
          "old_text": null,
          "new_text": "fgets(buf,64,fp)",
          "old_line_content": "",
          "new_line_content": "    if (fgets(buf,64,fp) == NULL) {",
          "content_same": false
        },
        {
          "line": 2935,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(fp)",
          "old_line_content": "void linuxOvercommitMemoryWarning(void) {",
          "new_line_content": "    fclose(fp);",
          "content_same": false
        },
        {
          "line": 2941,
          "old_api": null,
          "new_api": "linuxOvercommitMemoryValue",
          "old_text": null,
          "new_text": "linuxOvercommitMemoryValue()",
          "old_line_content": "",
          "new_line_content": "    if (linuxOvercommitMemoryValue() == 0) {",
          "content_same": false
        },
        {
          "line": 2942,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.\")",
          "old_line_content": "void createPidFile(void) {",
          "new_line_content": "        redisLog(REDIS_WARNING,\"WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.\");",
          "content_same": false
        },
        {
          "line": 2431,
          "old_api": null,
          "new_api": "zmalloc_get_rss",
          "old_text": null,
          "new_text": "zmalloc_get_rss()",
          "old_line_content": "            ZMALLOC_LIB",
          "new_line_content": "            zmalloc_get_rss(),",
          "content_same": false
        },
        {
          "line": 2434,
          "old_api": null,
          "new_api": "lua_gc",
          "old_text": null,
          "new_text": "lua_gc(server.lua,LUA_GCCOUNT,0)",
          "old_line_content": "",
          "new_line_content": "            ((long long)lua_gc(server.lua,LUA_GCCOUNT,0))*1024LL,",
          "content_same": false
        },
        {
          "line": 2435,
          "old_api": null,
          "new_api": "zmalloc_get_fragmentation_ratio",
          "old_text": null,
          "new_text": "zmalloc_get_fragmentation_ratio()",
          "old_line_content": "    /* Persistence */",
          "new_line_content": "            zmalloc_get_fragmentation_ratio(),",
          "content_same": false
        },
        {
          "line": 2949,
          "old_api": null,
          "new_api": "fopen",
          "old_text": null,
          "new_text": "fopen(server.pidfile,\"w\")",
          "old_line_content": "}",
          "new_line_content": "    FILE *fp = fopen(server.pidfile,\"w\");",
          "content_same": false
        },
        {
          "line": 2951,
          "old_api": null,
          "new_api": "getpid",
          "old_text": null,
          "new_text": "getpid()",
          "old_line_content": "void daemonize(void) {",
          "new_line_content": "        fprintf(fp,\"%d\\n\",(int)getpid());",
          "content_same": false
        },
        {
          "line": 2952,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(fp)",
          "old_line_content": "    int fd;",
          "new_line_content": "        fclose(fp);",
          "content_same": false
        },
        {
          "line": 2441,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"persistence\")",
          "old_line_content": "            \"rdb_changes_since_last_save:%lld\\r\\n\"",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"persistence\")) {",
          "content_same": false
        },
        {
          "line": 2442,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "            \"rdb_bgsave_in_progress:%d\\r\\n\"",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 2443,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"# Persistence\\r\\n\"\n            \"loading:%d\\r\\n\"\n            \"rdb_changes_since_last_save:%lld\\r\\n\"\n            \"rdb_bgsave_in_progress:%d\\r\\n\"\n            \"rdb_last_save_time:%jd\\r\\n\"\n            \"rdb_last_bgsave_status:%s\\r\\n\"\n            \"rdb_last_bgsave_time_sec:%jd\\r\\n\"\n            \"rdb_current_bgsave_time_sec:%jd\\r\\n\"\n            \"aof_enabled:%d\\r\\n\"\n            \"aof_rewrite_in_progress:%d\\r\\n\"\n            \"aof_rewrite_scheduled:%d\\r\\n\"\n            \"aof_last_rewrite_time_sec:%jd\\r\\n\"\n            \"aof_current_rewrite_time_sec:%jd\\r\\n\"\n            \"aof_last_bgrewrite_status:%s\\r\\n\"\n            \"aof_last_write_status:%s\\r\\n\",\n            server.loading,\n            server.dirty,\n            server.rdb_child_pid != -1,\n            (intmax_t)server.lastsave,\n            (server.lastbgsave_status == REDIS_OK) ? \"ok\" : \"err\",\n            (intmax_t)server.rdb_save_time_last,\n            (intmax_t)((server.rdb_child_pid == -1) ?\n                -1 : time(NULL)-server.rdb_save_time_start),\n            server.aof_state != REDIS_AOF_OFF,\n            server.aof_child_pid != -1,\n            server.aof_rewrite_scheduled,\n            (intmax_t)server.aof_rewrite_time_last,\n            (intmax_t)((server.aof_child_pid == -1) ?\n                -1 : time(NULL)-server.aof_rewrite_time_start),\n            (server.aof_lastbgrewrite_status == REDIS_OK) ? \"ok\" : \"err\",\n            (server.aof_last_write_status == REDIS_OK) ? \"ok\" : \"err\")",
          "old_line_content": "            \"rdb_last_save_time:%jd\\r\\n\"",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 2959,
          "old_api": null,
          "new_api": "exit",
          "old_text": null,
          "new_text": "exit(0)",
          "old_line_content": "     * it will not log at all. */",
          "new_line_content": "    if (fork() != 0) exit(0); /* parent exits */",
          "content_same": false
        },
        {
          "line": 2965,
          "old_api": null,
          "new_api": "open",
          "old_text": null,
          "new_text": "open(\"/dev/null\", O_RDWR, 0)",
          "old_line_content": "    }",
          "new_line_content": "    if ((fd = open(\"/dev/null\", O_RDWR, 0)) != -1) {",
          "content_same": false
        },
        {
          "line": 2966,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(fd, STDIN_FILENO)",
          "old_line_content": "}",
          "new_line_content": "        dup2(fd, STDIN_FILENO);",
          "content_same": false
        },
        {
          "line": 2967,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(fd, STDOUT_FILENO)",
          "old_line_content": "",
          "new_line_content": "        dup2(fd, STDOUT_FILENO);",
          "content_same": false
        },
        {
          "line": 2968,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(fd, STDERR_FILENO)",
          "old_line_content": "void version() {",
          "new_line_content": "        dup2(fd, STDERR_FILENO);",
          "content_same": false
        },
        {
          "line": 2974,
          "old_api": null,
          "new_api": "printf",
          "old_text": null,
          "new_text": "printf(\"Redis server v=%s sha=%s:%d malloc=%s bits=%d build=%llx\\n\",\n        REDIS_VERSION,\n        redisGitSHA1(),\n        atoi(redisGitDirty()) > 0,\n        ZMALLOC_LIB,\n        sizeof(long) == 4 ? 32 : 64,\n        (unsigned long long) redisBuildId())",
          "old_line_content": "        sizeof(long) == 4 ? 32 : 64,",
          "new_line_content": "    printf(\"Redis server v=%s sha=%s:%d malloc=%s bits=%d build=%llx\\n\",",
          "content_same": false
        },
        {
          "line": 2465,
          "old_api": null,
          "new_api": "intmax_t)((server.rdb_child_pid == -1) ?\n                -1 : time(NULL)-server.rdb_save_time_start)",
          "old_text": null,
          "new_text": "intmax_t)((server.rdb_child_pid == -1) ?\n                -1 : time(NULL)-server.rdb_save_time_start)",
          "old_line_content": "            (intmax_t)server.aof_rewrite_time_last,",
          "new_line_content": "            (intmax_t)((server.rdb_child_pid == -1) ?",
          "content_same": false
        },
        {
          "line": 2977,
          "old_api": null,
          "new_api": "redisGitDirty",
          "old_text": null,
          "new_text": "redisGitDirty()",
          "old_line_content": "}",
          "new_line_content": "        atoi(redisGitDirty()) > 0,",
          "content_same": false
        },
        {
          "line": 2471,
          "old_api": null,
          "new_api": "intmax_t)((server.aof_child_pid == -1) ?\n                -1 : time(NULL)-server.aof_rewrite_time_start)",
          "old_text": null,
          "new_text": "intmax_t)((server.aof_child_pid == -1) ?\n                -1 : time(NULL)-server.aof_rewrite_time_start)",
          "old_line_content": "        if (server.aof_state != REDIS_AOF_OFF) {",
          "new_line_content": "            (intmax_t)((server.aof_child_pid == -1) ?",
          "content_same": false
        },
        {
          "line": 2477,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                \"aof_current_size:%lld\\r\\n\"\n                \"aof_base_size:%lld\\r\\n\"\n                \"aof_pending_rewrite:%d\\r\\n\"\n                \"aof_buffer_length:%zu\\r\\n\"\n                \"aof_rewrite_buffer_length:%lu\\r\\n\"\n                \"aof_pending_bio_fsync:%llu\\r\\n\"\n                \"aof_delayed_fsync:%lu\\r\\n\",\n                (long long) server.aof_current_size,\n                (long long) server.aof_rewrite_base_size,\n                server.aof_rewrite_scheduled,\n                sdslen(server.aof_buf),\n                aofRewriteBufferSize(),\n                bioPendingJobsOfType(REDIS_BIO_AOF_FSYNC),\n                server.aof_delayed_fsync)",
          "old_line_content": "                \"aof_rewrite_buffer_length:%lu\\r\\n\"",
          "new_line_content": "            info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 2994,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr,\"       ./redis-server --port 7777 --slaveof 127.0.0.1 8888\\n\")",
          "old_line_content": "}",
          "new_line_content": "    fprintf(stderr,\"       ./redis-server --port 7777 --slaveof 127.0.0.1 8888\\n\");",
          "content_same": false
        },
        {
          "line": 2995,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr,\"       ./redis-server /etc/myredis.conf --loglevel verbose\\n\\n\")",
          "old_line_content": "",
          "new_line_content": "    fprintf(stderr,\"       ./redis-server /etc/myredis.conf --loglevel verbose\\n\\n\");",
          "content_same": false
        },
        {
          "line": 2996,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr,\"Sentinel mode:\\n\")",
          "old_line_content": "void redisAsciiArt(void) {",
          "new_line_content": "    fprintf(stderr,\"Sentinel mode:\\n\");",
          "content_same": false
        },
        {
          "line": 2997,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr,\"       ./redis-server /etc/sentinel.conf --sentinel\\n\")",
          "old_line_content": "#include \"asciilogo.h\"",
          "new_line_content": "    fprintf(stderr,\"       ./redis-server /etc/sentinel.conf --sentinel\\n\");",
          "content_same": false
        },
        {
          "line": 2488,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(server.aof_buf)",
          "old_line_content": "",
          "new_line_content": "                sdslen(server.aof_buf),",
          "content_same": false
        },
        {
          "line": 2489,
          "old_api": null,
          "new_api": "aofRewriteBufferSize",
          "old_text": null,
          "new_text": "aofRewriteBufferSize()",
          "old_line_content": "        if (server.loading) {",
          "new_line_content": "                aofRewriteBufferSize(),",
          "content_same": false
        },
        {
          "line": 2490,
          "old_api": null,
          "new_api": "bioPendingJobsOfType",
          "old_text": null,
          "new_text": "bioPendingJobsOfType(REDIS_BIO_AOF_FSYNC)",
          "old_line_content": "            double perc;",
          "new_line_content": "                bioPendingJobsOfType(REDIS_BIO_AOF_FSYNC),",
          "content_same": false
        },
        {
          "line": 3003,
          "old_api": null,
          "new_api": "zmalloc",
          "old_text": null,
          "new_text": "zmalloc(1024*16)",
          "old_line_content": "",
          "new_line_content": "    char *buf = zmalloc(1024*16);",
          "content_same": false
        },
        {
          "line": 3009,
          "old_api": null,
          "new_api": "snprintf",
          "old_text": null,
          "new_text": "snprintf(buf,1024*16,ascii_logo,\n        REDIS_VERSION,\n        redisGitSHA1(),\n        strtol(redisGitDirty(),NULL,10) > 0,\n        (sizeof(long) == 8) ? \"64\" : \"32\",\n        mode, server.port,\n        (long) getpid()\n    )",
          "old_line_content": "        mode, server.port,",
          "new_line_content": "    snprintf(buf,1024*16,ascii_logo,",
          "content_same": false
        },
        {
          "line": 3011,
          "old_api": null,
          "new_api": "redisGitSHA1",
          "old_text": null,
          "new_text": "redisGitSHA1()",
          "old_line_content": "    );",
          "new_line_content": "        redisGitSHA1(),",
          "content_same": false
        },
        {
          "line": 3015,
          "old_api": null,
          "new_api": "getpid",
          "old_text": null,
          "new_text": "getpid()",
          "old_line_content": "",
          "new_line_content": "        (long) getpid()",
          "content_same": false
        },
        {
          "line": 3018,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(buf)",
          "old_line_content": "",
          "new_line_content": "    zfree(buf);",
          "content_same": false
        },
        {
          "line": 3022,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(sig)",
          "old_line_content": "",
          "new_line_content": "    REDIS_NOTUSED(sig);",
          "content_same": false
        },
        {
          "line": 2511,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                \"loading_start_time:%jd\\r\\n\"\n                \"loading_total_bytes:%llu\\r\\n\"\n                \"loading_loaded_bytes:%llu\\r\\n\"\n                \"loading_loaded_perc:%.2f\\r\\n\"\n                \"loading_eta_seconds:%jd\\r\\n\",\n                (intmax_t) server.loading_start_time,\n                (unsigned long long) server.loading_total_bytes,\n                (unsigned long long) server.loading_loaded_bytes,\n                perc,\n                (intmax_t)eta\n            )",
          "old_line_content": "                \"loading_eta_seconds:%jd\\r\\n\",",
          "new_line_content": "            info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 3024,
          "old_api": null,
          "new_api": "redisLogFromHandler",
          "old_text": null,
          "new_text": "redisLogFromHandler(REDIS_WARNING,\"Received SIGTERM, scheduling shutdown...\")",
          "old_line_content": "    struct sigaction act;",
          "new_line_content": "    redisLogFromHandler(REDIS_WARNING,\"Received SIGTERM, scheduling shutdown...\");",
          "content_same": false
        },
        {
          "line": 3033,
          "old_api": null,
          "new_api": "sigemptyset",
          "old_text": null,
          "new_text": "sigemptyset(&act.sa_mask)",
          "old_line_content": "#ifdef HAVE_BACKTRACE",
          "new_line_content": "    sigemptyset(&act.sa_mask);",
          "content_same": false
        },
        {
          "line": 3036,
          "old_api": null,
          "new_api": "sigaction",
          "old_text": null,
          "new_text": "sigaction(SIGTERM, &act, NULL)",
          "old_line_content": "    act.sa_sigaction = sigsegvHandler;",
          "new_line_content": "    sigaction(SIGTERM, &act, NULL);",
          "content_same": false
        },
        {
          "line": 2527,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"stats\")",
          "old_line_content": "            \"total_commands_processed:%lld\\r\\n\"",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"stats\")) {",
          "content_same": false
        },
        {
          "line": 2528,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "            \"instantaneous_ops_per_sec:%lld\\r\\n\"",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 2529,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"# Stats\\r\\n\"\n            \"total_connections_received:%lld\\r\\n\"\n            \"total_commands_processed:%lld\\r\\n\"\n            \"instantaneous_ops_per_sec:%lld\\r\\n\"\n            \"rejected_connections:%lld\\r\\n\"\n            \"sync_full:%lld\\r\\n\"\n            \"sync_partial_ok:%lld\\r\\n\"\n            \"sync_partial_err:%lld\\r\\n\"\n            \"expired_keys:%lld\\r\\n\"\n            \"evicted_keys:%lld\\r\\n\"\n            \"keyspace_hits:%lld\\r\\n\"\n            \"keyspace_misses:%lld\\r\\n\"\n            \"pubsub_channels:%ld\\r\\n\"\n            \"pubsub_patterns:%lu\\r\\n\"\n            \"latest_fork_usec:%lld\\r\\n\"\n            \"migrate_cached_sockets:%ld\\r\\n\",\n            server.stat_numconnections,\n            server.stat_numcommands,\n            getOperationsPerSecond(),\n            server.stat_rejected_conn,\n            server.stat_sync_full,\n            server.stat_sync_partial_ok,\n            server.stat_sync_partial_err,\n            server.stat_expiredkeys,\n            server.stat_evictedkeys,\n            server.stat_keyspace_hits,\n            server.stat_keyspace_misses,\n            dictSize(server.pubsub_channels),\n            listLength(server.pubsub_patterns),\n            server.stat_fork_time,\n            dictSize(server.migrate_cached_sockets))",
          "old_line_content": "            \"rejected_connections:%lld\\r\\n\"",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 3042,
          "old_api": null,
          "new_api": "sigaction",
          "old_text": null,
          "new_text": "sigaction(SIGSEGV, &act, NULL)",
          "old_line_content": "    return;",
          "new_line_content": "    sigaction(SIGSEGV, &act, NULL);",
          "content_same": false
        },
        {
          "line": 3043,
          "old_api": null,
          "new_api": "sigaction",
          "old_text": null,
          "new_text": "sigaction(SIGBUS, &act, NULL)",
          "old_line_content": "}",
          "new_line_content": "    sigaction(SIGBUS, &act, NULL);",
          "content_same": false
        },
        {
          "line": 3044,
          "old_api": null,
          "new_api": "sigaction",
          "old_text": null,
          "new_text": "sigaction(SIGFPE, &act, NULL)",
          "old_line_content": "",
          "new_line_content": "    sigaction(SIGFPE, &act, NULL);",
          "content_same": false
        },
        {
          "line": 3045,
          "old_api": null,
          "new_api": "sigaction",
          "old_text": null,
          "new_text": "sigaction(SIGILL, &act, NULL)",
          "old_line_content": "void memtest(size_t megabytes, int passes);",
          "new_line_content": "    sigaction(SIGILL, &act, NULL);",
          "content_same": false
        },
        {
          "line": 3057,
          "old_api": null,
          "new_api": "strstr",
          "old_text": null,
          "new_text": "strstr(argv[0],\"redis-sentinel\")",
          "old_line_content": "",
          "new_line_content": "    if (strstr(argv[0],\"redis-sentinel\") != NULL) return 1;",
          "content_same": false
        },
        {
          "line": 3059,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(argv[j],\"--sentinel\")",
          "old_line_content": "void loadDataFromDisk(void) {",
          "new_line_content": "        if (!strcmp(argv[j],\"--sentinel\")) return 1;",
          "content_same": false
        },
        {
          "line": 2548,
          "old_api": null,
          "new_api": "getOperationsPerSecond",
          "old_text": null,
          "new_text": "getOperationsPerSecond()",
          "old_line_content": "            server.stat_expiredkeys,",
          "new_line_content": "            getOperationsPerSecond(),",
          "content_same": false
        },
        {
          "line": 3068,
          "old_api": null,
          "new_api": "ustime",
          "old_text": null,
          "new_text": "ustime()",
          "old_line_content": "        } else if (errno != ENOENT) {",
          "new_line_content": "            redisLog(REDIS_NOTICE,\"DB loaded from append only file: %.3f seconds\",(float)(ustime()-start)/1000000);",
          "content_same": false
        },
        {
          "line": 2557,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(server.pubsub_channels)",
          "old_line_content": "",
          "new_line_content": "            dictSize(server.pubsub_channels),",
          "content_same": false
        },
        {
          "line": 2558,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(server.pubsub_patterns)",
          "old_line_content": "    /* Replication */",
          "new_line_content": "            listLength(server.pubsub_patterns),",
          "content_same": false
        },
        {
          "line": 3071,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_NOTICE,\"DB loaded from disk: %.3f seconds\",\n                (float)(ustime()-start)/1000000)",
          "old_line_content": "        }",
          "new_line_content": "            redisLog(REDIS_NOTICE,\"DB loaded from disk: %.3f seconds\",",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 2561,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"# Replication\\r\\n\"\n            \"role:%s\\r\\n\",\n            server.masterhost == NULL ? \"master\" : \"slave\")",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3076,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"Out Of Memory allocating %zu bytes!\",\n        allocation_size)",
          "new_text": null,
          "old_line_content": "    redisLog(REDIS_WARNING,\"Out Of Memory allocating %zu bytes!\",",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3078,
          "old_api": "redisPanic",
          "new_api": null,
          "old_text": "redisPanic(\"Redis aborting for OUT OF MEMORY\")",
          "new_text": null,
          "old_line_content": "    redisPanic(\"Redis aborting for OUT OF MEMORY\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2573,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                \"master_host:%s\\r\\n\"\n                \"master_port:%d\\r\\n\"\n                \"master_link_status:%s\\r\\n\"\n                \"master_last_io_seconds_ago:%d\\r\\n\"\n                \"master_sync_in_progress:%d\\r\\n\"\n                \"slave_repl_offset:%lld\\r\\n\"\n                ,server.masterhost,\n                server.masterport,\n                (server.repl_state == REDIS_REPL_CONNECTED) ?\n                    \"up\" : \"down\",\n                server.master ?\n                ((int)(server.unixtime-server.master->lastinteraction)) : -1,\n                server.repl_state == REDIS_REPL_TRANSFER,\n                slave_repl_offset\n            )",
          "new_text": null,
          "old_line_content": "            info = sdscatprintf(info,",
          "new_line_content": "            if (server.master)",
          "content_same": false
        },
        {
          "line": 3087,
          "old_api": "setproctitle",
          "new_api": null,
          "old_text": "setproctitle(\"%s %s:%d%s\",\n        title,\n        server.bindaddr_count ? server.bindaddr[0] : \"*\",\n        server.port,\n        server_mode)",
          "new_text": null,
          "old_line_content": "    setproctitle(\"%s %s:%d%s\",",
          "new_line_content": "#ifdef USE_SETPROCTITLE",
          "content_same": false
        },
        {
          "line": 3093,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(title)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(title);",
          "new_line_content": "        title,",
          "content_same": false
        },
        {
          "line": 3102,
          "old_api": "spt_init",
          "new_api": null,
          "old_text": "spt_init(argc, argv)",
          "new_text": null,
          "old_line_content": "    spt_init(argc, argv);",
          "new_line_content": "int main(int argc, char **argv) {",
          "content_same": false
        },
        {
          "line": 2591,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                    \"master_sync_left_bytes:%lld\\r\\n\"\n                    \"master_sync_last_io_seconds_ago:%d\\r\\n\"\n                    , (long long)\n                        (server.repl_transfer_size - server.repl_transfer_read),\n                    (int)(server.unixtime-server.repl_transfer_lastio)\n                )",
          "new_text": null,
          "old_line_content": "                info = sdscatprintf(info,",
          "new_line_content": "                server.repl_state == REDIS_REPL_TRANSFER,",
          "content_same": false
        },
        {
          "line": 3104,
          "old_api": "setlocale",
          "new_api": null,
          "old_text": "setlocale(LC_COLLATE,\"\")",
          "new_text": null,
          "old_line_content": "    setlocale(LC_COLLATE,\"\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3105,
          "old_api": "zmalloc_enable_thread_safeness",
          "new_api": null,
          "old_text": "zmalloc_enable_thread_safeness()",
          "new_text": null,
          "old_line_content": "    zmalloc_enable_thread_safeness();",
          "new_line_content": "    /* We need to initialize our libraries, and the server configuration. */",
          "content_same": false
        },
        {
          "line": 3106,
          "old_api": "zmalloc_set_oom_handler",
          "new_api": null,
          "old_text": "zmalloc_set_oom_handler(redisOutOfMemoryHandler)",
          "new_text": null,
          "old_line_content": "    zmalloc_set_oom_handler(redisOutOfMemoryHandler);",
          "new_line_content": "#ifdef INIT_SETPROCTITLE_REPLACEMENT",
          "content_same": false
        },
        {
          "line": 3108,
          "old_api": "gettimeofday",
          "new_api": null,
          "old_text": "gettimeofday(&tv,NULL)",
          "new_text": null,
          "old_line_content": "    gettimeofday(&tv,NULL);",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 2601,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                    \"master_link_down_since_seconds:%jd\\r\\n\",\n                    (intmax_t)server.unixtime-server.repl_down_since)",
          "new_text": null,
          "old_line_content": "                info = sdscatprintf(info,",
          "new_line_content": "                    (int)(server.unixtime-server.repl_transfer_lastio)",
          "content_same": false
        },
        {
          "line": 2605,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                \"slave_priority:%d\\r\\n\"\n                \"slave_read_only:%d\\r\\n\",\n                server.slave_priority,\n                server.repl_slave_ro)",
          "new_text": null,
          "old_line_content": "            info = sdscatprintf(info,",
          "new_line_content": "            if (server.repl_state != REDIS_REPL_CONNECTED) {",
          "content_same": false
        },
        {
          "line": 3117,
          "old_api": "initSentinelConfig",
          "new_api": null,
          "old_text": "initSentinelConfig()",
          "new_text": null,
          "old_line_content": "        initSentinelConfig();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3118,
          "old_api": "initSentinel",
          "new_api": null,
          "old_text": "initSentinel()",
          "new_text": null,
          "old_line_content": "        initSentinel();",
          "new_line_content": "    /* We need to init sentinel right now as parsing the configuration file",
          "content_same": false
        },
        {
          "line": 2612,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"connected_slaves:%lu\\r\\n\",\n            listLength(server.slaves))",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "                \"slave_read_only:%d\\r\\n\",",
          "content_same": false
        },
        {
          "line": 2614,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(server.slaves)",
          "new_text": null,
          "old_line_content": "            listLength(server.slaves));",
          "new_line_content": "                server.repl_slave_ro);",
          "content_same": false
        },
        {
          "line": 3127,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(argv[1], \"-v\")",
          "new_text": null,
          "old_line_content": "        if (strcmp(argv[1], \"-v\") == 0 ||",
          "new_line_content": "        int j = 1; /* First option to parse in argv[] */",
          "content_same": false
        },
        {
          "line": 3129,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(argv[1], \"--help\")",
          "new_text": null,
          "old_line_content": "        if (strcmp(argv[1], \"--help\") == 0 ||",
          "new_line_content": "        char *configfile = NULL;",
          "content_same": false
        },
        {
          "line": 3130,
          "old_api": "usage",
          "new_api": null,
          "old_text": "usage()",
          "new_text": null,
          "old_line_content": "            strcmp(argv[1], \"-h\") == 0) usage();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3131,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(argv[1], \"--test-memory\")",
          "new_text": null,
          "old_line_content": "        if (strcmp(argv[1], \"--test-memory\") == 0) {",
          "new_line_content": "        /* Handle special options --help and --version */",
          "content_same": false
        },
        {
          "line": 2620,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                \"min_slaves_good_slaves:%d\\r\\n\",\n                server.repl_good_slaves_count)",
          "new_text": null,
          "old_line_content": "            info = sdscatprintf(info,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3137,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr,\"Example: ./redis-server --test-memory 4096\\n\\n\")",
          "new_text": null,
          "old_line_content": "                fprintf(stderr,\"Example: ./redis-server --test-memory 4096\\n\\n\");",
          "new_line_content": "            if (argc == 3) {",
          "content_same": false
        },
        {
          "line": 2631,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "            while((ln = listNext(&li))) {",
          "new_line_content": "            int slaveid = 0;",
          "content_same": false
        },
        {
          "line": 2632,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "                redisClient *slave = listNodeValue(ln);",
          "new_line_content": "            listNode *ln;",
          "content_same": false
        },
        {
          "line": 2638,
          "old_api": "anetPeerToString",
          "new_api": null,
          "old_text": "anetPeerToString(slave->fd,ip,sizeof(ip),&port)",
          "new_text": null,
          "old_line_content": "                if (anetPeerToString(slave->fd,ip,sizeof(ip),&port) == -1) continue;",
          "new_line_content": "                char *state = NULL;",
          "content_same": false
        },
        {
          "line": 3152,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(options,\"\\n\")",
          "new_text": null,
          "old_line_content": "                if (sdslen(options)) options = sdscat(options,\"\\n\");",
          "new_line_content": "         * string \"port 6380\\n\" to be parsed after the actual file name",
          "content_same": false
        },
        {
          "line": 3153,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(options,argv[j]+2)",
          "new_text": null,
          "old_line_content": "                options = sdscat(options,argv[j]+2);",
          "new_line_content": "         * is parsed, if any. */",
          "content_same": false
        },
        {
          "line": 3154,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(options,\" \")",
          "new_text": null,
          "old_line_content": "                options = sdscat(options,\" \");",
          "new_line_content": "        while(j != argc) {",
          "content_same": false
        },
        {
          "line": 3164,
          "old_api": "loadServerConfig",
          "new_api": null,
          "old_text": "loadServerConfig(configfile,options)",
          "new_text": null,
          "old_line_content": "        loadServerConfig(configfile,options);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2653,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "                    lag = time(NULL) - slave->repl_ack_time;",
          "new_line_content": "                    state = \"online\";",
          "content_same": false
        },
        {
          "line": 3165,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(options)",
          "new_text": null,
          "old_line_content": "        sdsfree(options);",
          "new_line_content": "            j++;",
          "content_same": false
        },
        {
          "line": 2655,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                    \"slave%d:ip=%s,port=%d,state=%s,\"\n                    \"offset=%lld,lag=%ld\\r\\n\",\n                    slaveid,ip,slave->slave_listening_port,state,\n                    slave->repl_ack_off, lag)",
          "new_text": null,
          "old_line_content": "                info = sdscatprintf(info,",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 3171,
          "old_api": "createPidFile",
          "new_api": null,
          "old_text": "createPidFile()",
          "new_text": null,
          "old_line_content": "    if (server.daemonize) createPidFile();",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 3173,
          "old_api": "redisAsciiArt",
          "new_api": null,
          "old_text": "redisAsciiArt()",
          "new_text": null,
          "old_line_content": "    redisAsciiArt();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2663,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"master_repl_offset:%lld\\r\\n\"\n            \"repl_backlog_active:%d\\r\\n\"\n            \"repl_backlog_size:%lld\\r\\n\"\n            \"repl_backlog_first_byte_offset:%lld\\r\\n\"\n            \"repl_backlog_histlen:%lld\\r\\n\",\n            server.master_repl_offset,\n            server.repl_backlog != NULL,\n            server.repl_backlog_size,\n            server.repl_backlog_off,\n            server.repl_backlog_histlen)",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "                    slaveid,ip,slave->slave_listening_port,state,",
          "content_same": false
        },
        {
          "line": 3179,
          "old_api": "linuxOvercommitMemoryWarning",
          "new_api": null,
          "old_text": "linuxOvercommitMemoryWarning()",
          "new_text": null,
          "old_line_content": "        linuxOvercommitMemoryWarning();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3181,
          "old_api": "loadDataFromDisk",
          "new_api": null,
          "old_text": "loadDataFromDisk()",
          "new_text": null,
          "old_line_content": "        loadDataFromDisk();",
          "new_line_content": "        /* Things not needed when running in Sentinel mode. */",
          "content_same": false
        },
        {
          "line": 3183,
          "old_api": "verifyClusterConfigWithData",
          "new_api": null,
          "old_text": "verifyClusterConfigWithData()",
          "new_text": null,
          "old_line_content": "            if (verifyClusterConfigWithData() == REDIS_ERR) {",
          "new_line_content": "    #ifdef __linux__",
          "content_same": false
        },
        {
          "line": 3187,
          "old_api": "exit",
          "new_api": null,
          "old_text": "exit(1)",
          "new_text": null,
          "old_line_content": "                exit(1);",
          "new_line_content": "        if (server.cluster_enabled) {",
          "content_same": false
        },
        {
          "line": 2677,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"cpu\")",
          "new_text": null,
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"cpu\")) {",
          "new_line_content": "            server.repl_backlog_off,",
          "content_same": false
        },
        {
          "line": 2678,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "            server.repl_backlog_histlen);",
          "content_same": false
        },
        {
          "line": 2679,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n        \"# CPU\\r\\n\"\n        \"used_cpu_sys:%.2f\\r\\n\"\n        \"used_cpu_user:%.2f\\r\\n\"\n        \"used_cpu_sys_children:%.2f\\r\\n\"\n        \"used_cpu_user_children:%.2f\\r\\n\",\n        (float)self_ru.ru_stime.tv_sec+(float)self_ru.ru_stime.tv_usec/1000000,\n        (float)self_ru.ru_utime.tv_sec+(float)self_ru.ru_utime.tv_usec/1000000,\n        (float)c_ru.ru_stime.tv_sec+(float)c_ru.ru_stime.tv_usec/1000000,\n        (float)c_ru.ru_utime.tv_sec+(float)c_ru.ru_utime.tv_usec/1000000)",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3191,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_NOTICE,\"The server is now ready to accept connections on port %d\", server.port)",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_NOTICE,\"The server is now ready to accept connections on port %d\", server.port);",
          "new_line_content": "                    \"Cluster mode. Exiting.\");",
          "content_same": false
        },
        {
          "line": 3193,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_NOTICE,\"The server is now ready to accept connections at %s\", server.unixsocket)",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_NOTICE,\"The server is now ready to accept connections at %s\", server.unixsocket);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 3195,
          "old_api": "sentinelIsRunning",
          "new_api": null,
          "old_text": "sentinelIsRunning()",
          "new_text": null,
          "old_line_content": "        sentinelIsRunning();",
          "new_line_content": "        if (server.ipfd_count > 0)",
          "content_same": false
        },
        {
          "line": 3203,
          "old_api": "aeSetBeforeSleepProc",
          "new_api": null,
          "old_text": "aeSetBeforeSleepProc(server.el,beforeSleep)",
          "new_text": null,
          "old_line_content": "    aeSetBeforeSleepProc(server.el,beforeSleep);",
          "new_line_content": "    /* Warning the user about suspicious maxmemory setting. */",
          "content_same": false
        },
        {
          "line": 2692,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"commandstats\")",
          "new_text": null,
          "old_line_content": "    if (allsections || !strcasecmp(section,\"commandstats\")) {",
          "new_line_content": "        (float)c_ru.ru_stime.tv_sec+(float)c_ru.ru_stime.tv_usec/1000000,",
          "content_same": false
        },
        {
          "line": 2693,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "        (float)c_ru.ru_utime.tv_sec+(float)c_ru.ru_utime.tv_usec/1000000);",
          "content_same": false
        },
        {
          "line": 2694,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info, \"# Commandstats\\r\\n\")",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info, \"# Commandstats\\r\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3204,
          "old_api": "aeMain",
          "new_api": null,
          "old_text": "aeMain(server.el)",
          "new_text": null,
          "old_line_content": "    aeMain(server.el);",
          "new_line_content": "    if (server.maxmemory > 0 && server.maxmemory < 1024*1024) {",
          "content_same": false
        },
        {
          "line": 2700,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                \"cmdstat_%s:calls=%lld,usec=%lld,usec_per_call=%.2f\\r\\n\",\n                c->name, c->calls, c->microseconds,\n                (c->calls == 0) ? 0 : ((float)c->microseconds/c->calls))",
          "new_text": null,
          "old_line_content": "            info = sdscatprintf(info,",
          "new_line_content": "        numcommands = sizeof(redisCommandTable)/sizeof(struct redisCommand);",
          "content_same": false
        },
        {
          "line": 2708,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"cluster\")",
          "new_text": null,
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"cluster\")) {",
          "new_line_content": "                (c->calls == 0) ? 0 : ((float)c->microseconds/c->calls));",
          "content_same": false
        },
        {
          "line": 2709,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2710,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n        \"# Cluster\\r\\n\"\n        \"cluster_enabled:%d\\r\\n\",\n        server.cluster_enabled)",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2717,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"keyspace\")",
          "new_text": null,
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"keyspace\")) {",
          "new_line_content": "        \"cluster_enabled:%d\\r\\n\",",
          "content_same": false
        },
        {
          "line": 2718,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "        server.cluster_enabled);",
          "content_same": false
        },
        {
          "line": 2719,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info, \"# Keyspace\\r\\n\")",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info, \"# Keyspace\\r\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2726,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                    \"db%d:keys=%lld,expires=%lld,avg_ttl=%lld\\r\\n\",\n                    j, keys, vkeys, server.db[j].avg_ttl)",
          "new_text": null,
          "old_line_content": "                info = sdscatprintf(info,",
          "new_line_content": "            long long keys, vkeys;",
          "content_same": false
        },
        {
          "line": 2739,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.syntaxerr)",
          "new_text": null,
          "old_line_content": "        addReply(c,shared.syntaxerr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2742,
          "old_api": "genRedisInfoString",
          "new_api": null,
          "old_text": "genRedisInfoString(section)",
          "new_text": null,
          "old_line_content": "    sds info = genRedisInfoString(section);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2743,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "    addReplySds(c,sdscatprintf(sdsempty(),\"$%lu\\r\\n\",",
          "new_line_content": "    if (c->argc > 2) {",
          "content_same": false
        },
        {
          "line": 2745,
          "old_api": "addReplySds",
          "new_api": null,
          "old_text": "addReplySds(c,info)",
          "new_text": null,
          "old_line_content": "    addReplySds(c,info);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 2746,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.crlf)",
          "new_text": null,
          "old_line_content": "    addReply(c,shared.crlf);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2754,
          "old_api": "listAddNodeTail",
          "new_api": null,
          "old_text": "listAddNodeTail(server.monitors,c)",
          "new_text": null,
          "old_line_content": "    listAddNodeTail(server.monitors,c);",
          "new_line_content": "void monitorCommand(redisClient *c) {",
          "content_same": false
        },
        {
          "line": 2755,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.ok)",
          "new_text": null,
          "old_line_content": "    addReply(c,shared.ok);",
          "new_line_content": "    /* ignore MONITOR if already slave or in monitor mode */",
          "content_same": false
        },
        {
          "line": 2777,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(server.slaves)",
          "new_text": null,
          "old_line_content": "    int slaves = listLength(server.slaves);",
          "new_line_content": " * should block the execution of commands that will result in more memory",
          "content_same": false
        },
        {
          "line": 2781,
          "old_api": "zmalloc_used_memory",
          "new_api": null,
          "old_text": "zmalloc_used_memory()",
          "new_text": null,
          "old_line_content": "    mem_used = zmalloc_used_memory();",
          "new_line_content": "    size_t mem_used, mem_tofree, mem_freed;",
          "content_same": false
        },
        {
          "line": 2787,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "        while((ln = listNext(&li))) {",
          "new_line_content": "    if (slaves) {",
          "content_same": false
        },
        {
          "line": 2788,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "            redisClient *slave = listNodeValue(ln);",
          "new_line_content": "        listIter li;",
          "content_same": false
        },
        {
          "line": 2789,
          "old_api": "getClientOutputBufferMemoryUsage",
          "new_api": null,
          "old_text": "getClientOutputBufferMemoryUsage(slave)",
          "new_text": null,
          "old_line_content": "            unsigned long obuf_bytes = getClientOutputBufferMemoryUsage(slave);",
          "new_line_content": "        listNode *ln;",
          "content_same": false
        },
        {
          "line": 2797,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(server.aof_buf)",
          "new_text": null,
          "old_line_content": "        mem_used -= sdslen(server.aof_buf);",
          "new_line_content": "            else",
          "content_same": false
        },
        {
          "line": 2798,
          "old_api": "aofRewriteBufferSize",
          "new_api": null,
          "old_text": "aofRewriteBufferSize()",
          "new_text": null,
          "old_line_content": "        mem_used -= aofRewriteBufferSize();",
          "new_line_content": "                mem_used -= obuf_bytes;",
          "content_same": false
        },
        {
          "line": 2827,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(dict)",
          "new_text": null,
          "old_line_content": "            if (dictSize(dict) == 0) continue;",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 2833,
          "old_api": "dictGetRandomKey",
          "new_api": null,
          "old_text": "dictGetRandomKey(dict)",
          "new_text": null,
          "old_line_content": "                de = dictGetRandomKey(dict);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2834,
          "old_api": "dictGetKey",
          "new_api": null,
          "old_text": "dictGetKey(de)",
          "new_text": null,
          "old_line_content": "                bestkey = dictGetKey(de);",
          "new_line_content": "            /* volatile-random and allkeys-random policy */",
          "content_same": false
        },
        {
          "line": 2846,
          "old_api": "dictGetRandomKey",
          "new_api": null,
          "old_text": "dictGetRandomKey(dict)",
          "new_text": null,
          "old_line_content": "                    de = dictGetRandomKey(dict);",
          "new_line_content": "                for (k = 0; k < server.maxmemory_samples; k++) {",
          "content_same": false
        },
        {
          "line": 2847,
          "old_api": "dictGetKey",
          "new_api": null,
          "old_text": "dictGetKey(de)",
          "new_text": null,
          "old_line_content": "                    thiskey = dictGetKey(de);",
          "new_line_content": "                    sds thiskey;",
          "content_same": false
        },
        {
          "line": 2853,
          "old_api": "estimateObjectIdleTime",
          "new_api": null,
          "old_text": "estimateObjectIdleTime(o)",
          "new_text": null,
          "old_line_content": "                    thisval = estimateObjectIdleTime(o);",
          "new_line_content": "                    /* When policy is volatile-lru we need an additional lookup",
          "content_same": false
        },
        {
          "line": 2869,
          "old_api": "dictGetRandomKey",
          "new_api": null,
          "old_text": "dictGetRandomKey(dict)",
          "new_text": null,
          "old_line_content": "                    de = dictGetRandomKey(dict);",
          "new_line_content": "            else if (server.maxmemory_policy == REDIS_MAXMEMORY_VOLATILE_TTL) {",
          "content_same": false
        },
        {
          "line": 2870,
          "old_api": "dictGetKey",
          "new_api": null,
          "old_text": "dictGetKey(de)",
          "new_text": null,
          "old_line_content": "                    thiskey = dictGetKey(de);",
          "new_line_content": "                for (k = 0; k < server.maxmemory_samples; k++) {",
          "content_same": false
        },
        {
          "line": 2871,
          "old_api": "dictGetVal",
          "new_api": null,
          "old_text": "dictGetVal(de)",
          "new_text": null,
          "old_line_content": "                    thisval = (long) dictGetVal(de);",
          "new_line_content": "                    sds thiskey;",
          "content_same": false
        },
        {
          "line": 2886,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(bestkey)",
          "new_text": null,
          "old_line_content": "                robj *keyobj = createStringObject(bestkey,sdslen(bestkey));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2887,
          "old_api": "propagateExpire",
          "new_api": null,
          "old_text": "propagateExpire(db,keyobj)",
          "new_text": null,
          "old_line_content": "                propagateExpire(db,keyobj);",
          "new_line_content": "            /* Finally remove the selected key. */",
          "content_same": false
        },
        {
          "line": 2896,
          "old_api": "zmalloc_used_memory",
          "new_api": null,
          "old_text": "zmalloc_used_memory()",
          "new_text": null,
          "old_line_content": "                delta = (long long) zmalloc_used_memory();",
          "new_line_content": "                 * we are freeing removing the key, but we can't account for",
          "content_same": false
        },
        {
          "line": 2897,
          "old_api": "dbDelete",
          "new_api": null,
          "old_text": "dbDelete(db,keyobj)",
          "new_text": null,
          "old_line_content": "                dbDelete(db,keyobj);",
          "new_line_content": "                 * that otherwise we would never exit the loop.",
          "content_same": false
        },
        {
          "line": 2898,
          "old_api": "zmalloc_used_memory",
          "new_api": null,
          "old_text": "zmalloc_used_memory()",
          "new_text": null,
          "old_line_content": "                delta -= (long long) zmalloc_used_memory();",
          "new_line_content": "                 *",
          "content_same": false
        },
        {
          "line": 2910,
          "old_api": "flushSlavesOutputBuffers",
          "new_api": null,
          "old_text": "flushSlavesOutputBuffers()",
          "new_text": null,
          "old_line_content": "                if (slaves) flushSlavesOutputBuffers();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2922,
          "old_api": "fopen",
          "new_api": null,
          "old_text": "fopen(\"/proc/sys/vm/overcommit_memory\",\"r\")",
          "new_text": null,
          "old_line_content": "    FILE *fp = fopen(\"/proc/sys/vm/overcommit_memory\",\"r\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2411,
          "old_api": "zmalloc_used_memory",
          "new_api": null,
          "old_text": "zmalloc_used_memory()",
          "new_text": null,
          "old_line_content": "        bytesToHuman(hmem,zmalloc_used_memory());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2412,
          "old_api": "bytesToHuman",
          "new_api": null,
          "old_text": "bytesToHuman(peak_hmem,server.stat_peak_memory)",
          "new_text": null,
          "old_line_content": "        bytesToHuman(peak_hmem,server.stat_peak_memory);",
          "new_line_content": "        if (zmalloc_used > server.stat_peak_memory) {",
          "content_same": false
        },
        {
          "line": 2413,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "            server.stat_peak_memory = zmalloc_used;",
          "content_same": false
        },
        {
          "line": 2414,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"# Memory\\r\\n\"\n            \"used_memory:%zu\\r\\n\"\n            \"used_memory_human:%s\\r\\n\"\n            \"used_memory_rss:%zu\\r\\n\"\n            \"used_memory_peak:%zu\\r\\n\"\n            \"used_memory_peak_human:%s\\r\\n\"\n            \"used_memory_lua:%lld\\r\\n\"\n            \"mem_fragmentation_ratio:%.2f\\r\\n\"\n            \"mem_allocator:%s\\r\\n\",\n            zmalloc_used_memory(),\n            hmem,\n            zmalloc_get_rss(),\n            server.stat_peak_memory,\n            peak_hmem,\n            ((long long)lua_gc(server.lua,LUA_GCCOUNT,0))*1024LL,\n            zmalloc_get_fragmentation_ratio(),\n            ZMALLOC_LIB\n            )",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2926,
          "old_api": "fgets",
          "new_api": null,
          "old_text": "fgets(buf,64,fp)",
          "new_text": null,
          "old_line_content": "    if (fgets(buf,64,fp) == NULL) {",
          "new_line_content": "int linuxOvercommitMemoryValue(void) {",
          "content_same": false
        },
        {
          "line": 2930,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(fp)",
          "new_text": null,
          "old_line_content": "    fclose(fp);",
          "new_line_content": "    if (!fp) return -1;",
          "content_same": false
        },
        {
          "line": 2424,
          "old_api": "zmalloc_used_memory",
          "new_api": null,
          "old_text": "zmalloc_used_memory()",
          "new_text": null,
          "old_line_content": "            zmalloc_used_memory(),",
          "new_line_content": "            \"used_memory_peak:%zu\\r\\n\"",
          "content_same": false
        },
        {
          "line": 2936,
          "old_api": "linuxOvercommitMemoryValue",
          "new_api": null,
          "old_text": "linuxOvercommitMemoryValue()",
          "new_text": null,
          "old_line_content": "    if (linuxOvercommitMemoryValue() == 0) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2426,
          "old_api": "zmalloc_get_rss",
          "new_api": null,
          "old_text": "zmalloc_get_rss()",
          "new_text": null,
          "old_line_content": "            zmalloc_get_rss(),",
          "new_line_content": "            \"used_memory_lua:%lld\\r\\n\"",
          "content_same": false
        },
        {
          "line": 2429,
          "old_api": "lua_gc",
          "new_api": null,
          "old_text": "lua_gc(server.lua,LUA_GCCOUNT,0)",
          "new_text": null,
          "old_line_content": "            ((long long)lua_gc(server.lua,LUA_GCCOUNT,0))*1024LL,",
          "new_line_content": "            zmalloc_used,",
          "content_same": false
        },
        {
          "line": 2430,
          "old_api": "zmalloc_get_fragmentation_ratio",
          "new_api": null,
          "old_text": "zmalloc_get_fragmentation_ratio()",
          "new_text": null,
          "old_line_content": "            zmalloc_get_fragmentation_ratio(),",
          "new_line_content": "            hmem,",
          "content_same": false
        },
        {
          "line": 2944,
          "old_api": "fopen",
          "new_api": null,
          "old_text": "fopen(server.pidfile,\"w\")",
          "new_text": null,
          "old_line_content": "    FILE *fp = fopen(server.pidfile,\"w\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2946,
          "old_api": "getpid",
          "new_api": null,
          "old_text": "getpid()",
          "new_text": null,
          "old_line_content": "        fprintf(fp,\"%d\\n\",(int)getpid());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2947,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(fp)",
          "new_text": null,
          "old_line_content": "        fclose(fp);",
          "new_line_content": "void createPidFile(void) {",
          "content_same": false
        },
        {
          "line": 2436,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"persistence\")",
          "new_text": null,
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"persistence\")) {",
          "new_line_content": "            ZMALLOC_LIB",
          "content_same": false
        },
        {
          "line": 2437,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "            );",
          "content_same": false
        },
        {
          "line": 2438,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"# Persistence\\r\\n\"\n            \"loading:%d\\r\\n\"\n            \"rdb_changes_since_last_save:%lld\\r\\n\"\n            \"rdb_bgsave_in_progress:%d\\r\\n\"\n            \"rdb_last_save_time:%jd\\r\\n\"\n            \"rdb_last_bgsave_status:%s\\r\\n\"\n            \"rdb_last_bgsave_time_sec:%jd\\r\\n\"\n            \"rdb_current_bgsave_time_sec:%jd\\r\\n\"\n            \"aof_enabled:%d\\r\\n\"\n            \"aof_rewrite_in_progress:%d\\r\\n\"\n            \"aof_rewrite_scheduled:%d\\r\\n\"\n            \"aof_last_rewrite_time_sec:%jd\\r\\n\"\n            \"aof_current_rewrite_time_sec:%jd\\r\\n\"\n            \"aof_last_bgrewrite_status:%s\\r\\n\"\n            \"aof_last_write_status:%s\\r\\n\",\n            server.loading,\n            server.dirty,\n            server.rdb_child_pid != -1,\n            (intmax_t)server.lastsave,\n            (server.lastbgsave_status == REDIS_OK) ? \"ok\" : \"err\",\n            (intmax_t)server.rdb_save_time_last,\n            (intmax_t)((server.rdb_child_pid == -1) ?\n                -1 : time(NULL)-server.rdb_save_time_start),\n            server.aof_state != REDIS_AOF_OFF,\n            server.aof_child_pid != -1,\n            server.aof_rewrite_scheduled,\n            (intmax_t)server.aof_rewrite_time_last,\n            (intmax_t)((server.aof_child_pid == -1) ?\n                -1 : time(NULL)-server.aof_rewrite_time_start),\n            (server.aof_lastbgrewrite_status == REDIS_OK) ? \"ok\" : \"err\",\n            (server.aof_last_write_status == REDIS_OK) ? \"ok\" : \"err\")",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2954,
          "old_api": "exit",
          "new_api": null,
          "old_text": "exit(0)",
          "new_text": null,
          "old_line_content": "    if (fork() != 0) exit(0); /* parent exits */",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2955,
          "old_api": "setsid",
          "new_api": null,
          "old_text": "setsid()",
          "new_text": null,
          "old_line_content": "    setsid(); /* create a new session */",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2961,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(fd, STDIN_FILENO)",
          "new_text": null,
          "old_line_content": "        dup2(fd, STDIN_FILENO);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2962,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(fd, STDOUT_FILENO)",
          "new_text": null,
          "old_line_content": "        dup2(fd, STDOUT_FILENO);",
          "new_line_content": "    /* Every output goes to /dev/null. If Redis is daemonized but",
          "content_same": false
        },
        {
          "line": 2963,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(fd, STDERR_FILENO)",
          "new_text": null,
          "old_line_content": "        dup2(fd, STDERR_FILENO);",
          "new_line_content": "     * the 'logfile' is set to 'stdout' in the configuration file",
          "content_same": false
        },
        {
          "line": 2964,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fd)",
          "new_text": null,
          "old_line_content": "        if (fd > STDERR_FILENO) close(fd);",
          "new_line_content": "     * it will not log at all. */",
          "content_same": false
        },
        {
          "line": 2971,
          "old_api": "redisGitSHA1",
          "new_api": null,
          "old_text": "redisGitSHA1()",
          "new_text": null,
          "old_line_content": "        redisGitSHA1(),",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2460,
          "old_api": "intmax_t)((server.rdb_child_pid == -1) ?\n                -1 : time(NULL)-server.rdb_save_time_start)",
          "new_api": null,
          "old_text": "intmax_t)((server.rdb_child_pid == -1) ?\n                -1 : time(NULL)-server.rdb_save_time_start)",
          "new_text": null,
          "old_line_content": "            (intmax_t)((server.rdb_child_pid == -1) ?",
          "new_line_content": "            server.dirty,",
          "content_same": false
        },
        {
          "line": 2461,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "                -1 : time(NULL)-server.rdb_save_time_start),",
          "new_line_content": "            server.rdb_child_pid != -1,",
          "content_same": false
        },
        {
          "line": 2972,
          "old_api": "redisGitDirty",
          "new_api": null,
          "old_text": "redisGitDirty()",
          "new_text": null,
          "old_line_content": "        atoi(redisGitDirty()) > 0,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2975,
          "old_api": "redisBuildId",
          "new_api": null,
          "old_text": "redisBuildId()",
          "new_text": null,
          "old_line_content": "        (unsigned long long) redisBuildId());",
          "new_line_content": "        REDIS_VERSION,",
          "content_same": false
        },
        {
          "line": 2467,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "                -1 : time(NULL)-server.aof_rewrite_time_start),",
          "new_line_content": "            server.aof_state != REDIS_AOF_OFF,",
          "content_same": false
        },
        {
          "line": 2982,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr,\"       ./redis-server -v or --version\\n\")",
          "new_text": null,
          "old_line_content": "    fprintf(stderr,\"       ./redis-server -v or --version\\n\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2983,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr,\"       ./redis-server -h or --help\\n\")",
          "new_text": null,
          "old_line_content": "    fprintf(stderr,\"       ./redis-server -h or --help\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2984,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr,\"       ./redis-server --test-memory <megabytes>\\n\\n\")",
          "new_text": null,
          "old_line_content": "    fprintf(stderr,\"       ./redis-server --test-memory <megabytes>\\n\\n\");",
          "new_line_content": "void usage() {",
          "content_same": false
        },
        {
          "line": 2483,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(server.aof_buf)",
          "new_text": null,
          "old_line_content": "                sdslen(server.aof_buf),",
          "new_line_content": "                \"aof_pending_bio_fsync:%llu\\r\\n\"",
          "content_same": false
        },
        {
          "line": 2484,
          "old_api": "aofRewriteBufferSize",
          "new_api": null,
          "old_text": "aofRewriteBufferSize()",
          "new_text": null,
          "old_line_content": "                aofRewriteBufferSize(),",
          "new_line_content": "                \"aof_delayed_fsync:%lu\\r\\n\",",
          "content_same": false
        },
        {
          "line": 2485,
          "old_api": "bioPendingJobsOfType",
          "new_api": null,
          "old_text": "bioPendingJobsOfType(REDIS_BIO_AOF_FSYNC)",
          "new_text": null,
          "old_line_content": "                bioPendingJobsOfType(REDIS_BIO_AOF_FSYNC),",
          "new_line_content": "                (long long) server.aof_current_size,",
          "content_same": false
        },
        {
          "line": 3004,
          "old_api": "snprintf",
          "new_api": null,
          "old_text": "snprintf(buf,1024*16,ascii_logo,\n        REDIS_VERSION,\n        redisGitSHA1(),\n        strtol(redisGitDirty(),NULL,10) > 0,\n        (sizeof(long) == 8) ? \"64\" : \"32\",\n        mode, server.port,\n        (long) getpid()\n    )",
          "new_text": null,
          "old_line_content": "    snprintf(buf,1024*16,ascii_logo,",
          "new_line_content": "    char *mode = \"stand alone\";",
          "content_same": false
        },
        {
          "line": 3006,
          "old_api": "redisGitSHA1",
          "new_api": null,
          "old_text": "redisGitSHA1()",
          "new_text": null,
          "old_line_content": "        redisGitSHA1(),",
          "new_line_content": "    if (server.cluster_enabled) mode = \"cluster\";",
          "content_same": false
        },
        {
          "line": 3007,
          "old_api": "redisGitDirty",
          "new_api": null,
          "old_text": "redisGitDirty()",
          "new_text": null,
          "old_line_content": "        strtol(redisGitDirty(),NULL,10) > 0,",
          "new_line_content": "    else if (server.sentinel_mode) mode = \"sentinel\";",
          "content_same": false
        },
        {
          "line": 3010,
          "old_api": "getpid",
          "new_api": null,
          "old_text": "getpid()",
          "new_text": null,
          "old_line_content": "        (long) getpid()",
          "new_line_content": "        REDIS_VERSION,",
          "content_same": false
        },
        {
          "line": 3013,
          "old_api": "zfree",
          "new_api": null,
          "old_text": "zfree(buf)",
          "new_text": null,
          "old_line_content": "    zfree(buf);",
          "new_line_content": "        (sizeof(long) == 8) ? \"64\" : \"32\",",
          "content_same": false
        },
        {
          "line": 2506,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                \"loading_start_time:%jd\\r\\n\"\n                \"loading_total_bytes:%llu\\r\\n\"\n                \"loading_loaded_bytes:%llu\\r\\n\"\n                \"loading_loaded_perc:%.2f\\r\\n\"\n                \"loading_eta_seconds:%jd\\r\\n\",\n                (intmax_t) server.loading_start_time,\n                (unsigned long long) server.loading_total_bytes,\n                (unsigned long long) server.loading_loaded_bytes,\n                perc,\n                (intmax_t)eta\n            )",
          "new_text": null,
          "old_line_content": "            info = sdscatprintf(info,",
          "new_line_content": "                            enough info */",
          "content_same": false
        },
        {
          "line": 3019,
          "old_api": "redisLogFromHandler",
          "new_api": null,
          "old_text": "redisLogFromHandler(REDIS_WARNING,\"Received SIGTERM, scheduling shutdown...\")",
          "new_text": null,
          "old_line_content": "    redisLogFromHandler(REDIS_WARNING,\"Received SIGTERM, scheduling shutdown...\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3028,
          "old_api": "sigemptyset",
          "new_api": null,
          "old_text": "sigemptyset(&act.sa_mask)",
          "new_text": null,
          "old_line_content": "    sigemptyset(&act.sa_mask);",
          "new_line_content": "void setupSignalHandlers(void) {",
          "content_same": false
        },
        {
          "line": 3031,
          "old_api": "sigaction",
          "new_api": null,
          "old_text": "sigaction(SIGTERM, &act, NULL)",
          "new_text": null,
          "old_line_content": "    sigaction(SIGTERM, &act, NULL);",
          "new_line_content": "    /* When the SA_SIGINFO flag is set in sa_flags then sa_sigaction is used.",
          "content_same": false
        },
        {
          "line": 2522,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"stats\")",
          "new_text": null,
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"stats\")) {",
          "new_line_content": "            );",
          "content_same": false
        },
        {
          "line": 2523,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2524,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"# Stats\\r\\n\"\n            \"total_connections_received:%lld\\r\\n\"\n            \"total_commands_processed:%lld\\r\\n\"\n            \"instantaneous_ops_per_sec:%lld\\r\\n\"\n            \"rejected_connections:%lld\\r\\n\"\n            \"sync_full:%lld\\r\\n\"\n            \"sync_partial_ok:%lld\\r\\n\"\n            \"sync_partial_err:%lld\\r\\n\"\n            \"expired_keys:%lld\\r\\n\"\n            \"evicted_keys:%lld\\r\\n\"\n            \"keyspace_hits:%lld\\r\\n\"\n            \"keyspace_misses:%lld\\r\\n\"\n            \"pubsub_channels:%ld\\r\\n\"\n            \"pubsub_patterns:%lu\\r\\n\"\n            \"latest_fork_usec:%lld\\r\\n\"\n            \"migrate_cached_sockets:%ld\\r\\n\",\n            server.stat_numconnections,\n            server.stat_numcommands,\n            getOperationsPerSecond(),\n            server.stat_rejected_conn,\n            server.stat_sync_full,\n            server.stat_sync_partial_ok,\n            server.stat_sync_partial_err,\n            server.stat_expiredkeys,\n            server.stat_evictedkeys,\n            server.stat_keyspace_hits,\n            server.stat_keyspace_misses,\n            dictSize(server.pubsub_channels),\n            listLength(server.pubsub_patterns),\n            server.stat_fork_time,\n            dictSize(server.migrate_cached_sockets))",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3034,
          "old_api": "sigemptyset",
          "new_api": null,
          "old_text": "sigemptyset(&act.sa_mask)",
          "new_text": null,
          "old_line_content": "    sigemptyset(&act.sa_mask);",
          "new_line_content": "    act.sa_flags = 0;",
          "content_same": false
        },
        {
          "line": 3037,
          "old_api": "sigaction",
          "new_api": null,
          "old_text": "sigaction(SIGSEGV, &act, NULL)",
          "new_text": null,
          "old_line_content": "    sigaction(SIGSEGV, &act, NULL);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3038,
          "old_api": "sigaction",
          "new_api": null,
          "old_text": "sigaction(SIGBUS, &act, NULL)",
          "new_text": null,
          "old_line_content": "    sigaction(SIGBUS, &act, NULL);",
          "new_line_content": "#ifdef HAVE_BACKTRACE",
          "content_same": false
        },
        {
          "line": 3040,
          "old_api": "sigaction",
          "new_api": null,
          "old_text": "sigaction(SIGILL, &act, NULL)",
          "new_text": null,
          "old_line_content": "    sigaction(SIGILL, &act, NULL);",
          "new_line_content": "    act.sa_flags = SA_NODEFER | SA_RESETHAND | SA_SIGINFO;",
          "content_same": false
        },
        {
          "line": 3052,
          "old_api": "strstr",
          "new_api": null,
          "old_text": "strstr(argv[0],\"redis-sentinel\")",
          "new_text": null,
          "old_line_content": "    if (strstr(argv[0],\"redis-sentinel\") != NULL) return 1;",
          "new_line_content": "/* Returns 1 if there is --sentinel among the arguments or if",
          "content_same": false
        },
        {
          "line": 3054,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(argv[j],\"--sentinel\")",
          "new_text": null,
          "old_line_content": "        if (!strcmp(argv[j],\"--sentinel\")) return 1;",
          "new_line_content": "int checkForSentinelMode(int argc, char **argv) {",
          "content_same": false
        },
        {
          "line": 2543,
          "old_api": "getOperationsPerSecond",
          "new_api": null,
          "old_text": "getOperationsPerSecond()",
          "new_text": null,
          "old_line_content": "            getOperationsPerSecond(),",
          "new_line_content": "            \"pubsub_patterns:%lu\\r\\n\"",
          "content_same": false
        },
        {
          "line": 3060,
          "old_api": "ustime",
          "new_api": null,
          "old_text": "ustime()",
          "new_text": null,
          "old_line_content": "    long long start = ustime();",
          "new_line_content": "    return 0;",
          "content_same": false
        },
        {
          "line": 3062,
          "old_api": "loadAppendOnlyFile",
          "new_api": null,
          "old_text": "loadAppendOnlyFile(server.aof_filename)",
          "new_text": null,
          "old_line_content": "        if (loadAppendOnlyFile(server.aof_filename) == REDIS_OK)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3063,
          "old_api": "ustime",
          "new_api": null,
          "old_text": "ustime()",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_NOTICE,\"DB loaded from append only file: %.3f seconds\",(float)(ustime()-start)/1000000);",
          "new_line_content": "/* Function called at startup to load RDB or AOF file in memory. */",
          "content_same": false
        },
        {
          "line": 2552,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(server.pubsub_channels)",
          "new_text": null,
          "old_line_content": "            dictSize(server.pubsub_channels),",
          "new_line_content": "            server.stat_sync_partial_err,",
          "content_same": false
        },
        {
          "line": 2553,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(server.pubsub_patterns)",
          "new_text": null,
          "old_line_content": "            listLength(server.pubsub_patterns),",
          "new_line_content": "            server.stat_expiredkeys,",
          "content_same": false
        },
        {
          "line": 3066,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_NOTICE,\"DB loaded from disk: %.3f seconds\",\n                (float)(ustime()-start)/1000000)",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_NOTICE,\"DB loaded from disk: %.3f seconds\",",
          "new_line_content": "    if (server.aof_state == REDIS_AOF_ON) {",
          "content_same": false
        },
        {
          "line": 2555,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(server.migrate_cached_sockets)",
          "new_text": null,
          "old_line_content": "            dictSize(server.migrate_cached_sockets));",
          "new_line_content": "            server.stat_keyspace_hits,",
          "content_same": false
        },
        {
          "line": 3069,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_WARNING,\"Fatal error loading the DB: %s. Exiting.\",strerror(errno));",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 2559,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"replication\")",
          "new_text": null,
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"replication\")) {",
          "new_line_content": "            server.stat_fork_time,",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 50,
      "total_additions": 153,
      "total_deletions": 153,
      "total_api_changes": 356
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 9,
        "api_related_lines": 356,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          2415
        ]
      }
    },
    "api_calls_before": 729,
    "api_calls_after": 728,
    "diff_info": {
      "added_lines": 7,
      "removed_lines": 2,
      "total_diff_lines": 29
    }
  }
}