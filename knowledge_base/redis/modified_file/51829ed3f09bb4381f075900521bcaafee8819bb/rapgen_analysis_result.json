{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/51829ed3f09bb4381f075900521bcaafee8819bb",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/51829ed3f09bb4381f075900521bcaafee8819bb/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/51829ed3f09bb4381f075900521bcaafee8819bb/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/51829ed3f09bb4381f075900521bcaafee8819bb/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 3118,
          "old_api": "oom",
          "new_api": "dictGetIterator",
          "old_text": "oom(\"dictGetIterator\")",
          "new_text": "dictGetIterator(dv[j])",
          "old_line_content": "        if (!di) oom(\"dictGetIterator\");",
          "new_line_content": "        di = dictGetIterator(dv[j]);",
          "content_same": false
        },
        {
          "line": 3127,
          "old_api": "incrRefCount",
          "new_api": "dictAdd",
          "old_text": "incrRefCount(ele)",
          "new_text": "dictAdd(dstset->ptr,ele,NULL)",
          "old_line_content": "                    incrRefCount(ele);",
          "new_line_content": "                if (dictAdd(dstset->ptr,ele,NULL) == DICT_OK) {",
          "content_same": false
        },
        {
          "line": 3144,
          "old_api": "dictNext",
          "new_api": "sdsempty",
          "old_text": "dictNext(di)",
          "new_text": "sdsempty()",
          "old_line_content": "        while((de = dictNext(di)) != NULL) {",
          "new_line_content": "        addReplySds(c,sdscatprintf(sdsempty(),\"*%d\\r\\n\",cardinality));",
          "content_same": false
        },
        {
          "line": 3147,
          "old_api": "dictGetEntryKey",
          "new_api": "dictNext",
          "old_text": "dictGetEntryKey(de)",
          "new_text": "dictNext(di)",
          "old_line_content": "            ele = dictGetEntryKey(de);",
          "new_line_content": "        while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 3150,
          "old_api": "addReply",
          "new_api": "dictGetEntryKey",
          "old_text": "addReply(c,ele)",
          "new_text": "dictGetEntryKey(de)",
          "old_line_content": "            addReply(c,ele);",
          "new_line_content": "            ele = dictGetEntryKey(de);",
          "content_same": false
        },
        {
          "line": 3151,
          "old_api": "addReply",
          "new_api": "sdsempty",
          "old_text": "addReply(c,shared.crlf)",
          "new_text": "sdsempty()",
          "old_line_content": "            addReply(c,shared.crlf);",
          "new_line_content": "            addReplySds(c,sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 3153,
          "old_api": "dictReleaseIterator",
          "new_api": "addReply",
          "old_text": "dictReleaseIterator(di)",
          "new_text": "addReply(c,ele)",
          "old_line_content": "        dictReleaseIterator(di);",
          "new_line_content": "            addReply(c,ele);",
          "content_same": false
        },
        {
          "line": 3163,
          "old_api": "zfree",
          "new_api": "addReply",
          "old_text": "zfree(dv)",
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "    zfree(dv);",
          "new_line_content": "        addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 3186,
          "old_api": "addReply",
          "new_api": "dictSize",
          "old_text": "addReply(c,shared.ok)",
          "new_text": "dictSize(c->db->dict)",
          "old_line_content": "    addReply(c,shared.ok);",
          "new_line_content": "    server.dirty += dictSize(c->db->dict);",
          "content_same": false
        },
        {
          "line": 3228,
          "old_api": "memcpy",
          "new_api": "sdslen",
          "old_text": "memcpy(keyname.buf+prefixlen,ssub,sublen)",
          "new_text": "sdslen(ssub)",
          "old_line_content": "    memcpy(keyname.buf+prefixlen,ssub,sublen);",
          "new_line_content": "    sublen = sdslen(ssub);",
          "content_same": false
        },
        {
          "line": 3229,
          "old_api": "memcpy",
          "new_api": "sdslen",
          "old_text": "memcpy(keyname.buf+prefixlen+sublen,p+1,postfixlen)",
          "new_text": "sdslen(spat)",
          "old_line_content": "    memcpy(keyname.buf+prefixlen+sublen,p+1,postfixlen);",
          "new_line_content": "    postfixlen = sdslen(spat)-(prefixlen+1);",
          "content_same": false
        },
        {
          "line": 3324,
          "old_api": "atoi",
          "new_api": "strcasecmp",
          "old_text": "atoi(c->argv[j+1]->ptr)",
          "new_text": "strcasecmp(c->argv[j]->ptr,\"alpha\")",
          "old_line_content": "            limit_start = atoi(c->argv[j+1]->ptr);",
          "new_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"alpha\")) {",
          "content_same": false
        },
        {
          "line": 3327,
          "old_api": "strcasecmp",
          "new_api": "atoi",
          "old_text": "strcasecmp(c->argv[j]->ptr,\"by\")",
          "new_text": "atoi(c->argv[j+1]->ptr)",
          "old_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"by\") && leftargs >= 1) {",
          "new_line_content": "            limit_start = atoi(c->argv[j+1]->ptr);",
          "content_same": false
        },
        {
          "line": 3334,
          "old_api": "createSortOperation",
          "new_api": "strchr",
          "old_text": "createSortOperation(\n                REDIS_SORT_GET,c->argv[j+1])",
          "new_text": "strchr(c->argv[j+1]->ptr,'*')",
          "old_line_content": "            listAddNodeTail(operations,createSortOperation(",
          "new_line_content": "            if (strchr(c->argv[j+1]->ptr,'*') == NULL) dontsort = 1;",
          "content_same": false
        },
        {
          "line": 3342,
          "old_api": "strcasecmp",
          "new_api": "createSortOperation",
          "old_text": "strcasecmp(c->argv[j]->ptr,\"incr\")",
          "new_text": "createSortOperation(\n                REDIS_SORT_DEL,c->argv[j+1])",
          "old_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"incr\") && leftargs >= 1) {",
          "new_line_content": "            listAddNodeTail(operations,createSortOperation(",
          "content_same": false
        },
        {
          "line": 3346,
          "old_api": "strcasecmp",
          "new_api": "createSortOperation",
          "old_text": "strcasecmp(c->argv[j]->ptr,\"get\")",
          "new_text": "createSortOperation(\n                REDIS_SORT_INCR,c->argv[j+1])",
          "old_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"get\") && leftargs >= 1) {",
          "new_line_content": "            listAddNodeTail(operations,createSortOperation(",
          "content_same": false
        },
        {
          "line": 3364,
          "old_api": "oom",
          "new_api": "listLength",
          "old_text": "oom(\"allocating objects vector for SORT\")",
          "new_text": "listLength((list*)sortval->ptr)",
          "old_line_content": "    if (!vector) oom(\"allocating objects vector for SORT\");",
          "new_line_content": "        listLength((list*)sortval->ptr) :",
          "content_same": false
        },
        {
          "line": 3386,
          "old_api": "dictGetEntryKey",
          "new_api": "dictGetIterator",
          "old_text": "dictGetEntryKey(setele)",
          "new_text": "dictGetIterator(set)",
          "old_line_content": "            vector[j].obj = dictGetEntryKey(setele);",
          "new_line_content": "        di = dictGetIterator(set);",
          "content_same": false
        },
        {
          "line": 3442,
          "old_api": "addReply",
          "new_api": "sdsempty",
          "old_text": "addReply(c,shared.crlf)",
          "new_text": "sdsempty()",
          "old_line_content": "            addReply(c,shared.crlf);",
          "new_line_content": "            addReplySds(c,sdscatprintf(sdsempty(),\"$%d\\r\\n\",",
          "content_same": false
        },
        {
          "line": 3444,
          "old_api": "listRewind",
          "new_api": "addReply",
          "old_text": "listRewind(operations)",
          "new_text": "addReply(c,vector[j].obj)",
          "old_line_content": "        listRewind(operations);",
          "new_line_content": "            addReply(c,vector[j].obj);",
          "content_same": false
        },
        {
          "line": 3445,
          "old_api": "listYield",
          "new_api": "addReply",
          "old_text": "listYield(operations)",
          "new_text": "addReply(c,shared.crlf)",
          "old_line_content": "        while((ln = listYield(operations))) {",
          "new_line_content": "            addReply(c,shared.crlf);",
          "content_same": false
        },
        {
          "line": 3447,
          "old_api": "lookupKeyByPattern",
          "new_api": "listRewind",
          "old_text": "lookupKeyByPattern(c->db,sop->pattern,\n                vector[j].obj)",
          "new_text": "listRewind(operations)",
          "old_line_content": "            robj *val = lookupKeyByPattern(c->db,sop->pattern,",
          "new_line_content": "        listRewind(operations);",
          "content_same": false
        },
        {
          "line": 3455,
          "old_api": "sdslen",
          "new_api": "addReply",
          "old_text": "sdslen(val->ptr)",
          "new_text": "addReply(c,shared.nullbulk)",
          "old_line_content": "                        sdslen(val->ptr)));",
          "new_line_content": "                    addReply(c,shared.nullbulk);",
          "content_same": false
        },
        {
          "line": 3457,
          "old_api": "addReply",
          "new_api": "sdsempty",
          "old_text": "addReply(c,shared.crlf)",
          "new_text": "sdsempty()",
          "old_line_content": "                    addReply(c,shared.crlf);",
          "new_line_content": "                    addReplySds(c,sdscatprintf(sdsempty(),\"$%d\\r\\n\",",
          "content_same": false
        },
        {
          "line": 3470,
          "old_api": "decrRefCount",
          "new_api": "listRelease",
          "old_text": "decrRefCount(vector[j].u.cmpobj)",
          "new_text": "listRelease(operations)",
          "old_line_content": "            decrRefCount(vector[j].u.cmpobj);",
          "new_line_content": "    listRelease(operations);",
          "content_same": false
        },
        {
          "line": 3531,
          "old_api": "incrRefCount",
          "new_api": "dictAdd",
          "old_text": "incrRefCount(key)",
          "new_text": "dictAdd(db->expires,key,(void*)when)",
          "old_line_content": "        incrRefCount(key);",
          "new_line_content": "    if (dictAdd(db->expires,key,(void*)when) == DICT_ERR) {",
          "content_same": false
        },
        {
          "line": 3545,
          "old_api": "dictGetEntryVal",
          "new_api": "dictSize",
          "old_text": "dictGetEntryVal(de)",
          "new_text": "dictSize(db->expires)",
          "old_line_content": "    return (time_t) dictGetEntryVal(de);",
          "new_line_content": "    if (dictSize(db->expires) == 0 ||",
          "content_same": false
        },
        {
          "line": 3557,
          "old_api": "dictGetEntryVal",
          "new_api": "dictFind",
          "old_text": "dictGetEntryVal(de)",
          "new_text": "dictFind(db->expires,key)",
          "old_line_content": "    when = (time_t) dictGetEntryVal(de);",
          "new_line_content": "       (de = dictFind(db->expires,key)) == NULL) return 0;",
          "content_same": false
        },
        {
          "line": 3561,
          "old_api": "dictDelete",
          "new_api": "time",
          "old_text": "dictDelete(db->expires,key)",
          "new_text": "time(NULL)",
          "old_line_content": "    dictDelete(db->expires,key);",
          "new_line_content": "    if (time(NULL) <= when) return 0;",
          "content_same": false
        },
        {
          "line": 3591,
          "old_api": "time",
          "new_api": "addReply",
          "old_text": "time(NULL)",
          "new_text": "addReply(c, shared.czero)",
          "old_line_content": "        time_t when = time(NULL)+seconds;",
          "new_line_content": "        addReply(c, shared.czero);",
          "content_same": false
        },
        {
          "line": 3595,
          "old_api": "addReply",
          "new_api": "setExpire",
          "old_text": "addReply(c,shared.czero)",
          "new_text": "setExpire(c->db,c->argv[1],when)",
          "old_line_content": "            addReply(c,shared.czero);",
          "new_line_content": "        if (setExpire(c->db,c->argv[1],when))",
          "content_same": false
        },
        {
          "line": 3699,
          "old_api": "redisLog",
          "new_api": "listDup",
          "old_text": "redisLog(REDIS_NOTICE,\"Waiting for end of BGSAVE for SYNC\")",
          "new_text": "listDup(slave->reply)",
          "old_line_content": "            redisLog(REDIS_NOTICE,\"Waiting for end of BGSAVE for SYNC\");",
          "new_line_content": "            c->reply = listDup(slave->reply);",
          "content_same": false
        },
        {
          "line": 3711,
          "old_api": "sdsnew",
          "new_api": "redisLog",
          "old_text": "sdsnew(\"-ERR Unalbe to perform background save\\r\\n\")",
          "new_text": "redisLog(REDIS_NOTICE,\"Starting BGSAVE for SYNC\")",
          "old_line_content": "            addReplySds(c,sdsnew(\"-ERR Unalbe to perform background save\\r\\n\"));",
          "new_line_content": "        redisLog(REDIS_NOTICE,\"Starting BGSAVE for SYNC\");",
          "content_same": false
        },
        {
          "line": 3742,
          "old_api": "freeClient",
          "new_api": "sdslen",
          "old_text": "freeClient(slave)",
          "new_text": "sdslen(bulkcount)",
          "old_line_content": "            freeClient(slave);",
          "new_line_content": "        if (write(fd,bulkcount,sdslen(bulkcount)) != (signed)sdslen(bulkcount))",
          "content_same": false
        },
        {
          "line": 3745,
          "old_api": "sdsfree",
          "new_api": "freeClient",
          "old_text": "sdsfree(bulkcount)",
          "new_text": "freeClient(slave)",
          "old_line_content": "        sdsfree(bulkcount);",
          "new_line_content": "            freeClient(slave);",
          "content_same": false
        },
        {
          "line": 3748,
          "old_api": "read",
          "new_api": "sdsfree",
          "old_text": "read(slave->repldbfd,buf,REDIS_IOBUF_LEN)",
          "new_text": "sdsfree(bulkcount)",
          "old_line_content": "    buflen = read(slave->repldbfd,buf,REDIS_IOBUF_LEN);",
          "new_line_content": "        sdsfree(bulkcount);",
          "content_same": false
        },
        {
          "line": 3750,
          "old_api": "redisLog",
          "new_api": "lseek",
          "old_text": "redisLog(REDIS_WARNING,\"Read error sending DB to slave: %s\",\n            (buflen == 0) ? \"premature EOF\" : strerror(errno))",
          "new_text": "lseek(slave->repldbfd,slave->repldboff,SEEK_SET)",
          "old_line_content": "        redisLog(REDIS_WARNING,\"Read error sending DB to slave: %s\",",
          "new_line_content": "    lseek(slave->repldbfd,slave->repldboff,SEEK_SET);",
          "content_same": false
        },
        {
          "line": 3751,
          "old_api": "strerror",
          "new_api": "read",
          "old_text": "strerror(errno)",
          "new_text": "read(slave->repldbfd,buf,REDIS_IOBUF_LEN)",
          "old_line_content": "            (buflen == 0) ? \"premature EOF\" : strerror(errno));",
          "new_line_content": "    buflen = read(slave->repldbfd,buf,REDIS_IOBUF_LEN);",
          "content_same": false
        },
        {
          "line": 3755,
          "old_api": "write",
          "new_api": "freeClient",
          "old_text": "write(fd,buf,buflen)",
          "new_text": "freeClient(slave)",
          "old_line_content": "    if ((nwritten = write(fd,buf,buflen)) == -1) {",
          "new_line_content": "        freeClient(slave);",
          "content_same": false
        },
        {
          "line": 3758,
          "old_api": "freeClient",
          "new_api": "write",
          "old_text": "freeClient(slave)",
          "new_text": "write(fd,buf,buflen)",
          "old_line_content": "        freeClient(slave);",
          "new_line_content": "    if ((nwritten = write(fd,buf,buflen)) == -1) {",
          "content_same": false
        },
        {
          "line": 3772,
          "old_api": "sdsempty",
          "new_api": "freeClient",
          "old_text": "sdsempty()",
          "new_text": "freeClient(slave)",
          "old_line_content": "        addReplySds(slave,sdsempty());",
          "new_line_content": "            freeClient(slave);",
          "content_same": false
        },
        {
          "line": 3796,
          "old_api": "open",
          "new_api": "redisLog",
          "old_text": "open(server.dbfilename,O_RDONLY)",
          "new_text": "redisLog(REDIS_WARNING,\"SYNC failed. BGSAVE child returned an error\")",
          "old_line_content": "            if ((slave->repldbfd = open(server.dbfilename,O_RDONLY)) == -1 ||",
          "new_line_content": "                redisLog(REDIS_WARNING,\"SYNC failed. BGSAVE child returned an error\");",
          "content_same": false
        },
        {
          "line": 3799,
          "old_api": "strerror",
          "new_api": "open",
          "old_text": "strerror(errno)",
          "new_text": "open(server.dbfilename,O_RDONLY)",
          "old_line_content": "                redisLog(REDIS_WARNING,\"SYNC failed. Can't open/stat DB after BGSAVE: %s\", strerror(errno));",
          "new_line_content": "            if ((slave->repldbfd = open(server.dbfilename,O_RDONLY)) == -1 ||",
          "content_same": false
        },
        {
          "line": 3816,
          "old_api": "listYield",
          "new_api": "rdbSaveBackground",
          "old_text": "listYield(server.slaves)",
          "new_text": "rdbSaveBackground(server.dbfilename)",
          "old_line_content": "            while((ln = listYield(server.slaves))) {",
          "new_line_content": "        if (rdbSaveBackground(server.dbfilename) != REDIS_OK) {",
          "content_same": false
        },
        {
          "line": 3841,
          "old_api": "strerror",
          "new_api": "syncWrite",
          "old_text": "strerror(errno)",
          "new_text": "syncWrite(fd,\"SYNC \\r\\n\",7,5)",
          "old_line_content": "            strerror(errno));",
          "new_line_content": "    if (syncWrite(fd,\"SYNC \\r\\n\",7,5) == -1) {",
          "content_same": false
        },
        {
          "line": 3848,
          "old_api": "strerror",
          "new_api": "syncReadLine",
          "old_text": "strerror(errno)",
          "new_text": "syncReadLine(fd,buf,1024,5)",
          "old_line_content": "            strerror(errno));",
          "new_line_content": "    if (syncReadLine(fd,buf,1024,5) == -1) {",
          "content_same": false
        },
        {
          "line": 3851,
          "old_api": "atoi",
          "new_api": "strerror",
          "old_text": "atoi(buf+1)",
          "new_text": "strerror(errno)",
          "old_line_content": "    dumpsize = atoi(buf+1);",
          "new_line_content": "            strerror(errno));",
          "content_same": false
        },
        {
          "line": 3854,
          "old_api": "random",
          "new_api": "atoi",
          "old_text": "random()",
          "new_text": "atoi(buf+1)",
          "old_line_content": "    snprintf(tmpfile,256,\"temp-%d.%ld.rdb\",(int)time(NULL),(long int)random());",
          "new_line_content": "    dumpsize = atoi(buf+1);",
          "content_same": false
        },
        {
          "line": 3855,
          "old_api": "open",
          "new_api": "redisLog",
          "old_text": "open(tmpfile,O_CREAT|O_WRONLY,0644)",
          "new_text": "redisLog(REDIS_NOTICE,\"Receiving %d bytes data dump from MASTER\",dumpsize)",
          "old_line_content": "    dfd = open(tmpfile,O_CREAT|O_WRONLY,0644);",
          "new_line_content": "    redisLog(REDIS_NOTICE,\"Receiving %d bytes data dump from MASTER\",dumpsize);",
          "content_same": false
        },
        {
          "line": 3857,
          "old_api": "close",
          "new_api": "random",
          "old_text": "close(fd)",
          "new_text": "random()",
          "old_line_content": "        close(fd);",
          "new_line_content": "    snprintf(tmpfile,256,\"temp-%d.%ld.rdb\",(int)time(NULL),(long int)random());",
          "content_same": false
        },
        {
          "line": 3858,
          "old_api": "strerror",
          "new_api": "open",
          "old_text": "strerror(errno)",
          "new_text": "open(tmpfile,O_CREAT|O_WRONLY,0644)",
          "old_line_content": "        redisLog(REDIS_WARNING,\"Opening the temp file needed for MASTER <-> SLAVE synchronization: %s\",strerror(errno));",
          "new_line_content": "    dfd = open(tmpfile,O_CREAT|O_WRONLY,0644);",
          "content_same": false
        },
        {
          "line": 3867,
          "old_api": "strerror",
          "new_api": "read",
          "old_text": "strerror(errno)",
          "new_text": "read(fd,buf,(dumpsize < 1024)?dumpsize:1024)",
          "old_line_content": "                strerror(errno));",
          "new_line_content": "        nread = read(fd,buf,(dumpsize < 1024)?dumpsize:1024);",
          "content_same": false
        },
        {
          "line": 3869,
          "old_api": "close",
          "new_api": "redisLog",
          "old_text": "close(dfd)",
          "new_text": "redisLog(REDIS_WARNING,\"I/O error trying to sync with MASTER: %s\",\n                strerror(errno))",
          "old_line_content": "            close(dfd);",
          "new_line_content": "            redisLog(REDIS_WARNING,\"I/O error trying to sync with MASTER: %s\",",
          "content_same": false
        },
        {
          "line": 3872,
          "old_api": "write",
          "new_api": "close",
          "old_text": "write(dfd,buf,nread)",
          "new_text": "close(dfd)",
          "old_line_content": "        nwritten = write(dfd,buf,nread);",
          "new_line_content": "            close(dfd);",
          "content_same": false
        },
        {
          "line": 3875,
          "old_api": "close",
          "new_api": "write",
          "old_text": "close(fd)",
          "new_text": "write(dfd,buf,nread)",
          "old_line_content": "            close(fd);",
          "new_line_content": "        nwritten = write(dfd,buf,nread);",
          "content_same": false
        },
        {
          "line": 3884,
          "old_api": "unlink",
          "new_api": "close",
          "old_text": "unlink(tmpfile)",
          "new_text": "close(dfd)",
          "old_line_content": "        unlink(tmpfile);",
          "new_line_content": "    close(dfd);",
          "content_same": false
        },
        {
          "line": 3885,
          "old_api": "close",
          "new_api": "rename",
          "old_text": "close(fd)",
          "new_text": "rename(tmpfile,server.dbfilename)",
          "old_line_content": "        close(fd);",
          "new_line_content": "    if (rename(tmpfile,server.dbfilename) == -1) {",
          "content_same": false
        },
        {
          "line": 3888,
          "old_api": "emptyDb",
          "new_api": "close",
          "old_text": "emptyDb()",
          "new_text": "close(fd)",
          "old_line_content": "    emptyDb();",
          "new_line_content": "        close(fd);",
          "content_same": false
        },
        {
          "line": 3891,
          "old_api": "close",
          "new_api": "emptyDb",
          "old_text": "close(fd)",
          "new_text": "emptyDb()",
          "old_line_content": "        close(fd);",
          "new_line_content": "    emptyDb();",
          "content_same": false
        },
        {
          "line": 3894,
          "old_api": "createClient",
          "new_api": "close",
          "old_text": "createClient(fd)",
          "new_text": "close(fd)",
          "old_line_content": "    server.master = createClient(fd);",
          "new_line_content": "        close(fd);",
          "content_same": false
        },
        {
          "line": 3937,
          "old_api": "dup2",
          "new_api": "open",
          "old_text": "dup2(fd, STDERR_FILENO)",
          "new_text": "open(\"/dev/null\", O_RDWR, 0)",
          "old_line_content": "        dup2(fd, STDERR_FILENO);",
          "new_line_content": "    if ((fd = open(\"/dev/null\", O_RDWR, 0)) != -1) {",
          "content_same": false
        },
        {
          "line": 3938,
          "old_api": "close",
          "new_api": "dup2",
          "old_text": "close(fd)",
          "new_text": "dup2(fd, STDIN_FILENO)",
          "old_line_content": "        if (fd > STDERR_FILENO) close(fd);",
          "new_line_content": "        dup2(fd, STDIN_FILENO);",
          "content_same": false
        },
        {
          "line": 3941,
          "old_api": "fopen",
          "new_api": "close",
          "old_text": "fopen(server.pidfile,\"w\")",
          "new_text": "close(fd)",
          "old_line_content": "    fp = fopen(server.pidfile,\"w\");",
          "new_line_content": "        if (fd > STDERR_FILENO) close(fd);",
          "content_same": false
        },
        {
          "line": 3944,
          "old_api": "fclose",
          "new_api": "fopen",
          "old_text": "fclose(fp)",
          "new_text": "fopen(server.pidfile,\"w\")",
          "old_line_content": "        fclose(fp);",
          "new_line_content": "    fp = fopen(server.pidfile,\"w\");",
          "content_same": false
        },
        {
          "line": 3953,
          "old_api": "initServerConfig",
          "new_api": "linuxOvercommitMemoryWarning",
          "old_text": "initServerConfig()",
          "new_text": "linuxOvercommitMemoryWarning()",
          "old_line_content": "    initServerConfig();",
          "new_line_content": "    linuxOvercommitMemoryWarning();",
          "content_same": false
        },
        {
          "line": 3956,
          "old_api": "loadServerConfig",
          "new_api": "initServerConfig",
          "old_text": "loadServerConfig(argv[1])",
          "new_text": "initServerConfig()",
          "old_line_content": "        loadServerConfig(argv[1]);",
          "new_line_content": "    initServerConfig();",
          "content_same": false
        },
        {
          "line": 3958,
          "old_api": "fprintf",
          "new_api": "ResetServerSaveParams",
          "old_text": "fprintf(stderr,\"Usage: ./redis-server [/path/to/redis.conf]\\n\")",
          "new_text": "ResetServerSaveParams()",
          "old_line_content": "        fprintf(stderr,\"Usage: ./redis-server [/path/to/redis.conf]\\n\");",
          "new_line_content": "        ResetServerSaveParams();",
          "content_same": false
        },
        {
          "line": 3959,
          "old_api": "exit",
          "new_api": "loadServerConfig",
          "old_text": "exit(1)",
          "new_text": "loadServerConfig(argv[1])",
          "old_line_content": "        exit(1);",
          "new_line_content": "        loadServerConfig(argv[1]);",
          "content_same": false
        },
        {
          "line": 3961,
          "old_api": "initServer",
          "new_api": "fprintf",
          "old_text": "initServer()",
          "new_text": "fprintf(stderr,\"Usage: ./redis-server [/path/to/redis.conf]\\n\")",
          "old_line_content": "    initServer();",
          "new_line_content": "        fprintf(stderr,\"Usage: ./redis-server [/path/to/redis.conf]\\n\");",
          "content_same": false
        },
        {
          "line": 3962,
          "old_api": "daemonize",
          "new_api": "exit",
          "old_text": "daemonize()",
          "new_text": "exit(1)",
          "old_line_content": "    if (server.daemonize) daemonize();",
          "new_line_content": "        exit(1);",
          "content_same": false
        },
        {
          "line": 3964,
          "old_api": "rdbLoad",
          "new_api": "initServer",
          "old_text": "rdbLoad(server.dbfilename)",
          "new_text": "initServer()",
          "old_line_content": "    if (rdbLoad(server.dbfilename) == REDIS_OK)",
          "new_line_content": "    initServer();",
          "content_same": false
        },
        {
          "line": 3965,
          "old_api": "redisLog",
          "new_api": "daemonize",
          "old_text": "redisLog(REDIS_NOTICE,\"DB loaded from disk\")",
          "new_text": "daemonize()",
          "old_line_content": "        redisLog(REDIS_NOTICE,\"DB loaded from disk\");",
          "new_line_content": "    if (server.daemonize) daemonize();",
          "content_same": false
        },
        {
          "line": 3966,
          "old_api": "aeCreateFileEvent",
          "new_api": "redisLog",
          "old_text": "aeCreateFileEvent(server.el, server.fd, AE_READABLE,\n        acceptHandler, NULL, NULL)",
          "new_text": "redisLog(REDIS_NOTICE,\"Server started, Redis version \" REDIS_VERSION)",
          "old_line_content": "    if (aeCreateFileEvent(server.el, server.fd, AE_READABLE,",
          "new_line_content": "    redisLog(REDIS_NOTICE,\"Server started, Redis version \" REDIS_VERSION);",
          "content_same": false
        },
        {
          "line": 3967,
          "old_api": "oom",
          "new_api": "rdbLoad",
          "old_text": "oom(\"creating file event\")",
          "new_text": "rdbLoad(server.dbfilename)",
          "old_line_content": "        acceptHandler, NULL, NULL) == AE_ERR) oom(\"creating file event\");",
          "new_line_content": "    if (rdbLoad(server.dbfilename) == REDIS_OK)",
          "content_same": false
        },
        {
          "line": 3969,
          "old_api": "aeMain",
          "new_api": "aeCreateFileEvent",
          "old_text": "aeMain(server.el)",
          "new_text": "aeCreateFileEvent(server.el, server.fd, AE_READABLE,\n        acceptHandler, NULL, NULL)",
          "old_line_content": "    aeMain(server.el);",
          "new_line_content": "    if (aeCreateFileEvent(server.el, server.fd, AE_READABLE,",
          "content_same": false
        },
        {
          "line": 3970,
          "old_api": "aeDeleteEventLoop",
          "new_api": "oom",
          "old_text": "aeDeleteEventLoop(server.el)",
          "new_text": "oom(\"creating file event\")",
          "old_line_content": "    aeDeleteEventLoop(server.el);",
          "new_line_content": "        acceptHandler, NULL, NULL) == AE_ERR) oom(\"creating file event\");",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 3585,
          "old_api": null,
          "new_api": "dictFind",
          "old_text": null,
          "new_text": "dictFind(c->db->dict,c->argv[1])",
          "old_line_content": "        return;",
          "new_line_content": "    de = dictFind(c->db->dict,c->argv[1]);",
          "content_same": false
        },
        {
          "line": 3587,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.czero)",
          "old_line_content": "    if (seconds <= 0) {",
          "new_line_content": "        addReply(c,shared.czero);",
          "content_same": false
        },
        {
          "line": 3594,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "        else",
          "new_line_content": "        time_t when = time(NULL)+seconds;",
          "content_same": false
        },
        {
          "line": 3596,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.cone)",
          "old_line_content": "        return;",
          "new_line_content": "            addReply(c,shared.cone);",
          "content_same": false
        },
        {
          "line": 3598,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.czero)",
          "old_line_content": "}",
          "new_line_content": "            addReply(c,shared.czero);",
          "content_same": false
        },
        {
          "line": 3607,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "    while(size) {",
          "new_line_content": "    time_t start = time(NULL);",
          "content_same": false
        },
        {
          "line": 3611,
          "old_api": null,
          "new_api": "aeWait",
          "old_text": null,
          "new_text": "aeWait(fd,AE_WRITABLE,1000)",
          "old_line_content": "            ptr += nwritten;",
          "new_line_content": "        if (aeWait(fd,AE_WRITABLE,1000) & AE_WRITABLE) {",
          "content_same": false
        },
        {
          "line": 3612,
          "old_api": null,
          "new_api": "write",
          "old_text": null,
          "new_text": "write(fd,ptr,size)",
          "old_line_content": "            size -= nwritten;",
          "new_line_content": "            nwritten = write(fd,ptr,size);",
          "content_same": false
        },
        {
          "line": 3617,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "        }",
          "new_line_content": "        if ((time(NULL)-start) > timeout) {",
          "content_same": false
        },
        {
          "line": 3627,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "    while(size) {",
          "new_line_content": "    time_t start = time(NULL);",
          "content_same": false
        },
        {
          "line": 3119,
          "old_api": null,
          "new_api": "oom",
          "old_text": null,
          "new_text": "oom(\"dictGetIterator\")",
          "old_line_content": "",
          "new_line_content": "        if (!di) oom(\"dictGetIterator\");",
          "content_same": false
        },
        {
          "line": 3631,
          "old_api": null,
          "new_api": "aeWait",
          "old_text": null,
          "new_text": "aeWait(fd,AE_READABLE,1000)",
          "old_line_content": "            ptr += nread;",
          "new_line_content": "        if (aeWait(fd,AE_READABLE,1000) & AE_READABLE) {",
          "content_same": false
        },
        {
          "line": 3121,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "            robj *ele;",
          "new_line_content": "        while((de = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 3632,
          "old_api": null,
          "new_api": "read",
          "old_text": null,
          "new_text": "read(fd,ptr,size)",
          "old_line_content": "            size -= nread;",
          "new_line_content": "            nread = read(fd,ptr,size);",
          "content_same": false
        },
        {
          "line": 3125,
          "old_api": null,
          "new_api": "dictGetEntryKey",
          "old_text": null,
          "new_text": "dictGetEntryKey(de)",
          "old_line_content": "            if (op == REDIS_OP_UNION || j == 0) {",
          "new_line_content": "            ele = dictGetEntryKey(de);",
          "content_same": false
        },
        {
          "line": 3638,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "        }",
          "new_line_content": "        if ((time(NULL)-start) > timeout) {",
          "content_same": false
        },
        {
          "line": 3128,
          "old_api": null,
          "new_api": "incrRefCount",
          "old_text": null,
          "new_text": "incrRefCount(ele)",
          "old_line_content": "                    cardinality++;",
          "new_line_content": "                    incrRefCount(ele);",
          "content_same": false
        },
        {
          "line": 3132,
          "old_api": null,
          "new_api": "dictDelete",
          "old_text": null,
          "new_text": "dictDelete(dstset->ptr,ele)",
          "old_line_content": "                    cardinality--;",
          "new_line_content": "                if (dictDelete(dstset->ptr,ele) == DICT_OK) {",
          "content_same": false
        },
        {
          "line": 3137,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "    }",
          "new_line_content": "        dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 3653,
          "old_api": null,
          "new_api": "syncRead",
          "old_text": null,
          "new_text": "syncRead(fd,&c,1,timeout)",
          "old_line_content": "            if (nread && *(ptr-1) == '\\r') *(ptr-1) = '\\0';",
          "new_line_content": "        if (syncRead(fd,&c,1,timeout) == -1) return -1;",
          "content_same": false
        },
        {
          "line": 3145,
          "old_api": null,
          "new_api": "dictGetIterator",
          "old_text": null,
          "new_text": "dictGetIterator(dstset->ptr)",
          "old_line_content": "            robj *ele;",
          "new_line_content": "        di = dictGetIterator(dstset->ptr);",
          "content_same": false
        },
        {
          "line": 3146,
          "old_api": null,
          "new_api": "oom",
          "old_text": null,
          "new_text": "oom(\"dictGetIterator\")",
          "old_line_content": "",
          "new_line_content": "        if (!di) oom(\"dictGetIterator\");",
          "content_same": false
        },
        {
          "line": 3152,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(ele->ptr)",
          "old_line_content": "        }",
          "new_line_content": "                    \"$%d\\r\\n\",sdslen(ele->ptr)));",
          "content_same": false
        },
        {
          "line": 3154,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.crlf)",
          "old_line_content": "    }",
          "new_line_content": "            addReply(c,shared.crlf);",
          "content_same": false
        },
        {
          "line": 3156,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "    /* Cleanup */",
          "new_line_content": "        dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 3161,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(dstset)",
          "old_line_content": "        server.dirty++;",
          "new_line_content": "        decrRefCount(dstset);",
          "content_same": false
        },
        {
          "line": 3675,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(c->reply)",
          "old_line_content": "    }",
          "new_line_content": "    if (listLength(c->reply) != 0) {",
          "content_same": false
        },
        {
          "line": 3676,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(\"-ERR SYNC is invalid with pending input\\r\\n\")",
          "old_line_content": "",
          "new_line_content": "        addReplySds(c,sdsnew(\"-ERR SYNC is invalid with pending input\\r\\n\"));",
          "content_same": false
        },
        {
          "line": 3166,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(dv)",
          "old_line_content": "static void sunionCommand(redisClient *c) {",
          "new_line_content": "    zfree(dv);",
          "content_same": false
        },
        {
          "line": 3680,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_NOTICE,\"Slave ask for synchronization\")",
          "old_line_content": "    if (server.bgsaveinprogress) {",
          "new_line_content": "    redisLog(REDIS_NOTICE,\"Slave ask for synchronization\");",
          "content_same": false
        },
        {
          "line": 3170,
          "old_api": null,
          "new_api": "sunionDiffGenericCommand",
          "old_text": null,
          "new_text": "sunionDiffGenericCommand(c,c->argv+1,c->argc-1,NULL,REDIS_OP_UNION)",
          "old_line_content": "static void sunionstoreCommand(redisClient *c) {",
          "new_line_content": "    sunionDiffGenericCommand(c,c->argv+1,c->argc-1,NULL,REDIS_OP_UNION);",
          "content_same": false
        },
        {
          "line": 3174,
          "old_api": null,
          "new_api": "sunionDiffGenericCommand",
          "old_text": null,
          "new_text": "sunionDiffGenericCommand(c,c->argv+2,c->argc-2,c->argv[1],REDIS_OP_UNION)",
          "old_line_content": "static void sdiffCommand(redisClient *c) {",
          "new_line_content": "    sunionDiffGenericCommand(c,c->argv+2,c->argc-2,c->argv[1],REDIS_OP_UNION);",
          "content_same": false
        },
        {
          "line": 3178,
          "old_api": null,
          "new_api": "sunionDiffGenericCommand",
          "old_text": null,
          "new_text": "sunionDiffGenericCommand(c,c->argv+1,c->argc-1,NULL,REDIS_OP_DIFF)",
          "old_line_content": "static void sdiffstoreCommand(redisClient *c) {",
          "new_line_content": "    sunionDiffGenericCommand(c,c->argv+1,c->argc-1,NULL,REDIS_OP_DIFF);",
          "content_same": false
        },
        {
          "line": 3690,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(server.slaves)",
          "old_line_content": "            if (slave->replstate == REDIS_REPL_WAIT_BGSAVE_END) break;",
          "new_line_content": "        listRewind(server.slaves);",
          "content_same": false
        },
        {
          "line": 3691,
          "old_api": null,
          "new_api": "listYield",
          "old_text": null,
          "new_text": "listYield(server.slaves)",
          "old_line_content": "        }",
          "new_line_content": "        while((ln = listYield(server.slaves))) {",
          "content_same": false
        },
        {
          "line": 3182,
          "old_api": null,
          "new_api": "sunionDiffGenericCommand",
          "old_text": null,
          "new_text": "sunionDiffGenericCommand(c,c->argv+2,c->argc-2,c->argv[1],REDIS_OP_DIFF)",
          "old_line_content": "static void flushdbCommand(redisClient *c) {",
          "new_line_content": "    sunionDiffGenericCommand(c,c->argv+2,c->argc-2,c->argv[1],REDIS_OP_DIFF);",
          "content_same": false
        },
        {
          "line": 3698,
          "old_api": null,
          "new_api": "listRelease",
          "old_text": null,
          "new_text": "listRelease(c->reply)",
          "old_line_content": "            c->replstate = REDIS_REPL_WAIT_BGSAVE_END;",
          "new_line_content": "            listRelease(c->reply);",
          "content_same": false
        },
        {
          "line": 3187,
          "old_api": null,
          "new_api": "dictEmpty",
          "old_text": null,
          "new_text": "dictEmpty(c->db->dict)",
          "old_line_content": "}",
          "new_line_content": "    dictEmpty(c->db->dict);",
          "content_same": false
        },
        {
          "line": 3188,
          "old_api": null,
          "new_api": "dictEmpty",
          "old_text": null,
          "new_text": "dictEmpty(c->db->expires)",
          "old_line_content": "",
          "new_line_content": "    dictEmpty(c->db->expires);",
          "content_same": false
        },
        {
          "line": 3189,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "static void flushallCommand(redisClient *c) {",
          "new_line_content": "    addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 3700,
          "old_api": null,
          "new_api": "oom",
          "old_text": null,
          "new_text": "oom(\"listDup copying slave reply list\")",
          "old_line_content": "        } else {",
          "new_line_content": "            if (!c->reply) oom(\"listDup copying slave reply list\");",
          "content_same": false
        },
        {
          "line": 3702,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_NOTICE,\"Waiting for end of BGSAVE for SYNC\")",
          "old_line_content": "             * register differences */",
          "new_line_content": "            redisLog(REDIS_NOTICE,\"Waiting for end of BGSAVE for SYNC\");",
          "content_same": false
        },
        {
          "line": 3193,
          "old_api": null,
          "new_api": "emptyDb",
          "old_text": null,
          "new_text": "emptyDb()",
          "old_line_content": "    server.dirty++;",
          "new_line_content": "    server.dirty += emptyDb();",
          "content_same": false
        },
        {
          "line": 3194,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "}",
          "new_line_content": "    addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 3195,
          "old_api": null,
          "new_api": "rdbSave",
          "old_text": null,
          "new_text": "rdbSave(server.dbfilename)",
          "old_line_content": "",
          "new_line_content": "    rdbSave(server.dbfilename);",
          "content_same": false
        },
        {
          "line": 3707,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_NOTICE,\"Waiting for next BGSAVE for SYNC\")",
          "old_line_content": "        /* Ok we don't have a BGSAVE in progress, let's start one */",
          "new_line_content": "            redisLog(REDIS_NOTICE,\"Waiting for next BGSAVE for SYNC\");",
          "content_same": false
        },
        {
          "line": 3200,
          "old_api": null,
          "new_api": "zmalloc",
          "old_text": null,
          "new_text": "zmalloc(sizeof(*so))",
          "old_line_content": "    so->pattern = pattern;",
          "new_line_content": "    redisSortOperation *so = zmalloc(sizeof(*so));",
          "content_same": false
        },
        {
          "line": 3201,
          "old_api": null,
          "new_api": "oom",
          "old_text": null,
          "new_text": "oom(\"createSortOperation\")",
          "old_line_content": "    return so;",
          "new_line_content": "    if (!so) oom(\"createSortOperation\");",
          "content_same": false
        },
        {
          "line": 3712,
          "old_api": null,
          "new_api": "rdbSaveBackground",
          "old_text": null,
          "new_text": "rdbSaveBackground(server.dbfilename)",
          "old_line_content": "            return;",
          "new_line_content": "        if (rdbSaveBackground(server.dbfilename) != REDIS_OK) {",
          "content_same": false
        },
        {
          "line": 3713,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_NOTICE,\"Replication failed, can't BGSAVE\")",
          "old_line_content": "        }",
          "new_line_content": "            redisLog(REDIS_NOTICE,\"Replication failed, can't BGSAVE\");",
          "content_same": false
        },
        {
          "line": 3714,
          "old_api": null,
          "new_api": "sdsnew",
          "old_text": null,
          "new_text": "sdsnew(\"-ERR Unalbe to perform background save\\r\\n\")",
          "old_line_content": "        c->replstate = REDIS_REPL_WAIT_BGSAVE_END;",
          "new_line_content": "            addReplySds(c,sdsnew(\"-ERR Unalbe to perform background save\\r\\n\"));",
          "content_same": false
        },
        {
          "line": 3722,
          "old_api": null,
          "new_api": "oom",
          "old_text": null,
          "new_text": "oom(\"listAddNodeTail\")",
          "old_line_content": "",
          "new_line_content": "    if (!listAddNodeTail(server.slaves,c)) oom(\"listAddNodeTail\");",
          "content_same": false
        },
        {
          "line": 3728,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(el)",
          "old_line_content": "    ssize_t nwritten, buflen;",
          "new_line_content": "    REDIS_NOTUSED(el);",
          "content_same": false
        },
        {
          "line": 3729,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(mask)",
          "old_line_content": "",
          "new_line_content": "    REDIS_NOTUSED(mask);",
          "content_same": false
        },
        {
          "line": 3223,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(ssub)",
          "old_line_content": "",
          "new_line_content": "    if (sdslen(spat)+sdslen(ssub)-1 > REDIS_SORTKEY_MAX) return NULL;",
          "content_same": false
        },
        {
          "line": 3224,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(spat,'*')",
          "old_line_content": "    prefixlen = p-spat;",
          "new_line_content": "    p = strchr(spat,'*');",
          "content_same": false
        },
        {
          "line": 3740,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "        {",
          "new_line_content": "        bulkcount = sdscatprintf(sdsempty(),\"$%lld\\r\\n\",(unsigned long long)",
          "content_same": false
        },
        {
          "line": 3230,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(keyname.buf,spat,prefixlen)",
          "old_line_content": "    keyname.buf[prefixlen+sublen+postfixlen] = '\\0';",
          "new_line_content": "    memcpy(keyname.buf,spat,prefixlen);",
          "content_same": false
        },
        {
          "line": 3231,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(keyname.buf+prefixlen,ssub,sublen)",
          "old_line_content": "    keyname.len = prefixlen+sublen+postfixlen;",
          "new_line_content": "    memcpy(keyname.buf+prefixlen,ssub,sublen);",
          "content_same": false
        },
        {
          "line": 3232,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(keyname.buf+prefixlen+sublen,p+1,postfixlen)",
          "old_line_content": "",
          "new_line_content": "    memcpy(keyname.buf+prefixlen+sublen,p+1,postfixlen);",
          "content_same": false
        },
        {
          "line": 3744,
          "old_api": null,
          "new_api": "sdsfree",
          "old_text": null,
          "new_text": "sdsfree(bulkcount)",
          "old_line_content": "        }",
          "new_line_content": "            sdsfree(bulkcount);",
          "content_same": false
        },
        {
          "line": 3241,
          "old_api": null,
          "new_api": "lookupKeyRead",
          "old_text": null,
          "new_text": "lookupKeyRead(db,&keyobj)",
          "old_line_content": "/* sortCompare() is used by qsort in sortCommand(). Given that qsort_r with",
          "new_line_content": "    return lookupKeyRead(db,&keyobj);",
          "content_same": false
        },
        {
          "line": 3753,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"Read error sending DB to slave: %s\",\n            (buflen == 0) ? \"premature EOF\" : strerror(errno))",
          "old_line_content": "        return;",
          "new_line_content": "        redisLog(REDIS_WARNING,\"Read error sending DB to slave: %s\",",
          "content_same": false
        },
        {
          "line": 3754,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "    }",
          "new_line_content": "            (buflen == 0) ? \"premature EOF\" : strerror(errno));",
          "content_same": false
        },
        {
          "line": 3759,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_DEBUG,\"Write error sending DB to slave: %s\",\n            strerror(errno))",
          "old_line_content": "        return;",
          "new_line_content": "        redisLog(REDIS_DEBUG,\"Write error sending DB to slave: %s\",",
          "content_same": false
        },
        {
          "line": 3760,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "    }",
          "new_line_content": "            strerror(errno));",
          "content_same": false
        },
        {
          "line": 3761,
          "old_api": null,
          "new_api": "freeClient",
          "old_text": null,
          "new_text": "freeClient(slave)",
          "old_line_content": "    slave->repldboff += nwritten;",
          "new_line_content": "        freeClient(slave);",
          "content_same": false
        },
        {
          "line": 3766,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(slave->repldbfd)",
          "old_line_content": "        slave->replstate = REDIS_REPL_ONLINE;",
          "new_line_content": "        close(slave->repldbfd);",
          "content_same": false
        },
        {
          "line": 3768,
          "old_api": null,
          "new_api": "aeDeleteFileEvent",
          "old_text": null,
          "new_text": "aeDeleteFileEvent(server.el,slave->fd,AE_WRITABLE)",
          "old_line_content": "            sendReplyToClient, slave, NULL) == AE_ERR) {",
          "new_line_content": "        aeDeleteFileEvent(server.el,slave->fd,AE_WRITABLE);",
          "content_same": false
        },
        {
          "line": 3770,
          "old_api": null,
          "new_api": "aeCreateFileEvent",
          "old_text": null,
          "new_text": "aeCreateFileEvent(server.el, slave->fd, AE_WRITABLE,\n            sendReplyToClient, slave, NULL)",
          "old_line_content": "            return;",
          "new_line_content": "        if (aeCreateFileEvent(server.el, slave->fd, AE_WRITABLE,",
          "content_same": false
        },
        {
          "line": 3775,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "}",
          "new_line_content": "        addReplySds(slave,sdsempty());",
          "content_same": false
        },
        {
          "line": 3776,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_NOTICE,\"Synchronization with slave succeeded\")",
          "old_line_content": "",
          "new_line_content": "        redisLog(REDIS_NOTICE,\"Synchronization with slave succeeded\");",
          "content_same": false
        },
        {
          "line": 3784,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(server.slaves)",
          "old_line_content": "",
          "new_line_content": "    listRewind(server.slaves);",
          "content_same": false
        },
        {
          "line": 3273,
          "old_api": null,
          "new_api": "strcoll",
          "old_text": null,
          "new_text": "strcoll(so1->u.cmpobj->ptr,so2->u.cmpobj->ptr)",
          "old_line_content": "            /* Compare elements directly */",
          "new_line_content": "                cmp = strcoll(so1->u.cmpobj->ptr,so2->u.cmpobj->ptr);",
          "content_same": false
        },
        {
          "line": 3785,
          "old_api": null,
          "new_api": "listYield",
          "old_text": null,
          "new_text": "listYield(server.slaves)",
          "old_line_content": "        if (slave->replstate == REDIS_REPL_WAIT_BGSAVE_START) {",
          "new_line_content": "    while((ln = listYield(server.slaves))) {",
          "content_same": false
        },
        {
          "line": 3277,
          "old_api": null,
          "new_api": "strcoll",
          "old_text": null,
          "new_text": "strcoll(so1->obj->ptr,so2->obj->ptr)",
          "old_line_content": "    return server.sort_desc ? -cmp : cmp;",
          "new_line_content": "            cmp = strcoll(so1->obj->ptr,so2->obj->ptr);",
          "content_same": false
        },
        {
          "line": 3795,
          "old_api": null,
          "new_api": "freeClient",
          "old_text": null,
          "new_text": "freeClient(slave)",
          "old_line_content": "            }",
          "new_line_content": "                freeClient(slave);",
          "content_same": false
        },
        {
          "line": 3800,
          "old_api": null,
          "new_api": "fstat",
          "old_text": null,
          "new_text": "fstat(slave->repldbfd,&buf)",
          "old_line_content": "                continue;",
          "new_line_content": "                fstat(slave->repldbfd,&buf) == -1) {",
          "content_same": false
        },
        {
          "line": 3801,
          "old_api": null,
          "new_api": "freeClient",
          "old_text": null,
          "new_text": "freeClient(slave)",
          "old_line_content": "            }",
          "new_line_content": "                freeClient(slave);",
          "content_same": false
        },
        {
          "line": 3802,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "            slave->repldboff = 0;",
          "new_line_content": "                redisLog(REDIS_WARNING,\"SYNC failed. Can't open/stat DB after BGSAVE: %s\", strerror(errno));",
          "content_same": false
        },
        {
          "line": 3296,
          "old_api": null,
          "new_api": "lookupKeyRead",
          "old_text": null,
          "new_text": "lookupKeyRead(c->db,c->argv[1])",
          "old_line_content": "        return;",
          "new_line_content": "    sortval = lookupKeyRead(c->db,c->argv[1]);",
          "content_same": false
        },
        {
          "line": 3808,
          "old_api": null,
          "new_api": "aeDeleteFileEvent",
          "old_text": null,
          "new_text": "aeDeleteFileEvent(server.el,slave->fd,AE_WRITABLE)",
          "old_line_content": "                continue;",
          "new_line_content": "            aeDeleteFileEvent(server.el,slave->fd,AE_WRITABLE);",
          "content_same": false
        },
        {
          "line": 3298,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.nokeyerr)",
          "old_line_content": "    if (sortval->type != REDIS_SET && sortval->type != REDIS_LIST) {",
          "new_line_content": "        addReply(c,shared.nokeyerr);",
          "content_same": false
        },
        {
          "line": 3809,
          "old_api": null,
          "new_api": "aeCreateFileEvent",
          "old_text": null,
          "new_text": "aeCreateFileEvent(server.el, slave->fd, AE_WRITABLE, sendBulkToSlave, slave, NULL)",
          "old_line_content": "            }",
          "new_line_content": "            if (aeCreateFileEvent(server.el, slave->fd, AE_WRITABLE, sendBulkToSlave, slave, NULL) == AE_ERR) {",
          "content_same": false
        },
        {
          "line": 3810,
          "old_api": null,
          "new_api": "freeClient",
          "old_text": null,
          "new_text": "freeClient(slave)",
          "old_line_content": "        }",
          "new_line_content": "                freeClient(slave);",
          "content_same": false
        },
        {
          "line": 3302,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.wrongtypeerr)",
          "old_line_content": "",
          "new_line_content": "        addReply(c,shared.wrongtypeerr);",
          "content_same": false
        },
        {
          "line": 3817,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(server.slaves)",
          "old_line_content": "                redisClient *slave = ln->value;",
          "new_line_content": "            listRewind(server.slaves);",
          "content_same": false
        },
        {
          "line": 3818,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"SYNC failed. BGSAVE failed\")",
          "old_line_content": "",
          "new_line_content": "            redisLog(REDIS_WARNING,\"SYNC failed. BGSAVE failed\");",
          "content_same": false
        },
        {
          "line": 3819,
          "old_api": null,
          "new_api": "listYield",
          "old_text": null,
          "new_text": "listYield(server.slaves)",
          "old_line_content": "                if (slave->replstate == REDIS_REPL_WAIT_BGSAVE_START)",
          "new_line_content": "            while((ln = listYield(server.slaves))) {",
          "content_same": false
        },
        {
          "line": 3308,
          "old_api": null,
          "new_api": "listCreate",
          "old_text": null,
          "new_text": "listCreate()",
          "old_line_content": "",
          "new_line_content": "    operations = listCreate();",
          "content_same": false
        },
        {
          "line": 3309,
          "old_api": null,
          "new_api": "listSetFreeMethod",
          "old_text": null,
          "new_text": "listSetFreeMethod(operations,zfree)",
          "old_line_content": "    /* Now we need to protect sortval incrementing its count, in the future",
          "new_line_content": "    listSetFreeMethod(operations,zfree);",
          "content_same": false
        },
        {
          "line": 3823,
          "old_api": null,
          "new_api": "freeClient",
          "old_text": null,
          "new_text": "freeClient(slave)",
          "old_line_content": "    }",
          "new_line_content": "                    freeClient(slave);",
          "content_same": false
        },
        {
          "line": 3315,
          "old_api": null,
          "new_api": "incrRefCount",
          "old_text": null,
          "new_text": "incrRefCount(sortval)",
          "old_line_content": "    while(j < c->argc) {",
          "new_line_content": "    incrRefCount(sortval);",
          "content_same": false
        },
        {
          "line": 3320,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(c->argv[j]->ptr,\"asc\")",
          "old_line_content": "            desc = 1;",
          "new_line_content": "        if (!strcasecmp(c->argv[j]->ptr,\"asc\")) {",
          "content_same": false
        },
        {
          "line": 3832,
          "old_api": null,
          "new_api": "anetTcpConnect",
          "old_text": null,
          "new_text": "anetTcpConnect(NULL,server.masterhost,server.masterport)",
          "old_line_content": "    if (fd == -1) {",
          "new_line_content": "    int fd = anetTcpConnect(NULL,server.masterhost,server.masterport);",
          "content_same": false
        },
        {
          "line": 3322,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(c->argv[j]->ptr,\"desc\")",
          "old_line_content": "            alpha = 1;",
          "new_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"desc\")) {",
          "content_same": false
        },
        {
          "line": 3836,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"Unable to connect to MASTER: %s\",\n            strerror(errno))",
          "old_line_content": "    }",
          "new_line_content": "        redisLog(REDIS_WARNING,\"Unable to connect to MASTER: %s\",",
          "content_same": false
        },
        {
          "line": 3837,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "    /* Issue the SYNC command */",
          "new_line_content": "            strerror(errno));",
          "content_same": false
        },
        {
          "line": 3326,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(c->argv[j]->ptr,\"limit\")",
          "old_line_content": "            j+=2;",
          "new_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"limit\") && leftargs >= 2) {",
          "content_same": false
        },
        {
          "line": 3328,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(c->argv[j+2]->ptr)",
          "old_line_content": "            sortby = c->argv[j+1];",
          "new_line_content": "            limit_count = atoi(c->argv[j+2]->ptr);",
          "content_same": false
        },
        {
          "line": 3330,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(c->argv[j]->ptr,\"by\")",
          "old_line_content": "             * we don't need to sort nor to lookup the weight keys. */",
          "new_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"by\") && leftargs >= 1) {",
          "content_same": false
        },
        {
          "line": 3842,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "        return REDIS_ERR;",
          "new_line_content": "        close(fd);",
          "content_same": false
        },
        {
          "line": 3843,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"I/O error writing to MASTER: %s\",\n            strerror(errno))",
          "old_line_content": "    }",
          "new_line_content": "        redisLog(REDIS_WARNING,\"I/O error writing to MASTER: %s\",",
          "content_same": false
        },
        {
          "line": 3844,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "    /* Read the bulk write count */",
          "new_line_content": "            strerror(errno));",
          "content_same": false
        },
        {
          "line": 3336,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(c->argv[j]->ptr,\"get\")",
          "old_line_content": "            getop++;",
          "new_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"get\") && leftargs >= 1) {",
          "content_same": false
        },
        {
          "line": 3337,
          "old_api": null,
          "new_api": "createSortOperation",
          "old_text": null,
          "new_text": "createSortOperation(\n                REDIS_SORT_GET,c->argv[j+1])",
          "old_line_content": "            j++;",
          "new_line_content": "            listAddNodeTail(operations,createSortOperation(",
          "content_same": false
        },
        {
          "line": 3849,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "        return REDIS_ERR;",
          "new_line_content": "        close(fd);",
          "content_same": false
        },
        {
          "line": 3850,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"I/O error reading bulk count from MASTER: %s\",\n            strerror(errno))",
          "old_line_content": "    }",
          "new_line_content": "        redisLog(REDIS_WARNING,\"I/O error reading bulk count from MASTER: %s\",",
          "content_same": false
        },
        {
          "line": 3341,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(c->argv[j]->ptr,\"del\")",
          "old_line_content": "            j++;",
          "new_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"del\") && leftargs >= 1) {",
          "content_same": false
        },
        {
          "line": 3345,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(c->argv[j]->ptr,\"incr\")",
          "old_line_content": "            j++;",
          "new_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"incr\") && leftargs >= 1) {",
          "content_same": false
        },
        {
          "line": 3860,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "    }",
          "new_line_content": "        close(fd);",
          "content_same": false
        },
        {
          "line": 3349,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(c->argv[j]->ptr,\"get\")",
          "old_line_content": "            j++;",
          "new_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"get\") && leftargs >= 1) {",
          "content_same": false
        },
        {
          "line": 3350,
          "old_api": null,
          "new_api": "createSortOperation",
          "old_text": null,
          "new_text": "createSortOperation(\n                REDIS_SORT_DECR,c->argv[j+1])",
          "old_line_content": "        } else {",
          "new_line_content": "            listAddNodeTail(operations,createSortOperation(",
          "content_same": false
        },
        {
          "line": 3861,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "    while(dumpsize) {",
          "new_line_content": "        redisLog(REDIS_WARNING,\"Opening the temp file needed for MASTER <-> SLAVE synchronization: %s\",strerror(errno));",
          "content_same": false
        },
        {
          "line": 3354,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(sortval)",
          "old_line_content": "            return;",
          "new_line_content": "            decrRefCount(sortval);",
          "content_same": false
        },
        {
          "line": 3355,
          "old_api": null,
          "new_api": "listRelease",
          "old_text": null,
          "new_text": "listRelease(operations)",
          "old_line_content": "        }",
          "new_line_content": "            listRelease(operations);",
          "content_same": false
        },
        {
          "line": 3356,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.syntaxerr)",
          "old_line_content": "        j++;",
          "new_line_content": "            addReply(c,shared.syntaxerr);",
          "content_same": false
        },
        {
          "line": 3870,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "            return REDIS_ERR;",
          "new_line_content": "                strerror(errno));",
          "content_same": false
        },
        {
          "line": 3871,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "        }",
          "new_line_content": "            close(fd);",
          "content_same": false
        },
        {
          "line": 3365,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize((dict*)sortval->ptr)",
          "old_line_content": "    j = 0;",
          "new_line_content": "        dictSize((dict*)sortval->ptr);",
          "content_same": false
        },
        {
          "line": 3366,
          "old_api": null,
          "new_api": "zmalloc",
          "old_text": null,
          "new_text": "zmalloc(sizeof(redisSortObject)*vectorlen)",
          "old_line_content": "    if (sortval->type == REDIS_LIST) {",
          "new_line_content": "    vector = zmalloc(sizeof(redisSortObject)*vectorlen);",
          "content_same": false
        },
        {
          "line": 3367,
          "old_api": null,
          "new_api": "oom",
          "old_text": null,
          "new_text": "oom(\"allocating objects vector for SORT\")",
          "old_line_content": "        list *list = sortval->ptr;",
          "new_line_content": "    if (!vector) oom(\"allocating objects vector for SORT\");",
          "content_same": false
        },
        {
          "line": 3877,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "            return REDIS_ERR;",
          "new_line_content": "            redisLog(REDIS_WARNING,\"Write error writing to the DB dump file needed for MASTER <-> SLAVE synchrnonization: %s\", strerror(errno));",
          "content_same": false
        },
        {
          "line": 3878,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "        }",
          "new_line_content": "            close(fd);",
          "content_same": false
        },
        {
          "line": 3879,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(dfd)",
          "old_line_content": "        dumpsize -= nread;",
          "new_line_content": "            close(dfd);",
          "content_same": false
        },
        {
          "line": 3373,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(list)",
          "old_line_content": "            vector[j].obj = ele;",
          "new_line_content": "        listRewind(list);",
          "content_same": false
        },
        {
          "line": 3374,
          "old_api": null,
          "new_api": "listYield",
          "old_text": null,
          "new_text": "listYield(list)",
          "old_line_content": "            vector[j].u.score = 0;",
          "new_line_content": "        while((ln = listYield(list))) {",
          "content_same": false
        },
        {
          "line": 3886,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "        return REDIS_ERR;",
          "new_line_content": "        redisLog(REDIS_WARNING,\"Failed trying to rename the temp DB into dump.rdb in MASTER <-> SLAVE synchronization: %s\", strerror(errno));",
          "content_same": false
        },
        {
          "line": 3887,
          "old_api": null,
          "new_api": "unlink",
          "old_text": null,
          "new_text": "unlink(tmpfile)",
          "old_line_content": "    }",
          "new_line_content": "        unlink(tmpfile);",
          "content_same": false
        },
        {
          "line": 3892,
          "old_api": null,
          "new_api": "rdbLoad",
          "old_text": null,
          "new_text": "rdbLoad(server.dbfilename)",
          "old_line_content": "        return REDIS_ERR;",
          "new_line_content": "    if (rdbLoad(server.dbfilename) != REDIS_OK) {",
          "content_same": false
        },
        {
          "line": 3893,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"Failed trying to load the MASTER synchronization DB from disk\")",
          "old_line_content": "    }",
          "new_line_content": "        redisLog(REDIS_WARNING,\"Failed trying to load the MASTER synchronization DB from disk\");",
          "content_same": false
        },
        {
          "line": 3897,
          "old_api": null,
          "new_api": "createClient",
          "old_text": null,
          "new_text": "createClient(fd)",
          "old_line_content": "    return REDIS_OK;",
          "new_line_content": "    server.master = createClient(fd);",
          "content_same": false
        },
        {
          "line": 3387,
          "old_api": null,
          "new_api": "oom",
          "old_text": null,
          "new_text": "oom(\"dictGetIterator\")",
          "old_line_content": "            vector[j].u.score = 0;",
          "new_line_content": "        if (!di) oom(\"dictGetIterator\");",
          "content_same": false
        },
        {
          "line": 3388,
          "old_api": null,
          "new_api": "dictNext",
          "old_text": null,
          "new_text": "dictNext(di)",
          "old_line_content": "            vector[j].u.cmpobj = NULL;",
          "new_line_content": "        while((setele = dictNext(di)) != NULL) {",
          "content_same": false
        },
        {
          "line": 3389,
          "old_api": null,
          "new_api": "dictGetEntryKey",
          "old_text": null,
          "new_text": "dictGetEntryKey(setele)",
          "old_line_content": "            j++;",
          "new_line_content": "            vector[j].obj = dictGetEntryKey(setele);",
          "content_same": false
        },
        {
          "line": 3394,
          "old_api": null,
          "new_api": "dictReleaseIterator",
          "old_text": null,
          "new_text": "dictReleaseIterator(di)",
          "old_line_content": "",
          "new_line_content": "        dictReleaseIterator(di);",
          "content_same": false
        },
        {
          "line": 3907,
          "old_api": null,
          "new_api": "fopen",
          "old_text": null,
          "new_text": "fopen(\"/proc/sys/vm/overcommit_memory\",\"r\")",
          "old_line_content": "    if (!fp) return -1;",
          "new_line_content": "    FILE *fp = fopen(\"/proc/sys/vm/overcommit_memory\",\"r\");",
          "content_same": false
        },
        {
          "line": 3396,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(j == vectorlen)",
          "old_line_content": "    if (dontsort == 0) {",
          "new_line_content": "    assert(j == vectorlen);",
          "content_same": false
        },
        {
          "line": 3911,
          "old_api": null,
          "new_api": "fgets",
          "old_text": null,
          "new_text": "fgets(buf,64,fp)",
          "old_line_content": "    }",
          "new_line_content": "    if (fgets(buf,64,fp) == NULL) {",
          "content_same": false
        },
        {
          "line": 3915,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(fp)",
          "old_line_content": "}",
          "new_line_content": "    fclose(fp);",
          "content_same": false
        },
        {
          "line": 3404,
          "old_api": null,
          "new_api": "lookupKeyByPattern",
          "old_text": null,
          "new_text": "lookupKeyByPattern(c->db,sortby,vector[j].obj)",
          "old_line_content": "                    vector[j].u.cmpobj = byval;",
          "new_line_content": "                byval = lookupKeyByPattern(c->db,sortby,vector[j].obj);",
          "content_same": false
        },
        {
          "line": 3917,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(buf)",
          "old_line_content": "void linuxOvercommitMemoryWarning(void) {",
          "new_line_content": "    return atoi(buf);",
          "content_same": false
        },
        {
          "line": 3408,
          "old_api": null,
          "new_api": "incrRefCount",
          "old_text": null,
          "new_text": "incrRefCount(byval)",
          "old_line_content": "                }",
          "new_line_content": "                    incrRefCount(byval);",
          "content_same": false
        },
        {
          "line": 3921,
          "old_api": null,
          "new_api": "linuxOvercommitMemoryValue",
          "old_text": null,
          "new_text": "linuxOvercommitMemoryValue()",
          "old_line_content": "}",
          "new_line_content": "    if (linuxOvercommitMemoryValue() == 0) {",
          "content_same": false
        },
        {
          "line": 3922,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"WARNING overcommit_memory is set to 0! Background save may fail under low condition memory. To fix this issue add 'echo 1 > /proc/sys/vm/overcommit_memory' in your init scripts.\")",
          "old_line_content": "#endif /* __linux__ */",
          "new_line_content": "        redisLog(REDIS_WARNING,\"WARNING overcommit_memory is set to 0! Background save may fail under low condition memory. To fix this issue add 'echo 1 > /proc/sys/vm/overcommit_memory' in your init scripts.\");",
          "content_same": false
        },
        {
          "line": 3413,
          "old_api": null,
          "new_api": "strtod",
          "old_text": null,
          "new_text": "strtod(vector[j].obj->ptr,NULL)",
          "old_line_content": "    }",
          "new_line_content": "                if (!alpha) vector[j].u.score = strtod(vector[j].obj->ptr,NULL);",
          "content_same": false
        },
        {
          "line": 3931,
          "old_api": null,
          "new_api": "exit",
          "old_text": null,
          "new_text": "exit(0)",
          "old_line_content": "    /* Every output goes to /dev/null. If Redis is daemonized but",
          "new_line_content": "    if (fork() != 0) exit(0); /* parent exits */",
          "content_same": false
        },
        {
          "line": 3932,
          "old_api": null,
          "new_api": "setsid",
          "old_text": null,
          "new_text": "setsid()",
          "old_line_content": "     * the 'logfile' is set to 'stdout' in the configuration file",
          "new_line_content": "    setsid(); /* create a new session */",
          "content_same": false
        },
        {
          "line": 3939,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(fd, STDOUT_FILENO)",
          "old_line_content": "    }",
          "new_line_content": "        dup2(fd, STDOUT_FILENO);",
          "content_same": false
        },
        {
          "line": 3940,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(fd, STDERR_FILENO)",
          "old_line_content": "    /* Try to write the pid file */",
          "new_line_content": "        dup2(fd, STDERR_FILENO);",
          "content_same": false
        },
        {
          "line": 3432,
          "old_api": null,
          "new_api": "qsort",
          "old_text": null,
          "new_text": "qsort(vector,vectorlen,sizeof(redisSortObject),sortCompare)",
          "old_line_content": "    /* Send command output to the output buffer, performing the specified",
          "new_line_content": "        qsort(vector,vectorlen,sizeof(redisSortObject),sortCompare);",
          "content_same": false
        },
        {
          "line": 3946,
          "old_api": null,
          "new_api": "getpid",
          "old_text": null,
          "new_text": "getpid()",
          "old_line_content": "}",
          "new_line_content": "        fprintf(fp,\"%d\\n\",getpid());",
          "content_same": false
        },
        {
          "line": 3947,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(fp)",
          "old_line_content": "",
          "new_line_content": "        fclose(fp);",
          "content_same": false
        },
        {
          "line": 3438,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "        if (!getop) {",
          "new_line_content": "    addReplySds(c,sdscatprintf(sdsempty(),\"*%d\\r\\n\",outputlen));",
          "content_same": false
        },
        {
          "line": 3443,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(vector[j].obj->ptr)",
          "old_line_content": "        }",
          "new_line_content": "                sdslen(vector[j].obj->ptr)));",
          "content_same": false
        },
        {
          "line": 3448,
          "old_api": null,
          "new_api": "listYield",
          "old_text": null,
          "new_text": "listYield(operations)",
          "old_line_content": "                vector[j].obj);",
          "new_line_content": "        while((ln = listYield(operations))) {",
          "content_same": false
        },
        {
          "line": 3450,
          "old_api": null,
          "new_api": "lookupKeyByPattern",
          "old_text": null,
          "new_text": "lookupKeyByPattern(c->db,sop->pattern,\n                vector[j].obj)",
          "old_line_content": "            if (sop->type == REDIS_SORT_GET) {",
          "new_line_content": "            robj *val = lookupKeyByPattern(c->db,sop->pattern,",
          "content_same": false
        },
        {
          "line": 3458,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(val->ptr)",
          "old_line_content": "                }",
          "new_line_content": "                        sdslen(val->ptr)));",
          "content_same": false
        },
        {
          "line": 3459,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,val)",
          "old_line_content": "            } else if (sop->type == REDIS_SORT_DEL) {",
          "new_line_content": "                    addReply(c,val);",
          "content_same": false
        },
        {
          "line": 3460,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.crlf)",
          "old_line_content": "                /* TODO */",
          "new_line_content": "                    addReply(c,shared.crlf);",
          "content_same": false
        },
        {
          "line": 3971,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_NOTICE,\"The server is now ready to accept connections on port %d\", server.port)",
          "old_line_content": "    return 0;",
          "new_line_content": "    redisLog(REDIS_NOTICE,\"The server is now ready to accept connections on port %d\", server.port);",
          "content_same": false
        },
        {
          "line": 3972,
          "old_api": null,
          "new_api": "aeMain",
          "old_text": null,
          "new_text": "aeMain(server.el)",
          "old_line_content": "}",
          "new_line_content": "    aeMain(server.el);",
          "content_same": false
        },
        {
          "line": 3973,
          "old_api": null,
          "new_api": "aeDeleteEventLoop",
          "old_text": null,
          "new_text": "aeDeleteEventLoop(server.el)",
          "old_line_content": "",
          "new_line_content": "    aeDeleteEventLoop(server.el);",
          "content_same": false
        },
        {
          "line": 3469,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(sortval)",
          "old_line_content": "        if (sortby && alpha && vector[j].u.cmpobj)",
          "new_line_content": "    decrRefCount(sortval);",
          "content_same": false
        },
        {
          "line": 3473,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(vector[j].u.cmpobj)",
          "old_line_content": "}",
          "new_line_content": "            decrRefCount(vector[j].u.cmpobj);",
          "content_same": false
        },
        {
          "line": 3475,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(vector)",
          "old_line_content": "static void infoCommand(redisClient *c) {",
          "new_line_content": "    zfree(vector);",
          "content_same": false
        },
        {
          "line": 3480,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "        \"redis_version:%s\\r\\n\"",
          "new_line_content": "    time_t uptime = time(NULL)-server.stat_starttime;",
          "content_same": false
        },
        {
          "line": 3482,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "        \"connected_slaves:%d\\r\\n\"",
          "new_line_content": "    info = sdscatprintf(sdsempty(),",
          "content_same": false
        },
        {
          "line": 3495,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(server.slaves)",
          "old_line_content": "        server.dirty,",
          "new_line_content": "        listLength(server.clients)-listLength(server.slaves),",
          "content_same": false
        },
        {
          "line": 3496,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(server.slaves)",
          "old_line_content": "        server.bgsaveinprogress,",
          "new_line_content": "        listLength(server.slaves),",
          "content_same": false
        },
        {
          "line": 3506,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(info)",
          "old_line_content": "}",
          "new_line_content": "    addReplySds(c,sdscatprintf(sdsempty(),\"$%d\\r\\n\",sdslen(info)));",
          "content_same": false
        },
        {
          "line": 3507,
          "old_api": null,
          "new_api": "addReplySds",
          "old_text": null,
          "new_text": "addReplySds(c,info)",
          "old_line_content": "",
          "new_line_content": "    addReplySds(c,info);",
          "content_same": false
        },
        {
          "line": 3508,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.crlf)",
          "old_line_content": "static void monitorCommand(redisClient *c) {",
          "new_line_content": "    addReply(c,shared.crlf);",
          "content_same": false
        },
        {
          "line": 3517,
          "old_api": null,
          "new_api": "oom",
          "old_text": null,
          "new_text": "oom(\"listAddNodeTail\")",
          "old_line_content": "",
          "new_line_content": "    if (!listAddNodeTail(server.monitors,c)) oom(\"listAddNodeTail\");",
          "content_same": false
        },
        {
          "line": 3518,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "/* ================================= Expire ================================= */",
          "new_line_content": "    addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 3523,
          "old_api": null,
          "new_api": "dictDelete",
          "old_text": null,
          "new_text": "dictDelete(db->expires,key)",
          "old_line_content": "        return 0;",
          "new_line_content": "    if (dictDelete(db->expires,key) == DICT_OK) {",
          "content_same": false
        },
        {
          "line": 3534,
          "old_api": null,
          "new_api": "incrRefCount",
          "old_text": null,
          "new_text": "incrRefCount(key)",
          "old_line_content": "}",
          "new_line_content": "        incrRefCount(key);",
          "content_same": false
        },
        {
          "line": 3546,
          "old_api": null,
          "new_api": "dictFind",
          "old_text": null,
          "new_text": "dictFind(db->expires,key)",
          "old_line_content": "}",
          "new_line_content": "       (de = dictFind(db->expires,key)) == NULL) return -1;",
          "content_same": false
        },
        {
          "line": 3548,
          "old_api": null,
          "new_api": "dictGetEntryVal",
          "old_text": null,
          "new_text": "dictGetEntryVal(de)",
          "old_line_content": "static int expireIfNeeded(redisDb *db, robj *key) {",
          "new_line_content": "    return (time_t) dictGetEntryVal(de);",
          "content_same": false
        },
        {
          "line": 3556,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(db->expires)",
          "old_line_content": "    /* Lookup the expire */",
          "new_line_content": "    if (dictSize(db->expires) == 0 ||",
          "content_same": false
        },
        {
          "line": 3560,
          "old_api": null,
          "new_api": "dictGetEntryVal",
          "old_text": null,
          "new_text": "dictGetEntryVal(de)",
          "old_line_content": "    /* Delete the key */",
          "new_line_content": "    when = (time_t) dictGetEntryVal(de);",
          "content_same": false
        },
        {
          "line": 3564,
          "old_api": null,
          "new_api": "dictDelete",
          "old_text": null,
          "new_text": "dictDelete(db->expires,key)",
          "old_line_content": "",
          "new_line_content": "    dictDelete(db->expires,key);",
          "content_same": false
        },
        {
          "line": 3565,
          "old_api": null,
          "new_api": "dictDelete",
          "old_text": null,
          "new_text": "dictDelete(db->dict,key)",
          "old_line_content": "static int deleteIfVolatile(redisDb *db, robj *key) {",
          "new_line_content": "    return dictDelete(db->dict,key) == DICT_OK;",
          "content_same": false
        },
        {
          "line": 3572,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(db->expires)",
          "old_line_content": "    /* Delete the key */",
          "new_line_content": "    if (dictSize(db->expires) == 0 ||",
          "content_same": false
        },
        {
          "line": 3573,
          "old_api": null,
          "new_api": "dictFind",
          "old_text": null,
          "new_text": "dictFind(db->expires,key)",
          "old_line_content": "    server.dirty++;",
          "new_line_content": "       (de = dictFind(db->expires,key)) == NULL) return 0;",
          "content_same": false
        },
        {
          "line": 3577,
          "old_api": null,
          "new_api": "dictDelete",
          "old_text": null,
          "new_text": "dictDelete(db->expires,key)",
          "old_line_content": "",
          "new_line_content": "    dictDelete(db->expires,key);",
          "content_same": false
        },
        {
          "line": 3578,
          "old_api": null,
          "new_api": "dictDelete",
          "old_text": null,
          "new_text": "dictDelete(db->dict,key)",
          "old_line_content": "static void expireCommand(redisClient *c) {",
          "new_line_content": "    return dictDelete(db->dict,key) == DICT_OK;",
          "content_same": false
        },
        {
          "line": 3583,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(c->argv[2]->ptr)",
          "old_line_content": "    if (de == NULL) {",
          "new_line_content": "    int seconds = atoi(c->argv[2]->ptr);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 3584,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.czero)",
          "new_text": null,
          "old_line_content": "        addReply(c,shared.czero);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3588,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c, shared.czero)",
          "new_text": null,
          "old_line_content": "        addReply(c, shared.czero);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 3592,
          "old_api": "setExpire",
          "new_api": null,
          "old_text": "setExpire(c->db,c->argv[1],when)",
          "new_text": null,
          "old_line_content": "        if (setExpire(c->db,c->argv[1],when))",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 3593,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.cone)",
          "new_text": null,
          "old_line_content": "            addReply(c,shared.cone);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 3604,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "    time_t start = time(NULL);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3608,
          "old_api": "aeWait",
          "new_api": null,
          "old_text": "aeWait(fd,AE_WRITABLE,1000)",
          "new_text": null,
          "old_line_content": "        if (aeWait(fd,AE_WRITABLE,1000) & AE_WRITABLE) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3609,
          "old_api": "write",
          "new_api": null,
          "old_text": "write(fd,ptr,size)",
          "new_text": null,
          "old_line_content": "            nwritten = write(fd,ptr,size);",
          "new_line_content": "    timeout++;",
          "content_same": false
        },
        {
          "line": 3614,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "        if ((time(NULL)-start) > timeout) {",
          "new_line_content": "            ptr += nwritten;",
          "content_same": false
        },
        {
          "line": 3624,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "    time_t start = time(NULL);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3628,
          "old_api": "aeWait",
          "new_api": null,
          "old_text": "aeWait(fd,AE_READABLE,1000)",
          "new_text": null,
          "old_line_content": "        if (aeWait(fd,AE_READABLE,1000) & AE_READABLE) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3117,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(dv[j])",
          "new_text": null,
          "old_line_content": "        di = dictGetIterator(dv[j]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3629,
          "old_api": "read",
          "new_api": null,
          "old_text": "read(fd,ptr,size)",
          "new_text": null,
          "old_line_content": "            nread = read(fd,ptr,size);",
          "new_line_content": "    timeout++;",
          "content_same": false
        },
        {
          "line": 3120,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "        while((de = dictNext(di)) != NULL) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3635,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "        if ((time(NULL)-start) > timeout) {",
          "new_line_content": "            size -= nread;",
          "content_same": false
        },
        {
          "line": 3124,
          "old_api": "dictGetEntryKey",
          "new_api": null,
          "old_text": "dictGetEntryKey(de)",
          "new_text": null,
          "old_line_content": "            ele = dictGetEntryKey(de);",
          "new_line_content": "            /* dictAdd will not add the same element multiple times */",
          "content_same": false
        },
        {
          "line": 3126,
          "old_api": "dictAdd",
          "new_api": null,
          "old_text": "dictAdd(dstset->ptr,ele,NULL)",
          "new_text": null,
          "old_line_content": "                if (dictAdd(dstset->ptr,ele,NULL) == DICT_OK) {",
          "new_line_content": "            if (op == REDIS_OP_UNION || j == 0) {",
          "content_same": false
        },
        {
          "line": 3131,
          "old_api": "dictDelete",
          "new_api": null,
          "old_text": "dictDelete(dstset->ptr,ele)",
          "new_text": null,
          "old_line_content": "                if (dictDelete(dstset->ptr,ele) == DICT_OK) {",
          "new_line_content": "            } else if (op == REDIS_OP_DIFF) {",
          "content_same": false
        },
        {
          "line": 3136,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "        dictReleaseIterator(di);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3650,
          "old_api": "syncRead",
          "new_api": null,
          "old_text": "syncRead(fd,&c,1,timeout)",
          "new_text": null,
          "old_line_content": "        if (syncRead(fd,&c,1,timeout) == -1) return -1;",
          "new_line_content": "    while(size) {",
          "content_same": false
        },
        {
          "line": 3141,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "        addReplySds(c,sdscatprintf(sdsempty(),\"*%d\\r\\n\",cardinality));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3142,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(dstset->ptr)",
          "new_text": null,
          "old_line_content": "        di = dictGetIterator(dstset->ptr);",
          "new_line_content": "    /* Output the content of the resulting set, if not in STORE mode */",
          "content_same": false
        },
        {
          "line": 3143,
          "old_api": "oom",
          "new_api": null,
          "old_text": "oom(\"dictGetIterator\")",
          "new_text": null,
          "old_line_content": "        if (!di) oom(\"dictGetIterator\");",
          "new_line_content": "    if (!dstkey) {",
          "content_same": false
        },
        {
          "line": 3148,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "            addReplySds(c,sdscatprintf(sdsempty(),",
          "new_line_content": "            robj *ele;",
          "content_same": false
        },
        {
          "line": 3149,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(ele->ptr)",
          "new_text": null,
          "old_line_content": "                    \"$%d\\r\\n\",sdslen(ele->ptr)));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3158,
          "old_api": "decrRefCount",
          "new_api": null,
          "old_text": "decrRefCount(dstset)",
          "new_text": null,
          "old_line_content": "        decrRefCount(dstset);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3160,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.ok)",
          "new_text": null,
          "old_line_content": "        addReply(c,shared.ok);",
          "new_line_content": "    if (!dstkey) {",
          "content_same": false
        },
        {
          "line": 3672,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(c->reply)",
          "new_text": null,
          "old_line_content": "    if (listLength(c->reply) != 0) {",
          "new_line_content": "     * the client about already issued commands. We need a fresh reply",
          "content_same": false
        },
        {
          "line": 3673,
          "old_api": "sdsnew",
          "new_api": null,
          "old_text": "sdsnew(\"-ERR SYNC is invalid with pending input\\r\\n\")",
          "new_text": null,
          "old_line_content": "        addReplySds(c,sdsnew(\"-ERR SYNC is invalid with pending input\\r\\n\"));",
          "new_line_content": "     * buffer registering the differences between the BGSAVE and the current",
          "content_same": false
        },
        {
          "line": 3677,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_NOTICE,\"Slave ask for synchronization\")",
          "new_text": null,
          "old_line_content": "    redisLog(REDIS_NOTICE,\"Slave ask for synchronization\");",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 3167,
          "old_api": "sunionDiffGenericCommand",
          "new_api": null,
          "old_text": "sunionDiffGenericCommand(c,c->argv+1,c->argc-1,NULL,REDIS_OP_UNION)",
          "new_text": null,
          "old_line_content": "    sunionDiffGenericCommand(c,c->argv+1,c->argc-1,NULL,REDIS_OP_UNION);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3171,
          "old_api": "sunionDiffGenericCommand",
          "new_api": null,
          "old_text": "sunionDiffGenericCommand(c,c->argv+2,c->argc-2,c->argv[1],REDIS_OP_UNION)",
          "new_text": null,
          "old_line_content": "    sunionDiffGenericCommand(c,c->argv+2,c->argc-2,c->argv[1],REDIS_OP_UNION);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3175,
          "old_api": "sunionDiffGenericCommand",
          "new_api": null,
          "old_text": "sunionDiffGenericCommand(c,c->argv+1,c->argc-1,NULL,REDIS_OP_DIFF)",
          "new_text": null,
          "old_line_content": "    sunionDiffGenericCommand(c,c->argv+1,c->argc-1,NULL,REDIS_OP_DIFF);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3687,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(server.slaves)",
          "new_text": null,
          "old_line_content": "        listRewind(server.slaves);",
          "new_line_content": "        redisClient *slave;",
          "content_same": false
        },
        {
          "line": 3688,
          "old_api": "listYield",
          "new_api": null,
          "old_text": "listYield(server.slaves)",
          "new_text": null,
          "old_line_content": "        while((ln = listYield(server.slaves))) {",
          "new_line_content": "        listNode *ln;",
          "content_same": false
        },
        {
          "line": 3179,
          "old_api": "sunionDiffGenericCommand",
          "new_api": null,
          "old_text": "sunionDiffGenericCommand(c,c->argv+2,c->argc-2,c->argv[1],REDIS_OP_DIFF)",
          "new_text": null,
          "old_line_content": "    sunionDiffGenericCommand(c,c->argv+2,c->argc-2,c->argv[1],REDIS_OP_DIFF);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3183,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(c->db->dict)",
          "new_text": null,
          "old_line_content": "    server.dirty += dictSize(c->db->dict);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3184,
          "old_api": "dictEmpty",
          "new_api": null,
          "old_text": "dictEmpty(c->db->dict)",
          "new_text": null,
          "old_line_content": "    dictEmpty(c->db->dict);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3185,
          "old_api": "dictEmpty",
          "new_api": null,
          "old_text": "dictEmpty(c->db->expires)",
          "new_text": null,
          "old_line_content": "    dictEmpty(c->db->expires);",
          "new_line_content": "static void flushdbCommand(redisClient *c) {",
          "content_same": false
        },
        {
          "line": 3695,
          "old_api": "listRelease",
          "new_api": null,
          "old_text": "listRelease(c->reply)",
          "new_text": null,
          "old_line_content": "            listRelease(c->reply);",
          "new_line_content": "        if (ln) {",
          "content_same": false
        },
        {
          "line": 3696,
          "old_api": "listDup",
          "new_api": null,
          "old_text": "listDup(slave->reply)",
          "new_text": null,
          "old_line_content": "            c->reply = listDup(slave->reply);",
          "new_line_content": "            /* Perfect, the server is already registering differences for",
          "content_same": false
        },
        {
          "line": 3697,
          "old_api": "oom",
          "new_api": null,
          "old_text": "oom(\"listDup copying slave reply list\")",
          "new_text": null,
          "old_line_content": "            if (!c->reply) oom(\"listDup copying slave reply list\");",
          "new_line_content": "             * another slave. Set the right state, and copy the buffer. */",
          "content_same": false
        },
        {
          "line": 3190,
          "old_api": "emptyDb",
          "new_api": null,
          "old_text": "emptyDb()",
          "new_text": null,
          "old_line_content": "    server.dirty += emptyDb();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3191,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.ok)",
          "new_text": null,
          "old_line_content": "    addReply(c,shared.ok);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3192,
          "old_api": "rdbSave",
          "new_api": null,
          "old_text": "rdbSave(server.dbfilename)",
          "new_text": null,
          "old_line_content": "    rdbSave(server.dbfilename);",
          "new_line_content": "static void flushallCommand(redisClient *c) {",
          "content_same": false
        },
        {
          "line": 3704,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_NOTICE,\"Waiting for next BGSAVE for SYNC\")",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_NOTICE,\"Waiting for next BGSAVE for SYNC\");",
          "new_line_content": "            /* No way, we need to wait for the next BGSAVE in order to",
          "content_same": false
        },
        {
          "line": 3708,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_NOTICE,\"Starting BGSAVE for SYNC\")",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_NOTICE,\"Starting BGSAVE for SYNC\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3197,
          "old_api": "zmalloc",
          "new_api": null,
          "old_text": "zmalloc(sizeof(*so))",
          "new_text": null,
          "old_line_content": "    redisSortOperation *so = zmalloc(sizeof(*so));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3198,
          "old_api": "oom",
          "new_api": null,
          "old_text": "oom(\"createSortOperation\")",
          "new_text": null,
          "old_line_content": "    if (!so) oom(\"createSortOperation\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3709,
          "old_api": "rdbSaveBackground",
          "new_api": null,
          "old_text": "rdbSaveBackground(server.dbfilename)",
          "new_text": null,
          "old_line_content": "        if (rdbSaveBackground(server.dbfilename) != REDIS_OK) {",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 3710,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_NOTICE,\"Replication failed, can't BGSAVE\")",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_NOTICE,\"Replication failed, can't BGSAVE\");",
          "new_line_content": "        /* Ok we don't have a BGSAVE in progress, let's start one */",
          "content_same": false
        },
        {
          "line": 3719,
          "old_api": "oom",
          "new_api": null,
          "old_text": "oom(\"listAddNodeTail\")",
          "new_text": null,
          "old_line_content": "    if (!listAddNodeTail(server.slaves,c)) oom(\"listAddNodeTail\");",
          "new_line_content": "    c->repldbfd = -1;",
          "content_same": false
        },
        {
          "line": 3725,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(el)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(el);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3726,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(mask)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(mask);",
          "new_line_content": "static void sendBulkToSlave(aeEventLoop *el, int fd, void *privdata, int mask) {",
          "content_same": false
        },
        {
          "line": 3220,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(ssub)",
          "new_text": null,
          "old_line_content": "    if (sdslen(spat)+sdslen(ssub)-1 > REDIS_SORTKEY_MAX) return NULL;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3221,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(spat,'*')",
          "new_text": null,
          "old_line_content": "    p = strchr(spat,'*');",
          "new_line_content": "    spat = pattern->ptr;",
          "content_same": false
        },
        {
          "line": 3225,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(ssub)",
          "new_text": null,
          "old_line_content": "    sublen = sdslen(ssub);",
          "new_line_content": "    if (!p) return NULL;",
          "content_same": false
        },
        {
          "line": 3226,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(spat)",
          "new_text": null,
          "old_line_content": "    postfixlen = sdslen(spat)-(prefixlen+1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3227,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(keyname.buf,spat,prefixlen)",
          "new_text": null,
          "old_line_content": "    memcpy(keyname.buf,spat,prefixlen);",
          "new_line_content": "    prefixlen = p-spat;",
          "content_same": false
        },
        {
          "line": 3737,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "        bulkcount = sdscatprintf(sdsempty(),\"$%lld\\r\\n\",(unsigned long long)",
          "new_line_content": "         * operations) will never be smaller than the few bytes we need. */",
          "content_same": false
        },
        {
          "line": 3739,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(bulkcount)",
          "new_text": null,
          "old_line_content": "        if (write(fd,bulkcount,sdslen(bulkcount)) != (signed)sdslen(bulkcount))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3741,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(bulkcount)",
          "new_text": null,
          "old_line_content": "            sdsfree(bulkcount);",
          "new_line_content": "            slave->repldbsize);",
          "content_same": false
        },
        {
          "line": 3747,
          "old_api": "lseek",
          "new_api": null,
          "old_text": "lseek(slave->repldbfd,slave->repldboff,SEEK_SET)",
          "new_text": null,
          "old_line_content": "    lseek(slave->repldbfd,slave->repldboff,SEEK_SET);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3238,
          "old_api": "lookupKeyRead",
          "new_api": null,
          "old_text": "lookupKeyRead(db,&keyobj)",
          "new_text": null,
          "old_line_content": "    return lookupKeyRead(db,&keyobj);",
          "new_line_content": "    keyobj.ptr = ((char*)&keyname)+(sizeof(long)*2);",
          "content_same": false
        },
        {
          "line": 3752,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient(slave)",
          "new_text": null,
          "old_line_content": "        freeClient(slave);",
          "new_line_content": "    if (buflen <= 0) {",
          "content_same": false
        },
        {
          "line": 3756,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_DEBUG,\"Write error sending DB to slave: %s\",\n            strerror(errno))",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_DEBUG,\"Write error sending DB to slave: %s\",",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 3757,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "            strerror(errno));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3763,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(slave->repldbfd)",
          "new_text": null,
          "old_line_content": "        close(slave->repldbfd);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3765,
          "old_api": "aeDeleteFileEvent",
          "new_api": null,
          "old_text": "aeDeleteFileEvent(server.el,slave->fd,AE_WRITABLE)",
          "new_text": null,
          "old_line_content": "        aeDeleteFileEvent(server.el,slave->fd,AE_WRITABLE);",
          "new_line_content": "    if (slave->repldboff == slave->repldbsize) {",
          "content_same": false
        },
        {
          "line": 3767,
          "old_api": "aeCreateFileEvent",
          "new_api": null,
          "old_text": "aeCreateFileEvent(server.el, slave->fd, AE_WRITABLE,\n            sendReplyToClient, slave, NULL)",
          "new_text": null,
          "old_line_content": "        if (aeCreateFileEvent(server.el, slave->fd, AE_WRITABLE,",
          "new_line_content": "        slave->repldbfd = -1;",
          "content_same": false
        },
        {
          "line": 3769,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient(slave)",
          "new_text": null,
          "old_line_content": "            freeClient(slave);",
          "new_line_content": "        slave->replstate = REDIS_REPL_ONLINE;",
          "content_same": false
        },
        {
          "line": 3773,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_NOTICE,\"Synchronization with slave succeeded\")",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_NOTICE,\"Synchronization with slave succeeded\");",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 3781,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(server.slaves)",
          "new_text": null,
          "old_line_content": "    listRewind(server.slaves);",
          "new_line_content": "    listNode *ln;",
          "content_same": false
        },
        {
          "line": 3270,
          "old_api": "strcoll",
          "new_api": null,
          "old_text": "strcoll(so1->u.cmpobj->ptr,so2->u.cmpobj->ptr)",
          "new_text": null,
          "old_line_content": "                cmp = strcoll(so1->u.cmpobj->ptr,so2->u.cmpobj->ptr);",
          "new_line_content": "                    cmp = 1;",
          "content_same": false
        },
        {
          "line": 3782,
          "old_api": "listYield",
          "new_api": null,
          "old_text": "listYield(server.slaves)",
          "new_text": null,
          "old_line_content": "    while((ln = listYield(server.slaves))) {",
          "new_line_content": "    int startbgsave = 0;",
          "content_same": false
        },
        {
          "line": 3274,
          "old_api": "strcoll",
          "new_api": null,
          "old_text": "strcoll(so1->obj->ptr,so2->obj->ptr)",
          "new_text": null,
          "old_line_content": "            cmp = strcoll(so1->obj->ptr,so2->obj->ptr);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 3792,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient(slave)",
          "new_text": null,
          "old_line_content": "                freeClient(slave);",
          "new_line_content": "            struct stat buf;",
          "content_same": false
        },
        {
          "line": 3793,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"SYNC failed. BGSAVE child returned an error\")",
          "new_text": null,
          "old_line_content": "                redisLog(REDIS_WARNING,\"SYNC failed. BGSAVE child returned an error\");",
          "new_line_content": "           ",
          "content_same": false
        },
        {
          "line": 3797,
          "old_api": "fstat",
          "new_api": null,
          "old_text": "fstat(slave->repldbfd,&buf)",
          "new_text": null,
          "old_line_content": "                fstat(slave->repldbfd,&buf) == -1) {",
          "new_line_content": "                continue;",
          "content_same": false
        },
        {
          "line": 3798,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient(slave)",
          "new_text": null,
          "old_line_content": "                freeClient(slave);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 3293,
          "old_api": "lookupKeyRead",
          "new_api": null,
          "old_text": "lookupKeyRead(c->db,c->argv[1])",
          "new_text": null,
          "old_line_content": "    sortval = lookupKeyRead(c->db,c->argv[1]);",
          "new_line_content": "    redisSortObject *vector; /* Resulting vector to sort */",
          "content_same": false
        },
        {
          "line": 3805,
          "old_api": "aeDeleteFileEvent",
          "new_api": null,
          "old_text": "aeDeleteFileEvent(server.el,slave->fd,AE_WRITABLE)",
          "new_text": null,
          "old_line_content": "            aeDeleteFileEvent(server.el,slave->fd,AE_WRITABLE);",
          "new_line_content": "            slave->repldboff = 0;",
          "content_same": false
        },
        {
          "line": 3295,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.nokeyerr)",
          "new_text": null,
          "old_line_content": "        addReply(c,shared.nokeyerr);",
          "new_line_content": "    /* Lookup the key to sort. It must be of the right types */",
          "content_same": false
        },
        {
          "line": 3806,
          "old_api": "aeCreateFileEvent",
          "new_api": null,
          "old_text": "aeCreateFileEvent(server.el, slave->fd, AE_WRITABLE, sendBulkToSlave, slave, NULL)",
          "new_text": null,
          "old_line_content": "            if (aeCreateFileEvent(server.el, slave->fd, AE_WRITABLE, sendBulkToSlave, slave, NULL) == AE_ERR) {",
          "new_line_content": "            slave->repldbsize = buf.st_size;",
          "content_same": false
        },
        {
          "line": 3807,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient(slave)",
          "new_text": null,
          "old_line_content": "                freeClient(slave);",
          "new_line_content": "            slave->replstate = REDIS_REPL_SEND_BULK;",
          "content_same": false
        },
        {
          "line": 3299,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.wrongtypeerr)",
          "new_text": null,
          "old_line_content": "        addReply(c,shared.wrongtypeerr);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 3813,
          "old_api": "rdbSaveBackground",
          "new_api": null,
          "old_text": "rdbSaveBackground(server.dbfilename)",
          "new_text": null,
          "old_line_content": "        if (rdbSaveBackground(server.dbfilename) != REDIS_OK) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3814,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(server.slaves)",
          "new_text": null,
          "old_line_content": "            listRewind(server.slaves);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3815,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"SYNC failed. BGSAVE failed\")",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_WARNING,\"SYNC failed. BGSAVE failed\");",
          "new_line_content": "    if (startbgsave) {",
          "content_same": false
        },
        {
          "line": 3305,
          "old_api": "listCreate",
          "new_api": null,
          "old_text": "listCreate()",
          "new_text": null,
          "old_line_content": "    operations = listCreate();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3306,
          "old_api": "listSetFreeMethod",
          "new_api": null,
          "old_text": "listSetFreeMethod(operations,zfree)",
          "new_text": null,
          "old_line_content": "    listSetFreeMethod(operations,zfree);",
          "new_line_content": "    /* Create a list of operations to perform for every sorted element.",
          "content_same": false
        },
        {
          "line": 3820,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient(slave)",
          "new_text": null,
          "old_line_content": "                    freeClient(slave);",
          "new_line_content": "                redisClient *slave = ln->value;",
          "content_same": false
        },
        {
          "line": 3312,
          "old_api": "incrRefCount",
          "new_api": null,
          "old_text": "incrRefCount(sortval)",
          "new_text": null,
          "old_line_content": "    incrRefCount(sortval);",
          "new_line_content": "    /* Now we need to protect sortval incrementing its count, in the future",
          "content_same": false
        },
        {
          "line": 3317,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[j]->ptr,\"asc\")",
          "new_text": null,
          "old_line_content": "        if (!strcasecmp(c->argv[j]->ptr,\"asc\")) {",
          "new_line_content": "    /* The SORT command has an SQL-alike syntax, parse it */",
          "content_same": false
        },
        {
          "line": 3829,
          "old_api": "anetTcpConnect",
          "new_api": null,
          "old_text": "anetTcpConnect(NULL,server.masterhost,server.masterport)",
          "new_text": null,
          "old_line_content": "    int fd = anetTcpConnect(NULL,server.masterhost,server.masterport);",
          "new_line_content": "static int syncWithMaster(void) {",
          "content_same": false
        },
        {
          "line": 3319,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[j]->ptr,\"desc\")",
          "new_text": null,
          "old_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"desc\")) {",
          "new_line_content": "        int leftargs = c->argc-j-1;",
          "content_same": false
        },
        {
          "line": 3321,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[j]->ptr,\"alpha\")",
          "new_text": null,
          "old_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"alpha\")) {",
          "new_line_content": "            desc = 0;",
          "content_same": false
        },
        {
          "line": 3833,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"Unable to connect to MASTER: %s\",\n            strerror(errno))",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_WARNING,\"Unable to connect to MASTER: %s\",",
          "new_line_content": "    int dfd;",
          "content_same": false
        },
        {
          "line": 3323,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[j]->ptr,\"limit\")",
          "new_text": null,
          "old_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"limit\") && leftargs >= 2) {",
          "new_line_content": "            desc = 1;",
          "content_same": false
        },
        {
          "line": 3834,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "            strerror(errno));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3325,
          "old_api": "atoi",
          "new_api": null,
          "old_text": "atoi(c->argv[j+2]->ptr)",
          "new_text": null,
          "old_line_content": "            limit_count = atoi(c->argv[j+2]->ptr);",
          "new_line_content": "            alpha = 1;",
          "content_same": false
        },
        {
          "line": 3838,
          "old_api": "syncWrite",
          "new_api": null,
          "old_text": "syncWrite(fd,\"SYNC \\r\\n\",7,5)",
          "new_text": null,
          "old_line_content": "    if (syncWrite(fd,\"SYNC \\r\\n\",7,5) == -1) {",
          "new_line_content": "        return REDIS_ERR;",
          "content_same": false
        },
        {
          "line": 3839,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fd)",
          "new_text": null,
          "old_line_content": "        close(fd);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3840,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"I/O error writing to MASTER: %s\",\n            strerror(errno))",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_WARNING,\"I/O error writing to MASTER: %s\",",
          "new_line_content": "    /* Issue the SYNC command */",
          "content_same": false
        },
        {
          "line": 3331,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(c->argv[j+1]->ptr,'*')",
          "new_text": null,
          "old_line_content": "            if (strchr(c->argv[j+1]->ptr,'*') == NULL) dontsort = 1;",
          "new_line_content": "            sortby = c->argv[j+1];",
          "content_same": false
        },
        {
          "line": 3333,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[j]->ptr,\"get\")",
          "new_text": null,
          "old_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"get\") && leftargs >= 1) {",
          "new_line_content": "             * we don't need to sort nor to lookup the weight keys. */",
          "content_same": false
        },
        {
          "line": 3845,
          "old_api": "syncReadLine",
          "new_api": null,
          "old_text": "syncReadLine(fd,buf,1024,5)",
          "new_text": null,
          "old_line_content": "    if (syncReadLine(fd,buf,1024,5) == -1) {",
          "new_line_content": "        return REDIS_ERR;",
          "content_same": false
        },
        {
          "line": 3846,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fd)",
          "new_text": null,
          "old_line_content": "        close(fd);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3847,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"I/O error reading bulk count from MASTER: %s\",\n            strerror(errno))",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_WARNING,\"I/O error reading bulk count from MASTER: %s\",",
          "new_line_content": "    /* Read the bulk write count */",
          "content_same": false
        },
        {
          "line": 3338,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[j]->ptr,\"del\")",
          "new_text": null,
          "old_line_content": "        } else if (!strcasecmp(c->argv[j]->ptr,\"del\") && leftargs >= 1) {",
          "new_line_content": "                REDIS_SORT_GET,c->argv[j+1]));",
          "content_same": false
        },
        {
          "line": 3339,
          "old_api": "createSortOperation",
          "new_api": null,
          "old_text": "createSortOperation(\n                REDIS_SORT_DEL,c->argv[j+1])",
          "new_text": null,
          "old_line_content": "            listAddNodeTail(operations,createSortOperation(",
          "new_line_content": "            getop++;",
          "content_same": false
        },
        {
          "line": 3852,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_NOTICE,\"Receiving %d bytes data dump from MASTER\",dumpsize)",
          "new_text": null,
          "old_line_content": "    redisLog(REDIS_NOTICE,\"Receiving %d bytes data dump from MASTER\",dumpsize);",
          "new_line_content": "        return REDIS_ERR;",
          "content_same": false
        },
        {
          "line": 3343,
          "old_api": "createSortOperation",
          "new_api": null,
          "old_text": "createSortOperation(\n                REDIS_SORT_INCR,c->argv[j+1])",
          "new_text": null,
          "old_line_content": "            listAddNodeTail(operations,createSortOperation(",
          "new_line_content": "                REDIS_SORT_DEL,c->argv[j+1]));",
          "content_same": false
        },
        {
          "line": 3347,
          "old_api": "createSortOperation",
          "new_api": null,
          "old_text": "createSortOperation(\n                REDIS_SORT_DECR,c->argv[j+1])",
          "new_text": null,
          "old_line_content": "            listAddNodeTail(operations,createSortOperation(",
          "new_line_content": "                REDIS_SORT_INCR,c->argv[j+1]));",
          "content_same": false
        },
        {
          "line": 3351,
          "old_api": "decrRefCount",
          "new_api": null,
          "old_text": "decrRefCount(sortval)",
          "new_text": null,
          "old_line_content": "            decrRefCount(sortval);",
          "new_line_content": "                REDIS_SORT_DECR,c->argv[j+1]));",
          "content_same": false
        },
        {
          "line": 3352,
          "old_api": "listRelease",
          "new_api": null,
          "old_text": "listRelease(operations)",
          "new_text": null,
          "old_line_content": "            listRelease(operations);",
          "new_line_content": "            j++;",
          "content_same": false
        },
        {
          "line": 3353,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.syntaxerr)",
          "new_text": null,
          "old_line_content": "            addReply(c,shared.syntaxerr);",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 3864,
          "old_api": "read",
          "new_api": null,
          "old_text": "read(fd,buf,(dumpsize < 1024)?dumpsize:1024)",
          "new_text": null,
          "old_line_content": "        nread = read(fd,buf,(dumpsize < 1024)?dumpsize:1024);",
          "new_line_content": "    while(dumpsize) {",
          "content_same": false
        },
        {
          "line": 3866,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"I/O error trying to sync with MASTER: %s\",\n                strerror(errno))",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_WARNING,\"I/O error trying to sync with MASTER: %s\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3868,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fd)",
          "new_text": null,
          "old_line_content": "            close(fd);",
          "new_line_content": "        if (nread == -1) {",
          "content_same": false
        },
        {
          "line": 3361,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength((list*)sortval->ptr)",
          "new_text": null,
          "old_line_content": "        listLength((list*)sortval->ptr) :",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3362,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize((dict*)sortval->ptr)",
          "new_text": null,
          "old_line_content": "        dictSize((dict*)sortval->ptr);",
          "new_line_content": "    /* Load the sorting vector with all the objects to sort */",
          "content_same": false
        },
        {
          "line": 3363,
          "old_api": "zmalloc",
          "new_api": null,
          "old_text": "zmalloc(sizeof(redisSortObject)*vectorlen)",
          "new_text": null,
          "old_line_content": "    vector = zmalloc(sizeof(redisSortObject)*vectorlen);",
          "new_line_content": "    vectorlen = (sortval->type == REDIS_LIST) ?",
          "content_same": false
        },
        {
          "line": 3874,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_WARNING,\"Write error writing to the DB dump file needed for MASTER <-> SLAVE synchrnonization: %s\", strerror(errno));",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3876,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(dfd)",
          "new_text": null,
          "old_line_content": "            close(dfd);",
          "new_line_content": "        if (nwritten == -1) {",
          "content_same": false
        },
        {
          "line": 3881,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(dfd)",
          "new_text": null,
          "old_line_content": "    close(dfd);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3370,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(list)",
          "new_text": null,
          "old_line_content": "        listRewind(list);",
          "new_line_content": "        list *list = sortval->ptr;",
          "content_same": false
        },
        {
          "line": 3371,
          "old_api": "listYield",
          "new_api": null,
          "old_text": "listYield(list)",
          "new_text": null,
          "old_line_content": "        while((ln = listYield(list))) {",
          "new_line_content": "        listNode *ln;",
          "content_same": false
        },
        {
          "line": 3882,
          "old_api": "rename",
          "new_api": null,
          "old_text": "rename(tmpfile,server.dbfilename)",
          "new_text": null,
          "old_line_content": "    if (rename(tmpfile,server.dbfilename) == -1) {",
          "new_line_content": "        dumpsize -= nread;",
          "content_same": false
        },
        {
          "line": 3883,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_WARNING,\"Failed trying to rename the temp DB into dump.rdb in MASTER <-> SLAVE synchronization: %s\", strerror(errno));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3889,
          "old_api": "rdbLoad",
          "new_api": null,
          "old_text": "rdbLoad(server.dbfilename)",
          "new_text": null,
          "old_line_content": "    if (rdbLoad(server.dbfilename) != REDIS_OK) {",
          "new_line_content": "        return REDIS_ERR;",
          "content_same": false
        },
        {
          "line": 3890,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"Failed trying to load the MASTER synchronization DB from disk\")",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_WARNING,\"Failed trying to load the MASTER synchronization DB from disk\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3383,
          "old_api": "dictGetIterator",
          "new_api": null,
          "old_text": "dictGetIterator(set)",
          "new_text": null,
          "old_line_content": "        di = dictGetIterator(set);",
          "new_line_content": "        dictIterator *di;",
          "content_same": false
        },
        {
          "line": 3384,
          "old_api": "oom",
          "new_api": null,
          "old_text": "oom(\"dictGetIterator\")",
          "new_text": null,
          "old_line_content": "        if (!di) oom(\"dictGetIterator\");",
          "new_line_content": "        dictEntry *setele;",
          "content_same": false
        },
        {
          "line": 3385,
          "old_api": "dictNext",
          "new_api": null,
          "old_text": "dictNext(di)",
          "new_text": null,
          "old_line_content": "        while((setele = dictNext(di)) != NULL) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3391,
          "old_api": "dictReleaseIterator",
          "new_api": null,
          "old_text": "dictReleaseIterator(di)",
          "new_text": null,
          "old_line_content": "        dictReleaseIterator(di);",
          "new_line_content": "            vector[j].u.cmpobj = NULL;",
          "content_same": false
        },
        {
          "line": 3904,
          "old_api": "fopen",
          "new_api": null,
          "old_text": "fopen(\"/proc/sys/vm/overcommit_memory\",\"r\")",
          "new_text": null,
          "old_line_content": "    FILE *fp = fopen(\"/proc/sys/vm/overcommit_memory\",\"r\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3393,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(j == vectorlen)",
          "new_text": null,
          "old_line_content": "    assert(j == vectorlen);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3908,
          "old_api": "fgets",
          "new_api": null,
          "old_text": "fgets(buf,64,fp)",
          "new_text": null,
          "old_line_content": "    if (fgets(buf,64,fp) == NULL) {",
          "new_line_content": "    char buf[64];",
          "content_same": false
        },
        {
          "line": 3909,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(fp)",
          "new_text": null,
          "old_line_content": "        fclose(fp);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3401,
          "old_api": "lookupKeyByPattern",
          "new_api": null,
          "old_text": "lookupKeyByPattern(c->db,sortby,vector[j].obj)",
          "new_text": null,
          "old_line_content": "                byval = lookupKeyByPattern(c->db,sortby,vector[j].obj);",
          "new_line_content": "            if (sortby) {",
          "content_same": false
        },
        {
          "line": 3914,
          "old_api": "atoi",
          "new_api": null,
          "old_text": "atoi(buf)",
          "new_text": null,
          "old_line_content": "    return atoi(buf);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3405,
          "old_api": "incrRefCount",
          "new_api": null,
          "old_text": "incrRefCount(byval)",
          "new_text": null,
          "old_line_content": "                    incrRefCount(byval);",
          "new_line_content": "                if (!byval || byval->type != REDIS_STRING) continue;",
          "content_same": false
        },
        {
          "line": 3918,
          "old_api": "linuxOvercommitMemoryValue",
          "new_api": null,
          "old_text": "linuxOvercommitMemoryValue()",
          "new_text": null,
          "old_line_content": "    if (linuxOvercommitMemoryValue() == 0) {",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3407,
          "old_api": "strtod",
          "new_api": null,
          "old_text": "strtod(byval->ptr,NULL)",
          "new_text": null,
          "old_line_content": "                    vector[j].u.score = strtod(byval->ptr,NULL);",
          "new_line_content": "                    vector[j].u.cmpobj = byval;",
          "content_same": false
        },
        {
          "line": 3919,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"WARNING overcommit_memory is set to 0! Background save may fail under low condition memory. To fix this issue add 'echo 1 > /proc/sys/vm/overcommit_memory' in your init scripts.\")",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_WARNING,\"WARNING overcommit_memory is set to 0! Background save may fail under low condition memory. To fix this issue add 'echo 1 > /proc/sys/vm/overcommit_memory' in your init scripts.\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3928,
          "old_api": "exit",
          "new_api": null,
          "old_text": "exit(0)",
          "new_text": null,
          "old_line_content": "    if (fork() != 0) exit(0); /* parent exits */",
          "new_line_content": "    int fd;",
          "content_same": false
        },
        {
          "line": 3929,
          "old_api": "setsid",
          "new_api": null,
          "old_text": "setsid()",
          "new_text": null,
          "old_line_content": "    setsid(); /* create a new session */",
          "new_line_content": "    FILE *fp;",
          "content_same": false
        },
        {
          "line": 3934,
          "old_api": "open",
          "new_api": null,
          "old_text": "open(\"/dev/null\", O_RDWR, 0)",
          "new_text": null,
          "old_line_content": "    if ((fd = open(\"/dev/null\", O_RDWR, 0)) != -1) {",
          "new_line_content": "    /* Every output goes to /dev/null. If Redis is daemonized but",
          "content_same": false
        },
        {
          "line": 3935,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(fd, STDIN_FILENO)",
          "new_text": null,
          "old_line_content": "        dup2(fd, STDIN_FILENO);",
          "new_line_content": "     * the 'logfile' is set to 'stdout' in the configuration file",
          "content_same": false
        },
        {
          "line": 3936,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(fd, STDOUT_FILENO)",
          "new_text": null,
          "old_line_content": "        dup2(fd, STDOUT_FILENO);",
          "new_line_content": "     * it will not log at all. */",
          "content_same": false
        },
        {
          "line": 3429,
          "old_api": "qsort",
          "new_api": null,
          "old_text": "qsort(vector,vectorlen,sizeof(redisSortObject),sortCompare)",
          "new_text": null,
          "old_line_content": "        qsort(vector,vectorlen,sizeof(redisSortObject),sortCompare);",
          "new_line_content": "        server.sort_desc = desc;",
          "content_same": false
        },
        {
          "line": 3943,
          "old_api": "getpid",
          "new_api": null,
          "old_text": "getpid()",
          "new_text": null,
          "old_line_content": "        fprintf(fp,\"%d\\n\",getpid());",
          "new_line_content": "    /* Try to write the pid file */",
          "content_same": false
        },
        {
          "line": 3435,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "    addReplySds(c,sdscatprintf(sdsempty(),\"*%d\\r\\n\",outputlen));",
          "new_line_content": "    /* Send command output to the output buffer, performing the specified",
          "content_same": false
        },
        {
          "line": 3950,
          "old_api": "linuxOvercommitMemoryWarning",
          "new_api": null,
          "old_text": "linuxOvercommitMemoryWarning()",
          "new_text": null,
          "old_line_content": "    linuxOvercommitMemoryWarning();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3439,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "            addReplySds(c,sdscatprintf(sdsempty(),\"$%d\\r\\n\",",
          "new_line_content": "    for (j = start; j <= end; j++) {",
          "content_same": false
        },
        {
          "line": 3440,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(vector[j].obj->ptr)",
          "new_text": null,
          "old_line_content": "                sdslen(vector[j].obj->ptr)));",
          "new_line_content": "        listNode *ln;",
          "content_same": false
        },
        {
          "line": 3441,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,vector[j].obj)",
          "new_text": null,
          "old_line_content": "            addReply(c,vector[j].obj);",
          "new_line_content": "        if (!getop) {",
          "content_same": false
        },
        {
          "line": 3955,
          "old_api": "ResetServerSaveParams",
          "new_api": null,
          "old_text": "ResetServerSaveParams()",
          "new_text": null,
          "old_line_content": "        ResetServerSaveParams();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3963,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_NOTICE,\"Server started, Redis version \" REDIS_VERSION)",
          "new_text": null,
          "old_line_content": "    redisLog(REDIS_NOTICE,\"Server started, Redis version \" REDIS_VERSION);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3452,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.nullbulk)",
          "new_text": null,
          "old_line_content": "                    addReply(c,shared.nullbulk);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3454,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "                    addReplySds(c,sdscatprintf(sdsempty(),\"$%d\\r\\n\",",
          "new_line_content": "                if (!val || val->type != REDIS_STRING) {",
          "content_same": false
        },
        {
          "line": 3456,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,val)",
          "new_text": null,
          "old_line_content": "                    addReply(c,val);",
          "new_line_content": "                } else {",
          "content_same": false
        },
        {
          "line": 3466,
          "old_api": "decrRefCount",
          "new_api": null,
          "old_text": "decrRefCount(sortval)",
          "new_text": null,
          "old_line_content": "    decrRefCount(sortval);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3467,
          "old_api": "listRelease",
          "new_api": null,
          "old_text": "listRelease(operations)",
          "new_text": null,
          "old_line_content": "    listRelease(operations);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3472,
          "old_api": "zfree",
          "new_api": null,
          "old_text": "zfree(vector)",
          "new_text": null,
          "old_line_content": "    zfree(vector);",
          "new_line_content": "        if (sortby && alpha && vector[j].u.cmpobj)",
          "content_same": false
        },
        {
          "line": 3477,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "    time_t uptime = time(NULL)-server.stat_starttime;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3479,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "    info = sdscatprintf(sdsempty(),",
          "new_line_content": "    sds info;",
          "content_same": false
        },
        {
          "line": 3492,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(server.slaves)",
          "new_text": null,
          "old_line_content": "        listLength(server.clients)-listLength(server.slaves),",
          "new_line_content": "        \"uptime_in_seconds:%d\\r\\n\"",
          "content_same": false
        },
        {
          "line": 3493,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(server.slaves)",
          "new_text": null,
          "old_line_content": "        listLength(server.slaves),",
          "new_line_content": "        \"uptime_in_days:%d\\r\\n\"",
          "content_same": false
        },
        {
          "line": 3503,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(info)",
          "new_text": null,
          "old_line_content": "    addReplySds(c,sdscatprintf(sdsempty(),\"$%d\\r\\n\",sdslen(info)));",
          "new_line_content": "        uptime,",
          "content_same": false
        },
        {
          "line": 3504,
          "old_api": "addReplySds",
          "new_api": null,
          "old_text": "addReplySds(c,info)",
          "new_text": null,
          "old_line_content": "    addReplySds(c,info);",
          "new_line_content": "        uptime/(3600*24)",
          "content_same": false
        },
        {
          "line": 3505,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.crlf)",
          "new_text": null,
          "old_line_content": "    addReply(c,shared.crlf);",
          "new_line_content": "    );",
          "content_same": false
        },
        {
          "line": 3514,
          "old_api": "oom",
          "new_api": null,
          "old_text": "oom(\"listAddNodeTail\")",
          "new_text": null,
          "old_line_content": "    if (!listAddNodeTail(server.monitors,c)) oom(\"listAddNodeTail\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3515,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.ok)",
          "new_text": null,
          "old_line_content": "    addReply(c,shared.ok);",
          "new_line_content": "    c->flags |= (REDIS_SLAVE|REDIS_MONITOR);",
          "content_same": false
        },
        {
          "line": 3520,
          "old_api": "dictDelete",
          "new_api": null,
          "old_text": "dictDelete(db->expires,key)",
          "new_text": null,
          "old_line_content": "    if (dictDelete(db->expires,key) == DICT_OK) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3528,
          "old_api": "dictAdd",
          "new_api": null,
          "old_text": "dictAdd(db->expires,key,(void*)when)",
          "new_text": null,
          "old_line_content": "    if (dictAdd(db->expires,key,(void*)when) == DICT_ERR) {",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3542,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(db->expires)",
          "new_text": null,
          "old_line_content": "    if (dictSize(db->expires) == 0 ||",
          "new_line_content": "    dictEntry *de;",
          "content_same": false
        },
        {
          "line": 3543,
          "old_api": "dictFind",
          "new_api": null,
          "old_text": "dictFind(db->expires,key)",
          "new_text": null,
          "old_line_content": "       (de = dictFind(db->expires,key)) == NULL) return -1;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3553,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(db->expires)",
          "new_text": null,
          "old_line_content": "    if (dictSize(db->expires) == 0 ||",
          "new_line_content": "    dictEntry *de;",
          "content_same": false
        },
        {
          "line": 3554,
          "old_api": "dictFind",
          "new_api": null,
          "old_text": "dictFind(db->expires,key)",
          "new_text": null,
          "old_line_content": "       (de = dictFind(db->expires,key)) == NULL) return 0;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3558,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "    if (time(NULL) <= when) return 0;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3562,
          "old_api": "dictDelete",
          "new_api": null,
          "old_text": "dictDelete(db->dict,key)",
          "new_text": null,
          "old_line_content": "    return dictDelete(db->dict,key) == DICT_OK;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3569,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(db->expires)",
          "new_text": null,
          "old_line_content": "    if (dictSize(db->expires) == 0 ||",
          "new_line_content": "    dictEntry *de;",
          "content_same": false
        },
        {
          "line": 3570,
          "old_api": "dictFind",
          "new_api": null,
          "old_text": "dictFind(db->expires,key)",
          "new_text": null,
          "old_line_content": "       (de = dictFind(db->expires,key)) == NULL) return 0;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3574,
          "old_api": "dictDelete",
          "new_api": null,
          "old_text": "dictDelete(db->expires,key)",
          "new_text": null,
          "old_line_content": "    dictDelete(db->expires,key);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3575,
          "old_api": "dictDelete",
          "new_api": null,
          "old_text": "dictDelete(db->dict,key)",
          "new_text": null,
          "old_line_content": "    return dictDelete(db->dict,key) == DICT_OK;",
          "new_line_content": "    /* Delete the key */",
          "content_same": false
        },
        {
          "line": 3580,
          "old_api": "atoi",
          "new_api": null,
          "old_text": "atoi(c->argv[2]->ptr)",
          "new_text": null,
          "old_line_content": "    int seconds = atoi(c->argv[2]->ptr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3582,
          "old_api": "dictFind",
          "new_api": null,
          "old_text": "dictFind(c->db->dict,c->argv[1])",
          "new_text": null,
          "old_line_content": "    de = dictFind(c->db->dict,c->argv[1]);",
          "new_line_content": "    dictEntry *de;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 76,
      "total_additions": 188,
      "total_deletions": 188,
      "total_api_changes": 452
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 452,
        "non_api_lines": 3,
        "non_api_line_numbers": [
          3138,
          3115,
          3139
        ]
      }
    },
    "api_calls_before": 1262,
    "api_calls_after": 1262,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 0,
      "total_diff_lines": 22
    }
  }
}