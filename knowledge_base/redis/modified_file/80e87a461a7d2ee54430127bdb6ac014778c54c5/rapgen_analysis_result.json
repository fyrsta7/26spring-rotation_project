{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/80e87a461a7d2ee54430127bdb6ac014778c54c5",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/80e87a461a7d2ee54430127bdb6ac014778c54c5/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/80e87a461a7d2ee54430127bdb6ac014778c54c5/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/80e87a461a7d2ee54430127bdb6ac014778c54c5/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1214,
          "old_api": "addReplyBulk",
          "new_api": "addReply",
          "old_text": "addReplyBulk(c,c->argv[1])",
          "new_text": "addReply(c,shared.pong)",
          "old_line_content": "    addReplyBulk(c,c->argv[1]);",
          "new_line_content": "    addReply(c,shared.pong);",
          "content_same": false
        },
        {
          "line": 1255,
          "old_api": "getrusage",
          "new_api": "strcasecmp",
          "old_text": "getrusage(RUSAGE_SELF, &self_ru)",
          "new_text": "strcasecmp(section,\"all\")",
          "old_line_content": "    getrusage(RUSAGE_SELF, &self_ru);",
          "new_line_content": "        allsections = strcasecmp(section,\"all\") == 0;",
          "content_same": false
        },
        {
          "line": 1256,
          "old_api": "getrusage",
          "new_api": "strcasecmp",
          "old_text": "getrusage(RUSAGE_CHILDREN, &c_ru)",
          "new_text": "strcasecmp(section,\"default\")",
          "old_line_content": "    getrusage(RUSAGE_CHILDREN, &c_ru);",
          "new_line_content": "        defsections = strcasecmp(section,\"default\") == 0;",
          "content_same": false
        },
        {
          "line": 1260,
          "old_api": "strcasecmp",
          "new_api": "getrusage",
          "old_text": "strcasecmp(section,\"server\")",
          "new_text": "getrusage(RUSAGE_CHILDREN, &c_ru)",
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"server\")) {",
          "new_line_content": "    getrusage(RUSAGE_CHILDREN, &c_ru);",
          "content_same": false
        },
        {
          "line": 1261,
          "old_api": "sdscat",
          "new_api": "getClientsMaxBuffers",
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": "getClientsMaxBuffers(&lol,&bib)",
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "    getClientsMaxBuffers(&lol,&bib);",
          "content_same": false
        },
        {
          "line": 1279,
          "old_api": "getpid",
          "new_api": "redisGitSHA1",
          "old_text": "getpid()",
          "new_text": "redisGitSHA1()",
          "old_line_content": "            (long) getpid(),",
          "new_line_content": "            redisGitSHA1(),",
          "content_same": false
        },
        {
          "line": 1305,
          "old_api": "zmalloc_used_memory",
          "new_api": "strcasecmp",
          "old_text": "zmalloc_used_memory()",
          "new_text": "strcasecmp(section,\"memory\")",
          "old_line_content": "        bytesToHuman(hmem,zmalloc_used_memory());",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"memory\")) {",
          "content_same": false
        },
        {
          "line": 1324,
          "old_api": "zmalloc_get_fragmentation_ratio",
          "new_api": "zmalloc_get_rss",
          "old_text": "zmalloc_get_fragmentation_ratio()",
          "new_text": "zmalloc_get_rss()",
          "old_line_content": "            zmalloc_get_fragmentation_ratio(),",
          "new_line_content": "            zmalloc_get_rss(),",
          "content_same": false
        },
        {
          "line": 1442,
          "old_api": "time",
          "new_api": "sdscatprintf",
          "old_text": "time(NULL)",
          "new_text": "sdscatprintf(info,\n                    \"master_sync_left_bytes:%ld\\r\\n\"\n                    \"master_sync_last_io_seconds_ago:%d\\r\\n\"\n                    ,(long)server.repl_transfer_left,\n                    (int)(time(NULL)-server.repl_transfer_lastio)\n                )",
          "old_line_content": "                    (int)(time(NULL)-server.repl_transfer_lastio)",
          "new_line_content": "                info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1458,
          "old_api": "strcasecmp",
          "new_api": "listLength",
          "old_text": "strcasecmp(section,\"cpu\")",
          "new_text": "listLength(server.slaves)",
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"cpu\")) {",
          "new_line_content": "            listLength(server.slaves));",
          "content_same": false
        },
        {
          "line": 1504,
          "old_api": "dictSize",
          "new_api": "sdscatprintf",
          "old_text": "dictSize(server.db[j].dict)",
          "new_text": "sdscatprintf(info, \"# Keyspace\\r\\n\")",
          "old_line_content": "            keys = dictSize(server.db[j].dict);",
          "new_line_content": "        info = sdscatprintf(info, \"# Keyspace\\r\\n\");",
          "content_same": false
        },
        {
          "line": 1523,
          "old_api": "sdsempty",
          "new_api": "addReply",
          "old_text": "sdsempty()",
          "new_text": "addReply(c,shared.syntaxerr)",
          "old_line_content": "    addReplySds(c,sdscatprintf(sdsempty(),\"$%lu\\r\\n\",",
          "new_line_content": "        addReply(c,shared.syntaxerr);",
          "content_same": false
        },
        {
          "line": 1526,
          "old_api": "addReply",
          "new_api": "genRedisInfoString",
          "old_text": "addReply(c,shared.crlf)",
          "new_text": "genRedisInfoString(section)",
          "old_line_content": "    addReply(c,shared.crlf);",
          "new_line_content": "    sds info = genRedisInfoString(section);",
          "content_same": false
        },
        {
          "line": 1598,
          "old_api": "dictFind",
          "new_api": "dictGetEntryKey",
          "old_text": "dictFind(db->dict, thiskey)",
          "new_text": "dictGetEntryKey(de)",
          "old_line_content": "                        de = dictFind(db->dict, thiskey);",
          "new_line_content": "                    thiskey = dictGetEntryKey(de);",
          "content_same": false
        },
        {
          "line": 1635,
          "old_api": "decrRefCount",
          "new_api": "sdslen",
          "old_text": "decrRefCount(keyobj)",
          "new_text": "sdslen(bestkey)",
          "old_line_content": "                decrRefCount(keyobj);",
          "new_line_content": "                robj *keyobj = createStringObject(bestkey,sdslen(bestkey));",
          "content_same": false
        },
        {
          "line": 1651,
          "old_api": "fgets",
          "new_api": "fopen",
          "old_text": "fgets(buf,64,fp)",
          "new_text": "fopen(\"/proc/sys/vm/overcommit_memory\",\"r\")",
          "old_line_content": "    if (fgets(buf,64,fp) == NULL) {",
          "new_line_content": "    FILE *fp = fopen(\"/proc/sys/vm/overcommit_memory\",\"r\");",
          "content_same": false
        },
        {
          "line": 1655,
          "old_api": "fclose",
          "new_api": "fgets",
          "old_text": "fclose(fp)",
          "new_text": "fgets(buf,64,fp)",
          "old_line_content": "    fclose(fp);",
          "new_line_content": "    if (fgets(buf,64,fp) == NULL) {",
          "content_same": false
        },
        {
          "line": 1661,
          "old_api": "linuxOvercommitMemoryValue",
          "new_api": "atoi",
          "old_text": "linuxOvercommitMemoryValue()",
          "new_text": "atoi(buf)",
          "old_line_content": "    if (linuxOvercommitMemoryValue() == 0) {",
          "new_line_content": "    return atoi(buf);",
          "content_same": false
        },
        {
          "line": 1689,
          "old_api": "close",
          "new_api": "open",
          "old_text": "close(fd)",
          "new_text": "open(\"/dev/null\", O_RDWR, 0)",
          "old_line_content": "        if (fd > STDERR_FILENO) close(fd);",
          "new_line_content": "    if ((fd = open(\"/dev/null\", O_RDWR, 0)) != -1) {",
          "content_same": false
        },
        {
          "line": 1700,
          "old_api": "fprintf",
          "new_api": "exit",
          "old_text": "fprintf(stderr,\"Usage: ./redis-server [/path/to/redis.conf]\\n\")",
          "new_text": "exit(0)",
          "old_line_content": "    fprintf(stderr,\"Usage: ./redis-server [/path/to/redis.conf]\\n\");",
          "new_line_content": "    exit(0);",
          "content_same": false
        },
        {
          "line": 1711,
          "old_api": "redisGitSHA1",
          "new_api": "zmalloc",
          "old_text": "redisGitSHA1()",
          "new_text": "zmalloc(1024*16)",
          "old_line_content": "        redisGitSHA1(),",
          "new_line_content": "    char *buf = zmalloc(1024*16);",
          "content_same": false
        },
        {
          "line": 1716,
          "old_api": "getpid",
          "new_api": "redisGitDirty",
          "old_text": "getpid()",
          "new_text": "redisGitDirty()",
          "old_line_content": "        (long) getpid()",
          "new_line_content": "        strtol(redisGitDirty(),NULL,10) > 0,",
          "content_same": false
        },
        {
          "line": 1729,
          "old_api": "usage",
          "new_api": "initServerConfig",
          "old_text": "usage()",
          "new_text": "initServerConfig()",
          "old_line_content": "        if (strcmp(argv[1], \"--help\") == 0) usage();",
          "new_line_content": "    initServerConfig();",
          "content_same": false
        },
        {
          "line": 1731,
          "old_api": "loadServerConfig",
          "new_api": "strcmp",
          "old_text": "loadServerConfig(argv[1])",
          "new_text": "strcmp(argv[1], \"-v\")",
          "old_line_content": "        loadServerConfig(argv[1]);",
          "new_line_content": "        if (strcmp(argv[1], \"-v\") == 0 ||",
          "content_same": false
        },
        {
          "line": 1735,
          "old_api": "redisLog",
          "new_api": "loadServerConfig",
          "old_text": "redisLog(REDIS_WARNING,\"Warning: no config file specified, using the default config. In order to specify a config file use 'redis-server /path/to/redis.conf'\")",
          "new_text": "loadServerConfig(argv[1])",
          "old_line_content": "        redisLog(REDIS_WARNING,\"Warning: no config file specified, using the default config. In order to specify a config file use 'redis-server /path/to/redis.conf'\");",
          "new_line_content": "        loadServerConfig(argv[1]);",
          "content_same": false
        },
        {
          "line": 1737,
          "old_api": "daemonize",
          "new_api": "usage",
          "old_text": "daemonize()",
          "new_text": "usage()",
          "old_line_content": "    if (server.daemonize) daemonize();",
          "new_line_content": "        usage();",
          "content_same": false
        },
        {
          "line": 1739,
          "old_api": "createPidFile",
          "new_api": "redisLog",
          "old_text": "createPidFile()",
          "new_text": "redisLog(REDIS_WARNING,\"Warning: no config file specified, using the default config. In order to specify a config file use 'redis-server /path/to/redis.conf'\")",
          "old_line_content": "    if (server.daemonize) createPidFile();",
          "new_line_content": "        redisLog(REDIS_WARNING,\"Warning: no config file specified, using the default config. In order to specify a config file use 'redis-server /path/to/redis.conf'\");",
          "content_same": false
        },
        {
          "line": 1741,
          "old_api": "redisLog",
          "new_api": "daemonize",
          "old_text": "redisLog(REDIS_NOTICE,\"Server started, Redis version \" REDIS_VERSION)",
          "new_text": "daemonize()",
          "old_line_content": "    redisLog(REDIS_NOTICE,\"Server started, Redis version \" REDIS_VERSION);",
          "new_line_content": "    if (server.daemonize) daemonize();",
          "content_same": false
        },
        {
          "line": 1743,
          "old_api": "linuxOvercommitMemoryWarning",
          "new_api": "createPidFile",
          "old_text": "linuxOvercommitMemoryWarning()",
          "new_text": "createPidFile()",
          "old_line_content": "    linuxOvercommitMemoryWarning();",
          "new_line_content": "    if (server.daemonize) createPidFile();",
          "content_same": false
        },
        {
          "line": 1745,
          "old_api": "ustime",
          "new_api": "redisLog",
          "old_text": "ustime()",
          "new_text": "redisLog(REDIS_NOTICE,\"Server started, Redis version \" REDIS_VERSION)",
          "old_line_content": "    start = ustime();",
          "new_line_content": "    redisLog(REDIS_NOTICE,\"Server started, Redis version \" REDIS_VERSION);",
          "content_same": false
        },
        {
          "line": 1747,
          "old_api": "loadAppendOnlyFile",
          "new_api": "linuxOvercommitMemoryWarning",
          "old_text": "loadAppendOnlyFile(server.appendfilename)",
          "new_text": "linuxOvercommitMemoryWarning()",
          "old_line_content": "        if (loadAppendOnlyFile(server.appendfilename) == REDIS_OK)",
          "new_line_content": "    linuxOvercommitMemoryWarning();",
          "content_same": false
        },
        {
          "line": 1751,
          "old_api": "ustime",
          "new_api": "loadAppendOnlyFile",
          "old_text": "ustime()",
          "new_text": "loadAppendOnlyFile(server.appendfilename)",
          "old_line_content": "            redisLog(REDIS_NOTICE,\"DB loaded from disk: %.3f seconds\",(float)(ustime()-start)/1000000);",
          "new_line_content": "        if (loadAppendOnlyFile(server.appendfilename) == REDIS_OK)",
          "content_same": false
        },
        {
          "line": 1754,
          "old_api": "redisLog",
          "new_api": "rdbLoad",
          "old_text": "redisLog(REDIS_NOTICE,\"The server is now ready to accept connections on port %d\", server.port)",
          "new_text": "rdbLoad(server.dbfilename)",
          "old_line_content": "        redisLog(REDIS_NOTICE,\"The server is now ready to accept connections on port %d\", server.port);",
          "new_line_content": "        if (rdbLoad(server.dbfilename) == REDIS_OK)",
          "content_same": false
        },
        {
          "line": 1758,
          "old_api": "aeMain",
          "new_api": "redisLog",
          "old_text": "aeMain(server.el)",
          "new_text": "redisLog(REDIS_NOTICE,\"The server is now ready to accept connections on port %d\", server.port)",
          "old_line_content": "    aeMain(server.el);",
          "new_line_content": "        redisLog(REDIS_NOTICE,\"The server is now ready to accept connections on port %d\", server.port);",
          "content_same": false
        },
        {
          "line": 1803,
          "old_api": "genRedisInfoString",
          "new_api": "REDIS_NOTUSED",
          "old_text": "genRedisInfoString(\"all\")",
          "new_text": "REDIS_NOTUSED(info)",
          "old_line_content": "    infostring = genRedisInfoString(\"all\");",
          "new_line_content": "    REDIS_NOTUSED(info);",
          "content_same": false
        },
        {
          "line": 1808,
          "old_api": "backtrace",
          "new_api": "redisLogRaw",
          "old_text": "backtrace(trace, 100)",
          "new_text": "redisLogRaw(REDIS_WARNING, infostring)",
          "old_line_content": "    trace_size = backtrace(trace, 100);",
          "new_line_content": "    redisLogRaw(REDIS_WARNING, infostring);",
          "content_same": false
        },
        {
          "line": 1823,
          "old_api": "sigemptyset (&act.sa_mask)",
          "new_api": "unlink",
          "old_text": "sigemptyset (&act.sa_mask)",
          "new_text": "unlink(server.pidfile)",
          "old_line_content": "    sigemptyset (&act.sa_mask);",
          "new_line_content": "    if (server.daemonize) unlink(server.pidfile);",
          "content_same": false
        },
        {
          "line": 1855,
          "old_api": "sigaction",
          "new_api": "sigemptyset",
          "old_text": "sigaction(SIGBUS, &act, NULL)",
          "new_text": "sigemptyset(&act.sa_mask)",
          "old_line_content": "    sigaction(SIGBUS, &act, NULL);",
          "new_line_content": "    sigemptyset(&act.sa_mask);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1539,
          "old_api": null,
          "new_api": "listAddNodeTail",
          "old_text": null,
          "new_text": "listAddNodeTail(server.monitors,c)",
          "old_line_content": "/* ============================ Maxmemory directive  ======================== */",
          "new_line_content": "    listAddNodeTail(server.monitors,c);",
          "content_same": false
        },
        {
          "line": 1540,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "",
          "new_line_content": "    addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 1561,
          "old_api": null,
          "new_api": "zmalloc_used_memory",
          "old_text": null,
          "new_text": "zmalloc_used_memory()",
          "old_line_content": "            long bestval = 0; /* just to prevent warning */",
          "new_line_content": "    while (server.maxmemory && zmalloc_used_memory() > server.maxmemory) {",
          "content_same": false
        },
        {
          "line": 1578,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(dict)",
          "old_line_content": "                server.maxmemory_policy == REDIS_MAXMEMORY_VOLATILE_RANDOM)",
          "new_line_content": "            if (dictSize(dict) == 0) continue;",
          "content_same": false
        },
        {
          "line": 1584,
          "old_api": null,
          "new_api": "dictGetRandomKey",
          "old_text": null,
          "new_text": "dictGetRandomKey(dict)",
          "old_line_content": "            /* volatile-lru and allkeys-lru policy */",
          "new_line_content": "                de = dictGetRandomKey(dict);",
          "content_same": false
        },
        {
          "line": 1585,
          "old_api": null,
          "new_api": "dictGetEntryKey",
          "old_text": null,
          "new_text": "dictGetEntryKey(de)",
          "old_line_content": "            else if (server.maxmemory_policy == REDIS_MAXMEMORY_ALLKEYS_LRU ||",
          "new_line_content": "                bestkey = dictGetEntryKey(de);",
          "content_same": false
        },
        {
          "line": 1597,
          "old_api": null,
          "new_api": "dictGetRandomKey",
          "old_text": null,
          "new_text": "dictGetRandomKey(dict)",
          "old_line_content": "                    if (server.maxmemory_policy == REDIS_MAXMEMORY_VOLATILE_LRU)",
          "new_line_content": "                    de = dictGetRandomKey(dict);",
          "content_same": false
        },
        {
          "line": 1602,
          "old_api": null,
          "new_api": "dictFind",
          "old_text": null,
          "new_text": "dictFind(db->dict, thiskey)",
          "old_line_content": "                    /* Higher idle time is better candidate for deletion */",
          "new_line_content": "                        de = dictFind(db->dict, thiskey);",
          "content_same": false
        },
        {
          "line": 1603,
          "old_api": null,
          "new_api": "dictGetEntryVal",
          "old_text": null,
          "new_text": "dictGetEntryVal(de)",
          "old_line_content": "                    if (bestkey == NULL || thisval > bestval) {",
          "new_line_content": "                    o = dictGetEntryVal(de);",
          "content_same": false
        },
        {
          "line": 1604,
          "old_api": null,
          "new_api": "estimateObjectIdleTime",
          "old_text": null,
          "new_text": "estimateObjectIdleTime(o)",
          "old_line_content": "                        bestkey = thiskey;",
          "new_line_content": "                    thisval = estimateObjectIdleTime(o);",
          "content_same": false
        },
        {
          "line": 1620,
          "old_api": null,
          "new_api": "dictGetRandomKey",
          "old_text": null,
          "new_text": "dictGetRandomKey(dict)",
          "old_line_content": "                    /* Expire sooner (minor expire unix timestamp) is better",
          "new_line_content": "                    de = dictGetRandomKey(dict);",
          "content_same": false
        },
        {
          "line": 1621,
          "old_api": null,
          "new_api": "dictGetEntryKey",
          "old_text": null,
          "new_text": "dictGetEntryKey(de)",
          "old_line_content": "                     * candidate for deletion */",
          "new_line_content": "                    thiskey = dictGetEntryKey(de);",
          "content_same": false
        },
        {
          "line": 1622,
          "old_api": null,
          "new_api": "dictGetEntryVal",
          "old_text": null,
          "new_text": "dictGetEntryVal(de)",
          "old_line_content": "                    if (bestkey == NULL || thisval < bestval) {",
          "new_line_content": "                    thisval = (long) dictGetEntryVal(de);",
          "content_same": false
        },
        {
          "line": 1636,
          "old_api": null,
          "new_api": "propagateExpire",
          "old_text": null,
          "new_text": "propagateExpire(db,keyobj)",
          "old_line_content": "                freed++;",
          "new_line_content": "                propagateExpire(db,keyobj);",
          "content_same": false
        },
        {
          "line": 1637,
          "old_api": null,
          "new_api": "dbDelete",
          "old_text": null,
          "new_text": "dbDelete(db,keyobj)",
          "old_line_content": "            }",
          "new_line_content": "                dbDelete(db,keyobj);",
          "content_same": false
        },
        {
          "line": 1639,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(keyobj)",
          "old_line_content": "        if (!freed) return; /* nothing to free... */",
          "new_line_content": "                decrRefCount(keyobj);",
          "content_same": false
        },
        {
          "line": 1656,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(fp)",
          "old_line_content": "",
          "new_line_content": "        fclose(fp);",
          "content_same": false
        },
        {
          "line": 1659,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(fp)",
          "old_line_content": "",
          "new_line_content": "    fclose(fp);",
          "content_same": false
        },
        {
          "line": 1665,
          "old_api": null,
          "new_api": "linuxOvercommitMemoryValue",
          "old_text": null,
          "new_text": "linuxOvercommitMemoryValue()",
          "old_line_content": "#endif /* __linux__ */",
          "new_line_content": "    if (linuxOvercommitMemoryValue() == 0) {",
          "content_same": false
        },
        {
          "line": 1666,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.\")",
          "old_line_content": "",
          "new_line_content": "        redisLog(REDIS_WARNING,\"WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.\");",
          "content_same": false
        },
        {
          "line": 1673,
          "old_api": null,
          "new_api": "fopen",
          "old_text": null,
          "new_text": "fopen(server.pidfile,\"w\")",
          "old_line_content": "    }",
          "new_line_content": "    FILE *fp = fopen(server.pidfile,\"w\");",
          "content_same": false
        },
        {
          "line": 1675,
          "old_api": null,
          "new_api": "getpid",
          "old_text": null,
          "new_text": "getpid()",
          "old_line_content": "",
          "new_line_content": "        fprintf(fp,\"%d\\n\",(int)getpid());",
          "content_same": false
        },
        {
          "line": 1676,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(fp)",
          "old_line_content": "void daemonize(void) {",
          "new_line_content": "        fclose(fp);",
          "content_same": false
        },
        {
          "line": 1683,
          "old_api": null,
          "new_api": "exit",
          "old_text": null,
          "new_text": "exit(0)",
          "old_line_content": "     * the 'logfile' is set to 'stdout' in the configuration file",
          "new_line_content": "    if (fork() != 0) exit(0); /* parent exits */",
          "content_same": false
        },
        {
          "line": 1684,
          "old_api": null,
          "new_api": "setsid",
          "old_text": null,
          "new_text": "setsid()",
          "old_line_content": "     * it will not log at all. */",
          "new_line_content": "    setsid(); /* create a new session */",
          "content_same": false
        },
        {
          "line": 1690,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(fd, STDIN_FILENO)",
          "old_line_content": "    }",
          "new_line_content": "        dup2(fd, STDIN_FILENO);",
          "content_same": false
        },
        {
          "line": 1691,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(fd, STDOUT_FILENO)",
          "old_line_content": "}",
          "new_line_content": "        dup2(fd, STDOUT_FILENO);",
          "content_same": false
        },
        {
          "line": 1692,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(fd, STDERR_FILENO)",
          "old_line_content": "",
          "new_line_content": "        dup2(fd, STDERR_FILENO);",
          "content_same": false
        },
        {
          "line": 1693,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "void version() {",
          "new_line_content": "        if (fd > STDERR_FILENO) close(fd);",
          "content_same": false
        },
        {
          "line": 1698,
          "old_api": null,
          "new_api": "printf",
          "old_text": null,
          "new_text": "printf(\"Redis server version %s (%s:%d)\\n\", REDIS_VERSION,\n        redisGitSHA1(), atoi(redisGitDirty()) > 0)",
          "old_line_content": "",
          "new_line_content": "    printf(\"Redis server version %s (%s:%d)\\n\", REDIS_VERSION,",
          "content_same": false
        },
        {
          "line": 1699,
          "old_api": null,
          "new_api": "redisGitDirty",
          "old_text": null,
          "new_text": "redisGitDirty()",
          "old_line_content": "void usage() {",
          "new_line_content": "        redisGitSHA1(), atoi(redisGitDirty()) > 0);",
          "content_same": false
        },
        {
          "line": 1704,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr,\"Usage: ./redis-server [/path/to/redis.conf]\\n\")",
          "old_line_content": "",
          "new_line_content": "    fprintf(stderr,\"Usage: ./redis-server [/path/to/redis.conf]\\n\");",
          "content_same": false
        },
        {
          "line": 1705,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr,\"       ./redis-server - (read config from stdin)\\n\")",
          "old_line_content": "void redisAsciiArt(void) {",
          "new_line_content": "    fprintf(stderr,\"       ./redis-server - (read config from stdin)\\n\");",
          "content_same": false
        },
        {
          "line": 1194,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(server.ipfd)",
          "old_line_content": "    return REDIS_OK;",
          "new_line_content": "    if (server.ipfd != -1) close(server.ipfd);",
          "content_same": false
        },
        {
          "line": 1195,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(server.sofd)",
          "old_line_content": "}",
          "new_line_content": "    if (server.sofd != -1) close(server.sofd);",
          "content_same": false
        },
        {
          "line": 1706,
          "old_api": null,
          "new_api": "exit",
          "old_text": null,
          "new_text": "exit(1)",
          "old_line_content": "#include \"asciilogo.h\"",
          "new_line_content": "    exit(1);",
          "content_same": false
        },
        {
          "line": 1197,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"Redis is now ready to exit, bye bye...\")",
          "old_line_content": "/*================================== Commands =============================== */",
          "new_line_content": "    redisLog(REDIS_WARNING,\"Redis is now ready to exit, bye bye...\");",
          "content_same": false
        },
        {
          "line": 1713,
          "old_api": null,
          "new_api": "snprintf",
          "old_text": null,
          "new_text": "snprintf(buf,1024*16,ascii_logo,\n        REDIS_VERSION,\n        redisGitSHA1(),\n        strtol(redisGitDirty(),NULL,10) > 0,\n        (sizeof(long) == 8) ? \"64\" : \"32\",\n        server.cluster_enabled ? \"cluster\" : \"stand alone\",\n        server.port,\n        (long) getpid()\n    )",
          "old_line_content": "        (sizeof(long) == 8) ? \"64\" : \"32\",",
          "new_line_content": "    snprintf(buf,1024*16,ascii_logo,",
          "content_same": false
        },
        {
          "line": 1715,
          "old_api": null,
          "new_api": "redisGitSHA1",
          "old_text": null,
          "new_text": "redisGitSHA1()",
          "old_line_content": "        server.port,",
          "new_line_content": "        redisGitSHA1(),",
          "content_same": false
        },
        {
          "line": 1204,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(c->argv[1]->ptr, server.requirepass)",
          "old_line_content": "      c->authenticated = 0;",
          "new_line_content": "    if (!server.requirepass || !strcmp(c->argv[1]->ptr, server.requirepass)) {",
          "content_same": false
        },
        {
          "line": 1206,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "    }",
          "new_line_content": "      addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 1720,
          "old_api": null,
          "new_api": "getpid",
          "old_text": null,
          "new_text": "getpid()",
          "old_line_content": "}",
          "new_line_content": "        (long) getpid()",
          "content_same": false
        },
        {
          "line": 1209,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c,\"invalid password\")",
          "old_line_content": "void pingCommand(redisClient *c) {",
          "new_line_content": "      addReplyError(c,\"invalid password\");",
          "content_same": false
        },
        {
          "line": 1722,
          "old_api": null,
          "new_api": "redisLogRaw",
          "old_text": null,
          "new_text": "redisLogRaw(REDIS_NOTICE|REDIS_LOG_RAW,buf)",
          "old_line_content": "int main(int argc, char **argv) {",
          "new_line_content": "    redisLogRaw(REDIS_NOTICE|REDIS_LOG_RAW,buf);",
          "content_same": false
        },
        {
          "line": 1723,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(buf)",
          "old_line_content": "    long long start;",
          "new_line_content": "    zfree(buf);",
          "content_same": false
        },
        {
          "line": 1218,
          "old_api": null,
          "new_api": "addReplyBulk",
          "old_text": null,
          "new_text": "addReplyBulk(c,c->argv[1])",
          "old_line_content": " * of 100B, 2G, 100M, 4K, and so forth. */",
          "new_line_content": "    addReplyBulk(c,c->argv[1]);",
          "content_same": false
        },
        {
          "line": 1732,
          "old_api": null,
          "new_api": "version",
          "old_text": null,
          "new_text": "version()",
          "old_line_content": "    } else if ((argc > 2)) {",
          "new_line_content": "            strcmp(argv[1], \"--version\") == 0) version();",
          "content_same": false
        },
        {
          "line": 1734,
          "old_api": null,
          "new_api": "resetServerSaveParams",
          "old_text": null,
          "new_text": "resetServerSaveParams()",
          "old_line_content": "    } else {",
          "new_line_content": "        resetServerSaveParams();",
          "content_same": false
        },
        {
          "line": 1742,
          "old_api": null,
          "new_api": "initServer",
          "old_text": null,
          "new_text": "initServer()",
          "old_line_content": "#ifdef __linux__",
          "new_line_content": "    initServer();",
          "content_same": false
        },
        {
          "line": 1232,
          "old_api": null,
          "new_api": "sprintf",
          "old_text": null,
          "new_text": "sprintf(s,\"%.2fK\",d)",
          "old_line_content": "    } else if (n < (1024LL*1024*1024*1024)) {",
          "new_line_content": "        sprintf(s,\"%.2fK\",d);",
          "content_same": false
        },
        {
          "line": 1744,
          "old_api": null,
          "new_api": "redisAsciiArt",
          "old_text": null,
          "new_text": "redisAsciiArt()",
          "old_line_content": "#endif",
          "new_line_content": "    redisAsciiArt();",
          "content_same": false
        },
        {
          "line": 1235,
          "old_api": null,
          "new_api": "sprintf",
          "old_text": null,
          "new_text": "sprintf(s,\"%.2fM\",d)",
          "old_line_content": "    }",
          "new_line_content": "        sprintf(s,\"%.2fM\",d);",
          "content_same": false
        },
        {
          "line": 1749,
          "old_api": null,
          "new_api": "ustime",
          "old_text": null,
          "new_text": "ustime()",
          "old_line_content": "    } else {",
          "new_line_content": "    start = ustime();",
          "content_same": false
        },
        {
          "line": 1238,
          "old_api": null,
          "new_api": "sprintf",
          "old_text": null,
          "new_text": "sprintf(s,\"%.2fG\",d)",
          "old_line_content": "/* Create the string returned by the INFO command. This is decoupled",
          "new_line_content": "        sprintf(s,\"%.2fG\",d);",
          "content_same": false
        },
        {
          "line": 1752,
          "old_api": null,
          "new_api": "ustime",
          "old_text": null,
          "new_text": "ustime()",
          "old_line_content": "    }",
          "new_line_content": "            redisLog(REDIS_NOTICE,\"DB loaded from append only file: %.3f seconds\",(float)(ustime()-start)/1000000);",
          "content_same": false
        },
        {
          "line": 1755,
          "old_api": null,
          "new_api": "ustime",
          "old_text": null,
          "new_text": "ustime()",
          "old_line_content": "    if (server.sofd > 0)",
          "new_line_content": "            redisLog(REDIS_NOTICE,\"DB loaded from disk: %.3f seconds\",(float)(ustime()-start)/1000000);",
          "content_same": false
        },
        {
          "line": 1246,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "    unsigned long lol, bib;",
          "new_line_content": "    sds info = sdsempty();",
          "content_same": false
        },
        {
          "line": 1247,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "    int allsections = 0, defsections = 0;",
          "new_line_content": "    time_t uptime = time(NULL)-server.stat_starttime;",
          "content_same": false
        },
        {
          "line": 1760,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_NOTICE,\"The server is now ready to accept connections at %s\", server.unixsocket)",
          "old_line_content": "    return 0;",
          "new_line_content": "        redisLog(REDIS_NOTICE,\"The server is now ready to accept connections at %s\", server.unixsocket);",
          "content_same": false
        },
        {
          "line": 1761,
          "old_api": null,
          "new_api": "aeSetBeforeSleepProc",
          "old_text": null,
          "new_text": "aeSetBeforeSleepProc(server.el,beforeSleep)",
          "old_line_content": "}",
          "new_line_content": "    aeSetBeforeSleepProc(server.el,beforeSleep);",
          "content_same": false
        },
        {
          "line": 1762,
          "old_api": null,
          "new_api": "aeMain",
          "old_text": null,
          "new_text": "aeMain(server.el)",
          "old_line_content": "",
          "new_line_content": "    aeMain(server.el);",
          "content_same": false
        },
        {
          "line": 1763,
          "old_api": null,
          "new_api": "aeDeleteEventLoop",
          "old_text": null,
          "new_text": "aeDeleteEventLoop(server.el)",
          "old_line_content": "#ifdef HAVE_BACKTRACE",
          "new_line_content": "    aeDeleteEventLoop(server.el);",
          "content_same": false
        },
        {
          "line": 1259,
          "old_api": null,
          "new_api": "getrusage",
          "old_text": null,
          "new_text": "getrusage(RUSAGE_SELF, &self_ru)",
          "old_line_content": "    /* Server */",
          "new_line_content": "    getrusage(RUSAGE_SELF, &self_ru);",
          "content_same": false
        },
        {
          "line": 1264,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"server\")",
          "old_line_content": "            \"redis_version:%s\\r\\n\"",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"server\")) {",
          "content_same": false
        },
        {
          "line": 1265,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "            \"redis_git_sha1:%s\\r\\n\"",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 1266,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"# Server\\r\\n\"\n            \"redis_version:%s\\r\\n\"\n            \"redis_git_sha1:%s\\r\\n\"\n            \"redis_git_dirty:%d\\r\\n\"\n            \"arch_bits:%s\\r\\n\"\n            \"multiplexing_api:%s\\r\\n\"\n            \"process_id:%ld\\r\\n\"\n            \"tcp_port:%d\\r\\n\"\n            \"uptime_in_seconds:%ld\\r\\n\"\n            \"uptime_in_days:%ld\\r\\n\"\n            \"lru_clock:%ld\\r\\n\",\n            REDIS_VERSION,\n            redisGitSHA1(),\n            strtol(redisGitDirty(),NULL,10) > 0,\n            (sizeof(long) == 8) ? \"64\" : \"32\",\n            aeGetApiName(),\n            (long) getpid(),\n            server.port,\n            uptime,\n            uptime/(3600*24),\n            (unsigned long) server.lruclock)",
          "old_line_content": "            \"redis_git_dirty:%d\\r\\n\"",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1280,
          "old_api": null,
          "new_api": "redisGitDirty",
          "old_text": null,
          "new_text": "redisGitDirty()",
          "old_line_content": "            server.port,",
          "new_line_content": "            strtol(redisGitDirty(),NULL,10) > 0,",
          "content_same": false
        },
        {
          "line": 1282,
          "old_api": null,
          "new_api": "aeGetApiName",
          "old_text": null,
          "new_text": "aeGetApiName()",
          "old_line_content": "            uptime/(3600*24),",
          "new_line_content": "            aeGetApiName(),",
          "content_same": false
        },
        {
          "line": 1283,
          "old_api": null,
          "new_api": "getpid",
          "old_text": null,
          "new_text": "getpid()",
          "old_line_content": "            (unsigned long) server.lruclock);",
          "new_line_content": "            (long) getpid(),",
          "content_same": false
        },
        {
          "line": 1291,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"clients\")",
          "old_line_content": "            \"connected_clients:%d\\r\\n\"",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"clients\")) {",
          "content_same": false
        },
        {
          "line": 1292,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "            \"client_longest_output_list:%lu\\r\\n\"",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 1293,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"# Clients\\r\\n\"\n            \"connected_clients:%d\\r\\n\"\n            \"client_longest_output_list:%lu\\r\\n\"\n            \"client_biggest_input_buf:%lu\\r\\n\"\n            \"blocked_clients:%d\\r\\n\",\n            listLength(server.clients)-listLength(server.slaves),\n            lol, bib,\n            server.bpop_blocked_clients)",
          "old_line_content": "            \"client_biggest_input_buf:%lu\\r\\n\"",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1805,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\n        \"======= Ooops! Redis %s got signal: -%d- =======\", REDIS_VERSION, sig)",
          "old_line_content": "    /* It's not safe to sdsfree() the returned string under memory",
          "new_line_content": "    redisLog(REDIS_WARNING,",
          "content_same": false
        },
        {
          "line": 1807,
          "old_api": null,
          "new_api": "genRedisInfoString",
          "old_text": null,
          "new_text": "genRedisInfoString(\"all\")",
          "old_line_content": "",
          "new_line_content": "    infostring = genRedisInfoString(\"all\");",
          "content_same": false
        },
        {
          "line": 1299,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(server.slaves)",
          "old_line_content": "",
          "new_line_content": "            listLength(server.clients)-listLength(server.slaves),",
          "content_same": false
        },
        {
          "line": 1812,
          "old_api": null,
          "new_api": "backtrace",
          "old_text": null,
          "new_text": "backtrace(trace, 100)",
          "old_line_content": "    }",
          "new_line_content": "    trace_size = backtrace(trace, 100);",
          "content_same": false
        },
        {
          "line": 1814,
          "old_api": null,
          "new_api": "getMcontextEip",
          "old_text": null,
          "new_text": "getMcontextEip(uc)",
          "old_line_content": "",
          "new_line_content": "    if (getMcontextEip(uc) != NULL) {",
          "content_same": false
        },
        {
          "line": 1815,
          "old_api": null,
          "new_api": "getMcontextEip",
          "old_text": null,
          "new_text": "getMcontextEip(uc)",
          "old_line_content": "    for (i=1; i<trace_size; ++i)",
          "new_line_content": "        trace[1] = getMcontextEip(uc);",
          "content_same": false
        },
        {
          "line": 1817,
          "old_api": null,
          "new_api": "backtrace_symbols",
          "old_text": null,
          "new_text": "backtrace_symbols(trace, trace_size)",
          "old_line_content": "",
          "new_line_content": "    messages = backtrace_symbols(trace, trace_size);",
          "content_same": false
        },
        {
          "line": 1820,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"%s\", messages[i])",
          "old_line_content": "",
          "new_line_content": "        redisLog(REDIS_WARNING,\"%s\", messages[i]);",
          "content_same": false
        },
        {
          "line": 1309,
          "old_api": null,
          "new_api": "zmalloc_used_memory",
          "old_text": null,
          "new_text": "zmalloc_used_memory()",
          "old_line_content": "            \"# Memory\\r\\n\"",
          "new_line_content": "        bytesToHuman(hmem,zmalloc_used_memory());",
          "content_same": false
        },
        {
          "line": 1310,
          "old_api": null,
          "new_api": "bytesToHuman",
          "old_text": null,
          "new_text": "bytesToHuman(peak_hmem,server.stat_peak_memory)",
          "old_line_content": "            \"used_memory:%zu\\r\\n\"",
          "new_line_content": "        bytesToHuman(peak_hmem,server.stat_peak_memory);",
          "content_same": false
        },
        {
          "line": 1311,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "            \"used_memory_human:%s\\r\\n\"",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 1312,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"# Memory\\r\\n\"\n            \"used_memory:%zu\\r\\n\"\n            \"used_memory_human:%s\\r\\n\"\n            \"used_memory_rss:%zu\\r\\n\"\n            \"used_memory_peak:%zu\\r\\n\"\n            \"used_memory_peak_human:%s\\r\\n\"\n            \"used_memory_lua:%lld\\r\\n\"\n            \"mem_fragmentation_ratio:%.2f\\r\\n\"\n            \"mem_allocator:%s\\r\\n\",\n            zmalloc_used_memory(),\n            hmem,\n            zmalloc_get_rss(),\n            server.stat_peak_memory,\n            peak_hmem,\n            ((long long)lua_gc(server.lua,LUA_GCCOUNT,0))*1024LL,\n            zmalloc_get_fragmentation_ratio(),\n            ZMALLOC_LIB\n            )",
          "old_line_content": "            \"used_memory_rss:%zu\\r\\n\"",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1827,
          "old_api": null,
          "new_api": "sigemptyset (&act.sa_mask)",
          "old_text": null,
          "new_text": "sigemptyset (&act.sa_mask)",
          "old_line_content": "    act.sa_handler = SIG_DFL;",
          "new_line_content": "    sigemptyset (&act.sa_mask);",
          "content_same": false
        },
        {
          "line": 1832,
          "old_api": null,
          "new_api": "sigaction (sig, &act, NULL)",
          "old_text": null,
          "new_text": "sigaction (sig, &act, NULL)",
          "old_line_content": "",
          "new_line_content": "    sigaction (sig, &act, NULL);",
          "content_same": false
        },
        {
          "line": 1833,
          "old_api": null,
          "new_api": "getpid",
          "old_text": null,
          "new_text": "getpid()",
          "old_line_content": "static void sigtermHandler(int sig) {",
          "new_line_content": "    kill(getpid(),sig);",
          "content_same": false
        },
        {
          "line": 1322,
          "old_api": null,
          "new_api": "zmalloc_used_memory",
          "old_text": null,
          "new_text": "zmalloc_used_memory()",
          "old_line_content": "            peak_hmem,",
          "new_line_content": "            zmalloc_used_memory(),",
          "content_same": false
        },
        {
          "line": 1838,
          "old_api": null,
          "new_api": "REDIS_NOTUSED",
          "old_text": null,
          "new_text": "REDIS_NOTUSED(sig)",
          "old_line_content": "}",
          "new_line_content": "    REDIS_NOTUSED(sig);",
          "content_same": false
        },
        {
          "line": 1327,
          "old_api": null,
          "new_api": "lua_gc",
          "old_text": null,
          "new_text": "lua_gc(server.lua,LUA_GCCOUNT,0)",
          "old_line_content": "    }",
          "new_line_content": "            ((long long)lua_gc(server.lua,LUA_GCCOUNT,0))*1024LL,",
          "content_same": false
        },
        {
          "line": 1328,
          "old_api": null,
          "new_api": "zmalloc_get_fragmentation_ratio",
          "old_text": null,
          "new_text": "zmalloc_get_fragmentation_ratio()",
          "old_line_content": "",
          "new_line_content": "            zmalloc_get_fragmentation_ratio(),",
          "content_same": false
        },
        {
          "line": 1840,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_WARNING,\"Received SIGTERM, scheduling shutdown...\")",
          "old_line_content": "void setupSignalHandlers(void) {",
          "new_line_content": "    redisLog(REDIS_WARNING,\"Received SIGTERM, scheduling shutdown...\");",
          "content_same": false
        },
        {
          "line": 1334,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"persistence\")",
          "old_line_content": "            \"loading:%d\\r\\n\"",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"persistence\")) {",
          "content_same": false
        },
        {
          "line": 1335,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "            \"aof_enabled:%d\\r\\n\"",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 1336,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"# Persistence\\r\\n\"\n            \"loading:%d\\r\\n\"\n            \"aof_enabled:%d\\r\\n\"\n            \"changes_since_last_save:%lld\\r\\n\"\n            \"bgsave_in_progress:%d\\r\\n\"\n            \"last_save_time:%ld\\r\\n\"\n            \"bgrewriteaof_in_progress:%d\\r\\n\",\n            server.loading,\n            server.appendonly,\n            server.dirty,\n            server.bgsavechildpid != -1,\n            server.lastsave,\n            server.bgrewritechildpid != -1)",
          "old_line_content": "            \"changes_since_last_save:%lld\\r\\n\"",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1849,
          "old_api": null,
          "new_api": "sigemptyset",
          "old_text": null,
          "new_text": "sigemptyset(&act.sa_mask)",
          "old_line_content": "",
          "new_line_content": "    sigemptyset(&act.sa_mask);",
          "content_same": false
        },
        {
          "line": 1852,
          "old_api": null,
          "new_api": "sigaction",
          "old_text": null,
          "new_text": "sigaction(SIGTERM, &act, NULL)",
          "old_line_content": "    act.sa_flags = SA_NODEFER | SA_ONSTACK | SA_RESETHAND | SA_SIGINFO;",
          "new_line_content": "    sigaction(SIGTERM, &act, NULL);",
          "content_same": false
        },
        {
          "line": 1858,
          "old_api": null,
          "new_api": "sigaction",
          "old_text": null,
          "new_text": "sigaction(SIGSEGV, &act, NULL)",
          "old_line_content": "#endif",
          "new_line_content": "    sigaction(SIGSEGV, &act, NULL);",
          "content_same": false
        },
        {
          "line": 1859,
          "old_api": null,
          "new_api": "sigaction",
          "old_text": null,
          "new_text": "sigaction(SIGBUS, &act, NULL)",
          "old_line_content": "    return;",
          "new_line_content": "    sigaction(SIGBUS, &act, NULL);",
          "content_same": false
        },
        {
          "line": 1860,
          "old_api": null,
          "new_api": "sigaction",
          "old_text": null,
          "new_text": "sigaction(SIGFPE, &act, NULL)",
          "old_line_content": "}",
          "new_line_content": "    sigaction(SIGFPE, &act, NULL);",
          "content_same": false
        },
        {
          "line": 1861,
          "old_api": null,
          "new_api": "sigaction",
          "old_text": null,
          "new_text": "sigaction(SIGILL, &act, NULL)",
          "old_line_content": "",
          "new_line_content": "    sigaction(SIGILL, &act, NULL);",
          "content_same": false
        },
        {
          "line": 1352,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                \"aof_current_size:%lld\\r\\n\"\n                \"aof_base_size:%lld\\r\\n\"\n                \"aof_pending_rewrite:%d\\r\\n\",\n                (long long) server.appendonly_current_size,\n                (long long) server.auto_aofrewrite_base_size,\n                server.aofrewrite_scheduled)",
          "old_line_content": "                (long long) server.appendonly_current_size,",
          "new_line_content": "            info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1370,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "            } else {",
          "new_line_content": "            elapsed = time(NULL)-server.loading_start_time;",
          "content_same": false
        },
        {
          "line": 1378,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                \"loading_start_time:%ld\\r\\n\"\n                \"loading_total_bytes:%llu\\r\\n\"\n                \"loading_loaded_bytes:%llu\\r\\n\"\n                \"loading_loaded_perc:%.2f\\r\\n\"\n                \"loading_eta_seconds:%ld\\r\\n\"\n                ,(unsigned long) server.loading_start_time,\n                (unsigned long long) server.loading_total_bytes,\n                (unsigned long long) server.loading_loaded_bytes,\n                perc,\n                eta\n            )",
          "old_line_content": "                \"loading_loaded_perc:%.2f\\r\\n\"",
          "new_line_content": "            info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1394,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"stats\")",
          "old_line_content": "            \"total_connections_received:%lld\\r\\n\"",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"stats\")) {",
          "content_same": false
        },
        {
          "line": 1395,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "            \"total_commands_processed:%lld\\r\\n\"",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 1396,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"# Stats\\r\\n\"\n            \"total_connections_received:%lld\\r\\n\"\n            \"total_commands_processed:%lld\\r\\n\"\n            \"expired_keys:%lld\\r\\n\"\n            \"evicted_keys:%lld\\r\\n\"\n            \"keyspace_hits:%lld\\r\\n\"\n            \"keyspace_misses:%lld\\r\\n\"\n            \"pubsub_channels:%ld\\r\\n\"\n            \"pubsub_patterns:%u\\r\\n\"\n            \"latest_fork_usec:%lld\\r\\n\",\n            server.stat_numconnections,\n            server.stat_numcommands,\n            server.stat_expiredkeys,\n            server.stat_evictedkeys,\n            server.stat_keyspace_hits,\n            server.stat_keyspace_misses,\n            dictSize(server.pubsub_channels),\n            listLength(server.pubsub_patterns),\n            server.stat_fork_time)",
          "old_line_content": "            \"expired_keys:%lld\\r\\n\"",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1413,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(server.pubsub_channels)",
          "old_line_content": "",
          "new_line_content": "            dictSize(server.pubsub_channels),",
          "content_same": false
        },
        {
          "line": 1414,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(server.pubsub_patterns)",
          "old_line_content": "    /* Replication */",
          "new_line_content": "            listLength(server.pubsub_patterns),",
          "content_same": false
        },
        {
          "line": 1419,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"replication\")",
          "old_line_content": "            \"role:%s\\r\\n\",",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"replication\")) {",
          "content_same": false
        },
        {
          "line": 1420,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "            server.masterhost == NULL ? \"master\" : \"slave\");",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 1421,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"# Replication\\r\\n\"\n            \"role:%s\\r\\n\",\n            server.masterhost == NULL ? \"master\" : \"slave\")",
          "old_line_content": "        if (server.masterhost) {",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1426,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                \"master_host:%s\\r\\n\"\n                \"master_port:%d\\r\\n\"\n                \"master_link_status:%s\\r\\n\"\n                \"master_last_io_seconds_ago:%d\\r\\n\"\n                \"master_sync_in_progress:%d\\r\\n\"\n                ,server.masterhost,\n                server.masterport,\n                (server.replstate == REDIS_REPL_CONNECTED) ?\n                    \"up\" : \"down\",\n                server.master ?\n                ((int)(time(NULL)-server.master->lastinteraction)) : -1,\n                server.replstate == REDIS_REPL_TRANSFER\n            )",
          "old_line_content": "                \"master_last_io_seconds_ago:%d\\r\\n\"",
          "new_line_content": "            info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1437,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "            if (server.replstate == REDIS_REPL_TRANSFER) {",
          "new_line_content": "                ((int)(time(NULL)-server.master->lastinteraction)) : -1,",
          "content_same": false
        },
        {
          "line": 1446,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "            if (server.replstate != REDIS_REPL_CONNECTED) {",
          "new_line_content": "                    (int)(time(NULL)-server.repl_transfer_lastio)",
          "content_same": false
        },
        {
          "line": 1451,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                    \"master_link_down_since_seconds:%ld\\r\\n\",\n                    (long)time(NULL)-server.repl_down_since)",
          "old_line_content": "        }",
          "new_line_content": "                info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1453,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "            \"connected_slaves:%d\\r\\n\",",
          "new_line_content": "                    (long)time(NULL)-server.repl_down_since);",
          "content_same": false
        },
        {
          "line": 1456,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n            \"connected_slaves:%d\\r\\n\",\n            listLength(server.slaves))",
          "old_line_content": "",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1462,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"cpu\")",
          "old_line_content": "        \"used_cpu_sys:%.2f\\r\\n\"",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"cpu\")) {",
          "content_same": false
        },
        {
          "line": 1463,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "        \"used_cpu_user:%.2f\\r\\n\"",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 1464,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n        \"# CPU\\r\\n\"\n        \"used_cpu_sys:%.2f\\r\\n\"\n        \"used_cpu_user:%.2f\\r\\n\"\n        \"used_cpu_sys_children:%.2f\\r\\n\"\n        \"used_cpu_user_children:%.2f\\r\\n\",\n        (float)self_ru.ru_utime.tv_sec+(float)self_ru.ru_utime.tv_usec/1000000,\n        (float)self_ru.ru_stime.tv_sec+(float)self_ru.ru_stime.tv_usec/1000000,\n        (float)c_ru.ru_utime.tv_sec+(float)c_ru.ru_utime.tv_usec/1000000,\n        (float)c_ru.ru_stime.tv_sec+(float)c_ru.ru_stime.tv_usec/1000000)",
          "old_line_content": "        \"used_cpu_sys_children:%.2f\\r\\n\"",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1477,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"commandstats\")",
          "old_line_content": "        for (j = 0; j < numcommands; j++) {",
          "new_line_content": "    if (allsections || !strcasecmp(section,\"commandstats\")) {",
          "content_same": false
        },
        {
          "line": 1478,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "            struct redisCommand *c = redisCommandTable+j;",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 1479,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info, \"# Commandstats\\r\\n\")",
          "old_line_content": "",
          "new_line_content": "        info = sdscatprintf(info, \"# Commandstats\\r\\n\");",
          "content_same": false
        },
        {
          "line": 1485,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n                \"cmdstat_%s:calls=%lld,usec=%lld,usec_per_call=%.2f\\r\\n\",\n                c->name, c->calls, c->microseconds,\n                (c->calls == 0) ? 0 : ((float)c->microseconds/c->calls))",
          "old_line_content": "        }",
          "new_line_content": "            info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1493,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"cluster\")",
          "old_line_content": "        \"cluster_enabled:%d\\r\\n\",",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"cluster\")) {",
          "content_same": false
        },
        {
          "line": 1494,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "        server.cluster_enabled);",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 1495,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info,\n        \"# Cluster\\r\\n\"\n        \"cluster_enabled:%d\\r\\n\",\n        server.cluster_enabled)",
          "old_line_content": "    }",
          "new_line_content": "        info = sdscatprintf(info,",
          "content_same": false
        },
        {
          "line": 1502,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(section,\"keyspace\")",
          "old_line_content": "            long long keys, vkeys;",
          "new_line_content": "    if (allsections || defsections || !strcasecmp(section,\"keyspace\")) {",
          "content_same": false
        },
        {
          "line": 1503,
          "old_api": null,
          "new_api": "sdscat",
          "old_text": null,
          "new_text": "sdscat(info,\"\\r\\n\")",
          "old_line_content": "",
          "new_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "content_same": false
        },
        {
          "line": 1508,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(server.db[j].dict)",
          "old_line_content": "                    j, keys, vkeys);",
          "new_line_content": "            keys = dictSize(server.db[j].dict);",
          "content_same": false
        },
        {
          "line": 1509,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(server.db[j].expires)",
          "old_line_content": "            }",
          "new_line_content": "            vkeys = dictSize(server.db[j].expires);",
          "content_same": false
        },
        {
          "line": 1511,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(info, \"db%d:keys=%lld,expires=%lld\\r\\n\",\n                    j, keys, vkeys)",
          "old_line_content": "    }",
          "new_line_content": "                info = sdscatprintf(info, \"db%d:keys=%lld,expires=%lld\\r\\n\",",
          "content_same": false
        },
        {
          "line": 1527,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "}",
          "new_line_content": "    addReplySds(c,sdscatprintf(sdsempty(),\"$%lu\\r\\n\",",
          "content_same": false
        },
        {
          "line": 1528,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(info)",
          "old_line_content": "",
          "new_line_content": "        (unsigned long)sdslen(info)));",
          "content_same": false
        },
        {
          "line": 1529,
          "old_api": null,
          "new_api": "addReplySds",
          "old_text": null,
          "new_text": "addReplySds(c,info)",
          "old_line_content": "void monitorCommand(redisClient *c) {",
          "new_line_content": "    addReplySds(c,info);",
          "content_same": false
        },
        {
          "line": 1530,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.crlf)",
          "old_line_content": "    /* ignore MONITOR if aleady slave or in monitor mode */",
          "new_line_content": "    addReply(c,shared.crlf);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1536,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.ok)",
          "new_text": null,
          "old_line_content": "    addReply(c,shared.ok);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1557,
          "old_api": "zmalloc_used_memory",
          "new_api": null,
          "old_text": "zmalloc_used_memory()",
          "new_text": null,
          "old_line_content": "    while (server.maxmemory && zmalloc_used_memory() > server.maxmemory) {",
          "new_line_content": "    /* Remove keys accordingly to the active policy as long as we are",
          "content_same": false
        },
        {
          "line": 1574,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(dict)",
          "new_text": null,
          "old_line_content": "            if (dictSize(dict) == 0) continue;",
          "new_line_content": "                dict = server.db[j].dict;",
          "content_same": false
        },
        {
          "line": 1580,
          "old_api": "dictGetRandomKey",
          "new_api": null,
          "old_text": "dictGetRandomKey(dict)",
          "new_text": null,
          "old_line_content": "                de = dictGetRandomKey(dict);",
          "new_line_content": "            /* volatile-random and allkeys-random policy */",
          "content_same": false
        },
        {
          "line": 1581,
          "old_api": "dictGetEntryKey",
          "new_api": null,
          "old_text": "dictGetEntryKey(de)",
          "new_text": null,
          "old_line_content": "                bestkey = dictGetEntryKey(de);",
          "new_line_content": "            if (server.maxmemory_policy == REDIS_MAXMEMORY_ALLKEYS_RANDOM ||",
          "content_same": false
        },
        {
          "line": 1593,
          "old_api": "dictGetRandomKey",
          "new_api": null,
          "old_text": "dictGetRandomKey(dict)",
          "new_text": null,
          "old_line_content": "                    de = dictGetRandomKey(dict);",
          "new_line_content": "                    sds thiskey;",
          "content_same": false
        },
        {
          "line": 1594,
          "old_api": "dictGetEntryKey",
          "new_api": null,
          "old_text": "dictGetEntryKey(de)",
          "new_text": null,
          "old_line_content": "                    thiskey = dictGetEntryKey(de);",
          "new_line_content": "                    long thisval;",
          "content_same": false
        },
        {
          "line": 1599,
          "old_api": "dictGetEntryVal",
          "new_api": null,
          "old_text": "dictGetEntryVal(de)",
          "new_text": null,
          "old_line_content": "                    o = dictGetEntryVal(de);",
          "new_line_content": "                    /* When policy is volatile-lru we need an additonal lookup",
          "content_same": false
        },
        {
          "line": 1600,
          "old_api": "estimateObjectIdleTime",
          "new_api": null,
          "old_text": "estimateObjectIdleTime(o)",
          "new_text": null,
          "old_line_content": "                    thisval = estimateObjectIdleTime(o);",
          "new_line_content": "                     * to locate the real key, as dict is set to db->expires. */",
          "content_same": false
        },
        {
          "line": 1616,
          "old_api": "dictGetRandomKey",
          "new_api": null,
          "old_text": "dictGetRandomKey(dict)",
          "new_text": null,
          "old_line_content": "                    de = dictGetRandomKey(dict);",
          "new_line_content": "                for (k = 0; k < server.maxmemory_samples; k++) {",
          "content_same": false
        },
        {
          "line": 1617,
          "old_api": "dictGetEntryKey",
          "new_api": null,
          "old_text": "dictGetEntryKey(de)",
          "new_text": null,
          "old_line_content": "                    thiskey = dictGetEntryKey(de);",
          "new_line_content": "                    sds thiskey;",
          "content_same": false
        },
        {
          "line": 1618,
          "old_api": "dictGetEntryVal",
          "new_api": null,
          "old_text": "dictGetEntryVal(de)",
          "new_text": null,
          "old_line_content": "                    thisval = (long) dictGetEntryVal(de);",
          "new_line_content": "                    long thisval;",
          "content_same": false
        },
        {
          "line": 1631,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(bestkey)",
          "new_text": null,
          "old_line_content": "                robj *keyobj = createStringObject(bestkey,sdslen(bestkey));",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1632,
          "old_api": "propagateExpire",
          "new_api": null,
          "old_text": "propagateExpire(db,keyobj)",
          "new_text": null,
          "old_line_content": "                propagateExpire(db,keyobj);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1633,
          "old_api": "dbDelete",
          "new_api": null,
          "old_text": "dbDelete(db,keyobj)",
          "new_text": null,
          "old_line_content": "                dbDelete(db,keyobj);",
          "new_line_content": "            /* Finally remove the selected key. */",
          "content_same": false
        },
        {
          "line": 1647,
          "old_api": "fopen",
          "new_api": null,
          "old_text": "fopen(\"/proc/sys/vm/overcommit_memory\",\"r\")",
          "new_text": null,
          "old_line_content": "    FILE *fp = fopen(\"/proc/sys/vm/overcommit_memory\",\"r\");",
          "new_line_content": "/* =================================== Main! ================================ */",
          "content_same": false
        },
        {
          "line": 1652,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(fp)",
          "new_text": null,
          "old_line_content": "        fclose(fp);",
          "new_line_content": "    char buf[64];",
          "content_same": false
        },
        {
          "line": 1657,
          "old_api": "atoi",
          "new_api": null,
          "old_text": "atoi(buf)",
          "new_text": null,
          "old_line_content": "    return atoi(buf);",
          "new_line_content": "        return -1;",
          "content_same": false
        },
        {
          "line": 1662,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.\")",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_WARNING,\"WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1669,
          "old_api": "fopen",
          "new_api": null,
          "old_text": "fopen(server.pidfile,\"w\")",
          "new_text": null,
          "old_line_content": "    FILE *fp = fopen(server.pidfile,\"w\");",
          "new_line_content": "#endif /* __linux__ */",
          "content_same": false
        },
        {
          "line": 1671,
          "old_api": "getpid",
          "new_api": null,
          "old_text": "getpid()",
          "new_text": null,
          "old_line_content": "        fprintf(fp,\"%d\\n\",(int)getpid());",
          "new_line_content": "void createPidFile(void) {",
          "content_same": false
        },
        {
          "line": 1672,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(fp)",
          "new_text": null,
          "old_line_content": "        fclose(fp);",
          "new_line_content": "    /* Try to write the pid file in a best-effort way. */",
          "content_same": false
        },
        {
          "line": 1679,
          "old_api": "exit",
          "new_api": null,
          "old_text": "exit(0)",
          "new_text": null,
          "old_line_content": "    if (fork() != 0) exit(0); /* parent exits */",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1680,
          "old_api": "setsid",
          "new_api": null,
          "old_text": "setsid()",
          "new_text": null,
          "old_line_content": "    setsid(); /* create a new session */",
          "new_line_content": "void daemonize(void) {",
          "content_same": false
        },
        {
          "line": 1685,
          "old_api": "open",
          "new_api": null,
          "old_text": "open(\"/dev/null\", O_RDWR, 0)",
          "new_text": null,
          "old_line_content": "    if ((fd = open(\"/dev/null\", O_RDWR, 0)) != -1) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1686,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(fd, STDIN_FILENO)",
          "new_text": null,
          "old_line_content": "        dup2(fd, STDIN_FILENO);",
          "new_line_content": "    /* Every output goes to /dev/null. If Redis is daemonized but",
          "content_same": false
        },
        {
          "line": 1687,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(fd, STDOUT_FILENO)",
          "new_text": null,
          "old_line_content": "        dup2(fd, STDOUT_FILENO);",
          "new_line_content": "     * the 'logfile' is set to 'stdout' in the configuration file",
          "content_same": false
        },
        {
          "line": 1688,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(fd, STDERR_FILENO)",
          "new_text": null,
          "old_line_content": "        dup2(fd, STDERR_FILENO);",
          "new_line_content": "     * it will not log at all. */",
          "content_same": false
        },
        {
          "line": 1694,
          "old_api": "printf",
          "new_api": null,
          "old_text": "printf(\"Redis server version %s (%s:%d)\\n\", REDIS_VERSION,\n        redisGitSHA1(), atoi(redisGitDirty()) > 0)",
          "new_text": null,
          "old_line_content": "    printf(\"Redis server version %s (%s:%d)\\n\", REDIS_VERSION,",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1695,
          "old_api": "redisGitDirty",
          "new_api": null,
          "old_text": "redisGitDirty()",
          "new_text": null,
          "old_line_content": "        redisGitSHA1(), atoi(redisGitDirty()) > 0);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1696,
          "old_api": "exit",
          "new_api": null,
          "old_text": "exit(0)",
          "new_text": null,
          "old_line_content": "    exit(0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1701,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr,\"       ./redis-server - (read config from stdin)\\n\")",
          "new_text": null,
          "old_line_content": "    fprintf(stderr,\"       ./redis-server - (read config from stdin)\\n\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1702,
          "old_api": "exit",
          "new_api": null,
          "old_text": "exit(1)",
          "new_text": null,
          "old_line_content": "    exit(1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1193,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"Redis is now ready to exit, bye bye...\")",
          "new_text": null,
          "old_line_content": "    redisLog(REDIS_WARNING,\"Redis is now ready to exit, bye bye...\");",
          "new_line_content": "    /* Close the listening sockets. Apparently this allows faster restarts. */",
          "content_same": false
        },
        {
          "line": 1707,
          "old_api": "zmalloc",
          "new_api": null,
          "old_text": "zmalloc(1024*16)",
          "new_text": null,
          "old_line_content": "    char *buf = zmalloc(1024*16);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1709,
          "old_api": "snprintf",
          "new_api": null,
          "old_text": "snprintf(buf,1024*16,ascii_logo,\n        REDIS_VERSION,\n        redisGitSHA1(),\n        strtol(redisGitDirty(),NULL,10) > 0,\n        (sizeof(long) == 8) ? \"64\" : \"32\",\n        server.cluster_enabled ? \"cluster\" : \"stand alone\",\n        server.port,\n        (long) getpid()\n    )",
          "new_text": null,
          "old_line_content": "    snprintf(buf,1024*16,ascii_logo,",
          "new_line_content": "void redisAsciiArt(void) {",
          "content_same": false
        },
        {
          "line": 1200,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(c->argv[1]->ptr, server.requirepass)",
          "new_text": null,
          "old_line_content": "    if (!server.requirepass || !strcmp(c->argv[1]->ptr, server.requirepass)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1712,
          "old_api": "redisGitDirty",
          "new_api": null,
          "old_text": "redisGitDirty()",
          "new_text": null,
          "old_line_content": "        strtol(redisGitDirty(),NULL,10) > 0,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1202,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.ok)",
          "new_text": null,
          "old_line_content": "      addReply(c,shared.ok);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1205,
          "old_api": "addReplyError",
          "new_api": null,
          "old_text": "addReplyError(c,\"invalid password\")",
          "new_text": null,
          "old_line_content": "      addReplyError(c,\"invalid password\");",
          "new_line_content": "      c->authenticated = 1;",
          "content_same": false
        },
        {
          "line": 1718,
          "old_api": "redisLogRaw",
          "new_api": null,
          "old_text": "redisLogRaw(REDIS_NOTICE|REDIS_LOG_RAW,buf)",
          "new_text": null,
          "old_line_content": "    redisLogRaw(REDIS_NOTICE|REDIS_LOG_RAW,buf);",
          "new_line_content": "        server.cluster_enabled ? \"cluster\" : \"stand alone\",",
          "content_same": false
        },
        {
          "line": 1719,
          "old_api": "zfree",
          "new_api": null,
          "old_text": "zfree(buf)",
          "new_text": null,
          "old_line_content": "    zfree(buf);",
          "new_line_content": "        server.port,",
          "content_same": false
        },
        {
          "line": 1210,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.pong)",
          "new_text": null,
          "old_line_content": "    addReply(c,shared.pong);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1725,
          "old_api": "initServerConfig",
          "new_api": null,
          "old_text": "initServerConfig()",
          "new_text": null,
          "old_line_content": "    initServerConfig();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1727,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(argv[1], \"-v\")",
          "new_text": null,
          "old_line_content": "        if (strcmp(argv[1], \"-v\") == 0 ||",
          "new_line_content": "    long long start;",
          "content_same": false
        },
        {
          "line": 1728,
          "old_api": "version",
          "new_api": null,
          "old_text": "version()",
          "new_text": null,
          "old_line_content": "            strcmp(argv[1], \"--version\") == 0) version();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1730,
          "old_api": "resetServerSaveParams",
          "new_api": null,
          "old_text": "resetServerSaveParams()",
          "new_text": null,
          "old_line_content": "        resetServerSaveParams();",
          "new_line_content": "    if (argc == 2) {",
          "content_same": false
        },
        {
          "line": 1224,
          "old_api": "sprintf",
          "new_api": null,
          "old_text": "sprintf(s,\"%lluB\",n)",
          "new_text": null,
          "old_line_content": "        sprintf(s,\"%lluB\",n);",
          "new_line_content": "    double d;",
          "content_same": false
        },
        {
          "line": 1738,
          "old_api": "initServer",
          "new_api": null,
          "old_text": "initServer()",
          "new_text": null,
          "old_line_content": "    initServer();",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 1740,
          "old_api": "redisAsciiArt",
          "new_api": null,
          "old_text": "redisAsciiArt()",
          "new_text": null,
          "old_line_content": "    redisAsciiArt();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1231,
          "old_api": "sprintf",
          "new_api": null,
          "old_text": "sprintf(s,\"%.2fM\",d)",
          "new_text": null,
          "old_line_content": "        sprintf(s,\"%.2fM\",d);",
          "new_line_content": "        d = (double)n/(1024);",
          "content_same": false
        },
        {
          "line": 1234,
          "old_api": "sprintf",
          "new_api": null,
          "old_text": "sprintf(s,\"%.2fG\",d)",
          "new_text": null,
          "old_line_content": "        sprintf(s,\"%.2fG\",d);",
          "new_line_content": "        d = (double)n/(1024*1024);",
          "content_same": false
        },
        {
          "line": 1748,
          "old_api": "ustime",
          "new_api": null,
          "old_text": "ustime()",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_NOTICE,\"DB loaded from append only file: %.3f seconds\",(float)(ustime()-start)/1000000);",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 1750,
          "old_api": "rdbLoad",
          "new_api": null,
          "old_text": "rdbLoad(server.dbfilename)",
          "new_text": null,
          "old_line_content": "        if (rdbLoad(server.dbfilename) == REDIS_OK)",
          "new_line_content": "    if (server.appendonly) {",
          "content_same": false
        },
        {
          "line": 1242,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "    sds info = sdsempty();",
          "new_line_content": "/* Create the string returned by the INFO command. This is decoupled",
          "content_same": false
        },
        {
          "line": 1243,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "    time_t uptime = time(NULL)-server.stat_starttime;",
          "new_line_content": " * by the INFO command itself as we need to report the same information",
          "content_same": false
        },
        {
          "line": 1756,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_NOTICE,\"The server is now ready to accept connections at %s\", server.unixsocket)",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_NOTICE,\"The server is now ready to accept connections at %s\", server.unixsocket);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1757,
          "old_api": "aeSetBeforeSleepProc",
          "new_api": null,
          "old_text": "aeSetBeforeSleepProc(server.el,beforeSleep)",
          "new_text": null,
          "old_line_content": "    aeSetBeforeSleepProc(server.el,beforeSleep);",
          "new_line_content": "    if (server.ipfd > 0)",
          "content_same": false
        },
        {
          "line": 1759,
          "old_api": "aeDeleteEventLoop",
          "new_api": null,
          "old_text": "aeDeleteEventLoop(server.el)",
          "new_text": null,
          "old_line_content": "    aeDeleteEventLoop(server.el);",
          "new_line_content": "    if (server.sofd > 0)",
          "content_same": false
        },
        {
          "line": 1251,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"all\")",
          "new_text": null,
          "old_line_content": "        allsections = strcasecmp(section,\"all\") == 0;",
          "new_line_content": "    int allsections = 0, defsections = 0;",
          "content_same": false
        },
        {
          "line": 1252,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"default\")",
          "new_text": null,
          "old_line_content": "        defsections = strcasecmp(section,\"default\") == 0;",
          "new_line_content": "    int sections = 0;",
          "content_same": false
        },
        {
          "line": 1257,
          "old_api": "getClientsMaxBuffers",
          "new_api": null,
          "old_text": "getClientsMaxBuffers(&lol,&bib)",
          "new_text": null,
          "old_line_content": "    getClientsMaxBuffers(&lol,&bib);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1262,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"# Server\\r\\n\"\n            \"redis_version:%s\\r\\n\"\n            \"redis_git_sha1:%s\\r\\n\"\n            \"redis_git_dirty:%d\\r\\n\"\n            \"arch_bits:%s\\r\\n\"\n            \"multiplexing_api:%s\\r\\n\"\n            \"process_id:%ld\\r\\n\"\n            \"tcp_port:%d\\r\\n\"\n            \"uptime_in_seconds:%ld\\r\\n\"\n            \"uptime_in_days:%ld\\r\\n\"\n            \"lru_clock:%ld\\r\\n\",\n            REDIS_VERSION,\n            redisGitSHA1(),\n            strtol(redisGitDirty(),NULL,10) > 0,\n            (sizeof(long) == 8) ? \"64\" : \"32\",\n            aeGetApiName(),\n            (long) getpid(),\n            server.port,\n            uptime,\n            uptime/(3600*24),\n            (unsigned long) server.lruclock)",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1275,
          "old_api": "redisGitSHA1",
          "new_api": null,
          "old_text": "redisGitSHA1()",
          "new_text": null,
          "old_line_content": "            redisGitSHA1(),",
          "new_line_content": "            \"uptime_in_seconds:%ld\\r\\n\"",
          "content_same": false
        },
        {
          "line": 1276,
          "old_api": "redisGitDirty",
          "new_api": null,
          "old_text": "redisGitDirty()",
          "new_text": null,
          "old_line_content": "            strtol(redisGitDirty(),NULL,10) > 0,",
          "new_line_content": "            \"uptime_in_days:%ld\\r\\n\"",
          "content_same": false
        },
        {
          "line": 1278,
          "old_api": "aeGetApiName",
          "new_api": null,
          "old_text": "aeGetApiName()",
          "new_text": null,
          "old_line_content": "            aeGetApiName(),",
          "new_line_content": "            REDIS_VERSION,",
          "content_same": false
        },
        {
          "line": 1287,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"clients\")",
          "new_text": null,
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"clients\")) {",
          "new_line_content": "            (unsigned long) server.lruclock);",
          "content_same": false
        },
        {
          "line": 1288,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1289,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"# Clients\\r\\n\"\n            \"connected_clients:%d\\r\\n\"\n            \"client_longest_output_list:%lu\\r\\n\"\n            \"client_biggest_input_buf:%lu\\r\\n\"\n            \"blocked_clients:%d\\r\\n\",\n            listLength(server.clients)-listLength(server.slaves),\n            lol, bib,\n            server.bpop_blocked_clients)",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1799,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(info)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(info);",
          "new_line_content": "    int i, trace_size = 0;",
          "content_same": false
        },
        {
          "line": 1801,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\n        \"======= Ooops! Redis %s got signal: -%d- =======\", REDIS_VERSION, sig)",
          "new_text": null,
          "old_line_content": "    redisLog(REDIS_WARNING,",
          "new_line_content": "    sds infostring;",
          "content_same": false
        },
        {
          "line": 1804,
          "old_api": "redisLogRaw",
          "new_api": null,
          "old_text": "redisLogRaw(REDIS_WARNING, infostring)",
          "new_text": null,
          "old_line_content": "    redisLogRaw(REDIS_WARNING, infostring);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1295,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(server.slaves)",
          "new_text": null,
          "old_line_content": "            listLength(server.clients)-listLength(server.slaves),",
          "new_line_content": "            \"connected_clients:%d\\r\\n\"",
          "content_same": false
        },
        {
          "line": 1810,
          "old_api": "getMcontextEip",
          "new_api": null,
          "old_text": "getMcontextEip(uc)",
          "new_text": null,
          "old_line_content": "    if (getMcontextEip(uc) != NULL) {",
          "new_line_content": "     * corruption conditions. Let it leak as we are going to abort */",
          "content_same": false
        },
        {
          "line": 1811,
          "old_api": "getMcontextEip",
          "new_api": null,
          "old_text": "getMcontextEip(uc)",
          "new_text": null,
          "old_line_content": "        trace[1] = getMcontextEip(uc);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1301,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"memory\")",
          "new_text": null,
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"memory\")) {",
          "new_line_content": "            server.bpop_blocked_clients);",
          "content_same": false
        },
        {
          "line": 1813,
          "old_api": "backtrace_symbols",
          "new_api": null,
          "old_text": "backtrace_symbols(trace, trace_size)",
          "new_text": null,
          "old_line_content": "    messages = backtrace_symbols(trace, trace_size);",
          "new_line_content": "    /* overwrite sigaction with caller's address */",
          "content_same": false
        },
        {
          "line": 1816,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"%s\", messages[i])",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_WARNING,\"%s\", messages[i]);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1306,
          "old_api": "bytesToHuman",
          "new_api": null,
          "old_text": "bytesToHuman(peak_hmem,server.stat_peak_memory)",
          "new_text": null,
          "old_line_content": "        bytesToHuman(peak_hmem,server.stat_peak_memory);",
          "new_line_content": "        char hmem[64];",
          "content_same": false
        },
        {
          "line": 1307,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "        char peak_hmem[64];",
          "content_same": false
        },
        {
          "line": 1308,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"# Memory\\r\\n\"\n            \"used_memory:%zu\\r\\n\"\n            \"used_memory_human:%s\\r\\n\"\n            \"used_memory_rss:%zu\\r\\n\"\n            \"used_memory_peak:%zu\\r\\n\"\n            \"used_memory_peak_human:%s\\r\\n\"\n            \"used_memory_lua:%lld\\r\\n\"\n            \"mem_fragmentation_ratio:%.2f\\r\\n\"\n            \"mem_allocator:%s\\r\\n\",\n            zmalloc_used_memory(),\n            hmem,\n            zmalloc_get_rss(),\n            server.stat_peak_memory,\n            peak_hmem,\n            ((long long)lua_gc(server.lua,LUA_GCCOUNT,0))*1024LL,\n            zmalloc_get_fragmentation_ratio(),\n            ZMALLOC_LIB\n            )",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1819,
          "old_api": "unlink",
          "new_api": null,
          "old_text": "unlink(server.pidfile)",
          "new_text": null,
          "old_line_content": "    if (server.daemonize) unlink(server.pidfile);",
          "new_line_content": "    for (i=1; i<trace_size; ++i)",
          "content_same": false
        },
        {
          "line": 1828,
          "old_api": "sigaction (sig, &act, NULL)",
          "new_api": null,
          "old_text": "sigaction (sig, &act, NULL)",
          "new_text": null,
          "old_line_content": "    sigaction (sig, &act, NULL);",
          "new_line_content": "    /* When the SA_SIGINFO flag is set in sa_flags then sa_sigaction",
          "content_same": false
        },
        {
          "line": 1829,
          "old_api": "getpid",
          "new_api": null,
          "old_text": "getpid()",
          "new_text": null,
          "old_line_content": "    kill(getpid(),sig);",
          "new_line_content": "     * is used. Otherwise, sa_handler is used */",
          "content_same": false
        },
        {
          "line": 1318,
          "old_api": "zmalloc_used_memory",
          "new_api": null,
          "old_text": "zmalloc_used_memory()",
          "new_text": null,
          "old_line_content": "            zmalloc_used_memory(),",
          "new_line_content": "            \"used_memory_peak_human:%s\\r\\n\"",
          "content_same": false
        },
        {
          "line": 1320,
          "old_api": "zmalloc_get_rss",
          "new_api": null,
          "old_text": "zmalloc_get_rss()",
          "new_text": null,
          "old_line_content": "            zmalloc_get_rss(),",
          "new_line_content": "            \"mem_fragmentation_ratio:%.2f\\r\\n\"",
          "content_same": false
        },
        {
          "line": 1834,
          "old_api": "REDIS_NOTUSED",
          "new_api": null,
          "old_text": "REDIS_NOTUSED(sig)",
          "new_text": null,
          "old_line_content": "    REDIS_NOTUSED(sig);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1323,
          "old_api": "lua_gc",
          "new_api": null,
          "old_text": "lua_gc(server.lua,LUA_GCCOUNT,0)",
          "new_text": null,
          "old_line_content": "            ((long long)lua_gc(server.lua,LUA_GCCOUNT,0))*1024LL,",
          "new_line_content": "            hmem,",
          "content_same": false
        },
        {
          "line": 1836,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_WARNING,\"Received SIGTERM, scheduling shutdown...\")",
          "new_text": null,
          "old_line_content": "    redisLog(REDIS_WARNING,\"Received SIGTERM, scheduling shutdown...\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1330,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"persistence\")",
          "new_text": null,
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"persistence\")) {",
          "new_line_content": "            );",
          "content_same": false
        },
        {
          "line": 1331,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1332,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"# Persistence\\r\\n\"\n            \"loading:%d\\r\\n\"\n            \"aof_enabled:%d\\r\\n\"\n            \"changes_since_last_save:%lld\\r\\n\"\n            \"bgsave_in_progress:%d\\r\\n\"\n            \"last_save_time:%ld\\r\\n\"\n            \"bgrewriteaof_in_progress:%d\\r\\n\",\n            server.loading,\n            server.appendonly,\n            server.dirty,\n            server.bgsavechildpid != -1,\n            server.lastsave,\n            server.bgrewritechildpid != -1)",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1845,
          "old_api": "sigemptyset",
          "new_api": null,
          "old_text": "sigemptyset(&act.sa_mask)",
          "new_text": null,
          "old_line_content": "    sigemptyset(&act.sa_mask);",
          "new_line_content": "    struct sigaction act;",
          "content_same": false
        },
        {
          "line": 1848,
          "old_api": "sigaction",
          "new_api": null,
          "old_text": "sigaction(SIGTERM, &act, NULL)",
          "new_text": null,
          "old_line_content": "    sigaction(SIGTERM, &act, NULL);",
          "new_line_content": "     * Otherwise, sa_handler is used. */",
          "content_same": false
        },
        {
          "line": 1851,
          "old_api": "sigemptyset",
          "new_api": null,
          "old_text": "sigemptyset(&act.sa_mask)",
          "new_text": null,
          "old_line_content": "    sigemptyset(&act.sa_mask);",
          "new_line_content": "    act.sa_handler = sigtermHandler;",
          "content_same": false
        },
        {
          "line": 1854,
          "old_api": "sigaction",
          "new_api": null,
          "old_text": "sigaction(SIGSEGV, &act, NULL)",
          "new_text": null,
          "old_line_content": "    sigaction(SIGSEGV, &act, NULL);",
          "new_line_content": "#ifdef HAVE_BACKTRACE",
          "content_same": false
        },
        {
          "line": 1856,
          "old_api": "sigaction",
          "new_api": null,
          "old_text": "sigaction(SIGFPE, &act, NULL)",
          "new_text": null,
          "old_line_content": "    sigaction(SIGFPE, &act, NULL);",
          "new_line_content": "    act.sa_flags = SA_NODEFER | SA_ONSTACK | SA_RESETHAND | SA_SIGINFO;",
          "content_same": false
        },
        {
          "line": 1857,
          "old_api": "sigaction",
          "new_api": null,
          "old_text": "sigaction(SIGILL, &act, NULL)",
          "new_text": null,
          "old_line_content": "    sigaction(SIGILL, &act, NULL);",
          "new_line_content": "    act.sa_sigaction = sigsegvHandler;",
          "content_same": false
        },
        {
          "line": 1348,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                \"aof_current_size:%lld\\r\\n\"\n                \"aof_base_size:%lld\\r\\n\"\n                \"aof_pending_rewrite:%d\\r\\n\",\n                (long long) server.appendonly_current_size,\n                (long long) server.auto_aofrewrite_base_size,\n                server.aofrewrite_scheduled)",
          "new_text": null,
          "old_line_content": "            info = sdscatprintf(info,",
          "new_line_content": "            server.lastsave,",
          "content_same": false
        },
        {
          "line": 1366,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "            elapsed = time(NULL)-server.loading_start_time;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1374,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                \"loading_start_time:%ld\\r\\n\"\n                \"loading_total_bytes:%llu\\r\\n\"\n                \"loading_loaded_bytes:%llu\\r\\n\"\n                \"loading_loaded_perc:%.2f\\r\\n\"\n                \"loading_eta_seconds:%ld\\r\\n\"\n                ,(unsigned long) server.loading_start_time,\n                (unsigned long long) server.loading_total_bytes,\n                (unsigned long long) server.loading_loaded_bytes,\n                perc,\n                eta\n            )",
          "new_text": null,
          "old_line_content": "            info = sdscatprintf(info,",
          "new_line_content": "            } else {",
          "content_same": false
        },
        {
          "line": 1390,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"stats\")",
          "new_text": null,
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"stats\")) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1391,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1392,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"# Stats\\r\\n\"\n            \"total_connections_received:%lld\\r\\n\"\n            \"total_commands_processed:%lld\\r\\n\"\n            \"expired_keys:%lld\\r\\n\"\n            \"evicted_keys:%lld\\r\\n\"\n            \"keyspace_hits:%lld\\r\\n\"\n            \"keyspace_misses:%lld\\r\\n\"\n            \"pubsub_channels:%ld\\r\\n\"\n            \"pubsub_patterns:%u\\r\\n\"\n            \"latest_fork_usec:%lld\\r\\n\",\n            server.stat_numconnections,\n            server.stat_numcommands,\n            server.stat_expiredkeys,\n            server.stat_evictedkeys,\n            server.stat_keyspace_hits,\n            server.stat_keyspace_misses,\n            dictSize(server.pubsub_channels),\n            listLength(server.pubsub_patterns),\n            server.stat_fork_time)",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1409,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(server.pubsub_channels)",
          "new_text": null,
          "old_line_content": "            dictSize(server.pubsub_channels),",
          "new_line_content": "            server.stat_expiredkeys,",
          "content_same": false
        },
        {
          "line": 1410,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(server.pubsub_patterns)",
          "new_text": null,
          "old_line_content": "            listLength(server.pubsub_patterns),",
          "new_line_content": "            server.stat_evictedkeys,",
          "content_same": false
        },
        {
          "line": 1415,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"replication\")",
          "new_text": null,
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"replication\")) {",
          "new_line_content": "            server.stat_fork_time);",
          "content_same": false
        },
        {
          "line": 1416,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1417,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"# Replication\\r\\n\"\n            \"role:%s\\r\\n\",\n            server.masterhost == NULL ? \"master\" : \"slave\")",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1422,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                \"master_host:%s\\r\\n\"\n                \"master_port:%d\\r\\n\"\n                \"master_link_status:%s\\r\\n\"\n                \"master_last_io_seconds_ago:%d\\r\\n\"\n                \"master_sync_in_progress:%d\\r\\n\"\n                ,server.masterhost,\n                server.masterport,\n                (server.replstate == REDIS_REPL_CONNECTED) ?\n                    \"up\" : \"down\",\n                server.master ?\n                ((int)(time(NULL)-server.master->lastinteraction)) : -1,\n                server.replstate == REDIS_REPL_TRANSFER\n            )",
          "new_text": null,
          "old_line_content": "            info = sdscatprintf(info,",
          "new_line_content": "            \"# Replication\\r\\n\"",
          "content_same": false
        },
        {
          "line": 1433,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "                ((int)(time(NULL)-server.master->lastinteraction)) : -1,",
          "new_line_content": "                server.masterport,",
          "content_same": false
        },
        {
          "line": 1438,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                    \"master_sync_left_bytes:%ld\\r\\n\"\n                    \"master_sync_last_io_seconds_ago:%d\\r\\n\"\n                    ,(long)server.repl_transfer_left,\n                    (int)(time(NULL)-server.repl_transfer_lastio)\n                )",
          "new_text": null,
          "old_line_content": "                info = sdscatprintf(info,",
          "new_line_content": "                server.replstate == REDIS_REPL_TRANSFER",
          "content_same": false
        },
        {
          "line": 1447,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                    \"master_link_down_since_seconds:%ld\\r\\n\",\n                    (long)time(NULL)-server.repl_down_since)",
          "new_text": null,
          "old_line_content": "                info = sdscatprintf(info,",
          "new_line_content": "                );",
          "content_same": false
        },
        {
          "line": 1449,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "                    (long)time(NULL)-server.repl_down_since);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1452,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n            \"connected_slaves:%d\\r\\n\",\n            listLength(server.slaves))",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "                    \"master_link_down_since_seconds:%ld\\r\\n\",",
          "content_same": false
        },
        {
          "line": 1454,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(server.slaves)",
          "new_text": null,
          "old_line_content": "            listLength(server.slaves));",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1459,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1460,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n        \"# CPU\\r\\n\"\n        \"used_cpu_sys:%.2f\\r\\n\"\n        \"used_cpu_user:%.2f\\r\\n\"\n        \"used_cpu_sys_children:%.2f\\r\\n\"\n        \"used_cpu_user_children:%.2f\\r\\n\",\n        (float)self_ru.ru_utime.tv_sec+(float)self_ru.ru_utime.tv_usec/1000000,\n        (float)self_ru.ru_stime.tv_sec+(float)self_ru.ru_stime.tv_usec/1000000,\n        (float)c_ru.ru_utime.tv_sec+(float)c_ru.ru_utime.tv_usec/1000000,\n        (float)c_ru.ru_stime.tv_sec+(float)c_ru.ru_stime.tv_usec/1000000)",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1473,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"commandstats\")",
          "new_text": null,
          "old_line_content": "    if (allsections || !strcasecmp(section,\"commandstats\")) {",
          "new_line_content": "        (float)c_ru.ru_stime.tv_sec+(float)c_ru.ru_stime.tv_usec/1000000);",
          "content_same": false
        },
        {
          "line": 1474,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1475,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info, \"# Commandstats\\r\\n\")",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info, \"# Commandstats\\r\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1481,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n                \"cmdstat_%s:calls=%lld,usec=%lld,usec_per_call=%.2f\\r\\n\",\n                c->name, c->calls, c->microseconds,\n                (c->calls == 0) ? 0 : ((float)c->microseconds/c->calls))",
          "new_text": null,
          "old_line_content": "            info = sdscatprintf(info,",
          "new_line_content": "        for (j = 0; j < numcommands; j++) {",
          "content_same": false
        },
        {
          "line": 1489,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"cluster\")",
          "new_text": null,
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"cluster\")) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1490,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1491,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info,\n        \"# Cluster\\r\\n\"\n        \"cluster_enabled:%d\\r\\n\",\n        server.cluster_enabled)",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1498,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(section,\"keyspace\")",
          "new_text": null,
          "old_line_content": "    if (allsections || defsections || !strcasecmp(section,\"keyspace\")) {",
          "new_line_content": "        server.cluster_enabled);",
          "content_same": false
        },
        {
          "line": 1499,
          "old_api": "sdscat",
          "new_api": null,
          "old_text": "sdscat(info,\"\\r\\n\")",
          "new_text": null,
          "old_line_content": "        if (sections++) info = sdscat(info,\"\\r\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1500,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info, \"# Keyspace\\r\\n\")",
          "new_text": null,
          "old_line_content": "        info = sdscatprintf(info, \"# Keyspace\\r\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1505,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(server.db[j].expires)",
          "new_text": null,
          "old_line_content": "            vkeys = dictSize(server.db[j].expires);",
          "new_line_content": "        for (j = 0; j < server.dbnum; j++) {",
          "content_same": false
        },
        {
          "line": 1507,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(info, \"db%d:keys=%lld,expires=%lld\\r\\n\",\n                    j, keys, vkeys)",
          "new_text": null,
          "old_line_content": "                info = sdscatprintf(info, \"db%d:keys=%lld,expires=%lld\\r\\n\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1519,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.syntaxerr)",
          "new_text": null,
          "old_line_content": "        addReply(c,shared.syntaxerr);",
          "new_line_content": "void infoCommand(redisClient *c) {",
          "content_same": false
        },
        {
          "line": 1522,
          "old_api": "genRedisInfoString",
          "new_api": null,
          "old_text": "genRedisInfoString(section)",
          "new_text": null,
          "old_line_content": "    sds info = genRedisInfoString(section);",
          "new_line_content": "    if (c->argc > 2) {",
          "content_same": false
        },
        {
          "line": 1524,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(info)",
          "new_text": null,
          "old_line_content": "        (unsigned long)sdslen(info)));",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 1525,
          "old_api": "addReplySds",
          "new_api": null,
          "old_text": "addReplySds(c,info)",
          "new_text": null,
          "old_line_content": "    addReplySds(c,info);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1535,
          "old_api": "listAddNodeTail",
          "new_api": null,
          "old_text": "listAddNodeTail(server.monitors,c)",
          "new_text": null,
          "old_line_content": "    listAddNodeTail(server.monitors,c);",
          "new_line_content": "    if (c->flags & REDIS_SLAVE) return;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 38,
      "total_additions": 137,
      "total_deletions": 135,
      "total_api_changes": 310
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 4,
        "api_related_lines": 310,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          1196
        ]
      }
    },
    "api_calls_before": 488,
    "api_calls_after": 490,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 0,
      "total_diff_lines": 16
    }
  }
}