{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/b215a496a4fcab6b198ce4344b4c1b94c5b1eb12",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/b215a496a4fcab6b198ce4344b4c1b94c5b1eb12/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/b215a496a4fcab6b198ce4344b4c1b94c5b1eb12/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/b215a496a4fcab6b198ce4344b4c1b94c5b1eb12/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 154,
          "old_api": "addReply",
          "new_api": "touchWatchedKey",
          "old_text": "addReply(c,shared.colon)",
          "new_text": "touchWatchedKey(c->db,c->argv[1])",
          "old_line_content": "    addReply(c,shared.colon);",
          "new_line_content": "            touchWatchedKey(c->db,c->argv[1]);",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": "addReply",
          "new_api": "addReplyLongLong",
          "old_text": "addReply(c,shared.crlf)",
          "new_text": "addReplyLongLong(c,newval)",
          "old_line_content": "    addReply(c,shared.crlf);",
          "new_line_content": "            addReplyLongLong(c,newval);",
          "content_same": false
        },
        {
          "line": 170,
          "old_api": "getLongLongFromObjectOrReply",
          "new_api": "addReply",
          "old_text": "getLongLongFromObjectOrReply(c, c->argv[2], &incr, NULL)",
          "new_text": "addReply(c,o)",
          "old_line_content": "    if (getLongLongFromObjectOrReply(c, c->argv[2], &incr, NULL) != REDIS_OK) return;",
          "new_line_content": "    addReply(c,o);",
          "content_same": false
        },
        {
          "line": 171,
          "old_api": "incrDecrCommand",
          "new_api": "addReply",
          "old_text": "incrDecrCommand(c,incr)",
          "new_text": "addReply(c,shared.crlf)",
          "old_line_content": "    incrDecrCommand(c,incr);",
          "new_line_content": "    addReply(c,shared.crlf);",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": "lookupKeyWrite",
          "new_api": "incrDecrCommand",
          "old_text": "lookupKeyWrite(c->db,c->argv[1])",
          "new_text": "incrDecrCommand(c,incr)",
          "old_line_content": "    o = lookupKeyWrite(c->db,c->argv[1]);",
          "new_line_content": "    incrDecrCommand(c,incr);",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": "stringObjectLen",
          "new_api": "getLongLongFromObjectOrReply",
          "old_text": "stringObjectLen(c->argv[2])",
          "new_text": "getLongLongFromObjectOrReply(c, c->argv[2], &incr, NULL)",
          "old_line_content": "        totlen = stringObjectLen(c->argv[2]);",
          "new_line_content": "    if (getLongLongFromObjectOrReply(c, c->argv[2], &incr, NULL) != REDIS_OK) return;",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "getDecodedObject",
          "new_api": "lookupKeyWrite",
          "old_text": "getDecodedObject(o)",
          "new_text": "lookupKeyWrite(c->db,c->argv[1])",
          "old_line_content": "            robj *decoded = getDecodedObject(o);",
          "new_line_content": "    o = lookupKeyWrite(c->db,c->argv[1]);",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "dbReplace",
          "new_api": "dbAdd",
          "old_text": "dbReplace(c->db,c->argv[1],o)",
          "new_text": "dbAdd(c->db,c->argv[1],c->argv[2])",
          "old_line_content": "            dbReplace(c->db,c->argv[1],o);",
          "new_line_content": "        retval = dbAdd(c->db,c->argv[1],c->argv[2]);",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": "sdslen",
          "new_api": "addReply",
          "old_text": "sdslen(c->argv[2]->ptr)",
          "new_text": "addReply(c,shared.wrongtypeerr)",
          "old_line_content": "                c->argv[2]->ptr, sdslen(c->argv[2]->ptr));",
          "new_line_content": "            addReply(c,shared.wrongtypeerr);",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": "addReplyLongLong",
          "new_api": "decrRefCount",
          "old_text": "addReplyLongLong(c,totlen)",
          "new_text": "decrRefCount(decoded)",
          "old_line_content": "    addReplyLongLong(c,totlen);",
          "new_line_content": "            decrRefCount(decoded);",
          "content_same": false
        },
        {
          "line": 224,
          "old_api": "atoi",
          "new_api": "sdscatlen",
          "old_text": "atoi(c->argv[2]->ptr)",
          "new_text": "sdscatlen(o->ptr,\n                c->argv[2]->ptr, sdslen(c->argv[2]->ptr))",
          "old_line_content": "    long start = atoi(c->argv[2]->ptr);",
          "new_line_content": "            o->ptr = sdscatlen(o->ptr,",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "atoi",
          "new_api": "sdslen",
          "old_text": "atoi(c->argv[3]->ptr)",
          "new_text": "sdslen(c->argv[2]->ptr)",
          "old_line_content": "    long end = atoi(c->argv[3]->ptr);",
          "new_line_content": "                c->argv[2]->ptr, sdslen(c->argv[2]->ptr));",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": "checkType",
          "new_api": "sdslen",
          "old_text": "checkType(c,o,REDIS_STRING)",
          "new_text": "sdslen(o->ptr)",
          "old_line_content": "        checkType(c,o,REDIS_STRING)) return;",
          "new_line_content": "        totlen = sdslen(o->ptr);",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "getDecodedObject",
          "new_api": "touchWatchedKey",
          "old_text": "getDecodedObject(o)",
          "new_text": "touchWatchedKey(c->db,c->argv[1])",
          "old_line_content": "    o = getDecodedObject(o);",
          "new_line_content": "    touchWatchedKey(c->db,c->argv[1]);",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": "addReply",
          "new_api": "lookupKeyReadOrReply",
          "old_text": "addReply(c,shared.nullbulk)",
          "new_text": "lookupKeyReadOrReply(c,c->argv[1],shared.nullbulk)",
          "old_line_content": "        addReply(c,shared.nullbulk);",
          "new_line_content": "    if ((o = lookupKeyReadOrReply(c,c->argv[1],shared.nullbulk)) == NULL ||",
          "content_same": false
        },
        {
          "line": 245,
          "old_api": "decrRefCount",
          "new_api": "checkType",
          "old_text": "decrRefCount(o)",
          "new_text": "checkType(c,o,REDIS_STRING)",
          "old_line_content": "        decrRefCount(o);",
          "new_line_content": "        checkType(c,o,REDIS_STRING)) return;",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": "decrRefCount",
          "new_api": "sdsempty",
          "old_text": "decrRefCount(o)",
          "new_text": "sdsempty()",
          "old_line_content": "    decrRefCount(o);",
          "new_line_content": "    addReplySds(c,sdscatprintf(sdsempty(),\"$%zu\\r\\n\",rangelen));",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 259,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.nullbulk)",
          "old_line_content": "void strlenCommand(redisClient *c) {",
          "new_line_content": "        addReply(c,shared.nullbulk);",
          "content_same": false
        },
        {
          "line": 260,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(o)",
          "old_line_content": "    robj *o;",
          "new_line_content": "        decrRefCount(o);",
          "content_same": false
        },
        {
          "line": 268,
          "old_api": null,
          "new_api": "sdsnewlen",
          "old_text": null,
          "new_text": "sdsnewlen((char*)o->ptr+start,rangelen)",
          "old_line_content": "}",
          "new_line_content": "    range = sdsnewlen((char*)o->ptr+start,rangelen);",
          "content_same": false
        },
        {
          "line": 269,
          "old_api": null,
          "new_api": "addReplySds",
          "old_text": null,
          "new_text": "addReplySds(c,range)",
          "old_line_content": "",
          "new_line_content": "    addReplySds(c,range);",
          "content_same": false
        },
        {
          "line": 270,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.crlf)",
          "old_line_content": "",
          "new_line_content": "    addReply(c,shared.crlf);",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(o)",
          "old_line_content": "",
          "new_line_content": "    decrRefCount(o);",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": null,
          "new_api": "lookupKeyReadOrReply",
          "old_text": null,
          "new_text": "lookupKeyReadOrReply(c,c->argv[1],shared.czero)",
          "old_line_content": "",
          "new_line_content": "    if ((o = lookupKeyReadOrReply(c,c->argv[1],shared.czero)) == NULL ||",
          "content_same": false
        },
        {
          "line": 278,
          "old_api": null,
          "new_api": "checkType",
          "old_text": null,
          "new_text": "checkType(c,o,REDIS_STRING)",
          "old_line_content": "",
          "new_line_content": "        checkType(c,o,REDIS_STRING)) return;",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": null,
          "new_api": "getDecodedObject",
          "old_text": null,
          "new_text": "getDecodedObject(o)",
          "old_line_content": "",
          "new_line_content": "    o = getDecodedObject(o);",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(o->ptr)",
          "old_line_content": "",
          "new_line_content": "    addReplyLongLong(c,sdslen(o->ptr));",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(o)",
          "old_line_content": "",
          "new_line_content": "    decrRefCount(o);",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": null,
          "new_api": "getLongLongFromObjectOrReply",
          "old_text": null,
          "new_text": "getLongLongFromObjectOrReply(c,o,&value,NULL)",
          "old_line_content": "void decrCommand(redisClient *c) {",
          "new_line_content": "    if (getLongLongFromObjectOrReply(c,o,&value,NULL) != REDIS_OK) return;",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": null,
          "new_api": "createStringObjectFromLongLong",
          "old_text": null,
          "new_text": "createStringObjectFromLongLong(value)",
          "old_line_content": "}",
          "new_line_content": "    o = createStringObjectFromLongLong(value);",
          "content_same": false
        },
        {
          "line": 166,
          "old_api": null,
          "new_api": "dbReplace",
          "old_text": null,
          "new_text": "dbReplace(c->db,c->argv[1],o)",
          "old_line_content": "",
          "new_line_content": "    dbReplace(c->db,c->argv[1],o);",
          "content_same": false
        },
        {
          "line": 167,
          "old_api": null,
          "new_api": "touchWatchedKey",
          "old_text": null,
          "new_text": "touchWatchedKey(c->db,c->argv[1])",
          "old_line_content": "void incrbyCommand(redisClient *c) {",
          "new_line_content": "    touchWatchedKey(c->db,c->argv[1]);",
          "content_same": false
        },
        {
          "line": 169,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.colon)",
          "old_line_content": "",
          "new_line_content": "    addReply(c,shared.colon);",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": null,
          "new_api": "incrDecrCommand",
          "old_text": null,
          "new_text": "incrDecrCommand(c,1)",
          "old_line_content": "    long long incr;",
          "new_line_content": "    incrDecrCommand(c,1);",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": null,
          "new_api": "incrDecrCommand",
          "old_text": null,
          "new_text": "incrDecrCommand(c,-1)",
          "old_line_content": "}",
          "new_line_content": "    incrDecrCommand(c,-1);",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": null,
          "new_api": "getLongLongFromObjectOrReply",
          "old_text": null,
          "new_text": "getLongLongFromObjectOrReply(c, c->argv[2], &incr, NULL)",
          "old_line_content": "",
          "new_line_content": "    if (getLongLongFromObjectOrReply(c, c->argv[2], &incr, NULL) != REDIS_OK) return;",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": null,
          "new_api": "incrDecrCommand",
          "old_text": null,
          "new_text": "incrDecrCommand(c,-incr)",
          "old_line_content": "    } else {",
          "new_line_content": "    incrDecrCommand(c,-incr);",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": null,
          "new_api": "tryObjectEncoding",
          "old_text": null,
          "new_text": "tryObjectEncoding(c->argv[2])",
          "old_line_content": "",
          "new_line_content": "    c->argv[2] = tryObjectEncoding(c->argv[2]);",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": null,
          "new_api": "incrRefCount",
          "old_text": null,
          "new_text": "incrRefCount(c->argv[2])",
          "old_line_content": "        }",
          "new_line_content": "        incrRefCount(c->argv[2]);",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": null,
          "new_api": "stringObjectLen",
          "old_text": null,
          "new_text": "stringObjectLen(c->argv[2])",
          "old_line_content": "        /* APPEND! */",
          "new_line_content": "        totlen = stringObjectLen(c->argv[2]);",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": null,
          "new_api": "getDecodedObject",
          "old_text": null,
          "new_text": "getDecodedObject(o)",
          "old_line_content": "    }",
          "new_line_content": "            robj *decoded = getDecodedObject(o);",
          "content_same": false
        },
        {
          "line": 218,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(decoded->ptr)",
          "old_line_content": "    server.dirty++;",
          "new_line_content": "            o = createStringObject(decoded->ptr, sdslen(decoded->ptr));",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": null,
          "new_api": "dbReplace",
          "old_text": null,
          "new_text": "dbReplace(c->db,c->argv[1],o)",
          "old_line_content": "}",
          "new_line_content": "            dbReplace(c->db,c->argv[1],o);",
          "content_same": false
        },
        {
          "line": 227,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(o->ptr, \"%ld\",\n                (unsigned long) c->argv[2]->ptr)",
          "old_line_content": "    sds range;",
          "new_line_content": "            o->ptr = sdscatprintf(o->ptr, \"%ld\",",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": null,
          "new_api": "addReplyLongLong",
          "old_text": null,
          "new_text": "addReplyLongLong(c,totlen)",
          "old_line_content": "",
          "new_line_content": "    addReplyLongLong(c,totlen);",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(c->argv[2]->ptr)",
          "old_line_content": "    if (end < 0) end = 0;",
          "new_line_content": "    long start = atoi(c->argv[2]->ptr);",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(c->argv[3]->ptr)",
          "old_line_content": "",
          "new_line_content": "    long end = atoi(c->argv[3]->ptr);",
          "content_same": false
        },
        {
          "line": 247,
          "old_api": null,
          "new_api": "getDecodedObject",
          "old_text": null,
          "new_text": "getDecodedObject(o)",
          "old_line_content": "    }",
          "new_line_content": "    o = getDecodedObject(o);",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(o->ptr)",
          "old_line_content": "    if ((size_t)end >= strlen) end = strlen-1;",
          "new_line_content": "    strlen = sdslen(o->ptr);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 256,
          "old_api": "decrRefCount",
          "new_api": null,
          "old_text": "decrRefCount(o)",
          "new_text": null,
          "old_line_content": "    decrRefCount(o);",
          "new_line_content": "    /* indexes sanity checks */",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": "lookupKeyReadOrReply",
          "new_api": null,
          "old_text": "lookupKeyReadOrReply(c,c->argv[1],shared.czero)",
          "new_text": null,
          "old_line_content": "    if ((o = lookupKeyReadOrReply(c,c->argv[1],shared.czero)) == NULL ||",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 263,
          "old_api": "checkType",
          "new_api": null,
          "old_text": "checkType(c,o,REDIS_STRING)",
          "new_text": null,
          "old_line_content": "        checkType(c,o,REDIS_STRING)) return;",
          "new_line_content": "    if ((size_t)end >= strlen) end = strlen-1;",
          "content_same": false
        },
        {
          "line": 265,
          "old_api": "getDecodedObject",
          "new_api": null,
          "old_text": "getDecodedObject(o)",
          "new_text": null,
          "old_line_content": "    o = getDecodedObject(o);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(o->ptr)",
          "new_text": null,
          "old_line_content": "    addReplyLongLong(c,sdslen(o->ptr));",
          "new_line_content": "    /* Return the result */",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "getLongLongFromObjectOrReply",
          "new_api": null,
          "old_text": "getLongLongFromObjectOrReply(c,o,&value,NULL)",
          "new_text": null,
          "old_line_content": "    if (getLongLongFromObjectOrReply(c,o,&value,NULL) != REDIS_OK) return;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": "createStringObjectFromLongLong",
          "new_api": null,
          "old_text": "createStringObjectFromLongLong(value)",
          "new_text": null,
          "old_line_content": "    o = createStringObjectFromLongLong(value);",
          "new_line_content": "        long long newval = ((long)o->ptr) + incr;",
          "content_same": false
        },
        {
          "line": 151,
          "old_api": "dbReplace",
          "new_api": null,
          "old_text": "dbReplace(c->db,c->argv[1],o)",
          "new_text": null,
          "old_line_content": "    dbReplace(c->db,c->argv[1],o);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": "touchWatchedKey",
          "new_api": null,
          "old_text": "touchWatchedKey(c->db,c->argv[1])",
          "new_text": null,
          "old_line_content": "    touchWatchedKey(c->db,c->argv[1]);",
          "new_line_content": "        if (newval >= LONG_MIN && newval <= LONG_MAX) {",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,o)",
          "new_text": null,
          "old_line_content": "    addReply(c,o);",
          "new_line_content": "            server.dirty++;",
          "content_same": false
        },
        {
          "line": 160,
          "old_api": "incrDecrCommand",
          "new_api": null,
          "old_text": "incrDecrCommand(c,1)",
          "new_text": null,
          "old_line_content": "    incrDecrCommand(c,1);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 164,
          "old_api": "incrDecrCommand",
          "new_api": null,
          "old_text": "incrDecrCommand(c,-1)",
          "new_text": null,
          "old_line_content": "    incrDecrCommand(c,-1);",
          "new_line_content": "    value += incr;",
          "content_same": false
        },
        {
          "line": 177,
          "old_api": "getLongLongFromObjectOrReply",
          "new_api": null,
          "old_text": "getLongLongFromObjectOrReply(c, c->argv[2], &incr, NULL)",
          "new_text": null,
          "old_line_content": "    if (getLongLongFromObjectOrReply(c, c->argv[2], &incr, NULL) != REDIS_OK) return;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": "incrDecrCommand",
          "new_api": null,
          "old_text": "incrDecrCommand(c,-incr)",
          "new_text": null,
          "old_line_content": "    incrDecrCommand(c,-incr);",
          "new_line_content": "void decrCommand(redisClient *c) {",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": "tryObjectEncoding",
          "new_api": null,
          "old_text": "tryObjectEncoding(c->argv[2])",
          "new_text": null,
          "old_line_content": "    c->argv[2] = tryObjectEncoding(c->argv[2]);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": "dbAdd",
          "new_api": null,
          "old_text": "dbAdd(c->db,c->argv[1],c->argv[2])",
          "new_text": null,
          "old_line_content": "        retval = dbAdd(c->db,c->argv[1],c->argv[2]);",
          "new_line_content": "    long long incr;",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "incrRefCount",
          "new_api": null,
          "old_text": "incrRefCount(c->argv[2])",
          "new_text": null,
          "old_line_content": "        incrRefCount(c->argv[2]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.wrongtypeerr)",
          "new_text": null,
          "old_line_content": "            addReply(c,shared.wrongtypeerr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(decoded->ptr)",
          "new_text": null,
          "old_line_content": "            o = createStringObject(decoded->ptr, sdslen(decoded->ptr));",
          "new_line_content": "    if (o == NULL) {",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": "decrRefCount",
          "new_api": null,
          "old_text": "decrRefCount(decoded)",
          "new_text": null,
          "old_line_content": "            decrRefCount(decoded);",
          "new_line_content": "        /* Create the key */",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": "sdscatlen",
          "new_api": null,
          "old_text": "sdscatlen(o->ptr,\n                c->argv[2]->ptr, sdslen(c->argv[2]->ptr))",
          "new_text": null,
          "old_line_content": "            o->ptr = sdscatlen(o->ptr,",
          "new_line_content": "        if (o->type != REDIS_STRING) {",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(o->ptr, \"%ld\",\n                (unsigned long) c->argv[2]->ptr)",
          "new_text": null,
          "old_line_content": "            o->ptr = sdscatprintf(o->ptr, \"%ld\",",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 215,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(o->ptr)",
          "new_text": null,
          "old_line_content": "        totlen = sdslen(o->ptr);",
          "new_line_content": "        if (o->refcount != 1 || o->encoding != REDIS_ENCODING_RAW) {",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": "touchWatchedKey",
          "new_api": null,
          "old_text": "touchWatchedKey(c->db,c->argv[1])",
          "new_text": null,
          "old_line_content": "    touchWatchedKey(c->db,c->argv[1]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": "lookupKeyReadOrReply",
          "new_api": null,
          "old_text": "lookupKeyReadOrReply(c,c->argv[1],shared.nullbulk)",
          "new_text": null,
          "old_line_content": "    if ((o = lookupKeyReadOrReply(c,c->argv[1],shared.nullbulk)) == NULL ||",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(o->ptr)",
          "new_text": null,
          "old_line_content": "    strlen = sdslen(o->ptr);",
          "new_line_content": "    server.dirty++;",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "    addReplySds(c,sdscatprintf(sdsempty(),\"$%zu\\r\\n\",rangelen));",
          "new_line_content": "    if (end < 0) end = strlen+end;",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": "sdsnewlen",
          "new_api": null,
          "old_text": "sdsnewlen((char*)o->ptr+start,rangelen)",
          "new_text": null,
          "old_line_content": "    range = sdsnewlen((char*)o->ptr+start,rangelen);",
          "new_line_content": "    if (start < 0) start = 0;",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": "addReplySds",
          "new_api": null,
          "old_text": "addReplySds(c,range)",
          "new_text": null,
          "old_line_content": "    addReplySds(c,range);",
          "new_line_content": "    if (end < 0) end = 0;",
          "content_same": false
        },
        {
          "line": 255,
          "old_api": "addReply",
          "new_api": null,
          "old_text": "addReply(c,shared.crlf)",
          "new_text": null,
          "old_line_content": "    addReply(c,shared.crlf);",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 17,
      "total_additions": 32,
      "total_deletions": 30,
      "total_api_changes": 79
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 17,
        "api_related_lines": 79,
        "non_api_lines": 8,
        "non_api_line_numbers": [
          161,
          162,
          148,
          149,
          153,
          157,
          158,
          159
        ]
      }
    },
    "api_calls_before": 97,
    "api_calls_after": 99,
    "diff_info": {
      "added_lines": 16,
      "removed_lines": 1,
      "total_diff_lines": 30
    }
  }
}