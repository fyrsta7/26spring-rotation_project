{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/b8d743e1813abbf3d55e92e9945dc47da3ef7836",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/b8d743e1813abbf3d55e92e9945dc47da3ef7836/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/b8d743e1813abbf3d55e92e9945dc47da3ef7836/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/redis/modified_file/b8d743e1813abbf3d55e92e9945dc47da3ef7836/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 841,
          "old_api": "read",
          "new_api": "sdslen",
          "old_text": "read(fd, buf, REDIS_IOBUF_LEN)",
          "new_text": "sdslen(c->querybuf)",
          "old_line_content": "    nread = read(fd, buf, REDIS_IOBUF_LEN);",
          "new_line_content": "    qblen = sdslen(c->querybuf);",
          "content_same": false
        },
        {
          "line": 873,
          "old_api": "listNodeValue",
          "new_api": "listRewind",
          "old_text": "listNodeValue(ln)",
          "new_text": "listRewind(server.clients,&li)",
          "old_line_content": "        c = listNodeValue(ln);",
          "new_line_content": "    listRewind(server.clients,&li);",
          "content_same": false
        },
        {
          "line": 875,
          "old_api": "listLength",
          "new_api": "listNodeValue",
          "old_text": "listLength(c->reply)",
          "new_text": "listNodeValue(ln)",
          "old_line_content": "        if (listLength(c->reply) > lol) lol = listLength(c->reply);",
          "new_line_content": "        c = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 889,
          "old_api": "time",
          "new_api": "strcasecmp",
          "old_text": "time(NULL)",
          "new_text": "strcasecmp(c->argv[1]->ptr,\"list\")",
          "old_line_content": "        time_t now = time(NULL);",
          "new_line_content": "    if (!strcasecmp(c->argv[1]->ptr,\"list\") && c->argc == 2) {",
          "content_same": false
        },
        {
          "line": 891,
          "old_api": "listRewind",
          "new_api": "time",
          "old_text": "listRewind(server.clients,&li)",
          "new_text": "time(NULL)",
          "old_line_content": "        listRewind(server.clients,&li);",
          "new_line_content": "        time_t now = time(NULL);",
          "content_same": false
        },
        {
          "line": 922,
          "old_api": "sdslen",
          "new_api": "listLength",
          "old_text": "sdslen(o)",
          "new_text": "listLength(client->pubsub_patterns)",
          "old_line_content": "        addReplyBulkCBuffer(c,o,sdslen(o));",
          "new_line_content": "                (int) listLength(client->pubsub_patterns));",
          "content_same": false
        },
        {
          "line": 924,
          "old_api": "strcasecmp",
          "new_api": "sdslen",
          "old_text": "strcasecmp(c->argv[1]->ptr,\"kill\")",
          "new_text": "sdslen(o)",
          "old_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"kill\") && c->argc == 3) {",
          "new_line_content": "        addReplyBulkCBuffer(c,o,sdslen(o));",
          "content_same": false
        },
        {
          "line": 925,
          "old_api": "listRewind",
          "new_api": "sdsfree",
          "old_text": "listRewind(server.clients,&li)",
          "new_text": "sdsfree(o)",
          "old_line_content": "        listRewind(server.clients,&li);",
          "new_line_content": "        sdsfree(o);",
          "content_same": false
        },
        {
          "line": 926,
          "old_api": "listNext",
          "new_api": "strcasecmp",
          "old_text": "listNext(&li)",
          "new_text": "strcasecmp(c->argv[1]->ptr,\"kill\")",
          "old_line_content": "        while ((ln = listNext(&li)) != NULL) {",
          "new_line_content": "    } else if (!strcasecmp(c->argv[1]->ptr,\"kill\") && c->argc == 3) {",
          "content_same": false
        },
        {
          "line": 932,
          "old_api": "snprintf",
          "new_api": "listNodeValue",
          "old_text": "snprintf(addr,sizeof(addr),\"%s:%d\",ip,port)",
          "new_text": "listNodeValue(ln)",
          "old_line_content": "            snprintf(addr,sizeof(addr),\"%s:%d\",ip,port);",
          "new_line_content": "            client = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 933,
          "old_api": "strcmp",
          "new_api": "anetPeerToString",
          "old_text": "strcmp(addr,c->argv[2]->ptr)",
          "new_text": "anetPeerToString(client->fd,ip,&port)",
          "old_line_content": "            if (strcmp(addr,c->argv[2]->ptr) == 0) {",
          "new_line_content": "            if (anetPeerToString(client->fd,ip,&port) == -1) continue;",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": "addReply",
          "new_api": "snprintf",
          "old_text": "addReply(c,shared.ok)",
          "new_text": "snprintf(addr,sizeof(addr),\"%s:%d\",ip,port)",
          "old_line_content": "                addReply(c,shared.ok);",
          "new_line_content": "            snprintf(addr,sizeof(addr),\"%s:%d\",ip,port);",
          "content_same": false
        },
        {
          "line": 964,
          "old_api": "incrRefCount",
          "new_api": "va_arg",
          "old_text": "incrRefCount(a)",
          "new_text": "va_arg(ap, robj*)",
          "old_line_content": "        incrRefCount(a);",
          "new_line_content": "        a = va_arg(ap, robj*);",
          "content_same": false
        },
        {
          "line": 976,
          "old_api": "va_end",
          "new_api": "lookupCommand",
          "old_text": "va_end(ap)",
          "new_text": "lookupCommand(c->argv[0]->ptr)",
          "old_line_content": "    va_end(ap);",
          "new_line_content": "    c->cmd = lookupCommand(c->argv[0]->ptr);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 898,
          "old_api": null,
          "new_api": "listNodeValue",
          "old_text": null,
          "new_text": "listNodeValue(ln)",
          "old_line_content": "            p = flags;",
          "new_line_content": "            client = listNodeValue(ln);",
          "content_same": false
        },
        {
          "line": 899,
          "old_api": null,
          "new_api": "anetPeerToString",
          "old_text": null,
          "new_text": "anetPeerToString(client->fd,ip,&port)",
          "old_line_content": "            if (client->flags & REDIS_SLAVE) {",
          "new_line_content": "            if (anetPeerToString(client->fd,ip,&port) == -1) continue;",
          "content_same": false
        },
        {
          "line": 915,
          "old_api": null,
          "new_api": "sdscatprintf",
          "old_text": null,
          "new_text": "sdscatprintf(o,\n                \"addr=%s:%d fd=%d idle=%ld flags=%s db=%d sub=%d psub=%d\\n\",\n                ip,port,client->fd,\n                (long)(now - client->lastinteraction),\n                flags,\n                client->db->id,\n                (int) dictSize(client->pubsub_channels),\n                (int) listLength(client->pubsub_patterns))",
          "old_line_content": "                ip,port,client->fd,",
          "new_line_content": "            o = sdscatprintf(o,",
          "content_same": false
        },
        {
          "line": 921,
          "old_api": null,
          "new_api": "dictSize",
          "old_text": null,
          "new_text": "dictSize(client->pubsub_channels)",
          "old_line_content": "        }",
          "new_line_content": "                (int) dictSize(client->pubsub_channels),",
          "content_same": false
        },
        {
          "line": 927,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(server.clients,&li)",
          "old_line_content": "            char ip[32], addr[64];",
          "new_line_content": "        listRewind(server.clients,&li);",
          "content_same": false
        },
        {
          "line": 928,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "            int port;",
          "new_line_content": "        while ((ln = listNext(&li)) != NULL) {",
          "content_same": false
        },
        {
          "line": 935,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(addr,c->argv[2]->ptr)",
          "old_line_content": "                if (c == client) {",
          "new_line_content": "            if (strcmp(addr,c->argv[2]->ptr) == 0) {",
          "content_same": false
        },
        {
          "line": 936,
          "old_api": null,
          "new_api": "addReply",
          "old_text": null,
          "new_text": "addReply(c,shared.ok)",
          "old_line_content": "                    client->flags |= REDIS_CLOSE_AFTER_REPLY;",
          "new_line_content": "                addReply(c,shared.ok);",
          "content_same": false
        },
        {
          "line": 940,
          "old_api": null,
          "new_api": "freeClient",
          "old_text": null,
          "new_text": "freeClient(client)",
          "old_line_content": "                return;",
          "new_line_content": "                    freeClient(client);",
          "content_same": false
        },
        {
          "line": 947,
          "old_api": null,
          "new_api": "addReplyError",
          "old_text": null,
          "new_text": "addReplyError(c, \"Syntax error, try CLIENT (LIST | KILL ip:port)\")",
          "old_line_content": "}",
          "new_line_content": "        addReplyError(c, \"Syntax error, try CLIENT (LIST | KILL ip:port)\");",
          "content_same": false
        },
        {
          "line": 959,
          "old_api": null,
          "new_api": "zmalloc",
          "old_text": null,
          "new_text": "zmalloc(sizeof(robj*)*argc)",
          "old_line_content": "    for (j = 0; j < argc; j++) {",
          "new_line_content": "    argv = zmalloc(sizeof(robj*)*argc);",
          "content_same": false
        },
        {
          "line": 960,
          "old_api": null,
          "new_api": "va_start",
          "old_text": null,
          "new_text": "va_start(ap,argc)",
          "old_line_content": "        robj *a;",
          "new_line_content": "    va_start(ap,argc);",
          "content_same": false
        },
        {
          "line": 966,
          "old_api": null,
          "new_api": "incrRefCount",
          "old_text": null,
          "new_text": "incrRefCount(a)",
          "old_line_content": "    /* We free the objects in the original vector at the end, so we are",
          "new_line_content": "        incrRefCount(a);",
          "content_same": false
        },
        {
          "line": 842,
          "old_api": null,
          "new_api": "sdsMakeRoomFor",
          "old_text": null,
          "new_text": "sdsMakeRoomFor(c->querybuf, REDIS_IOBUF_LEN)",
          "old_line_content": "    if (nread == -1) {",
          "new_line_content": "    c->querybuf = sdsMakeRoomFor(c->querybuf, REDIS_IOBUF_LEN);",
          "content_same": false
        },
        {
          "line": 843,
          "old_api": null,
          "new_api": "read",
          "old_text": null,
          "new_text": "read(fd, c->querybuf+qblen, REDIS_IOBUF_LEN)",
          "old_line_content": "        if (errno == EAGAIN) {",
          "new_line_content": "    nread = read(fd, c->querybuf+qblen, REDIS_IOBUF_LEN);",
          "content_same": false
        },
        {
          "line": 971,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(c->argv[j])",
          "old_line_content": "    /* Replace argv and argc with our new versions. */",
          "new_line_content": "    for (j = 0; j < c->argc; j++) decrRefCount(c->argv[j]);",
          "content_same": false
        },
        {
          "line": 972,
          "old_api": null,
          "new_api": "zfree",
          "old_text": null,
          "new_text": "zfree(c->argv)",
          "old_line_content": "    c->argv = argv;",
          "new_line_content": "    zfree(c->argv);",
          "content_same": false
        },
        {
          "line": 848,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "            return;",
          "new_line_content": "            redisLog(REDIS_VERBOSE, \"Reading from client: %s\",strerror(errno));",
          "content_same": false
        },
        {
          "line": 849,
          "old_api": null,
          "new_api": "freeClient",
          "old_text": null,
          "new_text": "freeClient(c)",
          "old_line_content": "        }",
          "new_line_content": "            freeClient(c);",
          "content_same": false
        },
        {
          "line": 977,
          "old_api": null,
          "new_api": "redisAssertWithInfo",
          "old_text": null,
          "new_text": "redisAssertWithInfo(c,NULL,c->cmd != NULL)",
          "old_line_content": "}",
          "new_line_content": "    redisAssertWithInfo(c,NULL,c->cmd != NULL);",
          "content_same": false
        },
        {
          "line": 978,
          "old_api": null,
          "new_api": "va_end",
          "old_text": null,
          "new_text": "va_end(ap)",
          "old_line_content": "",
          "new_line_content": "    va_end(ap);",
          "content_same": false
        },
        {
          "line": 853,
          "old_api": null,
          "new_api": "redisLog",
          "old_text": null,
          "new_text": "redisLog(REDIS_VERBOSE, \"Client closed connection\")",
          "old_line_content": "        return;",
          "new_line_content": "        redisLog(REDIS_VERBOSE, \"Client closed connection\");",
          "content_same": false
        },
        {
          "line": 854,
          "old_api": null,
          "new_api": "freeClient",
          "old_text": null,
          "new_text": "freeClient(c)",
          "old_line_content": "    }",
          "new_line_content": "        freeClient(c);",
          "content_same": false
        },
        {
          "line": 858,
          "old_api": null,
          "new_api": "sdsIncrLen",
          "old_text": null,
          "new_text": "sdsIncrLen(c->querybuf,nread)",
          "old_line_content": "    } else {",
          "new_line_content": "        sdsIncrLen(c->querybuf,nread);",
          "content_same": false
        },
        {
          "line": 859,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "        return;",
          "new_line_content": "        c->lastinteraction = time(NULL);",
          "content_same": false
        },
        {
          "line": 986,
          "old_api": null,
          "new_api": "redisAssertWithInfo",
          "old_text": null,
          "new_text": "redisAssertWithInfo(c,NULL,i < c->argc)",
          "old_line_content": "    c->argv[i] = newval;",
          "new_line_content": "    redisAssertWithInfo(c,NULL,i < c->argc);",
          "content_same": false
        },
        {
          "line": 989,
          "old_api": null,
          "new_api": "incrRefCount",
          "old_text": null,
          "new_text": "incrRefCount(newval)",
          "old_line_content": "",
          "new_line_content": "    incrRefCount(newval);",
          "content_same": false
        },
        {
          "line": 990,
          "old_api": null,
          "new_api": "decrRefCount",
          "old_text": null,
          "new_text": "decrRefCount(oldval)",
          "old_line_content": "    /* If this is the command name make sure to fix c->cmd. */",
          "new_line_content": "    decrRefCount(oldval);",
          "content_same": false
        },
        {
          "line": 863,
          "old_api": null,
          "new_api": "processInputBuffer",
          "old_text": null,
          "new_text": "processInputBuffer(c)",
          "old_line_content": "",
          "new_line_content": "    processInputBuffer(c);",
          "content_same": false
        },
        {
          "line": 994,
          "old_api": null,
          "new_api": "lookupCommand",
          "old_text": null,
          "new_text": "lookupCommand(c->argv[0]->ptr)",
          "old_line_content": "    }",
          "new_line_content": "        c->cmd = lookupCommand(c->argv[0]->ptr);",
          "content_same": false
        },
        {
          "line": 995,
          "old_api": null,
          "new_api": "redisAssertWithInfo",
          "old_text": null,
          "new_text": "redisAssertWithInfo(c,NULL,c->cmd != NULL)",
          "old_line_content": "}",
          "new_line_content": "        redisAssertWithInfo(c,NULL,c->cmd != NULL);",
          "content_same": false
        },
        {
          "line": 874,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "",
          "new_line_content": "    while ((ln = listNext(&li)) != NULL) {",
          "content_same": false
        },
        {
          "line": 877,
          "old_api": null,
          "new_api": "listLength",
          "old_text": null,
          "new_text": "listLength(c->reply)",
          "old_line_content": "    }",
          "new_line_content": "        if (listLength(c->reply) > lol) lol = listLength(c->reply);",
          "content_same": false
        },
        {
          "line": 878,
          "old_api": null,
          "new_api": "sdslen",
          "old_text": null,
          "new_text": "sdslen(c->querybuf)",
          "old_line_content": "    *longest_output_list = lol;",
          "new_line_content": "        if (sdslen(c->querybuf) > bib) bib = sdslen(c->querybuf);",
          "content_same": false
        },
        {
          "line": 890,
          "old_api": null,
          "new_api": "sdsempty",
          "old_text": null,
          "new_text": "sdsempty()",
          "old_line_content": "",
          "new_line_content": "        sds o = sdsempty();",
          "content_same": false
        },
        {
          "line": 893,
          "old_api": null,
          "new_api": "listRewind",
          "old_text": null,
          "new_text": "listRewind(server.clients,&li)",
          "old_line_content": "            char ip[32], flags[16], *p;",
          "new_line_content": "        listRewind(server.clients,&li);",
          "content_same": false
        },
        {
          "line": 894,
          "old_api": null,
          "new_api": "listNext",
          "old_text": null,
          "new_text": "listNext(&li)",
          "old_line_content": "            int port;",
          "new_line_content": "        while ((ln = listNext(&li)) != NULL) {",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 896,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "            client = listNodeValue(ln);",
          "new_line_content": "            int port;",
          "content_same": false
        },
        {
          "line": 897,
          "old_api": "anetPeerToString",
          "new_api": null,
          "old_text": "anetPeerToString(client->fd,ip,&port)",
          "new_text": null,
          "old_line_content": "            if (anetPeerToString(client->fd,ip,&port) == -1) continue;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 913,
          "old_api": "sdscatprintf",
          "new_api": null,
          "old_text": "sdscatprintf(o,\n                \"addr=%s:%d fd=%d idle=%ld flags=%s db=%d sub=%d psub=%d\\n\",\n                ip,port,client->fd,\n                (long)(now - client->lastinteraction),\n                flags,\n                client->db->id,\n                (int) dictSize(client->pubsub_channels),\n                (int) listLength(client->pubsub_patterns))",
          "new_text": null,
          "old_line_content": "            o = sdscatprintf(o,",
          "new_line_content": "            if (client->flags & REDIS_UNBLOCKED) *p++ = 'u';",
          "content_same": false
        },
        {
          "line": 919,
          "old_api": "dictSize",
          "new_api": null,
          "old_text": "dictSize(client->pubsub_channels)",
          "new_text": null,
          "old_line_content": "                (int) dictSize(client->pubsub_channels),",
          "new_line_content": "                flags,",
          "content_same": false
        },
        {
          "line": 920,
          "old_api": "listLength",
          "new_api": null,
          "old_text": "listLength(client->pubsub_patterns)",
          "new_text": null,
          "old_line_content": "                (int) listLength(client->pubsub_patterns));",
          "new_line_content": "                client->db->id,",
          "content_same": false
        },
        {
          "line": 923,
          "old_api": "sdsfree",
          "new_api": null,
          "old_text": "sdsfree(o)",
          "new_text": null,
          "old_line_content": "        sdsfree(o);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 930,
          "old_api": "listNodeValue",
          "new_api": null,
          "old_text": "listNodeValue(ln)",
          "new_text": null,
          "old_line_content": "            client = listNodeValue(ln);",
          "new_line_content": "            int port;",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": "anetPeerToString",
          "new_api": null,
          "old_text": "anetPeerToString(client->fd,ip,&port)",
          "new_text": null,
          "old_line_content": "            if (anetPeerToString(client->fd,ip,&port) == -1) continue;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 938,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient(client)",
          "new_text": null,
          "old_line_content": "                    freeClient(client);",
          "new_line_content": "                    client->flags |= REDIS_CLOSE_AFTER_REPLY;",
          "content_same": false
        },
        {
          "line": 943,
          "old_api": "addReplyError",
          "new_api": null,
          "old_text": "addReplyError(c,\"No such client\")",
          "new_text": null,
          "old_line_content": "        addReplyError(c,\"No such client\");",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 957,
          "old_api": "zmalloc",
          "new_api": null,
          "old_text": "zmalloc(sizeof(robj*)*argc)",
          "new_text": null,
          "old_line_content": "    argv = zmalloc(sizeof(robj*)*argc);",
          "new_line_content": "    robj **argv; /* The new argument vector */",
          "content_same": false
        },
        {
          "line": 958,
          "old_api": "va_start",
          "new_api": null,
          "old_text": "va_start(ap,argc)",
          "new_text": null,
          "old_line_content": "    va_start(ap,argc);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 962,
          "old_api": "va_arg",
          "new_api": null,
          "old_text": "va_arg(ap, robj*)",
          "new_text": null,
          "old_line_content": "        a = va_arg(ap, robj*);",
          "new_line_content": "        robj *a;",
          "content_same": false
        },
        {
          "line": 969,
          "old_api": "decrRefCount",
          "new_api": null,
          "old_text": "decrRefCount(c->argv[j])",
          "new_text": null,
          "old_line_content": "    for (j = 0; j < c->argc; j++) decrRefCount(c->argv[j]);",
          "new_line_content": "     * sure that if the same objects are reused in the new vector the",
          "content_same": false
        },
        {
          "line": 970,
          "old_api": "zfree",
          "new_api": null,
          "old_text": "zfree(c->argv)",
          "new_text": null,
          "old_line_content": "    zfree(c->argv);",
          "new_line_content": "     * refcount gets incremented before it gets decremented. */",
          "content_same": false
        },
        {
          "line": 846,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "            redisLog(REDIS_VERBOSE, \"Reading from client: %s\",strerror(errno));",
          "new_line_content": "            nread = 0;",
          "content_same": false
        },
        {
          "line": 847,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient(c)",
          "new_text": null,
          "old_line_content": "            freeClient(c);",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 974,
          "old_api": "lookupCommand",
          "new_api": null,
          "old_text": "lookupCommand(c->argv[0]->ptr)",
          "new_text": null,
          "old_line_content": "    c->cmd = lookupCommand(c->argv[0]->ptr);",
          "new_line_content": "    c->argv = argv;",
          "content_same": false
        },
        {
          "line": 975,
          "old_api": "redisAssertWithInfo",
          "new_api": null,
          "old_text": "redisAssertWithInfo(c,NULL,c->cmd != NULL)",
          "new_text": null,
          "old_line_content": "    redisAssertWithInfo(c,NULL,c->cmd != NULL);",
          "new_line_content": "    c->argc = argc;",
          "content_same": false
        },
        {
          "line": 851,
          "old_api": "redisLog",
          "new_api": null,
          "old_text": "redisLog(REDIS_VERBOSE, \"Client closed connection\")",
          "new_text": null,
          "old_line_content": "        redisLog(REDIS_VERBOSE, \"Client closed connection\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 852,
          "old_api": "freeClient",
          "new_api": null,
          "old_text": "freeClient(c)",
          "new_text": null,
          "old_line_content": "        freeClient(c);",
          "new_line_content": "    } else if (nread == 0) {",
          "content_same": false
        },
        {
          "line": 856,
          "old_api": "sdscatlen",
          "new_api": null,
          "old_text": "sdscatlen(c->querybuf,buf,nread)",
          "new_text": null,
          "old_line_content": "        c->querybuf = sdscatlen(c->querybuf,buf,nread);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 857,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "        c->lastinteraction = time(NULL);",
          "new_line_content": "    if (nread) {",
          "content_same": false
        },
        {
          "line": 984,
          "old_api": "redisAssertWithInfo",
          "new_api": null,
          "old_text": "redisAssertWithInfo(c,NULL,i < c->argc)",
          "new_text": null,
          "old_line_content": "    redisAssertWithInfo(c,NULL,i < c->argc);",
          "new_line_content": "    robj *oldval;",
          "content_same": false
        },
        {
          "line": 987,
          "old_api": "incrRefCount",
          "new_api": null,
          "old_text": "incrRefCount(newval)",
          "new_text": null,
          "old_line_content": "    incrRefCount(newval);",
          "new_line_content": "    oldval = c->argv[i];",
          "content_same": false
        },
        {
          "line": 988,
          "old_api": "decrRefCount",
          "new_api": null,
          "old_text": "decrRefCount(oldval)",
          "new_text": null,
          "old_line_content": "    decrRefCount(oldval);",
          "new_line_content": "    c->argv[i] = newval;",
          "content_same": false
        },
        {
          "line": 861,
          "old_api": "processInputBuffer",
          "new_api": null,
          "old_text": "processInputBuffer(c)",
          "new_text": null,
          "old_line_content": "    processInputBuffer(c);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 992,
          "old_api": "lookupCommand",
          "new_api": null,
          "old_text": "lookupCommand(c->argv[0]->ptr)",
          "new_text": null,
          "old_line_content": "        c->cmd = lookupCommand(c->argv[0]->ptr);",
          "new_line_content": "    /* If this is the command name make sure to fix c->cmd. */",
          "content_same": false
        },
        {
          "line": 993,
          "old_api": "redisAssertWithInfo",
          "new_api": null,
          "old_text": "redisAssertWithInfo(c,NULL,c->cmd != NULL)",
          "new_text": null,
          "old_line_content": "        redisAssertWithInfo(c,NULL,c->cmd != NULL);",
          "new_line_content": "    if (i == 0) {",
          "content_same": false
        },
        {
          "line": 871,
          "old_api": "listRewind",
          "new_api": null,
          "old_text": "listRewind(server.clients,&li)",
          "new_text": null,
          "old_line_content": "    listRewind(server.clients,&li);",
          "new_line_content": "    unsigned long lol = 0, bib = 0;",
          "content_same": false
        },
        {
          "line": 872,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "    while ((ln = listNext(&li)) != NULL) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 876,
          "old_api": "sdslen",
          "new_api": null,
          "old_text": "sdslen(c->querybuf)",
          "new_text": null,
          "old_line_content": "        if (sdslen(c->querybuf) > bib) bib = sdslen(c->querybuf);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 887,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(c->argv[1]->ptr,\"list\")",
          "new_text": null,
          "old_line_content": "    if (!strcasecmp(c->argv[1]->ptr,\"list\") && c->argc == 2) {",
          "new_line_content": "    redisClient *client;",
          "content_same": false
        },
        {
          "line": 888,
          "old_api": "sdsempty",
          "new_api": null,
          "old_text": "sdsempty()",
          "new_text": null,
          "old_line_content": "        sds o = sdsempty();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 892,
          "old_api": "listNext",
          "new_api": null,
          "old_text": "listNext(&li)",
          "new_text": null,
          "old_line_content": "        while ((ln = listNext(&li)) != NULL) {",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 14,
      "total_additions": 37,
      "total_deletions": 35,
      "total_api_changes": 86
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 86,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          836,
          837
        ]
      }
    },
    "api_calls_before": 323,
    "api_calls_after": 325,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 3,
      "total_diff_lines": 31
    }
  }
}