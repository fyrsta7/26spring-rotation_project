{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/reactos/modified_file/36b035181402140212e67c56a045f78f44d22f27",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/reactos/modified_file/36b035181402140212e67c56a045f78f44d22f27/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/reactos/modified_file/36b035181402140212e67c56a045f78f44d22f27/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/reactos/modified_file/36b035181402140212e67c56a045f78f44d22f27/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 363,
          "old_api": "DPRINT1",
          "new_api": "PsGetCurrentThread",
          "old_text": "DPRINT1(\"\\nHook found by Id and posted to Thread! %d\\n\",HookId )",
          "new_text": "PsGetCurrentThread()",
          "old_line_content": "        DPRINT1(\"\\nHook found by Id and posted to Thread! %d\\n\",HookId );",
          "new_line_content": "    if ((Hook->Thread != PsGetCurrentThread()) && (Hook->Thread != NULL))",
          "content_same": false
        },
        {
          "line": 365,
          "old_api": "IntCallLowLevelHook",
          "new_api": "DPRINT1",
          "old_text": "IntCallLowLevelHook(Hook, Code, wParam, lParam)",
          "new_text": "DPRINT1(\"\\nHook found by Id and posted to Thread! %d\\n\",HookId )",
          "old_line_content": "        return IntCallLowLevelHook(Hook, Code, wParam, lParam);",
          "new_line_content": "        DPRINT1(\"\\nHook found by Id and posted to Thread! %d\\n\",HookId );",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": "DPRINT1",
          "new_api": "NT_SUCCESS",
          "old_text": "DPRINT1(\"Invalid window station????\\n\")",
          "new_text": "NT_SUCCESS(Status)",
          "old_line_content": "        DPRINT1(\"Invalid window station????\\n\");",
          "new_line_content": "    if (!NT_SUCCESS(Status))",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": "ObDereferenceObject",
          "new_api": "MsqGetHooks",
          "old_text": "ObDereferenceObject(WinStaObj)",
          "new_text": "MsqGetHooks(pti->MessageQueue)",
          "old_line_content": "        ObDereferenceObject(WinStaObj);",
          "new_line_content": "        IntReleaseHookChain(MsqGetHooks(pti->MessageQueue), HookId, WinStaObj);",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": "DPRINT1",
          "new_api": "NT_SUCCESS",
          "old_text": "DPRINT1(\"Invalid window station????\\n\")",
          "new_text": "NT_SUCCESS(Status)",
          "old_line_content": "            DPRINT1(\"Invalid window station????\\n\");",
          "new_line_content": "        if (!NT_SUCCESS(Status))",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": "CONTAINING_RECORD",
          "new_api": "HOOKID_TO_INDEX",
          "old_text": "CONTAINING_RECORD(Elem, HOOK, Chain)",
          "new_text": "HOOKID_TO_INDEX(HookId)",
          "old_line_content": "                        HookObj = CONTAINING_RECORD(Elem, HOOK, Chain);",
          "new_line_content": "                    while (Elem != &GlobalHooks->Hooks[HOOKID_TO_INDEX(HookId)])",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": "DPRINT1",
          "new_api": "PsGetCurrentThread",
          "old_text": "DPRINT1(\"CALLING HOOK from another Thread. %d\\n\", Hook->HookId)",
          "new_text": "PsGetCurrentThread()",
          "old_line_content": "        DPRINT1(\"CALLING HOOK from another Thread. %d\\n\", Hook->HookId);",
          "new_line_content": "    if ((Hook->Thread != PsGetCurrentThread()) && (Hook->Thread != NULL))",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": "co_IntCallHookProc",
          "new_api": "DPRINT",
          "old_text": "co_IntCallHookProc(Hook->HookId,\n                              Code,\n                              wParam,\n                              lParam,\n                              Hook->Proc,\n                              Hook->Ansi,\n                              &Hook->ModuleName)",
          "new_text": "DPRINT(\"CALLING HOOK %d\\n\", Hook->HookId)",
          "old_line_content": "    return co_IntCallHookProc(Hook->HookId,",
          "new_line_content": "    DPRINT(\"CALLING HOOK %d\\n\", Hook->HookId);",
          "content_same": false
        },
        {
          "line": 837,
          "old_api": "ProbeForRead",
          "new_api": "IS_ATOM",
          "old_text": "ProbeForRead( pcbtcww->lpcs->lpszClass,\n                                             sizeof(WCHAR),\n                                             1)",
          "new_text": "IS_ATOM(pcbtcww->lpcs->lpszClass)",
          "old_line_content": "                               ProbeForRead( pcbtcww->lpcs->lpszClass,",
          "new_line_content": "                            if (!IS_ATOM(pcbtcww->lpcs->lpszClass))",
          "content_same": false
        },
        {
          "line": 1036,
          "old_api": "DPRINT",
          "new_api": "DECLARE_RETURN",
          "old_text": "DPRINT(\"Enter NtUserCallNextHookEx\\n\")",
          "new_text": "DECLARE_RETURN(LRESULT)",
          "old_line_content": "    DPRINT(\"Enter NtUserCallNextHookEx\\n\");",
          "new_line_content": "    DECLARE_RETURN(LRESULT);",
          "content_same": false
        },
        {
          "line": 1039,
          "old_api": "PsGetCurrentProcess",
          "new_api": "UserEnterExclusive",
          "old_text": "PsGetCurrentProcess()",
          "new_text": "UserEnterExclusive()",
          "old_line_content": "    Status = IntValidateWindowStationHandle(PsGetCurrentProcess()->Win32WindowStation,",
          "new_line_content": "    UserEnterExclusive();",
          "content_same": false
        },
        {
          "line": 1045,
          "old_api": "SetLastNtError",
          "new_api": "NT_SUCCESS",
          "old_text": "SetLastNtError(Status)",
          "new_text": "NT_SUCCESS(Status)",
          "old_line_content": "        SetLastNtError(Status);",
          "new_line_content": "    if (!NT_SUCCESS(Status))",
          "content_same": false
        },
        {
          "line": 1051,
          "old_api": "GetWin32ClientInfo",
          "new_api": "ObDereferenceObject",
          "old_text": "GetWin32ClientInfo()",
          "new_text": "ObDereferenceObject(WinStaObj)",
          "old_line_content": "    ClientInfo = GetWin32ClientInfo();",
          "new_line_content": "    ObDereferenceObject(WinStaObj);",
          "content_same": false
        },
        {
          "line": 1053,
          "old_api": "RETURN",
          "new_api": "GetWin32ClientInfo",
          "old_text": "RETURN( 0)",
          "new_text": "GetWin32ClientInfo()",
          "old_line_content": "    if (!ClientInfo) RETURN( 0);",
          "new_line_content": "    ClientInfo = GetWin32ClientInfo();",
          "content_same": false
        },
        {
          "line": 1065,
          "old_api": "UserReferenceObject",
          "new_api": "RETURN",
          "old_text": "UserReferenceObject(HookObj)",
          "new_text": "RETURN(0)",
          "old_line_content": "    UserReferenceObject(HookObj);",
          "new_line_content": "    if (HookObj == NextObj) RETURN(0);",
          "content_same": false
        },
        {
          "line": 1071,
          "old_api": "DPRINT1",
          "new_api": "PsGetCurrentThread",
          "old_text": "DPRINT1(\"Thread mismatch\\n\")",
          "new_text": "PsGetCurrentThread()",
          "old_line_content": "        DPRINT1(\"Thread mismatch\\n\");",
          "new_line_content": "    if (NULL != HookObj->Thread && (HookObj->Thread != PsGetCurrentThread()))",
          "content_same": false
        },
        {
          "line": 1073,
          "old_api": "SetLastWin32Error",
          "new_api": "DPRINT1",
          "old_text": "SetLastWin32Error(ERROR_INVALID_HANDLE)",
          "new_text": "DPRINT1(\"Thread mismatch\\n\")",
          "old_line_content": "        SetLastWin32Error(ERROR_INVALID_HANDLE);",
          "new_line_content": "        DPRINT1(\"Thread mismatch\\n\");",
          "content_same": false
        },
        {
          "line": 1074,
          "old_api": "RETURN",
          "new_api": "UserDereferenceObject",
          "old_text": "RETURN( 0)",
          "new_text": "UserDereferenceObject(HookObj)",
          "old_line_content": "        RETURN( 0);",
          "new_line_content": "        UserDereferenceObject(HookObj);",
          "content_same": false
        },
        {
          "line": 1079,
          "old_api": "UserCallNextHookEx",
          "new_api": "IntGetNextHook",
          "old_text": "UserCallNextHookEx( HookObj, Code, wParam, lParam, Ansi)",
          "new_text": "IntGetNextHook(HookObj)",
          "old_line_content": "    UserCallNextHookEx( HookObj, Code, wParam, lParam, Ansi);",
          "new_line_content": "    NextObj = IntGetNextHook(HookObj);",
          "content_same": false
        },
        {
          "line": 1082,
          "old_api": "RETURN",
          "new_api": "UserDereferenceObject",
          "old_text": "RETURN( (LRESULT)NextObj)",
          "new_text": "UserDereferenceObject(HookObj)",
          "old_line_content": "    RETURN( (LRESULT)NextObj);",
          "new_line_content": "    UserDereferenceObject(HookObj);",
          "content_same": false
        },
        {
          "line": 1100,
          "old_api": "NtUserSetWindowsHookEx",
          "new_api": "RtlInitUnicodeString",
          "old_text": "NtUserSetWindowsHookEx(NULL, &USModuleName, 0, idHook, lpfn, Ansi)",
          "new_text": "RtlInitUnicodeString(&USModuleName, NULL)",
          "old_line_content": "    return NtUserSetWindowsHookEx(NULL, &USModuleName, 0, idHook, lpfn, Ansi);",
          "new_line_content": "    RtlInitUnicodeString(&USModuleName, NULL);",
          "content_same": false
        },
        {
          "line": 1158,
          "old_api": "DPRINT1",
          "new_api": "PsLookupThreadByThreadId",
          "old_text": "DPRINT1(\"Invalid thread id 0x%x\\n\", ThreadId)",
          "new_text": "PsLookupThreadByThreadId((HANDLE)(DWORD_PTR) ThreadId, &Thread)",
          "old_line_content": "            DPRINT1(\"Invalid thread id 0x%x\\n\", ThreadId);",
          "new_line_content": "        if (!NT_SUCCESS(PsLookupThreadByThreadId((HANDLE)(DWORD_PTR) ThreadId, &Thread)))",
          "content_same": false
        },
        {
          "line": 1160,
          "old_api": "RETURN",
          "new_api": "DPRINT1",
          "old_text": "RETURN( NULL)",
          "new_text": "DPRINT1(\"Invalid thread id 0x%x\\n\", ThreadId)",
          "old_line_content": "            RETURN( NULL);",
          "new_line_content": "            DPRINT1(\"Invalid thread id 0x%x\\n\", ThreadId);",
          "content_same": false
        },
        {
          "line": 1167,
          "old_api": "ObDereferenceObject",
          "new_api": "PsGetCurrentProcess",
          "old_text": "ObDereferenceObject(Thread)",
          "new_text": "PsGetCurrentProcess()",
          "old_line_content": "            ObDereferenceObject(Thread);",
          "new_line_content": "        if (Thread->ThreadsProcess != PsGetCurrentProcess())",
          "content_same": false
        },
        {
          "line": 1169,
          "old_api": "SetLastWin32Error",
          "new_api": "ObDereferenceObject",
          "old_text": "SetLastWin32Error(ERROR_INVALID_PARAMETER)",
          "new_text": "ObDereferenceObject(Thread)",
          "old_line_content": "            SetLastWin32Error(ERROR_INVALID_PARAMETER);",
          "new_line_content": "            ObDereferenceObject(Thread);",
          "content_same": false
        },
        {
          "line": 1170,
          "old_api": "RETURN",
          "new_api": "DPRINT1",
          "old_text": "RETURN( NULL)",
          "new_text": "DPRINT1(\"Can't specify thread belonging to another process\\n\")",
          "old_line_content": "            RETURN( NULL);",
          "new_line_content": "            DPRINT1(\"Can't specify thread belonging to another process\\n\");",
          "content_same": false
        },
        {
          "line": 1180,
          "old_api": "ObReferenceObjectByPointer",
          "new_api": "PsGetCurrentThread",
          "old_text": "ObReferenceObjectByPointer(Thread,\n                                                THREAD_ALL_ACCESS,\n                                                PsThreadType,\n                                                KernelMode)",
          "new_text": "PsGetCurrentThread()",
          "old_line_content": "            Status = ObReferenceObjectByPointer(Thread,",
          "new_line_content": "            Thread = PsGetCurrentThread();",
          "content_same": false
        },
        {
          "line": 1187,
          "old_api": "SetLastNtError",
          "new_api": "NT_SUCCESS",
          "old_text": "SetLastNtError(Status)",
          "new_text": "NT_SUCCESS(Status)",
          "old_line_content": "                SetLastNtError(Status);",
          "new_line_content": "            if (!NT_SUCCESS(Status))",
          "content_same": false
        },
        {
          "line": 1220,
          "old_api": "RETURN",
          "new_api": "ObDereferenceObject",
          "old_text": "RETURN( NULL)",
          "new_text": "ObDereferenceObject(Thread)",
          "old_line_content": "        RETURN( NULL);",
          "new_line_content": "        if (ThreadReferenced) ObDereferenceObject(Thread);",
          "content_same": false
        },
        {
          "line": 1233,
          "old_api": "RETURN",
          "new_api": "ObDereferenceObject",
          "old_text": "RETURN( (HANDLE) NULL)",
          "new_text": "ObDereferenceObject(Thread)",
          "old_line_content": "        RETURN( (HANDLE) NULL);",
          "new_line_content": "        if (ThreadReferenced) ObDereferenceObject(Thread);",
          "content_same": false
        },
        {
          "line": 1242,
          "old_api": "RETURN",
          "new_api": "ObDereferenceObject",
          "old_text": "RETURN( NULL)",
          "new_text": "ObDereferenceObject(Thread)",
          "old_line_content": "        RETURN( NULL);",
          "new_line_content": "        if (ThreadReferenced) ObDereferenceObject(Thread);",
          "content_same": false
        },
        {
          "line": 1256,
          "old_api": "UserDereferenceObject",
          "new_api": "NT_SUCCESS",
          "old_text": "UserDereferenceObject(Hook)",
          "new_text": "NT_SUCCESS(Status)",
          "old_line_content": "            UserDereferenceObject(Hook);",
          "new_line_content": "        if (!NT_SUCCESS(Status))",
          "content_same": false
        },
        {
          "line": 1258,
          "old_api": "ObDereferenceObject",
          "new_api": "UserDereferenceObject",
          "old_text": "ObDereferenceObject(WinStaObj)",
          "new_text": "UserDereferenceObject(Hook)",
          "old_line_content": "            ObDereferenceObject(WinStaObj);",
          "new_line_content": "            UserDereferenceObject(Hook);",
          "content_same": false
        },
        {
          "line": 1259,
          "old_api": "SetLastNtError",
          "new_api": "IntRemoveHook",
          "old_text": "SetLastNtError(Status)",
          "new_text": "IntRemoveHook(Hook, WinStaObj, FALSE)",
          "old_line_content": "            SetLastNtError(Status);",
          "new_line_content": "            IntRemoveHook(Hook, WinStaObj, FALSE);",
          "content_same": false
        },
        {
          "line": 1260,
          "old_api": "RETURN",
          "new_api": "ObDereferenceObject",
          "old_text": "RETURN( NULL)",
          "new_text": "ObDereferenceObject(WinStaObj)",
          "old_line_content": "            RETURN( NULL);",
          "new_line_content": "            ObDereferenceObject(WinStaObj);",
          "content_same": false
        },
        {
          "line": 1270,
          "old_api": "ObDereferenceObject",
          "new_api": "UserDereferenceObject",
          "old_text": "ObDereferenceObject(WinStaObj)",
          "new_text": "UserDereferenceObject(Hook)",
          "old_line_content": "            ObDereferenceObject(WinStaObj);",
          "new_line_content": "            UserDereferenceObject(Hook);",
          "content_same": false
        },
        {
          "line": 1271,
          "old_api": "SetLastWin32Error",
          "new_api": "IntRemoveHook",
          "old_text": "SetLastWin32Error(ERROR_NOT_ENOUGH_MEMORY)",
          "new_text": "IntRemoveHook(Hook, WinStaObj, FALSE)",
          "old_line_content": "            SetLastWin32Error(ERROR_NOT_ENOUGH_MEMORY);",
          "new_line_content": "            IntRemoveHook(Hook, WinStaObj, FALSE);",
          "content_same": false
        },
        {
          "line": 1272,
          "old_api": "RETURN",
          "new_api": "ObDereferenceObject",
          "old_text": "RETURN( NULL)",
          "new_text": "ObDereferenceObject(WinStaObj)",
          "old_line_content": "            RETURN( NULL);",
          "new_line_content": "            ObDereferenceObject(WinStaObj);",
          "content_same": false
        },
        {
          "line": 1281,
          "old_api": "ExFreePoolWithTag",
          "new_api": "NT_SUCCESS",
          "old_text": "ExFreePoolWithTag(Hook->ModuleName.Buffer, TAG_HOOK)",
          "new_text": "NT_SUCCESS(Status)",
          "old_line_content": "            ExFreePoolWithTag(Hook->ModuleName.Buffer, TAG_HOOK);",
          "new_line_content": "        if (!NT_SUCCESS(Status))",
          "content_same": false
        },
        {
          "line": 1283,
          "old_api": "IntRemoveHook",
          "new_api": "ExFreePoolWithTag",
          "old_text": "IntRemoveHook(Hook, WinStaObj, FALSE)",
          "new_text": "ExFreePoolWithTag(Hook->ModuleName.Buffer, TAG_HOOK)",
          "old_line_content": "            IntRemoveHook(Hook, WinStaObj, FALSE);",
          "new_line_content": "            ExFreePoolWithTag(Hook->ModuleName.Buffer, TAG_HOOK);",
          "content_same": false
        },
        {
          "line": 1284,
          "old_api": "ObDereferenceObject",
          "new_api": "UserDereferenceObject",
          "old_text": "ObDereferenceObject(WinStaObj)",
          "new_text": "UserDereferenceObject(Hook)",
          "old_line_content": "            ObDereferenceObject(WinStaObj);",
          "new_line_content": "            UserDereferenceObject(Hook);",
          "content_same": false
        },
        {
          "line": 1285,
          "old_api": "SetLastNtError",
          "new_api": "IntRemoveHook",
          "old_text": "SetLastNtError(Status)",
          "new_text": "IntRemoveHook(Hook, WinStaObj, FALSE)",
          "old_line_content": "            SetLastNtError(Status);",
          "new_line_content": "            IntRemoveHook(Hook, WinStaObj, FALSE);",
          "content_same": false
        },
        {
          "line": 1286,
          "old_api": "RETURN",
          "new_api": "ObDereferenceObject",
          "old_text": "RETURN( NULL)",
          "new_text": "ObDereferenceObject(WinStaObj)",
          "old_line_content": "            RETURN( NULL);",
          "new_line_content": "            ObDereferenceObject(WinStaObj);",
          "content_same": false
        },
        {
          "line": 1304,
          "old_api": "ObDereferenceObject",
          "new_api": "UserDereferenceObject",
          "old_text": "ObDereferenceObject(WinStaObj)",
          "new_text": "UserDereferenceObject(Hook)",
          "old_line_content": "    ObDereferenceObject(WinStaObj);",
          "new_line_content": "    UserDereferenceObject(Hook);",
          "content_same": false
        },
        {
          "line": 1306,
          "old_api": "RETURN",
          "new_api": "ObDereferenceObject",
          "old_text": "RETURN( Handle)",
          "new_text": "ObDereferenceObject(WinStaObj)",
          "old_line_content": "    RETURN( Handle);",
          "new_line_content": "    ObDereferenceObject(WinStaObj);",
          "content_same": false
        },
        {
          "line": 1334,
          "old_api": "SetLastNtError",
          "new_api": "NT_SUCCESS",
          "old_text": "SetLastNtError(Status)",
          "new_text": "NT_SUCCESS(Status)",
          "old_line_content": "        SetLastNtError(Status);",
          "new_line_content": "    if (!NT_SUCCESS(Status))",
          "content_same": false
        },
        {
          "line": 1342,
          "old_api": "DPRINT1",
          "new_api": "IntGetHookObject",
          "old_text": "DPRINT1(\"Invalid handle passed to NtUserUnhookWindowsHookEx\\n\")",
          "new_text": "IntGetHookObject(Hook)",
          "old_line_content": "        DPRINT1(\"Invalid handle passed to NtUserUnhookWindowsHookEx\\n\");",
          "new_line_content": "    if (!(HookObj = IntGetHookObject(Hook)))",
          "content_same": false
        },
        {
          "line": 1345,
          "old_api": "RETURN",
          "new_api": "ObDereferenceObject",
          "old_text": "RETURN( FALSE)",
          "new_text": "ObDereferenceObject(WinStaObj)",
          "old_line_content": "        RETURN( FALSE);",
          "new_line_content": "        ObDereferenceObject(WinStaObj);",
          "content_same": false
        },
        {
          "line": 1350,
          "old_api": "IntRemoveHook",
          "new_api": "UserHMGetHandle",
          "old_text": "IntRemoveHook(HookObj, WinStaObj, FALSE)",
          "new_text": "UserHMGetHandle(HookObj)",
          "old_line_content": "    IntRemoveHook(HookObj, WinStaObj, FALSE);",
          "new_line_content": "    ASSERT(Hook == UserHMGetHandle(HookObj));",
          "content_same": false
        },
        {
          "line": 1352,
          "old_api": "UserDereferenceObject",
          "new_api": "IntRemoveHook",
          "old_text": "UserDereferenceObject(HookObj)",
          "new_text": "IntRemoveHook(HookObj, WinStaObj, FALSE)",
          "old_line_content": "    UserDereferenceObject(HookObj);",
          "new_line_content": "    IntRemoveHook(HookObj, WinStaObj, FALSE);",
          "content_same": false
        },
        {
          "line": 1355,
          "old_api": "RETURN",
          "new_api": "ObDereferenceObject",
          "old_text": "RETURN( TRUE)",
          "new_text": "ObDereferenceObject(WinStaObj)",
          "old_line_content": "    RETURN( TRUE);",
          "new_line_content": "    ObDereferenceObject(WinStaObj);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 513,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"HOOK WH_DEBUG read from lParam ERROR!\\n\")",
          "old_line_content": "        }",
          "new_line_content": "            DPRINT1(\"HOOK WH_DEBUG read from lParam ERROR!\\n\");",
          "content_same": false
        },
        {
          "line": 1038,
          "old_api": null,
          "new_api": "DPRINT",
          "old_text": null,
          "new_text": "DPRINT(\"Enter NtUserCallNextHookEx\\n\")",
          "old_line_content": "",
          "new_line_content": "    DPRINT(\"Enter NtUserCallNextHookEx\\n\");",
          "content_same": false
        },
        {
          "line": 1041,
          "old_api": null,
          "new_api": "PsGetCurrentProcess",
          "old_text": null,
          "new_text": "PsGetCurrentProcess()",
          "old_line_content": "                                            0,",
          "new_line_content": "    Status = IntValidateWindowStationHandle(PsGetCurrentProcess()->Win32WindowStation,",
          "content_same": false
        },
        {
          "line": 1047,
          "old_api": null,
          "new_api": "SetLastNtError",
          "old_text": null,
          "new_text": "SetLastNtError(Status)",
          "old_line_content": "    }",
          "new_line_content": "        SetLastNtError(Status);",
          "content_same": false
        },
        {
          "line": 1048,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( 0)",
          "old_line_content": "",
          "new_line_content": "        RETURN( 0);",
          "content_same": false
        },
        {
          "line": 1055,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( 0)",
          "old_line_content": "    HookObj = ClientInfo->phkCurrent;",
          "new_line_content": "    if (!ClientInfo) RETURN( 0);",
          "content_same": false
        },
        {
          "line": 1059,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( 0)",
          "old_line_content": "    /* Check that the first hook in the chain is not this hook */",
          "new_line_content": "    if (!HookObj) RETURN( 0);",
          "content_same": false
        },
        {
          "line": 1062,
          "old_api": null,
          "new_api": "IntGetTable",
          "old_text": null,
          "new_text": "IntGetTable(HookObj)",
          "old_line_content": "    /* Its the same so it has already been called */",
          "new_line_content": "    NextObj = IntGetFirstHook(IntGetTable(HookObj), HookObj->HookId);",
          "content_same": false
        },
        {
          "line": 1067,
          "old_api": null,
          "new_api": "UserReferenceObject",
          "old_text": null,
          "new_text": "UserReferenceObject(HookObj)",
          "old_line_content": "    Ansi = HookObj->Ansi;",
          "new_line_content": "    UserReferenceObject(HookObj);",
          "content_same": false
        },
        {
          "line": 1075,
          "old_api": null,
          "new_api": "SetLastWin32Error",
          "old_text": null,
          "new_text": "SetLastWin32Error(ERROR_INVALID_HANDLE)",
          "old_line_content": "    }",
          "new_line_content": "        SetLastWin32Error(ERROR_INVALID_HANDLE);",
          "content_same": false
        },
        {
          "line": 1076,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( 0)",
          "old_line_content": "   ",
          "new_line_content": "        RETURN( 0);",
          "content_same": false
        },
        {
          "line": 1081,
          "old_api": null,
          "new_api": "UserCallNextHookEx",
          "old_text": null,
          "new_text": "UserCallNextHookEx( HookObj, Code, wParam, lParam, Ansi)",
          "old_line_content": "",
          "new_line_content": "    UserCallNextHookEx( HookObj, Code, wParam, lParam, Ansi);",
          "content_same": false
        },
        {
          "line": 1084,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( (LRESULT)NextObj)",
          "old_line_content": "CLEANUP:",
          "new_line_content": "    RETURN( (LRESULT)NextObj);",
          "content_same": false
        },
        {
          "line": 1087,
          "old_api": null,
          "new_api": "DPRINT",
          "old_text": null,
          "new_text": "DPRINT(\"Leave NtUserCallNextHookEx, ret=%i\\n\",_ret_)",
          "old_line_content": "    END_CLEANUP;",
          "new_line_content": "    DPRINT(\"Leave NtUserCallNextHookEx, ret=%i\\n\",_ret_);",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": null,
          "new_api": "ExAllocatePoolWithTag",
          "old_text": null,
          "new_text": "ExAllocatePoolWithTag(NonPagedPool, Size, TAG_HOOK)",
          "old_line_content": "    if (HooklParam)",
          "new_line_content": "        HooklParam = ExAllocatePoolWithTag(NonPagedPool, Size, TAG_HOOK);",
          "content_same": false
        },
        {
          "line": 1088,
          "old_api": null,
          "new_api": "UserLeave",
          "old_text": null,
          "new_text": "UserLeave()",
          "old_line_content": "}",
          "new_line_content": "    UserLeave();",
          "content_same": false
        },
        {
          "line": 582,
          "old_api": null,
          "new_api": "ProbeForRead",
          "old_text": null,
          "new_text": "ProbeForRead((PVOID)Debug.lParam,\n                         Size,\n                         1)",
          "old_line_content": "                         1);",
          "new_line_content": "            ProbeForRead((PVOID)Debug.lParam,",
          "content_same": false
        },
        {
          "line": 586,
          "old_api": null,
          "new_api": "RtlCopyMemory",
          "old_text": null,
          "new_text": "RtlCopyMemory(HooklParam,\n                          (PVOID)Debug.lParam,\n                          Size)",
          "old_line_content": "                          Size);",
          "new_line_content": "            RtlCopyMemory(HooklParam,",
          "content_same": false
        },
        {
          "line": 1102,
          "old_api": null,
          "new_api": "NtUserSetWindowsHookEx",
          "old_text": null,
          "new_text": "NtUserSetWindowsHookEx(NULL, &USModuleName, 0, idHook, lpfn, Ansi)",
          "old_line_content": "",
          "new_line_content": "    return NtUserSetWindowsHookEx(NULL, &USModuleName, 0, idHook, lpfn, Ansi);",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"HOOK WH_DEBUG read from Debug.lParam ERROR!\\n\")",
          "old_line_content": "            return lResult;",
          "new_line_content": "            DPRINT1(\"HOOK WH_DEBUG read from Debug.lParam ERROR!\\n\");",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": null,
          "new_api": "ExFreePool",
          "old_text": null,
          "new_text": "ExFreePool(HooklParam)",
          "old_line_content": "        }",
          "new_line_content": "            ExFreePool(HooklParam);",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": null,
          "new_api": "co_HOOK_CallHookNext",
          "old_text": null,
          "new_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Debug)",
          "old_line_content": "",
          "new_line_content": "    lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Debug);",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": null,
          "new_api": "ExFreePoolWithTag",
          "old_text": null,
          "new_text": "ExFreePoolWithTag(HooklParam, TAG_HOOK)",
          "old_line_content": "    return lResult;",
          "new_line_content": "    if (HooklParam) ExFreePoolWithTag(HooklParam, TAG_HOOK);",
          "content_same": false
        },
        {
          "line": 1126,
          "old_api": null,
          "new_api": "UserEnterExclusive",
          "old_text": null,
          "new_text": "UserEnterExclusive()",
          "old_line_content": "    if (HookId < WH_MINHOOK || WH_MAXHOOK < HookId )",
          "new_line_content": "    UserEnterExclusive();",
          "content_same": false
        },
        {
          "line": 1130,
          "old_api": null,
          "new_api": "SetLastWin32Error",
          "old_text": null,
          "new_text": "SetLastWin32Error(ERROR_INVALID_PARAMETER)",
          "old_line_content": "    }",
          "new_line_content": "        SetLastWin32Error(ERROR_INVALID_PARAMETER);",
          "content_same": false
        },
        {
          "line": 1131,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( NULL)",
          "old_line_content": "",
          "new_line_content": "        RETURN( NULL);",
          "content_same": false
        },
        {
          "line": 1136,
          "old_api": null,
          "new_api": "SetLastWin32Error",
          "old_text": null,
          "new_text": "SetLastWin32Error(ERROR_INVALID_FILTER_PROC)",
          "old_line_content": "    }",
          "new_line_content": "        SetLastWin32Error(ERROR_INVALID_FILTER_PROC);",
          "content_same": false
        },
        {
          "line": 1137,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( NULL)",
          "old_line_content": "",
          "new_line_content": "        RETURN( NULL);",
          "content_same": false
        },
        {
          "line": 1140,
          "old_api": null,
          "new_api": "GetWin32ClientInfo",
          "old_text": null,
          "new_text": "GetWin32ClientInfo()",
          "old_line_content": "    if (ThreadId)  /* thread-local hook */",
          "new_line_content": "    ClientInfo = GetWin32ClientInfo();",
          "content_same": false
        },
        {
          "line": 634,
          "old_api": null,
          "new_api": "ProbeForRead",
          "old_text": null,
          "new_text": "ProbeForRead((PVOID)lParam,\n                             sizeof(MOUSEHOOKSTRUCTEX),\n                             1)",
          "old_line_content": "                             1);",
          "new_line_content": "                ProbeForRead((PVOID)lParam,",
          "content_same": false
        },
        {
          "line": 638,
          "old_api": null,
          "new_api": "RtlCopyMemory",
          "old_text": null,
          "new_text": "RtlCopyMemory(&Mouse,\n                              (PVOID)lParam,\n                              sizeof(MOUSEHOOKSTRUCTEX))",
          "old_line_content": "                              sizeof(MOUSEHOOKSTRUCTEX));",
          "new_line_content": "                RtlCopyMemory(&Mouse,",
          "content_same": false
        },
        {
          "line": 1151,
          "old_api": null,
          "new_api": "SetLastWin32Error",
          "old_text": null,
          "new_text": "SetLastWin32Error(ERROR_INVALID_PARAMETER)",
          "old_line_content": "        }",
          "new_line_content": "            SetLastWin32Error(ERROR_INVALID_PARAMETER);",
          "content_same": false
        },
        {
          "line": 1152,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( NULL)",
          "old_line_content": "",
          "new_line_content": "            RETURN( NULL);",
          "content_same": false
        },
        {
          "line": 1161,
          "old_api": null,
          "new_api": "SetLastWin32Error",
          "old_text": null,
          "new_text": "SetLastWin32Error(ERROR_INVALID_PARAMETER)",
          "old_line_content": "        }",
          "new_line_content": "            SetLastWin32Error(ERROR_INVALID_PARAMETER);",
          "content_same": false
        },
        {
          "line": 650,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"HOOK WH_MOUSE read from lParam ERROR!\\n\")",
          "old_line_content": "        }",
          "new_line_content": "                DPRINT1(\"HOOK WH_MOUSE read from lParam ERROR!\\n\");",
          "content_same": false
        },
        {
          "line": 1162,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( NULL)",
          "old_line_content": "",
          "new_line_content": "            RETURN( NULL);",
          "content_same": false
        },
        {
          "line": 656,
          "old_api": null,
          "new_api": "co_HOOK_CallHookNext",
          "old_text": null,
          "new_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Mouse)",
          "old_line_content": "",
          "new_line_content": "            lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Mouse);",
          "content_same": false
        },
        {
          "line": 1171,
          "old_api": null,
          "new_api": "SetLastWin32Error",
          "old_text": null,
          "new_text": "SetLastWin32Error(ERROR_INVALID_PARAMETER)",
          "old_line_content": "        }",
          "new_line_content": "            SetLastWin32Error(ERROR_INVALID_PARAMETER);",
          "content_same": false
        },
        {
          "line": 1172,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( NULL)",
          "old_line_content": "    }",
          "new_line_content": "            RETURN( NULL);",
          "content_same": false
        },
        {
          "line": 1182,
          "old_api": null,
          "new_api": "ObReferenceObjectByPointer",
          "old_text": null,
          "new_text": "ObReferenceObjectByPointer(Thread,\n                                                THREAD_ALL_ACCESS,\n                                                PsThreadType,\n                                                KernelMode)",
          "old_line_content": "                                                PsThreadType,",
          "new_line_content": "            Status = ObReferenceObjectByPointer(Thread,",
          "content_same": false
        },
        {
          "line": 672,
          "old_api": null,
          "new_api": "ProbeForRead",
          "old_text": null,
          "new_text": "ProbeForRead((PVOID)lParam,\n                                 sizeof(MSLLHOOKSTRUCT),\n                                 1)",
          "old_line_content": "                                 1);",
          "new_line_content": "                    ProbeForRead((PVOID)lParam,",
          "content_same": false
        },
        {
          "line": 676,
          "old_api": null,
          "new_api": "RtlCopyMemory",
          "old_text": null,
          "new_text": "RtlCopyMemory(&Mouse,\n                                  (PVOID)lParam,\n                                  sizeof(MSLLHOOKSTRUCT))",
          "old_line_content": "                                  sizeof(MSLLHOOKSTRUCT));",
          "new_line_content": "                    RtlCopyMemory(&Mouse,",
          "content_same": false
        },
        {
          "line": 1189,
          "old_api": null,
          "new_api": "SetLastNtError",
          "old_text": null,
          "new_text": "SetLastNtError(Status)",
          "old_line_content": "            }",
          "new_line_content": "                SetLastNtError(Status);",
          "content_same": false
        },
        {
          "line": 1190,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( (HANDLE) NULL)",
          "old_line_content": "",
          "new_line_content": "                RETURN( (HANDLE) NULL);",
          "content_same": false
        },
        {
          "line": 1198,
          "old_api": null,
          "new_api": "SetLastWin32Error",
          "old_text": null,
          "new_text": "SetLastWin32Error(ERROR_HOOK_NEEDS_HMOD)",
          "old_line_content": "        }",
          "new_line_content": "            SetLastWin32Error(ERROR_HOOK_NEEDS_HMOD);",
          "content_same": false
        },
        {
          "line": 1199,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( NULL)",
          "old_line_content": "        else",
          "new_line_content": "            RETURN( NULL);",
          "content_same": false
        },
        {
          "line": 688,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"HOOK WH_MOUSE_LL read from lParam ERROR!\\n\")",
          "old_line_content": "            }",
          "new_line_content": "                    DPRINT1(\"HOOK WH_MOUSE_LL read from lParam ERROR!\\n\");",
          "content_same": false
        },
        {
          "line": 694,
          "old_api": null,
          "new_api": "co_HOOK_CallHookNext",
          "old_text": null,
          "new_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Mouse)",
          "old_line_content": "            break;",
          "new_line_content": "                lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Mouse);",
          "content_same": false
        },
        {
          "line": 707,
          "old_api": null,
          "new_api": "ProbeForRead",
          "old_text": null,
          "new_text": "ProbeForRead((PVOID)lParam,\n                                 sizeof(KBDLLHOOKSTRUCT),\n                                 1)",
          "old_line_content": "                                 1);",
          "new_line_content": "                    ProbeForRead((PVOID)lParam,",
          "content_same": false
        },
        {
          "line": 1221,
          "old_api": null,
          "new_api": "SetLastWin32Error",
          "old_text": null,
          "new_text": "SetLastWin32Error(ERROR_NOT_SUPPORTED)",
          "old_line_content": "    }",
          "new_line_content": "        SetLastWin32Error(ERROR_NOT_SUPPORTED);",
          "content_same": false
        },
        {
          "line": 1222,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( NULL)",
          "old_line_content": "",
          "new_line_content": "        RETURN( NULL);",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": null,
          "new_api": "RtlCopyMemory",
          "old_text": null,
          "new_text": "RtlCopyMemory(&Keyboard,\n                                  (PVOID)lParam,\n                                  sizeof(KBDLLHOOKSTRUCT))",
          "old_line_content": "                                  sizeof(KBDLLHOOKSTRUCT));",
          "new_line_content": "                    RtlCopyMemory(&Keyboard,",
          "content_same": false
        },
        {
          "line": 1225,
          "old_api": null,
          "new_api": "PsGetCurrentProcess",
          "old_text": null,
          "new_text": "PsGetCurrentProcess()",
          "old_line_content": "                                            0,",
          "new_line_content": "    Status = IntValidateWindowStationHandle(PsGetCurrentProcess()->Win32WindowStation,",
          "content_same": false
        },
        {
          "line": 1230,
          "old_api": null,
          "new_api": "NT_SUCCESS",
          "old_text": null,
          "new_text": "NT_SUCCESS(Status)",
          "old_line_content": "        /* Dereference thread if needed */",
          "new_line_content": "    if (!NT_SUCCESS(Status))",
          "content_same": false
        },
        {
          "line": 1234,
          "old_api": null,
          "new_api": "SetLastNtError",
          "old_text": null,
          "new_text": "SetLastNtError(Status)",
          "old_line_content": "    }",
          "new_line_content": "        SetLastNtError(Status);",
          "content_same": false
        },
        {
          "line": 723,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"HOOK WH_KEYBORD_LL read from lParam ERROR!\\n\")",
          "old_line_content": "            }",
          "new_line_content": "                    DPRINT1(\"HOOK WH_KEYBORD_LL read from lParam ERROR!\\n\");",
          "content_same": false
        },
        {
          "line": 1235,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( (HANDLE) NULL)",
          "old_line_content": "",
          "new_line_content": "        RETURN( (HANDLE) NULL);",
          "content_same": false
        },
        {
          "line": 1238,
          "old_api": null,
          "new_api": "IntAddHook",
          "old_text": null,
          "new_text": "IntAddHook(Thread, HookId, Global, WinStaObj)",
          "old_line_content": "    {",
          "new_line_content": "    Hook = IntAddHook(Thread, HookId, Global, WinStaObj);",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": null,
          "new_api": "co_HOOK_CallHookNext",
          "old_text": null,
          "new_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Keyboard)",
          "old_line_content": "            break;",
          "new_line_content": "                lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Keyboard);",
          "content_same": false
        },
        {
          "line": 1243,
          "old_api": null,
          "new_api": "ObDereferenceObject",
          "old_text": null,
          "new_text": "ObDereferenceObject(WinStaObj)",
          "old_line_content": "    }",
          "new_line_content": "        ObDereferenceObject(WinStaObj);",
          "content_same": false
        },
        {
          "line": 1244,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( NULL)",
          "old_line_content": "",
          "new_line_content": "        RETURN( NULL);",
          "content_same": false
        },
        {
          "line": 1255,
          "old_api": null,
          "new_api": "MmCopyFromCaller",
          "old_text": null,
          "new_text": "MmCopyFromCaller(&ModuleName, UnsafeModuleName, sizeof(UNICODE_STRING))",
          "old_line_content": "        {",
          "new_line_content": "        Status = MmCopyFromCaller(&ModuleName, UnsafeModuleName, sizeof(UNICODE_STRING));",
          "content_same": false
        },
        {
          "line": 744,
          "old_api": null,
          "new_api": "ProbeForRead",
          "old_text": null,
          "new_text": "ProbeForRead((PVOID)lParam,\n                                 sizeof(MSG),\n                                 1)",
          "old_line_content": "                                 1);",
          "new_line_content": "                    ProbeForRead((PVOID)lParam,",
          "content_same": false
        },
        {
          "line": 748,
          "old_api": null,
          "new_api": "RtlCopyMemory",
          "old_text": null,
          "new_text": "RtlCopyMemory(&Msg,\n                                  (PVOID)lParam,\n                                  sizeof(MSG))",
          "old_line_content": "                                  sizeof(MSG));",
          "new_line_content": "                    RtlCopyMemory(&Msg,",
          "content_same": false
        },
        {
          "line": 1261,
          "old_api": null,
          "new_api": "SetLastNtError",
          "old_text": null,
          "new_text": "SetLastNtError(Status)",
          "old_line_content": "        }",
          "new_line_content": "            SetLastNtError(Status);",
          "content_same": false
        },
        {
          "line": 1262,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( NULL)",
          "old_line_content": "",
          "new_line_content": "            RETURN( NULL);",
          "content_same": false
        },
        {
          "line": 1265,
          "old_api": null,
          "new_api": "ExAllocatePoolWithTag",
          "old_text": null,
          "new_text": "ExAllocatePoolWithTag(PagedPool,\n                                                        ModuleName.MaximumLength,\n                                                        TAG_HOOK)",
          "old_line_content": "                                                        TAG_HOOK);",
          "new_line_content": "        Hook->ModuleName.Buffer = ExAllocatePoolWithTag(PagedPool,",
          "content_same": false
        },
        {
          "line": 760,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"HOOK WH_XMESSAGEX read from lParam ERROR!\\n\")",
          "old_line_content": "            }",
          "new_line_content": "                    DPRINT1(\"HOOK WH_XMESSAGEX read from lParam ERROR!\\n\");",
          "content_same": false
        },
        {
          "line": 1273,
          "old_api": null,
          "new_api": "SetLastWin32Error",
          "old_text": null,
          "new_text": "SetLastWin32Error(ERROR_NOT_ENOUGH_MEMORY)",
          "old_line_content": "        }",
          "new_line_content": "            SetLastWin32Error(ERROR_NOT_ENOUGH_MEMORY);",
          "content_same": false
        },
        {
          "line": 1274,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( NULL)",
          "old_line_content": "",
          "new_line_content": "            RETURN( NULL);",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": null,
          "new_api": "co_HOOK_CallHookNext",
          "old_text": null,
          "new_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Msg)",
          "old_line_content": "                if (lParam && (Hook->HookId == WH_GETMESSAGE))",
          "new_line_content": "                lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Msg);",
          "content_same": false
        },
        {
          "line": 1278,
          "old_api": null,
          "new_api": "MmCopyFromCaller",
          "old_text": null,
          "new_text": "MmCopyFromCaller(Hook->ModuleName.Buffer,\n                                  ModuleName.Buffer,\n                                  ModuleName.MaximumLength)",
          "old_line_content": "                                  ModuleName.MaximumLength);",
          "new_line_content": "        Status = MmCopyFromCaller(Hook->ModuleName.Buffer,",
          "content_same": false
        },
        {
          "line": 772,
          "old_api": null,
          "new_api": "ProbeForWrite",
          "old_text": null,
          "new_text": "ProbeForWrite((PVOID)lParam,\n                                      sizeof(MSG),\n                                      1)",
          "old_line_content": "                                      1);",
          "new_line_content": "                        ProbeForWrite((PVOID)lParam,",
          "content_same": false
        },
        {
          "line": 1287,
          "old_api": null,
          "new_api": "SetLastNtError",
          "old_text": null,
          "new_text": "SetLastNtError(Status)",
          "old_line_content": "        }",
          "new_line_content": "            SetLastNtError(Status);",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": null,
          "new_api": "RtlCopyMemory",
          "old_text": null,
          "new_text": "RtlCopyMemory((PVOID)lParam,\n                                      &Msg,\n                                      sizeof(MSG))",
          "old_line_content": "                                      sizeof(MSG));",
          "new_line_content": "                        RtlCopyMemory((PVOID)lParam,",
          "content_same": false
        },
        {
          "line": 1288,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( NULL)",
          "old_line_content": "",
          "new_line_content": "            RETURN( NULL);",
          "content_same": false
        },
        {
          "line": 1299,
          "old_api": null,
          "new_api": "UserHMGetHandle",
          "old_text": null,
          "new_text": "UserHMGetHandle(Hook)",
          "old_line_content": "    /* Clear the client threads next hook. */",
          "new_line_content": "    Handle = UserHMGetHandle(Hook);",
          "content_same": false
        },
        {
          "line": 788,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"HOOK WH_GETMESSAGE write to lParam ERROR!\\n\")",
          "old_line_content": "                }",
          "new_line_content": "                        DPRINT1(\"HOOK WH_GETMESSAGE write to lParam ERROR!\\n\");",
          "content_same": false
        },
        {
          "line": 796,
          "old_api": null,
          "new_api": "DPRINT",
          "old_text": null,
          "new_text": "DPRINT(\"HOOK WH_CBT!\\n\")",
          "old_line_content": "            {",
          "new_line_content": "            DPRINT(\"HOOK WH_CBT!\\n\");",
          "content_same": false
        },
        {
          "line": 1308,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( Handle)",
          "old_line_content": "CLEANUP:",
          "new_line_content": "    RETURN( Handle);",
          "content_same": false
        },
        {
          "line": 1311,
          "old_api": null,
          "new_api": "DPRINT",
          "old_text": null,
          "new_text": "DPRINT(\"Leave NtUserSetWindowsHookEx, ret=%i\\n\",_ret_)",
          "old_line_content": "    END_CLEANUP;",
          "new_line_content": "    DPRINT(\"Leave NtUserSetWindowsHookEx, ret=%i\\n\",_ret_);",
          "content_same": false
        },
        {
          "line": 1312,
          "old_api": null,
          "new_api": "UserLeave",
          "old_text": null,
          "new_text": "UserLeave()",
          "old_line_content": "}",
          "new_line_content": "    UserLeave();",
          "content_same": false
        },
        {
          "line": 803,
          "old_api": null,
          "new_api": "DPRINT",
          "old_text": null,
          "new_text": "DPRINT(\"HOOK HCBT_CREATEWND\\n\")",
          "old_line_content": "                    {",
          "new_line_content": "                    DPRINT(\"HOOK HCBT_CREATEWND\\n\");",
          "content_same": false
        },
        {
          "line": 1329,
          "old_api": null,
          "new_api": "PsGetCurrentProcess",
          "old_text": null,
          "new_text": "PsGetCurrentProcess()",
          "old_line_content": "                                            0,",
          "new_line_content": "    Status = IntValidateWindowStationHandle(PsGetCurrentProcess()->Win32WindowStation,",
          "content_same": false
        },
        {
          "line": 820,
          "old_api": null,
          "new_api": "ProbeForRead",
          "old_text": null,
          "new_text": "ProbeForRead( pcbtcww->lpcs->lpszClass,\n                                             sizeof(CHAR),\n                                             1)",
          "old_line_content": "                                             1);",
          "new_line_content": "                               ProbeForRead( pcbtcww->lpcs->lpszClass,",
          "content_same": false
        },
        {
          "line": 1336,
          "old_api": null,
          "new_api": "SetLastNtError",
          "old_text": null,
          "new_text": "SetLastNtError(Status)",
          "old_line_content": "    }",
          "new_line_content": "        SetLastNtError(Status);",
          "content_same": false
        },
        {
          "line": 1337,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( FALSE)",
          "old_line_content": "",
          "new_line_content": "        RETURN( FALSE);",
          "content_same": false
        },
        {
          "line": 1344,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"Invalid handle passed to NtUserUnhookWindowsHookEx\\n\")",
          "old_line_content": "        /* SetLastNtError(Status); */",
          "new_line_content": "        DPRINT1(\"Invalid handle passed to NtUserUnhookWindowsHookEx\\n\");",
          "content_same": false
        },
        {
          "line": 833,
          "old_api": null,
          "new_api": "ProbeForRead",
          "old_text": null,
          "new_text": "ProbeForRead( pcbtcww->lpcs->lpszName,\n                                          sizeof(WCHAR),\n                                          1)",
          "old_line_content": "                                          1);",
          "new_line_content": "                            ProbeForRead( pcbtcww->lpcs->lpszName,",
          "content_same": false
        },
        {
          "line": 1347,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( FALSE)",
          "old_line_content": "",
          "new_line_content": "        RETURN( FALSE);",
          "content_same": false
        },
        {
          "line": 839,
          "old_api": null,
          "new_api": "ProbeForRead",
          "old_text": null,
          "new_text": "ProbeForRead( pcbtcww->lpcs->lpszClass,\n                                             sizeof(WCHAR),\n                                             1)",
          "old_line_content": "                                             1);",
          "new_line_content": "                               ProbeForRead( pcbtcww->lpcs->lpszClass,",
          "content_same": false
        },
        {
          "line": 1354,
          "old_api": null,
          "new_api": "UserDereferenceObject",
          "old_text": null,
          "new_text": "UserDereferenceObject(HookObj)",
          "old_line_content": "",
          "new_line_content": "    UserDereferenceObject(HookObj);",
          "content_same": false
        },
        {
          "line": 1357,
          "old_api": null,
          "new_api": "RETURN",
          "old_text": null,
          "new_text": "RETURN( TRUE)",
          "old_line_content": "CLEANUP:",
          "new_line_content": "    RETURN( TRUE);",
          "content_same": false
        },
        {
          "line": 1360,
          "old_api": null,
          "new_api": "DPRINT",
          "old_text": null,
          "new_text": "DPRINT(\"Leave NtUserUnhookWindowsHookEx, ret=%i\\n\",_ret_)",
          "old_line_content": "    END_CLEANUP;",
          "new_line_content": "    DPRINT(\"Leave NtUserUnhookWindowsHookEx, ret=%i\\n\",_ret_);",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": null,
          "new_api": "ISITHOOKED",
          "old_text": null,
          "new_text": "ISITHOOKED(HookId)",
          "old_line_content": "    {",
          "new_line_content": "    if (!ISITHOOKED(HookId))",
          "content_same": false
        },
        {
          "line": 1361,
          "old_api": null,
          "new_api": "UserLeave",
          "old_text": null,
          "new_text": "UserLeave()",
          "old_line_content": "}",
          "new_line_content": "    UserLeave();",
          "content_same": false
        },
        {
          "line": 853,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"HOOK HCBT_CREATEWND write ERROR!\\n\")",
          "old_line_content": "                    /* The next call handles the structures. */",
          "new_line_content": "                        DPRINT1(\"HOOK HCBT_CREATEWND write ERROR!\\n\");",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": null,
          "new_api": "PsGetCurrentThreadWin32Thread",
          "old_text": null,
          "new_text": "PsGetCurrentThreadWin32Thread()",
          "old_line_content": "    {",
          "new_line_content": "    pti = PsGetCurrentThreadWin32Thread();",
          "content_same": false
        },
        {
          "line": 858,
          "old_api": null,
          "new_api": "co_HOOK_CallHookNext",
          "old_text": null,
          "new_text": "co_HOOK_CallHookNext(Hook, Code, wParam, lParam)",
          "old_line_content": "                    break;",
          "new_line_content": "                       lResult = co_HOOK_CallHookNext(Hook, Code, wParam, lParam);",
          "content_same": false
        },
        {
          "line": 350,
          "old_api": null,
          "new_api": "MsqGetHooks",
          "old_text": null,
          "new_text": "MsqGetHooks(pti->MessageQueue)",
          "old_line_content": "",
          "new_line_content": "        Table = MsqGetHooks(pti->MessageQueue);",
          "content_same": false
        },
        {
          "line": 353,
          "old_api": null,
          "new_api": "IntGetFirstValidHook",
          "old_text": null,
          "new_text": "IntGetFirstValidHook(Table, HookId)",
          "old_line_content": "        /* try global table */",
          "new_line_content": "    if (NULL == Table || ! (Hook = IntGetFirstValidHook(Table, HookId)))",
          "content_same": false
        },
        {
          "line": 867,
          "old_api": null,
          "new_api": "DPRINT",
          "old_text": null,
          "new_text": "DPRINT(\"HOOK HCBT_MOVESIZE\\n\")",
          "old_line_content": "                    if (lParam)",
          "new_line_content": "                    DPRINT(\"HOOK HCBT_MOVESIZE\\n\");",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": null,
          "new_api": "IntGetFirstValidHook",
          "old_text": null,
          "new_text": "IntGetFirstValidHook(Table, HookId)",
          "old_line_content": "            return 0;  /* no hook set */",
          "new_line_content": "        if (NULL == Table || ! (Hook = IntGetFirstValidHook(Table, HookId)))",
          "content_same": false
        },
        {
          "line": 873,
          "old_api": null,
          "new_api": "ProbeForRead",
          "old_text": null,
          "new_text": "ProbeForRead((PVOID)lParam,\n                                         sizeof(RECT),\n                                         1)",
          "old_line_content": "                                         1);",
          "new_line_content": "                            ProbeForRead((PVOID)lParam,",
          "content_same": false
        },
        {
          "line": 877,
          "old_api": null,
          "new_api": "RtlCopyMemory",
          "old_text": null,
          "new_text": "RtlCopyMemory(&rt,\n                                          (PVOID)lParam,\n                                          sizeof(RECT))",
          "old_line_content": "                                          sizeof(RECT));",
          "new_line_content": "                            RtlCopyMemory(&rt,",
          "content_same": false
        },
        {
          "line": 367,
          "old_api": null,
          "new_api": "IntCallLowLevelHook",
          "old_text": null,
          "new_text": "IntCallLowLevelHook(Hook, Code, wParam, lParam)",
          "old_line_content": "",
          "new_line_content": "        return IntCallLowLevelHook(Hook, Code, wParam, lParam);",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": null,
          "new_api": "HOOKID_TO_INDEX",
          "old_text": null,
          "new_text": "HOOKID_TO_INDEX(HookId)",
          "old_line_content": "    {",
          "new_line_content": "    Table->Counts[HOOKID_TO_INDEX(HookId)]++;",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": null,
          "new_api": "HOOKID_TO_INDEX",
          "old_text": null,
          "new_text": "HOOKID_TO_INDEX(HookId)",
          "old_line_content": "",
          "new_line_content": "        GlobalHooks->Counts[HOOKID_TO_INDEX(HookId)]++;",
          "content_same": false
        },
        {
          "line": 376,
          "old_api": null,
          "new_api": "GetWin32ClientInfo",
          "old_text": null,
          "new_text": "GetWin32ClientInfo()",
          "old_line_content": "    ClientInfo->phkCurrent = Hook;     /* Load the call. */",
          "new_line_content": "    ClientInfo = GetWin32ClientInfo();",
          "content_same": false
        },
        {
          "line": 889,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"HOOK HCBT_MOVESIZE read from lParam ERROR!\\n\")",
          "old_line_content": "                    }",
          "new_line_content": "                            DPRINT1(\"HOOK HCBT_MOVESIZE read from lParam ERROR!\\n\");",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": null,
          "new_api": "co_IntCallHookProc",
          "old_text": null,
          "new_text": "co_IntCallHookProc(HookId,\n                                Code,\n                                wParam,\n                                lParam,\n                                Hook->Proc,\n                                Hook->Ansi,\n                                &Hook->ModuleName)",
          "old_line_content": "                                wParam,",
          "new_line_content": "    Result = co_IntCallHookProc(HookId,",
          "content_same": false
        },
        {
          "line": 895,
          "old_api": null,
          "new_api": "co_HOOK_CallHookNext",
          "old_text": null,
          "new_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&rt)",
          "old_line_content": "                    break;",
          "new_line_content": "                        lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&rt);",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": null,
          "new_api": "PsGetCurrentProcess",
          "old_text": null,
          "new_text": "PsGetCurrentProcess()",
          "old_line_content": "                                            0,",
          "new_line_content": "    Status = IntValidateWindowStationHandle(PsGetCurrentProcess()->Win32WindowStation,",
          "content_same": false
        },
        {
          "line": 904,
          "old_api": null,
          "new_api": "DPRINT",
          "old_text": null,
          "new_text": "DPRINT(\"HOOK HCBT_ACTIVATE\\n\")",
          "old_line_content": "                    {",
          "new_line_content": "                    DPRINT(\"HOOK HCBT_ACTIVATE\\n\");",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"Invalid window station????\\n\")",
          "old_line_content": "    else",
          "new_line_content": "        DPRINT1(\"Invalid window station????\\n\");",
          "content_same": false
        },
        {
          "line": 909,
          "old_api": null,
          "new_api": "ProbeForRead",
          "old_text": null,
          "new_text": "ProbeForRead((PVOID)lParam,\n                                         sizeof(CBTACTIVATESTRUCT),\n                                         1)",
          "old_line_content": "                                         1);",
          "new_line_content": "                            ProbeForRead((PVOID)lParam,",
          "content_same": false
        },
        {
          "line": 913,
          "old_api": null,
          "new_api": "RtlCopyMemory",
          "old_text": null,
          "new_text": "RtlCopyMemory(&CbAs,\n                                          (PVOID)lParam,\n                                          sizeof(CBTACTIVATESTRUCT))",
          "old_line_content": "                                          sizeof(CBTACTIVATESTRUCT));",
          "new_line_content": "                            RtlCopyMemory(&CbAs,",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": null,
          "new_api": "IntReleaseHookChain",
          "old_text": null,
          "new_text": "IntReleaseHookChain(GlobalHooks, HookId, WinStaObj)",
          "old_line_content": "    }",
          "new_line_content": "        IntReleaseHookChain(GlobalHooks, HookId, WinStaObj);",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": null,
          "new_api": "ObDereferenceObject",
          "old_text": null,
          "new_text": "ObDereferenceObject(WinStaObj)",
          "old_line_content": "",
          "new_line_content": "        ObDereferenceObject(WinStaObj);",
          "content_same": false
        },
        {
          "line": 925,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"HOOK HCBT_ACTIVATE read from lParam ERROR!\\n\")",
          "old_line_content": "                    }",
          "new_line_content": "                            DPRINT1(\"HOOK HCBT_ACTIVATE read from lParam ERROR!\\n\");",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": null,
          "new_api": "co_HOOK_CallHookNext",
          "old_text": null,
          "new_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&CbAs)",
          "old_line_content": "                    break;",
          "new_line_content": "                        lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&CbAs);",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": null,
          "new_api": "PsGetCurrentProcess",
          "old_text": null,
          "new_text": "PsGetCurrentProcess()",
          "old_line_content": "                                                0,",
          "new_line_content": "        Status = IntValidateWindowStationHandle(PsGetCurrentProcess()->Win32WindowStation,",
          "content_same": false
        },
        {
          "line": 938,
          "old_api": null,
          "new_api": "DPRINT",
          "old_text": null,
          "new_text": "DPRINT(\"HOOK HCBT_ %d\\n\",Code)",
          "old_line_content": "                    break;",
          "new_line_content": "                    DPRINT(\"HOOK HCBT_ %d\\n\",Code);",
          "content_same": false
        },
        {
          "line": 939,
          "old_api": null,
          "new_api": "co_HOOK_CallHookNext",
          "old_text": null,
          "new_text": "co_HOOK_CallHookNext(Hook, Code, wParam, lParam)",
          "old_line_content": "            }",
          "new_line_content": "                    lResult = co_HOOK_CallHookNext(Hook, Code, wParam, lParam);",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"Invalid window station????\\n\")",
          "old_line_content": "        }",
          "new_line_content": "            DPRINT1(\"Invalid window station????\\n\");",
          "content_same": false
        },
        {
          "line": 953,
          "old_api": null,
          "new_api": "ProbeForRead",
          "old_text": null,
          "new_text": "ProbeForRead((PVOID)lParam,\n                                 sizeof(EVENTMSG),\n                                 1)",
          "old_line_content": "                                 1);",
          "new_line_content": "                    ProbeForRead((PVOID)lParam,",
          "content_same": false
        },
        {
          "line": 443,
          "old_api": null,
          "new_api": "CONTAINING_RECORD",
          "old_text": null,
          "new_text": "CONTAINING_RECORD(Elem, HOOK, Chain)",
          "old_line_content": "",
          "new_line_content": "                        HookObj = CONTAINING_RECORD(Elem, HOOK, Chain);",
          "content_same": false
        },
        {
          "line": 957,
          "old_api": null,
          "new_api": "RtlCopyMemory",
          "old_text": null,
          "new_text": "RtlCopyMemory(&EventMsg,\n                                  (PVOID)lParam,\n                                  sizeof(EVENTMSG))",
          "old_line_content": "                                  sizeof(EVENTMSG));",
          "new_line_content": "                    RtlCopyMemory(&EventMsg,",
          "content_same": false
        },
        {
          "line": 448,
          "old_api": null,
          "new_api": "IntRemoveHook",
          "old_text": null,
          "new_text": "IntRemoveHook(HookObj, WinStaObj, TRUE)",
          "old_line_content": "                    }",
          "new_line_content": "                            IntRemoveHook(HookObj, WinStaObj, TRUE);",
          "content_same": false
        },
        {
          "line": 969,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"HOOK WH_JOURNAL read from lParam ERROR!\\n\")",
          "old_line_content": "            }",
          "new_line_content": "                    DPRINT1(\"HOOK WH_JOURNAL read from lParam ERROR!\\n\");",
          "content_same": false
        },
        {
          "line": 975,
          "old_api": null,
          "new_api": "LPARAM)(lParam ? &EventMsg : NULL)",
          "old_text": null,
          "new_text": "LPARAM)(lParam ? &EventMsg : NULL)",
          "old_line_content": "                if (lParam)",
          "new_line_content": "                lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)(lParam ? &EventMsg : NULL));",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"CALLING HOOK from another Thread. %d\\n\", Hook->HookId)",
          "old_line_content": "    }",
          "new_line_content": "        DPRINT1(\"CALLING HOOK from another Thread. %d\\n\", Hook->HookId);",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": null,
          "new_api": "IntCallLowLevelHook",
          "old_text": null,
          "new_text": "IntCallLowLevelHook(Hook, Code, wParam, lParam)",
          "old_line_content": "",
          "new_line_content": "        return IntCallLowLevelHook(Hook, Code, wParam, lParam);",
          "content_same": false
        },
        {
          "line": 981,
          "old_api": null,
          "new_api": "ProbeForWrite",
          "old_text": null,
          "new_text": "ProbeForWrite((PVOID)lParam,\n                                      sizeof(EVENTMSG),\n                                      1)",
          "old_line_content": "                                      1);",
          "new_line_content": "                        ProbeForWrite((PVOID)lParam,",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": null,
          "new_api": "co_IntCallHookProc",
          "old_text": null,
          "new_text": "co_IntCallHookProc(Hook->HookId,\n                              Code,\n                              wParam,\n                              lParam,\n                              Hook->Proc,\n                              Hook->Ansi,\n                              &Hook->ModuleName)",
          "old_line_content": "                              wParam,",
          "new_line_content": "    return co_IntCallHookProc(Hook->HookId,",
          "content_same": false
        },
        {
          "line": 985,
          "old_api": null,
          "new_api": "RtlCopyMemory",
          "old_text": null,
          "new_text": "RtlCopyMemory((PVOID)lParam,\n                                      &EventMsg,\n                                      sizeof(EVENTMSG))",
          "old_line_content": "                                      sizeof(EVENTMSG));",
          "new_line_content": "                        RtlCopyMemory((PVOID)lParam,",
          "content_same": false
        },
        {
          "line": 997,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"HOOK WH_JOURNAL write to lParam ERROR!\\n\")",
          "old_line_content": "                }",
          "new_line_content": "                        DPRINT1(\"HOOK WH_JOURNAL write to lParam ERROR!\\n\");",
          "content_same": false
        },
        {
          "line": 1005,
          "old_api": null,
          "new_api": "IntCallDebugHook",
          "old_text": null,
          "new_text": "IntCallDebugHook(Hook, Code, wParam, lParam)",
          "old_line_content": "",
          "new_line_content": "            lResult = IntCallDebugHook(Hook, Code, wParam, lParam);",
          "content_same": false
        },
        {
          "line": 497,
          "old_api": null,
          "new_api": "ProbeForRead",
          "old_text": null,
          "new_text": "ProbeForRead((PVOID)lParam,\n                         sizeof(DEBUGHOOKINFO),\n                         1)",
          "old_line_content": "                         1);",
          "new_line_content": "            ProbeForRead((PVOID)lParam,",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": null,
          "new_api": "RtlCopyMemory",
          "old_text": null,
          "new_text": "RtlCopyMemory(&Debug,\n                          (PVOID)lParam,\n                          sizeof(DEBUGHOOKINFO))",
          "old_line_content": "                          sizeof(DEBUGHOOKINFO));",
          "new_line_content": "            RtlCopyMemory(&Debug,",
          "content_same": false
        },
        {
          "line": 1014,
          "old_api": null,
          "new_api": "co_HOOK_CallHookNext",
          "old_text": null,
          "new_text": "co_HOOK_CallHookNext(Hook, Code, wParam, lParam)",
          "old_line_content": "",
          "new_line_content": "            lResult = co_HOOK_CallHookNext(Hook, Code, wParam, lParam);      ",
          "content_same": false
        },
        {
          "line": 1018,
          "old_api": null,
          "new_api": "DPRINT1",
          "old_text": null,
          "new_text": "DPRINT1(\"Unsupported HOOK Id -> %d\\n\",Hook->HookId)",
          "old_line_content": "    }",
          "new_line_content": "            DPRINT1(\"Unsupported HOOK Id -> %d\\n\",Hook->HookId);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1034,
          "old_api": "DECLARE_RETURN",
          "new_api": null,
          "old_text": "DECLARE_RETURN(LRESULT)",
          "new_text": null,
          "old_line_content": "    DECLARE_RETURN(LRESULT);",
          "new_line_content": "    PWINSTATION_OBJECT WinStaObj;",
          "content_same": false
        },
        {
          "line": 1037,
          "old_api": "UserEnterExclusive",
          "new_api": null,
          "old_text": "UserEnterExclusive()",
          "new_text": null,
          "old_line_content": "    UserEnterExclusive();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1043,
          "old_api": "NT_SUCCESS",
          "new_api": null,
          "old_text": "NT_SUCCESS(Status)",
          "new_text": null,
          "old_line_content": "    if (!NT_SUCCESS(Status))",
          "new_line_content": "                                            0,",
          "content_same": false
        },
        {
          "line": 1046,
          "old_api": "RETURN",
          "new_api": null,
          "old_text": "RETURN( 0)",
          "new_text": null,
          "old_line_content": "        RETURN( 0);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 1049,
          "old_api": "ObDereferenceObject",
          "new_api": null,
          "old_text": "ObDereferenceObject(WinStaObj)",
          "new_text": null,
          "old_line_content": "    ObDereferenceObject(WinStaObj);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1057,
          "old_api": "RETURN",
          "new_api": null,
          "old_text": "RETURN( 0)",
          "new_text": null,
          "old_line_content": "    if (!HookObj) RETURN( 0);",
          "new_line_content": "    HookObj = ClientInfo->phkCurrent;",
          "content_same": false
        },
        {
          "line": 1060,
          "old_api": "IntGetTable",
          "new_api": null,
          "old_text": "IntGetTable(HookObj)",
          "new_text": null,
          "old_line_content": "    NextObj = IntGetFirstHook(IntGetTable(HookObj), HookObj->HookId);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1063,
          "old_api": "RETURN",
          "new_api": null,
          "old_text": "RETURN(0)",
          "new_text": null,
          "old_line_content": "    if (HookObj == NextObj) RETURN(0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1069,
          "old_api": "PsGetCurrentThread",
          "new_api": null,
          "old_text": "PsGetCurrentThread()",
          "new_text": null,
          "old_line_content": "    if (NULL != HookObj->Thread && (HookObj->Thread != PsGetCurrentThread()))",
          "new_line_content": "    Ansi = HookObj->Ansi;",
          "content_same": false
        },
        {
          "line": 1072,
          "old_api": "UserDereferenceObject",
          "new_api": null,
          "old_text": "UserDereferenceObject(HookObj)",
          "new_text": null,
          "old_line_content": "        UserDereferenceObject(HookObj);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 1077,
          "old_api": "IntGetNextHook",
          "new_api": null,
          "old_text": "IntGetNextHook(HookObj)",
          "new_text": null,
          "old_line_content": "    NextObj = IntGetNextHook(HookObj);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1080,
          "old_api": "UserDereferenceObject",
          "new_api": null,
          "old_text": "UserDereferenceObject(HookObj)",
          "new_text": null,
          "old_line_content": "    UserDereferenceObject(HookObj);",
          "new_line_content": "    ClientInfo->phkCurrent = NextObj; /* Preset next hook from list. */",
          "content_same": false
        },
        {
          "line": 1085,
          "old_api": "DPRINT",
          "new_api": null,
          "old_text": "DPRINT(\"Leave NtUserCallNextHookEx, ret=%i\\n\",_ret_)",
          "new_text": null,
          "old_line_content": "    DPRINT(\"Leave NtUserCallNextHookEx, ret=%i\\n\",_ret_);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1086,
          "old_api": "UserLeave",
          "new_api": null,
          "old_text": "UserLeave()",
          "new_text": null,
          "old_line_content": "    UserLeave();",
          "new_line_content": "CLEANUP:",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": "ExAllocatePoolWithTag",
          "new_api": null,
          "old_text": "ExAllocatePoolWithTag(NonPagedPool, Size, TAG_HOOK)",
          "new_text": null,
          "old_line_content": "        HooklParam = ExAllocatePoolWithTag(NonPagedPool, Size, TAG_HOOK);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 580,
          "old_api": "ProbeForRead",
          "new_api": null,
          "old_text": "ProbeForRead((PVOID)Debug.lParam,\n                         Size,\n                         1)",
          "new_text": null,
          "old_line_content": "            ProbeForRead((PVOID)Debug.lParam,",
          "new_line_content": "        _SEH2_TRY",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": "RtlCopyMemory",
          "new_api": null,
          "old_text": "RtlCopyMemory(HooklParam,\n                          (PVOID)Debug.lParam,\n                          Size)",
          "new_text": null,
          "old_line_content": "            RtlCopyMemory(HooklParam,",
          "new_line_content": "                         1);",
          "content_same": false
        },
        {
          "line": 1098,
          "old_api": "RtlInitUnicodeString",
          "new_api": null,
          "old_text": "RtlInitUnicodeString(&USModuleName, NULL)",
          "new_text": null,
          "old_line_content": "    RtlInitUnicodeString(&USModuleName, NULL);",
          "new_line_content": "    UNICODE_STRING USModuleName;",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"HOOK WH_DEBUG read from Debug.lParam ERROR!\\n\")",
          "new_text": null,
          "old_line_content": "            DPRINT1(\"HOOK WH_DEBUG read from Debug.lParam ERROR!\\n\");",
          "new_line_content": "        if (BadChk)",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "ExFreePool",
          "new_api": null,
          "old_text": "ExFreePool(HooklParam)",
          "new_text": null,
          "old_line_content": "            ExFreePool(HooklParam);",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 603,
          "old_api": "co_HOOK_CallHookNext",
          "new_api": null,
          "old_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Debug)",
          "new_text": null,
          "old_line_content": "    lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Debug);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 604,
          "old_api": "ExFreePoolWithTag",
          "new_api": null,
          "old_text": "ExFreePoolWithTag(HooklParam, TAG_HOOK)",
          "new_text": null,
          "old_line_content": "    if (HooklParam) ExFreePoolWithTag(HooklParam, TAG_HOOK);",
          "new_line_content": "    if (HooklParam) Debug.lParam = (LPARAM)HooklParam;",
          "content_same": false
        },
        {
          "line": 1124,
          "old_api": "UserEnterExclusive",
          "new_api": null,
          "old_text": "UserEnterExclusive()",
          "new_text": null,
          "old_line_content": "    UserEnterExclusive();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1128,
          "old_api": "SetLastWin32Error",
          "new_api": null,
          "old_text": "SetLastWin32Error(ERROR_INVALID_PARAMETER)",
          "new_text": null,
          "old_line_content": "        SetLastWin32Error(ERROR_INVALID_PARAMETER);",
          "new_line_content": "    if (HookId < WH_MINHOOK || WH_MAXHOOK < HookId )",
          "content_same": false
        },
        {
          "line": 1129,
          "old_api": "RETURN",
          "new_api": null,
          "old_text": "RETURN( NULL)",
          "new_text": null,
          "old_line_content": "        RETURN( NULL);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 1134,
          "old_api": "SetLastWin32Error",
          "new_api": null,
          "old_text": "SetLastWin32Error(ERROR_INVALID_FILTER_PROC)",
          "new_text": null,
          "old_line_content": "        SetLastWin32Error(ERROR_INVALID_FILTER_PROC);",
          "new_line_content": "    if (!HookProc)",
          "content_same": false
        },
        {
          "line": 1135,
          "old_api": "RETURN",
          "new_api": null,
          "old_text": "RETURN( NULL)",
          "new_text": null,
          "old_line_content": "        RETURN( NULL);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 1138,
          "old_api": "GetWin32ClientInfo",
          "new_api": null,
          "old_text": "GetWin32ClientInfo()",
          "new_text": null,
          "old_line_content": "    ClientInfo = GetWin32ClientInfo();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 632,
          "old_api": "ProbeForRead",
          "new_api": null,
          "old_text": "ProbeForRead((PVOID)lParam,\n                             sizeof(MOUSEHOOKSTRUCTEX),\n                             1)",
          "new_text": null,
          "old_line_content": "                ProbeForRead((PVOID)lParam,",
          "new_line_content": "            _SEH2_TRY",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": "RtlCopyMemory",
          "new_api": null,
          "old_text": "RtlCopyMemory(&Mouse,\n                              (PVOID)lParam,\n                              sizeof(MOUSEHOOKSTRUCTEX))",
          "new_text": null,
          "old_line_content": "                RtlCopyMemory(&Mouse,",
          "new_line_content": "                             1);",
          "content_same": false
        },
        {
          "line": 1149,
          "old_api": "SetLastWin32Error",
          "new_api": null,
          "old_text": "SetLastWin32Error(ERROR_INVALID_PARAMETER)",
          "new_text": null,
          "old_line_content": "            SetLastWin32Error(ERROR_INVALID_PARAMETER);",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 1150,
          "old_api": "RETURN",
          "new_api": null,
          "old_text": "RETURN( NULL)",
          "new_text": null,
          "old_line_content": "            RETURN( NULL);",
          "new_line_content": "            /* these can only be global */",
          "content_same": false
        },
        {
          "line": 1156,
          "old_api": "PsLookupThreadByThreadId",
          "new_api": null,
          "old_text": "PsLookupThreadByThreadId((HANDLE)(DWORD_PTR) ThreadId, &Thread)",
          "new_text": null,
          "old_line_content": "        if (!NT_SUCCESS(PsLookupThreadByThreadId((HANDLE)(DWORD_PTR) ThreadId, &Thread)))",
          "new_line_content": "        Global = FALSE;",
          "content_same": false
        },
        {
          "line": 1159,
          "old_api": "SetLastWin32Error",
          "new_api": null,
          "old_text": "SetLastWin32Error(ERROR_INVALID_PARAMETER)",
          "new_text": null,
          "old_line_content": "            SetLastWin32Error(ERROR_INVALID_PARAMETER);",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 648,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"HOOK WH_MOUSE read from lParam ERROR!\\n\")",
          "new_text": null,
          "old_line_content": "                DPRINT1(\"HOOK WH_MOUSE read from lParam ERROR!\\n\");",
          "new_line_content": "            if (BadChk)",
          "content_same": false
        },
        {
          "line": 1165,
          "old_api": "PsGetCurrentProcess",
          "new_api": null,
          "old_text": "PsGetCurrentProcess()",
          "new_text": null,
          "old_line_content": "        if (Thread->ThreadsProcess != PsGetCurrentProcess())",
          "new_line_content": "        /* Thread was referenced */",
          "content_same": false
        },
        {
          "line": 654,
          "old_api": "co_HOOK_CallHookNext",
          "new_api": null,
          "old_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Mouse)",
          "new_text": null,
          "old_line_content": "            lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Mouse);",
          "new_line_content": "        if (!BadChk)",
          "content_same": false
        },
        {
          "line": 1168,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"Can't specify thread belonging to another process\\n\")",
          "new_text": null,
          "old_line_content": "            DPRINT1(\"Can't specify thread belonging to another process\\n\");",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 1178,
          "old_api": "PsGetCurrentThread",
          "new_api": null,
          "old_text": "PsGetCurrentThread()",
          "new_text": null,
          "old_line_content": "            Thread = PsGetCurrentThread();",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": "ProbeForRead",
          "new_api": null,
          "old_text": "ProbeForRead((PVOID)lParam,\n                                 sizeof(MSLLHOOKSTRUCT),\n                                 1)",
          "new_text": null,
          "old_line_content": "                    ProbeForRead((PVOID)lParam,",
          "new_line_content": "                _SEH2_TRY",
          "content_same": false
        },
        {
          "line": 1185,
          "old_api": "NT_SUCCESS",
          "new_api": null,
          "old_text": "NT_SUCCESS(Status)",
          "new_text": null,
          "old_line_content": "            if (!NT_SUCCESS(Status))",
          "new_line_content": "                                                KernelMode);",
          "content_same": false
        },
        {
          "line": 674,
          "old_api": "RtlCopyMemory",
          "new_api": null,
          "old_text": "RtlCopyMemory(&Mouse,\n                                  (PVOID)lParam,\n                                  sizeof(MSLLHOOKSTRUCT))",
          "new_text": null,
          "old_line_content": "                    RtlCopyMemory(&Mouse,",
          "new_line_content": "                                 1);",
          "content_same": false
        },
        {
          "line": 1188,
          "old_api": "RETURN",
          "new_api": null,
          "old_text": "RETURN( (HANDLE) NULL)",
          "new_text": null,
          "old_line_content": "                RETURN( (HANDLE) NULL);",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 1196,
          "old_api": "SetLastWin32Error",
          "new_api": null,
          "old_text": "SetLastWin32Error(ERROR_HOOK_NEEDS_HMOD)",
          "new_text": null,
          "old_line_content": "            SetLastWin32Error(ERROR_HOOK_NEEDS_HMOD);",
          "new_line_content": "        else if (NULL ==  Mod)",
          "content_same": false
        },
        {
          "line": 1197,
          "old_api": "RETURN",
          "new_api": null,
          "old_text": "RETURN( NULL)",
          "new_text": null,
          "old_line_content": "            RETURN( NULL);",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 686,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"HOOK WH_MOUSE_LL read from lParam ERROR!\\n\")",
          "new_text": null,
          "old_line_content": "                    DPRINT1(\"HOOK WH_MOUSE_LL read from lParam ERROR!\\n\");",
          "new_line_content": "                if (BadChk)",
          "content_same": false
        },
        {
          "line": 692,
          "old_api": "co_HOOK_CallHookNext",
          "new_api": null,
          "old_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Mouse)",
          "new_text": null,
          "old_line_content": "                lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Mouse);",
          "new_line_content": "            if (!BadChk)",
          "content_same": false
        },
        {
          "line": 705,
          "old_api": "ProbeForRead",
          "new_api": null,
          "old_text": "ProbeForRead((PVOID)lParam,\n                                 sizeof(KBDLLHOOKSTRUCT),\n                                 1)",
          "new_text": null,
          "old_line_content": "                    ProbeForRead((PVOID)lParam,",
          "new_line_content": "                _SEH2_TRY",
          "content_same": false
        },
        {
          "line": 1218,
          "old_api": "ObDereferenceObject",
          "new_api": null,
          "old_text": "ObDereferenceObject(Thread)",
          "new_text": null,
          "old_line_content": "        if (ThreadReferenced) ObDereferenceObject(Thread);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1219,
          "old_api": "SetLastWin32Error",
          "new_api": null,
          "old_text": "SetLastWin32Error(ERROR_NOT_SUPPORTED)",
          "new_text": null,
          "old_line_content": "        SetLastWin32Error(ERROR_NOT_SUPPORTED);",
          "new_line_content": "        /* Dereference thread if needed */",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": "RtlCopyMemory",
          "new_api": null,
          "old_text": "RtlCopyMemory(&Keyboard,\n                                  (PVOID)lParam,\n                                  sizeof(KBDLLHOOKSTRUCT))",
          "new_text": null,
          "old_line_content": "                    RtlCopyMemory(&Keyboard,",
          "new_line_content": "                                 1);",
          "content_same": false
        },
        {
          "line": 1223,
          "old_api": "PsGetCurrentProcess",
          "new_api": null,
          "old_text": "PsGetCurrentProcess()",
          "new_text": null,
          "old_line_content": "    Status = IntValidateWindowStationHandle(PsGetCurrentProcess()->Win32WindowStation,",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1228,
          "old_api": "NT_SUCCESS",
          "new_api": null,
          "old_text": "NT_SUCCESS(Status)",
          "new_text": null,
          "old_line_content": "    if (!NT_SUCCESS(Status))",
          "new_line_content": "                                            &WinStaObj);",
          "content_same": false
        },
        {
          "line": 1231,
          "old_api": "ObDereferenceObject",
          "new_api": null,
          "old_text": "ObDereferenceObject(Thread)",
          "new_text": null,
          "old_line_content": "        if (ThreadReferenced) ObDereferenceObject(Thread);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 1232,
          "old_api": "SetLastNtError",
          "new_api": null,
          "old_text": "SetLastNtError(Status)",
          "new_text": null,
          "old_line_content": "        SetLastNtError(Status);",
          "new_line_content": "        /* Dereference thread if needed */",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"HOOK WH_KEYBORD_LL read from lParam ERROR!\\n\")",
          "new_text": null,
          "old_line_content": "                    DPRINT1(\"HOOK WH_KEYBORD_LL read from lParam ERROR!\\n\");",
          "new_line_content": "                if (BadChk)",
          "content_same": false
        },
        {
          "line": 1236,
          "old_api": "IntAddHook",
          "new_api": null,
          "old_text": "IntAddHook(Thread, HookId, Global, WinStaObj)",
          "new_text": null,
          "old_line_content": "    Hook = IntAddHook(Thread, HookId, Global, WinStaObj);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 727,
          "old_api": "co_HOOK_CallHookNext",
          "new_api": null,
          "old_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Keyboard)",
          "new_text": null,
          "old_line_content": "                lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Keyboard);",
          "new_line_content": "            if (!BadChk)",
          "content_same": false
        },
        {
          "line": 1240,
          "old_api": "ObDereferenceObject",
          "new_api": null,
          "old_text": "ObDereferenceObject(Thread)",
          "new_text": null,
          "old_line_content": "        if (ThreadReferenced) ObDereferenceObject(Thread);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 1241,
          "old_api": "ObDereferenceObject",
          "new_api": null,
          "old_text": "ObDereferenceObject(WinStaObj)",
          "new_text": null,
          "old_line_content": "        ObDereferenceObject(WinStaObj);",
          "new_line_content": "        /* Dereference thread if needed */",
          "content_same": false
        },
        {
          "line": 1253,
          "old_api": "MmCopyFromCaller",
          "new_api": null,
          "old_text": "MmCopyFromCaller(&ModuleName, UnsafeModuleName, sizeof(UNICODE_STRING))",
          "new_text": null,
          "old_line_content": "        Status = MmCopyFromCaller(&ModuleName, UnsafeModuleName, sizeof(UNICODE_STRING));",
          "new_line_content": "    if (NULL != Mod)",
          "content_same": false
        },
        {
          "line": 742,
          "old_api": "ProbeForRead",
          "new_api": null,
          "old_text": "ProbeForRead((PVOID)lParam,\n                                 sizeof(MSG),\n                                 1)",
          "new_text": null,
          "old_line_content": "                    ProbeForRead((PVOID)lParam,",
          "new_line_content": "                _SEH2_TRY",
          "content_same": false
        },
        {
          "line": 1254,
          "old_api": "NT_SUCCESS",
          "new_api": null,
          "old_text": "NT_SUCCESS(Status)",
          "new_text": null,
          "old_line_content": "        if (!NT_SUCCESS(Status))",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 1257,
          "old_api": "IntRemoveHook",
          "new_api": null,
          "old_text": "IntRemoveHook(Hook, WinStaObj, FALSE)",
          "new_text": null,
          "old_line_content": "            IntRemoveHook(Hook, WinStaObj, FALSE);",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 746,
          "old_api": "RtlCopyMemory",
          "new_api": null,
          "old_text": "RtlCopyMemory(&Msg,\n                                  (PVOID)lParam,\n                                  sizeof(MSG))",
          "new_text": null,
          "old_line_content": "                    RtlCopyMemory(&Msg,",
          "new_line_content": "                                 1);",
          "content_same": false
        },
        {
          "line": 1263,
          "old_api": "ExAllocatePoolWithTag",
          "new_api": null,
          "old_text": "ExAllocatePoolWithTag(PagedPool,\n                                                        ModuleName.MaximumLength,\n                                                        TAG_HOOK)",
          "new_text": null,
          "old_line_content": "        Hook->ModuleName.Buffer = ExAllocatePoolWithTag(PagedPool,",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1268,
          "old_api": "UserDereferenceObject",
          "new_api": null,
          "old_text": "UserDereferenceObject(Hook)",
          "new_text": null,
          "old_line_content": "            UserDereferenceObject(Hook);",
          "new_line_content": "        if (NULL == Hook->ModuleName.Buffer)",
          "content_same": false
        },
        {
          "line": 1269,
          "old_api": "IntRemoveHook",
          "new_api": null,
          "old_text": "IntRemoveHook(Hook, WinStaObj, FALSE)",
          "new_text": null,
          "old_line_content": "            IntRemoveHook(Hook, WinStaObj, FALSE);",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 758,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"HOOK WH_XMESSAGEX read from lParam ERROR!\\n\")",
          "new_text": null,
          "old_line_content": "                    DPRINT1(\"HOOK WH_XMESSAGEX read from lParam ERROR!\\n\");",
          "new_line_content": "                if (BadChk)",
          "content_same": false
        },
        {
          "line": 764,
          "old_api": "co_HOOK_CallHookNext",
          "new_api": null,
          "old_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Msg)",
          "new_text": null,
          "old_line_content": "                lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&Msg);",
          "new_line_content": "            if (!BadChk)",
          "content_same": false
        },
        {
          "line": 1276,
          "old_api": "MmCopyFromCaller",
          "new_api": null,
          "old_text": "MmCopyFromCaller(Hook->ModuleName.Buffer,\n                                  ModuleName.Buffer,\n                                  ModuleName.MaximumLength)",
          "new_text": null,
          "old_line_content": "        Status = MmCopyFromCaller(Hook->ModuleName.Buffer,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1279,
          "old_api": "NT_SUCCESS",
          "new_api": null,
          "old_text": "NT_SUCCESS(Status)",
          "new_text": null,
          "old_line_content": "        if (!NT_SUCCESS(Status))",
          "new_line_content": "                                  ModuleName.Buffer,",
          "content_same": false
        },
        {
          "line": 770,
          "old_api": "ProbeForWrite",
          "new_api": null,
          "old_text": "ProbeForWrite((PVOID)lParam,\n                                      sizeof(MSG),\n                                      1)",
          "new_text": null,
          "old_line_content": "                        ProbeForWrite((PVOID)lParam,",
          "new_line_content": "                    _SEH2_TRY",
          "content_same": false
        },
        {
          "line": 1282,
          "old_api": "UserDereferenceObject",
          "new_api": null,
          "old_text": "UserDereferenceObject(Hook)",
          "new_text": null,
          "old_line_content": "            UserDereferenceObject(Hook);",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 774,
          "old_api": "RtlCopyMemory",
          "new_api": null,
          "old_text": "RtlCopyMemory((PVOID)lParam,\n                                      &Msg,\n                                      sizeof(MSG))",
          "new_text": null,
          "old_line_content": "                        RtlCopyMemory((PVOID)lParam,",
          "new_line_content": "                                      1);",
          "content_same": false
        },
        {
          "line": 1297,
          "old_api": "UserHMGetHandle",
          "new_api": null,
          "old_text": "UserHMGetHandle(Hook)",
          "new_text": null,
          "old_line_content": "    Handle = UserHMGetHandle(Hook);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 786,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"HOOK WH_GETMESSAGE write to lParam ERROR!\\n\")",
          "new_text": null,
          "old_line_content": "                        DPRINT1(\"HOOK WH_GETMESSAGE write to lParam ERROR!\\n\");",
          "new_line_content": "                    if (BadChk)",
          "content_same": false
        },
        {
          "line": 1302,
          "old_api": "UserDereferenceObject",
          "new_api": null,
          "old_text": "UserDereferenceObject(Hook)",
          "new_text": null,
          "old_line_content": "    UserDereferenceObject(Hook);",
          "new_line_content": "    ClientInfo->phkCurrent = 0;",
          "content_same": false
        },
        {
          "line": 794,
          "old_api": "DPRINT",
          "new_api": null,
          "old_text": "DPRINT(\"HOOK WH_CBT!\\n\")",
          "new_text": null,
          "old_line_content": "            DPRINT(\"HOOK WH_CBT!\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1309,
          "old_api": "DPRINT",
          "new_api": null,
          "old_text": "DPRINT(\"Leave NtUserSetWindowsHookEx, ret=%i\\n\",_ret_)",
          "new_text": null,
          "old_line_content": "    DPRINT(\"Leave NtUserSetWindowsHookEx, ret=%i\\n\",_ret_);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1310,
          "old_api": "UserLeave",
          "new_api": null,
          "old_text": "UserLeave()",
          "new_text": null,
          "old_line_content": "    UserLeave();",
          "new_line_content": "CLEANUP:",
          "content_same": false
        },
        {
          "line": 801,
          "old_api": "DPRINT",
          "new_api": null,
          "old_text": "DPRINT(\"HOOK HCBT_CREATEWND\\n\")",
          "new_text": null,
          "old_line_content": "                    DPRINT(\"HOOK HCBT_CREATEWND\\n\");",
          "new_line_content": "                    LPCBT_CREATEWNDW pcbtcww = (LPCBT_CREATEWNDW)lParam;",
          "content_same": false
        },
        {
          "line": 1327,
          "old_api": "PsGetCurrentProcess",
          "new_api": null,
          "old_text": "PsGetCurrentProcess()",
          "new_text": null,
          "old_line_content": "    Status = IntValidateWindowStationHandle(PsGetCurrentProcess()->Win32WindowStation,",
          "new_line_content": "    UserEnterExclusive();",
          "content_same": false
        },
        {
          "line": 818,
          "old_api": "ProbeForRead",
          "new_api": null,
          "old_text": "ProbeForRead( pcbtcww->lpcs->lpszClass,\n                                             sizeof(CHAR),\n                                             1)",
          "new_text": null,
          "old_line_content": "                               ProbeForRead( pcbtcww->lpcs->lpszClass,",
          "new_line_content": "                            if (!IS_ATOM(pcbtcww->lpcs->lpszClass))",
          "content_same": false
        },
        {
          "line": 1332,
          "old_api": "NT_SUCCESS",
          "new_api": null,
          "old_text": "NT_SUCCESS(Status)",
          "new_text": null,
          "old_line_content": "    if (!NT_SUCCESS(Status))",
          "new_line_content": "                                            &WinStaObj);",
          "content_same": false
        },
        {
          "line": 1335,
          "old_api": "RETURN",
          "new_api": null,
          "old_text": "RETURN( FALSE)",
          "new_text": null,
          "old_line_content": "        RETURN( FALSE);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 1340,
          "old_api": "IntGetHookObject",
          "new_api": null,
          "old_text": "IntGetHookObject(Hook)",
          "new_text": null,
          "old_line_content": "    if (!(HookObj = IntGetHookObject(Hook)))",
          "new_line_content": "    /*  Status = UserReferenceObjectByHandle(gHandleTable, Hook,",
          "content_same": false
        },
        {
          "line": 831,
          "old_api": "ProbeForRead",
          "new_api": null,
          "old_text": "ProbeForRead( pcbtcww->lpcs->lpszName,\n                                          sizeof(WCHAR),\n                                          1)",
          "new_text": null,
          "old_line_content": "                            ProbeForRead( pcbtcww->lpcs->lpszName,",
          "new_line_content": "                                          sizeof(CREATESTRUCTW),",
          "content_same": false
        },
        {
          "line": 1343,
          "old_api": "ObDereferenceObject",
          "new_api": null,
          "old_text": "ObDereferenceObject(WinStaObj)",
          "new_text": null,
          "old_line_content": "        ObDereferenceObject(WinStaObj);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 835,
          "old_api": "IS_ATOM",
          "new_api": null,
          "old_text": "IS_ATOM(pcbtcww->lpcs->lpszClass)",
          "new_text": null,
          "old_line_content": "                            if (!IS_ATOM(pcbtcww->lpcs->lpszClass))",
          "new_line_content": "                                          1);",
          "content_same": false
        },
        {
          "line": 1348,
          "old_api": "UserHMGetHandle",
          "new_api": null,
          "old_text": "UserHMGetHandle(HookObj)",
          "new_text": null,
          "old_line_content": "    ASSERT(Hook == UserHMGetHandle(HookObj));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1353,
          "old_api": "ObDereferenceObject",
          "new_api": null,
          "old_text": "ObDereferenceObject(WinStaObj)",
          "new_text": null,
          "old_line_content": "    ObDereferenceObject(WinStaObj);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1358,
          "old_api": "DPRINT",
          "new_api": null,
          "old_text": "DPRINT(\"Leave NtUserUnhookWindowsHookEx, ret=%i\\n\",_ret_)",
          "new_text": null,
          "old_line_content": "    DPRINT(\"Leave NtUserUnhookWindowsHookEx, ret=%i\\n\",_ret_);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1359,
          "old_api": "UserLeave",
          "new_api": null,
          "old_text": "UserLeave()",
          "new_text": null,
          "old_line_content": "    UserLeave();",
          "new_line_content": "CLEANUP:",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": "ISITHOOKED",
          "new_api": null,
          "old_text": "ISITHOOKED(HookId)",
          "new_text": null,
          "old_line_content": "    if (!ISITHOOKED(HookId))",
          "new_line_content": "    /* FIXME! Check pDeskInfo->fsHooks for global hooks! */",
          "content_same": false
        },
        {
          "line": 851,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"HOOK HCBT_CREATEWND write ERROR!\\n\")",
          "new_text": null,
          "old_line_content": "                        DPRINT1(\"HOOK HCBT_CREATEWND write ERROR!\\n\");",
          "new_line_content": "                    if (BadChk)",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": "PsGetCurrentThreadWin32Thread",
          "new_api": null,
          "old_text": "PsGetCurrentThreadWin32Thread()",
          "new_text": null,
          "old_line_content": "    pti = PsGetCurrentThreadWin32Thread();",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 856,
          "old_api": "co_HOOK_CallHookNext",
          "new_api": null,
          "old_text": "co_HOOK_CallHookNext(Hook, Code, wParam, lParam)",
          "new_text": null,
          "old_line_content": "                       lResult = co_HOOK_CallHookNext(Hook, Code, wParam, lParam);",
          "new_line_content": "                    if (!BadChk && Hook->Proc)",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": "MsqGetHooks",
          "new_api": null,
          "old_text": "MsqGetHooks(pti->MessageQueue)",
          "new_text": null,
          "old_line_content": "        Table = MsqGetHooks(pti->MessageQueue);",
          "new_line_content": "    else",
          "content_same": false
        },
        {
          "line": 351,
          "old_api": "IntGetFirstValidHook",
          "new_api": null,
          "old_text": "IntGetFirstValidHook(Table, HookId)",
          "new_text": null,
          "old_line_content": "    if (NULL == Table || ! (Hook = IntGetFirstValidHook(Table, HookId)))",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 865,
          "old_api": "DPRINT",
          "new_api": null,
          "old_text": "DPRINT(\"HOOK HCBT_MOVESIZE\\n\")",
          "new_text": null,
          "old_line_content": "                    DPRINT(\"HOOK HCBT_MOVESIZE\\n\");",
          "new_line_content": "                    RECTL rt;",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": "IntGetFirstValidHook",
          "new_api": null,
          "old_text": "IntGetFirstValidHook(Table, HookId)",
          "new_text": null,
          "old_line_content": "        if (NULL == Table || ! (Hook = IntGetFirstValidHook(Table, HookId)))",
          "new_line_content": "        /* try global table */",
          "content_same": false
        },
        {
          "line": 871,
          "old_api": "ProbeForRead",
          "new_api": null,
          "old_text": "ProbeForRead((PVOID)lParam,\n                                         sizeof(RECT),\n                                         1)",
          "new_text": null,
          "old_line_content": "                            ProbeForRead((PVOID)lParam,",
          "new_line_content": "                        _SEH2_TRY",
          "content_same": false
        },
        {
          "line": 361,
          "old_api": "PsGetCurrentThread",
          "new_api": null,
          "old_text": "PsGetCurrentThread()",
          "new_text": null,
          "old_line_content": "    if ((Hook->Thread != PsGetCurrentThread()) && (Hook->Thread != NULL))",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 875,
          "old_api": "RtlCopyMemory",
          "new_api": null,
          "old_text": "RtlCopyMemory(&rt,\n                                          (PVOID)lParam,\n                                          sizeof(RECT))",
          "new_text": null,
          "old_line_content": "                            RtlCopyMemory(&rt,",
          "new_line_content": "                                         1);",
          "content_same": false
        },
        {
          "line": 368,
          "old_api": "HOOKID_TO_INDEX",
          "new_api": null,
          "old_text": "HOOKID_TO_INDEX(HookId)",
          "new_text": null,
          "old_line_content": "    Table->Counts[HOOKID_TO_INDEX(HookId)]++;",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": "HOOKID_TO_INDEX",
          "new_api": null,
          "old_text": "HOOKID_TO_INDEX(HookId)",
          "new_text": null,
          "old_line_content": "        GlobalHooks->Counts[HOOKID_TO_INDEX(HookId)]++;",
          "new_line_content": "    if (Table != GlobalHooks && GlobalHooks != NULL)",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": "GetWin32ClientInfo",
          "new_api": null,
          "old_text": "GetWin32ClientInfo()",
          "new_text": null,
          "old_line_content": "    ClientInfo = GetWin32ClientInfo();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 887,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"HOOK HCBT_MOVESIZE read from lParam ERROR!\\n\")",
          "new_text": null,
          "old_line_content": "                            DPRINT1(\"HOOK HCBT_MOVESIZE read from lParam ERROR!\\n\");",
          "new_line_content": "                        if (BadChk)",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": "co_IntCallHookProc",
          "new_api": null,
          "old_text": "co_IntCallHookProc(HookId,\n                                Code,\n                                wParam,\n                                lParam,\n                                Hook->Proc,\n                                Hook->Ansi,\n                                &Hook->ModuleName)",
          "new_text": null,
          "old_line_content": "    Result = co_IntCallHookProc(HookId,",
          "new_line_content": "    ClientInfo->phkCurrent = Hook;     /* Load the call. */",
          "content_same": false
        },
        {
          "line": 893,
          "old_api": "co_HOOK_CallHookNext",
          "new_api": null,
          "old_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&rt)",
          "new_text": null,
          "old_line_content": "                        lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&rt);",
          "new_line_content": "                    if (!BadChk)",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "PsGetCurrentProcess",
          "new_api": null,
          "old_text": "PsGetCurrentProcess()",
          "new_text": null,
          "old_line_content": "    Status = IntValidateWindowStationHandle(PsGetCurrentProcess()->Win32WindowStation,",
          "new_line_content": "    ClientInfo->phkCurrent = SaveHook;",
          "content_same": false
        },
        {
          "line": 902,
          "old_api": "DPRINT",
          "new_api": null,
          "old_text": "DPRINT(\"HOOK HCBT_ACTIVATE\\n\")",
          "new_text": null,
          "old_line_content": "                    DPRINT(\"HOOK HCBT_ACTIVATE\\n\");",
          "new_line_content": "                    CBTACTIVATESTRUCT CbAs;",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": "NT_SUCCESS",
          "new_api": null,
          "old_text": "NT_SUCCESS(Status)",
          "new_text": null,
          "old_line_content": "    if (!NT_SUCCESS(Status))",
          "new_line_content": "                                            &WinStaObj);",
          "content_same": false
        },
        {
          "line": 907,
          "old_api": "ProbeForRead",
          "new_api": null,
          "old_text": "ProbeForRead((PVOID)lParam,\n                                         sizeof(CBTACTIVATESTRUCT),\n                                         1)",
          "new_text": null,
          "old_line_content": "                            ProbeForRead((PVOID)lParam,",
          "new_line_content": "                        _SEH2_TRY",
          "content_same": false
        },
        {
          "line": 399,
          "old_api": "MsqGetHooks",
          "new_api": null,
          "old_text": "MsqGetHooks(pti->MessageQueue)",
          "new_text": null,
          "old_line_content": "        IntReleaseHookChain(MsqGetHooks(pti->MessageQueue), HookId, WinStaObj);",
          "new_line_content": "    else",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": "IntReleaseHookChain",
          "new_api": null,
          "old_text": "IntReleaseHookChain(GlobalHooks, HookId, WinStaObj)",
          "new_text": null,
          "old_line_content": "        IntReleaseHookChain(GlobalHooks, HookId, WinStaObj);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 911,
          "old_api": "RtlCopyMemory",
          "new_api": null,
          "old_text": "RtlCopyMemory(&CbAs,\n                                          (PVOID)lParam,\n                                          sizeof(CBTACTIVATESTRUCT))",
          "new_text": null,
          "old_line_content": "                            RtlCopyMemory(&CbAs,",
          "new_line_content": "                                         1);",
          "content_same": false
        },
        {
          "line": 923,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"HOOK HCBT_ACTIVATE read from lParam ERROR!\\n\")",
          "new_text": null,
          "old_line_content": "                            DPRINT1(\"HOOK HCBT_ACTIVATE read from lParam ERROR!\\n\");",
          "new_line_content": "                        if (BadChk)",
          "content_same": false
        },
        {
          "line": 929,
          "old_api": "co_HOOK_CallHookNext",
          "new_api": null,
          "old_text": "co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&CbAs)",
          "new_text": null,
          "old_line_content": "                        lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)&CbAs);",
          "new_line_content": "                    if (!BadChk)",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": "PsGetCurrentProcess",
          "new_api": null,
          "old_text": "PsGetCurrentProcess()",
          "new_text": null,
          "old_line_content": "        Status = IntValidateWindowStationHandle(PsGetCurrentProcess()->Win32WindowStation,",
          "new_line_content": "    if (NULL != GlobalHooks)",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": "NT_SUCCESS",
          "new_api": null,
          "old_text": "NT_SUCCESS(Status)",
          "new_text": null,
          "old_line_content": "        if (!NT_SUCCESS(Status))",
          "new_line_content": "                                                &WinStaObj);",
          "content_same": false
        },
        {
          "line": 936,
          "old_api": "DPRINT",
          "new_api": null,
          "old_text": "DPRINT(\"HOOK HCBT_ %d\\n\",Code)",
          "new_text": null,
          "old_line_content": "                    DPRINT(\"HOOK HCBT_ %d\\n\",Code);",
          "new_line_content": "                /* The rest just use default. */",
          "content_same": false
        },
        {
          "line": 937,
          "old_api": "co_HOOK_CallHookNext",
          "new_api": null,
          "old_text": "co_HOOK_CallHookNext(Hook, Code, wParam, lParam)",
          "new_text": null,
          "old_line_content": "                    lResult = co_HOOK_CallHookNext(Hook, Code, wParam, lParam);",
          "new_line_content": "                default:",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "HOOKID_TO_INDEX",
          "new_api": null,
          "old_text": "HOOKID_TO_INDEX(HookId)",
          "new_text": null,
          "old_line_content": "                    Elem = GlobalHooks->Hooks[HOOKID_TO_INDEX(HookId)].Flink;",
          "new_line_content": "                case WH_KEYBOARD_LL:",
          "content_same": false
        },
        {
          "line": 951,
          "old_api": "ProbeForRead",
          "new_api": null,
          "old_text": "ProbeForRead((PVOID)lParam,\n                                 sizeof(EVENTMSG),\n                                 1)",
          "new_text": null,
          "old_line_content": "                    ProbeForRead((PVOID)lParam,",
          "new_line_content": "                _SEH2_TRY",
          "content_same": false
        },
        {
          "line": 955,
          "old_api": "RtlCopyMemory",
          "new_api": null,
          "old_text": "RtlCopyMemory(&EventMsg,\n                                  (PVOID)lParam,\n                                  sizeof(EVENTMSG))",
          "new_text": null,
          "old_line_content": "                    RtlCopyMemory(&EventMsg,",
          "new_line_content": "                                 1);",
          "content_same": false
        },
        {
          "line": 446,
          "old_api": "IntRemoveHook",
          "new_api": null,
          "old_text": "IntRemoveHook(HookObj, WinStaObj, TRUE)",
          "new_text": null,
          "old_line_content": "                            IntRemoveHook(HookObj, WinStaObj, TRUE);",
          "new_line_content": "                        if (HookObj->Thread == Thread)",
          "content_same": false
        },
        {
          "line": 967,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"HOOK WH_JOURNAL read from lParam ERROR!\\n\")",
          "new_text": null,
          "old_line_content": "                    DPRINT1(\"HOOK WH_JOURNAL read from lParam ERROR!\\n\");",
          "new_line_content": "                if (BadChk)",
          "content_same": false
        },
        {
          "line": 460,
          "old_api": "PsGetCurrentThread",
          "new_api": null,
          "old_text": "PsGetCurrentThread()",
          "new_text": null,
          "old_line_content": "    if ((Hook->Thread != PsGetCurrentThread()) && (Hook->Thread != NULL))",
          "new_line_content": "co_HOOK_CallHookNext(PHOOK Hook, INT Code, WPARAM wParam, LPARAM lParam)",
          "content_same": false
        },
        {
          "line": 973,
          "old_api": "LPARAM)(lParam ? &EventMsg : NULL)",
          "new_api": null,
          "old_text": "LPARAM)(lParam ? &EventMsg : NULL)",
          "new_text": null,
          "old_line_content": "                lResult = co_HOOK_CallHookNext(Hook, Code, wParam, (LPARAM)(lParam ? &EventMsg : NULL));",
          "new_line_content": "            if (!BadChk) ",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "IntCallLowLevelHook",
          "new_api": null,
          "old_text": "IntCallLowLevelHook(Hook, Code, wParam, lParam)",
          "new_text": null,
          "old_line_content": "        return IntCallLowLevelHook(Hook, Code, wParam, lParam);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": "DPRINT",
          "new_api": null,
          "old_text": "DPRINT(\"CALLING HOOK %d\\n\", Hook->HookId)",
          "new_text": null,
          "old_line_content": "    DPRINT(\"CALLING HOOK %d\\n\", Hook->HookId);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 979,
          "old_api": "ProbeForWrite",
          "new_api": null,
          "old_text": "ProbeForWrite((PVOID)lParam,\n                                      sizeof(EVENTMSG),\n                                      1)",
          "new_text": null,
          "old_line_content": "                        ProbeForWrite((PVOID)lParam,",
          "new_line_content": "                    _SEH2_TRY",
          "content_same": false
        },
        {
          "line": 983,
          "old_api": "RtlCopyMemory",
          "new_api": null,
          "old_text": "RtlCopyMemory((PVOID)lParam,\n                                      &EventMsg,\n                                      sizeof(EVENTMSG))",
          "new_text": null,
          "old_line_content": "                        RtlCopyMemory((PVOID)lParam,",
          "new_line_content": "                                      1);",
          "content_same": false
        },
        {
          "line": 995,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"HOOK WH_JOURNAL write to lParam ERROR!\\n\")",
          "new_text": null,
          "old_line_content": "                        DPRINT1(\"HOOK WH_JOURNAL write to lParam ERROR!\\n\");",
          "new_line_content": "                    if (BadChk)",
          "content_same": false
        },
        {
          "line": 1003,
          "old_api": "IntCallDebugHook",
          "new_api": null,
          "old_text": "IntCallDebugHook(Hook, Code, wParam, lParam)",
          "new_text": null,
          "old_line_content": "            lResult = IntCallDebugHook(Hook, Code, wParam, lParam);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": "ProbeForRead",
          "new_api": null,
          "old_text": "ProbeForRead((PVOID)lParam,\n                         sizeof(DEBUGHOOKINFO),\n                         1)",
          "new_text": null,
          "old_line_content": "            ProbeForRead((PVOID)lParam,",
          "new_line_content": "        _SEH2_TRY",
          "content_same": false
        },
        {
          "line": 499,
          "old_api": "RtlCopyMemory",
          "new_api": null,
          "old_text": "RtlCopyMemory(&Debug,\n                          (PVOID)lParam,\n                          sizeof(DEBUGHOOKINFO))",
          "new_text": null,
          "old_line_content": "            RtlCopyMemory(&Debug,",
          "new_line_content": "                         1);",
          "content_same": false
        },
        {
          "line": 1012,
          "old_api": "co_HOOK_CallHookNext",
          "new_api": null,
          "old_text": "co_HOOK_CallHookNext(Hook, Code, wParam, lParam)",
          "new_text": null,
          "old_line_content": "            lResult = co_HOOK_CallHookNext(Hook, Code, wParam, lParam);      ",
          "new_line_content": "        case WH_KEYBOARD:",
          "content_same": false
        },
        {
          "line": 1016,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"Unsupported HOOK Id -> %d\\n\",Hook->HookId)",
          "new_text": null,
          "old_line_content": "            DPRINT1(\"Unsupported HOOK Id -> %d\\n\",Hook->HookId);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 511,
          "old_api": "DPRINT1",
          "new_api": null,
          "old_text": "DPRINT1(\"HOOK WH_DEBUG read from lParam ERROR!\\n\")",
          "new_text": null,
          "old_line_content": "            DPRINT1(\"HOOK WH_DEBUG read from lParam ERROR!\\n\");",
          "new_line_content": "        if (BadChk)",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 51,
      "total_additions": 142,
      "total_deletions": 142,
      "total_api_changes": 335
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 335,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          335
        ]
      }
    },
    "api_calls_before": 254,
    "api_calls_after": 254,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 0,
      "total_diff_lines": 19
    }
  }
}