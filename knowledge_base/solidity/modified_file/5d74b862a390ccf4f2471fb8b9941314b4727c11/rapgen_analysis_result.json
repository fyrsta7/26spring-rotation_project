{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/solidity/modified_file/5d74b862a390ccf4f2471fb8b9941314b4727c11",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/solidity/modified_file/5d74b862a390ccf4f2471fb8b9941314b4727c11/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/solidity/modified_file/5d74b862a390ccf4f2471fb8b9941314b4727c11/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/solidity/modified_file/5d74b862a390ccf4f2471fb8b9941314b4727c11/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 37,
          "old_api": "reset",
          "new_api": "clear",
          "old_text": "m_solver.reset()",
          "new_text": "m_functions.clear()",
          "old_line_content": "\tm_solver.reset();",
          "new_line_content": "\tm_functions.clear();",
          "content_same": false
        },
        {
          "line": 53,
          "old_api": "move",
          "new_api": "z3Sort",
          "old_text": "move(_name)",
          "new_text": "z3Sort(_codomain)",
          "old_line_content": "\treturn SolverInterface::newFunction(move(_name), _domain, _codomain);",
          "new_line_content": "\tm_functions.insert({_name, m_context.function(_name.c_str(), z3Sort(_domain), z3Sort(_codomain))});",
          "content_same": false
        },
        {
          "line": 59,
          "old_api": "move",
          "new_api": "c_str",
          "old_text": "move(_name)",
          "new_text": "_name.c_str()",
          "old_line_content": "\treturn SolverInterface::newInteger(move(_name));",
          "new_line_content": "\tm_constants.insert({_name, m_context.int_const(_name.c_str())});",
          "content_same": false
        },
        {
          "line": 65,
          "old_api": "std::move(_name)",
          "new_api": "c_str",
          "old_text": "std::move(_name)",
          "new_text": "_name.c_str()",
          "old_line_content": "\treturn SolverInterface::newBool(std::move(_name));",
          "new_line_content": "\tm_constants.insert({_name, m_context.bool_const(_name.c_str())});",
          "content_same": false
        },
        {
          "line": 113,
          "old_api": "at",
          "new_api": "count",
          "old_text": "m_constants.at(_expr.name)",
          "new_text": "m_constants.count(_expr.name)",
          "old_line_content": "\t\treturn m_constants.at(_expr.name);",
          "new_line_content": "\tif (_expr.arguments.empty() && m_constants.count(_expr.name))",
          "content_same": false
        },
        {
          "line": 135,
          "old_api": "at",
          "new_api": "count",
          "old_text": "m_functions.at(n)(arguments)",
          "new_text": "m_functions.count(n)",
          "old_line_content": "\t\treturn m_functions.at(n)(arguments);",
          "new_line_content": "\tif (m_functions.count(n))",
          "content_same": false
        },
        {
          "line": 136,
          "old_api": "count",
          "new_api": "at",
          "old_text": "m_constants.count(n)",
          "new_text": "m_functions.at(n)(arguments)",
          "old_line_content": "\telse if (m_constants.count(n))",
          "new_line_content": "\t\treturn m_functions.at(n)(arguments);",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": "at",
          "new_api": "empty",
          "old_text": "m_constants.at(n)",
          "new_text": "arguments.empty()",
          "old_line_content": "\t\treturn m_constants.at(n);",
          "new_line_content": "\t\tsolAssert(arguments.empty(), \"\");",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 137,
          "old_api": null,
          "new_api": "count",
          "old_text": null,
          "new_text": "m_constants.count(n)",
          "old_line_content": "\t{",
          "new_line_content": "\telse if (m_constants.count(n))",
          "content_same": false
        },
        {
          "line": 140,
          "old_api": null,
          "new_api": "at",
          "old_text": null,
          "new_text": "m_constants.at(n)",
          "old_line_content": "\t}",
          "new_line_content": "\t\treturn m_constants.at(n);",
          "content_same": false
        },
        {
          "line": 142,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "arguments.empty()",
          "old_line_content": "\t{",
          "new_line_content": "\telse if (arguments.empty())",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": null,
          "new_api": "bool_val",
          "old_text": null,
          "new_text": "m_context.bool_val(true)",
          "old_line_content": "\t\telse if (n == \"false\")",
          "new_line_content": "\t\t\treturn m_context.bool_val(true);",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": null,
          "new_api": "bool_val",
          "old_text": null,
          "new_text": "m_context.bool_val(false)",
          "old_line_content": "\t\telse",
          "new_line_content": "\t\t\treturn m_context.bool_val(false);",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "n.c_str()",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\treturn m_context.int_val(n.c_str());",
          "content_same": false
        },
        {
          "line": 153,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "arguments.size()",
          "old_line_content": "\tif (n == \"ite\")",
          "new_line_content": "\tsolAssert(arity.count(n) && arity.at(n) == arguments.size(), \"\");",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": null,
          "new_api": "z3::ite(arguments[0], arguments[1], arguments[2])",
          "old_text": null,
          "new_text": "z3::ite(arguments[0], arguments[1], arguments[2])",
          "old_line_content": "\telse if (n == \"not\")",
          "new_line_content": "\t\treturn z3::ite(arguments[0], arguments[1], arguments[2]);",
          "content_same": false
        },
        {
          "line": 31,
          "old_api": null,
          "new_api": "z3::set_param(\"rewriter.pull_cheap_ite\", true)",
          "old_text": null,
          "new_text": "z3::set_param(\"rewriter.pull_cheap_ite\", true)",
          "old_line_content": "}",
          "new_line_content": "\tz3::set_param(\"rewriter.pull_cheap_ite\", true);",
          "content_same": false
        },
        {
          "line": 38,
          "old_api": null,
          "new_api": "reset",
          "old_text": null,
          "new_text": "m_solver.reset()",
          "old_line_content": "}",
          "new_line_content": "\tm_solver.reset();",
          "content_same": false
        },
        {
          "line": 43,
          "old_api": null,
          "new_api": "push",
          "old_text": null,
          "new_text": "m_solver.push()",
          "old_line_content": "}",
          "new_line_content": "\tm_solver.push();",
          "content_same": false
        },
        {
          "line": 48,
          "old_api": null,
          "new_api": "pop",
          "old_text": null,
          "new_text": "m_solver.pop()",
          "old_line_content": "}",
          "new_line_content": "\tm_solver.pop();",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": null,
          "new_api": "solAssert",
          "old_text": null,
          "new_text": "solAssert(false, \"\")",
          "old_line_content": "\treturn arguments[0];",
          "new_line_content": "\tsolAssert(false, \"\");",
          "content_same": false
        },
        {
          "line": 54,
          "old_api": null,
          "new_api": "move",
          "old_text": null,
          "new_text": "move(_name)",
          "old_line_content": "}",
          "new_line_content": "\treturn SolverInterface::newFunction(move(_name), _domain, _codomain);",
          "content_same": false
        },
        {
          "line": 60,
          "old_api": null,
          "new_api": "move",
          "old_text": null,
          "new_text": "move(_name)",
          "old_line_content": "}",
          "new_line_content": "\treturn SolverInterface::newInteger(move(_name));",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": null,
          "new_api": "bool_sort",
          "old_text": null,
          "new_text": "m_context.bool_sort()",
          "old_line_content": "\tcase Sort::Int:",
          "new_line_content": "\t\treturn m_context.bool_sort();",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": null,
          "new_api": "int_sort",
          "old_text": null,
          "new_text": "m_context.int_sort()",
          "old_line_content": "\tdefault:",
          "new_line_content": "\t\treturn m_context.int_sort();",
          "content_same": false
        },
        {
          "line": 66,
          "old_api": null,
          "new_api": "std::move(_name)",
          "old_text": null,
          "new_text": "std::move(_name)",
          "old_line_content": "}",
          "new_line_content": "\treturn SolverInterface::newBool(std::move(_name));",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": null,
          "new_api": "solAssert",
          "old_text": null,
          "new_text": "solAssert(false, \"\")",
          "old_line_content": "\t// Cannot be reached.",
          "new_line_content": "\tsolAssert(false, \"\");",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": null,
          "new_api": "int_sort",
          "old_text": null,
          "new_text": "m_context.int_sort()",
          "old_line_content": "}",
          "new_line_content": "\treturn m_context.int_sort();",
          "content_same": false
        },
        {
          "line": 71,
          "old_api": null,
          "new_api": "toZ3Expr",
          "old_text": null,
          "new_text": "toZ3Expr(_expr)",
          "old_line_content": "}",
          "new_line_content": "\tm_solver.add(toZ3Expr(_expr));",
          "content_same": false
        },
        {
          "line": 80,
          "old_api": null,
          "new_api": "check",
          "old_text": null,
          "new_text": "m_solver.check()",
          "old_line_content": "\t\t{",
          "new_line_content": "\t\tswitch (m_solver.check())",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": null,
          "new_api": "solAssert",
          "old_text": null,
          "new_text": "solAssert(false, \"\")",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tsolAssert(false, \"\");",
          "content_same": false
        },
        {
          "line": 95,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "_expressionsToEvaluate.empty()",
          "old_line_content": "\t\t{",
          "new_line_content": "\t\tif (result != CheckResult::UNSATISFIABLE && !_expressionsToEvaluate.empty())",
          "content_same": false
        },
        {
          "line": 97,
          "old_api": null,
          "new_api": "get_model",
          "old_text": null,
          "new_text": "m_solver.get_model()",
          "old_line_content": "\t\t\tfor (Expression const& e: _expressionsToEvaluate)",
          "new_line_content": "\t\t\tz3::model m = m_solver.get_model();",
          "content_same": false
        },
        {
          "line": 99,
          "old_api": null,
          "new_api": "toZ3Expr",
          "old_text": null,
          "new_text": "toZ3Expr(e)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\tvalues.push_back(toString(m.eval(toZ3Expr(e))));",
          "content_same": false
        },
        {
          "line": 105,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "values.clear()",
          "old_line_content": "\t}",
          "new_line_content": "\t\tvalues.clear();",
          "content_same": false
        },
        {
          "line": 108,
          "old_api": null,
          "new_api": "make_pair",
          "old_text": null,
          "new_text": "make_pair(result, values)",
          "old_line_content": "}",
          "new_line_content": "\treturn make_pair(result, values);",
          "content_same": false
        },
        {
          "line": 114,
          "old_api": null,
          "new_api": "at",
          "old_text": null,
          "new_text": "m_constants.at(_expr.name)",
          "old_line_content": "\tz3::expr_vector arguments(m_context);",
          "new_line_content": "\t\treturn m_constants.at(_expr.name);",
          "content_same": false
        },
        {
          "line": 117,
          "old_api": null,
          "new_api": "toZ3Expr",
          "old_text": null,
          "new_text": "toZ3Expr(arg)",
          "old_line_content": "",
          "new_line_content": "\t\targuments.push_back(toZ3Expr(arg));",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 134,
          "old_api": "count",
          "new_api": null,
          "old_text": "m_functions.count(n)",
          "new_text": null,
          "old_line_content": "\tif (m_functions.count(n))",
          "new_line_content": "\tstring const& n = _expr.name;",
          "content_same": false
        },
        {
          "line": 138,
          "old_api": "empty",
          "new_api": null,
          "old_text": "arguments.empty()",
          "new_text": null,
          "old_line_content": "\t\tsolAssert(arguments.empty(), \"\");",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 141,
          "old_api": "empty",
          "new_api": null,
          "old_text": "arguments.empty()",
          "new_text": null,
          "old_line_content": "\telse if (arguments.empty())",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": "bool_val",
          "new_api": null,
          "old_text": "m_context.bool_val(true)",
          "new_text": null,
          "old_line_content": "\t\t\treturn m_context.bool_val(true);",
          "new_line_content": "\t\tif (n == \"true\")",
          "content_same": false
        },
        {
          "line": 146,
          "old_api": "bool_val",
          "new_api": null,
          "old_text": "m_context.bool_val(false)",
          "new_text": null,
          "old_line_content": "\t\t\treturn m_context.bool_val(false);",
          "new_line_content": "\t\telse if (n == \"false\")",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "n.c_str()",
          "new_text": null,
          "old_line_content": "\t\t\treturn m_context.int_val(n.c_str());",
          "new_line_content": "\t\t\t// We assume it is an integer...",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": "size",
          "new_api": null,
          "old_text": "arguments.size()",
          "new_text": null,
          "old_line_content": "\tsolAssert(arity.count(n) && arity.at(n) == arguments.size(), \"\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 154,
          "old_api": "z3::ite(arguments[0], arguments[1], arguments[2])",
          "new_api": null,
          "old_text": "z3::ite(arguments[0], arguments[1], arguments[2])",
          "new_text": null,
          "old_line_content": "\t\treturn z3::ite(arguments[0], arguments[1], arguments[2]);",
          "new_line_content": "\tif (n == \"ite\")",
          "content_same": false
        },
        {
          "line": 35,
          "old_api": "clear",
          "new_api": null,
          "old_text": "m_constants.clear()",
          "new_text": null,
          "old_line_content": "\tm_constants.clear();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 42,
          "old_api": "push",
          "new_api": null,
          "old_text": "m_solver.push()",
          "new_text": null,
          "old_line_content": "\tm_solver.push();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 47,
          "old_api": "pop",
          "new_api": null,
          "old_text": "m_solver.pop()",
          "new_text": null,
          "old_line_content": "\tm_solver.pop();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 52,
          "old_api": "z3Sort",
          "new_api": null,
          "old_text": "z3Sort(_codomain)",
          "new_text": null,
          "old_line_content": "\tm_functions.insert({_name, m_context.function(_name.c_str(), z3Sort(_domain), z3Sort(_codomain))});",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": "solAssert",
          "new_api": null,
          "old_text": "solAssert(false, \"\")",
          "new_text": null,
          "old_line_content": "\tsolAssert(false, \"\");",
          "new_line_content": "\t// Cannot reach here.",
          "content_same": false
        },
        {
          "line": 58,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "_name.c_str()",
          "new_text": null,
          "old_line_content": "\tm_constants.insert({_name, m_context.int_const(_name.c_str())});",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": "bool_sort",
          "new_api": null,
          "old_text": "m_context.bool_sort()",
          "new_text": null,
          "old_line_content": "\t\treturn m_context.bool_sort();",
          "new_line_content": "\tcase Sort::Bool:",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "int_sort",
          "new_api": null,
          "old_text": "m_context.int_sort()",
          "new_text": null,
          "old_line_content": "\t\treturn m_context.int_sort();",
          "new_line_content": "\tcase Sort::Int:",
          "content_same": false
        },
        {
          "line": 64,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "_name.c_str()",
          "new_text": null,
          "old_line_content": "\tm_constants.insert({_name, m_context.bool_const(_name.c_str())});",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": "solAssert",
          "new_api": null,
          "old_text": "solAssert(false, \"\")",
          "new_text": null,
          "old_line_content": "\tsolAssert(false, \"\");",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": "int_sort",
          "new_api": null,
          "old_text": "m_context.int_sort()",
          "new_text": null,
          "old_line_content": "\treturn m_context.int_sort();",
          "new_line_content": "\t// Cannot be reached.",
          "content_same": false
        },
        {
          "line": 70,
          "old_api": "toZ3Expr",
          "new_api": null,
          "old_text": "toZ3Expr(_expr)",
          "new_text": null,
          "old_line_content": "\tm_solver.add(toZ3Expr(_expr));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 79,
          "old_api": "check",
          "new_api": null,
          "old_text": "m_solver.check()",
          "new_text": null,
          "old_line_content": "\t\tswitch (m_solver.check())",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 91,
          "old_api": "solAssert",
          "new_api": null,
          "old_text": "solAssert(false, \"\")",
          "new_text": null,
          "old_line_content": "\t\t\tsolAssert(false, \"\");",
          "new_line_content": "\t\tdefault:",
          "content_same": false
        },
        {
          "line": 94,
          "old_api": "empty",
          "new_api": null,
          "old_text": "_expressionsToEvaluate.empty()",
          "new_text": null,
          "old_line_content": "\t\tif (result != CheckResult::UNSATISFIABLE && !_expressionsToEvaluate.empty())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 96,
          "old_api": "get_model",
          "new_api": null,
          "old_text": "m_solver.get_model()",
          "new_text": null,
          "old_line_content": "\t\t\tz3::model m = m_solver.get_model();",
          "new_line_content": "\t\t{",
          "content_same": false
        },
        {
          "line": 98,
          "old_api": "toZ3Expr",
          "new_api": null,
          "old_text": "toZ3Expr(e)",
          "new_text": null,
          "old_line_content": "\t\t\t\tvalues.push_back(toString(m.eval(toZ3Expr(e))));",
          "new_line_content": "\t\t\tfor (Expression const& e: _expressionsToEvaluate)",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": "clear",
          "new_api": null,
          "old_text": "values.clear()",
          "new_text": null,
          "old_line_content": "\t\tvalues.clear();",
          "new_line_content": "\t\tresult = CheckResult::ERROR;",
          "content_same": false
        },
        {
          "line": 107,
          "old_api": "make_pair",
          "new_api": null,
          "old_text": "make_pair(result, values)",
          "new_text": null,
          "old_line_content": "\treturn make_pair(result, values);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": "count",
          "new_api": null,
          "old_text": "m_constants.count(_expr.name)",
          "new_text": null,
          "old_line_content": "\tif (_expr.arguments.empty() && m_constants.count(_expr.name))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 116,
          "old_api": "toZ3Expr",
          "new_api": null,
          "old_text": "toZ3Expr(arg)",
          "new_text": null,
          "old_line_content": "\t\targuments.push_back(toZ3Expr(arg));",
          "new_line_content": "\tfor (auto const& arg: _expr.arguments)",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 8,
      "total_additions": 30,
      "total_deletions": 29,
      "total_api_changes": 67
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 1,
        "api_related_lines": 67,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 61,
    "api_calls_after": 62,
    "diff_info": {
      "added_lines": 1,
      "removed_lines": 0,
      "total_diff_lines": 13
    }
  }
}