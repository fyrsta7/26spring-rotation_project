{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/TDengine/modified_file/5b83fcc1fce9759c2c659559f8802b4da56a1d98",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/TDengine/modified_file/5b83fcc1fce9759c2c659559f8802b4da56a1d98/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/TDengine/modified_file/5b83fcc1fce9759c2c659559f8802b4da56a1d98/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/TDengine/modified_file/5b83fcc1fce9759c2c659559f8802b4da56a1d98/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1181,
          "old_api": "tRealloc",
          "new_api": "tPutDiskDataHdr",
          "old_text": "tRealloc(&aBuf[3], aBufN[3])",
          "new_text": "tPutDiskDataHdr(NULL, &hdr)",
          "old_line_content": "  code = tRealloc(&aBuf[3], aBufN[3]);",
          "new_line_content": "  aBufN[3] = tPutDiskDataHdr(NULL, &hdr);",
          "content_same": false
        },
        {
          "line": 1215,
          "old_api": "ASSERT",
          "new_api": "tGetDiskDataHdr",
          "old_text": "ASSERT(hdr.delimiter == TSDB_FILE_DLMT)",
          "new_text": "tGetDiskDataHdr(pIn + n, &hdr)",
          "old_line_content": "  ASSERT(hdr.delimiter == TSDB_FILE_DLMT);",
          "new_line_content": "  n += tGetDiskDataHdr(pIn + n, &hdr);",
          "content_same": false
        },
        {
          "line": 1224,
          "old_api": "tsdbDecmprData",
          "new_api": "ASSERT",
          "old_text": "tsdbDecmprData(pIn + n, hdr.szUid, TSDB_DATA_TYPE_BIGINT, hdr.cmprAlg, (uint8_t **)&pBlockData->aUid,\n                          sizeof(int64_t) * hdr.nRow, &aBuf[0])",
          "new_text": "ASSERT(hdr.szUid)",
          "old_line_content": "    code = tsdbDecmprData(pIn + n, hdr.szUid, TSDB_DATA_TYPE_BIGINT, hdr.cmprAlg, (uint8_t **)&pBlockData->aUid,",
          "new_line_content": "    ASSERT(hdr.szUid);",
          "content_same": false
        },
        {
          "line": 1289,
          "old_api": "tPutU32v",
          "new_api": "tPutU32",
          "old_text": "tPutU32v(p ? p + n : p, pHdr->fmtVer)",
          "new_text": "tPutU32(p ? p + n : p, pHdr->delimiter)",
          "old_line_content": "  n += tPutU32v(p ? p + n : p, pHdr->fmtVer);",
          "new_line_content": "  n += tPutU32(p ? p + n : p, pHdr->delimiter);",
          "content_same": false
        },
        {
          "line": 1290,
          "old_api": "tPutI64",
          "new_api": "tPutU32v",
          "old_text": "tPutI64(p ? p + n : p, pHdr->suid)",
          "new_text": "tPutU32v(p ? p + n : p, pHdr->fmtVer)",
          "old_line_content": "  n += tPutI64(p ? p + n : p, pHdr->suid);",
          "new_line_content": "  n += tPutU32v(p ? p + n : p, pHdr->fmtVer);",
          "content_same": false
        },
        {
          "line": 1292,
          "old_api": "tPutI32v",
          "new_api": "tPutI64",
          "old_text": "tPutI32v(p ? p + n : p, pHdr->szUid)",
          "new_text": "tPutI64(p ? p + n : p, pHdr->uid)",
          "old_line_content": "  n += tPutI32v(p ? p + n : p, pHdr->szUid);",
          "new_line_content": "  n += tPutI64(p ? p + n : p, pHdr->uid);",
          "content_same": false
        },
        {
          "line": 1297,
          "old_api": "tPutI8",
          "new_api": "tPutI32v",
          "old_text": "tPutI8(p ? p + n : p, pHdr->cmprAlg)",
          "new_text": "tPutI32v(p ? p + n : p, pHdr->nRow)",
          "old_line_content": "  n += tPutI8(p ? p + n : p, pHdr->cmprAlg);",
          "new_line_content": "  n += tPutI32v(p ? p + n : p, pHdr->nRow);",
          "content_same": false
        },
        {
          "line": 1307,
          "old_api": "tGetU32v",
          "new_api": "tGetU32",
          "old_text": "tGetU32v(p + n, &pHdr->fmtVer)",
          "new_text": "tGetU32(p + n, &pHdr->delimiter)",
          "old_line_content": "  n += tGetU32v(p + n, &pHdr->fmtVer);",
          "new_line_content": "  n += tGetU32(p + n, &pHdr->delimiter);",
          "content_same": false
        },
        {
          "line": 1308,
          "old_api": "tGetI64",
          "new_api": "tGetU32v",
          "old_text": "tGetI64(p + n, &pHdr->suid)",
          "new_text": "tGetU32v(p + n, &pHdr->fmtVer)",
          "old_line_content": "  n += tGetI64(p + n, &pHdr->suid);",
          "new_line_content": "  n += tGetU32v(p + n, &pHdr->fmtVer);",
          "content_same": false
        },
        {
          "line": 1310,
          "old_api": "tGetI32v",
          "new_api": "tGetI64",
          "old_text": "tGetI32v(p + n, &pHdr->szUid)",
          "new_text": "tGetI64(p + n, &pHdr->uid)",
          "old_line_content": "  n += tGetI32v(p + n, &pHdr->szUid);",
          "new_line_content": "  n += tGetI64(p + n, &pHdr->uid);",
          "content_same": false
        },
        {
          "line": 1315,
          "old_api": "tGetI8",
          "new_api": "tGetI32v",
          "old_text": "tGetI8(p + n, &pHdr->cmprAlg)",
          "new_text": "tGetI32v(p + n, &pHdr->nRow)",
          "old_line_content": "  n += tGetI8(p + n, &pHdr->cmprAlg);",
          "new_line_content": "  n += tGetI32v(p + n, &pHdr->nRow);",
          "content_same": false
        },
        {
          "line": 1326,
          "old_api": "tPutI64",
          "new_api": "tPutI16v",
          "old_text": "tPutI64(p ? p + n : p, pColAgg->sum)",
          "new_text": "tPutI16v(p ? p + n : p, pColAgg->numOfNull)",
          "old_line_content": "  n += tPutI64(p ? p + n : p, pColAgg->sum);",
          "new_line_content": "  n += tPutI16v(p ? p + n : p, pColAgg->numOfNull);",
          "content_same": false
        },
        {
          "line": 1338,
          "old_api": "tGetI64",
          "new_api": "tGetI16v",
          "old_text": "tGetI64(p + n, &pColAgg->sum)",
          "new_text": "tGetI16v(p + n, &pColAgg->numOfNull)",
          "old_line_content": "  n += tGetI64(p + n, &pColAgg->sum);",
          "new_line_content": "  n += tGetI16v(p + n, &pColAgg->numOfNull);",
          "content_same": false
        },
        {
          "line": 1365,
          "old_api": "tRealloc",
          "new_api": "ASSERT",
          "old_text": "tRealloc(ppBuf, size)",
          "new_text": "ASSERT(ppBuf)",
          "old_line_content": "      code = tRealloc(ppBuf, size);",
          "new_line_content": "      ASSERT(ppBuf);",
          "content_same": false
        },
        {
          "line": 1390,
          "old_api": "memcpy",
          "new_api": "ASSERT",
          "old_text": "memcpy(*ppOut, pIn, szOut)",
          "new_text": "ASSERT(szIn == szOut)",
          "old_line_content": "    memcpy(*ppOut, pIn, szOut);",
          "new_line_content": "    ASSERT(szIn == szOut);",
          "content_same": false
        },
        {
          "line": 1439,
          "old_api": "tsdbCmprData",
          "new_api": "IS_VAR_DATA_TYPE",
          "old_text": "tsdbCmprData((uint8_t *)pColData->aOffset, sizeof(int32_t) * pColData->nVal, TSDB_DATA_TYPE_INT, cmprAlg,\n                        ppOut, nOut + size, &pBlockCol->szOffset, ppBuf)",
          "new_text": "IS_VAR_DATA_TYPE(pColData->type)",
          "old_line_content": "    code = tsdbCmprData((uint8_t *)pColData->aOffset, sizeof(int32_t) * pColData->nVal, TSDB_DATA_TYPE_INT, cmprAlg,",
          "new_line_content": "  if (IS_VAR_DATA_TYPE(pColData->type) && pColData->flag != (HAS_NULL | HAS_NONE)) {",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1153,
          "old_api": null,
          "new_api": "tPutBlockCol",
          "old_text": null,
          "new_text": "tPutBlockCol(NULL, &blockCol)",
          "old_line_content": "    if (code) goto _exit;",
          "new_line_content": "    code = tRealloc(&aBuf[1], hdr.szBlkCol + tPutBlockCol(NULL, &blockCol));",
          "content_same": false
        },
        {
          "line": 1155,
          "old_api": null,
          "new_api": "tPutBlockCol",
          "old_text": null,
          "new_text": "tPutBlockCol(aBuf[1] + hdr.szBlkCol, &blockCol)",
          "old_line_content": "  }",
          "new_line_content": "    hdr.szBlkCol += tPutBlockCol(aBuf[1] + hdr.szBlkCol, &blockCol);",
          "content_same": false
        },
        {
          "line": 1416,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(pColData->flag && (pColData->flag != HAS_NONE) && (pColData->flag != HAS_NULL))",
          "old_line_content": "",
          "new_line_content": "  ASSERT(pColData->flag && (pColData->flag != HAS_NONE) && (pColData->flag != HAS_NULL));",
          "content_same": false
        },
        {
          "line": 1164,
          "old_api": null,
          "new_api": "tsdbCmprData",
          "old_text": null,
          "new_text": "tsdbCmprData((uint8_t *)pBlockData->aUid, sizeof(int64_t) * pBlockData->nRow, TSDB_DATA_TYPE_BIGINT, cmprAlg,\n                        &aBuf[2], aBufN[2], &hdr.szUid, &aBuf[3])",
          "old_line_content": "                        &aBuf[2], aBufN[2], &hdr.szUid, &aBuf[3]);",
          "new_line_content": "    code = tsdbCmprData((uint8_t *)pBlockData->aUid, sizeof(int64_t) * pBlockData->nRow, TSDB_DATA_TYPE_BIGINT, cmprAlg,",
          "content_same": false
        },
        {
          "line": 1170,
          "old_api": null,
          "new_api": "tsdbCmprData",
          "old_text": null,
          "new_text": "tsdbCmprData((uint8_t *)pBlockData->aVersion, sizeof(int64_t) * pBlockData->nRow, TSDB_DATA_TYPE_BIGINT,\n                      cmprAlg, &aBuf[2], aBufN[2], &hdr.szVer, &aBuf[3])",
          "old_line_content": "                      cmprAlg, &aBuf[2], aBufN[2], &hdr.szVer, &aBuf[3]);",
          "new_line_content": "  code = tsdbCmprData((uint8_t *)pBlockData->aVersion, sizeof(int64_t) * pBlockData->nRow, TSDB_DATA_TYPE_BIGINT,",
          "content_same": false
        },
        {
          "line": 1298,
          "old_api": null,
          "new_api": "tPutI8",
          "old_text": null,
          "new_text": "tPutI8(p ? p + n : p, pHdr->cmprAlg)",
          "old_line_content": "",
          "new_line_content": "  n += tPutI8(p ? p + n : p, pHdr->cmprAlg);",
          "content_same": false
        },
        {
          "line": 1427,
          "old_api": null,
          "new_api": "BIT2_SIZE",
          "old_text": null,
          "new_text": "BIT2_SIZE(pColData->nVal)",
          "old_line_content": "    } else {",
          "new_line_content": "      szBitMap = BIT2_SIZE(pColData->nVal);",
          "content_same": false
        },
        {
          "line": 1429,
          "old_api": null,
          "new_api": "BIT1_SIZE",
          "old_text": null,
          "new_text": "BIT1_SIZE(pColData->nVal)",
          "old_line_content": "    }",
          "new_line_content": "      szBitMap = BIT1_SIZE(pColData->nVal);",
          "content_same": false
        },
        {
          "line": 1175,
          "old_api": null,
          "new_api": "tsdbCmprData",
          "old_text": null,
          "new_text": "tsdbCmprData((uint8_t *)pBlockData->aTSKEY, sizeof(TSKEY) * pBlockData->nRow, TSDB_DATA_TYPE_TIMESTAMP,\n                      cmprAlg, &aBuf[2], aBufN[2], &hdr.szKey, &aBuf[3])",
          "old_line_content": "                      cmprAlg, &aBuf[2], aBufN[2], &hdr.szKey, &aBuf[3]);",
          "new_line_content": "  code = tsdbCmprData((uint8_t *)pBlockData->aTSKEY, sizeof(TSKEY) * pBlockData->nRow, TSDB_DATA_TYPE_TIMESTAMP,",
          "content_same": false
        },
        {
          "line": 1432,
          "old_api": null,
          "new_api": "tsdbCmprData",
          "old_text": null,
          "new_text": "tsdbCmprData(pColData->pBitMap, szBitMap, TSDB_DATA_TYPE_TINYINT, cmprAlg, ppOut, nOut + size,\n                        &pBlockCol->szBitmap, ppBuf)",
          "old_line_content": "                        &pBlockCol->szBitmap, ppBuf);",
          "new_line_content": "    code = tsdbCmprData(pColData->pBitMap, szBitMap, TSDB_DATA_TYPE_TINYINT, cmprAlg, ppOut, nOut + size,",
          "content_same": false
        },
        {
          "line": 1182,
          "old_api": null,
          "new_api": "tRealloc",
          "old_text": null,
          "new_text": "tRealloc(&aBuf[3], aBufN[3])",
          "old_line_content": "  if (code) goto _exit;",
          "new_line_content": "  code = tRealloc(&aBuf[3], aBufN[3]);",
          "content_same": false
        },
        {
          "line": 1184,
          "old_api": null,
          "new_api": "tPutDiskDataHdr",
          "old_text": null,
          "new_text": "tPutDiskDataHdr(aBuf[3], &hdr)",
          "old_line_content": "",
          "new_line_content": "  tPutDiskDataHdr(aBuf[3], &hdr);",
          "content_same": false
        },
        {
          "line": 1440,
          "old_api": null,
          "new_api": "tsdbCmprData",
          "old_text": null,
          "new_text": "tsdbCmprData((uint8_t *)pColData->aOffset, sizeof(int32_t) * pColData->nVal, TSDB_DATA_TYPE_INT, cmprAlg,\n                        ppOut, nOut + size, &pBlockCol->szOffset, ppBuf)",
          "old_line_content": "                        ppOut, nOut + size, &pBlockCol->szOffset, ppBuf);",
          "new_line_content": "    code = tsdbCmprData((uint8_t *)pColData->aOffset, sizeof(int32_t) * pColData->nVal, TSDB_DATA_TYPE_INT, cmprAlg,",
          "content_same": false
        },
        {
          "line": 1316,
          "old_api": null,
          "new_api": "tGetI8",
          "old_text": null,
          "new_text": "tGetI8(p + n, &pHdr->cmprAlg)",
          "old_line_content": "",
          "new_line_content": "  n += tGetI8(p + n, &pHdr->cmprAlg);",
          "content_same": false
        },
        {
          "line": 1189,
          "old_api": null,
          "new_api": "tRealloc",
          "old_text": null,
          "new_text": "tRealloc(ppOut, *szOut)",
          "old_line_content": "    if (code) goto _exit;",
          "new_line_content": "    code = tRealloc(ppOut, *szOut);",
          "content_same": false
        },
        {
          "line": 1448,
          "old_api": null,
          "new_api": "tsdbCmprData",
          "old_text": null,
          "new_text": "tsdbCmprData((uint8_t *)pColData->pData, pColData->nData, pColData->type, cmprAlg, ppOut, nOut + size,\n                        &pBlockCol->szValue, ppBuf)",
          "old_line_content": "                        &pBlockCol->szValue, ppBuf);",
          "new_line_content": "    code = tsdbCmprData((uint8_t *)pColData->pData, pColData->nData, pColData->type, cmprAlg, ppOut, nOut + size,",
          "content_same": false
        },
        {
          "line": 1193,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(*ppOut + aBufN[3], aBuf[2], aBufN[2])",
          "old_line_content": "    if (aBufN[1]) {",
          "new_line_content": "    memcpy(*ppOut + aBufN[3], aBuf[2], aBufN[2]);",
          "content_same": false
        },
        {
          "line": 1195,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(*ppOut + aBufN[3] + aBufN[2], aBuf[1], aBufN[1])",
          "old_line_content": "    }",
          "new_line_content": "      memcpy(*ppOut + aBufN[3] + aBufN[2], aBuf[1], aBufN[1]);",
          "content_same": false
        },
        {
          "line": 1198,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(*ppOut + aBufN[3] + aBufN[2] + aBufN[1], aBuf[0], aBufN[0])",
          "old_line_content": "    }",
          "new_line_content": "      memcpy(*ppOut + aBufN[3] + aBufN[2] + aBufN[1], aBuf[0], aBufN[0]);",
          "content_same": false
        },
        {
          "line": 1329,
          "old_api": null,
          "new_api": "tPutI64",
          "old_text": null,
          "new_text": "tPutI64(p ? p + n : p, pColAgg->min)",
          "old_line_content": "",
          "new_line_content": "  n += tPutI64(p ? p + n : p, pColAgg->min);",
          "content_same": false
        },
        {
          "line": 1463,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(pColData->type == pBlockCol->type)",
          "old_line_content": "  pColData->smaOn = pBlockCol->smaOn;",
          "new_line_content": "  ASSERT(pColData->type == pBlockCol->type);",
          "content_same": false
        },
        {
          "line": 1209,
          "old_api": null,
          "new_api": "tBlockDataReset",
          "old_text": null,
          "new_text": "tBlockDataReset(pBlockData)",
          "old_line_content": "",
          "new_line_content": "  tBlockDataReset(pBlockData);",
          "content_same": false
        },
        {
          "line": 1341,
          "old_api": null,
          "new_api": "tGetI64",
          "old_text": null,
          "new_text": "tGetI64(p + n, &pColAgg->min)",
          "old_line_content": "",
          "new_line_content": "  n += tGetI64(p + n, &pColAgg->min);",
          "content_same": false
        },
        {
          "line": 1216,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(hdr.delimiter == TSDB_FILE_DLMT)",
          "old_line_content": "",
          "new_line_content": "  ASSERT(hdr.delimiter == TSDB_FILE_DLMT);",
          "content_same": false
        },
        {
          "line": 1474,
          "old_api": null,
          "new_api": "BIT2_SIZE",
          "old_text": null,
          "new_text": "BIT2_SIZE(pColData->nVal)",
          "old_line_content": "    } else {",
          "new_line_content": "      szBitMap = BIT2_SIZE(pColData->nVal);",
          "content_same": false
        },
        {
          "line": 1476,
          "old_api": null,
          "new_api": "BIT1_SIZE",
          "old_text": null,
          "new_text": "BIT1_SIZE(pColData->nVal)",
          "old_line_content": "    }",
          "new_line_content": "      szBitMap = BIT1_SIZE(pColData->nVal);",
          "content_same": false
        },
        {
          "line": 1350,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(szIn > 0 && ppOut)",
          "old_line_content": "",
          "new_line_content": "  ASSERT(szIn > 0 && ppOut);",
          "content_same": false
        },
        {
          "line": 1479,
          "old_api": null,
          "new_api": "tsdbDecmprData",
          "old_text": null,
          "new_text": "tsdbDecmprData(p, pBlockCol->szBitmap, TSDB_DATA_TYPE_TINYINT, cmprAlg, &pColData->pBitMap, szBitMap, ppBuf)",
          "old_line_content": "    if (code) goto _exit;",
          "new_line_content": "    code = tsdbDecmprData(p, pBlockCol->szBitmap, TSDB_DATA_TYPE_TINYINT, cmprAlg, &pColData->pBitMap, szBitMap, ppBuf);",
          "content_same": false
        },
        {
          "line": 1225,
          "old_api": null,
          "new_api": "tsdbDecmprData",
          "old_text": null,
          "new_text": "tsdbDecmprData(pIn + n, hdr.szUid, TSDB_DATA_TYPE_BIGINT, hdr.cmprAlg, (uint8_t **)&pBlockData->aUid,\n                          sizeof(int64_t) * hdr.nRow, &aBuf[0])",
          "old_line_content": "                          sizeof(int64_t) * hdr.nRow, &aBuf[0]);",
          "new_line_content": "    code = tsdbDecmprData(pIn + n, hdr.szUid, TSDB_DATA_TYPE_BIGINT, hdr.cmprAlg, (uint8_t **)&pBlockData->aUid,",
          "content_same": false
        },
        {
          "line": 1353,
          "old_api": null,
          "new_api": "tRealloc",
          "old_text": null,
          "new_text": "tRealloc(ppOut, nOut + szIn)",
          "old_line_content": "    if (code) goto _exit;",
          "new_line_content": "    code = tRealloc(ppOut, nOut + szIn);",
          "content_same": false
        },
        {
          "line": 1356,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(*ppOut + nOut, pIn, szIn)",
          "old_line_content": "    *szOut = szIn;",
          "new_line_content": "    memcpy(*ppOut + nOut, pIn, szIn);",
          "content_same": false
        },
        {
          "line": 1229,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(!hdr.szUid)",
          "old_line_content": "  }",
          "new_line_content": "    ASSERT(!hdr.szUid);",
          "content_same": false
        },
        {
          "line": 1102,
          "old_api": null,
          "new_api": "tBlockDataGetColDataByIdx",
          "old_text": null,
          "new_text": "tBlockDataGetColDataByIdx(pBlockData, midx)",
          "old_line_content": "    int32_t   c = (pColData->cid == cid) ? 0 : ((pColData->cid > cid) ? 1 : -1);",
          "new_line_content": "    SColData *pColData = tBlockDataGetColDataByIdx(pBlockData, midx);",
          "content_same": false
        },
        {
          "line": 1486,
          "old_api": null,
          "new_api": "tsdbDecmprData",
          "old_text": null,
          "new_text": "tsdbDecmprData(p, pBlockCol->szOffset, TSDB_DATA_TYPE_INT, cmprAlg, (uint8_t **)&pColData->aOffset,\n                          sizeof(int32_t) * pColData->nVal, ppBuf)",
          "old_line_content": "                          sizeof(int32_t) * pColData->nVal, ppBuf);",
          "new_line_content": "    code = tsdbDecmprData(p, pBlockCol->szOffset, TSDB_DATA_TYPE_INT, cmprAlg, (uint8_t **)&pColData->aOffset,",
          "content_same": false
        },
        {
          "line": 1361,
          "old_api": null,
          "new_api": "tRealloc",
          "old_text": null,
          "new_text": "tRealloc(ppOut, nOut + size)",
          "old_line_content": "    if (code) goto _exit;",
          "new_line_content": "    code = tRealloc(ppOut, nOut + size);",
          "content_same": false
        },
        {
          "line": 1234,
          "old_api": null,
          "new_api": "tsdbDecmprData",
          "old_text": null,
          "new_text": "tsdbDecmprData(pIn + n, hdr.szVer, TSDB_DATA_TYPE_BIGINT, hdr.cmprAlg, (uint8_t **)&pBlockData->aVersion,\n                        sizeof(int64_t) * hdr.nRow, &aBuf[0])",
          "old_line_content": "                        sizeof(int64_t) * hdr.nRow, &aBuf[0]);",
          "new_line_content": "  code = tsdbDecmprData(pIn + n, hdr.szVer, TSDB_DATA_TYPE_BIGINT, hdr.cmprAlg, (uint8_t **)&pBlockData->aVersion,",
          "content_same": false
        },
        {
          "line": 1366,
          "old_api": null,
          "new_api": "tRealloc",
          "old_text": null,
          "new_text": "tRealloc(ppBuf, size)",
          "old_line_content": "      if (code) goto _exit;",
          "new_line_content": "      code = tRealloc(ppBuf, size);",
          "content_same": false
        },
        {
          "line": 1494,
          "old_api": null,
          "new_api": "tsdbDecmprData",
          "old_text": null,
          "new_text": "tsdbDecmprData(p, pBlockCol->szValue, pColData->type, cmprAlg, &pColData->pData, pColData->nData, ppBuf)",
          "old_line_content": "    if (code) goto _exit;",
          "new_line_content": "    code = tsdbDecmprData(p, pBlockCol->szValue, pColData->type, cmprAlg, &pColData->pData, pColData->nData, ppBuf);",
          "content_same": false
        },
        {
          "line": 1240,
          "old_api": null,
          "new_api": "tsdbDecmprData",
          "old_text": null,
          "new_text": "tsdbDecmprData(pIn + n, hdr.szKey, TSDB_DATA_TYPE_TIMESTAMP, hdr.cmprAlg, (uint8_t **)&pBlockData->aTSKEY,\n                        sizeof(TSKEY) * hdr.nRow, &aBuf[0])",
          "old_line_content": "                        sizeof(TSKEY) * hdr.nRow, &aBuf[0]);",
          "new_line_content": "  code = tsdbDecmprData(pIn + n, hdr.szKey, TSDB_DATA_TYPE_TIMESTAMP, hdr.cmprAlg, (uint8_t **)&pBlockData->aTSKEY,",
          "content_same": false
        },
        {
          "line": 1371,
          "old_api": null,
          "new_api": "compFunc",
          "old_text": null,
          "new_text": "tDataTypes[type].compFunc(pIn, szIn, szIn / tDataTypes[type].bytes, *ppOut + nOut, size, cmprAlg, *ppBuf, size)",
          "old_line_content": "    if (*szOut <= 0) {",
          "new_line_content": "        tDataTypes[type].compFunc(pIn, szIn, szIn / tDataTypes[type].bytes, *ppOut + nOut, size, cmprAlg, *ppBuf, size);",
          "content_same": false
        },
        {
          "line": 1252,
          "old_api": null,
          "new_api": "tGetBlockCol",
          "old_text": null,
          "new_text": "tGetBlockCol(pIn + n + nt, &blockCol)",
          "old_line_content": "    ++nColData;",
          "new_line_content": "    nt += tGetBlockCol(pIn + n + nt, &blockCol);",
          "content_same": false
        },
        {
          "line": 1255,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(nt == hdr.szBlkCol)",
          "old_line_content": "",
          "new_line_content": "  ASSERT(nt == hdr.szBlkCol);",
          "content_same": false
        },
        {
          "line": 1257,
          "old_api": null,
          "new_api": "tBlockDataAdjustColData",
          "old_text": null,
          "new_text": "tBlockDataAdjustColData(pBlockData, nColData)",
          "old_line_content": "  if (code) goto _exit;",
          "new_line_content": "  code = tBlockDataAdjustColData(pBlockData, nColData);",
          "content_same": false
        },
        {
          "line": 1386,
          "old_api": null,
          "new_api": "tRealloc",
          "old_text": null,
          "new_text": "tRealloc(ppOut, szOut)",
          "old_line_content": "  if (code) goto _exit;",
          "new_line_content": "  code = tRealloc(ppOut, szOut);",
          "content_same": false
        },
        {
          "line": 1133,
          "old_api": null,
          "new_api": "tBlockDataGetColDataByIdx",
          "old_text": null,
          "new_text": "tBlockDataGetColDataByIdx(pBlockData, iColData)",
          "old_line_content": "",
          "new_line_content": "    SColData *pColData = tBlockDataGetColDataByIdx(pBlockData, iColData);",
          "content_same": false
        },
        {
          "line": 1135,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(pColData->flag)",
          "old_line_content": "",
          "new_line_content": "    ASSERT(pColData->flag);",
          "content_same": false
        },
        {
          "line": 1264,
          "old_api": null,
          "new_api": "tGetBlockCol",
          "old_text": null,
          "new_text": "tGetBlockCol(pIn + n + nt, &blockCol)",
          "old_line_content": "",
          "new_line_content": "    nt += tGetBlockCol(pIn + n + nt, &blockCol);",
          "content_same": false
        },
        {
          "line": 1391,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(*ppOut, pIn, szOut)",
          "old_line_content": "  } else {",
          "new_line_content": "    memcpy(*ppOut, pIn, szOut);",
          "content_same": false
        },
        {
          "line": 1394,
          "old_api": null,
          "new_api": "tRealloc",
          "old_text": null,
          "new_text": "tRealloc(ppBuf, szOut + COMP_OVERFLOW_BYTES)",
          "old_line_content": "      if (code) goto _exit;",
          "new_line_content": "      code = tRealloc(ppBuf, szOut + COMP_OVERFLOW_BYTES);",
          "content_same": false
        },
        {
          "line": 1268,
          "old_api": null,
          "new_api": "tColDataInit",
          "old_text": null,
          "new_text": "tColDataInit(pColData, blockCol.cid, blockCol.type, blockCol.smaOn)",
          "old_line_content": "    if (blockCol.flag == HAS_NULL) {",
          "new_line_content": "    tColDataInit(pColData, blockCol.cid, blockCol.type, blockCol.smaOn);",
          "content_same": false
        },
        {
          "line": 1398,
          "old_api": null,
          "new_api": "decompFunc",
          "old_text": null,
          "new_text": "tDataTypes[type].decompFunc(pIn, szIn, szOut / tDataTypes[type].bytes, *ppOut, szOut, cmprAlg,\n                                               *ppBuf, szOut + COMP_OVERFLOW_BYTES)",
          "old_line_content": "                                               *ppBuf, szOut + COMP_OVERFLOW_BYTES);",
          "new_line_content": "    int32_t size = tDataTypes[type].decompFunc(pIn, szIn, szOut / tDataTypes[type].bytes, *ppOut, szOut, cmprAlg,",
          "content_same": false
        },
        {
          "line": 1271,
          "old_api": null,
          "new_api": "COL_VAL_NULL",
          "old_text": null,
          "new_text": "COL_VAL_NULL(blockCol.cid, blockCol.type)",
          "old_line_content": "        if (code) goto _exit;",
          "new_line_content": "        code = tColDataAppendValue(pColData, &COL_VAL_NULL(blockCol.cid, blockCol.type));",
          "content_same": false
        },
        {
          "line": 1146,
          "old_api": null,
          "new_api": "tsdbCmprColData",
          "old_text": null,
          "new_text": "tsdbCmprColData(pColData, cmprAlg, &blockCol, &aBuf[0], aBufN[0], &aBuf[2])",
          "old_line_content": "      if (code) goto _exit;",
          "new_line_content": "      code = tsdbCmprColData(pColData, cmprAlg, &blockCol, &aBuf[0], aBufN[0], &aBuf[2]);",
          "content_same": false
        },
        {
          "line": 1275,
          "old_api": null,
          "new_api": "tsdbDecmprColData",
          "old_text": null,
          "new_text": "tsdbDecmprColData(pIn + n + hdr.szBlkCol + blockCol.offset, &blockCol, hdr.cmprAlg, hdr.nRow, pColData,\n                               &aBuf[0])",
          "old_line_content": "                               &aBuf[0]);",
          "new_line_content": "      code = tsdbDecmprColData(pIn + n + hdr.szBlkCol + blockCol.offset, &blockCol, hdr.cmprAlg, hdr.nRow, pColData,",
          "content_same": false
        },
        {
          "line": 1405,
          "old_api": null,
          "new_api": "ASSERT",
          "old_text": null,
          "new_text": "ASSERT(size == szOut)",
          "old_line_content": "  }",
          "new_line_content": "    ASSERT(size == szOut);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1152,
          "old_api": "tPutBlockCol",
          "new_api": null,
          "old_text": "tPutBlockCol(NULL, &blockCol)",
          "new_text": null,
          "old_line_content": "    code = tRealloc(&aBuf[1], hdr.szBlkCol + tPutBlockCol(NULL, &blockCol));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1154,
          "old_api": "tPutBlockCol",
          "new_api": null,
          "old_text": "tPutBlockCol(aBuf[1] + hdr.szBlkCol, &blockCol)",
          "new_text": null,
          "old_line_content": "    hdr.szBlkCol += tPutBlockCol(aBuf[1] + hdr.szBlkCol, &blockCol);",
          "new_line_content": "    if (code) goto _exit;",
          "content_same": false
        },
        {
          "line": 1415,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(pColData->flag && (pColData->flag != HAS_NONE) && (pColData->flag != HAS_NULL))",
          "new_text": null,
          "old_line_content": "  ASSERT(pColData->flag && (pColData->flag != HAS_NONE) && (pColData->flag != HAS_NULL));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1288,
          "old_api": "tPutU32",
          "new_api": null,
          "old_text": "tPutU32(p ? p + n : p, pHdr->delimiter)",
          "new_text": null,
          "old_line_content": "  n += tPutU32(p ? p + n : p, pHdr->delimiter);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1163,
          "old_api": "tsdbCmprData",
          "new_api": null,
          "old_text": "tsdbCmprData((uint8_t *)pBlockData->aUid, sizeof(int64_t) * pBlockData->nRow, TSDB_DATA_TYPE_BIGINT, cmprAlg,\n                        &aBuf[2], aBufN[2], &hdr.szUid, &aBuf[3])",
          "new_text": null,
          "old_line_content": "    code = tsdbCmprData((uint8_t *)pBlockData->aUid, sizeof(int64_t) * pBlockData->nRow, TSDB_DATA_TYPE_BIGINT, cmprAlg,",
          "new_line_content": "  if (pBlockData->uid == 0) {",
          "content_same": false
        },
        {
          "line": 1169,
          "old_api": "tsdbCmprData",
          "new_api": null,
          "old_text": "tsdbCmprData((uint8_t *)pBlockData->aVersion, sizeof(int64_t) * pBlockData->nRow, TSDB_DATA_TYPE_BIGINT,\n                      cmprAlg, &aBuf[2], aBufN[2], &hdr.szVer, &aBuf[3])",
          "new_text": null,
          "old_line_content": "  code = tsdbCmprData((uint8_t *)pBlockData->aVersion, sizeof(int64_t) * pBlockData->nRow, TSDB_DATA_TYPE_BIGINT,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1426,
          "old_api": "BIT2_SIZE",
          "new_api": null,
          "old_text": "BIT2_SIZE(pColData->nVal)",
          "new_text": null,
          "old_line_content": "      szBitMap = BIT2_SIZE(pColData->nVal);",
          "new_line_content": "    if (pColData->flag == (HAS_VALUE | HAS_NULL | HAS_NONE)) {",
          "content_same": false
        },
        {
          "line": 1428,
          "old_api": "BIT1_SIZE",
          "new_api": null,
          "old_text": "BIT1_SIZE(pColData->nVal)",
          "new_text": null,
          "old_line_content": "      szBitMap = BIT1_SIZE(pColData->nVal);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 1174,
          "old_api": "tsdbCmprData",
          "new_api": null,
          "old_text": "tsdbCmprData((uint8_t *)pBlockData->aTSKEY, sizeof(TSKEY) * pBlockData->nRow, TSDB_DATA_TYPE_TIMESTAMP,\n                      cmprAlg, &aBuf[2], aBufN[2], &hdr.szKey, &aBuf[3])",
          "new_text": null,
          "old_line_content": "  code = tsdbCmprData((uint8_t *)pBlockData->aTSKEY, sizeof(TSKEY) * pBlockData->nRow, TSDB_DATA_TYPE_TIMESTAMP,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1431,
          "old_api": "tsdbCmprData",
          "new_api": null,
          "old_text": "tsdbCmprData(pColData->pBitMap, szBitMap, TSDB_DATA_TYPE_TINYINT, cmprAlg, ppOut, nOut + size,\n                        &pBlockCol->szBitmap, ppBuf)",
          "new_text": null,
          "old_line_content": "    code = tsdbCmprData(pColData->pBitMap, szBitMap, TSDB_DATA_TYPE_TINYINT, cmprAlg, ppOut, nOut + size,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1306,
          "old_api": "tGetU32",
          "new_api": null,
          "old_text": "tGetU32(p + n, &pHdr->delimiter)",
          "new_text": null,
          "old_line_content": "  n += tGetU32(p + n, &pHdr->delimiter);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1180,
          "old_api": "tPutDiskDataHdr",
          "new_api": null,
          "old_text": "tPutDiskDataHdr(NULL, &hdr)",
          "new_text": null,
          "old_line_content": "  aBufN[3] = tPutDiskDataHdr(NULL, &hdr);",
          "new_line_content": "  // hdr",
          "content_same": false
        },
        {
          "line": 1438,
          "old_api": "IS_VAR_DATA_TYPE",
          "new_api": null,
          "old_text": "IS_VAR_DATA_TYPE(pColData->type)",
          "new_text": null,
          "old_line_content": "  if (IS_VAR_DATA_TYPE(pColData->type) && pColData->flag != (HAS_NULL | HAS_NONE)) {",
          "new_line_content": "  // offset",
          "content_same": false
        },
        {
          "line": 1183,
          "old_api": "tPutDiskDataHdr",
          "new_api": null,
          "old_text": "tPutDiskDataHdr(aBuf[3], &hdr)",
          "new_text": null,
          "old_line_content": "  tPutDiskDataHdr(aBuf[3], &hdr);",
          "new_line_content": "  if (code) goto _exit;",
          "content_same": false
        },
        {
          "line": 1188,
          "old_api": "tRealloc",
          "new_api": null,
          "old_text": "tRealloc(ppOut, *szOut)",
          "new_text": null,
          "old_line_content": "    code = tRealloc(ppOut, *szOut);",
          "new_line_content": "    *szOut = aBufN[0] + aBufN[1] + aBufN[2] + aBufN[3];",
          "content_same": false
        },
        {
          "line": 1191,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(*ppOut, aBuf[3], aBufN[3])",
          "new_text": null,
          "old_line_content": "    memcpy(*ppOut, aBuf[3], aBufN[3]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1447,
          "old_api": "tsdbCmprData",
          "new_api": null,
          "old_text": "tsdbCmprData((uint8_t *)pColData->pData, pColData->nData, pColData->type, cmprAlg, ppOut, nOut + size,\n                        &pBlockCol->szValue, ppBuf)",
          "new_text": null,
          "old_line_content": "    code = tsdbCmprData((uint8_t *)pColData->pData, pColData->nData, pColData->type, cmprAlg, ppOut, nOut + size,",
          "new_line_content": "  if ((pColData->flag != (HAS_NULL | HAS_NONE)) && pColData->nData) {",
          "content_same": false
        },
        {
          "line": 1194,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(*ppOut + aBufN[3] + aBufN[2], aBuf[1], aBufN[1])",
          "new_text": null,
          "old_line_content": "      memcpy(*ppOut + aBufN[3] + aBufN[2], aBuf[1], aBufN[1]);",
          "new_line_content": "    if (aBufN[1]) {",
          "content_same": false
        },
        {
          "line": 1324,
          "old_api": "tPutI16v",
          "new_api": null,
          "old_text": "tPutI16v(p ? p + n : p, pColAgg->colId)",
          "new_text": null,
          "old_line_content": "  n += tPutI16v(p ? p + n : p, pColAgg->colId);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1197,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(*ppOut + aBufN[3] + aBufN[2] + aBufN[1], aBuf[0], aBufN[0])",
          "new_text": null,
          "old_line_content": "      memcpy(*ppOut + aBufN[3] + aBufN[2] + aBufN[1], aBuf[0], aBufN[0]);",
          "new_line_content": "    if (aBufN[0]) {",
          "content_same": false
        },
        {
          "line": 1461,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(pColData->cid == pBlockCol->cid)",
          "new_text": null,
          "old_line_content": "  ASSERT(pColData->cid == pBlockCol->cid);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1208,
          "old_api": "tBlockDataReset",
          "new_api": null,
          "old_text": "tBlockDataReset(pBlockData)",
          "new_text": null,
          "old_line_content": "  tBlockDataReset(pBlockData);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1336,
          "old_api": "tGetI16v",
          "new_api": null,
          "old_text": "tGetI16v(p + n, &pColAgg->colId)",
          "new_text": null,
          "old_line_content": "  n += tGetI16v(p + n, &pColAgg->colId);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1214,
          "old_api": "tGetDiskDataHdr",
          "new_api": null,
          "old_text": "tGetDiskDataHdr(pIn + n, &hdr)",
          "new_text": null,
          "old_line_content": "  n += tGetDiskDataHdr(pIn + n, &hdr);",
          "new_line_content": "  // SDiskDataHdr",
          "content_same": false
        },
        {
          "line": 1473,
          "old_api": "BIT2_SIZE",
          "new_api": null,
          "old_text": "BIT2_SIZE(pColData->nVal)",
          "new_text": null,
          "old_line_content": "      szBitMap = BIT2_SIZE(pColData->nVal);",
          "new_line_content": "    if (pColData->flag == (HAS_VALUE | HAS_NULL | HAS_NONE)) {",
          "content_same": false
        },
        {
          "line": 1475,
          "old_api": "BIT1_SIZE",
          "new_api": null,
          "old_text": "BIT1_SIZE(pColData->nVal)",
          "new_text": null,
          "old_line_content": "      szBitMap = BIT1_SIZE(pColData->nVal);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 1349,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(szIn > 0 && ppOut)",
          "new_text": null,
          "old_line_content": "  ASSERT(szIn > 0 && ppOut);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1478,
          "old_api": "tsdbDecmprData",
          "new_api": null,
          "old_text": "tsdbDecmprData(p, pBlockCol->szBitmap, TSDB_DATA_TYPE_TINYINT, cmprAlg, &pColData->pBitMap, szBitMap, ppBuf)",
          "new_text": null,
          "old_line_content": "    code = tsdbDecmprData(p, pBlockCol->szBitmap, TSDB_DATA_TYPE_TINYINT, cmprAlg, &pColData->pBitMap, szBitMap, ppBuf);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1223,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(hdr.szUid)",
          "new_text": null,
          "old_line_content": "    ASSERT(hdr.szUid);",
          "new_line_content": "  if (hdr.uid == 0) {",
          "content_same": false
        },
        {
          "line": 1352,
          "old_api": "tRealloc",
          "new_api": null,
          "old_text": "tRealloc(ppOut, nOut + szIn)",
          "new_text": null,
          "old_line_content": "    code = tRealloc(ppOut, nOut + szIn);",
          "new_line_content": "  if (cmprAlg == NO_COMPRESSION) {",
          "content_same": false
        },
        {
          "line": 1355,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(*ppOut + nOut, pIn, szIn)",
          "new_text": null,
          "old_line_content": "    memcpy(*ppOut + nOut, pIn, szIn);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1228,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(!hdr.szUid)",
          "new_text": null,
          "old_line_content": "    ASSERT(!hdr.szUid);",
          "new_line_content": "  } else {",
          "content_same": false
        },
        {
          "line": 1101,
          "old_api": "tBlockDataGetColDataByIdx",
          "new_api": null,
          "old_text": "tBlockDataGetColDataByIdx(pBlockData, midx)",
          "new_text": null,
          "old_line_content": "    SColData *pColData = tBlockDataGetColDataByIdx(pBlockData, midx);",
          "new_line_content": "                              (pBlockData->aColData[ridx].cid - pBlockData->aColData[lidx].cid);",
          "content_same": false
        },
        {
          "line": 1485,
          "old_api": "tsdbDecmprData",
          "new_api": null,
          "old_text": "tsdbDecmprData(p, pBlockCol->szOffset, TSDB_DATA_TYPE_INT, cmprAlg, (uint8_t **)&pColData->aOffset,\n                          sizeof(int32_t) * pColData->nVal, ppBuf)",
          "new_text": null,
          "old_line_content": "    code = tsdbDecmprData(p, pBlockCol->szOffset, TSDB_DATA_TYPE_INT, cmprAlg, (uint8_t **)&pColData->aOffset,",
          "new_line_content": "  if (pBlockCol->szOffset) {",
          "content_same": false
        },
        {
          "line": 1360,
          "old_api": "tRealloc",
          "new_api": null,
          "old_text": "tRealloc(ppOut, nOut + size)",
          "new_text": null,
          "old_line_content": "    code = tRealloc(ppOut, nOut + size);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1233,
          "old_api": "tsdbDecmprData",
          "new_api": null,
          "old_text": "tsdbDecmprData(pIn + n, hdr.szVer, TSDB_DATA_TYPE_BIGINT, hdr.cmprAlg, (uint8_t **)&pBlockData->aVersion,\n                        sizeof(int64_t) * hdr.nRow, &aBuf[0])",
          "new_text": null,
          "old_line_content": "  code = tsdbDecmprData(pIn + n, hdr.szVer, TSDB_DATA_TYPE_BIGINT, hdr.cmprAlg, (uint8_t **)&pBlockData->aVersion,",
          "new_line_content": "  // version",
          "content_same": false
        },
        {
          "line": 1364,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(ppBuf)",
          "new_text": null,
          "old_line_content": "      ASSERT(ppBuf);",
          "new_line_content": "    if (cmprAlg == TWO_STAGE_COMP) {",
          "content_same": false
        },
        {
          "line": 1493,
          "old_api": "tsdbDecmprData",
          "new_api": null,
          "old_text": "tsdbDecmprData(p, pBlockCol->szValue, pColData->type, cmprAlg, &pColData->pData, pColData->nData, ppBuf)",
          "new_text": null,
          "old_line_content": "    code = tsdbDecmprData(p, pBlockCol->szValue, pColData->type, cmprAlg, &pColData->pData, pColData->nData, ppBuf);",
          "new_line_content": "  if (pBlockCol->szValue) {",
          "content_same": false
        },
        {
          "line": 1239,
          "old_api": "tsdbDecmprData",
          "new_api": null,
          "old_text": "tsdbDecmprData(pIn + n, hdr.szKey, TSDB_DATA_TYPE_TIMESTAMP, hdr.cmprAlg, (uint8_t **)&pBlockData->aTSKEY,\n                        sizeof(TSKEY) * hdr.nRow, &aBuf[0])",
          "new_text": null,
          "old_line_content": "  code = tsdbDecmprData(pIn + n, hdr.szKey, TSDB_DATA_TYPE_TIMESTAMP, hdr.cmprAlg, (uint8_t **)&pBlockData->aTSKEY,",
          "new_line_content": "  // TSKEY",
          "content_same": false
        },
        {
          "line": 1370,
          "old_api": "compFunc",
          "new_api": null,
          "old_text": "tDataTypes[type].compFunc(pIn, szIn, szIn / tDataTypes[type].bytes, *ppOut + nOut, size, cmprAlg, *ppBuf, size)",
          "new_text": null,
          "old_line_content": "        tDataTypes[type].compFunc(pIn, szIn, szIn / tDataTypes[type].bytes, *ppOut + nOut, size, cmprAlg, *ppBuf, size);",
          "new_line_content": "    *szOut =",
          "content_same": false
        },
        {
          "line": 1251,
          "old_api": "tGetBlockCol",
          "new_api": null,
          "old_text": "tGetBlockCol(pIn + n + nt, &blockCol)",
          "new_text": null,
          "old_line_content": "    nt += tGetBlockCol(pIn + n + nt, &blockCol);",
          "new_line_content": "    SBlockCol blockCol = {0};",
          "content_same": false
        },
        {
          "line": 1254,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(nt == hdr.szBlkCol)",
          "new_text": null,
          "old_line_content": "  ASSERT(nt == hdr.szBlkCol);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 1256,
          "old_api": "tBlockDataAdjustColData",
          "new_api": null,
          "old_text": "tBlockDataAdjustColData(pBlockData, nColData)",
          "new_text": null,
          "old_line_content": "  code = tBlockDataAdjustColData(pBlockData, nColData);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1385,
          "old_api": "tRealloc",
          "new_api": null,
          "old_text": "tRealloc(ppOut, szOut)",
          "new_text": null,
          "old_line_content": "  code = tRealloc(ppOut, szOut);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1132,
          "old_api": "tBlockDataGetColDataByIdx",
          "new_api": null,
          "old_text": "tBlockDataGetColDataByIdx(pBlockData, iColData)",
          "new_text": null,
          "old_line_content": "    SColData *pColData = tBlockDataGetColDataByIdx(pBlockData, iColData);",
          "new_line_content": "  for (int32_t iColData = 0; iColData < pBlockData->nColData; iColData++) {",
          "content_same": false
        },
        {
          "line": 1389,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(szIn == szOut)",
          "new_text": null,
          "old_line_content": "    ASSERT(szIn == szOut);",
          "new_line_content": "  if (cmprAlg == NO_COMPRESSION) {",
          "content_same": false
        },
        {
          "line": 1134,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(pColData->flag)",
          "new_text": null,
          "old_line_content": "    ASSERT(pColData->flag);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1263,
          "old_api": "tGetBlockCol",
          "new_api": null,
          "old_text": "tGetBlockCol(pIn + n + nt, &blockCol)",
          "new_text": null,
          "old_line_content": "    nt += tGetBlockCol(pIn + n + nt, &blockCol);",
          "new_line_content": "    SBlockCol blockCol = {0};",
          "content_same": false
        },
        {
          "line": 1393,
          "old_api": "tRealloc",
          "new_api": null,
          "old_text": "tRealloc(ppBuf, szOut + COMP_OVERFLOW_BYTES)",
          "new_text": null,
          "old_line_content": "      code = tRealloc(ppBuf, szOut + COMP_OVERFLOW_BYTES);",
          "new_line_content": "    if (cmprAlg == TWO_STAGE_COMP) {",
          "content_same": false
        },
        {
          "line": 1267,
          "old_api": "tColDataInit",
          "new_api": null,
          "old_text": "tColDataInit(pColData, blockCol.cid, blockCol.type, blockCol.smaOn)",
          "new_text": null,
          "old_line_content": "    tColDataInit(pColData, blockCol.cid, blockCol.type, blockCol.smaOn);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1397,
          "old_api": "decompFunc",
          "new_api": null,
          "old_text": "tDataTypes[type].decompFunc(pIn, szIn, szOut / tDataTypes[type].bytes, *ppOut, szOut, cmprAlg,\n                                               *ppBuf, szOut + COMP_OVERFLOW_BYTES)",
          "new_text": null,
          "old_line_content": "    int32_t size = tDataTypes[type].decompFunc(pIn, szIn, szOut / tDataTypes[type].bytes, *ppOut, szOut, cmprAlg,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1270,
          "old_api": "COL_VAL_NULL",
          "new_api": null,
          "old_text": "COL_VAL_NULL(blockCol.cid, blockCol.type)",
          "new_text": null,
          "old_line_content": "        code = tColDataAppendValue(pColData, &COL_VAL_NULL(blockCol.cid, blockCol.type));",
          "new_line_content": "      for (int32_t iRow = 0; iRow < hdr.nRow; iRow++) {",
          "content_same": false
        },
        {
          "line": 1145,
          "old_api": "tsdbCmprColData",
          "new_api": null,
          "old_text": "tsdbCmprColData(pColData, cmprAlg, &blockCol, &aBuf[0], aBufN[0], &aBuf[2])",
          "new_text": null,
          "old_line_content": "      code = tsdbCmprColData(pColData, cmprAlg, &blockCol, &aBuf[0], aBufN[0], &aBuf[2]);",
          "new_line_content": "    if (pColData->flag != HAS_NULL) {",
          "content_same": false
        },
        {
          "line": 1274,
          "old_api": "tsdbDecmprColData",
          "new_api": null,
          "old_text": "tsdbDecmprColData(pIn + n + hdr.szBlkCol + blockCol.offset, &blockCol, hdr.cmprAlg, hdr.nRow, pColData,\n                               &aBuf[0])",
          "new_text": null,
          "old_line_content": "      code = tsdbDecmprColData(pIn + n + hdr.szBlkCol + blockCol.offset, &blockCol, hdr.cmprAlg, hdr.nRow, pColData,",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 1404,
          "old_api": "ASSERT",
          "new_api": null,
          "old_text": "ASSERT(size == szOut)",
          "new_text": null,
          "old_line_content": "    ASSERT(size == szOut);",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 16,
      "total_additions": 55,
      "total_deletions": 55,
      "total_api_changes": 126
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 126,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          1100
        ]
      }
    },
    "api_calls_before": 333,
    "api_calls_after": 333,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 1,
      "total_diff_lines": 15
    }
  }
}