{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ceph/modified_file/7ba05a29163e1a81fb449e3231200e0bf55c1200",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ceph/modified_file/7ba05a29163e1a81fb449e3231200e0bf55c1200/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ceph/modified_file/7ba05a29163e1a81fb449e3231200e0bf55c1200/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ceph/modified_file/7ba05a29163e1a81fb449e3231200e0bf55c1200/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 5303,
          "old_api": "get",
          "new_api": "get_name",
          "old_text": "s->object.get()",
          "new_text": "s->object->get_name()",
          "old_line_content": "  if (!rgw::sal::Object::empty(s->object.get())) {",
          "new_line_content": "    original_object_name = s->object->get_name();",
          "content_same": false
        },
        {
          "line": 5331,
          "old_api": "get",
          "new_api": "get_name",
          "old_text": "s->object.get()",
          "new_text": "s->object->get_name()",
          "old_line_content": "  if (!rgw::sal::Object::empty(s->object.get())) {",
          "new_line_content": "    key_name = s->object->get_name();",
          "content_same": false
        },
        {
          "line": 5453,
          "old_api": "execute",
          "new_api": "complete",
          "old_text": "getop->execute(y)",
          "new_text": "getop->complete()",
          "old_line_content": "  getop->execute(y);",
          "new_line_content": "  getop->complete();",
          "content_same": false
        },
        {
          "line": 5625,
          "old_api": "get",
          "new_api": "c_str",
          "old_text": "info.args.get(\"PayloadHash\")",
          "new_text": "payload_hash.c_str()",
          "old_line_content": "    payload_hash = info.args.get(\"PayloadHash\");",
          "new_line_content": "    exp_payload_hash = payload_hash.c_str();",
          "content_same": false
        },
        {
          "line": 5629,
          "old_api": "empty",
          "new_api": "rgw::auth::s3::get_v4_exp_payload_hash(info)",
          "old_text": "content_hash.empty()",
          "new_text": "rgw::auth::s3::get_v4_exp_payload_hash(info)",
          "old_line_content": "    if (content_hash.empty()) {",
          "new_line_content": "      exp_payload_hash = rgw::auth::s3::get_v4_exp_payload_hash(info);",
          "content_same": false
        },
        {
          "line": 5649,
          "old_api": "std::move(canonical_uri)",
          "new_api": "std::move(canonical_qs)",
          "old_text": "std::move(canonical_uri)",
          "new_text": "std::move(canonical_qs)",
          "old_line_content": "                                         std::move(canonical_uri),",
          "new_line_content": "                                         std::move(canonical_qs),",
          "content_same": false
        },
        {
          "line": 5650,
          "old_api": "std::move(canonical_qs)",
          "new_api": "std::move(canonical_headers)",
          "old_text": "std::move(canonical_qs)",
          "new_text": "std::move(canonical_headers)",
          "old_line_content": "                                         std::move(canonical_qs),",
          "new_line_content": "                                         std::move(canonical_headers),",
          "content_same": false
        },
        {
          "line": 5682,
          "old_api": "std::move(signed_hdrs)",
          "new_api": "std::move(string_to_sign)",
          "old_text": "std::move(signed_hdrs)",
          "new_text": "std::move(string_to_sign)",
          "old_line_content": "    std::move(signed_hdrs),",
          "new_line_content": "    std::move(string_to_sign),",
          "content_same": false
        },
        {
          "line": 5683,
          "old_api": "std::move(string_to_sign)",
          "new_api": "std::move(extra_headers)",
          "old_text": "std::move(string_to_sign)",
          "new_text": "std::move(extra_headers)",
          "old_line_content": "    std::move(string_to_sign),",
          "new_line_content": "    std::move(extra_headers),",
          "content_same": false
        },
        {
          "line": 5760,
          "old_api": "get",
          "new_api": "c_str",
          "old_text": "s->info.args.get(\"PayloadHash\")",
          "new_text": "payload_hash.c_str()",
          "old_line_content": "    payload_hash = s->info.args.get(\"PayloadHash\");",
          "new_line_content": "    exp_payload_hash = payload_hash.c_str();",
          "content_same": false
        },
        {
          "line": 5778,
          "old_api": "rgw::auth::s3::get_v4_canon_req_hash(s->cct,\n                                         std::move(canonical_method),\n                                         std::move(canonical_uri),\n                                         std::move(canonical_qs),\n                                         std::move(*canonical_headers),\n                                         signed_hdrs,\n                                         exp_payload_hash,\n                                         s)",
          "new_api": "std::move(canonical_method)",
          "old_text": "rgw::auth::s3::get_v4_canon_req_hash(s->cct,\n                                         std::move(canonical_method),\n                                         std::move(canonical_uri),\n                                         std::move(canonical_qs),\n                                         std::move(*canonical_headers),\n                                         signed_hdrs,\n                                         exp_payload_hash,\n                                         s)",
          "new_text": "std::move(canonical_method)",
          "old_line_content": "    rgw::auth::s3::get_v4_canon_req_hash(s->cct,",
          "new_line_content": "                                         std::move(canonical_method),",
          "content_same": false
        },
        {
          "line": 5779,
          "old_api": "std::move(canonical_method)",
          "new_api": "std::move(canonical_uri)",
          "old_text": "std::move(canonical_method)",
          "new_text": "std::move(canonical_uri)",
          "old_line_content": "                                         std::move(canonical_method),",
          "new_line_content": "                                         std::move(canonical_uri),",
          "content_same": false
        },
        {
          "line": 5780,
          "old_api": "std::move(canonical_uri)",
          "new_api": "std::move(canonical_qs)",
          "old_text": "std::move(canonical_uri)",
          "new_text": "std::move(canonical_qs)",
          "old_line_content": "                                         std::move(canonical_uri),",
          "new_line_content": "                                         std::move(canonical_qs),",
          "content_same": false
        },
        {
          "line": 5781,
          "old_api": "std::move(canonical_qs)",
          "new_api": "std::move(*canonical_headers)",
          "old_text": "std::move(canonical_qs)",
          "new_text": "std::move(*canonical_headers)",
          "old_line_content": "                                         std::move(canonical_qs),",
          "new_line_content": "                                         std::move(*canonical_headers),",
          "content_same": false
        },
        {
          "line": 5830,
          "old_api": "is_v4_payload_streamed",
          "new_api": "ldpp_dout",
          "old_text": "is_v4_payload_streamed(exp_payload_hash)",
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "    if (!is_v4_payload_streamed(exp_payload_hash)) {",
          "new_line_content": "      ldpp_dout(s, 10) << \"delaying v4 auth\" << dendl;",
          "content_same": false
        },
        {
          "line": 5963,
          "old_api": "get",
          "new_api": "empty",
          "old_text": "s->info.args.get(\"Expires\")",
          "new_text": "expires.empty()",
          "old_line_content": "    std::string_view expires = s->info.args.get(\"Expires\");",
          "new_line_content": "    if (expires.empty()) {",
          "content_same": false
        },
        {
          "line": 5977,
          "old_api": "exists",
          "new_api": "get",
          "old_text": "s->info.args.exists(\"x-amz-security-token\")",
          "new_text": "s->info.args.get(\"x-amz-security-token\")",
          "old_line_content": "    if (s->info.args.exists(\"x-amz-security-token\")) {",
          "new_line_content": "      session_token = s->info.args.get(\"x-amz-security-token\");",
          "content_same": false
        },
        {
          "line": 5978,
          "old_api": "get",
          "new_api": "size",
          "old_text": "s->info.args.get(\"x-amz-security-token\")",
          "new_text": "session_token.size()",
          "old_line_content": "      session_token = s->info.args.get(\"x-amz-security-token\");",
          "new_line_content": "      if (session_token.size() == 0) {",
          "content_same": false
        },
        {
          "line": 5986,
          "old_api": "strlen",
          "new_api": "rfind",
          "old_text": "strlen(\"AWS \")",
          "new_text": "auth_str.rfind(':')",
          "old_line_content": "    const std::string_view auth_str(http_auth + strlen(\"AWS \"));",
          "new_line_content": "    const size_t pos = auth_str.rfind(':');",
          "content_same": false
        },
        {
          "line": 6020,
          "old_api": "std::move(access_key_id)",
          "new_api": "std::move(signature)",
          "old_text": "std::move(access_key_id)",
          "new_text": "std::move(signature)",
          "old_line_content": "    std::move(access_key_id),",
          "new_line_content": "    std::move(signature),",
          "content_same": false
        },
        {
          "line": 6021,
          "old_api": "std::move(signature)",
          "new_api": "std::move(session_token)",
          "old_text": "std::move(signature)",
          "new_text": "std::move(session_token)",
          "old_line_content": "    std::move(signature),",
          "new_line_content": "    std::move(session_token),",
          "content_same": false
        },
        {
          "line": 6022,
          "old_api": "std::move(session_token)",
          "new_api": "std::move(string_to_sign)",
          "old_text": "std::move(session_token)",
          "new_text": "std::move(string_to_sign)",
          "old_line_content": "    std::move(session_token),",
          "new_line_content": "    std::move(string_to_sign),",
          "content_same": false
        },
        {
          "line": 6049,
          "old_api": "find",
          "new_api": "substr",
          "old_text": "credential.find(\"/\")",
          "new_text": "credential.substr(0, pos)",
          "old_line_content": "  const size_t pos = credential.find(\"/\");",
          "new_line_content": "  const std::string_view access_key_id = credential.substr(0, pos);",
          "content_same": false
        },
        {
          "line": 6050,
          "old_api": "substr",
          "new_api": "ldpp_dout",
          "old_text": "credential.substr(0, pos)",
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "  const std::string_view access_key_id = credential.substr(0, pos);",
          "new_line_content": "  ldpp_dout(s, 10) << \"access key id = \" << access_key_id << dendl;",
          "content_same": false
        },
        {
          "line": 6054,
          "old_api": "substr",
          "new_api": "ldpp_dout",
          "old_text": "credential.substr(pos + 1)",
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "  const std::string_view credential_scope = credential.substr(pos + 1);",
          "new_line_content": "  ldpp_dout(s, 10) << \"credential scope = \" << credential_scope << dendl;",
          "content_same": false
        },
        {
          "line": 6082,
          "old_api": "ldpp_dout",
          "new_api": "get_auth_data_v2",
          "old_text": "ldpp_dout(s, 0)",
          "new_text": "get_auth_data_v2(s)",
          "old_line_content": "    ldpp_dout(s, 0) << \"Signature verification algorithm AWS v2\" << dendl;",
          "new_line_content": "    return get_auth_data_v2(s);",
          "content_same": false
        },
        {
          "line": 6093,
          "old_api": "empty",
          "new_api": "result_t::deny(-EINVAL)",
          "old_text": "auth_data.client_signature.empty()",
          "new_text": "result_t::deny(-EINVAL)",
          "old_line_content": "  if (auth_data.access_key_id.empty() || auth_data.client_signature.empty()) {",
          "new_line_content": "    return result_t::deny(-EINVAL);",
          "content_same": false
        },
        {
          "line": 6132,
          "old_api": "init",
          "new_api": "bind",
          "old_text": "ldh->init()",
          "new_text": "ldh->bind()",
          "old_line_content": "      ldh->init();",
          "new_line_content": "      ldh->bind();",
          "content_same": false
        },
        {
          "line": 6190,
          "old_api": "valid",
          "new_api": "result_t::deny()",
          "old_text": "base64_token.valid()",
          "new_text": "result_t::deny()",
          "old_line_content": "  if (! base64_token.valid()) {",
          "new_line_content": "    return result_t::deny();",
          "content_same": false
        },
        {
          "line": 6206,
          "old_api": "auth",
          "new_api": "result_t::deny(-ERR_INVALID_ACCESS_KEY)",
          "old_text": "ldh->auth(base64_token.id, base64_token.key)",
          "new_text": "result_t::deny(-ERR_INVALID_ACCESS_KEY)",
          "old_line_content": "  if (ldh->auth(base64_token.id, base64_token.key) != 0) {",
          "new_line_content": "    return result_t::deny(-ERR_INVALID_ACCESS_KEY);",
          "content_same": false
        },
        {
          "line": 6210,
          "old_api": "get_acl_strategy",
          "new_api": "get_creds_info",
          "old_text": "get_acl_strategy()",
          "new_text": "get_creds_info(base64_token)",
          "old_line_content": "  auto apl = apl_factory->create_apl_remote(cct, s, get_acl_strategy(),",
          "new_line_content": "                                            get_creds_info(base64_token));",
          "content_same": false
        },
        {
          "line": 6211,
          "old_api": "get_creds_info",
          "new_api": "completer_factory",
          "old_text": "get_creds_info(base64_token)",
          "new_text": "completer_factory(boost::none)",
          "old_line_content": "                                            get_creds_info(base64_token));",
          "new_line_content": "  return result_t::grant(std::move(apl), completer_factory(boost::none));",
          "content_same": false
        },
        {
          "line": 6239,
          "old_api": "get_user_by_access_key",
          "new_api": "ldpp_dout",
          "old_text": "driver->get_user_by_access_key(dpp, access_key_id, y, &user)",
          "new_text": "ldpp_dout(dpp, 5)",
          "old_line_content": "  if (driver->get_user_by_access_key(dpp, access_key_id, y, &user) < 0) {",
          "new_line_content": "      ldpp_dout(dpp, 5) << \"error reading user info, uid=\" << access_key_id",
          "content_same": false
        },
        {
          "line": 6253,
          "old_api": "find",
          "new_api": "get_info",
          "old_text": "user->get_info().access_keys.find(access_key_id)",
          "new_text": "user->get_info()",
          "old_line_content": "  const auto iter = user->get_info().access_keys.find(access_key_id);",
          "new_line_content": "  if (iter == std::end(user->get_info().access_keys)) {",
          "content_same": false
        },
        {
          "line": 6254,
          "old_api": "get_info",
          "new_api": "ldpp_dout",
          "old_text": "user->get_info()",
          "new_text": "ldpp_dout(dpp, 0)",
          "old_line_content": "  if (iter == std::end(user->get_info().access_keys)) {",
          "new_line_content": "    ldpp_dout(dpp, 0) << \"ERROR: access key not encoded in user info\" << dendl;",
          "content_same": false
        },
        {
          "line": 6255,
          "old_api": "ldpp_dout",
          "new_api": "result_t::reject(-EPERM)",
          "old_text": "ldpp_dout(dpp, 0)",
          "new_text": "result_t::reject(-EPERM)",
          "old_line_content": "    ldpp_dout(dpp, 0) << \"ERROR: access key not encoded in user info\" << dendl;",
          "new_line_content": "    return result_t::reject(-EPERM);",
          "content_same": false
        },
        {
          "line": 6261,
          "old_api": "signature_factory",
          "new_api": "compare",
          "old_text": "signature_factory(cct, k.key, string_to_sign)",
          "new_text": "signature.compare(server_signature)",
          "old_line_content": "    signature_factory(cct, k.key, string_to_sign);",
          "new_line_content": "  auto compare = signature.compare(server_signature);",
          "content_same": false
        },
        {
          "line": 6316,
          "old_api": "validate_secret",
          "new_api": "ldpp_dout",
          "old_text": "cryptohandler->validate_secret(secret)",
          "new_text": "ldpp_dout(dpp, 0)",
          "old_line_content": "  if (ret = cryptohandler->validate_secret(secret); ret < 0) {",
          "new_line_content": "    ldpp_dout(dpp, 0) << \"ERROR: Invalid secret key\" << dendl;",
          "content_same": false
        },
        {
          "line": 6337,
          "old_api": "append",
          "new_api": "cbegin",
          "old_text": "dec_output.append('\\0')",
          "new_text": "dec_output.cbegin()",
          "old_line_content": "      dec_output.append('\\0');",
          "new_line_content": "      auto iter = dec_output.cbegin();",
          "content_same": false
        },
        {
          "line": 6338,
          "old_api": "cbegin",
          "new_api": "decode",
          "old_text": "dec_output.cbegin()",
          "new_text": "decode(token, iter)",
          "old_line_content": "      auto iter = dec_output.cbegin();",
          "new_line_content": "      decode(token, iter);",
          "content_same": false
        },
        {
          "line": 6361,
          "old_api": "exists",
          "new_api": "empty",
          "old_text": "s->info.env->exists(\"HTTP_X_AMZ_SECURITY_TOKEN\")",
          "new_text": "s->auth.s3_postobj_creds.x_amz_security_token.empty()",
          "old_line_content": "      ! s->info.env->exists(\"HTTP_X_AMZ_SECURITY_TOKEN\") &&",
          "new_line_content": "      s->auth.s3_postobj_creds.x_amz_security_token.empty()) {",
          "content_same": false
        },
        {
          "line": 6362,
          "old_api": "empty",
          "new_api": "result_t::deny()",
          "old_text": "s->auth.s3_postobj_creds.x_amz_security_token.empty()",
          "new_text": "result_t::deny()",
          "old_line_content": "      s->auth.s3_postobj_creds.x_amz_security_token.empty()) {",
          "new_line_content": "    return result_t::deny();",
          "content_same": false
        },
        {
          "line": 6367,
          "old_api": "get_session_token",
          "new_api": "result_t::reject(ret)",
          "old_text": "get_session_token(dpp, session_token, token)",
          "new_text": "result_t::reject(ret)",
          "old_line_content": "  if (int ret = get_session_token(dpp, session_token, token); ret < 0) {",
          "new_line_content": "    return result_t::reject(ret);",
          "content_same": false
        },
        {
          "line": 6373,
          "old_api": "ldpp_dout",
          "new_api": "result_t::reject(-EPERM)",
          "old_text": "ldpp_dout(dpp, 0)",
          "new_text": "result_t::reject(-EPERM)",
          "old_line_content": "    ldpp_dout(dpp, 0) << \"Invalid access key\" << dendl;",
          "new_line_content": "    return result_t::reject(-EPERM);",
          "content_same": false
        },
        {
          "line": 6379,
          "old_api": "empty",
          "new_api": "ceph::from_iso_8601(expiration, false)",
          "old_text": "expiration.empty()",
          "new_text": "ceph::from_iso_8601(expiration, false)",
          "old_line_content": "    if (! expiration.empty()) {",
          "new_line_content": "      boost::optional<real_clock::time_point> exp = ceph::from_iso_8601(expiration, false);",
          "content_same": false
        },
        {
          "line": 6384,
          "old_api": "ldpp_dout",
          "new_api": "result_t::reject(-EPERM)",
          "old_text": "ldpp_dout(dpp, 0)",
          "new_text": "result_t::reject(-EPERM)",
          "old_line_content": "          ldpp_dout(dpp, 0) << \"ERROR: Token expired\" << dendl;",
          "new_line_content": "          return result_t::reject(-EPERM);",
          "content_same": false
        },
        {
          "line": 6388,
          "old_api": "ldpp_dout",
          "new_api": "result_t::reject(-EPERM)",
          "old_text": "ldpp_dout(dpp, 0)",
          "new_text": "result_t::reject(-EPERM)",
          "old_line_content": "        ldpp_dout(dpp, 0) << \"ERROR: Invalid expiration: \" << expiration << dendl;",
          "new_line_content": "        return result_t::reject(-EPERM);",
          "content_same": false
        },
        {
          "line": 6395,
          "old_api": "signature_factory",
          "new_api": "compare",
          "old_text": "signature_factory(cct, token.secret_access_key, string_to_sign)",
          "new_text": "signature.compare(server_signature)",
          "old_line_content": "    signature_factory(cct, token.secret_access_key, string_to_sign);",
          "new_line_content": "  auto compare = signature.compare(server_signature);",
          "content_same": false
        },
        {
          "line": 6415,
          "old_api": "empty",
          "new_api": "get_role",
          "old_text": "token.roleId.empty()",
          "new_text": "driver->get_role(token.roleId)",
          "old_line_content": "  if (! token.roleId.empty()) {",
          "new_line_content": "    std::unique_ptr<rgw::sal::RGWRole> role = driver->get_role(token.roleId);",
          "content_same": false
        },
        {
          "line": 6416,
          "old_api": "get_role",
          "new_api": "get_by_id",
          "old_text": "driver->get_role(token.roleId)",
          "new_text": "role->get_by_id(dpp, y)",
          "old_line_content": "    std::unique_ptr<rgw::sal::RGWRole> role = driver->get_role(token.roleId);",
          "new_line_content": "    if (role->get_by_id(dpp, y) < 0) {",
          "content_same": false
        },
        {
          "line": 6417,
          "old_api": "get_by_id",
          "new_api": "result_t::deny(-EPERM)",
          "old_text": "role->get_by_id(dpp, y)",
          "new_text": "result_t::deny(-EPERM)",
          "old_line_content": "    if (role->get_by_id(dpp, y) < 0) {",
          "new_line_content": "      return result_t::deny(-EPERM);",
          "content_same": false
        },
        {
          "line": 6421,
          "old_api": "get_name",
          "new_api": "get_tenant",
          "old_text": "role->get_name()",
          "new_text": "role->get_tenant()",
          "old_line_content": "    r.name = role->get_name();",
          "new_line_content": "    r.tenant = role->get_tenant();",
          "content_same": false
        },
        {
          "line": 6427,
          "old_api": "get_role_policy",
          "new_api": "std::move(perm_policy)",
          "old_text": "role->get_role_policy(dpp, policy_name, perm_policy)",
          "new_text": "std::move(perm_policy)",
          "old_line_content": "      if (int ret = role->get_role_policy(dpp, policy_name, perm_policy); ret == 0) {",
          "new_line_content": "        r.role_policies.push_back(std::move(perm_policy));",
          "content_same": false
        },
        {
          "line": 6433,
          "old_api": "get_user",
          "new_api": "empty",
          "old_text": "driver->get_user(token.user)",
          "new_text": "token.user.empty()",
          "old_line_content": "  user = driver->get_user(token.user);",
          "new_line_content": "  if (! token.user.empty() && token.acct_type != TYPE_ROLE) {",
          "content_same": false
        },
        {
          "line": 6438,
          "old_api": "ldpp_dout",
          "new_api": "result_t::reject(-EPERM)",
          "old_text": "ldpp_dout(dpp, 5)",
          "new_text": "result_t::reject(-EPERM)",
          "old_line_content": "      ldpp_dout(dpp, 5) << \"ERROR: failed reading user info: uid=\" << token.user << dendl;",
          "new_line_content": "      return result_t::reject(-EPERM);",
          "content_same": false
        },
        {
          "line": 6444,
          "old_api": "get_acl_strategy",
          "new_api": "get_creds_info",
          "old_text": "get_acl_strategy()",
          "new_text": "get_creds_info(token)",
          "old_line_content": "    auto apl = remote_apl_factory->create_apl_remote(cct, s, get_acl_strategy(),",
          "new_line_content": "                                            get_creds_info(token));",
          "content_same": false
        },
        {
          "line": 6445,
          "old_api": "get_creds_info",
          "new_api": "completer_factory",
          "old_text": "get_creds_info(token)",
          "new_text": "completer_factory(token.secret_access_key)",
          "old_line_content": "                                            get_creds_info(token));",
          "new_line_content": "    return result_t::grant(std::move(apl), completer_factory(token.secret_access_key));",
          "content_same": false
        },
        {
          "line": 6448,
          "old_api": "std::move(token.user)",
          "new_api": "std::move(token.policy)",
          "old_text": "std::move(token.user)",
          "new_text": "std::move(token.policy)",
          "old_line_content": "    t_attrs.user_id = std::move(token.user); // This is mostly needed to assign the owner of a bucket during its creation",
          "new_line_content": "    t_attrs.token_policy = std::move(token.policy);",
          "content_same": false
        },
        {
          "line": 6449,
          "old_api": "std::move(token.policy)",
          "new_api": "std::move(token.role_session)",
          "old_text": "std::move(token.policy)",
          "new_text": "std::move(token.role_session)",
          "old_line_content": "    t_attrs.token_policy = std::move(token.policy);",
          "new_line_content": "    t_attrs.role_session_name = std::move(token.role_session);",
          "content_same": false
        },
        {
          "line": 6450,
          "old_api": "std::move(token.role_session)",
          "new_api": "std::move(token.token_claims)",
          "old_text": "std::move(token.role_session)",
          "new_text": "std::move(token.token_claims)",
          "old_line_content": "    t_attrs.role_session_name = std::move(token.role_session);",
          "new_line_content": "    t_attrs.token_claims = std::move(token.token_claims);",
          "content_same": false
        },
        {
          "line": 6451,
          "old_api": "std::move(token.token_claims)",
          "new_api": "std::move(token.issued_at)",
          "old_text": "std::move(token.token_claims)",
          "new_text": "std::move(token.issued_at)",
          "old_line_content": "    t_attrs.token_claims = std::move(token.token_claims);",
          "new_line_content": "    t_attrs.token_issued_at = std::move(token.issued_at);",
          "content_same": false
        },
        {
          "line": 6452,
          "old_api": "std::move(token.issued_at)",
          "new_api": "std::move(token.principal_tags)",
          "old_text": "std::move(token.issued_at)",
          "new_text": "std::move(token.principal_tags)",
          "old_line_content": "    t_attrs.token_issued_at = std::move(token.issued_at);",
          "new_line_content": "    t_attrs.principal_tags = std::move(token.principal_tags);",
          "content_same": false
        },
        {
          "line": 6453,
          "old_api": "std::move(token.principal_tags)",
          "new_api": "create_apl_role",
          "old_text": "std::move(token.principal_tags)",
          "new_text": "role_apl_factory->create_apl_role(cct, s, r, t_attrs)",
          "old_line_content": "    t_attrs.principal_tags = std::move(token.principal_tags);",
          "new_line_content": "    auto apl = role_apl_factory->create_apl_role(cct, s, r, t_attrs);",
          "content_same": false
        },
        {
          "line": 6454,
          "old_api": "create_apl_role",
          "new_api": "completer_factory",
          "old_text": "role_apl_factory->create_apl_role(cct, s, r, t_attrs)",
          "new_text": "completer_factory(token.secret_access_key)",
          "old_line_content": "    auto apl = role_apl_factory->create_apl_role(cct, s, r, t_attrs);",
          "new_line_content": "    return result_t::grant(std::move(apl), completer_factory(token.secret_access_key));",
          "content_same": false
        },
        {
          "line": 6458,
          "old_api": "std::string(_access_key_id)",
          "new_api": "completer_factory",
          "old_text": "std::string(_access_key_id)",
          "new_text": "completer_factory(token.secret_access_key)",
          "old_line_content": "    auto apl = local_apl_factory->create_apl_local(cct, s, user->get_info(), subuser, token.perm_mask, std::string(_access_key_id));",
          "new_line_content": "    return result_t::grant(std::move(apl), completer_factory(token.secret_access_key));",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 5636,
          "old_api": null,
          "new_api": "rgw::auth::s3::gen_v4_canonical_uri(info)",
          "old_text": null,
          "new_text": "rgw::auth::s3::gen_v4_canonical_uri(info)",
          "old_line_content": "  /* Craft canonical URI. Using std::move later so let it be non-const. */",
          "new_line_content": "  auto canonical_uri = rgw::auth::s3::gen_v4_canonical_uri(info);",
          "content_same": false
        },
        {
          "line": 5640,
          "old_api": null,
          "new_api": "rgw::auth::s3::gen_v4_canonical_qs(info, is_non_s3_op)",
          "old_text": null,
          "new_text": "rgw::auth::s3::gen_v4_canonical_qs(info, is_non_s3_op)",
          "old_line_content": "  /* Craft canonical query string. std::moving later so non-const here. */",
          "new_line_content": "  auto canonical_qs = rgw::auth::s3::gen_v4_canonical_qs(info, is_non_s3_op);",
          "content_same": false
        },
        {
          "line": 5642,
          "old_api": null,
          "new_api": "get_cct",
          "old_text": null,
          "new_text": "dpp->get_cct()",
          "old_line_content": "",
          "new_line_content": "  auto cct = dpp->get_cct();",
          "content_same": false
        },
        {
          "line": 5646,
          "old_api": null,
          "new_api": "rgw::auth::s3::get_v4_canon_req_hash(cct,\n                                         info.method,\n                                         std::move(canonical_uri),\n                                         std::move(canonical_qs),\n                                         std::move(canonical_headers),\n                                         signed_hdrs,\n                                         exp_payload_hash,\n                                         dpp)",
          "old_text": null,
          "new_text": "rgw::auth::s3::get_v4_canon_req_hash(cct,\n                                         info.method,\n                                         std::move(canonical_uri),\n                                         std::move(canonical_qs),\n                                         std::move(canonical_headers),\n                                         signed_hdrs,\n                                         exp_payload_hash,\n                                         dpp)",
          "old_line_content": "  auto canonical_req_hash = \\",
          "new_line_content": "    rgw::auth::s3::get_v4_canon_req_hash(cct,",
          "content_same": false
        },
        {
          "line": 6159,
          "old_api": null,
          "new_api": "rgw_user",
          "old_text": null,
          "new_text": "rgw_user(token.id)",
          "old_line_content": "  return rgw::auth::RemoteApplier::AuthInfo {",
          "new_line_content": "    rgw_user(token.id),",
          "content_same": false
        },
        {
          "line": 5648,
          "old_api": null,
          "new_api": "std::move(canonical_uri)",
          "old_text": null,
          "new_text": "std::move(canonical_uri)",
          "old_line_content": "                                         info.method,",
          "new_line_content": "                                         std::move(canonical_uri),",
          "content_same": false
        },
        {
          "line": 5656,
          "old_api": null,
          "new_api": "rgw::auth::s3::get_v4_string_to_sign(cct,\n                                         AWS4_HMAC_SHA256_STR,\n                                         date,\n                                         credential_scope,\n                                         std::move(canonical_req_hash),\n                                         dpp)",
          "old_text": null,
          "new_text": "rgw::auth::s3::get_v4_string_to_sign(cct,\n                                         AWS4_HMAC_SHA256_STR,\n                                         date,\n                                         credential_scope,\n                                         std::move(canonical_req_hash),\n                                         dpp)",
          "old_line_content": "  auto string_to_sign = \\",
          "new_line_content": "    rgw::auth::s3::get_v4_string_to_sign(cct,",
          "content_same": false
        },
        {
          "line": 5660,
          "old_api": null,
          "new_api": "std::move(canonical_req_hash)",
          "old_text": null,
          "new_text": "std::move(canonical_req_hash)",
          "old_line_content": "                                         credential_scope,",
          "new_line_content": "                                         std::move(canonical_req_hash),",
          "content_same": false
        },
        {
          "line": 6184,
          "old_api": null,
          "new_api": "rgw::from_base64(access_key_id)",
          "old_text": null,
          "new_text": "rgw::from_base64(access_key_id)",
          "old_line_content": "  try {",
          "new_line_content": "    base64_token = rgw::from_base64(access_key_id);",
          "content_same": false
        },
        {
          "line": 6186,
          "old_api": null,
          "new_api": "std::string(\"\")",
          "old_text": null,
          "new_text": "std::string(\"\")",
          "old_line_content": "  } catch (...) {",
          "new_line_content": "    base64_token = std::string(\"\");",
          "content_same": false
        },
        {
          "line": 6189,
          "old_api": null,
          "new_api": "valid",
          "old_text": null,
          "new_text": "base64_token.valid()",
          "old_line_content": "",
          "new_line_content": "  if (! base64_token.valid()) {",
          "content_same": false
        },
        {
          "line": 5681,
          "old_api": null,
          "new_api": "std::move(signed_hdrs)",
          "old_text": null,
          "new_text": "std::move(signed_hdrs)",
          "old_line_content": "    credential_scope,",
          "new_line_content": "    std::move(signed_hdrs),",
          "content_same": false
        },
        {
          "line": 5693,
          "old_api": null,
          "new_api": "get_cct",
          "old_text": null,
          "new_text": "rgw::auth::s3::get_v4_signature(sig_info.scope,\n                                                   dpp->get_cct(),\n                                                   secret_key,\n                                                   sig_info.string_to_sign,\n                                                   dpp)",
          "old_line_content": "{",
          "new_line_content": "  auto signature = rgw::auth::s3::get_v4_signature(sig_info.scope,",
          "content_same": false
        },
        {
          "line": 6205,
          "old_api": null,
          "new_api": "auth",
          "old_text": null,
          "new_text": "ldh->auth(base64_token.id, base64_token.key)",
          "old_line_content": "",
          "new_line_content": "  if (ldh->auth(base64_token.id, base64_token.key) != 0) {",
          "content_same": false
        },
        {
          "line": 6209,
          "old_api": null,
          "new_api": "get_acl_strategy",
          "old_text": null,
          "new_text": "get_acl_strategy()",
          "old_line_content": "",
          "new_line_content": "  auto apl = apl_factory->create_apl_remote(cct, s, get_acl_strategy(),",
          "content_same": false
        },
        {
          "line": 5704,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "payload_hash.empty()",
          "old_line_content": "  auto& payload_hash = result[\"x-amz-content-sha256\"];",
          "new_line_content": "  if (payload_hash.empty()) {",
          "content_same": false
        },
        {
          "line": 5707,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "string(\"AWS4-HMAC-SHA256 Credential=\").append(sig_info.access_key_id)",
          "old_line_content": "  }",
          "new_line_content": "  string auth_header = string(\"AWS4-HMAC-SHA256 Credential=\").append(sig_info.access_key_id) + \"/\";",
          "content_same": false
        },
        {
          "line": 6238,
          "old_api": null,
          "new_api": "get_user_by_access_key",
          "old_text": null,
          "new_text": "driver->get_user_by_access_key(dpp, access_key_id, y, &user)",
          "old_line_content": "  /* TODO(rzarzynski): we need to have string-view taking variant. */",
          "new_line_content": "  if (driver->get_user_by_access_key(dpp, access_key_id, y, &user) < 0) {",
          "content_same": false
        },
        {
          "line": 5729,
          "old_api": null,
          "new_api": "rgw::auth::s3::parse_v4_credentials(s->info,\n\t\t\t\t\t\taccess_key_id,\n\t\t\t\t\t\tcredential_scope,\n\t\t\t\t\t\tsigned_hdrs,\n\t\t\t\t\t\tclient_signature,\n\t\t\t\t\t\tdate,\n\t\t\t\t\t\tsession_token,\n\t\t\t\t\t\tusing_qs,\n                                                s)",
          "old_text": null,
          "new_text": "rgw::auth::s3::parse_v4_credentials(s->info,\n\t\t\t\t\t\taccess_key_id,\n\t\t\t\t\t\tcredential_scope,\n\t\t\t\t\t\tsigned_hdrs,\n\t\t\t\t\t\tclient_signature,\n\t\t\t\t\t\tdate,\n\t\t\t\t\t\tsession_token,\n\t\t\t\t\t\tusing_qs,\n                                                s)",
          "old_line_content": "",
          "new_line_content": "  int ret = rgw::auth::s3::parse_v4_credentials(s->info,",
          "content_same": false
        },
        {
          "line": 6241,
          "old_api": null,
          "new_api": "result_t::reject(-ERR_INVALID_ACCESS_KEY)",
          "old_text": null,
          "new_text": "result_t::reject(-ERR_INVALID_ACCESS_KEY)",
          "old_line_content": "              << \" can't authenticate\" << dendl;",
          "new_line_content": "      return result_t::reject(-ERR_INVALID_ACCESS_KEY);",
          "content_same": false
        },
        {
          "line": 6252,
          "old_api": null,
          "new_api": "find",
          "old_text": null,
          "new_text": "user->get_info().access_keys.find(access_key_id)",
          "old_line_content": "",
          "new_line_content": "  const auto iter = user->get_info().access_keys.find(access_key_id);",
          "content_same": false
        },
        {
          "line": 5744,
          "old_api": null,
          "new_api": "get_v4_canonical_headers",
          "old_text": null,
          "new_text": "get_v4_canonical_headers(s->info, signed_hdrs, using_qs)",
          "old_line_content": "  boost::optional<std::string> canonical_headers = \\",
          "new_line_content": "    get_v4_canonical_headers(s->info, signed_hdrs, using_qs);",
          "content_same": false
        },
        {
          "line": 5747,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "    using sanitize = rgw::crypt_sanitize::log_content;",
          "new_line_content": "    ldpp_dout(s, 10) << \"canonical headers format = \"",
          "content_same": false
        },
        {
          "line": 6260,
          "old_api": null,
          "new_api": "signature_factory",
          "old_text": null,
          "new_text": "signature_factory(cct, k.key, string_to_sign)",
          "old_line_content": "  const VersionAbstractor::server_signature_t server_signature = \\",
          "new_line_content": "    signature_factory(cct, k.key, string_to_sign);",
          "content_same": false
        },
        {
          "line": 6263,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(dpp, 15)",
          "old_line_content": "",
          "new_line_content": "  ldpp_dout(dpp, 15) << \"string_to_sign=\"",
          "content_same": false
        },
        {
          "line": 5753,
          "old_api": null,
          "new_api": "rgw::auth::s3::is_non_s3_op(s->op_type)",
          "old_text": null,
          "new_text": "rgw::auth::s3::is_non_s3_op(s->op_type)",
          "old_line_content": "",
          "new_line_content": "  bool is_non_s3_op = rgw::auth::s3::is_non_s3_op(s->op_type);",
          "content_same": false
        },
        {
          "line": 6266,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(dpp, 15)",
          "old_line_content": "                 << dendl;",
          "new_line_content": "  ldpp_dout(dpp, 15) << \"server signature=\" << server_signature << dendl;",
          "content_same": false
        },
        {
          "line": 5759,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "s->info.args.get(\"PayloadHash\")",
          "old_line_content": "    //For non s3 ops, we need to calculate the payload hash",
          "new_line_content": "    payload_hash = s->info.args.get(\"PayloadHash\");",
          "content_same": false
        },
        {
          "line": 6271,
          "old_api": null,
          "new_api": "result_t::reject(-ERR_SIGNATURE_NO_MATCH)",
          "old_text": null,
          "new_text": "result_t::reject(-ERR_SIGNATURE_NO_MATCH)",
          "old_line_content": "  if (compare != 0) {",
          "new_line_content": "    return result_t::reject(-ERR_SIGNATURE_NO_MATCH);",
          "content_same": false
        },
        {
          "line": 6274,
          "old_api": null,
          "new_api": "get_info",
          "old_text": null,
          "new_text": "user->get_info()",
          "old_line_content": "",
          "new_line_content": "  auto apl = apl_factory->create_apl_local(cct, s, user->get_info(),",
          "content_same": false
        },
        {
          "line": 5763,
          "old_api": null,
          "new_api": "rgw::auth::s3::get_v4_exp_payload_hash(s->info)",
          "old_text": null,
          "new_text": "rgw::auth::s3::get_v4_exp_payload_hash(s->info)",
          "old_line_content": "    /* Get the expected hash. */",
          "new_line_content": "    exp_payload_hash = rgw::auth::s3::get_v4_exp_payload_hash(s->info);",
          "content_same": false
        },
        {
          "line": 6276,
          "old_api": null,
          "new_api": "completer_factory",
          "old_text": null,
          "new_text": "completer_factory(k.key)",
          "old_line_content": "                                           k.subuser, std::nullopt, access_key_id);",
          "new_line_content": "  return result_t::grant(std::move(apl), completer_factory(k.key));",
          "content_same": false
        },
        {
          "line": 5767,
          "old_api": null,
          "new_api": "rgw::auth::s3::get_v4_canonical_uri(s->info)",
          "old_text": null,
          "new_text": "rgw::auth::s3::get_v4_canonical_uri(s->info)",
          "old_line_content": "  /* Craft canonical URI. Using std::move later so let it be non-const. */",
          "new_line_content": "  auto canonical_uri = rgw::auth::s3::get_v4_canonical_uri(s->info);",
          "content_same": false
        },
        {
          "line": 5770,
          "old_api": null,
          "new_api": "rgw::auth::s3::get_v4_canonical_qs(s->info, using_qs)",
          "old_text": null,
          "new_text": "rgw::auth::s3::get_v4_canonical_qs(s->info, using_qs)",
          "old_line_content": "  /* Craft canonical query string. std::moving later so non-const here. */",
          "new_line_content": "  auto canonical_qs = rgw::auth::s3::get_v4_canonical_qs(s->info, using_qs);",
          "content_same": false
        },
        {
          "line": 5773,
          "old_api": null,
          "new_api": "rgw::auth::s3::get_v4_canonical_method(s)",
          "old_text": null,
          "new_text": "rgw::auth::s3::get_v4_canonical_method(s)",
          "old_line_content": "  /* Craft canonical method. */",
          "new_line_content": "  auto canonical_method = rgw::auth::s3::get_v4_canonical_method(s);",
          "content_same": false
        },
        {
          "line": 5777,
          "old_api": null,
          "new_api": "rgw::auth::s3::get_v4_canon_req_hash(s->cct,\n                                         std::move(canonical_method),\n                                         std::move(canonical_uri),\n                                         std::move(canonical_qs),\n                                         std::move(*canonical_headers),\n                                         signed_hdrs,\n                                         exp_payload_hash,\n                                         s)",
          "old_text": null,
          "new_text": "rgw::auth::s3::get_v4_canon_req_hash(s->cct,\n                                         std::move(canonical_method),\n                                         std::move(canonical_uri),\n                                         std::move(canonical_qs),\n                                         std::move(*canonical_headers),\n                                         signed_hdrs,\n                                         exp_payload_hash,\n                                         s)",
          "old_line_content": "  auto canonical_req_hash = \\",
          "new_line_content": "    rgw::auth::s3::get_v4_canon_req_hash(s->cct,",
          "content_same": false
        },
        {
          "line": 5787,
          "old_api": null,
          "new_api": "rgw::auth::s3::get_v4_string_to_sign(s->cct,\n                                         AWS4_HMAC_SHA256_STR,\n                                         date,\n                                         credential_scope,\n                                         std::move(canonical_req_hash),\n                                         s)",
          "old_text": null,
          "new_text": "rgw::auth::s3::get_v4_string_to_sign(s->cct,\n                                         AWS4_HMAC_SHA256_STR,\n                                         date,\n                                         credential_scope,\n                                         std::move(canonical_req_hash),\n                                         s)",
          "old_line_content": "  auto string_to_sign = \\",
          "new_line_content": "    rgw::auth::s3::get_v4_string_to_sign(s->cct,",
          "content_same": false
        },
        {
          "line": 6302,
          "old_api": null,
          "new_api": "rgw::from_base64(session_token)",
          "old_text": null,
          "new_text": "rgw::from_base64(session_token)",
          "old_line_content": "  try {",
          "new_line_content": "    decodedSessionToken = rgw::from_base64(session_token);",
          "content_same": false
        },
        {
          "line": 5791,
          "old_api": null,
          "new_api": "std::move(canonical_req_hash)",
          "old_text": null,
          "new_text": "std::move(canonical_req_hash)",
          "old_line_content": "                                         credential_scope,",
          "new_line_content": "                                         std::move(canonical_req_hash),",
          "content_same": false
        },
        {
          "line": 6304,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(dpp, 0)",
          "old_line_content": "  } catch (...) {",
          "new_line_content": "    ldpp_dout(dpp, 0) << \"ERROR: Invalid session token, not base64 encoded.\" << dendl;",
          "content_same": false
        },
        {
          "line": 5794,
          "old_api": null,
          "new_api": "std::bind(rgw::auth::s3::get_v4_signature,\n                                     credential_scope,\n                                     std::placeholders::_1,\n                                     std::placeholders::_2,\n                                     std::placeholders::_3,\n                                     s)",
          "old_text": null,
          "new_text": "std::bind(rgw::auth::s3::get_v4_signature,\n                                     credential_scope,\n                                     std::placeholders::_1,\n                                     std::placeholders::_2,\n                                     std::placeholders::_3,\n                                     s)",
          "old_line_content": "",
          "new_line_content": "  const auto sig_factory = std::bind(rgw::auth::s3::get_v4_signature,",
          "content_same": false
        },
        {
          "line": 6308,
          "old_api": null,
          "new_api": "get_crypto_handler",
          "old_text": null,
          "new_text": "cct->get_crypto_handler(CEPH_CRYPTO_AES)",
          "old_line_content": "",
          "new_line_content": "  auto* cryptohandler = cct->get_crypto_handler(CEPH_CRYPTO_AES);",
          "content_same": false
        },
        {
          "line": 5287,
          "old_api": null,
          "new_api": "get_obj_state",
          "old_text": null,
          "new_text": "obj->get_obj_state(s, &state, s->yield)",
          "old_line_content": "  RGWObjState* state = nullptr;",
          "new_line_content": "  if (obj->get_obj_state(s, &state, s->yield) < 0) {",
          "content_same": false
        },
        {
          "line": 6313,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "secret_s.length()",
          "old_line_content": "  string secret_s = cct->_conf->rgw_sts_key;",
          "new_line_content": "  buffer::ptr secret(secret_s.c_str(), secret_s.length());",
          "content_same": false
        },
        {
          "line": 6315,
          "old_api": null,
          "new_api": "validate_secret",
          "old_text": null,
          "new_text": "cryptohandler->validate_secret(secret)",
          "old_line_content": "  int ret = 0;",
          "new_line_content": "  if (ret = cryptohandler->validate_secret(secret); ret < 0) {",
          "content_same": false
        },
        {
          "line": 6320,
          "old_api": null,
          "new_api": "get_key_handler",
          "old_text": null,
          "new_text": "cryptohandler->get_key_handler(secret, error)",
          "old_line_content": "  string error;",
          "new_line_content": "  std::unique_ptr<CryptoKeyHandler> keyhandler(cryptohandler->get_key_handler(secret, error));",
          "content_same": false
        },
        {
          "line": 6324,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "error.clear()",
          "old_line_content": "  }",
          "new_line_content": "  error.clear();",
          "content_same": false
        },
        {
          "line": 5813,
          "old_api": null,
          "new_api": "is_v4_payload_empty",
          "old_text": null,
          "new_text": "is_v4_payload_empty(s)",
          "old_line_content": "   * by default. We don't need to change that. */",
          "new_line_content": "  if (is_v4_payload_unsigned(exp_payload_hash) || is_v4_payload_empty(s) || is_non_s3_op) {",
          "content_same": false
        },
        {
          "line": 5302,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "s->object.get()",
          "old_line_content": "  // object name for redirect handling",
          "new_line_content": "  if (!rgw::sal::Object::empty(s->object.get())) {",
          "content_same": false
        },
        {
          "line": 6328,
          "old_api": null,
          "new_api": "buffer::list::static_from_string(decodedSessionToken)",
          "old_text": null,
          "new_text": "buffer::list::static_from_string(decodedSessionToken)",
          "old_line_content": "  buffer::list en_input, dec_output;",
          "new_line_content": "  en_input = buffer::list::static_from_string(decodedSessionToken);",
          "content_same": false
        },
        {
          "line": 5818,
          "old_api": null,
          "new_api": "std::move(string_to_sign)",
          "old_text": null,
          "new_text": "std::move(string_to_sign)",
          "old_line_content": "      session_token,",
          "new_line_content": "      std::move(string_to_sign),",
          "content_same": false
        },
        {
          "line": 6330,
          "old_api": null,
          "new_api": "decrypt",
          "old_text": null,
          "new_text": "keyhandler->decrypt(en_input, dec_output, &error)",
          "old_line_content": "",
          "new_line_content": "  ret = keyhandler->decrypt(en_input, dec_output, &error);",
          "content_same": false
        },
        {
          "line": 5308,
          "old_api": null,
          "new_api": "RGWHandler_REST_S3::init(driver, s, cio)",
          "old_text": null,
          "new_text": "RGWHandler_REST_S3::init(driver, s, cio)",
          "old_line_content": "",
          "new_line_content": "  return RGWHandler_REST_S3::init(driver, s, cio);",
          "content_same": false
        },
        {
          "line": 6332,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(dpp, 0)",
          "old_line_content": "  if (ret < 0) {",
          "new_line_content": "    ldpp_dout(dpp, 0) << \"ERROR: Decryption failed: \" << error << dendl;",
          "content_same": false
        },
        {
          "line": 6336,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "dec_output.append('\\0')",
          "old_line_content": "    try {",
          "new_line_content": "      dec_output.append('\\0');",
          "content_same": false
        },
        {
          "line": 5313,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "  *new_op = op;",
          "new_line_content": "  ldpp_dout(s, 10) << __func__ << \" Starting retarget\" << dendl;",
          "content_same": false
        },
        {
          "line": 6340,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(dpp, 0)",
          "old_line_content": "    } catch (const buffer::error& e) {",
          "new_line_content": "      ldpp_dout(dpp, 0) << \"ERROR: decode SessionToken failed: \" << error << dendl;",
          "content_same": false
        },
        {
          "line": 5829,
          "old_api": null,
          "new_api": "is_v4_payload_streamed",
          "old_text": null,
          "new_text": "is_v4_payload_streamed(exp_payload_hash)",
          "old_line_content": "     *   there is no payload, you must provide the hash of an empty string. */",
          "new_line_content": "    if (!is_v4_payload_streamed(exp_payload_hash)) {",
          "content_same": false
        },
        {
          "line": 5318,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "s->bucket.get()",
          "old_line_content": "",
          "new_line_content": "  if (rgw::sal::Bucket::empty(s->bucket.get())) {",
          "content_same": false
        },
        {
          "line": 5323,
          "old_api": null,
          "new_api": "get_info",
          "old_text": null,
          "new_text": "s->bucket->get_info()",
          "old_line_content": "",
          "new_line_content": "  if (!s->bucket->get_info().has_website) {",
          "content_same": false
        },
        {
          "line": 5330,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "s->object.get()",
          "old_line_content": "  string key_name;",
          "new_line_content": "  if (!rgw::sal::Object::empty(s->object.get())) {",
          "content_same": false
        },
        {
          "line": 5333,
          "old_api": null,
          "new_api": "web_dir",
          "old_text": null,
          "new_text": "web_dir()",
          "old_line_content": "  }",
          "new_line_content": "  bool get_res = s->bucket->get_info().website_conf.get_effective_key(key_name, &new_obj.name, web_dir());",
          "content_same": false
        },
        {
          "line": 6359,
          "old_api": null,
          "new_api": "exists",
          "old_text": null,
          "new_text": "s->info.args.exists(\"x-amz-security-token\")",
          "old_line_content": "{",
          "new_line_content": "  if (! s->info.args.exists(\"x-amz-security-token\") &&",
          "content_same": false
        },
        {
          "line": 5336,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 5)",
          "old_line_content": "    s->err.message = \"The IndexDocument Suffix is not configurated or not well formed!\";",
          "new_line_content": "    ldpp_dout(s, 5) << s->err.message << dendl;",
          "content_same": false
        },
        {
          "line": 5340,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "",
          "new_line_content": "  ldpp_dout(s, 10) << \"retarget get_effective_key \" << s->object << \" -> \"",
          "content_same": false
        },
        {
          "line": 6366,
          "old_api": null,
          "new_api": "get_session_token",
          "old_text": null,
          "new_text": "get_session_token(dpp, session_token, token)",
          "old_line_content": "  STS::SessionToken token;",
          "new_line_content": "  if (int ret = get_session_token(dpp, session_token, token); ret < 0) {",
          "content_same": false
        },
        {
          "line": 5345,
          "old_api": null,
          "new_api": "should_redirect",
          "old_text": null,
          "new_text": "s->bucket->get_info().website_conf.should_redirect(new_obj.name, 0, &rrule)",
          "old_line_content": "  bool should_redirect =",
          "new_line_content": "    s->bucket->get_info().website_conf.should_redirect(new_obj.name, 0, &rrule);",
          "content_same": false
        },
        {
          "line": 5348,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "s->info.env->get(\"HTTP_HOST\", \"\")",
          "old_line_content": "  if (should_redirect) {",
          "new_line_content": "    const string& hostname = s->info.env->get(\"HTTP_HOST\", \"\");",
          "content_same": false
        },
        {
          "line": 6372,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(dpp, 0)",
          "old_line_content": "  if (token.access_key_id != _access_key_id) {",
          "new_line_content": "    ldpp_dout(dpp, 0) << \"Invalid access key\" << dendl;",
          "content_same": false
        },
        {
          "line": 5350,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "s->info.env->get(\"SERVER_PORT_SECURE\")",
          "old_line_content": "    const string& protocol =",
          "new_line_content": "      (s->info.env->get(\"SERVER_PORT_SECURE\") ? \"https\" : \"http\");",
          "content_same": false
        },
        {
          "line": 5352,
          "old_api": null,
          "new_api": "apply_rule",
          "old_text": null,
          "new_text": "rrule.apply_rule(protocol, hostname, key_name, &s->redirect,\n\t\t    &redirect_code)",
          "old_line_content": "    int redirect_code = 0;",
          "new_line_content": "    rrule.apply_rule(protocol, hostname, key_name, &s->redirect,",
          "content_same": false
        },
        {
          "line": 6376,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "token.expiration.empty()",
          "old_line_content": "  //Check if the token has expired",
          "new_line_content": "  if (! token.expiration.empty()) {",
          "content_same": false
        },
        {
          "line": 6378,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "expiration.empty()",
          "old_line_content": "    std::string expiration = token.expiration;",
          "new_line_content": "    if (! expiration.empty()) {",
          "content_same": false
        },
        {
          "line": 5357,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "      s->err.http_ret = redirect_code; // Apply a custom HTTP response code",
          "new_line_content": "    ldpp_dout(s, 10) << \"retarget redirect code=\" << redirect_code",
          "content_same": false
        },
        {
          "line": 6381,
          "old_api": null,
          "new_api": "real_clock::now()",
          "old_text": null,
          "new_text": "real_clock::now()",
          "old_line_content": "      if (exp) {",
          "new_line_content": "        real_clock::time_point now = real_clock::now();",
          "content_same": false
        },
        {
          "line": 6383,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(dpp, 0)",
          "old_line_content": "        if (now >= *exp) {",
          "new_line_content": "          ldpp_dout(dpp, 0) << \"ERROR: Token expired\" << dendl;",
          "content_same": false
        },
        {
          "line": 5872,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "        default:",
          "new_line_content": "          ldpp_dout(s, 10) << \"ERROR: AWS4 completion for operation: \" << s->op_type << \", NOT IMPLEMENTED\" << dendl;",
          "content_same": false
        },
        {
          "line": 6387,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(dpp, 0)",
          "old_line_content": "      } else {",
          "new_line_content": "        ldpp_dout(dpp, 0) << \"ERROR: Invalid expiration: \" << expiration << dendl;",
          "content_same": false
        },
        {
          "line": 5876,
          "old_api": null,
          "new_api": "std::bind(AWSv4ComplSingle::create,\n                                          s,\n                                          std::placeholders::_1)",
          "old_text": null,
          "new_text": "std::bind(AWSv4ComplSingle::create,\n                                          s,\n                                          std::placeholders::_1)",
          "old_line_content": "",
          "new_line_content": "      const auto cmpl_factory = std::bind(AWSv4ComplSingle::create,",
          "content_same": false
        },
        {
          "line": 5369,
          "old_api": null,
          "new_api": "get_object",
          "old_text": null,
          "new_text": "s->bucket->get_object(new_obj)",
          "old_line_content": "   */",
          "new_line_content": "  s->object = s->bucket->get_object(new_obj);",
          "content_same": false
        },
        {
          "line": 6394,
          "old_api": null,
          "new_api": "signature_factory",
          "old_text": null,
          "new_text": "signature_factory(cct, token.secret_access_key, string_to_sign)",
          "old_line_content": "  const VersionAbstractor::server_signature_t server_signature = \\",
          "new_line_content": "    signature_factory(cct, token.secret_access_key, string_to_sign);",
          "content_same": false
        },
        {
          "line": 5883,
          "old_api": null,
          "new_api": "std::move(string_to_sign)",
          "old_text": null,
          "new_text": "std::move(string_to_sign)",
          "old_line_content": "        session_token,",
          "new_line_content": "        std::move(string_to_sign),",
          "content_same": false
        },
        {
          "line": 6397,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(dpp, 15)",
          "old_line_content": "",
          "new_line_content": "  ldpp_dout(dpp, 15) << \"string_to_sign=\"",
          "content_same": false
        },
        {
          "line": 5376,
          "old_api": null,
          "new_api": "get_obj_op",
          "old_text": null,
          "new_text": "get_obj_op(true)",
          "old_line_content": "{",
          "new_line_content": "  return get_obj_op(true);",
          "content_same": false
        },
        {
          "line": 6400,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(dpp, 15)",
          "old_line_content": "                 << dendl;",
          "new_line_content": "  ldpp_dout(dpp, 15) << \"server signature=\" << server_signature << dendl;",
          "content_same": false
        },
        {
          "line": 5891,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "",
          "new_line_content": "      ldpp_dout(s, 10) << \"body content detected in multiple chunks\" << dendl;",
          "content_same": false
        },
        {
          "line": 5381,
          "old_api": null,
          "new_api": "get_obj_op",
          "old_text": null,
          "new_text": "get_obj_op(false)",
          "old_line_content": "{",
          "new_line_content": "  return get_obj_op(false);",
          "content_same": false
        },
        {
          "line": 6405,
          "old_api": null,
          "new_api": "result_t::reject(-ERR_SIGNATURE_NO_MATCH)",
          "old_text": null,
          "new_text": "result_t::reject(-ERR_SIGNATURE_NO_MATCH)",
          "old_line_content": "  if (compare != 0) {",
          "new_line_content": "    return result_t::reject(-ERR_SIGNATURE_NO_MATCH);",
          "content_same": false
        },
        {
          "line": 5386,
          "old_api": null,
          "new_api": "reset",
          "old_text": null,
          "new_text": "s->formatter->reset()",
          "old_line_content": "  int ret = 0;",
          "new_line_content": "  s->formatter->reset(); /* Try to throw it all away */",
          "content_same": false
        },
        {
          "line": 5900,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "        default:",
          "new_line_content": "          ldpp_dout(s, 10) << \"ERROR: AWS4 completion for this operation NOT IMPLEMENTED (streaming mode)\" << dendl;",
          "content_same": false
        },
        {
          "line": 5389,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "getop.get()",
          "old_line_content": "  std::shared_ptr<RGWGetObj_ObjStore_S3Website> getop( static_cast<RGWGetObj_ObjStore_S3Website*>(op_get()));",
          "new_line_content": "  if (getop.get() == NULL) {",
          "content_same": false
        },
        {
          "line": 6414,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "token.roleId.empty()",
          "old_line_content": "  rgw::auth::RoleApplier::TokenAttrs t_attrs;",
          "new_line_content": "  if (! token.roleId.empty()) {",
          "content_same": false
        },
        {
          "line": 5392,
          "old_api": null,
          "new_api": "init",
          "old_text": null,
          "new_text": "getop->init(driver, s, this)",
          "old_line_content": "  }",
          "new_line_content": "  getop->init(driver, s, this);",
          "content_same": false
        },
        {
          "line": 5904,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "",
          "new_line_content": "      ldpp_dout(s, 10) << \"aws4 seed signature ok... delaying v4 auth\" << dendl;",
          "content_same": false
        },
        {
          "line": 6420,
          "old_api": null,
          "new_api": "get_name",
          "old_text": null,
          "new_text": "role->get_name()",
          "old_line_content": "    r.id = token.roleId;",
          "new_line_content": "    r.name = role->get_name();",
          "content_same": false
        },
        {
          "line": 6423,
          "old_api": null,
          "new_api": "get_role_policy_names",
          "old_text": null,
          "new_text": "role->get_role_policy_names()",
          "old_line_content": "",
          "new_line_content": "    vector<string> role_policy_names = role->get_role_policy_names();",
          "content_same": false
        },
        {
          "line": 5401,
          "old_api": null,
          "new_api": "get_object",
          "old_text": null,
          "new_text": "driver->get_object(errordoc_key)",
          "old_line_content": "   * are set up. Note, it won't have bucket. */",
          "new_line_content": "  s->object = driver->get_object(errordoc_key);",
          "content_same": false
        },
        {
          "line": 6426,
          "old_api": null,
          "new_api": "get_role_policy",
          "old_text": null,
          "new_text": "role->get_role_policy(dpp, policy_name, perm_policy)",
          "old_line_content": "      string perm_policy;",
          "new_line_content": "      if (int ret = role->get_role_policy(dpp, policy_name, perm_policy); ret == 0) {",
          "content_same": false
        },
        {
          "line": 5403,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "getop.get()",
          "old_line_content": "",
          "new_line_content": "  ret = init_permissions(getop.get(), y);",
          "content_same": false
        },
        {
          "line": 5916,
          "old_api": null,
          "new_api": "std::bind(AWSv4ComplMulti::create,\n                                          s,\n                                          date,\n                                          credential_scope,\n                                          client_signature,\n                                          std::placeholders::_1)",
          "old_text": null,
          "new_text": "std::bind(AWSv4ComplMulti::create,\n                                          s,\n                                          date,\n                                          credential_scope,\n                                          client_signature,\n                                          std::placeholders::_1)",
          "old_line_content": "       * for CanonReq. */",
          "new_line_content": "      const auto cmpl_factory = std::bind(AWSv4ComplMulti::create,",
          "content_same": false
        },
        {
          "line": 5405,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 20)",
          "old_line_content": "  if (ret < 0) {",
          "new_line_content": "    ldpp_dout(s, 20) << \"serve_errordoc failed, init_permissions ret=\" << ret << dendl;",
          "content_same": false
        },
        {
          "line": 6432,
          "old_api": null,
          "new_api": "get_user",
          "old_text": null,
          "new_text": "driver->get_user(token.user)",
          "old_line_content": "",
          "new_line_content": "  user = driver->get_user(token.user);",
          "content_same": false
        },
        {
          "line": 5409,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "getop.get()",
          "old_line_content": "",
          "new_line_content": "  ret = read_permissions(getop.get(), y);",
          "content_same": false
        },
        {
          "line": 5411,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 20)",
          "old_line_content": "  if (ret < 0) {",
          "new_line_content": "    ldpp_dout(s, 20) << \"serve_errordoc failed, read_permissions ret=\" << ret << dendl;",
          "content_same": false
        },
        {
          "line": 6435,
          "old_api": null,
          "new_api": "load_user",
          "old_text": null,
          "new_text": "user->load_user(dpp, y)",
          "old_line_content": "    // get user info",
          "new_line_content": "    int ret = user->load_user(dpp, y);",
          "content_same": false
        },
        {
          "line": 6437,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(dpp, 5)",
          "old_line_content": "    if (ret < 0) {",
          "new_line_content": "      ldpp_dout(dpp, 5) << \"ERROR: failed reading user info: uid=\" << token.user << dendl;",
          "content_same": false
        },
        {
          "line": 5926,
          "old_api": null,
          "new_api": "std::move(string_to_sign)",
          "old_text": null,
          "new_text": "std::move(string_to_sign)",
          "old_line_content": "        session_token,",
          "new_line_content": "        std::move(string_to_sign),",
          "content_same": false
        },
        {
          "line": 5416,
          "old_api": null,
          "new_api": "set_custom_http_response",
          "old_text": null,
          "new_text": "getop->set_custom_http_response(http_ret)",
          "old_line_content": "  if (http_ret) {",
          "new_line_content": "     getop->set_custom_http_response(http_ret);",
          "content_same": false
        },
        {
          "line": 5419,
          "old_api": null,
          "new_api": "init_processing",
          "old_text": null,
          "new_text": "getop->init_processing(y)",
          "old_line_content": "",
          "new_line_content": "  ret = getop->init_processing(y);",
          "content_same": false
        },
        {
          "line": 6443,
          "old_api": null,
          "new_api": "get_acl_strategy",
          "old_text": null,
          "new_text": "get_acl_strategy()",
          "old_line_content": "  if (token.acct_type == TYPE_KEYSTONE || token.acct_type == TYPE_LDAP) {",
          "new_line_content": "    auto apl = remote_apl_factory->create_apl_remote(cct, s, get_acl_strategy(),",
          "content_same": false
        },
        {
          "line": 5421,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 20)",
          "old_line_content": "  if (ret < 0) {",
          "new_line_content": "    ldpp_dout(s, 20) << \"serve_errordoc failed, init_processing ret=\" << ret << dendl;",
          "content_same": false
        },
        {
          "line": 6447,
          "old_api": null,
          "new_api": "std::move(token.user)",
          "old_text": null,
          "new_text": "std::move(token.user)",
          "old_line_content": "  } else if (token.acct_type == TYPE_ROLE) {",
          "new_line_content": "    t_attrs.user_id = std::move(token.user); // This is mostly needed to assign the owner of a bucket during its creation",
          "content_same": false
        },
        {
          "line": 5425,
          "old_api": null,
          "new_api": "verify_op_mask",
          "old_text": null,
          "new_text": "getop->verify_op_mask()",
          "old_line_content": "",
          "new_line_content": "  ret = getop->verify_op_mask();",
          "content_same": false
        },
        {
          "line": 5427,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 20)",
          "old_line_content": "  if (ret < 0) {",
          "new_line_content": "    ldpp_dout(s, 20) << \"serve_errordoc failed, verify_op_mask ret=\" << ret << dendl;",
          "content_same": false
        },
        {
          "line": 5941,
          "old_api": null,
          "new_api": "rgw::auth::s3::get_v4_canonical_headers(info, signedheaders,\n                                                 using_qs, true)",
          "old_text": null,
          "new_text": "rgw::auth::s3::get_v4_canonical_headers(info, signedheaders,\n                                                 using_qs, true)",
          "old_line_content": "{",
          "new_line_content": "  return rgw::auth::s3::get_v4_canonical_headers(info, signedheaders,",
          "content_same": false
        },
        {
          "line": 5431,
          "old_api": null,
          "new_api": "verify_permission",
          "old_text": null,
          "new_text": "getop->verify_permission(y)",
          "old_line_content": "",
          "new_line_content": "  ret = getop->verify_permission(y);",
          "content_same": false
        },
        {
          "line": 5433,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 20)",
          "old_line_content": "  if (ret < 0) {",
          "new_line_content": "    ldpp_dout(s, 20) << \"serve_errordoc failed, verify_permission ret=\" << ret << dendl;",
          "content_same": false
        },
        {
          "line": 6457,
          "old_api": null,
          "new_api": "std::string(_access_key_id)",
          "old_text": null,
          "new_text": "std::string(_access_key_id)",
          "old_line_content": "    string subuser;",
          "new_line_content": "    auto apl = local_apl_factory->create_apl_local(cct, s, user->get_info(), subuser, token.perm_mask, std::string(_access_key_id));",
          "content_same": false
        },
        {
          "line": 5437,
          "old_api": null,
          "new_api": "verify_params",
          "old_text": null,
          "new_text": "getop->verify_params()",
          "old_line_content": "",
          "new_line_content": "  ret = getop->verify_params();",
          "content_same": false
        },
        {
          "line": 5439,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 20)",
          "old_line_content": "  if (ret < 0) {",
          "new_line_content": "    ldpp_dout(s, 20) << \"serve_errordoc failed, verify_params ret=\" << ret << dendl;",
          "content_same": false
        },
        {
          "line": 5954,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "s->info.env->get(\"HTTP_AUTHORIZATION\")",
          "old_line_content": "",
          "new_line_content": "  const char* http_auth = s->info.env->get(\"HTTP_AUTHORIZATION\");",
          "content_same": false
        },
        {
          "line": 6467,
          "old_api": null,
          "new_api": "discover_aws_flavour",
          "old_text": null,
          "new_text": "discover_aws_flavour(s->info)",
          "old_line_content": "  AwsRoute route;",
          "new_line_content": "  std::tie(version, route) = discover_aws_flavour(s->info);",
          "content_same": false
        },
        {
          "line": 5444,
          "old_api": null,
          "new_api": "pre_exec",
          "old_text": null,
          "new_text": "getop->pre_exec()",
          "old_line_content": "  // No going back now",
          "new_line_content": "  getop->pre_exec();",
          "content_same": false
        },
        {
          "line": 5958,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "s->info.args.get(\"AWSAccessKeyId\")",
          "old_line_content": "     * the \"Expires\" parameter now. */",
          "new_line_content": "    access_key_id = s->info.args.get(\"AWSAccessKeyId\");",
          "content_same": false
        },
        {
          "line": 5962,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "s->info.args.get(\"Expires\")",
          "old_line_content": "",
          "new_line_content": "    std::string_view expires = s->info.args.get(\"Expires\");",
          "content_same": false
        },
        {
          "line": 5452,
          "old_api": null,
          "new_api": "execute",
          "old_text": null,
          "new_text": "getop->execute(y)",
          "old_line_content": "   */",
          "new_line_content": "  getop->execute(y);",
          "content_same": false
        },
        {
          "line": 5969,
          "old_api": null,
          "new_api": "data",
          "old_text": null,
          "new_text": "expires.data()",
          "old_line_content": "     * and thus string_view::data() can be safely used. */",
          "new_line_content": "    const time_t exp = atoll(expires.data());",
          "content_same": false
        },
        {
          "line": 5971,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(&now)",
          "old_line_content": "    time_t now;",
          "new_line_content": "    time(&now);",
          "content_same": false
        },
        {
          "line": 5461,
          "old_api": null,
          "new_api": "find",
          "old_text": null,
          "new_text": "rgw_http_s3_errors.find(err_no > 0 ? err_no : -err_no)",
          "old_line_content": "  int new_err_no = -1;",
          "new_line_content": "  rgw_http_errors::const_iterator r = rgw_http_s3_errors.find(err_no > 0 ? err_no : -err_no);",
          "content_same": false
        },
        {
          "line": 5464,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "rgw_http_s3_errors.end()",
          "old_line_content": "",
          "new_line_content": "  if (r != rgw_http_s3_errors.end()) {",
          "content_same": false
        },
        {
          "line": 5976,
          "old_api": null,
          "new_api": "exists",
          "old_text": null,
          "new_text": "s->info.args.exists(\"x-amz-security-token\")",
          "old_line_content": "    }",
          "new_line_content": "    if (s->info.args.exists(\"x-amz-security-token\")) {",
          "content_same": false
        },
        {
          "line": 5467,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "  }",
          "new_line_content": "  ldpp_dout(s, 10) << \"RGWHandler_REST_S3Website::error_handler err_no=\" << err_no << \" http_ret=\" << http_error_code << dendl;",
          "content_same": false
        },
        {
          "line": 5470,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "s->bucket.get()",
          "old_line_content": "  RGWBWRoutingRule rrule;",
          "new_line_content": "  bool have_bucket = !rgw::sal::Bucket::empty(s->bucket.get());",
          "content_same": false
        },
        {
          "line": 5985,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(\"AWS \")",
          "old_line_content": "    /* The \"Authorization\" HTTP header is being used. */",
          "new_line_content": "    const std::string_view auth_str(http_auth + strlen(\"AWS \"));",
          "content_same": false
        },
        {
          "line": 5474,
          "old_api": null,
          "new_api": "should_redirect",
          "old_text": null,
          "new_text": "s->bucket->get_info().website_conf.should_redirect(original_object_name,\n\t\t\t\t\t\t\t http_error_code, &rrule)",
          "old_line_content": "    should_redirect =",
          "new_line_content": "      s->bucket->get_info().website_conf.should_redirect(original_object_name,",
          "content_same": false
        },
        {
          "line": 5988,
          "old_api": null,
          "new_api": "substr",
          "old_text": null,
          "new_text": "auth_str.substr(0, pos)",
          "old_line_content": "    if (pos != std::string_view::npos) {",
          "new_line_content": "      access_key_id = auth_str.substr(0, pos);",
          "content_same": false
        },
        {
          "line": 5479,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "s->info.env->get(\"HTTP_HOST\", \"\")",
          "old_line_content": "  if (should_redirect) {",
          "new_line_content": "    const string& hostname = s->info.env->get(\"HTTP_HOST\", \"\");",
          "content_same": false
        },
        {
          "line": 5992,
          "old_api": null,
          "new_api": "get_optional",
          "old_text": null,
          "new_text": "s->info.env->get_optional(\"HTTP_X_AMZ_SECURITY_TOKEN\")",
          "old_line_content": "",
          "new_line_content": "    auto token = s->info.env->get_optional(\"HTTP_X_AMZ_SECURITY_TOKEN\");",
          "content_same": false
        },
        {
          "line": 5481,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "s->info.env->get(\"SERVER_PORT_SECURE\")",
          "old_line_content": "    const string& protocol =",
          "new_line_content": "      (s->info.env->get(\"SERVER_PORT_SECURE\") ? \"https\" : \"http\");",
          "content_same": false
        },
        {
          "line": 5483,
          "old_api": null,
          "new_api": "apply_rule",
          "old_text": null,
          "new_text": "rrule.apply_rule(protocol, hostname, original_object_name,\n                     &s->redirect, &redirect_code)",
          "old_line_content": "    int redirect_code = 0;",
          "new_line_content": "    rrule.apply_rule(protocol, hostname, original_object_name,",
          "content_same": false
        },
        {
          "line": 5995,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "session_token.size()",
          "old_line_content": "      session_token = *token;",
          "new_line_content": "      if (session_token.size() == 0) {",
          "content_same": false
        },
        {
          "line": 5488,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "      s->err.http_ret = redirect_code; // Apply a custom HTTP response code",
          "new_line_content": "    ldpp_dout(s, 10) << \"error handler redirect code=\" << redirect_code",
          "content_same": false
        },
        {
          "line": 6004,
          "old_api": null,
          "new_api": "rgw_create_s3_canonical_header",
          "old_text": null,
          "new_text": "rgw_create_s3_canonical_header(s, s->info, &header_time, string_to_sign,\n        qsr)",
          "old_line_content": "  utime_t header_time;",
          "new_line_content": "  if (! rgw_create_s3_canonical_header(s, s->info, &header_time, string_to_sign,",
          "content_same": false
        },
        {
          "line": 6006,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "        qsr)) {",
          "new_line_content": "    ldpp_dout(s, 10) << \"failed to create the canonized auth header\\n\"",
          "content_same": false
        },
        {
          "line": 5495,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "s->bucket->get_info().website_conf.error_doc.empty()",
          "old_line_content": "    // Do NOT fire the ErrorDoc handler",
          "new_line_content": "  } else if (have_bucket && !s->bucket->get_info().website_conf.error_doc.empty()) {",
          "content_same": false
        },
        {
          "line": 6011,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 10)",
          "old_line_content": "",
          "new_line_content": "  ldpp_dout(s, 10) << \"string_to_sign:\\n\"",
          "content_same": false
        },
        {
          "line": 5500,
          "old_api": null,
          "new_api": "get_info",
          "old_text": null,
          "new_text": "s->bucket->get_info()",
          "old_line_content": "     */",
          "new_line_content": "    new_err_no = RGWHandler_REST_S3Website::serve_errordoc(s, http_error_code, s->bucket->get_info().website_conf.error_doc, y);",
          "content_same": false
        },
        {
          "line": 6014,
          "old_api": null,
          "new_api": "is_time_skew_ok",
          "old_text": null,
          "new_text": "is_time_skew_ok(header_time)",
          "old_line_content": "",
          "new_line_content": "  if (!qsr && !is_time_skew_ok(header_time)) {",
          "content_same": false
        },
        {
          "line": 5505,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 20)",
          "old_line_content": "  } else {",
          "new_line_content": "    ldpp_dout(s, 20) << \"No special error handling today!\" << dendl;",
          "content_same": false
        },
        {
          "line": 6019,
          "old_api": null,
          "new_api": "std::move(access_key_id)",
          "old_text": null,
          "new_text": "std::move(access_key_id)",
          "old_line_content": "  return {",
          "new_line_content": "    std::move(access_key_id),",
          "content_same": false
        },
        {
          "line": 5518,
          "old_api": null,
          "new_api": "set_get_data",
          "old_text": null,
          "new_text": "op->set_get_data(get_data)",
          "old_line_content": "  RGWGetObj_ObjStore_S3Website* op = new RGWGetObj_ObjStore_S3Website;",
          "new_line_content": "  op->set_get_data(get_data);",
          "content_same": false
        },
        {
          "line": 6036,
          "old_api": null,
          "new_api": "to_str",
          "old_text": null,
          "new_text": "s->auth.s3_postobj_creds.encoded_policy.to_str()",
          "old_line_content": "    s->auth.s3_postobj_creds.x_amz_security_token,",
          "new_line_content": "    s->auth.s3_postobj_creds.encoded_policy.to_str(),",
          "content_same": false
        },
        {
          "line": 5529,
          "old_api": null,
          "new_api": "set_get_data",
          "old_text": null,
          "new_text": "op->set_get_data(get_data)",
          "old_line_content": "  RGWGetObj_ObjStore_S3Website* op = new RGWGetObj_ObjStore_S3Website;",
          "new_line_content": "  op->set_get_data(get_data);",
          "content_same": false
        },
        {
          "line": 6048,
          "old_api": null,
          "new_api": "find",
          "old_text": null,
          "new_text": "credential.find(\"/\")",
          "old_line_content": "  /* grab access key id */",
          "new_line_content": "  const size_t pos = credential.find(\"/\");",
          "content_same": false
        },
        {
          "line": 5540,
          "old_api": null,
          "new_api": "set_get_data",
          "old_text": null,
          "new_text": "op->set_get_data(get_data)",
          "old_line_content": "  RGWGetObj_ObjStore_S3Website* op = new RGWGetObj_ObjStore_S3Website;",
          "new_line_content": "  op->set_get_data(get_data);",
          "content_same": false
        },
        {
          "line": 6053,
          "old_api": null,
          "new_api": "substr",
          "old_text": null,
          "new_text": "credential.substr(pos + 1)",
          "old_line_content": "  /* grab credential scope */",
          "new_line_content": "  const std::string_view credential_scope = credential.substr(pos + 1);",
          "content_same": false
        },
        {
          "line": 6056,
          "old_api": null,
          "new_api": "std::bind(rgw::auth::s3::get_v4_signature,\n                                     credential_scope,\n                                     std::placeholders::_1,\n                                     std::placeholders::_2,\n                                     std::placeholders::_3,\n                                     s)",
          "old_text": null,
          "new_text": "std::bind(rgw::auth::s3::get_v4_signature,\n                                     credential_scope,\n                                     std::placeholders::_1,\n                                     std::placeholders::_2,\n                                     std::placeholders::_3,\n                                     s)",
          "old_line_content": "",
          "new_line_content": "  const auto sig_factory = std::bind(rgw::auth::s3::get_v4_signature,",
          "content_same": false
        },
        {
          "line": 6067,
          "old_api": null,
          "new_api": "to_str",
          "old_text": null,
          "new_text": "s->auth.s3_postobj_creds.encoded_policy.to_str()",
          "old_line_content": "    s->auth.s3_postobj_creds.x_amz_security_token,",
          "new_line_content": "    s->auth.s3_postobj_creds.encoded_policy.to_str(),",
          "content_same": false
        },
        {
          "line": 5559,
          "old_api": null,
          "new_api": "discover_aws_flavour",
          "old_text": null,
          "new_text": "discover_aws_flavour(s->info)",
          "old_line_content": "  AwsRoute route;",
          "new_line_content": "  std::tie(version, route) = discover_aws_flavour(s->info);",
          "content_same": false
        },
        {
          "line": 5562,
          "old_api": null,
          "new_api": "get_auth_data_v2",
          "old_text": null,
          "new_text": "get_auth_data_v2(s)",
          "old_line_content": "  if (version == AwsVersion::V2) {",
          "new_line_content": "    return get_auth_data_v2(s);",
          "content_same": false
        },
        {
          "line": 5564,
          "old_api": null,
          "new_api": "get_auth_data_v4",
          "old_text": null,
          "new_text": "get_auth_data_v4(s, route == AwsRoute::QUERY_STRING)",
          "old_line_content": "  } else if (version == AwsVersion::V4) {",
          "new_line_content": "    return get_auth_data_v4(s, route == AwsRoute::QUERY_STRING);",
          "content_same": false
        },
        {
          "line": 6077,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 0)",
          "old_line_content": "  if (s->auth.s3_postobj_creds.x_amz_algorithm == AWS4_HMAC_SHA256_STR) {",
          "new_line_content": "    ldpp_dout(s, 0) << \"Signature verification algorithm AWS v4\"",
          "content_same": false
        },
        {
          "line": 6079,
          "old_api": null,
          "new_api": "get_auth_data_v4",
          "old_text": null,
          "new_text": "get_auth_data_v4(s)",
          "old_line_content": "                     << \" (AWS4-HMAC-SHA256)\" << dendl;",
          "new_line_content": "    return get_auth_data_v4(s);",
          "content_same": false
        },
        {
          "line": 6081,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(s, 0)",
          "old_line_content": "  } else {",
          "new_line_content": "    ldpp_dout(s, 0) << \"Signature verification algorithm AWS v2\" << dendl;",
          "content_same": false
        },
        {
          "line": 5577,
          "old_api": null,
          "new_api": "rgw::auth::s3::get_v4_canonical_headers(info, signedheaders,\n                                                 using_qs, false)",
          "old_text": null,
          "new_text": "rgw::auth::s3::get_v4_canonical_headers(info, signedheaders,\n                                                 using_qs, false)",
          "old_line_content": "{",
          "new_line_content": "  return rgw::auth::s3::get_v4_canonical_headers(info, signedheaders,",
          "content_same": false
        },
        {
          "line": 6090,
          "old_api": null,
          "new_api": "get_auth_data",
          "old_text": null,
          "new_text": "ver_abstractor.get_auth_data(s)",
          "old_line_content": "  /* Small reminder: an ver_abstractor is allowed to throw! */",
          "new_line_content": "  const auto auth_data = ver_abstractor.get_auth_data(s);",
          "content_same": false
        },
        {
          "line": 6092,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "auth_data.client_signature.empty()",
          "old_line_content": "",
          "new_line_content": "  if (auth_data.access_key_id.empty() || auth_data.client_signature.empty()) {",
          "content_same": false
        },
        {
          "line": 6095,
          "old_api": null,
          "new_api": "authenticate",
          "old_text": null,
          "new_text": "authenticate(dpp,\n                        auth_data.access_key_id,\n\t\t        auth_data.client_signature,\n\t\t\tauth_data.session_token,\n\t\t\tauth_data.string_to_sign,\n                        auth_data.signature_factory,\n\t\t\tauth_data.completer_factory,\n\t\t\ts, y)",
          "old_line_content": "  } else {",
          "new_line_content": "    return authenticate(dpp,",
          "content_same": false
        },
        {
          "line": 5592,
          "old_api": null,
          "new_api": "ceph::real_clock::now()",
          "old_text": null,
          "new_text": "ceph::real_clock::now()",
          "old_line_content": "",
          "new_line_content": "  ceph::real_time timestamp = ceph::real_clock::now();",
          "content_same": false
        },
        {
          "line": 5596,
          "old_api": null,
          "new_api": "ceph::to_iso_8601_no_separators(timestamp, ceph::iso_8601_format::YMDhms)",
          "old_text": null,
          "new_text": "ceph::to_iso_8601_no_separators(timestamp, ceph::iso_8601_format::YMDhms)",
          "old_line_content": "",
          "new_line_content": "  std::string date = ceph::to_iso_8601_no_separators(timestamp, ceph::iso_8601_format::YMDhms);",
          "content_same": false
        },
        {
          "line": 5598,
          "old_api": null,
          "new_api": "gen_v4_scope",
          "old_text": null,
          "new_text": "gen_v4_scope(timestamp, region, service)",
          "old_line_content": "",
          "new_line_content": "  std::string credential_scope = gen_v4_scope(timestamp, region, service);",
          "content_same": false
        },
        {
          "line": 6114,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "cct->_conf->rgw_ldap_uri.empty()",
          "old_line_content": "  if (! cct->_conf->rgw_s3_auth_use_ldap ||",
          "new_line_content": "      cct->_conf->rgw_ldap_uri.empty()) {",
          "content_same": false
        },
        {
          "line": 5605,
          "old_api": null,
          "new_api": "to_str",
          "old_text": null,
          "new_text": "opt_content->to_str()",
          "old_line_content": "  if (opt_content) {",
          "new_line_content": "    content_hash = rgw::auth::s3::calc_v4_payload_hash(opt_content->to_str());",
          "content_same": false
        },
        {
          "line": 5612,
          "old_api": null,
          "new_api": "gen_v4_canonical_headers",
          "old_text": null,
          "new_text": "gen_v4_canonical_headers(info, extra_headers, &signed_hdrs)",
          "old_line_content": "  std::string canonical_headers = \\",
          "new_line_content": "    gen_v4_canonical_headers(info, extra_headers, &signed_hdrs);",
          "content_same": false
        },
        {
          "line": 6126,
          "old_api": null,
          "new_api": "parse_rgw_ldap_bindpw",
          "old_text": null,
          "new_text": "parse_rgw_ldap_bindpw(cct)",
          "old_line_content": "      const string& ldap_dnattr = cct->_conf->rgw_ldap_dnattr;",
          "new_line_content": "      std::string ldap_bindpw = parse_rgw_ldap_bindpw(cct);",
          "content_same": false
        },
        {
          "line": 5615,
          "old_api": null,
          "new_api": "ldpp_dout",
          "old_text": null,
          "new_text": "ldpp_dout(dpp, 10)",
          "old_line_content": "  using sanitize = rgw::crypt_sanitize::log_content;",
          "new_line_content": "  ldpp_dout(dpp, 10) << \"canonical headers format = \"",
          "content_same": false
        },
        {
          "line": 6131,
          "old_api": null,
          "new_api": "init",
          "old_text": null,
          "new_text": "ldh->init()",
          "old_line_content": "",
          "new_line_content": "      ldh->init();",
          "content_same": false
        },
        {
          "line": 5624,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "info.args.get(\"PayloadHash\")",
          "old_line_content": "    //For non s3 ops, we need to calculate the payload hash",
          "new_line_content": "    payload_hash = info.args.get(\"PayloadHash\");",
          "content_same": false
        },
        {
          "line": 5628,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "content_hash.empty()",
          "old_line_content": "    /* Get the expected hash. */",
          "new_line_content": "    if (content_hash.empty()) {",
          "content_same": false
        },
        {
          "line": 5631,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "content_hash.c_str()",
          "old_line_content": "    } else {",
          "new_line_content": "      exp_payload_hash = content_hash.c_str();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 5632,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "content_hash.c_str()",
          "new_text": null,
          "old_line_content": "      exp_payload_hash = content_hash.c_str();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 5637,
          "old_api": "rgw::auth::s3::gen_v4_canonical_uri(info)",
          "new_api": null,
          "old_text": "rgw::auth::s3::gen_v4_canonical_uri(info)",
          "new_text": null,
          "old_line_content": "  auto canonical_uri = rgw::auth::s3::gen_v4_canonical_uri(info);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5641,
          "old_api": "rgw::auth::s3::gen_v4_canonical_qs(info, is_non_s3_op)",
          "new_api": null,
          "old_text": "rgw::auth::s3::gen_v4_canonical_qs(info, is_non_s3_op)",
          "new_text": null,
          "old_line_content": "  auto canonical_qs = rgw::auth::s3::gen_v4_canonical_qs(info, is_non_s3_op);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5643,
          "old_api": "get_cct",
          "new_api": null,
          "old_text": "dpp->get_cct()",
          "new_text": null,
          "old_line_content": "  auto cct = dpp->get_cct();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5647,
          "old_api": "rgw::auth::s3::get_v4_canon_req_hash(cct,\n                                         info.method,\n                                         std::move(canonical_uri),\n                                         std::move(canonical_qs),\n                                         std::move(canonical_headers),\n                                         signed_hdrs,\n                                         exp_payload_hash,\n                                         dpp)",
          "new_api": null,
          "old_text": "rgw::auth::s3::get_v4_canon_req_hash(cct,\n                                         info.method,\n                                         std::move(canonical_uri),\n                                         std::move(canonical_qs),\n                                         std::move(canonical_headers),\n                                         signed_hdrs,\n                                         exp_payload_hash,\n                                         dpp)",
          "new_text": null,
          "old_line_content": "    rgw::auth::s3::get_v4_canon_req_hash(cct,",
          "new_line_content": "                                         info.method,",
          "content_same": false
        },
        {
          "line": 6160,
          "old_api": "rgw_user",
          "new_api": null,
          "old_text": "rgw_user(token.id)",
          "new_text": null,
          "old_line_content": "    rgw_user(token.id),",
          "new_line_content": "    token.id,",
          "content_same": false
        },
        {
          "line": 5651,
          "old_api": "std::move(canonical_headers)",
          "new_api": null,
          "old_text": "std::move(canonical_headers)",
          "new_text": null,
          "old_line_content": "                                         std::move(canonical_headers),",
          "new_line_content": "                                         signed_hdrs,",
          "content_same": false
        },
        {
          "line": 5657,
          "old_api": "rgw::auth::s3::get_v4_string_to_sign(cct,\n                                         AWS4_HMAC_SHA256_STR,\n                                         date,\n                                         credential_scope,\n                                         std::move(canonical_req_hash),\n                                         dpp)",
          "new_api": null,
          "old_text": "rgw::auth::s3::get_v4_string_to_sign(cct,\n                                         AWS4_HMAC_SHA256_STR,\n                                         date,\n                                         credential_scope,\n                                         std::move(canonical_req_hash),\n                                         dpp)",
          "new_text": null,
          "old_line_content": "    rgw::auth::s3::get_v4_string_to_sign(cct,",
          "new_line_content": "                                         AWS4_HMAC_SHA256_STR,",
          "content_same": false
        },
        {
          "line": 5661,
          "old_api": "std::move(canonical_req_hash)",
          "new_api": null,
          "old_text": "std::move(canonical_req_hash)",
          "new_text": null,
          "old_line_content": "                                         std::move(canonical_req_hash),",
          "new_line_content": "                                         dpp);",
          "content_same": false
        },
        {
          "line": 6185,
          "old_api": "rgw::from_base64(access_key_id)",
          "new_api": null,
          "old_text": "rgw::from_base64(access_key_id)",
          "new_text": null,
          "old_line_content": "    base64_token = rgw::from_base64(access_key_id);",
          "new_line_content": "  } catch (...) {",
          "content_same": false
        },
        {
          "line": 6187,
          "old_api": "std::string(\"\")",
          "new_api": null,
          "old_text": "std::string(\"\")",
          "new_text": null,
          "old_line_content": "    base64_token = std::string(\"\");",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 6191,
          "old_api": "result_t::deny()",
          "new_api": null,
          "old_text": "result_t::deny()",
          "new_text": null,
          "old_line_content": "    return result_t::deny();",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 5684,
          "old_api": "std::move(extra_headers)",
          "new_api": null,
          "old_text": "std::move(extra_headers)",
          "new_text": null,
          "old_line_content": "    std::move(extra_headers),",
          "new_line_content": "    sig_factory,",
          "content_same": false
        },
        {
          "line": 5695,
          "old_api": "get_cct",
          "new_api": null,
          "old_text": "dpp->get_cct()",
          "new_text": null,
          "old_line_content": "                                                   dpp->get_cct(),",
          "new_line_content": "                                                   secret_key,",
          "content_same": false
        },
        {
          "line": 6207,
          "old_api": "result_t::deny(-ERR_INVALID_ACCESS_KEY)",
          "new_api": null,
          "old_text": "result_t::deny(-ERR_INVALID_ACCESS_KEY)",
          "new_text": null,
          "old_line_content": "    return result_t::deny(-ERR_INVALID_ACCESS_KEY);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 6212,
          "old_api": "completer_factory",
          "new_api": null,
          "old_text": "completer_factory(boost::none)",
          "new_text": null,
          "old_line_content": "  return result_t::grant(std::move(apl), completer_factory(boost::none));",
          "new_line_content": "} /* rgw::auth::s3::LDAPEngine::authenticate */",
          "content_same": false
        },
        {
          "line": 5705,
          "old_api": "empty",
          "new_api": null,
          "old_text": "payload_hash.empty()",
          "new_text": null,
          "old_line_content": "  if (payload_hash.empty()) {",
          "new_line_content": "    payload_hash = AWS4_UNSIGNED_PAYLOAD_HASH;",
          "content_same": false
        },
        {
          "line": 5709,
          "old_api": "append",
          "new_api": null,
          "old_text": "auth_header.append(sig_info.scope + \",SignedHeaders=\")\n             .append(sig_info.signed_headers + \",Signature=\")\n             .append(signature)",
          "new_text": null,
          "old_line_content": "  auth_header.append(sig_info.scope + \",SignedHeaders=\")",
          "new_line_content": "             .append(sig_info.signed_headers + \",Signature=\")",
          "content_same": false
        },
        {
          "line": 6240,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(dpp, 5)",
          "new_text": null,
          "old_line_content": "      ldpp_dout(dpp, 5) << \"error reading user info, uid=\" << access_key_id",
          "new_line_content": "              << \" can't authenticate\" << dendl;",
          "content_same": false
        },
        {
          "line": 5730,
          "old_api": "rgw::auth::s3::parse_v4_credentials(s->info,\n\t\t\t\t\t\taccess_key_id,\n\t\t\t\t\t\tcredential_scope,\n\t\t\t\t\t\tsigned_hdrs,\n\t\t\t\t\t\tclient_signature,\n\t\t\t\t\t\tdate,\n\t\t\t\t\t\tsession_token,\n\t\t\t\t\t\tusing_qs,\n                                                s)",
          "new_api": null,
          "old_text": "rgw::auth::s3::parse_v4_credentials(s->info,\n\t\t\t\t\t\taccess_key_id,\n\t\t\t\t\t\tcredential_scope,\n\t\t\t\t\t\tsigned_hdrs,\n\t\t\t\t\t\tclient_signature,\n\t\t\t\t\t\tdate,\n\t\t\t\t\t\tsession_token,\n\t\t\t\t\t\tusing_qs,\n                                                s)",
          "new_text": null,
          "old_line_content": "  int ret = rgw::auth::s3::parse_v4_credentials(s->info,",
          "new_line_content": "\t\t\t\t\t\taccess_key_id,",
          "content_same": false
        },
        {
          "line": 6242,
          "old_api": "result_t::reject(-ERR_INVALID_ACCESS_KEY)",
          "new_api": null,
          "old_text": "result_t::reject(-ERR_INVALID_ACCESS_KEY)",
          "new_text": null,
          "old_line_content": "      return result_t::reject(-ERR_INVALID_ACCESS_KEY);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 6256,
          "old_api": "result_t::reject(-EPERM)",
          "new_api": null,
          "old_text": "result_t::reject(-EPERM)",
          "new_text": null,
          "old_line_content": "    return result_t::reject(-EPERM);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 5745,
          "old_api": "get_v4_canonical_headers",
          "new_api": null,
          "old_text": "get_v4_canonical_headers(s->info, signed_hdrs, using_qs)",
          "new_text": null,
          "old_line_content": "    get_v4_canonical_headers(s->info, signed_hdrs, using_qs);",
          "new_line_content": "  if (canonical_headers) {",
          "content_same": false
        },
        {
          "line": 5748,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(s, 10) << \"canonical headers format = \"",
          "new_line_content": "                      << sanitize{*canonical_headers} << dendl;",
          "content_same": false
        },
        {
          "line": 6262,
          "old_api": "compare",
          "new_api": null,
          "old_text": "signature.compare(server_signature)",
          "new_text": null,
          "old_line_content": "  auto compare = signature.compare(server_signature);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 6264,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(dpp, 15)",
          "new_text": null,
          "old_line_content": "  ldpp_dout(dpp, 15) << \"string_to_sign=\"",
          "new_line_content": "                 << rgw::crypt_sanitize::log_content{string_to_sign}",
          "content_same": false
        },
        {
          "line": 5754,
          "old_api": "rgw::auth::s3::is_non_s3_op(s->op_type)",
          "new_api": null,
          "old_text": "rgw::auth::s3::is_non_s3_op(s->op_type)",
          "new_text": null,
          "old_line_content": "  bool is_non_s3_op = rgw::auth::s3::is_non_s3_op(s->op_type);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 6269,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(dpp, 15)",
          "new_text": null,
          "old_line_content": "  ldpp_dout(dpp, 15) << \"compare=\" << compare << dendl;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 6272,
          "old_api": "result_t::reject(-ERR_SIGNATURE_NO_MATCH)",
          "new_api": null,
          "old_text": "result_t::reject(-ERR_SIGNATURE_NO_MATCH)",
          "new_text": null,
          "old_line_content": "    return result_t::reject(-ERR_SIGNATURE_NO_MATCH);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 5761,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "payload_hash.c_str()",
          "new_text": null,
          "old_line_content": "    exp_payload_hash = payload_hash.c_str();",
          "new_line_content": "  } else {",
          "content_same": false
        },
        {
          "line": 6275,
          "old_api": "get_info",
          "new_api": null,
          "old_text": "user->get_info()",
          "new_text": null,
          "old_line_content": "  auto apl = apl_factory->create_apl_local(cct, s, user->get_info(),",
          "new_line_content": "                                           k.subuser, std::nullopt, access_key_id);",
          "content_same": false
        },
        {
          "line": 5764,
          "old_api": "rgw::auth::s3::get_v4_exp_payload_hash(s->info)",
          "new_api": null,
          "old_text": "rgw::auth::s3::get_v4_exp_payload_hash(s->info)",
          "new_text": null,
          "old_line_content": "    exp_payload_hash = rgw::auth::s3::get_v4_exp_payload_hash(s->info);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 6277,
          "old_api": "completer_factory",
          "new_api": null,
          "old_text": "completer_factory(k.key)",
          "new_text": null,
          "old_line_content": "  return result_t::grant(std::move(apl), completer_factory(k.key));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 5768,
          "old_api": "rgw::auth::s3::get_v4_canonical_uri(s->info)",
          "new_api": null,
          "old_text": "rgw::auth::s3::get_v4_canonical_uri(s->info)",
          "new_text": null,
          "old_line_content": "  auto canonical_uri = rgw::auth::s3::get_v4_canonical_uri(s->info);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5771,
          "old_api": "rgw::auth::s3::get_v4_canonical_qs(s->info, using_qs)",
          "new_api": null,
          "old_text": "rgw::auth::s3::get_v4_canonical_qs(s->info, using_qs)",
          "new_text": null,
          "old_line_content": "  auto canonical_qs = rgw::auth::s3::get_v4_canonical_qs(s->info, using_qs);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5774,
          "old_api": "rgw::auth::s3::get_v4_canonical_method(s)",
          "new_api": null,
          "old_text": "rgw::auth::s3::get_v4_canonical_method(s)",
          "new_text": null,
          "old_line_content": "  auto canonical_method = rgw::auth::s3::get_v4_canonical_method(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5782,
          "old_api": "std::move(*canonical_headers)",
          "new_api": null,
          "old_text": "std::move(*canonical_headers)",
          "new_text": null,
          "old_line_content": "                                         std::move(*canonical_headers),",
          "new_line_content": "                                         signed_hdrs,",
          "content_same": false
        },
        {
          "line": 5788,
          "old_api": "rgw::auth::s3::get_v4_string_to_sign(s->cct,\n                                         AWS4_HMAC_SHA256_STR,\n                                         date,\n                                         credential_scope,\n                                         std::move(canonical_req_hash),\n                                         s)",
          "new_api": null,
          "old_text": "rgw::auth::s3::get_v4_string_to_sign(s->cct,\n                                         AWS4_HMAC_SHA256_STR,\n                                         date,\n                                         credential_scope,\n                                         std::move(canonical_req_hash),\n                                         s)",
          "new_text": null,
          "old_line_content": "    rgw::auth::s3::get_v4_string_to_sign(s->cct,",
          "new_line_content": "                                         AWS4_HMAC_SHA256_STR,",
          "content_same": false
        },
        {
          "line": 6303,
          "old_api": "rgw::from_base64(session_token)",
          "new_api": null,
          "old_text": "rgw::from_base64(session_token)",
          "new_text": null,
          "old_line_content": "    decodedSessionToken = rgw::from_base64(session_token);",
          "new_line_content": "  } catch (...) {",
          "content_same": false
        },
        {
          "line": 5792,
          "old_api": "std::move(canonical_req_hash)",
          "new_api": null,
          "old_text": "std::move(canonical_req_hash)",
          "new_text": null,
          "old_line_content": "                                         std::move(canonical_req_hash),",
          "new_line_content": "                                         s);",
          "content_same": false
        },
        {
          "line": 6305,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(dpp, 0)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(dpp, 0) << \"ERROR: Invalid session token, not base64 encoded.\" << dendl;",
          "new_line_content": "    return -EINVAL;",
          "content_same": false
        },
        {
          "line": 5795,
          "old_api": "std::bind(rgw::auth::s3::get_v4_signature,\n                                     credential_scope,\n                                     std::placeholders::_1,\n                                     std::placeholders::_2,\n                                     std::placeholders::_3,\n                                     s)",
          "new_api": null,
          "old_text": "std::bind(rgw::auth::s3::get_v4_signature,\n                                     credential_scope,\n                                     std::placeholders::_1,\n                                     std::placeholders::_2,\n                                     std::placeholders::_3,\n                                     s)",
          "new_text": null,
          "old_line_content": "  const auto sig_factory = std::bind(rgw::auth::s3::get_v4_signature,",
          "new_line_content": "                                     credential_scope,",
          "content_same": false
        },
        {
          "line": 5285,
          "old_api": "set_prefetch_data",
          "new_api": null,
          "old_text": "obj->set_prefetch_data()",
          "new_text": null,
          "old_line_content": "  obj->set_prefetch_data();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 6309,
          "old_api": "get_crypto_handler",
          "new_api": null,
          "old_text": "cct->get_crypto_handler(CEPH_CRYPTO_AES)",
          "new_text": null,
          "old_line_content": "  auto* cryptohandler = cct->get_crypto_handler(CEPH_CRYPTO_AES);",
          "new_line_content": "  if (! cryptohandler) {",
          "content_same": false
        },
        {
          "line": 5288,
          "old_api": "get_obj_state",
          "new_api": null,
          "old_text": "obj->get_obj_state(s, &state, s->yield)",
          "new_text": null,
          "old_line_content": "  if (obj->get_obj_state(s, &state, s->yield) < 0) {",
          "new_line_content": "    return false;",
          "content_same": false
        },
        {
          "line": 6314,
          "old_api": "length",
          "new_api": null,
          "old_text": "secret_s.length()",
          "new_text": null,
          "old_line_content": "  buffer::ptr secret(secret_s.c_str(), secret_s.length());",
          "new_line_content": "  int ret = 0;",
          "content_same": false
        },
        {
          "line": 6317,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(dpp, 0)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(dpp, 0) << \"ERROR: Invalid secret key\" << dendl;",
          "new_line_content": "    return -EINVAL;",
          "content_same": false
        },
        {
          "line": 6321,
          "old_api": "get_key_handler",
          "new_api": null,
          "old_text": "cryptohandler->get_key_handler(secret, error)",
          "new_text": null,
          "old_line_content": "  std::unique_ptr<CryptoKeyHandler> keyhandler(cryptohandler->get_key_handler(secret, error));",
          "new_line_content": "  if (! keyhandler) {",
          "content_same": false
        },
        {
          "line": 6325,
          "old_api": "clear",
          "new_api": null,
          "old_text": "error.clear()",
          "new_text": null,
          "old_line_content": "  error.clear();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5814,
          "old_api": "is_v4_payload_empty",
          "new_api": null,
          "old_text": "is_v4_payload_empty(s)",
          "new_text": null,
          "old_line_content": "  if (is_v4_payload_unsigned(exp_payload_hash) || is_v4_payload_empty(s) || is_non_s3_op) {",
          "new_line_content": "    return {",
          "content_same": false
        },
        {
          "line": 5304,
          "old_api": "get_name",
          "new_api": null,
          "old_text": "s->object->get_name()",
          "new_text": null,
          "old_line_content": "    original_object_name = s->object->get_name();",
          "new_line_content": "  } else {",
          "content_same": false
        },
        {
          "line": 6329,
          "old_api": "buffer::list::static_from_string(decodedSessionToken)",
          "new_api": null,
          "old_text": "buffer::list::static_from_string(decodedSessionToken)",
          "new_text": null,
          "old_line_content": "  en_input = buffer::list::static_from_string(decodedSessionToken);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5819,
          "old_api": "std::move(string_to_sign)",
          "new_api": null,
          "old_text": "std::move(string_to_sign)",
          "new_text": null,
          "old_line_content": "      std::move(string_to_sign),",
          "new_line_content": "      sig_factory,",
          "content_same": false
        },
        {
          "line": 6331,
          "old_api": "decrypt",
          "new_api": null,
          "old_text": "keyhandler->decrypt(en_input, dec_output, &error)",
          "new_text": null,
          "old_line_content": "  ret = keyhandler->decrypt(en_input, dec_output, &error);",
          "new_line_content": "  if (ret < 0) {",
          "content_same": false
        },
        {
          "line": 5309,
          "old_api": "RGWHandler_REST_S3::init(driver, s, cio)",
          "new_api": null,
          "old_text": "RGWHandler_REST_S3::init(driver, s, cio)",
          "new_text": null,
          "old_line_content": "  return RGWHandler_REST_S3::init(driver, s, cio);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 6333,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(dpp, 0)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(dpp, 0) << \"ERROR: Decryption failed: \" << error << dendl;",
          "new_line_content": "    return -EPERM;",
          "content_same": false
        },
        {
          "line": 5314,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "  ldpp_dout(s, 10) << __func__ << \" Starting retarget\" << dendl;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 6339,
          "old_api": "decode",
          "new_api": null,
          "old_text": "decode(token, iter)",
          "new_text": null,
          "old_line_content": "      decode(token, iter);",
          "new_line_content": "    } catch (const buffer::error& e) {",
          "content_same": false
        },
        {
          "line": 6341,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(dpp, 0)",
          "new_text": null,
          "old_line_content": "      ldpp_dout(dpp, 0) << \"ERROR: decode SessionToken failed: \" << error << dendl;",
          "new_line_content": "      return -EINVAL;",
          "content_same": false
        },
        {
          "line": 5319,
          "old_api": "get",
          "new_api": null,
          "old_text": "s->bucket.get()",
          "new_text": null,
          "old_line_content": "  if (rgw::sal::Bucket::empty(s->bucket.get())) {",
          "new_line_content": "    // TODO-FUTURE: if the bucket does not exist, maybe expose it here?",
          "content_same": false
        },
        {
          "line": 5831,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "      ldpp_dout(s, 10) << \"delaying v4 auth\" << dendl;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5324,
          "old_api": "get_info",
          "new_api": null,
          "old_text": "s->bucket->get_info()",
          "new_text": null,
          "old_line_content": "  if (!s->bucket->get_info().has_website) {",
          "new_line_content": "    // TODO-FUTURE: if the bucket has no WebsiteConfig, expose it here",
          "content_same": false
        },
        {
          "line": 5332,
          "old_api": "get_name",
          "new_api": null,
          "old_text": "s->object->get_name()",
          "new_text": null,
          "old_line_content": "    key_name = s->object->get_name();",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 5334,
          "old_api": "web_dir",
          "new_api": null,
          "old_text": "web_dir()",
          "new_text": null,
          "old_line_content": "  bool get_res = s->bucket->get_info().website_conf.get_effective_key(key_name, &new_obj.name, web_dir());",
          "new_line_content": "  if (!get_res) {",
          "content_same": false
        },
        {
          "line": 5337,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 5)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(s, 5) << s->err.message << dendl;",
          "new_line_content": "    return -EINVAL;",
          "content_same": false
        },
        {
          "line": 6363,
          "old_api": "result_t::deny()",
          "new_api": null,
          "old_text": "result_t::deny()",
          "new_text": null,
          "old_line_content": "    return result_t::deny();",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 5341,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "  ldpp_dout(s, 10) << \"retarget get_effective_key \" << s->object << \" -> \"",
          "new_line_content": "\t\t    << new_obj << dendl;",
          "content_same": false
        },
        {
          "line": 6368,
          "old_api": "result_t::reject(ret)",
          "new_api": null,
          "old_text": "result_t::reject(ret)",
          "new_text": null,
          "old_line_content": "    return result_t::reject(ret);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 5346,
          "old_api": "should_redirect",
          "new_api": null,
          "old_text": "s->bucket->get_info().website_conf.should_redirect(new_obj.name, 0, &rrule)",
          "new_text": null,
          "old_line_content": "    s->bucket->get_info().website_conf.should_redirect(new_obj.name, 0, &rrule);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5349,
          "old_api": "get",
          "new_api": null,
          "old_text": "s->info.env->get(\"HTTP_HOST\", \"\")",
          "new_text": null,
          "old_line_content": "    const string& hostname = s->info.env->get(\"HTTP_HOST\", \"\");",
          "new_line_content": "    const string& protocol =",
          "content_same": false
        },
        {
          "line": 6374,
          "old_api": "result_t::reject(-EPERM)",
          "new_api": null,
          "old_text": "result_t::reject(-EPERM)",
          "new_text": null,
          "old_line_content": "    return result_t::reject(-EPERM);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 5351,
          "old_api": "get",
          "new_api": null,
          "old_text": "s->info.env->get(\"SERVER_PORT_SECURE\")",
          "new_text": null,
          "old_line_content": "      (s->info.env->get(\"SERVER_PORT_SECURE\") ? \"https\" : \"http\");",
          "new_line_content": "    int redirect_code = 0;",
          "content_same": false
        },
        {
          "line": 5353,
          "old_api": "apply_rule",
          "new_api": null,
          "old_text": "rrule.apply_rule(protocol, hostname, key_name, &s->redirect,\n\t\t    &redirect_code)",
          "new_text": null,
          "old_line_content": "    rrule.apply_rule(protocol, hostname, key_name, &s->redirect,",
          "new_line_content": "\t\t    &redirect_code);",
          "content_same": false
        },
        {
          "line": 6377,
          "old_api": "empty",
          "new_api": null,
          "old_text": "token.expiration.empty()",
          "new_text": null,
          "old_line_content": "  if (! token.expiration.empty()) {",
          "new_line_content": "    std::string expiration = token.expiration;",
          "content_same": false
        },
        {
          "line": 6380,
          "old_api": "ceph::from_iso_8601(expiration, false)",
          "new_api": null,
          "old_text": "ceph::from_iso_8601(expiration, false)",
          "new_text": null,
          "old_line_content": "      boost::optional<real_clock::time_point> exp = ceph::from_iso_8601(expiration, false);",
          "new_line_content": "      if (exp) {",
          "content_same": false
        },
        {
          "line": 5358,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(s, 10) << \"retarget redirect code=\" << redirect_code",
          "new_line_content": "\t\t      << \" proto+host:\" << protocol << \"://\" << hostname",
          "content_same": false
        },
        {
          "line": 6382,
          "old_api": "real_clock::now()",
          "new_api": null,
          "old_text": "real_clock::now()",
          "new_text": null,
          "old_line_content": "        real_clock::time_point now = real_clock::now();",
          "new_line_content": "        if (now >= *exp) {",
          "content_same": false
        },
        {
          "line": 5873,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "          ldpp_dout(s, 10) << \"ERROR: AWS4 completion for operation: \" << s->op_type << \", NOT IMPLEMENTED\" << dendl;",
          "new_line_content": "          throw -ERR_NOT_IMPLEMENTED;",
          "content_same": false
        },
        {
          "line": 6385,
          "old_api": "result_t::reject(-EPERM)",
          "new_api": null,
          "old_text": "result_t::reject(-EPERM)",
          "new_text": null,
          "old_line_content": "          return result_t::reject(-EPERM);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 5877,
          "old_api": "std::bind(AWSv4ComplSingle::create,\n                                          s,\n                                          std::placeholders::_1)",
          "new_api": null,
          "old_text": "std::bind(AWSv4ComplSingle::create,\n                                          s,\n                                          std::placeholders::_1)",
          "new_text": null,
          "old_line_content": "      const auto cmpl_factory = std::bind(AWSv4ComplSingle::create,",
          "new_line_content": "                                          s,",
          "content_same": false
        },
        {
          "line": 6389,
          "old_api": "result_t::reject(-EPERM)",
          "new_api": null,
          "old_text": "result_t::reject(-EPERM)",
          "new_text": null,
          "old_line_content": "        return result_t::reject(-EPERM);",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 5370,
          "old_api": "get_object",
          "new_api": null,
          "old_text": "s->bucket->get_object(new_obj)",
          "new_text": null,
          "old_line_content": "  s->object = s->bucket->get_object(new_obj);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5884,
          "old_api": "std::move(string_to_sign)",
          "new_api": null,
          "old_text": "std::move(string_to_sign)",
          "new_text": null,
          "old_line_content": "        std::move(string_to_sign),",
          "new_line_content": "        sig_factory,",
          "content_same": false
        },
        {
          "line": 6396,
          "old_api": "compare",
          "new_api": null,
          "old_text": "signature.compare(server_signature)",
          "new_text": null,
          "old_line_content": "  auto compare = signature.compare(server_signature);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 6398,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(dpp, 15)",
          "new_text": null,
          "old_line_content": "  ldpp_dout(dpp, 15) << \"string_to_sign=\"",
          "new_line_content": "                 << rgw::crypt_sanitize::log_content{string_to_sign}",
          "content_same": false
        },
        {
          "line": 5377,
          "old_api": "get_obj_op",
          "new_api": null,
          "old_text": "get_obj_op(true)",
          "new_text": null,
          "old_line_content": "  return get_obj_op(true);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 6403,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(dpp, 15)",
          "new_text": null,
          "old_line_content": "  ldpp_dout(dpp, 15) << \"compare=\" << compare << dendl;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5892,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "      ldpp_dout(s, 10) << \"body content detected in multiple chunks\" << dendl;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5382,
          "old_api": "get_obj_op",
          "new_api": null,
          "old_text": "get_obj_op(false)",
          "new_text": null,
          "old_line_content": "  return get_obj_op(false);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 6406,
          "old_api": "result_t::reject(-ERR_SIGNATURE_NO_MATCH)",
          "new_api": null,
          "old_text": "result_t::reject(-ERR_SIGNATURE_NO_MATCH)",
          "new_text": null,
          "old_line_content": "    return result_t::reject(-ERR_SIGNATURE_NO_MATCH);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 5387,
          "old_api": "reset",
          "new_api": null,
          "old_text": "s->formatter->reset()",
          "new_text": null,
          "old_line_content": "  s->formatter->reset(); /* Try to throw it all away */",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5901,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "          ldpp_dout(s, 10) << \"ERROR: AWS4 completion for this operation NOT IMPLEMENTED (streaming mode)\" << dendl;",
          "new_line_content": "          throw -ERR_NOT_IMPLEMENTED;",
          "content_same": false
        },
        {
          "line": 5390,
          "old_api": "get",
          "new_api": null,
          "old_text": "getop.get()",
          "new_text": null,
          "old_line_content": "  if (getop.get() == NULL) {",
          "new_line_content": "    return -1; // Trigger double error handler",
          "content_same": false
        },
        {
          "line": 5393,
          "old_api": "init",
          "new_api": null,
          "old_text": "getop->init(driver, s, this)",
          "new_text": null,
          "old_line_content": "  getop->init(driver, s, this);",
          "new_line_content": "  getop->range_str = NULL;",
          "content_same": false
        },
        {
          "line": 5905,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "      ldpp_dout(s, 10) << \"aws4 seed signature ok... delaying v4 auth\" << dendl;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 6418,
          "old_api": "result_t::deny(-EPERM)",
          "new_api": null,
          "old_text": "result_t::deny(-EPERM)",
          "new_text": null,
          "old_line_content": "      return result_t::deny(-EPERM);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 6422,
          "old_api": "get_tenant",
          "new_api": null,
          "old_text": "role->get_tenant()",
          "new_text": null,
          "old_line_content": "    r.tenant = role->get_tenant();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 6424,
          "old_api": "get_role_policy_names",
          "new_api": null,
          "old_text": "role->get_role_policy_names()",
          "new_text": null,
          "old_line_content": "    vector<string> role_policy_names = role->get_role_policy_names();",
          "new_line_content": "    for (auto& policy_name : role_policy_names) {",
          "content_same": false
        },
        {
          "line": 5402,
          "old_api": "get_object",
          "new_api": null,
          "old_text": "driver->get_object(errordoc_key)",
          "new_text": null,
          "old_line_content": "  s->object = driver->get_object(errordoc_key);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5404,
          "old_api": "get",
          "new_api": null,
          "old_text": "getop.get()",
          "new_text": null,
          "old_line_content": "  ret = init_permissions(getop.get(), y);",
          "new_line_content": "  if (ret < 0) {",
          "content_same": false
        },
        {
          "line": 5917,
          "old_api": "std::bind(AWSv4ComplMulti::create,\n                                          s,\n                                          date,\n                                          credential_scope,\n                                          client_signature,\n                                          std::placeholders::_1)",
          "new_api": null,
          "old_text": "std::bind(AWSv4ComplMulti::create,\n                                          s,\n                                          date,\n                                          credential_scope,\n                                          client_signature,\n                                          std::placeholders::_1)",
          "new_text": null,
          "old_line_content": "      const auto cmpl_factory = std::bind(AWSv4ComplMulti::create,",
          "new_line_content": "                                          s,",
          "content_same": false
        },
        {
          "line": 5406,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 20)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(s, 20) << \"serve_errordoc failed, init_permissions ret=\" << ret << dendl;",
          "new_line_content": "    return -1; // Trigger double error handler",
          "content_same": false
        },
        {
          "line": 6428,
          "old_api": "std::move(perm_policy)",
          "new_api": null,
          "old_text": "std::move(perm_policy)",
          "new_text": null,
          "old_line_content": "        r.role_policies.push_back(std::move(perm_policy));",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 5410,
          "old_api": "get",
          "new_api": null,
          "old_text": "getop.get()",
          "new_text": null,
          "old_line_content": "  ret = read_permissions(getop.get(), y);",
          "new_line_content": "  if (ret < 0) {",
          "content_same": false
        },
        {
          "line": 6434,
          "old_api": "empty",
          "new_api": null,
          "old_text": "token.user.empty()",
          "new_text": null,
          "old_line_content": "  if (! token.user.empty() && token.acct_type != TYPE_ROLE) {",
          "new_line_content": "    // get user info",
          "content_same": false
        },
        {
          "line": 5412,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 20)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(s, 20) << \"serve_errordoc failed, read_permissions ret=\" << ret << dendl;",
          "new_line_content": "    return -1; // Trigger double error handler",
          "content_same": false
        },
        {
          "line": 6436,
          "old_api": "load_user",
          "new_api": null,
          "old_text": "user->load_user(dpp, y)",
          "new_text": null,
          "old_line_content": "    int ret = user->load_user(dpp, y);",
          "new_line_content": "    if (ret < 0) {",
          "content_same": false
        },
        {
          "line": 5927,
          "old_api": "std::move(string_to_sign)",
          "new_api": null,
          "old_text": "std::move(string_to_sign)",
          "new_text": null,
          "old_line_content": "        std::move(string_to_sign),",
          "new_line_content": "        sig_factory,",
          "content_same": false
        },
        {
          "line": 6439,
          "old_api": "result_t::reject(-EPERM)",
          "new_api": null,
          "old_text": "result_t::reject(-EPERM)",
          "new_text": null,
          "old_line_content": "      return result_t::reject(-EPERM);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 5417,
          "old_api": "set_custom_http_response",
          "new_api": null,
          "old_text": "getop->set_custom_http_response(http_ret)",
          "new_text": null,
          "old_line_content": "     getop->set_custom_http_response(http_ret);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 5420,
          "old_api": "init_processing",
          "new_api": null,
          "old_text": "getop->init_processing(y)",
          "new_text": null,
          "old_line_content": "  ret = getop->init_processing(y);",
          "new_line_content": "  if (ret < 0) {",
          "content_same": false
        },
        {
          "line": 5422,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 20)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(s, 20) << \"serve_errordoc failed, init_processing ret=\" << ret << dendl;",
          "new_line_content": "    return -1; // Trigger double error handler",
          "content_same": false
        },
        {
          "line": 6446,
          "old_api": "completer_factory",
          "new_api": null,
          "old_text": "completer_factory(token.secret_access_key)",
          "new_text": null,
          "old_line_content": "    return result_t::grant(std::move(apl), completer_factory(token.secret_access_key));",
          "new_line_content": "  } else if (token.acct_type == TYPE_ROLE) {",
          "content_same": false
        },
        {
          "line": 5426,
          "old_api": "verify_op_mask",
          "new_api": null,
          "old_text": "getop->verify_op_mask()",
          "new_text": null,
          "old_line_content": "  ret = getop->verify_op_mask();",
          "new_line_content": "  if (ret < 0) {",
          "content_same": false
        },
        {
          "line": 5428,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 20)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(s, 20) << \"serve_errordoc failed, verify_op_mask ret=\" << ret << dendl;",
          "new_line_content": "    return -1; // Trigger double error handler",
          "content_same": false
        },
        {
          "line": 5942,
          "old_api": "rgw::auth::s3::get_v4_canonical_headers(info, signedheaders,\n                                                 using_qs, true)",
          "new_api": null,
          "old_text": "rgw::auth::s3::get_v4_canonical_headers(info, signedheaders,\n                                                 using_qs, true)",
          "new_text": null,
          "old_line_content": "  return rgw::auth::s3::get_v4_canonical_headers(info, signedheaders,",
          "new_line_content": "                                                 using_qs, true);",
          "content_same": false
        },
        {
          "line": 6455,
          "old_api": "completer_factory",
          "new_api": null,
          "old_text": "completer_factory(token.secret_access_key)",
          "new_text": null,
          "old_line_content": "    return result_t::grant(std::move(apl), completer_factory(token.secret_access_key));",
          "new_line_content": "  } else { // This is for all local users of type TYPE_RGW or TYPE_NONE",
          "content_same": false
        },
        {
          "line": 5432,
          "old_api": "verify_permission",
          "new_api": null,
          "old_text": "getop->verify_permission(y)",
          "new_text": null,
          "old_line_content": "  ret = getop->verify_permission(y);",
          "new_line_content": "  if (ret < 0) {",
          "content_same": false
        },
        {
          "line": 5434,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 20)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(s, 20) << \"serve_errordoc failed, verify_permission ret=\" << ret << dendl;",
          "new_line_content": "    return -1; // Trigger double error handler",
          "content_same": false
        },
        {
          "line": 6459,
          "old_api": "completer_factory",
          "new_api": null,
          "old_text": "completer_factory(token.secret_access_key)",
          "new_text": null,
          "old_line_content": "    return result_t::grant(std::move(apl), completer_factory(token.secret_access_key));",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 5438,
          "old_api": "verify_params",
          "new_api": null,
          "old_text": "getop->verify_params()",
          "new_text": null,
          "old_line_content": "  ret = getop->verify_params();",
          "new_line_content": "  if (ret < 0) {",
          "content_same": false
        },
        {
          "line": 5440,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 20)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(s, 20) << \"serve_errordoc failed, verify_params ret=\" << ret << dendl;",
          "new_line_content": "    return -1; // Trigger double error handler",
          "content_same": false
        },
        {
          "line": 5955,
          "old_api": "get",
          "new_api": null,
          "old_text": "s->info.env->get(\"HTTP_AUTHORIZATION\")",
          "new_text": null,
          "old_line_content": "  const char* http_auth = s->info.env->get(\"HTTP_AUTHORIZATION\");",
          "new_line_content": "  if (! http_auth || http_auth[0] == '\\0') {",
          "content_same": false
        },
        {
          "line": 6468,
          "old_api": "discover_aws_flavour",
          "new_api": null,
          "old_text": "discover_aws_flavour(s->info)",
          "new_text": null,
          "old_line_content": "  std::tie(version, route) = discover_aws_flavour(s->info);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5445,
          "old_api": "pre_exec",
          "new_api": null,
          "old_text": "getop->pre_exec()",
          "new_text": null,
          "old_line_content": "  getop->pre_exec();",
          "new_line_content": "  /*",
          "content_same": false
        },
        {
          "line": 5960,
          "old_api": "get",
          "new_api": null,
          "old_text": "s->info.args.get(\"Signature\")",
          "new_text": null,
          "old_line_content": "    signature = s->info.args.get(\"Signature\");",
          "new_line_content": "    qsr = true;",
          "content_same": false
        },
        {
          "line": 5964,
          "old_api": "empty",
          "new_api": null,
          "old_text": "expires.empty()",
          "new_text": null,
          "old_line_content": "    if (expires.empty()) {",
          "new_line_content": "      throw -EPERM;",
          "content_same": false
        },
        {
          "line": 5454,
          "old_api": "complete",
          "new_api": null,
          "old_text": "getop->complete()",
          "new_text": null,
          "old_line_content": "  getop->complete();",
          "new_line_content": "  return 0;",
          "content_same": false
        },
        {
          "line": 5970,
          "old_api": "data",
          "new_api": null,
          "old_text": "expires.data()",
          "new_text": null,
          "old_line_content": "    const time_t exp = atoll(expires.data());",
          "new_line_content": "    time_t now;",
          "content_same": false
        },
        {
          "line": 5972,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(&now)",
          "new_text": null,
          "old_line_content": "    time(&now);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5462,
          "old_api": "find",
          "new_api": null,
          "old_text": "rgw_http_s3_errors.find(err_no > 0 ? err_no : -err_no)",
          "new_text": null,
          "old_line_content": "  rgw_http_errors::const_iterator r = rgw_http_s3_errors.find(err_no > 0 ? err_no : -err_no);",
          "new_line_content": "  int http_error_code = -1;",
          "content_same": false
        },
        {
          "line": 5465,
          "old_api": "end",
          "new_api": null,
          "old_text": "rgw_http_s3_errors.end()",
          "new_text": null,
          "old_line_content": "  if (r != rgw_http_s3_errors.end()) {",
          "new_line_content": "    http_error_code = r->second.first;",
          "content_same": false
        },
        {
          "line": 5979,
          "old_api": "size",
          "new_api": null,
          "old_text": "session_token.size()",
          "new_text": null,
          "old_line_content": "      if (session_token.size() == 0) {",
          "new_line_content": "        throw -EPERM;",
          "content_same": false
        },
        {
          "line": 5468,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "  ldpp_dout(s, 10) << \"RGWHandler_REST_S3Website::error_handler err_no=\" << err_no << \" http_ret=\" << http_error_code << dendl;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5471,
          "old_api": "get",
          "new_api": null,
          "old_text": "s->bucket.get()",
          "new_text": null,
          "old_line_content": "  bool have_bucket = !rgw::sal::Bucket::empty(s->bucket.get());",
          "new_line_content": "  bool should_redirect = false;",
          "content_same": false
        },
        {
          "line": 5475,
          "old_api": "should_redirect",
          "new_api": null,
          "old_text": "s->bucket->get_info().website_conf.should_redirect(original_object_name,\n\t\t\t\t\t\t\t http_error_code, &rrule)",
          "new_text": null,
          "old_line_content": "      s->bucket->get_info().website_conf.should_redirect(original_object_name,",
          "new_line_content": "\t\t\t\t\t\t\t http_error_code, &rrule);",
          "content_same": false
        },
        {
          "line": 5987,
          "old_api": "rfind",
          "new_api": null,
          "old_text": "auth_str.rfind(':')",
          "new_text": null,
          "old_line_content": "    const size_t pos = auth_str.rfind(':');",
          "new_line_content": "    if (pos != std::string_view::npos) {",
          "content_same": false
        },
        {
          "line": 5990,
          "old_api": "substr",
          "new_api": null,
          "old_text": "auth_str.substr(pos + 1)",
          "new_text": null,
          "old_line_content": "      signature = auth_str.substr(pos + 1);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 5480,
          "old_api": "get",
          "new_api": null,
          "old_text": "s->info.env->get(\"HTTP_HOST\", \"\")",
          "new_text": null,
          "old_line_content": "    const string& hostname = s->info.env->get(\"HTTP_HOST\", \"\");",
          "new_line_content": "    const string& protocol =",
          "content_same": false
        },
        {
          "line": 5993,
          "old_api": "get_optional",
          "new_api": null,
          "old_text": "s->info.env->get_optional(\"HTTP_X_AMZ_SECURITY_TOKEN\")",
          "new_text": null,
          "old_line_content": "    auto token = s->info.env->get_optional(\"HTTP_X_AMZ_SECURITY_TOKEN\");",
          "new_line_content": "    if (token) {",
          "content_same": false
        },
        {
          "line": 5482,
          "old_api": "get",
          "new_api": null,
          "old_text": "s->info.env->get(\"SERVER_PORT_SECURE\")",
          "new_text": null,
          "old_line_content": "      (s->info.env->get(\"SERVER_PORT_SECURE\") ? \"https\" : \"http\");",
          "new_line_content": "    int redirect_code = 0;",
          "content_same": false
        },
        {
          "line": 5484,
          "old_api": "apply_rule",
          "new_api": null,
          "old_text": "rrule.apply_rule(protocol, hostname, original_object_name,\n                     &s->redirect, &redirect_code)",
          "new_text": null,
          "old_line_content": "    rrule.apply_rule(protocol, hostname, original_object_name,",
          "new_line_content": "                     &s->redirect, &redirect_code);",
          "content_same": false
        },
        {
          "line": 5996,
          "old_api": "size",
          "new_api": null,
          "old_text": "session_token.size()",
          "new_text": null,
          "old_line_content": "      if (session_token.size() == 0) {",
          "new_line_content": "        throw -EPERM;",
          "content_same": false
        },
        {
          "line": 5489,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(s, 10) << \"error handler redirect code=\" << redirect_code",
          "new_line_content": "\t\t      << \" proto+host:\" << protocol << \"://\" << hostname",
          "content_same": false
        },
        {
          "line": 6005,
          "old_api": "rgw_create_s3_canonical_header",
          "new_api": null,
          "old_text": "rgw_create_s3_canonical_header(s, s->info, &header_time, string_to_sign,\n        qsr)",
          "new_text": null,
          "old_line_content": "  if (! rgw_create_s3_canonical_header(s, s->info, &header_time, string_to_sign,",
          "new_line_content": "        qsr)) {",
          "content_same": false
        },
        {
          "line": 6007,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(s, 10) << \"failed to create the canonized auth header\\n\"",
          "new_line_content": "                   << rgw::crypt_sanitize::auth{s,string_to_sign} << dendl;",
          "content_same": false
        },
        {
          "line": 5496,
          "old_api": "empty",
          "new_api": null,
          "old_text": "s->bucket->get_info().website_conf.error_doc.empty()",
          "new_text": null,
          "old_line_content": "  } else if (have_bucket && !s->bucket->get_info().website_conf.error_doc.empty()) {",
          "new_line_content": "    /* This serves an entire page!",
          "content_same": false
        },
        {
          "line": 6012,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "  ldpp_dout(s, 10) << \"string_to_sign:\\n\"",
          "new_line_content": "                 << rgw::crypt_sanitize::auth{s,string_to_sign} << dendl;",
          "content_same": false
        },
        {
          "line": 5501,
          "old_api": "get_info",
          "new_api": null,
          "old_text": "s->bucket->get_info()",
          "new_text": null,
          "old_line_content": "    new_err_no = RGWHandler_REST_S3Website::serve_errordoc(s, http_error_code, s->bucket->get_info().website_conf.error_doc, y);",
          "new_line_content": "    if (new_err_no != -1) {",
          "content_same": false
        },
        {
          "line": 6015,
          "old_api": "is_time_skew_ok",
          "new_api": null,
          "old_text": "is_time_skew_ok(header_time)",
          "new_text": null,
          "old_line_content": "  if (!qsr && !is_time_skew_ok(header_time)) {",
          "new_line_content": "    throw -ERR_REQUEST_TIME_SKEWED;",
          "content_same": false
        },
        {
          "line": 5506,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 20)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(s, 20) << \"No special error handling today!\" << dendl;",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 6023,
          "old_api": "std::move(string_to_sign)",
          "new_api": null,
          "old_text": "std::move(string_to_sign)",
          "new_text": null,
          "old_line_content": "    std::move(string_to_sign),",
          "new_line_content": "    rgw::auth::s3::get_v2_signature,",
          "content_same": false
        },
        {
          "line": 5519,
          "old_api": "set_get_data",
          "new_api": null,
          "old_text": "op->set_get_data(get_data)",
          "new_text": null,
          "old_line_content": "  op->set_get_data(get_data);",
          "new_line_content": "  return op;",
          "content_same": false
        },
        {
          "line": 6037,
          "old_api": "to_str",
          "new_api": null,
          "old_text": "s->auth.s3_postobj_creds.encoded_policy.to_str()",
          "new_text": null,
          "old_line_content": "    s->auth.s3_postobj_creds.encoded_policy.to_str(),",
          "new_line_content": "    rgw::auth::s3::get_v2_signature,",
          "content_same": false
        },
        {
          "line": 5530,
          "old_api": "set_get_data",
          "new_api": null,
          "old_text": "op->set_get_data(get_data)",
          "new_text": null,
          "old_line_content": "  op->set_get_data(get_data);",
          "new_line_content": "  return op;",
          "content_same": false
        },
        {
          "line": 6051,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "  ldpp_dout(s, 10) << \"access key id = \" << access_key_id << dendl;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5541,
          "old_api": "set_get_data",
          "new_api": null,
          "old_text": "op->set_get_data(get_data)",
          "new_text": null,
          "old_line_content": "  op->set_get_data(get_data);",
          "new_line_content": "  return op;",
          "content_same": false
        },
        {
          "line": 6055,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 10)",
          "new_text": null,
          "old_line_content": "  ldpp_dout(s, 10) << \"credential scope = \" << credential_scope << dendl;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 6057,
          "old_api": "std::bind(rgw::auth::s3::get_v4_signature,\n                                     credential_scope,\n                                     std::placeholders::_1,\n                                     std::placeholders::_2,\n                                     std::placeholders::_3,\n                                     s)",
          "new_api": null,
          "old_text": "std::bind(rgw::auth::s3::get_v4_signature,\n                                     credential_scope,\n                                     std::placeholders::_1,\n                                     std::placeholders::_2,\n                                     std::placeholders::_3,\n                                     s)",
          "new_text": null,
          "old_line_content": "  const auto sig_factory = std::bind(rgw::auth::s3::get_v4_signature,",
          "new_line_content": "                                     credential_scope,",
          "content_same": false
        },
        {
          "line": 6068,
          "old_api": "to_str",
          "new_api": null,
          "old_text": "s->auth.s3_postobj_creds.encoded_policy.to_str()",
          "new_text": null,
          "old_line_content": "    s->auth.s3_postobj_creds.encoded_policy.to_str(),",
          "new_line_content": "    sig_factory,",
          "content_same": false
        },
        {
          "line": 5560,
          "old_api": "discover_aws_flavour",
          "new_api": null,
          "old_text": "discover_aws_flavour(s->info)",
          "new_text": null,
          "old_line_content": "  std::tie(version, route) = discover_aws_flavour(s->info);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5563,
          "old_api": "get_auth_data_v2",
          "new_api": null,
          "old_text": "get_auth_data_v2(s)",
          "new_text": null,
          "old_line_content": "    return get_auth_data_v2(s);",
          "new_line_content": "  } else if (version == AwsVersion::V4) {",
          "content_same": false
        },
        {
          "line": 5565,
          "old_api": "get_auth_data_v4",
          "new_api": null,
          "old_text": "get_auth_data_v4(s, route == AwsRoute::QUERY_STRING)",
          "new_text": null,
          "old_line_content": "    return get_auth_data_v4(s, route == AwsRoute::QUERY_STRING);",
          "new_line_content": "  } else {",
          "content_same": false
        },
        {
          "line": 6078,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(s, 0)",
          "new_text": null,
          "old_line_content": "    ldpp_dout(s, 0) << \"Signature verification algorithm AWS v4\"",
          "new_line_content": "                     << \" (AWS4-HMAC-SHA256)\" << dendl;",
          "content_same": false
        },
        {
          "line": 6080,
          "old_api": "get_auth_data_v4",
          "new_api": null,
          "old_text": "get_auth_data_v4(s)",
          "new_text": null,
          "old_line_content": "    return get_auth_data_v4(s);",
          "new_line_content": "  } else {",
          "content_same": false
        },
        {
          "line": 6083,
          "old_api": "get_auth_data_v2",
          "new_api": null,
          "old_text": "get_auth_data_v2(s)",
          "new_text": null,
          "old_line_content": "    return get_auth_data_v2(s);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 5578,
          "old_api": "rgw::auth::s3::get_v4_canonical_headers(info, signedheaders,\n                                                 using_qs, false)",
          "new_api": null,
          "old_text": "rgw::auth::s3::get_v4_canonical_headers(info, signedheaders,\n                                                 using_qs, false)",
          "new_text": null,
          "old_line_content": "  return rgw::auth::s3::get_v4_canonical_headers(info, signedheaders,",
          "new_line_content": "                                                 using_qs, false);",
          "content_same": false
        },
        {
          "line": 6091,
          "old_api": "get_auth_data",
          "new_api": null,
          "old_text": "ver_abstractor.get_auth_data(s)",
          "new_text": null,
          "old_line_content": "  const auto auth_data = ver_abstractor.get_auth_data(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 6094,
          "old_api": "result_t::deny(-EINVAL)",
          "new_api": null,
          "old_text": "result_t::deny(-EINVAL)",
          "new_text": null,
          "old_line_content": "    return result_t::deny(-EINVAL);",
          "new_line_content": "  } else {",
          "content_same": false
        },
        {
          "line": 6096,
          "old_api": "authenticate",
          "new_api": null,
          "old_text": "authenticate(dpp,\n                        auth_data.access_key_id,\n\t\t        auth_data.client_signature,\n\t\t\tauth_data.session_token,\n\t\t\tauth_data.string_to_sign,\n                        auth_data.signature_factory,\n\t\t\tauth_data.completer_factory,\n\t\t\ts, y)",
          "new_text": null,
          "old_line_content": "    return authenticate(dpp,",
          "new_line_content": "                        auth_data.access_key_id,",
          "content_same": false
        },
        {
          "line": 5593,
          "old_api": "ceph::real_clock::now()",
          "new_api": null,
          "old_text": "ceph::real_clock::now()",
          "new_text": null,
          "old_line_content": "  ceph::real_time timestamp = ceph::real_clock::now();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5597,
          "old_api": "ceph::to_iso_8601_no_separators(timestamp, ceph::iso_8601_format::YMDhms)",
          "new_api": null,
          "old_text": "ceph::to_iso_8601_no_separators(timestamp, ceph::iso_8601_format::YMDhms)",
          "new_text": null,
          "old_line_content": "  std::string date = ceph::to_iso_8601_no_separators(timestamp, ceph::iso_8601_format::YMDhms);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5599,
          "old_api": "gen_v4_scope",
          "new_api": null,
          "old_text": "gen_v4_scope(timestamp, region, service)",
          "new_text": null,
          "old_line_content": "  std::string credential_scope = gen_v4_scope(timestamp, region, service);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 6115,
          "old_api": "empty",
          "new_api": null,
          "old_text": "cct->_conf->rgw_ldap_uri.empty()",
          "new_text": null,
          "old_line_content": "      cct->_conf->rgw_ldap_uri.empty()) {",
          "new_line_content": "    return;",
          "content_same": false
        },
        {
          "line": 5606,
          "old_api": "to_str",
          "new_api": null,
          "old_text": "opt_content->to_str()",
          "new_text": null,
          "old_line_content": "    content_hash = rgw::auth::s3::calc_v4_payload_hash(opt_content->to_str());",
          "new_line_content": "    extra_headers[\"x-amz-content-sha256\"] = content_hash;",
          "content_same": false
        },
        {
          "line": 5613,
          "old_api": "gen_v4_canonical_headers",
          "new_api": null,
          "old_text": "gen_v4_canonical_headers(info, extra_headers, &signed_hdrs)",
          "new_text": null,
          "old_line_content": "    gen_v4_canonical_headers(info, extra_headers, &signed_hdrs);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 6127,
          "old_api": "parse_rgw_ldap_bindpw",
          "new_api": null,
          "old_text": "parse_rgw_ldap_bindpw(cct)",
          "new_text": null,
          "old_line_content": "      std::string ldap_bindpw = parse_rgw_ldap_bindpw(cct);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 5616,
          "old_api": "ldpp_dout",
          "new_api": null,
          "old_text": "ldpp_dout(dpp, 10)",
          "new_text": null,
          "old_line_content": "  ldpp_dout(dpp, 10) << \"canonical headers format = \"",
          "new_line_content": "                     << sanitize{canonical_headers} << dendl;",
          "content_same": false
        },
        {
          "line": 6133,
          "old_api": "bind",
          "new_api": null,
          "old_text": "ldh->bind()",
          "new_text": null,
          "old_line_content": "      ldh->bind();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 5626,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "payload_hash.c_str()",
          "new_text": null,
          "old_line_content": "    exp_payload_hash = payload_hash.c_str();",
          "new_line_content": "  } else {",
          "content_same": false
        },
        {
          "line": 5630,
          "old_api": "rgw::auth::s3::get_v4_exp_payload_hash(info)",
          "new_api": null,
          "old_text": "rgw::auth::s3::get_v4_exp_payload_hash(info)",
          "new_text": null,
          "old_line_content": "      exp_payload_hash = rgw::auth::s3::get_v4_exp_payload_hash(info);",
          "new_line_content": "    } else {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 65,
      "total_additions": 180,
      "total_deletions": 181,
      "total_api_changes": 426
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 1,
        "api_related_lines": 426,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 2144,
    "api_calls_after": 2143,
    "diff_info": {
      "added_lines": 0,
      "removed_lines": 1,
      "total_diff_lines": 13
    }
  }
}