{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/bitcoin/modified_file/9c137aaccf8900138f40fc9fecbc00b11828223a",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/bitcoin/modified_file/9c137aaccf8900138f40fc9fecbc00b11828223a/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/bitcoin/modified_file/9c137aaccf8900138f40fc9fecbc00b11828223a/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/bitcoin/modified_file/9c137aaccf8900138f40fc9fecbc00b11828223a/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 80,
          "old_api": "LOCK",
          "new_api": "GetBoolArg",
          "old_text": "LOCK(cs_db)",
          "new_text": "GetBoolArg(\"-privdb\", true)",
          "old_line_content": "        LOCK(cs_db);",
          "new_line_content": "    if (GetBoolArg(\"-privdb\", true))",
          "content_same": false
        },
        {
          "line": 89,
          "old_api": "string",
          "new_api": "GetDataDir",
          "old_text": "pathErrorFile.string().c_str()",
          "new_text": "GetDataDir()",
          "old_line_content": "            printf(\"dbenv.open LogDir=%s ErrorFile=%s\\n\", pathLogDir.string().c_str(), pathErrorFile.string().c_str());",
          "new_line_content": "            filesystem::path pathDataDir = GetDataDir();",
          "content_same": false
        },
        {
          "line": 91,
          "old_api": "GetArg",
          "new_api": "filesystem::create_directory(pathLogDir)",
          "old_text": "GetArg(\"-dbcache\", 25)",
          "new_text": "filesystem::create_directory(pathLogDir)",
          "old_line_content": "            int nDbCache = GetArg(\"-dbcache\", 25);",
          "new_line_content": "            filesystem::create_directory(pathLogDir);",
          "content_same": false
        },
        {
          "line": 93,
          "old_api": "set_cachesize",
          "new_api": "string",
          "old_text": "dbenv.set_cachesize(nDbCache / 1024, (nDbCache % 1024)*1048576, 1)",
          "new_text": "pathErrorFile.string().c_str()",
          "old_line_content": "            dbenv.set_cachesize(nDbCache / 1024, (nDbCache % 1024)*1048576, 1);",
          "new_line_content": "            printf(\"dbenv.open LogDir=%s ErrorFile=%s\\n\", pathLogDir.string().c_str(), pathErrorFile.string().c_str());",
          "content_same": false
        },
        {
          "line": 95,
          "old_api": "set_lg_max",
          "new_api": "GetArg",
          "old_text": "dbenv.set_lg_max(10485760)",
          "new_text": "GetArg(\"-dbcache\", 25)",
          "old_line_content": "            dbenv.set_lg_max(10485760);",
          "new_line_content": "            int nDbCache = GetArg(\"-dbcache\", 25);",
          "content_same": false
        },
        {
          "line": 96,
          "old_api": "set_lk_max_locks",
          "new_api": "string",
          "old_text": "dbenv.set_lk_max_locks(10000)",
          "new_text": "pathLogDir.string().c_str()",
          "old_line_content": "            dbenv.set_lk_max_locks(10000);",
          "new_line_content": "            dbenv.set_lg_dir(pathLogDir.string().c_str());",
          "content_same": false
        },
        {
          "line": 97,
          "old_api": "set_lk_max_objects",
          "new_api": "set_cachesize",
          "old_text": "dbenv.set_lk_max_objects(10000)",
          "new_text": "dbenv.set_cachesize(nDbCache / 1024, (nDbCache % 1024)*1048576, 1)",
          "old_line_content": "            dbenv.set_lk_max_objects(10000);",
          "new_line_content": "            dbenv.set_cachesize(nDbCache / 1024, (nDbCache % 1024)*1048576, 1);",
          "content_same": false
        },
        {
          "line": 98,
          "old_api": "string",
          "new_api": "set_lg_bsize",
          "old_text": "pathErrorFile.string().c_str()",
          "new_text": "dbenv.set_lg_bsize(1048576)",
          "old_line_content": "            dbenv.set_errfile(fopen(pathErrorFile.string().c_str(), \"a\")); /// debug",
          "new_line_content": "            dbenv.set_lg_bsize(1048576);",
          "content_same": false
        },
        {
          "line": 99,
          "old_api": "set_flags",
          "new_api": "set_lg_max",
          "old_text": "dbenv.set_flags(DB_TXN_WRITE_NOSYNC, 1)",
          "new_text": "dbenv.set_lg_max(10485760)",
          "old_line_content": "            dbenv.set_flags(DB_TXN_WRITE_NOSYNC, 1);",
          "new_line_content": "            dbenv.set_lg_max(10485760);",
          "content_same": false
        },
        {
          "line": 100,
          "old_api": "set_flags",
          "new_api": "set_lk_max_locks",
          "old_text": "dbenv.set_flags(DB_AUTO_COMMIT, 1)",
          "new_text": "dbenv.set_lk_max_locks(10000)",
          "old_line_content": "            dbenv.set_flags(DB_AUTO_COMMIT, 1);",
          "new_line_content": "            dbenv.set_lk_max_locks(10000);",
          "content_same": false
        },
        {
          "line": 101,
          "old_api": "log_set_config",
          "new_api": "set_lk_max_objects",
          "old_text": "dbenv.log_set_config(DB_LOG_AUTO_REMOVE, 1)",
          "new_text": "dbenv.set_lk_max_objects(10000)",
          "old_line_content": "            dbenv.log_set_config(DB_LOG_AUTO_REMOVE, 1);",
          "new_line_content": "            dbenv.set_lk_max_objects(10000);",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": "close",
          "new_api": "LOCK",
          "old_text": "pdb->close(0)",
          "new_text": "LOCK(cs_db)",
          "old_line_content": "            pdb->close(0);",
          "new_line_content": "        LOCK(cs_db);",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "txn_checkpoint",
          "new_api": "LOCK",
          "old_text": "dbenv.txn_checkpoint(0, 0, 0)",
          "new_text": "LOCK(cs_db)",
          "old_line_content": "                dbenv.txn_checkpoint(0, 0, 0);",
          "new_line_content": "            LOCK(cs_db);",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": "c_str",
          "new_api": "count",
          "old_text": "strFile.c_str()",
          "new_text": "mapFileUseCount.count(strFile)",
          "old_line_content": "                dbenv.lsn_reset(strFile.c_str(), 0);",
          "new_line_content": "            if (!mapFileUseCount.count(strFile) || mapFileUseCount[strFile] == 0)",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "c_str",
          "new_api": "txn_checkpoint",
          "old_text": "strFile.c_str()",
          "new_text": "dbenv.txn_checkpoint(0, 0, 0)",
          "old_line_content": "                printf(\"Rewriting %s...\\n\", strFile.c_str());",
          "new_line_content": "                dbenv.txn_checkpoint(0, 0, 0);",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": "strlen",
          "new_api": "close",
          "old_text": "strlen(pszSkip)",
          "new_text": "pcursor->close()",
          "old_line_content": "                                strncmp(&ssKey[0], pszSkip, std::min(ssKey.size(), strlen(pszSkip))) == 0)",
          "new_line_content": "                                pcursor->close();",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": "clear",
          "new_api": "strlen",
          "old_text": "ssValue.clear()",
          "new_text": "strlen(pszSkip)",
          "old_line_content": "                                ssValue.clear();",
          "new_line_content": "                                strncmp(&ssKey[0], pszSkip, std::min(ssKey.size(), strlen(pszSkip))) == 0)",
          "content_same": false
        },
        {
          "line": 258,
          "old_api": "put",
          "new_api": "clear",
          "old_text": "pdbCopy->put(NULL, &datKey, &datValue, DB_NOOVERWRITE)",
          "new_text": "ssValue.clear()",
          "old_line_content": "                            int ret2 = pdbCopy->put(NULL, &datKey, &datValue, DB_NOOVERWRITE);",
          "new_line_content": "                                ssValue.clear();",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": "begin",
          "new_api": "printf",
          "old_text": "mapFileUseCount.begin()",
          "new_text": "printf(\"DBFlush(%s)%s\\n\", fShutdown ? \"true\" : \"false\", fDbEnvInit ? \"\" : \" db not started\")",
          "old_line_content": "        map<string, int>::iterator mi = mapFileUseCount.begin();",
          "new_line_content": "    printf(\"DBFlush(%s)%s\\n\", fShutdown ? \"true\" : \"false\", fDbEnvInit ? \"\" : \" db not started\");",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": "c_str",
          "new_api": "begin",
          "old_text": "strFile.c_str()",
          "new_text": "mapFileUseCount.begin()",
          "old_line_content": "            printf(\"%s refcount=%d\\n\", strFile.c_str(), nRefCount);",
          "new_line_content": "        map<string, int>::iterator mi = mapFileUseCount.begin();",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": "c_str",
          "new_api": "CloseDb",
          "old_text": "strFile.c_str()",
          "new_text": "CloseDb(strFile)",
          "old_line_content": "                    dbenv.lsn_reset(strFile.c_str(), 0);",
          "new_line_content": "                CloseDb(strFile);",
          "content_same": false
        },
        {
          "line": 317,
          "old_api": "c_str",
          "new_api": "txn_checkpoint",
          "old_text": "strFile.c_str()",
          "new_text": "dbenv.txn_checkpoint(0, 0, 0)",
          "old_line_content": "                printf(\"%s closed\\n\", strFile.c_str());",
          "new_line_content": "                dbenv.txn_checkpoint(0, 0, 0);",
          "content_same": false
        },
        {
          "line": 323,
          "old_api": "GetTimeMillis",
          "new_api": "erase",
          "old_text": "GetTimeMillis()",
          "new_text": "mapFileUseCount.erase(mi++)",
          "old_line_content": "        printf(\"DBFlush(%s)%s ended %15\"PRI64d\"ms\\n\", fShutdown ? \"true\" : \"false\", fDbEnvInit ? \"\" : \" db not started\", GetTimeMillis() - nStart);",
          "new_line_content": "                mapFileUseCount.erase(mi++);",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": "assert",
          "new_api": "string",
          "old_text": "assert(!fClient)",
          "new_text": "string(\"tx\")",
          "old_line_content": "    assert(!fClient);",
          "new_line_content": "    return Read(make_pair(string(\"tx\"), hash), txindex);",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": "assert",
          "new_api": "string",
          "old_text": "assert(!fClient)",
          "new_text": "string(\"tx\")",
          "old_line_content": "    assert(!fClient);",
          "new_line_content": "    return Write(make_pair(string(\"tx\"), hash), txindex);",
          "content_same": false
        },
        {
          "line": 365,
          "old_api": "string",
          "new_api": "assert",
          "old_text": "string(\"tx\")",
          "new_text": "assert(!fClient)",
          "old_line_content": "    return Write(make_pair(string(\"tx\"), hash), txindex);",
          "new_line_content": "    assert(!fClient);",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": "assert",
          "new_api": "string",
          "old_text": "assert(!fClient)",
          "new_text": "string(\"tx\")",
          "old_line_content": "    assert(!fClient);",
          "new_line_content": "    return Write(make_pair(string(\"tx\"), hash), txindex);",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": "assert",
          "new_api": "string",
          "old_text": "assert(!fClient)",
          "new_text": "string(\"tx\")",
          "old_line_content": "    assert(!fClient);",
          "new_line_content": "    return Erase(make_pair(string(\"tx\"), hash));",
          "content_same": false
        },
        {
          "line": 384,
          "old_api": "assert",
          "new_api": "string",
          "old_text": "assert(!fClient)",
          "new_text": "string(\"tx\")",
          "old_line_content": "    assert(!fClient);",
          "new_line_content": "    return Exists(make_pair(string(\"tx\"), hash));",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": "GetBlockHash",
          "new_api": "ReadDiskTx",
          "old_text": "blockindex.GetBlockHash()",
          "new_text": "ReadDiskTx(outpoint.hash, tx, txindex)",
          "old_line_content": "    return Write(make_pair(string(\"blockindex\"), blockindex.GetBlockHash()), blockindex);",
          "new_line_content": "    return ReadDiskTx(outpoint.hash, tx, txindex);",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": "string",
          "new_api": "GetBlockHash",
          "old_text": "string(\"hashBestChain\")",
          "new_text": "blockindex.GetBlockHash()",
          "old_line_content": "    return Read(string(\"hashBestChain\"), hashBestChain);",
          "new_line_content": "    return Write(make_pair(string(\"blockindex\"), blockindex.GetBlockHash()), blockindex);",
          "content_same": false
        },
        {
          "line": 595,
          "old_api": "ToString",
          "new_api": "count",
          "old_text": "hashBestChain.ToString().substr(0,20).c_str()",
          "new_text": "mapBlockIndex.count(hashBestChain)",
          "old_line_content": "    printf(\"LoadBlockIndex(): hashBestChain=%s  height=%d\\n\", hashBestChain.ToString().substr(0,20).c_str(), nBestHeight);",
          "new_line_content": "    if (!mapBlockIndex.count(hashBestChain))",
          "content_same": false
        },
        {
          "line": 607,
          "old_api": "printf",
          "new_api": "GetArg",
          "old_text": "printf(\"Verifying last %i blocks at level %i\\n\", nCheckDepth, nCheckLevel)",
          "new_text": "GetArg( \"-checkblocks\", 2500)",
          "old_line_content": "    printf(\"Verifying last %i blocks at level %i\\n\", nCheckDepth, nCheckLevel);",
          "new_line_content": "    int nCheckDepth = GetArg( \"-checkblocks\", 2500);",
          "content_same": false
        },
        {
          "line": 620,
          "old_api": "ToString",
          "new_api": "ReadFromDisk",
          "old_text": "pindex->GetBlockHash().ToString().c_str()",
          "new_text": "block.ReadFromDisk(pindex)",
          "old_line_content": "            printf(\"LoadBlockIndex() : *** found bad block at %d, hash=%s\\n\", pindex->nHeight, pindex->GetBlockHash().ToString().c_str());",
          "new_line_content": "        if (!block.ReadFromDisk(pindex))",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": "ToString",
          "new_api": "IsNull",
          "old_text": "hashTx.ToString().c_str()",
          "new_text": "txpos.IsNull()",
          "old_line_content": "                                    printf(\"LoadBlockIndex(): *** found bad spend at %d, hashBlock=%s, hashTx=%s\\n\", pindex->nHeight, pindex->GetBlockHash().ToString().c_str(), hashTx.ToString().c_str());",
          "new_line_content": "                            if (!txpos.IsNull())",
          "content_same": false
        },
        {
          "line": 674,
          "old_api": "CheckTransaction",
          "new_api": "ReadFromDisk",
          "old_text": "txSpend.CheckTransaction()",
          "new_text": "txSpend.ReadFromDisk(txpos)",
          "old_line_content": "                                    else if (!txSpend.CheckTransaction())",
          "new_line_content": "                                    if (!txSpend.ReadFromDisk(txpos))",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": "SetBestChain",
          "new_api": "printf",
          "old_text": "block.SetBestChain(txdb, pindexFork)",
          "new_text": "printf(\"LoadBlockIndex() : *** moving best chain pointer back to block %d\\n\", pindexFork->nHeight)",
          "old_line_content": "        block.SetBestChain(txdb, pindexFork);",
          "new_line_content": "        printf(\"LoadBlockIndex() : *** moving best chain pointer back to block %d\\n\", pindexFork->nHeight);",
          "content_same": false
        },
        {
          "line": 751,
          "old_api": "FLATDATA",
          "new_api": "RAND_bytes",
          "old_text": "FLATDATA(pchMessageStart)",
          "new_text": "RAND_bytes((unsigned char *)&randv, sizeof(randv))",
          "old_line_content": "    ssPeers << FLATDATA(pchMessageStart);",
          "new_line_content": "    RAND_bytes((unsigned char *)&randv, sizeof(randv));",
          "content_same": false
        },
        {
          "line": 758,
          "old_api": "string",
          "new_api": "end",
          "old_text": "pathTmp.string().c_str()",
          "new_text": "ssPeers.end()",
          "old_line_content": "    FILE *file = fopen(pathTmp.string().c_str(), \"wb\");",
          "new_line_content": "    uint256 hash = Hash(ssPeers.begin(), ssPeers.end());",
          "content_same": false
        },
        {
          "line": 775,
          "old_api": "error",
          "new_api": "FileCommit",
          "old_text": "error(\"CAddrman::Write() : Rename-into-place failed\")",
          "new_text": "FileCommit(fileout)",
          "old_line_content": "        return error(\"CAddrman::Write() : Rename-into-place failed\");",
          "new_line_content": "    FileCommit(fileout);",
          "content_same": false
        },
        {
          "line": 789,
          "old_api": "GetFilesize",
          "new_api": "CAutoFile",
          "old_text": "GetFilesize(filein)",
          "new_text": "CAutoFile(file, SER_DISK, CLIENT_VERSION)",
          "old_line_content": "    int fileSize = GetFilesize(filein);",
          "new_line_content": "    CAutoFile filein = CAutoFile(file, SER_DISK, CLIENT_VERSION);",
          "content_same": false
        },
        {
          "line": 797,
          "old_api": "read",
          "new_api": "resize",
          "old_text": "filein.read((char *)&vchData[0], dataSize)",
          "new_text": "vchData.resize(dataSize)",
          "old_line_content": "        filein.read((char *)&vchData[0], dataSize);",
          "new_line_content": "    vchData.resize(dataSize);",
          "content_same": false
        },
        {
          "line": 808,
          "old_api": "end",
          "new_api": "fclose",
          "old_text": "ssPeers.end()",
          "new_text": "filein.fclose()",
          "old_line_content": "    uint256 hashTmp = Hash(ssPeers.begin(), ssPeers.end());",
          "new_line_content": "    filein.fclose();",
          "content_same": false
        },
        {
          "line": 815,
          "old_api": "FLATDATA",
          "new_api": "error",
          "old_text": "FLATDATA(pchMsgTmp)",
          "new_text": "error(\"CAddrman::Read() : checksum mismatch; data corrupted\")",
          "old_line_content": "        ssPeers >> FLATDATA(pchMsgTmp);",
          "new_line_content": "        return error(\"CAddrman::Read() : checksum mismatch; data corrupted\");",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 515,
          "old_api": null,
          "new_api": "GetCursor",
          "old_text": null,
          "new_text": "GetCursor()",
          "old_line_content": "    unsigned int fFlags = DB_SET_RANGE;",
          "new_line_content": "    Dbc* pcursor = GetCursor();",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": null,
          "new_api": "CDataStream ssKey(SER_DISK, CLIENT_VERSION)",
          "old_text": null,
          "new_text": "CDataStream ssKey(SER_DISK, CLIENT_VERSION)",
          "old_line_content": "        fFlags = DB_NEXT;",
          "new_line_content": "        CDataStream ssKey(SER_DISK, CLIENT_VERSION);",
          "content_same": false
        },
        {
          "line": 526,
          "old_api": null,
          "new_api": "uint256",
          "old_text": null,
          "new_text": "uint256(0)",
          "old_line_content": "            break;",
          "new_line_content": "            ssKey << make_pair(string(\"blockindex\"), uint256(0));",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": null,
          "new_api": "ReadAtCursor",
          "old_text": null,
          "new_text": "ReadAtCursor(pcursor, ssKey, ssValue, fFlags)",
          "old_line_content": "            return false;",
          "new_line_content": "        int ret = ReadAtCursor(pcursor, ssKey, ssValue, fFlags);",
          "content_same": false
        },
        {
          "line": 544,
          "old_api": null,
          "new_api": "GetBlockHash",
          "old_text": null,
          "new_text": "diskindex.GetBlockHash()",
          "old_line_content": "            pindexNew->nHeight        = diskindex.nHeight;",
          "new_line_content": "            CBlockIndex* pindexNew = InsertBlockIndex(diskindex.GetBlockHash());",
          "content_same": false
        },
        {
          "line": 545,
          "old_api": null,
          "new_api": "InsertBlockIndex",
          "old_text": null,
          "new_text": "InsertBlockIndex(diskindex.hashPrev)",
          "old_line_content": "            pindexNew->nVersion       = diskindex.nVersion;",
          "new_line_content": "            pindexNew->pprev          = InsertBlockIndex(diskindex.hashPrev);",
          "content_same": false
        },
        {
          "line": 546,
          "old_api": null,
          "new_api": "InsertBlockIndex",
          "old_text": null,
          "new_text": "InsertBlockIndex(diskindex.hashNext)",
          "old_line_content": "            pindexNew->hashMerkleRoot = diskindex.hashMerkleRoot;",
          "new_line_content": "            pindexNew->pnext          = InsertBlockIndex(diskindex.hashNext);",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": null,
          "new_api": "GetBlockHash",
          "old_text": null,
          "new_text": "diskindex.GetBlockHash()",
          "old_line_content": "        }",
          "new_line_content": "            if (pindexGenesisBlock == NULL && diskindex.GetBlockHash() == hashGenesisBlock)",
          "content_same": false
        },
        {
          "line": 560,
          "old_api": null,
          "new_api": "CheckIndex",
          "old_text": null,
          "new_text": "pindexNew->CheckIndex()",
          "old_line_content": "            break; // if shutdown requested or finished loading block index",
          "new_line_content": "            if (!pindexNew->CheckIndex())",
          "content_same": false
        },
        {
          "line": 561,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"LoadBlockIndex() : CheckIndex failed at %d\", pindexNew->nHeight)",
          "old_line_content": "        }",
          "new_line_content": "                return error(\"LoadBlockIndex() : CheckIndex failed at %d\", pindexNew->nHeight);",
          "content_same": false
        },
        {
          "line": 568,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "pcursor->close()",
          "old_line_content": "    // Calculate bnChainWork",
          "new_line_content": "    pcursor->close();",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "mapBlockIndex.size()",
          "old_line_content": "    }",
          "new_line_content": "    vSortedByHeight.reserve(mapBlockIndex.size());",
          "content_same": false
        },
        {
          "line": 579,
          "old_api": null,
          "new_api": "make_pair",
          "old_text": null,
          "new_text": "make_pair(pindex->nHeight, pindex)",
          "old_line_content": "        CBlockIndex* pindex = item.second;",
          "new_line_content": "        vSortedByHeight.push_back(make_pair(pindex->nHeight, pindex));",
          "content_same": false
        },
        {
          "line": 581,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "vSortedByHeight.end()",
          "old_line_content": "    }",
          "new_line_content": "    sort(vSortedByHeight.begin(), vSortedByHeight.end());",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": null,
          "new_api": "GetBlockWork",
          "old_text": null,
          "new_text": "pindex->GetBlockWork()",
          "old_line_content": "    {",
          "new_line_content": "        pindex->bnChainWork = (pindex->pprev ? pindex->pprev->bnChainWork : 0) + pindex->GetBlockWork();",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": null,
          "new_api": "ReadHashBestChain",
          "old_text": null,
          "new_text": "ReadHashBestChain(hashBestChain)",
          "old_line_content": "    }",
          "new_line_content": "    if (!ReadHashBestChain(hashBestChain))",
          "content_same": false
        },
        {
          "line": 593,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"CTxDB::LoadBlockIndex() : hashBestChain not loaded\")",
          "old_line_content": "    nBestHeight = pindexBest->nHeight;",
          "new_line_content": "        return error(\"CTxDB::LoadBlockIndex() : hashBestChain not loaded\");",
          "content_same": false
        },
        {
          "line": 84,
          "old_api": null,
          "new_api": "LOCK",
          "old_text": null,
          "new_text": "LOCK(cs_db)",
          "old_line_content": "                return;",
          "new_line_content": "        LOCK(cs_db);",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"CTxDB::LoadBlockIndex() : hashBestChain not found in the block index\")",
          "old_line_content": "",
          "new_line_content": "        return error(\"CTxDB::LoadBlockIndex() : hashBestChain not found in the block index\");",
          "content_same": false
        },
        {
          "line": 600,
          "old_api": null,
          "new_api": "ToString",
          "old_text": null,
          "new_text": "hashBestChain.ToString().substr(0,20).c_str()",
          "old_line_content": "    // Verify blocks in the best chain",
          "new_line_content": "    printf(\"LoadBlockIndex(): hashBestChain=%s  height=%d\\n\", hashBestChain.ToString().substr(0,20).c_str(), nBestHeight);",
          "content_same": false
        },
        {
          "line": 603,
          "old_api": null,
          "new_api": "ReadBestInvalidWork",
          "old_text": null,
          "new_text": "ReadBestInvalidWork(bnBestInvalidWork)",
          "old_line_content": "    if (nCheckDepth == 0)",
          "new_line_content": "    ReadBestInvalidWork(bnBestInvalidWork);",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": null,
          "new_api": "GetArg",
          "old_text": null,
          "new_text": "GetArg(\"-checklevel\", 1)",
          "old_line_content": "        nCheckDepth = nBestHeight;",
          "new_line_content": "    int nCheckLevel = GetArg(\"-checklevel\", 1);",
          "content_same": false
        },
        {
          "line": 612,
          "old_api": null,
          "new_api": "printf",
          "old_text": null,
          "new_text": "printf(\"Verifying last %i blocks at level %i\\n\", nCheckDepth, nCheckLevel)",
          "old_line_content": "        if (fRequestShutdown || pindex->nHeight < nBestHeight-nCheckDepth)",
          "new_line_content": "    printf(\"Verifying last %i blocks at level %i\\n\", nCheckDepth, nCheckLevel);",
          "content_same": false
        },
        {
          "line": 103,
          "old_api": null,
          "new_api": "set_flags",
          "old_text": null,
          "new_text": "dbenv.set_flags(DB_TXN_WRITE_NOSYNC, 1)",
          "old_line_content": "                             DB_CREATE     |",
          "new_line_content": "            dbenv.set_flags(DB_TXN_WRITE_NOSYNC, 1);",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": null,
          "new_api": "set_flags",
          "old_text": null,
          "new_text": "dbenv.set_flags(DB_AUTO_COMMIT, 1)",
          "old_line_content": "                             DB_INIT_LOCK  |",
          "new_line_content": "            dbenv.set_flags(DB_AUTO_COMMIT, 1);",
          "content_same": false
        },
        {
          "line": 105,
          "old_api": null,
          "new_api": "log_set_config",
          "old_text": null,
          "new_text": "dbenv.log_set_config(DB_LOG_AUTO_REMOVE, 1)",
          "old_line_content": "                             DB_INIT_LOG   |",
          "new_line_content": "            dbenv.log_set_config(DB_LOG_AUTO_REMOVE, 1);",
          "content_same": false
        },
        {
          "line": 106,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "pathDataDir.string().c_str()",
          "old_line_content": "                             DB_INIT_MPOOL |",
          "new_line_content": "            ret = dbenv.open(pathDataDir.string().c_str(),",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"LoadBlockIndex() : block.ReadFromDisk failed\")",
          "old_line_content": "            pindexFork = pindex->pprev;",
          "new_line_content": "            return error(\"LoadBlockIndex() : block.ReadFromDisk failed\");",
          "content_same": false
        },
        {
          "line": 623,
          "old_api": null,
          "new_api": "CheckBlock",
          "old_text": null,
          "new_text": "block.CheckBlock()",
          "old_line_content": "        // check level 2: verify transaction index validity",
          "new_line_content": "        if (nCheckLevel>0 && !block.CheckBlock())",
          "content_same": false
        },
        {
          "line": 625,
          "old_api": null,
          "new_api": "ToString",
          "old_text": null,
          "new_text": "pindex->GetBlockHash().ToString().c_str()",
          "old_line_content": "        {",
          "new_line_content": "            printf(\"LoadBlockIndex() : *** found bad block at %d, hash=%s\\n\", pindex->nHeight, pindex->GetBlockHash().ToString().c_str());",
          "content_same": false
        },
        {
          "line": 117,
          "old_api": null,
          "new_api": "strprintf",
          "old_text": null,
          "new_text": "strprintf(\"CDB() : error %d opening database environment\", ret)",
          "old_line_content": "        ++mapFileUseCount[strFile];",
          "new_line_content": "                throw runtime_error(strprintf(\"CDB() : error %d opening database environment\", ret));",
          "content_same": false
        },
        {
          "line": 631,
          "old_api": null,
          "new_api": "make_pair",
          "old_text": null,
          "new_text": "make_pair(pindex->nFile, pindex->nBlockPos)",
          "old_line_content": "                CTxIndex txindex;",
          "new_line_content": "            pair<unsigned int, unsigned int> pos = make_pair(pindex->nFile, pindex->nBlockPos);",
          "content_same": false
        },
        {
          "line": 635,
          "old_api": null,
          "new_api": "GetHash",
          "old_text": null,
          "new_text": "tx.GetHash()",
          "old_line_content": "                    if (nCheckLevel>2 || pindex->nFile != txindex.pos.nFile || pindex->nBlockPos != txindex.pos.nBlockPos)",
          "new_line_content": "                uint256 hashTx = tx.GetHash();",
          "content_same": false
        },
        {
          "line": 637,
          "old_api": null,
          "new_api": "ReadTxIndex",
          "old_text": null,
          "new_text": "ReadTxIndex(hashTx, txindex)",
          "old_line_content": "                        // either an error or a duplicate transaction",
          "new_line_content": "                if (ReadTxIndex(hashTx, txindex))",
          "content_same": false
        },
        {
          "line": 128,
          "old_api": null,
          "new_api": "open",
          "old_text": null,
          "new_text": "pdb->open(NULL,      // Txn pointer\n                            pszFile,   // Filename\n                            \"main\",    // Logical db name\n                            DB_BTREE,  // Database type\n                            nFlags,    // Flags\n                            0)",
          "old_line_content": "                            0);",
          "new_line_content": "            ret = pdb->open(NULL,      // Txn pointer",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": null,
          "new_api": "ReadFromDisk",
          "old_text": null,
          "new_text": "txFound.ReadFromDisk(txindex.pos)",
          "old_line_content": "                        else",
          "new_line_content": "                        if (!txFound.ReadFromDisk(txindex.pos))",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": null,
          "new_api": "ToString",
          "old_text": null,
          "new_text": "hashTx.ToString().c_str()",
          "old_line_content": "                            {",
          "new_line_content": "                            printf(\"LoadBlockIndex() : *** cannot read mislocated transaction %s\\n\", hashTx.ToString().c_str());",
          "content_same": false
        },
        {
          "line": 650,
          "old_api": null,
          "new_api": "GetHash",
          "old_text": null,
          "new_text": "txFound.GetHash()",
          "old_line_content": "                    }",
          "new_line_content": "                            if (txFound.GetHash() != hashTx) // not a duplicate tx",
          "content_same": false
        },
        {
          "line": 140,
          "old_api": null,
          "new_api": "LOCK",
          "old_text": null,
          "new_text": "LOCK(cs_db)",
          "old_line_content": "            }",
          "new_line_content": "                     LOCK(cs_db);",
          "content_same": false
        },
        {
          "line": 652,
          "old_api": null,
          "new_api": "ToString",
          "old_text": null,
          "new_text": "hashTx.ToString().c_str()",
          "old_line_content": "                    unsigned int nOutput = 0;",
          "new_line_content": "                                printf(\"LoadBlockIndex(): *** invalid tx position for %s\\n\", hashTx.ToString().c_str());",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": null,
          "new_api": "strprintf",
          "old_text": null,
          "new_text": "strprintf(\"CDB() : can't open database file %s, error %d\", pszFile, ret)",
          "old_line_content": "                bool fTmp = fReadOnly;",
          "new_line_content": "                throw runtime_error(strprintf(\"CDB() : can't open database file %s, error %d\", pszFile, ret));",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "string(\"version\")",
          "old_line_content": "                fReadOnly = fTmp;",
          "new_line_content": "            if (fCreate && !Exists(string(\"version\")))",
          "content_same": false
        },
        {
          "line": 151,
          "old_api": null,
          "new_api": "WriteVersion",
          "old_text": null,
          "new_text": "WriteVersion(CLIENT_VERSION)",
          "old_line_content": "        }",
          "new_line_content": "                WriteVersion(CLIENT_VERSION);",
          "content_same": false
        },
        {
          "line": 664,
          "old_api": null,
          "new_api": "make_pair",
          "old_text": null,
          "new_text": "make_pair(txpos.nFile, txpos.nBlockPos)",
          "old_line_content": "                                }",
          "new_line_content": "                                pair<unsigned int, unsigned int> posFind = make_pair(txpos.nFile, txpos.nBlockPos);",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": null,
          "new_api": "count",
          "old_text": null,
          "new_text": "mapBlockPos.count(posFind)",
          "old_line_content": "                                // check level 6: check whether spent txouts were spent by a valid transaction that consume them",
          "new_line_content": "                                if (!mapBlockPos.count(posFind))",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": null,
          "new_api": "ToString",
          "old_text": null,
          "new_text": "hashTx.ToString().c_str()",
          "old_line_content": "                                {",
          "new_line_content": "                                    printf(\"LoadBlockIndex(): *** found bad spend at %d, hashBlock=%s, hashTx=%s\\n\", pindex->nHeight, pindex->GetBlockHash().ToString().c_str(), hashTx.ToString().c_str());",
          "content_same": false
        },
        {
          "line": 164,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "vTxn.empty()",
          "old_line_content": "    // Flush database activity from memory pool to disk log",
          "new_line_content": "    if (!vTxn.empty())",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": null,
          "new_api": "front",
          "old_text": null,
          "new_text": "vTxn.front()->abort()",
          "old_line_content": "    unsigned int nMinutes = 0;",
          "new_line_content": "        vTxn.front()->abort();",
          "content_same": false
        },
        {
          "line": 166,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "vTxn.clear()",
          "old_line_content": "    if (fReadOnly)",
          "new_line_content": "    vTxn.clear();",
          "content_same": false
        },
        {
          "line": 679,
          "old_api": null,
          "new_api": "CheckTransaction",
          "old_text": null,
          "new_text": "txSpend.CheckTransaction()",
          "old_line_content": "                                    else",
          "new_line_content": "                                    else if (!txSpend.CheckTransaction())",
          "content_same": false
        },
        {
          "line": 681,
          "old_api": null,
          "new_api": "ToString",
          "old_text": null,
          "new_text": "hashTx.ToString().c_str()",
          "old_line_content": "                                        bool fFound = false;",
          "new_line_content": "                                        printf(\"LoadBlockIndex(): *** spending transaction of %s:%i is invalid\\n\", hashTx.ToString().c_str(), nOutput);",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": null,
          "new_api": "IsInitialBlockDownload",
          "old_text": null,
          "new_text": "IsInitialBlockDownload()",
          "old_line_content": "    {",
          "new_line_content": "    if (strFile == \"blkindex.dat\" && IsInitialBlockDownload())",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": null,
          "new_api": "GetArg",
          "old_text": null,
          "new_text": "GetArg(\"-dblogsize\", 100)",
          "old_line_content": "    }",
          "new_line_content": "    dbenv.txn_checkpoint(nMinutes ? GetArg(\"-dblogsize\", 100)*1024 : 0, nMinutes, 0);",
          "content_same": false
        },
        {
          "line": 692,
          "old_api": null,
          "new_api": "ToString",
          "old_text": null,
          "new_text": "hashTx.ToString().c_str()",
          "old_line_content": "                            }",
          "new_line_content": "                                            printf(\"LoadBlockIndex(): *** spending transaction of %s:%i does not spend it\\n\", hashTx.ToString().c_str(), nOutput);",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": null,
          "new_api": "LOCK",
          "old_text": null,
          "new_text": "LOCK(cs_db)",
          "old_line_content": "void CloseDb(const string& strFile)",
          "new_line_content": "        LOCK(cs_db);",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "pdb->close(0)",
          "old_line_content": "}",
          "new_line_content": "            pdb->close(0);",
          "content_same": false
        },
        {
          "line": 708,
          "old_api": null,
          "new_api": "ReadTxIndex",
          "old_text": null,
          "new_text": "ReadTxIndex(txin.prevout.hash, txindex)",
          "old_line_content": "                              }",
          "new_line_content": "                          if (ReadTxIndex(txin.prevout.hash, txindex))",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": null,
          "new_api": "IsNull",
          "old_text": null,
          "new_text": "txindex.vSpent[txin.prevout.n].IsNull()",
          "old_line_content": "                     }",
          "new_line_content": "                              if (txindex.vSpent.size()-1 < txin.prevout.n || txindex.vSpent[txin.prevout.n].IsNull())",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": null,
          "new_api": "ToString",
          "old_text": null,
          "new_text": "hashTx.ToString().c_str()",
          "old_line_content": "            }",
          "new_line_content": "                                  printf(\"LoadBlockIndex(): *** found unspent prevout %s:%i in %s\\n\", txin.prevout.hash.ToString().c_str(), txin.prevout.n, hashTx.ToString().c_str());",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": null,
          "new_api": "CloseDb",
          "old_text": null,
          "new_text": "CloseDb(strFile)",
          "old_line_content": "                bool fSuccess = true;",
          "new_line_content": "                CloseDb(strFile);",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "strFile.c_str()",
          "old_line_content": "                string strFileRes = strFile + \".rewrite\";",
          "new_line_content": "                dbenv.lsn_reset(strFile.c_str(), 0);",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": null,
          "new_api": "erase",
          "old_text": null,
          "new_text": "mapFileUseCount.erase(strFile)",
          "old_line_content": "                { // surround usage of db with extra {}",
          "new_line_content": "                mapFileUseCount.erase(strFile);",
          "content_same": false
        },
        {
          "line": 724,
          "old_api": null,
          "new_api": "ReadFromDisk",
          "old_text": null,
          "new_text": "block.ReadFromDisk(pindexFork)",
          "old_line_content": "",
          "new_line_content": "        if (!block.ReadFromDisk(pindexFork))",
          "content_same": false
        },
        {
          "line": 725,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"LoadBlockIndex() : block.ReadFromDisk failed\")",
          "old_line_content": "    return true;",
          "new_line_content": "            return error(\"LoadBlockIndex() : block.ReadFromDisk failed\");",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "strFile.c_str()",
          "old_line_content": "    ",
          "new_line_content": "                printf(\"Rewriting %s...\\n\", strFile.c_str());",
          "content_same": false
        },
        {
          "line": 727,
          "old_api": null,
          "new_api": "SetBestChain",
          "old_text": null,
          "new_text": "block.SetBestChain(txdb, pindexFork)",
          "old_line_content": "",
          "new_line_content": "        block.SetBestChain(txdb, pindexFork);",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "strFile.c_str()",
          "old_line_content": "                                            \"main\",    // Logical db name",
          "new_line_content": "                    CDB db(strFile.c_str(), \"r\");",
          "content_same": false
        },
        {
          "line": 222,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "pdbCopy->open(NULL,                 // Txn pointer\n                                            strFileRes.c_str(),   // Filename\n                                            \"main\",    // Logical db name\n                                            DB_BTREE,  // Database type\n                                            DB_CREATE,    // Flags\n                                            0)",
          "old_line_content": "                                            0);",
          "new_line_content": "                    int ret = pdbCopy->open(NULL,                 // Txn pointer",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "strFileRes.c_str()",
          "old_line_content": "                    if (ret > 0)",
          "new_line_content": "                                            strFileRes.c_str(),   // Filename",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "strFileRes.c_str()",
          "old_line_content": "                    if (pcursor)",
          "new_line_content": "                        printf(\"Cannot create database file %s\\n\", strFileRes.c_str());",
          "content_same": false
        },
        {
          "line": 744,
          "old_api": null,
          "new_api": "GetDataDir",
          "old_text": null,
          "new_text": "GetDataDir()",
          "old_line_content": "    // Generate random temporary filename",
          "new_line_content": "    pathAddr = GetDataDir() / \"peers.dat\";",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": null,
          "new_api": "GetCursor",
          "old_text": null,
          "new_text": "db.GetCursor()",
          "old_line_content": "                            CDataStream ssValue(SER_DISK, CLIENT_VERSION);",
          "new_line_content": "                    Dbc* pcursor = db.GetCursor();",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": null,
          "new_api": "ReadAtCursor",
          "old_text": null,
          "new_text": "db.ReadAtCursor(pcursor, ssKey, ssValue, DB_NEXT)",
          "old_line_content": "                            }",
          "new_line_content": "                            int ret = db.ReadAtCursor(pcursor, ssKey, ssValue, DB_NEXT);",
          "content_same": false
        },
        {
          "line": 752,
          "old_api": null,
          "new_api": "strprintf",
          "old_text": null,
          "new_text": "strprintf(\"peers.dat.%04x\", randv)",
          "old_line_content": "    ssPeers << addr;",
          "new_line_content": "    std::string tmpfn = strprintf(\"peers.dat.%04x\", randv);",
          "content_same": false
        },
        {
          "line": 756,
          "old_api": null,
          "new_api": "FLATDATA",
          "old_text": null,
          "new_text": "FLATDATA(pchMessageStart)",
          "old_line_content": "    // open temp output file, and associate with CAutoFile",
          "new_line_content": "    ssPeers << FLATDATA(pchMessageStart);",
          "content_same": false
        },
        {
          "line": 762,
          "old_api": null,
          "new_api": "GetDataDir",
          "old_text": null,
          "new_text": "GetDataDir()",
          "old_line_content": "",
          "new_line_content": "    boost::filesystem::path pathTmp = GetDataDir() / tmpfn;",
          "content_same": false
        },
        {
          "line": 763,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "pathTmp.string().c_str()",
          "old_line_content": "    // Write and commit header, data",
          "new_line_content": "    FILE *file = fopen(pathTmp.string().c_str(), \"wb\");",
          "content_same": false
        },
        {
          "line": 764,
          "old_api": null,
          "new_api": "CAutoFile",
          "old_text": null,
          "new_text": "CAutoFile(file, SER_DISK, CLIENT_VERSION)",
          "old_line_content": "    try {",
          "new_line_content": "    CAutoFile fileout = CAutoFile(file, SER_DISK, CLIENT_VERSION);",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"CAddrman::Write() : open failed\")",
          "old_line_content": "    }",
          "new_line_content": "        return error(\"CAddrman::Write() : open failed\");",
          "content_same": false
        },
        {
          "line": 255,
          "old_api": null,
          "new_api": "strncmp",
          "old_text": null,
          "new_text": "strncmp(&ssKey[0], \"\\x07version\", 8)",
          "old_line_content": "                            }",
          "new_line_content": "                            if (strncmp(&ssKey[0], \"\\x07version\", 8) == 0)",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "ssKey.size()",
          "old_line_content": "                        }",
          "new_line_content": "                            Dbt datKey(&ssKey[0], ssKey.size());",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "ssValue.size()",
          "old_line_content": "                    if (fSuccess)",
          "new_line_content": "                            Dbt datValue(&ssValue[0], ssValue.size());",
          "content_same": false
        },
        {
          "line": 263,
          "old_api": null,
          "new_api": "put",
          "old_text": null,
          "new_text": "pdbCopy->put(NULL, &datKey, &datValue, DB_NOOVERWRITE)",
          "old_line_content": "                    {",
          "new_line_content": "                            int ret2 = pdbCopy->put(NULL, &datKey, &datValue, DB_NOOVERWRITE);",
          "content_same": false
        },
        {
          "line": 773,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"CAddrman::Write() : I/O error\")",
          "old_line_content": "    // replace existing peers.dat, if any, with new peers.dat.XXXX",
          "new_line_content": "        return error(\"CAddrman::Write() : I/O error\");",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fileout.fclose()",
          "old_line_content": "",
          "new_line_content": "    fileout.fclose();",
          "content_same": false
        },
        {
          "line": 779,
          "old_api": null,
          "new_api": "RenameOver",
          "old_text": null,
          "new_text": "RenameOver(pathTmp, pathAddr)",
          "old_line_content": "",
          "new_line_content": "    if (!RenameOver(pathTmp, pathAddr))",
          "content_same": false
        },
        {
          "line": 780,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"CAddrman::Write() : Rename-into-place failed\")",
          "old_line_content": "bool CAddrDB::Read(CAddrMan& addr)",
          "new_line_content": "        return error(\"CAddrman::Write() : Rename-into-place failed\");",
          "content_same": false
        },
        {
          "line": 269,
          "old_api": null,
          "new_api": "Close",
          "old_text": null,
          "new_text": "db.Close()",
          "old_line_content": "                    }",
          "new_line_content": "                        db.Close();",
          "content_same": false
        },
        {
          "line": 270,
          "old_api": null,
          "new_api": "CloseDb",
          "old_text": null,
          "new_text": "CloseDb(strFile)",
          "old_line_content": "                }",
          "new_line_content": "                        CloseDb(strFile);",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "pdbCopy->close(0)",
          "old_line_content": "                if (fSuccess)",
          "new_line_content": "                        if (pdbCopy->close(0))",
          "content_same": false
        },
        {
          "line": 788,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "pathAddr.string().c_str()",
          "old_line_content": "    // use file size to size memory buffer",
          "new_line_content": "    FILE *file = fopen(pathAddr.string().c_str(), \"rb\");",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "strFile.c_str()",
          "old_line_content": "                }",
          "new_line_content": "                    if (dbA.remove(strFile.c_str(), NULL, 0))",
          "content_same": false
        },
        {
          "line": 791,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"CAddrman::Read() : open failed\")",
          "old_line_content": "    vector<unsigned char> vchData;",
          "new_line_content": "        return error(\"CAddrman::Read() : open failed\");",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "strFile.c_str()",
          "old_line_content": "                return fSuccess;",
          "new_line_content": "                    if (dbB.rename(strFileRes.c_str(), NULL, strFile.c_str(), 0))",
          "content_same": false
        },
        {
          "line": 794,
          "old_api": null,
          "new_api": "GetFilesize",
          "old_text": null,
          "new_text": "GetFilesize(filein)",
          "old_line_content": "",
          "new_line_content": "    int fileSize = GetFilesize(filein);",
          "content_same": false
        },
        {
          "line": 286,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "strFileRes.c_str()",
          "old_line_content": "    }",
          "new_line_content": "                    printf(\"Rewriting of %s FAILED!\\n\", strFileRes.c_str());",
          "content_same": false
        },
        {
          "line": 290,
          "old_api": null,
          "new_api": "Sleep",
          "old_text": null,
          "new_text": "Sleep(100)",
          "old_line_content": "",
          "new_line_content": "        Sleep(100);",
          "content_same": false
        },
        {
          "line": 802,
          "old_api": null,
          "new_api": "read",
          "old_text": null,
          "new_text": "filein.read((char *)&vchData[0], dataSize)",
          "old_line_content": "    }",
          "new_line_content": "        filein.read((char *)&vchData[0], dataSize);",
          "content_same": false
        },
        {
          "line": 806,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"CAddrman::Read() 2 : I/O error or stream data corrupted\")",
          "old_line_content": "",
          "new_line_content": "        return error(\"CAddrman::Read() 2 : I/O error or stream data corrupted\");",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": null,
          "new_api": "GetTimeMillis",
          "old_text": null,
          "new_text": "GetTimeMillis()",
          "old_line_content": "        return;",
          "new_line_content": "    int64 nStart = GetTimeMillis();",
          "content_same": false
        },
        {
          "line": 813,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "ssPeers.end()",
          "old_line_content": "    unsigned char pchMsgTmp[4];",
          "new_line_content": "    uint256 hashTmp = Hash(ssPeers.begin(), ssPeers.end());",
          "content_same": false
        },
        {
          "line": 305,
          "old_api": null,
          "new_api": "LOCK",
          "old_text": null,
          "new_text": "LOCK(cs_db)",
          "old_line_content": "            int nRefCount = (*mi).second;",
          "new_line_content": "        LOCK(cs_db);",
          "content_same": false
        },
        {
          "line": 307,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "mapFileUseCount.end()",
          "old_line_content": "            if (nRefCount == 0)",
          "new_line_content": "        while (mi != mapFileUseCount.end())",
          "content_same": false
        },
        {
          "line": 820,
          "old_api": null,
          "new_api": "FLATDATA",
          "old_text": null,
          "new_text": "FLATDATA(pchMsgTmp)",
          "old_line_content": "    }",
          "new_line_content": "        ssPeers >> FLATDATA(pchMsgTmp);",
          "content_same": false
        },
        {
          "line": 316,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "strFile.c_str()",
          "old_line_content": "                }",
          "new_line_content": "                printf(\"%s checkpoint\\n\", strFile.c_str());",
          "content_same": false
        },
        {
          "line": 828,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(pchMsgTmp, pchMessageStart, sizeof(pchMsgTmp))",
          "old_line_content": "",
          "new_line_content": "    if (memcmp(pchMsgTmp, pchMessageStart, sizeof(pchMsgTmp)))",
          "content_same": false
        },
        {
          "line": 829,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"CAddrman::Read() : invalid network magic number\")",
          "old_line_content": "",
          "new_line_content": "        return error(\"CAddrman::Read() : invalid network magic number\");",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "strFile.c_str()",
          "old_line_content": "            }",
          "new_line_content": "                    printf(\"%s detach\\n\", strFile.c_str());",
          "content_same": false
        },
        {
          "line": 320,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "strFile.c_str()",
          "old_line_content": "            else",
          "new_line_content": "                    dbenv.lsn_reset(strFile.c_str(), 0);",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "strFile.c_str()",
          "old_line_content": "        }",
          "new_line_content": "                printf(\"%s closed\\n\", strFile.c_str());",
          "content_same": false
        },
        {
          "line": 328,
          "old_api": null,
          "new_api": "GetTimeMillis",
          "old_text": null,
          "new_text": "GetTimeMillis()",
          "old_line_content": "            {",
          "new_line_content": "        printf(\"DBFlush(%s)%s ended %15\"PRI64d\"ms\\n\", fShutdown ? \"true\" : \"false\", fDbEnvInit ? \"\" : \" db not started\", GetTimeMillis() - nStart);",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "mapFileUseCount.empty()",
          "old_line_content": "        }",
          "new_line_content": "            if (mapFileUseCount.empty())",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": null,
          "new_api": "log_archive",
          "old_text": null,
          "new_text": "dbenv.log_archive(&listp, DB_ARCH_REMOVE)",
          "old_line_content": "}",
          "new_line_content": "                dbenv.log_archive(&listp, DB_ARCH_REMOVE);",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": null,
          "new_api": "EnvShutdown",
          "old_text": null,
          "new_text": "EnvShutdown()",
          "old_line_content": "",
          "new_line_content": "                EnvShutdown();",
          "content_same": false
        },
        {
          "line": 352,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(!fClient)",
          "old_line_content": "bool CTxDB::UpdateTxIndex(uint256 hash, const CTxIndex& txindex)",
          "new_line_content": "    assert(!fClient);",
          "content_same": false
        },
        {
          "line": 353,
          "old_api": null,
          "new_api": "SetNull",
          "old_text": null,
          "new_text": "txindex.SetNull()",
          "old_line_content": "{",
          "new_line_content": "    txindex.SetNull();",
          "content_same": false
        },
        {
          "line": 359,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(!fClient)",
          "old_line_content": "{",
          "new_line_content": "    assert(!fClient);",
          "content_same": false
        },
        {
          "line": 368,
          "old_api": null,
          "new_api": "GetHash",
          "old_text": null,
          "new_text": "tx.GetHash()",
          "old_line_content": "bool CTxDB::EraseTxIndex(const CTransaction& tx)",
          "new_line_content": "    uint256 hash = tx.GetHash();",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "tx.vout.size()",
          "old_line_content": "{",
          "new_line_content": "    CTxIndex txindex(pos, tx.vout.size());",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(!fClient)",
          "old_line_content": "",
          "new_line_content": "    assert(!fClient);",
          "content_same": false
        },
        {
          "line": 376,
          "old_api": null,
          "new_api": "GetHash",
          "old_text": null,
          "new_text": "tx.GetHash()",
          "old_line_content": "bool CTxDB::ContainsTx(uint256 hash)",
          "new_line_content": "    uint256 hash = tx.GetHash();",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(!fClient)",
          "old_line_content": "{",
          "new_line_content": "    assert(!fClient);",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(!fClient)",
          "old_line_content": "    if (!pcursor)",
          "new_line_content": "    assert(!fClient);",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "vtx.clear()",
          "old_line_content": "        return false;",
          "new_line_content": "    vtx.clear();",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": null,
          "new_api": "GetCursor",
          "old_text": null,
          "new_text": "GetCursor()",
          "old_line_content": "    loop",
          "new_line_content": "    Dbc* pcursor = GetCursor();",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": null,
          "new_api": "CDataStream ssKey(SER_DISK, CLIENT_VERSION)",
          "old_text": null,
          "new_text": "CDataStream ssKey(SER_DISK, CLIENT_VERSION)",
          "old_line_content": "        fFlags = DB_NEXT;",
          "new_line_content": "        CDataStream ssKey(SER_DISK, CLIENT_VERSION);",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": null,
          "new_api": "CDiskTxPos",
          "old_text": null,
          "new_text": "CDiskTxPos(0, 0, 0)",
          "old_line_content": "            break;",
          "new_line_content": "            ssKey << string(\"owner\") << hash160 << CDiskTxPos(0, 0, 0);",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": null,
          "new_api": "ReadAtCursor",
          "old_text": null,
          "new_text": "ReadAtCursor(pcursor, ssKey, ssValue, fFlags)",
          "old_line_content": "        {",
          "new_line_content": "        int ret = ReadAtCursor(pcursor, ssKey, ssValue, fFlags);",
          "content_same": false
        },
        {
          "line": 411,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "pcursor->close()",
          "old_line_content": "        string strType;",
          "new_line_content": "            pcursor->close();",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "vtx.size()",
          "old_line_content": "            }",
          "new_line_content": "            vtx.resize(vtx.size()+1);",
          "content_same": false
        },
        {
          "line": 429,
          "old_api": null,
          "new_api": "back",
          "old_text": null,
          "new_text": "vtx.back().ReadFromDisk(pos)",
          "old_line_content": "        }",
          "new_line_content": "            if (!vtx.back().ReadFromDisk(pos))",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "pcursor->close()",
          "old_line_content": "",
          "new_line_content": "                pcursor->close();",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "pcursor->close()",
          "old_line_content": "{",
          "new_line_content": "    pcursor->close();",
          "content_same": false
        },
        {
          "line": 443,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(!fClient)",
          "old_line_content": "}",
          "new_line_content": "    assert(!fClient);",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": null,
          "new_api": "SetNull",
          "old_text": null,
          "new_text": "tx.SetNull()",
          "old_line_content": "",
          "new_line_content": "    tx.SetNull();",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": null,
          "new_api": "ReadTxIndex",
          "old_text": null,
          "new_text": "ReadTxIndex(hash, txindex)",
          "old_line_content": "bool CTxDB::ReadDiskTx(uint256 hash, CTransaction& tx)",
          "new_line_content": "    if (!ReadTxIndex(hash, txindex))",
          "content_same": false
        },
        {
          "line": 447,
          "old_api": null,
          "new_api": "ReadFromDisk",
          "old_text": null,
          "new_text": "tx.ReadFromDisk(txindex.pos)",
          "old_line_content": "    CTxIndex txindex;",
          "new_line_content": "    return (tx.ReadFromDisk(txindex.pos));",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": null,
          "new_api": "ReadDiskTx",
          "old_text": null,
          "new_text": "ReadDiskTx(outpoint.hash, tx, txindex)",
          "old_line_content": "    CTxIndex txindex;",
          "new_line_content": "    return ReadDiskTx(outpoint.hash, tx, txindex);",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "string(\"bnBestInvalidWork\")",
          "old_line_content": "    if (hash == 0)",
          "new_line_content": "    return Write(string(\"bnBestInvalidWork\"), bnBestInvalidWork);",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": null,
          "new_api": "find",
          "old_text": null,
          "new_text": "mapBlockIndex.find(hash)",
          "old_line_content": "    CBlockIndex* pindexNew = new CBlockIndex();",
          "new_line_content": "    map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);",
          "content_same": false
        },
        {
          "line": 499,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "mapBlockIndex.end()",
          "old_line_content": "    if (!pindexNew)",
          "new_line_content": "    if (mi != mapBlockIndex.end())",
          "content_same": false
        },
        {
          "line": 505,
          "old_api": null,
          "new_api": "runtime_error",
          "old_text": null,
          "new_text": "runtime_error(\"LoadBlockIndex() : new CBlockIndex failed\")",
          "old_line_content": "}",
          "new_line_content": "        throw runtime_error(\"LoadBlockIndex() : new CBlockIndex failed\");",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": null,
          "new_api": "make_pair",
          "old_text": null,
          "new_text": "make_pair(hash, pindexNew)",
          "old_line_content": "",
          "new_line_content": "    mi = mapBlockIndex.insert(make_pair(hash, pindexNew)).first;",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 519,
          "old_api": "CDataStream ssKey(SER_DISK, CLIENT_VERSION)",
          "new_api": null,
          "old_text": "CDataStream ssKey(SER_DISK, CLIENT_VERSION)",
          "new_text": null,
          "old_line_content": "        CDataStream ssKey(SER_DISK, CLIENT_VERSION);",
          "new_line_content": "    // Load mapBlockIndex",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": "uint256",
          "new_api": null,
          "old_text": "uint256(0)",
          "new_text": null,
          "old_line_content": "            ssKey << make_pair(string(\"blockindex\"), uint256(0));",
          "new_line_content": "    loop",
          "content_same": false
        },
        {
          "line": 523,
          "old_api": "ReadAtCursor",
          "new_api": null,
          "old_text": "ReadAtCursor(pcursor, ssKey, ssValue, fFlags)",
          "new_text": null,
          "old_line_content": "        int ret = ReadAtCursor(pcursor, ssKey, ssValue, fFlags);",
          "new_line_content": "        // Read next record",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": "GetBlockHash",
          "new_api": null,
          "old_text": "diskindex.GetBlockHash()",
          "new_text": null,
          "old_line_content": "            CBlockIndex* pindexNew = InsertBlockIndex(diskindex.GetBlockHash());",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": "InsertBlockIndex",
          "new_api": null,
          "old_text": "InsertBlockIndex(diskindex.hashPrev)",
          "new_text": null,
          "old_line_content": "            pindexNew->pprev          = InsertBlockIndex(diskindex.hashPrev);",
          "new_line_content": "            CDiskBlockIndex diskindex;",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": "InsertBlockIndex",
          "new_api": null,
          "old_text": "InsertBlockIndex(diskindex.hashNext)",
          "new_text": null,
          "old_line_content": "            pindexNew->pnext          = InsertBlockIndex(diskindex.hashNext);",
          "new_line_content": "            ssValue >> diskindex;",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": "GetBlockHash",
          "new_api": null,
          "old_text": "diskindex.GetBlockHash()",
          "new_text": null,
          "old_line_content": "            if (pindexGenesisBlock == NULL && diskindex.GetBlockHash() == hashGenesisBlock)",
          "new_line_content": "            pindexNew->nTime          = diskindex.nTime;",
          "content_same": false
        },
        {
          "line": 555,
          "old_api": "CheckIndex",
          "new_api": null,
          "old_text": "pindexNew->CheckIndex()",
          "new_text": null,
          "old_line_content": "            if (!pindexNew->CheckIndex())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 556,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"LoadBlockIndex() : CheckIndex failed at %d\", pindexNew->nHeight)",
          "new_text": null,
          "old_line_content": "                return error(\"LoadBlockIndex() : CheckIndex failed at %d\", pindexNew->nHeight);",
          "new_line_content": "            // Watch for genesis block",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": "close",
          "new_api": null,
          "old_text": "pcursor->close()",
          "new_text": null,
          "old_line_content": "    pcursor->close();",
          "new_line_content": "        else",
          "content_same": false
        },
        {
          "line": 570,
          "old_api": "size",
          "new_api": null,
          "old_text": "mapBlockIndex.size()",
          "new_text": null,
          "old_line_content": "    vSortedByHeight.reserve(mapBlockIndex.size());",
          "new_line_content": "    if (fRequestShutdown)",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": "make_pair",
          "new_api": null,
          "old_text": "make_pair(pindex->nHeight, pindex)",
          "new_text": null,
          "old_line_content": "        vSortedByHeight.push_back(make_pair(pindex->nHeight, pindex));",
          "new_line_content": "    vector<pair<int, CBlockIndex*> > vSortedByHeight;",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": "end",
          "new_api": null,
          "old_text": "vSortedByHeight.end()",
          "new_text": null,
          "old_line_content": "    sort(vSortedByHeight.begin(), vSortedByHeight.end());",
          "new_line_content": "    BOOST_FOREACH(const PAIRTYPE(uint256, CBlockIndex*)& item, mapBlockIndex)",
          "content_same": false
        },
        {
          "line": 580,
          "old_api": "GetBlockWork",
          "new_api": null,
          "old_text": "pindex->GetBlockWork()",
          "new_text": null,
          "old_line_content": "        pindex->bnChainWork = (pindex->pprev ? pindex->pprev->bnChainWork : 0) + pindex->GetBlockWork();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": "ReadHashBestChain",
          "new_api": null,
          "old_text": "ReadHashBestChain(hashBestChain)",
          "new_text": null,
          "old_line_content": "    if (!ReadHashBestChain(hashBestChain))",
          "new_line_content": "        CBlockIndex* pindex = item.second;",
          "content_same": false
        },
        {
          "line": 588,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"CTxDB::LoadBlockIndex() : hashBestChain not loaded\")",
          "new_text": null,
          "old_line_content": "        return error(\"CTxDB::LoadBlockIndex() : hashBestChain not loaded\");",
          "new_line_content": "    // Load hashBestChain pointer to end of best chain",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": "count",
          "new_api": null,
          "old_text": "mapBlockIndex.count(hashBestChain)",
          "new_text": null,
          "old_line_content": "    if (!mapBlockIndex.count(hashBestChain))",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 591,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"CTxDB::LoadBlockIndex() : hashBestChain not found in the block index\")",
          "new_text": null,
          "old_line_content": "        return error(\"CTxDB::LoadBlockIndex() : hashBestChain not found in the block index\");",
          "new_line_content": "        if (pindexGenesisBlock == NULL)",
          "content_same": false
        },
        {
          "line": 85,
          "old_api": "GetDataDir",
          "new_api": null,
          "old_text": "GetDataDir()",
          "new_text": null,
          "old_line_content": "            filesystem::path pathDataDir = GetDataDir();",
          "new_line_content": "        if (!fDbEnvInit)",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": "ReadBestInvalidWork",
          "new_api": null,
          "old_text": "ReadBestInvalidWork(bnBestInvalidWork)",
          "new_text": null,
          "old_line_content": "    ReadBestInvalidWork(bnBestInvalidWork);",
          "new_line_content": "    nBestHeight = pindexBest->nHeight;",
          "content_same": false
        },
        {
          "line": 87,
          "old_api": "filesystem::create_directory(pathLogDir)",
          "new_api": null,
          "old_text": "filesystem::create_directory(pathLogDir)",
          "new_text": null,
          "old_line_content": "            filesystem::create_directory(pathLogDir);",
          "new_line_content": "            if (fShutdown)",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": "GetArg",
          "new_api": null,
          "old_text": "GetArg(\"-checklevel\", 1)",
          "new_text": null,
          "old_line_content": "    int nCheckLevel = GetArg(\"-checklevel\", 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 602,
          "old_api": "GetArg",
          "new_api": null,
          "old_text": "GetArg( \"-checkblocks\", 2500)",
          "new_text": null,
          "old_line_content": "    int nCheckDepth = GetArg( \"-checkblocks\", 2500);",
          "new_line_content": "    // Load bnBestInvalidWork, OK if it doesn't exist",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": "string",
          "new_api": null,
          "old_text": "pathLogDir.string().c_str()",
          "new_text": null,
          "old_line_content": "            dbenv.set_lg_dir(pathLogDir.string().c_str());",
          "new_line_content": "            filesystem::path pathErrorFile = pathDataDir / \"db.log\";",
          "content_same": false
        },
        {
          "line": 94,
          "old_api": "set_lg_bsize",
          "new_api": null,
          "old_text": "dbenv.set_lg_bsize(1048576)",
          "new_text": null,
          "old_line_content": "            dbenv.set_lg_bsize(1048576);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 615,
          "old_api": "ReadFromDisk",
          "new_api": null,
          "old_text": "block.ReadFromDisk(pindex)",
          "new_text": null,
          "old_line_content": "        if (!block.ReadFromDisk(pindex))",
          "new_line_content": "    for (CBlockIndex* pindex = pindexBest; pindex && pindex->pprev; pindex = pindex->pprev)",
          "content_same": false
        },
        {
          "line": 616,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"LoadBlockIndex() : block.ReadFromDisk failed\")",
          "new_text": null,
          "old_line_content": "            return error(\"LoadBlockIndex() : block.ReadFromDisk failed\");",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": "CheckBlock",
          "new_api": null,
          "old_text": "block.CheckBlock()",
          "new_text": null,
          "old_line_content": "        if (nCheckLevel>0 && !block.CheckBlock())",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": "strprintf",
          "new_api": null,
          "old_text": "strprintf(\"CDB() : error %d opening database environment\", ret)",
          "new_text": null,
          "old_line_content": "                throw runtime_error(strprintf(\"CDB() : error %d opening database environment\", ret));",
          "new_line_content": "                             DB_THREAD     |",
          "content_same": false
        },
        {
          "line": 626,
          "old_api": "make_pair",
          "new_api": null,
          "old_text": "make_pair(pindex->nFile, pindex->nBlockPos)",
          "new_text": null,
          "old_line_content": "            pair<unsigned int, unsigned int> pos = make_pair(pindex->nFile, pindex->nBlockPos);",
          "new_line_content": "            pindexFork = pindex->pprev;",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": "GetHash",
          "new_api": null,
          "old_text": "tx.GetHash()",
          "new_text": null,
          "old_line_content": "                uint256 hashTx = tx.GetHash();",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 632,
          "old_api": "ReadTxIndex",
          "new_api": null,
          "old_text": "ReadTxIndex(hashTx, txindex)",
          "new_text": null,
          "old_line_content": "                if (ReadTxIndex(hashTx, txindex))",
          "new_line_content": "            mapBlockPos[pos] = pindex;",
          "content_same": false
        },
        {
          "line": 123,
          "old_api": "open",
          "new_api": null,
          "old_text": "pdb->open(NULL,      // Txn pointer\n                            pszFile,   // Filename\n                            \"main\",    // Logical db name\n                            DB_BTREE,  // Database type\n                            nFlags,    // Flags\n                            0)",
          "new_text": null,
          "old_line_content": "            ret = pdb->open(NULL,      // Txn pointer",
          "new_line_content": "        pdb = mapDb[strFile];",
          "content_same": false
        },
        {
          "line": 639,
          "old_api": "ReadFromDisk",
          "new_api": null,
          "old_text": "txFound.ReadFromDisk(txindex.pos)",
          "new_text": null,
          "old_line_content": "                        if (!txFound.ReadFromDisk(txindex.pos))",
          "new_line_content": "                    // check level 3: checker transaction hashes",
          "content_same": false
        },
        {
          "line": 641,
          "old_api": "ToString",
          "new_api": null,
          "old_text": "hashTx.ToString().c_str()",
          "new_text": null,
          "old_line_content": "                            printf(\"LoadBlockIndex() : *** cannot read mislocated transaction %s\\n\", hashTx.ToString().c_str());",
          "new_line_content": "                    {",
          "content_same": false
        },
        {
          "line": 645,
          "old_api": "GetHash",
          "new_api": null,
          "old_text": "txFound.GetHash()",
          "new_text": null,
          "old_line_content": "                            if (txFound.GetHash() != hashTx) // not a duplicate tx",
          "new_line_content": "                        {",
          "content_same": false
        },
        {
          "line": 135,
          "old_api": "LOCK",
          "new_api": null,
          "old_text": "LOCK(cs_db)",
          "new_text": null,
          "old_line_content": "                     LOCK(cs_db);",
          "new_line_content": "            if (ret > 0)",
          "content_same": false
        },
        {
          "line": 647,
          "old_api": "ToString",
          "new_api": null,
          "old_text": "hashTx.ToString().c_str()",
          "new_text": null,
          "old_line_content": "                                printf(\"LoadBlockIndex(): *** invalid tx position for %s\\n\", hashTx.ToString().c_str());",
          "new_line_content": "                            pindexFork = pindex->pprev;",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": "strprintf",
          "new_api": null,
          "old_text": "strprintf(\"CDB() : can't open database file %s, error %d\", pszFile, ret)",
          "new_text": null,
          "old_line_content": "                throw runtime_error(strprintf(\"CDB() : can't open database file %s, error %d\", pszFile, ret));",
          "new_line_content": "                {",
          "content_same": false
        },
        {
          "line": 142,
          "old_api": "string",
          "new_api": null,
          "old_text": "string(\"version\")",
          "new_text": null,
          "old_line_content": "            if (fCreate && !Exists(string(\"version\")))",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 657,
          "old_api": "IsNull",
          "new_api": null,
          "old_text": "txpos.IsNull()",
          "new_text": null,
          "old_line_content": "                            if (!txpos.IsNull())",
          "new_line_content": "                    unsigned int nOutput = 0;",
          "content_same": false
        },
        {
          "line": 146,
          "old_api": "WriteVersion",
          "new_api": null,
          "old_text": "WriteVersion(CLIENT_VERSION)",
          "new_text": null,
          "old_line_content": "                WriteVersion(CLIENT_VERSION);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 659,
          "old_api": "make_pair",
          "new_api": null,
          "old_text": "make_pair(txpos.nFile, txpos.nBlockPos)",
          "new_text": null,
          "old_line_content": "                                pair<unsigned int, unsigned int> posFind = make_pair(txpos.nFile, txpos.nBlockPos);",
          "new_line_content": "                    {",
          "content_same": false
        },
        {
          "line": 660,
          "old_api": "count",
          "new_api": null,
          "old_text": "mapBlockPos.count(posFind)",
          "new_text": null,
          "old_line_content": "                                if (!mapBlockPos.count(posFind))",
          "new_line_content": "                        BOOST_FOREACH(const CDiskTxPos &txpos, txindex.vSpent)",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": "ReadFromDisk",
          "new_api": null,
          "old_text": "txSpend.ReadFromDisk(txpos)",
          "new_text": null,
          "old_line_content": "                                    if (!txSpend.ReadFromDisk(txpos))",
          "new_line_content": "                                }",
          "content_same": false
        },
        {
          "line": 159,
          "old_api": "empty",
          "new_api": null,
          "old_text": "vTxn.empty()",
          "new_text": null,
          "old_line_content": "    if (!vTxn.empty())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 160,
          "old_api": "front",
          "new_api": null,
          "old_text": "vTxn.front()->abort()",
          "new_text": null,
          "old_line_content": "        vTxn.front()->abort();",
          "new_line_content": "void CDB::Close()",
          "content_same": false
        },
        {
          "line": 161,
          "old_api": "clear",
          "new_api": null,
          "old_text": "vTxn.clear()",
          "new_text": null,
          "old_line_content": "    vTxn.clear();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": "ToString",
          "new_api": null,
          "old_text": "hashTx.ToString().c_str()",
          "new_text": null,
          "old_line_content": "                                        printf(\"LoadBlockIndex(): *** cannot read spending transaction of %s:%i from disk\\n\", hashTx.ToString().c_str(), nOutput);",
          "new_line_content": "                                if (nCheckLevel>5)",
          "content_same": false
        },
        {
          "line": 170,
          "old_api": "IsInitialBlockDownload",
          "new_api": null,
          "old_text": "IsInitialBlockDownload()",
          "new_text": null,
          "old_line_content": "    if (strFile == \"blkindex.dat\" && IsInitialBlockDownload())",
          "new_line_content": "    unsigned int nMinutes = 0;",
          "content_same": false
        },
        {
          "line": 173,
          "old_api": "GetArg",
          "new_api": null,
          "old_text": "GetArg(\"-dblogsize\", 100)",
          "new_text": null,
          "old_line_content": "    dbenv.txn_checkpoint(nMinutes ? GetArg(\"-dblogsize\", 100)*1024 : 0, nMinutes, 0);",
          "new_line_content": "    if (strFile == \"blkindex.dat\")",
          "content_same": false
        },
        {
          "line": 687,
          "old_api": "ToString",
          "new_api": null,
          "old_text": "hashTx.ToString().c_str()",
          "new_text": null,
          "old_line_content": "                                            printf(\"LoadBlockIndex(): *** spending transaction of %s:%i does not spend it\\n\", hashTx.ToString().c_str(), nOutput);",
          "new_line_content": "                                        BOOST_FOREACH(const CTxIn &txin, txSpend.vin)",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": "LOCK",
          "new_api": null,
          "old_text": "LOCK(cs_db)",
          "new_text": null,
          "old_line_content": "        LOCK(cs_db);",
          "new_line_content": "        nMinutes = 5;",
          "content_same": false
        },
        {
          "line": 184,
          "old_api": "LOCK",
          "new_api": null,
          "old_text": "LOCK(cs_db)",
          "new_text": null,
          "old_line_content": "        LOCK(cs_db);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 703,
          "old_api": "ReadTxIndex",
          "new_api": null,
          "old_text": "ReadTxIndex(txin.prevout.hash, txindex)",
          "new_text": null,
          "old_line_content": "                          if (ReadTxIndex(txin.prevout.hash, txindex))",
          "new_line_content": "                if (nCheckLevel>4)",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": "IsNull",
          "new_api": null,
          "old_text": "txindex.vSpent[txin.prevout.n].IsNull()",
          "new_text": null,
          "old_line_content": "                              if (txindex.vSpent.size()-1 < txin.prevout.n || txindex.vSpent[txin.prevout.n].IsNull())",
          "new_line_content": "                {",
          "content_same": false
        },
        {
          "line": 706,
          "old_api": "ToString",
          "new_api": null,
          "old_text": "hashTx.ToString().c_str()",
          "new_text": null,
          "old_line_content": "                                  printf(\"LoadBlockIndex(): *** found unspent prevout %s:%i in %s\\n\", txin.prevout.hash.ToString().c_str(), txin.prevout.n, hashTx.ToString().c_str());",
          "new_line_content": "                     {",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "LOCK",
          "new_api": null,
          "old_text": "LOCK(cs_db)",
          "new_text": null,
          "old_line_content": "            LOCK(cs_db);",
          "new_line_content": "bool CDB::Rewrite(const string& strFile, const char* pszSkip)",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": "count",
          "new_api": null,
          "old_text": "mapFileUseCount.count(strFile)",
          "new_text": null,
          "old_line_content": "            if (!mapFileUseCount.count(strFile) || mapFileUseCount[strFile] == 0)",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "CloseDb",
          "new_api": null,
          "old_text": "CloseDb(strFile)",
          "new_text": null,
          "old_line_content": "                CloseDb(strFile);",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 717,
          "old_api": "printf",
          "new_api": null,
          "old_text": "printf(\"LoadBlockIndex() : *** moving best chain pointer back to block %d\\n\", pindexFork->nHeight)",
          "new_text": null,
          "old_line_content": "        printf(\"LoadBlockIndex() : *** moving best chain pointer back to block %d\\n\", pindexFork->nHeight);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 719,
          "old_api": "ReadFromDisk",
          "new_api": null,
          "old_text": "block.ReadFromDisk(pindexFork)",
          "new_text": null,
          "old_line_content": "        if (!block.ReadFromDisk(pindexFork))",
          "new_line_content": "    if (pindexFork && !fRequestShutdown)",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": "erase",
          "new_api": null,
          "old_text": "mapFileUseCount.erase(strFile)",
          "new_text": null,
          "old_line_content": "                mapFileUseCount.erase(strFile);",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 720,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"LoadBlockIndex() : block.ReadFromDisk failed\")",
          "new_text": null,
          "old_line_content": "            return error(\"LoadBlockIndex() : block.ReadFromDisk failed\");",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "strFile.c_str()",
          "new_text": null,
          "old_line_content": "                    CDB db(strFile.c_str(), \"r\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "pdbCopy->open(NULL,                 // Txn pointer\n                                            strFileRes.c_str(),   // Filename\n                                            \"main\",    // Logical db name\n                                            DB_BTREE,  // Database type\n                                            DB_CREATE,    // Flags\n                                            0)",
          "new_text": null,
          "old_line_content": "                    int ret = pdbCopy->open(NULL,                 // Txn pointer",
          "new_line_content": "                string strFileRes = strFile + \".rewrite\";",
          "content_same": false
        },
        {
          "line": 218,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "strFileRes.c_str()",
          "new_text": null,
          "old_line_content": "                                            strFileRes.c_str(),   // Filename",
          "new_line_content": "                { // surround usage of db with extra {}",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "strFileRes.c_str()",
          "new_text": null,
          "old_line_content": "                        printf(\"Cannot create database file %s\\n\", strFileRes.c_str());",
          "new_line_content": "                                            DB_BTREE,  // Database type",
          "content_same": false
        },
        {
          "line": 739,
          "old_api": "GetDataDir",
          "new_api": null,
          "old_text": "GetDataDir()",
          "new_text": null,
          "old_line_content": "    pathAddr = GetDataDir() / \"peers.dat\";",
          "new_line_content": "//",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": "GetCursor",
          "new_api": null,
          "old_text": "db.GetCursor()",
          "new_text": null,
          "old_line_content": "                    Dbc* pcursor = db.GetCursor();",
          "new_line_content": "                    {",
          "content_same": false
        },
        {
          "line": 746,
          "old_api": "RAND_bytes",
          "new_api": null,
          "old_text": "RAND_bytes((unsigned char *)&randv, sizeof(randv))",
          "new_text": null,
          "old_line_content": "    RAND_bytes((unsigned char *)&randv, sizeof(randv));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": "ReadAtCursor",
          "new_api": null,
          "old_text": "db.ReadAtCursor(pcursor, ssKey, ssValue, DB_NEXT)",
          "new_text": null,
          "old_line_content": "                            int ret = db.ReadAtCursor(pcursor, ssKey, ssValue, DB_NEXT);",
          "new_line_content": "                    if (pcursor)",
          "content_same": false
        },
        {
          "line": 747,
          "old_api": "strprintf",
          "new_api": null,
          "old_text": "strprintf(\"peers.dat.%04x\", randv)",
          "new_text": null,
          "old_line_content": "    std::string tmpfn = strprintf(\"peers.dat.%04x\", randv);",
          "new_line_content": "bool CAddrDB::Write(const CAddrMan& addr)",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": "close",
          "new_api": null,
          "old_text": "pcursor->close()",
          "new_text": null,
          "old_line_content": "                                pcursor->close();",
          "new_line_content": "                            CDataStream ssKey(SER_DISK, CLIENT_VERSION);",
          "content_same": false
        },
        {
          "line": 753,
          "old_api": "end",
          "new_api": null,
          "old_text": "ssPeers.end()",
          "new_text": null,
          "old_line_content": "    uint256 hash = Hash(ssPeers.begin(), ssPeers.end());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 757,
          "old_api": "GetDataDir",
          "new_api": null,
          "old_text": "GetDataDir()",
          "new_text": null,
          "old_line_content": "    boost::filesystem::path pathTmp = GetDataDir() / tmpfn;",
          "new_line_content": "    ssPeers << addr;",
          "content_same": false
        },
        {
          "line": 759,
          "old_api": "CAutoFile",
          "new_api": null,
          "old_text": "CAutoFile(file, SER_DISK, CLIENT_VERSION)",
          "new_text": null,
          "old_line_content": "    CAutoFile fileout = CAutoFile(file, SER_DISK, CLIENT_VERSION);",
          "new_line_content": "    ssPeers << hash;",
          "content_same": false
        },
        {
          "line": 761,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"CAddrman::Write() : open failed\")",
          "new_text": null,
          "old_line_content": "        return error(\"CAddrman::Write() : open failed\");",
          "new_line_content": "    // open temp output file, and associate with CAutoFile",
          "content_same": false
        },
        {
          "line": 250,
          "old_api": "strncmp",
          "new_api": null,
          "old_text": "strncmp(&ssKey[0], \"\\x07version\", 8)",
          "new_text": null,
          "old_line_content": "                            if (strncmp(&ssKey[0], \"\\x07version\", 8) == 0)",
          "new_line_content": "                                break;",
          "content_same": false
        },
        {
          "line": 256,
          "old_api": "size",
          "new_api": null,
          "old_text": "ssKey.size()",
          "new_text": null,
          "old_line_content": "                            Dbt datKey(&ssKey[0], ssKey.size());",
          "new_line_content": "                            {",
          "content_same": false
        },
        {
          "line": 257,
          "old_api": "size",
          "new_api": null,
          "old_text": "ssValue.size()",
          "new_text": null,
          "old_line_content": "                            Dbt datValue(&ssValue[0], ssValue.size());",
          "new_line_content": "                                // Update version:",
          "content_same": false
        },
        {
          "line": 768,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"CAddrman::Write() : I/O error\")",
          "new_text": null,
          "old_line_content": "        return error(\"CAddrman::Write() : I/O error\");",
          "new_line_content": "    // Write and commit header, data",
          "content_same": false
        },
        {
          "line": 770,
          "old_api": "FileCommit",
          "new_api": null,
          "old_text": "FileCommit(fileout)",
          "new_text": null,
          "old_line_content": "    FileCommit(fileout);",
          "new_line_content": "        fileout << ssPeers;",
          "content_same": false
        },
        {
          "line": 771,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fileout.fclose()",
          "new_text": null,
          "old_line_content": "    fileout.fclose();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 774,
          "old_api": "RenameOver",
          "new_api": null,
          "old_text": "RenameOver(pathTmp, pathAddr)",
          "new_text": null,
          "old_line_content": "    if (!RenameOver(pathTmp, pathAddr))",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": "Close",
          "new_api": null,
          "old_text": "db.Close()",
          "new_text": null,
          "old_line_content": "                        db.Close();",
          "new_line_content": "                            if (ret2 > 0)",
          "content_same": false
        },
        {
          "line": 265,
          "old_api": "CloseDb",
          "new_api": null,
          "old_text": "CloseDb(strFile)",
          "new_text": null,
          "old_line_content": "                        CloseDb(strFile);",
          "new_line_content": "                                fSuccess = false;",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": "close",
          "new_api": null,
          "old_text": "pdbCopy->close(0)",
          "new_text": null,
          "old_line_content": "                        if (pdbCopy->close(0))",
          "new_line_content": "                        }",
          "content_same": false
        },
        {
          "line": 783,
          "old_api": "string",
          "new_api": null,
          "old_text": "pathAddr.string().c_str()",
          "new_text": null,
          "old_line_content": "    FILE *file = fopen(pathAddr.string().c_str(), \"rb\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 784,
          "old_api": "CAutoFile",
          "new_api": null,
          "old_text": "CAutoFile(file, SER_DISK, CLIENT_VERSION)",
          "new_text": null,
          "old_line_content": "    CAutoFile filein = CAutoFile(file, SER_DISK, CLIENT_VERSION);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 274,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "strFile.c_str()",
          "new_text": null,
          "old_line_content": "                    if (dbA.remove(strFile.c_str(), NULL, 0))",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 786,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"CAddrman::Read() : open failed\")",
          "new_text": null,
          "old_line_content": "        return error(\"CAddrman::Read() : open failed\");",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "strFile.c_str()",
          "new_text": null,
          "old_line_content": "                    if (dbB.rename(strFileRes.c_str(), NULL, strFile.c_str(), 0))",
          "new_line_content": "                {",
          "content_same": false
        },
        {
          "line": 792,
          "old_api": "resize",
          "new_api": null,
          "old_text": "vchData.resize(dataSize)",
          "new_text": null,
          "old_line_content": "    vchData.resize(dataSize);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "strFileRes.c_str()",
          "new_text": null,
          "old_line_content": "                    printf(\"Rewriting of %s FAILED!\\n\", strFileRes.c_str());",
          "new_line_content": "                    Db dbB(&dbenv, 0);",
          "content_same": false
        },
        {
          "line": 285,
          "old_api": "Sleep",
          "new_api": null,
          "old_text": "Sleep(100)",
          "new_text": null,
          "old_line_content": "        Sleep(100);",
          "new_line_content": "                if (!fSuccess)",
          "content_same": false
        },
        {
          "line": 801,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"CAddrman::Read() 2 : I/O error or stream data corrupted\")",
          "new_text": null,
          "old_line_content": "        return error(\"CAddrman::Read() 2 : I/O error or stream data corrupted\");",
          "new_line_content": "    try {",
          "content_same": false
        },
        {
          "line": 803,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "filein.fclose()",
          "new_text": null,
          "old_line_content": "    filein.fclose();",
          "new_line_content": "        filein >> hashIn;",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": "GetTimeMillis",
          "new_api": null,
          "old_text": "GetTimeMillis()",
          "new_text": null,
          "old_line_content": "    int64 nStart = GetTimeMillis();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": "printf",
          "new_api": null,
          "old_text": "printf(\"DBFlush(%s)%s\\n\", fShutdown ? \"true\" : \"false\", fDbEnvInit ? \"\" : \" db not started\")",
          "new_text": null,
          "old_line_content": "    printf(\"DBFlush(%s)%s\\n\", fShutdown ? \"true\" : \"false\", fDbEnvInit ? \"\" : \" db not started\");",
          "new_line_content": "void DBFlush(bool fShutdown)",
          "content_same": false
        },
        {
          "line": 810,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"CAddrman::Read() : checksum mismatch; data corrupted\")",
          "new_text": null,
          "old_line_content": "        return error(\"CAddrman::Read() : checksum mismatch; data corrupted\");",
          "new_line_content": "    CDataStream ssPeers(vchData, SER_DISK, CLIENT_VERSION);",
          "content_same": false
        },
        {
          "line": 300,
          "old_api": "LOCK",
          "new_api": null,
          "old_text": "LOCK(cs_db)",
          "new_text": null,
          "old_line_content": "        LOCK(cs_db);",
          "new_line_content": "    //  on all files that are not in use",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": "end",
          "new_api": null,
          "old_text": "mapFileUseCount.end()",
          "new_text": null,
          "old_line_content": "        while (mi != mapFileUseCount.end())",
          "new_line_content": "    if (!fDbEnvInit)",
          "content_same": false
        },
        {
          "line": 819,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"CAddrman::Read() : I/O error or stream data corrupted\")",
          "new_text": null,
          "old_line_content": "        return error(\"CAddrman::Read() : I/O error or stream data corrupted\");",
          "new_line_content": "    try {",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": "CloseDb",
          "new_api": null,
          "old_text": "CloseDb(strFile)",
          "new_text": null,
          "old_line_content": "                CloseDb(strFile);",
          "new_line_content": "            int nRefCount = (*mi).second;",
          "content_same": false
        },
        {
          "line": 823,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(pchMsgTmp, pchMessageStart, sizeof(pchMsgTmp))",
          "new_text": null,
          "old_line_content": "    if (memcmp(pchMsgTmp, pchMessageStart, sizeof(pchMsgTmp)))",
          "new_line_content": "    catch (std::exception &e) {",
          "content_same": false
        },
        {
          "line": 312,
          "old_api": "txn_checkpoint",
          "new_api": null,
          "old_text": "dbenv.txn_checkpoint(0, 0, 0)",
          "new_text": null,
          "old_line_content": "                dbenv.txn_checkpoint(0, 0, 0);",
          "new_line_content": "            if (nRefCount == 0)",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "strFile.c_str()",
          "new_text": null,
          "old_line_content": "                    printf(\"%s detach\\n\", strFile.c_str());",
          "new_line_content": "                // Move log data to the dat file",
          "content_same": false
        },
        {
          "line": 318,
          "old_api": "erase",
          "new_api": null,
          "old_text": "mapFileUseCount.erase(mi++)",
          "new_text": null,
          "old_line_content": "                mapFileUseCount.erase(mi++);",
          "new_line_content": "                if (strFile != \"blkindex.dat\" || fDetachDB) {",
          "content_same": false
        },
        {
          "line": 327,
          "old_api": "empty",
          "new_api": null,
          "old_text": "mapFileUseCount.empty()",
          "new_text": null,
          "old_line_content": "            if (mapFileUseCount.empty())",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 329,
          "old_api": "log_archive",
          "new_api": null,
          "old_text": "dbenv.log_archive(&listp, DB_ARCH_REMOVE)",
          "new_text": null,
          "old_line_content": "                dbenv.log_archive(&listp, DB_ARCH_REMOVE);",
          "new_line_content": "        if (fShutdown)",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": "EnvShutdown",
          "new_api": null,
          "old_text": "EnvShutdown()",
          "new_text": null,
          "old_line_content": "                EnvShutdown();",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 347,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(!fClient)",
          "new_text": null,
          "old_line_content": "    assert(!fClient);",
          "new_line_content": "// CTxDB",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": "SetNull",
          "new_api": null,
          "old_text": "txindex.SetNull()",
          "new_text": null,
          "old_line_content": "    txindex.SetNull();",
          "new_line_content": "//",
          "content_same": false
        },
        {
          "line": 349,
          "old_api": "string",
          "new_api": null,
          "old_text": "string(\"tx\")",
          "new_text": null,
          "old_line_content": "    return Read(make_pair(string(\"tx\"), hash), txindex);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": "string",
          "new_api": null,
          "old_text": "string(\"tx\")",
          "new_text": null,
          "old_line_content": "    return Write(make_pair(string(\"tx\"), hash), txindex);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 363,
          "old_api": "GetHash",
          "new_api": null,
          "old_text": "tx.GetHash()",
          "new_text": null,
          "old_line_content": "    uint256 hash = tx.GetHash();",
          "new_line_content": "bool CTxDB::AddTxIndex(const CTransaction& tx, const CDiskTxPos& pos, int nHeight)",
          "content_same": false
        },
        {
          "line": 364,
          "old_api": "size",
          "new_api": null,
          "old_text": "tx.vout.size()",
          "new_text": null,
          "old_line_content": "    CTxIndex txindex(pos, tx.vout.size());",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": "GetHash",
          "new_api": null,
          "old_text": "tx.GetHash()",
          "new_text": null,
          "old_line_content": "    uint256 hash = tx.GetHash();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": "string",
          "new_api": null,
          "old_text": "string(\"tx\")",
          "new_text": null,
          "old_line_content": "    return Erase(make_pair(string(\"tx\"), hash));",
          "new_line_content": "bool CTxDB::EraseTxIndex(const CTransaction& tx)",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": "string",
          "new_api": null,
          "old_text": "string(\"tx\")",
          "new_text": null,
          "old_line_content": "    return Exists(make_pair(string(\"tx\"), hash));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": "clear",
          "new_api": null,
          "old_text": "vtx.clear()",
          "new_text": null,
          "old_line_content": "    vtx.clear();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "GetCursor",
          "new_api": null,
          "old_text": "GetCursor()",
          "new_text": null,
          "old_line_content": "    Dbc* pcursor = GetCursor();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": "CDataStream ssKey(SER_DISK, CLIENT_VERSION)",
          "new_api": null,
          "old_text": "CDataStream ssKey(SER_DISK, CLIENT_VERSION)",
          "new_text": null,
          "old_line_content": "        CDataStream ssKey(SER_DISK, CLIENT_VERSION);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": "CDiskTxPos",
          "new_api": null,
          "old_text": "CDiskTxPos(0, 0, 0)",
          "new_text": null,
          "old_line_content": "            ssKey << string(\"owner\") << hash160 << CDiskTxPos(0, 0, 0);",
          "new_line_content": "    loop",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": "ReadAtCursor",
          "new_api": null,
          "old_text": "ReadAtCursor(pcursor, ssKey, ssValue, fFlags)",
          "new_text": null,
          "old_line_content": "        int ret = ReadAtCursor(pcursor, ssKey, ssValue, fFlags);",
          "new_line_content": "        // Read next record",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": "close",
          "new_api": null,
          "old_text": "pcursor->close()",
          "new_text": null,
          "old_line_content": "            pcursor->close();",
          "new_line_content": "        fFlags = DB_NEXT;",
          "content_same": false
        },
        {
          "line": 423,
          "old_api": "size",
          "new_api": null,
          "old_text": "vtx.size()",
          "new_text": null,
          "old_line_content": "            vtx.resize(vtx.size()+1);",
          "new_line_content": "        // Read transaction",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": "back",
          "new_api": null,
          "old_text": "vtx.back().ReadFromDisk(pos)",
          "new_text": null,
          "old_line_content": "            if (!vtx.back().ReadFromDisk(pos))",
          "new_line_content": "        if (strType != \"owner\" || hashItem != hash160)",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": "close",
          "new_api": null,
          "old_text": "pcursor->close()",
          "new_text": null,
          "old_line_content": "                pcursor->close();",
          "new_line_content": "        if (nItemHeight >= nMinHeight)",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": "close",
          "new_api": null,
          "old_text": "pcursor->close()",
          "new_text": null,
          "old_line_content": "    pcursor->close();",
          "new_line_content": "                return false;",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(!fClient)",
          "new_text": null,
          "old_line_content": "    assert(!fClient);",
          "new_line_content": "    return true;",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": "SetNull",
          "new_api": null,
          "old_text": "tx.SetNull()",
          "new_text": null,
          "old_line_content": "    tx.SetNull();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": "ReadTxIndex",
          "new_api": null,
          "old_text": "ReadTxIndex(hash, txindex)",
          "new_text": null,
          "old_line_content": "    if (!ReadTxIndex(hash, txindex))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": "ReadFromDisk",
          "new_api": null,
          "old_text": "tx.ReadFromDisk(txindex.pos)",
          "new_text": null,
          "old_line_content": "    return (tx.ReadFromDisk(txindex.pos));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 448,
          "old_api": "ReadDiskTx",
          "new_api": null,
          "old_text": "ReadDiskTx(hash, tx, txindex)",
          "new_text": null,
          "old_line_content": "    return ReadDiskTx(hash, tx, txindex);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 459,
          "old_api": "ReadDiskTx",
          "new_api": null,
          "old_text": "ReadDiskTx(outpoint.hash, tx, txindex)",
          "new_text": null,
          "old_line_content": "    return ReadDiskTx(outpoint.hash, tx, txindex);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": "find",
          "new_api": null,
          "old_text": "mapBlockIndex.find(hash)",
          "new_text": null,
          "old_line_content": "    map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hash);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": "end",
          "new_api": null,
          "old_text": "mapBlockIndex.end()",
          "new_text": null,
          "old_line_content": "    if (mi != mapBlockIndex.end())",
          "new_line_content": "    if (hash == 0)",
          "content_same": false
        },
        {
          "line": 500,
          "old_api": "runtime_error",
          "new_api": null,
          "old_text": "runtime_error(\"LoadBlockIndex() : new CBlockIndex failed\")",
          "new_text": null,
          "old_line_content": "        throw runtime_error(\"LoadBlockIndex() : new CBlockIndex failed\");",
          "new_line_content": "        return (*mi).second;",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": "make_pair",
          "new_api": null,
          "old_text": "make_pair(hash, pindexNew)",
          "new_text": null,
          "old_line_content": "    mi = mapBlockIndex.insert(make_pair(hash, pindexNew)).first;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": "GetCursor",
          "new_api": null,
          "old_text": "GetCursor()",
          "new_text": null,
          "old_line_content": "    Dbc* pcursor = GetCursor();",
          "new_line_content": "}",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 44,
      "total_additions": 143,
      "total_deletions": 142,
      "total_api_changes": 329
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 329,
        "non_api_lines": 6,
        "non_api_line_numbers": [
          109,
          79,
          81,
          82,
          113,
          114
        ]
      }
    },
    "api_calls_before": 302,
    "api_calls_after": 303,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 1,
      "total_diff_lines": 26
    }
  }
}