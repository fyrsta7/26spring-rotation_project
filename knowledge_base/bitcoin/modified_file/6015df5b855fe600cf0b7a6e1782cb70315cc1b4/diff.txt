diff --git a/modified_file.cpp b/modified_file.cpp
index 0000000..1111111 100644
--- a/modified_file.cpp
+++ b/modified_file.cpp
--- a/modified_file.cpp
+++ b/modified_file.cpp
@@ -69,6 +69,9 @@
 

 uint256 CTransaction::GetWitnessHash() const

 {

+    if (!HasWitness()) {

+        return GetHash();

+    }

     return SerializeHash(*this, SER_GETHASH, 0);

 }

 
