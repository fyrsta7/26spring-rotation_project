{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/zstd/modified_file/e06f91a169f577566fba0680da10e725aaea076b",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/zstd/modified_file/e06f91a169f577566fba0680da10e725aaea076b/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/zstd/modified_file/e06f91a169f577566fba0680da10e725aaea076b/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/zstd/modified_file/e06f91a169f577566fba0680da10e725aaea076b/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1817,
          "old_api": "MIN",
          "new_api": "FUZ_rand",
          "old_text": "MIN(windowLogMax, cParams.windowLog)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                cParams.windowLog = MIN(windowLogMax, cParams.windowLog);",
          "new_line_content": "                cParams.windowLog += (FUZ_rand(&lseed) & 3) - 1;",
          "content_same": false
        },
        {
          "line": 1818,
          "old_api": "FUZ_rand",
          "new_api": "MIN",
          "old_text": "FUZ_rand(&lseed)",
          "new_text": "MIN(windowLogMax, cParams.windowLog)",
          "old_line_content": "                cParams.hashLog += (FUZ_rand(&lseed) & 3) - 1;",
          "new_line_content": "                cParams.windowLog = MIN(windowLogMax, cParams.windowLog);",
          "content_same": false
        },
        {
          "line": 1822,
          "old_api": "FUZ_rand",
          "new_api": "MIN",
          "old_text": "FUZ_rand(&lseed)",
          "new_text": "MIN(searchLogMax, cParams.searchLog)",
          "old_line_content": "                cParams.targetLength = (U32)((cParams.targetLength + 1 ) * (0.5 + ((double)(FUZ_rand(&lseed) & 127) / 128)));",
          "new_line_content": "                cParams.searchLog = MIN(searchLogMax, cParams.searchLog);",
          "content_same": false
        },
        {
          "line": 1823,
          "old_api": "ZSTD_adjustCParams",
          "new_api": "FUZ_rand",
          "old_text": "ZSTD_adjustCParams(cParams, pledgedSrcSize, dictSize)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                cParams = ZSTD_adjustCParams(cParams, pledgedSrcSize, dictSize);",
          "new_line_content": "                cParams.searchLength += (FUZ_rand(&lseed) & 3) - 1;",
          "content_same": false
        },
        {
          "line": 1825,
          "old_api": "FUZ_rand",
          "new_api": "ZSTD_adjustCParams",
          "old_text": "FUZ_rand(&lseed)",
          "new_text": "ZSTD_adjustCParams(cParams, pledgedSrcSize, dictSize)",
          "old_line_content": "                if (FUZ_rand(&lseed) & 1) {",
          "new_line_content": "                cParams = ZSTD_adjustCParams(cParams, pledgedSrcSize, dictSize);",
          "content_same": false
        },
        {
          "line": 1827,
          "old_api": "setCCtxParameter",
          "new_api": "FUZ_rand",
          "old_text": "setCCtxParameter(zc, cctxParams, ZSTD_p_windowLog, cParams.windowLog, opaqueAPI)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                    CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_windowLog, cParams.windowLog, opaqueAPI) );",
          "new_line_content": "                if (FUZ_rand(&lseed) & 1) {",
          "content_same": false
        },
        {
          "line": 1828,
          "old_api": "assert",
          "new_api": "DISPLAYLEVEL",
          "old_text": "assert(cParams.windowLog >= ZSTD_WINDOWLOG_MIN)",
          "new_text": "DISPLAYLEVEL(5, \"t%u: windowLog : %u \\n\", testNb, cParams.windowLog)",
          "old_line_content": "                    assert(cParams.windowLog >= ZSTD_WINDOWLOG_MIN);   /* guaranteed by ZSTD_adjustCParams() */",
          "new_line_content": "                    DISPLAYLEVEL(5, \"t%u: windowLog : %u \\n\", testNb, cParams.windowLog);",
          "content_same": false
        },
        {
          "line": 1833,
          "old_api": "setCCtxParameter",
          "new_api": "FUZ_rand",
          "old_text": "setCCtxParameter(zc, cctxParams, ZSTD_p_hashLog, cParams.hashLog, opaqueAPI)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                    CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_hashLog, cParams.hashLog, opaqueAPI) );",
          "new_line_content": "                if (FUZ_rand(&lseed) & 1) {",
          "content_same": false
        },
        {
          "line": 1835,
          "old_api": "FUZ_rand",
          "new_api": "setCCtxParameter",
          "old_text": "FUZ_rand(&lseed)",
          "new_text": "setCCtxParameter(zc, cctxParams, ZSTD_p_hashLog, cParams.hashLog, opaqueAPI)",
          "old_line_content": "                if (FUZ_rand(&lseed) & 1) {",
          "new_line_content": "                    CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_hashLog, cParams.hashLog, opaqueAPI) );",
          "content_same": false
        },
        {
          "line": 1837,
          "old_api": "setCCtxParameter",
          "new_api": "FUZ_rand",
          "old_text": "setCCtxParameter(zc, cctxParams, ZSTD_p_chainLog, cParams.chainLog, opaqueAPI)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                    CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_chainLog, cParams.chainLog, opaqueAPI) );",
          "new_line_content": "                if (FUZ_rand(&lseed) & 1) {",
          "content_same": false
        },
        {
          "line": 1847,
          "old_api": "FUZ_randomClampedLength",
          "new_api": "FUZ_rand",
          "old_text": "FUZ_randomClampedLength(&lseed, ZSTD_LDM_MINMATCH_MIN, ZSTD_LDM_MINMATCH_MAX)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                    if (FUZ_rand(&lseed) & 3) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_ldmMinMatch, FUZ_randomClampedLength(&lseed, ZSTD_LDM_MINMATCH_MIN, ZSTD_LDM_MINMATCH_MAX), opaqueAPI) );",
          "new_line_content": "                    if (FUZ_rand(&lseed) & 1) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_enableLongDistanceMatching, FUZ_rand(&lseed) & 63, opaqueAPI) );",
          "content_same": false
        },
        {
          "line": 1855,
          "old_api": "DISPLAYLEVEL",
          "new_api": "FUZ_rand",
          "old_text": "DISPLAYLEVEL(5, \"t%u: frame checksum : %u \\n\", testNb, checksumFlag)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                    DISPLAYLEVEL(5, \"t%u: frame checksum : %u \\n\", testNb, checksumFlag);",
          "new_line_content": "                if (FUZ_rand(&lseed) & 1) {",
          "content_same": false
        },
        {
          "line": 1856,
          "old_api": "setCCtxParameter",
          "new_api": "FUZ_rand",
          "old_text": "setCCtxParameter(zc, cctxParams, ZSTD_p_checksumFlag, checksumFlag, opaqueAPI)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                    CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_checksumFlag, checksumFlag, opaqueAPI) );",
          "new_line_content": "                    U32 const checksumFlag = FUZ_rand(&lseed) & 1;",
          "content_same": false
        },
        {
          "line": 1858,
          "old_api": "FUZ_rand",
          "new_api": "setCCtxParameter",
          "old_text": "FUZ_rand(&lseed)",
          "new_text": "setCCtxParameter(zc, cctxParams, ZSTD_p_checksumFlag, checksumFlag, opaqueAPI)",
          "old_line_content": "                if (FUZ_rand(&lseed) & 1) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_dictIDFlag, FUZ_rand(&lseed) & 1, opaqueAPI) );",
          "new_line_content": "                    CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_checksumFlag, checksumFlag, opaqueAPI) );",
          "content_same": false
        },
        {
          "line": 1861,
          "old_api": "DISPLAYLEVEL",
          "new_api": "FUZ_rand",
          "old_text": "DISPLAYLEVEL(5, \"t%u: pledgedSrcSize : %u \\n\", testNb, (U32)pledgedSrcSize)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                    DISPLAYLEVEL(5, \"t%u: pledgedSrcSize : %u \\n\", testNb, (U32)pledgedSrcSize);",
          "new_line_content": "                if (FUZ_rand(&lseed) & 1) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_contentSizeFlag, FUZ_rand(&lseed) & 1, opaqueAPI) );",
          "content_same": false
        },
        {
          "line": 1862,
          "old_api": "ZSTD_CCtx_setPledgedSrcSize",
          "new_api": "FUZ_rand",
          "old_text": "ZSTD_CCtx_setPledgedSrcSize(zc, pledgedSrcSize)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                    CHECK_Z( ZSTD_CCtx_setPledgedSrcSize(zc, pledgedSrcSize) );",
          "new_line_content": "                if (FUZ_rand(&lseed) & 1) {",
          "content_same": false
        },
        {
          "line": 1868,
          "old_api": "MIN",
          "new_api": "FUZ_rand",
          "old_text": "MIN(nbThreadsAdjusted, nbThreadsMax)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                    U32 const nbThreads = MIN(nbThreadsAdjusted, nbThreadsMax);",
          "new_line_content": "                if (bigTests || (FUZ_rand(&lseed) & 0xF) == 0xF) {",
          "content_same": false
        },
        {
          "line": 1869,
          "old_api": "DISPLAYLEVEL",
          "new_api": "FUZ_rand",
          "old_text": "DISPLAYLEVEL(5, \"t%u: nbThreads : %u \\n\", testNb, nbThreads)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                    DISPLAYLEVEL(5, \"t%u: nbThreads : %u \\n\", testNb, nbThreads);",
          "new_line_content": "                    U32 const nbThreadsCandidate = (FUZ_rand(&lseed) & 4) + 1;",
          "content_same": false
        },
        {
          "line": 1872,
          "old_api": "FUZ_rand",
          "new_api": "DISPLAYLEVEL",
          "old_text": "FUZ_rand(&lseed)",
          "new_text": "DISPLAYLEVEL(5, \"t%u: nbThreads : %u \\n\", testNb, nbThreads)",
          "old_line_content": "                        U32 const jobLog = FUZ_rand(&lseed) % (testLog+1);",
          "new_line_content": "                    DISPLAYLEVEL(5, \"t%u: nbThreads : %u \\n\", testNb, nbThreads);",
          "content_same": false
        },
        {
          "line": 1873,
          "old_api": "FUZ_rand",
          "new_api": "setCCtxParameter",
          "old_text": "FUZ_rand(&lseed)",
          "new_text": "setCCtxParameter(zc, cctxParams, ZSTD_p_nbWorkers, nbThreads, opaqueAPI)",
          "old_line_content": "                        CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_overlapSizeLog, FUZ_rand(&lseed) % 10, opaqueAPI) );",
          "new_line_content": "                    CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_nbWorkers, nbThreads, opaqueAPI) );",
          "content_same": false
        },
        {
          "line": 1886,
          "old_api": "FUZ_rand",
          "new_api": "ZSTD_CCtx_setParametersUsingCCtxParams",
          "old_text": "FUZ_rand(&lseed)",
          "new_text": "ZSTD_CCtx_setParametersUsingCCtxParams(zc, cctxParams)",
          "old_line_content": "                if (FUZ_rand(&lseed) & 1) {",
          "new_line_content": "                    CHECK_Z (ZSTD_CCtx_setParametersUsingCCtxParams(zc, cctxParams) );",
          "content_same": false
        },
        {
          "line": 1890,
          "old_api": "ZSTD_CCtx_loadDictionary_byReference",
          "new_api": "FUZ_rand",
          "old_text": "ZSTD_CCtx_loadDictionary_byReference(zc, dict, dictSize)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                        CHECK_Z( ZSTD_CCtx_loadDictionary_byReference(zc, dict, dictSize) );",
          "new_line_content": "                    if (FUZ_rand(&lseed) & 1) {",
          "content_same": false
        },
        {
          "line": 1898,
          "old_api": "ZSTD_CCtx_setParameter",
          "new_api": "ZSTD_CCtx_setParametersUsingCCtxParams",
          "old_text": "ZSTD_CCtx_setParameter(zc, ZSTD_p_windowLog, cParams.windowLog-1)",
          "new_text": "ZSTD_CCtx_setParametersUsingCCtxParams(zc, cctxParams)",
          "old_line_content": "                            size_t const setError = ZSTD_CCtx_setParameter(zc, ZSTD_p_windowLog, cParams.windowLog-1);",
          "new_line_content": "                            size_t const setError = ZSTD_CCtx_setParametersUsingCCtxParams(zc, cctxParams);",
          "content_same": false
        },
        {
          "line": 1910,
          "old_api": "XXH64_reset",
          "new_api": "getCCtxParams",
          "old_text": "XXH64_reset(&xxhState, 0)",
          "new_text": "getCCtxParams(zc, &savedParams)",
          "old_line_content": "        XXH64_reset(&xxhState, 0);",
          "new_line_content": "        CHECK_Z(getCCtxParams(zc, &savedParams));",
          "content_same": false
        },
        {
          "line": 1927,
          "old_api": "XXH64_update",
          "new_api": "DISPLAYLEVEL",
          "old_text": "XXH64_update(&xxhState, srcBuffer+srcStart, inBuff.pos)",
          "new_text": "DISPLAYLEVEL(6, \"t%u: compress consumed %u bytes (total : %u) ; flush: %u (total : %u) \\n\",\n                    testNb, (U32)inBuff.pos, (U32)(totalTestSize + inBuff.pos), (U32)flush, (U32)outBuff.pos)",
          "old_line_content": "                XXH64_update(&xxhState, srcBuffer+srcStart, inBuff.pos);",
          "new_line_content": "                DISPLAYLEVEL(6, \"t%u: compress consumed %u bytes (total : %u) ; flush: %u (total : %u) \\n\",",
          "content_same": false
        },
        {
          "line": 1928,
          "old_api": "memcpy",
          "new_api": "U32)(totalTestSize + inBuff.pos)",
          "old_text": "memcpy(copyBuffer+totalTestSize, srcBuffer+srcStart, inBuff.pos)",
          "new_text": "U32)(totalTestSize + inBuff.pos)",
          "old_line_content": "                memcpy(copyBuffer+totalTestSize, srcBuffer+srcStart, inBuff.pos);",
          "new_line_content": "                    testNb, (U32)inBuff.pos, (U32)(totalTestSize + inBuff.pos), (U32)flush, (U32)outBuff.pos);",
          "content_same": false
        },
        {
          "line": 1939,
          "old_api": "DISPLAYLEVEL",
          "new_api": "FUZ_randomLength",
          "old_text": "DISPLAYLEVEL(6, \"t%u: End-flush into dst buffer of size %u \\n\", testNb, (U32)adjustedDstSize)",
          "new_text": "FUZ_randomLength(&lseed, maxSampleLog+1)",
          "old_line_content": "                    DISPLAYLEVEL(6, \"t%u: End-flush into dst buffer of size %u \\n\", testNb, (U32)adjustedDstSize);",
          "new_line_content": "                    size_t const randomDstSize = FUZ_randomLength(&lseed, maxSampleLog+1);",
          "content_same": false
        },
        {
          "line": 1940,
          "old_api": "ZSTD_compress_generic",
          "new_api": "MIN",
          "old_text": "ZSTD_compress_generic(zc, &outBuff, &inBuff, ZSTD_e_end)",
          "new_text": "MIN(cBufferSize - cSize, randomDstSize)",
          "old_line_content": "                    remainingToFlush = ZSTD_compress_generic(zc, &outBuff, &inBuff, ZSTD_e_end);",
          "new_line_content": "                    size_t const adjustedDstSize = MIN(cBufferSize - cSize, randomDstSize);",
          "content_same": false
        },
        {
          "line": 1942,
          "old_api": "ZSTD_isError",
          "new_api": "DISPLAYLEVEL",
          "old_text": "ZSTD_isError(remainingToFlush)",
          "new_text": "DISPLAYLEVEL(6, \"t%u: End-flush into dst buffer of size %u \\n\", testNb, (U32)adjustedDstSize)",
          "old_line_content": "                    CHECK( ZSTD_isError(remainingToFlush),",
          "new_line_content": "                    DISPLAYLEVEL(6, \"t%u: End-flush into dst buffer of size %u \\n\", testNb, (U32)adjustedDstSize);",
          "content_same": false
        },
        {
          "line": 1944,
          "old_api": "ZSTD_getErrorName",
          "new_api": "DISPLAYLEVEL",
          "old_text": "ZSTD_getErrorName(remainingToFlush)",
          "new_text": "DISPLAYLEVEL(6, \"t%u: Total flushed so far : %u bytes \\n\", testNb, (U32)outBuff.pos)",
          "old_line_content": "                           ZSTD_getErrorName(remainingToFlush) );",
          "new_line_content": "                    DISPLAYLEVEL(6, \"t%u: Total flushed so far : %u bytes \\n\", testNb, (U32)outBuff.pos);",
          "content_same": false
        },
        {
          "line": 1951,
          "old_api": "badParameters",
          "new_api": "DISPLAYLEVEL",
          "old_text": "badParameters(zc, savedParams)",
          "new_text": "DISPLAYLEVEL(5, \"Frame completed : %zu bytes \\n\", cSize)",
          "old_line_content": "        CHECK(badParameters(zc, savedParams), \"CCtx params are wrong\");",
          "new_line_content": "            DISPLAYLEVEL(5, \"Frame completed : %zu bytes \\n\", cSize);",
          "content_same": false
        },
        {
          "line": 1954,
          "old_api": "FUZ_rand",
          "new_api": "badParameters",
          "old_text": "FUZ_rand(&lseed)",
          "new_text": "badParameters(zc, savedParams)",
          "old_line_content": "        if (!dictSize /* don't reset if dictionary : could be different */ && (FUZ_rand(&lseed) & 1)) {",
          "new_line_content": "        CHECK(badParameters(zc, savedParams), \"CCtx params are wrong\");",
          "content_same": false
        },
        {
          "line": 1959,
          "old_api": "DISPLAYLEVEL",
          "new_api": "ZSTD_resetDStream",
          "old_text": "DISPLAYLEVEL(5, \"using dictionary of size %zu \\n\", dictSize)",
          "new_text": "ZSTD_resetDStream(zd)",
          "old_line_content": "                DISPLAYLEVEL(5, \"using dictionary of size %zu \\n\", dictSize);",
          "new_line_content": "            CHECK_Z( ZSTD_resetDStream(zd) );",
          "content_same": false
        },
        {
          "line": 1971,
          "old_api": "DISPLAYLEVEL",
          "new_api": "MIN",
          "old_text": "DISPLAYLEVEL(6, \"decompression presented %u new bytes (pos:%u/%u)\\n\",\n                                (U32)readCSrcSize, (U32)inBuff.pos, (U32)cSize)",
          "new_text": "MIN(dstBufferSize - totalGenSize, randomDstSize)",
          "old_line_content": "                DISPLAYLEVEL(6, \"decompression presented %u new bytes (pos:%u/%u)\\n\",",
          "new_line_content": "                size_t const dstBuffSize = MIN(dstBufferSize - totalGenSize, randomDstSize);",
          "content_same": false
        },
        {
          "line": 1976,
          "old_api": "ZSTD_isError",
          "new_api": "ZSTD_decompressStream",
          "old_text": "ZSTD_isError(decompressionResult)",
          "new_text": "ZSTD_decompressStream(zd, &outBuff, &inBuff)",
          "old_line_content": "                if (ZSTD_isError(decompressionResult)) {",
          "new_line_content": "                decompressionResult = ZSTD_decompressStream(zd, &outBuff, &inBuff);",
          "content_same": false
        },
        {
          "line": 1977,
          "old_api": "ZSTD_getErrorName",
          "new_api": "DISPLAYLEVEL",
          "old_text": "ZSTD_getErrorName(decompressionResult)",
          "new_text": "DISPLAYLEVEL(6, \"so far: consumed = %u, produced = %u \\n\",\n                                (U32)inBuff.pos, (U32)outBuff.pos)",
          "old_line_content": "                    DISPLAY(\"ZSTD_decompressStream error : %s \\n\", ZSTD_getErrorName(decompressionResult));",
          "new_line_content": "                DISPLAYLEVEL(6, \"so far: consumed = %u, produced = %u \\n\",",
          "content_same": false
        },
        {
          "line": 1981,
          "old_api": "CHECK (inBuff.pos > cSize, \"ZSTD_decompressStream consumes too much input : %u > %u \", (U32)inBuff.pos, (U32)cSize)",
          "new_api": "findDiff",
          "old_text": "CHECK (inBuff.pos > cSize, \"ZSTD_decompressStream consumes too much input : %u > %u \", (U32)inBuff.pos, (U32)cSize)",
          "new_text": "findDiff(copyBuffer, dstBuffer, totalTestSize)",
          "old_line_content": "                CHECK (inBuff.pos > cSize, \"ZSTD_decompressStream consumes too much input : %u > %u \", (U32)inBuff.pos, (U32)cSize);",
          "new_line_content": "                    findDiff(copyBuffer, dstBuffer, totalTestSize);",
          "content_same": false
        },
        {
          "line": 1983,
          "old_api": "CHECK (inBuff.pos != cSize, \"compressed data should be fully read (%u != %u)\", (U32)inBuff.pos, (U32)cSize)",
          "new_api": "ZSTD_getErrorName",
          "old_text": "CHECK (inBuff.pos != cSize, \"compressed data should be fully read (%u != %u)\", (U32)inBuff.pos, (U32)cSize)",
          "new_text": "ZSTD_getErrorName(decompressionResult)",
          "old_line_content": "            CHECK (inBuff.pos != cSize, \"compressed data should be fully read (%u != %u)\", (U32)inBuff.pos, (U32)cSize);",
          "new_line_content": "                CHECK (ZSTD_isError(decompressionResult), \"decompression error : %s\", ZSTD_getErrorName(decompressionResult));",
          "content_same": false
        },
        {
          "line": 1984,
          "old_api": "CHECK (outBuff.pos != totalTestSize, \"decompressed data : wrong size (%u != %u)\", (U32)outBuff.pos, (U32)totalTestSize)",
          "new_api": "CHECK (inBuff.pos > cSize, \"ZSTD_decompressStream consumes too much input : %u > %u \", (U32)inBuff.pos, (U32)cSize)",
          "old_text": "CHECK (outBuff.pos != totalTestSize, \"decompressed data : wrong size (%u != %u)\", (U32)outBuff.pos, (U32)totalTestSize)",
          "new_text": "CHECK (inBuff.pos > cSize, \"ZSTD_decompressStream consumes too much input : %u > %u \", (U32)inBuff.pos, (U32)cSize)",
          "old_line_content": "            CHECK (outBuff.pos != totalTestSize, \"decompressed data : wrong size (%u != %u)\", (U32)outBuff.pos, (U32)totalTestSize);",
          "new_line_content": "                CHECK (inBuff.pos > cSize, \"ZSTD_decompressStream consumes too much input : %u > %u \", (U32)inBuff.pos, (U32)cSize);",
          "content_same": false
        },
        {
          "line": 1986,
          "old_api": "findDiff",
          "new_api": "CHECK (inBuff.pos != cSize, \"compressed data should be fully read (%u != %u)\", (U32)inBuff.pos, (U32)cSize)",
          "old_text": "findDiff(copyBuffer, dstBuffer, totalTestSize)",
          "new_text": "CHECK (inBuff.pos != cSize, \"compressed data should be fully read (%u != %u)\", (U32)inBuff.pos, (U32)cSize)",
          "old_line_content": "                if (crcDest!=crcOrig) findDiff(copyBuffer, dstBuffer, totalTestSize);",
          "new_line_content": "            CHECK (inBuff.pos != cSize, \"compressed data should be fully read (%u != %u)\", (U32)inBuff.pos, (U32)cSize);",
          "content_same": false
        },
        {
          "line": 1987,
          "old_api": "CHECK (crcDest!=crcOrig, \"decompressed data corrupted\")",
          "new_api": "CHECK (outBuff.pos != totalTestSize, \"decompressed data : wrong size (%u != %u)\", (U32)outBuff.pos, (U32)totalTestSize)",
          "old_text": "CHECK (crcDest!=crcOrig, \"decompressed data corrupted\")",
          "new_text": "CHECK (outBuff.pos != totalTestSize, \"decompressed data : wrong size (%u != %u)\", (U32)outBuff.pos, (U32)totalTestSize)",
          "old_line_content": "                CHECK (crcDest!=crcOrig, \"decompressed data corrupted\");",
          "new_line_content": "            CHECK (outBuff.pos != totalTestSize, \"decompressed data : wrong size (%u != %u)\", (U32)outBuff.pos, (U32)totalTestSize);",
          "content_same": false
        },
        {
          "line": 1996,
          "old_api": "MIN",
          "new_api": "FUZ_rand",
          "old_text": "MIN((cSize/3) , randomNoiseSize)",
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                size_t const noiseSize  = MIN((cSize/3) , randomNoiseSize);",
          "new_line_content": "        {   U32 const nbNoiseChunks = (FUZ_rand(&lseed) & 7) + 2;",
          "content_same": false
        },
        {
          "line": 1998,
          "old_api": "FUZ_rand",
          "new_api": "FUZ_randomLength",
          "old_text": "FUZ_rand(&lseed)",
          "new_text": "FUZ_randomLength(&lseed, maxSampleLog)",
          "old_line_content": "                size_t const cStart = FUZ_rand(&lseed) % (cSize - noiseSize);",
          "new_line_content": "                size_t const randomNoiseSize = FUZ_randomLength(&lseed, maxSampleLog);",
          "content_same": false
        },
        {
          "line": 1999,
          "old_api": "memcpy",
          "new_api": "MIN",
          "old_text": "memcpy(cBuffer+cStart, srcBuffer+noiseStart, noiseSize)",
          "new_text": "MIN((cSize/3) , randomNoiseSize)",
          "old_line_content": "                memcpy(cBuffer+cStart, srcBuffer+noiseStart, noiseSize);",
          "new_line_content": "                size_t const noiseSize  = MIN((cSize/3) , randomNoiseSize);",
          "content_same": false
        },
        {
          "line": 2010,
          "old_api": "MIN",
          "new_api": "FUZ_randomLength",
          "old_text": "MIN(cSize - inBuff.pos, randomCSrcSize)",
          "new_text": "FUZ_randomLength(&lseed, maxSampleLog)",
          "old_line_content": "                size_t const adjustedCSrcSize = MIN(cSize - inBuff.pos, randomCSrcSize);",
          "new_line_content": "                size_t const randomCSrcSize = FUZ_randomLength(&lseed, maxSampleLog);",
          "content_same": false
        },
        {
          "line": 2013,
          "old_api": "ZSTD_decompressStream",
          "new_api": "MIN",
          "old_text": "ZSTD_decompressStream(zd, &outBuff, &inBuff)",
          "new_text": "MIN(cSize - inBuff.pos, randomCSrcSize)",
          "old_line_content": "                {   size_t const decompressError = ZSTD_decompressStream(zd, &outBuff, &inBuff);",
          "new_line_content": "                size_t const adjustedCSrcSize = MIN(cSize - inBuff.pos, randomCSrcSize);",
          "content_same": false
        },
        {
          "line": 2021,
          "old_api": "ZSTD_freeCCtx",
          "new_api": "DISPLAY",
          "old_text": "ZSTD_freeCCtx(zc)",
          "new_text": "DISPLAY(\"\\r%u fuzzer tests completed   \\n\", testNb-1)",
          "old_line_content": "    ZSTD_freeCCtx(zc);",
          "new_line_content": "    DISPLAY(\"\\r%u fuzzer tests completed   \\n\", testNb-1);",
          "content_same": false
        },
        {
          "line": 2024,
          "old_api": "ZSTD_freeCCtxParams",
          "new_api": "ZSTD_freeCCtx",
          "old_text": "ZSTD_freeCCtxParams(cctxParams)",
          "new_text": "ZSTD_freeCCtx(zc)",
          "old_line_content": "    ZSTD_freeCCtxParams(cctxParams);",
          "new_line_content": "    ZSTD_freeCCtx(zc);",
          "content_same": false
        },
        {
          "line": 2025,
          "old_api": "free",
          "new_api": "ZSTD_freeDStream",
          "old_text": "free(cNoiseBuffer[0])",
          "new_text": "ZSTD_freeDStream(zd)",
          "old_line_content": "    free(cNoiseBuffer[0]);",
          "new_line_content": "    ZSTD_freeDStream(zd);",
          "content_same": false
        },
        {
          "line": 2026,
          "old_api": "free",
          "new_api": "ZSTD_freeDStream",
          "old_text": "free(cNoiseBuffer[1])",
          "new_text": "ZSTD_freeDStream(zd_noise)",
          "old_line_content": "    free(cNoiseBuffer[1]);",
          "new_line_content": "    ZSTD_freeDStream(zd_noise);",
          "content_same": false
        },
        {
          "line": 2027,
          "old_api": "free",
          "new_api": "ZSTD_freeCCtxParams",
          "old_text": "free(cNoiseBuffer[2])",
          "new_text": "ZSTD_freeCCtxParams(cctxParams)",
          "old_line_content": "    free(cNoiseBuffer[2]);",
          "new_line_content": "    ZSTD_freeCCtxParams(cctxParams);",
          "content_same": false
        },
        {
          "line": 2176,
          "old_api": "time",
          "new_api": "DISPLAY",
          "old_text": "time(NULL)",
          "new_text": "DISPLAY(\"Starting zstream tester (%i-bits, %s)\\n\", (int)(sizeof(size_t)*8), ZSTD_VERSION_STRING)",
          "old_line_content": "        time_t const t = time(NULL);",
          "new_line_content": "    DISPLAY(\"Starting zstream tester (%i-bits, %s)\\n\", (int)(sizeof(size_t)*8), ZSTD_VERSION_STRING);",
          "content_same": false
        },
        {
          "line": 2197,
          "old_api": "fuzzerTests_MT",
          "new_api": "fuzzerTests",
          "old_text": "fuzzerTests_MT(seed, nbTests, testNb, ((double)proba) / 100, bigTests)",
          "new_text": "fuzzerTests(seed, nbTests, testNb, ((double)proba) / 100, bigTests)",
          "old_line_content": "            result = fuzzerTests_MT(seed, nbTests, testNb, ((double)proba) / 100, bigTests);",
          "new_line_content": "            result = fuzzerTests(seed, nbTests, testNb, ((double)proba) / 100, bigTests);",
          "content_same": false
        },
        {
          "line": 2200,
          "old_api": "fuzzerTests_newAPI",
          "new_api": "fuzzerTests_MT",
          "old_text": "fuzzerTests_newAPI(seed, nbTests, testNb, ((double)proba) / 100, bigTests)",
          "new_text": "fuzzerTests_MT(seed, nbTests, testNb, ((double)proba) / 100, bigTests)",
          "old_line_content": "            result = fuzzerTests_newAPI(seed, nbTests, testNb, ((double)proba) / 100, bigTests);",
          "new_line_content": "            result = fuzzerTests_MT(seed, nbTests, testNb, ((double)proba) / 100, bigTests);",
          "content_same": false
        },
        {
          "line": 2203,
          "old_api": "assert",
          "new_api": "fuzzerTests_newAPI",
          "old_text": "assert(0)",
          "new_text": "fuzzerTests_newAPI(seed, nbTests, testNb, ((double)proba) / 100, bigTests)",
          "old_line_content": "            assert(0);   /* impossible */",
          "new_line_content": "            result = fuzzerTests_newAPI(seed, nbTests, testNb, ((double)proba) / 100, bigTests);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1920,
          "old_api": null,
          "new_api": "FUZ_randomLength",
          "old_text": null,
          "new_text": "FUZ_randomLength(&lseed, maxSampleLog+1)",
          "old_line_content": "                ZSTD_inBuffer inBuff = { srcBuffer+srcStart, srcSize, 0 };",
          "new_line_content": "                size_t const randomDstSize = FUZ_randomLength(&lseed, maxSampleLog+1);",
          "content_same": false
        },
        {
          "line": 1921,
          "old_api": null,
          "new_api": "MIN",
          "old_text": null,
          "new_text": "MIN(cBufferSize - cSize, randomDstSize)",
          "old_line_content": "                outBuff.size = outBuff.pos + dstBuffSize;",
          "new_line_content": "                size_t const dstBuffSize = MIN(cBufferSize - cSize, randomDstSize);",
          "content_same": false
        },
        {
          "line": 1922,
          "old_api": null,
          "new_api": "FUZ_rand",
          "old_text": null,
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "",
          "new_line_content": "                ZSTD_EndDirective const flush = (FUZ_rand(&lseed) & 15) ? ZSTD_e_continue : ZSTD_e_flush;",
          "content_same": false
        },
        {
          "line": 2179,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "    }",
          "new_line_content": "        time_t const t = time(NULL);",
          "content_same": false
        },
        {
          "line": 2180,
          "old_api": null,
          "new_api": "XXH32",
          "old_text": null,
          "new_text": "XXH32(&t, sizeof(t), 1)",
          "old_line_content": "",
          "new_line_content": "        U32 const h = XXH32(&t, sizeof(t), 1);",
          "content_same": false
        },
        {
          "line": 1926,
          "old_api": null,
          "new_api": "ZSTD_compress_generic",
          "old_text": null,
          "new_text": "ZSTD_compress_generic(zc, &outBuff, &inBuff, flush)",
          "old_line_content": "",
          "new_line_content": "                CHECK_Z( ZSTD_compress_generic(zc, &outBuff, &inBuff, flush) );",
          "content_same": false
        },
        {
          "line": 2056,
          "old_api": null,
          "new_api": "DISPLAY",
          "old_text": null,
          "new_text": "DISPLAY( \" -v     : verbose\\n\")",
          "old_line_content": "    return 0;",
          "new_line_content": "    DISPLAY( \" -v     : verbose\\n\");",
          "content_same": false
        },
        {
          "line": 2057,
          "old_api": null,
          "new_api": "DISPLAY",
          "old_text": null,
          "new_text": "DISPLAY( \" -p     : pause at the end\\n\")",
          "old_line_content": "}",
          "new_line_content": "    DISPLAY( \" -p     : pause at the end\\n\");",
          "content_same": false
        },
        {
          "line": 2058,
          "old_api": null,
          "new_api": "DISPLAY",
          "old_text": null,
          "new_text": "DISPLAY( \" -h     : display help and exit\\n\")",
          "old_line_content": "",
          "new_line_content": "    DISPLAY( \" -h     : display help and exit\\n\");",
          "content_same": false
        },
        {
          "line": 2184,
          "old_api": null,
          "new_api": "DISPLAY",
          "old_text": null,
          "new_text": "DISPLAY(\"Seed = %u\\n\", seed)",
          "old_line_content": "    if (nbTests<=0) nbTests=1;",
          "new_line_content": "    DISPLAY(\"Seed = %u\\n\", seed);",
          "content_same": false
        },
        {
          "line": 2185,
          "old_api": null,
          "new_api": "DISPLAY",
          "old_text": null,
          "new_text": "DISPLAY(\"Compressibility : %i%%\\n\", proba)",
          "old_line_content": "",
          "new_line_content": "    if (proba!=FUZ_COMPRESSIBILITY_DEFAULT) DISPLAY(\"Compressibility : %i%%\\n\", proba);",
          "content_same": false
        },
        {
          "line": 1930,
          "old_api": null,
          "new_api": "XXH64_update",
          "old_text": null,
          "new_text": "XXH64_update(&xxhState, srcBuffer+srcStart, inBuff.pos)",
          "old_line_content": "            }",
          "new_line_content": "                XXH64_update(&xxhState, srcBuffer+srcStart, inBuff.pos);",
          "content_same": false
        },
        {
          "line": 2190,
          "old_api": null,
          "new_api": "basicUnitTests",
          "old_text": null,
          "new_text": "basicUnitTests(0, ((double)proba) / 100)",
          "old_line_content": "    if (!result) {",
          "new_line_content": "        result = basicUnitTests(0, ((double)proba) / 100);  /* constant seed for predictability */",
          "content_same": false
        },
        {
          "line": 1931,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(copyBuffer+totalTestSize, srcBuffer+srcStart, inBuff.pos)",
          "old_line_content": "",
          "new_line_content": "                memcpy(copyBuffer+totalTestSize, srcBuffer+srcStart, inBuff.pos);",
          "content_same": false
        },
        {
          "line": 1814,
          "old_api": null,
          "new_api": "DISPLAYLEVEL",
          "old_text": null,
          "new_text": "DISPLAYLEVEL(5, \"t%u: with dictionary of size : %zu \\n\", testNb, dictSize)",
          "old_line_content": "",
          "new_line_content": "                    DISPLAYLEVEL(5, \"t%u: with dictionary of size : %zu \\n\", testNb, dictSize);",
          "content_same": false
        },
        {
          "line": 1943,
          "old_api": null,
          "new_api": "ZSTD_compress_generic",
          "old_text": null,
          "new_text": "ZSTD_compress_generic(zc, &outBuff, &inBuff, ZSTD_e_end)",
          "old_line_content": "                          \"ZSTD_compress_generic w/ ZSTD_e_end error : %s\",",
          "new_line_content": "                    remainingToFlush = ZSTD_compress_generic(zc, &outBuff, &inBuff, ZSTD_e_end);",
          "content_same": false
        },
        {
          "line": 1945,
          "old_api": null,
          "new_api": "ZSTD_isError",
          "old_text": null,
          "new_text": "ZSTD_isError(remainingToFlush)",
          "old_line_content": "            }   }",
          "new_line_content": "                    CHECK( ZSTD_isError(remainingToFlush),",
          "content_same": false
        },
        {
          "line": 1947,
          "old_api": null,
          "new_api": "ZSTD_getErrorName",
          "old_text": null,
          "new_text": "ZSTD_getErrorName(remainingToFlush)",
          "old_line_content": "            cSize = outBuff.pos;",
          "new_line_content": "                           ZSTD_getErrorName(remainingToFlush) );",
          "content_same": false
        },
        {
          "line": 1949,
          "old_api": null,
          "new_api": "XXH64_digest",
          "old_text": null,
          "new_text": "XXH64_digest(&xxhState)",
          "old_line_content": "        }",
          "new_line_content": "            crcOrig = XXH64_digest(&xxhState);",
          "content_same": false
        },
        {
          "line": 2206,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(0)",
          "old_line_content": "",
          "new_line_content": "            assert(0);   /* impossible */",
          "content_same": false
        },
        {
          "line": 1824,
          "old_api": null,
          "new_api": "FUZ_rand",
          "old_text": null,
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "",
          "new_line_content": "                cParams.targetLength = (U32)((cParams.targetLength + 1 ) * (0.5 + ((double)(FUZ_rand(&lseed) & 127) / 128)));",
          "content_same": false
        },
        {
          "line": 2081,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(argument != NULL)",
          "old_line_content": "        if (argument[0]=='-') {",
          "new_line_content": "        assert(argument != NULL);",
          "content_same": false
        },
        {
          "line": 2212,
          "old_api": null,
          "new_api": "DISPLAY",
          "old_text": null,
          "new_text": "DISPLAY(\"Press Enter \\n\")",
          "old_line_content": "    }",
          "new_line_content": "        DISPLAY(\"Press Enter \\n\");",
          "content_same": false
        },
        {
          "line": 2213,
          "old_api": null,
          "new_api": "getchar",
          "old_text": null,
          "new_text": "getchar()",
          "old_line_content": "    return result;",
          "new_line_content": "        unused = getchar();",
          "content_same": false
        },
        {
          "line": 2086,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(argument, \"--mt\")",
          "old_line_content": "",
          "new_line_content": "            if (!strcmp(argument, \"--mt\")) { selected_api=mt_api; testNb += !testNb; continue; }",
          "content_same": false
        },
        {
          "line": 2087,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(argument, \"--newapi\")",
          "old_line_content": "            argument++;",
          "new_line_content": "            if (!strcmp(argument, \"--newapi\")) { selected_api=advanced_api; testNb += !testNb; continue; }",
          "content_same": false
        },
        {
          "line": 2088,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(argument, \"--no-big-tests\")",
          "old_line_content": "            while (*argument!=0) {",
          "new_line_content": "            if (!strcmp(argument, \"--no-big-tests\")) { bigTests=0; continue; }",
          "content_same": false
        },
        {
          "line": 1829,
          "old_api": null,
          "new_api": "setCCtxParameter",
          "old_text": null,
          "new_text": "setCCtxParameter(zc, cctxParams, ZSTD_p_windowLog, cParams.windowLog, opaqueAPI)",
          "old_line_content": "                    windowLogMalus = (cParams.windowLog - ZSTD_WINDOWLOG_MIN) / 5;",
          "new_line_content": "                    CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_windowLog, cParams.windowLog, opaqueAPI) );",
          "content_same": false
        },
        {
          "line": 1830,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(cParams.windowLog >= ZSTD_WINDOWLOG_MIN)",
          "old_line_content": "                }",
          "new_line_content": "                    assert(cParams.windowLog >= ZSTD_WINDOWLOG_MIN);   /* guaranteed by ZSTD_adjustCParams() */",
          "content_same": false
        },
        {
          "line": 1834,
          "old_api": null,
          "new_api": "DISPLAYLEVEL",
          "old_text": null,
          "new_text": "DISPLAYLEVEL(5, \"t%u: hashLog : %u \\n\", testNb, cParams.hashLog)",
          "old_line_content": "                }",
          "new_line_content": "                    DISPLAYLEVEL(5, \"t%u: hashLog : %u \\n\", testNb, cParams.hashLog);",
          "content_same": false
        },
        {
          "line": 1957,
          "old_api": null,
          "new_api": "FUZ_rand",
          "old_text": null,
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "        } else {",
          "new_line_content": "        if (!dictSize /* don't reset if dictionary : could be different */ && (FUZ_rand(&lseed) & 1)) {",
          "content_same": false
        },
        {
          "line": 1958,
          "old_api": null,
          "new_api": "DISPLAYLEVEL",
          "old_text": null,
          "new_text": "DISPLAYLEVEL(5, \"resetting DCtx (dict:%08X) \\n\", (U32)(size_t)dict)",
          "old_line_content": "            if (dictSize)",
          "new_line_content": "            DISPLAYLEVEL(5, \"resetting DCtx (dict:%08X) \\n\", (U32)(size_t)dict);",
          "content_same": false
        },
        {
          "line": 1838,
          "old_api": null,
          "new_api": "DISPLAYLEVEL",
          "old_text": null,
          "new_text": "DISPLAYLEVEL(5, \"t%u: chainLog : %u \\n\", testNb, cParams.chainLog)",
          "old_line_content": "                }",
          "new_line_content": "                    DISPLAYLEVEL(5, \"t%u: chainLog : %u \\n\", testNb, cParams.chainLog);",
          "content_same": false
        },
        {
          "line": 2095,
          "old_api": null,
          "new_api": "FUZ_usage",
          "old_text": null,
          "new_text": "FUZ_usage(programName)",
          "old_line_content": "                    argument++;",
          "new_line_content": "                    return FUZ_usage(programName);",
          "content_same": false
        },
        {
          "line": 1962,
          "old_api": null,
          "new_api": "DISPLAYLEVEL",
          "old_text": null,
          "new_text": "DISPLAYLEVEL(5, \"using dictionary of size %zu \\n\", dictSize)",
          "old_line_content": "        {   size_t decompressionResult = 1;",
          "new_line_content": "                DISPLAYLEVEL(5, \"using dictionary of size %zu \\n\", dictSize);",
          "content_same": false
        },
        {
          "line": 1963,
          "old_api": null,
          "new_api": "ZSTD_initDStream_usingDict",
          "old_text": null,
          "new_text": "ZSTD_initDStream_usingDict(zd, dict, dictSize)",
          "old_line_content": "            ZSTD_inBuffer  inBuff = { cBuffer, cSize, 0 };",
          "new_line_content": "            CHECK_Z( ZSTD_initDStream_usingDict(zd, dict, dictSize) );",
          "content_same": false
        },
        {
          "line": 1842,
          "old_api": null,
          "new_api": "setCCtxParameter",
          "old_text": null,
          "new_text": "setCCtxParameter(zc, cctxParams, ZSTD_p_minMatch, cParams.searchLength, opaqueAPI)",
          "old_line_content": "",
          "new_line_content": "                if (FUZ_rand(&lseed) & 1) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_minMatch, cParams.searchLength, opaqueAPI) );",
          "content_same": false
        },
        {
          "line": 1843,
          "old_api": null,
          "new_api": "setCCtxParameter",
          "old_text": null,
          "new_text": "setCCtxParameter(zc, cctxParams, ZSTD_p_targetLength, cParams.targetLength, opaqueAPI)",
          "old_line_content": "                /* mess with long distance matching parameters */",
          "new_line_content": "                if (FUZ_rand(&lseed) & 1) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_targetLength, cParams.targetLength, opaqueAPI) );",
          "content_same": false
        },
        {
          "line": 1969,
          "old_api": null,
          "new_api": "FUZ_randomLength",
          "old_text": null,
          "new_text": "FUZ_randomLength(&lseed, maxSampleLog)",
          "old_line_content": "                inBuff.size = inBuff.pos + readCSrcSize;",
          "new_line_content": "                size_t const readCSrcSize = FUZ_randomLength(&lseed, maxSampleLog);",
          "content_same": false
        },
        {
          "line": 1970,
          "old_api": null,
          "new_api": "FUZ_randomLength",
          "old_text": null,
          "new_text": "FUZ_randomLength(&lseed, maxSampleLog)",
          "old_line_content": "                outBuff.size = outBuff.pos + dstBuffSize;",
          "new_line_content": "                size_t const randomDstSize = FUZ_randomLength(&lseed, maxSampleLog);",
          "content_same": false
        },
        {
          "line": 1850,
          "old_api": null,
          "new_api": "FUZ_randomClampedLength",
          "old_text": null,
          "new_text": "FUZ_randomClampedLength(&lseed, 0, ZSTD_LDM_BUCKETSIZELOG_MAX)",
          "old_line_content": "                }",
          "new_line_content": "                    if (FUZ_rand(&lseed) & 3) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_ldmBucketSizeLog, FUZ_randomClampedLength(&lseed, 0, ZSTD_LDM_BUCKETSIZELOG_MAX), opaqueAPI) );",
          "content_same": false
        },
        {
          "line": 1851,
          "old_api": null,
          "new_api": "FUZ_randomClampedLength",
          "old_text": null,
          "new_text": "FUZ_randomClampedLength(&lseed, 0, ZSTD_WINDOWLOG_MAX - ZSTD_HASHLOG_MIN)",
          "old_line_content": "",
          "new_line_content": "                    if (FUZ_rand(&lseed) & 3) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_ldmHashEveryLog, FUZ_randomClampedLength(&lseed, 0, ZSTD_WINDOWLOG_MAX - ZSTD_HASHLOG_MIN), opaqueAPI) );",
          "content_same": false
        },
        {
          "line": 1979,
          "old_api": null,
          "new_api": "ZSTD_isError",
          "old_text": null,
          "new_text": "ZSTD_isError(decompressionResult)",
          "old_line_content": "                }",
          "new_line_content": "                if (ZSTD_isError(decompressionResult)) {",
          "content_same": false
        },
        {
          "line": 1857,
          "old_api": null,
          "new_api": "DISPLAYLEVEL",
          "old_text": null,
          "new_text": "DISPLAYLEVEL(5, \"t%u: frame checksum : %u \\n\", testNb, checksumFlag)",
          "old_line_content": "                }",
          "new_line_content": "                    DISPLAYLEVEL(5, \"t%u: frame checksum : %u \\n\", testNb, checksumFlag);",
          "content_same": false
        },
        {
          "line": 1988,
          "old_api": null,
          "new_api": "XXH64",
          "old_text": null,
          "new_text": "XXH64(dstBuffer, totalTestSize, 0)",
          "old_line_content": "        }   }",
          "new_line_content": "            {   U64 const crcDest = XXH64(dstBuffer, totalTestSize, 0);",
          "content_same": false
        },
        {
          "line": 1989,
          "old_api": null,
          "new_api": "findDiff",
          "old_text": null,
          "new_text": "findDiff(copyBuffer, dstBuffer, totalTestSize)",
          "old_line_content": "",
          "new_line_content": "                if (crcDest!=crcOrig) findDiff(copyBuffer, dstBuffer, totalTestSize);",
          "content_same": false
        },
        {
          "line": 1990,
          "old_api": null,
          "new_api": "CHECK (crcDest!=crcOrig, \"decompressed data corrupted\")",
          "old_text": null,
          "new_text": "CHECK (crcDest!=crcOrig, \"decompressed data corrupted\")",
          "old_line_content": "        /*=====   noisy/erroneous src decompression test   =====*/",
          "new_line_content": "                CHECK (crcDest!=crcOrig, \"decompressed data corrupted\");",
          "content_same": false
        },
        {
          "line": 1863,
          "old_api": null,
          "new_api": "DISPLAYLEVEL",
          "old_text": null,
          "new_text": "DISPLAYLEVEL(5, \"t%u: pledgedSrcSize : %u \\n\", testNb, (U32)pledgedSrcSize)",
          "old_line_content": "                }",
          "new_line_content": "                    DISPLAYLEVEL(5, \"t%u: pledgedSrcSize : %u \\n\", testNb, (U32)pledgedSrcSize);",
          "content_same": false
        },
        {
          "line": 1864,
          "old_api": null,
          "new_api": "ZSTD_CCtx_setPledgedSrcSize",
          "old_text": null,
          "new_text": "ZSTD_CCtx_setPledgedSrcSize(zc, pledgedSrcSize)",
          "old_line_content": "",
          "new_line_content": "                    CHECK_Z( ZSTD_CCtx_setPledgedSrcSize(zc, pledgedSrcSize) );",
          "content_same": false
        },
        {
          "line": 1871,
          "old_api": null,
          "new_api": "MIN",
          "old_text": null,
          "new_text": "MIN(nbThreadsAdjusted, nbThreadsMax)",
          "old_line_content": "                    if (nbThreads > 1) {",
          "new_line_content": "                    U32 const nbThreads = MIN(nbThreadsAdjusted, nbThreadsMax);",
          "content_same": false
        },
        {
          "line": 2000,
          "old_api": null,
          "new_api": "FUZ_rand",
          "old_text": null,
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "        }   }",
          "new_line_content": "                size_t const noiseStart = FUZ_rand(&lseed) % (srcBufferSize - noiseSize);",
          "content_same": false
        },
        {
          "line": 2001,
          "old_api": null,
          "new_api": "FUZ_rand",
          "old_text": null,
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "",
          "new_line_content": "                size_t const cStart = FUZ_rand(&lseed) % (cSize - noiseSize);",
          "content_same": false
        },
        {
          "line": 2002,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(cBuffer+cStart, srcBuffer+noiseStart, noiseSize)",
          "old_line_content": "        /* try decompression on noisy data */",
          "new_line_content": "                memcpy(cBuffer+cStart, srcBuffer+noiseStart, noiseSize);",
          "content_same": false
        },
        {
          "line": 1875,
          "old_api": null,
          "new_api": "FUZ_rand",
          "old_text": null,
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                    }",
          "new_line_content": "                        U32 const jobLog = FUZ_rand(&lseed) % (testLog+1);",
          "content_same": false
        },
        {
          "line": 1876,
          "old_api": null,
          "new_api": "FUZ_rand",
          "old_text": null,
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                }",
          "new_line_content": "                        CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_overlapSizeLog, FUZ_rand(&lseed) % 10, opaqueAPI) );",
          "content_same": false
        },
        {
          "line": 1877,
          "old_api": null,
          "new_api": "FUZ_rLogLength",
          "old_text": null,
          "new_text": "FUZ_rLogLength(&lseed, jobLog)",
          "old_line_content": "",
          "new_line_content": "                        CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_jobSize, (U32)FUZ_rLogLength(&lseed, jobLog), opaqueAPI) );",
          "content_same": false
        },
        {
          "line": 2006,
          "old_api": null,
          "new_api": "ZSTD_initDStream",
          "old_text": null,
          "new_text": "ZSTD_initDStream(zd_noise)",
          "old_line_content": "            while (outBuff.pos < dstBufferSize) {",
          "new_line_content": "        CHECK_Z( ZSTD_initDStream(zd_noise) );   /* note : no dictionary */",
          "content_same": false
        },
        {
          "line": 1881,
          "old_api": null,
          "new_api": "FUZ_rand",
          "old_text": null,
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                if (opaqueAPI) {",
          "new_line_content": "                if (FUZ_rand(&lseed) & 1) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_forceMaxWindow, FUZ_rand(&lseed) & 1, opaqueAPI) );",
          "content_same": false
        },
        {
          "line": 2011,
          "old_api": null,
          "new_api": "FUZ_randomLength",
          "old_text": null,
          "new_text": "FUZ_randomLength(&lseed, maxSampleLog)",
          "old_line_content": "                outBuff.size = outBuff.pos + adjustedDstSize;",
          "new_line_content": "                size_t const randomDstSize = FUZ_randomLength(&lseed, maxSampleLog);",
          "content_same": false
        },
        {
          "line": 2012,
          "old_api": null,
          "new_api": "MIN",
          "old_text": null,
          "new_text": "MIN(dstBufferSize - outBuff.pos, randomDstSize)",
          "old_line_content": "                inBuff.size  = inBuff.pos + adjustedCSrcSize;",
          "new_line_content": "                size_t const adjustedDstSize = MIN(dstBufferSize - outBuff.pos, randomDstSize);",
          "content_same": false
        },
        {
          "line": 1885,
          "old_api": null,
          "new_api": "DISPLAYLEVEL",
          "old_text": null,
          "new_text": "DISPLAYLEVEL(5, \"t%u: applying CCtxParams \\n\", testNb)",
          "old_line_content": "",
          "new_line_content": "                    DISPLAYLEVEL(5, \"t%u: applying CCtxParams \\n\", testNb);",
          "content_same": false
        },
        {
          "line": 2016,
          "old_api": null,
          "new_api": "ZSTD_decompressStream",
          "old_text": null,
          "new_text": "ZSTD_decompressStream(zd, &outBuff, &inBuff)",
          "old_line_content": "                    if (outBuff.pos < outBuff.size && inBuff.pos == cSize) break;",
          "new_line_content": "                {   size_t const decompressError = ZSTD_decompressStream(zd, &outBuff, &inBuff);",
          "content_same": false
        },
        {
          "line": 1889,
          "old_api": null,
          "new_api": "FUZ_rand",
          "old_text": null,
          "new_text": "FUZ_rand(&lseed)",
          "old_line_content": "                    } else {",
          "new_line_content": "                if (FUZ_rand(&lseed) & 1) {",
          "content_same": false
        },
        {
          "line": 2017,
          "old_api": null,
          "new_api": "ZSTD_isError",
          "old_text": null,
          "new_text": "ZSTD_isError(decompressError)",
          "old_line_content": "    }   }   }   }",
          "new_line_content": "                    if (ZSTD_isError(decompressError)) break;   /* error correctly detected */",
          "content_same": false
        },
        {
          "line": 1891,
          "old_api": null,
          "new_api": "ZSTD_CCtx_loadDictionary",
          "old_text": null,
          "new_text": "ZSTD_CCtx_loadDictionary(zc, dict, dictSize)",
          "old_line_content": "                    }",
          "new_line_content": "                        CHECK_Z( ZSTD_CCtx_loadDictionary(zc, dict, dictSize) );",
          "content_same": false
        },
        {
          "line": 1893,
          "old_api": null,
          "new_api": "ZSTD_CCtx_loadDictionary_byReference",
          "old_text": null,
          "new_text": "ZSTD_CCtx_loadDictionary_byReference(zc, dict, dictSize)",
          "old_line_content": "                        /* test that compression parameters are rejected (correctly) after loading a non-NULL dictionary */",
          "new_line_content": "                        CHECK_Z( ZSTD_CCtx_loadDictionary_byReference(zc, dict, dictSize) );",
          "content_same": false
        },
        {
          "line": 1901,
          "old_api": null,
          "new_api": "ZSTD_CCtx_setParameter",
          "old_text": null,
          "new_text": "ZSTD_CCtx_setParameter(zc, ZSTD_p_windowLog, cParams.windowLog-1)",
          "old_line_content": "                    }",
          "new_line_content": "                            size_t const setError = ZSTD_CCtx_setParameter(zc, ZSTD_p_windowLog, cParams.windowLog-1);",
          "content_same": false
        },
        {
          "line": 1902,
          "old_api": null,
          "new_api": "ZSTD_isError",
          "old_text": null,
          "new_text": "ZSTD_isError(setError)",
          "old_line_content": "                } else {",
          "new_line_content": "                            CHECK(!ZSTD_isError(setError), \"ZSTD_CCtx_setParameter should have failed\");",
          "content_same": false
        },
        {
          "line": 2033,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(copyBuffer)",
          "old_line_content": "    return result;",
          "new_line_content": "    free(copyBuffer);",
          "content_same": false
        },
        {
          "line": 1906,
          "old_api": null,
          "new_api": "ZSTD_CCtx_refPrefix",
          "old_text": null,
          "new_text": "ZSTD_CCtx_refPrefix(zc, dict, dictSize)",
          "old_line_content": "",
          "new_line_content": "                    CHECK_Z( ZSTD_CCtx_refPrefix(zc, dict, dictSize) );",
          "content_same": false
        },
        {
          "line": 2034,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(cBuffer)",
          "old_line_content": "",
          "new_line_content": "    free(cBuffer);",
          "content_same": false
        },
        {
          "line": 2035,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(dstBuffer)",
          "old_line_content": "_output_error:",
          "new_line_content": "    free(dstBuffer);",
          "content_same": false
        },
        {
          "line": 1913,
          "old_api": null,
          "new_api": "XXH64_reset",
          "old_text": null,
          "new_text": "XXH64_reset(&xxhState, 0)",
          "old_line_content": "                /* compress random chunks into randomly sized dst buffers */",
          "new_line_content": "        XXH64_reset(&xxhState, 0);",
          "content_same": false
        },
        {
          "line": 2171,
          "old_api": null,
          "new_api": "FUZ_usage",
          "old_text": null,
          "new_text": "FUZ_usage(programName)",
          "old_line_content": "",
          "new_line_content": "                    return FUZ_usage(programName);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 2177,
          "old_api": "XXH32",
          "new_api": null,
          "old_text": "XXH32(&t, sizeof(t), 1)",
          "new_text": null,
          "old_line_content": "        U32 const h = XXH32(&t, sizeof(t), 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1923,
          "old_api": "ZSTD_compress_generic",
          "new_api": null,
          "old_text": "ZSTD_compress_generic(zc, &outBuff, &inBuff, flush)",
          "new_text": null,
          "old_line_content": "                CHECK_Z( ZSTD_compress_generic(zc, &outBuff, &inBuff, flush) );",
          "new_line_content": "                ZSTD_inBuffer inBuff = { srcBuffer+srcStart, srcSize, 0 };",
          "content_same": false
        },
        {
          "line": 1924,
          "old_api": "DISPLAYLEVEL",
          "new_api": null,
          "old_text": "DISPLAYLEVEL(6, \"t%u: compress consumed %u bytes (total : %u) ; flush: %u (total : %u) \\n\",\n                    testNb, (U32)inBuff.pos, (U32)(totalTestSize + inBuff.pos), (U32)flush, (U32)outBuff.pos)",
          "new_text": null,
          "old_line_content": "                DISPLAYLEVEL(6, \"t%u: compress consumed %u bytes (total : %u) ; flush: %u (total : %u) \\n\",",
          "new_line_content": "                outBuff.size = outBuff.pos + dstBuffSize;",
          "content_same": false
        },
        {
          "line": 2181,
          "old_api": "DISPLAY",
          "new_api": null,
          "old_text": "DISPLAY(\"Seed = %u\\n\", seed)",
          "new_text": null,
          "old_line_content": "    DISPLAY(\"Seed = %u\\n\", seed);",
          "new_line_content": "        seed = h % 10000;",
          "content_same": false
        },
        {
          "line": 2182,
          "old_api": "DISPLAY",
          "new_api": null,
          "old_text": "DISPLAY(\"Compressibility : %i%%\\n\", proba)",
          "new_text": null,
          "old_line_content": "    if (proba!=FUZ_COMPRESSIBILITY_DEFAULT) DISPLAY(\"Compressibility : %i%%\\n\", proba);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1925,
          "old_api": "U32)(totalTestSize + inBuff.pos)",
          "new_api": null,
          "old_text": "U32)(totalTestSize + inBuff.pos)",
          "new_text": null,
          "old_line_content": "                    testNb, (U32)inBuff.pos, (U32)(totalTestSize + inBuff.pos), (U32)flush, (U32)outBuff.pos);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2187,
          "old_api": "basicUnitTests",
          "new_api": null,
          "old_text": "basicUnitTests(0, ((double)proba) / 100)",
          "new_text": null,
          "old_line_content": "        result = basicUnitTests(0, ((double)proba) / 100);  /* constant seed for predictability */",
          "new_line_content": "    if (nbTests<=0) nbTests=1;",
          "content_same": false
        },
        {
          "line": 1936,
          "old_api": "FUZ_randomLength",
          "new_api": null,
          "old_text": "FUZ_randomLength(&lseed, maxSampleLog+1)",
          "new_text": null,
          "old_line_content": "                    size_t const randomDstSize = FUZ_randomLength(&lseed, maxSampleLog+1);",
          "new_line_content": "            {   size_t remainingToFlush = 1;",
          "content_same": false
        },
        {
          "line": 1937,
          "old_api": "MIN",
          "new_api": null,
          "old_text": "MIN(cBufferSize - cSize, randomDstSize)",
          "new_text": null,
          "old_line_content": "                    size_t const adjustedDstSize = MIN(cBufferSize - cSize, randomDstSize);",
          "new_line_content": "                while (remainingToFlush) {",
          "content_same": false
        },
        {
          "line": 2194,
          "old_api": "fuzzerTests",
          "new_api": null,
          "old_text": "fuzzerTests(seed, nbTests, testNb, ((double)proba) / 100, bigTests)",
          "new_text": null,
          "old_line_content": "            result = fuzzerTests(seed, nbTests, testNb, ((double)proba) / 100, bigTests);",
          "new_line_content": "        switch(selected_api)",
          "content_same": false
        },
        {
          "line": 1813,
          "old_api": "DISPLAYLEVEL",
          "new_api": null,
          "old_text": "DISPLAYLEVEL(5, \"t%u: with dictionary of size : %zu \\n\", testNb, dictSize)",
          "new_text": null,
          "old_line_content": "                    DISPLAYLEVEL(5, \"t%u: with dictionary of size : %zu \\n\", testNb, dictSize);",
          "new_line_content": "                if (dictSize)",
          "content_same": false
        },
        {
          "line": 1941,
          "old_api": "DISPLAYLEVEL",
          "new_api": null,
          "old_text": "DISPLAYLEVEL(6, \"t%u: Total flushed so far : %u bytes \\n\", testNb, (U32)outBuff.pos)",
          "new_text": null,
          "old_line_content": "                    DISPLAYLEVEL(6, \"t%u: Total flushed so far : %u bytes \\n\", testNb, (U32)outBuff.pos);",
          "new_line_content": "                    outBuff.size = outBuff.pos + adjustedDstSize;",
          "content_same": false
        },
        {
          "line": 1816,
          "old_api": "FUZ_rand",
          "new_api": null,
          "old_text": "FUZ_rand(&lseed)",
          "new_text": null,
          "old_line_content": "                cParams.windowLog += (FUZ_rand(&lseed) & 3) - 1;",
          "new_line_content": "                /* mess with compression parameters */",
          "content_same": false
        },
        {
          "line": 1946,
          "old_api": "XXH64_digest",
          "new_api": null,
          "old_text": "XXH64_digest(&xxhState)",
          "new_text": null,
          "old_line_content": "            crcOrig = XXH64_digest(&xxhState);",
          "new_line_content": "                          \"ZSTD_compress_generic w/ ZSTD_e_end error : %s\",",
          "content_same": false
        },
        {
          "line": 1948,
          "old_api": "DISPLAYLEVEL",
          "new_api": null,
          "old_text": "DISPLAYLEVEL(5, \"Frame completed : %zu bytes \\n\", cSize)",
          "new_text": null,
          "old_line_content": "            DISPLAYLEVEL(5, \"Frame completed : %zu bytes \\n\", cSize);",
          "new_line_content": "            }   }",
          "content_same": false
        },
        {
          "line": 2078,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(argument != NULL)",
          "new_text": null,
          "old_line_content": "        assert(argument != NULL);",
          "new_line_content": "    /* Check command line */",
          "content_same": false
        },
        {
          "line": 2209,
          "old_api": "DISPLAY",
          "new_api": null,
          "old_text": "DISPLAY(\"Press Enter \\n\")",
          "new_text": null,
          "old_line_content": "        DISPLAY(\"Press Enter \\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2210,
          "old_api": "getchar",
          "new_api": null,
          "old_text": "getchar()",
          "new_text": null,
          "old_line_content": "        unused = getchar();",
          "new_line_content": "    if (mainPause) {",
          "content_same": false
        },
        {
          "line": 2083,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(argument, \"--mt\")",
          "new_text": null,
          "old_line_content": "            if (!strcmp(argument, \"--mt\")) { selected_api=mt_api; testNb += !testNb; continue; }",
          "new_line_content": "        /* Parsing commands. Aggregated commands are allowed */",
          "content_same": false
        },
        {
          "line": 2084,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(argument, \"--newapi\")",
          "new_text": null,
          "old_line_content": "            if (!strcmp(argument, \"--newapi\")) { selected_api=advanced_api; testNb += !testNb; continue; }",
          "new_line_content": "        if (argument[0]=='-') {",
          "content_same": false
        },
        {
          "line": 2085,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(argument, \"--no-big-tests\")",
          "new_text": null,
          "old_line_content": "            if (!strcmp(argument, \"--no-big-tests\")) { bigTests=0; continue; }",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1826,
          "old_api": "DISPLAYLEVEL",
          "new_api": null,
          "old_text": "DISPLAYLEVEL(5, \"t%u: windowLog : %u \\n\", testNb, cParams.windowLog)",
          "new_text": null,
          "old_line_content": "                    DISPLAYLEVEL(5, \"t%u: windowLog : %u \\n\", testNb, cParams.windowLog);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1831,
          "old_api": "FUZ_rand",
          "new_api": null,
          "old_text": "FUZ_rand(&lseed)",
          "new_text": null,
          "old_line_content": "                if (FUZ_rand(&lseed) & 1) {",
          "new_line_content": "                    windowLogMalus = (cParams.windowLog - ZSTD_WINDOWLOG_MIN) / 5;",
          "content_same": false
        },
        {
          "line": 1832,
          "old_api": "DISPLAYLEVEL",
          "new_api": null,
          "old_text": "DISPLAYLEVEL(5, \"t%u: hashLog : %u \\n\", testNb, cParams.hashLog)",
          "new_text": null,
          "old_line_content": "                    DISPLAYLEVEL(5, \"t%u: hashLog : %u \\n\", testNb, cParams.hashLog);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1955,
          "old_api": "DISPLAYLEVEL",
          "new_api": null,
          "old_text": "DISPLAYLEVEL(5, \"resetting DCtx (dict:%08X) \\n\", (U32)(size_t)dict)",
          "new_text": null,
          "old_line_content": "            DISPLAYLEVEL(5, \"resetting DCtx (dict:%08X) \\n\", (U32)(size_t)dict);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1956,
          "old_api": "ZSTD_resetDStream",
          "new_api": null,
          "old_text": "ZSTD_resetDStream(zd)",
          "new_text": null,
          "old_line_content": "            CHECK_Z( ZSTD_resetDStream(zd) );",
          "new_line_content": "        /* multi - fragments decompression test */",
          "content_same": false
        },
        {
          "line": 1960,
          "old_api": "ZSTD_initDStream_usingDict",
          "new_api": null,
          "old_text": "ZSTD_initDStream_usingDict(zd, dict, dictSize)",
          "new_text": null,
          "old_line_content": "            CHECK_Z( ZSTD_initDStream_usingDict(zd, dict, dictSize) );",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 2092,
          "old_api": "FUZ_usage",
          "new_api": null,
          "old_text": "FUZ_usage(programName)",
          "new_text": null,
          "old_line_content": "                    return FUZ_usage(programName);",
          "new_line_content": "                switch(*argument)",
          "content_same": false
        },
        {
          "line": 1836,
          "old_api": "DISPLAYLEVEL",
          "new_api": null,
          "old_text": "DISPLAYLEVEL(5, \"t%u: chainLog : %u \\n\", testNb, cParams.chainLog)",
          "new_text": null,
          "old_line_content": "                    DISPLAYLEVEL(5, \"t%u: chainLog : %u \\n\", testNb, cParams.chainLog);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1966,
          "old_api": "FUZ_randomLength",
          "new_api": null,
          "old_text": "FUZ_randomLength(&lseed, maxSampleLog)",
          "new_text": null,
          "old_line_content": "                size_t const readCSrcSize = FUZ_randomLength(&lseed, maxSampleLog);",
          "new_line_content": "            ZSTD_inBuffer  inBuff = { cBuffer, cSize, 0 };",
          "content_same": false
        },
        {
          "line": 1967,
          "old_api": "FUZ_randomLength",
          "new_api": null,
          "old_text": "FUZ_randomLength(&lseed, maxSampleLog)",
          "new_text": null,
          "old_line_content": "                size_t const randomDstSize = FUZ_randomLength(&lseed, maxSampleLog);",
          "new_line_content": "            ZSTD_outBuffer outBuff= { dstBuffer, dstBufferSize, 0 };",
          "content_same": false
        },
        {
          "line": 1840,
          "old_api": "setCCtxParameter",
          "new_api": null,
          "old_text": "setCCtxParameter(zc, cctxParams, ZSTD_p_minMatch, cParams.searchLength, opaqueAPI)",
          "new_text": null,
          "old_line_content": "                if (FUZ_rand(&lseed) & 1) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_minMatch, cParams.searchLength, opaqueAPI) );",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1968,
          "old_api": "MIN",
          "new_api": null,
          "old_text": "MIN(dstBufferSize - totalGenSize, randomDstSize)",
          "new_text": null,
          "old_line_content": "                size_t const dstBuffSize = MIN(dstBufferSize - totalGenSize, randomDstSize);",
          "new_line_content": "            for (totalGenSize = 0 ; decompressionResult ; ) {",
          "content_same": false
        },
        {
          "line": 2045,
          "old_api": "DISPLAY",
          "new_api": null,
          "old_text": "DISPLAY( \"Usage :\\n\")",
          "new_text": null,
          "old_line_content": "    DISPLAY( \"Usage :\\n\");",
          "new_line_content": "*********************************************************/",
          "content_same": false
        },
        {
          "line": 1845,
          "old_api": "FUZ_rand",
          "new_api": null,
          "old_text": "FUZ_rand(&lseed)",
          "new_text": null,
          "old_line_content": "                    if (FUZ_rand(&lseed) & 1) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_enableLongDistanceMatching, FUZ_rand(&lseed) & 63, opaqueAPI) );",
          "new_line_content": "                /* mess with long distance matching parameters */",
          "content_same": false
        },
        {
          "line": 1846,
          "old_api": "FUZ_randomClampedLength",
          "new_api": null,
          "old_text": "FUZ_randomClampedLength(&lseed, ZSTD_HASHLOG_MIN, 23)",
          "new_text": null,
          "old_line_content": "                    if (FUZ_rand(&lseed) & 3) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_ldmHashLog, FUZ_randomClampedLength(&lseed, ZSTD_HASHLOG_MIN, 23), opaqueAPI) );",
          "new_line_content": "                if (bigTests) {",
          "content_same": false
        },
        {
          "line": 1973,
          "old_api": "ZSTD_decompressStream",
          "new_api": null,
          "old_text": "ZSTD_decompressStream(zd, &outBuff, &inBuff)",
          "new_text": null,
          "old_line_content": "                decompressionResult = ZSTD_decompressStream(zd, &outBuff, &inBuff);",
          "new_line_content": "                outBuff.size = outBuff.pos + dstBuffSize;",
          "content_same": false
        },
        {
          "line": 1978,
          "old_api": "findDiff",
          "new_api": null,
          "old_text": "findDiff(copyBuffer, dstBuffer, totalTestSize)",
          "new_text": null,
          "old_line_content": "                    findDiff(copyBuffer, dstBuffer, totalTestSize);",
          "new_line_content": "                                (U32)inBuff.pos, (U32)outBuff.pos);",
          "content_same": false
        },
        {
          "line": 1853,
          "old_api": "FUZ_rand",
          "new_api": null,
          "old_text": "FUZ_rand(&lseed)",
          "new_text": null,
          "old_line_content": "                if (FUZ_rand(&lseed) & 1) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1854,
          "old_api": "FUZ_rand",
          "new_api": null,
          "old_text": "FUZ_rand(&lseed)",
          "new_text": null,
          "old_line_content": "                    U32 const checksumFlag = FUZ_rand(&lseed) & 1;",
          "new_line_content": "                /* mess with frame parameters */",
          "content_same": false
        },
        {
          "line": 1985,
          "old_api": "XXH64",
          "new_api": null,
          "old_text": "XXH64(dstBuffer, totalTestSize, 0)",
          "new_text": null,
          "old_line_content": "            {   U64 const crcDest = XXH64(dstBuffer, totalTestSize, 0);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1859,
          "old_api": "FUZ_rand",
          "new_api": null,
          "old_text": "FUZ_rand(&lseed)",
          "new_text": null,
          "old_line_content": "                if (FUZ_rand(&lseed) & 1) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_contentSizeFlag, FUZ_rand(&lseed) & 1, opaqueAPI) );",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1993,
          "old_api": "FUZ_rand",
          "new_api": null,
          "old_text": "FUZ_rand(&lseed)",
          "new_text": null,
          "old_line_content": "        {   U32 const nbNoiseChunks = (FUZ_rand(&lseed) & 7) + 2;",
          "new_line_content": "        /*=====   noisy/erroneous src decompression test   =====*/",
          "content_same": false
        },
        {
          "line": 1866,
          "old_api": "FUZ_rand",
          "new_api": null,
          "old_text": "FUZ_rand(&lseed)",
          "new_text": null,
          "old_line_content": "                {   U32 const nbThreadsCandidate = (FUZ_rand(&lseed) & 4) + 1;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1995,
          "old_api": "FUZ_randomLength",
          "new_api": null,
          "old_text": "FUZ_randomLength(&lseed, maxSampleLog)",
          "new_text": null,
          "old_line_content": "                size_t const randomNoiseSize = FUZ_randomLength(&lseed, maxSampleLog);",
          "new_line_content": "        /* add some noise */",
          "content_same": false
        },
        {
          "line": 1997,
          "old_api": "FUZ_rand",
          "new_api": null,
          "old_text": "FUZ_rand(&lseed)",
          "new_text": null,
          "old_line_content": "                size_t const noiseStart = FUZ_rand(&lseed) % (srcBufferSize - noiseSize);",
          "new_line_content": "            U32 nn; for (nn=0; nn<nbNoiseChunks; nn++) {",
          "content_same": false
        },
        {
          "line": 1870,
          "old_api": "setCCtxParameter",
          "new_api": null,
          "old_text": "setCCtxParameter(zc, cctxParams, ZSTD_p_nbWorkers, nbThreads, opaqueAPI)",
          "new_text": null,
          "old_line_content": "                    CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_nbWorkers, nbThreads, opaqueAPI) );",
          "new_line_content": "                    U32 const nbThreadsAdjusted = (windowLogMalus < nbThreadsCandidate) ? nbThreadsCandidate - windowLogMalus : 1;",
          "content_same": false
        },
        {
          "line": 1874,
          "old_api": "FUZ_rLogLength",
          "new_api": null,
          "old_text": "FUZ_rLogLength(&lseed, jobLog)",
          "new_text": null,
          "old_line_content": "                        CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_jobSize, (U32)FUZ_rLogLength(&lseed, jobLog), opaqueAPI) );",
          "new_line_content": "                    if (nbThreads > 1) {",
          "content_same": false
        },
        {
          "line": 2003,
          "old_api": "ZSTD_initDStream",
          "new_api": null,
          "old_text": "ZSTD_initDStream(zd_noise)",
          "new_text": null,
          "old_line_content": "        CHECK_Z( ZSTD_initDStream(zd_noise) );   /* note : no dictionary */",
          "new_line_content": "        }   }",
          "content_same": false
        },
        {
          "line": 1878,
          "old_api": "FUZ_rand",
          "new_api": null,
          "old_text": "FUZ_rand(&lseed)",
          "new_text": null,
          "old_line_content": "                if (FUZ_rand(&lseed) & 1) CHECK_Z( setCCtxParameter(zc, cctxParams, ZSTD_p_forceMaxWindow, FUZ_rand(&lseed) & 1, opaqueAPI) );",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 2007,
          "old_api": "FUZ_randomLength",
          "new_api": null,
          "old_text": "FUZ_randomLength(&lseed, maxSampleLog)",
          "new_text": null,
          "old_line_content": "                size_t const randomCSrcSize = FUZ_randomLength(&lseed, maxSampleLog);",
          "new_line_content": "        {   ZSTD_inBuffer  inBuff = { cBuffer, cSize, 0 };",
          "content_same": false
        },
        {
          "line": 2008,
          "old_api": "FUZ_randomLength",
          "new_api": null,
          "old_text": "FUZ_randomLength(&lseed, maxSampleLog)",
          "new_text": null,
          "old_line_content": "                size_t const randomDstSize = FUZ_randomLength(&lseed, maxSampleLog);",
          "new_line_content": "            ZSTD_outBuffer outBuff= { dstBuffer, dstBufferSize, 0 };",
          "content_same": false
        },
        {
          "line": 2009,
          "old_api": "MIN",
          "new_api": null,
          "old_text": "MIN(dstBufferSize - outBuff.pos, randomDstSize)",
          "new_text": null,
          "old_line_content": "                size_t const adjustedDstSize = MIN(dstBufferSize - outBuff.pos, randomDstSize);",
          "new_line_content": "            while (outBuff.pos < dstBufferSize) {",
          "content_same": false
        },
        {
          "line": 1882,
          "old_api": "DISPLAYLEVEL",
          "new_api": null,
          "old_text": "DISPLAYLEVEL(5, \"t%u: applying CCtxParams \\n\", testNb)",
          "new_text": null,
          "old_line_content": "                    DISPLAYLEVEL(5, \"t%u: applying CCtxParams \\n\", testNb);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1883,
          "old_api": "ZSTD_CCtx_setParametersUsingCCtxParams",
          "new_api": null,
          "old_text": "ZSTD_CCtx_setParametersUsingCCtxParams(zc, cctxParams)",
          "new_text": null,
          "old_line_content": "                    CHECK_Z (ZSTD_CCtx_setParametersUsingCCtxParams(zc, cctxParams) );",
          "new_line_content": "                /* Apply parameters */",
          "content_same": false
        },
        {
          "line": 2014,
          "old_api": "ZSTD_isError",
          "new_api": null,
          "old_text": "ZSTD_isError(decompressError)",
          "new_text": null,
          "old_line_content": "                    if (ZSTD_isError(decompressError)) break;   /* error correctly detected */",
          "new_line_content": "                outBuff.size = outBuff.pos + adjustedDstSize;",
          "content_same": false
        },
        {
          "line": 1887,
          "old_api": "FUZ_rand",
          "new_api": null,
          "old_text": "FUZ_rand(&lseed)",
          "new_text": null,
          "old_line_content": "                    if (FUZ_rand(&lseed) & 1) {",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1888,
          "old_api": "ZSTD_CCtx_loadDictionary",
          "new_api": null,
          "old_text": "ZSTD_CCtx_loadDictionary(zc, dict, dictSize)",
          "new_text": null,
          "old_line_content": "                        CHECK_Z( ZSTD_CCtx_loadDictionary(zc, dict, dictSize) );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2018,
          "old_api": "DISPLAY",
          "new_api": null,
          "old_text": "DISPLAY(\"\\r%u fuzzer tests completed   \\n\", testNb-1)",
          "new_text": null,
          "old_line_content": "    DISPLAY(\"\\r%u fuzzer tests completed   \\n\", testNb-1);",
          "new_line_content": "                    /* Good so far, but no more progress possible */",
          "content_same": false
        },
        {
          "line": 2022,
          "old_api": "ZSTD_freeDStream",
          "new_api": null,
          "old_text": "ZSTD_freeDStream(zd)",
          "new_text": null,
          "old_line_content": "    ZSTD_freeDStream(zd);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1895,
          "old_api": "ZSTD_CCtx_setParametersUsingCCtxParams",
          "new_api": null,
          "old_text": "ZSTD_CCtx_setParametersUsingCCtxParams(zc, cctxParams)",
          "new_text": null,
          "old_line_content": "                            size_t const setError = ZSTD_CCtx_setParametersUsingCCtxParams(zc, cctxParams);",
          "new_line_content": "                    if (dict && dictSize) {",
          "content_same": false
        },
        {
          "line": 1896,
          "old_api": "ZSTD_isError",
          "new_api": null,
          "old_text": "ZSTD_isError(setError)",
          "new_text": null,
          "old_line_content": "                            CHECK(!ZSTD_isError(setError), \"ZSTD_CCtx_setParametersUsingCCtxParams should have failed\");",
          "new_line_content": "                        /* test that compression parameters are rejected (correctly) after loading a non-NULL dictionary */",
          "content_same": false
        },
        {
          "line": 2023,
          "old_api": "ZSTD_freeDStream",
          "new_api": null,
          "old_text": "ZSTD_freeDStream(zd_noise)",
          "new_text": null,
          "old_line_content": "    ZSTD_freeDStream(zd_noise);",
          "new_line_content": "_cleanup:",
          "content_same": false
        },
        {
          "line": 1903,
          "old_api": "ZSTD_CCtx_refPrefix",
          "new_api": null,
          "old_text": "ZSTD_CCtx_refPrefix(zc, dict, dictSize)",
          "new_text": null,
          "old_line_content": "                    CHECK_Z( ZSTD_CCtx_refPrefix(zc, dict, dictSize) );",
          "new_line_content": "                        }",
          "content_same": false
        },
        {
          "line": 1907,
          "old_api": "getCCtxParams",
          "new_api": null,
          "old_text": "getCCtxParams(zc, &savedParams)",
          "new_text": null,
          "old_line_content": "        CHECK_Z(getCCtxParams(zc, &savedParams));",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 2168,
          "old_api": "FUZ_usage",
          "new_api": null,
          "old_text": "FUZ_usage(programName)",
          "new_text": null,
          "old_line_content": "                    return FUZ_usage(programName);",
          "new_line_content": "                    break;",
          "content_same": false
        },
        {
          "line": 1914,
          "old_api": "FUZ_randomLength",
          "new_api": null,
          "old_text": "FUZ_randomLength(&lseed, maxSampleLog)",
          "new_text": null,
          "old_line_content": "                size_t const randomSrcSize = FUZ_randomLength(&lseed, maxSampleLog);",
          "new_line_content": "        {   ZSTD_outBuffer outBuff = { cBuffer, cBufferSize, 0 } ;",
          "content_same": false
        },
        {
          "line": 1915,
          "old_api": "MIN",
          "new_api": null,
          "old_text": "MIN(maxTestSize-totalTestSize, randomSrcSize)",
          "new_text": null,
          "old_line_content": "                size_t const srcSize = MIN(maxTestSize-totalTestSize, randomSrcSize);",
          "new_line_content": "            for (cSize=0, totalTestSize=0 ; (totalTestSize < maxTestSize) ; ) {",
          "content_same": false
        },
        {
          "line": 1916,
          "old_api": "FUZ_rand",
          "new_api": null,
          "old_text": "FUZ_rand(&lseed)",
          "new_text": null,
          "old_line_content": "                size_t const srcStart = FUZ_rand(&lseed) % (srcBufferSize - srcSize);",
          "new_line_content": "                /* compress random chunks into randomly sized dst buffers */",
          "content_same": false
        },
        {
          "line": 2173,
          "old_api": "DISPLAY",
          "new_api": null,
          "old_text": "DISPLAY(\"Starting zstream tester (%i-bits, %s)\\n\", (int)(sizeof(size_t)*8), ZSTD_VERSION_STRING)",
          "new_text": null,
          "old_line_content": "    DISPLAY(\"Starting zstream tester (%i-bits, %s)\\n\", (int)(sizeof(size_t)*8), ZSTD_VERSION_STRING);",
          "new_line_content": "    }   }   }   /* for(argNb=1; argNb<argc; argNb++) */",
          "content_same": false
        },
        {
          "line": 2046,
          "old_api": "DISPLAY",
          "new_api": null,
          "old_text": "DISPLAY( \"      %s [args]\\n\", programName)",
          "new_text": null,
          "old_line_content": "    DISPLAY( \"      %s [args]\\n\", programName);",
          "new_line_content": "static int FUZ_usage(const char* programName)",
          "content_same": false
        },
        {
          "line": 2047,
          "old_api": "DISPLAY",
          "new_api": null,
          "old_text": "DISPLAY( \"\\n\")",
          "new_text": null,
          "old_line_content": "    DISPLAY( \"\\n\");",
          "new_line_content": "{",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 55,
      "total_additions": 74,
      "total_deletions": 72,
      "total_api_changes": 201
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 9,
        "api_related_lines": 201,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          1815
        ]
      }
    },
    "api_calls_before": 1047,
    "api_calls_after": 1049,
    "diff_info": {
      "added_lines": 7,
      "removed_lines": 4,
      "total_diff_lines": 63
    }
  }
}