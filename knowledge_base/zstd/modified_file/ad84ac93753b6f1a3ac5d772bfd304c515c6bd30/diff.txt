diff --git a/programs/bench.c b/programs/bench.c
index cc135602..676b0395 100644
--- a/programs/bench.c
+++ b/programs/bench.c
@@ -222,7 +222,7 @@ static int BMK_benchMem(const void* srcBuffer, size_t srcSize,
     const size_t blockSize = (g_blockSize ? g_blockSize : srcSize) + (!srcSize);   /* avoid div by 0 */
     const U32 maxNbBlocks = (U32) ((srcSize + (blockSize-1)) / blockSize) + nbFiles;
     blockParam_t* const blockTable = (blockParam_t*) malloc(maxNbBlocks * sizeof(blockParam_t));
-    const size_t maxCompressedSize = (size_t)maxNbBlocks * ZSTD_compressBound(blockSize);
+    const size_t maxCompressedSize = ZSTD_compressBound(srcSize) + (maxNbBlocks * 512);   /* add some room for safety */
     void* const compressedBuffer = malloc(maxCompressedSize);
     void* const resultBuffer = malloc(srcSize);
     const compressor_t compressor = ZSTD_compress;
