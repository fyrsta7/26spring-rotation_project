{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/zstd/modified_file/b048af5999061a41e68d1083ef7b0ab2fe75e29d",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/zstd/modified_file/b048af5999061a41e68d1083ef7b0ab2fe75e29d/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/zstd/modified_file/b048af5999061a41e68d1083ef7b0ab2fe75e29d/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/zstd/modified_file/b048af5999061a41e68d1083ef7b0ab2fe75e29d/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 133,
          "old_api": "MEM_read32",
          "new_api": "assert",
          "old_text": "MEM_read32(ip)",
          "new_text": "assert(stepSize >= 1)",
          "old_line_content": "                    MEM_read32(dictMatch) != MEM_read32(ip)) {",
          "new_line_content": "                    assert(stepSize >= 1);",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": "U32)(current-dictMatchIndex-dictIndexDelta)",
          "new_api": "ZSTD_count_2segments",
          "old_text": "U32)(current-dictMatchIndex-dictIndexDelta)",
          "new_text": "ZSTD_count_2segments(ip+4, dictMatch+4, iend, dictEnd, prefixStart)",
          "old_line_content": "                    U32 const offset = (U32)(current-dictMatchIndex-dictIndexDelta);",
          "new_line_content": "                    mLength = ZSTD_count_2segments(ip+4, dictMatch+4, iend, dictEnd, prefixStart) + 4;",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": "ZSTD_storeSeq",
          "new_api": "MEM_read32",
          "old_text": "ZSTD_storeSeq(seqStore, 0, anchor, 0, repLength2-MINMATCH)",
          "new_text": "MEM_read32(ip)",
          "old_line_content": "                        ZSTD_storeSeq(seqStore, 0, anchor, 0, repLength2-MINMATCH);",
          "new_line_content": "                       && (MEM_read32(repMatch2) == MEM_read32(ip)) ) {",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": "U32)(ip-base)",
          "new_api": "MEM_read32",
          "old_text": "U32)(ip-base)",
          "new_text": "MEM_read32(ip - offset_2)",
          "old_line_content": "                    hashTable[ZSTD_hashPtr(ip, hlog, mls)] = (U32)(ip-base);",
          "new_line_content": "                        & (MEM_read32(ip) == MEM_read32(ip - offset_2)) )) {",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": "U32)(ip-base)",
          "new_api": "ZSTD_hashPtr",
          "old_text": "U32)(ip-base)",
          "new_text": "ZSTD_hashPtr(ip, hlog, mls)",
          "old_line_content": "        const U32    current = (U32)(ip-base);",
          "new_line_content": "        const size_t h = ZSTD_hashPtr(ip, hlog, mls);",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": "ZSTD_storeSeq",
          "new_api": "MEM_read32",
          "old_text": "ZSTD_storeSeq(seqStore, ip-anchor, anchor, 0, mLength-MINMATCH)",
          "new_text": "MEM_read32(ip+1)",
          "old_line_content": "            ZSTD_storeSeq(seqStore, ip-anchor, anchor, 0, mLength-MINMATCH);",
          "new_line_content": "           && (MEM_read32(repMatch) == MEM_read32(ip+1)) ) {",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": "assert",
          "new_api": "ZSTD_storeSeq",
          "old_text": "assert(stepSize >= 1)",
          "new_text": "ZSTD_storeSeq(seqStore, ip-anchor, anchor, 0, mLength-MINMATCH)",
          "old_line_content": "                assert(stepSize >= 1);",
          "new_line_content": "            ZSTD_storeSeq(seqStore, ip-anchor, anchor, 0, mLength-MINMATCH);",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": "U32)(ip-base)",
          "new_api": "ZSTD_hashPtr",
          "old_text": "U32)(ip-base)",
          "new_text": "ZSTD_hashPtr(base+current+2, hlog, mls)",
          "old_line_content": "                U32 const current2 = (U32)(ip-base);",
          "new_line_content": "            hashTable[ZSTD_hashPtr(base+current+2, hlog, mls)] = current+2;",
          "content_same": false
        },
        {
          "line": 339,
          "old_api": "MEM_read32",
          "new_api": "U32)(ip-base)",
          "old_text": "MEM_read32(ip)",
          "new_text": "U32)(ip-base)",
          "old_line_content": "                   && (MEM_read32(repMatch2) == MEM_read32(ip)) ) {",
          "new_line_content": "                U32 const current2 = (U32)(ip-base);",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": "ZSTD_storeSeq",
          "new_api": "MEM_read32",
          "old_text": "ZSTD_storeSeq(seqStore, 0, anchor, 0, repLength2-MINMATCH)",
          "new_text": "MEM_read32(ip)",
          "old_line_content": "                    ZSTD_storeSeq(seqStore, 0, anchor, 0, repLength2-MINMATCH);",
          "new_line_content": "                   && (MEM_read32(repMatch2) == MEM_read32(ip)) ) {",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 132,
          "old_api": null,
          "new_api": "MEM_read32",
          "old_text": null,
          "new_text": "MEM_read32(ip)",
          "old_line_content": "                if (dictMatchIndex <= dictStartIndex ||",
          "new_line_content": "                    MEM_read32(dictMatch) != MEM_read32(ip)) {",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": null,
          "new_api": "ZSTD_compressBlock_fast_generic",
          "old_text": null,
          "new_text": "ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 6, ZSTD_dictMatchState)",
          "old_line_content": "}",
          "new_line_content": "        return ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 6, ZSTD_dictMatchState);",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": null,
          "new_api": "ZSTD_compressBlock_fast_generic",
          "old_text": null,
          "new_text": "ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 7, ZSTD_dictMatchState)",
          "old_line_content": "",
          "new_line_content": "        return ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 7, ZSTD_dictMatchState);",
          "content_same": false
        },
        {
          "line": 138,
          "old_api": null,
          "new_api": "U32)(current-dictMatchIndex-dictIndexDelta)",
          "old_text": null,
          "new_text": "U32)(current-dictMatchIndex-dictIndexDelta)",
          "old_line_content": "                    /* found a dict match */",
          "new_line_content": "                    U32 const offset = (U32)(current-dictMatchIndex-dictIndexDelta);",
          "content_same": false
        },
        {
          "line": 146,
          "old_api": null,
          "new_api": "ZSTD_storeSeq",
          "old_text": null,
          "new_text": "ZSTD_storeSeq(seqStore, ip-anchor, anchor, offset + ZSTD_REP_MOVE, mLength-MINMATCH)",
          "old_line_content": "                    offset_1 = offset;",
          "new_line_content": "                    ZSTD_storeSeq(seqStore, ip-anchor, anchor, offset + ZSTD_REP_MOVE, mLength-MINMATCH);",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(stepSize >= 1)",
          "old_line_content": "            } else {",
          "new_line_content": "                assert(stepSize >= 1);",
          "content_same": false
        },
        {
          "line": 153,
          "old_api": null,
          "new_api": "MEM_read32",
          "old_text": null,
          "new_text": "MEM_read32(ip)",
          "old_line_content": "            }",
          "new_line_content": "        } else if (MEM_read32(match) != MEM_read32(ip)) {",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(stepSize >= 1)",
          "old_line_content": "            /* found a regular match */",
          "new_line_content": "            assert(stepSize >= 1);",
          "content_same": false
        },
        {
          "line": 160,
          "old_api": null,
          "new_api": "U32)(ip-match)",
          "old_text": null,
          "new_text": "U32)(ip-match)",
          "old_line_content": "            offset_2 = offset_1;",
          "new_line_content": "            U32 const offset = (U32)(ip-match);",
          "content_same": false
        },
        {
          "line": 161,
          "old_api": null,
          "new_api": "ZSTD_count",
          "old_text": null,
          "new_text": "ZSTD_count(ip+4, match+4, iend)",
          "old_line_content": "            offset_1 = offset;",
          "new_line_content": "            mLength = ZSTD_count(ip+4, match+4, iend) + 4;",
          "content_same": false
        },
        {
          "line": 166,
          "old_api": null,
          "new_api": "ZSTD_storeSeq",
          "old_text": null,
          "new_text": "ZSTD_storeSeq(seqStore, ip-anchor, anchor, offset + ZSTD_REP_MOVE, mLength-MINMATCH)",
          "old_line_content": "        ip += mLength;",
          "new_line_content": "            ZSTD_storeSeq(seqStore, ip-anchor, anchor, offset + ZSTD_REP_MOVE, mLength-MINMATCH);",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": null,
          "new_api": "U32)(ip-base)",
          "old_text": null,
          "new_text": "U32)(ip-base)",
          "old_line_content": "        size_t mLength;",
          "new_line_content": "        const U32    current = (U32)(ip-base);",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": null,
          "new_api": "ZSTD_hashPtr",
          "old_text": null,
          "new_text": "ZSTD_hashPtr(base+current+2, hlog, mls)",
          "old_line_content": "            if (dictMode == ZSTD_dictMatchState) {",
          "new_line_content": "            hashTable[ZSTD_hashPtr(base+current+2, hlog, mls)] = current+2;  /* here because current+2 could be > iend-8 */",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": null,
          "new_api": "U32)(ip-2-base)",
          "old_text": null,
          "new_text": "U32)(ip-2-base)",
          "old_line_content": "                while (ip <= ilimit) {",
          "new_line_content": "            hashTable[ZSTD_hashPtr(ip-2, hlog, mls)] = (U32)(ip-2-base);",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(offset_1 <= current +1)",
          "old_line_content": "            const BYTE* repMatchEnd = repIndex < prefixStartIndex ? dictEnd : iend;",
          "new_line_content": "        assert(offset_1 <= current +1);   /* check repIndex */",
          "content_same": false
        },
        {
          "line": 305,
          "old_api": null,
          "new_api": "U32)((prefixStartIndex-1) - repIndex)",
          "old_text": null,
          "new_text": "U32)((prefixStartIndex-1) - repIndex)",
          "old_line_content": "            ip++;",
          "new_line_content": "        if ( (((U32)((prefixStartIndex-1) - repIndex) >= 3) /* intentional underflow */ & (repIndex > dictStartIndex))",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": null,
          "new_api": "ZSTD_count_2segments",
          "old_text": null,
          "new_text": "ZSTD_count_2segments(ip+1+4, repMatch+4, iend, repMatchEnd, prefixStart)",
          "old_line_content": "            if ( (matchIndex < dictStartIndex) ||",
          "new_line_content": "            mLength = ZSTD_count_2segments(ip+1+4, repMatch+4, iend, repMatchEnd, prefixStart) + 4;",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": null,
          "new_api": "U32)(ip-base)",
          "old_text": null,
          "new_text": "U32)(ip-base)",
          "old_line_content": "                            base + repIndex2;",
          "new_line_content": "                    U32 const current2 = (U32)(ip-base);",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": null,
          "new_api": "MEM_read32",
          "old_text": null,
          "new_text": "MEM_read32(ip)",
          "old_line_content": "            }",
          "new_line_content": "                 (MEM_read32(match) != MEM_read32(ip)) ) {",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": null,
          "new_api": "U32)((prefixStartIndex-1) - (U32)repIndex2)",
          "old_text": null,
          "new_text": "U32)((prefixStartIndex-1) - (U32)repIndex2)",
          "old_line_content": "                        U32 tmpOffset = offset_2; offset_2 = offset_1; offset_1 = tmpOffset;   /* swap offset_2 <=> offset_1 */",
          "new_line_content": "                    if ( ((U32)((prefixStartIndex-1) - (U32)repIndex2) >= 3 /* intentional overflow */)",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(stepSize >= 1)",
          "old_line_content": "            {   const BYTE* matchEnd = matchIndex < prefixStartIndex ? dictEnd : iend;",
          "new_line_content": "                assert(stepSize >= 1);",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": null,
          "new_api": "ZSTD_count_2segments",
          "old_text": null,
          "new_text": "ZSTD_count_2segments(ip+4, repMatch2+4, iend, repEnd2, prefixStart)",
          "old_line_content": "                        ip += repLength2;",
          "new_line_content": "                        size_t const repLength2 = ZSTD_count_2segments(ip+4, repMatch2+4, iend, repEnd2, prefixStart) + 4;",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": null,
          "new_api": "ZSTD_storeSeq",
          "old_text": null,
          "new_text": "ZSTD_storeSeq(seqStore, 0, anchor, 0, repLength2-MINMATCH)",
          "old_line_content": "                        continue;",
          "new_line_content": "                        ZSTD_storeSeq(seqStore, 0, anchor, 0, repLength2-MINMATCH);",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": null,
          "new_api": "ZSTD_hashPtr",
          "old_text": null,
          "new_text": "ZSTD_hashPtr(ip, hlog, mls)",
          "old_line_content": "                    }",
          "new_line_content": "                        hashTable[ZSTD_hashPtr(ip, hlog, mls)] = current2;",
          "content_same": false
        },
        {
          "line": 321,
          "old_api": null,
          "new_api": "ZSTD_count_2segments",
          "old_text": null,
          "new_text": "ZSTD_count_2segments(ip+4, match+4, iend, matchEnd, prefixStart)",
          "old_line_content": "                offset_1 = offset;",
          "new_line_content": "                mLength = ZSTD_count_2segments(ip+4, match+4, iend, matchEnd, prefixStart) + 4;",
          "content_same": false
        },
        {
          "line": 326,
          "old_api": null,
          "new_api": "ZSTD_storeSeq",
          "old_text": null,
          "new_text": "ZSTD_storeSeq(seqStore, ip-anchor, anchor, offset + ZSTD_REP_MOVE, mLength-MINMATCH)",
          "old_line_content": "        ip += mLength;",
          "new_line_content": "                ZSTD_storeSeq(seqStore, ip-anchor, anchor, offset + ZSTD_REP_MOVE, mLength-MINMATCH);",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": null,
          "new_api": "ZSTD_count",
          "old_text": null,
          "new_text": "ZSTD_count(ip+4, ip+4-offset_2, iend)",
          "old_line_content": "                    ip += rLength;",
          "new_line_content": "                    size_t const rLength = ZSTD_count(ip+4, ip+4-offset_2, iend) + 4;",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": null,
          "new_api": "U32)(ip-base)",
          "old_text": null,
          "new_text": "U32)(ip-base)",
          "old_line_content": "                    continue;   /* faster when present ... (?) */",
          "new_line_content": "                    hashTable[ZSTD_hashPtr(ip, hlog, mls)] = (U32)(ip-base);",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": null,
          "new_api": "ZSTD_storeSeq",
          "old_text": null,
          "new_text": "ZSTD_storeSeq(seqStore, 0, anchor, 0, rLength-MINMATCH)",
          "old_line_content": "    }   }   }   }",
          "new_line_content": "                    ZSTD_storeSeq(seqStore, 0, anchor, 0, rLength-MINMATCH);",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": null,
          "new_api": "U32)(ip-2-base)",
          "old_text": null,
          "new_text": "U32)(ip-2-base)",
          "old_line_content": "                U32 const repIndex2 = current2 - offset_2;",
          "new_line_content": "            hashTable[ZSTD_hashPtr(ip-2, hlog, mls)] = (U32)(ip-2-base);",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": null,
          "new_api": "U32)((prefixStartIndex-1) - repIndex2)",
          "old_text": null,
          "new_text": "U32)((prefixStartIndex-1) - repIndex2)",
          "old_line_content": "                    U32 tmpOffset = offset_2; offset_2 = offset_1; offset_1 = tmpOffset;   /* swap offset_2 <=> offset_1 */",
          "new_line_content": "                if ( (((U32)((prefixStartIndex-1) - repIndex2) >= 3) & (repIndex2 > dictStartIndex))  /* intentional overflow */",
          "content_same": false
        },
        {
          "line": 345,
          "old_api": null,
          "new_api": "ZSTD_count_2segments",
          "old_text": null,
          "new_text": "ZSTD_count_2segments(ip+4, repMatch2+4, iend, repEnd2, prefixStart)",
          "old_line_content": "                    ip += repLength2;",
          "new_line_content": "                    size_t const repLength2 = ZSTD_count_2segments(ip+4, repMatch2+4, iend, repEnd2, prefixStart) + 4;",
          "content_same": false
        },
        {
          "line": 347,
          "old_api": null,
          "new_api": "ZSTD_storeSeq",
          "old_text": null,
          "new_text": "ZSTD_storeSeq(seqStore, 0, anchor, 0, repLength2-MINMATCH)",
          "old_line_content": "                    continue;",
          "new_line_content": "                    ZSTD_storeSeq(seqStore, 0, anchor, 0, repLength2-MINMATCH);",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": null,
          "new_api": "ZSTD_hashPtr",
          "old_text": null,
          "new_text": "ZSTD_hashPtr(ip, hlog, mls)",
          "old_line_content": "                }",
          "new_line_content": "                    hashTable[ZSTD_hashPtr(ip, hlog, mls)] = current2;",
          "content_same": false
        },
        {
          "line": 231,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(ms->dictMatchState == NULL)",
          "old_line_content": "    case 4 :",
          "new_line_content": "    assert(ms->dictMatchState == NULL);",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": null,
          "new_api": "ZSTD_compressBlock_fast_generic",
          "old_text": null,
          "new_text": "ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 6, ZSTD_noDict)",
          "old_line_content": "}",
          "new_line_content": "        return ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 6, ZSTD_noDict);",
          "content_same": false
        },
        {
          "line": 242,
          "old_api": null,
          "new_api": "ZSTD_compressBlock_fast_generic",
          "old_text": null,
          "new_text": "ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 7, ZSTD_noDict)",
          "old_line_content": "size_t ZSTD_compressBlock_fast_dictMatchState(",
          "new_line_content": "        return ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 7, ZSTD_noDict);",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": null,
          "new_api": "ZSTD_compressBlock_fast_extDict_generic",
          "old_text": null,
          "new_text": "ZSTD_compressBlock_fast_extDict_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 6)",
          "old_line_content": "}",
          "new_line_content": "        return ZSTD_compressBlock_fast_extDict_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 6);",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(ms->dictMatchState != NULL)",
          "old_line_content": "    case 4 :",
          "new_line_content": "    assert(ms->dictMatchState != NULL);",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": null,
          "new_api": "ZSTD_compressBlock_fast_extDict_generic",
          "old_text": null,
          "new_text": "ZSTD_compressBlock_fast_extDict_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 7)",
          "old_line_content": "",
          "new_line_content": "        return ZSTD_compressBlock_fast_extDict_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 7);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 128,
          "old_api": "MEM_read32",
          "new_api": null,
          "old_text": "MEM_read32(ip)",
          "new_text": null,
          "old_line_content": "                 || (MEM_read32(match) != MEM_read32(ip)) ) {",
          "new_line_content": "            if (dictMode == ZSTD_dictMatchState) {",
          "content_same": false
        },
        {
          "line": 256,
          "old_api": "ZSTD_compressBlock_fast_generic",
          "new_api": null,
          "old_text": "ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 5, ZSTD_dictMatchState)",
          "new_text": null,
          "old_line_content": "        return ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 5, ZSTD_dictMatchState);",
          "new_line_content": "    default: /* includes case 3 */",
          "content_same": false
        },
        {
          "line": 134,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(stepSize >= 1)",
          "new_text": null,
          "old_line_content": "                    assert(stepSize >= 1);",
          "new_line_content": "                    ip += ((ip-anchor) >> kSearchStrength) + stepSize;",
          "content_same": false
        },
        {
          "line": 140,
          "old_api": "ZSTD_count_2segments",
          "new_api": null,
          "old_text": "ZSTD_count_2segments(ip+4, dictMatch+4, iend, dictEnd, prefixStart)",
          "new_text": null,
          "old_line_content": "                    mLength = ZSTD_count_2segments(ip+4, dictMatch+4, iend, dictEnd, prefixStart) + 4;",
          "new_line_content": "                    while (((ip>anchor) & (dictMatch>dictStart))",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "ZSTD_storeSeq",
          "new_api": null,
          "old_text": "ZSTD_storeSeq(seqStore, ip-anchor, anchor, offset + ZSTD_REP_MOVE, mLength-MINMATCH)",
          "new_text": null,
          "old_line_content": "                    ZSTD_storeSeq(seqStore, ip-anchor, anchor, offset + ZSTD_REP_MOVE, mLength-MINMATCH);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(stepSize >= 1)",
          "new_text": null,
          "old_line_content": "                assert(stepSize >= 1);",
          "new_line_content": "                ip += ((ip-anchor) >> kSearchStrength) + stepSize;",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": "U32)(ip-match)",
          "new_api": null,
          "old_text": "U32)(ip-match)",
          "new_text": null,
          "old_line_content": "            U32 const offset = (U32)(ip-match);",
          "new_line_content": "            ip += ((ip-anchor) >> kSearchStrength) + stepSize;",
          "content_same": false
        },
        {
          "line": 157,
          "old_api": "ZSTD_count",
          "new_api": null,
          "old_text": "ZSTD_count(ip+4, match+4, iend)",
          "new_text": null,
          "old_line_content": "            mLength = ZSTD_count(ip+4, match+4, iend) + 4;",
          "new_line_content": "            continue;",
          "content_same": false
        },
        {
          "line": 289,
          "old_api": "ZSTD_hashPtr",
          "new_api": null,
          "old_text": "ZSTD_hashPtr(ip, hlog, mls)",
          "new_text": null,
          "old_line_content": "        const size_t h = ZSTD_hashPtr(ip, hlog, mls);",
          "new_line_content": "    stepSize += !stepSize;   /* support stepSize == 0 */",
          "content_same": false
        },
        {
          "line": 162,
          "old_api": "ZSTD_storeSeq",
          "new_api": null,
          "old_text": "ZSTD_storeSeq(seqStore, ip-anchor, anchor, offset + ZSTD_REP_MOVE, mLength-MINMATCH)",
          "new_text": null,
          "old_line_content": "            ZSTD_storeSeq(seqStore, ip-anchor, anchor, offset + ZSTD_REP_MOVE, mLength-MINMATCH);",
          "new_line_content": "            while (((ip>anchor) & (match>prefixStart))",
          "content_same": false
        },
        {
          "line": 171,
          "old_api": "ZSTD_hashPtr",
          "new_api": null,
          "old_text": "ZSTD_hashPtr(base+current+2, hlog, mls)",
          "new_text": null,
          "old_line_content": "            hashTable[ZSTD_hashPtr(base+current+2, hlog, mls)] = current+2;  /* here because current+2 could be > iend-8 */",
          "new_line_content": "        anchor = ip;",
          "content_same": false
        },
        {
          "line": 172,
          "old_api": "U32)(ip-2-base)",
          "new_api": null,
          "old_text": "U32)(ip-2-base)",
          "new_text": null,
          "old_line_content": "            hashTable[ZSTD_hashPtr(ip-2, hlog, mls)] = (U32)(ip-2-base);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(offset_1 <= current +1)",
          "new_text": null,
          "old_line_content": "        assert(offset_1 <= current +1);   /* check repIndex */",
          "new_line_content": "        const BYTE* const repBase = repIndex < prefixStartIndex ? dictBase : base;",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": "U32)((prefixStartIndex-1) - repIndex)",
          "new_api": null,
          "old_text": "U32)((prefixStartIndex-1) - repIndex)",
          "new_text": null,
          "old_line_content": "        if ( (((U32)((prefixStartIndex-1) - repIndex) >= 3) /* intentional underflow */ & (repIndex > dictStartIndex))",
          "new_line_content": "        size_t mLength;",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": "MEM_read32",
          "new_api": null,
          "old_text": "MEM_read32(ip+1)",
          "new_text": null,
          "old_line_content": "           && (MEM_read32(repMatch) == MEM_read32(ip+1)) ) {",
          "new_line_content": "        hashTable[h] = current;   /* update hash table */",
          "content_same": false
        },
        {
          "line": 304,
          "old_api": "ZSTD_count_2segments",
          "new_api": null,
          "old_text": "ZSTD_count_2segments(ip+1+4, repMatch+4, iend, repMatchEnd, prefixStart)",
          "new_text": null,
          "old_line_content": "            mLength = ZSTD_count_2segments(ip+1+4, repMatch+4, iend, repMatchEnd, prefixStart) + 4;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 177,
          "old_api": "U32)(ip-base)",
          "new_api": null,
          "old_text": "U32)(ip-base)",
          "new_text": null,
          "old_line_content": "                    U32 const current2 = (U32)(ip-base);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": "MEM_read32",
          "new_api": null,
          "old_text": "MEM_read32(ip)",
          "new_text": null,
          "old_line_content": "                 (MEM_read32(match) != MEM_read32(ip)) ) {",
          "new_line_content": "            ip++;",
          "content_same": false
        },
        {
          "line": 182,
          "old_api": "U32)((prefixStartIndex-1) - (U32)repIndex2)",
          "new_api": null,
          "old_text": "U32)((prefixStartIndex-1) - (U32)repIndex2)",
          "new_text": null,
          "old_line_content": "                    if ( ((U32)((prefixStartIndex-1) - (U32)repIndex2) >= 3 /* intentional overflow */)",
          "new_line_content": "                    U32 const repIndex2 = current2 - offset_2;",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": "MEM_read32",
          "new_api": null,
          "old_text": "MEM_read32(ip)",
          "new_text": null,
          "old_line_content": "                       && (MEM_read32(repMatch2) == MEM_read32(ip)) ) {",
          "new_line_content": "                    const BYTE* repMatch2 = repIndex2 < prefixStartIndex ?",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": "ZSTD_count_2segments",
          "new_api": null,
          "old_text": "ZSTD_count_2segments(ip+4, repMatch2+4, iend, repEnd2, prefixStart)",
          "new_text": null,
          "old_line_content": "                        size_t const repLength2 = ZSTD_count_2segments(ip+4, repMatch2+4, iend, repEnd2, prefixStart) + 4;",
          "new_line_content": "                            base + repIndex2;",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "ZSTD_hashPtr",
          "new_api": null,
          "old_text": "ZSTD_hashPtr(ip, hlog, mls)",
          "new_text": null,
          "old_line_content": "                        hashTable[ZSTD_hashPtr(ip, hlog, mls)] = current2;",
          "new_line_content": "                        const BYTE* const repEnd2 = repIndex2 < prefixStartIndex ? dictEnd : iend;",
          "content_same": false
        },
        {
          "line": 317,
          "old_api": "ZSTD_count_2segments",
          "new_api": null,
          "old_text": "ZSTD_count_2segments(ip+4, match+4, iend, matchEnd, prefixStart)",
          "new_text": null,
          "old_line_content": "                mLength = ZSTD_count_2segments(ip+4, match+4, iend, matchEnd, prefixStart) + 4;",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": "ZSTD_storeSeq",
          "new_api": null,
          "old_text": "ZSTD_storeSeq(seqStore, ip-anchor, anchor, offset + ZSTD_REP_MOVE, mLength-MINMATCH)",
          "new_text": null,
          "old_line_content": "                ZSTD_storeSeq(seqStore, ip-anchor, anchor, offset + ZSTD_REP_MOVE, mLength-MINMATCH);",
          "new_line_content": "                while (((ip>anchor) & (match>lowMatchPtr)) && (ip[-1] == match[-1])) { ip--; match--; mLength++; }   /* catch up */",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": "MEM_read32",
          "new_api": null,
          "old_text": "MEM_read32(ip - offset_2)",
          "new_text": null,
          "old_line_content": "                        & (MEM_read32(ip) == MEM_read32(ip - offset_2)) )) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": "ZSTD_count",
          "new_api": null,
          "old_text": "ZSTD_count(ip+4, ip+4-offset_2, iend)",
          "new_text": null,
          "old_line_content": "                    size_t const rLength = ZSTD_count(ip+4, ip+4-offset_2, iend) + 4;",
          "new_line_content": "                while ( (ip <= ilimit)",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": "ZSTD_hashPtr",
          "new_api": null,
          "old_text": "ZSTD_hashPtr(base+current+2, hlog, mls)",
          "new_text": null,
          "old_line_content": "            hashTable[ZSTD_hashPtr(base+current+2, hlog, mls)] = current+2;",
          "new_line_content": "        anchor = ip;",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": "U32)(ip-2-base)",
          "new_api": null,
          "old_text": "U32)(ip-2-base)",
          "new_text": null,
          "old_line_content": "            hashTable[ZSTD_hashPtr(ip-2, hlog, mls)] = (U32)(ip-2-base);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "ZSTD_storeSeq",
          "new_api": null,
          "old_text": "ZSTD_storeSeq(seqStore, 0, anchor, 0, rLength-MINMATCH)",
          "new_text": null,
          "old_line_content": "                    ZSTD_storeSeq(seqStore, 0, anchor, 0, rLength-MINMATCH);",
          "new_line_content": "                    /* store sequence */",
          "content_same": false
        },
        {
          "line": 338,
          "old_api": "U32)((prefixStartIndex-1) - repIndex2)",
          "new_api": null,
          "old_text": "U32)((prefixStartIndex-1) - repIndex2)",
          "new_text": null,
          "old_line_content": "                if ( (((U32)((prefixStartIndex-1) - repIndex2) >= 3) & (repIndex2 > dictStartIndex))  /* intentional overflow */",
          "new_line_content": "            while (ip <= ilimit) {",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": "ZSTD_count_2segments",
          "new_api": null,
          "old_text": "ZSTD_count_2segments(ip+4, repMatch2+4, iend, repEnd2, prefixStart)",
          "new_text": null,
          "old_line_content": "                    size_t const repLength2 = ZSTD_count_2segments(ip+4, repMatch2+4, iend, repEnd2, prefixStart) + 4;",
          "new_line_content": "                const BYTE* repMatch2 = repIndex2 < prefixStartIndex ? dictBase + repIndex2 : base + repIndex2;",
          "content_same": false
        },
        {
          "line": 344,
          "old_api": "ZSTD_hashPtr",
          "new_api": null,
          "old_text": "ZSTD_hashPtr(ip, hlog, mls)",
          "new_text": null,
          "old_line_content": "                    hashTable[ZSTD_hashPtr(ip, hlog, mls)] = current2;",
          "new_line_content": "                    const BYTE* const repEnd2 = repIndex2 < prefixStartIndex ? dictEnd : iend;",
          "content_same": false
        },
        {
          "line": 227,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(ms->dictMatchState == NULL)",
          "new_text": null,
          "old_line_content": "    assert(ms->dictMatchState == NULL);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "ZSTD_compressBlock_fast_generic",
          "new_api": null,
          "old_text": "ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 4, ZSTD_noDict)",
          "new_text": null,
          "old_line_content": "        return ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 4, ZSTD_noDict);",
          "new_line_content": "    switch(mls)",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": "ZSTD_compressBlock_fast_generic",
          "new_api": null,
          "old_text": "ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 5, ZSTD_noDict)",
          "new_text": null,
          "old_line_content": "        return ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 5, ZSTD_noDict);",
          "new_line_content": "    default: /* includes case 3 */",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": "ZSTD_compressBlock_fast_extDict_generic",
          "new_api": null,
          "old_text": "ZSTD_compressBlock_fast_extDict_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 4)",
          "new_text": null,
          "old_line_content": "        return ZSTD_compressBlock_fast_extDict_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 4);",
          "new_line_content": "    switch(mls)",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": "ZSTD_compressBlock_fast_extDict_generic",
          "new_api": null,
          "old_text": "ZSTD_compressBlock_fast_extDict_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 5)",
          "new_text": null,
          "old_line_content": "        return ZSTD_compressBlock_fast_extDict_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 5);",
          "new_line_content": "    default: /* includes case 3 */",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(ms->dictMatchState != NULL)",
          "new_text": null,
          "old_line_content": "    assert(ms->dictMatchState != NULL);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": "ZSTD_compressBlock_fast_generic",
          "new_api": null,
          "old_text": "ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 4, ZSTD_dictMatchState)",
          "new_text": null,
          "old_line_content": "        return ZSTD_compressBlock_fast_generic(ms, seqStore, rep, src, srcSize, hlog, stepSize, 4, ZSTD_dictMatchState);",
          "new_line_content": "    switch(mls)",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 10,
      "total_additions": 40,
      "total_deletions": 39,
      "total_api_changes": 89
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 89,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          154,
          127
        ]
      }
    },
    "api_calls_before": 86,
    "api_calls_after": 87,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 2,
      "total_diff_lines": 27
    }
  }
}