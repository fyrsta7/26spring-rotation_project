{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/zstd/modified_file/86db60752d1f813642054d12d704663c7757d434",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/zstd/modified_file/86db60752d1f813642054d12d704663c7757d434/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/zstd/modified_file/86db60752d1f813642054d12d704663c7757d434/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/zstd/modified_file/86db60752d1f813642054d12d704663c7757d434/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 539,
          "old_api": "ZSTD_compressSubBlock",
          "new_api": "countLiterals",
          "old_text": "ZSTD_compressSubBlock(&nextCBlock->entropy, entropyMetadata,\n                                                sp, seqCount,\n                                                lp, litSize,\n                                                llCodePtr, mlCodePtr, ofCodePtr,\n                                                cctxParams,\n                                                op, (size_t)(oend-op),\n                                                bmi2, writeLitEntropy, writeSeqEntropy,\n                                                &litEntropyWritten, &seqEntropyWritten,\n                                                0)",
          "new_text": "countLiterals(seqStorePtr, sp, seqCount)",
          "old_line_content": "                size_t const cSize = ZSTD_compressSubBlock(&nextCBlock->entropy, entropyMetadata,",
          "new_line_content": "                size_t litSize = countLiterals(seqStorePtr, sp, seqCount);",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": "ZSTD_needSequenceEntropyTables",
          "new_api": "DEBUGLOG",
          "old_text": "ZSTD_needSequenceEntropyTables(&entropyMetadata->fseMetadata)",
          "new_text": "DEBUGLOG(5, \"Literal entropy tables were never written\")",
          "old_line_content": "    if (writeSeqEntropy && ZSTD_needSequenceEntropyTables(&entropyMetadata->fseMetadata)) {",
          "new_line_content": "        DEBUGLOG(5, \"Literal entropy tables were never written\");",
          "content_same": false
        },
        {
          "line": 635,
          "old_api": "assert",
          "new_api": "ZSTD_noCompressBlock",
          "old_text": "assert(cSize != 0)",
          "new_text": "ZSTD_noCompressBlock(op, (size_t)(oend - op), ip, rSize, lastBlock)",
          "old_line_content": "        assert(cSize != 0);",
          "new_line_content": "        size_t const cSize = ZSTD_noCompressBlock(op, (size_t)(oend - op), ip, rSize, lastBlock);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 644,
          "old_api": null,
          "new_api": "ZSTD_memcpy",
          "old_text": null,
          "new_text": "ZSTD_memcpy(&rep, prevCBlock->rep, sizeof(rep))",
          "old_line_content": "            }",
          "new_line_content": "            ZSTD_memcpy(&rep, prevCBlock->rep, sizeof(rep));",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": null,
          "new_api": "ZSTD_getSequenceLength",
          "old_text": null,
          "new_text": "ZSTD_getSequenceLength(seqStorePtr, seq)",
          "old_line_content": "        }",
          "new_line_content": "                ZSTD_updateRep(rep.rep, seq->offBase, ZSTD_getSequenceLength(seqStorePtr, seq).litLength == 0);",
          "content_same": false
        },
        {
          "line": 648,
          "old_api": null,
          "new_api": "ZSTD_memcpy",
          "old_text": null,
          "new_text": "ZSTD_memcpy(nextCBlock->rep, &rep, sizeof(rep))",
          "old_line_content": "",
          "new_line_content": "            ZSTD_memcpy(nextCBlock->rep, &rep, sizeof(rep));",
          "content_same": false
        },
        {
          "line": 652,
          "old_api": null,
          "new_api": "DEBUGLOG",
          "old_text": null,
          "new_text": "DEBUGLOG(5, \"ZSTD_compressSubBlock_multi compressed all subBlocks: total compressed size = %u\",\n                (unsigned)(op-ostart))",
          "old_line_content": "}",
          "new_line_content": "    DEBUGLOG(5, \"ZSTD_compressSubBlock_multi compressed all subBlocks: total compressed size = %u\",",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": null,
          "new_api": "sizeBlockSequences",
          "old_text": null,
          "new_text": "sizeBlockSequences(sp, (size_t)(send-sp), avgBlockBudget + blockBudgetSupp, avgLitCost, avgSeqCost, n==0)",
          "old_line_content": "            if (sp + seqCount == send) break;",
          "new_line_content": "            size_t seqCount = sizeBlockSequences(sp, (size_t)(send-sp), avgBlockBudget + blockBudgetSupp, avgLitCost, avgSeqCost, n==0);",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(seqCount <= (size_t)(send-sp))",
          "old_line_content": "            /* compress sub-block */",
          "new_line_content": "            assert(seqCount <= (size_t)(send-sp));",
          "content_same": false
        },
        {
          "line": 535,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(seqCount > 0)",
          "old_line_content": "                int seqEntropyWritten = 0;",
          "new_line_content": "            assert(seqCount > 0);",
          "content_same": false
        },
        {
          "line": 664,
          "old_api": null,
          "new_api": "ZSTD_buildBlockEntropyStats",
          "old_text": null,
          "new_text": "ZSTD_buildBlockEntropyStats(&zc->seqStore,\n          &zc->blockState.prevCBlock->entropy,\n          &zc->blockState.nextCBlock->entropy,\n          &zc->appliedParams,\n          &entropyMetadata,\n          zc->entropyWorkspace, ENTROPY_WORKSPACE_SIZE /* statically allocated in resetCCtx */)",
          "old_line_content": "          &zc->appliedParams,",
          "new_line_content": "    FORWARD_IF_ERROR(ZSTD_buildBlockEntropyStats(&zc->seqStore,",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": null,
          "new_api": "ZSTD_seqDecompressedSize",
          "old_text": null,
          "new_text": "ZSTD_seqDecompressedSize(seqStorePtr, sp, seqCount, litSize, 0)",
          "old_line_content": "                                                lp, litSize,",
          "new_line_content": "                        ZSTD_seqDecompressedSize(seqStorePtr, sp, seqCount, litSize, 0);",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": null,
          "new_api": "ZSTD_compressSubBlock",
          "old_text": null,
          "new_text": "ZSTD_compressSubBlock(&nextCBlock->entropy, entropyMetadata,\n                                                sp, seqCount,\n                                                lp, litSize,\n                                                llCodePtr, mlCodePtr, ofCodePtr,\n                                                cctxParams,\n                                                op, (size_t)(oend-op),\n                                                bmi2, writeLitEntropy, writeSeqEntropy,\n                                                &litEntropyWritten, &seqEntropyWritten,\n                                                0)",
          "old_line_content": "                                                llCodePtr, mlCodePtr, ofCodePtr,",
          "new_line_content": "                size_t const cSize = ZSTD_compressSubBlock(&nextCBlock->entropy, entropyMetadata,",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": null,
          "new_api": "ZSTD_compressSubBlock_multi",
          "old_text": null,
          "new_text": "ZSTD_compressSubBlock_multi(&zc->seqStore,\n            zc->blockState.prevCBlock,\n            zc->blockState.nextCBlock,\n            &entropyMetadata,\n            &zc->appliedParams,\n            dst, dstCapacity,\n            src, srcSize,\n            zc->bmi2, lastBlock,\n            zc->entropyWorkspace, ENTROPY_WORKSPACE_SIZE /* statically allocated in resetCCtx */)",
          "old_line_content": "            &entropyMetadata,",
          "new_line_content": "    return ZSTD_compressSubBlock_multi(&zc->seqStore,",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": null,
          "new_api": "FORWARD_IF_ERROR",
          "old_text": null,
          "new_text": "FORWARD_IF_ERROR(cSize, \"ZSTD_compressSubBlock failed\")",
          "old_line_content": "                if (cSize > 0 && cSize < decompressedSize) {",
          "new_line_content": "                FORWARD_IF_ERROR(cSize, \"ZSTD_compressSubBlock failed\");",
          "content_same": false
        },
        {
          "line": 555,
          "old_api": null,
          "new_api": "DEBUGLOG",
          "old_text": null,
          "new_text": "DEBUGLOG(5, \"Committed sub-block compressing %u bytes => %u bytes\",\n                                (unsigned)decompressedSize, (unsigned)cSize)",
          "old_line_content": "                    ip += decompressedSize;",
          "new_line_content": "                    DEBUGLOG(5, \"Committed sub-block compressing %u bytes => %u bytes\",",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(ip + decompressedSize <= iend)",
          "old_line_content": "                    op += cSize;",
          "new_line_content": "                    assert(ip + decompressedSize <= iend);",
          "content_same": false
        },
        {
          "line": 579,
          "old_api": null,
          "new_api": "DEBUGLOG",
          "old_text": null,
          "new_text": "DEBUGLOG(2, \"Generate last sub-block: %u sequences remaining\", (unsigned)(send - sp))",
          "old_line_content": "        size_t litSize = (size_t)(lend - lp);",
          "new_line_content": "    DEBUGLOG(2, \"Generate last sub-block: %u sequences remaining\", (unsigned)(send - sp));",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": null,
          "new_api": "ZSTD_seqDecompressedSize",
          "old_text": null,
          "new_text": "ZSTD_seqDecompressedSize(seqStorePtr, sp, seqCount, litSize, 1)",
          "old_line_content": "                                            lp, litSize,",
          "new_line_content": "                ZSTD_seqDecompressedSize(seqStorePtr, sp, seqCount, litSize, 1);",
          "content_same": false
        },
        {
          "line": 586,
          "old_api": null,
          "new_api": "ZSTD_compressSubBlock",
          "old_text": null,
          "new_text": "ZSTD_compressSubBlock(&nextCBlock->entropy, entropyMetadata,\n                                            sp, seqCount,\n                                            lp, litSize,\n                                            llCodePtr, mlCodePtr, ofCodePtr,\n                                            cctxParams,\n                                            op, (size_t)(oend-op),\n                                            bmi2, writeLitEntropy, writeSeqEntropy,\n                                            &litEntropyWritten, &seqEntropyWritten,\n                                            lastBlock)",
          "old_line_content": "                                            llCodePtr, mlCodePtr, ofCodePtr,",
          "new_line_content": "        size_t const cSize = ZSTD_compressSubBlock(&nextCBlock->entropy, entropyMetadata,",
          "content_same": false
        },
        {
          "line": 595,
          "old_api": null,
          "new_api": "FORWARD_IF_ERROR",
          "old_text": null,
          "new_text": "FORWARD_IF_ERROR(cSize, \"ZSTD_compressSubBlock failed\")",
          "old_line_content": "        if (cSize > 0 && cSize < decompressedSize) {",
          "new_line_content": "        FORWARD_IF_ERROR(cSize, \"ZSTD_compressSubBlock failed\");",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": null,
          "new_api": "DEBUGLOG",
          "old_text": null,
          "new_text": "DEBUGLOG(2, \"Last sub-block compressed %u bytes => %u bytes\",\n                        (unsigned)decompressedSize, (unsigned)cSize)",
          "old_line_content": "            ip += decompressedSize;",
          "new_line_content": "            DEBUGLOG(2, \"Last sub-block compressed %u bytes => %u bytes\",",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(ip + decompressedSize <= iend)",
          "old_line_content": "            op += cSize;",
          "new_line_content": "            assert(ip + decompressedSize <= iend);",
          "content_same": false
        },
        {
          "line": 622,
          "old_api": null,
          "new_api": "ZSTD_memcpy",
          "old_text": null,
          "new_text": "ZSTD_memcpy(&nextCBlock->entropy.huf, &prevCBlock->entropy.huf, sizeof(prevCBlock->entropy.huf))",
          "old_line_content": "        /* If we haven't written our entropy tables, then we've violated our contract and",
          "new_line_content": "        ZSTD_memcpy(&nextCBlock->entropy.huf, &prevCBlock->entropy.huf, sizeof(prevCBlock->entropy.huf));",
          "content_same": false
        },
        {
          "line": 624,
          "old_api": null,
          "new_api": "ZSTD_needSequenceEntropyTables",
          "old_text": null,
          "new_text": "ZSTD_needSequenceEntropyTables(&entropyMetadata->fseMetadata)",
          "old_line_content": "         */",
          "new_line_content": "    if (writeSeqEntropy && ZSTD_needSequenceEntropyTables(&entropyMetadata->fseMetadata)) {",
          "content_same": false
        },
        {
          "line": 628,
          "old_api": null,
          "new_api": "DEBUGLOG",
          "old_text": null,
          "new_text": "DEBUGLOG(5, \"Sequence entropy tables were never written => cancel, emit an uncompressed block\")",
          "old_line_content": "",
          "new_line_content": "        DEBUGLOG(5, \"Sequence entropy tables were never written => cancel, emit an uncompressed block\");",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": null,
          "new_api": "DEBUGLOG",
          "old_text": null,
          "new_text": "DEBUGLOG(2, \"Generate last uncompressed sub-block of %u bytes\", (unsigned)(rSize))",
          "old_line_content": "        op += cSize;",
          "new_line_content": "        DEBUGLOG(2, \"Generate last uncompressed sub-block of %u bytes\", (unsigned)(rSize));",
          "content_same": false
        },
        {
          "line": 637,
          "old_api": null,
          "new_api": "FORWARD_IF_ERROR",
          "old_text": null,
          "new_text": "FORWARD_IF_ERROR(cSize, \"ZSTD_noCompressBlock failed\")",
          "old_line_content": "        /* We have to regenerate the repcodes because we've skipped some sequences */",
          "new_line_content": "        FORWARD_IF_ERROR(cSize, \"ZSTD_noCompressBlock failed\");",
          "content_same": false
        },
        {
          "line": 638,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(cSize != 0)",
          "old_line_content": "        if (sp < send) {",
          "new_line_content": "        assert(cSize != 0);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 641,
          "old_api": "ZSTD_memcpy",
          "new_api": null,
          "old_text": "ZSTD_memcpy(&rep, prevCBlock->rep, sizeof(rep))",
          "new_text": null,
          "old_line_content": "            ZSTD_memcpy(&rep, prevCBlock->rep, sizeof(rep));",
          "new_line_content": "        if (sp < send) {",
          "content_same": false
        },
        {
          "line": 643,
          "old_api": "ZSTD_getSequenceLength",
          "new_api": null,
          "old_text": "ZSTD_getSequenceLength(seqStorePtr, seq)",
          "new_text": null,
          "old_line_content": "                ZSTD_updateRep(rep.rep, seq->offBase, ZSTD_getSequenceLength(seqStorePtr, seq).litLength == 0);",
          "new_line_content": "            repcodes_t rep;",
          "content_same": false
        },
        {
          "line": 645,
          "old_api": "ZSTD_memcpy",
          "new_api": null,
          "old_text": "ZSTD_memcpy(nextCBlock->rep, &rep, sizeof(rep))",
          "new_text": null,
          "old_line_content": "            ZSTD_memcpy(nextCBlock->rep, &rep, sizeof(rep));",
          "new_line_content": "            for (seq = sstart; seq < sp; ++seq) {",
          "content_same": false
        },
        {
          "line": 649,
          "old_api": "DEBUGLOG",
          "new_api": null,
          "old_text": "DEBUGLOG(5, \"ZSTD_compressSubBlock_multi compressed all subBlocks: total compressed size = %u\",\n                (unsigned)(op-ostart))",
          "new_text": null,
          "old_line_content": "    DEBUGLOG(5, \"ZSTD_compressSubBlock_multi compressed all subBlocks: total compressed size = %u\",",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": "sizeBlockSequences",
          "new_api": null,
          "old_text": "sizeBlockSequences(sp, (size_t)(send-sp), avgBlockBudget + blockBudgetSupp, avgLitCost, avgSeqCost, n==0)",
          "new_text": null,
          "old_line_content": "            size_t seqCount = sizeBlockSequences(sp, (size_t)(send-sp), avgBlockBudget + blockBudgetSupp, avgLitCost, avgSeqCost, n==0);",
          "new_line_content": "        /* compress and write sub-blocks */",
          "content_same": false
        },
        {
          "line": 530,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(seqCount <= (size_t)(send-sp))",
          "new_text": null,
          "old_line_content": "            assert(seqCount <= (size_t)(send-sp));",
          "new_line_content": "            /* determine nb of sequences for current sub-block + nbLiterals from next sequence */",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(seqCount > 0)",
          "new_text": null,
          "old_line_content": "            assert(seqCount > 0);",
          "new_line_content": "            /* if reached last sequence : break to last sub-block (simplification) */",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": "ZSTD_buildBlockEntropyStats",
          "new_api": null,
          "old_text": "ZSTD_buildBlockEntropyStats(&zc->seqStore,\n          &zc->blockState.prevCBlock->entropy,\n          &zc->blockState.nextCBlock->entropy,\n          &zc->appliedParams,\n          &entropyMetadata,\n          zc->entropyWorkspace, ENTROPY_WORKSPACE_SIZE /* statically allocated in resetCCtx */)",
          "new_text": null,
          "old_line_content": "    FORWARD_IF_ERROR(ZSTD_buildBlockEntropyStats(&zc->seqStore,",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 536,
          "old_api": "countLiterals",
          "new_api": null,
          "old_text": "countLiterals(seqStorePtr, sp, seqCount)",
          "new_text": null,
          "old_line_content": "                size_t litSize = countLiterals(seqStorePtr, sp, seqCount);",
          "new_line_content": "            /* compress sub-block */",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": "ZSTD_seqDecompressedSize",
          "new_api": null,
          "old_text": "ZSTD_seqDecompressedSize(seqStorePtr, sp, seqCount, litSize, 0)",
          "new_text": null,
          "old_line_content": "                        ZSTD_seqDecompressedSize(seqStorePtr, sp, seqCount, litSize, 0);",
          "new_line_content": "                int seqEntropyWritten = 0;",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": "ZSTD_compressSubBlock_multi",
          "new_api": null,
          "old_text": "ZSTD_compressSubBlock_multi(&zc->seqStore,\n            zc->blockState.prevCBlock,\n            zc->blockState.nextCBlock,\n            &entropyMetadata,\n            &zc->appliedParams,\n            dst, dstCapacity,\n            src, srcSize,\n            zc->bmi2, lastBlock,\n            zc->entropyWorkspace, ENTROPY_WORKSPACE_SIZE /* statically allocated in resetCCtx */)",
          "new_text": null,
          "old_line_content": "    return ZSTD_compressSubBlock_multi(&zc->seqStore,",
          "new_line_content": "          &entropyMetadata,",
          "content_same": false
        },
        {
          "line": 548,
          "old_api": "FORWARD_IF_ERROR",
          "new_api": null,
          "old_text": "FORWARD_IF_ERROR(cSize, \"ZSTD_compressSubBlock failed\")",
          "new_text": null,
          "old_line_content": "                FORWARD_IF_ERROR(cSize, \"ZSTD_compressSubBlock failed\");",
          "new_line_content": "                                                bmi2, writeLitEntropy, writeSeqEntropy,",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": "DEBUGLOG",
          "new_api": null,
          "old_text": "DEBUGLOG(5, \"Committed sub-block compressing %u bytes => %u bytes\",\n                                (unsigned)decompressedSize, (unsigned)cSize)",
          "new_text": null,
          "old_line_content": "                    DEBUGLOG(5, \"Committed sub-block compressing %u bytes => %u bytes\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(ip + decompressedSize <= iend)",
          "new_text": null,
          "old_line_content": "                    assert(ip + decompressedSize <= iend);",
          "new_line_content": "                if (cSize > 0 && cSize < decompressedSize) {",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": "DEBUGLOG",
          "new_api": null,
          "old_text": "DEBUGLOG(2, \"Generate last sub-block: %u sequences remaining\", (unsigned)(send - sp))",
          "new_text": null,
          "old_line_content": "    DEBUGLOG(2, \"Generate last sub-block: %u sequences remaining\", (unsigned)(send - sp));",
          "new_line_content": "    } /* if (nbSeqs > 0) */",
          "content_same": false
        },
        {
          "line": 582,
          "old_api": "ZSTD_seqDecompressedSize",
          "new_api": null,
          "old_text": "ZSTD_seqDecompressedSize(seqStorePtr, sp, seqCount, litSize, 1)",
          "new_text": null,
          "old_line_content": "                ZSTD_seqDecompressedSize(seqStorePtr, sp, seqCount, litSize, 1);",
          "new_line_content": "        size_t litSize = (size_t)(lend - lp);",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": "ZSTD_compressSubBlock",
          "new_api": null,
          "old_text": "ZSTD_compressSubBlock(&nextCBlock->entropy, entropyMetadata,\n                                            sp, seqCount,\n                                            lp, litSize,\n                                            llCodePtr, mlCodePtr, ofCodePtr,\n                                            cctxParams,\n                                            op, (size_t)(oend-op),\n                                            bmi2, writeLitEntropy, writeSeqEntropy,\n                                            &litEntropyWritten, &seqEntropyWritten,\n                                            lastBlock)",
          "new_text": null,
          "old_line_content": "        size_t const cSize = ZSTD_compressSubBlock(&nextCBlock->entropy, entropyMetadata,",
          "new_line_content": "        size_t seqCount = (size_t)(send - sp);",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": "FORWARD_IF_ERROR",
          "new_api": null,
          "old_text": "FORWARD_IF_ERROR(cSize, \"ZSTD_compressSubBlock failed\")",
          "new_text": null,
          "old_line_content": "        FORWARD_IF_ERROR(cSize, \"ZSTD_compressSubBlock failed\");",
          "new_line_content": "                                            bmi2, writeLitEntropy, writeSeqEntropy,",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": "DEBUGLOG",
          "new_api": null,
          "old_text": "DEBUGLOG(2, \"Last sub-block compressed %u bytes => %u bytes\",\n                        (unsigned)decompressedSize, (unsigned)cSize)",
          "new_text": null,
          "old_line_content": "            DEBUGLOG(2, \"Last sub-block compressed %u bytes => %u bytes\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(ip + decompressedSize <= iend)",
          "new_text": null,
          "old_line_content": "            assert(ip + decompressedSize <= iend);",
          "new_line_content": "        if (cSize > 0 && cSize < decompressedSize) {",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": "DEBUGLOG",
          "new_api": null,
          "old_text": "DEBUGLOG(5, \"Literal entropy tables were never written\")",
          "new_text": null,
          "old_line_content": "        DEBUGLOG(5, \"Literal entropy tables were never written\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 619,
          "old_api": "ZSTD_memcpy",
          "new_api": null,
          "old_text": "ZSTD_memcpy(&nextCBlock->entropy.huf, &prevCBlock->entropy.huf, sizeof(prevCBlock->entropy.huf))",
          "new_text": null,
          "old_line_content": "        ZSTD_memcpy(&nextCBlock->entropy.huf, &prevCBlock->entropy.huf, sizeof(prevCBlock->entropy.huf));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 625,
          "old_api": "DEBUGLOG",
          "new_api": null,
          "old_text": "DEBUGLOG(5, \"Sequence entropy tables were never written => cancel, emit an uncompressed block\")",
          "new_text": null,
          "old_line_content": "        DEBUGLOG(5, \"Sequence entropy tables were never written => cancel, emit an uncompressed block\");",
          "new_line_content": "        /* If we haven't written our entropy tables, then we've violated our contract and",
          "content_same": false
        },
        {
          "line": 632,
          "old_api": "ZSTD_noCompressBlock",
          "new_api": null,
          "old_text": "ZSTD_noCompressBlock(op, (size_t)(oend - op), ip, rSize, lastBlock)",
          "new_text": null,
          "old_line_content": "        size_t const cSize = ZSTD_noCompressBlock(op, (size_t)(oend - op), ip, rSize, lastBlock);",
          "new_line_content": "    if (ip < iend) {",
          "content_same": false
        },
        {
          "line": 633,
          "old_api": "DEBUGLOG",
          "new_api": null,
          "old_text": "DEBUGLOG(2, \"Generate last uncompressed sub-block of %u bytes\", (unsigned)(rSize))",
          "new_text": null,
          "old_line_content": "        DEBUGLOG(2, \"Generate last uncompressed sub-block of %u bytes\", (unsigned)(rSize));",
          "new_line_content": "        /* some data left : last part of the block sent uncompressed */",
          "content_same": false
        },
        {
          "line": 634,
          "old_api": "FORWARD_IF_ERROR",
          "new_api": null,
          "old_text": "FORWARD_IF_ERROR(cSize, \"ZSTD_noCompressBlock failed\")",
          "new_text": null,
          "old_line_content": "        FORWARD_IF_ERROR(cSize, \"ZSTD_noCompressBlock failed\");",
          "new_line_content": "        size_t const rSize = (size_t)((iend - ip));",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 3,
      "total_additions": 26,
      "total_deletions": 26,
      "total_api_changes": 55
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 55,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          524,
          525,
          526,
          571,
          574
        ]
      }
    },
    "api_calls_before": 109,
    "api_calls_after": 109,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 1,
      "total_diff_lines": 24
    }
  }
}