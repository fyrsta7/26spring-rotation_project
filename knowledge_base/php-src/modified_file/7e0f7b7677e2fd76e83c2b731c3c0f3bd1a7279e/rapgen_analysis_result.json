{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/7e0f7b7677e2fd76e83c2b731c3c0f3bd1a7279e",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/7e0f7b7677e2fd76e83c2b731c3c0f3bd1a7279e/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/7e0f7b7677e2fd76e83c2b731c3c0f3bd1a7279e/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/7e0f7b7677e2fd76e83c2b731c3c0f3bd1a7279e/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 114,
          "old_api": "add_next_index_long",
          "new_api": "ZSTR_CHAR",
          "old_text": "add_next_index_long(&keyword, lineno)",
          "new_text": "ZSTR_CHAR(text[0])",
          "old_line_content": "\t\tadd_next_index_long(&keyword, lineno);",
          "new_line_content": "\t\t\tadd_next_index_str(&keyword, ZSTR_CHAR(text[0]));",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": "ZSTR_CHAR",
          "new_api": "add_next_index_long",
          "old_text": "ZSTR_CHAR(text[0])",
          "new_text": "add_next_index_long(&keyword, lineno)",
          "old_line_content": "\t\t\tadd_next_index_str(return_value, ZSTR_CHAR(text[0]));",
          "new_line_content": "\t\tadd_next_index_long(&keyword, lineno);",
          "content_same": false
        },
        {
          "line": 138,
          "old_api": "zend_restore_lexical_state",
          "new_api": "ZVAL_STR_COPY",
          "old_text": "zend_restore_lexical_state(&original_lex_state)",
          "new_text": "ZVAL_STR_COPY(&source_zval, source)",
          "old_line_content": "\t\tzend_restore_lexical_state(&original_lex_state);",
          "new_line_content": "\tZVAL_STR_COPY(&source_zval, source);",
          "content_same": false
        },
        {
          "line": 142,
          "old_api": "LANG_SCNG",
          "new_api": "zend_restore_lexical_state",
          "old_text": "LANG_SCNG(yy_state)",
          "new_text": "zend_restore_lexical_state(&original_lex_state)",
          "old_line_content": "\tLANG_SCNG(yy_state) = yycINITIAL;",
          "new_line_content": "\t\tzend_restore_lexical_state(&original_lex_state);",
          "content_same": false
        },
        {
          "line": 146,
          "old_api": "add_token",
          "new_api": "LANG_SCNG",
          "old_text": "add_token(return_value, token_type, zendtext, zendleng, token_line)",
          "new_text": "LANG_SCNG(yy_state)",
          "old_line_content": "\t\tadd_token(return_value, token_type, zendtext, zendleng, token_line);",
          "new_line_content": "\tLANG_SCNG(yy_state) = yycINITIAL;",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": "zval_ptr_dtor_nogc",
          "new_api": "lex_scan",
          "old_text": "zval_ptr_dtor_nogc(&token)",
          "new_text": "lex_scan(&token, NULL)",
          "old_line_content": "\t\t\tzval_ptr_dtor_nogc(&token);",
          "new_line_content": "\twhile ((token_type = lex_scan(&token, NULL))) {",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": "ZVAL_UNDEF",
          "new_api": "add_token",
          "old_text": "ZVAL_UNDEF(&token)",
          "new_text": "add_token(return_value, token_type, zendtext, zendleng, token_line)",
          "old_line_content": "\t\t\tZVAL_UNDEF(&token);",
          "new_line_content": "\t\tadd_token(return_value, token_type, zendtext, zendleng, token_line);",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": "zend_restore_lexical_state",
          "new_api": "CG",
          "old_text": "zend_restore_lexical_state(&original_lex_state)",
          "new_text": "CG(zend_lineno)",
          "old_line_content": "\tzend_restore_lexical_state(&original_lex_state);",
          "new_line_content": "\t\ttoken_line = CG(zend_lineno);",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": "Z_ARRVAL_P",
          "new_api": "LANG_SCNG",
          "old_text": "Z_ARRVAL_P(token_stream)",
          "new_text": "LANG_SCNG(yy_leng)",
          "old_line_content": "\t\t\ttokens_ht = Z_ARRVAL_P(token_stream);",
          "new_line_content": "\t\t\t\tadd_token(token_stream, token, LANG_SCNG(yy_text), LANG_SCNG(yy_leng), line);",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "LANG_SCNG",
          "new_api": "Z_ARRVAL_P",
          "old_text": "LANG_SCNG(yy_limit)",
          "new_text": "Z_ARRVAL_P(token_zv)",
          "old_line_content": "\t\t\tif (LANG_SCNG(yy_cursor) != LANG_SCNG(yy_limit)) {",
          "new_line_content": "\t\t\t\tZVAL_LONG(zend_hash_index_find(Z_ARRVAL_P(token_zv), 0), token);",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": "zend_save_lexical_state",
          "new_api": "ZVAL_STR_COPY",
          "old_text": "zend_save_lexical_state(&original_lex_state)",
          "new_text": "ZVAL_STR_COPY(&source_zval, source)",
          "old_line_content": "\tzend_save_lexical_state(&original_lex_state);",
          "new_line_content": "\tZVAL_STR_COPY(&source_zval, source);",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "zend_prepare_string_for_scanning",
          "new_api": "CG",
          "old_text": "zend_prepare_string_for_scanning(&source_zval, \"\")",
          "new_text": "CG(in_compilation)",
          "old_line_content": "\tif ((success = (zend_prepare_string_for_scanning(&source_zval, \"\") == SUCCESS))) {",
          "new_line_content": "\toriginal_in_compilation = CG(in_compilation);",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": "array_init",
          "new_api": "zend_save_lexical_state",
          "old_text": "array_init(&token_stream)",
          "new_text": "zend_save_lexical_state(&original_lex_state)",
          "old_line_content": "\t\tarray_init(&token_stream);",
          "new_line_content": "\tzend_save_lexical_state(&original_lex_state);",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": "CG",
          "new_api": "zend_prepare_string_for_scanning",
          "old_text": "CG(ast)",
          "new_text": "zend_prepare_string_for_scanning(&source_zval, \"\")",
          "old_line_content": "\t\tCG(ast) = NULL;",
          "new_line_content": "\tif ((success = (zend_prepare_string_for_scanning(&source_zval, \"\") == SUCCESS))) {",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": "LANG_SCNG",
          "new_api": "array_init",
          "old_text": "LANG_SCNG(yy_state)",
          "new_text": "array_init(&token_stream)",
          "old_line_content": "\t\tLANG_SCNG(yy_state) = yycINITIAL;",
          "new_line_content": "\t\tarray_init(&token_stream);",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": "LANG_SCNG",
          "new_api": "CG",
          "old_text": "LANG_SCNG(on_event_context)",
          "new_text": "CG(ast)",
          "old_line_content": "\t\tLANG_SCNG(on_event_context) = &token_stream;",
          "new_line_content": "\t\tCG(ast) = NULL;",
          "content_same": false
        },
        {
          "line": 242,
          "old_api": "zendparse",
          "new_api": "LANG_SCNG",
          "old_text": "zendparse()",
          "new_text": "LANG_SCNG(yy_state)",
          "old_line_content": "\t\tif((success = (zendparse() == SUCCESS))) {",
          "new_line_content": "\t\tLANG_SCNG(yy_state) = yycINITIAL;",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": "ZVAL_COPY_VALUE",
          "new_api": "LANG_SCNG",
          "old_text": "ZVAL_COPY_VALUE(return_value, &token_stream)",
          "new_text": "LANG_SCNG(on_event)",
          "old_line_content": "\t\t\tZVAL_COPY_VALUE(return_value, &token_stream);",
          "new_line_content": "\t\tLANG_SCNG(on_event) = on_event;",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": "CG",
          "new_api": "zval_ptr_dtor",
          "old_text": "CG(ast_arena)",
          "new_text": "zval_ptr_dtor(&token_stream)",
          "old_line_content": "\t\tzend_arena_destroy(CG(ast_arena));",
          "new_line_content": "\t\t\tzval_ptr_dtor(&token_stream);",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": "zend_restore_lexical_state",
          "new_api": "CG",
          "old_text": "zend_restore_lexical_state(&original_lex_state)",
          "new_text": "CG(ast_arena)",
          "old_line_content": "\tzend_restore_lexical_state(&original_lex_state);",
          "new_line_content": "\t\tzend_arena_destroy(CG(ast_arena));",
          "content_same": false
        },
        {
          "line": 275,
          "old_api": "ZEND_PARSE_PARAMETERS_END",
          "new_api": "ZEND_PARSE_PARAMETERS_START",
          "old_text": "ZEND_PARSE_PARAMETERS_END()",
          "new_text": "ZEND_PARSE_PARAMETERS_START(1, 2)",
          "old_line_content": "\tZEND_PARSE_PARAMETERS_END();",
          "new_line_content": "\tZEND_PARSE_PARAMETERS_START(1, 2)",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": "zend_clear_exception",
          "new_api": "tokenize_parse",
          "old_text": "zend_clear_exception()",
          "new_text": "tokenize_parse(return_value, source)",
          "old_line_content": "\t\tzend_clear_exception();",
          "new_line_content": "\t\tsuccess = tokenize_parse(return_value, source);",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": "get_token_type_name",
          "new_api": "ZEND_PARSE_PARAMETERS_START",
          "old_text": "get_token_type_name(type)",
          "new_text": "ZEND_PARSE_PARAMETERS_START(1, 1)",
          "old_line_content": "\tRETVAL_STRING(get_token_type_name(type));",
          "new_line_content": "\tZEND_PARSE_PARAMETERS_START(1, 1)",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 257,
          "old_api": null,
          "new_api": "zend_restore_lexical_state",
          "old_text": null,
          "new_text": "zend_restore_lexical_state(&original_lex_state)",
          "old_line_content": "",
          "new_line_content": "\tzend_restore_lexical_state(&original_lex_state);",
          "content_same": false
        },
        {
          "line": 258,
          "old_api": null,
          "new_api": "CG",
          "old_text": null,
          "new_text": "CG(in_compilation)",
          "old_line_content": "\treturn success;",
          "new_line_content": "\tCG(in_compilation) = original_in_compilation;",
          "content_same": false
        },
        {
          "line": 260,
          "old_api": null,
          "new_api": "zval_ptr_dtor_str",
          "old_text": null,
          "new_text": "zval_ptr_dtor_str(&source_zval)",
          "old_line_content": "",
          "new_line_content": "\tzval_ptr_dtor_str(&source_zval);",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": null,
          "new_api": "zend_save_lexical_state",
          "old_text": null,
          "new_text": "zend_save_lexical_state(&original_lex_state)",
          "old_line_content": "\t\treturn 0;",
          "new_line_content": "\tzend_save_lexical_state(&original_lex_state);",
          "content_same": false
        },
        {
          "line": 141,
          "old_api": null,
          "new_api": "zend_prepare_string_for_scanning",
          "old_text": null,
          "new_text": "zend_prepare_string_for_scanning(&source_zval, \"\")",
          "old_line_content": "",
          "new_line_content": "\tif (zend_prepare_string_for_scanning(&source_zval, \"\") == FAILURE) {",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": null,
          "new_api": "array_init",
          "old_text": null,
          "new_text": "array_init(return_value)",
          "old_line_content": "",
          "new_line_content": "\tarray_init(return_value);",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": null,
          "new_api": "Z_PARAM_STR",
          "old_text": null,
          "new_text": "Z_PARAM_STR(source)",
          "old_line_content": "",
          "new_line_content": "\t\tZ_PARAM_STR(source)",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": null,
          "new_api": "ZEND_PARSE_PARAMETERS_END",
          "old_text": null,
          "new_text": "ZEND_PARSE_PARAMETERS_END()",
          "old_line_content": "\t} else {",
          "new_line_content": "\tZEND_PARSE_PARAMETERS_END();",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": null,
          "new_api": "Z_TYPE",
          "old_text": null,
          "new_text": "Z_TYPE(token)",
          "old_line_content": "",
          "new_line_content": "\t\tif (Z_TYPE(token) != IS_UNDEF) {",
          "content_same": false
        },
        {
          "line": 153,
          "old_api": null,
          "new_api": "zval_ptr_dtor_nogc",
          "old_text": null,
          "new_text": "zval_ptr_dtor_nogc(&token)",
          "old_line_content": "\t\t/* after T_HALT_COMPILER collect the next three non-dropped tokens */",
          "new_line_content": "\t\t\tzval_ptr_dtor_nogc(&token);",
          "content_same": false
        },
        {
          "line": 154,
          "old_api": null,
          "new_api": "ZVAL_UNDEF",
          "old_text": null,
          "new_text": "ZVAL_UNDEF(&token)",
          "old_line_content": "\t\tif (need_tokens != -1) {",
          "new_line_content": "\t\t\tZVAL_UNDEF(&token);",
          "content_same": false
        },
        {
          "line": 284,
          "old_api": null,
          "new_api": "tokenize",
          "old_text": null,
          "new_text": "tokenize(return_value, source)",
          "old_line_content": "",
          "new_line_content": "\t\tsuccess = tokenize(return_value, source);",
          "content_same": false
        },
        {
          "line": 286,
          "old_api": null,
          "new_api": "zend_clear_exception",
          "old_text": null,
          "new_text": "zend_clear_exception()",
          "old_line_content": "}",
          "new_line_content": "\t\tzend_clear_exception();",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": null,
          "new_api": "add_token",
          "old_text": null,
          "new_text": "add_token(return_value, T_INLINE_HTML,\n\t\t\t\t\t\tzendcursor, zendlimit - zendcursor, token_line)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\t\tadd_token(return_value, T_INLINE_HTML,",
          "content_same": false
        },
        {
          "line": 300,
          "old_api": null,
          "new_api": "Z_PARAM_LONG",
          "old_text": null,
          "new_text": "Z_PARAM_LONG(type)",
          "old_line_content": "}",
          "new_line_content": "\t\tZ_PARAM_LONG(type)",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": null,
          "new_api": "ZEND_PARSE_PARAMETERS_END",
          "old_text": null,
          "new_text": "ZEND_PARSE_PARAMETERS_END()",
          "old_line_content": "/* }}} */",
          "new_line_content": "\tZEND_PARSE_PARAMETERS_END();",
          "content_same": false
        },
        {
          "line": 174,
          "old_api": null,
          "new_api": "CG",
          "old_text": null,
          "new_text": "CG(increment_lineno)",
          "old_line_content": "",
          "new_line_content": "\t\tif (CG(increment_lineno)) {",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": null,
          "new_api": "get_token_type_name",
          "old_text": null,
          "new_text": "get_token_type_name(type)",
          "old_line_content": "",
          "new_line_content": "\tRETVAL_STRING(get_token_type_name(type));",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": null,
          "new_api": "CG",
          "old_text": null,
          "new_text": "CG(increment_lineno)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tCG(increment_lineno) = 0;",
          "content_same": false
        },
        {
          "line": 182,
          "old_api": null,
          "new_api": "zval_ptr_dtor_str",
          "old_text": null,
          "new_text": "zval_ptr_dtor_str(&source_zval)",
          "old_line_content": "}",
          "new_line_content": "\tzval_ptr_dtor_str(&source_zval);",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": null,
          "new_api": "zend_restore_lexical_state",
          "old_text": null,
          "new_text": "zend_restore_lexical_state(&original_lex_state)",
          "old_line_content": "",
          "new_line_content": "\tzend_restore_lexical_state(&original_lex_state);",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": null,
          "new_api": "LANG_SCNG",
          "old_text": null,
          "new_text": "LANG_SCNG(yy_leng)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\tif (token == ';' && LANG_SCNG(yy_leng) > 1) { /* ?> or ?>\\n or ?>\\r\\n */",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": null,
          "new_api": "LANG_SCNG",
          "old_text": null,
          "new_text": "LANG_SCNG(yy_leng)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\t} else if (token == T_ECHO && LANG_SCNG(yy_leng) == sizeof(\"<?=\") - 1) {",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": null,
          "new_api": "Z_ARRVAL_P",
          "old_text": null,
          "new_text": "Z_ARRVAL_P(token_stream)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\ttokens_ht = Z_ARRVAL_P(token_stream);",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": null,
          "new_api": "zend_hash_num_elements",
          "old_text": null,
          "new_text": "zend_hash_num_elements(tokens_ht)",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\t\ttoken_zv = zend_hash_index_find(tokens_ht, zend_hash_num_elements(tokens_ht) - 1);",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": null,
          "new_api": "Z_TYPE_P",
          "old_text": null,
          "new_text": "Z_TYPE_P(token_zv)",
          "old_line_content": "\t\tcase ON_STOP:",
          "new_line_content": "\t\t\tif (token_zv && Z_TYPE_P(token_zv) == IS_ARRAY) {",
          "content_same": false
        },
        {
          "line": 215,
          "old_api": null,
          "new_api": "LANG_SCNG",
          "old_text": null,
          "new_text": "LANG_SCNG(yy_limit)",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\t\tif (LANG_SCNG(yy_cursor) != LANG_SCNG(yy_limit)) {",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": null,
          "new_api": "LANG_SCNG",
          "old_text": null,
          "new_text": "LANG_SCNG(yy_cursor)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\t\tadd_token(token_stream, T_INLINE_HTML, LANG_SCNG(yy_cursor),",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": null,
          "new_api": "CG",
          "old_text": null,
          "new_text": "CG(zend_lineno)",
          "old_line_content": "}",
          "new_line_content": "\t\t\t\t\tLANG_SCNG(yy_limit) - LANG_SCNG(yy_cursor), CG(zend_lineno));",
          "content_same": false
        },
        {
          "line": 247,
          "old_api": null,
          "new_api": "ZVAL_COPY_VALUE",
          "old_text": null,
          "new_text": "ZVAL_COPY_VALUE(return_value, &token_stream)",
          "old_line_content": "",
          "new_line_content": "\t\t\tZVAL_COPY_VALUE(return_value, &token_stream);",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": null,
          "new_api": "CG",
          "old_text": null,
          "new_text": "CG(in_compilation)",
          "old_line_content": "\t\tzval token_stream;",
          "new_line_content": "\tCG(in_compilation) = 1;",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": null,
          "new_api": "zend_arena_create",
          "old_text": null,
          "new_text": "zend_arena_create(1024 * 32)",
          "old_line_content": "",
          "new_line_content": "\t\tCG(ast_arena) = zend_arena_create(1024 * 32);",
          "content_same": false
        },
        {
          "line": 116,
          "old_api": null,
          "new_api": "add_next_index_stringl",
          "old_text": null,
          "new_text": "add_next_index_stringl(&keyword, (char *) text, leng)",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\t\tadd_next_index_stringl(&keyword, (char *) text, leng);",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": null,
          "new_api": "LANG_SCNG",
          "old_text": null,
          "new_text": "LANG_SCNG(on_event_context)",
          "old_line_content": "\t\t} else {",
          "new_line_content": "\t\tLANG_SCNG(on_event_context) = &token_stream;",
          "content_same": false
        },
        {
          "line": 246,
          "old_api": null,
          "new_api": "zendparse",
          "old_text": null,
          "new_text": "zendparse()",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tif((success = (zendparse() == SUCCESS))) {",
          "content_same": false
        },
        {
          "line": 119,
          "old_api": null,
          "new_api": "add_next_index_zval",
          "old_text": null,
          "new_text": "add_next_index_zval(return_value, &keyword)",
          "old_line_content": "\t\t} else {",
          "new_line_content": "\t\tadd_next_index_zval(return_value, &keyword);",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": null,
          "new_api": "CG",
          "old_text": null,
          "new_text": "CG(ast)",
          "old_line_content": "\t/* restore compiler and scanner global states */",
          "new_line_content": "\t\tzend_ast_destroy(CG(ast));",
          "content_same": false
        },
        {
          "line": 122,
          "old_api": null,
          "new_api": "ZSTR_CHAR",
          "old_text": null,
          "new_text": "ZSTR_CHAR(text[0])",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tadd_next_index_str(return_value, ZSTR_CHAR(text[0]));",
          "content_same": false
        },
        {
          "line": 124,
          "old_api": null,
          "new_api": "add_next_index_stringl",
          "old_text": null,
          "new_text": "add_next_index_stringl(return_value, (char *) text, leng)",
          "old_line_content": "",
          "new_line_content": "\t\t\tadd_next_index_stringl(return_value, (char *) text, leng);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 256,
          "old_api": "zval_ptr_dtor_str",
          "new_api": null,
          "old_text": "zval_ptr_dtor_str(&source_zval)",
          "new_text": null,
          "old_line_content": "\tzval_ptr_dtor_str(&source_zval);",
          "new_line_content": "\t/* restore compiler and scanner global states */",
          "content_same": false
        },
        {
          "line": 134,
          "old_api": "ZVAL_STR_COPY",
          "new_api": null,
          "old_text": "ZVAL_STR_COPY(&source_zval, source)",
          "new_text": null,
          "old_line_content": "\tZVAL_STR_COPY(&source_zval, source);",
          "new_line_content": "\tint token_type;",
          "content_same": false
        },
        {
          "line": 135,
          "old_api": "zend_save_lexical_state",
          "new_api": null,
          "old_text": "zend_save_lexical_state(&original_lex_state)",
          "new_text": null,
          "old_line_content": "\tzend_save_lexical_state(&original_lex_state);",
          "new_line_content": "\tint token_line = 1;",
          "content_same": false
        },
        {
          "line": 137,
          "old_api": "zend_prepare_string_for_scanning",
          "new_api": null,
          "old_text": "zend_prepare_string_for_scanning(&source_zval, \"\")",
          "new_text": null,
          "old_line_content": "\tif (zend_prepare_string_for_scanning(&source_zval, \"\") == FAILURE) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 143,
          "old_api": "array_init",
          "new_api": null,
          "old_text": "array_init(return_value)",
          "new_text": null,
          "old_line_content": "\tarray_init(return_value);",
          "new_line_content": "\t\treturn 0;",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": "ZEND_PARSE_PARAMETERS_START",
          "new_api": null,
          "old_text": "ZEND_PARSE_PARAMETERS_START(1, 2)",
          "new_text": null,
          "old_line_content": "\tZEND_PARSE_PARAMETERS_START(1, 2)",
          "new_line_content": "\tzend_string *source;",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": "lex_scan",
          "new_api": null,
          "old_text": "lex_scan(&token, NULL)",
          "new_text": null,
          "old_line_content": "\twhile ((token_type = lex_scan(&token, NULL))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 272,
          "old_api": "Z_PARAM_STR",
          "new_api": null,
          "old_text": "Z_PARAM_STR(source)",
          "new_text": null,
          "old_line_content": "\t\tZ_PARAM_STR(source)",
          "new_line_content": "\tzend_long flags = 0;",
          "content_same": false
        },
        {
          "line": 148,
          "old_api": "Z_TYPE",
          "new_api": null,
          "old_text": "Z_TYPE(token)",
          "new_text": null,
          "old_line_content": "\t\tif (Z_TYPE(token) != IS_UNDEF) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 278,
          "old_api": "tokenize_parse",
          "new_api": null,
          "old_text": "tokenize_parse(return_value, source)",
          "new_text": null,
          "old_line_content": "\t\tsuccess = tokenize_parse(return_value, source);",
          "new_line_content": "\t\tZ_PARAM_LONG(flags)",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": "tokenize",
          "new_api": null,
          "old_text": "tokenize(return_value, source)",
          "new_text": null,
          "old_line_content": "\t\tsuccess = tokenize(return_value, source);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 161,
          "old_api": "add_token",
          "new_api": null,
          "old_text": "add_token(return_value, T_INLINE_HTML,\n\t\t\t\t\t\tzendcursor, zendlimit - zendcursor, token_line)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tadd_token(return_value, T_INLINE_HTML,",
          "new_line_content": "\t\t\t\t&& --need_tokens == 0",
          "content_same": false
        },
        {
          "line": 295,
          "old_api": "ZEND_PARSE_PARAMETERS_START",
          "new_api": null,
          "old_text": "ZEND_PARSE_PARAMETERS_START(1, 1)",
          "new_text": null,
          "old_line_content": "\tZEND_PARSE_PARAMETERS_START(1, 1)",
          "new_line_content": "PHP_FUNCTION(token_name)",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": "Z_PARAM_LONG",
          "new_api": null,
          "old_text": "Z_PARAM_LONG(type)",
          "new_text": null,
          "old_line_content": "\t\tZ_PARAM_LONG(type)",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": "ZEND_PARSE_PARAMETERS_END",
          "new_api": null,
          "old_text": "ZEND_PARSE_PARAMETERS_END()",
          "new_text": null,
          "old_line_content": "\tZEND_PARSE_PARAMETERS_END();",
          "new_line_content": "\tzend_long type;",
          "content_same": false
        },
        {
          "line": 170,
          "old_api": "CG",
          "new_api": null,
          "old_text": "CG(increment_lineno)",
          "new_text": null,
          "old_line_content": "\t\tif (CG(increment_lineno)) {",
          "new_line_content": "\t\t} else if (token_type == T_HALT_COMPILER) {",
          "content_same": false
        },
        {
          "line": 171,
          "old_api": "CG",
          "new_api": null,
          "old_text": "CG(zend_lineno)",
          "new_text": null,
          "old_line_content": "\t\t\tCG(zend_lineno)++;",
          "new_line_content": "\t\t\tneed_tokens = 3;",
          "content_same": false
        },
        {
          "line": 172,
          "old_api": "CG",
          "new_api": null,
          "old_text": "CG(increment_lineno)",
          "new_text": null,
          "old_line_content": "\t\t\tCG(increment_lineno) = 0;",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": "zval_ptr_dtor_str",
          "new_api": null,
          "old_text": "zval_ptr_dtor_str(&source_zval)",
          "new_text": null,
          "old_line_content": "\tzval_ptr_dtor_str(&source_zval);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": "LANG_SCNG",
          "new_api": null,
          "old_text": "LANG_SCNG(yy_leng)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (token == ';' && LANG_SCNG(yy_leng) > 1) { /* ?> or ?>\\n or ?>\\r\\n */",
          "new_line_content": "\t\tcase ON_TOKEN:",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": "LANG_SCNG",
          "new_api": null,
          "old_text": "LANG_SCNG(yy_leng)",
          "new_text": null,
          "old_line_content": "\t\t\t\t} else if (token == T_ECHO && LANG_SCNG(yy_leng) == sizeof(\"<?=\") - 1) {",
          "new_line_content": "\t\t\t\tif (token == END) break;",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": "LANG_SCNG",
          "new_api": null,
          "old_text": "LANG_SCNG(yy_leng)",
          "new_text": null,
          "old_line_content": "\t\t\t\tadd_token(token_stream, token, LANG_SCNG(yy_text), LANG_SCNG(yy_leng), line);",
          "new_line_content": "\t\t\t\t\ttoken = T_CLOSE_TAG;",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "zend_hash_num_elements",
          "new_api": null,
          "old_text": "zend_hash_num_elements(tokens_ht)",
          "new_text": null,
          "old_line_content": "\t\t\ttoken_zv = zend_hash_index_find(tokens_ht, zend_hash_num_elements(tokens_ht) - 1);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "Z_TYPE_P",
          "new_api": null,
          "old_text": "Z_TYPE_P(token_zv)",
          "new_text": null,
          "old_line_content": "\t\t\tif (token_zv && Z_TYPE_P(token_zv) == IS_ARRAY) {",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": "Z_ARRVAL_P",
          "new_api": null,
          "old_text": "Z_ARRVAL_P(token_zv)",
          "new_text": null,
          "old_line_content": "\t\t\t\tZVAL_LONG(zend_hash_index_find(Z_ARRVAL_P(token_zv), 0), token);",
          "new_line_content": "\t\tcase ON_FEEDBACK:",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "LANG_SCNG",
          "new_api": null,
          "old_text": "LANG_SCNG(yy_cursor)",
          "new_text": null,
          "old_line_content": "\t\t\t\tadd_token(token_stream, T_INLINE_HTML, LANG_SCNG(yy_cursor),",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": "CG",
          "new_api": null,
          "old_text": "CG(zend_lineno)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tLANG_SCNG(yy_limit) - LANG_SCNG(yy_cursor), CG(zend_lineno));",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": "CG",
          "new_api": null,
          "old_text": "CG(ast)",
          "new_text": null,
          "old_line_content": "\t\tzend_ast_destroy(CG(ast));",
          "new_line_content": "\t\t} else {",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": "ZVAL_STR_COPY",
          "new_api": null,
          "old_text": "ZVAL_STR_COPY(&source_zval, source)",
          "new_text": null,
          "old_line_content": "\tZVAL_STR_COPY(&source_zval, source);",
          "new_line_content": "\tzend_lex_state original_lex_state;",
          "content_same": false
        },
        {
          "line": 228,
          "old_api": "CG",
          "new_api": null,
          "old_text": "CG(in_compilation)",
          "new_text": null,
          "old_line_content": "\toriginal_in_compilation = CG(in_compilation);",
          "new_line_content": "\tzend_bool success;",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": "CG",
          "new_api": null,
          "old_text": "CG(in_compilation)",
          "new_text": null,
          "old_line_content": "\tCG(in_compilation) = 1;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": "zend_arena_create",
          "new_api": null,
          "old_text": "zend_arena_create(1024 * 32)",
          "new_text": null,
          "old_line_content": "\t\tCG(ast_arena) = zend_arena_create(1024 * 32);",
          "new_line_content": "\t\tzval token_stream;",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": "LANG_SCNG",
          "new_api": null,
          "old_text": "LANG_SCNG(on_event)",
          "new_text": null,
          "old_line_content": "\t\tLANG_SCNG(on_event) = on_event;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 113,
          "old_api": "add_next_index_stringl",
          "new_api": null,
          "old_text": "add_next_index_stringl(&keyword, (char *) text, leng)",
          "new_text": null,
          "old_line_content": "\t\tadd_next_index_stringl(&keyword, (char *) text, leng);",
          "new_line_content": "\t\tif (leng == 1) {",
          "content_same": false
        },
        {
          "line": 115,
          "old_api": "add_next_index_zval",
          "new_api": null,
          "old_text": "add_next_index_zval(return_value, &keyword)",
          "new_text": null,
          "old_line_content": "\t\tadd_next_index_zval(return_value, &keyword);",
          "new_line_content": "\t\t} else {",
          "content_same": false
        },
        {
          "line": 245,
          "old_api": "zval_ptr_dtor",
          "new_api": null,
          "old_text": "zval_ptr_dtor(&token_stream)",
          "new_text": null,
          "old_line_content": "\t\t\tzval_ptr_dtor(&token_stream);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 120,
          "old_api": "add_next_index_stringl",
          "new_api": null,
          "old_text": "add_next_index_stringl(return_value, (char *) text, leng)",
          "new_text": null,
          "old_line_content": "\t\t\tadd_next_index_stringl(return_value, (char *) text, leng);",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": "CG",
          "new_api": null,
          "old_text": "CG(in_compilation)",
          "new_text": null,
          "old_line_content": "\tCG(in_compilation) = original_in_compilation;",
          "new_line_content": "\t}",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 23,
      "total_additions": 39,
      "total_deletions": 38,
      "total_api_changes": 100
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 100,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          117
        ]
      }
    },
    "api_calls_before": 94,
    "api_calls_after": 96,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 1,
      "total_diff_lines": 18
    }
  }
}