{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/689504556518b823ba8d375853ca79bef70a2fed",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/689504556518b823ba8d375853ca79bef70a2fed/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/689504556518b823ba8d375853ca79bef70a2fed/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/689504556518b823ba8d375853ca79bef70a2fed/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 2036,
          "old_api": "strlen",
          "new_api": "TSRMLS_FETCH",
          "old_text": "strlen(op->value.str.val)",
          "new_text": "TSRMLS_FETCH()",
          "old_line_content": "\top->value.str.len = strlen(op->value.str.val);",
          "new_line_content": "\tTSRMLS_FETCH();",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 2020,
          "old_api": null,
          "new_api": "Z_OBJ_HANDLE_P",
          "old_text": null,
          "new_text": "Z_OBJ_HANDLE_P(o2)",
          "old_line_content": "",
          "new_line_content": "\tif (Z_OBJ_HANDLE_P(o1) == Z_OBJ_HANDLE_P(o2)) {",
          "content_same": false
        },
        {
          "line": 1990,
          "old_api": null,
          "new_api": "compare_function",
          "old_text": null,
          "new_text": "compare_function(&result, (zval *) *z1, (zval *) *z2 TSRMLS_CC)",
          "old_line_content": "}",
          "new_line_content": "\tif (compare_function(&result, (zval *) *z1, (zval *) *z2 TSRMLS_CC)==FAILURE) {",
          "content_same": false
        },
        {
          "line": 2025,
          "old_api": null,
          "new_api": "Z_OBJ_HT_P",
          "old_text": null,
          "new_text": "Z_OBJ_HT_P(o1)",
          "old_line_content": "\t}",
          "new_line_content": "\tif (Z_OBJ_HT_P(o1)->compare_objects == NULL) {",
          "content_same": false
        },
        {
          "line": 1964,
          "old_api": null,
          "new_api": "zend_finite",
          "old_text": null,
          "new_text": "zend_finite(dval1)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t} else if (dval1 == dval2 && !zend_finite(dval1)) {",
          "content_same": false
        },
        {
          "line": 2028,
          "old_api": null,
          "new_api": "compare_objects",
          "old_text": null,
          "new_text": "Z_OBJ_HT_P(o1)->compare_objects(o1, o2 TSRMLS_CC)",
          "old_line_content": "ZEND_API void zend_locale_sprintf_double(zval *op ZEND_FILE_LINE_DC)",
          "new_line_content": "\t\tresult->value.lval = Z_OBJ_HT_P(o1)->compare_objects(o1, o2 TSRMLS_CC);",
          "content_same": false
        },
        {
          "line": 1998,
          "old_api": null,
          "new_api": "zend_hash_compare",
          "old_text": null,
          "new_text": "zend_hash_compare(ht1, ht2, (compare_func_t) hash_zval_compare_function, 0 TSRMLS_CC)",
          "old_line_content": "",
          "new_line_content": "\treturn zend_hash_compare(ht1, ht2, (compare_func_t) hash_zval_compare_function, 0 TSRMLS_CC);",
          "content_same": false
        },
        {
          "line": 2039,
          "old_api": null,
          "new_api": "EG",
          "old_text": null,
          "new_text": "EG(precision)",
          "old_line_content": "/*",
          "new_line_content": "\tsprintf(op->value.str.val, \"%.*G\", (int) EG(precision), dval);",
          "content_same": false
        },
        {
          "line": 2006,
          "old_api": null,
          "new_api": "zend_hash_compare",
          "old_text": null,
          "new_text": "zend_hash_compare(ht1, ht2, (compare_func_t) hash_zval_compare_function, 0 TSRMLS_CC)",
          "old_line_content": "ZEND_API void zend_compare_arrays(zval *result, zval *a1, zval *a2 TSRMLS_DC)",
          "new_line_content": "\tresult->value.lval = zend_hash_compare(ht1, ht2, (compare_func_t) hash_zval_compare_function, 0 TSRMLS_CC);",
          "content_same": false
        },
        {
          "line": 2038,
          "old_api": null,
          "new_api": "EG",
          "old_text": null,
          "new_text": "EG(precision)",
          "old_line_content": "",
          "new_line_content": "\top->value.str.val = (char *) emalloc_rel(MAX_LENGTH_OF_DOUBLE + EG(precision) + 1);",
          "content_same": false
        },
        {
          "line": 2040,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(op->value.str.val)",
          "old_line_content": " * Local variables:",
          "new_line_content": "\top->value.str.len = strlen(op->value.str.val);",
          "content_same": false
        },
        {
          "line": 1978,
          "old_api": null,
          "new_api": "zend_binary_zval_strcmp",
          "old_text": null,
          "new_text": "zend_binary_zval_strcmp(s1, s2)",
          "old_line_content": "\treturn;\t",
          "new_line_content": "\t\tresult->value.lval = zend_binary_zval_strcmp(s1, s2);",
          "content_same": false
        },
        {
          "line": 1979,
          "old_api": null,
          "new_api": "ZEND_NORMALIZE_BOOL",
          "old_text": null,
          "new_text": "ZEND_NORMALIZE_BOOL(result->value.lval)",
          "old_line_content": "}",
          "new_line_content": "\t\tresult->value.lval = ZEND_NORMALIZE_BOOL(result->value.lval);",
          "content_same": false
        },
        {
          "line": 2012,
          "old_api": null,
          "new_api": "zend_compare_symbol_tables",
          "old_text": null,
          "new_text": "zend_compare_symbol_tables(result, a1->value.ht, a2->value.ht TSRMLS_CC)",
          "old_line_content": "ZEND_API void zend_compare_objects(zval *result, zval *o1, zval *o2 TSRMLS_DC)",
          "new_line_content": "\tzend_compare_symbol_tables(result, a1->value.ht, a2->value.ht TSRMLS_CC);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 2016,
          "old_api": "Z_OBJ_HANDLE_P",
          "new_api": null,
          "old_text": "Z_OBJ_HANDLE_P(o2)",
          "new_text": null,
          "old_line_content": "\tif (Z_OBJ_HANDLE_P(o1) == Z_OBJ_HANDLE_P(o2)) {",
          "new_line_content": "ZEND_API void zend_compare_objects(zval *result, zval *o1, zval *o2 TSRMLS_DC)",
          "content_same": false
        },
        {
          "line": 1986,
          "old_api": "compare_function",
          "new_api": null,
          "old_text": "compare_function(&result, (zval *) *z1, (zval *) *z2 TSRMLS_CC)",
          "new_text": null,
          "old_line_content": "\tif (compare_function(&result, (zval *) *z1, (zval *) *z2 TSRMLS_CC)==FAILURE) {",
          "new_line_content": "static int hash_zval_compare_function(const zval **z1, const zval **z2 TSRMLS_DC)",
          "content_same": false
        },
        {
          "line": 2021,
          "old_api": "Z_OBJ_HT_P",
          "new_api": null,
          "old_text": "Z_OBJ_HT_P(o1)",
          "new_text": null,
          "old_line_content": "\tif (Z_OBJ_HT_P(o1)->compare_objects == NULL) {",
          "new_line_content": "\t\tresult->value.lval = 0;",
          "content_same": false
        },
        {
          "line": 2024,
          "old_api": "compare_objects",
          "new_api": null,
          "old_text": "Z_OBJ_HT_P(o1)->compare_objects(o1, o2 TSRMLS_CC)",
          "new_text": null,
          "old_line_content": "\t\tresult->value.lval = Z_OBJ_HT_P(o1)->compare_objects(o1, o2 TSRMLS_CC);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1961,
          "old_api": "zend_strtod",
          "new_api": null,
          "old_text": "zend_strtod(s1->value.str.val, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\t\tdval1 = zend_strtod(s1->value.str.val, NULL);",
          "new_line_content": "\t\t\t\tdval1 = (double) lval1;",
          "content_same": false
        },
        {
          "line": 1994,
          "old_api": "zend_hash_compare",
          "new_api": null,
          "old_text": "zend_hash_compare(ht1, ht2, (compare_func_t) hash_zval_compare_function, 0 TSRMLS_CC)",
          "new_text": null,
          "old_line_content": "\treturn zend_hash_compare(ht1, ht2, (compare_func_t) hash_zval_compare_function, 0 TSRMLS_CC);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1963,
          "old_api": "zend_strtod",
          "new_api": null,
          "old_text": "zend_strtod(s2->value.str.val, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\t\tdval2 = zend_strtod(s2->value.str.val, NULL);",
          "new_line_content": "\t\t\t\tdval2 = (double) lval2;",
          "content_same": false
        },
        {
          "line": 1966,
          "old_api": "ZEND_NORMALIZE_BOOL",
          "new_api": null,
          "old_text": "ZEND_NORMALIZE_BOOL(result->value.dval)",
          "new_text": null,
          "old_line_content": "\t\t\tresult->value.lval = ZEND_NORMALIZE_BOOL(result->value.dval);",
          "new_line_content": "\t\t\t\t * so a numeric comparison would be inaccurate */",
          "content_same": false
        },
        {
          "line": 2032,
          "old_api": "TSRMLS_FETCH",
          "new_api": null,
          "old_text": "TSRMLS_FETCH()",
          "new_text": null,
          "old_line_content": "\tTSRMLS_FETCH();",
          "new_line_content": "ZEND_API void zend_locale_sprintf_double(zval *op ZEND_FILE_LINE_DC)",
          "content_same": false
        },
        {
          "line": 2002,
          "old_api": "zend_hash_compare",
          "new_api": null,
          "old_text": "zend_hash_compare(ht1, ht2, (compare_func_t) hash_zval_compare_function, 0 TSRMLS_CC)",
          "new_text": null,
          "old_line_content": "\tresult->value.lval = zend_hash_compare(ht1, ht2, (compare_func_t) hash_zval_compare_function, 0 TSRMLS_CC);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2034,
          "old_api": "EG",
          "new_api": null,
          "old_text": "EG(precision)",
          "new_text": null,
          "old_line_content": "\top->value.str.val = (char *) emalloc_rel(MAX_LENGTH_OF_DOUBLE + EG(precision) + 1);",
          "new_line_content": "\tdouble dval = op->value.dval;",
          "content_same": false
        },
        {
          "line": 2035,
          "old_api": "EG",
          "new_api": null,
          "old_text": "EG(precision)",
          "new_text": null,
          "old_line_content": "\tsprintf(op->value.str.val, \"%.*G\", (int) EG(precision), dval);",
          "new_line_content": "\t",
          "content_same": false
        },
        {
          "line": 1974,
          "old_api": "zend_binary_zval_strcmp",
          "new_api": null,
          "old_text": "zend_binary_zval_strcmp(s1, s2)",
          "new_text": null,
          "old_line_content": "\t\tresult->value.lval = zend_binary_zval_strcmp(s1, s2);",
          "new_line_content": "\t\t\tresult->type = IS_LONG;",
          "content_same": false
        },
        {
          "line": 1975,
          "old_api": "ZEND_NORMALIZE_BOOL",
          "new_api": null,
          "old_text": "ZEND_NORMALIZE_BOOL(result->value.lval)",
          "new_text": null,
          "old_line_content": "\t\tresult->value.lval = ZEND_NORMALIZE_BOOL(result->value.lval);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 2008,
          "old_api": "zend_compare_symbol_tables",
          "new_api": null,
          "old_text": "zend_compare_symbol_tables(result, a1->value.ht, a2->value.ht TSRMLS_CC)",
          "new_text": null,
          "old_line_content": "\tzend_compare_symbol_tables(result, a1->value.ht, a2->value.ht TSRMLS_CC);",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 1,
      "total_additions": 13,
      "total_deletions": 15,
      "total_api_changes": 29
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 10,
        "api_related_lines": 29,
        "non_api_lines": 6,
        "non_api_line_numbers": [
          1965,
          1967,
          1969,
          1970,
          1973,
          1977
        ]
      }
    },
    "api_calls_before": 413,
    "api_calls_after": 411,
    "diff_info": {
      "added_lines": 8,
      "removed_lines": 4,
      "total_diff_lines": 33
    }
  }
}