{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/0a69e142787d77ac521ab9ed81f5211a21d246fb",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/0a69e142787d77ac521ab9ed81f5211a21d246fb/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/0a69e142787d77ac521ab9ed81f5211a21d246fb/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/0a69e142787d77ac521ab9ed81f5211a21d246fb/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1279,
          "old_api": "phar_free_alias",
          "new_api": "PHAR_G",
          "old_text": "phar_free_alias(fd_ptr, alias, alias_len)",
          "new_text": "PHAR_G(phar_alias_map)",
          "old_line_content": "\t\t\tif (SUCCESS != phar_free_alias(fd_ptr, alias, alias_len)) {",
          "new_line_content": "\t\tif (NULL != (fd_ptr = zend_hash_str_find_ptr(&(PHAR_G(phar_alias_map)), alias, alias_len))) {",
          "content_same": false
        },
        {
          "line": 1292,
          "old_api": "zend_string_release",
          "new_api": "PHAR_G",
          "old_text": "zend_string_release(str)",
          "new_text": "PHAR_G(phar_alias_map)",
          "old_line_content": "\t\tzend_string_release(str);",
          "new_line_content": "\t\tzend_hash_add_ptr(&(PHAR_G(phar_alias_map)), str, mydata);",
          "content_same": false
        },
        {
          "line": 1303,
          "old_api": "zend_string_release",
          "new_api": "PHAR_G",
          "old_text": "zend_string_release(str)",
          "new_text": "PHAR_G(phar_fname_map)",
          "old_line_content": "\tzend_string_release(str);",
          "new_line_content": "\tzend_hash_add_ptr(&(PHAR_G(phar_fname_map)), str, mydata);",
          "content_same": false
        },
        {
          "line": 1304,
          "old_api": "efree",
          "new_api": "zend_string_release",
          "old_text": "efree(savebuf)",
          "new_text": "zend_string_release(str)",
          "old_line_content": "\tefree(savebuf);",
          "new_line_content": "\tzend_string_release(str);",
          "content_same": false
        },
        {
          "line": 1362,
          "old_api": "spprintf",
          "new_api": "zend_hash_str_find_ptr",
          "old_text": "spprintf(error, 0, \"'%s' is not a phar archive. Use PharData::__construct() for a standard zip or tar archive\", fname)",
          "new_text": "zend_hash_str_find_ptr(&((*test)->manifest), \".phar/stub.php\", sizeof(\".phar/stub.php\")-1)",
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"'%s' is not a phar archive. Use PharData::__construct() for a standard zip or tar archive\", fname);",
          "new_line_content": "\t\t\tif (NULL == (stub = zend_hash_str_find_ptr(&((*test)->manifest), \".phar/stub.php\", sizeof(\".phar/stub.php\")-1))) {",
          "content_same": false
        },
        {
          "line": 1415,
          "old_api": "ZSTR_LEN",
          "new_api": "ZSTR_VAL",
          "old_text": "ZSTR_LEN(actual)",
          "new_text": "ZSTR_VAL(actual)",
          "old_line_content": "\t\tfname_len = ZSTR_LEN(actual);",
          "new_line_content": "\t\tfname = ZSTR_VAL(actual);",
          "content_same": false
        },
        {
          "line": 1420,
          "old_api": "PHAR_G",
          "new_api": "phar_open_from_fp",
          "old_text": "PHAR_G(readonly)",
          "new_text": "phar_open_from_fp(fp, fname, fname_len, alias, alias_len, options, pphar, error)",
          "old_line_content": "\t\t\tif ((*pphar)->is_data || !PHAR_G(readonly)) {",
          "new_line_content": "\t\tif (phar_open_from_fp(fp, fname, fname_len, alias, alias_len, options, pphar, error) == SUCCESS) {",
          "content_same": false
        },
        {
          "line": 1451,
          "old_api": "expand_filepath",
          "new_api": "ecalloc",
          "old_text": "expand_filepath(fname, NULL)",
          "new_text": "ecalloc(1, sizeof(phar_archive_data))",
          "old_line_content": "\tmydata->fname = expand_filepath(fname, NULL);",
          "new_line_content": "\tmydata = ecalloc(1, sizeof(phar_archive_data));",
          "content_same": false
        },
        {
          "line": 1489,
          "old_api": "PHAR_G",
          "new_api": "phar_request_initialize",
          "old_text": "PHAR_G(phar_fname_map)",
          "new_text": "phar_request_initialize()",
          "old_line_content": "\tzend_hash_str_add_ptr(&(PHAR_G(phar_fname_map)), mydata->fname, fname_len, mydata);",
          "new_line_content": "\tphar_request_initialize();",
          "content_same": false
        },
        {
          "line": 1501,
          "old_api": "phar_free_alias",
          "new_api": "PHAR_G",
          "old_text": "phar_free_alias(fd_ptr, alias, alias_len)",
          "new_text": "PHAR_G(phar_alias_map)",
          "old_line_content": "\t\t\tif (SUCCESS != phar_free_alias(fd_ptr, alias, alias_len)) {",
          "new_line_content": "\t\tif (alias && NULL != (fd_ptr = zend_hash_str_find_ptr(&(PHAR_G(phar_alias_map)), alias, alias_len))) {",
          "content_same": false
        },
        {
          "line": 1517,
          "old_api": "estrndup",
          "new_api": "ZEND_ASSERT",
          "old_text": "estrndup(mydata->fname, fname_len)",
          "new_text": "ZEND_ASSERT(!mydata->is_persistent)",
          "old_line_content": "\t\tmydata->alias = alias ? estrndup(alias, alias_len) : estrndup(mydata->fname, fname_len);",
          "new_line_content": "\t\tZEND_ASSERT(!mydata->is_persistent);",
          "content_same": false
        },
        {
          "line": 1589,
          "old_api": "ZSTR_LEN",
          "new_api": "ZSTR_VAL",
          "old_text": "ZSTR_LEN(actual)",
          "new_text": "ZSTR_VAL(actual)",
          "old_line_content": "\t\tfname_len = ZSTR_LEN(actual);",
          "new_line_content": "\t\tfname = ZSTR_VAL(actual);",
          "content_same": false
        },
        {
          "line": 1657,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": "php_stream_rewind",
          "old_text": "MAPPHAR_ALLOC_FAIL(\"cannot rewind phar \\\"%s\\\"\")",
          "new_text": "php_stream_rewind(fp)",
          "old_line_content": "\t\tMAPPHAR_ALLOC_FAIL(\"cannot rewind phar \\\"%s\\\"\")",
          "new_line_content": "\tif (-1 == php_stream_rewind(fp)) {",
          "content_same": false
        },
        {
          "line": 1667,
          "old_api": "php_stream_read",
          "new_api": "php_stream_eof",
          "old_text": "php_stream_read(fp, buffer+tokenlen, readsize)",
          "new_text": "php_stream_eof(fp)",
          "old_line_content": "\t\tif ((got = php_stream_read(fp, buffer+tokenlen, readsize)) < (size_t) tokenlen) {",
          "new_line_content": "\twhile(!php_stream_eof(fp)) {",
          "content_same": false
        },
        {
          "line": 1668,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": "php_stream_read",
          "old_text": "MAPPHAR_ALLOC_FAIL(\"internal corruption of phar \\\"%s\\\" (truncated entry)\")",
          "new_text": "php_stream_read(fp, buffer+tokenlen, readsize)",
          "old_line_content": "\t\t\tMAPPHAR_ALLOC_FAIL(\"internal corruption of phar \\\"%s\\\" (truncated entry)\")",
          "new_line_content": "\t\tif ((got = php_stream_read(fp, buffer+tokenlen, readsize)) < (size_t) tokenlen) {",
          "content_same": false
        },
        {
          "line": 1682,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": "PHAR_G",
          "old_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\" to temporary file, enable zlib extension in php.ini\")",
          "new_text": "PHAR_G(has_zlib)",
          "old_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\" to temporary file, enable zlib extension in php.ini\")",
          "new_line_content": "\t\t\t\tif (!PHAR_G(has_zlib)) {",
          "content_same": false
        },
        {
          "line": 1693,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": "php_stream_fopen_tmpfile",
          "old_text": "MAPPHAR_ALLOC_FAIL(\"unable to create temporary file for decompression of gzipped phar archive \\\"%s\\\"\")",
          "new_text": "php_stream_fopen_tmpfile()",
          "old_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to create temporary file for decompression of gzipped phar archive \\\"%s\\\"\")",
          "new_line_content": "\t\t\t\tif (!(temp = php_stream_fopen_tmpfile())) {",
          "content_same": false
        },
        {
          "line": 1697,
          "old_api": "php_stream_is_persistent",
          "new_api": "php_stream_rewind",
          "old_text": "php_stream_is_persistent(fp)",
          "new_text": "php_stream_rewind(fp)",
          "old_line_content": "\t\t\t\tfilter = php_stream_filter_create(\"zlib.inflate\", &filterparams, php_stream_is_persistent(fp));",
          "new_line_content": "\t\t\t\tphp_stream_rewind(fp);",
          "content_same": false
        },
        {
          "line": 1702,
          "old_api": "php_stream_is_persistent",
          "new_api": "add_assoc_long_ex",
          "old_text": "php_stream_is_persistent(fp)",
          "new_text": "add_assoc_long_ex(&filterparams, \"window\", sizeof(\"window\") - 1, MAX_WBITS)",
          "old_line_content": "\t\t\t\t\tfilter = php_stream_filter_create(\"zlib.inflate\", &filterparams, php_stream_is_persistent(fp));",
          "new_line_content": "\t\t\t\t\tadd_assoc_long_ex(&filterparams, \"window\", sizeof(\"window\") - 1, MAX_WBITS);",
          "content_same": false
        },
        {
          "line": 1703,
          "old_api": "Z_ARR",
          "new_api": "php_stream_is_persistent",
          "old_text": "Z_ARR(filterparams)",
          "new_text": "php_stream_is_persistent(fp)",
          "old_line_content": "\t\t\t\t\tzend_array_destroy(Z_ARR(filterparams));",
          "new_line_content": "\t\t\t\t\tfilter = php_stream_filter_create(\"zlib.inflate\", &filterparams, php_stream_is_persistent(fp));",
          "content_same": false
        },
        {
          "line": 1707,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": "php_stream_close",
          "old_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\", ext/zlib is buggy in PHP versions older than 5.2.6\")",
          "new_text": "php_stream_close(temp)",
          "old_line_content": "\t\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\", ext/zlib is buggy in PHP versions older than 5.2.6\")",
          "new_line_content": "\t\t\t\t\t\tphp_stream_close(temp);",
          "content_same": false
        },
        {
          "line": 1718,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": "php_stream_close",
          "old_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\", ext/zlib is buggy in PHP versions older than 5.2.6\")",
          "new_text": "php_stream_close(temp)",
          "old_line_content": "\t\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\", ext/zlib is buggy in PHP versions older than 5.2.6\")",
          "new_line_content": "\t\t\t\t\t\tphp_stream_close(temp);",
          "content_same": false
        },
        {
          "line": 1721,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": "php_stream_close",
          "old_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\" to temporary file\")",
          "new_text": "php_stream_close(temp)",
          "old_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\" to temporary file\")",
          "new_line_content": "\t\t\t\t\tphp_stream_close(temp);",
          "content_same": false
        },
        {
          "line": 1725,
          "old_api": "php_stream_filter_remove",
          "new_api": "php_stream_filter_flush",
          "old_text": "php_stream_filter_remove(filter, 1)",
          "new_text": "php_stream_filter_flush(filter, 1)",
          "old_line_content": "\t\t\t\tphp_stream_filter_remove(filter, 1);",
          "new_line_content": "\t\t\t\tphp_stream_filter_flush(filter, 1);",
          "content_same": false
        },
        {
          "line": 1726,
          "old_api": "php_stream_close",
          "new_api": "php_stream_filter_remove",
          "old_text": "php_stream_close(fp)",
          "new_text": "php_stream_filter_remove(filter, 1)",
          "old_line_content": "\t\t\t\tphp_stream_close(fp);",
          "new_line_content": "\t\t\t\tphp_stream_filter_remove(filter, 1);",
          "content_same": false
        },
        {
          "line": 1743,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": "PHAR_G",
          "old_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\" to temporary file, enable bz2 extension in php.ini\")",
          "new_text": "PHAR_G(has_bz2)",
          "old_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\" to temporary file, enable bz2 extension in php.ini\")",
          "new_line_content": "\t\t\t\tif (!PHAR_G(has_bz2)) {",
          "content_same": false
        },
        {
          "line": 1748,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": "php_stream_fopen_tmpfile",
          "old_text": "MAPPHAR_ALLOC_FAIL(\"unable to create temporary file for decompression of bzipped phar archive \\\"%s\\\"\")",
          "new_text": "php_stream_fopen_tmpfile()",
          "old_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to create temporary file for decompression of bzipped phar archive \\\"%s\\\"\")",
          "new_line_content": "\t\t\t\tif (!(temp = php_stream_fopen_tmpfile())) {",
          "content_same": false
        },
        {
          "line": 1752,
          "old_api": "php_stream_is_persistent",
          "new_api": "php_stream_rewind",
          "old_text": "php_stream_is_persistent(fp)",
          "new_text": "php_stream_rewind(fp)",
          "old_line_content": "\t\t\t\tfilter = php_stream_filter_create(\"bzip2.decompress\", NULL, php_stream_is_persistent(fp));",
          "new_line_content": "\t\t\t\tphp_stream_rewind(fp);",
          "content_same": false
        },
        {
          "line": 1756,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": "php_stream_close",
          "old_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\", filter creation failed\")",
          "new_text": "php_stream_close(temp)",
          "old_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\", filter creation failed\")",
          "new_line_content": "\t\t\t\t\tphp_stream_close(temp);",
          "content_same": false
        },
        {
          "line": 1762,
          "old_api": "php_stream_close",
          "new_api": "php_stream_copy_to_stream_ex",
          "old_text": "php_stream_close(temp)",
          "new_text": "php_stream_copy_to_stream_ex(fp, temp, PHP_STREAM_COPY_ALL, NULL)",
          "old_line_content": "\t\t\t\t\tphp_stream_close(temp);",
          "new_line_content": "\t\t\t\tif (SUCCESS != php_stream_copy_to_stream_ex(fp, temp, PHP_STREAM_COPY_ALL, NULL)) {",
          "content_same": false
        },
        {
          "line": 1763,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": "php_stream_close",
          "old_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\" to temporary file\")",
          "new_text": "php_stream_close(temp)",
          "old_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\" to temporary file\")",
          "new_line_content": "\t\t\t\t\tphp_stream_close(temp);",
          "content_same": false
        },
        {
          "line": 1767,
          "old_api": "php_stream_filter_remove",
          "new_api": "php_stream_filter_flush",
          "old_text": "php_stream_filter_remove(filter, 1)",
          "new_text": "php_stream_filter_flush(filter, 1)",
          "old_line_content": "\t\t\t\tphp_stream_filter_remove(filter, 1);",
          "new_line_content": "\t\t\t\tphp_stream_filter_flush(filter, 1);",
          "content_same": false
        },
        {
          "line": 1768,
          "old_api": "php_stream_close",
          "new_api": "php_stream_filter_remove",
          "old_text": "php_stream_close(fp)",
          "new_text": "php_stream_filter_remove(filter, 1)",
          "old_line_content": "\t\t\t\tphp_stream_close(fp);",
          "new_line_content": "\t\t\t\tphp_stream_filter_remove(filter, 1);",
          "content_same": false
        },
        {
          "line": 1783,
          "old_api": "php_stream_seek",
          "new_api": "memcmp",
          "old_text": "php_stream_seek(fp, 0, SEEK_END)",
          "new_text": "memcmp(pos, zip_magic, 4)",
          "old_line_content": "\t\t\t\tphp_stream_seek(fp, 0, SEEK_END);",
          "new_line_content": "\t\t\tif (!memcmp(pos, zip_magic, 4)) {",
          "content_same": false
        },
        {
          "line": 1784,
          "old_api": "phar_parse_zipfile",
          "new_api": "php_stream_seek",
          "old_text": "phar_parse_zipfile(fp, fname, fname_len, alias, alias_len, pphar, error)",
          "new_text": "php_stream_seek(fp, 0, SEEK_END)",
          "old_line_content": "\t\t\t\treturn phar_parse_zipfile(fp, fname, fname_len, alias, alias_len, pphar, error);",
          "new_line_content": "\t\t\t\tphp_stream_seek(fp, 0, SEEK_END);",
          "content_same": false
        },
        {
          "line": 1789,
          "old_api": "php_stream_rewind",
          "new_api": "phar_is_tar",
          "old_text": "php_stream_rewind(fp)",
          "new_text": "phar_is_tar(pos, fname)",
          "old_line_content": "\t\t\t\t\tphp_stream_rewind(fp);",
          "new_line_content": "\t\t\t\tif (phar_is_tar(pos, fname)) {",
          "content_same": false
        },
        {
          "line": 1790,
          "old_api": "phar_parse_tarfile",
          "new_api": "php_stream_rewind",
          "old_text": "phar_parse_tarfile(fp, fname, fname_len, alias, alias_len, pphar, compression, error)",
          "new_text": "php_stream_rewind(fp)",
          "old_line_content": "\t\t\t\t\treturn phar_parse_tarfile(fp, fname, fname_len, alias, alias_len, pphar, compression, error);",
          "new_line_content": "\t\t\t\t\tphp_stream_rewind(fp);",
          "content_same": false
        },
        {
          "line": 1828,
          "old_api": "efree",
          "new_api": "strlen",
          "old_text": "efree(realpath)",
          "new_text": "strlen(realpath)",
          "old_line_content": "\t\t\tefree(realpath);",
          "new_line_content": "\t\tif (zend_hash_str_exists(&(PHAR_G(phar_fname_map)), realpath, strlen(realpath))) {",
          "content_same": false
        },
        {
          "line": 1834,
          "old_api": "efree",
          "new_api": "strlen",
          "old_text": "efree(realpath)",
          "new_text": "strlen(realpath)",
          "old_line_content": "\t\t\tefree(realpath);",
          "new_line_content": "\t\tif (PHAR_G(manifest_cached) && zend_hash_str_exists(&cached_phars, realpath, strlen(realpath))) {",
          "content_same": false
        },
        {
          "line": 1871,
          "old_api": "efree",
          "new_api": "expand_filepath",
          "old_text": "efree(filename)",
          "new_text": "expand_filepath(filename, NULL)",
          "old_line_content": "\t\t\t\t\tefree(filename);",
          "new_line_content": "\t\t\t\tif (!(realpath = expand_filepath(filename, NULL))) {",
          "content_same": false
        },
        {
          "line": 1893,
          "old_api": "efree",
          "new_api": "php_stream_stat_path",
          "old_text": "efree(realpath)",
          "new_text": "php_stream_stat_path(realpath, &ssb)",
          "old_line_content": "\t\t\t\t\tefree(realpath);",
          "new_line_content": "\t\t\t\tif (SUCCESS != php_stream_stat_path(realpath, &ssb)) {",
          "content_same": false
        },
        {
          "line": 2041,
          "old_api": "ZSTR_LEN",
          "new_api": "PHAR_G",
          "old_text": "ZSTR_LEN(str_key)",
          "new_text": "PHAR_G(phar_fname_map)",
          "old_line_content": "\t\t\t\tif (ZSTR_LEN(str_key) > filename_len) {",
          "new_line_content": "\t\t\tZEND_HASH_MAP_FOREACH_STR_KEY_PTR(&PHAR_G(phar_fname_map), str_key, pphar) {",
          "content_same": false
        },
        {
          "line": 2053,
          "old_api": "ZEND_HASH_MAP_FOREACH_STR_KEY_PTR",
          "new_api": "PHAR_G",
          "old_text": "ZEND_HASH_MAP_FOREACH_STR_KEY_PTR(&cached_phars, str_key, pphar)",
          "new_text": "PHAR_G(manifest_cached)",
          "old_line_content": "\t\t\t\tZEND_HASH_MAP_FOREACH_STR_KEY_PTR(&cached_phars, str_key, pphar) {",
          "new_line_content": "\t\t\tif (PHAR_G(manifest_cached)) {",
          "content_same": false
        },
        {
          "line": 2054,
          "old_api": "ZSTR_LEN",
          "new_api": "ZEND_HASH_MAP_FOREACH_STR_KEY_PTR",
          "old_text": "ZSTR_LEN(str_key)",
          "new_text": "ZEND_HASH_MAP_FOREACH_STR_KEY_PTR(&cached_phars, str_key, pphar)",
          "old_line_content": "\t\t\t\t\tif (ZSTR_LEN(str_key) > filename_len) {",
          "new_line_content": "\t\t\t\tZEND_HASH_MAP_FOREACH_STR_KEY_PTR(&cached_phars, str_key, pphar) {",
          "content_same": false
        },
        {
          "line": 2145,
          "old_api": "strlen",
          "new_api": "PHAR_G",
          "old_text": "strlen(path)",
          "new_text": "PHAR_G(cwd_len)",
          "old_line_content": "\t\tnewpath = emalloc(strlen(path) + newpath_len + 1);",
          "new_line_content": "\t\tnewpath_len = PHAR_G(cwd_len);",
          "content_same": false
        },
        {
          "line": 2146,
          "old_api": "PHAR_G",
          "new_api": "strlen",
          "old_text": "PHAR_G(cwd)",
          "new_text": "strlen(path)",
          "old_line_content": "\t\tmemcpy(newpath, PHAR_G(cwd), newpath_len);",
          "new_line_content": "\t\tnewpath = emalloc(strlen(path) + newpath_len + 1);",
          "content_same": false
        },
        {
          "line": 2172,
          "old_api": "estrndup",
          "new_api": "efree",
          "old_text": "estrndup(\"/\", 1)",
          "new_text": "efree(newpath)",
          "old_line_content": "\t\t\t\t\treturn estrndup(\"/\", 1);",
          "new_line_content": "\t\t\t\t\tefree(newpath);",
          "content_same": false
        },
        {
          "line": 2180,
          "old_api": "estrndup",
          "new_api": "efree",
          "old_text": "estrndup(\"/\", 1)",
          "new_text": "efree(newpath)",
          "old_line_content": "\t\t\t\t\treturn estrndup(\"/\", 1);",
          "new_line_content": "\t\t\t\t\tefree(newpath);",
          "content_same": false
        },
        {
          "line": 2191,
          "old_api": "IS_BACKSLASH",
          "new_api": "IS_DIRECTORY_UP",
          "old_text": "IS_BACKSLASH(newpath[newpath_len - 1])",
          "new_text": "IS_DIRECTORY_UP(tok, ptr_length)",
          "old_line_content": "\t\t\twhile (newpath_len > 1 && !IS_BACKSLASH(newpath[newpath_len - 1])) {",
          "new_line_content": "\t\tif (IS_DIRECTORY_UP(tok, ptr_length)) {",
          "content_same": false
        },
        {
          "line": 2268,
          "old_api": "estrndup",
          "new_api": "memchr",
          "old_text": "estrndup(filename, filename_len)",
          "new_text": "memchr(filename, '\\\\', filename_len)",
          "old_line_content": "\t\tfilename = estrndup(filename, filename_len);",
          "new_line_content": "\tif (memchr(filename, '\\\\', filename_len)) {",
          "content_same": false
        },
        {
          "line": 2269,
          "old_api": "phar_unixify_path_separators",
          "new_api": "estrndup",
          "old_text": "phar_unixify_path_separators((char *)filename, filename_len)",
          "new_text": "estrndup(filename, filename_len)",
          "old_line_content": "\t\tphar_unixify_path_separators((char *)filename, filename_len);",
          "new_line_content": "\t\tfilename = estrndup(filename, filename_len);",
          "content_same": false
        },
        {
          "line": 2400,
          "old_api": "ZSTR_VAL",
          "new_api": "phar_open_archive_fp",
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": "phar_open_archive_fp(idata->phar)",
          "old_line_content": "\t\t\tspprintf(error, 0, \"phar error: unable to open zip-based phar archive \\\"%s\\\" to verify local file header for file \\\"%s\\\"\", idata->phar->fname, ZSTR_VAL(entry->filename));",
          "new_line_content": "\t\tif (SUCCESS != phar_open_archive_fp(idata->phar)) {",
          "content_same": false
        },
        {
          "line": 2413,
          "old_api": "phar_get_entrypfp",
          "new_api": "PHAR_ZIP_16",
          "old_text": "phar_get_entrypfp(idata->internal_file)",
          "new_text": "PHAR_ZIP_16(local.flags)",
          "old_line_content": "\t\t\tphp_stream_seek(phar_get_entrypfp(idata->internal_file),",
          "new_line_content": "\t\tif (((PHAR_ZIP_16(local.flags)) & 0x8) == 0x8) {",
          "content_same": false
        },
        {
          "line": 2432,
          "old_api": "ZSTR_VAL",
          "new_api": "PHAR_ZIP_32",
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": "PHAR_ZIP_32(local.compsize)",
          "old_line_content": "\t\t\tspprintf(error, 0, \"phar error: internal corruption of zip-based phar \\\"%s\\\" (local header of file \\\"%s\\\" does not match central directory)\", idata->phar->fname, ZSTR_VAL(entry->filename));",
          "new_line_content": "\t\tif (ZSTR_LEN(entry->filename) != PHAR_ZIP_16(local.filename_len) || entry->crc32 != PHAR_ZIP_32(local.crc32) || entry->uncompressed_filesize != PHAR_ZIP_32(local.uncompsize) || entry->compressed_filesize != PHAR_ZIP_32(local.compsize)) {",
          "content_same": false
        },
        {
          "line": 2452,
          "old_api": "php_crc32_stream_bulk_update",
          "new_api": "php_crc32_bulk_init",
          "old_text": "php_crc32_stream_bulk_update(&crc, fp, idata->internal_file->uncompressed_filesize)",
          "new_text": "php_crc32_bulk_init()",
          "old_line_content": "\tzend_result ret = php_crc32_stream_bulk_update(&crc, fp, idata->internal_file->uncompressed_filesize);",
          "new_line_content": "\tuint32_t crc = php_crc32_bulk_init();",
          "content_same": false
        },
        {
          "line": 2634,
          "old_api": "php_stream_write",
          "new_api": "ZSTR_VAL",
          "old_text": "php_stream_write(newfile, end_sequence, end_sequence_len)",
          "new_text": "ZSTR_VAL(user_stub)",
          "old_line_content": "\t\t\t|| end_sequence_len != php_stream_write(newfile, end_sequence, end_sequence_len)",
          "new_line_content": "\t\t\tlen != php_stream_write(newfile, ZSTR_VAL(user_stub), len)",
          "content_same": false
        },
        {
          "line": 2655,
          "old_api": "ZSTR_LEN",
          "new_api": "phar_create_default_stub",
          "old_text": "ZSTR_LEN(new_stub)",
          "new_text": "phar_create_default_stub(NULL, NULL, NULL)",
          "old_line_content": "\t\t\tphar->halt_offset = ZSTR_LEN(new_stub);",
          "new_line_content": "\t\t\tnew_stub = phar_create_default_stub(NULL, NULL, NULL);",
          "content_same": false
        },
        {
          "line": 2656,
          "old_api": "ZSTR_VAL",
          "new_api": "ZSTR_LEN",
          "old_text": "ZSTR_VAL(new_stub)",
          "new_text": "ZSTR_LEN(new_stub)",
          "old_line_content": "\t\t\twritten = php_stream_write(newfile, ZSTR_VAL(new_stub), phar->halt_offset);",
          "new_line_content": "\t\t\tphar->halt_offset = ZSTR_LEN(new_stub);",
          "content_same": false
        },
        {
          "line": 2691,
          "old_api": "Z_ISUNDEF",
          "new_api": "ZSTR_LEN",
          "old_text": "Z_ISUNDEF(phar->metadata_tracker.val)",
          "new_text": "ZSTR_LEN(phar->metadata_tracker.str)",
          "old_line_content": "\t} else if (!Z_ISUNDEF(phar->metadata_tracker.val)) {",
          "new_line_content": "\t\tsmart_str_appendl(&main_metadata_str, ZSTR_VAL(phar->metadata_tracker.str), ZSTR_LEN(phar->metadata_tracker.str));",
          "content_same": false
        },
        {
          "line": 2692,
          "old_api": "PHP_VAR_SERIALIZE_INIT",
          "new_api": "Z_ISUNDEF",
          "old_text": "PHP_VAR_SERIALIZE_INIT(metadata_hash)",
          "new_text": "Z_ISUNDEF(phar->metadata_tracker.val)",
          "old_line_content": "\t\tPHP_VAR_SERIALIZE_INIT(metadata_hash);",
          "new_line_content": "\t} else if (!Z_ISUNDEF(phar->metadata_tracker.val)) {",
          "content_same": false
        },
        {
          "line": 2693,
          "old_api": "php_var_serialize",
          "new_api": "PHP_VAR_SERIALIZE_INIT",
          "old_text": "php_var_serialize(&main_metadata_str, &phar->metadata_tracker.val, &metadata_hash)",
          "new_text": "PHP_VAR_SERIALIZE_INIT(metadata_hash)",
          "old_line_content": "\t\tphp_var_serialize(&main_metadata_str, &phar->metadata_tracker.val, &metadata_hash);",
          "new_line_content": "\t\tPHP_VAR_SERIALIZE_INIT(metadata_hash);",
          "content_same": false
        },
        {
          "line": 2694,
          "old_api": "PHP_VAR_SERIALIZE_DESTROY",
          "new_api": "php_var_serialize",
          "old_text": "PHP_VAR_SERIALIZE_DESTROY(metadata_hash)",
          "new_text": "php_var_serialize(&main_metadata_str, &phar->metadata_tracker.val, &metadata_hash)",
          "old_line_content": "\t\tPHP_VAR_SERIALIZE_DESTROY(metadata_hash);",
          "new_line_content": "\t\tphp_var_serialize(&main_metadata_str, &phar->metadata_tracker.val, &metadata_hash);",
          "content_same": false
        },
        {
          "line": 2729,
          "old_api": "ZEND_ASSERT",
          "new_api": "Z_ISUNDEF",
          "old_text": "ZEND_ASSERT(!entry->is_persistent)",
          "new_text": "Z_ISUNDEF(entry->metadata_tracker.val)",
          "old_line_content": "\t\t\tZEND_ASSERT(!entry->is_persistent);",
          "new_line_content": "\t\tif (!Z_ISUNDEF(entry->metadata_tracker.val) && !entry->metadata_tracker.str) {",
          "content_same": false
        },
        {
          "line": 2733,
          "old_api": "php_var_serialize",
          "new_api": "PHP_VAR_SERIALIZE_INIT",
          "old_text": "php_var_serialize(&buf, &entry->metadata_tracker.val, &metadata_hash)",
          "new_text": "PHP_VAR_SERIALIZE_INIT(metadata_hash)",
          "old_line_content": "\t\t\tphp_var_serialize(&buf, &entry->metadata_tracker.val, &metadata_hash);",
          "new_line_content": "\t\t\tPHP_VAR_SERIALIZE_INIT(metadata_hash);",
          "content_same": false
        },
        {
          "line": 2734,
          "old_api": "PHP_VAR_SERIALIZE_DESTROY",
          "new_api": "php_var_serialize",
          "old_text": "PHP_VAR_SERIALIZE_DESTROY(metadata_hash)",
          "new_text": "php_var_serialize(&buf, &entry->metadata_tracker.val, &metadata_hash)",
          "old_line_content": "\t\t\tPHP_VAR_SERIALIZE_DESTROY(metadata_hash);",
          "new_line_content": "\t\t\tphp_var_serialize(&buf, &entry->metadata_tracker.val, &metadata_hash);",
          "content_same": false
        },
        {
          "line": 2761,
          "old_api": "phar_seek_efp",
          "new_api": "phar_get_efp",
          "old_text": "phar_seek_efp(entry, 0, SEEK_SET, 0, 1)",
          "new_text": "phar_get_efp(entry, 0)",
          "old_line_content": "\t\tif (-1 == phar_seek_efp(entry, 0, SEEK_SET, 0, 1)) {",
          "new_line_content": "\t\tfile = phar_get_efp(entry, 0);",
          "content_same": false
        },
        {
          "line": 2772,
          "old_api": "php_crc32_stream_bulk_update",
          "new_api": "php_crc32_bulk_init",
          "old_text": "php_crc32_stream_bulk_update(&newcrc32, file, entry->uncompressed_filesize)",
          "new_text": "php_crc32_bulk_init()",
          "old_line_content": "\t\tphp_crc32_stream_bulk_update(&newcrc32, file, entry->uncompressed_filesize);",
          "new_line_content": "\t\tnewcrc32 = php_crc32_bulk_init();",
          "content_same": false
        },
        {
          "line": 2773,
          "old_api": "php_crc32_bulk_end",
          "new_api": "php_crc32_stream_bulk_update",
          "old_text": "php_crc32_bulk_end(newcrc32)",
          "new_text": "php_crc32_stream_bulk_update(&newcrc32, file, entry->uncompressed_filesize)",
          "old_line_content": "\t\tentry->crc32 = php_crc32_bulk_end(newcrc32);",
          "new_line_content": "\t\tphp_crc32_stream_bulk_update(&newcrc32, file, entry->uncompressed_filesize);",
          "content_same": false
        },
        {
          "line": 2817,
          "old_api": "php_stream_tell",
          "new_api": "ZEND_ASSERT",
          "old_text": "php_stream_tell(entry->cfp)",
          "new_text": "ZEND_ASSERT(entry->header_offset == 0)",
          "old_line_content": "\t\tentry->header_offset = php_stream_tell(entry->cfp);",
          "new_line_content": "\t\tZEND_ASSERT(entry->header_offset == 0);",
          "content_same": false
        },
        {
          "line": 2818,
          "old_api": "php_stream_flush",
          "new_api": "php_stream_tell",
          "old_text": "php_stream_flush(file)",
          "new_text": "php_stream_tell(entry->cfp)",
          "old_line_content": "\t\tphp_stream_flush(file);",
          "new_line_content": "\t\tentry->header_offset = php_stream_tell(entry->cfp);",
          "content_same": false
        },
        {
          "line": 2819,
          "old_api": "phar_seek_efp",
          "new_api": "php_stream_flush",
          "old_text": "phar_seek_efp(entry, 0, SEEK_SET, 0, 0)",
          "new_text": "php_stream_flush(file)",
          "old_line_content": "\t\tif (-1 == phar_seek_efp(entry, 0, SEEK_SET, 0, 0)) {",
          "new_line_content": "\t\tphp_stream_flush(file);",
          "content_same": false
        },
        {
          "line": 2830,
          "old_api": "php_stream_copy_to_stream_ex",
          "new_api": "php_stream_filter_append",
          "old_text": "php_stream_copy_to_stream_ex(file, entry->cfp, entry->uncompressed_filesize, NULL)",
          "new_text": "php_stream_filter_append((&entry->cfp->writefilters), filter)",
          "old_line_content": "\t\tif (SUCCESS != php_stream_copy_to_stream_ex(file, entry->cfp, entry->uncompressed_filesize, NULL)) {",
          "new_line_content": "\t\tphp_stream_filter_append((&entry->cfp->writefilters), filter);",
          "content_same": false
        },
        {
          "line": 2841,
          "old_api": "php_stream_flush",
          "new_api": "php_stream_filter_flush",
          "old_text": "php_stream_flush(entry->cfp)",
          "new_text": "php_stream_filter_flush(filter, 1)",
          "old_line_content": "\t\tphp_stream_flush(entry->cfp);",
          "new_line_content": "\t\tphp_stream_filter_flush(filter, 1);",
          "content_same": false
        },
        {
          "line": 2842,
          "old_api": "php_stream_filter_remove",
          "new_api": "php_stream_flush",
          "old_text": "php_stream_filter_remove(filter, 1)",
          "new_text": "php_stream_flush(entry->cfp)",
          "old_line_content": "\t\tphp_stream_filter_remove(filter, 1);",
          "new_line_content": "\t\tphp_stream_flush(entry->cfp);",
          "content_same": false
        },
        {
          "line": 2843,
          "old_api": "php_stream_seek",
          "new_api": "php_stream_filter_remove",
          "old_text": "php_stream_seek(entry->cfp, 0, SEEK_END)",
          "new_text": "php_stream_filter_remove(filter, 1)",
          "old_line_content": "\t\tphp_stream_seek(entry->cfp, 0, SEEK_END);",
          "new_line_content": "\t\tphp_stream_filter_remove(filter, 1);",
          "content_same": false
        },
        {
          "line": 2844,
          "old_api": "php_stream_tell",
          "new_api": "php_stream_seek",
          "old_text": "php_stream_tell(entry->cfp)",
          "new_text": "php_stream_seek(entry->cfp, 0, SEEK_END)",
          "old_line_content": "\t\tentry->compressed_filesize = ((uint32_t) php_stream_tell(entry->cfp)) - entry->header_offset;",
          "new_line_content": "\t\tphp_stream_seek(entry->cfp, 0, SEEK_END);",
          "content_same": false
        },
        {
          "line": 2868,
          "old_api": "phar_set_32",
          "new_api": "ZSTR_LEN",
          "old_text": "phar_set_32(manifest, manifest_len)",
          "new_text": "ZSTR_LEN(main_metadata_str.s)",
          "old_line_content": "\tphar_set_32(manifest, manifest_len);",
          "new_line_content": "\tmanifest_len = offset + phar->alias_len + sizeof(manifest) + (main_metadata_str.s ? ZSTR_LEN(main_metadata_str.s) : 0);",
          "content_same": false
        },
        {
          "line": 2909,
          "old_api": "smart_str_free",
          "new_api": "ZSTR_LEN",
          "old_text": "smart_str_free(&main_metadata_str)",
          "new_text": "ZSTR_LEN(main_metadata_str.s)",
          "old_line_content": "\t\tsmart_str_free(&main_metadata_str);",
          "new_line_content": "\t&& ZSTR_LEN(main_metadata_str.s) != php_stream_write(newfile, ZSTR_VAL(main_metadata_str.s), ZSTR_LEN(main_metadata_str.s)))) {",
          "content_same": false
        },
        {
          "line": 2945,
          "old_api": "ZSTR_LEN",
          "new_api": "php_stream_write",
          "old_text": "ZSTR_LEN(entry->filename)",
          "new_text": "php_stream_write(newfile, entry_buffer, 4)",
          "old_line_content": "\t\t|| ZSTR_LEN(entry->filename) != php_stream_write(newfile, ZSTR_VAL(entry->filename), ZSTR_LEN(entry->filename))",
          "new_line_content": "\t\tif (4 != php_stream_write(newfile, entry_buffer, 4)",
          "content_same": false
        },
        {
          "line": 2946,
          "old_api": "php_stream_write",
          "new_api": "ZSTR_LEN",
          "old_text": "php_stream_write(newfile, \"/\", 1)",
          "new_text": "ZSTR_LEN(entry->filename)",
          "old_line_content": "\t\t|| (entry->is_dir && 1 != php_stream_write(newfile, \"/\", 1))) {",
          "new_line_content": "\t\t|| ZSTR_LEN(entry->filename) != php_stream_write(newfile, ZSTR_VAL(entry->filename), ZSTR_LEN(entry->filename))",
          "content_same": false
        },
        {
          "line": 2971,
          "old_api": "phar_set_32",
          "new_api": "time",
          "old_text": "phar_set_32(entry_buffer, entry->uncompressed_filesize)",
          "new_text": "time(NULL)",
          "old_line_content": "\t\tphar_set_32(entry_buffer, entry->uncompressed_filesize);",
          "new_line_content": "\t\tmytime = time(NULL);",
          "content_same": false
        },
        {
          "line": 3014,
          "old_api": "ZEND_HASH_MAP_FOREACH_PTR",
          "new_api": "php_stream_tell",
          "old_text": "ZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry)",
          "new_text": "php_stream_tell(newfile)",
          "old_line_content": "\tZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry) {",
          "new_line_content": "\toffset = php_stream_tell(newfile);",
          "content_same": false
        },
        {
          "line": 3024,
          "old_api": "phar_seek_efp",
          "new_api": "phar_get_efp",
          "old_text": "phar_seek_efp(entry, 0, SEEK_SET, 0, 0)",
          "new_text": "phar_get_efp(entry, 0)",
          "old_line_content": "\t\t\tif (-1 == phar_seek_efp(entry, 0, SEEK_SET, 0, 0)) {",
          "new_line_content": "\t\t\tfile = phar_get_efp(entry, 0);",
          "content_same": false
        },
        {
          "line": 3109,
          "old_api": "efree",
          "new_api": "spprintf",
          "old_text": "efree(save)",
          "new_text": "spprintf(error, 0, \"phar error: unable to write signature: %s\", save)",
          "old_line_content": "\t\t\t\t\t\tefree(save);",
          "new_line_content": "\t\t\t\t\t\tspprintf(error, 0, \"phar error: unable to write signature: %s\", save);",
          "content_same": false
        },
        {
          "line": 3122,
          "old_api": "efree",
          "new_api": "php_stream_write",
          "old_text": "efree(digest)",
          "new_text": "php_stream_write(newfile, digest, digest_len)",
          "old_line_content": "\t\t\t\tefree(digest);",
          "new_line_content": "\t\t\t\tphp_stream_write(newfile, digest, digest_len);",
          "content_same": false
        },
        {
          "line": 3127,
          "old_api": "php_stream_write",
          "new_api": "phar_set_32",
          "old_text": "php_stream_write(newfile, sig_buf, 4)",
          "new_text": "phar_set_32(sig_buf, digest_len)",
          "old_line_content": "\t\t\t\t\tphp_stream_write(newfile, sig_buf, 4);",
          "new_line_content": "\t\t\t\t\tphar_set_32(sig_buf, digest_len);",
          "content_same": false
        },
        {
          "line": 3133,
          "old_api": "php_stream_write",
          "new_api": "phar_set_32",
          "old_text": "php_stream_write(newfile, sig_buf, 4)",
          "new_text": "phar_set_32(sig_buf, phar->sig_flags)",
          "old_line_content": "\t\tphp_stream_write(newfile, sig_buf, 4);",
          "new_line_content": "\t\tphar_set_32(sig_buf, phar->sig_flags);",
          "content_same": false
        },
        {
          "line": 3178,
          "old_api": "add_assoc_long",
          "new_api": "array_init",
          "old_text": "add_assoc_long(&filterparams, \"window\", MAX_WBITS+16)",
          "new_text": "array_init(&filterparams)",
          "old_line_content": "\t\t\tadd_assoc_long(&filterparams, \"window\", MAX_WBITS+16);",
          "new_line_content": "\t\t\tarray_init(&filterparams);",
          "content_same": false
        },
        {
          "line": 3179,
          "old_api": "php_stream_is_persistent",
          "new_api": "add_assoc_long",
          "old_text": "php_stream_is_persistent(phar->fp)",
          "new_text": "add_assoc_long(&filterparams, \"window\", MAX_WBITS+16)",
          "old_line_content": "\t\t\tfilter = php_stream_filter_create(\"zlib.deflate\", &filterparams, php_stream_is_persistent(phar->fp));",
          "new_line_content": "\t\t\tadd_assoc_long(&filterparams, \"window\", MAX_WBITS+16);",
          "content_same": false
        },
        {
          "line": 3180,
          "old_api": "Z_ARR",
          "new_api": "php_stream_is_persistent",
          "old_text": "Z_ARR(filterparams)",
          "new_text": "php_stream_is_persistent(phar->fp)",
          "old_line_content": "\t\t\tzend_array_destroy(Z_ARR(filterparams));",
          "new_line_content": "\t\t\tfilter = php_stream_filter_create(\"zlib.deflate\", &filterparams, php_stream_is_persistent(phar->fp));",
          "content_same": false
        },
        {
          "line": 3190,
          "old_api": "php_stream_copy_to_stream_ex",
          "new_api": "php_stream_filter_append",
          "old_text": "php_stream_copy_to_stream_ex(newfile, phar->fp, PHP_STREAM_COPY_ALL, NULL)",
          "new_text": "php_stream_filter_append(&phar->fp->writefilters, filter)",
          "old_line_content": "\t\t\tphp_stream_copy_to_stream_ex(newfile, phar->fp, PHP_STREAM_COPY_ALL, NULL);",
          "new_line_content": "\t\t\tphp_stream_filter_append(&phar->fp->writefilters, filter);",
          "content_same": false
        },
        {
          "line": 3191,
          "old_api": "php_stream_filter_flush",
          "new_api": "php_stream_copy_to_stream_ex",
          "old_text": "php_stream_filter_flush(filter, 1)",
          "new_text": "php_stream_copy_to_stream_ex(newfile, phar->fp, PHP_STREAM_COPY_ALL, NULL)",
          "old_line_content": "\t\t\tphp_stream_filter_flush(filter, 1);",
          "new_line_content": "\t\t\tphp_stream_copy_to_stream_ex(newfile, phar->fp, PHP_STREAM_COPY_ALL, NULL);",
          "content_same": false
        },
        {
          "line": 3192,
          "old_api": "php_stream_filter_remove",
          "new_api": "php_stream_filter_flush",
          "old_text": "php_stream_filter_remove(filter, 1)",
          "new_text": "php_stream_filter_flush(filter, 1)",
          "old_line_content": "\t\t\tphp_stream_filter_remove(filter, 1);",
          "new_line_content": "\t\t\tphp_stream_filter_flush(filter, 1);",
          "content_same": false
        },
        {
          "line": 3193,
          "old_api": "php_stream_close",
          "new_api": "php_stream_filter_remove",
          "old_text": "php_stream_close(phar->fp)",
          "new_text": "php_stream_filter_remove(filter, 1)",
          "old_line_content": "\t\t\tphp_stream_close(phar->fp);",
          "new_line_content": "\t\t\tphp_stream_filter_remove(filter, 1);",
          "content_same": false
        },
        {
          "line": 3198,
          "old_api": "php_stream_filter_append",
          "new_api": "php_stream_is_persistent",
          "old_text": "php_stream_filter_append(&phar->fp->writefilters, filter)",
          "new_text": "php_stream_is_persistent(phar->fp)",
          "old_line_content": "\t\t\tphp_stream_filter_append(&phar->fp->writefilters, filter);",
          "new_line_content": "\t\t\tfilter = php_stream_filter_create(\"bzip2.compress\", NULL, php_stream_is_persistent(phar->fp));",
          "content_same": false
        },
        {
          "line": 3199,
          "old_api": "php_stream_copy_to_stream_ex",
          "new_api": "php_stream_filter_append",
          "old_text": "php_stream_copy_to_stream_ex(newfile, phar->fp, PHP_STREAM_COPY_ALL, NULL)",
          "new_text": "php_stream_filter_append(&phar->fp->writefilters, filter)",
          "old_line_content": "\t\t\tphp_stream_copy_to_stream_ex(newfile, phar->fp, PHP_STREAM_COPY_ALL, NULL);",
          "new_line_content": "\t\t\tphp_stream_filter_append(&phar->fp->writefilters, filter);",
          "content_same": false
        },
        {
          "line": 3200,
          "old_api": "php_stream_filter_flush",
          "new_api": "php_stream_copy_to_stream_ex",
          "old_text": "php_stream_filter_flush(filter, 1)",
          "new_text": "php_stream_copy_to_stream_ex(newfile, phar->fp, PHP_STREAM_COPY_ALL, NULL)",
          "old_line_content": "\t\t\tphp_stream_filter_flush(filter, 1);",
          "new_line_content": "\t\t\tphp_stream_copy_to_stream_ex(newfile, phar->fp, PHP_STREAM_COPY_ALL, NULL);",
          "content_same": false
        },
        {
          "line": 3201,
          "old_api": "php_stream_filter_remove",
          "new_api": "php_stream_filter_flush",
          "old_text": "php_stream_filter_remove(filter, 1)",
          "new_text": "php_stream_filter_flush(filter, 1)",
          "old_line_content": "\t\t\tphp_stream_filter_remove(filter, 1);",
          "new_line_content": "\t\t\tphp_stream_filter_flush(filter, 1);",
          "content_same": false
        },
        {
          "line": 3202,
          "old_api": "php_stream_close",
          "new_api": "php_stream_filter_remove",
          "old_text": "php_stream_close(phar->fp)",
          "new_text": "php_stream_filter_remove(filter, 1)",
          "old_line_content": "\t\t\tphp_stream_close(phar->fp);",
          "new_line_content": "\t\t\tphp_stream_filter_remove(filter, 1);",
          "content_same": false
        },
        {
          "line": 3273,
          "old_api": "ZSTR_LEN",
          "new_api": "ZSTR_VAL",
          "old_text": "ZSTR_LEN(file_handle->filename)",
          "new_text": "ZSTR_VAL(file_handle->filename)",
          "old_line_content": "\t\tif (SUCCESS == phar_open_from_filename(ZSTR_VAL(file_handle->filename), ZSTR_LEN(file_handle->filename), NULL, 0, 0, &phar, NULL)) {",
          "new_line_content": "\tif (strstr(ZSTR_VAL(file_handle->filename), \".phar\") && !strstr(ZSTR_VAL(file_handle->filename), \"://\")) {",
          "content_same": false
        },
        {
          "line": 3279,
          "old_api": "zend_stream_init_filename_ex",
          "new_api": "ZSTR_VAL",
          "old_text": "zend_stream_init_filename_ex(&f, name)",
          "new_text": "ZSTR_VAL(file_handle->filename)",
          "old_line_content": "\t\t\t\tzend_stream_init_filename_ex(&f, name);",
          "new_line_content": "\t\t\t\tname = zend_strpprintf(4096, \"phar://%s/%s\", ZSTR_VAL(file_handle->filename), \".phar/stub.php\");",
          "content_same": false
        },
        {
          "line": 3280,
          "old_api": "zend_stream_open_function",
          "new_api": "zend_stream_init_filename_ex",
          "old_text": "zend_stream_open_function(&f)",
          "new_text": "zend_stream_init_filename_ex(&f, name)",
          "old_line_content": "\t\t\t\tif (SUCCESS == zend_stream_open_function(&f)) {",
          "new_line_content": "\t\t\t\tzend_stream_init_filename_ex(&f, name);",
          "content_same": false
        },
        {
          "line": 3281,
          "old_api": "zend_string_release",
          "new_api": "zend_stream_open_function",
          "old_text": "zend_string_release(f.filename)",
          "new_text": "zend_stream_open_function(&f)",
          "old_line_content": "\t\t\t\t\tzend_string_release(f.filename);",
          "new_line_content": "\t\t\t\tif (SUCCESS == zend_stream_open_function(&f)) {",
          "content_same": false
        },
        {
          "line": 3311,
          "old_api": "php_stream_rewind",
          "new_api": "PHAR_G",
          "old_text": "php_stream_rewind(phar->fp)",
          "new_text": "PHAR_G(cached_fp)",
          "old_line_content": "\t\t\t\t\tphp_stream_rewind(phar->fp);",
          "new_line_content": "\t\t\t\t\tphp_stream_rewind(PHAR_G(cached_fp)[phar->phar_pos].fp) :",
          "content_same": false
        },
        {
          "line": 3319,
          "old_api": "phar_orig_compile_file",
          "new_api": "CG",
          "old_text": "phar_orig_compile_file(file_handle, type)",
          "new_text": "CG(zend_lineno)",
          "old_line_content": "\t\tres = phar_orig_compile_file(file_handle, type);",
          "new_line_content": "\t\tCG(zend_lineno) = 0;",
          "content_same": false
        },
        {
          "line": 3350,
          "old_api": "HT_INVALIDATE",
          "new_api": "memset",
          "old_text": "HT_INVALIDATE(&phar_globals->phar_persist_map)",
          "new_text": "memset(phar_globals, 0, sizeof(zend_phar_globals))",
          "old_line_content": "\tHT_INVALIDATE(&phar_globals->phar_persist_map);",
          "new_line_content": "\tmemset(phar_globals, 0, sizeof(zend_phar_globals));",
          "content_same": false
        },
        {
          "line": 3427,
          "old_api": "phar_save_orig_functions",
          "new_api": "phar_intercept_functions_init",
          "old_text": "phar_save_orig_functions()",
          "new_text": "phar_intercept_functions_init()",
          "old_line_content": "\tphar_save_orig_functions();",
          "new_line_content": "\tphar_intercept_functions_init();",
          "content_same": false
        },
        {
          "line": 3444,
          "old_api": "zend_hash_destroy",
          "new_api": "PHAR_G",
          "old_text": "zend_hash_destroy(&(cached_phars))",
          "new_text": "PHAR_G(manifest_cached)",
          "old_line_content": "\t\tzend_hash_destroy(&(cached_phars));",
          "new_line_content": "\tif (PHAR_G(manifest_cached)) {",
          "content_same": false
        },
        {
          "line": 3459,
          "old_api": "zend_hash_str_exists",
          "new_api": "PHAR_G",
          "old_text": "zend_hash_str_exists(&module_registry, \"bz2\", sizeof(\"bz2\")-1)",
          "new_text": "PHAR_G(last_alias)",
          "old_line_content": "\t\tPHAR_G(has_bz2) = zend_hash_str_exists(&module_registry, \"bz2\", sizeof(\"bz2\")-1);",
          "new_line_content": "\t\tPHAR_G(last_phar_name) = PHAR_G(last_alias) = NULL;",
          "content_same": false
        },
        {
          "line": 3461,
          "old_api": "PHAR_G",
          "new_api": "zend_hash_str_exists",
          "old_text": "PHAR_G(request_init)",
          "new_text": "zend_hash_str_exists(&module_registry, \"zlib\", sizeof(\"zlib\")-1)",
          "old_line_content": "\t\tPHAR_G(request_init) = 1;",
          "new_line_content": "\t\tPHAR_G(has_zlib) = zend_hash_str_exists(&module_registry, \"zlib\", sizeof(\"zlib\")-1);",
          "content_same": false
        },
        {
          "line": 3473,
          "old_api": "zend_hash_num_elements",
          "new_api": "ZEND_HASH_MAP_FOREACH_PTR",
          "old_text": "zend_hash_num_elements(&(pphar->manifest))",
          "new_text": "ZEND_HASH_MAP_FOREACH_PTR(&cached_phars, pphar)",
          "old_line_content": "\t\t\t\tstuff[pphar->phar_pos].manifest = (phar_entry_fp_info *) ecalloc( zend_hash_num_elements(&(pphar->manifest)), sizeof(phar_entry_fp_info));",
          "new_line_content": "\t\t\tZEND_HASH_MAP_FOREACH_PTR(&cached_phars, pphar) {",
          "content_same": false
        },
        {
          "line": 3474,
          "old_api": "ZEND_HASH_FOREACH_END",
          "new_api": "zend_hash_num_elements",
          "old_text": "ZEND_HASH_FOREACH_END()",
          "new_text": "zend_hash_num_elements(&(pphar->manifest))",
          "old_line_content": "\t\t\t} ZEND_HASH_FOREACH_END();",
          "new_line_content": "\t\t\t\tstuff[pphar->phar_pos].manifest = (phar_entry_fp_info *) ecalloc( zend_hash_num_elements(&(pphar->manifest)), sizeof(phar_entry_fp_info));",
          "content_same": false
        },
        {
          "line": 3494,
          "old_api": "PHAR_G",
          "new_api": "phar_release_functions",
          "old_text": "PHAR_G(phar_alias_map)",
          "new_text": "phar_release_functions()",
          "old_line_content": "\t\tzend_hash_destroy(&(PHAR_G(phar_alias_map)));",
          "new_line_content": "\t\tphar_release_functions();",
          "content_same": false
        },
        {
          "line": 3503,
          "old_api": "zend_hash_num_elements",
          "new_api": "PHAR_G",
          "old_text": "zend_hash_num_elements(&cached_phars)",
          "new_text": "PHAR_G(cached_fp)",
          "old_line_content": "\t\t\tfor (uint32_t i = 0; i < zend_hash_num_elements(&cached_phars); ++i) {",
          "new_line_content": "\t\tif (PHAR_G(cached_fp)) {",
          "content_same": false
        },
        {
          "line": 3504,
          "old_api": "PHAR_G",
          "new_api": "zend_hash_num_elements",
          "old_text": "PHAR_G(cached_fp)",
          "new_text": "zend_hash_num_elements(&cached_phars)",
          "old_line_content": "\t\t\t\tif (PHAR_G(cached_fp)[i].fp) {",
          "new_line_content": "\t\t\tfor (uint32_t i = 0; i < zend_hash_num_elements(&cached_phars); ++i) {",
          "content_same": false
        },
        {
          "line": 3535,
          "old_api": "php_info_print_table_start",
          "new_api": "phar_request_initialize",
          "old_text": "php_info_print_table_start()",
          "new_text": "phar_request_initialize()",
          "old_line_content": "\tphp_info_print_table_start();",
          "new_line_content": "\tphar_request_initialize();",
          "content_same": false
        },
        {
          "line": 3536,
          "old_api": "php_info_print_table_row",
          "new_api": "php_info_print_table_start",
          "old_text": "php_info_print_table_row(2, \"Phar: PHP Archive support\", \"enabled\")",
          "new_text": "php_info_print_table_start()",
          "old_line_content": "\tphp_info_print_table_row(2, \"Phar: PHP Archive support\", \"enabled\");",
          "new_line_content": "\tphp_info_print_table_start();",
          "content_same": false
        },
        {
          "line": 3543,
          "old_api": "php_info_print_table_row",
          "new_api": "PHAR_G",
          "old_text": "php_info_print_table_row(2, \"gzip compression\", \"enabled\")",
          "new_text": "PHAR_G(has_zlib)",
          "old_line_content": "\t\tphp_info_print_table_row(2, \"gzip compression\", \"enabled\");",
          "new_line_content": "\tif (PHAR_G(has_zlib)) {",
          "content_same": false
        },
        {
          "line": 3549,
          "old_api": "php_info_print_table_row",
          "new_api": "PHAR_G",
          "old_text": "php_info_print_table_row(2, \"bzip2 compression\", \"enabled\")",
          "new_text": "PHAR_G(has_bz2)",
          "old_line_content": "\t\tphp_info_print_table_row(2, \"bzip2 compression\", \"enabled\");",
          "new_line_content": "\tif (PHAR_G(has_bz2)) {",
          "content_same": false
        },
        {
          "line": 3557,
          "old_api": "php_info_print_table_row",
          "new_api": "zend_hash_str_exists",
          "old_text": "php_info_print_table_row(2, \"OpenSSL support\", \"enabled\")",
          "new_text": "zend_hash_str_exists(&module_registry, \"openssl\", sizeof(\"openssl\")-1)",
          "old_line_content": "\t\tphp_info_print_table_row(2, \"OpenSSL support\", \"enabled\");",
          "new_line_content": "\tif (zend_hash_str_exists(&module_registry, \"openssl\", sizeof(\"openssl\")-1)) {",
          "content_same": false
        },
        {
          "line": 3565,
          "old_api": "PUTS",
          "new_api": "php_info_print_box_start",
          "old_text": "PUTS(\"Phar based on pear/PHP_Archive, original concept by Davey Shafik.\")",
          "new_text": "php_info_print_box_start(0)",
          "old_line_content": "\tPUTS(\"Phar based on pear/PHP_Archive, original concept by Davey Shafik.\");",
          "new_line_content": "\tphp_info_print_box_start(0);",
          "content_same": false
        },
        {
          "line": 3570,
          "old_api": "php_info_print_box_end",
          "new_api": "PUTS",
          "old_text": "php_info_print_box_end()",
          "new_text": "PUTS(\"Portions of tar implementation Copyright (c) 2003-2009 Tim Kientzle.\")",
          "old_line_content": "\tphp_info_print_box_end();",
          "new_line_content": "\tPUTS(\"Portions of tar implementation Copyright (c) 2003-2009 Tim Kientzle.\");",
          "content_same": false
        },
        {
          "line": 3594,
          "old_api": "PHP_MSHUTDOWN",
          "new_api": "PHP_MINIT",
          "old_text": "PHP_MSHUTDOWN(phar)",
          "new_text": "PHP_MINIT(phar)",
          "old_line_content": "\tPHP_MSHUTDOWN(phar),",
          "new_line_content": "\tPHP_MINIT(phar),",
          "content_same": false
        },
        {
          "line": 3597,
          "old_api": "PHP_MINFO",
          "new_api": "PHP_RSHUTDOWN",
          "old_text": "PHP_MINFO(phar)",
          "new_text": "PHP_RSHUTDOWN(phar)",
          "old_line_content": "\tPHP_MINFO(phar),",
          "new_line_content": "\tPHP_RSHUTDOWN(phar),",
          "content_same": false
        },
        {
          "line": 3600,
          "old_api": "PHP_GINIT",
          "new_api": "PHP_MODULE_GLOBALS",
          "old_text": "PHP_GINIT(phar)",
          "new_text": "PHP_MODULE_GLOBALS(phar)",
          "old_line_content": "\tPHP_GINIT(phar),            /* globals ctor */",
          "new_line_content": "\tPHP_MODULE_GLOBALS(phar),   /* globals descriptor */",
          "content_same": false
        },
        {
          "line": 3601,
          "old_api": "PHP_GSHUTDOWN",
          "new_api": "PHP_GINIT",
          "old_text": "PHP_GSHUTDOWN(phar)",
          "new_text": "PHP_GINIT(phar)",
          "old_line_content": "\tPHP_GSHUTDOWN(phar),        /* globals dtor */",
          "new_line_content": "\tPHP_GINIT(phar),            /* globals ctor */",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 2048,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(str_key)",
          "old_line_content": "\t\t\t\t\tgoto woohoo;",
          "new_line_content": "\t\t\t\t\t*ext_str = filename + (ZSTR_LEN(str_key) - pphar->ext_len);",
          "content_same": false
        },
        {
          "line": 2051,
          "old_api": null,
          "new_api": "ZEND_HASH_FOREACH_END",
          "old_text": null,
          "new_text": "ZEND_HASH_FOREACH_END()",
          "old_line_content": "",
          "new_line_content": "\t\t\t} ZEND_HASH_FOREACH_END();",
          "content_same": false
        },
        {
          "line": 2055,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(str_key)",
          "old_line_content": "\t\t\t\t\t\tcontinue;",
          "new_line_content": "\t\t\t\t\tif (ZSTR_LEN(str_key) > filename_len) {",
          "content_same": false
        },
        {
          "line": 2061,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(str_key)",
          "old_line_content": "\t\t\t\t\t\tgoto woohoo;",
          "new_line_content": "\t\t\t\t\t\t*ext_str = filename + (ZSTR_LEN(str_key) - pphar->ext_len);",
          "content_same": false
        },
        {
          "line": 2064,
          "old_api": null,
          "new_api": "ZEND_HASH_FOREACH_END",
          "old_text": null,
          "new_text": "ZEND_HASH_FOREACH_END()",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\t} ZEND_HASH_FOREACH_END();",
          "content_same": false
        },
        {
          "line": 2070,
          "old_api": null,
          "new_api": "memchr",
          "old_text": null,
          "new_text": "memchr(filename + 1, '.', filename_len)",
          "old_line_content": "next_extension:",
          "new_line_content": "\tpos = memchr(filename + 1, '.', filename_len);",
          "content_same": false
        },
        {
          "line": 2077,
          "old_api": null,
          "new_api": "memchr",
          "old_text": null,
          "new_text": "memchr(pos + 1, '.', filename_len - (pos - filename) - 1)",
          "old_line_content": "\t\tif (!pos) {",
          "new_line_content": "\t\tpos = memchr(pos + 1, '.', filename_len - (pos - filename) - 1);",
          "content_same": false
        },
        {
          "line": 2083,
          "old_api": null,
          "new_api": "memchr",
          "old_text": null,
          "new_text": "memchr(pos, '/', filename_len - (pos - filename))",
          "old_line_content": "",
          "new_line_content": "\tslash = memchr(pos, '/', filename_len - (pos - filename));",
          "content_same": false
        },
        {
          "line": 2088,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(pos)",
          "old_line_content": "",
          "new_line_content": "\t\t*ext_len = strlen(pos);",
          "content_same": false
        },
        {
          "line": 2091,
          "old_api": null,
          "new_api": "phar_check_str",
          "old_text": null,
          "new_text": "phar_check_str(filename, *ext_str, *ext_len, executable, for_create)",
          "old_line_content": "\t}",
          "new_line_content": "\t\treturn phar_check_str(filename, *ext_str, *ext_len, executable, for_create);",
          "content_same": false
        },
        {
          "line": 2098,
          "old_api": null,
          "new_api": "phar_check_str",
          "old_text": null,
          "new_text": "phar_check_str(filename, *ext_str, *ext_len, executable, for_create)",
          "old_line_content": "\t\treturn SUCCESS;",
          "new_line_content": "\tif (phar_check_str(filename, *ext_str, *ext_len, executable, for_create) == SUCCESS) {",
          "content_same": false
        },
        {
          "line": 2103,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(pos + 1, '.')",
          "old_line_content": "\tif (pos) {",
          "new_line_content": "\tpos = strchr(pos + 1, '.');",
          "content_same": false
        },
        {
          "line": 2147,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(cwd)",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\tmemcpy(newpath, PHAR_G(cwd), newpath_len);",
          "content_same": false
        },
        {
          "line": 2149,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(path)",
          "old_line_content": "\t\tnewpath[0] = '/';",
          "new_line_content": "\t\tnewpath = emalloc(strlen(path) + 2);",
          "content_same": false
        },
        {
          "line": 2163,
          "old_api": null,
          "new_api": "memchr",
          "old_text": null,
          "new_text": "memchr(ptr, '/', path_length - (ptr - path))",
          "old_line_content": "\t} while (ptr && ptr - tok == 0 && *ptr == '/' && ++ptr && ++tok);",
          "new_line_content": "\t\tptr = memchr(ptr, '/', path_length - (ptr - path));",
          "content_same": false
        },
        {
          "line": 2170,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(path)",
          "old_line_content": "\t\t\t\t\t*new_len = 1;",
          "new_line_content": "\t\t\t\t\tefree(path);",
          "content_same": false
        },
        {
          "line": 2173,
          "old_api": null,
          "new_api": "estrndup",
          "old_text": null,
          "new_text": "estrndup(\"/\", 1)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\treturn estrndup(\"/\", 1);",
          "content_same": false
        },
        {
          "line": 2178,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(path)",
          "old_line_content": "\t\t\t\t\t*new_len = 1;",
          "new_line_content": "\t\t\t\t\tefree(path);",
          "content_same": false
        },
        {
          "line": 2181,
          "old_api": null,
          "new_api": "estrndup",
          "old_text": null,
          "new_text": "estrndup(\"/\", 1)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\treturn estrndup(\"/\", 1);",
          "content_same": false
        },
        {
          "line": 2184,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(newpath)",
          "old_line_content": "\t\treturn path;",
          "new_line_content": "\t\tefree(newpath);",
          "content_same": false
        },
        {
          "line": 2192,
          "old_api": null,
          "new_api": "IS_BACKSLASH",
          "old_text": null,
          "new_text": "IS_BACKSLASH(newpath[newpath_len - 1])",
          "old_line_content": "\t\t\t\tnewpath_len--;",
          "new_line_content": "\t\t\twhile (newpath_len > 1 && !IS_BACKSLASH(newpath[newpath_len - 1])) {",
          "content_same": false
        },
        {
          "line": 2201,
          "old_api": null,
          "new_api": "IS_DIRECTORY_CURRENT",
          "old_text": null,
          "new_text": "IS_DIRECTORY_CURRENT(tok, ptr_length)",
          "old_line_content": "\t\t\tif (newpath_len > 1) {",
          "new_line_content": "\t\t} else if (!IS_DIRECTORY_CURRENT(tok, ptr_length)) {",
          "content_same": false
        },
        {
          "line": 2204,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(newpath + newpath_len, tok, ptr_length+1)",
          "old_line_content": "\t\t\t} else {",
          "new_line_content": "\t\t\t\tmemcpy(newpath + newpath_len, tok, ptr_length+1);",
          "content_same": false
        },
        {
          "line": 2206,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(newpath + newpath_len, tok, ptr_length+1)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tmemcpy(newpath + newpath_len, tok, ptr_length+1);",
          "content_same": false
        },
        {
          "line": 2219,
          "old_api": null,
          "new_api": "memchr",
          "old_text": null,
          "new_text": "memchr(ptr, '/', path_length - (ptr - path))",
          "old_line_content": "\t\t} while (ptr && ptr - tok == 0 && *ptr == '/' && ++ptr && ++tok);",
          "new_line_content": "\t\t\tptr = memchr(ptr, '/', path_length - (ptr - path));",
          "content_same": false
        },
        {
          "line": 2229,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(path)",
          "old_line_content": "\t*new_len = newpath_len;",
          "new_line_content": "\tefree(path);",
          "content_same": false
        },
        {
          "line": 2232,
          "old_api": null,
          "new_api": "erealloc",
          "old_text": null,
          "new_text": "erealloc(newpath, newpath_len + 1)",
          "old_line_content": "}",
          "new_line_content": "\treturn erealloc(newpath, newpath_len + 1);",
          "content_same": false
        },
        {
          "line": 2256,
          "old_api": null,
          "new_api": "CHECK_NULL_PATH",
          "old_text": null,
          "new_text": "CHECK_NULL_PATH(filename, filename_len)",
          "old_line_content": "\t\treturn FAILURE;",
          "new_line_content": "\tif (CHECK_NULL_PATH(filename, filename_len)) {",
          "content_same": false
        },
        {
          "line": 2260,
          "old_api": null,
          "new_api": "strncasecmp",
          "old_text": null,
          "new_text": "strncasecmp(filename, \"phar://\", 7)",
          "old_line_content": "\t\tfilename += 7;",
          "new_line_content": "\tif (!strncasecmp(filename, \"phar://\", 7)) {",
          "content_same": false
        },
        {
          "line": 2270,
          "old_api": null,
          "new_api": "phar_unixify_path_separators",
          "old_text": null,
          "new_text": "phar_unixify_path_separators((char *)filename, filename_len)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tphar_unixify_path_separators((char *)filename, filename_len);",
          "content_same": false
        },
        {
          "line": 2273,
          "old_api": null,
          "new_api": "phar_detect_phar_fname_ext",
          "old_text": null,
          "new_text": "phar_detect_phar_fname_ext(filename, filename_len, &ext_str, &ext_len, executable, for_create, 0)",
          "old_line_content": "\t\tif (ext_len != -1) {",
          "new_line_content": "\tif (phar_detect_phar_fname_ext(filename, filename_len, &ext_str, &ext_len, executable, for_create, 0) == FAILURE) {",
          "content_same": false
        },
        {
          "line": 2286,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree((char *)filename)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tefree((char *)filename);",
          "content_same": false
        },
        {
          "line": 2297,
          "old_api": null,
          "new_api": "estrndup",
          "old_text": null,
          "new_text": "estrndup(filename, *arch_len)",
          "old_line_content": "",
          "new_line_content": "\t*arch = estrndup(filename, *arch_len);",
          "content_same": false
        },
        {
          "line": 2301,
          "old_api": null,
          "new_api": "estrndup",
          "old_text": null,
          "new_text": "estrndup(ext_str+ext_len, *entry_len)",
          "old_line_content": "#ifdef PHP_WIN32",
          "new_line_content": "\t\t*entry = estrndup(ext_str+ext_len, *entry_len);",
          "content_same": false
        },
        {
          "line": 2303,
          "old_api": null,
          "new_api": "phar_unixify_path_separators",
          "old_text": null,
          "new_text": "phar_unixify_path_separators(*entry, *entry_len)",
          "old_line_content": "#endif",
          "new_line_content": "\t\tphar_unixify_path_separators(*entry, *entry_len);",
          "content_same": false
        },
        {
          "line": 2305,
          "old_api": null,
          "new_api": "phar_fix_filepath",
          "old_text": null,
          "new_text": "phar_fix_filepath(*entry, entry_len, 0)",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\t*entry = phar_fix_filepath(*entry, entry_len, 0);",
          "content_same": false
        },
        {
          "line": 2308,
          "old_api": null,
          "new_api": "estrndup",
          "old_text": null,
          "new_text": "estrndup(\"/\", 1)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t*entry = estrndup(\"/\", 1);",
          "content_same": false
        },
        {
          "line": 2313,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree((char *)filename)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tefree((char *)filename);",
          "content_same": false
        },
        {
          "line": 2331,
          "old_api": null,
          "new_api": "zend_get_executed_filename_ex",
          "old_text": null,
          "new_text": "zend_get_executed_filename_ex()",
          "old_line_content": "",
          "new_line_content": "\tzend_string *fname = zend_get_executed_filename_ex();",
          "content_same": false
        },
        {
          "line": 2335,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"cannot initialize a phar outside of PHP execution\")",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tspprintf(error, 0, \"cannot initialize a phar outside of PHP execution\");",
          "content_same": false
        },
        {
          "line": 2340,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(fname)",
          "old_line_content": "\t\treturn SUCCESS;",
          "new_line_content": "\tif (phar_open_parsed_phar(ZSTR_VAL(fname), ZSTR_LEN(fname), alias, alias_len, 0, REPORT_ERRORS, NULL, 0) == SUCCESS) {",
          "content_same": false
        },
        {
          "line": 2344,
          "old_api": null,
          "new_api": "zend_get_constant_str",
          "old_text": null,
          "new_text": "zend_get_constant_str(\"__COMPILER_HALT_OFFSET__\", sizeof(\"__COMPILER_HALT_OFFSET__\")-1)",
          "old_line_content": "\t\tif (error) {",
          "new_line_content": "\tif (0 == zend_get_constant_str(\"__COMPILER_HALT_OFFSET__\", sizeof(\"__COMPILER_HALT_OFFSET__\")-1)) {",
          "content_same": false
        },
        {
          "line": 2346,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"__HALT_COMPILER(); must be declared in a phar\")",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tspprintf(error, 0, \"__HALT_COMPILER(); must be declared in a phar\");",
          "content_same": false
        },
        {
          "line": 2351,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(fname)",
          "old_line_content": "\t\treturn FAILURE;",
          "new_line_content": "\tif (php_check_open_basedir(ZSTR_VAL(fname))) {",
          "content_same": false
        },
        {
          "line": 2357,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(fname)",
          "old_line_content": "",
          "new_line_content": "\tfp = php_stream_open_wrapper(ZSTR_VAL(fname), \"rb\", IGNORE_URL|STREAM_MUST_SEEK|REPORT_ERRORS, &actual);",
          "content_same": false
        },
        {
          "line": 2361,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(fname)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tspprintf(error, 0, \"unable to open phar for reading \\\"%s\\\"\", ZSTR_VAL(fname));",
          "content_same": false
        },
        {
          "line": 2364,
          "old_api": null,
          "new_api": "zend_string_release_ex",
          "old_text": null,
          "new_text": "zend_string_release_ex(actual, 0)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tzend_string_release_ex(actual, 0);",
          "content_same": false
        },
        {
          "line": 2373,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(fname)",
          "old_line_content": "",
          "new_line_content": "\tzend_result ret = phar_open_from_fp(fp, ZSTR_VAL(fname), ZSTR_LEN(fname), alias, alias_len, REPORT_ERRORS, NULL, error);",
          "content_same": false
        },
        {
          "line": 2376,
          "old_api": null,
          "new_api": "zend_string_release_ex",
          "old_text": null,
          "new_text": "zend_string_release_ex(actual, 0)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tzend_string_release_ex(actual, 0);",
          "content_same": false
        },
        {
          "line": 2401,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\treturn FAILURE;",
          "new_line_content": "\t\t\tspprintf(error, 0, \"phar error: unable to open zip-based phar archive \\\"%s\\\" to verify local file header for file \\\"%s\\\"\", idata->phar->fname, ZSTR_VAL(entry->filename));",
          "content_same": false
        },
        {
          "line": 2404,
          "old_api": null,
          "new_api": "phar_get_entrypfp",
          "old_text": null,
          "new_text": "phar_get_entrypfp(idata->internal_file)",
          "old_line_content": "",
          "new_line_content": "\t\tphp_stream_seek(phar_get_entrypfp(idata->internal_file), entry->header_offset, SEEK_SET);",
          "content_same": false
        },
        {
          "line": 2406,
          "old_api": null,
          "new_api": "phar_get_entrypfp",
          "old_text": null,
          "new_text": "phar_get_entrypfp(idata->internal_file)",
          "old_line_content": "",
          "new_line_content": "\t\tif (sizeof(local) != php_stream_read(phar_get_entrypfp(idata->internal_file), (char *) &local, sizeof(local))) {",
          "content_same": false
        },
        {
          "line": 2408,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\treturn FAILURE;",
          "new_line_content": "\t\t\tspprintf(error, 0, \"phar error: internal corruption of zip-based phar \\\"%s\\\" (cannot read local file header for file \\\"%s\\\")\", idata->phar->fname, ZSTR_VAL(entry->filename));",
          "content_same": false
        },
        {
          "line": 2414,
          "old_api": null,
          "new_api": "phar_get_entrypfp",
          "old_text": null,
          "new_text": "phar_get_entrypfp(idata->internal_file)",
          "old_line_content": "\t\t\t\t\tentry->header_offset + sizeof(local) +",
          "new_line_content": "\t\t\tphp_stream_seek(phar_get_entrypfp(idata->internal_file),",
          "content_same": false
        },
        {
          "line": 2417,
          "old_api": null,
          "new_api": "PHAR_ZIP_16",
          "old_text": null,
          "new_text": "PHAR_ZIP_16(local.extra_len)",
          "old_line_content": "\t\t\t\t\tentry->compressed_filesize, SEEK_SET);",
          "new_line_content": "\t\t\t\t\tPHAR_ZIP_16(local.extra_len) +",
          "content_same": false
        },
        {
          "line": 2419,
          "old_api": null,
          "new_api": "phar_get_entrypfp",
          "old_text": null,
          "new_text": "phar_get_entrypfp(idata->internal_file)",
          "old_line_content": "\t\t\t\t\t\t\t    (char *) &desc, sizeof(desc))) {",
          "new_line_content": "\t\t\tif (sizeof(desc) != php_stream_read(phar_get_entrypfp(idata->internal_file),",
          "content_same": false
        },
        {
          "line": 2421,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\t\treturn FAILURE;",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"phar error: internal corruption of zip-based phar \\\"%s\\\" (cannot read local data descriptor for file \\\"%s\\\")\", idata->phar->fname, ZSTR_VAL(entry->filename));",
          "content_same": false
        },
        {
          "line": 2425,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(&(local.crc32), &(desc.crc32), 12)",
          "old_line_content": "\t\t\t} else {",
          "new_line_content": "\t\t\t\tmemcpy(&(local.crc32), &(desc.crc32), 12);",
          "content_same": false
        },
        {
          "line": 2428,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(&(local.crc32), &desc, 12)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tmemcpy(&(local.crc32), &desc, 12);",
          "content_same": false
        },
        {
          "line": 2433,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\treturn FAILURE;",
          "new_line_content": "\t\t\tspprintf(error, 0, \"phar error: internal corruption of zip-based phar \\\"%s\\\" (local header of file \\\"%s\\\" does not match central directory)\", idata->phar->fname, ZSTR_VAL(entry->filename));",
          "content_same": false
        },
        {
          "line": 2439,
          "old_api": null,
          "new_api": "PHAR_ZIP_16",
          "old_text": null,
          "new_text": "PHAR_ZIP_16(local.extra_len)",
          "old_line_content": "",
          "new_line_content": "\t\t\tsizeof(local) + entry->header_offset + PHAR_ZIP_16(local.filename_len) + PHAR_ZIP_16(local.extra_len);",
          "content_same": false
        },
        {
          "line": 2450,
          "old_api": null,
          "new_api": "php_stream_seek",
          "old_text": null,
          "new_text": "php_stream_seek(fp, idata->zero, SEEK_SET)",
          "old_line_content": "",
          "new_line_content": "\tphp_stream_seek(fp, idata->zero, SEEK_SET);",
          "content_same": false
        },
        {
          "line": 2453,
          "old_api": null,
          "new_api": "php_crc32_stream_bulk_update",
          "old_text": null,
          "new_text": "php_crc32_stream_bulk_update(&crc, fp, idata->internal_file->uncompressed_filesize)",
          "old_line_content": "",
          "new_line_content": "\tzend_result ret = php_crc32_stream_bulk_update(&crc, fp, idata->internal_file->uncompressed_filesize);",
          "content_same": false
        },
        {
          "line": 2455,
          "old_api": null,
          "new_api": "php_stream_seek",
          "old_text": null,
          "new_text": "php_stream_seek(fp, idata->zero, SEEK_SET)",
          "old_line_content": "",
          "new_line_content": "\tphp_stream_seek(fp, idata->zero, SEEK_SET);",
          "content_same": false
        },
        {
          "line": 2457,
          "old_api": null,
          "new_api": "php_crc32_bulk_end",
          "old_text": null,
          "new_text": "php_crc32_bulk_end(crc)",
          "old_line_content": "\t\tentry->is_crc_checked = 1;",
          "new_line_content": "\tif (SUCCESS == ret && php_crc32_bulk_end(crc) == crc32) {",
          "content_same": false
        },
        {
          "line": 2461,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\treturn FAILURE;",
          "new_line_content": "\t\tspprintf(error, 0, \"phar error: internal corruption of phar \\\"%s\\\" (crc32 mismatch on file \\\"%s\\\")\", idata->phar->fname, ZSTR_VAL(entry->filename));",
          "content_same": false
        },
        {
          "line": 2475,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(buffer, &var, sizeof(var))",
          "old_line_content": "#endif",
          "new_line_content": "\t memcpy(buffer, &var, sizeof(var));",
          "content_same": false
        },
        {
          "line": 2481,
          "old_api": null,
          "new_api": "Z_PTR_P",
          "old_text": null,
          "new_text": "Z_PTR_P(zv)",
          "old_line_content": "",
          "new_line_content": "\tphar_entry_info *entry = (phar_entry_info *)Z_PTR_P(zv);",
          "content_same": false
        },
        {
          "line": 2510,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(web_index)",
          "old_line_content": "",
          "new_line_content": "\tweb_len = strlen(web_index);",
          "content_same": false
        },
        {
          "line": 2515,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"Illegal filename passed in for stub creation, was %zd characters long, and only 400 or less is allowed\", index_len)",
          "old_line_content": "\t\t\treturn NULL;",
          "new_line_content": "\t\t\tspprintf(error, 0, \"Illegal filename passed in for stub creation, was %zd characters long, and only 400 or less is allowed\", index_len);",
          "content_same": false
        },
        {
          "line": 2523,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"Illegal web filename passed in for stub creation, was %zd characters long, and only 400 or less is allowed\", web_len)",
          "old_line_content": "\t\t\treturn NULL;",
          "new_line_content": "\t\t\tspprintf(error, 0, \"Illegal web filename passed in for stub creation, was %zd characters long, and only 400 or less is allowed\", web_len);",
          "content_same": false
        },
        {
          "line": 2528,
          "old_api": null,
          "new_api": "phar_get_stub",
          "old_text": null,
          "new_text": "phar_get_stub(index_php, web_index, index_len+1, web_len+1)",
          "old_line_content": "}",
          "new_line_content": "\treturn phar_get_stub(index_php, web_index, index_len+1, web_len+1);",
          "content_same": false
        },
        {
          "line": 2533,
          "old_api": null,
          "new_api": "phar_flush_ex",
          "old_text": null,
          "new_text": "phar_flush_ex(phar, NULL, false, error)",
          "old_line_content": "}",
          "new_line_content": "\tphar_flush_ex(phar, NULL, false, error);",
          "content_same": false
        },
        {
          "line": 2567,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"internal error: attempt to flush cached zip-based phar \\\"%s\\\"\", phar->fname)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tspprintf(error, 0, \"internal error: attempt to flush cached zip-based phar \\\"%s\\\"\", phar->fname);",
          "content_same": false
        },
        {
          "line": 2576,
          "old_api": null,
          "new_api": "zend_hash_num_elements",
          "old_text": null,
          "new_text": "zend_hash_num_elements(&phar->manifest)",
          "old_line_content": "\t\treturn;",
          "new_line_content": "\tif (!zend_hash_num_elements(&phar->manifest) && !user_stub) {",
          "content_same": false
        },
        {
          "line": 2580,
          "old_api": null,
          "new_api": "zend_hash_clean",
          "old_text": null,
          "new_text": "zend_hash_clean(&phar->virtual_dirs)",
          "old_line_content": "",
          "new_line_content": "\tzend_hash_clean(&phar->virtual_dirs);",
          "content_same": false
        },
        {
          "line": 2583,
          "old_api": null,
          "new_api": "phar_zip_flush",
          "old_text": null,
          "new_text": "phar_zip_flush(phar, user_stub, is_default_stub, error)",
          "old_line_content": "\t\treturn;",
          "new_line_content": "\t\tphar_zip_flush(phar, user_stub, is_default_stub, error);",
          "content_same": false
        },
        {
          "line": 2588,
          "old_api": null,
          "new_api": "phar_tar_flush",
          "old_text": null,
          "new_text": "phar_tar_flush(phar, user_stub, is_default_stub, error)",
          "old_line_content": "\t\treturn;",
          "new_line_content": "\t\tphar_tar_flush(phar, user_stub, is_default_stub, error);",
          "content_same": false
        },
        {
          "line": 2592,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(readonly)",
          "old_line_content": "\t\treturn;",
          "new_line_content": "\tif (PHAR_G(readonly)) {",
          "content_same": false
        },
        {
          "line": 2599,
          "old_api": null,
          "new_api": "php_stream_rewind",
          "old_text": null,
          "new_text": "php_stream_rewind(oldfile)",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\tphp_stream_rewind(oldfile);",
          "content_same": false
        },
        {
          "line": 2601,
          "old_api": null,
          "new_api": "php_stream_open_wrapper",
          "old_text": null,
          "new_text": "php_stream_open_wrapper(phar->fname, \"rb\", 0, NULL)",
          "old_line_content": "\t\tmust_close_old_file = oldfile != NULL;",
          "new_line_content": "\t\toldfile = php_stream_open_wrapper(phar->fname, \"rb\", 0, NULL);",
          "content_same": false
        },
        {
          "line": 2604,
          "old_api": null,
          "new_api": "php_stream_fopen_tmpfile",
          "old_text": null,
          "new_text": "php_stream_fopen_tmpfile()",
          "old_line_content": "\tif (!newfile) {",
          "new_line_content": "\tnewfile = php_stream_fopen_tmpfile();",
          "content_same": false
        },
        {
          "line": 2607,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"unable to create temporary file\")",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tspprintf(error, 0, \"unable to create temporary file\");",
          "content_same": false
        },
        {
          "line": 2610,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 2616,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(halt_stub)",
          "old_line_content": "",
          "new_line_content": "\t\tchar *pos = php_stristr(ZSTR_VAL(user_stub), halt_stub, ZSTR_LEN(user_stub), strlen(halt_stub));",
          "content_same": false
        },
        {
          "line": 2620,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 2622,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\t\tif (error) {",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 2624,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"illegal stub for phar \\\"%s\\\" (__HALT_COMPILER(); is missing)\", phar->fname)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"illegal stub for phar \\\"%s\\\" (__HALT_COMPILER(); is missing)\", phar->fname);",
          "content_same": false
        },
        {
          "line": 2629,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(halt_stub)",
          "old_line_content": "\t\tconst char end_sequence[] = \" ?>\\r\\n\";",
          "new_line_content": "\t\tsize_t len = pos - ZSTR_VAL(user_stub) + strlen(halt_stub);",
          "content_same": false
        },
        {
          "line": 2631,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(end_sequence)",
          "old_line_content": "",
          "new_line_content": "\t\tsize_t end_sequence_len = strlen(end_sequence);",
          "content_same": false
        },
        {
          "line": 2635,
          "old_api": null,
          "new_api": "php_stream_write",
          "old_text": null,
          "new_text": "php_stream_write(newfile, end_sequence, end_sequence_len)",
          "old_line_content": "\t\t) {",
          "new_line_content": "\t\t\t|| end_sequence_len != php_stream_write(newfile, end_sequence, end_sequence_len)",
          "content_same": false
        },
        {
          "line": 2638,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 2640,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\t\tif (error) {",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 2642,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"unable to create stub from string in new phar \\\"%s\\\"\", phar->fname)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"unable to create stub from string in new phar \\\"%s\\\"\", phar->fname);",
          "content_same": false
        },
        {
          "line": 2652,
          "old_api": null,
          "new_api": "php_stream_copy_to_stream_ex",
          "old_text": null,
          "new_text": "php_stream_copy_to_stream_ex(oldfile, newfile, phar->halt_offset, &written)",
          "old_line_content": "\t\t} else {",
          "new_line_content": "\t\t\tphp_stream_copy_to_stream_ex(oldfile, newfile, phar->halt_offset, &written);",
          "content_same": false
        },
        {
          "line": 2657,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(new_stub)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\twritten = php_stream_write(newfile, ZSTR_VAL(new_stub), phar->halt_offset);",
          "content_same": false
        },
        {
          "line": 2661,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 2663,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\t\tif (error) {",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 2666,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"unable to create stub in new phar \\\"%s\\\"\", phar->fname)",
          "old_line_content": "\t\t\t\t} else {",
          "new_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to create stub in new phar \\\"%s\\\"\", phar->fname);",
          "content_same": false
        },
        {
          "line": 2668,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"unable to copy stub of old phar to new phar \\\"%s\\\"\", phar->fname)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to copy stub of old phar to new phar \\\"%s\\\"\", phar->fname);",
          "content_same": false
        },
        {
          "line": 2672,
          "old_api": null,
          "new_api": "zend_string_free",
          "old_text": null,
          "new_text": "zend_string_free(new_stub)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tzend_string_free(new_stub);",
          "content_same": false
        },
        {
          "line": 2677,
          "old_api": null,
          "new_api": "zend_string_free",
          "old_text": null,
          "new_text": "zend_string_free(new_stub)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tzend_string_free(new_stub);",
          "content_same": false
        },
        {
          "line": 2680,
          "old_api": null,
          "new_api": "php_stream_tell",
          "old_text": null,
          "new_text": "php_stream_tell(newfile)",
          "old_line_content": "\thalt_offset = manifest_ftell;",
          "new_line_content": "\tmanifest_ftell = php_stream_tell(newfile);",
          "content_same": false
        },
        {
          "line": 2686,
          "old_api": null,
          "new_api": "zend_hash_apply",
          "old_text": null,
          "new_text": "zend_hash_apply(&phar->manifest, phar_flush_clean_deleted_apply)",
          "old_line_content": "",
          "new_line_content": "\tzend_hash_apply(&phar->manifest, phar_flush_clean_deleted_apply);",
          "content_same": false
        },
        {
          "line": 2695,
          "old_api": null,
          "new_api": "PHP_VAR_SERIALIZE_DESTROY",
          "old_text": null,
          "new_text": "PHP_VAR_SERIALIZE_DESTROY(metadata_hash)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tPHP_VAR_SERIALIZE_DESTROY(metadata_hash);",
          "content_same": false
        },
        {
          "line": 2699,
          "old_api": null,
          "new_api": "ZEND_HASH_MAP_FOREACH_PTR",
          "old_text": null,
          "new_text": "ZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry)",
          "old_line_content": "\t\tif (entry->cfp) {",
          "new_line_content": "\tZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry) {",
          "content_same": false
        },
        {
          "line": 2702,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(entry->cfp)",
          "old_line_content": "\t\t\tentry->cfp = 0;",
          "new_line_content": "\t\t\tphp_stream_close(entry->cfp);",
          "content_same": false
        },
        {
          "line": 2723,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(entry->filename)",
          "old_line_content": "",
          "new_line_content": "\t\tphar_add_virtual_dirs(phar, ZSTR_VAL(entry->filename), ZSTR_LEN(entry->filename));",
          "content_same": false
        },
        {
          "line": 2730,
          "old_api": null,
          "new_api": "ZEND_ASSERT",
          "old_text": null,
          "new_text": "ZEND_ASSERT(!entry->is_persistent)",
          "old_line_content": "\t\t\t/* Assume serialization will succeed. TODO: Set error and throw if EG(exception) != NULL */",
          "new_line_content": "\t\t\tZEND_ASSERT(!entry->is_persistent);",
          "content_same": false
        },
        {
          "line": 2735,
          "old_api": null,
          "new_api": "PHP_VAR_SERIALIZE_DESTROY",
          "old_text": null,
          "new_text": "PHP_VAR_SERIALIZE_DESTROY(metadata_hash)",
          "old_line_content": "\t\t\tentry->metadata_tracker.str = buf.s;",
          "new_line_content": "\t\t\tPHP_VAR_SERIALIZE_DESTROY(metadata_hash);",
          "content_same": false
        },
        {
          "line": 2740,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(entry->metadata_tracker.str)",
          "old_line_content": "",
          "new_line_content": "\t\toffset += 4 + ZSTR_LEN(entry->filename) + sizeof(entry_buffer) + (entry->metadata_tracker.str ? ZSTR_LEN(entry->metadata_tracker.str) : 0) + (entry->is_dir ? 1 : 0);",
          "content_same": false
        },
        {
          "line": 2750,
          "old_api": null,
          "new_api": "phar_get_efp",
          "old_text": null,
          "new_text": "phar_get_efp(entry, 0)",
          "old_line_content": "\t\t\t/* re-open internal file pointer just-in-time */",
          "new_line_content": "\t\tif (!phar_get_efp(entry, 0)) {",
          "content_same": false
        },
        {
          "line": 2752,
          "old_api": null,
          "new_api": "phar_open_jit",
          "old_text": null,
          "new_text": "phar_open_jit(phar, entry, error)",
          "old_line_content": "\t\t\tif (!newentry) {",
          "new_line_content": "\t\t\tnewentry = phar_open_jit(phar, entry, error);",
          "content_same": false
        },
        {
          "line": 2755,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(*error)",
          "old_line_content": "\t\t\t\t*error = NULL;",
          "new_line_content": "\t\t\t\tefree(*error);",
          "content_same": false
        },
        {
          "line": 2762,
          "old_api": null,
          "new_api": "phar_seek_efp",
          "old_text": null,
          "new_text": "phar_seek_efp(entry, 0, SEEK_SET, 0, 1)",
          "old_line_content": "\t\t\tif (must_close_old_file) {",
          "new_line_content": "\t\tif (-1 == phar_seek_efp(entry, 0, SEEK_SET, 0, 1)) {",
          "content_same": false
        },
        {
          "line": 2764,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 2766,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\t\tif (error) {",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 2768,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"unable to seek to start of file \\\"%s\\\" while creating new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "content_same": false
        },
        {
          "line": 2774,
          "old_api": null,
          "new_api": "php_crc32_bulk_end",
          "old_text": null,
          "new_text": "php_crc32_bulk_end(newcrc32)",
          "old_line_content": "\t\tentry->is_crc_checked = 1;",
          "new_line_content": "\t\tentry->crc32 = php_crc32_bulk_end(newcrc32);",
          "content_same": false
        },
        {
          "line": 2781,
          "old_api": null,
          "new_api": "phar_compress_filter",
          "old_text": null,
          "new_text": "phar_compress_filter(entry, 0)",
          "old_line_content": "\t\tif (!filter) {",
          "new_line_content": "\t\tfilter = php_stream_filter_create(phar_compress_filter(entry, 0), NULL, 0);",
          "content_same": false
        },
        {
          "line": 2784,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 2786,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\t\tif (entry->flags & PHAR_ENT_COMPRESSED_GZ) {",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 2789,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to gzip compress file \\\"%s\\\" to new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "content_same": false
        },
        {
          "line": 2793,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to bzip2 compress file \\\"%s\\\" to new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "content_same": false
        },
        {
          "line": 2803,
          "old_api": null,
          "new_api": "php_stream_fopen_tmpfile",
          "old_text": null,
          "new_text": "php_stream_fopen_tmpfile()",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tshared_cfp = php_stream_fopen_tmpfile();",
          "content_same": false
        },
        {
          "line": 2808,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"unable to create temporary file\")",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"unable to create temporary file\");",
          "content_same": false
        },
        {
          "line": 2811,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 2813,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\t\tgoto cleanup;",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 2820,
          "old_api": null,
          "new_api": "phar_seek_efp",
          "old_text": null,
          "new_text": "phar_seek_efp(entry, 0, SEEK_SET, 0, 0)",
          "old_line_content": "\t\t\tif (must_close_old_file) {",
          "new_line_content": "\t\tif (-1 == phar_seek_efp(entry, 0, SEEK_SET, 0, 0)) {",
          "content_same": false
        },
        {
          "line": 2822,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 2824,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\t\tif (error) {",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 2826,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"unable to seek to start of file \\\"%s\\\" while creating new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "content_same": false
        },
        {
          "line": 2831,
          "old_api": null,
          "new_api": "php_stream_copy_to_stream_ex",
          "old_text": null,
          "new_text": "php_stream_copy_to_stream_ex(file, entry->cfp, entry->uncompressed_filesize, NULL)",
          "old_line_content": "\t\t\tif (must_close_old_file) {",
          "new_line_content": "\t\tif (SUCCESS != php_stream_copy_to_stream_ex(file, entry->cfp, entry->uncompressed_filesize, NULL)) {",
          "content_same": false
        },
        {
          "line": 2833,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 2835,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\t\tif (error) {",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 2837,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"unable to copy compressed file contents of file \\\"%s\\\" while creating new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "content_same": false
        },
        {
          "line": 2845,
          "old_api": null,
          "new_api": "php_stream_tell",
          "old_text": null,
          "new_text": "php_stream_tell(entry->cfp)",
          "old_line_content": "\t\t/* generate crc on compressed file */",
          "new_line_content": "\t\tentry->compressed_filesize = ((uint32_t) php_stream_tell(entry->cfp)) - entry->header_offset;",
          "content_same": false
        },
        {
          "line": 2850,
          "old_api": null,
          "new_api": "ZEND_HASH_FOREACH_END",
          "old_text": null,
          "new_text": "ZEND_HASH_FOREACH_END()",
          "old_line_content": "\tglobal_flags |= PHAR_HDR_SIGNATURE;",
          "new_line_content": "\t} ZEND_HASH_FOREACH_END();",
          "content_same": false
        },
        {
          "line": 2869,
          "old_api": null,
          "new_api": "phar_set_32",
          "old_text": null,
          "new_text": "phar_set_32(manifest, manifest_len)",
          "old_line_content": "\t/* Hack - see bug #65028, add padding byte to the end of the manifest */",
          "new_line_content": "\tphar_set_32(manifest, manifest_len);",
          "content_same": false
        },
        {
          "line": 2873,
          "old_api": null,
          "new_api": "phar_set_32",
          "old_text": null,
          "new_text": "phar_set_32(manifest, manifest_len)",
          "old_line_content": "\t\tmanifest_hack = true;",
          "new_line_content": "\t\tphar_set_32(manifest, manifest_len);",
          "content_same": false
        },
        {
          "line": 2876,
          "old_api": null,
          "new_api": "phar_set_32",
          "old_text": null,
          "new_text": "phar_set_32(manifest+4, new_manifest_count)",
          "old_line_content": "\tif (has_dirs) {",
          "new_line_content": "\tphar_set_32(manifest+4, new_manifest_count);",
          "content_same": false
        },
        {
          "line": 2885,
          "old_api": null,
          "new_api": "phar_set_32",
          "old_text": null,
          "new_text": "phar_set_32(manifest+14, phar->alias_len)",
          "old_line_content": "",
          "new_line_content": "\tphar_set_32(manifest+14, phar->alias_len);",
          "content_same": false
        },
        {
          "line": 2889,
          "old_api": null,
          "new_api": "php_stream_write",
          "old_text": null,
          "new_text": "php_stream_write(newfile, phar->alias, phar->alias_len)",
          "old_line_content": "",
          "new_line_content": "\t|| (size_t)phar->alias_len != php_stream_write(newfile, phar->alias, phar->alias_len)) {",
          "content_same": false
        },
        {
          "line": 2892,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 2895,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\tphar->alias_len = restore_alias_len;",
          "new_line_content": "\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 2899,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"unable to write manifest header of new phar \\\"%s\\\"\", phar->fname)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tspprintf(error, 0, \"unable to write manifest header of new phar \\\"%s\\\"\", phar->fname);",
          "content_same": false
        },
        {
          "line": 2910,
          "old_api": null,
          "new_api": "smart_str_free",
          "old_text": null,
          "new_text": "smart_str_free(&main_metadata_str)",
          "old_line_content": "",
          "new_line_content": "\t\tsmart_str_free(&main_metadata_str);",
          "content_same": false
        },
        {
          "line": 2913,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 2916,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\tphar->alias_len = restore_alias_len;",
          "new_line_content": "\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 2920,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"unable to write manifest meta-data of new phar \\\"%s\\\"\", phar->fname)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tspprintf(error, 0, \"unable to write manifest meta-data of new phar \\\"%s\\\"\", phar->fname);",
          "content_same": false
        },
        {
          "line": 2925,
          "old_api": null,
          "new_api": "smart_str_free",
          "old_text": null,
          "new_text": "smart_str_free(&main_metadata_str)",
          "old_line_content": "",
          "new_line_content": "\tsmart_str_free(&main_metadata_str);",
          "content_same": false
        },
        {
          "line": 2928,
          "old_api": null,
          "new_api": "php_stream_tell",
          "old_text": null,
          "new_text": "php_stream_tell(newfile)",
          "old_line_content": "",
          "new_line_content": "\tmanifest_ftell = php_stream_tell(newfile);",
          "content_same": false
        },
        {
          "line": 2931,
          "old_api": null,
          "new_api": "ZEND_HASH_MAP_FOREACH_PTR",
          "old_text": null,
          "new_text": "ZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry)",
          "old_line_content": "\t\tconst zend_string *metadata_str;",
          "new_line_content": "\tZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry) {",
          "content_same": false
        },
        {
          "line": 2940,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(entry->filename)",
          "old_line_content": "\t\t} else {",
          "new_line_content": "\t\t\tphar_set_32(entry_buffer, ZSTR_LEN(entry->filename) + 1);",
          "content_same": false
        },
        {
          "line": 2942,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(entry->filename)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tphar_set_32(entry_buffer, ZSTR_LEN(entry->filename));",
          "content_same": false
        },
        {
          "line": 2947,
          "old_api": null,
          "new_api": "php_stream_write",
          "old_text": null,
          "new_text": "php_stream_write(newfile, \"/\", 1)",
          "old_line_content": "\t\t\tif (must_close_old_file) {",
          "new_line_content": "\t\t|| (entry->is_dir && 1 != php_stream_write(newfile, \"/\", 1))) {",
          "content_same": false
        },
        {
          "line": 2949,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 2951,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\t\tif (error) {",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 2954,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\t\t} else {",
          "new_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to write filename of directory \\\"%s\\\" to manifest of new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "content_same": false
        },
        {
          "line": 2956,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to write filename of file \\\"%s\\\" to manifest of new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "content_same": false
        },
        {
          "line": 2976,
          "old_api": null,
          "new_api": "phar_set_32",
          "old_text": null,
          "new_text": "phar_set_32(entry_buffer+16, entry->flags)",
          "old_line_content": "\t\tmetadata_str = entry->metadata_tracker.str;",
          "new_line_content": "\t\tphar_set_32(entry_buffer+16, entry->flags);",
          "content_same": false
        },
        {
          "line": 2978,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(metadata_str)",
          "old_line_content": "",
          "new_line_content": "\t\tphar_set_32(entry_buffer+20, metadata_str ? ZSTR_LEN(metadata_str) : 0);",
          "content_same": false
        },
        {
          "line": 2980,
          "old_api": null,
          "new_api": "php_stream_write",
          "old_text": null,
          "new_text": "php_stream_write(newfile, entry_buffer, sizeof(entry_buffer))",
          "old_line_content": "\t\t|| (metadata_str &&",
          "new_line_content": "\t\tif (sizeof(entry_buffer) != php_stream_write(newfile, entry_buffer, sizeof(entry_buffer))",
          "content_same": false
        },
        {
          "line": 2982,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(metadata_str)",
          "old_line_content": "\t\t\tif (must_close_old_file) {",
          "new_line_content": "\t\t    ZSTR_LEN(metadata_str) != php_stream_write(newfile, ZSTR_VAL(metadata_str), ZSTR_LEN(metadata_str)))) {",
          "content_same": false
        },
        {
          "line": 2984,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 2987,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 2990,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"unable to write temporary manifest of file \\\"%s\\\" to manifest of new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "content_same": false
        },
        {
          "line": 2995,
          "old_api": null,
          "new_api": "ZEND_HASH_FOREACH_END",
          "old_text": null,
          "new_text": "ZEND_HASH_FOREACH_END()",
          "old_line_content": "\t/* Hack - see bug #65028, add padding byte to the end of the manifest */",
          "new_line_content": "\t} ZEND_HASH_FOREACH_END();",
          "content_same": false
        },
        {
          "line": 2998,
          "old_api": null,
          "new_api": "php_stream_write",
          "old_text": null,
          "new_text": "php_stream_write(newfile, manifest, 1)",
          "old_line_content": "\t\t\tif (must_close_old_file) {",
          "new_line_content": "\t\tif(1 != php_stream_write(newfile, manifest, 1)) {",
          "content_same": false
        },
        {
          "line": 3000,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 3003,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 3006,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"unable to write manifest padding byte\")",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"unable to write manifest padding byte\");",
          "content_same": false
        },
        {
          "line": 3015,
          "old_api": null,
          "new_api": "ZEND_HASH_MAP_FOREACH_PTR",
          "old_text": null,
          "new_text": "ZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry)",
          "old_line_content": "\t\tif (entry->is_deleted || entry->is_dir || entry->is_mounted) {",
          "new_line_content": "\tZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry) {",
          "content_same": false
        },
        {
          "line": 3022,
          "old_api": null,
          "new_api": "php_stream_seek",
          "old_text": null,
          "new_text": "php_stream_seek(file, entry->header_offset, SEEK_SET)",
          "old_line_content": "\t\t} else {",
          "new_line_content": "\t\t\tphp_stream_seek(file, entry->header_offset, SEEK_SET);",
          "content_same": false
        },
        {
          "line": 3025,
          "old_api": null,
          "new_api": "phar_seek_efp",
          "old_text": null,
          "new_text": "phar_seek_efp(entry, 0, SEEK_SET, 0, 0)",
          "old_line_content": "\t\t\t\tif (must_close_old_file) {",
          "new_line_content": "\t\t\tif (-1 == phar_seek_efp(entry, 0, SEEK_SET, 0, 0)) {",
          "content_same": false
        },
        {
          "line": 3027,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 3029,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\t\t\tif (error) {",
          "new_line_content": "\t\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 3031,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to seek to start of file \\\"%s\\\" while creating new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "content_same": false
        },
        {
          "line": 3039,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 3041,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\t\tif (error) {",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 3043,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"unable to seek to start of file \\\"%s\\\" while creating new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "content_same": false
        },
        {
          "line": 3051,
          "old_api": null,
          "new_api": "php_stream_copy_to_stream_ex",
          "old_text": null,
          "new_text": "php_stream_copy_to_stream_ex(file, newfile, entry->compressed_filesize, &wrote)",
          "old_line_content": "\t\t\tif (must_close_old_file) {",
          "new_line_content": "\t\tif (php_stream_copy_to_stream_ex(file, newfile, entry->compressed_filesize, &wrote) == FAILURE) {",
          "content_same": false
        },
        {
          "line": 3053,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 3056,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 3059,
          "old_api": null,
          "new_api": "ZSTR_VAL",
          "old_text": null,
          "new_text": "ZSTR_VAL(entry->filename)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"unable to write contents of file \\\"%s\\\" to new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "content_same": false
        },
        {
          "line": 3075,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(entry->fp)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tphp_stream_close(entry->fp);",
          "content_same": false
        },
        {
          "line": 3083,
          "old_api": null,
          "new_api": "ZEND_HASH_FOREACH_END",
          "old_text": null,
          "new_text": "ZEND_HASH_FOREACH_END()",
          "old_line_content": "",
          "new_line_content": "\t} ZEND_HASH_FOREACH_END();",
          "content_same": false
        },
        {
          "line": 3086,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(shared_cfp)",
          "old_line_content": "\t\tshared_cfp = NULL;",
          "new_line_content": "\t\tphp_stream_close(shared_cfp);",
          "content_same": false
        },
        {
          "line": 3094,
          "old_api": null,
          "new_api": "php_stream_rewind",
          "old_text": null,
          "new_text": "php_stream_rewind(newfile)",
          "old_line_content": "",
          "new_line_content": "\t\tphp_stream_rewind(newfile);",
          "content_same": false
        },
        {
          "line": 3097,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(phar->signature)",
          "old_line_content": "\t\t\tphar->signature = NULL;",
          "new_line_content": "\t\t\tefree(phar->signature);",
          "content_same": false
        },
        {
          "line": 3106,
          "old_api": null,
          "new_api": "phar_create_signature",
          "old_text": null,
          "new_text": "phar_create_signature(phar, newfile, &digest, &digest_len, error)",
          "old_line_content": "\t\t\t\t\tif (error) {",
          "new_line_content": "\t\t\t\tif (FAILURE == phar_create_signature(phar, newfile, &digest, &digest_len, error)) {",
          "content_same": false
        },
        {
          "line": 3110,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(save)",
          "old_line_content": "\t\t\t\t\t}",
          "new_line_content": "\t\t\t\t\t\tefree(save);",
          "content_same": false
        },
        {
          "line": 3113,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(digest)",
          "old_line_content": "\t\t\t\t\t}",
          "new_line_content": "\t\t\t\t\t\tefree(digest);",
          "content_same": false
        },
        {
          "line": 3116,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t\t\t\t\t}",
          "new_line_content": "\t\t\t\t\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 3118,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\t\t\t\treturn;",
          "new_line_content": "\t\t\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 3123,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(digest)",
          "old_line_content": "\t\t\t\tif (phar->sig_flags == PHAR_SIG_OPENSSL ||",
          "new_line_content": "\t\t\t\tefree(digest);",
          "content_same": false
        },
        {
          "line": 3128,
          "old_api": null,
          "new_api": "php_stream_write",
          "old_text": null,
          "new_text": "php_stream_write(newfile, sig_buf, 4)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tphp_stream_write(newfile, sig_buf, 4);",
          "content_same": false
        },
        {
          "line": 3135,
          "old_api": null,
          "new_api": "php_stream_write",
          "old_text": null,
          "new_text": "php_stream_write(newfile, \"GBMB\", 4)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tphp_stream_write(newfile, \"GBMB\", 4);",
          "content_same": false
        },
        {
          "line": 3142,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(phar->fp)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tphp_stream_close(phar->fp);",
          "content_same": false
        },
        {
          "line": 3147,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(phar->ufp)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tphp_stream_close(phar->ufp);",
          "content_same": false
        },
        {
          "line": 3153,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(oldfile)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tphp_stream_close(oldfile);",
          "content_same": false
        },
        {
          "line": 3159,
          "old_api": null,
          "new_api": "php_stream_rewind",
          "old_text": null,
          "new_text": "php_stream_rewind(newfile)",
          "old_line_content": "",
          "new_line_content": "\tphp_stream_rewind(newfile);",
          "content_same": false
        },
        {
          "line": 3165,
          "old_api": null,
          "new_api": "php_stream_open_wrapper",
          "old_text": null,
          "new_text": "php_stream_open_wrapper(phar->fname, \"w+b\", IGNORE_URL|STREAM_MUST_SEEK|REPORT_ERRORS, NULL)",
          "old_line_content": "\t\tif (!phar->fp) {",
          "new_line_content": "\t\tphar->fp = php_stream_open_wrapper(phar->fname, \"w+b\", IGNORE_URL|STREAM_MUST_SEEK|REPORT_ERRORS, NULL);",
          "content_same": false
        },
        {
          "line": 3169,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 4096, \"unable to open new phar \\\"%s\\\" for writing\", phar->fname)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 4096, \"unable to open new phar \\\"%s\\\" for writing\", phar->fname);",
          "content_same": false
        },
        {
          "line": 3181,
          "old_api": null,
          "new_api": "Z_ARR",
          "old_text": null,
          "new_text": "Z_ARR(filterparams)",
          "old_line_content": "",
          "new_line_content": "\t\t\tzend_array_destroy(Z_ARR(filterparams));",
          "content_same": false
        },
        {
          "line": 3185,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 4096, \"unable to compress all contents of phar \\\"%s\\\" using zlib, PHP versions older than 5.2.6 have a buggy zlib\", phar->fname)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tspprintf(error, 4096, \"unable to compress all contents of phar \\\"%s\\\" using zlib, PHP versions older than 5.2.6 have a buggy zlib\", phar->fname);",
          "content_same": false
        },
        {
          "line": 3194,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(phar->fp)",
          "old_line_content": "\t\t\t/* use the temp stream as our base */",
          "new_line_content": "\t\t\tphp_stream_close(phar->fp);",
          "content_same": false
        },
        {
          "line": 3203,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(phar->fp)",
          "old_line_content": "\t\t\t/* use the temp stream as our base */",
          "new_line_content": "\t\t\tphp_stream_close(phar->fp);",
          "content_same": false
        },
        {
          "line": 3207,
          "old_api": null,
          "new_api": "php_stream_copy_to_stream_ex",
          "old_text": null,
          "new_text": "php_stream_copy_to_stream_ex(newfile, phar->fp, PHP_STREAM_COPY_ALL, NULL)",
          "old_line_content": "\t\t\t/* we could also reopen the file in \"rb\" mode but there is no need for that */",
          "new_line_content": "\t\t\tphp_stream_copy_to_stream_ex(newfile, phar->fp, PHP_STREAM_COPY_ALL, NULL);",
          "content_same": false
        },
        {
          "line": 3209,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(newfile)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tphp_stream_close(newfile);",
          "content_same": false
        },
        {
          "line": 3213,
          "old_api": null,
          "new_api": "php_stream_seek",
          "old_text": null,
          "new_text": "php_stream_seek(phar->fp, phar->halt_offset, SEEK_SET)",
          "old_line_content": "\t\tif (error) {",
          "new_line_content": "\tif (-1 == php_stream_seek(phar->fp, phar->halt_offset, SEEK_SET)) {",
          "content_same": false
        },
        {
          "line": 3215,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"unable to seek to __HALT_COMPILER(); in new phar \\\"%s\\\"\", phar->fname)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tspprintf(error, 0, \"unable to seek to __HALT_COMPILER(); in new phar \\\"%s\\\"\", phar->fname);",
          "content_same": false
        },
        {
          "line": 3223,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(shared_cfp)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tphp_stream_close(shared_cfp);",
          "content_same": false
        },
        {
          "line": 3225,
          "old_api": null,
          "new_api": "ZEND_HASH_MAP_FOREACH_PTR",
          "old_text": null,
          "new_text": "ZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry)",
          "old_line_content": "\t\tif (entry->cfp) {",
          "new_line_content": "\tZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry) {",
          "content_same": false
        },
        {
          "line": 3230,
          "old_api": null,
          "new_api": "ZEND_HASH_FOREACH_END",
          "old_text": null,
          "new_text": "ZEND_HASH_FOREACH_END()",
          "old_line_content": "}",
          "new_line_content": "\t} ZEND_HASH_FOREACH_END();",
          "content_same": false
        },
        {
          "line": 3236,
          "old_api": null,
          "new_api": "ZEND_TSRMLS_CACHE_DEFINE",
          "old_text": null,
          "new_text": "ZEND_TSRMLS_CACHE_DEFINE()",
          "old_line_content": "#endif",
          "new_line_content": "ZEND_TSRMLS_CACHE_DEFINE()",
          "content_same": false
        },
        {
          "line": 3238,
          "old_api": null,
          "new_api": "ZEND_GET_MODULE",
          "old_text": null,
          "new_text": "ZEND_GET_MODULE(phar)",
          "old_line_content": "#endif",
          "new_line_content": "ZEND_GET_MODULE(phar)",
          "content_same": false
        },
        {
          "line": 3243,
          "old_api": null,
          "new_api": "phar_get_pharfp",
          "old_text": null,
          "new_text": "phar_get_pharfp((phar_archive_data*)handle)",
          "old_line_content": "}",
          "new_line_content": "\treturn php_stream_read(phar_get_pharfp((phar_archive_data*)handle), buf, len);",
          "content_same": false
        },
        {
          "line": 3256,
          "old_api": null,
          "new_api": "phar_find_in_include_path",
          "old_text": null,
          "new_text": "phar_find_in_include_path(filename, NULL)",
          "old_line_content": "\tif (!ret) {",
          "new_line_content": "\tzend_string *ret = phar_find_in_include_path(filename, NULL);",
          "content_same": false
        },
        {
          "line": 3258,
          "old_api": null,
          "new_api": "phar_save_resolve_path",
          "old_text": null,
          "new_text": "phar_save_resolve_path(filename)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tret = phar_save_resolve_path(filename);",
          "content_same": false
        },
        {
          "line": 3271,
          "old_api": null,
          "new_api": "phar_orig_compile_file",
          "old_text": null,
          "new_text": "phar_orig_compile_file(file_handle, type)",
          "old_line_content": "\t}",
          "new_line_content": "\t\treturn phar_orig_compile_file(file_handle, type);",
          "content_same": false
        },
        {
          "line": 3274,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(file_handle->filename)",
          "old_line_content": "\t\t\tif (phar->is_zip || phar->is_tar) {",
          "new_line_content": "\t\tif (SUCCESS == phar_open_from_filename(ZSTR_VAL(file_handle->filename), ZSTR_LEN(file_handle->filename), NULL, 0, 0, &phar, NULL)) {",
          "content_same": false
        },
        {
          "line": 1233,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(entry.filename)",
          "old_line_content": "\t\tif (mydata->is_persistent) {",
          "new_line_content": "\t\t\tstr = zend_string_init_interned(ZSTR_VAL(entry.filename), ZSTR_LEN(entry.filename), 1);",
          "content_same": false
        },
        {
          "line": 3282,
          "old_api": null,
          "new_api": "zend_string_release",
          "old_text": null,
          "new_text": "zend_string_release(f.filename)",
          "old_line_content": "\t\t\t\t\tf.filename = file_handle->filename;",
          "new_line_content": "\t\t\t\t\tzend_string_release(f.filename);",
          "content_same": false
        },
        {
          "line": 1237,
          "old_api": null,
          "new_api": "zend_hash_add_mem",
          "old_text": null,
          "new_text": "zend_hash_add_mem(&mydata->manifest, str, (void*)&entry, sizeof(phar_entry_info))",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tzend_hash_add_mem(&mydata->manifest, str, (void*)&entry, sizeof(phar_entry_info));",
          "content_same": false
        },
        {
          "line": 3285,
          "old_api": null,
          "new_api": "zend_string_release",
          "old_text": null,
          "new_text": "zend_string_release(f.opened_path)",
          "old_line_content": "\t\t\t\t\t}",
          "new_line_content": "\t\t\t\t\t\tzend_string_release(f.opened_path);",
          "content_same": false
        },
        {
          "line": 1243,
          "old_api": null,
          "new_api": "snprintf",
          "old_text": null,
          "new_text": "snprintf(mydata->version, sizeof(mydata->version), \"%u.%u.%u\", manifest_ver >> 12, (manifest_ver >> 8) & 0xF, (manifest_ver >> 4) & 0xF)",
          "old_line_content": "\tmydata->halt_offset = halt_offset;",
          "new_line_content": "\tsnprintf(mydata->version, sizeof(mydata->version), \"%u.%u.%u\", manifest_ver >> 12, (manifest_ver >> 8) & 0xF, (manifest_ver >> 4) & 0xF);",
          "content_same": false
        },
        {
          "line": 3292,
          "old_api": null,
          "new_api": "closer",
          "old_text": null,
          "new_text": "file_handle->handle.stream.closer(file_handle->handle.stream.handle)",
          "old_line_content": "\t\t\t\t\t\t\t}",
          "new_line_content": "\t\t\t\t\t\t\t\tfile_handle->handle.stream.closer(file_handle->handle.stream.handle);",
          "content_same": false
        },
        {
          "line": 1246,
          "old_api": null,
          "new_api": "strrchr",
          "old_text": null,
          "new_text": "strrchr(mydata->fname, '/')",
          "old_line_content": "",
          "new_line_content": "\tendbuffer = strrchr(mydata->fname, '/');",
          "content_same": false
        },
        {
          "line": 1249,
          "old_api": null,
          "new_api": "memchr",
          "old_text": null,
          "new_text": "memchr(endbuffer, '.', (mydata->fname + fname_len) - endbuffer)",
          "old_line_content": "\t\tif (mydata->ext == endbuffer) {",
          "new_line_content": "\t\tmydata->ext = memchr(endbuffer, '.', (mydata->fname + fname_len) - endbuffer);",
          "content_same": false
        },
        {
          "line": 1251,
          "old_api": null,
          "new_api": "memchr",
          "old_text": null,
          "new_text": "memchr(endbuffer + 1, '.', (mydata->fname + fname_len) - endbuffer - 1)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tmydata->ext = memchr(endbuffer + 1, '.', (mydata->fname + fname_len) - endbuffer - 1);",
          "content_same": false
        },
        {
          "line": 1260,
          "old_api": null,
          "new_api": "pestrndup",
          "old_text": null,
          "new_text": "pestrndup(mydata->fname, fname_len, mydata->is_persistent)",
          "old_line_content": "\tmydata->alias_len = alias ? alias_len : fname_len;",
          "new_line_content": "\t\tpestrndup(mydata->fname, fname_len, mydata->is_persistent);",
          "content_same": false
        },
        {
          "line": 3312,
          "old_api": null,
          "new_api": "php_stream_rewind",
          "old_text": null,
          "new_text": "php_stream_rewind(phar->fp)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\t\tphp_stream_rewind(phar->fp);",
          "content_same": false
        },
        {
          "line": 1266,
          "old_api": null,
          "new_api": "phar_request_initialize",
          "old_text": null,
          "new_text": "phar_request_initialize()",
          "old_line_content": "",
          "new_line_content": "\tphar_request_initialize();",
          "content_same": false
        },
        {
          "line": 3320,
          "old_api": null,
          "new_api": "phar_orig_compile_file",
          "old_text": null,
          "new_text": "phar_orig_compile_file(file_handle, type)",
          "old_line_content": "\t} zend_catch {",
          "new_line_content": "\t\tres = phar_orig_compile_file(file_handle, type);",
          "content_same": false
        },
        {
          "line": 1273,
          "old_api": null,
          "new_api": "phar_validate_alias",
          "old_text": null,
          "new_text": "phar_validate_alias(mydata->alias, mydata->alias_len)",
          "old_line_content": "\t\t\tsignature = NULL;",
          "new_line_content": "\t\tif (!phar_validate_alias(mydata->alias, mydata->alias_len)) {",
          "content_same": false
        },
        {
          "line": 1276,
          "old_api": null,
          "new_api": "MAPPHAR_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_FAIL(\"Cannot open archive \\\"%s\\\", invalid alias\")",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tMAPPHAR_FAIL(\"Cannot open archive \\\"%s\\\", invalid alias\");",
          "content_same": false
        },
        {
          "line": 3324,
          "old_api": null,
          "new_api": "zend_end_try",
          "old_text": null,
          "new_text": "zend_end_try()",
          "old_line_content": "",
          "new_line_content": "\t} zend_end_try();",
          "content_same": false
        },
        {
          "line": 3327,
          "old_api": null,
          "new_api": "zend_string_release",
          "old_text": null,
          "new_text": "zend_string_release(name)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tzend_string_release(name);",
          "content_same": false
        },
        {
          "line": 1280,
          "old_api": null,
          "new_api": "phar_free_alias",
          "old_text": null,
          "new_text": "phar_free_alias(fd_ptr, alias, alias_len)",
          "old_line_content": "\t\t\t\tsignature = NULL;",
          "new_line_content": "\t\t\tif (SUCCESS != phar_free_alias(fd_ptr, alias, alias_len)) {",
          "content_same": false
        },
        {
          "line": 1283,
          "old_api": null,
          "new_api": "MAPPHAR_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_FAIL(\"Cannot open archive \\\"%s\\\", alias is already in use by existing archive\")",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tMAPPHAR_FAIL(\"Cannot open archive \\\"%s\\\", alias is already in use by existing archive\");",
          "content_same": false
        },
        {
          "line": 3331,
          "old_api": null,
          "new_api": "zend_bailout",
          "old_text": null,
          "new_text": "zend_bailout()",
          "old_line_content": "\t}",
          "new_line_content": "\t\tzend_bailout();",
          "content_same": false
        },
        {
          "line": 1288,
          "old_api": null,
          "new_api": "zend_string_init_interned",
          "old_text": null,
          "new_text": "zend_string_init_interned(alias, alias_len, 1)",
          "old_line_content": "\t\t} else {",
          "new_line_content": "\t\t\tstr = zend_string_init_interned(alias, alias_len, 1);",
          "content_same": false
        },
        {
          "line": 1290,
          "old_api": null,
          "new_api": "zend_string_init",
          "old_text": null,
          "new_text": "zend_string_init(alias, alias_len, 0)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tstr = zend_string_init(alias, alias_len, 0);",
          "content_same": false
        },
        {
          "line": 3340,
          "old_api": null,
          "new_api": "Z_PTR_P",
          "old_text": null,
          "new_text": "Z_PTR_P(zv)",
          "old_line_content": "}",
          "new_line_content": "\tfree(Z_PTR_P(zv));",
          "content_same": false
        },
        {
          "line": 1293,
          "old_api": null,
          "new_api": "zend_string_release",
          "old_text": null,
          "new_text": "zend_string_release(str)",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\tzend_string_release(str);",
          "content_same": false
        },
        {
          "line": 3346,
          "old_api": null,
          "new_api": "ZEND_TSRMLS_CACHE_UPDATE",
          "old_text": null,
          "new_text": "ZEND_TSRMLS_CACHE_UPDATE()",
          "old_line_content": "#endif",
          "new_line_content": "\tZEND_TSRMLS_CACHE_UPDATE();",
          "content_same": false
        },
        {
          "line": 1299,
          "old_api": null,
          "new_api": "zend_string_init_interned",
          "old_text": null,
          "new_text": "zend_string_init_interned(mydata->fname, fname_len, 1)",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\tstr = zend_string_init_interned(mydata->fname, fname_len, 1);",
          "content_same": false
        },
        {
          "line": 1301,
          "old_api": null,
          "new_api": "zend_string_init",
          "old_text": null,
          "new_text": "zend_string_init(mydata->fname, fname_len, 0)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tstr = zend_string_init(mydata->fname, fname_len, 0);",
          "content_same": false
        },
        {
          "line": 1305,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(savebuf)",
          "old_line_content": "",
          "new_line_content": "\tefree(savebuf);",
          "content_same": false
        },
        {
          "line": 3353,
          "old_api": null,
          "new_api": "HT_INVALIDATE",
          "old_text": null,
          "new_text": "HT_INVALIDATE(&phar_globals->phar_alias_map)",
          "old_line_content": "\tphar_globals->readonly = 1;",
          "new_line_content": "\tHT_INVALIDATE(&phar_globals->phar_alias_map);",
          "content_same": false
        },
        {
          "line": 3356,
          "old_api": null,
          "new_api": "zend_hash_init",
          "old_text": null,
          "new_text": "zend_hash_init(&phar_globals->mime_types, 0, NULL, mime_type_dtor, 1)",
          "old_line_content": "",
          "new_line_content": "\tzend_hash_init(&phar_globals->mime_types, 0, NULL, mime_type_dtor, 1);",
          "content_same": false
        },
        {
          "line": 1332,
          "old_api": null,
          "new_api": "phar_detect_phar_fname_ext",
          "old_text": null,
          "new_text": "phar_detect_phar_fname_ext(fname, fname_len, &ext_str, &ext_len, !is_data, 0, 1)",
          "old_line_content": "\t\tgoto check_file;",
          "new_line_content": "\tif (phar_detect_phar_fname_ext(fname, fname_len, &ext_str, &ext_len, !is_data, 0, 1) == SUCCESS) {",
          "content_same": false
        },
        {
          "line": 1337,
          "old_api": null,
          "new_api": "phar_detect_phar_fname_ext",
          "old_text": null,
          "new_text": "phar_detect_phar_fname_ext(fname, fname_len, &ext_str, &ext_len, !is_data, 1, 1)",
          "old_line_content": "\t\tif (error) {",
          "new_line_content": "\tif (FAILURE == phar_detect_phar_fname_ext(fname, fname_len, &ext_str, &ext_len, !is_data, 1, 1)) {",
          "content_same": false
        },
        {
          "line": 1340,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"Cannot create a phar archive from a URL like \\\"%s\\\". Phar objects can only be created from local files\", fname)",
          "old_line_content": "\t\t\t} else {",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"Cannot create a phar archive from a URL like \\\"%s\\\". Phar objects can only be created from local files\", fname);",
          "content_same": false
        },
        {
          "line": 1342,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"Cannot create phar '%s', file extension (or combination) not recognised or the directory does not exist\", fname)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"Cannot create phar '%s', file extension (or combination) not recognised or the directory does not exist\", fname);",
          "content_same": false
        },
        {
          "line": 1348,
          "old_api": null,
          "new_api": "phar_open_parsed_phar",
          "old_text": null,
          "new_text": "phar_open_parsed_phar(fname, fname_len, alias, alias_len, is_data, options, test, &my_error)",
          "old_line_content": "\t\tif (pphar) {",
          "new_line_content": "\tif (phar_open_parsed_phar(fname, fname_len, alias, alias_len, is_data, options, test, &my_error) == SUCCESS) {",
          "content_same": false
        },
        {
          "line": 1355,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"Cannot open '%s' as a PharData object. Use Phar::__construct() for executable archives\", fname)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"Cannot open '%s' as a PharData object. Use Phar::__construct() for executable archives\", fname);",
          "content_same": false
        },
        {
          "line": 3403,
          "old_api": null,
          "new_api": "PHAR_SET_MIME",
          "old_text": null,
          "new_text": "PHAR_SET_MIME(\"text/xml\", PHAR_MIME_OTHER, \"xml\")",
          "old_line_content": "",
          "new_line_content": "\tPHAR_SET_MIME(\"text/xml\", PHAR_MIME_OTHER, \"xml\")",
          "content_same": false
        },
        {
          "line": 3405,
          "old_api": null,
          "new_api": "phar_restore_orig_functions",
          "old_text": null,
          "new_text": "phar_restore_orig_functions()",
          "old_line_content": "}",
          "new_line_content": "\tphar_restore_orig_functions();",
          "content_same": false
        },
        {
          "line": 1360,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(readonly)",
          "old_line_content": "\t\t\tphar_entry_info *stub;",
          "new_line_content": "\t\tif (PHAR_G(readonly) && !(*test)->is_data && ((*test)->is_tar || (*test)->is_zip)) {",
          "content_same": false
        },
        {
          "line": 1363,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"'%s' is not a phar archive. Use PharData::__construct() for a standard zip or tar archive\", fname)",
          "old_line_content": "\t\t\t\treturn FAILURE;",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"'%s' is not a phar archive. Use PharData::__construct() for a standard zip or tar archive\", fname);",
          "content_same": false
        },
        {
          "line": 3411,
          "old_api": null,
          "new_api": "zend_hash_destroy",
          "old_text": null,
          "new_text": "zend_hash_destroy(&phar_globals->mime_types)",
          "old_line_content": "}",
          "new_line_content": "\tzend_hash_destroy(&phar_globals->mime_types);",
          "content_same": false
        },
        {
          "line": 1368,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(readonly)",
          "old_line_content": "\t\t\t(*test)->is_writeable = 1;",
          "new_line_content": "\t\tif (!PHAR_G(readonly) || (*test)->is_data) {",
          "content_same": false
        },
        {
          "line": 3417,
          "old_api": null,
          "new_api": "REGISTER_INI_ENTRIES",
          "old_text": null,
          "new_text": "REGISTER_INI_ENTRIES()",
          "old_line_content": "",
          "new_line_content": "\tREGISTER_INI_ENTRIES();",
          "content_same": false
        },
        {
          "line": 1376,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(my_error)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tefree(my_error);",
          "content_same": false
        },
        {
          "line": 3425,
          "old_api": null,
          "new_api": "phar_object_init",
          "old_text": null,
          "new_text": "phar_object_init()",
          "old_line_content": "",
          "new_line_content": "\tphar_object_init();",
          "content_same": false
        },
        {
          "line": 3428,
          "old_api": null,
          "new_api": "phar_save_orig_functions",
          "old_text": null,
          "new_text": "phar_save_orig_functions()",
          "old_line_content": "",
          "new_line_content": "\tphar_save_orig_functions();",
          "content_same": false
        },
        {
          "line": 1381,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(z + 1, \"ip\", 2)",
          "old_line_content": "\t\t/* assume zip-based phar */",
          "new_line_content": "\tif (ext_len > 3 && (z = memchr(ext_str, 'z', ext_len)) && ((ext_str + ext_len) - z >= 2) && !memcmp(z + 1, \"ip\", 2)) {",
          "content_same": false
        },
        {
          "line": 3430,
          "old_api": null,
          "new_api": "php_register_url_stream_wrapper",
          "old_text": null,
          "new_text": "php_register_url_stream_wrapper(\"phar\", &php_stream_phar_wrapper)",
          "old_line_content": "}",
          "new_line_content": "\treturn php_register_url_stream_wrapper(\"phar\", &php_stream_phar_wrapper);",
          "content_same": false
        },
        {
          "line": 1383,
          "old_api": null,
          "new_api": "phar_open_or_create_zip",
          "old_text": null,
          "new_text": "phar_open_or_create_zip(fname, fname_len, alias, alias_len, is_data, options, pphar, error)",
          "old_line_content": "\t}",
          "new_line_content": "\t\treturn phar_open_or_create_zip(fname, fname_len, alias, alias_len, is_data, options, pphar, error);",
          "content_same": false
        },
        {
          "line": 1386,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(z + 1, \"ar\", 2)",
          "old_line_content": "\t\t/* assume tar-based phar */",
          "new_line_content": "\tif (ext_len > 3 && (z = memchr(ext_str, 't', ext_len)) && ((ext_str + ext_len) - z >= 2) && !memcmp(z + 1, \"ar\", 2)) {",
          "content_same": false
        },
        {
          "line": 1388,
          "old_api": null,
          "new_api": "phar_open_or_create_tar",
          "old_text": null,
          "new_text": "phar_open_or_create_tar(fname, fname_len, alias, alias_len, is_data, options, pphar, error)",
          "old_line_content": "\t}",
          "new_line_content": "\t\treturn phar_open_or_create_tar(fname, fname_len, alias, alias_len, is_data, options, pphar, error);",
          "content_same": false
        },
        {
          "line": 3436,
          "old_api": null,
          "new_api": "php_unregister_url_stream_wrapper",
          "old_text": null,
          "new_text": "php_unregister_url_stream_wrapper(\"phar\")",
          "old_line_content": "",
          "new_line_content": "\tphp_unregister_url_stream_wrapper(\"phar\");",
          "content_same": false
        },
        {
          "line": 3438,
          "old_api": null,
          "new_api": "phar_intercept_functions_shutdown",
          "old_text": null,
          "new_text": "phar_intercept_functions_shutdown()",
          "old_line_content": "",
          "new_line_content": "\tphar_intercept_functions_shutdown();",
          "content_same": false
        },
        {
          "line": 1391,
          "old_api": null,
          "new_api": "phar_create_or_parse_filename",
          "old_text": null,
          "new_text": "phar_create_or_parse_filename(fname, fname_len, alias, alias_len, is_data, options, pphar, error)",
          "old_line_content": "}",
          "new_line_content": "\treturn phar_create_or_parse_filename(fname, fname_len, alias, alias_len, is_data, options, pphar, error);",
          "content_same": false
        },
        {
          "line": 3446,
          "old_api": null,
          "new_api": "zend_hash_destroy",
          "old_text": null,
          "new_text": "zend_hash_destroy(&(cached_alias))",
          "old_line_content": "\t}",
          "new_line_content": "\t\tzend_hash_destroy(&(cached_alias));",
          "content_same": false
        },
        {
          "line": 3449,
          "old_api": null,
          "new_api": "UNREGISTER_INI_ENTRIES",
          "old_text": null,
          "new_text": "UNREGISTER_INI_ENTRIES()",
          "old_line_content": "\treturn SUCCESS;",
          "new_line_content": "\tUNREGISTER_INI_ENTRIES();",
          "content_same": false
        },
        {
          "line": 1407,
          "old_api": null,
          "new_api": "php_check_open_basedir",
          "old_text": null,
          "new_text": "php_check_open_basedir(fname)",
          "old_line_content": "\t\treturn FAILURE;",
          "new_line_content": "\tif (php_check_open_basedir(fname)) {",
          "content_same": false
        },
        {
          "line": 3456,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(request_init)",
          "old_line_content": "\t{",
          "new_line_content": "\tif (!PHAR_G(request_init))",
          "content_same": false
        },
        {
          "line": 1412,
          "old_api": null,
          "new_api": "php_stream_open_wrapper",
          "old_text": null,
          "new_text": "php_stream_open_wrapper(fname, \"rb\", IGNORE_URL|STREAM_MUST_SEEK|0, &actual)",
          "old_line_content": "",
          "new_line_content": "\tfp = php_stream_open_wrapper(fname, \"rb\", IGNORE_URL|STREAM_MUST_SEEK|0, &actual);",
          "content_same": false
        },
        {
          "line": 1416,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(actual)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tfname_len = ZSTR_LEN(actual);",
          "content_same": false
        },
        {
          "line": 3467,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(phar_alias_map)",
          "old_line_content": "",
          "new_line_content": "\t\tzend_hash_init(&(PHAR_G(phar_alias_map)), 5, zend_get_hash_value, NULL, 0);",
          "content_same": false
        },
        {
          "line": 1421,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(readonly)",
          "old_line_content": "\t\t\t\t(*pphar)->is_writeable = 1;",
          "new_line_content": "\t\t\tif ((*pphar)->is_data || !PHAR_G(readonly)) {",
          "content_same": false
        },
        {
          "line": 3469,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(manifest_cached)",
          "old_line_content": "\t\t\tphar_archive_data *pphar;",
          "new_line_content": "\t\tif (PHAR_G(manifest_cached)) {",
          "content_same": false
        },
        {
          "line": 3471,
          "old_api": null,
          "new_api": "zend_hash_num_elements",
          "old_text": null,
          "new_text": "zend_hash_num_elements(&cached_phars)",
          "old_line_content": "",
          "new_line_content": "\t\t\tphar_entry_fp *stuff = (phar_entry_fp *) ecalloc(zend_hash_num_elements(&cached_phars), sizeof(phar_entry_fp));",
          "content_same": false
        },
        {
          "line": 1425,
          "old_api": null,
          "new_api": "zend_string_release_ex",
          "old_text": null,
          "new_text": "zend_string_release_ex(actual, 0)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tzend_string_release_ex(actual, 0);",
          "content_same": false
        },
        {
          "line": 3475,
          "old_api": null,
          "new_api": "ZEND_HASH_FOREACH_END",
          "old_text": null,
          "new_text": "ZEND_HASH_FOREACH_END()",
          "old_line_content": "",
          "new_line_content": "\t\t\t} ZEND_HASH_FOREACH_END();",
          "content_same": false
        },
        {
          "line": 3477,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(cached_fp)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tPHAR_G(cached_fp) = stuff;",
          "content_same": false
        },
        {
          "line": 1431,
          "old_api": null,
          "new_api": "zend_string_release_ex",
          "old_text": null,
          "new_text": "zend_string_release_ex(actual, 0)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tzend_string_release_ex(actual, 0);",
          "content_same": false
        },
        {
          "line": 3483,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(cwd_init)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tPHAR_G(cwd_init) = 0;",
          "content_same": false
        },
        {
          "line": 1438,
          "old_api": null,
          "new_api": "zend_string_release_ex",
          "old_text": null,
          "new_text": "zend_string_release_ex(actual, 0)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tzend_string_release_ex(actual, 0);",
          "content_same": false
        },
        {
          "line": 1441,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(readonly)",
          "old_line_content": "\t\tif (options & REPORT_ERRORS) {",
          "new_line_content": "\tif (PHAR_G(readonly) && !is_data) {",
          "content_same": false
        },
        {
          "line": 3490,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(request_ends)",
          "old_line_content": "",
          "new_line_content": "\tPHAR_G(request_ends) = 1;",
          "content_same": false
        },
        {
          "line": 1444,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"creating archive \\\"%s\\\" disabled by the php.ini setting phar.readonly\", fname)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"creating archive \\\"%s\\\" disabled by the php.ini setting phar.readonly\", fname);",
          "content_same": false
        },
        {
          "line": 3492,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(request_init)",
          "old_line_content": "\t{",
          "new_line_content": "\tif (PHAR_G(request_init))",
          "content_same": false
        },
        {
          "line": 1452,
          "old_api": null,
          "new_api": "expand_filepath",
          "old_text": null,
          "new_text": "expand_filepath(fname, NULL)",
          "old_line_content": "\tif (mydata->fname == NULL) {",
          "new_line_content": "\tmydata->fname = expand_filepath(fname, NULL);",
          "content_same": false
        },
        {
          "line": 3501,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(phar_SERVER_mung_list)",
          "old_line_content": "",
          "new_line_content": "\t\tPHAR_G(phar_SERVER_mung_list) = 0;",
          "content_same": false
        },
        {
          "line": 1454,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(mydata)",
          "old_line_content": "\t\treturn FAILURE;",
          "new_line_content": "\t\tefree(mydata);",
          "content_same": false
        },
        {
          "line": 1457,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(mydata->fname)",
          "old_line_content": "#ifdef PHP_WIN32",
          "new_line_content": "\tfname_len = strlen(mydata->fname);",
          "content_same": false
        },
        {
          "line": 3506,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(cached_fp)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tphp_stream_close(PHAR_G(cached_fp)[i].fp);",
          "content_same": false
        },
        {
          "line": 1459,
          "old_api": null,
          "new_api": "phar_unixify_path_separators",
          "old_text": null,
          "new_text": "phar_unixify_path_separators(mydata->fname, fname_len)",
          "old_line_content": "#endif",
          "new_line_content": "\tphar_unixify_path_separators(mydata->fname, fname_len);",
          "content_same": false
        },
        {
          "line": 1461,
          "old_api": null,
          "new_api": "strrchr",
          "old_text": null,
          "new_text": "strrchr(mydata->fname, '/')",
          "old_line_content": "",
          "new_line_content": "\tp = strrchr(mydata->fname, '/');",
          "content_same": false
        },
        {
          "line": 3509,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(cached_fp)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tphp_stream_close(PHAR_G(cached_fp)[i].ufp);",
          "content_same": false
        },
        {
          "line": 3511,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(cached_fp)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tefree(PHAR_G(cached_fp)[i].manifest);",
          "content_same": false
        },
        {
          "line": 1464,
          "old_api": null,
          "new_api": "memchr",
          "old_text": null,
          "new_text": "memchr(p, '.', (mydata->fname + fname_len) - p)",
          "old_line_content": "\t\tif (mydata->ext == p) {",
          "new_line_content": "\t\tmydata->ext = memchr(p, '.', (mydata->fname + fname_len) - p);",
          "content_same": false
        },
        {
          "line": 1466,
          "old_api": null,
          "new_api": "memchr",
          "old_text": null,
          "new_text": "memchr(p + 1, '.', (mydata->fname + fname_len) - p - 1)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tmydata->ext = memchr(p + 1, '.', (mydata->fname + fname_len) - p - 1);",
          "content_same": false
        },
        {
          "line": 3514,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(cached_fp)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tPHAR_G(cached_fp) = 0;",
          "content_same": false
        },
        {
          "line": 3517,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(request_init)",
          "old_line_content": "",
          "new_line_content": "\t\tPHAR_G(request_init) = 0;",
          "content_same": false
        },
        {
          "line": 3520,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(cwd)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tefree(PHAR_G(cwd));",
          "content_same": false
        },
        {
          "line": 1477,
          "old_api": null,
          "new_api": "zend_hash_init",
          "old_text": null,
          "new_text": "zend_hash_init(&mydata->manifest, sizeof(phar_entry_info),\n\t\tzend_get_hash_value, destroy_phar_manifest_entry, 0)",
          "old_line_content": "\t\tzend_get_hash_value, destroy_phar_manifest_entry, 0);",
          "new_line_content": "\tzend_hash_init(&mydata->manifest, sizeof(phar_entry_info),",
          "content_same": false
        },
        {
          "line": 3525,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(cwd_init)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tPHAR_G(cwd_init) = 0;",
          "content_same": false
        },
        {
          "line": 1479,
          "old_api": null,
          "new_api": "zend_hash_init",
          "old_text": null,
          "new_text": "zend_hash_init(&mydata->mounted_dirs, sizeof(char *),\n\t\tzend_get_hash_value, NULL, 0)",
          "old_line_content": "\t\tzend_get_hash_value, NULL, 0);",
          "new_line_content": "\tzend_hash_init(&mydata->mounted_dirs, sizeof(char *),",
          "content_same": false
        },
        {
          "line": 3528,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(request_done)",
          "old_line_content": "\treturn SUCCESS;",
          "new_line_content": "\tPHAR_G(request_done) = 1;",
          "content_same": false
        },
        {
          "line": 1481,
          "old_api": null,
          "new_api": "zend_hash_init",
          "old_text": null,
          "new_text": "zend_hash_init(&mydata->virtual_dirs, sizeof(char *),\n\t\tzend_get_hash_value, NULL, (bool)mydata->is_persistent)",
          "old_line_content": "\t\tzend_get_hash_value, NULL, (bool)mydata->is_persistent);",
          "new_line_content": "\tzend_hash_init(&mydata->virtual_dirs, sizeof(char *),",
          "content_same": false
        },
        {
          "line": 1484,
          "old_api": null,
          "new_api": "snprintf",
          "old_text": null,
          "new_text": "snprintf(mydata->version, sizeof(mydata->version), \"%s\", PHP_PHAR_API_VERSION)",
          "old_line_content": "\tmydata->is_temporary_alias = alias ? 0 : 1;",
          "new_line_content": "\tsnprintf(mydata->version, sizeof(mydata->version), \"%s\", PHP_PHAR_API_VERSION);",
          "content_same": false
        },
        {
          "line": 1490,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(phar_fname_map)",
          "old_line_content": "",
          "new_line_content": "\tzend_hash_str_add_ptr(&(PHAR_G(phar_fname_map)), mydata->fname, fname_len, mydata);",
          "content_same": false
        },
        {
          "line": 3541,
          "old_api": null,
          "new_api": "php_info_print_table_row",
          "old_text": null,
          "new_text": "php_info_print_table_row(2, \"ZIP-based phar archives\", \"enabled\")",
          "old_line_content": "",
          "new_line_content": "\tphp_info_print_table_row(2, \"ZIP-based phar archives\", \"enabled\");",
          "content_same": false
        },
        {
          "line": 3544,
          "old_api": null,
          "new_api": "php_info_print_table_row",
          "old_text": null,
          "new_text": "php_info_print_table_row(2, \"gzip compression\", \"enabled\")",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\tphp_info_print_table_row(2, \"gzip compression\", \"enabled\");",
          "content_same": false
        },
        {
          "line": 3546,
          "old_api": null,
          "new_api": "php_info_print_table_row",
          "old_text": null,
          "new_text": "php_info_print_table_row(2, \"gzip compression\", \"disabled (install ext/zlib)\")",
          "old_line_content": "\t}",
          "new_line_content": "\t\tphp_info_print_table_row(2, \"gzip compression\", \"disabled (install ext/zlib)\");",
          "content_same": false
        },
        {
          "line": 1502,
          "old_api": null,
          "new_api": "phar_free_alias",
          "old_text": null,
          "new_text": "phar_free_alias(fd_ptr, alias, alias_len)",
          "old_line_content": "\t\t\t\tif (error) {",
          "new_line_content": "\t\t\tif (SUCCESS != phar_free_alias(fd_ptr, alias, alias_len)) {",
          "content_same": false
        },
        {
          "line": 3550,
          "old_api": null,
          "new_api": "php_info_print_table_row",
          "old_text": null,
          "new_text": "php_info_print_table_row(2, \"bzip2 compression\", \"enabled\")",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\tphp_info_print_table_row(2, \"bzip2 compression\", \"enabled\");",
          "content_same": false
        },
        {
          "line": 1504,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 4096, \"phar error: phar \\\"%s\\\" cannot set alias \\\"%s\\\", already in use by another phar archive\", mydata->fname, alias)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tspprintf(error, 4096, \"phar error: phar \\\"%s\\\" cannot set alias \\\"%s\\\", already in use by another phar archive\", mydata->fname, alias);",
          "content_same": false
        },
        {
          "line": 3552,
          "old_api": null,
          "new_api": "php_info_print_table_row",
          "old_text": null,
          "new_text": "php_info_print_table_row(2, \"bzip2 compression\", \"disabled (install ext/bz2)\")",
          "old_line_content": "\t}",
          "new_line_content": "\t\tphp_info_print_table_row(2, \"bzip2 compression\", \"disabled (install ext/bz2)\");",
          "content_same": false
        },
        {
          "line": 1507,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(phar_fname_map)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tzend_hash_str_del(&(PHAR_G(phar_fname_map)), mydata->fname, fname_len);",
          "content_same": false
        },
        {
          "line": 3555,
          "old_api": null,
          "new_api": "php_info_print_table_row",
          "old_text": null,
          "new_text": "php_info_print_table_row(2, \"Native OpenSSL support\", \"enabled\")",
          "old_line_content": "#else",
          "new_line_content": "\tphp_info_print_table_row(2, \"Native OpenSSL support\", \"enabled\");",
          "content_same": false
        },
        {
          "line": 3558,
          "old_api": null,
          "new_api": "php_info_print_table_row",
          "old_text": null,
          "new_text": "php_info_print_table_row(2, \"OpenSSL support\", \"enabled\")",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\tphp_info_print_table_row(2, \"OpenSSL support\", \"enabled\");",
          "content_same": false
        },
        {
          "line": 3560,
          "old_api": null,
          "new_api": "php_info_print_table_row",
          "old_text": null,
          "new_text": "php_info_print_table_row(2, \"OpenSSL support\", \"disabled (install ext/openssl)\")",
          "old_line_content": "\t}",
          "new_line_content": "\t\tphp_info_print_table_row(2, \"OpenSSL support\", \"disabled (install ext/openssl)\");",
          "content_same": false
        },
        {
          "line": 3563,
          "old_api": null,
          "new_api": "php_info_print_table_end",
          "old_text": null,
          "new_text": "php_info_print_table_end()",
          "old_line_content": "",
          "new_line_content": "\tphp_info_print_table_end();",
          "content_same": false
        },
        {
          "line": 1518,
          "old_api": null,
          "new_api": "estrndup",
          "old_text": null,
          "new_text": "estrndup(mydata->fname, fname_len)",
          "old_line_content": "\t\tmydata->alias_len = alias ? alias_len : fname_len;",
          "new_line_content": "\t\tmydata->alias = alias ? estrndup(alias, alias_len) : estrndup(mydata->fname, fname_len);",
          "content_same": false
        },
        {
          "line": 1523,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(phar_alias_map)",
          "old_line_content": "\t\t\tif (options & REPORT_ERRORS) {",
          "new_line_content": "\t\tif (NULL == zend_hash_str_add_ptr(&(PHAR_G(phar_alias_map)), alias, alias_len, mydata)) {",
          "content_same": false
        },
        {
          "line": 3571,
          "old_api": null,
          "new_api": "php_info_print_box_end",
          "old_text": null,
          "new_text": "php_info_print_box_end()",
          "old_line_content": "",
          "new_line_content": "\tphp_info_print_box_end();",
          "content_same": false
        },
        {
          "line": 3573,
          "old_api": null,
          "new_api": "DISPLAY_INI_ENTRIES",
          "old_text": null,
          "new_text": "DISPLAY_INI_ENTRIES()",
          "old_line_content": "}",
          "new_line_content": "\tDISPLAY_INI_ENTRIES();",
          "content_same": false
        },
        {
          "line": 1526,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"archive \\\"%s\\\" cannot be associated with alias \\\"%s\\\", already in use\", fname, alias)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tspprintf(error, 0, \"archive \\\"%s\\\" cannot be associated with alias \\\"%s\\\", already in use\", fname, alias);",
          "content_same": false
        },
        {
          "line": 1530,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(phar_fname_map)",
          "old_line_content": "",
          "new_line_content": "\t\t\tzend_hash_str_del(&(PHAR_G(phar_fname_map)), mydata->fname, fname_len);",
          "content_same": false
        },
        {
          "line": 3595,
          "old_api": null,
          "new_api": "PHP_MSHUTDOWN",
          "old_text": null,
          "new_text": "PHP_MSHUTDOWN(phar)",
          "old_line_content": "\tNULL,",
          "new_line_content": "\tPHP_MSHUTDOWN(phar),",
          "content_same": false
        },
        {
          "line": 3598,
          "old_api": null,
          "new_api": "PHP_MINFO",
          "old_text": null,
          "new_text": "PHP_MINFO(phar)",
          "old_line_content": "\tPHP_PHAR_VERSION,",
          "new_line_content": "\tPHP_MINFO(phar),",
          "content_same": false
        },
        {
          "line": 3602,
          "old_api": null,
          "new_api": "PHP_GSHUTDOWN",
          "old_text": null,
          "new_text": "PHP_GSHUTDOWN(phar)",
          "old_line_content": "\tNULL,                       /* post deactivate */",
          "new_line_content": "\tPHP_GSHUTDOWN(phar),        /* globals dtor */",
          "content_same": false
        },
        {
          "line": 1561,
          "old_api": null,
          "new_api": "strstr",
          "old_text": null,
          "new_text": "strstr(fname, \".phar\")",
          "old_line_content": "\t\tis_data = true;",
          "new_line_content": "\tif (!strstr(fname, \".phar\")) {",
          "content_same": false
        },
        {
          "line": 1565,
          "old_api": null,
          "new_api": "phar_open_parsed_phar",
          "old_text": null,
          "new_text": "phar_open_parsed_phar(fname, fname_len, alias, alias_len, is_data, options, pphar, error)",
          "old_line_content": "\t\treturn SUCCESS;",
          "new_line_content": "\tif (phar_open_parsed_phar(fname, fname_len, alias, alias_len, is_data, options, pphar, error) == SUCCESS) {",
          "content_same": false
        },
        {
          "line": 1570,
          "old_api": null,
          "new_api": "php_check_open_basedir",
          "old_text": null,
          "new_text": "php_check_open_basedir(fname)",
          "old_line_content": "\t\treturn FAILURE;",
          "new_line_content": "\tif (php_check_open_basedir(fname)) {",
          "content_same": false
        },
        {
          "line": 1574,
          "old_api": null,
          "new_api": "php_stream_open_wrapper",
          "old_text": null,
          "new_text": "php_stream_open_wrapper(fname, \"rb\", IGNORE_URL|STREAM_MUST_SEEK, &actual)",
          "old_line_content": "",
          "new_line_content": "\tfp = php_stream_open_wrapper(fname, \"rb\", IGNORE_URL|STREAM_MUST_SEEK, &actual);",
          "content_same": false
        },
        {
          "line": 1579,
          "old_api": null,
          "new_api": "spprintf",
          "old_text": null,
          "new_text": "spprintf(error, 0, \"unable to open phar for reading \\\"%s\\\"\", fname)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tspprintf(error, 0, \"unable to open phar for reading \\\"%s\\\"\", fname);",
          "content_same": false
        },
        {
          "line": 1583,
          "old_api": null,
          "new_api": "zend_string_release_ex",
          "old_text": null,
          "new_text": "zend_string_release_ex(actual, 0)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tzend_string_release_ex(actual, 0);",
          "content_same": false
        },
        {
          "line": 1590,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(actual)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tfname_len = ZSTR_LEN(actual);",
          "content_same": false
        },
        {
          "line": 1593,
          "old_api": null,
          "new_api": "phar_open_from_fp",
          "old_text": null,
          "new_text": "phar_open_from_fp(fp, fname, fname_len, alias, alias_len, options, pphar, error)",
          "old_line_content": "",
          "new_line_content": "\tzend_result ret = phar_open_from_fp(fp, fname, fname_len, alias, alias_len, options, pphar, error);",
          "content_same": false
        },
        {
          "line": 1596,
          "old_api": null,
          "new_api": "zend_string_release_ex",
          "old_text": null,
          "new_text": "zend_string_release_ex(actual, 0)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tzend_string_release_ex(actual, 0);",
          "content_same": false
        },
        {
          "line": 1615,
          "old_api": null,
          "new_api": "memchr",
          "old_text": null,
          "new_text": "memchr(c + 1, search[0], buf_len - search_len - so_far)",
          "old_line_content": "\t\t\treturn (char *) NULL;",
          "new_line_content": "\t\tif (!(c = memchr(c + 1, search[0], buf_len - search_len - so_far))) {",
          "content_same": false
        },
        {
          "line": 1625,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(c, search, search_len)",
          "old_line_content": "\t\t\treturn (char *) c;",
          "new_line_content": "\t\tif (!memcmp(c, search, search_len)) {",
          "content_same": false
        },
        {
          "line": 1658,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"cannot rewind phar \\\"%s\\\"\")",
          "old_line_content": "\t}",
          "new_line_content": "\t\tMAPPHAR_ALLOC_FAIL(\"cannot rewind phar \\\"%s\\\"\")",
          "content_same": false
        },
        {
          "line": 1662,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(buffer, 32, sizeof(token))",
          "old_line_content": "\thalt_offset = 0;",
          "new_line_content": "\tmemset(buffer, 32, sizeof(token));",
          "content_same": false
        },
        {
          "line": 1669,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"internal corruption of phar \\\"%s\\\" (truncated entry)\")",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tMAPPHAR_ALLOC_FAIL(\"internal corruption of phar \\\"%s\\\" (truncated entry)\")",
          "content_same": false
        },
        {
          "line": 1675,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(pos, gz_magic, 3)",
          "old_line_content": "\t\t\t\tchar err = 0;",
          "new_line_content": "\t\t\tif (!memcmp(pos, gz_magic, 3)) {",
          "content_same": false
        },
        {
          "line": 1683,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\" to temporary file, enable zlib extension in php.ini\")",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\" to temporary file, enable zlib extension in php.ini\")",
          "content_same": false
        },
        {
          "line": 1685,
          "old_api": null,
          "new_api": "array_init",
          "old_text": null,
          "new_text": "array_init(&filterparams)",
          "old_line_content": "/* this is defined in zlib's zconf.h */",
          "new_line_content": "\t\t\t\tarray_init(&filterparams);",
          "content_same": false
        },
        {
          "line": 1690,
          "old_api": null,
          "new_api": "add_assoc_long_ex",
          "old_text": null,
          "new_text": "add_assoc_long_ex(&filterparams, \"window\", sizeof(\"window\") - 1, MAX_WBITS + 32)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tadd_assoc_long_ex(&filterparams, \"window\", sizeof(\"window\") - 1, MAX_WBITS + 32);",
          "content_same": false
        },
        {
          "line": 1694,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"unable to create temporary file for decompression of gzipped phar archive \\\"%s\\\"\")",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to create temporary file for decompression of gzipped phar archive \\\"%s\\\"\")",
          "content_same": false
        },
        {
          "line": 1698,
          "old_api": null,
          "new_api": "php_stream_is_persistent",
          "old_text": null,
          "new_text": "php_stream_is_persistent(fp)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tfilter = php_stream_filter_create(\"zlib.inflate\", &filterparams, php_stream_is_persistent(fp));",
          "content_same": false
        },
        {
          "line": 1704,
          "old_api": null,
          "new_api": "Z_ARR",
          "old_text": null,
          "new_text": "Z_ARR(filterparams)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t\tzend_array_destroy(Z_ARR(filterparams));",
          "content_same": false
        },
        {
          "line": 1708,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\", ext/zlib is buggy in PHP versions older than 5.2.6\")",
          "old_line_content": "\t\t\t\t\t}",
          "new_line_content": "\t\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\", ext/zlib is buggy in PHP versions older than 5.2.6\")",
          "content_same": false
        },
        {
          "line": 1711,
          "old_api": null,
          "new_api": "Z_ARR",
          "old_text": null,
          "new_text": "Z_ARR(filterparams)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tzend_array_destroy(Z_ARR(filterparams));",
          "content_same": false
        },
        {
          "line": 1714,
          "old_api": null,
          "new_api": "php_stream_filter_append",
          "old_text": null,
          "new_text": "php_stream_filter_append(&temp->writefilters, filter)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tphp_stream_filter_append(&temp->writefilters, filter);",
          "content_same": false
        },
        {
          "line": 1716,
          "old_api": null,
          "new_api": "php_stream_copy_to_stream_ex",
          "old_text": null,
          "new_text": "php_stream_copy_to_stream_ex(fp, temp, PHP_STREAM_COPY_ALL, NULL)",
          "old_line_content": "\t\t\t\t\tif (err) {",
          "new_line_content": "\t\t\t\tif (SUCCESS != php_stream_copy_to_stream_ex(fp, temp, PHP_STREAM_COPY_ALL, NULL)) {",
          "content_same": false
        },
        {
          "line": 1719,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\", ext/zlib is buggy in PHP versions older than 5.2.6\")",
          "old_line_content": "\t\t\t\t\t}",
          "new_line_content": "\t\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\", ext/zlib is buggy in PHP versions older than 5.2.6\")",
          "content_same": false
        },
        {
          "line": 1722,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\" to temporary file\")",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\" to temporary file\")",
          "content_same": false
        },
        {
          "line": 1727,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(fp)",
          "old_line_content": "\t\t\t\tfp = temp;",
          "new_line_content": "\t\t\t\tphp_stream_close(fp);",
          "content_same": false
        },
        {
          "line": 1729,
          "old_api": null,
          "new_api": "php_stream_rewind",
          "old_text": null,
          "new_text": "php_stream_rewind(fp)",
          "old_line_content": "\t\t\t\tcompression = PHAR_FILE_COMPRESSED_GZ;",
          "new_line_content": "\t\t\t\tphp_stream_rewind(fp);",
          "content_same": false
        },
        {
          "line": 1735,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\"\")",
          "old_line_content": "\t\t\t\t\tbreak;",
          "new_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\"\");",
          "content_same": false
        },
        {
          "line": 1739,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(pos, bz_magic, 3)",
          "old_line_content": "\t\t\t\tphp_stream_filter *filter;",
          "new_line_content": "\t\t\t} else if (!memcmp(pos, bz_magic, 3)) {",
          "content_same": false
        },
        {
          "line": 1744,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\" to temporary file, enable bz2 extension in php.ini\")",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\" to temporary file, enable bz2 extension in php.ini\")",
          "content_same": false
        },
        {
          "line": 1749,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"unable to create temporary file for decompression of bzipped phar archive \\\"%s\\\"\")",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to create temporary file for decompression of bzipped phar archive \\\"%s\\\"\")",
          "content_same": false
        },
        {
          "line": 1753,
          "old_api": null,
          "new_api": "php_stream_is_persistent",
          "old_text": null,
          "new_text": "php_stream_is_persistent(fp)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tfilter = php_stream_filter_create(\"bzip2.decompress\", NULL, php_stream_is_persistent(fp));",
          "content_same": false
        },
        {
          "line": 1757,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\", filter creation failed\")",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\", filter creation failed\")",
          "content_same": false
        },
        {
          "line": 1760,
          "old_api": null,
          "new_api": "php_stream_filter_append",
          "old_text": null,
          "new_text": "php_stream_filter_append(&temp->writefilters, filter)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tphp_stream_filter_append(&temp->writefilters, filter);",
          "content_same": false
        },
        {
          "line": 1764,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\" to temporary file\")",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\" to temporary file\")",
          "content_same": false
        },
        {
          "line": 1769,
          "old_api": null,
          "new_api": "php_stream_close",
          "old_text": null,
          "new_text": "php_stream_close(fp)",
          "old_line_content": "\t\t\t\tfp = temp;",
          "new_line_content": "\t\t\t\tphp_stream_close(fp);",
          "content_same": false
        },
        {
          "line": 1771,
          "old_api": null,
          "new_api": "php_stream_rewind",
          "old_text": null,
          "new_text": "php_stream_rewind(fp)",
          "old_line_content": "\t\t\t\tcompression = PHAR_FILE_COMPRESSED_BZ2;",
          "new_line_content": "\t\t\t\tphp_stream_rewind(fp);",
          "content_same": false
        },
        {
          "line": 1777,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\"\")",
          "old_line_content": "\t\t\t\t\tbreak;",
          "new_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\"\");",
          "content_same": false
        },
        {
          "line": 1785,
          "old_api": null,
          "new_api": "phar_parse_zipfile",
          "old_text": null,
          "new_text": "phar_parse_zipfile(fp, fname, fname_len, alias, alias_len, pphar, error)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\treturn phar_parse_zipfile(fp, fname, fname_len, alias, alias_len, pphar, error);",
          "content_same": false
        },
        {
          "line": 1791,
          "old_api": null,
          "new_api": "phar_parse_tarfile",
          "old_text": null,
          "new_text": "phar_parse_tarfile(fp, fname, fname_len, alias, alias_len, pphar, compression, error)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\treturn phar_parse_tarfile(fp, fname, fname_len, alias, alias_len, pphar, compression, error);",
          "content_same": false
        },
        {
          "line": 1796,
          "old_api": null,
          "new_api": "phar_strnstr",
          "old_text": null,
          "new_text": "phar_strnstr(buffer, got + sizeof(token), token, sizeof(token)-1)",
          "old_line_content": "\t\t\thalt_offset += (pos - buffer); /* no -tokenlen+tokenlen here */",
          "new_line_content": "\t\tif (got > 0 && (pos = phar_strnstr(buffer, got + sizeof(token), token, sizeof(token)-1)) != NULL) {",
          "content_same": false
        },
        {
          "line": 1798,
          "old_api": null,
          "new_api": "phar_parse_pharfile",
          "old_text": null,
          "new_text": "phar_parse_pharfile(fp, fname, fname_len, alias, alias_len, halt_offset, pphar, compression, error)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\treturn phar_parse_pharfile(fp, fname, fname_len, alias, alias_len, halt_offset, pphar, compression, error);",
          "content_same": false
        },
        {
          "line": 1802,
          "old_api": null,
          "new_api": "memmove",
          "old_text": null,
          "new_text": "memmove(buffer, buffer + window_size, tokenlen)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tmemmove(buffer, buffer + window_size, tokenlen); /* move the memory buffer by the size of the window */",
          "content_same": false
        },
        {
          "line": 1805,
          "old_api": null,
          "new_api": "MAPPHAR_ALLOC_FAIL",
          "old_text": null,
          "new_text": "MAPPHAR_ALLOC_FAIL(\"internal corruption of phar \\\"%s\\\" (__HALT_COMPILER(); not found)\")",
          "old_line_content": "}",
          "new_line_content": "\tMAPPHAR_ALLOC_FAIL(\"internal corruption of phar \\\"%s\\\" (__HALT_COMPILER(); not found)\")",
          "content_same": false
        },
        {
          "line": 1822,
          "old_api": null,
          "new_api": "estrndup",
          "old_text": null,
          "new_text": "estrndup(fname, (ext - fname) + ext_len)",
          "old_line_content": "",
          "new_line_content": "\tchar *filename = estrndup(fname, (ext - fname) + ext_len);",
          "content_same": false
        },
        {
          "line": 1824,
          "old_api": null,
          "new_api": "expand_filepath",
          "old_text": null,
          "new_text": "expand_filepath(filename, NULL)",
          "old_line_content": "#ifdef PHP_WIN32",
          "new_line_content": "\tif ((realpath = expand_filepath(filename, NULL))) {",
          "content_same": false
        },
        {
          "line": 1826,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(realpath)",
          "old_line_content": "#endif",
          "new_line_content": "\t\tphar_unixify_path_separators(realpath, strlen(realpath));",
          "content_same": false
        },
        {
          "line": 1830,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(filename)",
          "old_line_content": "\t\t\treturn SUCCESS;",
          "new_line_content": "\t\t\tefree(filename);",
          "content_same": false
        },
        {
          "line": 1836,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(filename)",
          "old_line_content": "\t\t\treturn SUCCESS;",
          "new_line_content": "\t\t\tefree(filename);",
          "content_same": false
        },
        {
          "line": 1839,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(realpath)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tefree(realpath);",
          "content_same": false
        },
        {
          "line": 1842,
          "old_api": null,
          "new_api": "php_stream_stat_path",
          "old_text": null,
          "new_text": "php_stream_stat_path((char *) filename, &ssb)",
          "old_line_content": "",
          "new_line_content": "\tif (SUCCESS == php_stream_stat_path((char *) filename, &ssb)) {",
          "content_same": false
        },
        {
          "line": 1844,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(filename)",
          "old_line_content": "",
          "new_line_content": "\t\tefree(filename);",
          "content_same": false
        },
        {
          "line": 1859,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(filename)",
          "old_line_content": "\t\t\treturn FAILURE;",
          "new_line_content": "\t\t\tefree(filename);",
          "content_same": false
        },
        {
          "line": 1863,
          "old_api": null,
          "new_api": "strrchr",
          "old_text": null,
          "new_text": "strrchr(filename, '/')",
          "old_line_content": "",
          "new_line_content": "\t\tslash = (char *) strrchr(filename, '/');",
          "content_same": false
        },
        {
          "line": 1869,
          "old_api": null,
          "new_api": "php_stream_stat_path",
          "old_text": null,
          "new_text": "php_stream_stat_path((char *) filename, &ssb)",
          "old_line_content": "\t\t\tif (!slash) {",
          "new_line_content": "\t\tif (SUCCESS != php_stream_stat_path((char *) filename, &ssb)) {",
          "content_same": false
        },
        {
          "line": 1872,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(filename)",
          "old_line_content": "\t\t\t\t\treturn FAILURE;",
          "new_line_content": "\t\t\t\t\tefree(filename);",
          "content_same": false
        },
        {
          "line": 1876,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(realpath)",
          "old_line_content": "#endif",
          "new_line_content": "\t\t\t\tphar_unixify_path_separators(realpath, strlen(realpath));",
          "content_same": false
        },
        {
          "line": 1878,
          "old_api": null,
          "new_api": "strstr",
          "old_text": null,
          "new_text": "strstr(realpath, filename)",
          "old_line_content": "\t\t\t\tif (slash) {",
          "new_line_content": "\t\t\t\tslash = strstr(realpath, filename);",
          "content_same": false
        },
        {
          "line": 1883,
          "old_api": null,
          "new_api": "strrchr",
          "old_text": null,
          "new_text": "strrchr(realpath, '/')",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tslash = strrchr(realpath, '/');",
          "content_same": false
        },
        {
          "line": 1889,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(filename)",
          "old_line_content": "\t\t\t\t\treturn FAILURE;",
          "new_line_content": "\t\t\t\t\tefree(filename);",
          "content_same": false
        },
        {
          "line": 1895,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(filename)",
          "old_line_content": "\t\t\t\t\treturn FAILURE;",
          "new_line_content": "\t\t\t\t\tefree(filename);",
          "content_same": false
        },
        {
          "line": 1899,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(realpath)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tefree(realpath);",
          "content_same": false
        },
        {
          "line": 1902,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(filename)",
          "old_line_content": "\t\t\t\t\treturn SUCCESS;",
          "new_line_content": "\t\t\t\t\tefree(filename);",
          "content_same": false
        },
        {
          "line": 1907,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(filename)",
          "old_line_content": "\t\t\treturn FAILURE;",
          "new_line_content": "\t\t\tefree(filename);",
          "content_same": false
        },
        {
          "line": 1911,
          "old_api": null,
          "new_api": "efree",
          "old_text": null,
          "new_text": "efree(filename)",
          "old_line_content": "",
          "new_line_content": "\t\tefree(filename);",
          "content_same": false
        },
        {
          "line": 1933,
          "old_api": null,
          "new_api": "strstr",
          "old_text": null,
          "new_text": "strstr(ext_str, \".phar\")",
          "old_line_content": "",
          "new_line_content": "\t\tpos = strstr(ext_str, \".phar\");",
          "content_same": false
        },
        {
          "line": 1942,
          "old_api": null,
          "new_api": "phar_analyze_path",
          "old_text": null,
          "new_text": "phar_analyze_path(fname, ext_str, ext_len, for_create)",
          "old_line_content": "\t}",
          "new_line_content": "\t\treturn phar_analyze_path(fname, ext_str, ext_len, for_create);",
          "content_same": false
        },
        {
          "line": 1947,
          "old_api": null,
          "new_api": "strstr",
          "old_text": null,
          "new_text": "strstr(ext_str, \".phar\")",
          "old_line_content": "\t\tif (!(pos && (*(pos - 1) != '/')",
          "new_line_content": "\t\tpos = strstr(ext_str, \".phar\");",
          "content_same": false
        },
        {
          "line": 1950,
          "old_api": null,
          "new_api": "phar_analyze_path",
          "old_text": null,
          "new_text": "phar_analyze_path(fname, ext_str, ext_len, for_create)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\treturn phar_analyze_path(fname, ext_str, ext_len, for_create);",
          "content_same": false
        },
        {
          "line": 1954,
          "old_api": null,
          "new_api": "phar_analyze_path",
          "old_text": null,
          "new_text": "phar_analyze_path(fname, ext_str, ext_len, for_create)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\treturn phar_analyze_path(fname, ext_str, ext_len, for_create);",
          "content_same": false
        },
        {
          "line": 1986,
          "old_api": null,
          "new_api": "phar_request_initialize",
          "old_text": null,
          "new_text": "phar_request_initialize()",
          "old_line_content": "\t/* first check for alias in first segment */",
          "new_line_content": "\tphar_request_initialize();",
          "content_same": false
        },
        {
          "line": 1988,
          "old_api": null,
          "new_api": "memchr",
          "old_text": null,
          "new_text": "memchr(filename, '/', filename_len)",
          "old_line_content": "",
          "new_line_content": "\tpos = memchr(filename, '/', filename_len);",
          "content_same": false
        },
        {
          "line": 1997,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(phar_alias_map)",
          "old_line_content": "\t\t\t*ext_str = pos;",
          "new_line_content": "\t\tif (zend_hash_str_exists(&(PHAR_G(phar_alias_map)), (char *) filename, pos - filename)) {",
          "content_same": false
        },
        {
          "line": 2003,
          "old_api": null,
          "new_api": "zend_hash_str_exists",
          "old_text": null,
          "new_text": "zend_hash_str_exists(&cached_alias, (char *) filename, pos - filename)",
          "old_line_content": "\t\t\t*ext_str = pos;",
          "new_line_content": "\t\tif (PHAR_G(manifest_cached) && zend_hash_str_exists(&cached_alias, (char *) filename, pos - filename)) {",
          "content_same": false
        },
        {
          "line": 2010,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(manifest_cached)",
          "old_line_content": "\t\tphar_archive_data *pphar;",
          "new_line_content": "\tif (zend_hash_num_elements(&(PHAR_G(phar_fname_map))) || PHAR_G(manifest_cached)) {",
          "content_same": false
        },
        {
          "line": 2014,
          "old_api": null,
          "new_api": "PHAR_G",
          "old_text": null,
          "new_text": "PHAR_G(phar_fname_map)",
          "old_line_content": "\t\t\t\t*ext_str = filename + (filename_len - pphar->ext_len);",
          "new_line_content": "\t\t\tif (NULL != (pphar = zend_hash_str_find_ptr(&(PHAR_G(phar_fname_map)), (char *) filename, filename_len))) {",
          "content_same": false
        },
        {
          "line": 2034,
          "old_api": null,
          "new_api": "zend_hash_str_find_ptr",
          "old_text": null,
          "new_text": "zend_hash_str_find_ptr(&cached_phars, (char *) filename, filename_len)",
          "old_line_content": "\t\t\t\t*ext_str = filename + (filename_len - pphar->ext_len);",
          "new_line_content": "\t\t\tif (PHAR_G(manifest_cached) && NULL != (pphar = zend_hash_str_find_ptr(&cached_phars, (char *) filename, filename_len))) {",
          "content_same": false
        },
        {
          "line": 2042,
          "old_api": null,
          "new_api": "ZSTR_LEN",
          "old_text": null,
          "new_text": "ZSTR_LEN(str_key)",
          "old_line_content": "\t\t\t\t\tcontinue;",
          "new_line_content": "\t\t\t\tif (ZSTR_LEN(str_key) > filename_len) {",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 2050,
          "old_api": "ZEND_HASH_FOREACH_END",
          "new_api": null,
          "old_text": "ZEND_HASH_FOREACH_END()",
          "new_text": null,
          "old_line_content": "\t\t\t} ZEND_HASH_FOREACH_END();",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 2052,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(manifest_cached)",
          "new_text": null,
          "old_line_content": "\t\t\tif (PHAR_G(manifest_cached)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2058,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(str_key)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tif (!memcmp(filename, ZSTR_VAL(str_key), ZSTR_LEN(str_key)) && (filename_len == ZSTR_LEN(str_key)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2063,
          "old_api": "ZEND_HASH_FOREACH_END",
          "new_api": null,
          "old_text": "ZEND_HASH_FOREACH_END()",
          "new_text": null,
          "old_line_content": "\t\t\t\t} ZEND_HASH_FOREACH_END();",
          "new_line_content": "\t\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 2069,
          "old_api": "memchr",
          "new_api": null,
          "old_text": "memchr(filename + 1, '.', filename_len)",
          "new_text": null,
          "old_line_content": "\tpos = memchr(filename + 1, '.', filename_len);",
          "new_line_content": "\t// TODO Use some sort of loop here instead of a goto",
          "content_same": false
        },
        {
          "line": 2076,
          "old_api": "memchr",
          "new_api": null,
          "old_text": "memchr(pos + 1, '.', filename_len - (pos - filename) - 1)",
          "new_text": null,
          "old_line_content": "\t\tpos = memchr(pos + 1, '.', filename_len - (pos - filename) - 1);",
          "new_line_content": "\twhile (pos != filename && (*(pos - 1) == '/' || *(pos - 1) == '\\0')) {",
          "content_same": false
        },
        {
          "line": 2082,
          "old_api": "memchr",
          "new_api": null,
          "old_text": "memchr(pos, '/', filename_len - (pos - filename))",
          "new_text": null,
          "old_line_content": "\tslash = memchr(pos, '/', filename_len - (pos - filename));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2087,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(pos)",
          "new_text": null,
          "old_line_content": "\t\t*ext_len = strlen(pos);",
          "new_line_content": "\t\t*ext_str = pos;",
          "content_same": false
        },
        {
          "line": 2090,
          "old_api": "phar_check_str",
          "new_api": null,
          "old_text": "phar_check_str(filename, *ext_str, *ext_len, executable, for_create)",
          "new_text": null,
          "old_line_content": "\t\treturn phar_check_str(filename, *ext_str, *ext_len, executable, for_create);",
          "new_line_content": "\t\t/* file extension must contain \"phar\" */",
          "content_same": false
        },
        {
          "line": 2097,
          "old_api": "phar_check_str",
          "new_api": null,
          "old_text": "phar_check_str(filename, *ext_str, *ext_len, executable, for_create)",
          "new_text": null,
          "old_line_content": "\tif (phar_check_str(filename, *ext_str, *ext_len, executable, for_create) == SUCCESS) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2102,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(pos + 1, '.')",
          "new_text": null,
          "old_line_content": "\tpos = strchr(pos + 1, '.');",
          "new_line_content": "\t/* look for more extensions */",
          "content_same": false
        },
        {
          "line": 2143,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(cwd_len)",
          "new_text": null,
          "old_line_content": "\tif (PHAR_G(cwd_len) && use_cwd && path_length > 2 && path[0] == '.' && path[1] == '/') {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2148,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(path)",
          "new_text": null,
          "old_line_content": "\t\tnewpath = emalloc(strlen(path) + 2);",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 2162,
          "old_api": "memchr",
          "new_api": null,
          "old_text": "memchr(ptr, '/', path_length - (ptr - path))",
          "new_text": null,
          "old_line_content": "\t\tptr = memchr(ptr, '/', path_length - (ptr - path));",
          "new_line_content": "\tdo {",
          "content_same": false
        },
        {
          "line": 2169,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(path)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tefree(path);",
          "new_line_content": "\t\t\t\tif (*tok == '.') {",
          "content_same": false
        },
        {
          "line": 2171,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(newpath)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tefree(newpath);",
          "new_line_content": "\t\t\t\t\t*new_len = 1;",
          "content_same": false
        },
        {
          "line": 2177,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(path)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tefree(path);",
          "new_line_content": "\t\t\t\tif (tok[0] == '.' && tok[1] == '.') {",
          "content_same": false
        },
        {
          "line": 2179,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(newpath)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tefree(newpath);",
          "new_line_content": "\t\t\t\t\t*new_len = 1;",
          "content_same": false
        },
        {
          "line": 2183,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(newpath)",
          "new_text": null,
          "old_line_content": "\t\tefree(newpath);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 2190,
          "old_api": "IS_DIRECTORY_UP",
          "new_api": null,
          "old_text": "IS_DIRECTORY_UP(tok, ptr_length)",
          "new_text": null,
          "old_line_content": "\t\tif (IS_DIRECTORY_UP(tok, ptr_length)) {",
          "new_line_content": "last_time:",
          "content_same": false
        },
        {
          "line": 2200,
          "old_api": "IS_DIRECTORY_CURRENT",
          "new_api": null,
          "old_text": "IS_DIRECTORY_CURRENT(tok, ptr_length)",
          "new_text": null,
          "old_line_content": "\t\t} else if (!IS_DIRECTORY_CURRENT(tok, ptr_length)) {",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 2203,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(newpath + newpath_len, tok, ptr_length+1)",
          "new_text": null,
          "old_line_content": "\t\t\t\tmemcpy(newpath + newpath_len, tok, ptr_length+1);",
          "new_line_content": "\t\t\t\tnewpath[newpath_len++] = '/';",
          "content_same": false
        },
        {
          "line": 2205,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(newpath + newpath_len, tok, ptr_length+1)",
          "new_text": null,
          "old_line_content": "\t\t\t\tmemcpy(newpath + newpath_len, tok, ptr_length+1);",
          "new_line_content": "\t\t\t} else {",
          "content_same": false
        },
        {
          "line": 2218,
          "old_api": "memchr",
          "new_api": null,
          "old_text": "memchr(ptr, '/', path_length - (ptr - path))",
          "new_text": null,
          "old_line_content": "\t\t\tptr = memchr(ptr, '/', path_length - (ptr - path));",
          "new_line_content": "\t\tdo {",
          "content_same": false
        },
        {
          "line": 2228,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(path)",
          "new_text": null,
          "old_line_content": "\tefree(path);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2231,
          "old_api": "erealloc",
          "new_api": null,
          "old_text": "erealloc(newpath, newpath_len + 1)",
          "new_text": null,
          "old_line_content": "\treturn erealloc(newpath, newpath_len + 1);",
          "new_line_content": "\tnewpath[newpath_len] = '\\0';",
          "content_same": false
        },
        {
          "line": 2255,
          "old_api": "CHECK_NULL_PATH",
          "new_api": null,
          "old_text": "CHECK_NULL_PATH(filename, filename_len)",
          "new_text": null,
          "old_line_content": "\tif (CHECK_NULL_PATH(filename, filename_len)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2259,
          "old_api": "strncasecmp",
          "new_api": null,
          "old_text": "strncasecmp(filename, \"phar://\", 7)",
          "new_text": null,
          "old_line_content": "\tif (!strncasecmp(filename, \"phar://\", 7)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2267,
          "old_api": "memchr",
          "new_api": null,
          "old_text": "memchr(filename, '\\\\', filename_len)",
          "new_text": null,
          "old_line_content": "\tif (memchr(filename, '\\\\', filename_len)) {",
          "new_line_content": "\tsave = (char *)filename;",
          "content_same": false
        },
        {
          "line": 2272,
          "old_api": "phar_detect_phar_fname_ext",
          "new_api": null,
          "old_text": "phar_detect_phar_fname_ext(filename, filename_len, &ext_str, &ext_len, executable, for_create, 0)",
          "new_text": null,
          "old_line_content": "\tif (phar_detect_phar_fname_ext(filename, filename_len, &ext_str, &ext_len, executable, for_create, 0) == FAILURE) {",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 2285,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree((char *)filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\tefree((char *)filename);",
          "new_line_content": "\t\t\tif (filename != save) {",
          "content_same": false
        },
        {
          "line": 2296,
          "old_api": "estrndup",
          "new_api": null,
          "old_text": "estrndup(filename, *arch_len)",
          "new_text": null,
          "old_line_content": "\t*arch = estrndup(filename, *arch_len);",
          "new_line_content": "\t*arch_len = ext_str - filename + ext_len;",
          "content_same": false
        },
        {
          "line": 2300,
          "old_api": "estrndup",
          "new_api": null,
          "old_text": "estrndup(ext_str+ext_len, *entry_len)",
          "new_text": null,
          "old_line_content": "\t\t*entry = estrndup(ext_str+ext_len, *entry_len);",
          "new_line_content": "\t\t*entry_len = filename_len - *arch_len;",
          "content_same": false
        },
        {
          "line": 2302,
          "old_api": "phar_unixify_path_separators",
          "new_api": null,
          "old_text": "phar_unixify_path_separators(*entry, *entry_len)",
          "new_text": null,
          "old_line_content": "\t\tphar_unixify_path_separators(*entry, *entry_len);",
          "new_line_content": "#ifdef PHP_WIN32",
          "content_same": false
        },
        {
          "line": 2304,
          "old_api": "phar_fix_filepath",
          "new_api": null,
          "old_text": "phar_fix_filepath(*entry, entry_len, 0)",
          "new_text": null,
          "old_line_content": "\t\t*entry = phar_fix_filepath(*entry, entry_len, 0);",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 2307,
          "old_api": "estrndup",
          "new_api": null,
          "old_text": "estrndup(\"/\", 1)",
          "new_text": null,
          "old_line_content": "\t\t*entry = estrndup(\"/\", 1);",
          "new_line_content": "\t\t*entry_len = 1;",
          "content_same": false
        },
        {
          "line": 2312,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree((char *)filename)",
          "new_text": null,
          "old_line_content": "\t\tefree((char *)filename);",
          "new_line_content": "\tif (filename != save) {",
          "content_same": false
        },
        {
          "line": 2330,
          "old_api": "zend_get_executed_filename_ex",
          "new_api": null,
          "old_text": "zend_get_executed_filename_ex()",
          "new_text": null,
          "old_line_content": "\tzend_string *fname = zend_get_executed_filename_ex();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2334,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"cannot initialize a phar outside of PHP execution\")",
          "new_text": null,
          "old_line_content": "\t\t\tspprintf(error, 0, \"cannot initialize a phar outside of PHP execution\");",
          "new_line_content": "\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2339,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(fname)",
          "new_text": null,
          "old_line_content": "\tif (phar_open_parsed_phar(ZSTR_VAL(fname), ZSTR_LEN(fname), alias, alias_len, 0, REPORT_ERRORS, NULL, 0) == SUCCESS) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2343,
          "old_api": "zend_get_constant_str",
          "new_api": null,
          "old_text": "zend_get_constant_str(\"__COMPILER_HALT_OFFSET__\", sizeof(\"__COMPILER_HALT_OFFSET__\")-1)",
          "new_text": null,
          "old_line_content": "\tif (0 == zend_get_constant_str(\"__COMPILER_HALT_OFFSET__\", sizeof(\"__COMPILER_HALT_OFFSET__\")-1)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2345,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"__HALT_COMPILER(); must be declared in a phar\")",
          "new_text": null,
          "old_line_content": "\t\t\tspprintf(error, 0, \"__HALT_COMPILER(); must be declared in a phar\");",
          "new_line_content": "\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2350,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(fname)",
          "new_text": null,
          "old_line_content": "\tif (php_check_open_basedir(ZSTR_VAL(fname))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2356,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(fname)",
          "new_text": null,
          "old_line_content": "\tfp = php_stream_open_wrapper(ZSTR_VAL(fname), \"rb\", IGNORE_URL|STREAM_MUST_SEEK|REPORT_ERRORS, &actual);",
          "new_line_content": "\tphp_stream *fp;",
          "content_same": false
        },
        {
          "line": 2360,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(fname)",
          "new_text": null,
          "old_line_content": "\t\t\tspprintf(error, 0, \"unable to open phar for reading \\\"%s\\\"\", ZSTR_VAL(fname));",
          "new_line_content": "\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2363,
          "old_api": "zend_string_release_ex",
          "new_api": null,
          "old_text": "zend_string_release_ex(actual, 0)",
          "new_text": null,
          "old_line_content": "\t\t\tzend_string_release_ex(actual, 0);",
          "new_line_content": "\t\tif (actual) {",
          "content_same": false
        },
        {
          "line": 2372,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(fname)",
          "new_text": null,
          "old_line_content": "\tzend_result ret = phar_open_from_fp(fp, ZSTR_VAL(fname), ZSTR_LEN(fname), alias, alias_len, REPORT_ERRORS, NULL, error);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2375,
          "old_api": "zend_string_release_ex",
          "new_api": null,
          "old_text": "zend_string_release_ex(actual, 0)",
          "new_text": null,
          "old_line_content": "\t\tzend_string_release_ex(actual, 0);",
          "new_line_content": "\tif (actual) {",
          "content_same": false
        },
        {
          "line": 2399,
          "old_api": "phar_open_archive_fp",
          "new_api": null,
          "old_text": "phar_open_archive_fp(idata->phar)",
          "new_text": null,
          "old_line_content": "\t\tif (SUCCESS != phar_open_archive_fp(idata->phar)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2403,
          "old_api": "phar_get_entrypfp",
          "new_api": null,
          "old_text": "phar_get_entrypfp(idata->internal_file)",
          "new_text": null,
          "old_line_content": "\t\tphp_stream_seek(phar_get_entrypfp(idata->internal_file), entry->header_offset, SEEK_SET);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 2405,
          "old_api": "phar_get_entrypfp",
          "new_api": null,
          "old_text": "phar_get_entrypfp(idata->internal_file)",
          "new_text": null,
          "old_line_content": "\t\tif (sizeof(local) != php_stream_read(phar_get_entrypfp(idata->internal_file), (char *) &local, sizeof(local))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2407,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\tspprintf(error, 0, \"phar error: internal corruption of zip-based phar \\\"%s\\\" (cannot read local file header for file \\\"%s\\\")\", idata->phar->fname, ZSTR_VAL(entry->filename));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2412,
          "old_api": "PHAR_ZIP_16",
          "new_api": null,
          "old_text": "PHAR_ZIP_16(local.flags)",
          "new_text": null,
          "old_line_content": "\t\tif (((PHAR_ZIP_16(local.flags)) & 0x8) == 0x8) {",
          "new_line_content": "\t\t/* check for data descriptor */",
          "content_same": false
        },
        {
          "line": 2415,
          "old_api": "PHAR_ZIP_16",
          "new_api": null,
          "old_text": "PHAR_ZIP_16(local.filename_len)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tPHAR_ZIP_16(local.filename_len) +",
          "new_line_content": "\t\t\t\t\tentry->header_offset + sizeof(local) +",
          "content_same": false
        },
        {
          "line": 2418,
          "old_api": "phar_get_entrypfp",
          "new_api": null,
          "old_text": "phar_get_entrypfp(idata->internal_file)",
          "new_text": null,
          "old_line_content": "\t\t\tif (sizeof(desc) != php_stream_read(phar_get_entrypfp(idata->internal_file),",
          "new_line_content": "\t\t\t\t\tentry->compressed_filesize, SEEK_SET);",
          "content_same": false
        },
        {
          "line": 2420,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"phar error: internal corruption of zip-based phar \\\"%s\\\" (cannot read local data descriptor for file \\\"%s\\\")\", idata->phar->fname, ZSTR_VAL(entry->filename));",
          "new_line_content": "\t\t\t\t\t\t\t    (char *) &desc, sizeof(desc))) {",
          "content_same": false
        },
        {
          "line": 2424,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(&(local.crc32), &(desc.crc32), 12)",
          "new_text": null,
          "old_line_content": "\t\t\t\tmemcpy(&(local.crc32), &(desc.crc32), 12);",
          "new_line_content": "\t\t\tif (desc.signature[0] == 'P' && desc.signature[1] == 'K') {",
          "content_same": false
        },
        {
          "line": 2427,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(&(local.crc32), &desc, 12)",
          "new_text": null,
          "old_line_content": "\t\t\t\tmemcpy(&(local.crc32), &desc, 12);",
          "new_line_content": "\t\t\t\t/* old data descriptors have no signature */",
          "content_same": false
        },
        {
          "line": 2431,
          "old_api": "PHAR_ZIP_32",
          "new_api": null,
          "old_text": "PHAR_ZIP_32(local.compsize)",
          "new_text": null,
          "old_line_content": "\t\tif (ZSTR_LEN(entry->filename) != PHAR_ZIP_16(local.filename_len) || entry->crc32 != PHAR_ZIP_32(local.crc32) || entry->uncompressed_filesize != PHAR_ZIP_32(local.uncompsize) || entry->compressed_filesize != PHAR_ZIP_32(local.compsize)) {",
          "new_line_content": "\t\t/* verify local header */",
          "content_same": false
        },
        {
          "line": 2438,
          "old_api": "PHAR_ZIP_16",
          "new_api": null,
          "old_text": "PHAR_ZIP_16(local.extra_len)",
          "new_text": null,
          "old_line_content": "\t\t\tsizeof(local) + entry->header_offset + PHAR_ZIP_16(local.filename_len) + PHAR_ZIP_16(local.extra_len);",
          "new_line_content": "\t\tentry->offset = entry->offset_abs =",
          "content_same": false
        },
        {
          "line": 2449,
          "old_api": "php_stream_seek",
          "new_api": null,
          "old_text": "php_stream_seek(fp, idata->zero, SEEK_SET)",
          "new_text": null,
          "old_line_content": "\tphp_stream_seek(fp, idata->zero, SEEK_SET);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2451,
          "old_api": "php_crc32_bulk_init",
          "new_api": null,
          "old_text": "php_crc32_bulk_init()",
          "new_text": null,
          "old_line_content": "\tuint32_t crc = php_crc32_bulk_init();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2454,
          "old_api": "php_stream_seek",
          "new_api": null,
          "old_text": "php_stream_seek(fp, idata->zero, SEEK_SET)",
          "new_text": null,
          "old_line_content": "\tphp_stream_seek(fp, idata->zero, SEEK_SET);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2456,
          "old_api": "php_crc32_bulk_end",
          "new_api": null,
          "old_text": "php_crc32_bulk_end(crc)",
          "new_text": null,
          "old_line_content": "\tif (SUCCESS == ret && php_crc32_bulk_end(crc) == crc32) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2460,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\tspprintf(error, 0, \"phar error: internal corruption of phar \\\"%s\\\" (crc32 mismatch on file \\\"%s\\\")\", idata->phar->fname, ZSTR_VAL(entry->filename));",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 2474,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(buffer, &var, sizeof(var))",
          "new_text": null,
          "old_line_content": "\t memcpy(buffer, &var, sizeof(var));",
          "new_line_content": "#else",
          "content_same": false
        },
        {
          "line": 2480,
          "old_api": "Z_PTR_P",
          "new_api": null,
          "old_text": "Z_PTR_P(zv)",
          "new_text": null,
          "old_line_content": "\tphar_entry_info *entry = (phar_entry_info *)Z_PTR_P(zv);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2508,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(index_php)",
          "new_text": null,
          "old_line_content": "\tindex_len = strlen(index_php);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2514,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"Illegal filename passed in for stub creation, was %zd characters long, and only 400 or less is allowed\", index_len)",
          "new_text": null,
          "old_line_content": "\t\t\tspprintf(error, 0, \"Illegal filename passed in for stub creation, was %zd characters long, and only 400 or less is allowed\", index_len);",
          "new_line_content": "\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2522,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"Illegal web filename passed in for stub creation, was %zd characters long, and only 400 or less is allowed\", web_len)",
          "new_text": null,
          "old_line_content": "\t\t\tspprintf(error, 0, \"Illegal web filename passed in for stub creation, was %zd characters long, and only 400 or less is allowed\", web_len);",
          "new_line_content": "\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2527,
          "old_api": "phar_get_stub",
          "new_api": null,
          "old_text": "phar_get_stub(index_php, web_index, index_len+1, web_len+1)",
          "new_text": null,
          "old_line_content": "\treturn phar_get_stub(index_php, web_index, index_len+1, web_len+1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2532,
          "old_api": "phar_flush_ex",
          "new_api": null,
          "old_text": "phar_flush_ex(phar, NULL, false, error)",
          "new_text": null,
          "old_line_content": "\tphar_flush_ex(phar, NULL, false, error);",
          "new_line_content": "void phar_flush(phar_archive_data *phar, char **error) {",
          "content_same": false
        },
        {
          "line": 2566,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"internal error: attempt to flush cached zip-based phar \\\"%s\\\"\", phar->fname)",
          "new_text": null,
          "old_line_content": "\t\t\tspprintf(error, 0, \"internal error: attempt to flush cached zip-based phar \\\"%s\\\"\", phar->fname);",
          "new_line_content": "\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2575,
          "old_api": "zend_hash_num_elements",
          "new_api": null,
          "old_text": "zend_hash_num_elements(&phar->manifest)",
          "new_text": null,
          "old_line_content": "\tif (!zend_hash_num_elements(&phar->manifest) && !user_stub) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2579,
          "old_api": "zend_hash_clean",
          "new_api": null,
          "old_text": "zend_hash_clean(&phar->virtual_dirs)",
          "new_text": null,
          "old_line_content": "\tzend_hash_clean(&phar->virtual_dirs);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2582,
          "old_api": "phar_zip_flush",
          "new_api": null,
          "old_text": "phar_zip_flush(phar, user_stub, is_default_stub, error)",
          "new_text": null,
          "old_line_content": "\t\tphar_zip_flush(phar, user_stub, is_default_stub, error);",
          "new_line_content": "\tif (phar->is_zip) {",
          "content_same": false
        },
        {
          "line": 2587,
          "old_api": "phar_tar_flush",
          "new_api": null,
          "old_text": "phar_tar_flush(phar, user_stub, is_default_stub, error)",
          "new_text": null,
          "old_line_content": "\t\tphar_tar_flush(phar, user_stub, is_default_stub, error);",
          "new_line_content": "\tif (phar->is_tar) {",
          "content_same": false
        },
        {
          "line": 2591,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(readonly)",
          "new_text": null,
          "old_line_content": "\tif (PHAR_G(readonly)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2598,
          "old_api": "php_stream_rewind",
          "new_api": null,
          "old_text": "php_stream_rewind(oldfile)",
          "new_text": null,
          "old_line_content": "\t\tphp_stream_rewind(oldfile);",
          "new_line_content": "\t\tmust_close_old_file = false;",
          "content_same": false
        },
        {
          "line": 2600,
          "old_api": "php_stream_open_wrapper",
          "new_api": null,
          "old_text": "php_stream_open_wrapper(phar->fname, \"rb\", 0, NULL)",
          "new_text": null,
          "old_line_content": "\t\toldfile = php_stream_open_wrapper(phar->fname, \"rb\", 0, NULL);",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 2603,
          "old_api": "php_stream_fopen_tmpfile",
          "new_api": null,
          "old_text": "php_stream_fopen_tmpfile()",
          "new_text": null,
          "old_line_content": "\tnewfile = php_stream_fopen_tmpfile();",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 2606,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"unable to create temporary file\")",
          "new_text": null,
          "old_line_content": "\t\t\tspprintf(error, 0, \"unable to create temporary file\");",
          "new_line_content": "\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2609,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 2615,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(halt_stub)",
          "new_text": null,
          "old_line_content": "\t\tchar *pos = php_stristr(ZSTR_VAL(user_stub), halt_stub, ZSTR_LEN(user_stub), strlen(halt_stub));",
          "new_line_content": "\tif (user_stub) {",
          "content_same": false
        },
        {
          "line": 2619,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 2621,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 2623,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"illegal stub for phar \\\"%s\\\" (__HALT_COMPILER(); is missing)\", phar->fname)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"illegal stub for phar \\\"%s\\\" (__HALT_COMPILER(); is missing)\", phar->fname);",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2628,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(halt_stub)",
          "new_text": null,
          "old_line_content": "\t\tsize_t len = pos - ZSTR_VAL(user_stub) + strlen(halt_stub);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2630,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(end_sequence)",
          "new_text": null,
          "old_line_content": "\t\tsize_t end_sequence_len = strlen(end_sequence);",
          "new_line_content": "\t\tconst char end_sequence[] = \" ?>\\r\\n\";",
          "content_same": false
        },
        {
          "line": 2633,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(user_stub)",
          "new_text": null,
          "old_line_content": "\t\t\tlen != php_stream_write(newfile, ZSTR_VAL(user_stub), len)",
          "new_line_content": "\t\tif (",
          "content_same": false
        },
        {
          "line": 2637,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 2639,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 2641,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"unable to create stub from string in new phar \\\"%s\\\"\", phar->fname)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"unable to create stub from string in new phar \\\"%s\\\"\", phar->fname);",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2651,
          "old_api": "php_stream_copy_to_stream_ex",
          "new_api": null,
          "old_text": "php_stream_copy_to_stream_ex(oldfile, newfile, phar->halt_offset, &written)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_copy_to_stream_ex(oldfile, newfile, phar->halt_offset, &written);",
          "new_line_content": "\t\tif (!user_stub && phar->halt_offset && oldfile && !phar->is_brandnew) {",
          "content_same": false
        },
        {
          "line": 2654,
          "old_api": "phar_create_default_stub",
          "new_api": null,
          "old_text": "phar_create_default_stub(NULL, NULL, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\tnew_stub = phar_create_default_stub(NULL, NULL, NULL);",
          "new_line_content": "\t\t\t/* this is either a brand new phar or a default stub overwrite */",
          "content_same": false
        },
        {
          "line": 2660,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 2662,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 2665,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"unable to create stub in new phar \\\"%s\\\"\", phar->fname)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to create stub in new phar \\\"%s\\\"\", phar->fname);",
          "new_line_content": "\t\t\t\tif (new_stub) {",
          "content_same": false
        },
        {
          "line": 2667,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"unable to copy stub of old phar to new phar \\\"%s\\\"\", phar->fname)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to copy stub of old phar to new phar \\\"%s\\\"\", phar->fname);",
          "new_line_content": "\t\t\t\t} else {",
          "content_same": false
        },
        {
          "line": 2671,
          "old_api": "zend_string_free",
          "new_api": null,
          "old_text": "zend_string_free(new_stub)",
          "new_text": null,
          "old_line_content": "\t\t\t\tzend_string_free(new_stub);",
          "new_line_content": "\t\t\tif (new_stub) {",
          "content_same": false
        },
        {
          "line": 2676,
          "old_api": "zend_string_free",
          "new_api": null,
          "old_text": "zend_string_free(new_stub)",
          "new_text": null,
          "old_line_content": "\t\t\tzend_string_free(new_stub);",
          "new_line_content": "\t\tif (new_stub) {",
          "content_same": false
        },
        {
          "line": 2679,
          "old_api": "php_stream_tell",
          "new_api": null,
          "old_text": "php_stream_tell(newfile)",
          "new_text": null,
          "old_line_content": "\tmanifest_ftell = php_stream_tell(newfile);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 2685,
          "old_api": "zend_hash_apply",
          "new_api": null,
          "old_text": "zend_hash_apply(&phar->manifest, phar_flush_clean_deleted_apply)",
          "new_text": null,
          "old_line_content": "\tzend_hash_apply(&phar->manifest, phar_flush_clean_deleted_apply);",
          "new_line_content": "\t * we need to skip entries marked is_deleted. */",
          "content_same": false
        },
        {
          "line": 2690,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(phar->metadata_tracker.str)",
          "new_text": null,
          "old_line_content": "\t\tsmart_str_appendl(&main_metadata_str, ZSTR_VAL(phar->metadata_tracker.str), ZSTR_LEN(phar->metadata_tracker.str));",
          "new_line_content": "\tif (phar->metadata_tracker.str) {",
          "content_same": false
        },
        {
          "line": 2698,
          "old_api": "ZEND_HASH_MAP_FOREACH_PTR",
          "new_api": null,
          "old_text": "ZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry)",
          "new_text": null,
          "old_line_content": "\tZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry) {",
          "new_line_content": "\toffset = 0;",
          "content_same": false
        },
        {
          "line": 2701,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(entry->cfp)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(entry->cfp);",
          "new_line_content": "\t\t\t/* did we forget to get rid of cfp last time? */",
          "content_same": false
        },
        {
          "line": 2722,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\tphar_add_virtual_dirs(phar, ZSTR_VAL(entry->filename), ZSTR_LEN(entry->filename));",
          "new_line_content": "\t\t++new_manifest_count;",
          "content_same": false
        },
        {
          "line": 2728,
          "old_api": "Z_ISUNDEF",
          "new_api": null,
          "old_text": "Z_ISUNDEF(entry->metadata_tracker.val)",
          "new_text": null,
          "old_line_content": "\t\tif (!Z_ISUNDEF(entry->metadata_tracker.val) && !entry->metadata_tracker.str) {",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 2732,
          "old_api": "PHP_VAR_SERIALIZE_INIT",
          "new_api": null,
          "old_text": "PHP_VAR_SERIALIZE_INIT(metadata_hash)",
          "new_text": null,
          "old_line_content": "\t\t\tPHP_VAR_SERIALIZE_INIT(metadata_hash);",
          "new_line_content": "\t\t\tsmart_str buf = {0};",
          "content_same": false
        },
        {
          "line": 2739,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(entry->metadata_tracker.str)",
          "new_text": null,
          "old_line_content": "\t\toffset += 4 + ZSTR_LEN(entry->filename) + sizeof(entry_buffer) + (entry->metadata_tracker.str ? ZSTR_LEN(entry->metadata_tracker.str) : 0) + (entry->is_dir ? 1 : 0);",
          "new_line_content": "\t\t/* 32 bits for filename length, length of filename, manifest + metadata, and add 1 for trailing / if a directory */",
          "content_same": false
        },
        {
          "line": 2749,
          "old_api": "phar_get_efp",
          "new_api": null,
          "old_text": "phar_get_efp(entry, 0)",
          "new_text": null,
          "old_line_content": "\t\tif (!phar_get_efp(entry, 0)) {",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 2751,
          "old_api": "phar_open_jit",
          "new_api": null,
          "old_text": "phar_open_jit(phar, entry, error)",
          "new_text": null,
          "old_line_content": "\t\t\tnewentry = phar_open_jit(phar, entry, error);",
          "new_line_content": "\t\t\t/* re-open internal file pointer just-in-time */",
          "content_same": false
        },
        {
          "line": 2754,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(*error)",
          "new_text": null,
          "old_line_content": "\t\t\t\tefree(*error);",
          "new_line_content": "\t\t\t\t/* major problem re-opening, so we ignore this file and the error */",
          "content_same": false
        },
        {
          "line": 2760,
          "old_api": "phar_get_efp",
          "new_api": null,
          "old_text": "phar_get_efp(entry, 0)",
          "new_text": null,
          "old_line_content": "\t\tfile = phar_get_efp(entry, 0);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 2763,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 2765,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 2767,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"unable to seek to start of file \\\"%s\\\" while creating new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2771,
          "old_api": "php_crc32_bulk_init",
          "new_api": null,
          "old_text": "php_crc32_bulk_init()",
          "new_text": null,
          "old_line_content": "\t\tnewcrc32 = php_crc32_bulk_init();",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 2780,
          "old_api": "phar_compress_filter",
          "new_api": null,
          "old_text": "phar_compress_filter(entry, 0)",
          "new_text": null,
          "old_line_content": "\t\tfilter = php_stream_filter_create(phar_compress_filter(entry, 0), NULL, 0);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 2783,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 2785,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 2788,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to gzip compress file \\\"%s\\\" to new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "new_line_content": "\t\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2792,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to bzip2 compress file \\\"%s\\\" to new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "new_line_content": "\t\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2802,
          "old_api": "php_stream_fopen_tmpfile",
          "new_api": null,
          "old_text": "php_stream_fopen_tmpfile()",
          "new_text": null,
          "old_line_content": "\t\t\tshared_cfp = php_stream_fopen_tmpfile();",
          "new_line_content": "\t\tif (shared_cfp == NULL) {",
          "content_same": false
        },
        {
          "line": 2807,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"unable to create temporary file\")",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"unable to create temporary file\");",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2810,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 2812,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 2816,
          "old_api": "ZEND_ASSERT",
          "new_api": null,
          "old_text": "ZEND_ASSERT(entry->header_offset == 0)",
          "new_text": null,
          "old_line_content": "\t\tZEND_ASSERT(entry->header_offset == 0);",
          "new_line_content": "\t\t/* for real phars, header_offset is unused; we misuse it here to store the offset in the temp file */",
          "content_same": false
        },
        {
          "line": 2821,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 2823,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 2825,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"unable to seek to start of file \\\"%s\\\" while creating new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2829,
          "old_api": "php_stream_filter_append",
          "new_api": null,
          "old_text": "php_stream_filter_append((&entry->cfp->writefilters), filter)",
          "new_text": null,
          "old_line_content": "\t\tphp_stream_filter_append((&entry->cfp->writefilters), filter);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 2832,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 2834,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 2836,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"unable to copy compressed file contents of file \\\"%s\\\" while creating new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2840,
          "old_api": "php_stream_filter_flush",
          "new_api": null,
          "old_text": "php_stream_filter_flush(filter, 1)",
          "new_text": null,
          "old_line_content": "\t\tphp_stream_filter_flush(filter, 1);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 2849,
          "old_api": "ZEND_HASH_FOREACH_END",
          "new_api": null,
          "old_text": "ZEND_HASH_FOREACH_END()",
          "new_text": null,
          "old_line_content": "\t} ZEND_HASH_FOREACH_END();",
          "new_line_content": "\t\tglobal_flags |= (entry->flags & PHAR_ENT_COMPRESSION_MASK);",
          "content_same": false
        },
        {
          "line": 2867,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(main_metadata_str.s)",
          "new_text": null,
          "old_line_content": "\tmanifest_len = offset + phar->alias_len + sizeof(manifest) + (main_metadata_str.s ? ZSTR_LEN(main_metadata_str.s) : 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2872,
          "old_api": "phar_set_32",
          "new_api": null,
          "old_text": "phar_set_32(manifest, manifest_len)",
          "new_text": null,
          "old_line_content": "\t\tphar_set_32(manifest, manifest_len);",
          "new_line_content": "\t\tmanifest_len++;",
          "content_same": false
        },
        {
          "line": 2875,
          "old_api": "phar_set_32",
          "new_api": null,
          "old_text": "phar_set_32(manifest+4, new_manifest_count)",
          "new_text": null,
          "old_line_content": "\tphar_set_32(manifest+4, new_manifest_count);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 2883,
          "old_api": "phar_set_32",
          "new_api": null,
          "old_text": "phar_set_32(manifest+10, global_flags)",
          "new_text": null,
          "old_line_content": "\tphar_set_32(manifest+10, global_flags);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 2887,
          "old_api": "php_stream_write",
          "new_api": null,
          "old_text": "php_stream_write(newfile, manifest, sizeof(manifest))",
          "new_text": null,
          "old_line_content": "\tif (sizeof(manifest) != php_stream_write(newfile, manifest, sizeof(manifest))",
          "new_line_content": "\t/* write the manifest header */",
          "content_same": false
        },
        {
          "line": 2891,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 2894,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\tphp_stream_close(newfile);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2898,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"unable to write manifest header of new phar \\\"%s\\\"\", phar->fname)",
          "new_text": null,
          "old_line_content": "\t\t\tspprintf(error, 0, \"unable to write manifest header of new phar \\\"%s\\\"\", phar->fname);",
          "new_line_content": "\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2906,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(main_metadata_str.s)",
          "new_text": null,
          "old_line_content": "\tphar_set_32(manifest, main_metadata_str.s ? ZSTR_LEN(main_metadata_str.s) : 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2912,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 2915,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\tphp_stream_close(newfile);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2919,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"unable to write manifest meta-data of new phar \\\"%s\\\"\", phar->fname)",
          "new_text": null,
          "old_line_content": "\t\t\tspprintf(error, 0, \"unable to write manifest meta-data of new phar \\\"%s\\\"\", phar->fname);",
          "new_line_content": "\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2924,
          "old_api": "smart_str_free",
          "new_api": null,
          "old_text": "smart_str_free(&main_metadata_str)",
          "new_text": null,
          "old_line_content": "\tsmart_str_free(&main_metadata_str);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 2927,
          "old_api": "php_stream_tell",
          "new_api": null,
          "old_text": "php_stream_tell(newfile)",
          "new_text": null,
          "old_line_content": "\tmanifest_ftell = php_stream_tell(newfile);",
          "new_line_content": "\t/* re-calculate the manifest location to simplify later code */",
          "content_same": false
        },
        {
          "line": 2930,
          "old_api": "ZEND_HASH_MAP_FOREACH_PTR",
          "new_api": null,
          "old_text": "ZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry)",
          "new_text": null,
          "old_line_content": "\tZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry) {",
          "new_line_content": "\t/* now write the manifest */",
          "content_same": false
        },
        {
          "line": 2939,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\tphar_set_32(entry_buffer, ZSTR_LEN(entry->filename) + 1);",
          "new_line_content": "\t\t\t/* add 1 for trailing slash */",
          "content_same": false
        },
        {
          "line": 2941,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\tphar_set_32(entry_buffer, ZSTR_LEN(entry->filename));",
          "new_line_content": "\t\t} else {",
          "content_same": false
        },
        {
          "line": 2944,
          "old_api": "php_stream_write",
          "new_api": null,
          "old_text": "php_stream_write(newfile, entry_buffer, 4)",
          "new_text": null,
          "old_line_content": "\t\tif (4 != php_stream_write(newfile, entry_buffer, 4)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2948,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 2950,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 2953,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to write filename of directory \\\"%s\\\" to manifest of new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "new_line_content": "\t\t\t\tif (entry->is_dir) {",
          "content_same": false
        },
        {
          "line": 2955,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to write filename of file \\\"%s\\\" to manifest of new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "new_line_content": "\t\t\t\t} else {",
          "content_same": false
        },
        {
          "line": 2970,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "\t\tmytime = time(NULL);",
          "new_line_content": "\t\t*/",
          "content_same": false
        },
        {
          "line": 2977,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(metadata_str)",
          "new_text": null,
          "old_line_content": "\t\tphar_set_32(entry_buffer+20, metadata_str ? ZSTR_LEN(metadata_str) : 0);",
          "new_line_content": "\t\tmetadata_str = entry->metadata_tracker.str;",
          "content_same": false
        },
        {
          "line": 2979,
          "old_api": "php_stream_write",
          "new_api": null,
          "old_text": "php_stream_write(newfile, entry_buffer, sizeof(entry_buffer))",
          "new_text": null,
          "old_line_content": "\t\tif (sizeof(entry_buffer) != php_stream_write(newfile, entry_buffer, sizeof(entry_buffer))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2981,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(metadata_str)",
          "new_text": null,
          "old_line_content": "\t\t    ZSTR_LEN(metadata_str) != php_stream_write(newfile, ZSTR_VAL(metadata_str), ZSTR_LEN(metadata_str)))) {",
          "new_line_content": "\t\t|| (metadata_str &&",
          "content_same": false
        },
        {
          "line": 2983,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 2986,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2989,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"unable to write temporary manifest of file \\\"%s\\\" to manifest of new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 2994,
          "old_api": "ZEND_HASH_FOREACH_END",
          "new_api": null,
          "old_text": "ZEND_HASH_FOREACH_END()",
          "new_text": null,
          "old_line_content": "\t} ZEND_HASH_FOREACH_END();",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 2997,
          "old_api": "php_stream_write",
          "new_api": null,
          "old_text": "php_stream_write(newfile, manifest, 1)",
          "new_text": null,
          "old_line_content": "\t\tif(1 != php_stream_write(newfile, manifest, 1)) {",
          "new_line_content": "\tif (manifest_hack) {",
          "content_same": false
        },
        {
          "line": 2999,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 3002,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3005,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"unable to write manifest padding byte\")",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"unable to write manifest padding byte\");",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 3013,
          "old_api": "php_stream_tell",
          "new_api": null,
          "old_text": "php_stream_tell(newfile)",
          "new_text": null,
          "old_line_content": "\toffset = php_stream_tell(newfile);",
          "new_line_content": "\t/* now copy the actual file data to the new phar */",
          "content_same": false
        },
        {
          "line": 3021,
          "old_api": "php_stream_seek",
          "new_api": null,
          "old_text": "php_stream_seek(file, entry->header_offset, SEEK_SET)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_seek(file, entry->header_offset, SEEK_SET);",
          "new_line_content": "\t\t\tfile = entry->cfp;",
          "content_same": false
        },
        {
          "line": 3023,
          "old_api": "phar_get_efp",
          "new_api": null,
          "old_text": "phar_get_efp(entry, 0)",
          "new_text": null,
          "old_line_content": "\t\t\tfile = phar_get_efp(entry, 0);",
          "new_line_content": "\t\t} else {",
          "content_same": false
        },
        {
          "line": 3026,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 3028,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(newfile);",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 3030,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tspprintf(error, 0, \"unable to seek to start of file \\\"%s\\\" while creating new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "new_line_content": "\t\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 3038,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 3040,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 3042,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"unable to seek to start of file \\\"%s\\\" while creating new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 3050,
          "old_api": "php_stream_copy_to_stream_ex",
          "new_api": null,
          "old_text": "php_stream_copy_to_stream_ex(file, newfile, entry->compressed_filesize, &wrote)",
          "new_text": null,
          "old_line_content": "\t\tif (php_stream_copy_to_stream_ex(file, newfile, entry->compressed_filesize, &wrote) == FAILURE) {",
          "new_line_content": "\t\toffset += entry->compressed_filesize;",
          "content_same": false
        },
        {
          "line": 3052,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 3055,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3058,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(entry->filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"unable to write contents of file \\\"%s\\\" to new phar \\\"%s\\\"\", ZSTR_VAL(entry->filename), phar->fname);",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 3074,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(entry->fp)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_close(entry->fp);",
          "new_line_content": "\t\t\tif (entry->fp_refcount == 0 && entry->fp != phar->fp && entry->fp != phar->ufp) {",
          "content_same": false
        },
        {
          "line": 3082,
          "old_api": "ZEND_HASH_FOREACH_END",
          "new_api": null,
          "old_text": "ZEND_HASH_FOREACH_END()",
          "new_text": null,
          "old_line_content": "\t} ZEND_HASH_FOREACH_END();",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 3085,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(shared_cfp)",
          "new_text": null,
          "old_line_content": "\t\tphp_stream_close(shared_cfp);",
          "new_line_content": "\tif (shared_cfp != NULL) {",
          "content_same": false
        },
        {
          "line": 3093,
          "old_api": "php_stream_rewind",
          "new_api": null,
          "old_text": "php_stream_rewind(newfile)",
          "new_text": null,
          "old_line_content": "\t\tphp_stream_rewind(newfile);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3096,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(phar->signature)",
          "new_text": null,
          "old_line_content": "\t\t\tefree(phar->signature);",
          "new_line_content": "\t\tif (phar->signature) {",
          "content_same": false
        },
        {
          "line": 3105,
          "old_api": "phar_create_signature",
          "new_api": null,
          "old_text": "phar_create_signature(phar, newfile, &digest, &digest_len, error)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (FAILURE == phar_create_signature(phar, newfile, &digest, &digest_len, error)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3108,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"phar error: unable to write signature: %s\", save)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tspprintf(error, 0, \"phar error: unable to write signature: %s\", save);",
          "new_line_content": "\t\t\t\t\t\tchar *save = *error;",
          "content_same": false
        },
        {
          "line": 3112,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(digest)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tefree(digest);",
          "new_line_content": "\t\t\t\t\tif (digest) {",
          "content_same": false
        },
        {
          "line": 3115,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tphp_stream_close(oldfile);",
          "new_line_content": "\t\t\t\t\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 3117,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tphp_stream_close(newfile);",
          "new_line_content": "\t\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 3121,
          "old_api": "php_stream_write",
          "new_api": null,
          "old_text": "php_stream_write(newfile, digest, digest_len)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_write(newfile, digest, digest_len);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3126,
          "old_api": "phar_set_32",
          "new_api": null,
          "old_text": "phar_set_32(sig_buf, digest_len)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tphar_set_32(sig_buf, digest_len);",
          "new_line_content": "\t\t\t\t\tphar->sig_flags == PHAR_SIG_OPENSSL_SHA512) {",
          "content_same": false
        },
        {
          "line": 3132,
          "old_api": "phar_set_32",
          "new_api": null,
          "old_text": "phar_set_32(sig_buf, phar->sig_flags)",
          "new_text": null,
          "old_line_content": "\t\tphar_set_32(sig_buf, phar->sig_flags);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 3141,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(phar->fp)",
          "new_text": null,
          "old_line_content": "\t\tphp_stream_close(phar->fp);",
          "new_line_content": "\tif (phar->fp && free_fp) {",
          "content_same": false
        },
        {
          "line": 3146,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(phar->ufp)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(phar->ufp);",
          "new_line_content": "\t\tif (free_ufp) {",
          "content_same": false
        },
        {
          "line": 3152,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(oldfile)",
          "new_text": null,
          "old_line_content": "\t\tphp_stream_close(oldfile);",
          "new_line_content": "\tif (must_close_old_file) {",
          "content_same": false
        },
        {
          "line": 3158,
          "old_api": "php_stream_rewind",
          "new_api": null,
          "old_text": "php_stream_rewind(newfile)",
          "new_text": null,
          "old_line_content": "\tphp_stream_rewind(newfile);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3164,
          "old_api": "php_stream_open_wrapper",
          "new_api": null,
          "old_text": "php_stream_open_wrapper(phar->fname, \"w+b\", IGNORE_URL|STREAM_MUST_SEEK|REPORT_ERRORS, NULL)",
          "new_text": null,
          "old_line_content": "\t\tphar->fp = php_stream_open_wrapper(phar->fname, \"w+b\", IGNORE_URL|STREAM_MUST_SEEK|REPORT_ERRORS, NULL);",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 3168,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 4096, \"unable to open new phar \\\"%s\\\" for writing\", phar->fname)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 4096, \"unable to open new phar \\\"%s\\\" for writing\", phar->fname);",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 3177,
          "old_api": "array_init",
          "new_api": null,
          "old_text": "array_init(&filterparams)",
          "new_text": null,
          "old_line_content": "\t\t\tarray_init(&filterparams);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3184,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 4096, \"unable to compress all contents of phar \\\"%s\\\" using zlib, PHP versions older than 5.2.6 have a buggy zlib\", phar->fname)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tspprintf(error, 4096, \"unable to compress all contents of phar \\\"%s\\\" using zlib, PHP versions older than 5.2.6 have a buggy zlib\", phar->fname);",
          "new_line_content": "\t\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 3189,
          "old_api": "php_stream_filter_append",
          "new_api": null,
          "old_text": "php_stream_filter_append(&phar->fp->writefilters, filter)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_filter_append(&phar->fp->writefilters, filter);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3197,
          "old_api": "php_stream_is_persistent",
          "new_api": null,
          "old_text": "php_stream_is_persistent(phar->fp)",
          "new_text": null,
          "old_line_content": "\t\t\tfilter = php_stream_filter_create(\"bzip2.compress\", NULL, php_stream_is_persistent(phar->fp));",
          "new_line_content": "\t\t} else if (phar->flags & PHAR_FILE_COMPRESSED_BZ2) {",
          "content_same": false
        },
        {
          "line": 3206,
          "old_api": "php_stream_copy_to_stream_ex",
          "new_api": null,
          "old_text": "php_stream_copy_to_stream_ex(newfile, phar->fp, PHP_STREAM_COPY_ALL, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_copy_to_stream_ex(newfile, phar->fp, PHP_STREAM_COPY_ALL, NULL);",
          "new_line_content": "\t\t} else {",
          "content_same": false
        },
        {
          "line": 3208,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(newfile)",
          "new_text": null,
          "old_line_content": "\t\t\tphp_stream_close(newfile);",
          "new_line_content": "\t\t\t/* we could also reopen the file in \"rb\" mode but there is no need for that */",
          "content_same": false
        },
        {
          "line": 3212,
          "old_api": "php_stream_seek",
          "new_api": null,
          "old_text": "php_stream_seek(phar->fp, phar->halt_offset, SEEK_SET)",
          "new_text": null,
          "old_line_content": "\tif (-1 == php_stream_seek(phar->fp, phar->halt_offset, SEEK_SET)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3214,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"unable to seek to __HALT_COMPILER(); in new phar \\\"%s\\\"\", phar->fname)",
          "new_text": null,
          "old_line_content": "\t\t\tspprintf(error, 0, \"unable to seek to __HALT_COMPILER(); in new phar \\\"%s\\\"\", phar->fname);",
          "new_line_content": "\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 3222,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(shared_cfp)",
          "new_text": null,
          "old_line_content": "\t\tphp_stream_close(shared_cfp);",
          "new_line_content": "\tif (shared_cfp != NULL) {",
          "content_same": false
        },
        {
          "line": 3224,
          "old_api": "ZEND_HASH_MAP_FOREACH_PTR",
          "new_api": null,
          "old_text": "ZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry)",
          "new_text": null,
          "old_line_content": "\tZEND_HASH_MAP_FOREACH_PTR(&phar->manifest, entry) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 3229,
          "old_api": "ZEND_HASH_FOREACH_END",
          "new_api": null,
          "old_text": "ZEND_HASH_FOREACH_END()",
          "new_text": null,
          "old_line_content": "\t} ZEND_HASH_FOREACH_END();",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 3235,
          "old_api": "ZEND_TSRMLS_CACHE_DEFINE",
          "new_api": null,
          "old_text": "ZEND_TSRMLS_CACHE_DEFINE()",
          "new_text": null,
          "old_line_content": "ZEND_TSRMLS_CACHE_DEFINE()",
          "new_line_content": "#ifdef ZTS",
          "content_same": false
        },
        {
          "line": 3237,
          "old_api": "ZEND_GET_MODULE",
          "new_api": null,
          "old_text": "ZEND_GET_MODULE(phar)",
          "new_text": null,
          "old_line_content": "ZEND_GET_MODULE(phar)",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 3242,
          "old_api": "phar_get_pharfp",
          "new_api": null,
          "old_text": "phar_get_pharfp((phar_archive_data*)handle)",
          "new_text": null,
          "old_line_content": "\treturn php_stream_read(phar_get_pharfp((phar_archive_data*)handle), buf, len);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3255,
          "old_api": "phar_find_in_include_path",
          "new_api": null,
          "old_text": "phar_find_in_include_path(filename, NULL)",
          "new_text": null,
          "old_line_content": "\tzend_string *ret = phar_find_in_include_path(filename, NULL);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3257,
          "old_api": "phar_save_resolve_path",
          "new_api": null,
          "old_text": "phar_save_resolve_path(filename)",
          "new_text": null,
          "old_line_content": "\t\tret = phar_save_resolve_path(filename);",
          "new_line_content": "\tif (!ret) {",
          "content_same": false
        },
        {
          "line": 3270,
          "old_api": "phar_orig_compile_file",
          "new_api": null,
          "old_text": "phar_orig_compile_file(file_handle, type)",
          "new_text": null,
          "old_line_content": "\t\treturn phar_orig_compile_file(file_handle, type);",
          "new_line_content": "\tif (!file_handle || !file_handle->filename) {",
          "content_same": false
        },
        {
          "line": 3272,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(file_handle->filename)",
          "new_text": null,
          "old_line_content": "\tif (strstr(ZSTR_VAL(file_handle->filename), \".phar\") && !strstr(ZSTR_VAL(file_handle->filename), \"://\")) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 3278,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(file_handle->filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\tname = zend_strpprintf(4096, \"phar://%s/%s\", ZSTR_VAL(file_handle->filename), \".phar/stub.php\");",
          "new_line_content": "\t\t\t\t/* zip or tar-based phar */",
          "content_same": false
        },
        {
          "line": 1234,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(entry.filename)",
          "new_text": null,
          "old_line_content": "\t\t\tstr = zend_string_init_interned(ZSTR_VAL(entry.filename), ZSTR_LEN(entry.filename), 1);",
          "new_line_content": "\t\t} else {",
          "content_same": false
        },
        {
          "line": 1236,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(entry.filename)",
          "new_text": null,
          "old_line_content": "\t\t\tstr = zend_string_init(ZSTR_VAL(entry.filename), ZSTR_LEN(entry.filename), 0);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 3284,
          "old_api": "zend_string_release",
          "new_api": null,
          "old_text": "zend_string_release(f.opened_path)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tzend_string_release(f.opened_path);",
          "new_line_content": "\t\t\t\t\tif (f.opened_path) {",
          "content_same": false
        },
        {
          "line": 1238,
          "old_api": "zend_hash_add_mem",
          "new_api": null,
          "old_text": "zend_hash_add_mem(&mydata->manifest, str, (void*)&entry, sizeof(phar_entry_info))",
          "new_text": null,
          "old_line_content": "\t\tzend_hash_add_mem(&mydata->manifest, str, (void*)&entry, sizeof(phar_entry_info));",
          "new_line_content": "\t\tif (mydata->is_persistent) {",
          "content_same": false
        },
        {
          "line": 1242,
          "old_api": "snprintf",
          "new_api": null,
          "old_text": "snprintf(mydata->version, sizeof(mydata->version), \"%u.%u.%u\", manifest_ver >> 12, (manifest_ver >> 8) & 0xF, (manifest_ver >> 4) & 0xF)",
          "new_text": null,
          "old_line_content": "\tsnprintf(mydata->version, sizeof(mydata->version), \"%u.%u.%u\", manifest_ver >> 12, (manifest_ver >> 8) & 0xF, (manifest_ver >> 4) & 0xF);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3291,
          "old_api": "closer",
          "new_api": null,
          "old_text": "file_handle->handle.stream.closer(file_handle->handle.stream.handle)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t\tfile_handle->handle.stream.closer(file_handle->handle.stream.handle);",
          "new_line_content": "\t\t\t\t\t\t\tif (file_handle->handle.stream.closer && file_handle->handle.stream.handle) {",
          "content_same": false
        },
        {
          "line": 1245,
          "old_api": "strrchr",
          "new_api": null,
          "old_text": "strrchr(mydata->fname, '/')",
          "new_text": null,
          "old_line_content": "\tendbuffer = strrchr(mydata->fname, '/');",
          "new_line_content": "\tmydata->flags = manifest_flags;",
          "content_same": false
        },
        {
          "line": 1248,
          "old_api": "memchr",
          "new_api": null,
          "old_text": "memchr(endbuffer, '.', (mydata->fname + fname_len) - endbuffer)",
          "new_text": null,
          "old_line_content": "\t\tmydata->ext = memchr(endbuffer, '.', (mydata->fname + fname_len) - endbuffer);",
          "new_line_content": "\tif (endbuffer) {",
          "content_same": false
        },
        {
          "line": 1250,
          "old_api": "memchr",
          "new_api": null,
          "old_text": "memchr(endbuffer + 1, '.', (mydata->fname + fname_len) - endbuffer - 1)",
          "new_text": null,
          "old_line_content": "\t\t\tmydata->ext = memchr(endbuffer + 1, '.', (mydata->fname + fname_len) - endbuffer - 1);",
          "new_line_content": "\t\tif (mydata->ext == endbuffer) {",
          "content_same": false
        },
        {
          "line": 1258,
          "old_api": "pestrndup",
          "new_api": null,
          "old_text": "pestrndup(alias, alias_len, mydata->is_persistent)",
          "new_text": null,
          "old_line_content": "\t\tpestrndup(alias, alias_len, mydata->is_persistent) :",
          "new_line_content": "\tmydata->alias = alias ?",
          "content_same": false
        },
        {
          "line": 3310,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(cached_fp)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tphp_stream_rewind(PHAR_G(cached_fp)[phar->phar_pos].fp) :",
          "new_line_content": "\t\t\t\tphar->is_persistent ?",
          "content_same": false
        },
        {
          "line": 1265,
          "old_api": "phar_request_initialize",
          "new_api": null,
          "old_text": "phar_request_initialize()",
          "new_text": null,
          "old_line_content": "\tphar_request_initialize();",
          "new_line_content": "\tmydata->signature = signature;",
          "content_same": false
        },
        {
          "line": 3318,
          "old_api": "CG",
          "new_api": null,
          "old_text": "CG(zend_lineno)",
          "new_text": null,
          "old_line_content": "\t\tCG(zend_lineno) = 0;",
          "new_line_content": "\t\tfailed = 0;",
          "content_same": false
        },
        {
          "line": 1272,
          "old_api": "phar_validate_alias",
          "new_api": null,
          "old_text": "phar_validate_alias(mydata->alias, mydata->alias_len)",
          "new_text": null,
          "old_line_content": "\t\tif (!phar_validate_alias(mydata->alias, mydata->alias_len)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1275,
          "old_api": "MAPPHAR_FAIL",
          "new_api": null,
          "old_text": "MAPPHAR_FAIL(\"Cannot open archive \\\"%s\\\", invalid alias\")",
          "new_text": null,
          "old_line_content": "\t\t\tMAPPHAR_FAIL(\"Cannot open archive \\\"%s\\\", invalid alias\");",
          "new_line_content": "\t\t\tfp = NULL;",
          "content_same": false
        },
        {
          "line": 3323,
          "old_api": "zend_end_try",
          "new_api": null,
          "old_text": "zend_end_try()",
          "new_text": null,
          "old_line_content": "\t} zend_end_try();",
          "new_line_content": "\t\tres = NULL;",
          "content_same": false
        },
        {
          "line": 1278,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(phar_alias_map)",
          "new_text": null,
          "old_line_content": "\t\tif (NULL != (fd_ptr = zend_hash_str_find_ptr(&(PHAR_G(phar_alias_map)), alias, alias_len))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3326,
          "old_api": "zend_string_release",
          "new_api": null,
          "old_text": "zend_string_release(name)",
          "new_text": null,
          "old_line_content": "\t\tzend_string_release(name);",
          "new_line_content": "\tif (name) {",
          "content_same": false
        },
        {
          "line": 1282,
          "old_api": "MAPPHAR_FAIL",
          "new_api": null,
          "old_text": "MAPPHAR_FAIL(\"Cannot open archive \\\"%s\\\", alias is already in use by existing archive\")",
          "new_text": null,
          "old_line_content": "\t\t\t\tMAPPHAR_FAIL(\"Cannot open archive \\\"%s\\\", alias is already in use by existing archive\");",
          "new_line_content": "\t\t\t\tfp = NULL;",
          "content_same": false
        },
        {
          "line": 3330,
          "old_api": "zend_bailout",
          "new_api": null,
          "old_text": "zend_bailout()",
          "new_text": null,
          "old_line_content": "\t\tzend_bailout();",
          "new_line_content": "\tif (failed) {",
          "content_same": false
        },
        {
          "line": 1287,
          "old_api": "zend_string_init_interned",
          "new_api": null,
          "old_text": "zend_string_init_interned(alias, alias_len, 1)",
          "new_text": null,
          "old_line_content": "\t\t\tstr = zend_string_init_interned(alias, alias_len, 1);",
          "new_line_content": "\t\tif (mydata->is_persistent) {",
          "content_same": false
        },
        {
          "line": 1289,
          "old_api": "zend_string_init",
          "new_api": null,
          "old_text": "zend_string_init(alias, alias_len, 0)",
          "new_text": null,
          "old_line_content": "\t\t\tstr = zend_string_init(alias, alias_len, 0);",
          "new_line_content": "\t\t} else {",
          "content_same": false
        },
        {
          "line": 1291,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(phar_alias_map)",
          "new_text": null,
          "old_line_content": "\t\tzend_hash_add_ptr(&(PHAR_G(phar_alias_map)), str, mydata);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 3339,
          "old_api": "Z_PTR_P",
          "new_api": null,
          "old_text": "Z_PTR_P(zv)",
          "new_text": null,
          "old_line_content": "\tfree(Z_PTR_P(zv));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3345,
          "old_api": "ZEND_TSRMLS_CACHE_UPDATE",
          "new_api": null,
          "old_text": "ZEND_TSRMLS_CACHE_UPDATE()",
          "new_text": null,
          "old_line_content": "\tZEND_TSRMLS_CACHE_UPDATE();",
          "new_line_content": "#if defined(COMPILE_DL_PHAR) && defined(ZTS)",
          "content_same": false
        },
        {
          "line": 1298,
          "old_api": "zend_string_init_interned",
          "new_api": null,
          "old_text": "zend_string_init_interned(mydata->fname, fname_len, 1)",
          "new_text": null,
          "old_line_content": "\t\tstr = zend_string_init_interned(mydata->fname, fname_len, 1);",
          "new_line_content": "\tif (mydata->is_persistent) {",
          "content_same": false
        },
        {
          "line": 1300,
          "old_api": "zend_string_init",
          "new_api": null,
          "old_text": "zend_string_init(mydata->fname, fname_len, 0)",
          "new_text": null,
          "old_line_content": "\t\tstr = zend_string_init(mydata->fname, fname_len, 0);",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 3349,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(phar_globals, 0, sizeof(zend_phar_globals))",
          "new_text": null,
          "old_line_content": "\tmemset(phar_globals, 0, sizeof(zend_phar_globals));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1302,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(phar_fname_map)",
          "new_text": null,
          "old_line_content": "\tzend_hash_add_ptr(&(PHAR_G(phar_fname_map)), str, mydata);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 3355,
          "old_api": "zend_hash_init",
          "new_api": null,
          "old_text": "zend_hash_init(&phar_globals->mime_types, 0, NULL, mime_type_dtor, 1)",
          "new_text": null,
          "old_line_content": "\tzend_hash_init(&phar_globals->mime_types, 0, NULL, mime_type_dtor, 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3363,
          "old_api": "PHAR_SET_MIME",
          "new_api": null,
          "old_text": "PHAR_SET_MIME(\"text/html\", PHAR_MIME_PHPS, \"phps\")",
          "new_text": null,
          "old_line_content": "\tPHAR_SET_MIME(\"text/html\", PHAR_MIME_PHPS, \"phps\")",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1331,
          "old_api": "phar_detect_phar_fname_ext",
          "new_api": null,
          "old_text": "phar_detect_phar_fname_ext(fname, fname_len, &ext_str, &ext_len, !is_data, 0, 1)",
          "new_text": null,
          "old_line_content": "\tif (phar_detect_phar_fname_ext(fname, fname_len, &ext_str, &ext_len, !is_data, 0, 1) == SUCCESS) {",
          "new_line_content": "\t/* first try to open an existing file */",
          "content_same": false
        },
        {
          "line": 1336,
          "old_api": "phar_detect_phar_fname_ext",
          "new_api": null,
          "old_text": "phar_detect_phar_fname_ext(fname, fname_len, &ext_str, &ext_len, !is_data, 1, 1)",
          "new_text": null,
          "old_line_content": "\tif (FAILURE == phar_detect_phar_fname_ext(fname, fname_len, &ext_str, &ext_len, !is_data, 1, 1)) {",
          "new_line_content": "\t/* next try to create a new file */",
          "content_same": false
        },
        {
          "line": 1339,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"Cannot create a phar archive from a URL like \\\"%s\\\". Phar objects can only be created from local files\", fname)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"Cannot create a phar archive from a URL like \\\"%s\\\". Phar objects can only be created from local files\", fname);",
          "new_line_content": "\t\t\tif (ext_len == -2) {",
          "content_same": false
        },
        {
          "line": 1341,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"Cannot create phar '%s', file extension (or combination) not recognised or the directory does not exist\", fname)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"Cannot create phar '%s', file extension (or combination) not recognised or the directory does not exist\", fname);",
          "new_line_content": "\t\t\t} else {",
          "content_same": false
        },
        {
          "line": 1347,
          "old_api": "phar_open_parsed_phar",
          "new_api": null,
          "old_text": "phar_open_parsed_phar(fname, fname_len, alias, alias_len, is_data, options, test, &my_error)",
          "new_text": null,
          "old_line_content": "\tif (phar_open_parsed_phar(fname, fname_len, alias, alias_len, is_data, options, test, &my_error) == SUCCESS) {",
          "new_line_content": "check_file:",
          "content_same": false
        },
        {
          "line": 1354,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"Cannot open '%s' as a PharData object. Use Phar::__construct() for executable archives\", fname)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"Cannot open '%s' as a PharData object. Use Phar::__construct() for executable archives\", fname);",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 3404,
          "old_api": "phar_restore_orig_functions",
          "new_api": null,
          "old_text": "phar_restore_orig_functions()",
          "new_text": null,
          "old_line_content": "\tphar_restore_orig_functions();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1359,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(readonly)",
          "new_text": null,
          "old_line_content": "\t\tif (PHAR_G(readonly) && !(*test)->is_data && ((*test)->is_tar || (*test)->is_zip)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1361,
          "old_api": "zend_hash_str_find_ptr",
          "new_api": null,
          "old_text": "zend_hash_str_find_ptr(&((*test)->manifest), \".phar/stub.php\", sizeof(\".phar/stub.php\")-1)",
          "new_text": null,
          "old_line_content": "\t\t\tif (NULL == (stub = zend_hash_str_find_ptr(&((*test)->manifest), \".phar/stub.php\", sizeof(\".phar/stub.php\")-1))) {",
          "new_line_content": "\t\t\tphar_entry_info *stub;",
          "content_same": false
        },
        {
          "line": 3410,
          "old_api": "zend_hash_destroy",
          "new_api": null,
          "old_text": "zend_hash_destroy(&phar_globals->mime_types)",
          "new_text": null,
          "old_line_content": "\tzend_hash_destroy(&phar_globals->mime_types);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1367,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(readonly)",
          "new_text": null,
          "old_line_content": "\t\tif (!PHAR_G(readonly) || (*test)->is_data) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3416,
          "old_api": "REGISTER_INI_ENTRIES",
          "new_api": null,
          "old_text": "REGISTER_INI_ENTRIES()",
          "new_text": null,
          "old_line_content": "\tREGISTER_INI_ENTRIES();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1375,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(my_error)",
          "new_text": null,
          "old_line_content": "\t\t\tefree(my_error);",
          "new_line_content": "\t\t} else {",
          "content_same": false
        },
        {
          "line": 3424,
          "old_api": "phar_object_init",
          "new_api": null,
          "old_text": "phar_object_init()",
          "new_text": null,
          "old_line_content": "\tphar_object_init();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3426,
          "old_api": "phar_intercept_functions_init",
          "new_api": null,
          "old_text": "phar_intercept_functions_init()",
          "new_text": null,
          "old_line_content": "\tphar_intercept_functions_init();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1380,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(z + 1, \"ip\", 2)",
          "new_text": null,
          "old_line_content": "\tif (ext_len > 3 && (z = memchr(ext_str, 'z', ext_len)) && ((ext_str + ext_len) - z >= 2) && !memcmp(z + 1, \"ip\", 2)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3429,
          "old_api": "php_register_url_stream_wrapper",
          "new_api": null,
          "old_text": "php_register_url_stream_wrapper(\"phar\", &php_stream_phar_wrapper)",
          "new_text": null,
          "old_line_content": "\treturn php_register_url_stream_wrapper(\"phar\", &php_stream_phar_wrapper);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1382,
          "old_api": "phar_open_or_create_zip",
          "new_api": null,
          "old_text": "phar_open_or_create_zip(fname, fname_len, alias, alias_len, is_data, options, pphar, error)",
          "new_text": null,
          "old_line_content": "\t\treturn phar_open_or_create_zip(fname, fname_len, alias, alias_len, is_data, options, pphar, error);",
          "new_line_content": "\t\t/* assume zip-based phar */",
          "content_same": false
        },
        {
          "line": 1385,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(z + 1, \"ar\", 2)",
          "new_text": null,
          "old_line_content": "\tif (ext_len > 3 && (z = memchr(ext_str, 't', ext_len)) && ((ext_str + ext_len) - z >= 2) && !memcmp(z + 1, \"ar\", 2)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1387,
          "old_api": "phar_open_or_create_tar",
          "new_api": null,
          "old_text": "phar_open_or_create_tar(fname, fname_len, alias, alias_len, is_data, options, pphar, error)",
          "new_text": null,
          "old_line_content": "\t\treturn phar_open_or_create_tar(fname, fname_len, alias, alias_len, is_data, options, pphar, error);",
          "new_line_content": "\t\t/* assume tar-based phar */",
          "content_same": false
        },
        {
          "line": 3435,
          "old_api": "php_unregister_url_stream_wrapper",
          "new_api": null,
          "old_text": "php_unregister_url_stream_wrapper(\"phar\")",
          "new_text": null,
          "old_line_content": "\tphp_unregister_url_stream_wrapper(\"phar\");",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3437,
          "old_api": "phar_intercept_functions_shutdown",
          "new_api": null,
          "old_text": "phar_intercept_functions_shutdown()",
          "new_text": null,
          "old_line_content": "\tphar_intercept_functions_shutdown();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1390,
          "old_api": "phar_create_or_parse_filename",
          "new_api": null,
          "old_text": "phar_create_or_parse_filename(fname, fname_len, alias, alias_len, is_data, options, pphar, error)",
          "new_text": null,
          "old_line_content": "\treturn phar_create_or_parse_filename(fname, fname_len, alias, alias_len, is_data, options, pphar, error);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3443,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(manifest_cached)",
          "new_text": null,
          "old_line_content": "\tif (PHAR_G(manifest_cached)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3448,
          "old_api": "UNREGISTER_INI_ENTRIES",
          "new_api": null,
          "old_text": "UNREGISTER_INI_ENTRIES()",
          "new_text": null,
          "old_line_content": "\tUNREGISTER_INI_ENTRIES();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1406,
          "old_api": "php_check_open_basedir",
          "new_api": null,
          "old_text": "php_check_open_basedir(fname)",
          "new_text": null,
          "old_line_content": "\tif (php_check_open_basedir(fname)) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 3455,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(request_init)",
          "new_text": null,
          "old_line_content": "\tif (!PHAR_G(request_init))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3457,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(last_phar)",
          "new_text": null,
          "old_line_content": "\t\tPHAR_G(last_phar) = NULL;",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1411,
          "old_api": "php_stream_open_wrapper",
          "new_api": null,
          "old_text": "php_stream_open_wrapper(fname, \"rb\", IGNORE_URL|STREAM_MUST_SEEK|0, &actual)",
          "new_text": null,
          "old_line_content": "\tfp = php_stream_open_wrapper(fname, \"rb\", IGNORE_URL|STREAM_MUST_SEEK|0, &actual);",
          "new_line_content": "\t/* first open readonly so it won't be created if not present */",
          "content_same": false
        },
        {
          "line": 1414,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(actual)",
          "new_text": null,
          "old_line_content": "\t\tfname = ZSTR_VAL(actual);",
          "new_line_content": "\tif (actual) {",
          "content_same": false
        },
        {
          "line": 1419,
          "old_api": "phar_open_from_fp",
          "new_api": null,
          "old_text": "phar_open_from_fp(fp, fname, fname_len, alias, alias_len, options, pphar, error)",
          "new_text": null,
          "old_line_content": "\t\tif (phar_open_from_fp(fp, fname, fname_len, alias, alias_len, options, pphar, error) == SUCCESS) {",
          "new_line_content": "\tif (fp) {",
          "content_same": false
        },
        {
          "line": 3468,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(manifest_cached)",
          "new_text": null,
          "old_line_content": "\t\tif (PHAR_G(manifest_cached)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3470,
          "old_api": "zend_hash_num_elements",
          "new_api": null,
          "old_text": "zend_hash_num_elements(&cached_phars)",
          "new_text": null,
          "old_line_content": "\t\t\tphar_entry_fp *stuff = (phar_entry_fp *) ecalloc(zend_hash_num_elements(&cached_phars), sizeof(phar_entry_fp));",
          "new_line_content": "\t\t\tphar_archive_data *pphar;",
          "content_same": false
        },
        {
          "line": 1424,
          "old_api": "zend_string_release_ex",
          "new_api": null,
          "old_text": "zend_string_release_ex(actual, 0)",
          "new_text": null,
          "old_line_content": "\t\t\t\tzend_string_release_ex(actual, 0);",
          "new_line_content": "\t\t\tif (actual) {",
          "content_same": false
        },
        {
          "line": 3472,
          "old_api": "ZEND_HASH_MAP_FOREACH_PTR",
          "new_api": null,
          "old_text": "ZEND_HASH_MAP_FOREACH_PTR(&cached_phars, pphar)",
          "new_text": null,
          "old_line_content": "\t\t\tZEND_HASH_MAP_FOREACH_PTR(&cached_phars, pphar) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3476,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(cached_fp)",
          "new_text": null,
          "old_line_content": "\t\t\tPHAR_G(cached_fp) = stuff;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1430,
          "old_api": "zend_string_release_ex",
          "new_api": null,
          "old_text": "zend_string_release_ex(actual, 0)",
          "new_text": null,
          "old_line_content": "\t\t\t\tzend_string_release_ex(actual, 0);",
          "new_line_content": "\t\t\tif (actual) {",
          "content_same": false
        },
        {
          "line": 3479,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(phar_SERVER_mung_list)",
          "new_text": null,
          "old_line_content": "\t\tPHAR_G(phar_SERVER_mung_list) = 0;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1437,
          "old_api": "zend_string_release_ex",
          "new_api": null,
          "old_text": "zend_string_release_ex(actual, 0)",
          "new_text": null,
          "old_line_content": "\t\tzend_string_release_ex(actual, 0);",
          "new_line_content": "\tif (actual) {",
          "content_same": false
        },
        {
          "line": 1440,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(readonly)",
          "new_text": null,
          "old_line_content": "\tif (PHAR_G(readonly) && !is_data) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3489,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(request_ends)",
          "new_text": null,
          "old_line_content": "\tPHAR_G(request_ends) = 1;",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1443,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"creating archive \\\"%s\\\" disabled by the php.ini setting phar.readonly\", fname)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"creating archive \\\"%s\\\" disabled by the php.ini setting phar.readonly\", fname);",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 3491,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(request_init)",
          "new_text": null,
          "old_line_content": "\tif (PHAR_G(request_init))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3493,
          "old_api": "phar_release_functions",
          "new_api": null,
          "old_text": "phar_release_functions()",
          "new_text": null,
          "old_line_content": "\t\tphar_release_functions();",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1450,
          "old_api": "ecalloc",
          "new_api": null,
          "old_text": "ecalloc(1, sizeof(phar_archive_data))",
          "new_text": null,
          "old_line_content": "\tmydata = ecalloc(1, sizeof(phar_archive_data));",
          "new_line_content": "\t/* set up our manifest */",
          "content_same": false
        },
        {
          "line": 1453,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(mydata)",
          "new_text": null,
          "old_line_content": "\t\tefree(mydata);",
          "new_line_content": "\tif (mydata->fname == NULL) {",
          "content_same": false
        },
        {
          "line": 3502,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(cached_fp)",
          "new_text": null,
          "old_line_content": "\t\tif (PHAR_G(cached_fp)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1456,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(mydata->fname)",
          "new_text": null,
          "old_line_content": "\tfname_len = strlen(mydata->fname);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1458,
          "old_api": "phar_unixify_path_separators",
          "new_api": null,
          "old_text": "phar_unixify_path_separators(mydata->fname, fname_len)",
          "new_text": null,
          "old_line_content": "\tphar_unixify_path_separators(mydata->fname, fname_len);",
          "new_line_content": "#ifdef PHP_WIN32",
          "content_same": false
        },
        {
          "line": 3507,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(cached_fp)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (PHAR_G(cached_fp)[i].ufp) {",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 1460,
          "old_api": "strrchr",
          "new_api": null,
          "old_text": "strrchr(mydata->fname, '/')",
          "new_text": null,
          "old_line_content": "\tp = strrchr(mydata->fname, '/');",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 3510,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(cached_fp)",
          "new_text": null,
          "old_line_content": "\t\t\t\tefree(PHAR_G(cached_fp)[i].manifest);",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 1463,
          "old_api": "memchr",
          "new_api": null,
          "old_text": "memchr(p, '.', (mydata->fname + fname_len) - p)",
          "new_text": null,
          "old_line_content": "\t\tmydata->ext = memchr(p, '.', (mydata->fname + fname_len) - p);",
          "new_line_content": "\tif (p) {",
          "content_same": false
        },
        {
          "line": 3512,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(cached_fp)",
          "new_text": null,
          "old_line_content": "\t\t\tefree(PHAR_G(cached_fp));",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 1465,
          "old_api": "memchr",
          "new_api": null,
          "old_text": "memchr(p + 1, '.', (mydata->fname + fname_len) - p - 1)",
          "new_text": null,
          "old_line_content": "\t\t\tmydata->ext = memchr(p + 1, '.', (mydata->fname + fname_len) - p - 1);",
          "new_line_content": "\t\tif (mydata->ext == p) {",
          "content_same": false
        },
        {
          "line": 3516,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(request_init)",
          "new_text": null,
          "old_line_content": "\t\tPHAR_G(request_init) = 0;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3518,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(cwd)",
          "new_text": null,
          "old_line_content": "\t\tif (PHAR_G(cwd)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3522,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(cwd)",
          "new_text": null,
          "old_line_content": "\t\tPHAR_G(cwd) = NULL;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1476,
          "old_api": "zend_hash_init",
          "new_api": null,
          "old_text": "zend_hash_init(&mydata->manifest, sizeof(phar_entry_info),\n\t\tzend_get_hash_value, destroy_phar_manifest_entry, 0)",
          "new_text": null,
          "old_line_content": "\tzend_hash_init(&mydata->manifest, sizeof(phar_entry_info),",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1478,
          "old_api": "zend_hash_init",
          "new_api": null,
          "old_text": "zend_hash_init(&mydata->mounted_dirs, sizeof(char *),\n\t\tzend_get_hash_value, NULL, 0)",
          "new_text": null,
          "old_line_content": "\tzend_hash_init(&mydata->mounted_dirs, sizeof(char *),",
          "new_line_content": "\t\tzend_get_hash_value, destroy_phar_manifest_entry, 0);",
          "content_same": false
        },
        {
          "line": 3527,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(request_done)",
          "new_text": null,
          "old_line_content": "\tPHAR_G(request_done) = 1;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1480,
          "old_api": "zend_hash_init",
          "new_api": null,
          "old_text": "zend_hash_init(&mydata->virtual_dirs, sizeof(char *),\n\t\tzend_get_hash_value, NULL, (bool)mydata->is_persistent)",
          "new_text": null,
          "old_line_content": "\tzend_hash_init(&mydata->virtual_dirs, sizeof(char *),",
          "new_line_content": "\t\tzend_get_hash_value, NULL, 0);",
          "content_same": false
        },
        {
          "line": 1483,
          "old_api": "snprintf",
          "new_api": null,
          "old_text": "snprintf(mydata->version, sizeof(mydata->version), \"%s\", PHP_PHAR_API_VERSION)",
          "new_text": null,
          "old_line_content": "\tsnprintf(mydata->version, sizeof(mydata->version), \"%s\", PHP_PHAR_API_VERSION);",
          "new_line_content": "\tmydata->fname_len = fname_len;",
          "content_same": false
        },
        {
          "line": 3534,
          "old_api": "phar_request_initialize",
          "new_api": null,
          "old_text": "phar_request_initialize()",
          "new_text": null,
          "old_line_content": "\tphar_request_initialize();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1488,
          "old_api": "phar_request_initialize",
          "new_api": null,
          "old_text": "phar_request_initialize()",
          "new_text": null,
          "old_line_content": "\tphar_request_initialize();",
          "new_line_content": "\tmydata->is_brandnew = 1;",
          "content_same": false
        },
        {
          "line": 3542,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(has_zlib)",
          "new_text": null,
          "old_line_content": "\tif (PHAR_G(has_zlib)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3545,
          "old_api": "php_info_print_table_row",
          "new_api": null,
          "old_text": "php_info_print_table_row(2, \"gzip compression\", \"disabled (install ext/zlib)\")",
          "new_text": null,
          "old_line_content": "\t\tphp_info_print_table_row(2, \"gzip compression\", \"disabled (install ext/zlib)\");",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 1500,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(phar_alias_map)",
          "new_text": null,
          "old_line_content": "\t\tif (alias && NULL != (fd_ptr = zend_hash_str_find_ptr(&(PHAR_G(phar_alias_map)), alias, alias_len))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3548,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(has_bz2)",
          "new_text": null,
          "old_line_content": "\tif (PHAR_G(has_bz2)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1503,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 4096, \"phar error: phar \\\"%s\\\" cannot set alias \\\"%s\\\", already in use by another phar archive\", mydata->fname, alias)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tspprintf(error, 4096, \"phar error: phar \\\"%s\\\" cannot set alias \\\"%s\\\", already in use by another phar archive\", mydata->fname, alias);",
          "new_line_content": "\t\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 3551,
          "old_api": "php_info_print_table_row",
          "new_api": null,
          "old_text": "php_info_print_table_row(2, \"bzip2 compression\", \"disabled (install ext/bz2)\")",
          "new_text": null,
          "old_line_content": "\t\tphp_info_print_table_row(2, \"bzip2 compression\", \"disabled (install ext/bz2)\");",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 1506,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(phar_fname_map)",
          "new_text": null,
          "old_line_content": "\t\t\t\tzend_hash_str_del(&(PHAR_G(phar_fname_map)), mydata->fname, fname_len);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3554,
          "old_api": "php_info_print_table_row",
          "new_api": null,
          "old_text": "php_info_print_table_row(2, \"Native OpenSSL support\", \"enabled\")",
          "new_text": null,
          "old_line_content": "\tphp_info_print_table_row(2, \"Native OpenSSL support\", \"enabled\");",
          "new_line_content": "#ifdef PHAR_HAVE_OPENSSL",
          "content_same": false
        },
        {
          "line": 3556,
          "old_api": "zend_hash_str_exists",
          "new_api": null,
          "old_text": "zend_hash_str_exists(&module_registry, \"openssl\", sizeof(\"openssl\")-1)",
          "new_text": null,
          "old_line_content": "\tif (zend_hash_str_exists(&module_registry, \"openssl\", sizeof(\"openssl\")-1)) {",
          "new_line_content": "#else",
          "content_same": false
        },
        {
          "line": 3559,
          "old_api": "php_info_print_table_row",
          "new_api": null,
          "old_text": "php_info_print_table_row(2, \"OpenSSL support\", \"disabled (install ext/openssl)\")",
          "new_text": null,
          "old_line_content": "\t\tphp_info_print_table_row(2, \"OpenSSL support\", \"disabled (install ext/openssl)\");",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 3562,
          "old_api": "php_info_print_table_end",
          "new_api": null,
          "old_text": "php_info_print_table_end()",
          "new_text": null,
          "old_line_content": "\tphp_info_print_table_end();",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 1516,
          "old_api": "ZEND_ASSERT",
          "new_api": null,
          "old_text": "ZEND_ASSERT(!mydata->is_persistent)",
          "new_text": null,
          "old_line_content": "\t\tZEND_ASSERT(!mydata->is_persistent);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3564,
          "old_api": "php_info_print_box_start",
          "new_api": null,
          "old_text": "php_info_print_box_start(0)",
          "new_text": null,
          "old_line_content": "\tphp_info_print_box_start(0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1522,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(phar_alias_map)",
          "new_text": null,
          "old_line_content": "\t\tif (NULL == zend_hash_str_add_ptr(&(PHAR_G(phar_alias_map)), alias, alias_len, mydata)) {",
          "new_line_content": "\tif (alias_len && alias) {",
          "content_same": false
        },
        {
          "line": 3572,
          "old_api": "DISPLAY_INI_ENTRIES",
          "new_api": null,
          "old_text": "DISPLAY_INI_ENTRIES()",
          "new_text": null,
          "old_line_content": "\tDISPLAY_INI_ENTRIES();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1525,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"archive \\\"%s\\\" cannot be associated with alias \\\"%s\\\", already in use\", fname, alias)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tspprintf(error, 0, \"archive \\\"%s\\\" cannot be associated with alias \\\"%s\\\", already in use\", fname, alias);",
          "new_line_content": "\t\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 1529,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(phar_fname_map)",
          "new_text": null,
          "old_line_content": "\t\t\tzend_hash_str_del(&(PHAR_G(phar_fname_map)), mydata->fname, fname_len);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3593,
          "old_api": "PHP_MINIT",
          "new_api": null,
          "old_text": "PHP_MINIT(phar)",
          "new_text": null,
          "old_line_content": "\tPHP_MINIT(phar),",
          "new_line_content": "\tNULL,",
          "content_same": false
        },
        {
          "line": 3596,
          "old_api": "PHP_RSHUTDOWN",
          "new_api": null,
          "old_text": "PHP_RSHUTDOWN(phar)",
          "new_text": null,
          "old_line_content": "\tPHP_RSHUTDOWN(phar),",
          "new_line_content": "\tNULL,",
          "content_same": false
        },
        {
          "line": 3599,
          "old_api": "PHP_MODULE_GLOBALS",
          "new_api": null,
          "old_text": "PHP_MODULE_GLOBALS(phar)",
          "new_text": null,
          "old_line_content": "\tPHP_MODULE_GLOBALS(phar),   /* globals descriptor */",
          "new_line_content": "\tPHP_PHAR_VERSION,",
          "content_same": false
        },
        {
          "line": 1560,
          "old_api": "strstr",
          "new_api": null,
          "old_text": "strstr(fname, \".phar\")",
          "new_text": null,
          "old_line_content": "\tif (!strstr(fname, \".phar\")) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1564,
          "old_api": "phar_open_parsed_phar",
          "new_api": null,
          "old_text": "phar_open_parsed_phar(fname, fname_len, alias, alias_len, is_data, options, pphar, error)",
          "new_text": null,
          "old_line_content": "\tif (phar_open_parsed_phar(fname, fname_len, alias, alias_len, is_data, options, pphar, error) == SUCCESS) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1569,
          "old_api": "php_check_open_basedir",
          "new_api": null,
          "old_text": "php_check_open_basedir(fname)",
          "new_text": null,
          "old_line_content": "\tif (php_check_open_basedir(fname)) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1573,
          "old_api": "php_stream_open_wrapper",
          "new_api": null,
          "old_text": "php_stream_open_wrapper(fname, \"rb\", IGNORE_URL|STREAM_MUST_SEEK, &actual)",
          "new_text": null,
          "old_line_content": "\tfp = php_stream_open_wrapper(fname, \"rb\", IGNORE_URL|STREAM_MUST_SEEK, &actual);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1578,
          "old_api": "spprintf",
          "new_api": null,
          "old_text": "spprintf(error, 0, \"unable to open phar for reading \\\"%s\\\"\", fname)",
          "new_text": null,
          "old_line_content": "\t\t\t\tspprintf(error, 0, \"unable to open phar for reading \\\"%s\\\"\", fname);",
          "new_line_content": "\t\t\tif (error) {",
          "content_same": false
        },
        {
          "line": 1582,
          "old_api": "zend_string_release_ex",
          "new_api": null,
          "old_text": "zend_string_release_ex(actual, 0)",
          "new_text": null,
          "old_line_content": "\t\t\tzend_string_release_ex(actual, 0);",
          "new_line_content": "\t\tif (actual) {",
          "content_same": false
        },
        {
          "line": 1588,
          "old_api": "ZSTR_VAL",
          "new_api": null,
          "old_text": "ZSTR_VAL(actual)",
          "new_text": null,
          "old_line_content": "\t\tfname = ZSTR_VAL(actual);",
          "new_line_content": "\tif (actual) {",
          "content_same": false
        },
        {
          "line": 1592,
          "old_api": "phar_open_from_fp",
          "new_api": null,
          "old_text": "phar_open_from_fp(fp, fname, fname_len, alias, alias_len, options, pphar, error)",
          "new_text": null,
          "old_line_content": "\tzend_result ret = phar_open_from_fp(fp, fname, fname_len, alias, alias_len, options, pphar, error);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1595,
          "old_api": "zend_string_release_ex",
          "new_api": null,
          "old_text": "zend_string_release_ex(actual, 0)",
          "new_text": null,
          "old_line_content": "\t\tzend_string_release_ex(actual, 0);",
          "new_line_content": "\tif (actual) {",
          "content_same": false
        },
        {
          "line": 1614,
          "old_api": "memchr",
          "new_api": null,
          "old_text": "memchr(c + 1, search[0], buf_len - search_len - so_far)",
          "new_text": null,
          "old_line_content": "\t\tif (!(c = memchr(c + 1, search[0], buf_len - search_len - so_far))) {",
          "new_line_content": "\tdo {",
          "content_same": false
        },
        {
          "line": 1624,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(c, search, search_len)",
          "new_text": null,
          "old_line_content": "\t\tif (!memcmp(c, search, search_len)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1656,
          "old_api": "php_stream_rewind",
          "new_api": null,
          "old_text": "php_stream_rewind(fp)",
          "new_text": null,
          "old_line_content": "\tif (-1 == php_stream_rewind(fp)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1661,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(buffer, 32, sizeof(token))",
          "new_text": null,
          "old_line_content": "\tmemset(buffer, 32, sizeof(token));",
          "new_line_content": "\tbuffer[sizeof(buffer)-1] = '\\0';",
          "content_same": false
        },
        {
          "line": 1666,
          "old_api": "php_stream_eof",
          "new_api": null,
          "old_text": "php_stream_eof(fp)",
          "new_text": null,
          "old_line_content": "\twhile(!php_stream_eof(fp)) {",
          "new_line_content": "\t/* but we only want the offset. So we want a .re scanner to find it. */",
          "content_same": false
        },
        {
          "line": 1674,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(pos, gz_magic, 3)",
          "new_text": null,
          "old_line_content": "\t\t\tif (!memcmp(pos, gz_magic, 3)) {",
          "new_line_content": "\t\t\tpos = buffer+tokenlen;",
          "content_same": false
        },
        {
          "line": 1681,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(has_zlib)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (!PHAR_G(has_zlib)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1684,
          "old_api": "array_init",
          "new_api": null,
          "old_text": "array_init(&filterparams)",
          "new_text": null,
          "old_line_content": "\t\t\t\tarray_init(&filterparams);",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 1689,
          "old_api": "add_assoc_long_ex",
          "new_api": null,
          "old_text": "add_assoc_long_ex(&filterparams, \"window\", sizeof(\"window\") - 1, MAX_WBITS + 32)",
          "new_text": null,
          "old_line_content": "\t\t\t\tadd_assoc_long_ex(&filterparams, \"window\", sizeof(\"window\") - 1, MAX_WBITS + 32);",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 1692,
          "old_api": "php_stream_fopen_tmpfile",
          "new_api": null,
          "old_text": "php_stream_fopen_tmpfile()",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (!(temp = php_stream_fopen_tmpfile())) {",
          "new_line_content": "\t\t\t\t/* entire file is gzip-compressed, uncompress to temporary file */",
          "content_same": false
        },
        {
          "line": 1696,
          "old_api": "php_stream_rewind",
          "new_api": null,
          "old_text": "php_stream_rewind(fp)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_rewind(fp);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1701,
          "old_api": "add_assoc_long_ex",
          "new_api": null,
          "old_text": "add_assoc_long_ex(&filterparams, \"window\", sizeof(\"window\") - 1, MAX_WBITS)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tadd_assoc_long_ex(&filterparams, \"window\", sizeof(\"window\") - 1, MAX_WBITS);",
          "new_line_content": "\t\t\t\t\terr = 1;",
          "content_same": false
        },
        {
          "line": 1706,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(temp)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tphp_stream_close(temp);",
          "new_line_content": "\t\t\t\t\tif (!filter) {",
          "content_same": false
        },
        {
          "line": 1710,
          "old_api": "Z_ARR",
          "new_api": null,
          "old_text": "Z_ARR(filterparams)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tzend_array_destroy(Z_ARR(filterparams));",
          "new_line_content": "\t\t\t\t} else {",
          "content_same": false
        },
        {
          "line": 1713,
          "old_api": "php_stream_filter_append",
          "new_api": null,
          "old_text": "php_stream_filter_append(&temp->writefilters, filter)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_filter_append(&temp->writefilters, filter);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1715,
          "old_api": "php_stream_copy_to_stream_ex",
          "new_api": null,
          "old_text": "php_stream_copy_to_stream_ex(fp, temp, PHP_STREAM_COPY_ALL, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (SUCCESS != php_stream_copy_to_stream_ex(fp, temp, PHP_STREAM_COPY_ALL, NULL)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1717,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(temp)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tphp_stream_close(temp);",
          "new_line_content": "\t\t\t\t\tif (err) {",
          "content_same": false
        },
        {
          "line": 1720,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(temp)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tphp_stream_close(temp);",
          "new_line_content": "\t\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 1724,
          "old_api": "php_stream_filter_flush",
          "new_api": null,
          "old_text": "php_stream_filter_flush(filter, 1)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_filter_flush(filter, 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1728,
          "old_api": "php_stream_rewind",
          "new_api": null,
          "old_text": "php_stream_rewind(fp)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_rewind(fp);",
          "new_line_content": "\t\t\t\tfp = temp;",
          "content_same": false
        },
        {
          "line": 1734,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": null,
          "old_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\"\")",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress gzipped phar archive \\\"%s\\\"\");",
          "new_line_content": "\t\t\t\tif (!--recursion_count) {",
          "content_same": false
        },
        {
          "line": 1738,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(pos, bz_magic, 3)",
          "new_text": null,
          "old_line_content": "\t\t\t} else if (!memcmp(pos, bz_magic, 3)) {",
          "new_line_content": "\t\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 1742,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(has_bz2)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (!PHAR_G(has_bz2)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1747,
          "old_api": "php_stream_fopen_tmpfile",
          "new_api": null,
          "old_text": "php_stream_fopen_tmpfile()",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (!(temp = php_stream_fopen_tmpfile())) {",
          "new_line_content": "\t\t\t\t/* entire file is bzip-compressed, uncompress to temporary file */",
          "content_same": false
        },
        {
          "line": 1751,
          "old_api": "php_stream_rewind",
          "new_api": null,
          "old_text": "php_stream_rewind(fp)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_rewind(fp);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1755,
          "old_api": "php_stream_close",
          "new_api": null,
          "old_text": "php_stream_close(temp)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tphp_stream_close(temp);",
          "new_line_content": "\t\t\t\tif (!filter) {",
          "content_same": false
        },
        {
          "line": 1759,
          "old_api": "php_stream_filter_append",
          "new_api": null,
          "old_text": "php_stream_filter_append(&temp->writefilters, filter)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_filter_append(&temp->writefilters, filter);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1761,
          "old_api": "php_stream_copy_to_stream_ex",
          "new_api": null,
          "old_text": "php_stream_copy_to_stream_ex(fp, temp, PHP_STREAM_COPY_ALL, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (SUCCESS != php_stream_copy_to_stream_ex(fp, temp, PHP_STREAM_COPY_ALL, NULL)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1766,
          "old_api": "php_stream_filter_flush",
          "new_api": null,
          "old_text": "php_stream_filter_flush(filter, 1)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_filter_flush(filter, 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1770,
          "old_api": "php_stream_rewind",
          "new_api": null,
          "old_text": "php_stream_rewind(fp)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphp_stream_rewind(fp);",
          "new_line_content": "\t\t\t\tfp = temp;",
          "content_same": false
        },
        {
          "line": 1776,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": null,
          "old_text": "MAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\"\")",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tMAPPHAR_ALLOC_FAIL(\"unable to decompress bzipped phar archive \\\"%s\\\"\");",
          "new_line_content": "\t\t\t\tif (!--recursion_count) {",
          "content_same": false
        },
        {
          "line": 1782,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(pos, zip_magic, 4)",
          "new_text": null,
          "old_line_content": "\t\t\tif (!memcmp(pos, zip_magic, 4)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1788,
          "old_api": "phar_is_tar",
          "new_api": null,
          "old_text": "phar_is_tar(pos, fname)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (phar_is_tar(pos, fname)) {",
          "new_line_content": "\t\t\tif (got >= 512) {",
          "content_same": false
        },
        {
          "line": 1795,
          "old_api": "phar_strnstr",
          "new_api": null,
          "old_text": "phar_strnstr(buffer, got + sizeof(token), token, sizeof(token)-1)",
          "new_text": null,
          "old_line_content": "\t\tif (got > 0 && (pos = phar_strnstr(buffer, got + sizeof(token), token, sizeof(token)-1)) != NULL) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1797,
          "old_api": "phar_parse_pharfile",
          "new_api": null,
          "old_text": "phar_parse_pharfile(fp, fname, fname_len, alias, alias_len, halt_offset, pphar, compression, error)",
          "new_text": null,
          "old_line_content": "\t\t\treturn phar_parse_pharfile(fp, fname, fname_len, alias, alias_len, halt_offset, pphar, compression, error);",
          "new_line_content": "\t\t\thalt_offset += (pos - buffer); /* no -tokenlen+tokenlen here */",
          "content_same": false
        },
        {
          "line": 1801,
          "old_api": "memmove",
          "new_api": null,
          "old_text": "memmove(buffer, buffer + window_size, tokenlen)",
          "new_text": null,
          "old_line_content": "\t\tmemmove(buffer, buffer + window_size, tokenlen); /* move the memory buffer by the size of the window */",
          "new_line_content": "\t\thalt_offset += got;",
          "content_same": false
        },
        {
          "line": 1804,
          "old_api": "MAPPHAR_ALLOC_FAIL",
          "new_api": null,
          "old_text": "MAPPHAR_ALLOC_FAIL(\"internal corruption of phar \\\"%s\\\" (__HALT_COMPILER(); not found)\")",
          "new_text": null,
          "old_line_content": "\tMAPPHAR_ALLOC_FAIL(\"internal corruption of phar \\\"%s\\\" (__HALT_COMPILER(); not found)\")",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1821,
          "old_api": "estrndup",
          "new_api": null,
          "old_text": "estrndup(fname, (ext - fname) + ext_len)",
          "new_text": null,
          "old_line_content": "\tchar *filename = estrndup(fname, (ext - fname) + ext_len);",
          "new_line_content": "\tchar *realpath;",
          "content_same": false
        },
        {
          "line": 1823,
          "old_api": "expand_filepath",
          "new_api": null,
          "old_text": "expand_filepath(filename, NULL)",
          "new_text": null,
          "old_line_content": "\tif ((realpath = expand_filepath(filename, NULL))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1825,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(realpath)",
          "new_text": null,
          "old_line_content": "\t\tphar_unixify_path_separators(realpath, strlen(realpath));",
          "new_line_content": "#ifdef PHP_WIN32",
          "content_same": false
        },
        {
          "line": 1827,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(realpath)",
          "new_text": null,
          "old_line_content": "\t\tif (zend_hash_str_exists(&(PHAR_G(phar_fname_map)), realpath, strlen(realpath))) {",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 1833,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(realpath)",
          "new_text": null,
          "old_line_content": "\t\tif (PHAR_G(manifest_cached) && zend_hash_str_exists(&cached_phars, realpath, strlen(realpath))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1838,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(realpath)",
          "new_text": null,
          "old_line_content": "\t\tefree(realpath);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 1841,
          "old_api": "php_stream_stat_path",
          "new_api": null,
          "old_text": "php_stream_stat_path((char *) filename, &ssb)",
          "new_text": null,
          "old_line_content": "\tif (SUCCESS == php_stream_stat_path((char *) filename, &ssb)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1843,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(filename)",
          "new_text": null,
          "old_line_content": "\t\tefree(filename);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1858,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(filename)",
          "new_text": null,
          "old_line_content": "\t\t\tefree(filename);",
          "new_line_content": "\t\tif (!for_create) {",
          "content_same": false
        },
        {
          "line": 1862,
          "old_api": "strrchr",
          "new_api": null,
          "old_text": "strrchr(filename, '/')",
          "new_text": null,
          "old_line_content": "\t\tslash = (char *) strrchr(filename, '/');",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1868,
          "old_api": "php_stream_stat_path",
          "new_api": null,
          "old_text": "php_stream_stat_path((char *) filename, &ssb)",
          "new_text": null,
          "old_line_content": "\t\tif (SUCCESS != php_stream_stat_path((char *) filename, &ssb)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1870,
          "old_api": "expand_filepath",
          "new_api": null,
          "old_text": "expand_filepath(filename, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (!(realpath = expand_filepath(filename, NULL))) {",
          "new_line_content": "\t\t\tif (!slash) {",
          "content_same": false
        },
        {
          "line": 1875,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(realpath)",
          "new_text": null,
          "old_line_content": "\t\t\t\tphar_unixify_path_separators(realpath, strlen(realpath));",
          "new_line_content": "#ifdef PHP_WIN32",
          "content_same": false
        },
        {
          "line": 1877,
          "old_api": "strstr",
          "new_api": null,
          "old_text": "strstr(realpath, filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\tslash = strstr(realpath, filename);",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 1882,
          "old_api": "strrchr",
          "new_api": null,
          "old_text": "strrchr(realpath, '/')",
          "new_text": null,
          "old_line_content": "\t\t\t\tslash = strrchr(realpath, '/');",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 1887,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(realpath)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tefree(realpath);",
          "new_line_content": "\t\t\t\t} else {",
          "content_same": false
        },
        {
          "line": 1892,
          "old_api": "php_stream_stat_path",
          "new_api": null,
          "old_text": "php_stream_stat_path(realpath, &ssb)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (SUCCESS != php_stream_stat_path(realpath, &ssb)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1898,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(realpath)",
          "new_text": null,
          "old_line_content": "\t\t\t\tefree(realpath);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1901,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(filename)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tefree(filename);",
          "new_line_content": "\t\t\t\tif (ssb.sb.st_mode & S_IFDIR) {",
          "content_same": false
        },
        {
          "line": 1906,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(filename)",
          "new_text": null,
          "old_line_content": "\t\t\tefree(filename);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1910,
          "old_api": "efree",
          "new_api": null,
          "old_text": "efree(filename)",
          "new_text": null,
          "old_line_content": "\t\tefree(filename);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1932,
          "old_api": "strstr",
          "new_api": null,
          "old_text": "strstr(ext_str, \".phar\")",
          "new_text": null,
          "old_line_content": "\t\tpos = strstr(ext_str, \".phar\");",
          "new_line_content": "\t\t/* (phar://hi/there/.phar/oops is also invalid) */",
          "content_same": false
        },
        {
          "line": 1941,
          "old_api": "phar_analyze_path",
          "new_api": null,
          "old_text": "phar_analyze_path(fname, ext_str, ext_len, for_create)",
          "new_text": null,
          "old_line_content": "\t\treturn phar_analyze_path(fname, ext_str, ext_len, for_create);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 1946,
          "old_api": "strstr",
          "new_api": null,
          "old_text": "strstr(ext_str, \".phar\")",
          "new_text": null,
          "old_line_content": "\t\tpos = strstr(ext_str, \".phar\");",
          "new_line_content": "\tif (!executable) {",
          "content_same": false
        },
        {
          "line": 1949,
          "old_api": "phar_analyze_path",
          "new_api": null,
          "old_text": "phar_analyze_path(fname, ext_str, ext_len, for_create)",
          "new_text": null,
          "old_line_content": "\t\t\treturn phar_analyze_path(fname, ext_str, ext_len, for_create);",
          "new_line_content": "\t\t\t\t\t&& (pos += 5) && (*pos == '\\0' || *pos == '/' || *pos == '.')) && *(ext_str + 1) != '.' && *(ext_str + 1) != '/' && *(ext_str + 1) != '\\0') {",
          "content_same": false
        },
        {
          "line": 1953,
          "old_api": "phar_analyze_path",
          "new_api": null,
          "old_text": "phar_analyze_path(fname, ext_str, ext_len, for_create)",
          "new_text": null,
          "old_line_content": "\t\t\treturn phar_analyze_path(fname, ext_str, ext_len, for_create);",
          "new_line_content": "\t\tif (*(ext_str + 1) != '.' && *(ext_str + 1) != '/' && *(ext_str + 1) != '\\0') {",
          "content_same": false
        },
        {
          "line": 1985,
          "old_api": "phar_request_initialize",
          "new_api": null,
          "old_text": "phar_request_initialize()",
          "new_text": null,
          "old_line_content": "\tphar_request_initialize();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1987,
          "old_api": "memchr",
          "new_api": null,
          "old_text": "memchr(filename, '/', filename_len)",
          "new_text": null,
          "old_line_content": "\tpos = memchr(filename, '/', filename_len);",
          "new_line_content": "\t/* first check for alias in first segment */",
          "content_same": false
        },
        {
          "line": 1996,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(phar_alias_map)",
          "new_text": null,
          "old_line_content": "\t\tif (zend_hash_str_exists(&(PHAR_G(phar_alias_map)), (char *) filename, pos - filename)) {",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 2002,
          "old_api": "zend_hash_str_exists",
          "new_api": null,
          "old_text": "zend_hash_str_exists(&cached_alias, (char *) filename, pos - filename)",
          "new_text": null,
          "old_line_content": "\t\tif (PHAR_G(manifest_cached) && zend_hash_str_exists(&cached_alias, (char *) filename, pos - filename)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2009,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(manifest_cached)",
          "new_text": null,
          "old_line_content": "\tif (zend_hash_num_elements(&(PHAR_G(phar_fname_map))) || PHAR_G(manifest_cached)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2013,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(phar_fname_map)",
          "new_text": null,
          "old_line_content": "\t\t\tif (NULL != (pphar = zend_hash_str_find_ptr(&(PHAR_G(phar_fname_map)), (char *) filename, filename_len))) {",
          "new_line_content": "\t\tif (is_complete) {",
          "content_same": false
        },
        {
          "line": 2033,
          "old_api": "zend_hash_str_find_ptr",
          "new_api": null,
          "old_text": "zend_hash_str_find_ptr(&cached_phars, (char *) filename, filename_len)",
          "new_text": null,
          "old_line_content": "\t\t\tif (PHAR_G(manifest_cached) && NULL != (pphar = zend_hash_str_find_ptr(&cached_phars, (char *) filename, filename_len))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2040,
          "old_api": "PHAR_G",
          "new_api": null,
          "old_text": "PHAR_G(phar_fname_map)",
          "new_text": null,
          "old_line_content": "\t\t\tZEND_HASH_MAP_FOREACH_STR_KEY_PTR(&PHAR_G(phar_fname_map), str_key, pphar) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2045,
          "old_api": "ZSTR_LEN",
          "new_api": null,
          "old_text": "ZSTR_LEN(str_key)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (!memcmp(filename, ZSTR_VAL(str_key), ZSTR_LEN(str_key)) && (filename_len == ZSTR_LEN(str_key)",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 126,
      "total_additions": 418,
      "total_deletions": 419,
      "total_api_changes": 963
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 6,
        "api_related_lines": 963,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          1232,
          1235,
          1240,
          1239
        ]
      }
    },
    "api_calls_before": 1123,
    "api_calls_after": 1120,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 3,
      "total_diff_lines": 24
    }
  }
}