{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/1af91d944aabad42014c0e34cbf54e89a87590b1",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/1af91d944aabad42014c0e34cbf54e89a87590b1/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/1af91d944aabad42014c0e34cbf54e89a87590b1/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/1af91d944aabad42014c0e34cbf54e89a87590b1/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 190,
          "old_api": "swp",
          "new_api": "cmp",
          "old_text": "swp(k, k - siz)",
          "new_text": "cmp(j, i)",
          "old_line_content": "\t\t\t\t\t\tswp(k, k - siz);",
          "new_line_content": "\t\t\t\t\t\tif (cmp(j, i) <= 0) {",
          "content_same": false
        },
        {
          "line": 321,
          "old_api": "Z_L",
          "new_api": "zend_insert_sort",
          "old_text": "Z_L(1)",
          "new_text": "zend_insert_sort(base, nmemb, siz, cmp, swp)",
          "old_line_content": "\t\t\tsize_t offset = (nmemb >> Z_L(1));",
          "new_line_content": "\t\t\tzend_insert_sort(base, nmemb, siz, cmp, swp);",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": "swp",
          "new_api": "Z_L",
          "old_text": "swp(start + siz, pivot)",
          "new_text": "Z_L(10)",
          "old_line_content": "\t\t\tswp(start + siz, pivot);",
          "new_line_content": "\t\t\tif ((nmemb >> Z_L(10))) {",
          "content_same": false
        },
        {
          "line": 351,
          "old_api": "swp",
          "new_api": "cmp",
          "old_text": "swp(i, j)",
          "new_text": "cmp(pivot, j)",
          "old_line_content": "\t\t\t\tswp(i, j);",
          "new_line_content": "\t\t\t\twhile (cmp(pivot, j) < 0) {",
          "content_same": false
        },
        {
          "line": 364,
          "old_api": "zend_sort",
          "new_api": "swp",
          "old_text": "zend_sort(i, (end - i)/siz, siz, cmp, swp)",
          "new_text": "swp(pivot, i - siz)",
          "old_line_content": "\t\t\t\tzend_sort(i, (end - i)/siz, siz, cmp, swp);",
          "new_line_content": "\t\t\tswp(pivot, i - siz);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 168,
          "old_api": null,
          "new_api": "zend_sort_4",
          "old_text": null,
          "new_text": "zend_sort_4(base, (char *)base + siz, (char *)base + siz2, (char *)base + siz + siz2, cmp, swp)",
          "old_line_content": "\t\tcase 5:",
          "new_line_content": "\t\t\t\tzend_sort_4(base, (char *)base + siz, (char *)base + siz2, (char *)base + siz + siz2, cmp, swp);",
          "content_same": false
        },
        {
          "line": 174,
          "old_api": null,
          "new_api": "zend_sort_5",
          "old_text": null,
          "new_text": "zend_sort_5(base, (char *)base + siz, (char *)base + siz2, (char *)base + siz + siz2, (char *)base + siz2 + siz2, cmp, swp)",
          "old_line_content": "\t\t\t\tchar *start = (char *)base;",
          "new_line_content": "\t\t\t\tzend_sort_5(base, (char *)base + siz, (char *)base + siz2, (char *)base + siz + siz2, (char *)base + siz2 + siz2, cmp, swp);",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": null,
          "new_api": "cmp",
          "old_text": null,
          "new_text": "cmp(j, i)",
          "old_line_content": "\t\t\t\t\t\t\tj += siz;",
          "new_line_content": "\t\t\t\t\tif (cmp(j, i) <= 0) {",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": null,
          "new_api": "swp",
          "old_text": null,
          "new_text": "swp(k, k - siz)",
          "old_line_content": "\t\t\t\t\t\tcontinue;",
          "new_line_content": "\t\t\t\t\t\tswp(k, k - siz);",
          "content_same": false
        },
        {
          "line": 327,
          "old_api": null,
          "new_api": "Z_L",
          "old_text": null,
          "new_text": "Z_L(1)",
          "old_line_content": "\t\t\t} else {",
          "new_line_content": "\t\t\tsize_t offset = (nmemb >> Z_L(1));",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": null,
          "new_api": "cmp",
          "old_text": null,
          "new_text": "cmp(j, i)",
          "old_line_content": "\t\t\t\t\t\t\tj += siz;",
          "new_line_content": "\t\t\t\t\tif (cmp(j, i) <= 0) {",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": null,
          "new_api": "Z_L",
          "old_text": null,
          "new_text": "Z_L(1)",
          "old_line_content": "\t\t\tpivot = start + siz;",
          "new_line_content": "\t\t\t\tsize_t delta = (offset >> Z_L(1)) * siz;",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": null,
          "new_api": "zend_sort_5",
          "old_text": null,
          "new_text": "zend_sort_5(start, start + delta, pivot, pivot + delta, end - siz, cmp, swp)",
          "old_line_content": "\t\t\ti = pivot + siz;",
          "new_line_content": "\t\t\t\tzend_sort_5(start, start + delta, pivot, pivot + delta, end - siz, cmp, swp);",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": null,
          "new_api": "cmp",
          "old_text": null,
          "new_text": "cmp(j, i)",
          "old_line_content": "\t\t\t\t\t\t}",
          "new_line_content": "\t\t\t\t\t\tif (cmp(j, i) <= 0) {",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": null,
          "new_api": "zend_sort_3",
          "old_text": null,
          "new_text": "zend_sort_3(start, pivot, end - siz, cmp, swp)",
          "old_line_content": "\t\t\twhile (1) {",
          "new_line_content": "\t\t\t\tzend_sort_3(start, pivot, end - siz, cmp, swp);",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": null,
          "new_api": "cmp",
          "old_text": null,
          "new_text": "cmp(j, i)",
          "old_line_content": "\t\t\t\t\t\t\tbreak;",
          "new_line_content": "\t\t\t\t\t\t\tif (cmp(j, i) <= 0) {",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": null,
          "new_api": "swp",
          "old_text": null,
          "new_text": "swp(start + siz, pivot)",
          "old_line_content": "\t\t\t\t\ti += siz;",
          "new_line_content": "\t\t\tswp(start + siz, pivot);",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": null,
          "new_api": "cmp",
          "old_text": null,
          "new_text": "cmp(i, pivot)",
          "old_line_content": "\t\t\t\tj -= siz;",
          "new_line_content": "\t\t\t\twhile (cmp(i, pivot) < 0) {",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": null,
          "new_api": "UNEXPECTED",
          "old_text": null,
          "new_text": "UNEXPECTED(i == j)",
          "old_line_content": "\t\t\t\t\tgoto done;",
          "new_line_content": "\t\t\t\t\tif (UNEXPECTED(i == j)) {",
          "content_same": false
        },
        {
          "line": 218,
          "old_api": null,
          "new_api": "cmp",
          "old_text": null,
          "new_text": "cmp(j, i)",
          "old_line_content": "\t\t\t\t\tfor (k = i; k > j; k -= siz) {",
          "new_line_content": "\t\t\t\t\t\t\tif (cmp(j, i) < 0) {",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": null,
          "new_api": "UNEXPECTED",
          "old_text": null,
          "new_text": "UNEXPECTED(j == i)",
          "old_line_content": "\t\t\t\t\t\tgoto done;",
          "new_line_content": "\t\t\t\tif (UNEXPECTED(j == i)) {",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": null,
          "new_api": "swp",
          "old_text": null,
          "new_text": "swp(k, k - siz)",
          "old_line_content": "}",
          "new_line_content": "\t\t\t\t\t\tswp(k, k - siz);",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": null,
          "new_api": "swp",
          "old_text": null,
          "new_text": "swp(i, j)",
          "old_line_content": "done:",
          "new_line_content": "\t\t\t\tswp(i, j);",
          "content_same": false
        },
        {
          "line": 359,
          "old_api": null,
          "new_api": "UNEXPECTED",
          "old_text": null,
          "new_text": "UNEXPECTED(i == j)",
          "old_line_content": "\t\t\tif ((i - siz) - start < end - i) {",
          "new_line_content": "\t\t\t\tif (UNEXPECTED(i == j)) {",
          "content_same": false
        },
        {
          "line": 366,
          "old_api": null,
          "new_api": "zend_sort",
          "old_text": null,
          "new_text": "zend_sort(start, (i - start)/siz - 1, siz, cmp, swp)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tzend_sort(start, (i - start)/siz - 1, siz, cmp, swp);",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": null,
          "new_api": "zend_sort",
          "old_text": null,
          "new_text": "zend_sort(i, (end - i)/siz, siz, cmp, swp)",
          "old_line_content": "/* }}} */",
          "new_line_content": "\t\t\t\tzend_sort(i, (end - i)/siz, siz, cmp, swp);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 166,
          "old_api": "zend_sort_4",
          "new_api": null,
          "old_text": "zend_sort_4(base, (char *)base + siz, (char *)base + siz + siz, (char *)base + siz + siz + siz, cmp, swp)",
          "new_text": null,
          "old_line_content": "\t\t\tzend_sort_4(base, (char *)base + siz, (char *)base + siz + siz, (char *)base + siz + siz + siz, cmp, swp);",
          "new_line_content": "\t\t\t{",
          "content_same": false
        },
        {
          "line": 169,
          "old_api": "zend_sort_5",
          "new_api": null,
          "old_text": "zend_sort_5(base, (char *)base + siz, (char *)base + siz + siz, (char *)base + siz + siz + siz, (char *)base + (siz * 4), cmp, swp)",
          "new_text": null,
          "old_line_content": "\t\t\tzend_sort_5(base, (char *)base + siz, (char *)base + siz + siz, (char *)base + siz + siz + siz, (char *)base + (siz * 4), cmp, swp);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": "cmp",
          "new_api": null,
          "old_text": "cmp(j, i)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tif (cmp(j, i) <= 0) {",
          "new_line_content": "\t\t\t\tchar *i, *j, *k;",
          "content_same": false
        },
        {
          "line": 184,
          "old_api": "cmp",
          "new_api": null,
          "old_text": "cmp(j, i)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tif (cmp(j, i) <= 0) {",
          "new_line_content": "\t\t\t\t\tj = i - siz;",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": "zend_insert_sort",
          "new_api": null,
          "old_text": "zend_insert_sort(base, nmemb, siz, cmp, swp)",
          "new_text": null,
          "old_line_content": "\t\t\tzend_insert_sort(base, nmemb, siz, cmp, swp);",
          "new_line_content": " * IN THE SOFTWARE.",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": "cmp",
          "new_api": null,
          "old_text": "cmp(j, i)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tif (cmp(j, i) <= 0) {",
          "new_line_content": "\t\t\t\t\tfor (k = i; k > j; k -= siz) {",
          "content_same": false
        },
        {
          "line": 324,
          "old_api": "Z_L",
          "new_api": null,
          "old_text": "Z_L(10)",
          "new_text": null,
          "old_line_content": "\t\t\tif ((nmemb >> Z_L(10))) {",
          "new_line_content": "\t\t\tchar *i, *j;",
          "content_same": false
        },
        {
          "line": 325,
          "old_api": "Z_L",
          "new_api": null,
          "old_text": "Z_L(1)",
          "new_text": null,
          "old_line_content": "\t\t\t\tsize_t delta = (offset >> Z_L(1)) * siz;",
          "new_line_content": "\t\t\tchar *start = (char *)base;",
          "content_same": false
        },
        {
          "line": 326,
          "old_api": "zend_sort_5",
          "new_api": null,
          "old_text": "zend_sort_5(start, start + delta, pivot, pivot + delta, end - siz, cmp, swp)",
          "new_text": null,
          "old_line_content": "\t\t\t\tzend_sort_5(start, start + delta, pivot, pivot + delta, end - siz, cmp, swp);",
          "new_line_content": "\t\t\tchar *end = start + (nmemb * siz);",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": "cmp",
          "new_api": null,
          "old_text": "cmp(j, i)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tif (cmp(j, i) <= 0) {",
          "new_line_content": "\t\t\t\t\tj = i - siz;",
          "content_same": false
        },
        {
          "line": 328,
          "old_api": "zend_sort_3",
          "new_api": null,
          "old_text": "zend_sort_3(start, pivot, end - siz, cmp, swp)",
          "new_text": null,
          "old_line_content": "\t\t\t\tzend_sort_3(start, pivot, end - siz, cmp, swp);",
          "new_line_content": "\t\t\tchar *pivot = start + (offset * siz);",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": "cmp",
          "new_api": null,
          "old_text": "cmp(j, i)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\tif (cmp(j, i) <= 0) {",
          "new_line_content": "\t\t\t\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": "cmp",
          "new_api": null,
          "old_text": "cmp(i, pivot)",
          "new_text": null,
          "old_line_content": "\t\t\t\twhile (cmp(i, pivot) < 0) {",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": "UNEXPECTED",
          "new_api": null,
          "old_text": "UNEXPECTED(i == j)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tif (UNEXPECTED(i == j)) {",
          "new_line_content": "\t\t\tpivot = start + siz;",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "cmp",
          "new_api": null,
          "old_text": "cmp(j, i)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\tif (cmp(j, i) < 0) {",
          "new_line_content": "\t\t\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": "UNEXPECTED",
          "new_api": null,
          "old_text": "UNEXPECTED(j == i)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (UNEXPECTED(j == i)) {",
          "new_line_content": "\t\t\t\t\ti += siz;",
          "content_same": false
        },
        {
          "line": 345,
          "old_api": "cmp",
          "new_api": null,
          "old_text": "cmp(pivot, j)",
          "new_text": null,
          "old_line_content": "\t\t\t\twhile (cmp(pivot, j) < 0) {",
          "new_line_content": "\t\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": "swp",
          "new_api": null,
          "old_text": "swp(k, k - siz)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tswp(k, k - siz);",
          "new_line_content": "\t\t\t\t\t\t\t\tj += siz;",
          "content_same": false
        },
        {
          "line": 347,
          "old_api": "UNEXPECTED",
          "new_api": null,
          "old_text": "UNEXPECTED(j == i)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tif (UNEXPECTED(j == i)) {",
          "new_line_content": "\t\t\t\tj -= siz;",
          "content_same": false
        },
        {
          "line": 358,
          "old_api": "swp",
          "new_api": null,
          "old_text": "swp(pivot, i - siz)",
          "new_text": null,
          "old_line_content": "\t\t\tswp(pivot, i - siz);",
          "new_line_content": "\t\t\t\ti += siz;",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": "zend_sort",
          "new_api": null,
          "old_text": "zend_sort(start, (i - start)/siz - 1, siz, cmp, swp)",
          "new_text": null,
          "old_line_content": "\t\t\t\tzend_sort(start, (i - start)/siz - 1, siz, cmp, swp);",
          "new_line_content": "\t\t\t\t\tgoto done;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 5,
      "total_additions": 21,
      "total_deletions": 21,
      "total_api_changes": 47
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 8,
        "api_related_lines": 47,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          175,
          172,
          173,
          167
        ]
      }
    },
    "api_calls_before": 69,
    "api_calls_after": 69,
    "diff_info": {
      "added_lines": 8,
      "removed_lines": 2,
      "total_diff_lines": 24
    }
  }
}