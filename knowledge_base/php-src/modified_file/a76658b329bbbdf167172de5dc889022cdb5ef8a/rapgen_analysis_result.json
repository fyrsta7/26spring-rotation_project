{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/a76658b329bbbdf167172de5dc889022cdb5ef8a",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/a76658b329bbbdf167172de5dc889022cdb5ef8a/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/a76658b329bbbdf167172de5dc889022cdb5ef8a/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/a76658b329bbbdf167172de5dc889022cdb5ef8a/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 276,
          "old_api": "MB_CONVERT_BUF_STORE",
          "new_api": "MB_CONVERT_BUF_ENSURE",
          "old_text": "MB_CONVERT_BUF_STORE(buf, out, limit)",
          "new_text": "MB_CONVERT_BUF_ENSURE(buf, out, limit, len)",
          "old_line_content": "\tMB_CONVERT_BUF_STORE(buf, out, limit);",
          "new_line_content": "\t\t\t\tMB_CONVERT_BUF_ENSURE(buf, out, limit, len);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 249,
          "old_api": null,
          "new_api": "MB_CONVERT_BUF_ENSURE",
          "old_text": null,
          "new_text": "MB_CONVERT_BUF_ENSURE(buf, out, limit, len)",
          "old_line_content": "\t\t} else if (w >= ucs_a3_uhc_table_min && w < ucs_a3_uhc_table_max) {",
          "new_line_content": "\tMB_CONVERT_BUF_ENSURE(buf, out, limit, len);",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": null,
          "new_api": "mb_convert_buf_add",
          "old_text": null,
          "new_text": "mb_convert_buf_add(out, 0)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\tout = mb_convert_buf_add(out, 0);",
          "content_same": false
        },
        {
          "line": 275,
          "old_api": null,
          "new_api": "MB_CONVERT_ERROR",
          "old_text": null,
          "new_text": "MB_CONVERT_ERROR(buf, out, limit, w, mb_wchar_to_uhc)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tMB_CONVERT_ERROR(buf, out, limit, w, mb_wchar_to_uhc);",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": null,
          "new_api": "mb_convert_buf_add",
          "old_text": null,
          "new_text": "mb_convert_buf_add(out, s)",
          "old_line_content": "",
          "new_line_content": "\t\t\tout = mb_convert_buf_add(out, s);",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": null,
          "new_api": "MB_CONVERT_BUF_LOAD",
          "old_text": null,
          "new_text": "MB_CONVERT_BUF_LOAD(buf, out, limit)",
          "old_line_content": "\t\t\ts = ucs_a2_uhc_table[w - ucs_a2_uhc_table_min];",
          "new_line_content": "\tMB_CONVERT_BUF_LOAD(buf, out, limit);",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": null,
          "new_api": "MB_CONVERT_BUF_ENSURE",
          "old_text": null,
          "new_text": "MB_CONVERT_BUF_ENSURE(buf, out, limit, len + 2)",
          "old_line_content": "",
          "new_line_content": "\t\t\tMB_CONVERT_BUF_ENSURE(buf, out, limit, len + 2);",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": null,
          "new_api": "mb_convert_buf_add2",
          "old_text": null,
          "new_text": "mb_convert_buf_add2(out, (s >> 8) & 0xFF, s & 0xFF)",
          "old_line_content": "",
          "new_line_content": "\t\t\tout = mb_convert_buf_add2(out, (s >> 8) & 0xFF, s & 0xFF);",
          "content_same": false
        },
        {
          "line": 222,
          "old_api": null,
          "new_api": "ZEND_ASSERT",
          "old_text": null,
          "new_text": "ZEND_ASSERT(w < uhc3_ucs_table_size)",
          "old_line_content": "\t\t\t\tw = MBFL_BAD_INPUT;",
          "new_line_content": "\t\t\t\tZEND_ASSERT(w < uhc3_ucs_table_size);",
          "content_same": false
        },
        {
          "line": 286,
          "old_api": null,
          "new_api": "MB_CONVERT_BUF_STORE",
          "old_text": null,
          "new_text": "MB_CONVERT_BUF_STORE(buf, out, limit)",
          "old_line_content": "",
          "new_line_content": "\tMB_CONVERT_BUF_STORE(buf, out, limit);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 263,
          "old_api": "mb_convert_buf_add",
          "new_api": null,
          "old_text": "mb_convert_buf_add(out, 0)",
          "new_text": null,
          "old_line_content": "\t\t\t\tout = mb_convert_buf_add(out, 0);",
          "new_line_content": "\t\t} else if (w >= ucs_s_uhc_table_min && w < ucs_s_uhc_table_max) {",
          "content_same": false
        },
        {
          "line": 265,
          "old_api": "MB_CONVERT_ERROR",
          "new_api": null,
          "old_text": "MB_CONVERT_ERROR(buf, out, limit, w, mb_wchar_to_uhc)",
          "new_text": null,
          "old_line_content": "\t\t\t\tMB_CONVERT_ERROR(buf, out, limit, w, mb_wchar_to_uhc);",
          "new_line_content": "\t\t} else if (w >= ucs_r1_uhc_table_min && w < ucs_r1_uhc_table_max) {",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": "MB_CONVERT_BUF_ENSURE",
          "new_api": null,
          "old_text": "MB_CONVERT_BUF_ENSURE(buf, out, limit, len)",
          "new_text": null,
          "old_line_content": "\t\t\t\tMB_CONVERT_BUF_ENSURE(buf, out, limit, len);",
          "new_line_content": "\t\t\ts = ucs_r1_uhc_table[w - ucs_r1_uhc_table_min];",
          "content_same": false
        },
        {
          "line": 269,
          "old_api": "mb_convert_buf_add",
          "new_api": null,
          "old_text": "mb_convert_buf_add(out, s)",
          "new_text": null,
          "old_line_content": "\t\t\tout = mb_convert_buf_add(out, s);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": "MB_CONVERT_BUF_LOAD",
          "new_api": null,
          "old_text": "MB_CONVERT_BUF_LOAD(buf, out, limit)",
          "new_text": null,
          "old_line_content": "\tMB_CONVERT_BUF_LOAD(buf, out, limit);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": "MB_CONVERT_BUF_ENSURE",
          "new_api": null,
          "old_text": "MB_CONVERT_BUF_ENSURE(buf, out, limit, len + 2)",
          "new_text": null,
          "old_line_content": "\t\t\tMB_CONVERT_BUF_ENSURE(buf, out, limit, len + 2);",
          "new_line_content": "\t\tif (!s) {",
          "content_same": false
        },
        {
          "line": 272,
          "old_api": "mb_convert_buf_add2",
          "new_api": null,
          "old_text": "mb_convert_buf_add2(out, (s >> 8) & 0xFF, s & 0xFF)",
          "new_text": null,
          "old_line_content": "\t\t\tout = mb_convert_buf_add2(out, (s >> 8) & 0xFF, s & 0xFF);",
          "new_line_content": "\t\t\tif (w == 0) {",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": "MB_CONVERT_BUF_ENSURE",
          "new_api": null,
          "old_text": "MB_CONVERT_BUF_ENSURE(buf, out, limit, len)",
          "new_text": null,
          "old_line_content": "\tMB_CONVERT_BUF_ENSURE(buf, out, limit, len);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": "ZEND_ASSERT",
          "new_api": null,
          "old_text": "ZEND_ASSERT(w < uhc1_ucs_table_size)",
          "new_text": null,
          "old_line_content": "\t\t\t\tZEND_ASSERT(w < uhc1_ucs_table_size);",
          "new_line_content": "\t\t\tunsigned int w = 0;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 1,
      "total_additions": 9,
      "total_deletions": 9,
      "total_api_changes": 19
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 14,
        "api_related_lines": 19,
        "non_api_lines": 12,
        "non_api_line_numbers": [
          230,
          199,
          200,
          234,
          235,
          204,
          236,
          206,
          207,
          208,
          237,
          240
        ]
      }
    },
    "api_calls_before": 29,
    "api_calls_after": 29,
    "diff_info": {
      "added_lines": 12,
      "removed_lines": 2,
      "total_diff_lines": 38
    }
  }
}