{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/a0cc6d426f709bf44741cd7254221bbc6e31c6a4",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/a0cc6d426f709bf44741cd7254221bbc6e31c6a4/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/a0cc6d426f709bf44741cd7254221bbc6e31c6a4/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/php-src/modified_file/a0cc6d426f709bf44741cd7254221bbc6e31c6a4/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 347,
          "old_api": "ZEND_RESULT_TYPE",
          "new_api": "ZEND_RESULT",
          "old_text": "ZEND_RESULT_TYPE(op)",
          "new_text": "ZEND_RESULT(opline)",
          "old_line_content": "\t\t\t\t\t\t\tif(ZEND_RESULT_TYPE(op) == IS_TMP_VAR &&",
          "new_line_content": "\t\t\t\t\t\t\t   ZEND_OP2(op).var == ZEND_RESULT(opline).var) {",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": "SET_UNUSED",
          "new_api": "ZEND_OP2_TYPE",
          "old_text": "SET_UNUSED(opline->result)",
          "new_text": "ZEND_OP2_TYPE(op)",
          "old_line_content": "\t\t\t\t\t\tSET_UNUSED(opline->result);",
          "new_line_content": "\t\t\t\t\t\t\tif(ZEND_OP2_TYPE(op) == IS_TMP_VAR &&",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": "ZEND_OFFSET_TO_OPLINE",
          "new_api": "ZEND_OP2_JMP_ADDR",
          "old_text": "ZEND_OFFSET_TO_OPLINE(opline, opline->extended_value)",
          "new_text": "ZEND_OP2_JMP_ADDR(opline)",
          "old_line_content": "\t\t\t\twhile (ZEND_OFFSET_TO_OPLINE(opline, opline->extended_value) < end",
          "new_line_content": "\t\t\t\t\t\t&& ZEND_OP2_JMP_ADDR(opline)->opcode == ZEND_JMP) {",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": "ZEND_OFFSET_TO_OPLINE",
          "new_api": "ZEND_OP2_JMP_ADDR",
          "old_text": "ZEND_OFFSET_TO_OPLINE(opline, opline->extended_value)",
          "new_text": "ZEND_OP2_JMP_ADDR(opline)",
          "old_line_content": "\t\t\t\t\t\t&& ZEND_OFFSET_TO_OPLINE(opline, opline->extended_value)->opcode == ZEND_JMP) {",
          "new_line_content": "\t\t\t\t\tzend_op *target = ZEND_OP2_JMP_ADDR(opline);",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": "ZEND_OFFSET_TO_OPLINE",
          "new_api": "CHECK_JMP",
          "old_text": "ZEND_OFFSET_TO_OPLINE(opline, opline->extended_value)",
          "new_text": "CHECK_JMP(target, continue_jmpznz_optimization)",
          "old_line_content": "\t\t\t\t\tzend_op *target = ZEND_OFFSET_TO_OPLINE(opline, opline->extended_value);",
          "new_line_content": "\t\t\t\t\tCHECK_JMP(target, continue_jmpznz_optimization);",
          "content_same": false
        },
        {
          "line": 404,
          "old_api": "CHECK_JMP",
          "new_api": "ZEND_OP1_JMP_ADDR",
          "old_text": "CHECK_JMP(target, done_jmp_optimization)",
          "new_text": "ZEND_OP1_JMP_ADDR(target)",
          "old_line_content": "\t\t\t\t\tCHECK_JMP(target, done_jmp_optimization);",
          "new_line_content": "\t\t\t\t\tZEND_SET_OP_JMP_ADDR(opline, opline->op2, ZEND_OP1_JMP_ADDR(target));",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 387,
          "old_api": null,
          "new_api": "SET_UNUSED",
          "old_text": null,
          "new_text": "SET_UNUSED(opline->result)",
          "old_line_content": "\t\t\tcase ZEND_JMPZNZ:",
          "new_line_content": "\t\t\t\t\t\tSET_UNUSED(opline->result);",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": null,
          "new_api": "ZEND_OP2_JMP_ADDR",
          "old_text": null,
          "new_text": "ZEND_OP2_JMP_ADDR(opline)",
          "old_line_content": "\t\t\t\t/* JMPZNZ(X,L1,L2), L2: JMP(L3) => JMPZNZ(X,L1,L3), L2: JMP(L3) */",
          "new_line_content": "\t\t\t\twhile (ZEND_OP2_JMP_ADDR(opline) < end",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": null,
          "new_api": "ZEND_OFFSET_TO_OPLINE",
          "old_text": null,
          "new_text": "ZEND_OFFSET_TO_OPLINE(opline, opline->extended_value)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\twhile (ZEND_OFFSET_TO_OPLINE(opline, opline->extended_value) < end",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": null,
          "new_api": "ZEND_OFFSET_TO_OPLINE",
          "old_text": null,
          "new_text": "ZEND_OFFSET_TO_OPLINE(opline, opline->extended_value)",
          "old_line_content": "\t\t\tcase ZEND_POST_INC:",
          "new_line_content": "\t\t\t\t\t\t&& ZEND_OFFSET_TO_OPLINE(opline, opline->extended_value)->opcode == ZEND_JMP) {",
          "content_same": false
        },
        {
          "line": 410,
          "old_api": null,
          "new_api": "ZEND_OFFSET_TO_OPLINE",
          "old_text": null,
          "new_text": "ZEND_OFFSET_TO_OPLINE(opline, opline->extended_value)",
          "old_line_content": "\t\t\tcase ZEND_POST_DEC: {",
          "new_line_content": "\t\t\t\t\tzend_op *target = ZEND_OFFSET_TO_OPLINE(opline, opline->extended_value);",
          "content_same": false
        },
        {
          "line": 411,
          "old_api": null,
          "new_api": "CHECK_JMP",
          "old_text": null,
          "new_text": "CHECK_JMP(target, done_jmp_optimization)",
          "old_line_content": "\t\t\t\t\t/* POST_INC, FREE => PRE_INC */",
          "new_line_content": "\t\t\t\t\tCHECK_JMP(target, done_jmp_optimization);",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": null,
          "new_api": "ZEND_OP1_JMP_ADDR",
          "old_text": null,
          "new_text": "ZEND_OP1_JMP_ADDR(target)",
          "old_line_content": "\t\t\t\t\tzend_op *next_op = opline + 1;",
          "new_line_content": "\t\t\t\t\topline->extended_value = ZEND_OPLINE_TO_OFFSET(opline, ZEND_OP1_JMP_ADDR(target));",
          "content_same": false
        },
        {
          "line": 425,
          "old_api": null,
          "new_api": "ZEND_RESULT",
          "old_text": null,
          "new_text": "ZEND_RESULT(opline)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\t\t\tZEND_OP1(next_op).var == ZEND_RESULT(opline).var) {",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": null,
          "new_api": "MAKE_NOP",
          "old_text": null,
          "new_text": "MAKE_NOP(next_op)",
          "old_line_content": "done_jmp_optimization:",
          "new_line_content": "\t\t\t\t\t\tMAKE_NOP(next_op);",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": null,
          "new_api": "ZEND_RESULT_TYPE",
          "old_text": null,
          "new_text": "ZEND_RESULT_TYPE(opline)",
          "old_line_content": "\t\topline_num++;",
          "new_line_content": "\t\t\t\t\t\tZEND_RESULT_TYPE(opline) = IS_UNUSED;",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": null,
          "new_api": "SAME_VAR",
          "old_text": null,
          "new_text": "SAME_VAR(opline->result, target->op1)",
          "old_line_content": "\t\t\t\t\t\t\tbreak;",
          "new_line_content": "\t\t\t\t\t\t           SAME_VAR(opline->result, target->op1)) {",
          "content_same": false
        },
        {
          "line": 307,
          "old_api": null,
          "new_api": "ZEND_SET_OP_JMP_ADDR",
          "old_text": null,
          "new_text": "ZEND_SET_OP_JMP_ADDR(opline, opline->op2, target + 1)",
          "old_line_content": "\t\t\t\t\tbreak;",
          "new_line_content": "\t\t\t\t\t\t\tZEND_SET_OP_JMP_ADDR(opline, opline->op2, target + 1);",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": null,
          "new_api": "free_alloca",
          "old_text": null,
          "new_text": "free_alloca(jmp_hitlist, use_heap)",
          "old_line_content": "",
          "new_line_content": "\tfree_alloca(jmp_hitlist, use_heap);",
          "content_same": false
        },
        {
          "line": 320,
          "old_api": null,
          "new_api": "ZEND_RESULT_TYPE",
          "old_text": null,
          "new_text": "ZEND_RESULT_TYPE(op)",
          "old_line_content": "\t\t\t\t\t\t\t   op->opcode == ZEND_JMPZ_EX ||",
          "new_line_content": "\t\t\t\t\t\t\tif(ZEND_RESULT_TYPE(op) == IS_TMP_VAR &&",
          "content_same": false
        },
        {
          "line": 321,
          "old_api": null,
          "new_api": "ZEND_RESULT",
          "old_text": null,
          "new_text": "ZEND_RESULT(opline)",
          "old_line_content": "\t\t\t\t\t\t\t   op->opcode == ZEND_JMPNZ ||",
          "new_line_content": "\t\t\t\t\t\t\t   ZEND_RESULT(op).var == ZEND_RESULT(opline).var) {",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": null,
          "new_api": "ZEND_OP1_TYPE",
          "old_text": null,
          "new_text": "ZEND_OP1_TYPE(op)",
          "old_line_content": "\t\t\t\t\t\t\t\tgoto done_jmp_optimization;",
          "new_line_content": "\t\t\t\t\t\t\tif(ZEND_OP1_TYPE(op) == IS_TMP_VAR &&",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": null,
          "new_api": "ZEND_RESULT",
          "old_text": null,
          "new_text": "ZEND_RESULT(opline)",
          "old_line_content": "\t\t\t\t\t\t\t}",
          "new_line_content": "\t\t\t\t\t\t\t   ZEND_OP1(op).var == ZEND_RESULT(opline).var) {",
          "content_same": false
        },
        {
          "line": 346,
          "old_api": null,
          "new_api": "ZEND_OP2_TYPE",
          "old_text": null,
          "new_text": "ZEND_OP2_TYPE(op)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t\t\t\tif(ZEND_OP2_TYPE(op) == IS_TMP_VAR &&",
          "content_same": false
        },
        {
          "line": 352,
          "old_api": null,
          "new_api": "ZEND_OP2",
          "old_text": null,
          "new_text": "ZEND_OP2(opline)",
          "old_line_content": "\t\t\t\t\t\t\tif(op->opcode == ZEND_JMP ||",
          "new_line_content": "\t\t\t\t\t\tfor(op = &op_array->opcodes[ZEND_OP2(opline).opline_num]; op<end; op++) {",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": null,
          "new_api": "ZEND_RESULT_TYPE",
          "old_text": null,
          "new_text": "ZEND_RESULT_TYPE(op)",
          "old_line_content": "\t\t\t\t\t\t\t   op->opcode == ZEND_JMPZ_EX ||",
          "new_line_content": "\t\t\t\t\t\t\tif(ZEND_RESULT_TYPE(op) == IS_TMP_VAR &&",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": null,
          "new_api": "ZEND_RESULT",
          "old_text": null,
          "new_text": "ZEND_RESULT(opline)",
          "old_line_content": "\t\t\t\t\t\t\t   op->opcode == ZEND_JMPNZ ||",
          "new_line_content": "\t\t\t\t\t\t\t   ZEND_RESULT(op).var == ZEND_RESULT(opline).var) {",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": null,
          "new_api": "ZEND_OP1_TYPE",
          "old_text": null,
          "new_text": "ZEND_OP1_TYPE(op)",
          "old_line_content": "\t\t\t\t\t\t\t\tgoto done_jmp_optimization;",
          "new_line_content": "\t\t\t\t\t\t\tif(ZEND_OP1_TYPE(op) == IS_TMP_VAR &&",
          "content_same": false
        },
        {
          "line": 376,
          "old_api": null,
          "new_api": "ZEND_RESULT",
          "old_text": null,
          "new_text": "ZEND_RESULT(opline)",
          "old_line_content": "\t\t\t\t\t\t\t}",
          "new_line_content": "\t\t\t\t\t\t\t   ZEND_OP1(op).var == ZEND_RESULT(opline).var) {",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": null,
          "new_api": "ZEND_RESULT",
          "old_text": null,
          "new_text": "ZEND_RESULT(opline)",
          "old_line_content": "\t\t\t\t\t\tbreak;",
          "new_line_content": "\t\t\t\t\t\t\t   ZEND_OP2(op).var == ZEND_RESULT(opline).var) {",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 393,
          "old_api": "ZEND_OP2_JMP_ADDR",
          "new_api": null,
          "old_text": "ZEND_OP2_JMP_ADDR(opline)",
          "new_text": null,
          "old_line_content": "\t\t\t\twhile (ZEND_OP2_JMP_ADDR(opline) < end",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": "ZEND_OP2_JMP_ADDR",
          "new_api": null,
          "old_text": "ZEND_OP2_JMP_ADDR(opline)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t&& ZEND_OP2_JMP_ADDR(opline)->opcode == ZEND_JMP) {",
          "new_line_content": "\t\t\tcase ZEND_JMPZNZ:",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": "ZEND_OP2_JMP_ADDR",
          "new_api": null,
          "old_text": "ZEND_OP2_JMP_ADDR(opline)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tzend_op *target = ZEND_OP2_JMP_ADDR(opline);",
          "new_line_content": "\t\t\t\tif (op_array->fn_flags & ZEND_ACC_HAS_FINALLY_BLOCK) {",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": "CHECK_JMP",
          "new_api": null,
          "old_text": "CHECK_JMP(target, continue_jmpznz_optimization)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tCHECK_JMP(target, continue_jmpznz_optimization);",
          "new_line_content": "\t\t\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": "ZEND_OP1_JMP_ADDR",
          "new_api": null,
          "old_text": "ZEND_OP1_JMP_ADDR(target)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tZEND_SET_OP_JMP_ADDR(opline, opline->op2, ZEND_OP1_JMP_ADDR(target));",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": "ZEND_OP1_JMP_ADDR",
          "new_api": null,
          "old_text": "ZEND_OP1_JMP_ADDR(target)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\topline->extended_value = ZEND_OPLINE_TO_OFFSET(opline, ZEND_OP1_JMP_ADDR(target));",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": "ZEND_RESULT",
          "new_api": null,
          "old_text": "ZEND_RESULT(opline)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tZEND_OP1(next_op).var == ZEND_RESULT(opline).var) {",
          "new_line_content": "\t\t\t\t\t/* POST_INC, FREE => PRE_INC */",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": "MAKE_NOP",
          "new_api": null,
          "old_text": "MAKE_NOP(next_op)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tMAKE_NOP(next_op);",
          "new_line_content": "\t\t\t\t\tzend_op *next_op = opline + 1;",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": "ZEND_RESULT_TYPE",
          "new_api": null,
          "old_text": "ZEND_RESULT_TYPE(opline)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tZEND_RESULT_TYPE(opline) = IS_UNUSED;",
          "new_line_content": "\t\t\t\t\tif (next_op >= end) {",
          "content_same": false
        },
        {
          "line": 430,
          "old_api": "free_alloca",
          "new_api": null,
          "old_text": "free_alloca(jmp_hitlist, use_heap)",
          "new_text": null,
          "old_line_content": "\tfree_alloca(jmp_hitlist, use_heap);",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": "ZEND_RESULT_TYPE",
          "new_api": null,
          "old_text": "ZEND_RESULT_TYPE(op)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\tif(ZEND_RESULT_TYPE(op) == IS_TMP_VAR &&",
          "new_line_content": "continue_jmp_ex_optimization:",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": "ZEND_RESULT",
          "new_api": null,
          "old_text": "ZEND_RESULT(opline)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t   ZEND_RESULT(op).var == ZEND_RESULT(opline).var) {",
          "new_line_content": "\t\t\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": "ZEND_OP1_TYPE",
          "new_api": null,
          "old_text": "ZEND_OP1_TYPE(op)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\tif(ZEND_OP1_TYPE(op) == IS_TMP_VAR &&",
          "new_line_content": "\t\t\t\t\t\t\t   op->opcode == ZEND_FAST_RET ||",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": "ZEND_RESULT",
          "new_api": null,
          "old_text": "ZEND_RESULT(opline)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t   ZEND_OP1(op).var == ZEND_RESULT(opline).var) {",
          "new_line_content": "\t\t\t\t\t\t\t   op->opcode == ZEND_FE_FETCH_R ||",
          "content_same": false
        },
        {
          "line": 339,
          "old_api": "ZEND_OP2_TYPE",
          "new_api": null,
          "old_text": "ZEND_OP2_TYPE(op)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\tif(ZEND_OP2_TYPE(op) == IS_TMP_VAR &&",
          "new_line_content": "\t\t\t\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": "ZEND_RESULT",
          "new_api": null,
          "old_text": "ZEND_RESULT(opline)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t   ZEND_OP2(op).var == ZEND_RESULT(opline).var) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 345,
          "old_api": "ZEND_OP2",
          "new_api": null,
          "old_text": "ZEND_OP2(opline)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tfor(op = &op_array->opcodes[ZEND_OP2(opline).opline_num]; op<end; op++) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": "ZEND_RESULT",
          "new_api": null,
          "old_text": "ZEND_RESULT(opline)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t   ZEND_RESULT(op).var == ZEND_RESULT(opline).var) {",
          "new_line_content": "\t\t\t\t\t\t\t\tgoto done_jmp_optimization;",
          "content_same": false
        },
        {
          "line": 368,
          "old_api": "ZEND_OP1_TYPE",
          "new_api": null,
          "old_text": "ZEND_OP1_TYPE(op)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\tif(ZEND_OP1_TYPE(op) == IS_TMP_VAR &&",
          "new_line_content": "\t\t\t\t\t\t\t   op->opcode == ZEND_FAST_RET ||",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": "ZEND_RESULT",
          "new_api": null,
          "old_text": "ZEND_RESULT(opline)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t   ZEND_OP1(op).var == ZEND_RESULT(opline).var) {",
          "new_line_content": "\t\t\t\t\t\t\t   op->opcode == ZEND_FE_FETCH_R ||",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": "ZEND_OP2_TYPE",
          "new_api": null,
          "old_text": "ZEND_OP2_TYPE(op)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\tif(ZEND_OP2_TYPE(op) == IS_TMP_VAR &&",
          "new_line_content": "\t\t\t\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": "ZEND_RESULT",
          "new_api": null,
          "old_text": "ZEND_RESULT(opline)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t   ZEND_OP2(op).var == ZEND_RESULT(opline).var) {",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 6,
      "total_additions": 24,
      "total_deletions": 22,
      "total_api_changes": 52
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 52,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          302,
          304,
          305,
          306,
          308
        ]
      }
    },
    "api_calls_before": 108,
    "api_calls_after": 110,
    "diff_info": {
      "added_lines": 7,
      "removed_lines": 0,
      "total_diff_lines": 19
    }
  }
}