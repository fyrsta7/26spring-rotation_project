{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/7ac6c94720ed2d32dde51299824475b27ff1edc1",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/7ac6c94720ed2d32dde51299824475b27ff1edc1/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/7ac6c94720ed2d32dde51299824475b27ff1edc1/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/7ac6c94720ed2d32dde51299824475b27ff1edc1/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 125,
          "old_api": "ap (NULL, 1, PROT_READ|PROT_WRITE, MAP_PRIVATE, fd, 0);",
          "new_api": "ntl (fd, F_RDAHEAD, 1);",
          "old_text": "ap (NULL, 1, PROT_READ|PROT_WRITE, MAP_PRIVATE, fd, 0);\n",
          "new_text": "ntl (fd, F_RDAHEAD, 1);\n",
          "old_line_content": "        void *addr = mmap (NULL, 1, PROT_READ|PROT_WRITE, MAP_PRIVATE, fd, 0);",
          "new_line_content": "    fcntl (fd, F_RDAHEAD, 1);",
          "content_same": false
        },
        {
          "line": 132,
          "old_api": "sconf (_SC_PAGE_SIZE);",
          "new_api": "ap (NULL, 1, PROT_READ|PROT_WRITE, MAP_PRIVATE, fd, 0);",
          "old_text": "sconf (_SC_PAGE_SIZE);\n",
          "new_text": "ap (NULL, 1, PROT_READ|PROT_WRITE, MAP_PRIVATE, fd, 0);\n",
          "old_line_content": "    p_sys->page_size = sysconf (_SC_PAGE_SIZE);",
          "new_line_content": "        void *addr = mmap (NULL, 1, PROT_READ|PROT_WRITE, MAP_PRIVATE, fd, 0);",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "ose (fd);",
          "new_api": "six_fadvise (fd, 0, 0, POSIX_FADV_SEQUENTIAL);",
          "old_text": "ose (fd);\n",
          "new_text": "six_fadvise (fd, 0, 0, POSIX_FADV_SEQUENTIAL);\n",
          "old_line_content": "        close (fd);",
          "new_line_content": "    posix_fadvise (fd, 0, 0, POSIX_FADV_SEQUENTIAL);",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": "g_Err (p_access, \"position: 0x%08llx instead of 0x%08llx\",\n                 p_access->info.i_pos, dbgpos);",
          "new_api": "g_Dbg (p_access, \"at end of memory mapped file\");",
          "old_text": "g_Err (p_access, \"position: 0x%08llx instead of 0x%08llx\",\n                 p_access->info.i_pos, dbgpos);\n",
          "new_text": "g_Dbg (p_access, \"at end of memory mapped file\");\n",
          "old_line_content": "        msg_Err (p_access, \"position: 0x%08llx instead of 0x%08llx\",",
          "new_line_content": "        msg_Dbg (p_access, \"at end of memory mapped file\");",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": "ap (NULL, length, PROT_READ|PROT_WRITE, MAP_PRIVATE,\n                       p_sys->fd, outer_offset);",
          "new_api": "sert (p_access->info.i_pos < p_access->info.i_size);",
          "old_text": "ap (NULL, length, PROT_READ|PROT_WRITE, MAP_PRIVATE,\n                       p_sys->fd, outer_offset);\n",
          "new_text": "sert (p_access->info.i_pos < p_access->info.i_size); ",
          "old_line_content": "    void *addr = mmap (NULL, length, PROT_READ|PROT_WRITE, MAP_PRIVATE,",
          "new_line_content": "    assert (p_access->info.i_pos < p_access->info.i_size); /* imply */",
          "content_same": false
        },
        {
          "line": 222,
          "old_api": "ock_mmap_Alloc (addr, length);",
          "new_api": "\"VLC could not read the file.\"));",
          "old_text": "ock_mmap_Alloc (addr, length);\n",
          "new_text": "\"VLC could not read the file.\"));",
          "old_line_content": "    block_t *block = block_mmap_Alloc (addr, length);",
          "new_line_content": "                        _(\"VLC could not read the file.\"));",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": "g_Err (p_access, \"inconsistent data buffer\");",
          "new_api": "lloc (block->i_buffer);",
          "old_text": "g_Err (p_access, \"inconsistent data buffer\");\n",
          "new_text": "lloc (block->i_buffer);\n",
          "old_line_content": "        msg_Err (p_access, \"inconsistent data buffer\");",
          "new_line_content": "    char *buf = malloc (block->i_buffer);",
          "content_same": false
        },
        {
          "line": 242,
          "old_api": "ee (buf);",
          "new_api": "ad (p_sys->fd, buf, block->i_buffer);",
          "old_text": "ee (buf);\n",
          "new_text": "ad (p_sys->fd, buf, block->i_buffer);\n",
          "old_line_content": "    free (buf);",
          "new_line_content": "    ssize_t i_read = read (p_sys->fd, buf, block->i_buffer);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 134,
          "old_api": null,
          "new_api": "nmap (addr, 1);",
          "old_text": null,
          "new_text": "nmap (addr, 1);\n",
          "old_line_content": "    if (p_sys->mtu < p_sys->page_size)",
          "new_line_content": "            munmap (addr, 1);",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": null,
          "new_api": "eek (p_access->p_sys->fd, i_pos, SEEK_SET);",
          "old_text": null,
          "new_text": "eek (p_access->p_sys->fd, i_pos, SEEK_SET);\n",
          "old_line_content": "",
          "new_line_content": "    lseek (p_access->p_sys->fd, i_pos, SEEK_SET);",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": null,
          "new_api": "sconf (_SC_PAGE_SIZE);",
          "old_text": null,
          "new_text": "sconf (_SC_PAGE_SIZE);\n",
          "old_line_content": "#ifdef HAVE_POSIX_FADVISE    ",
          "new_line_content": "    p_sys->page_size = sysconf (_SC_PAGE_SIZE);",
          "content_same": false
        },
        {
          "line": 154,
          "old_api": null,
          "new_api": "ose (fd);",
          "old_text": null,
          "new_text": "ose (fd);\n",
          "old_line_content": "{",
          "new_line_content": "        close (fd);",
          "content_same": false
        },
        {
          "line": 283,
          "old_api": null,
          "new_api": "_arg (args, bool *))",
          "old_text": null,
          "new_text": "_arg (args, bool *)) ",
          "old_line_content": "        case ACCESS_GET_PTS_DELAY:",
          "new_line_content": "            *((bool *)va_arg (args, bool *)) = true;",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": null,
          "new_api": "ee (p_sys);",
          "old_text": null,
          "new_text": "ee (p_sys);\n",
          "old_line_content": "    access_t *p_access = (access_t *)p_this;",
          "new_line_content": "    free (p_sys);",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": null,
          "new_api": "_arg (args, int *))",
          "old_text": null,
          "new_text": "_arg (args, int *)) ",
          "old_line_content": "            return VLC_SUCCESS;",
          "new_line_content": "            *((int *)va_arg (args, int *)) = p_sys->mtu;",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": null,
          "new_api": "r_CreateGetInteger (p_access, \"file-caching\");",
          "old_text": null,
          "new_text": "r_CreateGetInteger (p_access, \"file-caching\");\n",
          "old_line_content": "            break;",
          "new_line_content": "            int delay_ms = var_CreateGetInteger (p_access, \"file-caching\");",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": null,
          "new_api": "ose (p_sys->fd);",
          "old_text": null,
          "new_text": "ose (p_sys->fd); ",
          "old_line_content": "",
          "new_line_content": "    close (p_sys->fd); /* don't care about error when only reading */",
          "content_same": false
        },
        {
          "line": 166,
          "old_api": null,
          "new_api": "ee (p_sys);",
          "old_text": null,
          "new_text": "ee (p_sys);\n",
          "old_line_content": "    /* Check if file size changed... */",
          "new_line_content": "    free (p_sys);",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": null,
          "new_api": "T64_C (1000);",
          "old_text": null,
          "new_text": "T64_C (1000);\n",
          "old_line_content": "",
          "new_line_content": "            *((int64_t *)va_arg (args, int64_t *)) = delay_ms * INT64_C (1000);",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": null,
          "new_api": "tat (p_sys->fd, &st) =",
          "old_text": null,
          "new_text": "tat (p_sys->fd, &st) =",
          "old_line_content": "    if ((uint64_t)p_access->info.i_pos >= (uint64_t)p_access->info.i_size)",
          "new_line_content": "    if ((fstat (p_sys->fd, &st) == 0)",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": null,
          "new_api": "g_Warn (p_access, \"unimplemented query %d in control\", query);",
          "old_text": null,
          "new_text": "g_Warn (p_access, \"unimplemented query %d in control\", query);\n",
          "old_line_content": "",
          "new_line_content": "            msg_Warn (p_access, \"unimplemented query %d in control\", query);",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": null,
          "new_api": "eek (p_sys->fd, 0, SEEK_CUR);",
          "old_text": null,
          "new_text": "eek (p_sys->fd, 0, SEEK_CUR);\n",
          "old_line_content": "    /* Start the mapping on a page boundary: */",
          "new_line_content": "    int64_t dbgpos = lseek (p_sys->fd, 0, SEEK_CUR);",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": null,
          "new_api": "g_Err (p_access, \"position: 0x%08llx instead of 0x%08llx\",\n                 p_access->info.i_pos, dbgpos);",
          "old_text": null,
          "new_text": "g_Err (p_access, \"position: 0x%08llx instead of 0x%08llx\",\n                 p_access->info.i_pos, dbgpos);\n",
          "old_line_content": "    /* Skip useless bytes at the beginning of the first page: */",
          "new_line_content": "        msg_Err (p_access, \"position: 0x%08llx instead of 0x%08llx\",",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": null,
          "new_api": "sert (outer_offset <= p_access->info.i_pos);",
          "old_text": null,
          "new_text": "sert (outer_offset <= p_access->info.i_pos); ",
          "old_line_content": "     * original file. This does NOT need open write permission. */",
          "new_line_content": "    assert (outer_offset <= p_access->info.i_pos);          /* and */",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": null,
          "new_api": "sert (outer_offset < p_access->info.i_size);",
          "old_text": null,
          "new_text": "sert (outer_offset < p_access->info.i_size); ",
          "old_line_content": "                       p_sys->fd, outer_offset);",
          "new_line_content": "    assert (outer_offset < p_access->info.i_size);         /* imply */",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": null,
          "new_api": "sert (length > 0);",
          "old_text": null,
          "new_text": "sert (length > 0);\n",
          "old_line_content": "    if (addr == MAP_FAILED)",
          "new_line_content": "    assert (length > 0);",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": null,
          "new_api": "ap (NULL, length, PROT_READ|PROT_WRITE, MAP_PRIVATE,\n                       p_sys->fd, outer_offset);",
          "old_text": null,
          "new_text": "ap (NULL, length, PROT_READ|PROT_WRITE, MAP_PRIVATE,\n                       p_sys->fd, outer_offset);\n",
          "old_line_content": "        goto fatal;",
          "new_line_content": "    void *addr = mmap (NULL, length, PROT_READ|PROT_WRITE, MAP_PRIVATE,",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": null,
          "new_api": "g_Err (p_access, \"memory mapping failed (%m)\");",
          "old_text": null,
          "new_text": "g_Err (p_access, \"memory mapping failed (%m)\");\n",
          "old_line_content": "#endif",
          "new_line_content": "        msg_Err (p_access, \"memory mapping failed (%m)\");",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": null,
          "new_api": "\"File reading failed\"),",
          "old_text": null,
          "new_text": "\"File reading failed\"),\n",
          "old_line_content": "",
          "new_line_content": "        intf_UserFatal (p_access, false, _(\"File reading failed\"),",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": null,
          "new_api": "six_madvise (addr, length, POSIX_MADV_SEQUENTIAL);",
          "old_text": null,
          "new_text": "six_madvise (addr, length, POSIX_MADV_SEQUENTIAL);\n",
          "old_line_content": "    block->p_buffer += inner_offset;",
          "new_line_content": "    posix_madvise (addr, length, POSIX_MADV_SEQUENTIAL);",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": null,
          "new_api": "ock_mmap_Alloc (addr, length);",
          "old_text": null,
          "new_text": "ock_mmap_Alloc (addr, length);\n",
          "old_line_content": "#ifdef MMAP_DEBUG",
          "new_line_content": "    block_t *block = block_mmap_Alloc (addr, length);",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": null,
          "new_api": "g_Dbg (p_access, \"mapped 0x%lx bytes at %p from offset 0x%lx\",\n             (unsigned long)length, addr, (unsigned long)outer_offset);",
          "old_text": null,
          "new_text": "g_Dbg (p_access, \"mapped 0x%lx bytes at %p from offset 0x%lx\",\n             (unsigned long)length, addr, (unsigned long)outer_offset);\n",
          "old_line_content": "    if (i_read != (ssize_t)block->i_buffer)",
          "new_line_content": "    msg_Dbg (p_access, \"mapped 0x%lx bytes at %p from offset 0x%lx\",",
          "content_same": false
        },
        {
          "line": 245,
          "old_api": null,
          "new_api": "g_Err (p_access, \"read %u instead of %u bytes\", (unsigned)i_read,\n                 (unsigned)block->i_buffer);",
          "old_text": null,
          "new_text": "g_Err (p_access, \"read %u instead of %u bytes\", (unsigned)i_read,\n                 (unsigned)block->i_buffer);\n",
          "old_line_content": "    p_access->info.i_pos = outer_offset + length;",
          "new_line_content": "        msg_Err (p_access, \"read %u instead of %u bytes\", (unsigned)i_read,",
          "content_same": false
        },
        {
          "line": 247,
          "old_api": null,
          "new_api": "mcmp (buf, block->p_buffer, block->i_buffer))",
          "old_text": null,
          "new_text": "mcmp (buf, block->p_buffer, block->i_buffer))\n",
          "old_line_content": "",
          "new_line_content": "    if (memcmp (buf, block->p_buffer, block->i_buffer))",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": null,
          "new_api": "g_Err (p_access, \"inconsistent data buffer\");",
          "old_text": null,
          "new_text": "g_Err (p_access, \"inconsistent data buffer\");\n",
          "old_line_content": "fatal:",
          "new_line_content": "        msg_Err (p_access, \"inconsistent data buffer\");",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": null,
          "new_api": "ee (buf);",
          "old_text": null,
          "new_text": "ee (buf);\n",
          "old_line_content": "    p_access->info.b_eof = true;",
          "new_line_content": "    free (buf);",
          "content_same": false
        },
        {
          "line": 126,
          "old_api": null,
          "new_api": "ntl (fd, F_NOCACHE, 1);",
          "old_text": null,
          "new_text": "ntl (fd, F_NOCACHE, 1);\n",
          "old_line_content": "        if (addr != MAP_FAILED)",
          "new_line_content": "    fcntl (fd, F_NOCACHE, 1);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 257,
          "old_api": "eek (p_access->p_sys->fd, i_pos, SEEK_SET);",
          "new_api": null,
          "old_text": "eek (p_access->p_sys->fd, i_pos, SEEK_SET);\n",
          "new_text": null,
          "old_line_content": "    lseek (p_access->p_sys->fd, i_pos, SEEK_SET);",
          "new_line_content": "    return NULL;",
          "content_same": false
        },
        {
          "line": 140,
          "old_api": "six_fadvise (fd, 0, 0, POSIX_FADV_SEQUENTIAL);",
          "new_api": null,
          "old_text": "six_fadvise (fd, 0, 0, POSIX_FADV_SEQUENTIAL);\n",
          "new_text": null,
          "old_line_content": "    posix_fadvise (fd, 0, 0, POSIX_FADV_SEQUENTIAL);",
          "new_line_content": "    p_sys->mtu = MMAP_SIZE;",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": "_arg (args, bool *))",
          "new_api": null,
          "old_text": "_arg (args, bool *)) ",
          "new_text": null,
          "old_line_content": "            *((bool *)va_arg (args, bool *)) = true;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 148,
          "old_api": "ee (p_sys);",
          "new_api": null,
          "old_text": "ee (p_sys);\n",
          "new_text": null,
          "old_line_content": "    free (p_sys);",
          "new_line_content": "#endif ",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": "_arg (args, int *))",
          "new_api": null,
          "old_text": "_arg (args, int *)) ",
          "new_text": null,
          "old_line_content": "            *((int *)va_arg (args, int *)) = p_sys->mtu;",
          "new_line_content": "        case ACCESS_CAN_FASTSEEK:",
          "content_same": false
        },
        {
          "line": 285,
          "old_api": "r_CreateGetInteger (p_access, \"file-caching\");",
          "new_api": null,
          "old_text": "r_CreateGetInteger (p_access, \"file-caching\");\n",
          "new_text": null,
          "old_line_content": "            int delay_ms = var_CreateGetInteger (p_access, \"file-caching\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 286,
          "old_api": "T64_C (1000);",
          "new_api": null,
          "old_text": "T64_C (1000);\n",
          "new_text": null,
          "old_line_content": "            *((int64_t *)va_arg (args, int64_t *)) = delay_ms * INT64_C (1000);",
          "new_line_content": "        case ACCESS_GET_MTU:",
          "content_same": false
        },
        {
          "line": 158,
          "old_api": "ose (p_sys->fd);",
          "new_api": null,
          "old_text": "ose (p_sys->fd); ",
          "new_text": null,
          "old_line_content": "    close (p_sys->fd); /* don't care about error when only reading */",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 159,
          "old_api": "ee (p_sys);",
          "new_api": null,
          "old_text": "ee (p_sys);\n",
          "new_text": null,
          "old_line_content": "    free (p_sys);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 169,
          "old_api": "tat (p_sys->fd, &st) =",
          "new_api": null,
          "old_text": "tat (p_sys->fd, &st) =",
          "new_text": null,
          "old_line_content": "    if ((fstat (p_sys->fd, &st) == 0)",
          "new_line_content": "static block_t *Block (access_t *p_access)",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": "g_Warn (p_access, \"unimplemented query %d in control\", query);",
          "new_api": null,
          "old_text": "g_Warn (p_access, \"unimplemented query %d in control\", query);\n",
          "new_text": null,
          "old_line_content": "            msg_Warn (p_access, \"unimplemented query %d in control\", query);",
          "new_line_content": "        case ACCESS_SET_PRIVATE_ID_STATE:",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": "g_Dbg (p_access, \"at end of memory mapped file\");",
          "new_api": null,
          "old_text": "g_Dbg (p_access, \"at end of memory mapped file\");\n",
          "new_text": null,
          "old_line_content": "        msg_Dbg (p_access, \"at end of memory mapped file\");",
          "new_line_content": "        p_access->info.i_update |= INPUT_UPDATE_SIZE;",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": "eek (p_sys->fd, 0, SEEK_CUR);",
          "new_api": null,
          "old_text": "eek (p_sys->fd, 0, SEEK_CUR);\n",
          "new_text": null,
          "old_line_content": "    int64_t dbgpos = lseek (p_sys->fd, 0, SEEK_CUR);",
          "new_line_content": "        /* We are at end of file */",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "sert (outer_offset <= p_access->info.i_pos);",
          "new_api": null,
          "old_text": "sert (outer_offset <= p_access->info.i_pos); ",
          "new_text": null,
          "old_line_content": "    assert (outer_offset <= p_access->info.i_pos);          /* and */",
          "new_line_content": "    /* Skip useless bytes at the beginning of the first page: */",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": "sert (p_access->info.i_pos < p_access->info.i_size);",
          "new_api": null,
          "old_text": "sert (p_access->info.i_pos < p_access->info.i_size); ",
          "new_text": null,
          "old_line_content": "    assert (p_access->info.i_pos < p_access->info.i_size); /* imply */",
          "new_line_content": "    size_t inner_offset = p_access->info.i_pos & page_mask;",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": "sert (outer_offset < p_access->info.i_size);",
          "new_api": null,
          "old_text": "sert (outer_offset < p_access->info.i_size); ",
          "new_text": null,
          "old_line_content": "    assert (outer_offset < p_access->info.i_size);         /* imply */",
          "new_line_content": "    /* Map no more bytes than remain: */",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": "sert (length > 0);",
          "new_api": null,
          "old_text": "sert (length > 0);\n",
          "new_text": null,
          "old_line_content": "    assert (length > 0);",
          "new_line_content": "    size_t length = p_sys->mtu;",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": "g_Err (p_access, \"memory mapping failed (%m)\");",
          "new_api": null,
          "old_text": "g_Err (p_access, \"memory mapping failed (%m)\");\n",
          "new_text": null,
          "old_line_content": "        msg_Err (p_access, \"memory mapping failed (%m)\");",
          "new_line_content": "    /* NOTE: We use PROT_WRITE and MAP_PRIVATE so that the block can be",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": "\"File reading failed\"),",
          "new_api": null,
          "old_text": "\"File reading failed\"),\n",
          "new_text": null,
          "old_line_content": "        intf_UserFatal (p_access, false, _(\"File reading failed\"),",
          "new_line_content": "     * modified down the chain, without messing up with the underlying",
          "content_same": false
        },
        {
          "line": 215,
          "old_api": "\"VLC could not read the file.\"));",
          "new_api": null,
          "old_text": "\"VLC could not read the file.\"));",
          "new_text": null,
          "old_line_content": "                        _(\"VLC could not read the file.\"));",
          "new_line_content": "     * original file. This does NOT need open write permission. */",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": "six_madvise (addr, length, POSIX_MADV_SEQUENTIAL);",
          "new_api": null,
          "old_text": "six_madvise (addr, length, POSIX_MADV_SEQUENTIAL);\n",
          "new_text": null,
          "old_line_content": "    posix_madvise (addr, length, POSIX_MADV_SEQUENTIAL);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": "g_Dbg (p_access, \"mapped 0x%lx bytes at %p from offset 0x%lx\",\n             (unsigned long)length, addr, (unsigned long)outer_offset);",
          "new_api": null,
          "old_text": "g_Dbg (p_access, \"mapped 0x%lx bytes at %p from offset 0x%lx\",\n             (unsigned long)length, addr, (unsigned long)outer_offset);\n",
          "new_text": null,
          "old_line_content": "    msg_Dbg (p_access, \"mapped 0x%lx bytes at %p from offset 0x%lx\",",
          "new_line_content": "    if (block == NULL)",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": "lloc (block->i_buffer);",
          "new_api": null,
          "old_text": "lloc (block->i_buffer);\n",
          "new_text": null,
          "old_line_content": "    char *buf = malloc (block->i_buffer);",
          "new_line_content": "    block->i_buffer -= inner_offset;",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": "ad (p_sys->fd, buf, block->i_buffer);",
          "new_api": null,
          "old_text": "ad (p_sys->fd, buf, block->i_buffer);\n",
          "new_text": null,
          "old_line_content": "    ssize_t i_read = read (p_sys->fd, buf, block->i_buffer);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": "g_Err (p_access, \"read %u instead of %u bytes\", (unsigned)i_read,\n                 (unsigned)block->i_buffer);",
          "new_api": null,
          "old_text": "g_Err (p_access, \"read %u instead of %u bytes\", (unsigned)i_read,\n                 (unsigned)block->i_buffer);\n",
          "new_text": null,
          "old_line_content": "        msg_Err (p_access, \"read %u instead of %u bytes\", (unsigned)i_read,",
          "new_line_content": "             (unsigned long)length, addr, (unsigned long)outer_offset);",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": "mcmp (buf, block->p_buffer, block->i_buffer))",
          "new_api": null,
          "old_text": "mcmp (buf, block->p_buffer, block->i_buffer))\n",
          "new_text": null,
          "old_line_content": "    if (memcmp (buf, block->p_buffer, block->i_buffer))",
          "new_line_content": "    /* Compare normal I/O with memory mapping */",
          "content_same": false
        },
        {
          "line": 127,
          "old_api": "nmap (addr, 1);",
          "new_api": null,
          "old_text": "nmap (addr, 1);\n",
          "new_text": null,
          "old_line_content": "            munmap (addr, 1);",
          "new_line_content": "# endif",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 8,
      "total_additions": 29,
      "total_deletions": 27,
      "total_api_changes": 64
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 64,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          128,
          122,
          123,
          124
        ]
      }
    },
    "api_calls_before": 60,
    "api_calls_after": 62,
    "diff_info": {
      "added_lines": 7,
      "removed_lines": 0,
      "total_diff_lines": 19
    }
  }
}