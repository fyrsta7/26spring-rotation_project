{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/e84106dc71662f1c5bf1c06a7b70b550a45718d8",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/e84106dc71662f1c5bf1c06a7b70b550a45718d8/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/e84106dc71662f1c5bf1c06a7b70b550a45718d8/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/e84106dc71662f1c5bf1c06a7b70b550a45718d8/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 192,
          "old_api": "restrict",
          "new_api": "vout_display_PlacePicture",
          "old_text": "restrict",
          "new_text": "vout_display_PlacePicture(&place, source, cfg)",
          "old_line_content": "                                       const video_format_t *restrict source,",
          "new_line_content": "    vout_display_PlacePicture(&place, source, cfg);",
          "content_same": false
        },
        {
          "line": 278,
          "old_api": "va_arg",
          "new_api": "video_format_Copy",
          "old_text": "va_arg(ap, vout_display_priv_t *)",
          "new_text": "video_format_Copy(&osys->display_fmt, vd->source)",
          "old_line_content": "    vout_display_priv_t *osys = va_arg(ap, vout_display_priv_t *);",
          "new_line_content": "    video_format_Copy(&osys->display_fmt, vd->source);",
          "content_same": false
        },
        {
          "line": 283,
          "old_api": "video_format_Copy",
          "new_api": "video_format_Clean",
          "old_text": "video_format_Copy(&osys->display_fmt, vd->source)",
          "new_text": "video_format_Clean(&osys->display_fmt)",
          "old_line_content": "    video_format_Copy(&osys->display_fmt, vd->source);",
          "new_line_content": "        video_format_Clean(&osys->display_fmt);",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": "msg_Dbg",
          "new_api": "es_format_InitFromVideo",
          "old_text": "msg_Dbg(vd, \"A filter to adapt decoder %4.4s to display %4.4s is needed\",\n            (const char *)&v_src.i_chroma, (const char *)&v_dst.i_chroma)",
          "new_text": "es_format_InitFromVideo(&src, &v_src)",
          "old_line_content": "    msg_Dbg(vd, \"A filter to adapt decoder %4.4s to display %4.4s is needed\",",
          "new_line_content": "    es_format_InitFromVideo(&src, &v_src);",
          "content_same": false
        },
        {
          "line": 339,
          "old_api": "es_format_InitFromVideo",
          "new_api": "es_format_Clean",
          "old_text": "es_format_InitFromVideo(&dst, &v_dst)",
          "new_text": "es_format_Clean(&src)",
          "old_line_content": "    es_format_InitFromVideo(&dst, &v_dst);",
          "new_line_content": "    es_format_Clean(&src);",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": "filter_chain_AppendConverter",
          "new_api": "msg_Err",
          "old_text": "filter_chain_AppendConverter(osys->converters, &dst)",
          "new_text": "msg_Err(vd, \"Failed to adapt decoder format to display\")",
          "old_line_content": "    int ret = filter_chain_AppendConverter(osys->converters, &dst);",
          "new_line_content": "        msg_Err(vd, \"Failed to adapt decoder format to display\");",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": "es_format_Clean",
          "new_api": "filter_chain_Delete",
          "old_text": "es_format_Clean(&dst)",
          "new_text": "filter_chain_Delete(osys->converters)",
          "old_line_content": "    es_format_Clean(&dst);",
          "new_line_content": "        filter_chain_Delete(osys->converters);",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": "filter_chain_IsEmpty",
          "new_api": "container_of",
          "old_text": "filter_chain_IsEmpty(osys->converters)",
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "    return osys->converters == NULL || !filter_chain_IsEmpty(osys->converters);",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": "filter_chain_VideoFlush",
          "new_api": "container_of",
          "old_text": "filter_chain_VideoFlush(osys->converters)",
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "        filter_chain_VideoFlush(osys->converters);",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 429,
          "old_api": "filter_chain_Delete",
          "new_api": "picture_pool_Release",
          "old_text": "filter_chain_Delete(osys->converters)",
          "new_text": "picture_pool_Release(osys->pool)",
          "old_line_content": "        filter_chain_Delete(osys->converters);",
          "new_line_content": "        picture_pool_Release(osys->pool);",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": "picture_pool_Release",
          "new_api": "reset_pictures",
          "old_text": "picture_pool_Release(osys->pool)",
          "new_text": "vd->ops->reset_pictures(vd, &osys->display_fmt)",
          "old_line_content": "        picture_pool_Release(osys->pool);",
          "new_line_content": "    if (vd->ops->reset_pictures(vd, &osys->display_fmt) != VLC_SUCCESS",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": "msg_Err",
          "new_api": "container_of",
          "old_text": "msg_Err(vd, \"Failed to adjust render format\")",
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "        msg_Err(vd, \"Failed to adjust render format\");",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 562,
          "old_api": "vout_display_Reset",
          "new_api": "container_of",
          "old_text": "vout_display_Reset(vd)",
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "        vout_display_Reset(vd);",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": "container_of",
          "new_api": "vout_display_Reset",
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": "vout_display_Reset(vd)",
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "        vout_display_Reset(vd);",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": "vout_display_Reset",
          "new_api": "container_of",
          "old_text": "vout_display_Reset(vd)",
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "        vout_display_Reset(vd);",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": "vout_display_Reset",
          "new_api": "container_of",
          "old_text": "vout_display_Reset(vd)",
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "        vout_display_Reset(vd);",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": "vout_display_Reset",
          "new_api": "container_of",
          "old_text": "vout_display_Reset(vd)",
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "        vout_display_Reset(vd);",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 615,
          "old_api": "vout_SetSourceAspect",
          "new_api": "restrict",
          "old_text": "vout_SetSourceAspect(vd, sar_num, sar_den)",
          "new_text": "restrict",
          "old_line_content": "    if (vout_SetSourceAspect(vd, sar_num, sar_den))",
          "new_line_content": "                         const struct vout_crop *restrict crop)",
          "content_same": false
        },
        {
          "line": 622,
          "old_api": "container_of",
          "new_api": "vout_UpdateSourceCrop",
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": "vout_UpdateSourceCrop(vd)",
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "        if (vout_UpdateSourceCrop(vd))",
          "content_same": false
        },
        {
          "line": 720,
          "old_api": "vlc_video_context_Release",
          "new_api": "filter_chain_Delete",
          "old_text": "vlc_video_context_Release( osys->src_vctx )",
          "new_text": "filter_chain_Delete(osys->converters)",
          "old_line_content": "        vlc_video_context_Release( osys->src_vctx );",
          "new_line_content": "        filter_chain_Delete(osys->converters);",
          "content_same": false
        },
        {
          "line": 731,
          "old_api": "close",
          "new_api": "vlc_object_delete",
          "old_text": "vd->ops->close(vd)",
          "new_text": "vlc_object_delete(vd)",
          "old_line_content": "        vd->ops->close(vd);",
          "new_line_content": "    vlc_object_delete(vd);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 518,
          "old_api": null,
          "new_api": "vlc_ureduce",
          "old_text": null,
          "new_text": "vlc_ureduce( &fmt->i_sar_num, &fmt->i_sar_den,\n                 fmt->i_sar_num,  fmt->i_sar_den, 50000 )",
          "old_line_content": "    return ret;",
          "new_line_content": "    vlc_ureduce( &fmt->i_sar_num, &fmt->i_sar_den,",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": null,
          "new_api": "container_of",
          "old_text": null,
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "    }",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": null,
          "new_api": "VoutFixFormatAR",
          "old_text": null,
          "new_text": "VoutFixFormatAR( &fixed_src )",
          "old_line_content": "{",
          "new_line_content": "    VoutFixFormatAR( &fixed_src );",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": null,
          "new_api": "vout_SetSourceAspect",
          "old_text": null,
          "new_text": "vout_SetSourceAspect(vd, osys->source.i_sar_num,\n                                    osys->source.i_sar_den)",
          "old_line_content": "",
          "new_line_content": "        err1 = vout_SetSourceAspect(vd, osys->source.i_sar_num,",
          "content_same": false
        },
        {
          "line": 549,
          "old_api": null,
          "new_api": "video_format_CopyCrop",
          "old_text": null,
          "new_text": "video_format_CopyCrop(&osys->source, source)",
          "old_line_content": "    if (source->i_x_offset       != osys->source.i_x_offset ||",
          "new_line_content": "        video_format_CopyCrop(&osys->source, source);",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": null,
          "new_api": "vout_UpdateSourceCrop",
          "old_text": null,
          "new_text": "vout_UpdateSourceCrop(vd)",
          "old_line_content": "",
          "new_line_content": "        err2 = vout_UpdateSourceCrop(vd);",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": null,
          "new_api": "vout_display_Reset",
          "old_text": null,
          "new_text": "vout_display_Reset(vd)",
          "old_line_content": "         * over the new decoder crop settings. */",
          "new_line_content": "        vout_display_Reset(vd);",
          "content_same": false
        },
        {
          "line": 566,
          "old_api": null,
          "new_api": "vout_display_Control",
          "old_text": null,
          "new_text": "vout_display_Control(vd, VOUT_DISPLAY_CHANGE_DISPLAY_SIZE)",
          "old_line_content": "{",
          "new_line_content": "    if (vout_display_Control(vd, VOUT_DISPLAY_CHANGE_DISPLAY_SIZE))",
          "content_same": false
        },
        {
          "line": 578,
          "old_api": null,
          "new_api": "vout_display_Control",
          "old_text": null,
          "new_text": "vout_display_Control(vd, VOUT_DISPLAY_CHANGE_DISPLAY_FILLED)",
          "old_line_content": "",
          "new_line_content": "    if (vout_display_Control(vd, VOUT_DISPLAY_CHANGE_DISPLAY_FILLED))",
          "content_same": false
        },
        {
          "line": 579,
          "old_api": null,
          "new_api": "vout_display_Reset",
          "old_text": null,
          "new_text": "vout_display_Reset(vd)",
          "old_line_content": "    if (is_filled == osys->cfg.is_display_filled)",
          "new_line_content": "        vout_display_Reset(vd);",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": null,
          "new_api": "vout_display_Control",
          "old_text": null,
          "new_text": "vout_display_Control(vd, VOUT_DISPLAY_CHANGE_ZOOM)",
          "old_line_content": "     && osys->cfg.zoom.num == num && osys->cfg.zoom.den == den)",
          "new_line_content": "    if (vout_display_Control(vd, VOUT_DISPLAY_CHANGE_ZOOM))",
          "content_same": false
        },
        {
          "line": 593,
          "old_api": null,
          "new_api": "vout_display_Reset",
          "old_text": null,
          "new_text": "vout_display_Reset(vd)",
          "old_line_content": "        return; /* nothing to do */",
          "new_line_content": "        vout_display_Reset(vd);",
          "content_same": false
        },
        {
          "line": 604,
          "old_api": null,
          "new_api": "vlc_ureduce",
          "old_text": null,
          "new_text": "vlc_ureduce(&sar_num, &sar_den, sar_num, sar_den, 0)",
          "old_line_content": "",
          "new_line_content": "        vlc_ureduce(&sar_num, &sar_den, sar_num, sar_den, 0);",
          "content_same": false
        },
        {
          "line": 610,
          "old_api": null,
          "new_api": "vout_SetSourceAspect",
          "old_text": null,
          "new_text": "vout_SetSourceAspect(vd, sar_num, sar_den)",
          "old_line_content": "    } else {",
          "new_line_content": "    if (vout_SetSourceAspect(vd, sar_num, sar_den))",
          "content_same": false
        },
        {
          "line": 611,
          "old_api": null,
          "new_api": "vout_display_Reset",
          "old_text": null,
          "new_text": "vout_display_Reset(vd)",
          "old_line_content": "        sar_num = 0;",
          "new_line_content": "        vout_display_Reset(vd);",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": null,
          "new_api": "container_of",
          "old_text": null,
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "}",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 619,
          "old_api": null,
          "new_api": "vout_CropEqual",
          "old_text": null,
          "new_text": "vout_CropEqual(crop, &osys->crop)",
          "old_line_content": "void vout_SetDisplayCrop(vout_display_t *vd,",
          "new_line_content": "    if (!vout_CropEqual(crop, &osys->crop)) {",
          "content_same": false
        },
        {
          "line": 623,
          "old_api": null,
          "new_api": "vout_display_Reset",
          "old_text": null,
          "new_text": "vout_display_Reset(vd)",
          "old_line_content": "",
          "new_line_content": "            vout_display_Reset(vd);",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": null,
          "new_api": "container_of",
          "old_text": null,
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "}",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 642,
          "old_api": null,
          "new_api": "set_viewpoint",
          "old_text": null,
          "new_text": "vd->ops->set_viewpoint(vd, &osys->cfg.viewpoint)",
          "old_line_content": "",
          "new_line_content": "            if (vd->ops->set_viewpoint(vd, &osys->cfg.viewpoint)) {",
          "content_same": false
        },
        {
          "line": 643,
          "old_api": null,
          "new_api": "msg_Err",
          "old_text": null,
          "new_text": "msg_Err(vd, \"Failed to change Viewpoint\")",
          "old_line_content": "        osys->cfg.viewpoint = *p_viewpoint;",
          "new_line_content": "                msg_Err(vd, \"Failed to change Viewpoint\");",
          "content_same": false
        },
        {
          "line": 133,
          "old_api": null,
          "new_api": "vout_display_GetDefaultDisplaySize",
          "old_text": null,
          "new_text": "vout_display_GetDefaultDisplaySize(&display_width, &display_height,\n                                           source, cfg)",
          "old_line_content": "        vout_display_cfg_t cfg_tmp = *cfg;",
          "new_line_content": "        vout_display_GetDefaultDisplaySize(&display_width, &display_height,",
          "content_same": false
        },
        {
          "line": 657,
          "old_api": null,
          "new_api": "vlc_custom_create",
          "old_text": null,
          "new_text": "vlc_custom_create(parent, sizeof (*osys),\n                                                  \"vout display\")",
          "old_line_content": "                                 vlc_video_context *vctx,",
          "new_line_content": "    vout_display_priv_t *osys = vlc_custom_create(parent, sizeof (*osys),",
          "content_same": false
        },
        {
          "line": 659,
          "old_api": null,
          "new_api": "unlikely",
          "old_text": null,
          "new_text": "unlikely(osys == NULL)",
          "old_line_content": "                                 const char *module,",
          "new_line_content": "    if (unlikely(osys == NULL))",
          "content_same": false
        },
        {
          "line": 663,
          "old_api": null,
          "new_api": "vout_display_GetDefaultDisplaySize",
          "old_text": null,
          "new_text": "vout_display_GetDefaultDisplaySize(&display_width, &display_height,\n                                       source, cfg)",
          "old_line_content": "                                                  \"vout display\");",
          "new_line_content": "    vout_display_GetDefaultDisplaySize(&display_width, &display_height,",
          "content_same": false
        },
        {
          "line": 675,
          "old_api": null,
          "new_api": "video_format_Copy",
          "old_text": null,
          "new_text": "video_format_Copy(&osys->source, source)",
          "old_line_content": "    osys->cfg.display.height = display_height;",
          "new_line_content": "    video_format_Copy(&osys->source, source);",
          "content_same": false
        },
        {
          "line": 678,
          "old_api": null,
          "new_api": "vlc_video_context_Hold",
          "old_text": null,
          "new_text": "vlc_video_context_Hold( vctx )",
          "old_line_content": "    osys->pool = NULL;",
          "new_line_content": "    osys->src_vctx = vctx ? vlc_video_context_Hold( vctx ) : NULL;",
          "content_same": false
        },
        {
          "line": 691,
          "old_api": null,
          "new_api": "vlc_module_load",
          "old_text": null,
          "new_text": "vlc_module_load(vd, \"vout display\", module, module && *module != '\\0',\n                        vout_display_start, osys)",
          "old_line_content": "    vd->ops = NULL;",
          "new_line_content": "    if (vlc_module_load(vd, \"vout display\", module, module && *module != '\\0',",
          "content_same": false
        },
        {
          "line": 695,
          "old_api": null,
          "new_api": "VoutDisplayCreateRender",
          "old_text": null,
          "new_text": "VoutDisplayCreateRender(vd)",
          "old_line_content": "",
          "new_line_content": "    if (VoutDisplayCreateRender(vd)) {",
          "content_same": false
        },
        {
          "line": 697,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "vd->ops->close(vd)",
          "old_line_content": "                        vout_display_start, osys) == NULL)",
          "new_line_content": "            vd->ops->close(vd);",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": null,
          "new_api": "restrict",
          "old_text": null,
          "new_text": "restrict",
          "old_line_content": "        break;",
          "new_line_content": "void vout_display_TranslateCoordinates(int *restrict xp, int *restrict yp,",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": null,
          "new_api": "restrict",
          "old_text": null,
          "new_text": "restrict",
          "old_line_content": "    }",
          "new_line_content": "                                       const video_format_t *restrict source,",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": null,
          "new_api": "restrict",
          "old_text": null,
          "new_text": "restrict",
          "old_line_content": "}",
          "new_line_content": "                                       const vout_display_cfg_t *restrict cfg)",
          "content_same": false
        },
        {
          "line": 698,
          "old_api": null,
          "new_api": "VLC_OBJECT",
          "old_text": null,
          "new_text": "VLC_OBJECT(vd)",
          "old_line_content": "        goto error;",
          "new_line_content": "        vlc_objres_clear(VLC_OBJECT(vd));",
          "content_same": false
        },
        {
          "line": 699,
          "old_api": null,
          "new_api": "video_format_Clean",
          "old_text": null,
          "new_text": "video_format_Clean(&osys->display_fmt)",
          "old_line_content": "",
          "new_line_content": "        video_format_Clean(&osys->display_fmt);",
          "content_same": false
        },
        {
          "line": 705,
          "old_api": null,
          "new_api": "vlc_object_delete",
          "old_text": null,
          "new_text": "vlc_object_delete(vd)",
          "old_line_content": "        goto error;",
          "new_line_content": "    vlc_object_delete(vd);",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": null,
          "new_api": "container_of",
          "old_text": null,
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "    return NULL;",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 715,
          "old_api": null,
          "new_api": "vlc_video_context_Release",
          "old_text": null,
          "new_text": "vlc_video_context_Release( osys->src_vctx )",
          "old_line_content": "{",
          "new_line_content": "        vlc_video_context_Release( osys->src_vctx );",
          "content_same": false
        },
        {
          "line": 723,
          "old_api": null,
          "new_api": "picture_pool_Release",
          "old_text": null,
          "new_text": "picture_pool_Release(osys->pool)",
          "old_line_content": "",
          "new_line_content": "        picture_pool_Release(osys->pool);",
          "content_same": false
        },
        {
          "line": 726,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "vd->ops->close(vd)",
          "old_line_content": "",
          "new_line_content": "        vd->ops->close(vd);",
          "content_same": false
        },
        {
          "line": 727,
          "old_api": null,
          "new_api": "VLC_OBJECT",
          "old_text": null,
          "new_text": "VLC_OBJECT(vd)",
          "old_line_content": "    if (osys->pool != NULL)",
          "new_line_content": "    vlc_objres_clear(VLC_OBJECT(vd));",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": null,
          "new_api": "video_format_Clean",
          "old_text": null,
          "new_text": "video_format_Clean(&osys->source)",
          "old_line_content": "",
          "new_line_content": "    video_format_Clean(&osys->source);",
          "content_same": false
        },
        {
          "line": 730,
          "old_api": null,
          "new_api": "video_format_Clean",
          "old_text": null,
          "new_text": "video_format_Clean(&osys->display_fmt)",
          "old_line_content": "    if (vd->ops->close != NULL)",
          "new_line_content": "    video_format_Clean(&osys->display_fmt);",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": null,
          "new_api": "vlc_assert_unreachable",
          "old_text": null,
          "new_text": "vlc_assert_unreachable()",
          "old_line_content": "        case ORIENT_RIGHT_BOTTOM:",
          "new_line_content": "            vlc_assert_unreachable();",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": null,
          "new_api": "vout_display_TranslateCoordinates",
          "old_text": null,
          "new_text": "vout_display_TranslateCoordinates(&video->i_x, &video->i_y, vd->source,\n                                      vd->cfg)",
          "old_line_content": "",
          "new_line_content": "    vout_display_TranslateCoordinates(&video->i_x, &video->i_y, vd->source,",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": null,
          "new_api": "va_arg",
          "old_text": null,
          "new_text": "va_arg(ap, vout_display_priv_t *)",
          "old_line_content": "} vout_display_priv_t;",
          "new_line_content": "    vout_display_priv_t *osys = va_arg(ap, vout_display_priv_t *);",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": null,
          "new_api": "activate",
          "old_text": null,
          "new_text": "activate(vd, &osys->display_fmt, context)",
          "old_line_content": "",
          "new_line_content": "    int ret = activate(vd, &osys->display_fmt, context);",
          "content_same": false
        },
        {
          "line": 284,
          "old_api": null,
          "new_api": "VLC_OBJECT",
          "old_text": null,
          "new_text": "VLC_OBJECT(vd)",
          "old_line_content": "    vd->obj.force = forced; /* TODO: pass to activate() instead? */",
          "new_line_content": "        vlc_objres_clear(VLC_OBJECT(vd));",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": null,
          "new_api": "VLC_UNUSED",
          "old_text": null,
          "new_text": "VLC_UNUSED(o)",
          "old_line_content": "    return ret;",
          "new_line_content": "    VLC_UNUSED(o);",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": null,
          "new_api": "container_of",
          "old_text": null,
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": null,
          "new_api": "vlc_video_context_HoldDevice",
          "old_text": null,
          "new_text": "vlc_video_context_HoldDevice(osys->src_vctx)",
          "old_line_content": "static vlc_decoder_device * DisplayHoldDecoderDevice(vlc_object_t *o, void *sys)",
          "new_line_content": "    return osys->src_vctx ? vlc_video_context_HoldDevice(osys->src_vctx) : NULL;",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": null,
          "new_api": "container_of",
          "old_text": null,
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "    VideoBufferNew, DisplayHoldDecoderDevice,",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": null,
          "new_api": "filter_chain_NewVideo",
          "old_text": null,
          "new_text": "filter_chain_NewVideo(vd, false, &owner)",
          "old_line_content": "    filter_owner_t owner = {",
          "new_line_content": "    osys->converters = filter_chain_NewVideo(vd, false, &owner);",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": null,
          "new_api": "unlikely",
          "old_text": null,
          "new_text": "unlikely(osys->converters == NULL)",
          "old_line_content": "        .video = &vout_display_filter_cbs,",
          "new_line_content": "    if (unlikely(osys->converters == NULL))",
          "content_same": false
        },
        {
          "line": 321,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(&v_src, &v_dst, sizeof(v_src))",
          "old_line_content": "",
          "new_line_content": "    const bool convert = memcmp(&v_src, &v_dst, sizeof(v_src)) != 0;",
          "content_same": false
        },
        {
          "line": 325,
          "old_api": null,
          "new_api": "msg_Dbg",
          "old_text": null,
          "new_text": "msg_Dbg(vd, \"A filter to adapt decoder %4.4s to display %4.4s is needed\",\n            (const char *)&v_src.i_chroma, (const char *)&v_dst.i_chroma)",
          "old_line_content": "",
          "new_line_content": "    msg_Dbg(vd, \"A filter to adapt decoder %4.4s to display %4.4s is needed\",",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": null,
          "new_api": "es_format_InitFromVideo",
          "old_text": null,
          "new_text": "es_format_InitFromVideo(&dst, &v_dst)",
          "old_line_content": "    es_format_t src;",
          "new_line_content": "    es_format_InitFromVideo(&dst, &v_dst);",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": null,
          "new_api": "filter_chain_Reset",
          "old_text": null,
          "new_text": "filter_chain_Reset(osys->converters, &src, osys->src_vctx, &dst)",
          "old_line_content": "",
          "new_line_content": "    filter_chain_Reset(osys->converters, &src, osys->src_vctx, &dst);",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": null,
          "new_api": "filter_chain_AppendConverter",
          "old_text": null,
          "new_text": "filter_chain_AppendConverter(osys->converters, &dst)",
          "old_line_content": "    /* */",
          "new_line_content": "    int ret = filter_chain_AppendConverter(osys->converters, &dst);",
          "content_same": false
        },
        {
          "line": 338,
          "old_api": null,
          "new_api": "es_format_Clean",
          "old_text": null,
          "new_text": "es_format_Clean(&dst)",
          "old_line_content": "    es_format_t dst;",
          "new_line_content": "    es_format_Clean(&dst);",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": null,
          "new_api": "container_of",
          "old_text": null,
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "/**",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 377,
          "old_api": null,
          "new_api": "picture_pool_NewFromFormat",
          "old_text": null,
          "new_text": "picture_pool_NewFromFormat(vd->fmt, count)",
          "old_line_content": "picture_pool_t *vout_GetPool(vout_display_t *vd, unsigned count)",
          "new_line_content": "        osys->pool = picture_pool_NewFromFormat(vd->fmt, count);",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": null,
          "new_api": "container_of",
          "old_text": null,
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "    return osys->pool;",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": null,
          "new_api": "filter_chain_IsEmpty",
          "old_text": null,
          "new_text": "filter_chain_IsEmpty(osys->converters)",
          "old_line_content": "",
          "new_line_content": "    return osys->converters == NULL || !filter_chain_IsEmpty(osys->converters);",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": null,
          "new_api": "picture_Release",
          "old_text": null,
          "new_text": "picture_Release(picture)",
          "old_line_content": "picture_t *vout_ConvertForDisplay(vout_display_t *vd, picture_t *picture)",
          "new_line_content": "        picture_Release(picture);",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": null,
          "new_api": "filter_chain_VideoFilter",
          "old_text": null,
          "new_text": "filter_chain_VideoFilter(osys->converters, picture)",
          "old_line_content": "    if (osys->converters == NULL) {",
          "new_line_content": "    return filter_chain_VideoFilter(osys->converters, picture);",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(subpic == NULL)",
          "old_line_content": "}",
          "new_line_content": "    assert(subpic == NULL); /* TODO */",
          "content_same": false
        },
        {
          "line": 404,
          "old_api": null,
          "new_api": "vout_ConvertForDisplay",
          "old_text": null,
          "new_text": "vout_ConvertForDisplay(vd, picture)",
          "old_line_content": "",
          "new_line_content": "    picture = vout_ConvertForDisplay(vd, picture);",
          "content_same": false
        },
        {
          "line": 407,
          "old_api": null,
          "new_api": "prepare",
          "old_text": null,
          "new_text": "vd->ops->prepare(vd, picture, subpic, date)",
          "old_line_content": "{",
          "new_line_content": "        vd->ops->prepare(vd, picture, subpic, date);",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": null,
          "new_api": "container_of",
          "old_text": null,
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "    return picture;",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": null,
          "new_api": "filter_chain_VideoFlush",
          "old_text": null,
          "new_text": "filter_chain_VideoFlush(osys->converters)",
          "old_line_content": "void vout_FilterFlush(vout_display_t *vd)",
          "new_line_content": "        filter_chain_VideoFlush(osys->converters);",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": null,
          "new_api": "filter_chain_Delete",
          "old_text": null,
          "new_text": "filter_chain_Delete(osys->converters)",
          "old_line_content": "static void vout_display_Reset(vout_display_t *vd)",
          "new_line_content": "        filter_chain_Delete(osys->converters);",
          "content_same": false
        },
        {
          "line": 433,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(vd->ops->reset_pictures)",
          "old_line_content": "    if (osys->pool != NULL) {",
          "new_line_content": "    assert(vd->ops->reset_pictures);",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": null,
          "new_api": "VoutDisplayCreateRender",
          "old_text": null,
          "new_text": "VoutDisplayCreateRender(vd)",
          "old_line_content": "        osys->pool = NULL;",
          "new_line_content": "     || VoutDisplayCreateRender(vd))",
          "content_same": false
        },
        {
          "line": 436,
          "old_api": null,
          "new_api": "msg_Err",
          "old_text": null,
          "new_text": "msg_Err(vd, \"Failed to adjust render format\")",
          "old_line_content": "    }",
          "new_line_content": "        msg_Err(vd, \"Failed to adjust render format\");",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": null,
          "new_api": "VLC_OBJECT",
          "old_text": null,
          "new_text": "VLC_OBJECT(vd)",
          "old_line_content": "static int vout_UpdateSourceCrop(vout_display_t *vd)",
          "new_line_content": "    video_format_Print(VLC_OBJECT(vd), \"SOURCE \", &osys->source);",
          "content_same": false
        },
        {
          "line": 453,
          "old_api": null,
          "new_api": "VoutDisplayCropRatio",
          "old_text": null,
          "new_text": "VoutDisplayCropRatio(&left, &top, &right, &bottom, &osys->source,\n                                 osys->crop.ratio.num, osys->crop.ratio.den)",
          "old_line_content": "            left = top = 0;",
          "new_line_content": "            VoutDisplayCropRatio(&left, &top, &right, &bottom, &osys->source,",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": null,
          "new_api": "vlc_assert_unreachable",
          "old_text": null,
          "new_text": "vlc_assert_unreachable()",
          "old_line_content": "            right = osys->source.i_visible_width - osys->crop.border.right;",
          "new_line_content": "            vlc_assert_unreachable();",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": null,
          "new_api": "VLC_OBJECT",
          "old_text": null,
          "new_text": "VLC_OBJECT(vd)",
          "old_line_content": "",
          "new_line_content": "    video_format_Print(VLC_OBJECT(vd), \"CROPPED \", &osys->source);",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": null,
          "new_api": "vout_display_Control",
          "old_text": null,
          "new_text": "vout_display_Control(vd, VOUT_DISPLAY_CHANGE_SOURCE_CROP)",
          "old_line_content": "    osys->source.i_y_offset += top;",
          "new_line_content": "    return vout_display_Control(vd, VOUT_DISPLAY_CHANGE_SOURCE_CROP);",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": null,
          "new_api": "container_of",
          "old_text": null,
          "new_text": "container_of(vd, vout_display_priv_t, display)",
          "old_line_content": "}",
          "new_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": null,
          "new_api": "vout_display_Control",
          "old_text": null,
          "new_text": "vout_display_Control(vd, VOUT_DISPLAY_CHANGE_SOURCE_ASPECT)",
          "old_line_content": "    if (sar_num > 0 && sar_den > 0) {",
          "new_line_content": "    if (vout_display_Control(vd, VOUT_DISPLAY_CHANGE_SOURCE_ASPECT))",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": null,
          "new_api": "vout_UpdateSourceCrop",
          "old_text": null,
          "new_text": "vout_UpdateSourceCrop(vd)",
          "old_line_content": "",
          "new_line_content": "    if (osys->crop.mode != VOUT_CROP_NONE && vout_UpdateSourceCrop(vd))",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 515,
          "old_api": "vout_UpdateSourceCrop",
          "new_api": null,
          "old_text": "vout_UpdateSourceCrop(vd)",
          "new_text": null,
          "old_line_content": "    if (osys->crop.mode != VOUT_CROP_NONE && vout_UpdateSourceCrop(vd))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 523,
          "old_api": "vlc_ureduce",
          "new_api": null,
          "old_text": "vlc_ureduce( &fmt->i_sar_num, &fmt->i_sar_den,\n                 fmt->i_sar_num,  fmt->i_sar_den, 50000 )",
          "new_text": null,
          "old_line_content": "    vlc_ureduce( &fmt->i_sar_num, &fmt->i_sar_den,",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "    if (fixed_src.i_sar_num * osys->source.i_sar_den !=",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": "VoutFixFormatAR",
          "new_api": null,
          "old_text": "VoutFixFormatAR( &fixed_src )",
          "new_text": null,
          "old_line_content": "    VoutFixFormatAR( &fixed_src );",
          "new_line_content": "        osys->source.i_sar_num = fixed_src.i_sar_num;",
          "content_same": false
        },
        {
          "line": 545,
          "old_api": "vout_SetSourceAspect",
          "new_api": null,
          "old_text": "vout_SetSourceAspect(vd, osys->source.i_sar_num,\n                                    osys->source.i_sar_den)",
          "new_text": null,
          "old_line_content": "        err1 = vout_SetSourceAspect(vd, osys->source.i_sar_num,",
          "new_line_content": "        source->i_y_offset       != osys->source.i_y_offset ||",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": "video_format_CopyCrop",
          "new_api": null,
          "old_text": "video_format_CopyCrop(&osys->source, source)",
          "new_text": null,
          "old_line_content": "        video_format_CopyCrop(&osys->source, source);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 558,
          "old_api": "vout_UpdateSourceCrop",
          "new_api": null,
          "old_text": "vout_UpdateSourceCrop(vd)",
          "new_text": null,
          "old_line_content": "        err2 = vout_UpdateSourceCrop(vd);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": "vout_display_Control",
          "new_api": null,
          "old_text": "vout_display_Control(vd, VOUT_DISPLAY_CHANGE_DISPLAY_SIZE)",
          "new_text": null,
          "old_line_content": "    if (vout_display_Control(vd, VOUT_DISPLAY_CHANGE_DISPLAY_SIZE))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 577,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "    osys->cfg.is_display_filled = is_filled;",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": "vout_display_Control",
          "new_api": null,
          "old_text": "vout_display_Control(vd, VOUT_DISPLAY_CHANGE_DISPLAY_FILLED)",
          "new_text": null,
          "old_line_content": "    if (vout_display_Control(vd, VOUT_DISPLAY_CHANGE_DISPLAY_FILLED))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "vout_display_Control",
          "new_api": null,
          "old_text": "vout_display_Control(vd, VOUT_DISPLAY_CHANGE_ZOOM)",
          "new_text": null,
          "old_line_content": "    if (vout_display_Control(vd, VOUT_DISPLAY_CHANGE_ZOOM))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 603,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "        sar_den = dar_den * osys->source.i_visible_width;",
          "content_same": false
        },
        {
          "line": 609,
          "old_api": "vlc_ureduce",
          "new_api": null,
          "old_text": "vlc_ureduce(&sar_num, &sar_den, sar_num, sar_den, 0)",
          "new_text": null,
          "old_line_content": "        vlc_ureduce(&sar_num, &sar_den, sar_num, sar_den, 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 616,
          "old_api": "vout_display_Reset",
          "new_api": null,
          "old_text": "vout_display_Reset(vd)",
          "new_text": null,
          "old_line_content": "        vout_display_Reset(vd);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 620,
          "old_api": "restrict",
          "new_api": null,
          "old_text": "restrict",
          "new_text": null,
          "old_line_content": "                         const struct vout_crop *restrict crop)",
          "new_line_content": "        osys->crop = *crop;",
          "content_same": false
        },
        {
          "line": 624,
          "old_api": "vout_CropEqual",
          "new_api": null,
          "old_text": "vout_CropEqual(crop, &osys->crop)",
          "new_text": null,
          "old_line_content": "    if (!vout_CropEqual(crop, &osys->crop)) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 627,
          "old_api": "vout_UpdateSourceCrop",
          "new_api": null,
          "old_text": "vout_UpdateSourceCrop(vd)",
          "new_text": null,
          "old_line_content": "        if (vout_UpdateSourceCrop(vd))",
          "new_line_content": "void vout_SetDisplayViewpoint(vout_display_t *vd,",
          "content_same": false
        },
        {
          "line": 628,
          "old_api": "vout_display_Reset",
          "new_api": null,
          "old_text": "vout_display_Reset(vd)",
          "new_text": null,
          "old_line_content": "            vout_display_Reset(vd);",
          "new_line_content": "                              const vlc_viewpoint_t *p_viewpoint)",
          "content_same": false
        },
        {
          "line": 635,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "        osys->cfg.viewpoint.fov   != p_viewpoint->fov) {",
          "content_same": false
        },
        {
          "line": 647,
          "old_api": "set_viewpoint",
          "new_api": null,
          "old_text": "vd->ops->set_viewpoint(vd, &osys->cfg.viewpoint)",
          "new_text": null,
          "old_line_content": "            if (vd->ops->set_viewpoint(vd, &osys->cfg.viewpoint)) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 648,
          "old_api": "msg_Err",
          "new_api": null,
          "old_text": "msg_Err(vd, \"Failed to change Viewpoint\")",
          "new_text": null,
          "old_line_content": "                msg_Err(vd, \"Failed to change Viewpoint\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 137,
          "old_api": "vout_display_GetDefaultDisplaySize",
          "new_api": null,
          "old_text": "vout_display_GetDefaultDisplaySize(&display_width, &display_height,\n                                           source, &cfg_tmp)",
          "new_text": null,
          "old_line_content": "        vout_display_GetDefaultDisplaySize(&display_width, &display_height,",
          "new_line_content": "    const unsigned height = source->i_visible_height;",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": "vlc_custom_create",
          "new_api": null,
          "old_text": "vlc_custom_create(parent, sizeof (*osys),\n                                                  \"vout display\")",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = vlc_custom_create(parent, sizeof (*osys),",
          "new_line_content": "    unsigned display_width, display_height;",
          "content_same": false
        },
        {
          "line": 664,
          "old_api": "unlikely",
          "new_api": null,
          "old_text": "unlikely(osys == NULL)",
          "new_text": null,
          "old_line_content": "    if (unlikely(osys == NULL))",
          "new_line_content": "                                       source, cfg);",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": "vout_display_GetDefaultDisplaySize",
          "new_api": null,
          "old_text": "vout_display_GetDefaultDisplaySize(&display_width, &display_height,\n                                       source, cfg)",
          "new_text": null,
          "old_line_content": "    vout_display_GetDefaultDisplaySize(&display_width, &display_height,",
          "new_line_content": "     * favor of the calculated display size. */",
          "content_same": false
        },
        {
          "line": 680,
          "old_api": "video_format_Copy",
          "new_api": null,
          "old_text": "video_format_Copy(&osys->source, source)",
          "new_text": null,
          "old_line_content": "    video_format_Copy(&osys->source, source);",
          "new_line_content": "    /* */",
          "content_same": false
        },
        {
          "line": 683,
          "old_api": "vlc_video_context_Hold",
          "new_api": null,
          "old_text": "vlc_video_context_Hold( vctx )",
          "new_text": null,
          "old_line_content": "    osys->src_vctx = vctx ? vlc_video_context_Hold( vctx ) : NULL;",
          "new_line_content": "    vd->fmt = &osys->display_fmt;",
          "content_same": false
        },
        {
          "line": 696,
          "old_api": "vlc_module_load",
          "new_api": null,
          "old_text": "vlc_module_load(vd, \"vout display\", module, module && *module != '\\0',\n                        vout_display_start, osys)",
          "new_text": null,
          "old_line_content": "    if (vlc_module_load(vd, \"vout display\", module, module && *module != '\\0',",
          "new_line_content": "        if (vd->ops->close != NULL)",
          "content_same": false
        },
        {
          "line": 700,
          "old_api": "VoutDisplayCreateRender",
          "new_api": null,
          "old_text": "VoutDisplayCreateRender(vd)",
          "new_text": null,
          "old_line_content": "    if (VoutDisplayCreateRender(vd)) {",
          "new_line_content": "        goto error;",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": "close",
          "new_api": null,
          "old_text": "vd->ops->close(vd)",
          "new_text": null,
          "old_line_content": "            vd->ops->close(vd);",
          "new_line_content": "    return vd;",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "restrict",
          "new_api": null,
          "old_text": "restrict",
          "new_text": null,
          "old_line_content": "void vout_display_TranslateCoordinates(int *restrict xp, int *restrict yp,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 703,
          "old_api": "VLC_OBJECT",
          "new_api": null,
          "old_text": "VLC_OBJECT(vd)",
          "new_text": null,
          "old_line_content": "        vlc_objres_clear(VLC_OBJECT(vd));",
          "new_line_content": "error:",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": "restrict",
          "new_api": null,
          "old_text": "restrict",
          "new_text": null,
          "old_line_content": "                                       const vout_display_cfg_t *restrict cfg)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": "vout_display_PlacePicture",
          "new_api": null,
          "old_text": "vout_display_PlacePicture(&place, source, cfg)",
          "new_text": null,
          "old_line_content": "    vout_display_PlacePicture(&place, source, cfg);",
          "new_line_content": "    const int wx = *xp, wy = *yp;",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": "video_format_Clean",
          "new_api": null,
          "old_text": "video_format_Clean(&osys->source)",
          "new_text": null,
          "old_line_content": "    video_format_Clean(&osys->source);",
          "new_line_content": "void vout_display_Delete(vout_display_t *vd)",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": "vlc_object_delete",
          "new_api": null,
          "old_text": "vlc_object_delete(vd)",
          "new_text": null,
          "old_line_content": "    vlc_object_delete(vd);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 716,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "        osys->src_vctx = NULL;",
          "content_same": false
        },
        {
          "line": 725,
          "old_api": "filter_chain_Delete",
          "new_api": null,
          "old_text": "filter_chain_Delete(osys->converters)",
          "new_text": null,
          "old_line_content": "        filter_chain_Delete(osys->converters);",
          "new_line_content": "    if (vd->ops->close != NULL)",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "picture_pool_Release",
          "new_api": null,
          "old_text": "picture_pool_Release(osys->pool)",
          "new_text": null,
          "old_line_content": "        picture_pool_Release(osys->pool);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 732,
          "old_api": "VLC_OBJECT",
          "new_api": null,
          "old_text": "VLC_OBJECT(vd)",
          "new_text": null,
          "old_line_content": "    vlc_objres_clear(VLC_OBJECT(vd));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 734,
          "old_api": "video_format_Clean",
          "new_api": null,
          "old_text": "video_format_Clean(&osys->source)",
          "new_text": null,
          "old_line_content": "    video_format_Clean(&osys->source);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": "video_format_Clean",
          "new_api": null,
          "old_text": "video_format_Clean(&osys->display_fmt)",
          "new_text": null,
          "old_line_content": "    video_format_Clean(&osys->display_fmt);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 736,
          "old_api": "vlc_object_delete",
          "new_api": null,
          "old_text": "vlc_object_delete(vd)",
          "new_text": null,
          "old_line_content": "    vlc_object_delete(vd);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": "vlc_assert_unreachable",
          "new_api": null,
          "old_text": "vlc_assert_unreachable()",
          "new_text": null,
          "old_line_content": "            vlc_assert_unreachable();",
          "new_line_content": "    y = source->i_y_offset",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": "vout_display_TranslateCoordinates",
          "new_api": null,
          "old_text": "vout_display_TranslateCoordinates(&video->i_x, &video->i_y, vd->source,\n                                      vd->cfg)",
          "new_text": null,
          "old_line_content": "    vout_display_TranslateCoordinates(&video->i_x, &video->i_y, vd->source,",
          "new_line_content": "    vout_display_t  display;",
          "content_same": false
        },
        {
          "line": 286,
          "old_api": "activate",
          "new_api": null,
          "old_text": "activate(vd, &osys->display_fmt, context)",
          "new_text": null,
          "old_line_content": "    int ret = activate(vd, &osys->display_fmt, context);",
          "new_line_content": "    return ret;",
          "content_same": false
        },
        {
          "line": 288,
          "old_api": "video_format_Clean",
          "new_api": null,
          "old_text": "video_format_Clean(&osys->display_fmt)",
          "new_text": null,
          "old_line_content": "        video_format_Clean(&osys->display_fmt);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 289,
          "old_api": "VLC_OBJECT",
          "new_api": null,
          "old_text": "VLC_OBJECT(vd)",
          "new_text": null,
          "old_line_content": "        vlc_objres_clear(VLC_OBJECT(vd));",
          "new_line_content": "static vlc_decoder_device * DisplayHoldDecoderDevice(vlc_object_t *o, void *sys)",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": "VLC_UNUSED",
          "new_api": null,
          "old_text": "VLC_UNUSED(o)",
          "new_text": null,
          "old_line_content": "    VLC_UNUSED(o);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "    VideoBufferNew, DisplayHoldDecoderDevice,",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": "vlc_video_context_HoldDevice",
          "new_api": null,
          "old_text": "vlc_video_context_HoldDevice(osys->src_vctx)",
          "new_text": null,
          "old_line_content": "    return osys->src_vctx ? vlc_video_context_HoldDevice(osys->src_vctx) : NULL;",
          "new_line_content": "};",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": "filter_chain_NewVideo",
          "new_api": null,
          "old_text": "filter_chain_NewVideo(vd, false, &owner)",
          "new_text": null,
          "old_line_content": "    osys->converters = filter_chain_NewVideo(vd, false, &owner);",
          "new_line_content": "    v_src.i_sar_num = 0;",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": "unlikely",
          "new_api": null,
          "old_text": "unlikely(osys->converters == NULL)",
          "new_text": null,
          "old_line_content": "    if (unlikely(osys->converters == NULL))",
          "new_line_content": "    v_src.i_sar_den = 0;",
          "content_same": false
        },
        {
          "line": 326,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(&v_src, &v_dst, sizeof(v_src))",
          "new_text": null,
          "old_line_content": "    const bool convert = memcmp(&v_src, &v_dst, sizeof(v_src)) != 0;",
          "new_line_content": "            (const char *)&v_src.i_chroma, (const char *)&v_dst.i_chroma);",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": "es_format_InitFromVideo",
          "new_api": null,
          "old_text": "es_format_InitFromVideo(&src, &v_src)",
          "new_text": null,
          "old_line_content": "    es_format_InitFromVideo(&src, &v_src);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": "filter_chain_Reset",
          "new_api": null,
          "old_text": "filter_chain_Reset(osys->converters, &src, osys->src_vctx, &dst)",
          "new_text": null,
          "old_line_content": "    filter_chain_Reset(osys->converters, &src, osys->src_vctx, &dst);",
          "new_line_content": "    if (ret != 0) {",
          "content_same": false
        },
        {
          "line": 344,
          "old_api": "es_format_Clean",
          "new_api": null,
          "old_text": "es_format_Clean(&src)",
          "new_text": null,
          "old_line_content": "    es_format_Clean(&src);",
          "new_line_content": "        osys->converters = NULL;",
          "content_same": false
        },
        {
          "line": 347,
          "old_api": "msg_Err",
          "new_api": null,
          "old_text": "msg_Err(vd, \"Failed to adapt decoder format to display\")",
          "new_text": null,
          "old_line_content": "        msg_Err(vd, \"Failed to adapt decoder format to display\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": "filter_chain_Delete",
          "new_api": null,
          "old_text": "filter_chain_Delete(osys->converters)",
          "new_text": null,
          "old_line_content": "        filter_chain_Delete(osys->converters);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": "picture_pool_NewFromFormat",
          "new_api": null,
          "old_text": "picture_pool_NewFromFormat(vd->fmt, count)",
          "new_text": null,
          "old_line_content": "        osys->pool = picture_pool_NewFromFormat(vd->fmt, count);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "picture_t *vout_ConvertForDisplay(vout_display_t *vd, picture_t *picture)",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": "picture_Release",
          "new_api": null,
          "old_text": "picture_Release(picture)",
          "new_text": null,
          "old_line_content": "        picture_Release(picture);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": "filter_chain_VideoFilter",
          "new_api": null,
          "old_text": "filter_chain_VideoFilter(osys->converters, picture)",
          "new_text": null,
          "old_line_content": "    return filter_chain_VideoFilter(osys->converters, picture);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(subpic == NULL)",
          "new_text": null,
          "old_line_content": "    assert(subpic == NULL); /* TODO */",
          "new_line_content": "    return picture;",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": "vout_ConvertForDisplay",
          "new_api": null,
          "old_text": "vout_ConvertForDisplay(vd, picture)",
          "new_text": null,
          "old_line_content": "    picture = vout_ConvertForDisplay(vd, picture);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": "prepare",
          "new_api": null,
          "old_text": "vd->ops->prepare(vd, picture, subpic, date)",
          "new_text": null,
          "old_line_content": "        vd->ops->prepare(vd, picture, subpic, date);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(vd->ops->reset_pictures)",
          "new_text": null,
          "old_line_content": "    assert(vd->ops->reset_pictures);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": "reset_pictures",
          "new_api": null,
          "old_text": "vd->ops->reset_pictures(vd, &osys->display_fmt)",
          "new_text": null,
          "old_line_content": "    if (vd->ops->reset_pictures(vd, &osys->display_fmt) != VLC_SUCCESS",
          "new_line_content": "static int vout_UpdateSourceCrop(vout_display_t *vd)",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": "VoutDisplayCreateRender",
          "new_api": null,
          "old_text": "VoutDisplayCreateRender(vd)",
          "new_text": null,
          "old_line_content": "     || VoutDisplayCreateRender(vd))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 446,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "    switch (osys->crop.mode) {",
          "content_same": false
        },
        {
          "line": 449,
          "old_api": "VLC_OBJECT",
          "new_api": null,
          "old_text": "VLC_OBJECT(vd)",
          "new_text": null,
          "old_line_content": "    video_format_Print(VLC_OBJECT(vd), \"SOURCE \", &osys->source);",
          "new_line_content": "            right = osys->source.i_visible_width;",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": "VoutDisplayCropRatio",
          "new_api": null,
          "old_text": "VoutDisplayCropRatio(&left, &top, &right, &bottom, &osys->source,\n                                 osys->crop.ratio.num, osys->crop.ratio.den)",
          "new_text": null,
          "old_line_content": "            VoutDisplayCropRatio(&left, &top, &right, &bottom, &osys->source,",
          "new_line_content": "            top = osys->crop.window.y;",
          "content_same": false
        },
        {
          "line": 475,
          "old_api": "vlc_assert_unreachable",
          "new_api": null,
          "old_text": "vlc_assert_unreachable()",
          "new_text": null,
          "old_line_content": "            vlc_assert_unreachable();",
          "new_line_content": "    if (top >= bottom)",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": "VLC_OBJECT",
          "new_api": null,
          "old_text": "VLC_OBJECT(vd)",
          "new_text": null,
          "old_line_content": "    video_format_Print(VLC_OBJECT(vd), \"CROPPED \", &osys->source);",
          "new_line_content": "static int vout_SetSourceAspect(vout_display_t *vd,",
          "content_same": false
        },
        {
          "line": 497,
          "old_api": "vout_display_Control",
          "new_api": null,
          "old_text": "vout_display_Control(vd, VOUT_DISPLAY_CHANGE_SOURCE_CROP)",
          "new_text": null,
          "old_line_content": "    return vout_display_Control(vd, VOUT_DISPLAY_CHANGE_SOURCE_CROP);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": "container_of",
          "new_api": null,
          "old_text": "container_of(vd, vout_display_priv_t, display)",
          "new_text": null,
          "old_line_content": "    vout_display_priv_t *osys = container_of(vd, vout_display_priv_t, display);",
          "new_line_content": "        osys->source.i_sar_den = sar_den;",
          "content_same": false
        },
        {
          "line": 511,
          "old_api": "vout_display_Control",
          "new_api": null,
          "old_text": "vout_display_Control(vd, VOUT_DISPLAY_CHANGE_SOURCE_ASPECT)",
          "new_text": null,
          "old_line_content": "    if (vout_display_Control(vd, VOUT_DISPLAY_CHANGE_SOURCE_ASPECT))",
          "new_line_content": "        ret = -1;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 21,
      "total_additions": 83,
      "total_deletions": 83,
      "total_api_changes": 187
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 187,
        "non_api_lines": 6,
        "non_api_line_numbers": [
          132,
          134,
          135,
          136,
          138,
          139
        ]
      }
    },
    "api_calls_before": 119,
    "api_calls_after": 119,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 7,
      "total_diff_lines": 22
    }
  }
}