{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/e6dc15a1d9b5b4b26a38bde0936c7e43c4e21493",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/e6dc15a1d9b5b4b26a38bde0936c7e43c4e21493/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/e6dc15a1d9b5b4b26a38bde0936c7e43c4e21493/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/e6dc15a1d9b5b4b26a38bde0936c7e43c4e21493/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 190,
          "old_api": "vlc_gl_MakeCurrent (gl)",
          "new_api": "vlc_gl_ReleaseCurrent (gl)",
          "old_text": "vlc_gl_MakeCurrent (gl)",
          "new_text": "vlc_gl_ReleaseCurrent (gl)",
          "old_line_content": "            vlc_gl_MakeCurrent (gl);",
          "new_line_content": "            vlc_gl_ReleaseCurrent (gl);",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": "vlc_gl_ReleaseCurrent (gl)",
          "new_api": "vlc_gl_Release (gl)",
          "old_text": "vlc_gl_ReleaseCurrent (gl)",
          "new_text": "vlc_gl_Release (gl)",
          "old_line_content": "            vlc_gl_ReleaseCurrent (gl);",
          "new_line_content": "        vlc_gl_Release (gl);",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": "CommonClean",
          "new_api": "free",
          "old_text": "CommonClean(vd)",
          "new_text": "free(sys)",
          "old_line_content": "    CommonClean(vd);",
          "new_line_content": "    free(sys);",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": "vlc_gl_MakeCurrent (sys->gl)",
          "new_api": "vout_display_opengl_GetPool",
          "old_text": "vlc_gl_MakeCurrent (sys->gl)",
          "new_text": "vout_display_opengl_GetPool(sys->vgl, count)",
          "old_line_content": "    if (!sys->sys.pool && vlc_gl_MakeCurrent (sys->gl) == VLC_SUCCESS)",
          "new_line_content": "        sys->sys.pool = vout_display_opengl_GetPool(sys->vgl, count);",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": "vlc_gl_MakeCurrent (sys->gl)",
          "new_api": "vout_display_opengl_Prepare (sys->vgl, picture, subpicture)",
          "old_text": "vlc_gl_MakeCurrent (sys->gl)",
          "new_text": "vout_display_opengl_Prepare (sys->vgl, picture, subpicture)",
          "old_line_content": "    if (vlc_gl_MakeCurrent (sys->gl) == VLC_SUCCESS)",
          "new_line_content": "        vout_display_opengl_Prepare (sys->vgl, picture, subpicture);",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": "VLC_UNUSED",
          "new_api": "vlc_gl_MakeCurrent (sys->gl)",
          "old_text": "VLC_UNUSED(picture)",
          "new_text": "vlc_gl_MakeCurrent (sys->gl)",
          "old_line_content": "    VLC_UNUSED(picture);",
          "new_line_content": "    if (vlc_gl_MakeCurrent (sys->gl) == VLC_SUCCESS)",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": "vlc_gl_MakeCurrent (sys->gl)",
          "new_api": "vout_display_opengl_Display (sys->vgl, &vd->source)",
          "old_text": "vlc_gl_MakeCurrent (sys->gl)",
          "new_text": "vout_display_opengl_Display (sys->vgl, &vd->source)",
          "old_line_content": "    if (vlc_gl_MakeCurrent (sys->gl) == VLC_SUCCESS)",
          "new_line_content": "        vout_display_opengl_Display (sys->vgl, &vd->source);",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": "vlc_gl_MakeCurrent (sys->gl)",
          "new_api": "vout_display_opengl_SetWindowAspectRatio",
          "old_text": "vlc_gl_MakeCurrent (sys->gl)",
          "new_text": "vout_display_opengl_SetWindowAspectRatio(sys->vgl, (float)width / height)",
          "old_line_content": "    if (vlc_gl_MakeCurrent (sys->gl) != VLC_SUCCESS)",
          "new_line_content": "    vout_display_opengl_SetWindowAspectRatio(sys->vgl, (float)width / height);",
          "content_same": false
        },
        {
          "line": 255,
          "old_api": "vout_display_opengl_SetWindowAspectRatio",
          "new_api": "vlc_gl_ReleaseCurrent (sys->gl)",
          "old_text": "vout_display_opengl_SetWindowAspectRatio(sys->vgl, (float)width / height)",
          "new_text": "vlc_gl_ReleaseCurrent (sys->gl)",
          "old_line_content": "    vout_display_opengl_SetWindowAspectRatio(sys->vgl, (float)width / height);",
          "new_line_content": "    vlc_gl_ReleaseCurrent (sys->gl);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 224,
          "old_api": null,
          "new_api": "vlc_gl_ReleaseCurrent (sys->gl)",
          "old_text": null,
          "new_text": "vlc_gl_ReleaseCurrent (sys->gl)",
          "old_line_content": "    {",
          "new_line_content": "        vlc_gl_ReleaseCurrent (sys->gl);",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": null,
          "new_api": "vlc_object_release",
          "old_text": null,
          "new_text": "vlc_object_release(surface)",
          "old_line_content": "        }",
          "new_line_content": "        vlc_object_release(surface);",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": null,
          "new_api": "CommonClean",
          "old_text": null,
          "new_text": "CommonClean(vd)",
          "old_line_content": "    }",
          "new_line_content": "    CommonClean(vd);",
          "content_same": false
        },
        {
          "line": 231,
          "old_api": null,
          "new_api": "VLC_UNUSED",
          "old_text": null,
          "new_text": "VLC_UNUSED(picture)",
          "old_line_content": "{",
          "new_line_content": "    VLC_UNUSED(picture);",
          "content_same": false
        },
        {
          "line": 250,
          "old_api": null,
          "new_api": "vlc_gl_Resize (sys->gl, width, height)",
          "old_text": null,
          "new_text": "vlc_gl_Resize (sys->gl, width, height)",
          "old_line_content": "    const int width  = sys->sys.rect_dest.right  - sys->sys.rect_dest.left;",
          "new_line_content": "    vlc_gl_Resize (sys->gl, width, height);",
          "content_same": false
        },
        {
          "line": 171,
          "old_api": null,
          "new_api": "Close",
          "old_text": null,
          "new_text": "Close(vd)",
          "old_line_content": "",
          "new_line_content": "    Close(vd);",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": null,
          "new_api": "vlc_gl_ReleaseCurrent (sys->gl)",
          "old_text": null,
          "new_text": "vlc_gl_ReleaseCurrent (sys->gl)",
          "old_line_content": "    {",
          "new_line_content": "        vlc_gl_ReleaseCurrent (sys->gl);",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": null,
          "new_api": "vlc_gl_MakeCurrent (sys->gl)",
          "old_text": null,
          "new_text": "vlc_gl_MakeCurrent (sys->gl)",
          "old_line_content": "    vout_display_sys_t *sys = vd->sys;",
          "new_line_content": "    if (!sys->sys.pool && vlc_gl_MakeCurrent (sys->gl) == VLC_SUCCESS)",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": null,
          "new_api": "CommonDisplay",
          "old_text": null,
          "new_text": "CommonDisplay(vd)",
          "old_line_content": "    }",
          "new_line_content": "    CommonDisplay(vd);",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": null,
          "new_api": "vlc_gl_ReleaseCurrent (sys->gl)",
          "old_text": null,
          "new_text": "vlc_gl_ReleaseCurrent (sys->gl)",
          "old_line_content": "    {",
          "new_line_content": "        vlc_gl_ReleaseCurrent (sys->gl);",
          "content_same": false
        },
        {
          "line": 246,
          "old_api": null,
          "new_api": "CommonManage",
          "old_text": null,
          "new_text": "CommonManage(vd)",
          "old_line_content": "    vout_display_sys_t *sys = vd->sys;",
          "new_line_content": "    CommonManage(vd);",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": null,
          "new_api": "vlc_gl_MakeCurrent (sys->gl)",
          "old_text": null,
          "new_text": "vlc_gl_MakeCurrent (sys->gl)",
          "old_line_content": "    vout_display_sys_t *sys = vd->sys;",
          "new_line_content": "    if (vlc_gl_MakeCurrent (sys->gl) == VLC_SUCCESS)",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": null,
          "new_api": "Manage",
          "old_text": null,
          "new_text": "Manage(vd)",
          "old_line_content": "                    vlc_tick_t date)",
          "new_line_content": "    Manage(vd);",
          "content_same": false
        },
        {
          "line": 218,
          "old_api": null,
          "new_api": "VLC_UNUSED",
          "old_text": null,
          "new_text": "VLC_UNUSED(date)",
          "old_line_content": "{",
          "new_line_content": "    VLC_UNUSED(date);",
          "content_same": false
        },
        {
          "line": 251,
          "old_api": null,
          "new_api": "vlc_gl_MakeCurrent (sys->gl)",
          "old_text": null,
          "new_text": "vlc_gl_MakeCurrent (sys->gl)",
          "old_line_content": "    const int height = sys->sys.rect_dest.bottom - sys->sys.rect_dest.top;",
          "new_line_content": "    if (vlc_gl_MakeCurrent (sys->gl) != VLC_SUCCESS)",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": null,
          "new_api": "vlc_gl_MakeCurrent (gl)",
          "old_text": null,
          "new_text": "vlc_gl_MakeCurrent (gl)",
          "old_line_content": "        if (sys->vgl)",
          "new_line_content": "            vlc_gl_MakeCurrent (gl);",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": null,
          "new_api": "vout_display_opengl_Delete",
          "old_text": null,
          "new_text": "vout_display_opengl_Delete(sys->vgl)",
          "old_line_content": "        {",
          "new_line_content": "            vout_display_opengl_Delete(sys->vgl);",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": null,
          "new_api": "vout_display_opengl_Viewport",
          "old_text": null,
          "new_text": "vout_display_opengl_Viewport(sys->vgl, 0, 0, width, height)",
          "old_line_content": "        return;",
          "new_line_content": "    vout_display_opengl_Viewport(sys->vgl, 0, 0, width, height);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 256,
          "old_api": "vout_display_opengl_Viewport",
          "new_api": null,
          "old_text": "vout_display_opengl_Viewport(sys->vgl, 0, 0, width, height)",
          "new_text": null,
          "old_line_content": "    vout_display_opengl_Viewport(sys->vgl, 0, 0, width, height);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 257,
          "old_api": "vlc_gl_ReleaseCurrent (sys->gl)",
          "new_api": null,
          "old_text": "vlc_gl_ReleaseCurrent (sys->gl)",
          "new_text": null,
          "old_line_content": "    vlc_gl_ReleaseCurrent (sys->gl);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": "vlc_gl_Release (gl)",
          "new_api": null,
          "old_text": "vlc_gl_Release (gl)",
          "new_text": null,
          "old_line_content": "        vlc_gl_Release (gl);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": "vlc_object_release",
          "new_api": null,
          "old_text": "vlc_object_release(surface)",
          "new_text": null,
          "old_line_content": "        vlc_object_release(surface);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "vout_display_opengl_Prepare (sys->vgl, picture, subpicture)",
          "new_api": null,
          "old_text": "vout_display_opengl_Prepare (sys->vgl, picture, subpicture)",
          "new_text": null,
          "old_line_content": "        vout_display_opengl_Prepare (sys->vgl, picture, subpicture);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": "vlc_gl_ReleaseCurrent (sys->gl)",
          "new_api": null,
          "old_text": "vlc_gl_ReleaseCurrent (sys->gl)",
          "new_text": null,
          "old_line_content": "        vlc_gl_ReleaseCurrent (sys->gl);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(sys)",
          "new_text": null,
          "old_line_content": "    free(sys);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 173,
          "old_api": "Close",
          "new_api": null,
          "old_text": "Close(vd)",
          "new_text": null,
          "old_line_content": "    Close(vd);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": "vout_display_opengl_Display (sys->vgl, &vd->source)",
          "new_api": null,
          "old_text": "vout_display_opengl_Display (sys->vgl, &vd->source)",
          "new_text": null,
          "old_line_content": "        vout_display_opengl_Display (sys->vgl, &vd->source);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": "vlc_gl_ReleaseCurrent (sys->gl)",
          "new_api": null,
          "old_text": "vlc_gl_ReleaseCurrent (sys->gl)",
          "new_text": null,
          "old_line_content": "        vlc_gl_ReleaseCurrent (sys->gl);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": "CommonDisplay",
          "new_api": null,
          "old_text": "CommonDisplay(vd)",
          "new_text": null,
          "old_line_content": "    CommonDisplay(vd);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": "vout_display_opengl_GetPool",
          "new_api": null,
          "old_text": "vout_display_opengl_GetPool(sys->vgl, count)",
          "new_text": null,
          "old_line_content": "        sys->sys.pool = vout_display_opengl_GetPool(sys->vgl, count);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "vlc_gl_ReleaseCurrent (sys->gl)",
          "new_api": null,
          "old_text": "vlc_gl_ReleaseCurrent (sys->gl)",
          "new_text": null,
          "old_line_content": "        vlc_gl_ReleaseCurrent (sys->gl);",
          "new_line_content": "    return sys->sys.pool;",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": "vlc_gl_Resize (sys->gl, width, height)",
          "new_api": null,
          "old_text": "vlc_gl_Resize (sys->gl, width, height)",
          "new_text": null,
          "old_line_content": "    vlc_gl_Resize (sys->gl, width, height);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": "CommonManage",
          "new_api": null,
          "old_text": "CommonManage(vd)",
          "new_text": null,
          "old_line_content": "    CommonManage(vd);",
          "new_line_content": "    const int width  = sys->sys.rect_dest.right  - sys->sys.rect_dest.left;",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": "Manage",
          "new_api": null,
          "old_text": "Manage(vd)",
          "new_text": null,
          "old_line_content": "    Manage(vd);",
          "new_line_content": "    vout_display_sys_t *sys = vd->sys;",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": "VLC_UNUSED",
          "new_api": null,
          "old_text": "VLC_UNUSED(date)",
          "new_text": null,
          "old_line_content": "    VLC_UNUSED(date);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "vout_display_opengl_Delete",
          "new_api": null,
          "old_text": "vout_display_opengl_Delete(sys->vgl)",
          "new_text": null,
          "old_line_content": "            vout_display_opengl_Delete(sys->vgl);",
          "new_line_content": "        }",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 9,
      "total_additions": 18,
      "total_deletions": 18,
      "total_api_changes": 45
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 45,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          161,
          163,
          157,
          158,
          159
        ]
      }
    },
    "api_calls_before": 55,
    "api_calls_after": 55,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 5,
      "total_diff_lines": 22
    }
  }
}