{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/19657e3d4c7fbdd427c2553ddba55f528b024a26",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/19657e3d4c7fbdd427c2553ddba55f528b024a26/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/19657e3d4c7fbdd427c2553ddba55f528b024a26/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/vlc/modified_file/19657e3d4c7fbdd427c2553ddba55f528b024a26/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 358,
          "old_api": "g_Dbg",
          "new_api": "likely",
          "old_text": "g_Dbg( p_filter, \"Displaying overlay: %4.4s, %d, %d, %d\",\n                 (char*)&p_overlay->format.i_chroma, p_overlay->i_x, p_overlay->i_y,\n                 p_overlay->i_alpha );\n",
          "new_text": "likely(p_region == NULL) )",
          "old_line_content": "        msg_Dbg( p_filter, \"Displaying overlay: %4.4s, %d, %d, %d\",",
          "new_line_content": "        if( unlikely(p_region == NULL) )",
          "content_same": false
        },
        {
          "line": 364,
          "old_api": "xt_segment_New",
          "new_api": "g_Dbg",
          "old_text": "xt_segment_New( p_overlay->data.p_text );\n",
          "new_text": "g_Dbg( p_filter, \"Displaying overlay: %4.4s, %d, %d, %d\",\n                 (char*)&p_overlay->format.i_chroma, p_overlay->i_x, p_overlay->i_y,\n                 p_overlay->i_alpha );\n",
          "old_line_content": "            p_region->p_text = text_segment_New( p_overlay->data.p_text );",
          "new_line_content": "        msg_Dbg( p_filter, \"Displaying overlay: %4.4s, %d, %d, %d\",",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": "cture_Copy",
          "new_api": "xt_segment_New",
          "old_text": "cture_Copy( p_region->p_picture, p_overlay->data.p_pic );\n",
          "new_text": "xt_segment_New( p_overlay->data.p_text );\n",
          "old_line_content": "            picture_Copy( p_region->p_picture, p_overlay->data.p_pic );",
          "new_line_content": "            p_region->p_text = text_segment_New( p_overlay->data.p_text );",
          "content_same": false
        },
        {
          "line": 391,
          "old_api": "rncmp",
          "new_api": "c_mutex_lock",
          "old_text": "rncmp( psz_var, \"overlay-input\", 13 ) )",
          "new_text": "c_mutex_lock( &p_sys->lock );\n",
          "old_line_content": "    if( !strncmp( psz_var, \"overlay-input\", 13 ) )",
          "new_line_content": "    vlc_mutex_lock( &p_sys->lock );",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": "rdup",
          "new_api": "ee",
          "old_text": "rdup( newval.psz_string );\n",
          "new_text": "ee( p_sys->psz_inputfile );\n",
          "old_line_content": "        p_sys->psz_inputfile = strdup( newval.psz_string );",
          "new_line_content": "        free( p_sys->psz_inputfile );",
          "content_same": false
        },
        {
          "line": 399,
          "old_api": "rdup",
          "new_api": "ee",
          "old_text": "rdup( newval.psz_string );\n",
          "new_text": "ee( p_sys->psz_outputfile );\n",
          "old_line_content": "        p_sys->psz_outputfile = strdup( newval.psz_string );",
          "new_line_content": "        free( p_sys->psz_outputfile );",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 355,
          "old_api": null,
          "new_api": "bpicture_region_New",
          "old_text": null,
          "new_text": "bpicture_region_New( &p_overlay->format );\n",
          "old_line_content": "        if( !p_region )",
          "new_line_content": "            p_region = subpicture_region_New( &p_overlay->format );",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": null,
          "new_api": "bpicture_region_ForPicture",
          "old_text": null,
          "new_text": "bpicture_region_ForPicture( &p_overlay->format, p_overlay->data.p_pic );\n",
          "old_line_content": "",
          "new_line_content": "            p_region = subpicture_region_ForPicture( &p_overlay->format, p_overlay->data.p_pic );",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": null,
          "new_api": "C_UNUSED",
          "old_text": null,
          "new_text": "C_UNUSED(oldval);\n",
          "old_line_content": "",
          "new_line_content": "    VLC_UNUSED(p_this); VLC_UNUSED(oldval);",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": null,
          "new_api": "rncmp",
          "old_text": null,
          "new_text": "rncmp( psz_var, \"overlay-input\", 13 ) )",
          "old_line_content": "    {",
          "new_line_content": "    if( !strncmp( psz_var, \"overlay-input\", 13 ) )",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": null,
          "new_api": "rdup",
          "old_text": null,
          "new_text": "rdup( newval.psz_string );\n",
          "old_line_content": "    }",
          "new_line_content": "        p_sys->psz_inputfile = strdup( newval.psz_string );",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": null,
          "new_api": "rncmp",
          "old_text": null,
          "new_text": "rncmp( psz_var, \"overlay-output\", 14 ) )",
          "old_line_content": "    {",
          "new_line_content": "    else if( !strncmp( psz_var, \"overlay-output\", 14 ) )",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": null,
          "new_api": "rdup",
          "old_text": null,
          "new_text": "rdup( newval.psz_string );\n",
          "old_line_content": "    }",
          "new_line_content": "        p_sys->psz_outputfile = strdup( newval.psz_string );",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": null,
          "new_api": "c_mutex_unlock",
          "old_text": null,
          "new_text": "c_mutex_unlock( &p_sys->lock );\n",
          "old_line_content": "",
          "new_line_content": "    vlc_mutex_unlock( &p_sys->lock );",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": null,
          "new_api": "xt_style_Duplicate",
          "old_text": null,
          "new_text": "xt_style_Duplicate( p_overlay->p_fontstyle );\n",
          "old_line_content": "        }",
          "new_line_content": "            p_region->p_text->style = text_style_Duplicate( p_overlay->p_fontstyle );",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 354,
          "old_api": "bpicture_region_New",
          "new_api": null,
          "old_text": "bpicture_region_New( &p_overlay->format );\n",
          "new_text": null,
          "old_line_content": "        *pp_region = p_region = subpicture_region_New( &p_overlay->format );",
          "new_line_content": "        if( p_overlay->format.i_chroma == VLC_CODEC_TEXT )",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "C_UNUSED",
          "new_api": null,
          "old_text": "C_UNUSED(oldval);\n",
          "new_text": null,
          "old_line_content": "    VLC_UNUSED(p_this); VLC_UNUSED(oldval);",
          "new_line_content": "    filter_sys_t *p_sys = p_data;",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": "c_mutex_lock",
          "new_api": null,
          "old_text": "c_mutex_lock( &p_sys->lock );\n",
          "new_text": null,
          "old_line_content": "    vlc_mutex_lock( &p_sys->lock );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": "ee",
          "new_api": null,
          "old_text": "ee( p_sys->psz_inputfile );\n",
          "new_text": null,
          "old_line_content": "        free( p_sys->psz_inputfile );",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": "rncmp",
          "new_api": null,
          "old_text": "rncmp( psz_var, \"overlay-output\", 14 ) )",
          "new_text": null,
          "old_line_content": "    else if( !strncmp( psz_var, \"overlay-output\", 14 ) )",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 365,
          "old_api": "xt_style_Duplicate",
          "new_api": null,
          "old_text": "xt_style_Duplicate( p_overlay->p_fontstyle );\n",
          "new_text": null,
          "old_line_content": "            p_region->p_text->style = text_style_Duplicate( p_overlay->p_fontstyle );",
          "new_line_content": "                 (char*)&p_overlay->format.i_chroma, p_overlay->i_x, p_overlay->i_y,",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": "ee",
          "new_api": null,
          "old_text": "ee( p_sys->psz_outputfile );\n",
          "new_text": null,
          "old_line_content": "        free( p_sys->psz_outputfile );",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": "c_mutex_unlock",
          "new_api": null,
          "old_text": "c_mutex_unlock( &p_sys->lock );\n",
          "new_text": null,
          "old_line_content": "    vlc_mutex_unlock( &p_sys->lock );",
          "new_line_content": "    }",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 6,
      "total_additions": 9,
      "total_deletions": 8,
      "total_api_changes": 23
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 13,
        "api_related_lines": 23,
        "non_api_lines": 7,
        "non_api_line_numbers": [
          356,
          359,
          360,
          362,
          367,
          368,
          369
        ]
      }
    },
    "api_calls_before": 97,
    "api_calls_after": 98,
    "diff_info": {
      "added_lines": 8,
      "removed_lines": 7,
      "total_diff_lines": 35
    }
  }
}