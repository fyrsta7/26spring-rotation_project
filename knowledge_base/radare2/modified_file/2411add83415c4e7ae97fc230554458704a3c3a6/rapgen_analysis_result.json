{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/radare2/modified_file/2411add83415c4e7ae97fc230554458704a3c3a6",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/radare2/modified_file/2411add83415c4e7ae97fc230554458704a3c3a6/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/radare2/modified_file/2411add83415c4e7ae97fc230554458704a3c3a6/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/radare2/modified_file/2411add83415c4e7ae97fc230554458704a3c3a6/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 700,
          "old_api": "ht_up_new0 ()",
          "new_api": "r_pvector_init (&visit_a, NULL)",
          "old_text": "ht_up_new0 ()",
          "new_text": "r_pvector_init (&visit_a, NULL)",
          "old_line_content": "\tctx.visited = ht_up_new0 ();",
          "new_line_content": "\tr_pvector_init (&visit_a, NULL);",
          "content_same": false
        },
        {
          "line": 706,
          "old_api": "r_pvector_push (cur_visit, block)",
          "new_api": "ht_up_new0 ()",
          "old_text": "r_pvector_push (cur_visit, block)",
          "new_text": "ht_up_new0 ()",
          "old_line_content": "\tr_pvector_push (cur_visit, block);",
          "new_line_content": "\tctx.visited = ht_up_new0 ();",
          "content_same": false
        },
        {
          "line": 725,
          "old_api": "r_anal_get_block_at (block->anal, dstbb_addr)",
          "new_api": "r_pvector_clear (ctx.next_visit)",
          "old_text": "r_anal_get_block_at (block->anal, dstbb_addr)",
          "new_text": "r_pvector_clear (ctx.next_visit)",
          "old_line_content": "\tRAnalBlock *dst_block = r_anal_get_block_at (block->anal, dstbb_addr);",
          "new_line_content": "\t\tr_pvector_clear (ctx.next_visit);",
          "content_same": false
        },
        {
          "line": 731,
          "old_api": "r_anal_block_ref (prev)",
          "new_api": "r_anal_get_block_at (block->anal, dstbb_addr)",
          "old_text": "r_anal_block_ref (prev)",
          "new_text": "r_anal_get_block_at (block->anal, dstbb_addr)",
          "old_line_content": "\t\t\tr_anal_block_ref (prev);",
          "new_line_content": "\tRAnalBlock *dst_block = r_anal_get_block_at (block->anal, dstbb_addr);",
          "content_same": false
        },
        {
          "line": 733,
          "old_api": "ht_up_find (ctx.visited, prev->addr, NULL)",
          "new_api": "r_list_newf ((RListFree)r_anal_block_unref)",
          "old_text": "ht_up_find (ctx.visited, prev->addr, NULL)",
          "new_text": "r_list_newf ((RListFree)r_anal_block_unref)",
          "old_line_content": "\t\t\tprev = ht_up_find (ctx.visited, prev->addr, NULL);",
          "new_line_content": "\t\tret = r_list_newf ((RListFree)r_anal_block_unref);",
          "content_same": false
        },
        {
          "line": 738,
          "old_api": "ht_up_free (ctx.visited)",
          "new_api": "r_list_prepend (ret, prev)",
          "old_text": "ht_up_free (ctx.visited)",
          "new_text": "r_list_prepend (ret, prev)",
          "old_line_content": "\tht_up_free (ctx.visited);",
          "new_line_content": "\t\t\tr_list_prepend (ret, prev);",
          "content_same": false
        },
        {
          "line": 739,
          "old_api": "r_pvector_clear (&visit_a)",
          "new_api": "ht_up_find (ctx.visited, prev->addr, NULL)",
          "old_text": "r_pvector_clear (&visit_a)",
          "new_text": "ht_up_find (ctx.visited, prev->addr, NULL)",
          "old_line_content": "\tr_pvector_clear (&visit_a);",
          "new_line_content": "\t\t\tprev = ht_up_find (ctx.visited, prev->addr, NULL);",
          "content_same": false
        },
        {
          "line": 745,
          "old_api": "r_return_val_if_fail (block, false)",
          "new_api": "r_pvector_clear (&visit_a)",
          "old_text": "r_return_val_if_fail (block, false)",
          "new_text": "r_pvector_clear (&visit_a)",
          "old_line_content": "\tr_return_val_if_fail (block, false);",
          "new_line_content": "\tr_pvector_clear (&visit_a);",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": "r_return_if_fail (block)",
          "new_api": "r_hash_xxhash (buf, block->size)",
          "old_text": "r_return_if_fail (block)",
          "new_text": "r_hash_xxhash (buf, block->size)",
          "old_line_content": "\tr_return_if_fail (block);",
          "new_line_content": "\tut32 cur_hash = r_hash_xxhash (buf, block->size);",
          "content_same": false
        },
        {
          "line": 779,
          "old_api": "r_hash_xxhash (buf, block->size)",
          "new_api": "malloc (block->size)",
          "old_text": "r_hash_xxhash (buf, block->size)",
          "new_text": "malloc (block->size)",
          "old_line_content": "\t\tblock->bbhash = r_hash_xxhash (buf, block->size);",
          "new_line_content": "\tut8 *buf = malloc (block->size);",
          "content_same": false
        },
        {
          "line": 813,
          "old_api": "ht_up_find (succs, block->addr, NULL)",
          "new_api": "ht_up_insert (succs, block->addr, succ)",
          "old_text": "ht_up_find (succs, block->addr, NULL)",
          "new_text": "ht_up_insert (succs, block->addr, succ)",
          "old_line_content": "\tNoreturnSuccessor *succ = ht_up_find (succs, block->addr, NULL);",
          "new_line_content": "\tht_up_insert (succs, block->addr, succ);",
          "content_same": false
        },
        {
          "line": 839,
          "old_api": "r_return_val_if_fail (block, NULL)",
          "new_api": "r_anal_block_ref (succ->block)",
          "old_text": "r_return_val_if_fail (block, NULL)",
          "new_text": "r_anal_block_ref (succ->block)",
          "old_line_content": "\tr_return_val_if_fail (block, NULL);",
          "new_line_content": "\tr_anal_block_ref (succ->block);",
          "content_same": false
        },
        {
          "line": 840,
          "old_api": "r_anal_block_contains (block, addr)",
          "new_api": "r_list_push (blocks, succ->block)",
          "old_text": "r_anal_block_contains (block, addr)",
          "new_text": "r_list_push (blocks, succ->block)",
          "old_line_content": "\tif (!r_anal_block_contains (block, addr) || addr == block->addr) {",
          "new_line_content": "\tr_list_push (blocks, succ->block);",
          "content_same": false
        },
        {
          "line": 871,
          "old_api": "ht_up_foreach (succs, noreturn_remove_unreachable_cb, fcn)",
          "new_api": "r_list_clone (block->fcns, NULL)",
          "old_text": "ht_up_foreach (succs, noreturn_remove_unreachable_cb, fcn)",
          "new_text": "r_list_clone (block->fcns, NULL)",
          "old_line_content": "\t\tht_up_foreach (succs, noreturn_remove_unreachable_cb, fcn);",
          "new_line_content": "\tRList *fcns_cpy = r_list_clone (block->fcns, NULL);",
          "content_same": false
        },
        {
          "line": 873,
          "old_api": "r_list_free (fcns_cpy)",
          "new_api": "r_anal_get_block_at (block->anal, fcn->addr)",
          "old_text": "r_list_free (fcns_cpy)",
          "new_text": "r_anal_get_block_at (block->anal, fcn->addr)",
          "old_line_content": "\tr_list_free (fcns_cpy);",
          "new_line_content": "\t\tRAnalBlock *entry = r_anal_get_block_at (block->anal, fcn->addr);",
          "content_same": false
        },
        {
          "line": 884,
          "old_api": "r_anal_block_unref (block)",
          "new_api": "r_list_init (&merge_blocks)",
          "old_text": "r_anal_block_unref (block)",
          "new_text": "r_list_init (&merge_blocks)",
          "old_line_content": "\tr_anal_block_unref (block);",
          "new_line_content": "\tr_list_init (&merge_blocks);",
          "content_same": false
        },
        {
          "line": 890,
          "old_api": "r_anal_block_automerge (&merge_blocks)",
          "new_api": "r_anal_block_unref (block)",
          "old_text": "r_anal_block_automerge (&merge_blocks)",
          "new_text": "r_anal_block_unref (block)",
          "old_line_content": "\tr_anal_block_automerge (&merge_blocks);",
          "new_line_content": "\tr_anal_block_unref (block);",
          "content_same": false
        },
        {
          "line": 936,
          "old_api": "ht_up_find (ctx->predecessors, (ut64)(size_t)block, &found)",
          "new_api": "ht_up_find (ctx->blocks, addr, NULL)",
          "old_text": "ht_up_find (ctx->predecessors, (ut64)(size_t)block, &found)",
          "new_text": "ht_up_find (ctx->blocks, addr, NULL)",
          "old_line_content": "\tRAnalBlock *pred = ht_up_find (ctx->predecessors, (ut64)(size_t)block, &found);",
          "new_line_content": "\tRAnalBlock *block = ht_up_find (ctx->blocks, addr, NULL);",
          "content_same": false
        },
        {
          "line": 965,
          "old_api": "r_anal_block_successor_addrs_foreach (block, automerge_predecessor_successor_cb, ctx)",
          "new_api": "ht_up_find (ctx->visited_blocks, (ut64)(size_t)block, &already_visited)",
          "old_text": "r_anal_block_successor_addrs_foreach (block, automerge_predecessor_successor_cb, ctx)",
          "new_text": "ht_up_find (ctx->visited_blocks, (ut64)(size_t)block, &already_visited)",
          "old_line_content": "\t\tr_anal_block_successor_addrs_foreach (block, automerge_predecessor_successor_cb, ctx);",
          "new_line_content": "\t\tht_up_find (ctx->visited_blocks, (ut64)(size_t)block, &already_visited);",
          "content_same": false
        },
        {
          "line": 982,
          "old_api": "r_list_new ()",
          "new_api": "ht_up_new0 ()",
          "old_text": "r_list_new ()",
          "new_text": "ht_up_new0 ()",
          "old_line_content": "\tRList *fixup_candidates = r_list_new (); // used further down",
          "new_line_content": "\t\t.predecessors = ht_up_new0 (),",
          "content_same": false
        },
        {
          "line": 1000,
          "old_api": "set_u_foreach (relevant_fcns, automerge_get_predecessors_cb, &ctx)",
          "new_api": "set_u_add (relevant_fcns, (ut64)(size_t)fcn)",
          "old_text": "set_u_foreach (relevant_fcns, automerge_get_predecessors_cb, &ctx)",
          "new_text": "set_u_add (relevant_fcns, (ut64)(size_t)fcn)",
          "old_line_content": "\tset_u_foreach (relevant_fcns, automerge_get_predecessors_cb, &ctx);",
          "new_line_content": "\t\t\tset_u_add (relevant_fcns, (ut64)(size_t)fcn);",
          "content_same": false
        },
        {
          "line": 1027,
          "old_api": "r_anal_block_merge (predecessor, block)",
          "new_api": "ht_up_find (ctx.predecessors, (ut64)(size_t)clock, NULL)",
          "old_text": "r_anal_block_merge (predecessor, block)",
          "new_text": "ht_up_find (ctx.predecessors, (ut64)(size_t)clock, NULL)",
          "old_line_content": "\t\tif (r_anal_block_merge (predecessor, block)) { // r_anal_block_merge() does checks like contiguous, to that's fine",
          "new_line_content": "\t\t\tRAnalBlock *fixup_pred = ht_up_find (ctx.predecessors, (ut64)(size_t)clock, NULL);",
          "content_same": false
        },
        {
          "line": 1038,
          "old_api": "r_list_split_iter (blocks, it)",
          "new_api": "ht_up_update (ctx.visited_blocks, (ut64)(size_t)predecessor, (void *)ctx.cur_succ_count)",
          "old_text": "r_list_split_iter (blocks, it)",
          "new_text": "ht_up_update (ctx.visited_blocks, (ut64)(size_t)predecessor, (void *)ctx.cur_succ_count)",
          "old_line_content": "\t\t\tr_list_split_iter (blocks, it);",
          "new_line_content": "\t\t\tht_up_update (ctx.visited_blocks, (ut64)(size_t)predecessor, (void *)ctx.cur_succ_count);",
          "content_same": false
        },
        {
          "line": 1048,
          "old_api": "ht_up_free (ctx.blocks)",
          "new_api": "r_list_purge (fixup_candidates)",
          "old_text": "ht_up_free (ctx.blocks)",
          "new_text": "r_list_purge (fixup_candidates)",
          "old_line_content": "\tht_up_free (ctx.blocks);",
          "new_line_content": "\t\tr_list_purge (fixup_candidates);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1029,
          "old_api": null,
          "new_api": "r_list_push (fixup_candidates, clock)",
          "old_text": null,
          "new_text": "r_list_push (fixup_candidates, clock)",
          "old_line_content": "\t\t\t// Update number of successors of the predecessor",
          "new_line_content": "\t\t\t\tr_list_push (fixup_candidates, clock);",
          "content_same": false
        },
        {
          "line": 1033,
          "old_api": null,
          "new_api": "r_anal_block_merge (predecessor, block)",
          "old_text": null,
          "new_text": "r_anal_block_merge (predecessor, block)",
          "old_line_content": "\t\t\tr_list_foreach (fixup_candidates, bit, clock) {",
          "new_line_content": "\t\tif (r_anal_block_merge (predecessor, block)) { // r_anal_block_merge() does checks like contiguous, to that's fine",
          "content_same": false
        },
        {
          "line": 1037,
          "old_api": null,
          "new_api": "r_anal_block_successor_addrs_foreach (predecessor, count_successors_cb, &ctx)",
          "old_text": null,
          "new_text": "r_anal_block_successor_addrs_foreach (predecessor, count_successors_cb, &ctx)",
          "old_line_content": "\t\t\t// Remove it from the list",
          "new_line_content": "\t\t\tr_anal_block_successor_addrs_foreach (predecessor, count_successors_cb, &ctx);",
          "content_same": false
        },
        {
          "line": 1041,
          "old_api": null,
          "new_api": "ht_up_update (ctx.predecessors, (ut64)(size_t)clock, predecessor)",
          "old_text": null,
          "new_text": "ht_up_update (ctx.predecessors, (ut64)(size_t)clock, predecessor)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tht_up_update (ctx.predecessors, (ut64)(size_t)clock, predecessor);",
          "content_same": false
        },
        {
          "line": 1044,
          "old_api": null,
          "new_api": "r_list_split_iter (blocks, it)",
          "old_text": null,
          "new_text": "r_list_split_iter (blocks, it)",
          "old_line_content": "",
          "new_line_content": "\t\t\tr_list_split_iter (blocks, it);",
          "content_same": false
        },
        {
          "line": 1045,
          "old_api": null,
          "new_api": "free (it)",
          "old_text": null,
          "new_text": "free (it)",
          "old_line_content": "beach:",
          "new_line_content": "\t\t\tfree (it);",
          "content_same": false
        },
        {
          "line": 1052,
          "old_api": null,
          "new_api": "ht_up_free (ctx.predecessors)",
          "old_text": null,
          "new_text": "ht_up_free (ctx.predecessors)",
          "old_line_content": "",
          "new_line_content": "\tht_up_free (ctx.predecessors);",
          "content_same": false
        },
        {
          "line": 1053,
          "old_api": null,
          "new_api": "ht_up_free (ctx.visited_blocks)",
          "old_text": null,
          "new_text": "ht_up_free (ctx.visited_blocks)",
          "old_line_content": "",
          "new_line_content": "\tht_up_free (ctx.visited_blocks);",
          "content_same": false
        },
        {
          "line": 1054,
          "old_api": null,
          "new_api": "ht_up_free (ctx.blocks)",
          "old_text": null,
          "new_text": "ht_up_free (ctx.blocks)",
          "old_line_content": "",
          "new_line_content": "\tht_up_free (ctx.blocks);",
          "content_same": false
        },
        {
          "line": 1055,
          "old_api": null,
          "new_api": "set_u_free (relevant_fcns)",
          "old_text": null,
          "new_text": "set_u_free (relevant_fcns)",
          "old_line_content": "",
          "new_line_content": "\tset_u_free (relevant_fcns);",
          "content_same": false
        },
        {
          "line": 1056,
          "old_api": null,
          "new_api": "r_list_free (fixup_candidates)",
          "old_text": null,
          "new_text": "r_list_free (fixup_candidates)",
          "old_line_content": "",
          "new_line_content": "\tr_list_free (fixup_candidates);",
          "content_same": false
        },
        {
          "line": 647,
          "old_api": null,
          "new_api": "r_anal_bb_offset_inst (bb, i)",
          "old_text": null,
          "new_text": "r_anal_bb_offset_inst (bb, i)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tut16 inst_off = r_anal_bb_offset_inst (bb, i);",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": null,
          "new_api": "ht_up_find_kv (ctx->visited, addr, NULL)",
          "old_text": null,
          "new_text": "ht_up_find_kv (ctx->visited, addr, NULL)",
          "old_line_content": "\tif (block) {",
          "new_line_content": "\tif (ht_up_find_kv (ctx->visited, addr, NULL)) {",
          "content_same": false
        },
        {
          "line": 672,
          "old_api": null,
          "new_api": "ht_up_insert (ctx->visited, addr, ctx->cur_parent)",
          "old_text": null,
          "new_text": "ht_up_insert (ctx->visited, addr, ctx->cur_parent)",
          "old_line_content": "}",
          "new_line_content": "\tht_up_insert (ctx->visited, addr, ctx->cur_parent);",
          "content_same": false
        },
        {
          "line": 673,
          "old_api": null,
          "new_api": "r_anal_get_block_at (ctx->anal, addr)",
          "old_text": null,
          "new_text": "r_anal_get_block_at (ctx->anal, addr)",
          "old_line_content": "",
          "new_line_content": "\tRAnalBlock *block = r_anal_get_block_at (ctx->anal, addr);",
          "content_same": false
        },
        {
          "line": 675,
          "old_api": null,
          "new_api": "r_pvector_push (ctx->next_visit, block)",
          "old_text": null,
          "new_text": "r_pvector_push (ctx->next_visit, block)",
          "old_line_content": "\tRListIter *iter;",
          "new_line_content": "\t\tr_pvector_push (ctx->next_visit, block);",
          "content_same": false
        },
        {
          "line": 683,
          "old_api": null,
          "new_api": "r_anal_get_blocks_in (a, n)",
          "old_text": null,
          "new_text": "r_anal_get_blocks_in (a, n)",
          "old_line_content": "",
          "new_line_content": "\tRList *blocks = r_anal_get_blocks_in (a, n);",
          "content_same": false
        },
        {
          "line": 691,
          "old_api": null,
          "new_api": "bb_addr_for (block->anal, dst)",
          "old_text": null,
          "new_text": "bb_addr_for (block->anal, dst)",
          "old_line_content": "",
          "new_line_content": "\tut64 dstbb_addr = bb_addr_for (block->anal, dst);",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": null,
          "new_api": "r_pvector_init (&visit_b, NULL)",
          "old_text": null,
          "new_text": "r_pvector_init (&visit_b, NULL)",
          "old_line_content": "\t\tgoto beach;",
          "new_line_content": "\tr_pvector_init (&visit_b, NULL);",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": null,
          "new_api": "ht_up_insert (ctx.visited, block->addr, NULL)",
          "old_text": null,
          "new_text": "ht_up_insert (ctx.visited, block->addr, NULL)",
          "old_line_content": "\t\tr_pvector_foreach (cur_visit, it) {",
          "new_line_content": "\tht_up_insert (ctx.visited, block->addr, NULL);",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": null,
          "new_api": "r_pvector_push (cur_visit, block)",
          "old_text": null,
          "new_text": "r_pvector_push (cur_visit, block)",
          "old_line_content": "\t\t\tRAnalBlock *cur = *it;",
          "new_line_content": "\tr_pvector_push (cur_visit, block);",
          "content_same": false
        },
        {
          "line": 715,
          "old_api": null,
          "new_api": "r_pvector_empty (cur_visit)",
          "old_text": null,
          "new_text": "r_pvector_empty (cur_visit)",
          "old_line_content": "\t\t}",
          "new_line_content": "\twhile (!r_pvector_empty (cur_visit)) {",
          "content_same": false
        },
        {
          "line": 720,
          "old_api": null,
          "new_api": "r_anal_block_successor_addrs_foreach (cur, shortest_path_successor_cb, &ctx)",
          "old_text": null,
          "new_text": "r_anal_block_successor_addrs_foreach (cur, shortest_path_successor_cb, &ctx)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tr_anal_block_successor_addrs_foreach (cur, shortest_path_successor_cb, &ctx);",
          "content_same": false
        },
        {
          "line": 730,
          "old_api": null,
          "new_api": "ht_up_find (ctx.visited, dstbb_addr, &found)",
          "old_text": null,
          "new_text": "ht_up_find (ctx.visited, dstbb_addr, &found)",
          "old_line_content": "\t\twhile (prev) {",
          "new_line_content": "\tRAnalBlock *prev = ht_up_find (ctx.visited, dstbb_addr, &found);",
          "content_same": false
        },
        {
          "line": 734,
          "old_api": null,
          "new_api": "r_anal_block_ref (dst_block)",
          "old_text": null,
          "new_text": "r_anal_block_ref (dst_block)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tr_anal_block_ref (dst_block);",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": null,
          "new_api": "r_list_prepend (ret, dst_block)",
          "old_text": null,
          "new_text": "r_list_prepend (ret, dst_block)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tr_list_prepend (ret, dst_block);",
          "content_same": false
        },
        {
          "line": 737,
          "old_api": null,
          "new_api": "r_anal_block_ref (prev)",
          "old_text": null,
          "new_text": "r_anal_block_ref (prev)",
          "old_line_content": "beach:",
          "new_line_content": "\t\t\tr_anal_block_ref (prev);",
          "content_same": false
        },
        {
          "line": 744,
          "old_api": null,
          "new_api": "ht_up_free (ctx.visited)",
          "old_text": null,
          "new_text": "ht_up_free (ctx.visited)",
          "old_line_content": "R_API bool r_anal_block_was_modified(RAnalBlock *block) {",
          "new_line_content": "\tht_up_free (ctx.visited);",
          "content_same": false
        },
        {
          "line": 746,
          "old_api": null,
          "new_api": "r_pvector_clear (&visit_b)",
          "old_text": null,
          "new_text": "r_pvector_clear (&visit_b)",
          "old_line_content": "\tif (!block->bbhash) {",
          "new_line_content": "\tr_pvector_clear (&visit_b);",
          "content_same": false
        },
        {
          "line": 751,
          "old_api": null,
          "new_api": "r_return_val_if_fail (block, false)",
          "old_text": null,
          "new_text": "r_return_val_if_fail (block, false)",
          "old_line_content": "\t}",
          "new_line_content": "\tr_return_val_if_fail (block, false);",
          "content_same": false
        },
        {
          "line": 758,
          "old_api": null,
          "new_api": "malloc (block->size)",
          "old_text": null,
          "new_text": "malloc (block->size)",
          "old_line_content": "\t\treturn false;",
          "new_line_content": "\tut8 *buf = malloc (block->size);",
          "content_same": false
        },
        {
          "line": 762,
          "old_api": null,
          "new_api": "block->anal->iob.read_at (block->anal->iob.io, block->addr, buf, block->size)",
          "old_text": null,
          "new_text": "block->anal->iob.read_at (block->anal->iob.io, block->addr, buf, block->size)",
          "old_line_content": "\treturn block->bbhash != cur_hash;",
          "new_line_content": "\tif (!block->anal->iob.read_at (block->anal->iob.io, block->addr, buf, block->size)) {",
          "content_same": false
        },
        {
          "line": 763,
          "old_api": null,
          "new_api": "free (buf)",
          "old_text": null,
          "new_text": "free (buf)",
          "old_line_content": "}",
          "new_line_content": "\t\tfree (buf);",
          "content_same": false
        },
        {
          "line": 767,
          "old_api": null,
          "new_api": "free (buf)",
          "old_text": null,
          "new_text": "free (buf)",
          "old_line_content": "\tif (!block->anal->iob.read_at) {",
          "new_line_content": "\tfree (buf);",
          "content_same": false
        },
        {
          "line": 772,
          "old_api": null,
          "new_api": "r_return_if_fail (block)",
          "old_text": null,
          "new_text": "r_return_if_fail (block)",
          "old_line_content": "\t}",
          "new_line_content": "\tr_return_if_fail (block);",
          "content_same": false
        },
        {
          "line": 781,
          "old_api": null,
          "new_api": "block->anal->iob.read_at (block->anal->iob.io, block->addr, buf, block->size)",
          "old_text": null,
          "new_text": "block->anal->iob.read_at (block->anal->iob.io, block->addr, buf, block->size)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tif (!block->anal->iob.read_at (block->anal->iob.io, block->addr, buf, block->size)) {",
          "content_same": false
        },
        {
          "line": 782,
          "old_api": null,
          "new_api": "free (buf)",
          "old_text": null,
          "new_text": "free (buf)",
          "old_line_content": "}",
          "new_line_content": "\t\t\tfree (buf);",
          "content_same": false
        },
        {
          "line": 785,
          "old_api": null,
          "new_api": "r_hash_xxhash (buf, block->size)",
          "old_text": null,
          "new_text": "r_hash_xxhash (buf, block->size)",
          "old_line_content": "\tRAnalBlock *block;",
          "new_line_content": "\t\tblock->bbhash = r_hash_xxhash (buf, block->size);",
          "content_same": false
        },
        {
          "line": 786,
          "old_api": null,
          "new_api": "free (buf)",
          "old_text": null,
          "new_text": "free (buf)",
          "old_line_content": "\tbool reachable;",
          "new_line_content": "\t\tfree (buf);",
          "content_same": false
        },
        {
          "line": 797,
          "old_api": null,
          "new_api": "r_anal_block_unref (succ->block)",
          "old_text": null,
          "new_text": "r_anal_block_unref (succ->block)",
          "old_line_content": "\t\treturn false;",
          "new_line_content": "\tr_anal_block_unref (succ->block);",
          "content_same": false
        },
        {
          "line": 798,
          "old_api": null,
          "new_api": "free (succ)",
          "old_text": null,
          "new_text": "free (succ)",
          "old_line_content": "\t}",
          "new_line_content": "\tfree (succ);",
          "content_same": false
        },
        {
          "line": 806,
          "old_api": null,
          "new_api": "R_NEW0 (NoreturnSuccessor)",
          "old_text": null,
          "new_text": "R_NEW0 (NoreturnSuccessor)",
          "old_line_content": "\tsucc->reachable = false; // reset for first iteration",
          "new_line_content": "\tNoreturnSuccessor *succ = R_NEW0 (NoreturnSuccessor);",
          "content_same": false
        },
        {
          "line": 810,
          "old_api": null,
          "new_api": "r_anal_block_ref (block)",
          "old_text": null,
          "new_text": "r_anal_block_ref (block)",
          "old_line_content": "",
          "new_line_content": "\tr_anal_block_ref (block);",
          "content_same": false
        },
        {
          "line": 819,
          "old_api": null,
          "new_api": "ht_up_find (succs, block->addr, NULL)",
          "old_text": null,
          "new_text": "ht_up_find (succs, block->addr, NULL)",
          "old_line_content": "",
          "new_line_content": "\tNoreturnSuccessor *succ = ht_up_find (succs, block->addr, NULL);",
          "content_same": false
        },
        {
          "line": 829,
          "old_api": null,
          "new_api": "r_list_contains (succ->block->fcns, fcn)",
          "old_text": null,
          "new_text": "r_list_contains (succ->block->fcns, fcn)",
          "old_line_content": "",
          "new_line_content": "\tif (!succ->reachable && r_list_contains (succ->block->fcns, fcn)) {",
          "content_same": false
        },
        {
          "line": 830,
          "old_api": null,
          "new_api": "r_anal_function_remove_block (fcn, succ->block)",
          "old_text": null,
          "new_text": "r_anal_function_remove_block (fcn, succ->block)",
          "old_line_content": "static bool noreturn_get_blocks_cb(void *user, const ut64 k, const void *v) {",
          "new_line_content": "\t\tr_anal_function_remove_block (fcn, succ->block);",
          "content_same": false
        },
        {
          "line": 845,
          "old_api": null,
          "new_api": "r_return_val_if_fail (block, NULL)",
          "old_text": null,
          "new_text": "r_return_val_if_fail (block, NULL)",
          "old_line_content": "\t// Cache all recursive successors of block here.",
          "new_line_content": "\tr_return_val_if_fail (block, NULL);",
          "content_same": false
        },
        {
          "line": 846,
          "old_api": null,
          "new_api": "r_anal_block_contains (block, addr)",
          "old_text": null,
          "new_text": "r_anal_block_contains (block, addr)",
          "old_line_content": "\t// These are the candidates that we might have to remove from functions later.",
          "new_line_content": "\tif (!r_anal_block_contains (block, addr) || addr == block->addr) {",
          "content_same": false
        },
        {
          "line": 849,
          "old_api": null,
          "new_api": "r_anal_block_ref (block)",
          "old_text": null,
          "new_text": "r_anal_block_ref (block)",
          "old_line_content": "\t\treturn block;",
          "new_line_content": "\tr_anal_block_ref (block);",
          "content_same": false
        },
        {
          "line": 853,
          "old_api": null,
          "new_api": "ht_up_new (NULL, noreturn_successor_free, NULL)",
          "old_text": null,
          "new_text": "ht_up_new (NULL, noreturn_successor_free, NULL)",
          "old_line_content": "\t// Chop the block. Resize and remove all destination addrs",
          "new_line_content": "\tHtUP *succs = ht_up_new (NULL, noreturn_successor_free, NULL); // maps block addr (ut64) => NoreturnSuccessor *",
          "content_same": false
        },
        {
          "line": 857,
          "old_api": null,
          "new_api": "r_anal_block_recurse (block, noreturn_successors_cb, succs)",
          "old_text": null,
          "new_text": "r_anal_block_recurse (block, noreturn_successors_cb, succs)",
          "old_line_content": "\tblock->fail = UT64_MAX;",
          "new_line_content": "\tr_anal_block_recurse (block, noreturn_successors_cb, succs);",
          "content_same": false
        },
        {
          "line": 860,
          "old_api": null,
          "new_api": "r_anal_block_set_size (block, addr - block->addr)",
          "old_text": null,
          "new_text": "r_anal_block_set_size (block, addr - block->addr)",
          "old_line_content": "",
          "new_line_content": "\tr_anal_block_set_size (block, addr - block->addr);",
          "content_same": false
        },
        {
          "line": 861,
          "old_api": null,
          "new_api": "r_anal_block_update_hash (block)",
          "old_text": null,
          "new_text": "r_anal_block_update_hash (block)",
          "old_line_content": "\t// Now, for each fcn, check which of our successors are still reachable in the function remove and the ones that are not.",
          "new_line_content": "\tr_anal_block_update_hash (block);",
          "content_same": false
        },
        {
          "line": 864,
          "old_api": null,
          "new_api": "r_anal_switch_op_free (block->switch_op)",
          "old_text": null,
          "new_text": "r_anal_switch_op_free (block->switch_op)",
          "old_line_content": "\t// We need to clone the list because block->fcns will get modified in the loop",
          "new_line_content": "\tr_anal_switch_op_free (block->switch_op);",
          "content_same": false
        },
        {
          "line": 874,
          "old_api": null,
          "new_api": "r_list_contains (entry->fcns, fcn)",
          "old_text": null,
          "new_text": "r_list_contains (entry->fcns, fcn)",
          "old_line_content": "",
          "new_line_content": "\t\tif (entry && r_list_contains (entry->fcns, fcn)) {",
          "content_same": false
        },
        {
          "line": 875,
          "old_api": null,
          "new_api": "r_anal_block_recurse (entry, noreturn_successors_reachable_cb, succs)",
          "old_text": null,
          "new_text": "r_anal_block_recurse (entry, noreturn_successors_reachable_cb, succs)",
          "old_line_content": "\t// This last step isn't really critical, but nice to have.",
          "new_line_content": "\t\t\tr_anal_block_recurse (entry, noreturn_successors_reachable_cb, succs);",
          "content_same": false
        },
        {
          "line": 877,
          "old_api": null,
          "new_api": "ht_up_foreach (succs, noreturn_remove_unreachable_cb, fcn)",
          "old_text": null,
          "new_text": "ht_up_foreach (succs, noreturn_remove_unreachable_cb, fcn)",
          "old_line_content": "\tRList merge_blocks;",
          "new_line_content": "\t\tht_up_foreach (succs, noreturn_remove_unreachable_cb, fcn);",
          "content_same": false
        },
        {
          "line": 879,
          "old_api": null,
          "new_api": "r_list_free (fcns_cpy)",
          "old_text": null,
          "new_text": "r_list_free (fcns_cpy)",
          "old_line_content": "\tmerge_blocks.free = (RListFree)r_anal_block_unref;",
          "new_line_content": "\tr_list_free (fcns_cpy);",
          "content_same": false
        },
        {
          "line": 886,
          "old_api": null,
          "new_api": "ht_up_foreach (succs, noreturn_get_blocks_cb, &merge_blocks)",
          "old_text": null,
          "new_text": "ht_up_foreach (succs, noreturn_get_blocks_cb, &merge_blocks)",
          "old_line_content": "",
          "new_line_content": "\tht_up_foreach (succs, noreturn_get_blocks_cb, &merge_blocks);",
          "content_same": false
        },
        {
          "line": 891,
          "old_api": null,
          "new_api": "ht_up_free (succs)",
          "old_text": null,
          "new_text": "ht_up_free (succs)",
          "old_line_content": "",
          "new_line_content": "\tht_up_free (succs);",
          "content_same": false
        },
        {
          "line": 896,
          "old_api": null,
          "new_api": "r_anal_block_automerge (&merge_blocks)",
          "old_text": null,
          "new_text": "r_anal_block_automerge (&merge_blocks)",
          "old_line_content": "\t\t\t// block is still there",
          "new_line_content": "\tr_anal_block_automerge (&merge_blocks);",
          "content_same": false
        },
        {
          "line": 908,
          "old_api": null,
          "new_api": "r_list_purge (&merge_blocks)",
          "old_text": null,
          "new_text": "r_list_purge (&merge_blocks)",
          "old_line_content": "\tHtUP *visited_blocks; // during predecessor search, mark blocks whose successors we already checked. Value is void *-casted count of successors",
          "new_line_content": "\tr_list_purge (&merge_blocks);",
          "content_same": false
        },
        {
          "line": 942,
          "old_api": null,
          "new_api": "ht_up_find (ctx->predecessors, (ut64)(size_t)block, &found)",
          "old_text": null,
          "new_text": "ht_up_find (ctx->predecessors, (ut64)(size_t)block, &found)",
          "old_line_content": "\t} else {",
          "new_line_content": "\tRAnalBlock *pred = ht_up_find (ctx->predecessors, (ut64)(size_t)block, &found);",
          "content_same": false
        },
        {
          "line": 946,
          "old_api": null,
          "new_api": "ht_up_update (ctx->predecessors, (ut64)(size_t) block, NULL)",
          "old_text": null,
          "new_text": "ht_up_update (ctx->predecessors, (ut64)(size_t) block, NULL)",
          "old_line_content": "\treturn true;",
          "new_line_content": "\t\t\tht_up_update (ctx->predecessors, (ut64)(size_t) block, NULL);",
          "content_same": false
        },
        {
          "line": 950,
          "old_api": null,
          "new_api": "ht_up_insert (ctx->predecessors, (ut64)(size_t) block, ctx->cur_pred)",
          "old_text": null,
          "new_text": "ht_up_insert (ctx->predecessors, (ut64)(size_t) block, ctx->cur_pred)",
          "old_line_content": "\tif (k == UT64_MAX) {",
          "new_line_content": "\t\tht_up_insert (ctx->predecessors, (ut64)(size_t) block, ctx->cur_pred);",
          "content_same": false
        },
        {
          "line": 963,
          "old_api": null,
          "new_api": "r_list_foreach (fcn->bbs, it, block)",
          "old_text": null,
          "new_text": "r_list_foreach (fcn->bbs, it, block)",
          "old_line_content": "\t\tctx->cur_pred = block;",
          "new_line_content": "\tr_list_foreach (fcn->bbs, it, block) {",
          "content_same": false
        },
        {
          "line": 971,
          "old_api": null,
          "new_api": "r_anal_block_successor_addrs_foreach (block, automerge_predecessor_successor_cb, ctx)",
          "old_text": null,
          "new_text": "r_anal_block_successor_addrs_foreach (block, automerge_predecessor_successor_cb, ctx)",
          "old_line_content": "// Try to find the contiguous predecessors of all given blocks and merge them if possible,",
          "new_line_content": "\t\tr_anal_block_successor_addrs_foreach (block, automerge_predecessor_successor_cb, ctx);",
          "content_same": false
        },
        {
          "line": 972,
          "old_api": null,
          "new_api": "ht_up_insert (ctx->visited_blocks, (ut64)(size_t)block, (void *)ctx->cur_succ_count)",
          "old_text": null,
          "new_text": "ht_up_insert (ctx->visited_blocks, (ut64)(size_t)block, (void *)ctx->cur_succ_count)",
          "old_line_content": "// i.e. if there are no other blocks that have this block as one of their successors",
          "new_line_content": "\t\tht_up_insert (ctx->visited_blocks, (ut64)(size_t)block, (void *)ctx->cur_succ_count);",
          "content_same": false
        },
        {
          "line": 980,
          "old_api": null,
          "new_api": "r_return_if_fail (blocks)",
          "old_text": null,
          "new_text": "r_return_if_fail (blocks)",
          "old_line_content": "",
          "new_line_content": "\tr_return_if_fail (blocks);",
          "content_same": false
        },
        {
          "line": 983,
          "old_api": null,
          "new_api": "ht_up_new0 ()",
          "old_text": null,
          "new_text": "ht_up_new0 ()",
          "old_line_content": "\tif (!ctx.predecessors || !ctx.visited_blocks || !ctx.blocks || !relevant_fcns || !fixup_candidates) {",
          "new_line_content": "\t\t.visited_blocks = ht_up_new0 (),",
          "content_same": false
        },
        {
          "line": 984,
          "old_api": null,
          "new_api": "ht_up_new0 ()",
          "old_text": null,
          "new_text": "ht_up_new0 ()",
          "old_line_content": "\t\tgoto beach;",
          "new_line_content": "\t\t.blocks = ht_up_new0 ()",
          "content_same": false
        },
        {
          "line": 987,
          "old_api": null,
          "new_api": "set_u_new ()",
          "old_text": null,
          "new_text": "set_u_new ()",
          "old_line_content": "\t// Get all the functions and prepare ctx.blocks",
          "new_line_content": "\tSetU *relevant_fcns = set_u_new ();",
          "content_same": false
        },
        {
          "line": 988,
          "old_api": null,
          "new_api": "r_list_new ()",
          "old_text": null,
          "new_text": "r_list_new ()",
          "old_line_content": "\tRListIter *it;",
          "new_line_content": "\tRList *fixup_candidates = r_list_new (); // used further down",
          "content_same": false
        },
        {
          "line": 999,
          "old_api": null,
          "new_api": "r_list_foreach (block->fcns, fit, fcn)",
          "old_text": null,
          "new_text": "r_list_foreach (block->fcns, fit, fcn)",
          "old_line_content": "\t// Get the single predecessors we might want to merge with",
          "new_line_content": "\t\tr_list_foreach (block->fcns, fit, fcn) {",
          "content_same": false
        },
        {
          "line": 1002,
          "old_api": null,
          "new_api": "ht_up_insert (ctx.blocks, block->addr, block)",
          "old_text": null,
          "new_text": "ht_up_insert (ctx.blocks, block->addr, block)",
          "old_line_content": "\t// Now finally do the merging",
          "new_line_content": "\t\tht_up_insert (ctx.blocks, block->addr, block);",
          "content_same": false
        },
        {
          "line": 1006,
          "old_api": null,
          "new_api": "set_u_foreach (relevant_fcns, automerge_get_predecessors_cb, &ctx)",
          "old_text": null,
          "new_text": "set_u_foreach (relevant_fcns, automerge_get_predecessors_cb, &ctx)",
          "old_line_content": "\t\tif (!predecessor) {",
          "new_line_content": "\tset_u_foreach (relevant_fcns, automerge_get_predecessors_cb, &ctx);",
          "content_same": false
        },
        {
          "line": 1011,
          "old_api": null,
          "new_api": "ht_up_find (ctx.predecessors, (ut64)(size_t)block, NULL)",
          "old_text": null,
          "new_text": "ht_up_find (ctx.predecessors, (ut64)(size_t)block, NULL)",
          "old_line_content": "\t\t\t// we can only merge this predecessor if it has exactly one successor",
          "new_line_content": "\t\tRAnalBlock *predecessor = ht_up_find (ctx.predecessors, (ut64)(size_t)block, NULL);",
          "content_same": false
        },
        {
          "line": 1015,
          "old_api": null,
          "new_api": "ht_up_find (ctx.visited_blocks, (ut64)(size_t)predecessor, NULL)",
          "old_text": null,
          "new_text": "ht_up_find (ctx.visited_blocks, (ut64)(size_t)predecessor, NULL)",
          "old_line_content": "\t\t// We are about to merge block into predecessor",
          "new_line_content": "\t\tsize_t pred_succs_count = (size_t)ht_up_find (ctx.visited_blocks, (ut64)(size_t)predecessor, NULL);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1031,
          "old_api": "r_anal_block_successor_addrs_foreach (predecessor, count_successors_cb, &ctx)",
          "new_api": null,
          "old_text": "r_anal_block_successor_addrs_foreach (predecessor, count_successors_cb, &ctx)",
          "new_text": null,
          "old_line_content": "\t\t\tr_anal_block_successor_addrs_foreach (predecessor, count_successors_cb, &ctx);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 1032,
          "old_api": "ht_up_update (ctx.visited_blocks, (ut64)(size_t)predecessor, (void *)ctx.cur_succ_count)",
          "new_api": null,
          "old_text": "ht_up_update (ctx.visited_blocks, (ut64)(size_t)predecessor, (void *)ctx.cur_succ_count)",
          "new_text": null,
          "old_line_content": "\t\t\tht_up_update (ctx.visited_blocks, (ut64)(size_t)predecessor, (void *)ctx.cur_succ_count);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1035,
          "old_api": "ht_up_update (ctx.predecessors, (ut64)(size_t)clock, predecessor)",
          "new_api": null,
          "old_text": "ht_up_update (ctx.predecessors, (ut64)(size_t)clock, predecessor)",
          "new_text": null,
          "old_line_content": "\t\t\t\tht_up_update (ctx.predecessors, (ut64)(size_t)clock, predecessor);",
          "new_line_content": "\t\t\t// Update number of successors of the predecessor",
          "content_same": false
        },
        {
          "line": 1039,
          "old_api": "free (it)",
          "new_api": null,
          "old_text": "free (it)",
          "new_text": null,
          "old_line_content": "\t\t\tfree (it);",
          "new_line_content": "\t\t\tr_list_foreach (fixup_candidates, bit, clock) {",
          "content_same": false
        },
        {
          "line": 1042,
          "old_api": "r_list_purge (fixup_candidates)",
          "new_api": null,
          "old_text": "r_list_purge (fixup_candidates)",
          "new_text": null,
          "old_line_content": "\t\tr_list_purge (fixup_candidates);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 1046,
          "old_api": "ht_up_free (ctx.predecessors)",
          "new_api": null,
          "old_text": "ht_up_free (ctx.predecessors)",
          "new_text": null,
          "old_line_content": "\tht_up_free (ctx.predecessors);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 1047,
          "old_api": "ht_up_free (ctx.visited_blocks)",
          "new_api": null,
          "old_text": "ht_up_free (ctx.visited_blocks)",
          "new_text": null,
          "old_line_content": "\tht_up_free (ctx.visited_blocks);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1049,
          "old_api": "set_u_free (relevant_fcns)",
          "new_api": null,
          "old_text": "set_u_free (relevant_fcns)",
          "new_text": null,
          "old_line_content": "\tset_u_free (relevant_fcns);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1050,
          "old_api": "r_list_free (fixup_candidates)",
          "new_api": null,
          "old_text": "r_list_free (fixup_candidates)",
          "new_text": null,
          "old_line_content": "\tr_list_free (fixup_candidates);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": "r_anal_bb_offset_inst (bb, i)",
          "new_api": null,
          "old_text": "r_anal_bb_offset_inst (bb, i)",
          "new_text": null,
          "old_line_content": "\t\tut16 inst_off = r_anal_bb_offset_inst (bb, i);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": "ht_up_find_kv (ctx->visited, addr, NULL)",
          "new_api": null,
          "old_text": "ht_up_find_kv (ctx->visited, addr, NULL)",
          "new_text": null,
          "old_line_content": "\tif (ht_up_find_kv (ctx->visited, addr, NULL)) {",
          "new_line_content": "\tRPVector/*<RAnalBlock>*/ *next_visit; // accumulate block of the next level in the tree",
          "content_same": false
        },
        {
          "line": 666,
          "old_api": "ht_up_insert (ctx->visited, addr, ctx->cur_parent)",
          "new_api": null,
          "old_text": "ht_up_insert (ctx->visited, addr, ctx->cur_parent)",
          "new_text": null,
          "old_line_content": "\tht_up_insert (ctx->visited, addr, ctx->cur_parent);",
          "new_line_content": "static bool shortest_path_successor_cb(ut64 addr, void *user) {",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": "r_anal_get_block_at (ctx->anal, addr)",
          "new_api": null,
          "old_text": "r_anal_get_block_at (ctx->anal, addr)",
          "new_text": null,
          "old_line_content": "\tRAnalBlock *block = r_anal_get_block_at (ctx->anal, addr);",
          "new_line_content": "\tPathContext *ctx = user;",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": "r_pvector_push (ctx->next_visit, block)",
          "new_api": null,
          "old_text": "r_pvector_push (ctx->next_visit, block)",
          "new_text": null,
          "old_line_content": "\t\tr_pvector_push (ctx->next_visit, block);",
          "new_line_content": "\t\t// already visited",
          "content_same": false
        },
        {
          "line": 677,
          "old_api": "r_anal_get_blocks_in (a, n)",
          "new_api": null,
          "old_text": "r_anal_get_blocks_in (a, n)",
          "new_text": null,
          "old_line_content": "\tRList *blocks = r_anal_get_blocks_in (a, n);",
          "new_line_content": "\treturn addr != ctx->dst; // break if we found our destination",
          "content_same": false
        },
        {
          "line": 685,
          "old_api": "bb_addr_for (block->anal, dst)",
          "new_api": null,
          "old_text": "bb_addr_for (block->anal, dst)",
          "new_text": null,
          "old_line_content": "\tut64 dstbb_addr = bb_addr_for (block->anal, dst);",
          "new_line_content": "\t\treturn bb->addr;",
          "content_same": false
        },
        {
          "line": 694,
          "old_api": "r_pvector_init (&visit_a, NULL)",
          "new_api": null,
          "old_text": "r_pvector_init (&visit_a, NULL)",
          "new_text": null,
          "old_line_content": "\tr_pvector_init (&visit_a, NULL);",
          "new_line_content": "\tPathContext ctx;",
          "content_same": false
        },
        {
          "line": 696,
          "old_api": "r_pvector_init (&visit_b, NULL)",
          "new_api": null,
          "old_text": "r_pvector_init (&visit_b, NULL)",
          "new_text": null,
          "old_line_content": "\tr_pvector_init (&visit_b, NULL);",
          "new_line_content": "\tctx.dst = dstbb_addr;",
          "content_same": false
        },
        {
          "line": 705,
          "old_api": "ht_up_insert (ctx.visited, block->addr, NULL)",
          "new_api": null,
          "old_text": "ht_up_insert (ctx.visited, block->addr, NULL)",
          "new_text": null,
          "old_line_content": "\tht_up_insert (ctx.visited, block->addr, NULL);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": "r_pvector_empty (cur_visit)",
          "new_api": null,
          "old_text": "r_pvector_empty (cur_visit)",
          "new_text": null,
          "old_line_content": "\twhile (!r_pvector_empty (cur_visit)) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 714,
          "old_api": "r_anal_block_successor_addrs_foreach (cur, shortest_path_successor_cb, &ctx)",
          "new_api": null,
          "old_text": "r_anal_block_successor_addrs_foreach (cur, shortest_path_successor_cb, &ctx)",
          "new_text": null,
          "old_line_content": "\t\t\tr_anal_block_successor_addrs_foreach (cur, shortest_path_successor_cb, &ctx);",
          "new_line_content": "\t// BFS",
          "content_same": false
        },
        {
          "line": 719,
          "old_api": "r_pvector_clear (ctx.next_visit)",
          "new_api": null,
          "old_text": "r_pvector_clear (ctx.next_visit)",
          "new_text": null,
          "old_line_content": "\t\tr_pvector_clear (ctx.next_visit);",
          "new_line_content": "\t\t\tctx.cur_parent = cur;",
          "content_same": false
        },
        {
          "line": 724,
          "old_api": "ht_up_find (ctx.visited, dstbb_addr, &found)",
          "new_api": null,
          "old_text": "ht_up_find (ctx.visited, dstbb_addr, &found)",
          "new_text": null,
          "old_line_content": "\tRAnalBlock *prev = ht_up_find (ctx.visited, dstbb_addr, &found);",
          "new_line_content": "\t\tctx.next_visit = tmp;",
          "content_same": false
        },
        {
          "line": 727,
          "old_api": "r_list_newf ((RListFree)r_anal_block_unref)",
          "new_api": null,
          "old_text": "r_list_newf ((RListFree)r_anal_block_unref)",
          "new_text": null,
          "old_line_content": "\t\tret = r_list_newf ((RListFree)r_anal_block_unref);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "r_anal_block_ref (dst_block)",
          "new_api": null,
          "old_text": "r_anal_block_ref (dst_block)",
          "new_text": null,
          "old_line_content": "\t\tr_anal_block_ref (dst_block);",
          "new_line_content": "\t// reconstruct the path",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": "r_list_prepend (ret, dst_block)",
          "new_api": null,
          "old_text": "r_list_prepend (ret, dst_block)",
          "new_text": null,
          "old_line_content": "\t\tr_list_prepend (ret, dst_block);",
          "new_line_content": "\tbool found = false;",
          "content_same": false
        },
        {
          "line": 732,
          "old_api": "r_list_prepend (ret, prev)",
          "new_api": null,
          "old_text": "r_list_prepend (ret, prev)",
          "new_text": null,
          "old_line_content": "\t\t\tr_list_prepend (ret, prev);",
          "new_line_content": "\tif (found && dst_block) {",
          "content_same": false
        },
        {
          "line": 740,
          "old_api": "r_pvector_clear (&visit_b)",
          "new_api": null,
          "old_text": "r_pvector_clear (&visit_b)",
          "new_text": null,
          "old_line_content": "\tr_pvector_clear (&visit_b);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 752,
          "old_api": "malloc (block->size)",
          "new_api": null,
          "old_text": "malloc (block->size)",
          "new_text": null,
          "old_line_content": "\tut8 *buf = malloc (block->size);",
          "new_line_content": "\tif (!block->bbhash) {",
          "content_same": false
        },
        {
          "line": 756,
          "old_api": "block->anal->iob.read_at (block->anal->iob.io, block->addr, buf, block->size)",
          "new_api": null,
          "old_text": "block->anal->iob.read_at (block->anal->iob.io, block->addr, buf, block->size)",
          "new_text": null,
          "old_line_content": "\tif (!block->anal->iob.read_at (block->anal->iob.io, block->addr, buf, block->size)) {",
          "new_line_content": "\t\treturn false;",
          "content_same": false
        },
        {
          "line": 757,
          "old_api": "free (buf)",
          "new_api": null,
          "old_text": "free (buf)",
          "new_text": null,
          "old_line_content": "\t\tfree (buf);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 760,
          "old_api": "r_hash_xxhash (buf, block->size)",
          "new_api": null,
          "old_text": "r_hash_xxhash (buf, block->size)",
          "new_text": null,
          "old_line_content": "\tut32 cur_hash = r_hash_xxhash (buf, block->size);",
          "new_line_content": "\t\treturn false;",
          "content_same": false
        },
        {
          "line": 761,
          "old_api": "free (buf)",
          "new_api": null,
          "old_text": "free (buf)",
          "new_text": null,
          "old_line_content": "\tfree (buf);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 773,
          "old_api": "malloc (block->size)",
          "new_api": null,
          "old_text": "malloc (block->size)",
          "new_text": null,
          "old_line_content": "\tut8 *buf = malloc (block->size);",
          "new_line_content": "\tif (!block->anal->iob.read_at) {",
          "content_same": false
        },
        {
          "line": 775,
          "old_api": "block->anal->iob.read_at (block->anal->iob.io, block->addr, buf, block->size)",
          "new_api": null,
          "old_text": "block->anal->iob.read_at (block->anal->iob.io, block->addr, buf, block->size)",
          "new_text": null,
          "old_line_content": "\t\tif (!block->anal->iob.read_at (block->anal->iob.io, block->addr, buf, block->size)) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": "free (buf)",
          "new_api": null,
          "old_text": "free (buf)",
          "new_text": null,
          "old_line_content": "\t\t\tfree (buf);",
          "new_line_content": "\tif (block->size < 1) {",
          "content_same": false
        },
        {
          "line": 780,
          "old_api": "free (buf)",
          "new_api": null,
          "old_text": "free (buf)",
          "new_text": null,
          "old_line_content": "\t\tfree (buf);",
          "new_line_content": "\tif (buf) {",
          "content_same": false
        },
        {
          "line": 791,
          "old_api": "r_anal_block_unref (succ->block)",
          "new_api": null,
          "old_text": "r_anal_block_unref (succ->block)",
          "new_text": null,
          "old_line_content": "\tr_anal_block_unref (succ->block);",
          "new_line_content": "\tRAnalBlock *block;",
          "content_same": false
        },
        {
          "line": 792,
          "old_api": "free (succ)",
          "new_api": null,
          "old_text": "free (succ)",
          "new_text": null,
          "old_line_content": "\tfree (succ);",
          "new_line_content": "\tbool reachable;",
          "content_same": false
        },
        {
          "line": 800,
          "old_api": "R_NEW0 (NoreturnSuccessor)",
          "new_api": null,
          "old_text": "R_NEW0 (NoreturnSuccessor)",
          "new_text": null,
          "old_line_content": "\tNoreturnSuccessor *succ = R_NEW0 (NoreturnSuccessor);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 804,
          "old_api": "r_anal_block_ref (block)",
          "new_api": null,
          "old_text": "r_anal_block_ref (block)",
          "new_text": null,
          "old_line_content": "\tr_anal_block_ref (block);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 807,
          "old_api": "ht_up_insert (succs, block->addr, succ)",
          "new_api": null,
          "old_text": "ht_up_insert (succs, block->addr, succ)",
          "new_text": null,
          "old_line_content": "\tht_up_insert (succs, block->addr, succ);",
          "new_line_content": "\tif (!succ) {",
          "content_same": false
        },
        {
          "line": 823,
          "old_api": "r_list_contains (succ->block->fcns, fcn)",
          "new_api": null,
          "old_text": "r_list_contains (succ->block->fcns, fcn)",
          "new_text": null,
          "old_line_content": "\tif (!succ->reachable && r_list_contains (succ->block->fcns, fcn)) {",
          "new_line_content": "\treturn true;",
          "content_same": false
        },
        {
          "line": 824,
          "old_api": "r_anal_function_remove_block (fcn, succ->block)",
          "new_api": null,
          "old_text": "r_anal_function_remove_block (fcn, succ->block)",
          "new_text": null,
          "old_line_content": "\t\tr_anal_function_remove_block (fcn, succ->block);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 833,
          "old_api": "r_anal_block_ref (succ->block)",
          "new_api": null,
          "old_text": "r_anal_block_ref (succ->block)",
          "new_text": null,
          "old_line_content": "\tr_anal_block_ref (succ->block);",
          "new_line_content": "\treturn true;",
          "content_same": false
        },
        {
          "line": 834,
          "old_api": "r_list_push (blocks, succ->block)",
          "new_api": null,
          "old_text": "r_list_push (blocks, succ->block)",
          "new_text": null,
          "old_line_content": "\tr_list_push (blocks, succ->block);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 843,
          "old_api": "r_anal_block_ref (block)",
          "new_api": null,
          "old_text": "r_anal_block_ref (block)",
          "new_text": null,
          "old_line_content": "\tr_anal_block_ref (block);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 847,
          "old_api": "ht_up_new (NULL, noreturn_successor_free, NULL)",
          "new_api": null,
          "old_text": "ht_up_new (NULL, noreturn_successor_free, NULL)",
          "new_text": null,
          "old_line_content": "\tHtUP *succs = ht_up_new (NULL, noreturn_successor_free, NULL); // maps block addr (ut64) => NoreturnSuccessor *",
          "new_line_content": "\t\treturn block;",
          "content_same": false
        },
        {
          "line": 851,
          "old_api": "r_anal_block_recurse (block, noreturn_successors_cb, succs)",
          "new_api": null,
          "old_text": "r_anal_block_recurse (block, noreturn_successors_cb, succs)",
          "new_text": null,
          "old_line_content": "\tr_anal_block_recurse (block, noreturn_successors_cb, succs);",
          "new_line_content": "\t// Cache all recursive successors of block here.",
          "content_same": false
        },
        {
          "line": 854,
          "old_api": "r_anal_block_set_size (block, addr - block->addr)",
          "new_api": null,
          "old_text": "r_anal_block_set_size (block, addr - block->addr)",
          "new_text": null,
          "old_line_content": "\tr_anal_block_set_size (block, addr - block->addr);",
          "new_line_content": "\tif (!succs) {",
          "content_same": false
        },
        {
          "line": 855,
          "old_api": "r_anal_block_update_hash (block)",
          "new_api": null,
          "old_text": "r_anal_block_update_hash (block)",
          "new_text": null,
          "old_line_content": "\tr_anal_block_update_hash (block);",
          "new_line_content": "\t\treturn block;",
          "content_same": false
        },
        {
          "line": 858,
          "old_api": "r_anal_switch_op_free (block->switch_op)",
          "new_api": null,
          "old_text": "r_anal_switch_op_free (block->switch_op)",
          "new_text": null,
          "old_line_content": "\tr_anal_switch_op_free (block->switch_op);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 865,
          "old_api": "r_list_clone (block->fcns, NULL)",
          "new_api": null,
          "old_text": "r_list_clone (block->fcns, NULL)",
          "new_text": null,
          "old_line_content": "\tRList *fcns_cpy = r_list_clone (block->fcns, NULL);",
          "new_line_content": "\tblock->switch_op = NULL;",
          "content_same": false
        },
        {
          "line": 867,
          "old_api": "r_anal_get_block_at (block->anal, fcn->addr)",
          "new_api": null,
          "old_text": "r_anal_get_block_at (block->anal, fcn->addr)",
          "new_text": null,
          "old_line_content": "\t\tRAnalBlock *entry = r_anal_get_block_at (block->anal, fcn->addr);",
          "new_line_content": "\t// Now, for each fcn, check which of our successors are still reachable in the function remove and the ones that are not.",
          "content_same": false
        },
        {
          "line": 868,
          "old_api": "r_list_contains (entry->fcns, fcn)",
          "new_api": null,
          "old_text": "r_list_contains (entry->fcns, fcn)",
          "new_text": null,
          "old_line_content": "\t\tif (entry && r_list_contains (entry->fcns, fcn)) {",
          "new_line_content": "\tRListIter *it;",
          "content_same": false
        },
        {
          "line": 869,
          "old_api": "r_anal_block_recurse (entry, noreturn_successors_reachable_cb, succs)",
          "new_api": null,
          "old_text": "r_anal_block_recurse (entry, noreturn_successors_reachable_cb, succs)",
          "new_text": null,
          "old_line_content": "\t\t\tr_anal_block_recurse (entry, noreturn_successors_reachable_cb, succs);",
          "new_line_content": "\tRAnalFunction *fcn;",
          "content_same": false
        },
        {
          "line": 878,
          "old_api": "r_list_init (&merge_blocks)",
          "new_api": null,
          "old_text": "r_list_init (&merge_blocks)",
          "new_text": null,
          "old_line_content": "\tr_list_init (&merge_blocks);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 880,
          "old_api": "ht_up_foreach (succs, noreturn_get_blocks_cb, &merge_blocks)",
          "new_api": null,
          "old_text": "ht_up_foreach (succs, noreturn_get_blocks_cb, &merge_blocks)",
          "new_text": null,
          "old_line_content": "\tht_up_foreach (succs, noreturn_get_blocks_cb, &merge_blocks);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 885,
          "old_api": "ht_up_free (succs)",
          "new_api": null,
          "old_text": "ht_up_free (succs)",
          "new_text": null,
          "old_line_content": "\tht_up_free (succs);",
          "new_line_content": "\tmerge_blocks.free = (RListFree)r_anal_block_unref;",
          "content_same": false
        },
        {
          "line": 902,
          "old_api": "r_list_purge (&merge_blocks)",
          "new_api": null,
          "old_text": "r_list_purge (&merge_blocks)",
          "new_text": null,
          "old_line_content": "\tr_list_purge (&merge_blocks);",
          "new_line_content": "\t\t\t// block is still there",
          "content_same": false
        },
        {
          "line": 930,
          "old_api": "ht_up_find (ctx->blocks, addr, NULL)",
          "new_api": null,
          "old_text": "ht_up_find (ctx->blocks, addr, NULL)",
          "new_text": null,
          "old_line_content": "\tRAnalBlock *block = ht_up_find (ctx->blocks, addr, NULL);",
          "new_line_content": "static bool automerge_predecessor_successor_cb(ut64 addr, void *user) {",
          "content_same": false
        },
        {
          "line": 940,
          "old_api": "ht_up_update (ctx->predecessors, (ut64)(size_t) block, NULL)",
          "new_api": null,
          "old_text": "ht_up_update (ctx->predecessors, (ut64)(size_t) block, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\tht_up_update (ctx->predecessors, (ut64)(size_t) block, NULL);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 944,
          "old_api": "ht_up_insert (ctx->predecessors, (ut64)(size_t) block, ctx->cur_pred)",
          "new_api": null,
          "old_text": "ht_up_insert (ctx->predecessors, (ut64)(size_t) block, ctx->cur_pred)",
          "new_text": null,
          "old_line_content": "\t\tht_up_insert (ctx->predecessors, (ut64)(size_t) block, ctx->cur_pred);",
          "new_line_content": "\t\tif (pred) {",
          "content_same": false
        },
        {
          "line": 957,
          "old_api": "r_list_foreach (fcn->bbs, it, block)",
          "new_api": null,
          "old_text": "r_list_foreach (fcn->bbs, it, block)",
          "new_text": null,
          "old_line_content": "\tr_list_foreach (fcn->bbs, it, block) {",
          "new_line_content": "\t\treturn true;",
          "content_same": false
        },
        {
          "line": 959,
          "old_api": "ht_up_find (ctx->visited_blocks, (ut64)(size_t)block, &already_visited)",
          "new_api": null,
          "old_text": "ht_up_find (ctx->visited_blocks, (ut64)(size_t)block, &already_visited)",
          "new_text": null,
          "old_line_content": "\t\tht_up_find (ctx->visited_blocks, (ut64)(size_t)block, &already_visited);",
          "new_line_content": "\tAutomergeCtx *ctx = user;",
          "content_same": false
        },
        {
          "line": 966,
          "old_api": "ht_up_insert (ctx->visited_blocks, (ut64)(size_t)block, (void *)ctx->cur_succ_count)",
          "new_api": null,
          "old_text": "ht_up_insert (ctx->visited_blocks, (ut64)(size_t)block, (void *)ctx->cur_succ_count)",
          "new_text": null,
          "old_line_content": "\t\tht_up_insert (ctx->visited_blocks, (ut64)(size_t)block, (void *)ctx->cur_succ_count);",
          "new_line_content": "\t\tif (already_visited) {",
          "content_same": false
        },
        {
          "line": 974,
          "old_api": "r_return_if_fail (blocks)",
          "new_api": null,
          "old_text": "r_return_if_fail (blocks)",
          "new_text": null,
          "old_line_content": "\tr_return_if_fail (blocks);",
          "new_line_content": "\treturn true;",
          "content_same": false
        },
        {
          "line": 976,
          "old_api": "ht_up_new0 ()",
          "new_api": null,
          "old_text": "ht_up_new0 ()",
          "new_text": null,
          "old_line_content": "\t\t.predecessors = ht_up_new0 (),",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 977,
          "old_api": "ht_up_new0 ()",
          "new_api": null,
          "old_text": "ht_up_new0 ()",
          "new_text": null,
          "old_line_content": "\t\t.visited_blocks = ht_up_new0 (),",
          "new_line_content": "// Try to find the contiguous predecessors of all given blocks and merge them if possible,",
          "content_same": false
        },
        {
          "line": 978,
          "old_api": "ht_up_new0 ()",
          "new_api": null,
          "old_text": "ht_up_new0 ()",
          "new_text": null,
          "old_line_content": "\t\t.blocks = ht_up_new0 ()",
          "new_line_content": "// i.e. if there are no other blocks that have this block as one of their successors",
          "content_same": false
        },
        {
          "line": 981,
          "old_api": "set_u_new ()",
          "new_api": null,
          "old_text": "set_u_new ()",
          "new_text": null,
          "old_line_content": "\tSetU *relevant_fcns = set_u_new ();",
          "new_line_content": "\tAutomergeCtx ctx = {",
          "content_same": false
        },
        {
          "line": 993,
          "old_api": "r_list_foreach (block->fcns, fit, fcn)",
          "new_api": null,
          "old_text": "r_list_foreach (block->fcns, fit, fcn)",
          "new_text": null,
          "old_line_content": "\t\tr_list_foreach (block->fcns, fit, fcn) {",
          "new_line_content": "\t// Get all the functions and prepare ctx.blocks",
          "content_same": false
        },
        {
          "line": 994,
          "old_api": "set_u_add (relevant_fcns, (ut64)(size_t)fcn)",
          "new_api": null,
          "old_text": "set_u_add (relevant_fcns, (ut64)(size_t)fcn)",
          "new_text": null,
          "old_line_content": "\t\t\tset_u_add (relevant_fcns, (ut64)(size_t)fcn);",
          "new_line_content": "\tRListIter *it;",
          "content_same": false
        },
        {
          "line": 996,
          "old_api": "ht_up_insert (ctx.blocks, block->addr, block)",
          "new_api": null,
          "old_text": "ht_up_insert (ctx.blocks, block->addr, block)",
          "new_text": null,
          "old_line_content": "\t\tht_up_insert (ctx.blocks, block->addr, block);",
          "new_line_content": "\tr_list_foreach (blocks, it, block) {",
          "content_same": false
        },
        {
          "line": 1005,
          "old_api": "ht_up_find (ctx.predecessors, (ut64)(size_t)block, NULL)",
          "new_api": null,
          "old_text": "ht_up_find (ctx.predecessors, (ut64)(size_t)block, NULL)",
          "new_text": null,
          "old_line_content": "\t\tRAnalBlock *predecessor = ht_up_find (ctx.predecessors, (ut64)(size_t)block, NULL);",
          "new_line_content": "\t// Get the single predecessors we might want to merge with",
          "content_same": false
        },
        {
          "line": 1009,
          "old_api": "ht_up_find (ctx.visited_blocks, (ut64)(size_t)predecessor, NULL)",
          "new_api": null,
          "old_text": "ht_up_find (ctx.visited_blocks, (ut64)(size_t)predecessor, NULL)",
          "new_text": null,
          "old_line_content": "\t\tsize_t pred_succs_count = (size_t)ht_up_find (ctx.visited_blocks, (ut64)(size_t)predecessor, NULL);",
          "new_line_content": "\tRListIter *tmp;",
          "content_same": false
        },
        {
          "line": 1021,
          "old_api": "ht_up_find (ctx.predecessors, (ut64)(size_t)clock, NULL)",
          "new_api": null,
          "old_text": "ht_up_find (ctx.predecessors, (ut64)(size_t)clock, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\tRAnalBlock *fixup_pred = ht_up_find (ctx.predecessors, (ut64)(size_t)clock, NULL);",
          "new_line_content": "\t\t// We are about to merge block into predecessor",
          "content_same": false
        },
        {
          "line": 1023,
          "old_api": "r_list_push (fixup_candidates, clock)",
          "new_api": null,
          "old_text": "r_list_push (fixup_candidates, clock)",
          "new_text": null,
          "old_line_content": "\t\t\t\tr_list_push (fixup_candidates, clock);",
          "new_line_content": "\t\t// we would uaf after the merge since block will be freed.",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 24,
      "total_additions": 78,
      "total_deletions": 78,
      "total_api_changes": 180
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 6,
        "api_related_lines": 180,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          642,
          643,
          648,
          649,
          650
        ]
      }
    },
    "api_calls_before": 262,
    "api_calls_after": 262,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 0,
      "total_diff_lines": 21
    }
  }
}