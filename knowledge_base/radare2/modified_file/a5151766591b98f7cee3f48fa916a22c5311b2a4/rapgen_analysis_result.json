{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/radare2/modified_file/a5151766591b98f7cee3f48fa916a22c5311b2a4",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/radare2/modified_file/a5151766591b98f7cee3f48fa916a22c5311b2a4/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/radare2/modified_file/a5151766591b98f7cee3f48fa916a22c5311b2a4/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/radare2/modified_file/a5151766591b98f7cee3f48fa916a22c5311b2a4/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 664,
          "old_api": "malloc (csize)",
          "new_api": "MultiByteToWideChar (CP_UTF8, 0, str, len, NULL, 0)",
          "old_text": "malloc (csize)",
          "new_text": "MultiByteToWideChar (CP_UTF8, 0, str, len, NULL, 0)",
          "old_line_content": "\t\t\t\tif ((acp = malloc (csize))) {",
          "new_line_content": "\tif ((wcsize = MultiByteToWideChar (CP_UTF8, 0, str, len, NULL, 0))) {",
          "content_same": false
        },
        {
          "line": 742,
          "old_api": "r_utf8_decode (str_ptr, str_end - str_ptr, &ch)",
          "new_api": "R_NEWS (int, len + 1)",
          "old_text": "r_utf8_decode (str_ptr, str_end - str_ptr, &ch)",
          "new_text": "R_NEWS (int, len + 1)",
          "old_line_content": "\t\tint ch_bytes = r_utf8_decode (str_ptr, str_end - str_ptr, &ch);",
          "new_line_content": "\tint *list = R_NEWS (int, len + 1);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 646,
          "old_api": null,
          "new_api": "MultiByteToWideChar (CP_UTF8, 0, cstring, len, NULL, 0)",
          "old_text": null,
          "new_text": "MultiByteToWideChar (CP_UTF8, 0, cstring, len, NULL, 0)",
          "old_line_content": "}",
          "new_line_content": "\tif ((wcsize = MultiByteToWideChar (CP_UTF8, 0, cstring, len, NULL, 0))) {",
          "content_same": false
        },
        {
          "line": 648,
          "old_api": null,
          "new_api": "calloc (wcsize, sizeof (wchar_t))",
          "old_text": null,
          "new_text": "calloc (wcsize, sizeof (wchar_t))",
          "old_line_content": "R_API char *r_utf8_to_acp_l(const ut8 *str, int len) {",
          "new_line_content": "\t\tif ((rutf16 = (wchar_t *) calloc (wcsize, sizeof (wchar_t)))) {",
          "content_same": false
        },
        {
          "line": 649,
          "old_api": null,
          "new_api": "MultiByteToWideChar (CP_UTF8, 0, cstring, len, rutf16, wcsize)",
          "old_text": null,
          "new_text": "MultiByteToWideChar (CP_UTF8, 0, cstring, len, rutf16, wcsize)",
          "old_line_content": "\tif (!str || !len || len < -1) {",
          "new_line_content": "\t\t\tMultiByteToWideChar (CP_UTF8, 0, cstring, len, rutf16, wcsize);",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": null,
          "new_api": "calloc (wcsize, sizeof (wchar_t))",
          "old_text": null,
          "new_text": "calloc (wcsize, sizeof (wchar_t))",
          "old_line_content": "\t\t\t\t\t\tacp[csize - 1] = '\\0';",
          "new_line_content": "\t\tif ((rutf16 = (wchar_t *)calloc (wcsize, sizeof (wchar_t)))) {",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": null,
          "new_api": "MultiByteToWideChar (CP_UTF8, 0, str, len, rutf16, wcsize)",
          "old_text": null,
          "new_text": "MultiByteToWideChar (CP_UTF8, 0, str, len, rutf16, wcsize)",
          "old_line_content": "\t\t\t\t\t}",
          "new_line_content": "\t\t\tMultiByteToWideChar (CP_UTF8, 0, str, len, rutf16, wcsize);",
          "content_same": false
        },
        {
          "line": 672,
          "old_api": null,
          "new_api": "WideCharToMultiByte (CP_ACP, 0, rutf16, wcsize, NULL, 0, NULL, NULL)",
          "old_text": null,
          "new_text": "WideCharToMultiByte (CP_ACP, 0, rutf16, wcsize, NULL, 0, NULL, NULL)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tif ((csize = WideCharToMultiByte (CP_ACP, 0, rutf16, wcsize, NULL, 0, NULL, NULL))) {",
          "content_same": false
        },
        {
          "line": 674,
          "old_api": null,
          "new_api": "malloc (csize)",
          "old_text": null,
          "new_text": "malloc (csize)",
          "old_line_content": "\treturn acp;",
          "new_line_content": "\t\t\t\tif ((acp = malloc (csize))) {",
          "content_same": false
        },
        {
          "line": 675,
          "old_api": null,
          "new_api": "WideCharToMultiByte (CP_ACP, 0, rutf16, wcsize, acp, csize, NULL, NULL)",
          "old_text": null,
          "new_text": "WideCharToMultiByte (CP_ACP, 0, rutf16, wcsize, acp, csize, NULL, NULL)",
          "old_line_content": "}",
          "new_line_content": "\t\t\t\t\tWideCharToMultiByte (CP_ACP, 0, rutf16, wcsize, acp, csize, NULL, NULL);",
          "content_same": false
        },
        {
          "line": 681,
          "old_api": null,
          "new_api": "free (rutf16)",
          "old_text": null,
          "new_text": "free (rutf16)",
          "old_line_content": "\tint wcsize;",
          "new_line_content": "\t\t\tfree (rutf16);",
          "content_same": false
        },
        {
          "line": 692,
          "old_api": null,
          "new_api": "MultiByteToWideChar (CP_ACP, 0, str, len, NULL, 0)",
          "old_text": null,
          "new_text": "MultiByteToWideChar (CP_ACP, 0, str, len, NULL, 0)",
          "old_line_content": "\t\t\treturn ret;",
          "new_line_content": "\tif ((wcsize = MultiByteToWideChar (CP_ACP, 0, str, len, NULL, 0))) {",
          "content_same": false
        },
        {
          "line": 695,
          "old_api": null,
          "new_api": "calloc (wcsize, sizeof (wchar_t))",
          "old_text": null,
          "new_text": "calloc (wcsize, sizeof (wchar_t))",
          "old_line_content": "\treturn NULL;",
          "new_line_content": "\t\tif ((rutf16 = (wchar_t *) calloc (wcsize, sizeof (wchar_t)))) {",
          "content_same": false
        },
        {
          "line": 696,
          "old_api": null,
          "new_api": "MultiByteToWideChar (CP_ACP, 0, str, len, rutf16, wcsize)",
          "old_text": null,
          "new_text": "MultiByteToWideChar (CP_ACP, 0, str, len, rutf16, wcsize)",
          "old_line_content": "}",
          "new_line_content": "\t\t\tMultiByteToWideChar (CP_ACP, 0, str, len, rutf16, wcsize);",
          "content_same": false
        },
        {
          "line": 700,
          "old_api": null,
          "new_api": "r_utf16_to_utf8_l (rutf16, wcsize)",
          "old_text": null,
          "new_text": "r_utf16_to_utf8_l (rutf16, wcsize)",
          "old_line_content": "R_API int r_utf_block_idx(RRune ch) {",
          "new_line_content": "\t\t\tconst char *ret = r_utf16_to_utf8_l (rutf16, wcsize);",
          "content_same": false
        },
        {
          "line": 701,
          "old_api": null,
          "new_api": "free (rutf16)",
          "old_text": null,
          "new_text": "free (rutf16)",
          "old_line_content": "\tconst int last = r_utf_blocks_count;",
          "new_line_content": "\t\t\tfree (rutf16);",
          "content_same": false
        },
        {
          "line": 739,
          "old_api": null,
          "new_api": "strlen ((const char *)str)",
          "old_text": null,
          "new_text": "strlen ((const char *)str)",
          "old_line_content": "\tRRune ch;",
          "new_line_content": "\t\tlen = strlen ((const char *)str);",
          "content_same": false
        },
        {
          "line": 752,
          "old_api": null,
          "new_api": "r_utf8_decode (str_ptr, str_end - str_ptr, &ch)",
          "old_text": null,
          "new_text": "r_utf8_decode (str_ptr, str_end - str_ptr, &ch)",
          "old_line_content": "\t\t\tlist_ptr++;",
          "new_line_content": "\t\tint ch_bytes = r_utf8_decode (str_ptr, str_end - str_ptr, &ch);",
          "content_same": false
        },
        {
          "line": 627,
          "old_api": null,
          "new_api": "WideCharToMultiByte (CP_UTF8, 0, wc, len, NULL, 0, NULL, NULL)",
          "old_text": null,
          "new_text": "WideCharToMultiByte (CP_UTF8, 0, wc, len, NULL, 0, NULL, NULL)",
          "old_line_content": "}",
          "new_line_content": "\tif ((csize = WideCharToMultiByte (CP_UTF8, 0, wc, len, NULL, 0, NULL, NULL))) {",
          "content_same": false
        },
        {
          "line": 629,
          "old_api": null,
          "new_api": "malloc (csize)",
          "old_text": null,
          "new_text": "malloc (csize)",
          "old_line_content": "R_API wchar_t *r_utf8_to_utf16_l(const char *cstring, int len) {",
          "new_line_content": "\t\tif ((rutf8 = malloc (csize))) {",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": null,
          "new_api": "WideCharToMultiByte (CP_UTF8, 0, wc, len, rutf8, csize, NULL, NULL)",
          "old_text": null,
          "new_text": "WideCharToMultiByte (CP_UTF8, 0, wc, len, rutf8, csize, NULL, NULL)",
          "old_line_content": "\tif (!cstring || !len || len < -1) {",
          "new_line_content": "\t\t\tWideCharToMultiByte (CP_UTF8, 0, wc, len, rutf8, csize, NULL, NULL);",
          "content_same": false
        },
        {
          "line": 757,
          "old_api": null,
          "new_api": "r_utf_block_idx (ch)",
          "old_text": null,
          "new_text": "r_utf_block_idx (ch)",
          "old_line_content": "\tfor (list_ptr = list; *list_ptr != -1; list_ptr++) {",
          "new_line_content": "\t\t\tblock_idx = r_utf_block_idx (ch);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 654,
          "old_api": "MultiByteToWideChar (CP_UTF8, 0, str, len, NULL, 0)",
          "new_api": null,
          "old_text": "MultiByteToWideChar (CP_UTF8, 0, str, len, NULL, 0)",
          "new_text": null,
          "old_line_content": "\tif ((wcsize = MultiByteToWideChar (CP_UTF8, 0, str, len, NULL, 0))) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 657,
          "old_api": "calloc (wcsize, sizeof (wchar_t))",
          "new_api": null,
          "old_text": "calloc (wcsize, sizeof (wchar_t))",
          "new_text": null,
          "old_line_content": "\t\tif ((rutf16 = (wchar_t *)calloc (wcsize, sizeof (wchar_t)))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 658,
          "old_api": "MultiByteToWideChar (CP_UTF8, 0, str, len, rutf16, wcsize)",
          "new_api": null,
          "old_text": "MultiByteToWideChar (CP_UTF8, 0, str, len, rutf16, wcsize)",
          "new_text": null,
          "old_line_content": "\t\t\tMultiByteToWideChar (CP_UTF8, 0, str, len, rutf16, wcsize);",
          "new_line_content": "R_API char *r_utf8_to_acp_l(const ut8 *str, int len) {",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": "WideCharToMultiByte (CP_ACP, 0, rutf16, wcsize, NULL, 0, NULL, NULL)",
          "new_api": null,
          "old_text": "WideCharToMultiByte (CP_ACP, 0, rutf16, wcsize, NULL, 0, NULL, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\tif ((csize = WideCharToMultiByte (CP_ACP, 0, rutf16, wcsize, NULL, 0, NULL, NULL))) {",
          "new_line_content": "\tchar *acp = NULL;",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": "WideCharToMultiByte (CP_ACP, 0, rutf16, wcsize, acp, csize, NULL, NULL)",
          "new_api": null,
          "old_text": "WideCharToMultiByte (CP_ACP, 0, rutf16, wcsize, acp, csize, NULL, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tWideCharToMultiByte (CP_ACP, 0, rutf16, wcsize, acp, csize, NULL, NULL);",
          "new_line_content": "\t\twchar_t *rutf16;",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": "free (rutf16)",
          "new_api": null,
          "old_text": "free (rutf16)",
          "new_text": null,
          "old_line_content": "\t\t\tfree (rutf16);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": "MultiByteToWideChar (CP_ACP, 0, str, len, NULL, 0)",
          "new_api": null,
          "old_text": "MultiByteToWideChar (CP_ACP, 0, str, len, NULL, 0)",
          "new_text": null,
          "old_line_content": "\tif ((wcsize = MultiByteToWideChar (CP_ACP, 0, str, len, NULL, 0))) {",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 685,
          "old_api": "calloc (wcsize, sizeof (wchar_t))",
          "new_api": null,
          "old_text": "calloc (wcsize, sizeof (wchar_t))",
          "new_text": null,
          "old_line_content": "\t\tif ((rutf16 = (wchar_t *) calloc (wcsize, sizeof (wchar_t)))) {",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 686,
          "old_api": "MultiByteToWideChar (CP_ACP, 0, str, len, rutf16, wcsize)",
          "new_api": null,
          "old_text": "MultiByteToWideChar (CP_ACP, 0, str, len, rutf16, wcsize)",
          "new_text": null,
          "old_line_content": "\t\t\tMultiByteToWideChar (CP_ACP, 0, str, len, rutf16, wcsize);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 690,
          "old_api": "r_utf16_to_utf8_l (rutf16, wcsize)",
          "new_api": null,
          "old_text": "r_utf16_to_utf8_l (rutf16, wcsize)",
          "new_text": null,
          "old_line_content": "\t\t\tconst char *ret = r_utf16_to_utf8_l (rutf16, wcsize);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 691,
          "old_api": "free (rutf16)",
          "new_api": null,
          "old_text": "free (rutf16)",
          "new_text": null,
          "old_line_content": "\t\t\tfree (rutf16);",
          "new_line_content": "\tint wcsize;",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": "strlen ((const char *)str)",
          "new_api": null,
          "old_text": "strlen ((const char *)str)",
          "new_text": null,
          "old_line_content": "\t\tlen = strlen ((const char *)str);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 732,
          "old_api": "R_NEWS (int, len + 1)",
          "new_api": null,
          "old_text": "R_NEWS (int, len + 1)",
          "new_text": null,
          "old_line_content": "\tint *list = R_NEWS (int, len + 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": "WideCharToMultiByte (CP_UTF8, 0, wc, len, NULL, 0, NULL, NULL)",
          "new_api": null,
          "old_text": "WideCharToMultiByte (CP_UTF8, 0, wc, len, NULL, 0, NULL, NULL)",
          "new_text": null,
          "old_line_content": "\tif ((csize = WideCharToMultiByte (CP_UTF8, 0, wc, len, NULL, 0, NULL, NULL))) {",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 619,
          "old_api": "malloc (csize)",
          "new_api": null,
          "old_text": "malloc (csize)",
          "new_text": null,
          "old_line_content": "\t\tif ((rutf8 = malloc (csize))) {",
          "new_line_content": "#if __WINDOWS__",
          "content_same": false
        },
        {
          "line": 620,
          "old_api": "WideCharToMultiByte (CP_UTF8, 0, wc, len, rutf8, csize, NULL, NULL)",
          "new_api": null,
          "old_text": "WideCharToMultiByte (CP_UTF8, 0, wc, len, rutf8, csize, NULL, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\tWideCharToMultiByte (CP_UTF8, 0, wc, len, rutf8, csize, NULL, NULL);",
          "new_line_content": "R_API char *r_utf16_to_utf8_l(const wchar_t *wc, int len) {",
          "content_same": false
        },
        {
          "line": 747,
          "old_api": "r_utf_block_idx (ch)",
          "new_api": null,
          "old_text": "r_utf_block_idx (ch)",
          "new_text": null,
          "old_line_content": "\t\t\tblock_idx = r_utf_block_idx (ch);",
          "new_line_content": "\tconst ut8 *str_ptr = str;",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": "MultiByteToWideChar (CP_UTF8, 0, cstring, len, NULL, 0)",
          "new_api": null,
          "old_text": "MultiByteToWideChar (CP_UTF8, 0, cstring, len, NULL, 0)",
          "new_text": null,
          "old_line_content": "\tif ((wcsize = MultiByteToWideChar (CP_UTF8, 0, cstring, len, NULL, 0))) {",
          "new_line_content": "\treturn rutf8;",
          "content_same": false
        },
        {
          "line": 638,
          "old_api": "calloc (wcsize, sizeof (wchar_t))",
          "new_api": null,
          "old_text": "calloc (wcsize, sizeof (wchar_t))",
          "new_text": null,
          "old_line_content": "\t\tif ((rutf16 = (wchar_t *) calloc (wcsize, sizeof (wchar_t)))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 639,
          "old_api": "MultiByteToWideChar (CP_UTF8, 0, cstring, len, rutf16, wcsize)",
          "new_api": null,
          "old_text": "MultiByteToWideChar (CP_UTF8, 0, cstring, len, rutf16, wcsize)",
          "new_text": null,
          "old_line_content": "\t\t\tMultiByteToWideChar (CP_UTF8, 0, cstring, len, rutf16, wcsize);",
          "new_line_content": "R_API wchar_t *r_utf8_to_utf16_l(const char *cstring, int len) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 2,
      "total_additions": 20,
      "total_deletions": 20,
      "total_api_changes": 42
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 10,
        "api_related_lines": 42,
        "non_api_lines": 10,
        "non_api_line_numbers": [
          588,
          589,
          590,
          591,
          592,
          593,
          594,
          595,
          596,
          597
        ]
      }
    },
    "api_calls_before": 23,
    "api_calls_after": 23,
    "diff_info": {
      "added_lines": 10,
      "removed_lines": 0,
      "total_diff_lines": 22
    }
  }
}