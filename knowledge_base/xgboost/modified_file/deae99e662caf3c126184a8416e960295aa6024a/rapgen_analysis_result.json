{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/xgboost/modified_file/deae99e662caf3c126184a8416e960295aa6024a",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/xgboost/modified_file/deae99e662caf3c126184a8416e960295aa6024a/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/xgboost/modified_file/deae99e662caf3c126184a8416e960295aa6024a/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/xgboost/modified_file/deae99e662caf3c126184a8416e960295aa6024a/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 215,
          "old_api": "BuildHistKernel<do_prefetch, uint16_t, true, any_missing>(gpair, row_indices, gmat, hist)",
          "new_api": "BuildHistKernel<do_prefetch, uint8_t, true, any_missing>(gpair, row_indices, gmat, hist)",
          "old_text": "BuildHistKernel<do_prefetch, uint16_t, true, any_missing>(gpair, row_indices, gmat, hist)",
          "new_text": "BuildHistKernel<do_prefetch, uint8_t, true, any_missing>(gpair, row_indices, gmat, hist)",
          "old_line_content": "      BuildHistKernel<do_prefetch, uint16_t, true, any_missing>(gpair, row_indices, gmat, hist);",
          "new_line_content": "      BuildHistKernel<do_prefetch, uint8_t, true, any_missing>(gpair, row_indices, gmat, hist);",
          "content_same": false
        },
        {
          "line": 218,
          "old_api": "BuildHistKernel<do_prefetch, uint32_t, true, any_missing>(gpair, row_indices, gmat, hist)",
          "new_api": "BuildHistKernel<do_prefetch, uint16_t, true, any_missing>(gpair, row_indices, gmat, hist)",
          "old_text": "BuildHistKernel<do_prefetch, uint32_t, true, any_missing>(gpair, row_indices, gmat, hist)",
          "new_text": "BuildHistKernel<do_prefetch, uint16_t, true, any_missing>(gpair, row_indices, gmat, hist)",
          "old_line_content": "      BuildHistKernel<do_prefetch, uint32_t, true, any_missing>(gpair, row_indices, gmat, hist);",
          "new_line_content": "      BuildHistKernel<do_prefetch, uint16_t, true, any_missing>(gpair, row_indices, gmat, hist);",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": "CHECK",
          "new_api": "BuildHistKernel<do_prefetch, uint32_t, true, any_missing>(gpair, row_indices, gmat, hist)",
          "old_text": "CHECK(false)",
          "new_text": "BuildHistKernel<do_prefetch, uint32_t, true, any_missing>(gpair, row_indices, gmat, hist)",
          "old_line_content": "      CHECK(false);  // no default behavior",
          "new_line_content": "      BuildHistKernel<do_prefetch, uint32_t, true, any_missing>(gpair, row_indices, gmat, hist);",
          "content_same": false
        },
        {
          "line": 224,
          "old_api": "GetBinTypeSize",
          "new_api": "CHECK",
          "old_text": "gmat.index.GetBinTypeSize()",
          "new_text": "CHECK(false)",
          "old_line_content": "    switch (gmat.index.GetBinTypeSize()) {",
          "new_line_content": "      CHECK(false);  // no default behavior",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": "BuildHistKernel<do_prefetch, uint16_t, false, any_missing>(gpair, row_indices, gmat, hist)",
          "new_api": "BuildHistKernel<do_prefetch, uint8_t, false, any_missing>(gpair, row_indices, gmat, hist)",
          "old_text": "BuildHistKernel<do_prefetch, uint16_t, false, any_missing>(gpair, row_indices, gmat, hist)",
          "new_text": "BuildHistKernel<do_prefetch, uint8_t, false, any_missing>(gpair, row_indices, gmat, hist)",
          "old_line_content": "      BuildHistKernel<do_prefetch, uint16_t, false, any_missing>(gpair, row_indices, gmat, hist);",
          "new_line_content": "      BuildHistKernel<do_prefetch, uint8_t, false, any_missing>(gpair, row_indices, gmat, hist);",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "BuildHistKernel<do_prefetch, uint32_t, false, any_missing>(gpair, row_indices, gmat, hist)",
          "new_api": "BuildHistKernel<do_prefetch, uint16_t, false, any_missing>(gpair, row_indices, gmat, hist)",
          "old_text": "BuildHistKernel<do_prefetch, uint32_t, false, any_missing>(gpair, row_indices, gmat, hist)",
          "new_text": "BuildHistKernel<do_prefetch, uint16_t, false, any_missing>(gpair, row_indices, gmat, hist)",
          "old_line_content": "      BuildHistKernel<do_prefetch, uint32_t, false, any_missing>(gpair, row_indices, gmat, hist);",
          "new_line_content": "      BuildHistKernel<do_prefetch, uint16_t, false, any_missing>(gpair, row_indices, gmat, hist);",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": "CHECK",
          "new_api": "BuildHistKernel<do_prefetch, uint32_t, false, any_missing>(gpair, row_indices, gmat, hist)",
          "old_text": "CHECK(false)",
          "new_text": "BuildHistKernel<do_prefetch, uint32_t, false, any_missing>(gpair, row_indices, gmat, hist)",
          "old_line_content": "      CHECK(false);  // no default behavior",
          "new_line_content": "      BuildHistKernel<do_prefetch, uint32_t, false, any_missing>(gpair, row_indices, gmat, hist);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 256,
          "old_api": null,
          "new_api": "BuildHistDispatch<false, any_missing>(gpair, row_indices,\n                                                        gmat, hist)",
          "old_text": null,
          "new_text": "BuildHistDispatch<false, any_missing>(gpair, row_indices,\n                                                        gmat, hist)",
          "old_line_content": "    const RowSetCollection::Elem span1(row_indices.begin,",
          "new_line_content": "    BuildHistDispatch<false, any_missing>(gpair, row_indices,",
          "content_same": false
        },
        {
          "line": 227,
          "old_api": null,
          "new_api": "GetBinTypeSize",
          "old_text": null,
          "new_text": "gmat.index.GetBinTypeSize()",
          "old_line_content": "      break;",
          "new_line_content": "    switch (gmat.index.GetBinTypeSize()) {",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": null,
          "new_api": "static_cast<uint32_t>(gr_index_local[j])",
          "old_text": null,
          "new_text": "static_cast<uint32_t>(gr_index_local[j])",
          "old_line_content": "      hist_data[idx_bin] += pgh[idx_gh];",
          "new_line_content": "      const uint32_t idx_bin = two * (static_cast<uint32_t>(gr_index_local[j]) +",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": null,
          "new_api": "BuildHistDispatch<true, any_missing>(gpair, span1, gmat, hist)",
          "old_text": null,
          "new_text": "BuildHistDispatch<true, any_missing>(gpair, span1, gmat, hist)",
          "old_line_content": "  }",
          "new_line_content": "    BuildHistDispatch<true, any_missing>(gpair, span1, gmat, hist);",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": null,
          "new_api": "BuildHistDispatch<false, any_missing>(gpair, span2, gmat, hist)",
          "old_text": null,
          "new_text": "BuildHistDispatch<false, any_missing>(gpair, span2, gmat, hist)",
          "old_line_content": "",
          "new_line_content": "    BuildHistDispatch<false, any_missing>(gpair, span2, gmat, hist);",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": null,
          "new_api": "CHECK",
          "old_text": null,
          "new_text": "CHECK(false)",
          "old_line_content": "}",
          "new_line_content": "      CHECK(false);  // no default behavior",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": null,
          "new_api": "GetBinTypeSize",
          "old_text": null,
          "new_text": "gmat.index.GetBinTypeSize()",
          "old_line_content": "      break;",
          "new_line_content": "    switch (gmat.index.GetBinTypeSize()) {",
          "content_same": false
        },
        {
          "line": 247,
          "old_api": null,
          "new_api": "Size",
          "old_text": null,
          "new_text": "row_indices.Size()",
          "old_line_content": "  // if need to work with all rows from bin-matrix (e.g. root node)",
          "new_line_content": "  const size_t nrows = row_indices.Size();",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": null,
          "new_api": "Prefetch::NoPrefetchSize(nrows)",
          "old_text": null,
          "new_text": "Prefetch::NoPrefetchSize(nrows)",
          "old_line_content": "  const bool contiguousBlock =",
          "new_line_content": "  const size_t no_prefetch_size = Prefetch::NoPrefetchSize(nrows);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 226,
          "old_api": "BuildHistKernel<do_prefetch, uint8_t, false, any_missing>(gpair, row_indices, gmat, hist)",
          "new_api": null,
          "old_text": "BuildHistKernel<do_prefetch, uint8_t, false, any_missing>(gpair, row_indices, gmat, hist)",
          "new_text": null,
          "old_line_content": "      BuildHistKernel<do_prefetch, uint8_t, false, any_missing>(gpair, row_indices, gmat, hist);",
          "new_line_content": "  } else {",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": "static_cast<uint32_t>(gr_index_local[j])",
          "new_api": null,
          "old_text": "static_cast<uint32_t>(gr_index_local[j])",
          "new_text": null,
          "old_line_content": "      const uint32_t idx_bin = two * (static_cast<uint32_t>(gr_index_local[j]) +",
          "new_line_content": "    const float pgh_t[] = {pgh[idx_gh], pgh[idx_gh + 1]};",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": "BuildHistDispatch<true, any_missing>(gpair, span1, gmat, hist)",
          "new_api": null,
          "old_text": "BuildHistDispatch<true, any_missing>(gpair, span1, gmat, hist)",
          "new_text": null,
          "old_line_content": "    BuildHistDispatch<true, any_missing>(gpair, span1, gmat, hist);",
          "new_line_content": "    const RowSetCollection::Elem span2(row_indices.end - no_prefetch_size,",
          "content_same": false
        },
        {
          "line": 263,
          "old_api": "BuildHistDispatch<false, any_missing>(gpair, span2, gmat, hist)",
          "new_api": null,
          "old_text": "BuildHistDispatch<false, any_missing>(gpair, span2, gmat, hist)",
          "new_text": null,
          "old_line_content": "    BuildHistDispatch<false, any_missing>(gpair, span2, gmat, hist);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": "GetBinTypeSize",
          "new_api": null,
          "old_text": "gmat.index.GetBinTypeSize()",
          "new_text": null,
          "old_line_content": "    switch (gmat.index.GetBinTypeSize()) {",
          "new_line_content": "                       GHistRow hist) {",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "BuildHistKernel<do_prefetch, uint8_t, true, any_missing>(gpair, row_indices, gmat, hist)",
          "new_api": null,
          "old_text": "BuildHistKernel<do_prefetch, uint8_t, true, any_missing>(gpair, row_indices, gmat, hist)",
          "new_text": null,
          "old_line_content": "      BuildHistKernel<do_prefetch, uint8_t, true, any_missing>(gpair, row_indices, gmat, hist);",
          "new_line_content": "  if (first_page) {",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": "Size",
          "new_api": null,
          "old_text": "row_indices.Size()",
          "new_text": null,
          "old_line_content": "  const size_t nrows = row_indices.Size();",
          "new_line_content": "void GHistBuilder::BuildHist(const std::vector<GradientPair> &gpair,",
          "content_same": false
        },
        {
          "line": 245,
          "old_api": "Prefetch::NoPrefetchSize(nrows)",
          "new_api": null,
          "old_text": "Prefetch::NoPrefetchSize(nrows)",
          "new_text": null,
          "old_line_content": "  const size_t no_prefetch_size = Prefetch::NoPrefetchSize(nrows);",
          "new_line_content": "                             const RowSetCollection::Elem row_indices, const GHistIndexMatrix &gmat,",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": "BuildHistDispatch<false, any_missing>(gpair, row_indices,\n                                                        gmat, hist)",
          "new_api": null,
          "old_text": "BuildHistDispatch<false, any_missing>(gpair, row_indices,\n                                                        gmat, hist)",
          "new_text": null,
          "old_line_content": "    BuildHistDispatch<false, any_missing>(gpair, row_indices,",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 7,
      "total_additions": 9,
      "total_deletions": 9,
      "total_api_changes": 25
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 25,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          195,
          199,
          200,
          201,
          202
        ]
      }
    },
    "api_calls_before": 82,
    "api_calls_after": 82,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 2,
      "total_diff_lines": 22
    }
  }
}