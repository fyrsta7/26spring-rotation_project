{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/98986948e8e124c5fe5beb4afa12c6995940fbb6",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/98986948e8e124c5fe5beb4afa12c6995940fbb6/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/98986948e8e124c5fe5beb4afa12c6995940fbb6/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/98986948e8e124c5fe5beb4afa12c6995940fbb6/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 75,
          "old_api": "talloc_strdup",
          "new_api": "talloc_array",
          "old_text": "talloc_strdup(priv, codec_name)",
          "new_text": "talloc_array(priv, char*, 0)",
          "old_line_content": "    priv->codec = talloc_strdup(priv, codec_name);",
          "new_line_content": "    priv->cur_list = talloc_array(priv, char*, 0);",
          "content_same": false
        },
        {
          "line": 79,
          "old_api": "mp_codec_to_av_codec_id",
          "new_api": "get_lavc_format",
          "old_text": "mp_codec_to_av_codec_id(fmt)",
          "new_text": "get_lavc_format(priv->codec)",
          "old_line_content": "    AVCodec *codec = avcodec_find_decoder(mp_codec_to_av_codec_id(fmt));",
          "new_line_content": "    const char *fmt = get_lavc_format(priv->codec);",
          "content_same": false
        },
        {
          "line": 88,
          "old_api": "av_dict_set",
          "new_api": "strcmp",
          "old_text": "av_dict_set(&opts, \"real_time\", \"1\", 0)",
          "new_text": "strcmp(codec_name, \"eia_608\")",
          "old_line_content": "        av_dict_set(&opts, \"real_time\", \"1\", 0);",
          "new_line_content": "    if (strcmp(codec_name, \"eia_608\") == 0)",
          "content_same": false
        },
        {
          "line": 89,
          "old_api": "avcodec_open2",
          "new_api": "av_dict_set",
          "old_text": "avcodec_open2(avctx, codec, &opts)",
          "new_text": "av_dict_set(&opts, \"real_time\", \"1\", 0)",
          "old_line_content": "    if (avcodec_open2(avctx, codec, &opts) < 0)",
          "new_line_content": "        av_dict_set(&opts, \"real_time\", \"1\", 0);",
          "content_same": false
        },
        {
          "line": 105,
          "old_api": "av_dict_free",
          "new_api": "MP_FATAL",
          "old_text": "av_dict_free(&opts)",
          "new_text": "MP_FATAL(priv, \"Could not open libavcodec subtitle converter\\n\")",
          "old_line_content": "    av_dict_free(&opts);",
          "new_line_content": "    MP_FATAL(priv, \"Could not open libavcodec subtitle converter\\n\");",
          "content_same": false
        },
        {
          "line": 106,
          "old_api": "av_free",
          "new_api": "av_dict_free",
          "old_text": "av_free(avctx)",
          "new_text": "av_dict_free(&opts)",
          "old_line_content": "    av_free(avctx);",
          "new_line_content": "    av_dict_free(&opts);",
          "content_same": false
        },
        {
          "line": 107,
          "old_api": "talloc_free",
          "new_api": "av_free",
          "old_text": "talloc_free(priv)",
          "new_text": "av_free(avctx)",
          "old_line_content": "    talloc_free(priv);",
          "new_line_content": "    av_free(avctx);",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": "AVERROR",
          "new_api": "av_packet_unref",
          "old_text": "AVERROR(ENOMEM)",
          "new_text": "av_packet_unref(pkt)",
          "old_line_content": "            return AVERROR(ENOMEM);",
          "new_line_content": "            av_packet_unref(pkt);",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": "AVERROR",
          "new_api": "av_packet_unref",
          "old_text": "AVERROR(ENOMEM)",
          "new_text": "av_packet_unref(pkt)",
          "old_line_content": "            return AVERROR(ENOMEM);",
          "new_line_content": "            av_packet_unref(pkt);",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": "parse_webvtt",
          "new_api": "strcmp",
          "old_text": "parse_webvtt(&pkt, &parsed_pkt)",
          "new_text": "strcmp(priv->codec, \"webvtt-webm\")",
          "old_line_content": "        if (parse_webvtt(&pkt, &parsed_pkt) < 0) {",
          "new_line_content": "    if (strcmp(priv->codec, \"webvtt-webm\") == 0) {",
          "content_same": false
        },
        {
          "line": 245,
          "old_api": "MP_ERR",
          "new_api": "parse_webvtt",
          "old_text": "MP_ERR(priv, \"Error parsing subtitle\\n\")",
          "new_text": "parse_webvtt(&pkt, &parsed_pkt)",
          "old_line_content": "            MP_ERR(priv, \"Error parsing subtitle\\n\");",
          "new_line_content": "        if (parse_webvtt(&pkt, &parsed_pkt) < 0) {",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": "MP_TARRAY_APPEND",
          "new_api": "av_packet_unref",
          "old_text": "MP_TARRAY_APPEND(priv, priv->cur_list, num_cur, NULL)",
          "new_text": "av_packet_unref(&parsed_pkt)",
          "old_line_content": "    MP_TARRAY_APPEND(priv, priv->cur_list, num_cur, NULL);",
          "new_line_content": "    av_packet_unref(&parsed_pkt);",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": "avcodec_free_context",
          "new_api": "avsubtitle_free",
          "old_text": "avcodec_free_context(&priv->avctx)",
          "new_text": "avsubtitle_free(&priv->cur)",
          "old_line_content": "    avcodec_free_context(&priv->avctx);",
          "new_line_content": "    avsubtitle_free(&priv->cur);",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": "talloc_free",
          "new_api": "avcodec_free_context",
          "old_text": "talloc_free(priv)",
          "new_text": "avcodec_free_context(&priv->avctx)",
          "old_line_content": "    talloc_free(priv);",
          "new_line_content": "    avcodec_free_context(&priv->avctx);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 258,
          "old_api": null,
          "new_api": "MP_WARN",
          "old_text": null,
          "new_text": "MP_WARN(priv, \"Ignoring bitmap subtitle.\\n\")",
          "old_line_content": "            char *ass_line = priv->cur.rects[i]->ass;",
          "new_line_content": "                MP_WARN(priv, \"Ignoring bitmap subtitle.\\n\");",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": null,
          "new_api": "MP_TARRAY_APPEND",
          "old_text": null,
          "new_text": "MP_TARRAY_APPEND(priv, priv->cur_list, num_cur, ass_line)",
          "old_line_content": "        }",
          "new_line_content": "            MP_TARRAY_APPEND(priv, priv->cur_list, num_cur, ass_line);",
          "content_same": false
        },
        {
          "line": 268,
          "old_api": null,
          "new_api": "MP_TARRAY_APPEND",
          "old_text": null,
          "new_text": "MP_TARRAY_APPEND(priv, priv->cur_list, num_cur, NULL)",
          "old_line_content": "    return priv->cur_list;",
          "new_line_content": "    MP_TARRAY_APPEND(priv, priv->cur_list, num_cur, NULL);",
          "content_same": false
        },
        {
          "line": 274,
          "old_api": null,
          "new_api": "avcodec_flush_buffers",
          "old_text": null,
          "new_text": "avcodec_flush_buffers(priv->avctx)",
          "old_line_content": "}",
          "new_line_content": "    avcodec_flush_buffers(priv->avctx);",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(priv)",
          "old_line_content": "}",
          "new_line_content": "    talloc_free(priv);",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": null,
          "new_api": "av_new_packet",
          "old_text": null,
          "new_text": "av_new_packet(pkt, text_len)",
          "old_line_content": "    if (err < 0)",
          "new_line_content": "    err = av_new_packet(pkt, text_len);",
          "content_same": false
        },
        {
          "line": 60,
          "old_api": null,
          "new_api": "bstr0",
          "old_text": null,
          "new_text": "bstr0(\"\\nStyle: \")",
          "old_line_content": "    while (header.len) {",
          "new_line_content": "    bstr style = bstr0(\"\\nStyle: \");",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(err)",
          "old_line_content": "",
          "new_line_content": "        return AVERROR(err);",
          "content_same": false
        },
        {
          "line": 62,
          "old_api": null,
          "new_api": "bstr_find",
          "old_text": null,
          "new_text": "bstr_find(header, style)",
          "old_line_content": "        if (n < 0)",
          "new_line_content": "        int n = bstr_find(header, style);",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(pkt->data, text, text_len)",
          "old_line_content": "",
          "new_line_content": "    memcpy(pkt->data, text, text_len);",
          "content_same": false
        },
        {
          "line": 66,
          "old_api": null,
          "new_api": "bstr_cut",
          "old_text": null,
          "new_text": "bstr_cut(header, n + style.len)",
          "old_line_content": "    }",
          "new_line_content": "        header = bstr_cut(header, n + style.len);",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": null,
          "new_api": "av_packet_new_side_data",
          "old_text": null,
          "new_text": "av_packet_new_side_data(pkt,\n                                      AV_PKT_DATA_WEBVTT_IDENTIFIER,\n                                      id_len)",
          "old_line_content": "                                      AV_PKT_DATA_WEBVTT_IDENTIFIER,",
          "new_line_content": "        buf = av_packet_new_side_data(pkt,",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "        }",
          "new_line_content": "            return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 73,
          "old_api": null,
          "new_api": "talloc_zero",
          "old_text": null,
          "new_text": "talloc_zero(NULL, struct lavc_conv)",
          "old_line_content": "    priv->log = log;",
          "new_line_content": "    struct lavc_conv *priv = talloc_zero(NULL, struct lavc_conv);",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(buf, id, id_len)",
          "old_line_content": "    }",
          "new_line_content": "        memcpy(buf, id, id_len);",
          "content_same": false
        },
        {
          "line": 76,
          "old_api": null,
          "new_api": "talloc_strdup",
          "old_text": null,
          "new_text": "talloc_strdup(priv, codec_name)",
          "old_line_content": "    AVCodecContext *avctx = NULL;",
          "new_line_content": "    priv->codec = talloc_strdup(priv, codec_name);",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": null,
          "new_api": "av_packet_new_side_data",
          "old_text": null,
          "new_text": "av_packet_new_side_data(pkt,\n                                      AV_PKT_DATA_WEBVTT_SETTINGS,\n                                      settings_len)",
          "old_line_content": "                                      AV_PKT_DATA_WEBVTT_SETTINGS,",
          "new_line_content": "        buf = av_packet_new_side_data(pkt,",
          "content_same": false
        },
        {
          "line": 80,
          "old_api": null,
          "new_api": "mp_codec_to_av_codec_id",
          "old_text": null,
          "new_text": "mp_codec_to_av_codec_id(fmt)",
          "old_line_content": "    if (!codec)",
          "new_line_content": "    AVCodec *codec = avcodec_find_decoder(mp_codec_to_av_codec_id(fmt));",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": null,
          "new_api": "AVERROR",
          "old_text": null,
          "new_text": "AVERROR(ENOMEM)",
          "old_line_content": "        }",
          "new_line_content": "            return AVERROR(ENOMEM);",
          "content_same": false
        },
        {
          "line": 83,
          "old_api": null,
          "new_api": "avcodec_alloc_context3",
          "old_text": null,
          "new_text": "avcodec_alloc_context3(codec)",
          "old_line_content": "    if (!avctx)",
          "new_line_content": "    avctx = avcodec_alloc_context3(codec);",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(buf, settings, settings_len)",
          "old_line_content": "    }",
          "new_line_content": "        memcpy(buf, settings, settings_len);",
          "content_same": false
        },
        {
          "line": 86,
          "old_api": null,
          "new_api": "mp_lavc_set_extradata",
          "old_text": null,
          "new_text": "mp_lavc_set_extradata(avctx, extradata, extradata_len)",
          "old_line_content": "        goto error;",
          "new_line_content": "    if (mp_lavc_set_extradata(avctx, extradata, extradata_len) < 0)",
          "content_same": false
        },
        {
          "line": 90,
          "old_api": null,
          "new_api": "avcodec_open2",
          "old_text": null,
          "new_text": "avcodec_open2(avctx, codec, &opts)",
          "old_line_content": "        goto error;",
          "new_line_content": "    if (avcodec_open2(avctx, codec, &opts) < 0)",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": null,
          "new_api": "av_dict_free",
          "old_text": null,
          "new_text": "av_dict_free(&opts)",
          "old_line_content": "    // Documented as \"set by libavcodec\", but there is no other way",
          "new_line_content": "    av_dict_free(&opts);",
          "content_same": false
        },
        {
          "line": 99,
          "old_api": null,
          "new_api": "talloc_strndup",
          "old_text": null,
          "new_text": "talloc_strndup(priv, avctx->subtitle_header,\n                                     avctx->subtitle_header_size)",
          "old_line_content": "                                     avctx->subtitle_header_size);",
          "new_line_content": "    priv->extradata = talloc_strndup(priv, avctx->subtitle_header,",
          "content_same": false
        },
        {
          "line": 101,
          "old_api": null,
          "new_api": "bstr0",
          "old_text": null,
          "new_text": "bstr0(priv->extradata)",
          "old_line_content": "    return priv;",
          "new_line_content": "    disable_styles(bstr0(priv->extradata));",
          "content_same": false
        },
        {
          "line": 108,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(priv)",
          "old_line_content": "    return NULL;",
          "new_line_content": "    talloc_free(priv);",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": null,
          "new_api": "avsubtitle_free",
          "old_text": null,
          "new_text": "avsubtitle_free(&priv->cur)",
          "old_line_content": "",
          "new_line_content": "    avsubtitle_free(&priv->cur);",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": null,
          "new_api": "mp_set_av_packet",
          "old_text": null,
          "new_text": "mp_set_av_packet(&pkt, packet, &avctx->time_base)",
          "old_line_content": "    if (pkt.pts < 0)",
          "new_line_content": "    mp_set_av_packet(&pkt, packet, &avctx->time_base);",
          "content_same": false
        },
        {
          "line": 246,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(priv, \"Error parsing subtitle\\n\")",
          "old_line_content": "            goto done;",
          "new_line_content": "            MP_ERR(priv, \"Error parsing subtitle\\n\");",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": null,
          "new_api": "avcodec_decode_subtitle2",
          "old_text": null,
          "new_text": "avcodec_decode_subtitle2(avctx, &priv->cur, &got_sub, &pkt)",
          "old_line_content": "    if (ret < 0) {",
          "new_line_content": "    ret = avcodec_decode_subtitle2(avctx, &priv->cur, &got_sub, &pkt);",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(priv, \"Error decoding subtitle\\n\")",
          "old_line_content": "    } else if (got_sub) {",
          "new_line_content": "        MP_ERR(priv, \"Error decoding subtitle\\n\");",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 257,
          "old_api": "MP_WARN",
          "new_api": null,
          "old_text": "MP_WARN(priv, \"Ignoring bitmap subtitle.\\n\")",
          "new_text": null,
          "old_line_content": "                MP_WARN(priv, \"Ignoring bitmap subtitle.\\n\");",
          "new_line_content": "            if (priv->cur.rects[i]->w > 0 && priv->cur.rects[i]->h > 0)",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": "MP_TARRAY_APPEND",
          "new_api": null,
          "old_text": "MP_TARRAY_APPEND(priv, priv->cur_list, num_cur, ass_line)",
          "new_text": null,
          "old_line_content": "            MP_TARRAY_APPEND(priv, priv->cur_list, num_cur, ass_line);",
          "new_line_content": "                continue;",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": "av_packet_unref",
          "new_api": null,
          "old_text": "av_packet_unref(&parsed_pkt)",
          "new_text": null,
          "old_line_content": "    av_packet_unref(&parsed_pkt);",
          "new_line_content": "done:",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": "avcodec_flush_buffers",
          "new_api": null,
          "old_text": "avcodec_flush_buffers(priv->avctx)",
          "new_text": null,
          "old_line_content": "    avcodec_flush_buffers(priv->avctx);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 278,
          "old_api": "avsubtitle_free",
          "new_api": null,
          "old_text": "avsubtitle_free(&priv->cur)",
          "new_text": null,
          "old_line_content": "    avsubtitle_free(&priv->cur);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": "av_new_packet",
          "new_api": null,
          "old_text": "av_new_packet(pkt, text_len)",
          "new_text": null,
          "old_line_content": "    err = av_new_packet(pkt, text_len);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "AVERROR",
          "new_api": null,
          "old_text": "AVERROR(err)",
          "new_text": null,
          "old_line_content": "        return AVERROR(err);",
          "new_line_content": "    if (err < 0)",
          "content_same": false
        },
        {
          "line": 61,
          "old_api": "bstr0",
          "new_api": null,
          "old_text": "bstr0(\"\\nStyle: \")",
          "new_text": null,
          "old_line_content": "        int n = bstr_find(header, bstr0(\"\\nStyle: \"));",
          "new_line_content": "    while (header.len) {",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(pkt->data, text, text_len)",
          "new_text": null,
          "old_line_content": "    memcpy(pkt->data, text, text_len);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 65,
          "old_api": "bstr_cut",
          "new_api": null,
          "old_text": "bstr_cut(header, 2)",
          "new_text": null,
          "old_line_content": "        header = bstr_cut(header, 2);",
          "new_line_content": "        header.start[n + 1] = '#'; // turn into a comment",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": "av_packet_new_side_data",
          "new_api": null,
          "old_text": "av_packet_new_side_data(pkt,\n                                      AV_PKT_DATA_WEBVTT_IDENTIFIER,\n                                      id_len)",
          "new_text": null,
          "old_line_content": "        buf = av_packet_new_side_data(pkt,",
          "new_line_content": "    if (id_len > 0) {",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": "av_packet_unref",
          "new_api": null,
          "old_text": "av_packet_unref(pkt)",
          "new_text": null,
          "old_line_content": "            av_packet_unref(pkt);",
          "new_line_content": "        if (buf == NULL) {",
          "content_same": false
        },
        {
          "line": 72,
          "old_api": "talloc_zero",
          "new_api": null,
          "old_text": "talloc_zero(NULL, struct lavc_conv)",
          "new_text": null,
          "old_line_content": "    struct lavc_conv *priv = talloc_zero(NULL, struct lavc_conv);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(buf, id, id_len)",
          "new_text": null,
          "old_line_content": "        memcpy(buf, id, id_len);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 74,
          "old_api": "talloc_array",
          "new_api": null,
          "old_text": "talloc_array(priv, char*, 0)",
          "new_text": null,
          "old_line_content": "    priv->cur_list = talloc_array(priv, char*, 0);",
          "new_line_content": "    priv->log = log;",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": "av_packet_new_side_data",
          "new_api": null,
          "old_text": "av_packet_new_side_data(pkt,\n                                      AV_PKT_DATA_WEBVTT_SETTINGS,\n                                      settings_len)",
          "new_text": null,
          "old_line_content": "        buf = av_packet_new_side_data(pkt,",
          "new_line_content": "    if (settings_len > 0) {",
          "content_same": false
        },
        {
          "line": 78,
          "old_api": "get_lavc_format",
          "new_api": null,
          "old_text": "get_lavc_format(priv->codec)",
          "new_text": null,
          "old_line_content": "    const char *fmt = get_lavc_format(priv->codec);",
          "new_line_content": "    AVDictionary *opts = NULL;",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": "av_packet_unref",
          "new_api": null,
          "old_text": "av_packet_unref(pkt)",
          "new_text": null,
          "old_line_content": "            av_packet_unref(pkt);",
          "new_line_content": "        if (buf == NULL) {",
          "content_same": false
        },
        {
          "line": 82,
          "old_api": "avcodec_alloc_context3",
          "new_api": null,
          "old_text": "avcodec_alloc_context3(codec)",
          "new_text": null,
          "old_line_content": "    avctx = avcodec_alloc_context3(codec);",
          "new_line_content": "        goto error;",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(buf, settings, settings_len)",
          "new_text": null,
          "old_line_content": "        memcpy(buf, settings, settings_len);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 85,
          "old_api": "mp_lavc_set_extradata",
          "new_api": null,
          "old_text": "mp_lavc_set_extradata(avctx, extradata, extradata_len)",
          "new_text": null,
          "old_line_content": "    if (mp_lavc_set_extradata(avctx, extradata, extradata_len) < 0)",
          "new_line_content": "        goto error;",
          "content_same": false
        },
        {
          "line": 87,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(codec_name, \"eia_608\")",
          "new_text": null,
          "old_line_content": "    if (strcmp(codec_name, \"eia_608\") == 0)",
          "new_line_content": "        goto error;",
          "content_same": false
        },
        {
          "line": 91,
          "old_api": "av_dict_free",
          "new_api": null,
          "old_text": "av_dict_free(&opts)",
          "new_text": null,
          "old_line_content": "    av_dict_free(&opts);",
          "new_line_content": "        goto error;",
          "content_same": false
        },
        {
          "line": 98,
          "old_api": "talloc_strndup",
          "new_api": null,
          "old_text": "talloc_strndup(priv, avctx->subtitle_header,\n                                     avctx->subtitle_header_size)",
          "new_text": null,
          "old_line_content": "    priv->extradata = talloc_strndup(priv, avctx->subtitle_header,",
          "new_line_content": "    priv->avctx = avctx;",
          "content_same": false
        },
        {
          "line": 100,
          "old_api": "bstr0",
          "new_api": null,
          "old_text": "bstr0(priv->extradata)",
          "new_text": null,
          "old_line_content": "    disable_styles(bstr0(priv->extradata));",
          "new_line_content": "                                     avctx->subtitle_header_size);",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": "MP_FATAL",
          "new_api": null,
          "old_text": "MP_FATAL(priv, \"Could not open libavcodec subtitle converter\\n\")",
          "new_text": null,
          "old_line_content": "    MP_FATAL(priv, \"Could not open libavcodec subtitle converter\\n\");",
          "new_line_content": " error:",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": "avsubtitle_free",
          "new_api": null,
          "old_text": "avsubtitle_free(&priv->cur)",
          "new_text": null,
          "old_line_content": "    avsubtitle_free(&priv->cur);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": "mp_set_av_packet",
          "new_api": null,
          "old_text": "mp_set_av_packet(&pkt, packet, &avctx->time_base)",
          "new_text": null,
          "old_line_content": "    mp_set_av_packet(&pkt, packet, &avctx->time_base);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(priv->codec, \"webvtt-webm\")",
          "new_text": null,
          "old_line_content": "    if (strcmp(priv->codec, \"webvtt-webm\") == 0) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 251,
          "old_api": "avcodec_decode_subtitle2",
          "new_api": null,
          "old_text": "avcodec_decode_subtitle2(avctx, &priv->cur, &got_sub, &pkt)",
          "new_text": null,
          "old_line_content": "    ret = avcodec_decode_subtitle2(avctx, &priv->cur, &got_sub, &pkt);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": "MP_ERR",
          "new_api": null,
          "old_text": "MP_ERR(priv, \"Error decoding subtitle\\n\")",
          "new_text": null,
          "old_line_content": "        MP_ERR(priv, \"Error decoding subtitle\\n\");",
          "new_line_content": "    if (ret < 0) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 14,
      "total_additions": 32,
      "total_deletions": 31,
      "total_api_changes": 77
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 77,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 50,
    "api_calls_after": 50,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 2,
      "total_diff_lines": 21
    }
  }
}