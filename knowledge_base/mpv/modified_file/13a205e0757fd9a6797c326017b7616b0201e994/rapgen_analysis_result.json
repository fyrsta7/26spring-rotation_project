{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/13a205e0757fd9a6797c326017b7616b0201e994",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/13a205e0757fd9a6797c326017b7616b0201e994/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/13a205e0757fd9a6797c326017b7616b0201e994/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/13a205e0757fd9a6797c326017b7616b0201e994/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 230,
          "old_api": "af_msg",
          "new_api": "realloc",
          "old_text": "af_msg(AF_MSG_VERBOSE, \"[libaf] Reallocating memory in module %s, \"\n          \"old len = %i, new len = %i\\n\",af->info->name,af->data->len,max_bytes_out)",
          "new_text": "realloc(af->data->audio, max_bytes_out)",
          "old_line_content": "    af_msg(AF_MSG_VERBOSE, \"[libaf] Reallocating memory in module %s, \"",
          "new_line_content": "    af->data->audio = realloc(af->data->audio, max_bytes_out);",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "realloc",
          "new_api": "af_msg",
          "old_text": "realloc(af->data->audio, max_bytes_out)",
          "new_text": "af_msg(AF_MSG_FATAL, \"[libaf] Could not allocate memory\\n\")",
          "old_line_content": "    af->data->audio = realloc(af->data->audio, max_bytes_out);",
          "new_line_content": "      af_msg(AF_MSG_FATAL, \"[libaf] Could not allocate memory\\n\");",
          "content_same": false
        },
        {
          "line": 251,
          "old_api": "output_overlap",
          "new_api": "memcpy",
          "old_text": "s->output_overlap(s, pout, bytes_off)",
          "new_text": "memcpy(pout + s->bytes_overlap,\n           s->buf_queue + bytes_off + s->bytes_overlap,\n           s->bytes_standing)",
          "old_line_content": "      s->output_overlap(s, pout, bytes_off);",
          "new_line_content": "    memcpy(pout + s->bytes_overlap,",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": "realloc",
          "new_api": "af_msg",
          "old_text": "realloc(s->table_blend, s->bytes_overlap * 4)",
          "new_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "old_line_content": "      s->table_blend      = realloc(s->table_blend, s->bytes_overlap * 4);",
          "new_line_content": "        af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": "realloc",
          "new_api": "af_msg",
          "old_text": "realloc(s->table_window, s->bytes_overlap * 2 - nch * bps * 2)",
          "new_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "old_line_content": "        s->table_window = realloc(s->table_window, s->bytes_overlap * 2 - nch * bps * 2);",
          "new_line_content": "          af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": "realloc",
          "new_api": "af_msg",
          "old_text": "realloc(s->table_window, s->bytes_overlap - nch * bps)",
          "new_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "old_line_content": "        s->table_window = realloc(s->table_window, s->bytes_overlap - nch * bps);",
          "new_line_content": "          af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "content_same": false
        },
        {
          "line": 411,
          "old_api": "realloc",
          "new_api": "af_msg",
          "old_text": "realloc(s->buf_queue, s->bytes_queue)",
          "new_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "old_line_content": "    s->buf_queue = realloc(s->buf_queue, s->bytes_queue);",
          "new_line_content": "      af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 257,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(s->buf_overlap,\n           s->buf_queue + bytes_off + s->bytes_stride,\n           s->bytes_overlap)",
          "old_line_content": "",
          "new_line_content": "    memcpy(s->buf_overlap,",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": null,
          "new_api": "realloc",
          "old_text": null,
          "new_text": "realloc(s->buf_pre_corr, s->bytes_overlap)",
          "old_line_content": "      } else {",
          "new_line_content": "        s->buf_pre_corr = realloc(s->buf_pre_corr, s->bytes_overlap);",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": null,
          "new_api": "realloc",
          "old_text": null,
          "new_text": "realloc(s->table_window, s->bytes_overlap - nch * bps)",
          "old_line_content": "        float* pw;",
          "new_line_content": "        s->table_window = realloc(s->table_window, s->bytes_overlap - nch * bps);",
          "content_same": false
        },
        {
          "line": 265,
          "old_api": null,
          "new_api": "fill_queue",
          "old_text": null,
          "new_text": "fill_queue(af, data, offset_in)",
          "old_line_content": "    s->bytes_to_slide = ti * s->bytes_per_frame;",
          "new_line_content": "    offset_in += fill_queue(af, data, offset_in);",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(af->data->audio)",
          "old_line_content": "{",
          "new_line_content": "  free(af->data->audio);",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(af->data)",
          "old_line_content": "  af_scaletempo_t* s = af->setup;",
          "new_line_content": "  free(af->data);",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": null,
          "new_api": "realloc",
          "old_text": null,
          "new_text": "realloc(s->buf_queue, s->bytes_queue)",
          "old_line_content": "    s->bytes_queue",
          "new_line_content": "    s->buf_queue = realloc(s->buf_queue, s->bytes_queue);",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": null,
          "new_api": "calloc",
          "old_text": null,
          "new_text": "calloc(1,sizeof(af_data_t))",
          "old_line_content": "  af->play      = play;",
          "new_line_content": "  af->data      = calloc(1,sizeof(af_data_t));",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": null,
          "new_api": "calloc",
          "old_text": null,
          "new_text": "calloc(1,sizeof(af_scaletempo_t))",
          "old_line_content": "  af->mul       = 1;",
          "new_line_content": "  af->setup     = calloc(1,sizeof(af_scaletempo_t));",
          "content_same": false
        },
        {
          "line": 415,
          "old_api": null,
          "new_api": "af_msg (AF_MSG_DEBUG0, \"[scaletempo] \"\n            \"%.2f stride_in, %i stride_out, %i standing, \"\n            \"%i overlap, %i search, %i queue, %s mode\\n\",\n            s->frames_stride_scaled,\n            (int)(s->bytes_stride / nch / bps),\n            (int)(s->bytes_standing / nch / bps),\n            (int)(s->bytes_overlap / nch / bps),\n            s->frames_search,\n            (int)(s->bytes_queue / nch / bps),\n            (use_int?\"s16\":\"float\"))",
          "old_text": null,
          "new_text": "af_msg (AF_MSG_DEBUG0, \"[scaletempo] \"\n            \"%.2f stride_in, %i stride_out, %i standing, \"\n            \"%i overlap, %i search, %i queue, %s mode\\n\",\n            s->frames_stride_scaled,\n            (int)(s->bytes_stride / nch / bps),\n            (int)(s->bytes_standing / nch / bps),\n            (int)(s->bytes_overlap / nch / bps),\n            s->frames_search,\n            (int)(s->bytes_queue / nch / bps),\n            (use_int?\"s16\":\"float\"))",
          "old_line_content": "    }",
          "new_line_content": "    af_msg (AF_MSG_DEBUG0, \"[scaletempo] \"",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_VERBOSE,\n           \"[scaletempo] %.3f speed * %.3f scale_nominal = %.3f\\n\",\n           s->speed, s->scale_nominal, s->scale)",
          "old_line_content": "    int i, j;",
          "new_line_content": "    af_msg(AF_MSG_VERBOSE,",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": null,
          "new_api": "af_test_output",
          "old_text": null,
          "new_text": "af_test_output(af, (af_data_t*)arg)",
          "old_line_content": "            (use_int?\"s16\":\"float\"));",
          "new_line_content": "    return af_test_output(af, (af_data_t*)arg);",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(af->data, data, sizeof(af_data_t))",
          "old_line_content": "      if (s->speed_tempo && s->speed_pitch)",
          "new_line_content": "      memcpy(af->data, data, sizeof(af_data_t));",
          "content_same": false
        },
        {
          "line": 300,
          "old_api": null,
          "new_api": "af_test_output",
          "old_text": null,
          "new_text": "af_test_output(af, data)",
          "old_line_content": "        return AF_DETACH;",
          "new_line_content": "      return af_test_output(af, data);",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": null,
          "new_api": "realloc",
          "old_text": null,
          "new_text": "realloc(s->buf_overlap, s->bytes_overlap)",
          "old_line_content": "      s->bytes_standing   = s->bytes_stride - s->bytes_overlap;",
          "new_line_content": "      s->buf_overlap      = realloc(s->buf_overlap, s->bytes_overlap);",
          "content_same": false
        },
        {
          "line": 333,
          "old_api": null,
          "new_api": "realloc",
          "old_text": null,
          "new_text": "realloc(s->table_blend, s->bytes_overlap * 4)",
          "old_line_content": "      s->samples_standing = s->bytes_standing / bps;",
          "new_line_content": "      s->table_blend      = realloc(s->table_blend, s->bytes_overlap * 4);",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": null,
          "new_api": "subopt_parse",
          "old_text": null,
          "new_text": "subopt_parse(arg, subopts)",
          "old_line_content": "      {NULL},",
          "new_line_content": "    if (subopt_parse(arg, subopts) != 0) {",
          "content_same": false
        },
        {
          "line": 338,
          "old_api": null,
          "new_api": "bzero",
          "old_text": null,
          "new_text": "bzero(s->buf_overlap, s->bytes_overlap)",
          "old_line_content": "        return AF_ERROR;",
          "new_line_content": "      bzero(s->buf_overlap, s->bytes_overlap);",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": scale > 0\\n\")",
          "old_line_content": "    }",
          "new_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": stride > 0\\n\")",
          "old_line_content": "    }",
          "new_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": 0 <= overlap <= 1\\n\")",
          "old_line_content": "    }",
          "new_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "content_same": false
        },
        {
          "line": 228,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_VERBOSE, \"[libaf] Reallocating memory in module %s, \"\n          \"old len = %i, new len = %i\\n\",af->info->name,af->data->len,max_bytes_out)",
          "old_line_content": "  max_bytes_out = ((int)(data->len / s->bytes_stride_scaled) + 1) * s->bytes_stride;",
          "new_line_content": "    af_msg(AF_MSG_VERBOSE, \"[libaf] Reallocating memory in module %s, \"",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": search >= 0\\n\")",
          "old_line_content": "    }",
          "new_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(speed.str, \"pitch\")",
          "old_line_content": "    }",
          "new_line_content": "      if (strcmp(speed.str, \"pitch\") == 0) {",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(speed.str, \"tempo\")",
          "old_line_content": "        s->speed_tempo = 0;",
          "new_line_content": "      } else if (strcmp(speed.str, \"tempo\") == 0) {",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": null,
          "new_api": "fill_queue",
          "old_text": null,
          "new_text": "fill_queue(af, data, 0)",
          "old_line_content": "  }",
          "new_line_content": "  offset_in = fill_queue(af, data, 0);",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(speed.str, \"none\")",
          "old_line_content": "        s->speed_tempo = 1;",
          "new_line_content": "      } else if (strcmp(speed.str, \"none\") == 0) {",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": null,
          "new_api": "realloc",
          "old_text": null,
          "new_text": "realloc(s->buf_pre_corr, s->bytes_overlap * 2)",
          "old_line_content": "        int32_t n = 8589934588LL / (t * t);  // 4 * (2^31 - 1) / t^2",
          "new_line_content": "        s->buf_pre_corr = realloc(s->buf_pre_corr, s->bytes_overlap * 2);",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": null,
          "new_api": "realloc",
          "old_text": null,
          "new_text": "realloc(s->table_window, s->bytes_overlap * 2 - nch * bps * 2)",
          "old_line_content": "        int32_t* pw;",
          "new_line_content": "        s->table_window = realloc(s->table_window, s->bytes_overlap * 2 - nch * bps * 2);",
          "content_same": false
        },
        {
          "line": 499,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(speed.str, \"both\")",
          "old_line_content": "        s->speed_tempo = 0;",
          "new_line_content": "      } else if (strcmp(speed.str, \"both\") == 0) {",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n               MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n               \": speed=[pitch|tempo|none|both]\\n\")",
          "old_line_content": "        s->speed_pitch = 1;",
          "new_line_content": "        af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": null,
          "new_api": "best_overlap_offset",
          "old_text": null,
          "new_text": "s->best_overlap_offset(s)",
          "old_line_content": "    if (s->output_overlap) {",
          "new_line_content": "        bytes_off = s->best_overlap_offset(s);",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": null,
          "new_api": "output_overlap",
          "old_text": null,
          "new_text": "s->output_overlap(s, pout, bytes_off)",
          "old_line_content": "      if (s->best_overlap_offset)",
          "new_line_content": "      s->output_overlap(s, pout, bytes_off);",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_DEBUG0, \"[scaletempo] %6.3f scale, %6.2f stride, %6.2f overlap, %6.2f search, speed = %s\\n\", s->scale_nominal, s->ms_stride, s->percent_overlap, s->ms_search, (s->speed_tempo?(s->speed_pitch?\"tempo and speed\":\"tempo\"):(s->speed_pitch?\"pitch\":\"none\")))",
          "old_line_content": "    }",
          "new_line_content": "    af_msg(AF_MSG_DEBUG0, \"[scaletempo] %6.3f scale, %6.2f stride, %6.2f overlap, %6.2f search, speed = %s\\n\", s->scale_nominal, s->ms_stride, s->percent_overlap, s->ms_search, (s->speed_tempo?(s->speed_pitch?\"tempo and speed\":\"tempo\"):(s->speed_pitch?\"pitch\":\"none\")));",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": null,
          "new_api": "av_log2",
          "old_text": null,
          "new_text": "av_log2( 2*(s->samples_overlap - nch) - 1 )",
          "old_line_content": "          }",
          "new_line_content": "        s->shift_corr = av_log2( 2*(s->samples_overlap - nch) - 1 );",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 512,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_DEBUG0, \"[scaletempo] %6.3f scale, %6.2f stride, %6.2f overlap, %6.2f search, speed = %s\\n\", s->scale_nominal, s->ms_stride, s->percent_overlap, s->ms_search, (s->speed_tempo?(s->speed_pitch?\"tempo and speed\":\"tempo\"):(s->speed_pitch?\"pitch\":\"none\")))",
          "new_text": null,
          "old_line_content": "    af_msg(AF_MSG_DEBUG0, \"[scaletempo] %6.3f scale, %6.2f stride, %6.2f overlap, %6.2f search, speed = %s\\n\", s->scale_nominal, s->ms_stride, s->percent_overlap, s->ms_search, (s->speed_tempo?(s->speed_pitch?\"tempo and speed\":\"tempo\"):(s->speed_pitch?\"pitch\":\"none\")));",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": "av_log2",
          "new_api": null,
          "old_text": "av_log2( 2*(s->samples_overlap - nch) - 1 )",
          "new_text": null,
          "old_line_content": "        s->shift_corr = av_log2( 2*(s->samples_overlap - nch) - 1 );",
          "new_line_content": "      } else {",
          "content_same": false
        },
        {
          "line": 259,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(s->buf_overlap,\n           s->buf_queue + bytes_off + s->bytes_stride,\n           s->bytes_overlap)",
          "new_text": null,
          "old_line_content": "    memcpy(s->buf_overlap,",
          "new_line_content": "           s->bytes_overlap);",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": "realloc",
          "new_api": null,
          "old_text": "realloc(s->buf_pre_corr, s->bytes_overlap)",
          "new_text": null,
          "old_line_content": "        s->buf_pre_corr = realloc(s->buf_pre_corr, s->bytes_overlap);",
          "new_line_content": "        if(!s->buf_pre_corr || !s->table_window) {",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "new_text": null,
          "old_line_content": "          af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": "fill_queue",
          "new_api": null,
          "old_text": "fill_queue(af, data, offset_in)",
          "new_text": null,
          "old_line_content": "    offset_in += fill_queue(af, data, offset_in);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 529,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(s->table_window)",
          "new_text": null,
          "old_line_content": "  free(s->table_window);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 530,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(af->setup)",
          "new_text": null,
          "old_line_content": "  free(af->setup);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": "calloc",
          "new_api": null,
          "old_text": "calloc(1,sizeof(af_data_t))",
          "new_text": null,
          "old_line_content": "  af->data      = calloc(1,sizeof(af_data_t));",
          "new_line_content": "  if(af->data == NULL || af->setup == NULL)",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "new_text": null,
          "old_line_content": "      af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": "calloc",
          "new_api": null,
          "old_text": "calloc(1,sizeof(af_scaletempo_t))",
          "new_text": null,
          "old_line_content": "  af->setup     = calloc(1,sizeof(af_scaletempo_t));",
          "new_line_content": "    return AF_ERROR;",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": "af_msg (AF_MSG_DEBUG0, \"[scaletempo] \"\n            \"%.2f stride_in, %i stride_out, %i standing, \"\n            \"%i overlap, %i search, %i queue, %s mode\\n\",\n            s->frames_stride_scaled,\n            (int)(s->bytes_stride / nch / bps),\n            (int)(s->bytes_standing / nch / bps),\n            (int)(s->bytes_overlap / nch / bps),\n            s->frames_search,\n            (int)(s->bytes_queue / nch / bps),\n            (use_int?\"s16\":\"float\"))",
          "new_api": null,
          "old_text": "af_msg (AF_MSG_DEBUG0, \"[scaletempo] \"\n            \"%.2f stride_in, %i stride_out, %i standing, \"\n            \"%i overlap, %i search, %i queue, %s mode\\n\",\n            s->frames_stride_scaled,\n            (int)(s->bytes_stride / nch / bps),\n            (int)(s->bytes_standing / nch / bps),\n            (int)(s->bytes_overlap / nch / bps),\n            s->frames_search,\n            (int)(s->bytes_queue / nch / bps),\n            (use_int?\"s16\":\"float\"))",
          "new_text": null,
          "old_line_content": "    af_msg (AF_MSG_DEBUG0, \"[scaletempo] \"",
          "new_line_content": "            \"%i overlap, %i search, %i queue, %s mode\\n\",",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_VERBOSE,\n           \"[scaletempo] %.3f speed * %.3f scale_nominal = %.3f\\n\",\n           s->speed, s->scale_nominal, s->scale)",
          "new_text": null,
          "old_line_content": "    af_msg(AF_MSG_VERBOSE,",
          "new_line_content": "           s->speed, s->scale_nominal, s->scale);",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": "af_test_output",
          "new_api": null,
          "old_text": "af_test_output(af, (af_data_t*)arg)",
          "new_text": null,
          "old_line_content": "    return af_test_output(af, (af_data_t*)arg);",
          "new_line_content": "  case AF_CONTROL_PLAYBACK_SPEED | AF_CONTROL_SET:{",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(af->data, data, sizeof(af_data_t))",
          "new_text": null,
          "old_line_content": "      memcpy(af->data, data, sizeof(af_data_t));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": "af_test_output",
          "new_api": null,
          "old_text": "af_test_output(af, data)",
          "new_text": null,
          "old_line_content": "      return af_test_output(af, data);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": "realloc",
          "new_api": null,
          "old_text": "realloc(s->buf_overlap, s->bytes_overlap)",
          "new_text": null,
          "old_line_content": "      s->buf_overlap      = realloc(s->buf_overlap, s->bytes_overlap);",
          "new_line_content": "      if(!s->buf_overlap || !s->table_blend) {",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": "subopt_parse",
          "new_api": null,
          "old_text": "subopt_parse(arg, subopts)",
          "new_text": null,
          "old_line_content": "    if (subopt_parse(arg, subopts) != 0) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "new_text": null,
          "old_line_content": "        af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": "bzero",
          "new_api": null,
          "old_text": "bzero(s->buf_overlap, s->bytes_overlap)",
          "new_text": null,
          "old_line_content": "      bzero(s->buf_overlap, s->bytes_overlap);",
          "new_line_content": "        int32_t* pb = s->table_blend;",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": scale > 0\\n\")",
          "new_text": null,
          "old_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "new_line_content": "             \": scale > 0\\n\");",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": stride > 0\\n\")",
          "new_text": null,
          "old_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "new_line_content": "             \": stride > 0\\n\");",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": 0 <= overlap <= 1\\n\")",
          "new_text": null,
          "old_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "new_line_content": "             \": 0 <= overlap <= 1\\n\");",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": search >= 0\\n\")",
          "new_text": null,
          "old_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "new_line_content": "             \": search >= 0\\n\");",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_FATAL, \"[libaf] Could not allocate memory\\n\")",
          "new_text": null,
          "old_line_content": "      af_msg(AF_MSG_FATAL, \"[libaf] Could not allocate memory\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(speed.str, \"pitch\")",
          "new_text": null,
          "old_line_content": "      if (strcmp(speed.str, \"pitch\") == 0) {",
          "new_line_content": "        s->speed_pitch = 1;",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(speed.str, \"tempo\")",
          "new_text": null,
          "old_line_content": "      } else if (strcmp(speed.str, \"tempo\") == 0) {",
          "new_line_content": "        s->speed_pitch = 0;",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": "fill_queue",
          "new_api": null,
          "old_text": "fill_queue(af, data, 0)",
          "new_text": null,
          "old_line_content": "  offset_in = fill_queue(af, data, 0);",
          "new_line_content": "  while (s->bytes_queued >= s->bytes_queue) {",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(speed.str, \"none\")",
          "new_text": null,
          "old_line_content": "      } else if (strcmp(speed.str, \"none\") == 0) {",
          "new_line_content": "        s->speed_pitch = 0;",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": "realloc",
          "new_api": null,
          "old_text": "realloc(s->buf_pre_corr, s->bytes_overlap * 2)",
          "new_text": null,
          "old_line_content": "        s->buf_pre_corr = realloc(s->buf_pre_corr, s->bytes_overlap * 2);",
          "new_line_content": "        if(!s->buf_pre_corr || !s->table_window) {",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(speed.str, \"both\")",
          "new_text": null,
          "old_line_content": "      } else if (strcmp(speed.str, \"both\") == 0) {",
          "new_line_content": "        s->speed_pitch = 1;",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "new_text": null,
          "old_line_content": "          af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 505,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n               MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n               \": speed=[pitch|tempo|none|both]\\n\")",
          "new_text": null,
          "old_line_content": "        af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "new_line_content": "               \": speed=[pitch|tempo|none|both]\\n\");",
          "content_same": false
        },
        {
          "line": 250,
          "old_api": "best_overlap_offset",
          "new_api": null,
          "old_text": "s->best_overlap_offset(s)",
          "new_text": null,
          "old_line_content": "        bytes_off = s->best_overlap_offset(s);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(pout + s->bytes_overlap,\n           s->buf_queue + bytes_off + s->bytes_overlap,\n           s->bytes_standing)",
          "new_text": null,
          "old_line_content": "    memcpy(pout + s->bytes_overlap,",
          "new_line_content": "           s->bytes_standing);",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 7,
      "total_additions": 35,
      "total_deletions": 35,
      "total_api_changes": 77
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 77,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          174,
          175
        ]
      }
    },
    "api_calls_before": 52,
    "api_calls_after": 52,
    "diff_info": {
      "added_lines": 0,
      "removed_lines": 2,
      "total_diff_lines": 14
    }
  }
}