{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/6cecbf38c110bd3fb83ed06523d5045fa1481139",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/6cecbf38c110bd3fb83ed06523d5045fa1481139/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/6cecbf38c110bd3fb83ed06523d5045fa1481139/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/6cecbf38c110bd3fb83ed06523d5045fa1481139/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 157,
          "old_api": "register",
          "new_api": "clamp",
          "old_text": "register",
          "new_text": "clamp(x,SHRT_MIN,SHRT_MAX)",
          "old_line_content": "\t  register int x = (a[i] * vol) >> 8;",
          "new_line_content": "\t  a[i]=clamp(x,SHRT_MIN,SHRT_MAX);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 171,
          "old_api": null,
          "new_api": "register",
          "old_text": null,
          "new_text": "register",
          "old_line_content": "\tfor(i=ch;i<len;i+=nch){",
          "new_line_content": "\t  register float x \t= a[i];",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": null,
          "new_api": "calloc",
          "old_text": null,
          "new_text": "calloc(1,sizeof(af_data_t))",
          "old_line_content": "  af->mul=1;",
          "new_line_content": "  af->data=calloc(1,sizeof(af_data_t));",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": null,
          "new_api": "register",
          "old_text": null,
          "new_text": "register",
          "old_line_content": "  int           ch  = 0;\t\t\t// Channel counter",
          "new_line_content": "  register int\tnch = c->nch;\t\t\t// Number of channels",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": null,
          "new_api": "af_softclip",
          "old_text": null,
          "new_text": "af_softclip(x)",
          "old_line_content": "\t  if(s->soft)",
          "new_line_content": "\t    x=af_softclip(x);",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": null,
          "new_api": "register",
          "old_text": null,
          "new_text": "register",
          "old_line_content": "\tfor(i=ch;i<len;i+=nch){",
          "new_line_content": "\t  register int x = (a[i] * vol) >> 8;",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": null,
          "new_api": "clamp",
          "old_text": null,
          "new_text": "clamp(x,-1.0,1.0)",
          "old_line_content": "\t  else",
          "new_line_content": "\t    x=clamp(x,-1.0,1.0);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 173,
          "old_api": "register",
          "new_api": null,
          "old_text": "register",
          "new_text": null,
          "old_line_content": "\t  register float pow \t= x*x;",
          "new_line_content": "\t  // Check maximum power value",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": "calloc",
          "new_api": null,
          "old_text": "calloc(1,sizeof(af_volume_t))",
          "new_text": null,
          "old_line_content": "  af->setup=calloc(1,sizeof(af_volume_t));",
          "new_line_content": "  if(af->data == NULL || af->setup == NULL)",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "register",
          "new_api": null,
          "old_text": "register",
          "new_text": null,
          "old_line_content": "  register int  i   = 0;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": "register",
          "new_api": null,
          "old_text": "register",
          "new_text": null,
          "old_line_content": "\tregister int vol = (int)(255.0 * s->level[ch]);",
          "new_line_content": "\tfor(i=ch;i<len;i+=nch){",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "af_softclip",
          "new_api": null,
          "old_text": "af_softclip(x)",
          "new_text": null,
          "old_line_content": "\t    x=af_softclip(x);",
          "new_line_content": "\t  // Hard clipping",
          "content_same": false
        },
        {
          "line": 158,
          "old_api": "clamp",
          "new_api": null,
          "old_text": "clamp(x,SHRT_MIN,SHRT_MAX)",
          "new_text": null,
          "old_line_content": "\t  a[i]=clamp(x,SHRT_MIN,SHRT_MAX);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "clamp",
          "new_api": null,
          "old_text": "clamp(x,-1.0,1.0)",
          "new_text": null,
          "old_line_content": "\t    x=clamp(x,-1.0,1.0);",
          "new_line_content": "\t  a[i] = x;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 1,
      "total_additions": 6,
      "total_deletions": 7,
      "total_api_changes": 14
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 14,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          166,
          167,
          152,
          153,
          154
        ]
      }
    },
    "api_calls_before": 28,
    "api_calls_after": 27,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 5,
      "total_diff_lines": 35
    }
  }
}