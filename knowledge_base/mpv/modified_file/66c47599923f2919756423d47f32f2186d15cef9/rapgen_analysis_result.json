{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/66c47599923f2919756423d47f32f2186d15cef9",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/66c47599923f2919756423d47f32f2186d15cef9/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/66c47599923f2919756423d47f32f2186d15cef9/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/66c47599923f2919756423d47f32f2186d15cef9/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 250,
          "old_api": "output_overlap",
          "new_api": "best_overlap_offset",
          "old_text": "s->output_overlap(s, pout, bytes_off)",
          "new_text": "s->best_overlap_offset(s)",
          "old_line_content": "      s->output_overlap(s, pout, bytes_off);",
          "new_line_content": "        bytes_off = s->best_overlap_offset(s);",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": "af_test_output",
          "new_api": "memcpy",
          "old_text": "af_test_output(af, data)",
          "new_text": "memcpy(af->data, data, sizeof(af_data_t))",
          "old_line_content": "      return af_test_output(af, data);",
          "new_line_content": "      memcpy(af->data, data, sizeof(af_data_t));",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 512,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_DEBUG0, \"[scaletempo] %6.3f scale, %6.2f stride, %6.2f overlap, %6.2f search, speed = %s\\n\", s->scale_nominal, s->ms_stride, s->percent_overlap, s->ms_search, (s->speed_tempo?(s->speed_pitch?\"tempo and speed\":\"tempo\"):(s->speed_pitch?\"pitch\":\"none\")))",
          "old_line_content": "    return AF_OK;",
          "new_line_content": "    af_msg(AF_MSG_DEBUG0, \"[scaletempo] %6.3f scale, %6.2f stride, %6.2f overlap, %6.2f search, speed = %s\\n\", s->scale_nominal, s->ms_stride, s->percent_overlap, s->ms_search, (s->speed_tempo?(s->speed_pitch?\"tempo and speed\":\"tempo\"):(s->speed_pitch?\"pitch\":\"none\")));",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": null,
          "new_api": "av_log2",
          "old_text": null,
          "new_text": "av_log2( 2*(s->samples_overlap - nch) - 1 )",
          "old_line_content": "        s->best_overlap_offset = best_overlap_offset_s16;",
          "new_line_content": "        s->shift_corr = av_log2( 2*(s->samples_overlap - nch) - 1 );",
          "content_same": false
        },
        {
          "line": 259,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(s->buf_overlap,\n           s->buf_queue + bytes_off + s->bytes_stride,\n           s->bytes_overlap)",
          "old_line_content": "           s->buf_queue + bytes_off + s->bytes_stride,",
          "new_line_content": "    memcpy(s->buf_overlap,",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": null,
          "new_api": "realloc",
          "old_text": null,
          "new_text": "realloc(s->table_window, s->bytes_overlap - nch * bps)",
          "old_line_content": "        if(!s->buf_pre_corr || !s->table_window) {",
          "new_line_content": "        s->table_window = realloc(s->table_window, s->bytes_overlap - nch * bps);",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "old_line_content": "          return AF_ERROR;",
          "new_line_content": "          af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": null,
          "new_api": "fill_queue",
          "old_text": null,
          "new_text": "fill_queue(af, data, offset_in)",
          "old_line_content": "  }",
          "new_line_content": "    offset_in += fill_queue(af, data, offset_in);",
          "content_same": false
        },
        {
          "line": 530,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(af->setup)",
          "old_line_content": "}",
          "new_line_content": "  free(af->setup);",
          "content_same": false
        },
        {
          "line": 411,
          "old_api": null,
          "new_api": "realloc",
          "old_text": null,
          "new_text": "realloc(s->buf_queue, s->bytes_queue)",
          "old_line_content": "    if(!s->buf_queue) {",
          "new_line_content": "    s->buf_queue = realloc(s->buf_queue, s->bytes_queue);",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "old_line_content": "      return AF_ERROR;",
          "new_line_content": "      af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": null,
          "new_api": "calloc",
          "old_text": null,
          "new_text": "calloc(1,sizeof(af_scaletempo_t))",
          "old_line_content": "  if(af->data == NULL || af->setup == NULL)",
          "new_line_content": "  af->setup     = calloc(1,sizeof(af_scaletempo_t));",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": null,
          "new_api": "af_msg (AF_MSG_DEBUG0, \"[scaletempo] \"\n            \"%.2f stride_in, %i stride_out, %i standing, \"\n            \"%i overlap, %i search, %i queue, %s mode\\n\",\n            s->frames_stride_scaled,\n            (int)(s->bytes_stride / nch / bps),\n            (int)(s->bytes_standing / nch / bps),\n            (int)(s->bytes_overlap / nch / bps),\n            s->frames_search,\n            (int)(s->bytes_queue / nch / bps),\n            (use_int?\"s16\":\"float\"))",
          "old_text": null,
          "new_text": "af_msg (AF_MSG_DEBUG0, \"[scaletempo] \"\n            \"%.2f stride_in, %i stride_out, %i standing, \"\n            \"%i overlap, %i search, %i queue, %s mode\\n\",\n            s->frames_stride_scaled,\n            (int)(s->bytes_stride / nch / bps),\n            (int)(s->bytes_standing / nch / bps),\n            (int)(s->bytes_overlap / nch / bps),\n            s->frames_search,\n            (int)(s->bytes_queue / nch / bps),\n            (use_int?\"s16\":\"float\"))",
          "old_line_content": "            \"%.2f stride_in, %i stride_out, %i standing, \"",
          "new_line_content": "    af_msg (AF_MSG_DEBUG0, \"[scaletempo] \"",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_VERBOSE,\n           \"[scaletempo] %.3f speed * %.3f scale_nominal = %.3f\\n\",\n           s->speed, s->scale_nominal, s->scale)",
          "old_line_content": "           \"[scaletempo] %.3f speed * %.3f scale_nominal = %.3f\\n\",",
          "new_line_content": "    af_msg(AF_MSG_VERBOSE,",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": null,
          "new_api": "af_test_output",
          "old_text": null,
          "new_text": "af_test_output(af, (af_data_t*)arg)",
          "old_line_content": "  }",
          "new_line_content": "    return af_test_output(af, (af_data_t*)arg);",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": null,
          "new_api": "af_test_output",
          "old_text": null,
          "new_text": "af_test_output(af, data)",
          "old_line_content": "    }",
          "new_line_content": "      return af_test_output(af, data);",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": null,
          "new_api": "realloc",
          "old_text": null,
          "new_text": "realloc(s->table_blend, s->bytes_overlap * 4)",
          "old_line_content": "      if(!s->buf_overlap || !s->table_blend) {",
          "new_line_content": "      s->table_blend      = realloc(s->table_blend, s->bytes_overlap * 4);",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": null,
          "new_api": "subopt_parse",
          "old_text": null,
          "new_text": "subopt_parse(arg, subopts)",
          "old_line_content": "      return AF_ERROR;",
          "new_line_content": "    if (subopt_parse(arg, subopts) != 0) {",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "old_line_content": "        return AF_ERROR;",
          "new_line_content": "        af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": null,
          "new_api": "bzero",
          "old_text": null,
          "new_text": "bzero(s->buf_overlap, s->bytes_overlap)",
          "old_line_content": "      if (use_int) {",
          "new_line_content": "      bzero(s->buf_overlap, s->bytes_overlap);",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": scale > 0\\n\")",
          "old_line_content": "             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange",
          "new_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": stride > 0\\n\")",
          "old_line_content": "             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange",
          "new_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": 0 <= overlap <= 1\\n\")",
          "old_line_content": "             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange",
          "new_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_VERBOSE, \"[libaf] Reallocating memory in module %s, \"\n          \"old len = %i, new len = %i\\n\",af->info->name,af->data->len,max_bytes_out)",
          "old_line_content": "          \"old len = %i, new len = %i\\n\",af->info->name,af->data->len,max_bytes_out);",
          "new_line_content": "    af_msg(AF_MSG_VERBOSE, \"[libaf] Reallocating memory in module %s, \"",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": search >= 0\\n\")",
          "old_line_content": "             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange",
          "new_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": null,
          "new_api": "realloc",
          "old_text": null,
          "new_text": "realloc(af->data->audio, max_bytes_out)",
          "old_line_content": "    if (!af->data->audio) {",
          "new_line_content": "    af->data->audio = realloc(af->data->audio, max_bytes_out);",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_FATAL, \"[libaf] Could not allocate memory\\n\")",
          "old_line_content": "      return NULL;",
          "new_line_content": "      af_msg(AF_MSG_FATAL, \"[libaf] Could not allocate memory\\n\");",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(speed.str, \"pitch\")",
          "old_line_content": "        s->speed_tempo = 0;",
          "new_line_content": "      if (strcmp(speed.str, \"pitch\") == 0) {",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(speed.str, \"tempo\")",
          "old_line_content": "        s->speed_tempo = 1;",
          "new_line_content": "      } else if (strcmp(speed.str, \"tempo\") == 0) {",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": null,
          "new_api": "fill_queue",
          "old_text": null,
          "new_text": "fill_queue(af, data, 0)",
          "old_line_content": "  pout = af->data->audio;",
          "new_line_content": "  offset_in = fill_queue(af, data, 0);",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(speed.str, \"none\")",
          "old_line_content": "        s->speed_tempo = 0;",
          "new_line_content": "      } else if (strcmp(speed.str, \"none\") == 0) {",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": null,
          "new_api": "realloc",
          "old_text": null,
          "new_text": "realloc(s->table_window, s->bytes_overlap * 2 - nch * bps * 2)",
          "old_line_content": "        if(!s->buf_pre_corr || !s->table_window) {",
          "new_line_content": "        s->table_window = realloc(s->table_window, s->bytes_overlap * 2 - nch * bps * 2);",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(speed.str, \"both\")",
          "old_line_content": "        s->speed_tempo = 1;",
          "new_line_content": "      } else if (strcmp(speed.str, \"both\") == 0) {",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "old_line_content": "          return AF_ERROR;",
          "new_line_content": "          af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "content_same": false
        },
        {
          "line": 505,
          "old_api": null,
          "new_api": "af_msg",
          "old_text": null,
          "new_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n               MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n               \": speed=[pitch|tempo|none|both]\\n\")",
          "old_line_content": "               MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange",
          "new_line_content": "        af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "content_same": false
        },
        {
          "line": 251,
          "old_api": null,
          "new_api": "output_overlap",
          "old_text": null,
          "new_text": "s->output_overlap(s, pout, bytes_off)",
          "old_line_content": "    }",
          "new_line_content": "      s->output_overlap(s, pout, bytes_off);",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(pout + s->bytes_overlap,\n           s->buf_queue + bytes_off + s->bytes_overlap,\n           s->bytes_standing)",
          "old_line_content": "           s->buf_queue + bytes_off + s->bytes_overlap,",
          "new_line_content": "    memcpy(pout + s->bytes_overlap,",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 384,
          "old_api": "av_log2",
          "new_api": null,
          "old_text": "av_log2( 2*(s->samples_overlap - nch) - 1 )",
          "new_text": null,
          "old_line_content": "        s->shift_corr = av_log2( 2*(s->samples_overlap - nch) - 1 );",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 258,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(s->buf_overlap,\n           s->buf_queue + bytes_off + s->bytes_stride,\n           s->bytes_overlap)",
          "new_text": null,
          "old_line_content": "    memcpy(s->buf_overlap,",
          "new_line_content": "    // input stride",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "realloc",
          "new_api": null,
          "old_text": "realloc(s->buf_pre_corr, s->bytes_overlap)",
          "new_text": null,
          "old_line_content": "        s->buf_pre_corr = realloc(s->buf_pre_corr, s->bytes_overlap);",
          "new_line_content": "        float* pw;",
          "content_same": false
        },
        {
          "line": 391,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "new_text": null,
          "old_line_content": "          af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "new_line_content": "        if(!s->buf_pre_corr || !s->table_window) {",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": "fill_queue",
          "new_api": null,
          "old_text": "fill_queue(af, data, offset_in)",
          "new_text": null,
          "old_line_content": "    offset_in += fill_queue(af, data, offset_in);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(af->data->audio)",
          "new_text": null,
          "old_line_content": "  free(af->data->audio);",
          "new_line_content": "  af_scaletempo_t* s = af->setup;",
          "content_same": false
        },
        {
          "line": 410,
          "old_api": "realloc",
          "new_api": null,
          "old_text": "realloc(s->buf_queue, s->bytes_queue)",
          "new_text": null,
          "old_line_content": "    s->buf_queue = realloc(s->buf_queue, s->bytes_queue);",
          "new_line_content": "      = (s->frames_search + frames_stride + frames_overlap) * bps * nch;",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "new_text": null,
          "old_line_content": "      af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "new_line_content": "    if(!s->buf_queue) {",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": "calloc",
          "new_api": null,
          "old_text": "calloc(1,sizeof(af_data_t))",
          "new_text": null,
          "old_line_content": "  af->data      = calloc(1,sizeof(af_data_t));",
          "new_line_content": "  af->mul       = 1;",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": "af_msg (AF_MSG_DEBUG0, \"[scaletempo] \"\n            \"%.2f stride_in, %i stride_out, %i standing, \"\n            \"%i overlap, %i search, %i queue, %s mode\\n\",\n            s->frames_stride_scaled,\n            (int)(s->bytes_stride / nch / bps),\n            (int)(s->bytes_standing / nch / bps),\n            (int)(s->bytes_overlap / nch / bps),\n            s->frames_search,\n            (int)(s->bytes_queue / nch / bps),\n            (use_int?\"s16\":\"float\"))",
          "new_api": null,
          "old_text": "af_msg (AF_MSG_DEBUG0, \"[scaletempo] \"\n            \"%.2f stride_in, %i stride_out, %i standing, \"\n            \"%i overlap, %i search, %i queue, %s mode\\n\",\n            s->frames_stride_scaled,\n            (int)(s->bytes_stride / nch / bps),\n            (int)(s->bytes_standing / nch / bps),\n            (int)(s->bytes_overlap / nch / bps),\n            s->frames_search,\n            (int)(s->bytes_queue / nch / bps),\n            (use_int?\"s16\":\"float\"))",
          "new_text": null,
          "old_line_content": "    af_msg (AF_MSG_DEBUG0, \"[scaletempo] \"",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_VERBOSE,\n           \"[scaletempo] %.3f speed * %.3f scale_nominal = %.3f\\n\",\n           s->speed, s->scale_nominal, s->scale)",
          "new_text": null,
          "old_line_content": "    af_msg(AF_MSG_VERBOSE,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 427,
          "old_api": "af_test_output",
          "new_api": null,
          "old_text": "af_test_output(af, (af_data_t*)arg)",
          "new_text": null,
          "old_line_content": "    return af_test_output(af, (af_data_t*)arg);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 300,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(af->data, data, sizeof(af_data_t))",
          "new_text": null,
          "old_line_content": "      memcpy(af->data, data, sizeof(af_data_t));",
          "new_line_content": "        return AF_DETACH;",
          "content_same": false
        },
        {
          "line": 333,
          "old_api": "realloc",
          "new_api": null,
          "old_text": "realloc(s->buf_overlap, s->bytes_overlap)",
          "new_text": null,
          "old_line_content": "      s->buf_overlap      = realloc(s->buf_overlap, s->bytes_overlap);",
          "new_line_content": "      s->samples_standing = s->bytes_standing / bps;",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "subopt_parse",
          "new_api": null,
          "old_text": "subopt_parse(arg, subopts)",
          "new_text": null,
          "old_line_content": "    if (subopt_parse(arg, subopts) != 0) {",
          "new_line_content": "    };",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "new_text": null,
          "old_line_content": "        af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "new_line_content": "      if(!s->buf_overlap || !s->table_blend) {",
          "content_same": false
        },
        {
          "line": 339,
          "old_api": "bzero",
          "new_api": null,
          "old_text": "bzero(s->buf_overlap, s->bytes_overlap)",
          "new_text": null,
          "old_line_content": "      bzero(s->buf_overlap, s->bytes_overlap);",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 467,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": scale > 0\\n\")",
          "new_text": null,
          "old_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "new_line_content": "    if (s->scale_nominal <= 0) {",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": stride > 0\\n\")",
          "new_text": null,
          "old_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "new_line_content": "    if (s->ms_stride <= 0) {",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": 0 <= overlap <= 1\\n\")",
          "new_text": null,
          "old_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "new_line_content": "    if (s->percent_overlap < 0 || s->percent_overlap > 1) {",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_VERBOSE, \"[libaf] Reallocating memory in module %s, \"\n          \"old len = %i, new len = %i\\n\",af->info->name,af->data->len,max_bytes_out)",
          "new_text": null,
          "old_line_content": "    af_msg(AF_MSG_VERBOSE, \"[libaf] Reallocating memory in module %s, \"",
          "new_line_content": "  if (max_bytes_out > af->data->len) {",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n             MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n             \": search >= 0\\n\")",
          "new_text": null,
          "old_line_content": "      af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "new_line_content": "    if (s->ms_search < 0) {",
          "content_same": false
        },
        {
          "line": 231,
          "old_api": "realloc",
          "new_api": null,
          "old_text": "realloc(af->data->audio, max_bytes_out)",
          "new_text": null,
          "old_line_content": "    af->data->audio = realloc(af->data->audio, max_bytes_out);",
          "new_line_content": "          \"old len = %i, new len = %i\\n\",af->info->name,af->data->len,max_bytes_out);",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_FATAL, \"[libaf] Could not allocate memory\\n\")",
          "new_text": null,
          "old_line_content": "      af_msg(AF_MSG_FATAL, \"[libaf] Could not allocate memory\\n\");",
          "new_line_content": "    if (!af->data->audio) {",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(speed.str, \"pitch\")",
          "new_text": null,
          "old_line_content": "      if (strcmp(speed.str, \"pitch\") == 0) {",
          "new_line_content": "    if (speed.len > 0) {",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(speed.str, \"tempo\")",
          "new_text": null,
          "old_line_content": "      } else if (strcmp(speed.str, \"tempo\") == 0) {",
          "new_line_content": "        s->speed_pitch = 1;",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": "fill_queue",
          "new_api": null,
          "old_text": "fill_queue(af, data, 0)",
          "new_text": null,
          "old_line_content": "  offset_in = fill_queue(af, data, 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 497,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(speed.str, \"none\")",
          "new_text": null,
          "old_line_content": "      } else if (strcmp(speed.str, \"none\") == 0) {",
          "new_line_content": "        s->speed_pitch = 0;",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": "realloc",
          "new_api": null,
          "old_text": "realloc(s->buf_pre_corr, s->bytes_overlap * 2)",
          "new_text": null,
          "old_line_content": "        s->buf_pre_corr = realloc(s->buf_pre_corr, s->bytes_overlap * 2);",
          "new_line_content": "        int32_t* pw;",
          "content_same": false
        },
        {
          "line": 500,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(speed.str, \"both\")",
          "new_text": null,
          "old_line_content": "      } else if (strcmp(speed.str, \"both\") == 0) {",
          "new_line_content": "        s->speed_pitch = 0;",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\")",
          "new_text": null,
          "old_line_content": "          af_msg(AF_MSG_FATAL, \"[scaletempo] Out of memory\\n\");",
          "new_line_content": "        if(!s->buf_pre_corr || !s->table_window) {",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_ERROR, \"[scaletempo] \"\n               MSGTR_ErrorParsingCommandLine \": \" MSGTR_AF_ValueOutOfRange\n               \": speed=[pitch|tempo|none|both]\\n\")",
          "new_text": null,
          "old_line_content": "        af_msg(AF_MSG_ERROR, \"[scaletempo] \"",
          "new_line_content": "      } else {",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": "best_overlap_offset",
          "new_api": null,
          "old_text": "s->best_overlap_offset(s)",
          "new_text": null,
          "old_line_content": "        bytes_off = s->best_overlap_offset(s);",
          "new_line_content": "      if (s->best_overlap_offset)",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(pout + s->bytes_overlap,\n           s->buf_queue + bytes_off + s->bytes_overlap,\n           s->bytes_standing)",
          "new_text": null,
          "old_line_content": "    memcpy(pout + s->bytes_overlap,",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 511,
          "old_api": "af_msg",
          "new_api": null,
          "old_text": "af_msg(AF_MSG_DEBUG0, \"[scaletempo] %6.3f scale, %6.2f stride, %6.2f overlap, %6.2f search, speed = %s\\n\", s->scale_nominal, s->ms_stride, s->percent_overlap, s->ms_search, (s->speed_tempo?(s->speed_pitch?\"tempo and speed\":\"tempo\"):(s->speed_pitch?\"pitch\":\"none\")))",
          "new_text": null,
          "old_line_content": "    af_msg(AF_MSG_DEBUG0, \"[scaletempo] %6.3f scale, %6.2f stride, %6.2f overlap, %6.2f search, speed = %s\\n\", s->scale_nominal, s->ms_stride, s->percent_overlap, s->ms_search, (s->speed_tempo?(s->speed_pitch?\"tempo and speed\":\"tempo\"):(s->speed_pitch?\"pitch\":\"none\")));",
          "new_line_content": "    s->scale = s->speed * s->scale_nominal;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 2,
      "total_additions": 35,
      "total_deletions": 35,
      "total_api_changes": 72
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 72,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          158,
          159
        ]
      }
    },
    "api_calls_before": 52,
    "api_calls_after": 52,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 1,
      "total_diff_lines": 15
    }
  }
}