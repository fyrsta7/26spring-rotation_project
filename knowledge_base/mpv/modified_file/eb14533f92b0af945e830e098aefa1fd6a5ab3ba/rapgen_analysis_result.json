{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/eb14533f92b0af945e830e098aefa1fd6a5ab3ba",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/eb14533f92b0af945e830e098aefa1fd6a5ab3ba/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/eb14533f92b0af945e830e098aefa1fd6a5ab3ba/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/eb14533f92b0af945e830e098aefa1fd6a5ab3ba/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 137,
          "old_api": "memset",
          "new_api": "memcpy",
          "old_text": "memset(p->temp + 8*stride + y*stride, 0, stride*sizeof(int16_t))",
          "new_text": "memcpy(p->src + (      7-y)*stride, p->src + (      y+8)*stride, stride)",
          "old_line_content": "\t\tmemset(p->temp + 8*stride + y*stride, 0, stride*sizeof(int16_t));",
          "new_line_content": "\t\tmemcpy(p->src + (      7-y)*stride, p->src + (      y+8)*stride, stride);",
          "content_same": false
        },
        {
          "line": 158,
          "old_api": "XMIN",
          "new_api": "fdct",
          "old_text": "XMIN(y, height-1)",
          "new_text": "p->dsp.fdct(block)",
          "old_line_content": "\t\t\t\tqp= qp_store[ (XMIN(x, width-1)>>qps) + (XMIN(y, height-1)>>qps) * qp_stride];",
          "new_line_content": "\t\t\t\tp->dsp.fdct(block);",
          "content_same": false
        },
        {
          "line": 263,
          "old_api": "vf_next_put_image",
          "new_api": "free",
          "old_text": "vf_next_put_image(vf,dmpi)",
          "new_text": "free(vf->priv->src)",
          "old_line_content": "\treturn vf_next_put_image(vf,dmpi);",
          "new_line_content": "\tif(vf->priv->src) free(vf->priv->src);",
          "content_same": false
        },
        {
          "line": 311,
          "old_api": "avcodec_alloc_context",
          "new_api": "vf_match_csp",
          "old_text": "avcodec_alloc_context()",
          "new_text": "vf_match_csp(&vf->next,fmt_list,IMGFMT_YV12)",
          "old_line_content": "    vf->priv->avctx= avcodec_alloc_context();",
          "new_line_content": "    vf->priv->outfmt=vf_match_csp(&vf->next,fmt_list,IMGFMT_YV12);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 128,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(p->src + 8 + 8*stride + y*stride, src + y*src_stride, width)",
          "old_line_content": "\tconst int count= 1<<p->log2_count;",
          "new_line_content": "\t\tmemcpy(p->src + 8 + 8*stride + y*stride, src + y*src_stride, width);",
          "content_same": false
        },
        {
          "line": 129,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(p->temp + 8*stride + y*stride, 0, stride*sizeof(int16_t))",
          "old_line_content": "\tconst int log2_scale= 6-p->log2_count;",
          "new_line_content": "\t\tmemset(p->temp + 8*stride + y*stride, 0, stride*sizeof(int16_t));",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(vf->priv->temp)",
          "old_line_content": "#endif",
          "new_line_content": "\tif(vf->priv->temp) free(vf->priv->temp);",
          "content_same": false
        },
        {
          "line": 265,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(vf->priv->avctx)",
          "old_line_content": "",
          "new_line_content": "        if(vf->priv->avctx) free(vf->priv->avctx);",
          "content_same": false
        },
        {
          "line": 138,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(p->src + (height+8+y)*stride, p->src + (height-y+7)*stride, stride)",
          "old_line_content": "\t\tfor(x=0; x<8; x++){ ",
          "new_line_content": "\t\tmemcpy(p->src + (height+8+y)*stride, p->src + (height-y+7)*stride, stride);",
          "content_same": false
        },
        {
          "line": 268,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(vf->priv)",
          "old_line_content": "",
          "new_line_content": "\tfree(vf->priv);",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": null,
          "new_api": "XMIN",
          "old_text": null,
          "new_text": "XMIN(y, height-1)",
          "old_line_content": "\tfor(y=0; y<height+8; y+=8){",
          "new_line_content": "\t\t\t\tqp= qp_store[ (XMIN(x, width-1)>>qps) + (XMIN(y, height-1)>>qps) * qp_stride];",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": null,
          "new_api": "vf_next_query_format",
          "old_text": null,
          "new_text": "vf_next_query_format(vf,vf->priv->outfmt)",
          "old_line_content": "//===========================================================================//",
          "new_line_content": "\t\treturn vf_next_query_format(vf,vf->priv->outfmt);",
          "content_same": false
        },
        {
          "line": 157,
          "old_api": null,
          "new_api": "get_pixels",
          "old_text": null,
          "new_text": "p->dsp.get_pixels(block, p->src + index, stride)",
          "old_line_content": "\t\t\telse{",
          "new_line_content": "\t\t\t\tp->dsp.get_pixels(block, p->src + index, stride);",
          "content_same": false
        },
        {
          "line": 159,
          "old_api": null,
          "new_api": "requantize",
          "old_text": null,
          "new_text": "requantize(block2, block, qp, p->dsp.idct_permutation)",
          "old_line_content": "\t\t\t\tif(p->mpeg2) qp>>=1;",
          "new_line_content": "\t\t\t\trequantize(block2, block, qp, p->dsp.idct_permutation);",
          "content_same": false
        },
        {
          "line": 160,
          "old_api": null,
          "new_api": "idct",
          "old_text": null,
          "new_text": "p->dsp.idct(block2)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tp->dsp.idct(block2);",
          "content_same": false
        },
        {
          "line": 161,
          "old_api": null,
          "new_api": "add_block",
          "old_text": null,
          "new_text": "add_block(p->temp + index, stride, block2)",
          "old_line_content": "\t\t\tfor(i=0; i<count; i++){",
          "new_line_content": "\t\t\t\tadd_block(p->temp + index, stride, block2);",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": null,
          "new_api": "malloc",
          "old_text": null,
          "new_text": "malloc(sizeof(struct vf_priv_s))",
          "old_line_content": "};",
          "new_line_content": "    vf->priv=malloc(sizeof(struct vf_priv_s));",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(vf->priv, 0, sizeof(struct vf_priv_s))",
          "old_line_content": "",
          "new_line_content": "    memset(vf->priv, 0, sizeof(struct vf_priv_s));",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": null,
          "new_api": "avcodec_init",
          "old_text": null,
          "new_text": "avcodec_init()",
          "old_line_content": "    vf->config=config;",
          "new_line_content": "    avcodec_init();",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": null,
          "new_api": "avcodec_alloc_context",
          "old_text": null,
          "new_text": "avcodec_alloc_context()",
          "old_line_content": "    vf->get_image=get_image;",
          "new_line_content": "    vf->priv->avctx= avcodec_alloc_context();",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": null,
          "new_api": "STORE",
          "old_text": null,
          "new_text": "STORE(0)",
          "old_line_content": "\tif(temp & 0x100) temp= ~(temp>>31);\\",
          "new_line_content": "\t\t\tSTORE(0);",
          "content_same": false
        },
        {
          "line": 177,
          "old_api": null,
          "new_api": "STORE",
          "old_text": null,
          "new_text": "STORE(1)",
          "old_line_content": "\tdst[x + y*dst_stride + pos]= temp;",
          "new_line_content": "\t\t\tSTORE(1);",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": null,
          "new_api": "STORE",
          "old_text": null,
          "new_text": "STORE(2)",
          "old_line_content": "",
          "new_line_content": "\t\t\tSTORE(2);",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": null,
          "new_api": "STORE",
          "old_text": null,
          "new_text": "STORE(3)",
          "old_line_content": "\tfor(y=0; y<height; y++){",
          "new_line_content": "\t\t\tSTORE(3);",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": null,
          "new_api": "STORE",
          "old_text": null,
          "new_text": "STORE(4)",
          "old_line_content": "\t\tuint8_t *d= dither[y&7];",
          "new_line_content": "\t\t\tSTORE(4);",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": null,
          "new_api": "STORE",
          "old_text": null,
          "new_text": "STORE(5)",
          "old_line_content": "\t\tfor(x=0; x<width; x+=8){",
          "new_line_content": "\t\t\tSTORE(5);",
          "content_same": false
        },
        {
          "line": 182,
          "old_api": null,
          "new_api": "STORE",
          "old_text": null,
          "new_text": "STORE(6)",
          "old_line_content": "\t\t\tconst int index= 8 + 8*stride + x + y*stride;",
          "new_line_content": "\t\t\tSTORE(6);",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": null,
          "new_api": "STORE",
          "old_text": null,
          "new_text": "STORE(7)",
          "old_line_content": "\t\t\tint temp;",
          "new_line_content": "\t\t\tSTORE(7);",
          "content_same": false
        },
        {
          "line": 304,
          "old_api": null,
          "new_api": "dsputil_init",
          "old_text": null,
          "new_text": "dsputil_init(&vf->priv->dsp, vf->priv->avctx)",
          "old_line_content": "    vf->query_format=query_format;",
          "new_line_content": "    dsputil_init(&vf->priv->dsp, vf->priv->avctx);",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": null,
          "new_api": "sscanf",
          "old_text": null,
          "new_text": "sscanf(args, \"%d:%d\", &vf->priv->log2_count, &vf->priv->qp)",
          "old_line_content": "    ",
          "new_line_content": "    if (args) sscanf(args, \"%d:%d\", &vf->priv->log2_count, &vf->priv->qp);",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": null,
          "new_api": "uninit",
          "old_text": null,
          "new_text": "uninit(vf)",
          "old_line_content": "    vf->priv->log2_count= 6;",
          "new_line_content": "\tuninit(vf);",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": null,
          "new_api": "malloc",
          "old_text": null,
          "new_text": "malloc(vf->priv->temp_stride*(height+16)*sizeof(int16_t))",
          "old_line_content": "\t//FIXME reorder for better caching",
          "new_line_content": "        vf->priv->temp= malloc(vf->priv->temp_stride*(height+16)*sizeof(int16_t));",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": null,
          "new_api": "malloc",
          "old_text": null,
          "new_text": "malloc(vf->priv->temp_stride*(height+16)*sizeof(uint8_t))",
          "old_line_content": "}",
          "new_line_content": "        vf->priv->src = malloc(vf->priv->temp_stride*(height+16)*sizeof(uint8_t));",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": null,
          "new_api": "vf_next_config",
          "old_text": null,
          "new_text": "vf_next_config(vf,width,height,d_width,d_height,flags,outfmt)",
          "old_line_content": "static int config(struct vf_instance_s* vf,",
          "new_line_content": "\treturn vf_next_config(vf,width,height,d_width,d_height,flags,outfmt);",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": null,
          "new_api": "vf_get_image",
          "old_text": null,
          "new_text": "vf_get_image(vf->next,mpi->imgfmt,\n        mpi->type, mpi->flags, mpi->w, mpi->h)",
          "old_line_content": "        ",
          "new_line_content": "    vf->dmpi=vf_get_image(vf->next,mpi->imgfmt,",
          "content_same": false
        },
        {
          "line": 95,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(dst, 0, 64*sizeof(DCTELEM))",
          "old_line_content": "\tthreshold2= (threshold1<<1);",
          "new_line_content": "\tmemset(dst, 0, 64*sizeof(DCTELEM));",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": null,
          "new_api": "vf_get_image",
          "old_text": null,
          "new_text": "vf_get_image(vf->next,vf->priv->outfmt,\n\t\tMP_IMGTYPE_TEMP, MP_IMGFLAG_ACCEPT_STRIDE,\n\t\tmpi->w,mpi->h)",
          "old_line_content": "    mpi->flags|=MP_IMGFLAG_DIRECT;",
          "new_line_content": "\t\tvf->dmpi=vf_get_image(vf->next,vf->priv->outfmt,",
          "content_same": false
        },
        {
          "line": 242,
          "old_api": null,
          "new_api": "filter",
          "old_text": null,
          "new_text": "filter(vf->priv, dmpi->planes[0], mpi->planes[0], dmpi->stride[0], mpi->stride[0], mpi->w, mpi->h, mpi->qscale, mpi->qstride, 1)",
          "old_line_content": "\t\tMP_IMGTYPE_TEMP, MP_IMGFLAG_ACCEPT_STRIDE,",
          "new_line_content": "\tfilter(vf->priv, dmpi->planes[0], mpi->planes[0], dmpi->stride[0], mpi->stride[0], mpi->w, mpi->h, mpi->qscale, mpi->qstride, 1);",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": null,
          "new_api": "filter",
          "old_text": null,
          "new_text": "filter(vf->priv, dmpi->planes[1], mpi->planes[1], dmpi->stride[1], mpi->stride[1], mpi->w>>1, mpi->h>>1, mpi->qscale, mpi->qstride, 0)",
          "old_line_content": "\t\tmpi->w,mpi->h);",
          "new_line_content": "\tfilter(vf->priv, dmpi->planes[1], mpi->planes[1], dmpi->stride[1], mpi->stride[1], mpi->w>>1, mpi->h>>1, mpi->qscale, mpi->qstride, 0);",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": null,
          "new_api": "filter",
          "old_text": null,
          "new_text": "filter(vf->priv, dmpi->planes[2], mpi->planes[2], dmpi->stride[2], mpi->stride[2], mpi->w>>1, mpi->h>>1, mpi->qscale, mpi->qstride, 0)",
          "old_line_content": "\t}",
          "new_line_content": "\tfilter(vf->priv, dmpi->planes[2], mpi->planes[2], dmpi->stride[2], mpi->stride[2], mpi->w>>1, mpi->h>>1, mpi->qscale, mpi->qstride, 0);",
          "content_same": false
        },
        {
          "line": 246,
          "old_api": null,
          "new_api": "vf_clone_mpi_attributes",
          "old_text": null,
          "new_text": "vf_clone_mpi_attributes(dmpi, mpi)",
          "old_line_content": "\tdmpi= vf->dmpi;",
          "new_line_content": "        vf_clone_mpi_attributes(dmpi, mpi);",
          "content_same": false
        },
        {
          "line": 255,
          "old_api": null,
          "new_api": "vf_next_put_image",
          "old_text": null,
          "new_text": "vf_next_put_image(vf,dmpi)",
          "old_line_content": "",
          "new_line_content": "\treturn vf_next_put_image(vf,dmpi);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 136,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(p->src + 8 + 8*stride + y*stride, src + y*src_stride, width)",
          "new_text": null,
          "old_line_content": "\t\tmemcpy(p->src + 8 + 8*stride + y*stride, src + y*src_stride, width);",
          "new_line_content": "\tfor(y=0; y<8; y++){",
          "content_same": false
        },
        {
          "line": 269,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(vf->priv->temp)",
          "new_text": null,
          "old_line_content": "\tif(vf->priv->temp) free(vf->priv->temp);",
          "new_line_content": "\tvf->priv=NULL;",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(vf->priv->src)",
          "new_text": null,
          "old_line_content": "\tif(vf->priv->src) free(vf->priv->src);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(p->src + (      7-y)*stride, p->src + (      y+8)*stride, stride)",
          "new_text": null,
          "old_line_content": "\t\tmemcpy(p->src + (      7-y)*stride, p->src + (      y+8)*stride, stride);",
          "new_line_content": "\t\t\tint qp;",
          "content_same": false
        },
        {
          "line": 146,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(p->src + (height+8+y)*stride, p->src + (height-y+7)*stride, stride)",
          "new_text": null,
          "old_line_content": "\t\tmemcpy(p->src + (height+8+y)*stride, p->src + (height-y+7)*stride, stride);",
          "new_line_content": "                        ",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(vf->priv->avctx)",
          "new_text": null,
          "old_line_content": "        if(vf->priv->avctx) free(vf->priv->avctx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(vf->priv)",
          "new_text": null,
          "old_line_content": "\tfree(vf->priv);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 288,
          "old_api": "vf_next_query_format",
          "new_api": null,
          "old_text": "vf_next_query_format(vf,vf->priv->outfmt)",
          "new_text": null,
          "old_line_content": "\t\treturn vf_next_query_format(vf,vf->priv->outfmt);",
          "new_line_content": "    IMGFMT_IYUV,",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": "get_pixels",
          "new_api": null,
          "old_text": "p->dsp.get_pixels(block, p->src + index, stride)",
          "new_text": null,
          "old_line_content": "\t\t\t\tp->dsp.get_pixels(block, p->src + index, stride);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 166,
          "old_api": "fdct",
          "new_api": null,
          "old_text": "p->dsp.fdct(block)",
          "new_text": null,
          "old_line_content": "\t\t\t\tp->dsp.fdct(block);",
          "new_line_content": "#define STORE(pos) \\",
          "content_same": false
        },
        {
          "line": 167,
          "old_api": "requantize",
          "new_api": null,
          "old_text": "requantize(block2, block, qp, p->dsp.idct_permutation)",
          "new_text": null,
          "old_line_content": "\t\t\t\trequantize(block2, block, qp, p->dsp.idct_permutation);",
          "new_line_content": "\ttemp= ((p->temp[index + pos]<<log2_scale) + d[pos])>>6;\\",
          "content_same": false
        },
        {
          "line": 168,
          "old_api": "idct",
          "new_api": null,
          "old_text": "p->dsp.idct(block2)",
          "new_text": null,
          "old_line_content": "\t\t\t\tp->dsp.idct(block2);",
          "new_line_content": "\tif(temp & 0x100) temp= ~(temp>>31);\\",
          "content_same": false
        },
        {
          "line": 169,
          "old_api": "add_block",
          "new_api": null,
          "old_text": "add_block(p->temp + index, stride, block2)",
          "new_text": null,
          "old_line_content": "\t\t\t\tadd_block(p->temp + index, stride, block2);",
          "new_line_content": "\tdst[x + y*dst_stride + pos]= temp;",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": "malloc",
          "new_api": null,
          "old_text": "malloc(sizeof(struct vf_priv_s))",
          "new_text": null,
          "old_line_content": "    vf->priv=malloc(sizeof(struct vf_priv_s));",
          "new_line_content": "    vf->priv->log2_count= 6;",
          "content_same": false
        },
        {
          "line": 307,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(vf->priv, 0, sizeof(struct vf_priv_s))",
          "new_text": null,
          "old_line_content": "    memset(vf->priv, 0, sizeof(struct vf_priv_s));",
          "new_line_content": "    ",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": "avcodec_init",
          "new_api": null,
          "old_text": "avcodec_init()",
          "new_text": null,
          "old_line_content": "    avcodec_init();",
          "new_line_content": "\t",
          "content_same": false
        },
        {
          "line": 184,
          "old_api": "STORE",
          "new_api": null,
          "old_text": "STORE(0)",
          "new_text": null,
          "old_line_content": "\t\t\tSTORE(0);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": "STORE",
          "new_api": null,
          "old_text": "STORE(1)",
          "new_text": null,
          "old_line_content": "\t\t\tSTORE(1);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": "STORE",
          "new_api": null,
          "old_text": "STORE(2)",
          "new_text": null,
          "old_line_content": "\t\t\tSTORE(2);",
          "new_line_content": "#if 0",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": "STORE",
          "new_api": null,
          "old_text": "STORE(3)",
          "new_text": null,
          "old_line_content": "\t\t\tSTORE(3);",
          "new_line_content": "\tfor(y=0; y<height; y++){",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "STORE",
          "new_api": null,
          "old_text": "STORE(4)",
          "new_text": null,
          "old_line_content": "\t\t\tSTORE(4);",
          "new_line_content": "\t\tfor(x=0; x<width; x++){",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": "STORE",
          "new_api": null,
          "old_text": "STORE(5)",
          "new_text": null,
          "old_line_content": "\t\t\tSTORE(5);",
          "new_line_content": "\t\t\tif((((x>>6) ^ (y>>6)) & 1) == 0)",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": "STORE",
          "new_api": null,
          "old_text": "STORE(6)",
          "new_text": null,
          "old_line_content": "\t\t\tSTORE(6);",
          "new_line_content": "\t\t\t\tdst[x + y*dst_stride]= p->src[8 + 8*stride  + x + y*stride];",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "STORE",
          "new_api": null,
          "old_text": "STORE(7)",
          "new_text": null,
          "old_line_content": "\t\t\tSTORE(7);",
          "new_line_content": "\t\t\tif((x&63) == 0 || (y&63)==0)",
          "content_same": false
        },
        {
          "line": 312,
          "old_api": "dsputil_init",
          "new_api": null,
          "old_text": "dsputil_init(&vf->priv->dsp, vf->priv->avctx)",
          "new_text": null,
          "old_line_content": "    dsputil_init(&vf->priv->dsp, vf->priv->avctx);",
          "new_line_content": "    if(!vf->priv->outfmt)",
          "content_same": false
        },
        {
          "line": 316,
          "old_api": "sscanf",
          "new_api": null,
          "old_text": "sscanf(args, \"%d:%d\", &vf->priv->log2_count, &vf->priv->qp)",
          "new_text": null,
          "old_line_content": "    if (args) sscanf(args, \"%d:%d\", &vf->priv->log2_count, &vf->priv->qp);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": "vf_match_csp",
          "new_api": null,
          "old_text": "vf_match_csp(&vf->next,fmt_list,IMGFMT_YV12)",
          "new_text": null,
          "old_line_content": "    vf->priv->outfmt=vf_match_csp(&vf->next,fmt_list,IMGFMT_YV12);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": "uninit",
          "new_api": null,
          "old_text": "uninit(vf)",
          "new_text": null,
          "old_line_content": "\tuninit(vf);",
          "new_line_content": "    \"simple postprocess\",",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "malloc",
          "new_api": null,
          "old_text": "malloc(vf->priv->temp_stride*(height+16)*sizeof(int16_t))",
          "new_text": null,
          "old_line_content": "        vf->priv->temp= malloc(vf->priv->temp_stride*(height+16)*sizeof(int16_t));",
          "new_line_content": "    if(mpi->imgfmt!=vf->priv->outfmt) return; // colorspace differ",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": "malloc",
          "new_api": null,
          "old_text": "malloc(vf->priv->temp_stride*(height+16)*sizeof(uint8_t))",
          "new_text": null,
          "old_line_content": "        vf->priv->src = malloc(vf->priv->temp_stride*(height+16)*sizeof(uint8_t));",
          "new_line_content": "    // ok, we can do pp in-place (or pp disabled):",
          "content_same": false
        },
        {
          "line": 215,
          "old_api": "vf_next_config",
          "new_api": null,
          "old_text": "vf_next_config(vf,width,height,d_width,d_height,flags,outfmt)",
          "new_text": null,
          "old_line_content": "\treturn vf_next_config(vf,width,height,d_width,d_height,flags,outfmt);",
          "new_line_content": "        mpi->type, mpi->flags, mpi->w, mpi->h);",
          "content_same": false
        },
        {
          "line": 222,
          "old_api": "vf_get_image",
          "new_api": null,
          "old_text": "vf_get_image(vf->next,mpi->imgfmt,\n        mpi->type, mpi->flags, mpi->w, mpi->h)",
          "new_text": null,
          "old_line_content": "    vf->dmpi=vf_get_image(vf->next,mpi->imgfmt,",
          "new_line_content": "\tmpi->stride[1]=vf->dmpi->stride[1];",
          "content_same": false
        },
        {
          "line": 97,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(dst, 0, 64*sizeof(DCTELEM))",
          "new_text": null,
          "old_line_content": "\tmemset(dst, 0, 64*sizeof(DCTELEM));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": "vf_get_image",
          "new_api": null,
          "old_text": "vf_get_image(vf->next,vf->priv->outfmt,\n\t\tMP_IMGTYPE_TEMP, MP_IMGFLAG_ACCEPT_STRIDE,\n\t\tmpi->w,mpi->h)",
          "new_text": null,
          "old_line_content": "\t\tvf->dmpi=vf_get_image(vf->next,vf->priv->outfmt,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 250,
          "old_api": "filter",
          "new_api": null,
          "old_text": "filter(vf->priv, dmpi->planes[0], mpi->planes[0], dmpi->stride[0], mpi->stride[0], mpi->w, mpi->h, mpi->qscale, mpi->qstride, 1)",
          "new_text": null,
          "old_line_content": "\tfilter(vf->priv, dmpi->planes[0], mpi->planes[0], dmpi->stride[0], mpi->stride[0], mpi->w, mpi->h, mpi->qscale, mpi->qstride, 1);",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 251,
          "old_api": "filter",
          "new_api": null,
          "old_text": "filter(vf->priv, dmpi->planes[1], mpi->planes[1], dmpi->stride[1], mpi->stride[1], mpi->w>>1, mpi->h>>1, mpi->qscale, mpi->qstride, 0)",
          "new_text": null,
          "old_line_content": "\tfilter(vf->priv, dmpi->planes[1], mpi->planes[1], dmpi->stride[1], mpi->stride[1], mpi->w>>1, mpi->h>>1, mpi->qscale, mpi->qstride, 0);",
          "new_line_content": "#ifdef HAVE_MMX2",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": "filter",
          "new_api": null,
          "old_text": "filter(vf->priv, dmpi->planes[2], mpi->planes[2], dmpi->stride[2], mpi->stride[2], mpi->w>>1, mpi->h>>1, mpi->qscale, mpi->qstride, 0)",
          "new_text": null,
          "old_line_content": "\tfilter(vf->priv, dmpi->planes[2], mpi->planes[2], dmpi->stride[2], mpi->stride[2], mpi->w>>1, mpi->h>>1, mpi->qscale, mpi->qstride, 0);",
          "new_line_content": "\tif(gCpuCaps.hasMMX2) asm volatile (\"sfence\\n\\t\");",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": "vf_clone_mpi_attributes",
          "new_api": null,
          "old_text": "vf_clone_mpi_attributes(dmpi, mpi)",
          "new_text": null,
          "old_line_content": "        vf_clone_mpi_attributes(dmpi, mpi);",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 4,
      "total_additions": 38,
      "total_deletions": 38,
      "total_api_changes": 80
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 19,
        "api_related_lines": 80,
        "non_api_lines": 19,
        "non_api_line_numbers": [
          89,
          90,
          91,
          92,
          93,
          94,
          96,
          98,
          99,
          100,
          101,
          102,
          104,
          105,
          106,
          107,
          108,
          109,
          110
        ]
      }
    },
    "api_calls_before": 45,
    "api_calls_after": 45,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 14,
      "total_diff_lines": 40
    }
  }
}