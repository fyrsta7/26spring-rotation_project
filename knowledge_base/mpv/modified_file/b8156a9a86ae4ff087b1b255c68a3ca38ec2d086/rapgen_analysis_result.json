{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/b8156a9a86ae4ff087b1b255c68a3ca38ec2d086",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/b8156a9a86ae4ff087b1b255c68a3ca38ec2d086/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/b8156a9a86ae4ff087b1b255c68a3ca38ec2d086/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/b8156a9a86ae4ff087b1b255c68a3ca38ec2d086/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 3332,
          "old_api": "imer_pool_stop",
          "new_api": "imer_pool_start",
          "old_text": "imer_pool_stop(p->blit_timer);",
          "new_text": "imer_pool_start(p->blit_timer);",
          "old_line_content": "                timer_pool_stop(p->blit_timer);",
          "new_line_content": "                timer_pool_start(p->blit_timer);",
          "content_same": false
        },
        {
          "line": 3333,
          "old_api": "imer_pool_measure",
          "new_api": "blit",
          "old_text": "imer_pool_measure(p->blit_timer))",
          "new_text": "->ra->fns->blit(p->ra, fbo.tex, p->output_tex, &dst, &src);",
          "old_line_content": "                pass_record(p, timer_pool_measure(p->blit_timer));",
          "new_line_content": "                p->ra->fns->blit(p->ra, fbo.tex, p->output_tex, &dst, &src);",
          "content_same": false
        },
        {
          "line": 3444,
          "old_api": "p_image_alloc",
          "new_api": "l_video_render_frame",
          "old_text": "p_image_alloc(mpfmt, params.w, params.h);",
          "new_text": "l_video_render_frame(p, nframe, (struct ra_fbo){target}, flags);",
          "old_line_content": "    res = mp_image_alloc(mpfmt, params.w, params.h);",
          "new_line_content": "    gl_video_render_frame(p, nframe, (struct ra_fbo){target}, flags);",
          "content_same": false
        },
        {
          "line": 3463,
          "old_api": "l_video_resize",
          "new_api": "alloc_free",
          "old_text": "l_video_resize(p, &old_src, &old_dst, &old_osd);",
          "new_text": "alloc_free(nframe);",
          "old_line_content": "    gl_video_resize(p, &old_src, &old_dst, &old_osd);",
          "new_line_content": "    talloc_free(nframe);",
          "content_same": false
        },
        {
          "line": 3464,
          "old_api": "l_video_reset_surfaces",
          "new_api": "a_tex_free",
          "old_text": "l_video_reset_surfaces(p);",
          "new_text": "a_tex_free(p->ra, &target);",
          "old_line_content": "    gl_video_reset_surfaces(p);",
          "new_line_content": "    ra_tex_free(p->ra, &target);",
          "content_same": false
        },
        {
          "line": 3466,
          "old_api": "A_FREEP",
          "new_api": "l_video_reset_surfaces",
          "old_text": "A_FREEP(&res);",
          "new_text": "l_video_reset_surfaces(p);",
          "old_line_content": "        TA_FREEP(&res);",
          "new_line_content": "    gl_video_reset_surfaces(p);",
          "content_same": false
        },
        {
          "line": 3494,
          "old_api": "sd_res_equals",
          "new_api": "p_rect_equals",
          "old_text": "sd_res_equals(p->osd_rect, *osd))",
          "new_text": "p_rect_equals(&p->src_rect, src) ",
          "old_line_content": "        osd_res_equals(p->osd_rect, *osd))",
          "new_line_content": "    if (mp_rect_equals(&p->src_rect, src) &&",
          "content_same": false
        },
        {
          "line": 3535,
          "old_api": "p_image_new_ref",
          "new_api": "nref_current_image",
          "old_text": "p_image_new_ref(mpi);",
          "new_text": "nref_current_image(p);",
          "old_line_content": "    mpi = mp_image_new_ref(mpi);",
          "new_line_content": "    unref_current_image(p);",
          "content_same": false
        },
        {
          "line": 3552,
          "old_api": "a_hwdec_mapper_map",
          "new_api": "ass_describe",
          "old_text": "a_hwdec_mapper_map(p->hwdec_mapper, vimg->mpi) ",
          "new_text": "ass_describe(p, \"map frame (hwdec)\");",
          "old_line_content": "        bool ok = ra_hwdec_mapper_map(p->hwdec_mapper, vimg->mpi) >= 0;",
          "new_line_content": "        pass_describe(p, \"map frame (hwdec)\");",
          "content_same": false
        },
        {
          "line": 3553,
          "old_api": "imer_pool_stop",
          "new_api": "imer_pool_start",
          "old_text": "imer_pool_stop(p->upload_timer);",
          "new_text": "imer_pool_start(p->upload_timer);",
          "old_line_content": "        timer_pool_stop(p->upload_timer);",
          "new_line_content": "        timer_pool_start(p->upload_timer);",
          "content_same": false
        },
        {
          "line": 3554,
          "old_api": "imer_pool_measure",
          "new_api": "a_hwdec_mapper_map",
          "old_text": "imer_pool_measure(p->upload_timer))",
          "new_text": "a_hwdec_mapper_map(p->hwdec_mapper, vimg->mpi) ",
          "old_line_content": "        pass_record(p, timer_pool_measure(p->upload_timer));",
          "new_line_content": "        bool ok = ra_hwdec_mapper_map(p->hwdec_mapper, vimg->mpi) >= 0;",
          "content_same": false
        },
        {
          "line": 3578,
          "old_api": "imer_pool_start",
          "new_api": "ssert",
          "old_text": "imer_pool_start(p->upload_timer);",
          "new_text": "ssert(mpi->num_planes == p->plane_count);",
          "old_line_content": "    timer_pool_start(p->upload_timer);",
          "new_line_content": "    assert(mpi->num_planes == p->plane_count);",
          "content_same": false
        },
        {
          "line": 3617,
          "old_api": "imer_pool_stop",
          "new_api": "p_image_new_ref",
          "old_text": "imer_pool_stop(p->upload_timer);",
          "new_text": "p_image_new_ref(mpi);",
          "old_line_content": "    timer_pool_stop(p->upload_timer);",
          "new_line_content": "            mapped->mpi = mp_image_new_ref(mpi);",
          "content_same": false
        },
        {
          "line": 3636,
          "old_api": "a_tex_resize",
          "new_api": "P_VERBOSE",
          "old_text": "a_tex_resize(p->ra, p->log, &tex, 16, 16, fmt);",
          "new_text": "P_VERBOSE(p, \"Testing FBO format %s\\n\", fmt->name);",
          "old_line_content": "    bool success = ra_tex_resize(p->ra, p->log, &tex, 16, 16, fmt);",
          "new_line_content": "    MP_VERBOSE(p, \"Testing FBO format %s\\n\", fmt->name);",
          "content_same": false
        },
        {
          "line": 3677,
          "old_api": "a_find_unorm_format",
          "new_api": "a_find_float16_format",
          "old_text": "a_find_unorm_format(p->ra, 1, 2);",
          "new_text": "a_find_float16_format(ra, 1);",
          "old_line_content": "    const struct ra_format *rg_tex = ra_find_unorm_format(p->ra, 1, 2);",
          "new_line_content": "    bool have_float_tex = !!ra_find_float16_format(ra, 1);",
          "content_same": false
        },
        {
          "line": 3696,
          "old_api": "P_WARN",
          "new_api": "a_find_named_format",
          "old_text": "P_WARN(p, \"FBO format '%s' not found!\\n\", fmt);",
          "new_text": "a_find_named_format(p->ra, fmt);",
          "old_line_content": "            MP_WARN(p, \"FBO format '%s' not found!\\n\", fmt);",
          "new_line_content": "        const struct ra_format *f = ra_find_named_format(p->ra, fmt);",
          "content_same": false
        },
        {
          "line": 3698,
          "old_api": "est_fbo",
          "new_api": "P_WARN",
          "old_text": "est_fbo(p, f))",
          "new_text": "P_WARN(p, \"FBO format '%s' not found!\\n\", fmt);",
          "old_line_content": "            (fbo_test_result = test_fbo(p, f))) {",
          "new_line_content": "            MP_WARN(p, \"FBO format '%s' not found!\\n\", fmt);",
          "content_same": false
        },
        {
          "line": 3758,
          "old_api": "P_WARN",
          "new_api": "P_VERBOSE",
          "old_text": "P_WARN(p, \"High bit depth FBOs unsupported. Enabling dumb mode.\\n\"\n                       \"Most extended features will be disabled.\\n\");",
          "new_text": "P_VERBOSE(p, \"No advanced processing required. Enabling dumb mode.\\n\");",
          "old_line_content": "            MP_WARN(p, \"High bit depth FBOs unsupported. Enabling dumb mode.\\n\"",
          "new_line_content": "            MP_VERBOSE(p, \"No advanced processing required. Enabling dumb mode.\\n\");",
          "content_same": false
        },
        {
          "line": 3847,
          "old_api": "imer_pool_create",
          "new_api": "ebug_check_gl",
          "old_text": "imer_pool_create(p->ra);",
          "new_text": "ebug_check_gl(p, \"before init_gl\");",
          "old_line_content": "    p->upload_timer = timer_pool_create(p->ra);",
          "new_line_content": "    debug_check_gl(p, \"before init_gl\");",
          "content_same": false
        },
        {
          "line": 3851,
          "old_api": "ebug_check_gl",
          "new_api": "imer_pool_create",
          "old_text": "ebug_check_gl(p, \"after init_gl\");",
          "new_text": "imer_pool_create(p->ra);",
          "old_line_content": "    debug_check_gl(p, \"after init_gl\");",
          "new_line_content": "    p->osd_timer = timer_pool_create(p->ra);",
          "content_same": false
        },
        {
          "line": 3853,
          "old_api": "a_dump_tex_formats",
          "new_api": "ebug_check_gl",
          "old_text": "a_dump_tex_formats(p->ra, MSGL_DEBUG);",
          "new_text": "ebug_check_gl(p, \"after init_gl\");",
          "old_line_content": "    ra_dump_tex_formats(p->ra, MSGL_DEBUG);",
          "new_line_content": "    debug_check_gl(p, \"after init_gl\");",
          "content_same": false
        },
        {
          "line": 3870,
          "old_api": "a_tex_free",
          "new_api": "l_sc_destroy",
          "old_text": "a_tex_free(p->ra, &p->lut_3d_texture);",
          "new_text": "l_sc_destroy(p->sc);",
          "old_line_content": "    ra_tex_free(p->ra, &p->lut_3d_texture);",
          "new_line_content": "    gl_sc_destroy(p->sc);",
          "content_same": false
        },
        {
          "line": 3873,
          "old_api": "imer_pool_destroy",
          "new_api": "a_buf_free",
          "old_text": "imer_pool_destroy(p->upload_timer);",
          "new_text": "a_buf_free(p->ra, &p->hdr_peak_ssbo);",
          "old_line_content": "    timer_pool_destroy(p->upload_timer);",
          "new_line_content": "    ra_buf_free(p->ra, &p->hdr_peak_ssbo);",
          "content_same": false
        },
        {
          "line": 3891,
          "old_api": "alloc_free",
          "new_api": "ssert",
          "old_text": "alloc_free(p);",
          "new_text": "ssert(!p->num_dr_buffers);",
          "old_line_content": "    talloc_free(p);",
          "new_line_content": "    assert(!p->num_dr_buffers);",
          "content_same": false
        },
        {
          "line": 3934,
          "old_api": "p_image_params_equal",
          "new_api": "nref_current_image",
          "old_text": "p_image_params_equal(&p->real_image_params, params))",
          "new_text": "nref_current_image(p);",
          "old_line_content": "    if (!mp_image_params_equal(&p->real_image_params, params)) {",
          "new_line_content": "    unref_current_image(p);",
          "content_same": false
        },
        {
          "line": 3963,
          "old_api": "_config_cache_alloc",
          "new_api": "l_sc_create",
          "old_text": "_config_cache_alloc(p, g, &gl_video_conf),",
          "new_text": "l_sc_create(ra, g, log),",
          "old_line_content": "        .opts_cache = m_config_cache_alloc(p, g, &gl_video_conf),",
          "new_line_content": "        .sc = gl_sc_create(ra, g, log),",
          "content_same": false
        },
        {
          "line": 4008,
          "old_api": "einit_from_options",
          "new_api": "_config_cache_update",
          "old_text": "einit_from_options(p);",
          "new_text": "_config_cache_update(p->opts_cache))",
          "old_line_content": "        reinit_from_options(p);",
          "new_line_content": "    if (m_config_cache_update(p->opts_cache)) {",
          "content_same": false
        },
        {
          "line": 4029,
          "old_api": "l_sc_set_cache_dir",
          "new_api": "heck_gl_features",
          "old_text": "l_sc_set_cache_dir(p->sc, p->opts.shader_cache_dir);",
          "new_text": "heck_gl_features(p);",
          "old_line_content": "    gl_sc_set_cache_dir(p->sc, p->opts.shader_cache_dir);",
          "new_line_content": "    check_gl_features(p);",
          "content_same": false
        },
        {
          "line": 4031,
          "old_api": "l_video_setup_hooks",
          "new_api": "l_sc_set_cache_dir",
          "old_text": "l_video_setup_hooks(p);",
          "new_text": "l_sc_set_cache_dir(p->sc, p->opts.shader_cache_dir);",
          "old_line_content": "    gl_video_setup_hooks(p);",
          "new_line_content": "    gl_sc_set_cache_dir(p->sc, p->opts.shader_cache_dir);",
          "content_same": false
        },
        {
          "line": 4037,
          "old_api": "P_WARN",
          "new_api": "p_read_option_raw",
          "old_text": "P_WARN(p, \"Interpolation now requires enabling display-sync mode.\\n\"\n                   \"E.g.: --video-sync=display-resample\\n\");",
          "new_text": "p_read_option_raw(p->global, \"video-sync\", &m_option_type_choice, &vs);",
          "old_line_content": "        MP_WARN(p, \"Interpolation now requires enabling display-sync mode.\\n\"",
          "new_line_content": "    mp_read_option_raw(p->global, \"video-sync\", &m_option_type_choice, &vs);",
          "content_same": false
        },
        {
          "line": 4132,
          "old_api": "p_fatal",
          "new_api": "p_info",
          "old_text": "p_fatal(log, \"No window named '%s' found!\\n\", s);",
          "new_text": "p_info(log, \"    %s\\n\", mp_filter_windows[n].name);",
          "old_line_content": "            mp_fatal(log, \"No window named '%s' found!\\n\", s);",
          "new_line_content": "            mp_info(log, \"    %s\\n\", mp_filter_windows[n].name);",
          "content_same": false
        },
        {
          "line": 4155,
          "old_api": "p_fatal",
          "new_api": "p_info",
          "old_text": "p_fatal(log, \"No error diffusion kernel named '%s' found!\\n\", s);",
          "new_text": "p_info(log, \"    %s\\n\", mp_error_diffusion_kernels[n].name);",
          "old_line_content": "            mp_fatal(log, \"No error diffusion kernel named '%s' found!\\n\", s);",
          "new_line_content": "            mp_info(log, \"    %s\\n\", mp_error_diffusion_kernels[n].name);",
          "content_same": false
        },
        {
          "line": 4165,
          "old_api": "og10",
          "new_api": "ssert",
          "old_text": "og10(lmin))",
          "new_text": "ssert(lmax > lmin);",
          "old_line_content": "    float num = (rmax - rmin) * (log10(lux) - log10(lmin));",
          "new_line_content": "    assert(lmax > lmin);",
          "content_same": false
        },
        {
          "line": 4172,
          "old_api": "PMIN",
          "new_api": "PMAX",
          "old_text": "PMIN(result, max),",
          "new_text": "PMAX(rmax, rmin);",
          "old_line_content": "    return MPMAX(MPMIN(result, max), min);",
          "new_line_content": "    float max = MPMAX(rmax, rmin);",
          "content_same": false
        },
        {
          "line": 4211,
          "old_api": "P_TARRAY_REMOVE_AT",
          "new_api": "ssert",
          "old_text": "P_TARRAY_REMOVE_AT(p->dr_buffers, p->num_dr_buffers, n);",
          "new_text": "ssert(!buffer->mpi);",
          "old_line_content": "            MP_TARRAY_REMOVE_AT(p->dr_buffers, p->num_dr_buffers, n);",
          "new_line_content": "            assert(!buffer->mpi); // can't be freed while it has a ref",
          "content_same": false
        },
        {
          "line": 4250,
          "old_api": "P_TARRAY_APPEND",
          "new_api": "a_hwdec_load_driver",
          "old_text": "P_TARRAY_APPEND(p, p->hwdecs, p->num_hwdecs, hwdec);",
          "new_text": "a_hwdec_load_driver(p->ra, p->log, p->global, devs, drv, is_auto);",
          "old_line_content": "        MP_TARRAY_APPEND(p, p->hwdecs, p->num_hwdecs, hwdec);",
          "new_line_content": "        ra_hwdec_load_driver(p->ra, p->log, p->global, devs, drv, is_auto);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 4098,
          "old_api": null,
          "new_api": "p_info",
          "old_text": null,
          "new_text": "p_info(log, \"Available scalers:\\n\");",
          "old_line_content": "                                                : fixed_scale_filters;",
          "new_line_content": "        mp_info(log, \"Available scalers:\\n\");",
          "content_same": false
        },
        {
          "line": 4102,
          "old_api": null,
          "new_api": "p_info",
          "old_text": null,
          "new_text": "p_info(log, \"    %s\\n\", *filter);",
          "old_line_content": "        for (int n = 0; mp_filter_kernels[n].f.name; n++) {",
          "new_line_content": "            mp_info(log, \"    %s\\n\", *filter);",
          "content_same": false
        },
        {
          "line": 3593,
          "old_api": null,
          "new_api": "p_image_plane_h",
          "old_text": null,
          "new_text": "p_image_plane_h(mpi, n);",
          "old_line_content": "            params.stride = -params.stride;",
          "new_line_content": "            int h = mp_image_plane_h(mpi, n);",
          "content_same": false
        },
        {
          "line": 4106,
          "old_api": null,
          "new_api": "p_info",
          "old_text": null,
          "new_text": "p_info(log, \"    %s\\n\", mp_filter_kernels[n].f.name);",
          "old_line_content": "        if (s[0])",
          "new_line_content": "                mp_info(log, \"    %s\\n\", mp_filter_kernels[n].f.name);",
          "content_same": false
        },
        {
          "line": 4109,
          "old_api": null,
          "new_api": "p_fatal",
          "old_text": null,
          "new_text": "p_fatal(log, \"No scaler named '%s' found!\\n\", s);",
          "old_line_content": "    return r;",
          "new_line_content": "            mp_fatal(log, \"No scaler named '%s' found!\\n\", s);",
          "content_same": false
        },
        {
          "line": 3598,
          "old_api": null,
          "new_api": "l_find_dr_buffer",
          "old_text": null,
          "new_text": "l_find_dr_buffer(p, mpi->planes[n]);",
          "old_line_content": "            params.buf = mapped->buf;",
          "new_line_content": "        struct dr_buffer *mapped = gl_find_dr_buffer(p, mpi->planes[n]);",
          "content_same": false
        },
        {
          "line": 4119,
          "old_api": null,
          "new_api": "str_equals0",
          "old_text": null,
          "new_text": "str_equals0(param, \"help\"))",
          "old_line_content": "    } else if (!param.len) {",
          "new_line_content": "    if (bstr_equals0(param, \"help\")) {",
          "content_same": false
        },
        {
          "line": 3608,
          "old_api": null,
          "new_api": "P_VERBOSE",
          "old_text": null,
          "new_text": "P_VERBOSE(p, \"DR enabled: %s\\n\", p->using_dr_path ? \"yes\" : \"no\");",
          "old_line_content": "",
          "new_line_content": "            MP_VERBOSE(p, \"DR enabled: %s\\n\", p->using_dr_path ? \"yes\" : \"no\");",
          "content_same": false
        },
        {
          "line": 3611,
          "old_api": null,
          "new_api": "tex_upload",
          "old_text": null,
          "new_text": "->ra->fns->tex_upload(p->ra, &params))",
          "old_line_content": "            goto error;",
          "new_line_content": "        if (!p->ra->fns->tex_upload(p->ra, &params)) {",
          "content_same": false
        },
        {
          "line": 4124,
          "old_api": null,
          "new_api": "STR_P",
          "old_text": null,
          "new_text": "STR_P(param))",
          "old_line_content": "        if (!window)",
          "new_line_content": "        snprintf(s, sizeof(s), \"%.*s\", BSTR_P(param));",
          "content_same": false
        },
        {
          "line": 4125,
          "old_api": null,
          "new_api": "p_find_filter_window",
          "old_text": null,
          "new_text": "p_find_filter_window(s);",
          "old_line_content": "            r = M_OPT_INVALID;",
          "new_line_content": "        const struct filter_window *window = mp_find_filter_window(s);",
          "content_same": false
        },
        {
          "line": 3612,
          "old_api": null,
          "new_api": "imer_pool_stop",
          "old_text": null,
          "new_text": "imer_pool_stop(p->upload_timer);",
          "old_line_content": "        }",
          "new_line_content": "            timer_pool_stop(p->upload_timer);",
          "content_same": false
        },
        {
          "line": 3619,
          "old_api": null,
          "new_api": "imer_pool_stop",
          "old_text": null,
          "new_text": "imer_pool_stop(p->upload_timer);",
          "old_line_content": "    bool using_pbo = p->ra->use_pbo || !(p->ra->caps & RA_CAP_DIRECT_UPLOAD);",
          "new_line_content": "    timer_pool_stop(p->upload_timer);",
          "content_same": false
        },
        {
          "line": 4134,
          "old_api": null,
          "new_api": "p_fatal",
          "old_text": null,
          "new_text": "p_fatal(log, \"No window named '%s' found!\\n\", s);",
          "old_line_content": "    return r;",
          "new_line_content": "            mp_fatal(log, \"No window named '%s' found!\\n\", s);",
          "content_same": false
        },
        {
          "line": 3623,
          "old_api": null,
          "new_api": "ass_describe",
          "old_text": null,
          "new_text": "ass_describe(p, \"upload frame (%s)\", mode);",
          "old_line_content": "",
          "new_line_content": "    pass_describe(p, \"upload frame (%s)\", mode);",
          "content_same": false
        },
        {
          "line": 3624,
          "old_api": null,
          "new_api": "imer_pool_measure",
          "old_text": null,
          "new_text": "imer_pool_measure(p->upload_timer))",
          "old_line_content": "    return true;",
          "new_line_content": "    pass_record(p, timer_pool_measure(p->upload_timer));",
          "content_same": false
        },
        {
          "line": 3629,
          "old_api": null,
          "new_api": "nref_current_image",
          "old_text": null,
          "new_text": "nref_current_image(p);",
          "old_line_content": "    return false;",
          "new_line_content": "    unref_current_image(p);",
          "content_same": false
        },
        {
          "line": 4144,
          "old_api": null,
          "new_api": "str_equals0",
          "old_text": null,
          "new_text": "str_equals0(param, \"help\"))",
          "old_line_content": "    } else {",
          "new_line_content": "    if (bstr_equals0(param, \"help\")) {",
          "content_same": false
        },
        {
          "line": 4147,
          "old_api": null,
          "new_api": "STR_P",
          "old_text": null,
          "new_text": "STR_P(param))",
          "old_line_content": "        if (!k)",
          "new_line_content": "        snprintf(s, sizeof(s), \"%.*s\", BSTR_P(param));",
          "content_same": false
        },
        {
          "line": 4148,
          "old_api": null,
          "new_api": "p_find_error_diffusion_kernel",
          "old_text": null,
          "new_text": "p_find_error_diffusion_kernel(s);",
          "old_line_content": "            r = M_OPT_INVALID;",
          "new_line_content": "        const struct error_diffusion_kernel *k = mp_find_error_diffusion_kernel(s);",
          "content_same": false
        },
        {
          "line": 3638,
          "old_api": null,
          "new_api": "a_tex_resize",
          "old_text": null,
          "new_text": "a_tex_resize(p->ra, p->log, &tex, 16, 16, fmt);",
          "old_line_content": "    return success;",
          "new_line_content": "    bool success = ra_tex_resize(p->ra, p->log, &tex, 16, 16, fmt);",
          "content_same": false
        },
        {
          "line": 3639,
          "old_api": null,
          "new_api": "a_tex_free",
          "old_text": null,
          "new_text": "a_tex_free(p->ra, &tex);",
          "old_line_content": "}",
          "new_line_content": "    ra_tex_free(p->ra, &tex);",
          "content_same": false
        },
        {
          "line": 4157,
          "old_api": null,
          "new_api": "p_fatal",
          "old_text": null,
          "new_text": "p_fatal(log, \"No error diffusion kernel named '%s' found!\\n\", s);",
          "old_line_content": "    return r;",
          "new_line_content": "            mp_fatal(log, \"No error diffusion kernel named '%s' found!\\n\", s);",
          "content_same": false
        },
        {
          "line": 4167,
          "old_api": null,
          "new_api": "og10",
          "old_text": null,
          "new_text": "og10(lmin))",
          "old_line_content": "    float result = num / den + rmin;",
          "new_line_content": "    float num = (rmax - rmin) * (log10(lux) - log10(lmin));",
          "content_same": false
        },
        {
          "line": 4168,
          "old_api": null,
          "new_api": "og10",
          "old_text": null,
          "new_text": "og10(lmin);",
          "old_line_content": "",
          "new_line_content": "    float den = log10(lmax) - log10(lmin);",
          "content_same": false
        },
        {
          "line": 4173,
          "old_api": null,
          "new_api": "PMIN",
          "old_text": null,
          "new_text": "PMIN(rmax, rmin);",
          "old_line_content": "}",
          "new_line_content": "    float min = MPMIN(rmax, rmin);",
          "content_same": false
        },
        {
          "line": 4174,
          "old_api": null,
          "new_api": "PMIN",
          "old_text": null,
          "new_text": "PMIN(result, max),",
          "old_line_content": "",
          "new_line_content": "    return MPMAX(MPMIN(result, max), min);",
          "content_same": false
        },
        {
          "line": 3664,
          "old_api": null,
          "new_api": "trcmp",
          "old_text": null,
          "new_text": "trcmp(name, \"bilinear\") ",
          "old_line_content": "        }",
          "new_line_content": "            if (name && strcmp(name, \"bilinear\") != 0)",
          "content_same": false
        },
        {
          "line": 4180,
          "old_api": null,
          "new_api": "l_video_scale_ambient_lux",
          "old_text": null,
          "new_text": "l_video_scale_ambient_lux(16.0, 256.0, 1.0, 1.2, lux);",
          "old_line_content": "                 p->opts.gamma);",
          "new_line_content": "        p->opts.gamma = gl_video_scale_ambient_lux(16.0, 256.0, 1.0, 1.2, lux);",
          "content_same": false
        },
        {
          "line": 4181,
          "old_api": null,
          "new_api": "P_TRACE",
          "old_text": null,
          "new_text": "P_TRACE(p, \"ambient light changed: %d lux (gamma: %f)\\n\", lux,\n                 p->opts.gamma);",
          "old_line_content": "    }",
          "new_line_content": "        MP_TRACE(p, \"ambient light changed: %d lux (gamma: %f)\\n\", lux,",
          "content_same": false
        },
        {
          "line": 3679,
          "old_api": null,
          "new_api": "a_find_unorm_format",
          "old_text": null,
          "new_text": "a_find_unorm_format(p->ra, 1, 2);",
          "old_line_content": "    bool have_compute = ra->caps & RA_CAP_COMPUTE;",
          "new_line_content": "    const struct ra_format *rg_tex = ra_find_unorm_format(p->ra, 1, 2);",
          "content_same": false
        },
        {
          "line": 4194,
          "old_api": null,
          "new_api": "a_buf_create",
          "old_text": null,
          "new_text": "a_buf_create(p->ra, &params);",
          "old_line_content": "        return NULL;",
          "new_line_content": "    struct ra_buf *buf = ra_buf_create(p->ra, &params);",
          "content_same": false
        },
        {
          "line": 4198,
          "old_api": null,
          "new_api": "P_TARRAY_GROW",
          "old_text": null,
          "new_text": "P_TARRAY_GROW(p, p->dr_buffers, p->num_dr_buffers);",
          "old_line_content": "",
          "new_line_content": "    MP_TARRAY_GROW(p, p->dr_buffers, p->num_dr_buffers);",
          "content_same": false
        },
        {
          "line": 3688,
          "old_api": null,
          "new_api": "trcmp",
          "old_text": null,
          "new_text": "trcmp(user_fbo_fmts[0], \"auto\")\n",
          "old_line_content": "    bool user_specified_fbo_fmt = fbo_fmts == user_fbo_fmts;",
          "new_line_content": "    const char **fbo_fmts = user_fbo_fmts[0] && strcmp(user_fbo_fmts[0], \"auto\")",
          "content_same": false
        },
        {
          "line": 4212,
          "old_api": null,
          "new_api": "a_buf_free",
          "old_text": null,
          "new_text": "a_buf_free(p->ra, &buffer->buf);",
          "old_line_content": "            return;",
          "new_line_content": "            ra_buf_free(p->ra, &buffer->buf);",
          "content_same": false
        },
        {
          "line": 4213,
          "old_api": null,
          "new_api": "P_TARRAY_REMOVE_AT",
          "old_text": null,
          "new_text": "P_TARRAY_REMOVE_AT(p->dr_buffers, p->num_dr_buffers, n);",
          "old_line_content": "        }",
          "new_line_content": "            MP_TARRAY_REMOVE_AT(p->dr_buffers, p->num_dr_buffers, n);",
          "content_same": false
        },
        {
          "line": 3700,
          "old_api": null,
          "new_api": "est_fbo",
          "old_text": null,
          "new_text": "est_fbo(p, f))",
          "old_line_content": "            have_fbo = true;",
          "new_line_content": "            (fbo_test_result = test_fbo(p, f))) {",
          "content_same": false
        },
        {
          "line": 3701,
          "old_api": null,
          "new_api": "P_VERBOSE",
          "old_text": null,
          "new_text": "P_VERBOSE(p, \"Using FBO format %s.\\n\", f->name);",
          "old_line_content": "            p->fbo_format = f;",
          "new_line_content": "            MP_VERBOSE(p, \"Using FBO format %s.\\n\", f->name);",
          "content_same": false
        },
        {
          "line": 4218,
          "old_api": null,
          "new_api": "ssert",
          "old_text": null,
          "new_text": "ssert(0);",
          "old_line_content": "",
          "new_line_content": "    assert(0);",
          "content_same": false
        },
        {
          "line": 3708,
          "old_api": null,
          "new_api": "P_WARN",
          "old_text": null,
          "new_text": "P_WARN(p, \"User-specified FBO format '%s' failed to initialize! \"\n                       \"(exists=%d, renderable=%d, linear_filter=%d, \"\n                       \"fbo_test_result=%d)\\n\",\n                    fmt, !!f, f ? f->renderable : 0,  f ? f->linear_filter : 0,\n                    fbo_test_result);",
          "old_line_content": "                       \"fbo_test_result=%d)\\n\",",
          "new_line_content": "            MP_WARN(p, \"User-specified FBO format '%s' failed to initialize! \"",
          "content_same": false
        },
        {
          "line": 4224,
          "old_api": null,
          "new_api": "l_video_check_format",
          "old_text": null,
          "new_text": "l_video_check_format(p, imgfmt))",
          "old_line_content": "",
          "new_line_content": "    if (!gl_video_check_format(p, imgfmt))",
          "content_same": false
        },
        {
          "line": 4227,
          "old_api": null,
          "new_api": "p_image_get_alloc_size",
          "old_text": null,
          "new_text": "p_image_get_alloc_size(imgfmt, w, h, stride_align);",
          "old_line_content": "        return NULL;",
          "new_line_content": "    int size = mp_image_get_alloc_size(imgfmt, w, h, stride_align);",
          "content_same": false
        },
        {
          "line": 4232,
          "old_api": null,
          "new_api": "l_video_dr_alloc_buffer",
          "old_text": null,
          "new_text": "l_video_dr_alloc_buffer(p, alloc_size);",
          "old_line_content": "        return NULL;",
          "new_line_content": "    void *ptr = gl_video_dr_alloc_buffer(p, alloc_size);",
          "content_same": false
        },
        {
          "line": 3720,
          "old_api": null,
          "new_api": "P_WARN",
          "old_text": null,
          "new_text": "P_WARN(p, \"Disabling dithering (no gl_FragCoord).\\n\");",
          "old_line_content": "    if (!have_fragcoord && p->opts.alpha_mode == ALPHA_BLEND_TILES) {",
          "new_line_content": "        MP_WARN(p, \"Disabling dithering (no gl_FragCoord).\\n\");",
          "content_same": false
        },
        {
          "line": 3725,
          "old_api": null,
          "new_api": "P_VERBOSE",
          "old_text": null,
          "new_text": "P_VERBOSE(p, \"Disabling alpha checkerboard (no gl_FragCoord).\\n\");",
          "old_line_content": "    if (!have_fbo && have_compute) {",
          "new_line_content": "        MP_VERBOSE(p, \"Disabling alpha checkerboard (no gl_FragCoord).\\n\");",
          "content_same": false
        },
        {
          "line": 4238,
          "old_api": null,
          "new_api": "p_image_from_buffer",
          "old_text": null,
          "new_text": "p_image_from_buffer(imgfmt, w, h, stride_align,\n                                                ptr, alloc_size, p,\n                                                gl_video_dr_free_buffer);",
          "old_line_content": "                                                gl_video_dr_free_buffer);",
          "new_line_content": "    struct mp_image *res = mp_image_from_buffer(imgfmt, w, h, stride_align,",
          "content_same": false
        },
        {
          "line": 3729,
          "old_api": null,
          "new_api": "P_WARN",
          "old_text": null,
          "new_text": "P_WARN(p, \"Force-disabling compute shaders as an FBO format was not \"\n                   \"available! See your FBO format configuration!\\n\");",
          "old_line_content": "    }",
          "new_line_content": "        MP_WARN(p, \"Force-disabling compute shaders as an FBO format was not \"",
          "content_same": false
        },
        {
          "line": 4242,
          "old_api": null,
          "new_api": "l_video_dr_free_buffer",
          "old_text": null,
          "new_text": "l_video_dr_free_buffer(p, ptr);",
          "old_line_content": "}",
          "new_line_content": "        gl_video_dr_free_buffer(p, ptr);",
          "content_same": false
        },
        {
          "line": 3735,
          "old_api": null,
          "new_api": "P_WARN",
          "old_text": null,
          "new_text": "P_WARN(p, \"Force-disabling compute shaders as the chosen FBO format \"\n                \"is not storable! See your FBO format configuration!\\n\");",
          "old_line_content": "    }",
          "new_line_content": "        MP_WARN(p, \"Force-disabling compute shaders as the chosen FBO format \"",
          "content_same": false
        },
        {
          "line": 4252,
          "old_api": null,
          "new_api": "P_TARRAY_APPEND",
          "old_text": null,
          "new_text": "P_TARRAY_APPEND(p, p->hwdecs, p->num_hwdecs, hwdec);",
          "old_line_content": "",
          "new_line_content": "        MP_TARRAY_APPEND(p, p->hwdecs, p->num_hwdecs, hwdec);",
          "content_same": false
        },
        {
          "line": 3740,
          "old_api": null,
          "new_api": "P_WARN",
          "old_text": null,
          "new_text": "P_WARN(p, \"Disabling error diffusion dithering because compute shader \"\n                   \"was not supported. Fallback to dither=fruit instead.\\n\");",
          "old_line_content": "        p->opts.dither_algo = DITHER_FRUIT;",
          "new_line_content": "        MP_WARN(p, \"Disabling error diffusion dithering because compute shader \"",
          "content_same": false
        },
        {
          "line": 4259,
          "old_api": null,
          "new_api": "trcmp",
          "old_text": null,
          "new_text": "trcmp(type, \"auto\") ",
          "old_line_content": "            return;",
          "new_line_content": "    if (!type || !type[0] || strcmp(type, \"auto\") == 0) {",
          "content_same": false
        },
        {
          "line": 3748,
          "old_api": null,
          "new_api": "P_MSG",
          "old_text": null,
          "new_text": "P_MSG(p, msgl, \"Disabling HDR peak computation (one or more of the \"\n                        \"following is not supported: compute shaders=%d, \"\n                        \"SSBO=%d).\\n\", have_compute, have_ssbo);",
          "old_line_content": "                        \"SSBO=%d).\\n\", have_compute, have_ssbo);",
          "new_line_content": "        MP_MSG(p, msgl, \"Disabling HDR peak computation (one or more of the \"",
          "content_same": false
        },
        {
          "line": 4266,
          "old_api": null,
          "new_api": "trcmp",
          "old_text": null,
          "new_text": "trcmp(type, \"all\") ",
          "old_line_content": "    } else {",
          "new_line_content": "    } else if (strcmp(type, \"all\") == 0) {",
          "content_same": false
        },
        {
          "line": 4267,
          "old_api": null,
          "new_api": "l_video_load_hwdecs_all",
          "old_text": null,
          "new_text": "l_video_load_hwdecs_all(p, devs);",
          "old_line_content": "        for (int n = 0; ra_hwdec_drivers[n]; n++) {",
          "new_line_content": "        gl_video_load_hwdecs_all(p, devs);",
          "content_same": false
        },
        {
          "line": 3755,
          "old_api": null,
          "new_api": "heck_dumb_mode",
          "old_text": null,
          "new_text": "heck_dumb_mode(p);",
          "old_line_content": "        if (voluntarily_dumb) {",
          "new_line_content": "    bool voluntarily_dumb = check_dumb_mode(p);",
          "content_same": false
        },
        {
          "line": 4271,
          "old_api": null,
          "new_api": "trcmp",
          "old_text": null,
          "new_text": "trcmp(type, drv->name) ",
          "old_line_content": "                break;",
          "new_line_content": "            if (strcmp(type, drv->name) == 0) {",
          "content_same": false
        },
        {
          "line": 4272,
          "old_api": null,
          "new_api": "oad_add_hwdec",
          "old_text": null,
          "new_text": "oad_add_hwdec(p, devs, drv, false);",
          "old_line_content": "            }",
          "new_line_content": "                load_add_hwdec(p, devs, drv, false);",
          "content_same": false
        },
        {
          "line": 3249,
          "old_api": null,
          "new_api": "p_rect_equals",
          "old_text": null,
          "new_text": "p_rect_equals(&p->dst_rect, &target_rc))",
          "old_line_content": "    struct m_color c = p->clear_color;",
          "new_line_content": "    if (!has_frame || !mp_rect_equals(&p->dst_rect, &target_rc)) {",
          "content_same": false
        },
        {
          "line": 3760,
          "old_api": null,
          "new_api": "P_WARN",
          "old_text": null,
          "new_text": "P_WARN(p, \"High bit depth FBOs unsupported. Enabling dumb mode.\\n\"\n                       \"Most extended features will be disabled.\\n\");",
          "old_line_content": "        }",
          "new_line_content": "            MP_WARN(p, \"High bit depth FBOs unsupported. Enabling dumb mode.\\n\"",
          "content_same": false
        },
        {
          "line": 3252,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "->ra->fns->clear(p->ra, fbo.tex, clear_color, &target_rc);",
          "old_line_content": "",
          "new_line_content": "        p->ra->fns->clear(p->ra, fbo.tex, clear_color, &target_rc);",
          "content_same": false
        },
        {
          "line": 3258,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "->ra->fns->clear(p->ra, fbo.tex, color, &p->dst_rect);",
          "old_line_content": "",
          "new_line_content": "            p->ra->fns->clear(p->ra, fbo.tex, color, &p->dst_rect);",
          "content_same": false
        },
        {
          "line": 4284,
          "old_api": null,
          "new_api": "oad_add_hwdec",
          "old_text": null,
          "new_text": "oad_add_hwdec(p, devs, ra_hwdec_drivers[n], true);",
          "old_line_content": "    }",
          "new_line_content": "            load_add_hwdec(p, devs, ra_hwdec_drivers[n], true);",
          "content_same": false
        },
        {
          "line": 3261,
          "old_api": null,
          "new_api": "overlay_frame",
          "old_text": null,
          "new_text": "->hwdec_overlay->driver->overlay_frame(p->hwdec_overlay, frame->current,\n                                                &p->src_rect, &p->dst_rect,\n                                                frame->frame_id != p->image.id);",
          "old_line_content": "                                                frame->frame_id != p->image.id);",
          "new_line_content": "        p->hwdec_overlay->driver->overlay_frame(p->hwdec_overlay, frame->current,",
          "content_same": false
        },
        {
          "line": 3277,
          "old_api": null,
          "new_api": "abs",
          "old_text": null,
          "new_text": "abs(ratio - 1.0) ",
          "old_line_content": "        }",
          "new_line_content": "            if (fabs(ratio - 1.0) < p->opts.interpolation_threshold)",
          "content_same": false
        },
        {
          "line": 3282,
          "old_api": null,
          "new_api": "l_video_interpolate_frame",
          "old_text": null,
          "new_text": "l_video_interpolate_frame(p, frame, fbo, flags);",
          "old_line_content": "            bool is_new = frame->frame_id != p->image.id;",
          "new_line_content": "            gl_video_interpolate_frame(p, frame, fbo, flags);",
          "content_same": false
        },
        {
          "line": 3803,
          "old_api": null,
          "new_api": "p_find_filter_kernel",
          "old_text": null,
          "new_text": "p_find_filter_kernel(p->opts.scaler[n].kernel.name);",
          "old_line_content": "            char *reason = NULL;",
          "new_line_content": "            mp_find_filter_kernel(p->opts.scaler[n].kernel.name);",
          "content_same": false
        },
        {
          "line": 3293,
          "old_api": null,
          "new_api": "ass_info_reset",
          "old_text": null,
          "new_text": "ass_info_reset(p, !is_new);",
          "old_line_content": "                    goto done;",
          "new_line_content": "                pass_info_reset(p, !is_new);",
          "content_same": false
        },
        {
          "line": 3294,
          "old_api": null,
          "new_api": "ass_render_frame",
          "old_text": null,
          "new_text": "ass_render_frame(p, frame->current, frame->frame_id, flags))",
          "old_line_content": "",
          "new_line_content": "                if (!pass_render_frame(p, frame->current, frame->frame_id, flags))",
          "content_same": false
        },
        {
          "line": 3811,
          "old_api": null,
          "new_api": "P_WARN",
          "old_text": null,
          "new_text": "P_WARN(p, \"Disabling scaler #%d %s %s.\\n\", n,\n                        p->opts.scaler[n].kernel.name, reason);",
          "old_line_content": "                // p->opts is a copy => we can just mess with it.",
          "new_line_content": "                MP_WARN(p, \"Disabling scaler #%d %s %s.\\n\", n,",
          "content_same": false
        },
        {
          "line": 3311,
          "old_api": null,
          "new_api": "a_tex_resize",
          "old_text": null,
          "new_text": "a_tex_resize(p->ra, p->log, &p->output_tex,\n                                           fbo.tex->params.w, fbo.tex->params.h,\n                                           fmt);",
          "old_line_content": "                                           fmt);",
          "new_line_content": "                    bool r = ra_tex_resize(p->ra, p->log, &p->output_tex,",
          "content_same": false
        },
        {
          "line": 3319,
          "old_api": null,
          "new_api": "ass_draw_to_screen",
          "old_text": null,
          "new_text": "ass_draw_to_screen(p, dest_fbo);",
          "old_line_content": "",
          "new_line_content": "                pass_draw_to_screen(p, dest_fbo);",
          "content_same": false
        },
        {
          "line": 3831,
          "old_api": null,
          "new_api": "P_WARN",
          "old_text": null,
          "new_text": "P_WARN(p, \"Disabling linear/sigmoid scaling (GLSL version too old).\\n\");",
          "old_line_content": "    if (!have_mglsl && use_cms) {",
          "new_line_content": "        MP_WARN(p, \"Disabling linear/sigmoid scaling (GLSL version too old).\\n\");",
          "content_same": false
        },
        {
          "line": 3324,
          "old_api": null,
          "new_api": "ass_info_reset",
          "old_text": null,
          "new_text": "ass_info_reset(p, true);",
          "old_line_content": "                struct mp_rect src = p->dst_rect;",
          "new_line_content": "                pass_info_reset(p, true);",
          "content_same": false
        },
        {
          "line": 3325,
          "old_api": null,
          "new_api": "ass_describe",
          "old_text": null,
          "new_text": "ass_describe(p, \"redraw cached frame\");",
          "old_line_content": "                struct mp_rect dst = src;",
          "new_line_content": "                pass_describe(p, \"redraw cached frame\");",
          "content_same": false
        },
        {
          "line": 3837,
          "old_api": null,
          "new_api": "P_WARN",
          "old_text": null,
          "new_text": "P_WARN(p, \"Disabling color management (GLSL version too old).\\n\");",
          "old_line_content": "    if (!have_mglsl && p->opts.deband) {",
          "new_line_content": "        MP_WARN(p, \"Disabling color management (GLSL version too old).\\n\");",
          "content_same": false
        },
        {
          "line": 3841,
          "old_api": null,
          "new_api": "P_WARN",
          "old_text": null,
          "new_text": "P_WARN(p, \"Disabling debanding (GLSL version too old).\\n\");",
          "old_line_content": "}",
          "new_line_content": "        MP_WARN(p, \"Disabling debanding (GLSL version too old).\\n\");",
          "content_same": false
        },
        {
          "line": 3334,
          "old_api": null,
          "new_api": "imer_pool_stop",
          "old_text": null,
          "new_text": "imer_pool_stop(p->blit_timer);",
          "old_line_content": "            }",
          "new_line_content": "                timer_pool_stop(p->blit_timer);",
          "content_same": false
        },
        {
          "line": 3335,
          "old_api": null,
          "new_api": "imer_pool_measure",
          "old_text": null,
          "new_text": "imer_pool_measure(p->blit_timer))",
          "old_line_content": "        }",
          "new_line_content": "                pass_record(p, timer_pool_measure(p->blit_timer));",
          "content_same": false
        },
        {
          "line": 3850,
          "old_api": null,
          "new_api": "imer_pool_create",
          "old_text": null,
          "new_text": "imer_pool_create(p->ra);",
          "old_line_content": "",
          "new_line_content": "    p->blit_timer = timer_pool_create(p->ra);",
          "content_same": false
        },
        {
          "line": 3342,
          "old_api": null,
          "new_api": "ebug_check_gl",
          "old_text": null,
          "new_text": "ebug_check_gl(p, \"after video rendering\");",
          "old_line_content": "    if (p->osd && (flags & (RENDER_FRAME_SUBS | RENDER_FRAME_OSD))) {",
          "new_line_content": "    debug_check_gl(p, \"after video rendering\");",
          "content_same": false
        },
        {
          "line": 3855,
          "old_api": null,
          "new_api": "a_dump_tex_formats",
          "old_text": null,
          "new_text": "a_dump_tex_formats(p->ra, MSGL_DEBUG);",
          "old_line_content": "}",
          "new_line_content": "    ra_dump_tex_formats(p->ra, MSGL_DEBUG);",
          "content_same": false
        },
        {
          "line": 3856,
          "old_api": null,
          "new_api": "a_dump_img_formats",
          "old_text": null,
          "new_text": "a_dump_img_formats(p->ra, MSGL_DEBUG);",
          "old_line_content": "",
          "new_line_content": "    ra_dump_img_formats(p->ra, MSGL_DEBUG);",
          "content_same": false
        },
        {
          "line": 3349,
          "old_api": null,
          "new_api": "ass_info_reset",
          "old_text": null,
          "new_text": "ass_info_reset(p, true);",
          "old_line_content": "        int osd_flags = p->opts.blend_subs ? OSD_DRAW_OSD_ONLY : 0;",
          "new_line_content": "            pass_info_reset(p, true);",
          "content_same": false
        },
        {
          "line": 3864,
          "old_api": null,
          "new_api": "ninit_video",
          "old_text": null,
          "new_text": "ninit_video(p);",
          "old_line_content": "    for (int n = 0; n < p->num_hwdecs; n++)",
          "new_line_content": "    uninit_video(p);",
          "content_same": false
        },
        {
          "line": 3867,
          "old_api": null,
          "new_api": "a_hwdec_uninit",
          "old_text": null,
          "new_text": "a_hwdec_uninit(p->hwdecs[n]);",
          "old_line_content": "",
          "new_line_content": "        ra_hwdec_uninit(p->hwdecs[n]);",
          "content_same": false
        },
        {
          "line": 3357,
          "old_api": null,
          "new_api": "ass_draw_osd",
          "old_text": null,
          "new_text": "ass_draw_osd(p, osd_flags, flags, p->osd_pts, p->osd_rect, fbo, true);",
          "old_line_content": "    }",
          "new_line_content": "        pass_draw_osd(p, osd_flags, flags, p->osd_pts, p->osd_rect, fbo, true);",
          "content_same": false
        },
        {
          "line": 3358,
          "old_api": null,
          "new_api": "ebug_check_gl",
          "old_text": null,
          "new_text": "ebug_check_gl(p, \"after OSD rendering\");",
          "old_line_content": "",
          "new_line_content": "        debug_check_gl(p, \"after OSD rendering\");",
          "content_same": false
        },
        {
          "line": 3872,
          "old_api": null,
          "new_api": "a_tex_free",
          "old_text": null,
          "new_text": "a_tex_free(p->ra, &p->lut_3d_texture);",
          "old_line_content": "",
          "new_line_content": "    ra_tex_free(p->ra, &p->lut_3d_texture);",
          "content_same": false
        },
        {
          "line": 3361,
          "old_api": null,
          "new_api": "l_sc_error_state",
          "old_text": null,
          "new_text": "l_sc_error_state(p->sc);",
          "old_line_content": "        // Make the screen solid blue to make it visually clear that an",
          "new_line_content": "    p->broken_frame |= gl_sc_error_state(p->sc);",
          "content_same": false
        },
        {
          "line": 3876,
          "old_api": null,
          "new_api": "imer_pool_destroy",
          "old_text": null,
          "new_text": "imer_pool_destroy(p->blit_timer);",
          "old_line_content": "",
          "new_line_content": "    timer_pool_destroy(p->blit_timer);",
          "content_same": false
        },
        {
          "line": 3877,
          "old_api": null,
          "new_api": "imer_pool_destroy",
          "old_text": null,
          "new_text": "imer_pool_destroy(p->osd_timer);",
          "old_line_content": "    for (int i = 0; i < VO_PASS_PERF_MAX; i++) {",
          "new_line_content": "    timer_pool_destroy(p->osd_timer);",
          "content_same": false
        },
        {
          "line": 3366,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "->ra->fns->clear(p->ra, fbo.tex, color, &target_rc);",
          "old_line_content": "",
          "new_line_content": "        p->ra->fns->clear(p->ra, fbo.tex, color, &target_rc);",
          "content_same": false
        },
        {
          "line": 3880,
          "old_api": null,
          "new_api": "alloc_free",
          "old_text": null,
          "new_text": "alloc_free(p->pass_fresh[i].desc.start);",
          "old_line_content": "    }",
          "new_line_content": "        talloc_free(p->pass_fresh[i].desc.start);",
          "content_same": false
        },
        {
          "line": 3881,
          "old_api": null,
          "new_api": "alloc_free",
          "old_text": null,
          "new_text": "alloc_free(p->pass_redraw[i].desc.start);",
          "old_line_content": "",
          "new_line_content": "        talloc_free(p->pass_redraw[i].desc.start);",
          "content_same": false
        },
        {
          "line": 3370,
          "old_api": null,
          "new_api": "ass_report_performance",
          "old_text": null,
          "new_text": "ass_report_performance(p);",
          "old_line_content": "",
          "new_line_content": "    pass_report_performance(p);",
          "content_same": false
        },
        {
          "line": 3884,
          "old_api": null,
          "new_api": "pgl_osd_destroy",
          "old_text": null,
          "new_text": "pgl_osd_destroy(p->osd);",
          "old_line_content": "    // Forcibly destroy possibly remaining image references. This should also",
          "new_line_content": "    mpgl_osd_destroy(p->osd);",
          "content_same": false
        },
        {
          "line": 3888,
          "old_api": null,
          "new_api": "c_pending_dr_fences",
          "old_text": null,
          "new_text": "c_pending_dr_fences(p, true);",
          "old_line_content": "    // Should all have been unreffed already.",
          "new_line_content": "    gc_pending_dr_fences(p, true);",
          "content_same": false
        },
        {
          "line": 3893,
          "old_api": null,
          "new_api": "alloc_free",
          "old_text": null,
          "new_text": "alloc_free(p);",
          "old_line_content": "",
          "new_line_content": "    talloc_free(p);",
          "content_same": false
        },
        {
          "line": 3385,
          "old_api": null,
          "new_api": "o_frame_ref",
          "old_text": null,
          "new_text": "o_frame_ref(frame);",
          "old_line_content": "    // Disable interpolation and such.",
          "new_line_content": "    struct vo_frame *nframe = vo_frame_ref(frame);",
          "content_same": false
        },
        {
          "line": 3898,
          "old_api": null,
          "new_api": "l_video_reset_surfaces",
          "old_text": null,
          "new_text": "l_video_reset_surfaces(p);",
          "old_line_content": "",
          "new_line_content": "    gl_video_reset_surfaces(p);",
          "content_same": false
        },
        {
          "line": 3396,
          "old_api": null,
          "new_api": "p_image_params_get_dsize",
          "old_text": null,
          "new_text": "p_image_params_get_dsize(&p->image_params, &w, &h);",
          "old_line_content": "            return;",
          "new_line_content": "        mp_image_params_get_dsize(&p->image_params, &w, &h);",
          "content_same": false
        },
        {
          "line": 3921,
          "old_api": null,
          "new_api": "a_get_imgfmt_desc",
          "old_text": null,
          "new_text": "a_get_imgfmt_desc(p->ra, mp_format, &desc) ",
          "old_line_content": "        return true;",
          "new_line_content": "    if (ra_get_imgfmt_desc(p->ra, mp_format, &desc) &&",
          "content_same": false
        },
        {
          "line": 3410,
          "old_api": null,
          "new_api": "l_video_resize",
          "old_text": null,
          "new_text": "l_video_resize(p, &src, &dst, &osd);",
          "old_line_content": "",
          "new_line_content": "        gl_video_resize(p, &src, &dst, &osd);",
          "content_same": false
        },
        {
          "line": 3922,
          "old_api": null,
          "new_api": "s_imgfmt_desc_supported",
          "old_text": null,
          "new_text": "s_imgfmt_desc_supported(p, &desc))",
          "old_line_content": "    for (int n = 0; n < p->num_hwdecs; n++) {",
          "new_line_content": "        is_imgfmt_desc_supported(p, &desc))",
          "content_same": false
        },
        {
          "line": 3413,
          "old_api": null,
          "new_api": "l_video_reset_surfaces",
          "old_text": null,
          "new_text": "l_video_reset_surfaces(p);",
          "old_line_content": "    struct ra_tex_params params = {",
          "new_line_content": "    gl_video_reset_surfaces(p);",
          "content_same": false
        },
        {
          "line": 3925,
          "old_api": null,
          "new_api": "a_hwdec_test_format",
          "old_text": null,
          "new_text": "a_hwdec_test_format(p->hwdecs[n], mp_format))",
          "old_line_content": "    }",
          "new_line_content": "        if (ra_hwdec_test_format(p->hwdecs[n], mp_format))",
          "content_same": false
        },
        {
          "line": 3933,
          "old_api": null,
          "new_api": "nmap_overlay",
          "old_text": null,
          "new_text": "nmap_overlay(p);",
          "old_line_content": "",
          "new_line_content": "    unmap_overlay(p);",
          "content_same": false
        },
        {
          "line": 3423,
          "old_api": null,
          "new_api": "a_find_unorm_format",
          "old_text": null,
          "new_text": "a_find_unorm_format(p->ra, 1, 4);",
          "old_line_content": "    if (args->high_bit_depth && p->ra_format.component_bits > 8) {",
          "new_line_content": "    params.format = ra_find_unorm_format(p->ra, 1, 4);",
          "content_same": false
        },
        {
          "line": 3936,
          "old_api": null,
          "new_api": "p_image_params_equal",
          "old_text": null,
          "new_text": "p_image_params_equal(&p->real_image_params, params))",
          "old_line_content": "        p->real_image_params = *params;",
          "new_line_content": "    if (!mp_image_params_equal(&p->real_image_params, params)) {",
          "content_same": false
        },
        {
          "line": 3937,
          "old_api": null,
          "new_api": "ninit_video",
          "old_text": null,
          "new_text": "ninit_video(p);",
          "old_line_content": "        p->image_params = *params;",
          "new_line_content": "        uninit_video(p);",
          "content_same": false
        },
        {
          "line": 3426,
          "old_api": null,
          "new_api": "a_find_unorm_format",
          "old_text": null,
          "new_text": "a_find_unorm_format(p->ra, 2, 4);",
          "old_line_content": "            params.format = fmt;",
          "new_line_content": "        const struct ra_format *fmt = ra_find_unorm_format(p->ra, 2, 4);",
          "content_same": false
        },
        {
          "line": 3941,
          "old_api": null,
          "new_api": "nit_video",
          "old_text": null,
          "new_text": "nit_video(p);",
          "old_line_content": "",
          "new_line_content": "            init_video(p);",
          "content_same": false
        },
        {
          "line": 3944,
          "old_api": null,
          "new_api": "l_video_reset_surfaces",
          "old_text": null,
          "new_text": "l_video_reset_surfaces(p);",
          "old_line_content": "",
          "new_line_content": "    gl_video_reset_surfaces(p);",
          "content_same": false
        },
        {
          "line": 3435,
          "old_api": null,
          "new_api": "a_tex_create",
          "old_text": null,
          "new_text": "a_tex_create(p->ra, &params);",
          "old_line_content": "        goto done;",
          "new_line_content": "    target = ra_tex_create(p->ra, &params);",
          "content_same": false
        },
        {
          "line": 3949,
          "old_api": null,
          "new_api": "pgl_osd_destroy",
          "old_text": null,
          "new_text": "pgl_osd_destroy(p->osd);",
          "old_line_content": "    p->osd_state = osd;",
          "new_line_content": "    mpgl_osd_destroy(p->osd);",
          "content_same": false
        },
        {
          "line": 3952,
          "old_api": null,
          "new_api": "einit_osd",
          "old_text": null,
          "new_text": "einit_osd(p);",
          "old_line_content": "",
          "new_line_content": "    reinit_osd(p);",
          "content_same": false
        },
        {
          "line": 3446,
          "old_api": null,
          "new_api": "p_image_alloc",
          "old_text": null,
          "new_text": "p_image_alloc(mpfmt, params.w, params.h);",
          "old_line_content": "        goto done;",
          "new_line_content": "    res = mp_image_alloc(mpfmt, params.w, params.h);",
          "content_same": false
        },
        {
          "line": 3958,
          "old_api": null,
          "new_api": "alloc_ptrtype",
          "old_text": null,
          "new_text": "alloc_ptrtype(NULL, p);",
          "old_line_content": "        .ra = ra,",
          "new_line_content": "    struct gl_video *p = talloc_ptrtype(NULL, p);",
          "content_same": false
        },
        {
          "line": 3964,
          "old_api": null,
          "new_api": "p_csp_equalizer_create",
          "old_text": null,
          "new_text": "p_csp_equalizer_create(p, g),",
          "old_line_content": "    };",
          "new_line_content": "        .video_eq = mp_csp_equalizer_create(p, g),",
          "content_same": false
        },
        {
          "line": 3965,
          "old_api": null,
          "new_api": "_config_cache_alloc",
          "old_text": null,
          "new_text": "_config_cache_alloc(p, g, &gl_video_conf),",
          "old_line_content": "    // make sure this variable is initialized to *something*",
          "new_line_content": "        .opts_cache = m_config_cache_alloc(p, g, &gl_video_conf),",
          "content_same": false
        },
        {
          "line": 3455,
          "old_api": null,
          "new_api": "tex_download",
          "old_text": null,
          "new_text": "->ra->fns->tex_download(p->ra, &download_params))",
          "old_line_content": "",
          "new_line_content": "    if (!p->ra->fns->tex_download(p->ra, &download_params))",
          "content_same": false
        },
        {
          "line": 3970,
          "old_api": null,
          "new_api": "l_lcms_init",
          "old_text": null,
          "new_text": "l_lcms_init(p, log, g, opts->icc_opts),",
          "old_line_content": "    for (int n = 0; n < SCALER_COUNT; n++)",
          "new_line_content": "    p->cms = gl_lcms_init(p, log, g, opts->icc_opts),",
          "content_same": false
        },
        {
          "line": 3975,
          "old_api": null,
          "new_api": "P_TARRAY_APPEND",
          "old_text": null,
          "new_text": "P_TARRAY_APPEND(p, p->vao, p->vao_len, (struct ra_renderpass_input) {\n        .name = \"position\",\n        .type = RA_VARTYPE_FLOAT,\n        .dim_v = 2,\n        .dim_m = 1,\n        .offset = 0,\n    });",
          "old_line_content": "        .type = RA_VARTYPE_FLOAT,",
          "new_line_content": "    MP_TARRAY_APPEND(p, p->vao, p->vao_len, (struct ra_renderpass_input) {",
          "content_same": false
        },
        {
          "line": 3465,
          "old_api": null,
          "new_api": "l_video_resize",
          "old_text": null,
          "new_text": "l_video_resize(p, &old_src, &old_dst, &old_osd);",
          "old_line_content": "    if (!ok)",
          "new_line_content": "    gl_video_resize(p, &old_src, &old_dst, &old_osd);",
          "content_same": false
        },
        {
          "line": 3468,
          "old_api": null,
          "new_api": "A_FREEP",
          "old_text": null,
          "new_text": "A_FREEP(&res);",
          "old_line_content": "}",
          "new_line_content": "        TA_FREEP(&res);",
          "content_same": false
        },
        {
          "line": 3982,
          "old_api": null,
          "new_api": "nit_gl",
          "old_text": null,
          "new_text": "nit_gl(p);",
          "old_line_content": "    return p;",
          "new_line_content": "    init_gl(p);",
          "content_same": false
        },
        {
          "line": 3983,
          "old_api": null,
          "new_api": "einit_from_options",
          "old_text": null,
          "new_text": "einit_from_options(p);",
          "old_line_content": "}",
          "new_line_content": "    reinit_from_options(p);",
          "content_same": false
        },
        {
          "line": 3992,
          "old_api": null,
          "new_api": "p_find_filter_kernel",
          "old_text": null,
          "new_text": "p_find_filter_kernel(name);",
          "old_line_content": "                return kernel->f.name;",
          "new_line_content": "        const struct filter_kernel *kernel = mp_find_filter_kernel(name);",
          "content_same": false
        },
        {
          "line": 3487,
          "old_api": null,
          "new_api": "pgl_osd_check_change",
          "old_text": null,
          "new_text": "pgl_osd_check_change(p->osd, res, pts) ",
          "old_line_content": "",
          "new_line_content": "    return p->osd ? mpgl_osd_check_change(p->osd, res, pts) : false;",
          "content_same": false
        },
        {
          "line": 3999,
          "old_api": null,
          "new_api": "trcmp",
          "old_text": null,
          "new_text": "trcmp(*filter, name) ",
          "old_line_content": "        }",
          "new_line_content": "            if (strcmp(*filter, name) == 0)",
          "content_same": false
        },
        {
          "line": 3495,
          "old_api": null,
          "new_api": "p_rect_equals",
          "old_text": null,
          "new_text": "p_rect_equals(&p->dst_rect, dst) ",
          "old_line_content": "        return;",
          "new_line_content": "        mp_rect_equals(&p->dst_rect, dst) &&",
          "content_same": false
        },
        {
          "line": 3496,
          "old_api": null,
          "new_api": "sd_res_equals",
          "old_text": null,
          "new_text": "sd_res_equals(p->osd_rect, *osd))",
          "old_line_content": "",
          "new_line_content": "        osd_res_equals(p->osd_rect, *osd))",
          "content_same": false
        },
        {
          "line": 4009,
          "old_api": null,
          "new_api": "l_lcms_update_options",
          "old_text": null,
          "new_text": "l_lcms_update_options(p->cms);",
          "old_line_content": "    }",
          "new_line_content": "        gl_lcms_update_options(p->cms);",
          "content_same": false
        },
        {
          "line": 4010,
          "old_api": null,
          "new_api": "einit_from_options",
          "old_text": null,
          "new_text": "einit_from_options(p);",
          "old_line_content": "",
          "new_line_content": "        reinit_from_options(p);",
          "content_same": false
        },
        {
          "line": 4013,
          "old_api": null,
          "new_api": "p_csp_equalizer_state_changed",
          "old_text": null,
          "new_text": "p_csp_equalizer_state_changed(p->video_eq))",
          "old_line_content": "}",
          "new_line_content": "    if (mp_csp_equalizer_state_changed(p->video_eq))",
          "content_same": false
        },
        {
          "line": 3503,
          "old_api": null,
          "new_api": "l_video_reset_surfaces",
          "old_text": null,
          "new_text": "l_video_reset_surfaces(p);",
          "old_line_content": "    if (p->osd)",
          "new_line_content": "    gl_video_reset_surfaces(p);",
          "content_same": false
        },
        {
          "line": 3506,
          "old_api": null,
          "new_api": "pgl_osd_resize",
          "old_text": null,
          "new_text": "pgl_osd_resize(p->osd, p->osd_rect, p->image_params.stereo3d);",
          "old_line_content": "",
          "new_line_content": "        mpgl_osd_resize(p->osd, p->osd_rect, p->image_params.stereo3d);",
          "content_same": false
        },
        {
          "line": 4019,
          "old_api": null,
          "new_api": "l_lcms_has_profile",
          "old_text": null,
          "new_text": "l_lcms_has_profile(p->cms);",
          "old_line_content": "    // Copy the option fields, so that check_gl_features() can mutate them.",
          "new_line_content": "    p->use_lut_3d = gl_lcms_has_profile(p->cms);",
          "content_same": false
        },
        {
          "line": 4030,
          "old_api": null,
          "new_api": "ninit_rendering",
          "old_text": null,
          "new_text": "ninit_rendering(p);",
          "old_line_content": "    p->ra->use_pbo = p->opts.pbo;",
          "new_line_content": "    uninit_rendering(p);",
          "content_same": false
        },
        {
          "line": 4033,
          "old_api": null,
          "new_api": "l_video_setup_hooks",
          "old_text": null,
          "new_text": "l_video_setup_hooks(p);",
          "old_line_content": "",
          "new_line_content": "    gl_video_setup_hooks(p);",
          "content_same": false
        },
        {
          "line": 4034,
          "old_api": null,
          "new_api": "einit_osd",
          "old_text": null,
          "new_text": "einit_osd(p);",
          "old_line_content": "    int vs;",
          "new_line_content": "    reinit_osd(p);",
          "content_same": false
        },
        {
          "line": 3523,
          "old_api": null,
          "new_api": "rame_perf_data",
          "old_text": null,
          "new_text": "rame_perf_data(p->pass_fresh,  &out->fresh);",
          "old_line_content": "}",
          "new_line_content": "    frame_perf_data(p->pass_fresh,  &out->fresh);",
          "content_same": false
        },
        {
          "line": 3524,
          "old_api": null,
          "new_api": "rame_perf_data",
          "old_text": null,
          "new_text": "rame_perf_data(p->pass_redraw, &out->redraw);",
          "old_line_content": "",
          "new_line_content": "    frame_perf_data(p->pass_redraw, &out->redraw);",
          "content_same": false
        },
        {
          "line": 4039,
          "old_api": null,
          "new_api": "P_WARN",
          "old_text": null,
          "new_text": "P_WARN(p, \"Interpolation now requires enabling display-sync mode.\\n\"\n                   \"E.g.: --video-sync=display-resample\\n\");",
          "old_line_content": "        p->dsi_warned = true;",
          "new_line_content": "        MP_WARN(p, \"Interpolation now requires enabling display-sync mode.\\n\"",
          "content_same": false
        },
        {
          "line": 4048,
          "old_api": null,
          "new_api": "trcmp",
          "old_text": null,
          "new_text": "trcmp(name, \"bilinear\"))",
          "old_line_content": "            p->correct_downscaling_warned = true;",
          "new_line_content": "        if (!name || !strcmp(name, \"bilinear\")) {",
          "content_same": false
        },
        {
          "line": 3537,
          "old_api": null,
          "new_api": "p_image_new_ref",
          "old_text": null,
          "new_text": "p_image_new_ref(mpi);",
          "old_line_content": "        goto error;",
          "new_line_content": "    mpi = mp_image_new_ref(mpi);",
          "content_same": false
        },
        {
          "line": 4049,
          "old_api": null,
          "new_api": "P_WARN",
          "old_text": null,
          "new_text": "P_WARN(p, \"correct-downscaling requires non-bilinear scaler.\\n\");",
          "old_line_content": "        }",
          "new_line_content": "            MP_WARN(p, \"correct-downscaling requires non-bilinear scaler.\\n\");",
          "content_same": false
        },
        {
          "line": 4057,
          "old_api": null,
          "new_api": "l_video_update_options",
          "old_text": null,
          "new_text": "l_video_update_options(p);",
          "old_line_content": "    int queue_size = 1;",
          "new_line_content": "    gl_video_update_options(p);",
          "content_same": false
        },
        {
          "line": 4065,
          "old_api": null,
          "new_api": "p_find_filter_kernel",
          "old_text": null,
          "new_text": "p_find_filter_kernel(p->opts.scaler[SCALER_TSCALE].kernel.name);",
          "old_line_content": "            // filter_scale wouldn't be correctly initialized were we to use it here.",
          "new_line_content": "            mp_find_filter_kernel(p->opts.scaler[SCALER_TSCALE].kernel.name);",
          "content_same": false
        },
        {
          "line": 3555,
          "old_api": null,
          "new_api": "imer_pool_stop",
          "old_text": null,
          "new_text": "imer_pool_stop(p->upload_timer);",
          "old_line_content": "",
          "new_line_content": "        timer_pool_stop(p->upload_timer);",
          "content_same": false
        },
        {
          "line": 3556,
          "old_api": null,
          "new_api": "imer_pool_measure",
          "old_text": null,
          "new_text": "imer_pool_measure(p->upload_timer))",
          "old_line_content": "        vimg->hwdec_mapped = true;",
          "new_line_content": "        pass_record(p, timer_pool_measure(p->upload_timer));",
          "content_same": false
        },
        {
          "line": 4072,
          "old_api": null,
          "new_api": "eil",
          "old_text": null,
          "new_text": "eil(radius);",
          "old_line_content": "            // Oversample/linear case",
          "new_line_content": "            queue_size += 1 + ceil(radius);",
          "content_same": false
        },
        {
          "line": 3561,
          "old_api": null,
          "new_api": "p_image_set_params",
          "old_text": null,
          "new_text": "p_image_set_params(&layout, &p->image_params);",
          "old_line_content": "            for (int n = 0; n < p->plane_count; n++) {",
          "new_line_content": "            mp_image_set_params(&layout, &p->image_params);",
          "content_same": false
        },
        {
          "line": 3565,
          "old_api": null,
          "new_api": "p_image_plane_w",
          "old_text": null,
          "new_text": "p_image_plane_w(&layout, n),",
          "old_line_content": "                    .tex = tex[n],",
          "new_line_content": "                    .w = mp_image_plane_w(&layout, n),",
          "content_same": false
        },
        {
          "line": 3566,
          "old_api": null,
          "new_api": "p_image_plane_h",
          "old_text": null,
          "new_text": "p_image_plane_h(&layout, n),",
          "old_line_content": "                };",
          "new_line_content": "                    .h = mp_image_plane_h(&layout, n),",
          "content_same": false
        },
        {
          "line": 4079,
          "old_api": null,
          "new_api": "o_set_queue_params",
          "old_text": null,
          "new_text": "o_set_queue_params(vo, 0, queue_size);",
          "old_line_content": "",
          "new_line_content": "    vo_set_queue_params(vo, 0, queue_size);",
          "content_same": false
        },
        {
          "line": 3571,
          "old_api": null,
          "new_api": "P_FATAL",
          "old_text": null,
          "new_text": "P_FATAL(p, \"Mapping hardware decoded surface failed.\\n\");",
          "old_line_content": "        }",
          "new_line_content": "            MP_FATAL(p, \"Mapping hardware decoded surface failed.\\n\");",
          "content_same": false
        },
        {
          "line": 4087,
          "old_api": null,
          "new_api": "str_equals0",
          "old_text": null,
          "new_text": "str_equals0(name, \"tscale\");",
          "old_line_content": "        r = M_OPT_EXIT;",
          "new_line_content": "    bool tscale = bstr_equals0(name, \"tscale\");",
          "content_same": false
        },
        {
          "line": 4090,
          "old_api": null,
          "new_api": "str_equals0",
          "old_text": null,
          "new_text": "str_equals0(name, \"dscale\") ",
          "old_line_content": "    } else {",
          "new_line_content": "    } else if (bstr_equals0(name, \"dscale\") && !param.len) {",
          "content_same": false
        },
        {
          "line": 3580,
          "old_api": null,
          "new_api": "imer_pool_start",
          "old_text": null,
          "new_text": "imer_pool_start(p->upload_timer);",
          "old_line_content": "        struct texplane *plane = &vimg->planes[n];",
          "new_line_content": "    timer_pool_start(p->upload_timer);",
          "content_same": false
        },
        {
          "line": 4093,
          "old_api": null,
          "new_api": "STR_P",
          "old_text": null,
          "new_text": "STR_P(param))",
          "old_line_content": "            r = M_OPT_INVALID;",
          "new_line_content": "        snprintf(s, sizeof(s), \"%.*s\", BSTR_P(param));",
          "content_same": false
        },
        {
          "line": 4094,
          "old_api": null,
          "new_api": "andle_scaler_opt",
          "old_text": null,
          "new_text": "andle_scaler_opt(s, tscale))",
          "old_line_content": "    }",
          "new_line_content": "        if (!handle_scaler_opt(s, tscale))",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 4096,
          "old_api": "p_info",
          "new_api": null,
          "old_text": "p_info(log, \"Available scalers:\\n\");",
          "new_text": null,
          "old_line_content": "        mp_info(log, \"Available scalers:\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4100,
          "old_api": "p_info",
          "new_api": null,
          "old_text": "p_info(log, \"    %s\\n\", *filter);",
          "new_text": null,
          "old_line_content": "            mp_info(log, \"    %s\\n\", *filter);",
          "new_line_content": "                                                : fixed_scale_filters;",
          "content_same": false
        },
        {
          "line": 3591,
          "old_api": "p_image_plane_h",
          "new_api": null,
          "old_text": "p_image_plane_h(mpi, n);",
          "new_text": null,
          "old_line_content": "            int h = mp_image_plane_h(mpi, n);",
          "new_line_content": "        plane->flipped = params.stride < 0;",
          "content_same": false
        },
        {
          "line": 4104,
          "old_api": "p_info",
          "new_api": null,
          "old_text": "p_info(log, \"    %s\\n\", mp_filter_kernels[n].f.name);",
          "new_text": null,
          "old_line_content": "                mp_info(log, \"    %s\\n\", mp_filter_kernels[n].f.name);",
          "new_line_content": "        for (int n = 0; mp_filter_kernels[n].f.name; n++) {",
          "content_same": false
        },
        {
          "line": 4107,
          "old_api": "p_fatal",
          "new_api": null,
          "old_text": "p_fatal(log, \"No scaler named '%s' found!\\n\", s);",
          "new_text": null,
          "old_line_content": "            mp_fatal(log, \"No scaler named '%s' found!\\n\", s);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3596,
          "old_api": "l_find_dr_buffer",
          "new_api": null,
          "old_text": "l_find_dr_buffer(p, mpi->planes[n]);",
          "new_text": null,
          "old_line_content": "        struct dr_buffer *mapped = gl_find_dr_buffer(p, mpi->planes[n]);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 4117,
          "old_api": "str_equals0",
          "new_api": null,
          "old_text": "str_equals0(param, \"help\"))",
          "new_text": null,
          "old_line_content": "    if (bstr_equals0(param, \"help\")) {",
          "new_line_content": "    char s[20] = {0};",
          "content_same": false
        },
        {
          "line": 3606,
          "old_api": "P_VERBOSE",
          "new_api": null,
          "old_text": "P_VERBOSE(p, \"DR enabled: %s\\n\", p->using_dr_path ? \"yes\" : \"no\");",
          "new_text": null,
          "old_line_content": "            MP_VERBOSE(p, \"DR enabled: %s\\n\", p->using_dr_path ? \"yes\" : \"no\");",
          "new_line_content": "        if (p->using_dr_path != !!mapped) {",
          "content_same": false
        },
        {
          "line": 3609,
          "old_api": "tex_upload",
          "new_api": null,
          "old_text": "->ra->fns->tex_upload(p->ra, &params))",
          "new_text": null,
          "old_line_content": "        if (!p->ra->fns->tex_upload(p->ra, &params)) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 4122,
          "old_api": "STR_P",
          "new_api": null,
          "old_text": "STR_P(param))",
          "new_text": null,
          "old_line_content": "        snprintf(s, sizeof(s), \"%.*s\", BSTR_P(param));",
          "new_line_content": "        return r; // empty string means \"use preferred window\"",
          "content_same": false
        },
        {
          "line": 4123,
          "old_api": "p_find_filter_window",
          "new_api": null,
          "old_text": "p_find_filter_window(s);",
          "new_text": null,
          "old_line_content": "        const struct filter_window *window = mp_find_filter_window(s);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 3610,
          "old_api": "imer_pool_stop",
          "new_api": null,
          "old_text": "imer_pool_stop(p->upload_timer);",
          "new_text": null,
          "old_line_content": "            timer_pool_stop(p->upload_timer);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3615,
          "old_api": "p_image_new_ref",
          "new_api": null,
          "old_text": "p_image_new_ref(mpi);",
          "new_text": null,
          "old_line_content": "            mapped->mpi = mp_image_new_ref(mpi);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4128,
          "old_api": "p_info",
          "new_api": null,
          "old_text": "p_info(log, \"Available windows:\\n\");",
          "new_text": null,
          "old_line_content": "        mp_info(log, \"Available windows:\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3621,
          "old_api": "ass_describe",
          "new_api": null,
          "old_text": "ass_describe(p, \"upload frame (%s)\", mode);",
          "new_text": null,
          "old_line_content": "    pass_describe(p, \"upload frame (%s)\", mode);",
          "new_line_content": "    bool using_pbo = p->ra->use_pbo || !(p->ra->caps & RA_CAP_DIRECT_UPLOAD);",
          "content_same": false
        },
        {
          "line": 3622,
          "old_api": "imer_pool_measure",
          "new_api": null,
          "old_text": "imer_pool_measure(p->upload_timer))",
          "new_text": null,
          "old_line_content": "    pass_record(p, timer_pool_measure(p->upload_timer));",
          "new_line_content": "    const char *mode = p->using_dr_path ? \"DR\" : using_pbo ? \"PBO\" : \"naive\";",
          "content_same": false
        },
        {
          "line": 3627,
          "old_api": "nref_current_image",
          "new_api": null,
          "old_text": "nref_current_image(p);",
          "new_text": null,
          "old_line_content": "    unref_current_image(p);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4142,
          "old_api": "str_equals0",
          "new_api": null,
          "old_text": "str_equals0(param, \"help\"))",
          "new_text": null,
          "old_line_content": "    if (bstr_equals0(param, \"help\")) {",
          "new_line_content": "    char s[20] = {0};",
          "content_same": false
        },
        {
          "line": 4145,
          "old_api": "STR_P",
          "new_api": null,
          "old_text": "STR_P(param))",
          "new_text": null,
          "old_line_content": "        snprintf(s, sizeof(s), \"%.*s\", BSTR_P(param));",
          "new_line_content": "        r = M_OPT_EXIT;",
          "content_same": false
        },
        {
          "line": 4146,
          "old_api": "p_find_error_diffusion_kernel",
          "new_api": null,
          "old_text": "p_find_error_diffusion_kernel(s);",
          "new_text": null,
          "old_line_content": "        const struct error_diffusion_kernel *k = mp_find_error_diffusion_kernel(s);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 3634,
          "old_api": "P_VERBOSE",
          "new_api": null,
          "old_text": "P_VERBOSE(p, \"Testing FBO format %s\\n\", fmt->name);",
          "new_text": null,
          "old_line_content": "    MP_VERBOSE(p, \"Testing FBO format %s\\n\", fmt->name);",
          "new_line_content": "static bool test_fbo(struct gl_video *p, const struct ra_format *fmt)",
          "content_same": false
        },
        {
          "line": 3637,
          "old_api": "a_tex_free",
          "new_api": null,
          "old_text": "a_tex_free(p->ra, &tex);",
          "new_text": null,
          "old_line_content": "    ra_tex_free(p->ra, &tex);",
          "new_line_content": "    struct ra_tex *tex = NULL;",
          "content_same": false
        },
        {
          "line": 4151,
          "old_api": "p_info",
          "new_api": null,
          "old_text": "p_info(log, \"Available error diffusion kernels:\\n\");",
          "new_text": null,
          "old_line_content": "        mp_info(log, \"Available error diffusion kernels:\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4163,
          "old_api": "ssert",
          "new_api": null,
          "old_text": "ssert(lmax > lmin);",
          "new_text": null,
          "old_line_content": "    assert(lmax > lmin);",
          "new_line_content": "                                 float rmin, float rmax, float lux)",
          "content_same": false
        },
        {
          "line": 4166,
          "old_api": "og10",
          "new_api": null,
          "old_text": "og10(lmin);",
          "new_text": null,
          "old_line_content": "    float den = log10(lmax) - log10(lmin);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4170,
          "old_api": "PMAX",
          "new_api": null,
          "old_text": "PMAX(rmax, rmin);",
          "new_text": null,
          "old_line_content": "    float max = MPMAX(rmax, rmin);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4171,
          "old_api": "PMIN",
          "new_api": null,
          "old_text": "PMIN(rmax, rmin);",
          "new_text": null,
          "old_line_content": "    float min = MPMIN(rmax, rmin);",
          "new_line_content": "    // clamp the result",
          "content_same": false
        },
        {
          "line": 3662,
          "old_api": "trcmp",
          "new_api": null,
          "old_text": "trcmp(name, \"bilinear\") ",
          "new_text": null,
          "old_line_content": "            if (name && strcmp(name, \"bilinear\") != 0)",
          "new_line_content": "        if (i != SCALER_TSCALE) {",
          "content_same": false
        },
        {
          "line": 4178,
          "old_api": "l_video_scale_ambient_lux",
          "new_api": null,
          "old_text": "l_video_scale_ambient_lux(16.0, 256.0, 1.0, 1.2, lux);",
          "new_text": null,
          "old_line_content": "        p->opts.gamma = gl_video_scale_ambient_lux(16.0, 256.0, 1.0, 1.2, lux);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 4179,
          "old_api": "P_TRACE",
          "new_api": null,
          "old_text": "P_TRACE(p, \"ambient light changed: %d lux (gamma: %f)\\n\", lux,\n                 p->opts.gamma);",
          "new_text": null,
          "old_line_content": "        MP_TRACE(p, \"ambient light changed: %d lux (gamma: %f)\\n\", lux,",
          "new_line_content": "    if (p->opts.gamma_auto) {",
          "content_same": false
        },
        {
          "line": 3675,
          "old_api": "a_find_float16_format",
          "new_api": null,
          "old_text": "a_find_float16_format(ra, 1);",
          "new_text": null,
          "old_line_content": "    bool have_float_tex = !!ra_find_float16_format(ra, 1);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 4192,
          "old_api": "a_buf_create",
          "new_api": null,
          "old_text": "a_buf_create(p->ra, &params);",
          "new_text": null,
          "old_line_content": "    struct ra_buf *buf = ra_buf_create(p->ra, &params);",
          "new_line_content": "    };",
          "content_same": false
        },
        {
          "line": 4196,
          "old_api": "P_TARRAY_GROW",
          "new_api": null,
          "old_text": "P_TARRAY_GROW(p, p->dr_buffers, p->num_dr_buffers);",
          "new_text": null,
          "old_line_content": "    MP_TARRAY_GROW(p, p->dr_buffers, p->num_dr_buffers);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 3686,
          "old_api": "trcmp",
          "new_api": null,
          "old_text": "trcmp(user_fbo_fmts[0], \"auto\")\n",
          "new_text": null,
          "old_line_content": "    const char **fbo_fmts = user_fbo_fmts[0] && strcmp(user_fbo_fmts[0], \"auto\")",
          "new_line_content": "                                   \"rgb10_a2\", \"rgba8\", 0};",
          "content_same": false
        },
        {
          "line": 3694,
          "old_api": "a_find_named_format",
          "new_api": null,
          "old_text": "a_find_named_format(p->ra, fmt);",
          "new_text": null,
          "old_line_content": "        const struct ra_format *f = ra_find_named_format(p->ra, fmt);",
          "new_line_content": "    for (int n = 0; fbo_fmts[n]; n++) {",
          "content_same": false
        },
        {
          "line": 4209,
          "old_api": "ssert",
          "new_api": null,
          "old_text": "ssert(!buffer->mpi);",
          "new_text": null,
          "old_line_content": "            assert(!buffer->mpi); // can't be freed while it has a ref",
          "new_line_content": "        struct dr_buffer *buffer = &p->dr_buffers[n];",
          "content_same": false
        },
        {
          "line": 4210,
          "old_api": "a_buf_free",
          "new_api": null,
          "old_text": "a_buf_free(p->ra, &buffer->buf);",
          "new_text": null,
          "old_line_content": "            ra_buf_free(p->ra, &buffer->buf);",
          "new_line_content": "        if (buffer->buf->data == data) {",
          "content_same": false
        },
        {
          "line": 3699,
          "old_api": "P_VERBOSE",
          "new_api": null,
          "old_text": "P_VERBOSE(p, \"Using FBO format %s.\\n\", f->name);",
          "new_text": null,
          "old_line_content": "            MP_VERBOSE(p, \"Using FBO format %s.\\n\", f->name);",
          "new_line_content": "        if (f && f->renderable && f->linear_filter &&",
          "content_same": false
        },
        {
          "line": 4216,
          "old_api": "ssert",
          "new_api": null,
          "old_text": "ssert(0);",
          "new_text": null,
          "old_line_content": "    assert(0);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3706,
          "old_api": "P_WARN",
          "new_api": null,
          "old_text": "P_WARN(p, \"User-specified FBO format '%s' failed to initialize! \"\n                       \"(exists=%d, renderable=%d, linear_filter=%d, \"\n                       \"fbo_test_result=%d)\\n\",\n                    fmt, !!f, f ? f->renderable : 0,  f ? f->linear_filter : 0,\n                    fbo_test_result);",
          "new_text": null,
          "old_line_content": "            MP_WARN(p, \"User-specified FBO format '%s' failed to initialize! \"",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4222,
          "old_api": "l_video_check_format",
          "new_api": null,
          "old_text": "l_video_check_format(p, imgfmt))",
          "new_text": null,
          "old_line_content": "    if (!gl_video_check_format(p, imgfmt))",
          "new_line_content": "                                    int stride_align)",
          "content_same": false
        },
        {
          "line": 4225,
          "old_api": "p_image_get_alloc_size",
          "new_api": null,
          "old_text": "p_image_get_alloc_size(imgfmt, w, h, stride_align);",
          "new_text": null,
          "old_line_content": "    int size = mp_image_get_alloc_size(imgfmt, w, h, stride_align);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 4230,
          "old_api": "l_video_dr_alloc_buffer",
          "new_api": null,
          "old_text": "l_video_dr_alloc_buffer(p, alloc_size);",
          "new_text": null,
          "old_line_content": "    void *ptr = gl_video_dr_alloc_buffer(p, alloc_size);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3718,
          "old_api": "P_WARN",
          "new_api": null,
          "old_text": "P_WARN(p, \"Disabling dithering (no gl_FragCoord).\\n\");",
          "new_text": null,
          "old_line_content": "        MP_WARN(p, \"Disabling dithering (no gl_FragCoord).\\n\");",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 3723,
          "old_api": "P_VERBOSE",
          "new_api": null,
          "old_text": "P_VERBOSE(p, \"Disabling alpha checkerboard (no gl_FragCoord).\\n\");",
          "new_text": null,
          "old_line_content": "        MP_VERBOSE(p, \"Disabling alpha checkerboard (no gl_FragCoord).\\n\");",
          "new_line_content": "        p->opts.alpha_mode = ALPHA_BLEND;",
          "content_same": false
        },
        {
          "line": 4236,
          "old_api": "p_image_from_buffer",
          "new_api": null,
          "old_text": "p_image_from_buffer(imgfmt, w, h, stride_align,\n                                                ptr, alloc_size, p,\n                                                gl_video_dr_free_buffer);",
          "new_text": null,
          "old_line_content": "    struct mp_image *res = mp_image_from_buffer(imgfmt, w, h, stride_align,",
          "new_line_content": "    // (we expect vo.c to proxy the free callback, so it happens in the same",
          "content_same": false
        },
        {
          "line": 3727,
          "old_api": "P_WARN",
          "new_api": null,
          "old_text": "P_WARN(p, \"Force-disabling compute shaders as an FBO format was not \"\n                   \"available! See your FBO format configuration!\\n\");",
          "new_text": null,
          "old_line_content": "        MP_WARN(p, \"Force-disabling compute shaders as an FBO format was not \"",
          "new_line_content": "    if (!have_fbo && have_compute) {",
          "content_same": false
        },
        {
          "line": 4240,
          "old_api": "l_video_dr_free_buffer",
          "new_api": null,
          "old_text": "l_video_dr_free_buffer(p, ptr);",
          "new_text": null,
          "old_line_content": "        gl_video_dr_free_buffer(p, ptr);",
          "new_line_content": "                                                gl_video_dr_free_buffer);",
          "content_same": false
        },
        {
          "line": 3733,
          "old_api": "P_WARN",
          "new_api": null,
          "old_text": "P_WARN(p, \"Force-disabling compute shaders as the chosen FBO format \"\n                \"is not storable! See your FBO format configuration!\\n\");",
          "new_text": null,
          "old_line_content": "        MP_WARN(p, \"Force-disabling compute shaders as the chosen FBO format \"",
          "new_line_content": "    if (have_compute && have_fbo && !p->fbo_format->storable) {",
          "content_same": false
        },
        {
          "line": 4248,
          "old_api": "a_hwdec_load_driver",
          "new_api": null,
          "old_text": "a_hwdec_load_driver(p->ra, p->log, p->global, devs, drv, is_auto);",
          "new_text": null,
          "old_line_content": "        ra_hwdec_load_driver(p->ra, p->log, p->global, devs, drv, is_auto);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3738,
          "old_api": "P_WARN",
          "new_api": null,
          "old_text": "P_WARN(p, \"Disabling error diffusion dithering because compute shader \"\n                   \"was not supported. Fallback to dither=fruit instead.\\n\");",
          "new_text": null,
          "old_line_content": "        MP_WARN(p, \"Disabling error diffusion dithering because compute shader \"",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4257,
          "old_api": "trcmp",
          "new_api": null,
          "old_text": "trcmp(type, \"auto\") ",
          "new_text": null,
          "old_line_content": "    if (!type || !type[0] || strcmp(type, \"auto\") == 0) {",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3746,
          "old_api": "P_MSG",
          "new_api": null,
          "old_text": "P_MSG(p, msgl, \"Disabling HDR peak computation (one or more of the \"\n                        \"following is not supported: compute shaders=%d, \"\n                        \"SSBO=%d).\\n\", have_compute, have_ssbo);",
          "new_text": null,
          "old_line_content": "        MP_MSG(p, msgl, \"Disabling HDR peak computation (one or more of the \"",
          "new_line_content": "    if (!have_compute_peak && p->opts.tone_map.compute_peak >= 0) {",
          "content_same": false
        },
        {
          "line": 4262,
          "old_api": "trcmp",
          "new_api": null,
          "old_text": "trcmp(type, \"no\") ",
          "new_text": null,
          "old_line_content": "    if (strcmp(type, \"no\") == 0) {",
          "new_line_content": "        type = \"all\";",
          "content_same": false
        },
        {
          "line": 4265,
          "old_api": "l_video_load_hwdecs_all",
          "new_api": null,
          "old_text": "l_video_load_hwdecs_all(p, devs);",
          "new_text": null,
          "old_line_content": "        gl_video_load_hwdecs_all(p, devs);",
          "new_line_content": "        // do nothing, just block further loading",
          "content_same": false
        },
        {
          "line": 3753,
          "old_api": "heck_dumb_mode",
          "new_api": null,
          "old_text": "heck_dumb_mode(p);",
          "new_text": null,
          "old_line_content": "    bool voluntarily_dumb = check_dumb_mode(p);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3756,
          "old_api": "P_VERBOSE",
          "new_api": null,
          "old_text": "P_VERBOSE(p, \"No advanced processing required. Enabling dumb mode.\\n\");",
          "new_text": null,
          "old_line_content": "            MP_VERBOSE(p, \"No advanced processing required. Enabling dumb mode.\\n\");",
          "new_line_content": "    if (p->forced_dumb_mode || voluntarily_dumb) {",
          "content_same": false
        },
        {
          "line": 4269,
          "old_api": "trcmp",
          "new_api": null,
          "old_text": "trcmp(type, drv->name) ",
          "new_text": null,
          "old_line_content": "            if (strcmp(type, drv->name) == 0) {",
          "new_line_content": "        for (int n = 0; ra_hwdec_drivers[n]; n++) {",
          "content_same": false
        },
        {
          "line": 4270,
          "old_api": "oad_add_hwdec",
          "new_api": null,
          "old_text": "oad_add_hwdec(p, devs, drv, false);",
          "new_text": null,
          "old_line_content": "                load_add_hwdec(p, devs, drv, false);",
          "new_line_content": "            const struct ra_hwdec_driver *drv = ra_hwdec_drivers[n];",
          "content_same": false
        },
        {
          "line": 3251,
          "old_api": "clear",
          "new_api": null,
          "old_text": "->ra->fns->clear(p->ra, fbo.tex, clear_color, &target_rc);",
          "new_text": null,
          "old_line_content": "    p->ra->fns->clear(p->ra, fbo.tex, clear_color, &target_rc);",
          "new_line_content": "        float clear_color[4] = {c.r / 255.0, c.g / 255.0, c.b / 255.0, c.a / 255.0};",
          "content_same": false
        },
        {
          "line": 3256,
          "old_api": "clear",
          "new_api": null,
          "old_text": "->ra->fns->clear(p->ra, fbo.tex, color, &p->dst_rect);",
          "new_text": null,
          "old_line_content": "            p->ra->fns->clear(p->ra, fbo.tex, color, &p->dst_rect);",
          "new_line_content": "        if (has_frame) {",
          "content_same": false
        },
        {
          "line": 4282,
          "old_api": "oad_add_hwdec",
          "new_api": null,
          "old_text": "oad_add_hwdec(p, devs, ra_hwdec_drivers[n], true);",
          "new_text": null,
          "old_line_content": "            load_add_hwdec(p, devs, ra_hwdec_drivers[n], true);",
          "new_line_content": "    if (!p->hwdec_interop_loading_done) {",
          "content_same": false
        },
        {
          "line": 3259,
          "old_api": "overlay_frame",
          "new_api": null,
          "old_text": "->hwdec_overlay->driver->overlay_frame(p->hwdec_overlay, frame->current,\n                                                &p->src_rect, &p->dst_rect,\n                                                frame->frame_id != p->image.id);",
          "new_text": null,
          "old_line_content": "        p->hwdec_overlay->driver->overlay_frame(p->hwdec_overlay, frame->current,",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3275,
          "old_api": "abs",
          "new_api": null,
          "old_text": "abs(ratio - 1.0) ",
          "new_text": null,
          "old_line_content": "            if (fabs(ratio - 1.0) < p->opts.interpolation_threshold)",
          "new_line_content": "        if (interpolate) {",
          "content_same": false
        },
        {
          "line": 3280,
          "old_api": "l_video_interpolate_frame",
          "new_api": null,
          "old_text": "l_video_interpolate_frame(p, frame, fbo, flags);",
          "new_text": null,
          "old_line_content": "            gl_video_interpolate_frame(p, frame, fbo, flags);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3801,
          "old_api": "p_find_filter_kernel",
          "new_api": null,
          "old_text": "p_find_filter_kernel(p->opts.scaler[n].kernel.name);",
          "new_text": null,
          "old_line_content": "            mp_find_filter_kernel(p->opts.scaler[n].kernel.name);",
          "new_line_content": "    for (int n = 0; n < SCALER_COUNT; n++) {",
          "content_same": false
        },
        {
          "line": 3291,
          "old_api": "ass_info_reset",
          "new_api": null,
          "old_text": "ass_info_reset(p, !is_new);",
          "new_text": null,
          "old_line_content": "                pass_info_reset(p, !is_new);",
          "new_line_content": "                p->output_tex_valid = false;",
          "content_same": false
        },
        {
          "line": 3292,
          "old_api": "ass_render_frame",
          "new_api": null,
          "old_text": "ass_render_frame(p, frame->current, frame->frame_id, flags))",
          "new_text": null,
          "old_line_content": "                if (!pass_render_frame(p, frame->current, frame->frame_id, flags))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3809,
          "old_api": "P_WARN",
          "new_api": null,
          "old_text": "P_WARN(p, \"Disabling scaler #%d %s %s.\\n\", n,\n                        p->opts.scaler[n].kernel.name, reason);",
          "new_text": null,
          "old_line_content": "                MP_WARN(p, \"Disabling scaler #%d %s %s.\\n\", n,",
          "new_line_content": "                reason = \"(GLSL version too old)\";",
          "content_same": false
        },
        {
          "line": 3309,
          "old_api": "a_tex_resize",
          "new_api": null,
          "old_text": "a_tex_resize(p->ra, p->log, &p->output_tex,\n                                           fbo.tex->params.w, fbo.tex->params.h,\n                                           fmt);",
          "new_text": null,
          "old_line_content": "                    bool r = ra_tex_resize(p->ra, p->log, &p->output_tex,",
          "new_line_content": "                        fmt = p->fbo_format;",
          "content_same": false
        },
        {
          "line": 3317,
          "old_api": "ass_draw_to_screen",
          "new_api": null,
          "old_text": "ass_draw_to_screen(p, dest_fbo);",
          "new_text": null,
          "old_line_content": "                pass_draw_to_screen(p, dest_fbo);",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 3829,
          "old_api": "P_WARN",
          "new_api": null,
          "old_text": "P_WARN(p, \"Disabling linear/sigmoid scaling (GLSL version too old).\\n\");",
          "new_text": null,
          "old_line_content": "        MP_WARN(p, \"Disabling linear/sigmoid scaling (GLSL version too old).\\n\");",
          "new_line_content": "        p->opts.linear_upscaling = false;",
          "content_same": false
        },
        {
          "line": 3322,
          "old_api": "ass_info_reset",
          "new_api": null,
          "old_text": "ass_info_reset(p, true);",
          "new_text": null,
          "old_line_content": "                pass_info_reset(p, true);",
          "new_line_content": "            // \"output tex valid\" and \"output tex needed\" are equivalent",
          "content_same": false
        },
        {
          "line": 3323,
          "old_api": "ass_describe",
          "new_api": null,
          "old_text": "ass_describe(p, \"redraw cached frame\");",
          "new_text": null,
          "old_line_content": "                pass_describe(p, \"redraw cached frame\");",
          "new_line_content": "            if (p->output_tex_valid && fbo.tex->params.blit_dst) {",
          "content_same": false
        },
        {
          "line": 3835,
          "old_api": "P_WARN",
          "new_api": null,
          "old_text": "P_WARN(p, \"Disabling color management (GLSL version too old).\\n\");",
          "new_text": null,
          "old_line_content": "        MP_WARN(p, \"Disabling color management (GLSL version too old).\\n\");",
          "new_line_content": "        p->opts.target_trc = MP_CSP_TRC_AUTO;",
          "content_same": false
        },
        {
          "line": 3839,
          "old_api": "P_WARN",
          "new_api": null,
          "old_text": "P_WARN(p, \"Disabling debanding (GLSL version too old).\\n\");",
          "new_text": null,
          "old_line_content": "        MP_WARN(p, \"Disabling debanding (GLSL version too old).\\n\");",
          "new_line_content": "    if (!have_mglsl && p->opts.deband) {",
          "content_same": false
        },
        {
          "line": 3330,
          "old_api": "imer_pool_start",
          "new_api": null,
          "old_text": "imer_pool_start(p->blit_timer);",
          "new_text": null,
          "old_line_content": "                timer_pool_start(p->blit_timer);",
          "new_line_content": "                    dst.y1 = fbo.tex->params.h - src.y1;",
          "content_same": false
        },
        {
          "line": 3331,
          "old_api": "blit",
          "new_api": null,
          "old_text": "->ra->fns->blit(p->ra, fbo.tex, p->output_tex, &dst, &src);",
          "new_text": null,
          "old_line_content": "                p->ra->fns->blit(p->ra, fbo.tex, p->output_tex, &dst, &src);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 3845,
          "old_api": "ebug_check_gl",
          "new_api": null,
          "old_text": "ebug_check_gl(p, \"before init_gl\");",
          "new_text": null,
          "old_line_content": "    debug_check_gl(p, \"before init_gl\");",
          "new_line_content": "static void init_gl(struct gl_video *p)",
          "content_same": false
        },
        {
          "line": 3848,
          "old_api": "imer_pool_create",
          "new_api": null,
          "old_text": "imer_pool_create(p->ra);",
          "new_text": null,
          "old_line_content": "    p->blit_timer = timer_pool_create(p->ra);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3340,
          "old_api": "ebug_check_gl",
          "new_api": null,
          "old_text": "ebug_check_gl(p, \"after video rendering\");",
          "new_text": null,
          "old_line_content": "    debug_check_gl(p, \"after video rendering\");",
          "new_line_content": "done:",
          "content_same": false
        },
        {
          "line": 3854,
          "old_api": "a_dump_img_formats",
          "new_api": null,
          "old_text": "a_dump_img_formats(p->ra, MSGL_DEBUG);",
          "new_text": null,
          "old_line_content": "    ra_dump_img_formats(p->ra, MSGL_DEBUG);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3347,
          "old_api": "ass_info_reset",
          "new_api": null,
          "old_text": "ass_info_reset(p, true);",
          "new_text": null,
          "old_line_content": "            pass_info_reset(p, true);",
          "new_line_content": "        // redraw just because, since it's basically a blank frame anyway",
          "content_same": false
        },
        {
          "line": 3862,
          "old_api": "ninit_video",
          "new_api": null,
          "old_text": "ninit_video(p);",
          "new_text": null,
          "old_line_content": "    uninit_video(p);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 3865,
          "old_api": "a_hwdec_uninit",
          "new_api": null,
          "old_text": "a_hwdec_uninit(p->hwdecs[n]);",
          "new_text": null,
          "old_line_content": "        ra_hwdec_uninit(p->hwdecs[n]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3355,
          "old_api": "ass_draw_osd",
          "new_api": null,
          "old_text": "ass_draw_osd(p, osd_flags, flags, p->osd_pts, p->osd_rect, fbo, true);",
          "new_text": null,
          "old_line_content": "        pass_draw_osd(p, osd_flags, flags, p->osd_pts, p->osd_rect, fbo, true);",
          "new_line_content": "            osd_flags |= OSD_DRAW_SUB_ONLY;",
          "content_same": false
        },
        {
          "line": 3356,
          "old_api": "ebug_check_gl",
          "new_api": null,
          "old_text": "ebug_check_gl(p, \"after OSD rendering\");",
          "new_text": null,
          "old_line_content": "        debug_check_gl(p, \"after OSD rendering\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3868,
          "old_api": "l_sc_destroy",
          "new_api": null,
          "old_text": "l_sc_destroy(p->sc);",
          "new_text": null,
          "old_line_content": "    gl_sc_destroy(p->sc);",
          "new_line_content": "    p->num_hwdecs = 0;",
          "content_same": false
        },
        {
          "line": 3359,
          "old_api": "l_sc_error_state",
          "new_api": null,
          "old_text": "l_sc_error_state(p->sc);",
          "new_text": null,
          "old_line_content": "    p->broken_frame |= gl_sc_error_state(p->sc);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3871,
          "old_api": "a_buf_free",
          "new_api": null,
          "old_text": "a_buf_free(p->ra, &p->hdr_peak_ssbo);",
          "new_text": null,
          "old_line_content": "    ra_buf_free(p->ra, &p->hdr_peak_ssbo);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3874,
          "old_api": "imer_pool_destroy",
          "new_api": null,
          "old_text": "imer_pool_destroy(p->blit_timer);",
          "new_text": null,
          "old_line_content": "    timer_pool_destroy(p->blit_timer);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3364,
          "old_api": "clear",
          "new_api": null,
          "old_text": "->ra->fns->clear(p->ra, fbo.tex, color, &target_rc);",
          "new_text": null,
          "old_line_content": "        p->ra->fns->clear(p->ra, fbo.tex, color, &target_rc);",
          "new_line_content": "        // error has occurred",
          "content_same": false
        },
        {
          "line": 3878,
          "old_api": "alloc_free",
          "new_api": null,
          "old_text": "alloc_free(p->pass_fresh[i].desc.start);",
          "new_text": null,
          "old_line_content": "        talloc_free(p->pass_fresh[i].desc.start);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3879,
          "old_api": "alloc_free",
          "new_api": null,
          "old_text": "alloc_free(p->pass_redraw[i].desc.start);",
          "new_text": null,
          "old_line_content": "        talloc_free(p->pass_redraw[i].desc.start);",
          "new_line_content": "    for (int i = 0; i < VO_PASS_PERF_MAX; i++) {",
          "content_same": false
        },
        {
          "line": 3368,
          "old_api": "ass_report_performance",
          "new_api": null,
          "old_text": "ass_report_performance(p);",
          "new_text": null,
          "old_line_content": "    pass_report_performance(p);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3882,
          "old_api": "pgl_osd_destroy",
          "new_api": null,
          "old_text": "pgl_osd_destroy(p->osd);",
          "new_text": null,
          "old_line_content": "    mpgl_osd_destroy(p->osd);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3886,
          "old_api": "c_pending_dr_fences",
          "new_api": null,
          "old_text": "c_pending_dr_fences(p, true);",
          "new_text": null,
          "old_line_content": "    gc_pending_dr_fences(p, true);",
          "new_line_content": "    // Forcibly destroy possibly remaining image references. This should also",
          "content_same": false
        },
        {
          "line": 3889,
          "old_api": "ssert",
          "new_api": null,
          "old_text": "ssert(!p->num_dr_buffers);",
          "new_text": null,
          "old_line_content": "    assert(!p->num_dr_buffers);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3383,
          "old_api": "o_frame_ref",
          "new_api": null,
          "old_text": "o_frame_ref(frame);",
          "new_text": null,
          "old_line_content": "    struct vo_frame *nframe = vo_frame_ref(frame);",
          "new_line_content": "    struct mp_rect old_dst = p->dst_rect;",
          "content_same": false
        },
        {
          "line": 3896,
          "old_api": "l_video_reset_surfaces",
          "new_api": null,
          "old_text": "l_video_reset_surfaces(p);",
          "new_text": null,
          "old_line_content": "    gl_video_reset_surfaces(p);",
          "new_line_content": "void gl_video_reset(struct gl_video *p)",
          "content_same": false
        },
        {
          "line": 3394,
          "old_api": "p_image_params_get_dsize",
          "new_api": null,
          "old_text": "p_image_params_get_dsize(&p->image_params, &w, &h);",
          "new_text": null,
          "old_line_content": "        mp_image_params_get_dsize(&p->image_params, &w, &h);",
          "new_line_content": "    if (!args->scaled) {",
          "content_same": false
        },
        {
          "line": 3919,
          "old_api": "a_get_imgfmt_desc",
          "new_api": null,
          "old_text": "a_get_imgfmt_desc(p->ra, mp_format, &desc) ",
          "new_text": null,
          "old_line_content": "    if (ra_get_imgfmt_desc(p->ra, mp_format, &desc) &&",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3408,
          "old_api": "l_video_resize",
          "new_api": null,
          "old_text": "l_video_resize(p, &src, &dst, &osd);",
          "new_text": null,
          "old_line_content": "        gl_video_resize(p, &src, &dst, &osd);",
          "new_line_content": "        struct mp_rect dst = {0, 0, w, h};",
          "content_same": false
        },
        {
          "line": 3920,
          "old_api": "s_imgfmt_desc_supported",
          "new_api": null,
          "old_text": "s_imgfmt_desc_supported(p, &desc))",
          "new_text": null,
          "old_line_content": "        is_imgfmt_desc_supported(p, &desc))",
          "new_line_content": "    struct ra_imgfmt_desc desc;",
          "content_same": false
        },
        {
          "line": 3411,
          "old_api": "l_video_reset_surfaces",
          "new_api": null,
          "old_text": "l_video_reset_surfaces(p);",
          "new_text": null,
          "old_line_content": "    gl_video_reset_surfaces(p);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3923,
          "old_api": "a_hwdec_test_format",
          "new_api": null,
          "old_text": "a_hwdec_test_format(p->hwdecs[n], mp_format))",
          "new_text": null,
          "old_line_content": "        if (ra_hwdec_test_format(p->hwdecs[n], mp_format))",
          "new_line_content": "        return true;",
          "content_same": false
        },
        {
          "line": 3931,
          "old_api": "nmap_overlay",
          "new_api": null,
          "old_text": "nmap_overlay(p);",
          "new_text": null,
          "old_line_content": "    unmap_overlay(p);",
          "new_line_content": "void gl_video_config(struct gl_video *p, struct mp_image_params *params)",
          "content_same": false
        },
        {
          "line": 3932,
          "old_api": "nref_current_image",
          "new_api": null,
          "old_text": "nref_current_image(p);",
          "new_text": null,
          "old_line_content": "    unref_current_image(p);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3421,
          "old_api": "a_find_unorm_format",
          "new_api": null,
          "old_text": "a_find_unorm_format(p->ra, 1, 4);",
          "new_text": null,
          "old_line_content": "    params.format = ra_find_unorm_format(p->ra, 1, 4);",
          "new_line_content": "    };",
          "content_same": false
        },
        {
          "line": 3935,
          "old_api": "ninit_video",
          "new_api": null,
          "old_text": "ninit_video(p);",
          "new_text": null,
          "old_line_content": "        uninit_video(p);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3424,
          "old_api": "a_find_unorm_format",
          "new_api": null,
          "old_text": "a_find_unorm_format(p->ra, 2, 4);",
          "new_text": null,
          "old_line_content": "        const struct ra_format *fmt = ra_find_unorm_format(p->ra, 2, 4);",
          "new_line_content": "    int mpfmt = IMGFMT_RGB0;",
          "content_same": false
        },
        {
          "line": 3939,
          "old_api": "nit_video",
          "new_api": null,
          "old_text": "nit_video(p);",
          "new_text": null,
          "old_line_content": "            init_video(p);",
          "new_line_content": "        p->image_params = *params;",
          "content_same": false
        },
        {
          "line": 3942,
          "old_api": "l_video_reset_surfaces",
          "new_api": null,
          "old_text": "l_video_reset_surfaces(p);",
          "new_text": null,
          "old_line_content": "    gl_video_reset_surfaces(p);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3433,
          "old_api": "a_tex_create",
          "new_api": null,
          "old_text": "a_tex_create(p->ra, &params);",
          "new_text": null,
          "old_line_content": "    target = ra_tex_create(p->ra, &params);",
          "new_line_content": "    if (!params.format || !params.format->renderable)",
          "content_same": false
        },
        {
          "line": 3947,
          "old_api": "pgl_osd_destroy",
          "new_api": null,
          "old_text": "pgl_osd_destroy(p->osd);",
          "new_text": null,
          "old_line_content": "    mpgl_osd_destroy(p->osd);",
          "new_line_content": "void gl_video_set_osd_source(struct gl_video *p, struct osd_state *osd)",
          "content_same": false
        },
        {
          "line": 3950,
          "old_api": "einit_osd",
          "new_api": null,
          "old_text": "einit_osd(p);",
          "new_text": null,
          "old_line_content": "    reinit_osd(p);",
          "new_line_content": "    p->osd = NULL;",
          "content_same": false
        },
        {
          "line": 3442,
          "old_api": "l_video_render_frame",
          "new_api": null,
          "old_text": "l_video_render_frame(p, nframe, (struct ra_fbo){target}, flags);",
          "new_text": null,
          "old_line_content": "    gl_video_render_frame(p, nframe, (struct ra_fbo){target}, flags);",
          "new_line_content": "    if (args->osd)",
          "content_same": false
        },
        {
          "line": 3956,
          "old_api": "alloc_ptrtype",
          "new_api": null,
          "old_text": "alloc_ptrtype(NULL, p);",
          "new_text": null,
          "old_line_content": "    struct gl_video *p = talloc_ptrtype(NULL, p);",
          "new_line_content": "                               struct mpv_global *g)",
          "content_same": false
        },
        {
          "line": 3961,
          "old_api": "l_sc_create",
          "new_api": null,
          "old_text": "l_sc_create(ra, g, log),",
          "new_text": null,
          "old_line_content": "        .sc = gl_sc_create(ra, g, log),",
          "new_line_content": "        .global = g,",
          "content_same": false
        },
        {
          "line": 3962,
          "old_api": "p_csp_equalizer_create",
          "new_api": null,
          "old_text": "p_csp_equalizer_create(p, g),",
          "new_text": null,
          "old_line_content": "        .video_eq = mp_csp_equalizer_create(p, g),",
          "new_line_content": "        .log = log,",
          "content_same": false
        },
        {
          "line": 3453,
          "old_api": "tex_download",
          "new_api": null,
          "old_text": "->ra->fns->tex_download(p->ra, &download_params))",
          "new_text": null,
          "old_line_content": "    if (!p->ra->fns->tex_download(p->ra, &download_params))",
          "new_line_content": "        .stride = res->stride[0],",
          "content_same": false
        },
        {
          "line": 3968,
          "old_api": "l_lcms_init",
          "new_api": null,
          "old_text": "l_lcms_init(p, log, g, opts->icc_opts),",
          "new_text": null,
          "old_line_content": "    p->cms = gl_lcms_init(p, log, g, opts->icc_opts),",
          "new_line_content": "    p->pass = p->pass_fresh;",
          "content_same": false
        },
        {
          "line": 3461,
          "old_api": "alloc_free",
          "new_api": null,
          "old_text": "alloc_free(nframe);",
          "new_text": null,
          "old_line_content": "    talloc_free(nframe);",
          "new_line_content": "    ok = true;",
          "content_same": false
        },
        {
          "line": 3462,
          "old_api": "a_tex_free",
          "new_api": null,
          "old_text": "a_tex_free(p->ra, &target);",
          "new_text": null,
          "old_line_content": "    ra_tex_free(p->ra, &target);",
          "new_line_content": "done:",
          "content_same": false
        },
        {
          "line": 3973,
          "old_api": "P_TARRAY_APPEND",
          "new_api": null,
          "old_text": "P_TARRAY_APPEND(p, p->vao, p->vao_len, (struct ra_renderpass_input) {\n        .name = \"position\",\n        .type = RA_VARTYPE_FLOAT,\n        .dim_v = 2,\n        .dim_m = 1,\n        .offset = 0,\n    });",
          "new_text": null,
          "old_line_content": "    MP_TARRAY_APPEND(p, p->vao, p->vao_len, (struct ra_renderpass_input) {",
          "new_line_content": "        p->scaler[n] = (struct scaler){.index = n};",
          "content_same": false
        },
        {
          "line": 3980,
          "old_api": "nit_gl",
          "new_api": null,
          "old_text": "nit_gl(p);",
          "new_text": null,
          "old_line_content": "    init_gl(p);",
          "new_line_content": "        .offset = 0,",
          "content_same": false
        },
        {
          "line": 3981,
          "old_api": "einit_from_options",
          "new_api": null,
          "old_text": "einit_from_options(p);",
          "new_text": null,
          "old_line_content": "    reinit_from_options(p);",
          "new_line_content": "    });",
          "content_same": false
        },
        {
          "line": 3990,
          "old_api": "p_find_filter_kernel",
          "new_api": null,
          "old_text": "p_find_filter_kernel(name);",
          "new_text": null,
          "old_line_content": "        const struct filter_kernel *kernel = mp_find_filter_kernel(name);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3485,
          "old_api": "pgl_osd_check_change",
          "new_api": null,
          "old_text": "pgl_osd_check_change(p->osd, res, pts) ",
          "new_text": null,
          "old_line_content": "    return p->osd ? mpgl_osd_check_change(p->osd, res, pts) : false;",
          "new_line_content": "                               double pts)",
          "content_same": false
        },
        {
          "line": 3997,
          "old_api": "trcmp",
          "new_api": null,
          "old_text": "trcmp(*filter, name) ",
          "new_text": null,
          "old_line_content": "            if (strcmp(*filter, name) == 0)",
          "new_line_content": "                                                : fixed_scale_filters;",
          "content_same": false
        },
        {
          "line": 3492,
          "old_api": "p_rect_equals",
          "new_api": null,
          "old_text": "p_rect_equals(&p->src_rect, src) ",
          "new_text": null,
          "old_line_content": "    if (mp_rect_equals(&p->src_rect, src) &&",
          "new_line_content": "                     struct mp_osd_res *osd)",
          "content_same": false
        },
        {
          "line": 3493,
          "old_api": "p_rect_equals",
          "new_api": null,
          "old_text": "p_rect_equals(&p->dst_rect, dst) ",
          "new_text": null,
          "old_line_content": "        mp_rect_equals(&p->dst_rect, dst) &&",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 4006,
          "old_api": "_config_cache_update",
          "new_api": null,
          "old_text": "_config_cache_update(p->opts_cache))",
          "new_text": null,
          "old_line_content": "    if (m_config_cache_update(p->opts_cache)) {",
          "new_line_content": "static void gl_video_update_options(struct gl_video *p)",
          "content_same": false
        },
        {
          "line": 4007,
          "old_api": "l_lcms_update_options",
          "new_api": null,
          "old_text": "l_lcms_update_options(p->cms);",
          "new_text": null,
          "old_line_content": "        gl_lcms_update_options(p->cms);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 4011,
          "old_api": "p_csp_equalizer_state_changed",
          "new_api": null,
          "old_text": "p_csp_equalizer_state_changed(p->video_eq))",
          "new_text": null,
          "old_line_content": "    if (mp_csp_equalizer_state_changed(p->video_eq))",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3501,
          "old_api": "l_video_reset_surfaces",
          "new_api": null,
          "old_text": "l_video_reset_surfaces(p);",
          "new_text": null,
          "old_line_content": "    gl_video_reset_surfaces(p);",
          "new_line_content": "    p->osd_rect = *osd;",
          "content_same": false
        },
        {
          "line": 3504,
          "old_api": "pgl_osd_resize",
          "new_api": null,
          "old_text": "pgl_osd_resize(p->osd, p->osd_rect, p->image_params.stereo3d);",
          "new_text": null,
          "old_line_content": "        mpgl_osd_resize(p->osd, p->osd_rect, p->image_params.stereo3d);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4017,
          "old_api": "l_lcms_has_profile",
          "new_api": null,
          "old_text": "l_lcms_has_profile(p->cms);",
          "new_text": null,
          "old_line_content": "    p->use_lut_3d = gl_lcms_has_profile(p->cms);",
          "new_line_content": "static void reinit_from_options(struct gl_video *p)",
          "content_same": false
        },
        {
          "line": 4027,
          "old_api": "heck_gl_features",
          "new_api": null,
          "old_text": "heck_gl_features(p);",
          "new_text": null,
          "old_line_content": "    check_gl_features(p);",
          "new_line_content": "        p->clear_color = p->opts.background;",
          "content_same": false
        },
        {
          "line": 4028,
          "old_api": "ninit_rendering",
          "new_api": null,
          "old_text": "ninit_rendering(p);",
          "new_text": null,
          "old_line_content": "    uninit_rendering(p);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4032,
          "old_api": "einit_osd",
          "new_api": null,
          "old_text": "einit_osd(p);",
          "new_text": null,
          "old_line_content": "    reinit_osd(p);",
          "new_line_content": "    p->ra->use_pbo = p->opts.pbo;",
          "content_same": false
        },
        {
          "line": 3521,
          "old_api": "rame_perf_data",
          "new_api": null,
          "old_text": "rame_perf_data(p->pass_fresh,  &out->fresh);",
          "new_text": null,
          "old_line_content": "    frame_perf_data(p->pass_fresh,  &out->fresh);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3522,
          "old_api": "rame_perf_data",
          "new_api": null,
          "old_text": "rame_perf_data(p->pass_redraw, &out->redraw);",
          "new_text": null,
          "old_line_content": "    frame_perf_data(p->pass_redraw, &out->redraw);",
          "new_line_content": "    *out = (struct voctrl_performance_data){0};",
          "content_same": false
        },
        {
          "line": 4035,
          "old_api": "p_read_option_raw",
          "new_api": null,
          "old_text": "p_read_option_raw(p->global, \"video-sync\", &m_option_type_choice, &vs);",
          "new_text": null,
          "old_line_content": "    mp_read_option_raw(p->global, \"video-sync\", &m_option_type_choice, &vs);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3533,
          "old_api": "nref_current_image",
          "new_api": null,
          "old_text": "nref_current_image(p);",
          "new_text": null,
          "old_line_content": "    unref_current_image(p);",
          "new_line_content": "        return true;",
          "content_same": false
        },
        {
          "line": 4046,
          "old_api": "trcmp",
          "new_api": null,
          "old_text": "trcmp(name, \"bilinear\"))",
          "new_text": null,
          "old_line_content": "        if (!name || !strcmp(name, \"bilinear\")) {",
          "new_line_content": "        if (!name)",
          "content_same": false
        },
        {
          "line": 4047,
          "old_api": "P_WARN",
          "new_api": null,
          "old_text": "P_WARN(p, \"correct-downscaling requires non-bilinear scaler.\\n\");",
          "new_text": null,
          "old_line_content": "            MP_WARN(p, \"correct-downscaling requires non-bilinear scaler.\\n\");",
          "new_line_content": "            name = p->opts.scaler[SCALER_SCALE].kernel.name;",
          "content_same": false
        },
        {
          "line": 4055,
          "old_api": "l_video_update_options",
          "new_api": null,
          "old_text": "l_video_update_options(p);",
          "new_text": null,
          "old_line_content": "    gl_video_update_options(p);",
          "new_line_content": "void gl_video_configure_queue(struct gl_video *p, struct vo *vo)",
          "content_same": false
        },
        {
          "line": 3550,
          "old_api": "ass_describe",
          "new_api": null,
          "old_text": "ass_describe(p, \"map frame (hwdec)\");",
          "new_text": null,
          "old_line_content": "        pass_describe(p, \"map frame (hwdec)\");",
          "new_line_content": "            goto error;",
          "content_same": false
        },
        {
          "line": 3551,
          "old_api": "imer_pool_start",
          "new_api": null,
          "old_text": "imer_pool_start(p->upload_timer);",
          "new_text": null,
          "old_line_content": "        timer_pool_start(p->upload_timer);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4063,
          "old_api": "p_find_filter_kernel",
          "new_api": null,
          "old_text": "p_find_filter_kernel(p->opts.scaler[SCALER_TSCALE].kernel.name);",
          "new_text": null,
          "old_line_content": "            mp_find_filter_kernel(p->opts.scaler[SCALER_TSCALE].kernel.name);",
          "new_line_content": "    if (p->opts.interpolation) {",
          "content_same": false
        },
        {
          "line": 4070,
          "old_api": "eil",
          "new_api": null,
          "old_text": "eil(radius);",
          "new_text": null,
          "old_line_content": "            queue_size += 1 + ceil(radius);",
          "new_line_content": "            double radius = kernel->f.radius;",
          "content_same": false
        },
        {
          "line": 3559,
          "old_api": "p_image_set_params",
          "new_api": null,
          "old_text": "p_image_set_params(&layout, &p->image_params);",
          "new_text": null,
          "old_line_content": "            mp_image_set_params(&layout, &p->image_params);",
          "new_line_content": "        if (ok) {",
          "content_same": false
        },
        {
          "line": 3563,
          "old_api": "p_image_plane_w",
          "new_api": null,
          "old_text": "p_image_plane_w(&layout, n),",
          "new_text": null,
          "old_line_content": "                    .w = mp_image_plane_w(&layout, n),",
          "new_line_content": "            for (int n = 0; n < p->plane_count; n++) {",
          "content_same": false
        },
        {
          "line": 3564,
          "old_api": "p_image_plane_h",
          "new_api": null,
          "old_text": "p_image_plane_h(&layout, n),",
          "new_text": null,
          "old_line_content": "                    .h = mp_image_plane_h(&layout, n),",
          "new_line_content": "                vimg->planes[n] = (struct texplane){",
          "content_same": false
        },
        {
          "line": 4077,
          "old_api": "o_set_queue_params",
          "new_api": null,
          "old_text": "o_set_queue_params(vo, 0, queue_size);",
          "new_text": null,
          "old_line_content": "    vo_set_queue_params(vo, 0, queue_size);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3569,
          "old_api": "P_FATAL",
          "new_api": null,
          "old_text": "P_FATAL(p, \"Mapping hardware decoded surface failed.\\n\");",
          "new_text": null,
          "old_line_content": "            MP_FATAL(p, \"Mapping hardware decoded surface failed.\\n\");",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 4085,
          "old_api": "str_equals0",
          "new_api": null,
          "old_text": "str_equals0(name, \"tscale\");",
          "new_text": null,
          "old_line_content": "    bool tscale = bstr_equals0(name, \"tscale\");",
          "new_line_content": "    char s[20] = {0};",
          "content_same": false
        },
        {
          "line": 4086,
          "old_api": "str_equals0",
          "new_api": null,
          "old_text": "str_equals0(param, \"help\"))",
          "new_text": null,
          "old_line_content": "    if (bstr_equals0(param, \"help\")) {",
          "new_line_content": "    int r = 1;",
          "content_same": false
        },
        {
          "line": 3576,
          "old_api": "ssert",
          "new_api": null,
          "old_text": "ssert(mpi->num_planes == p->plane_count);",
          "new_text": null,
          "old_line_content": "    assert(mpi->num_planes == p->plane_count);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4091,
          "old_api": "STR_P",
          "new_api": null,
          "old_text": "STR_P(param))",
          "new_text": null,
          "old_line_content": "        snprintf(s, sizeof(s), \"%.*s\", BSTR_P(param));",
          "new_line_content": "        return r; // empty dscale means \"use same as upscaler\"",
          "content_same": false
        },
        {
          "line": 4092,
          "old_api": "andle_scaler_opt",
          "new_api": null,
          "old_text": "andle_scaler_opt(s, tscale))",
          "new_text": null,
          "old_line_content": "        if (!handle_scaler_opt(s, tscale))",
          "new_line_content": "    } else {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 36,
      "total_additions": 163,
      "total_deletions": 162,
      "total_api_changes": 361
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 361,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          3250,
          3253
        ]
      }
    },
    "api_calls_before": 870,
    "api_calls_after": 871,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 3,
      "total_diff_lines": 20
    }
  }
}