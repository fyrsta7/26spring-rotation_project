{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/bd1ba99ab2f64f218128100cbf3a91e5cb1b4872",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/bd1ba99ab2f64f218128100cbf3a91e5cb1b4872/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/bd1ba99ab2f64f218128100cbf3a91e5cb1b4872/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mpv/modified_file/bd1ba99ab2f64f218128100cbf3a91e5cb1b4872/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 247,
          "old_api": "mp_image_get_alloc_size",
          "new_api": "mp_lcm",
          "old_text": "mp_image_get_alloc_size(imgfmt, w, h, stride_align)",
          "new_text": "mp_lcm(stride_align, gpu->limits.align_tex_xfer_pitch)",
          "old_line_content": "    int size = mp_image_get_alloc_size(imgfmt, w, h, stride_align);",
          "new_line_content": "    stride_align = mp_lcm(stride_align, gpu->limits.align_tex_xfer_pitch);",
          "content_same": false
        },
        {
          "line": 270,
          "old_api": "pthread_mutex_unlock",
          "new_api": "pthread_mutex_lock",
          "old_text": "pthread_mutex_unlock(&p->dr_lock)",
          "new_text": "pthread_mutex_lock(&p->dr_lock)",
          "old_line_content": "    pthread_mutex_unlock(&p->dr_lock);",
          "new_line_content": "    pthread_mutex_lock(&p->dr_lock);",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": "MPMAX",
          "new_api": "pl_tex_recreate",
          "old_text": "MPMAX(item->packed_w, entry->tex ? entry->tex->params.w : 0)",
          "new_text": "pl_tex_recreate(p->gpu, &entry->tex, &(struct pl_tex_params) {\n            .format = tex_fmt,\n            .w = MPMAX(item->packed_w, entry->tex ? entry->tex->params.w : 0),\n            .h = MPMAX(item->packed_h, entry->tex ? entry->tex->params.h : 0),\n            .host_writable = true,\n            .sampleable = true,\n        })",
          "old_line_content": "            .w = MPMAX(item->packed_w, entry->tex ? entry->tex->params.w : 0),",
          "new_line_content": "        bool ok = pl_tex_recreate(p->gpu, &entry->tex, &(struct pl_tex_params) {",
          "content_same": false
        },
        {
          "line": 363,
          "old_api": "pl_color_transfer_is_hdr",
          "new_api": "get_mpi_csp",
          "old_text": "pl_color_transfer_is_hdr(ol->color.transfer)",
          "new_text": "get_mpi_csp(vo, src)",
          "old_line_content": "                if (pl_color_transfer_is_hdr(ol->color.transfer)) {",
          "new_line_content": "                ol->color = get_mpi_csp(vo, src);",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": "get_side_data",
          "new_api": "pl_map_hdr_metadata",
          "old_text": "get_side_data(mpi, AV_FRAME_DATA_CONTENT_LIGHT_LEVEL)",
          "new_text": "pl_map_hdr_metadata(&csp.hdr, &(struct pl_av_hdr_metadata) {\n        .mdm = get_side_data(mpi, AV_FRAME_DATA_MASTERING_DISPLAY_METADATA),\n        .clm = get_side_data(mpi, AV_FRAME_DATA_CONTENT_LIGHT_LEVEL),\n        .dhp = get_side_data(mpi, AV_FRAME_DATA_DYNAMIC_HDR_PLUS),\n    })",
          "old_line_content": "        .clm = get_side_data(mpi, AV_FRAME_DATA_CONTENT_LIGHT_LEVEL),",
          "new_line_content": "    pl_map_hdr_metadata(&csp.hdr, &(struct pl_av_hdr_metadata) {",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": "MP_ERR",
          "new_api": "ra_hwdec_mapper_create",
          "old_text": "MP_ERR(p, \"Initializing texture for hardware decoding failed.\\n\")",
          "new_text": "ra_hwdec_mapper_create(hwdec, par)",
          "old_line_content": "        MP_ERR(p, \"Initializing texture for hardware decoding failed.\\n\");",
          "new_line_content": "    p->hwdec_mapper = ra_hwdec_mapper_create(hwdec, par);",
          "content_same": false
        },
        {
          "line": 581,
          "old_api": "ra_gl_get_raw_tex",
          "new_api": "ra_gl_get_format",
          "old_text": "ra_gl_get_raw_tex(ra, ratex, &par.texture, &par.target)",
          "new_text": "ra_gl_get_format(ratex->params.format, &par.iformat,\n                         &(GLenum){0}, &(GLenum){0})",
          "old_line_content": "        ra_gl_get_raw_tex(ra, ratex, &par.texture, &par.target);",
          "new_line_content": "        ra_gl_get_format(ratex->params.format, &par.iformat,",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": "ra_d3d11_get_raw_tex",
          "new_api": "ra_is_d3d11",
          "old_text": "ra_d3d11_get_raw_tex(ra, ratex, &array_slice)",
          "new_text": "ra_is_d3d11(ra)",
          "old_line_content": "        ID3D11Resource *res = ra_d3d11_get_raw_tex(ra, ratex, &array_slice);",
          "new_line_content": "    if (ra_is_d3d11(ra)) {",
          "content_same": false
        },
        {
          "line": 634,
          "old_api": "pl_tex_destroy",
          "new_api": "ra_pl_get",
          "old_text": "pl_tex_destroy(p->gpu, &frame->planes[n].texture)",
          "new_text": "ra_pl_get(p->hwdec_mapper->ra)",
          "old_line_content": "            pl_tex_destroy(p->gpu, &frame->planes[n].texture);",
          "new_line_content": "    if (!ra_pl_get(p->hwdec_mapper->ra)) {",
          "content_same": false
        },
        {
          "line": 666,
          "old_api": "mp_csp_to_pl",
          "new_api": "get_mpi_csp",
          "old_text": "mp_csp_to_pl(par->color.space)",
          "new_text": "get_mpi_csp(vo, mpi)",
          "old_line_content": "            .sys = mp_csp_to_pl(par->color.space),",
          "new_line_content": "        .color = get_mpi_csp(vo, mpi),",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": "mp_alpha_to_pl",
          "new_api": "mp_csp_to_pl",
          "old_text": "mp_alpha_to_pl(par->alpha)",
          "new_text": "mp_csp_to_pl(par->color.space)",
          "old_line_content": "            .alpha = mp_alpha_to_pl(par->alpha),",
          "new_line_content": "            .sys = mp_csp_to_pl(par->color.space),",
          "content_same": false
        },
        {
          "line": 748,
          "old_api": "talloc_free",
          "new_api": "pl_upload_plane",
          "old_text": "talloc_free(data[n].priv)",
          "new_text": "pl_upload_plane(gpu, plane, &tex[n], &data[n])",
          "old_line_content": "                talloc_free(data[n].priv);",
          "new_line_content": "            if (!pl_upload_plane(gpu, plane, &tex[n], &data[n])) {",
          "content_same": false
        },
        {
          "line": 749,
          "old_api": "talloc_free",
          "new_api": "MP_ERR",
          "old_text": "talloc_free(mpi)",
          "new_text": "MP_ERR(vo, \"Failed uploading frame!\\n\")",
          "old_line_content": "                talloc_free(mpi);",
          "new_line_content": "                MP_ERR(vo, \"Failed uploading frame!\\n\");",
          "content_same": false
        },
        {
          "line": 791,
          "old_api": "talloc_free",
          "new_api": "MP_TARRAY_APPEND",
          "old_text": "talloc_free(mpi)",
          "new_text": "MP_TARRAY_APPEND(p, p->sub_tex, p->num_sub_tex, tex)",
          "old_line_content": "    talloc_free(mpi);",
          "new_line_content": "            MP_TARRAY_APPEND(p, p->sub_tex, p->num_sub_tex, tex);",
          "content_same": false
        },
        {
          "line": 825,
          "old_api": "update_lut",
          "new_api": "update_render_options",
          "old_text": "update_lut(p, &p->lut)",
          "new_text": "update_render_options(vo)",
          "old_line_content": "    update_lut(p, &p->lut);",
          "new_line_content": "        update_render_options(vo);",
          "content_same": false
        },
        {
          "line": 882,
          "old_api": "mp_prim_to_pl",
          "new_api": "mp_levels_to_pl",
          "old_text": "mp_prim_to_pl(opts->target_prim)",
          "new_text": "mp_levels_to_pl(p->output_levels)",
          "old_line_content": "        target->color.primaries = mp_prim_to_pl(opts->target_prim);",
          "new_line_content": "        target->repr.levels = mp_levels_to_pl(p->output_levels);",
          "content_same": false
        },
        {
          "line": 884,
          "old_api": "mp_trc_to_pl",
          "new_api": "mp_prim_to_pl",
          "old_text": "mp_trc_to_pl(opts->target_trc)",
          "new_text": "mp_prim_to_pl(opts->target_prim)",
          "old_line_content": "        target->color.transfer = mp_trc_to_pl(opts->target_trc);",
          "new_line_content": "        target->color.primaries = mp_prim_to_pl(opts->target_prim);",
          "content_same": false
        },
        {
          "line": 947,
          "old_api": "MPMIN",
          "new_api": "pl_rect_w",
          "old_text": "MPMIN(out_w / 2.0f, out_h)",
          "new_text": "pl_rect_w(target->crop)",
          "old_line_content": "    const float size = MPMIN(out_w / 2.0f, out_h);",
          "new_line_content": "    const float out_w = fabsf(pl_rect_w(target->crop));",
          "content_same": false
        },
        {
          "line": 1010,
          "old_api": "mp_prim_to_pl",
          "new_api": "get_mpi_csp",
          "old_text": "mp_prim_to_pl(opts->target_prim)",
          "new_text": "get_mpi_csp(vo, frame->current)",
          "old_line_content": "            hint.primaries = mp_prim_to_pl(opts->target_prim);",
          "new_line_content": "        struct pl_color_space hint = get_mpi_csp(vo, frame->current);",
          "content_same": false
        },
        {
          "line": 1012,
          "old_api": "mp_trc_to_pl",
          "new_api": "mp_prim_to_pl",
          "old_text": "mp_trc_to_pl(opts->target_trc)",
          "new_text": "mp_prim_to_pl(opts->target_prim)",
          "old_line_content": "            hint.transfer = mp_trc_to_pl(opts->target_trc);",
          "new_line_content": "            hint.primaries = mp_prim_to_pl(opts->target_prim);",
          "content_same": false
        },
        {
          "line": 1030,
          "old_api": "pl_frame_mix_radius",
          "new_api": "pl_queue_params",
          "old_text": "pl_frame_mix_radius(&params)",
          "new_text": "pl_queue_params(\n                .pts = frame->current->pts + vsync_offset,\n                .radius = pl_frame_mix_radius(&params),\n            )",
          "old_line_content": "                .radius = pl_frame_mix_radius(&params),",
          "new_line_content": "            pl_queue_update(p->queue, NULL, pl_queue_params(",
          "content_same": false
        },
        {
          "line": 1043,
          "old_api": "update_overlays",
          "new_api": "pl_frame_from_swapchain",
          "old_text": "update_overlays(vo, p->osd_res,\n                    (frame->current && opts->blend_subs) ? OSD_DRAW_OSD_ONLY : 0,\n                    PL_OVERLAY_COORDS_DST_FRAME, &p->osd_state, &target, frame->current)",
          "new_text": "pl_frame_from_swapchain(&target, &swframe)",
          "old_line_content": "    update_overlays(vo, p->osd_res,",
          "new_line_content": "    pl_frame_from_swapchain(&target, &swframe);",
          "content_same": false
        },
        {
          "line": 1064,
          "old_api": "pl_queue_update",
          "new_api": "MPMAX",
          "old_text": "pl_queue_update(p->queue, &mix, &qparams)",
          "new_text": "MPMAX(qparams.pts, p->last_pts)",
          "old_line_content": "        switch (pl_queue_update(p->queue, &mix, &qparams)) {",
          "new_line_content": "        qparams.pts = p->last_pts = MPMAX(qparams.pts, p->last_pts);",
          "content_same": false
        },
        {
          "line": 1066,
          "old_api": "MP_ERR",
          "new_api": "pl_queue_update",
          "old_text": "MP_ERR(vo, \"Failed updating frames!\\n\")",
          "new_text": "pl_queue_update(p->queue, &mix, &qparams)",
          "old_line_content": "            MP_ERR(vo, \"Failed updating frames!\\n\");",
          "new_line_content": "        switch (pl_queue_update(p->queue, &mix, &qparams)) {",
          "content_same": false
        },
        {
          "line": 1093,
          "old_api": "pl_rect_w",
          "new_api": "pl_rect_h",
          "old_text": "pl_rect_w(p->dst)",
          "new_text": "pl_rect_h(image->crop)",
          "old_line_content": "                        .w = pl_rect_w(p->dst),",
          "new_line_content": "                    float ry = pl_rect_h(p->dst) / pl_rect_h(image->crop);",
          "content_same": false
        },
        {
          "line": 1154,
          "old_api": "pl_gpu_flush",
          "new_api": "pl_tex_clear",
          "old_text": "pl_gpu_flush(gpu)",
          "new_text": "pl_tex_clear(gpu, swframe.fbo, (float[4]){ 0.5, 0.0, 1.0, 1.0 })",
          "old_line_content": "    pl_gpu_flush(gpu);",
          "new_line_content": "        pl_tex_clear(gpu, swframe.fbo, (float[4]){ 0.5, 0.0, 1.0, 1.0 });",
          "content_same": false
        },
        {
          "line": 1207,
          "old_api": "gpu_ctx_resize",
          "new_api": "vo_get_src_dst_rects",
          "old_text": "gpu_ctx_resize(p->context, vo->dwidth, vo->dheight)",
          "new_text": "vo_get_src_dst_rects(vo, &src, &dst, &osd)",
          "old_line_content": "        gpu_ctx_resize(p->context, vo->dwidth, vo->dheight);",
          "new_line_content": "    vo_get_src_dst_rects(vo, &src, &dst, &osd);",
          "content_same": false
        },
        {
          "line": 1213,
          "old_api": "osd_res_equals",
          "new_api": "mp_rect_equals",
          "old_text": "osd_res_equals(p->osd_res, osd)",
          "new_text": "mp_rect_equals(&p->src, &src)",
          "old_line_content": "        osd_res_equals(p->osd_res, osd))",
          "new_line_content": "    if (mp_rect_equals(&p->src, &src) &&",
          "content_same": false
        },
        {
          "line": 1263,
          "old_api": "control",
          "new_api": "MP_VERBOSE",
          "old_text": "p->ra_ctx->fns->control(p->ra_ctx, events, VOCTRL_GET_ICC_PROFILE, &icc)",
          "new_text": "MP_VERBOSE(p, \"Querying ICC profile...\\n\")",
          "old_line_content": "    int r = p->ra_ctx->fns->control(p->ra_ctx, events, VOCTRL_GET_ICC_PROFILE, &icc);",
          "new_line_content": "    MP_VERBOSE(p, \"Querying ICC profile...\\n\");",
          "content_same": false
        },
        {
          "line": 1269,
          "old_api": "MP_ERR",
          "new_api": "MP_WARN",
          "old_text": "MP_ERR(p, \"icc-profile-auto not implemented on this platform.\\n\")",
          "new_text": "MP_WARN(p, \"Could not retrieve an ICC profile.\\n\")",
          "old_line_content": "            MP_ERR(p, \"icc-profile-auto not implemented on this platform.\\n\");",
          "new_line_content": "            MP_WARN(p, \"Could not retrieve an ICC profile.\\n\");",
          "content_same": false
        },
        {
          "line": 1307,
          "old_api": "MP_ERR",
          "new_api": "assert",
          "old_text": "MP_ERR(vo, \"Unknown error occurred while trying to take screenshot!\\n\")",
          "new_text": "assert(status != PL_QUEUE_EOF)",
          "old_line_content": "        MP_ERR(vo, \"Unknown error occurred while trying to take screenshot!\\n\");",
          "new_line_content": "    assert(status != PL_QUEUE_EOF);",
          "content_same": false
        },
        {
          "line": 1397,
          "old_api": "update_tm_viz",
          "new_api": "apply_crop",
          "old_text": "update_tm_viz(&pars->color_map_params, &target)",
          "new_text": "apply_crop(&image, src, mpi->params.w, mpi->params.h)",
          "old_line_content": "    update_tm_viz(&pars->color_map_params, &target);",
          "new_line_content": "    apply_crop(&image, src, mpi->params.w, mpi->params.h);",
          "content_same": false
        },
        {
          "line": 1411,
          "old_api": "pl_rect_w",
          "new_api": "pl_rect_h",
          "old_text": "pl_rect_w(dst)",
          "new_text": "pl_rect_h(image.crop)",
          "old_line_content": "            .w = pl_rect_w(dst),",
          "new_line_content": "        float ry = pl_rect_h(dst) / pl_rect_h(image.crop);",
          "content_same": false
        },
        {
          "line": 1440,
          "old_api": "mp_levels_from_pl",
          "new_api": "mp_prim_from_pl",
          "old_text": "mp_levels_from_pl(target.repr.levels)",
          "new_text": "mp_prim_from_pl(target.color.primaries)",
          "old_line_content": "    args->res->params.color.levels = mp_levels_from_pl(target.repr.levels);",
          "new_line_content": "    args->res->params.color.primaries = mp_prim_from_pl(target.color.primaries);",
          "content_same": false
        },
        {
          "line": 1463,
          "old_api": "MPMIN",
          "new_api": "MP_ARRAY_SIZE",
          "old_text": "MPMIN(pl->count, VO_PASS_PERF_MAX)",
          "new_text": "MP_ARRAY_SIZE(mp->perf)",
          "old_line_content": "    mp->count = MPMIN(pl->count, VO_PASS_PERF_MAX);",
          "new_line_content": "    static_assert(MP_ARRAY_SIZE(pl->info) == MP_ARRAY_SIZE(mp->perf), \"\");",
          "content_same": false
        },
        {
          "line": 1562,
          "old_api": "update_auto_profile",
          "new_api": "control",
          "old_text": "update_auto_profile(p, &events)",
          "new_text": "p->ra_ctx->fns->control(p->ra_ctx, &events, request, data)",
          "old_line_content": "        if (update_auto_profile(p, &events))",
          "new_line_content": "    int r = p->ra_ctx->fns->control(p->ra_ctx, &events, request, data);",
          "content_same": false
        },
        {
          "line": 1587,
          "old_api": "vo_wait_default",
          "new_api": "wait_events",
          "old_text": "vo_wait_default(vo, until_time_ns)",
          "new_text": "p->ra_ctx->fns->wait_events(p->ra_ctx, until_time_ns)",
          "old_line_content": "        vo_wait_default(vo, until_time_ns);",
          "new_line_content": "        p->ra_ctx->fns->wait_events(p->ra_ctx, until_time_ns);",
          "content_same": false
        },
        {
          "line": 1602,
          "old_api": "mp_find_user_file",
          "new_api": "mp_get_user_path",
          "old_text": "mp_find_user_file(NULL, p->global, \"cache\", \"\")",
          "new_text": "mp_get_user_path(NULL, p->global, dir)",
          "old_line_content": "        dir = mp_find_user_file(NULL, p->global, \"cache\", \"\");",
          "new_line_content": "        dir = mp_get_user_path(NULL, p->global, dir);",
          "content_same": false
        },
        {
          "line": 1608,
          "old_api": "talloc_free",
          "new_api": "mp_mkdirp",
          "old_text": "talloc_free(dir)",
          "new_text": "mp_mkdirp(dir)",
          "old_line_content": "    talloc_free(dir);",
          "new_line_content": "        mp_mkdirp(dir);",
          "content_same": false
        },
        {
          "line": 1618,
          "old_api": "pl_tex_destroy",
          "new_api": "pl_queue_destroy",
          "old_text": "pl_tex_destroy(p->gpu, &p->osd_state.entries[i].tex)",
          "new_text": "pl_queue_destroy(&p->queue)",
          "old_line_content": "        pl_tex_destroy(p->gpu, &p->osd_state.entries[i].tex);",
          "new_line_content": "    pl_queue_destroy(&p->queue); // destroy this first",
          "content_same": false
        },
        {
          "line": 1622,
          "old_api": "pl_mpv_user_shader_destroy",
          "new_api": "pl_tex_destroy",
          "old_text": "pl_mpv_user_shader_destroy(&p->user_hooks[i].hook)",
          "new_text": "pl_tex_destroy(p->gpu, &p->sub_tex[i])",
          "old_line_content": "        pl_mpv_user_shader_destroy(&p->user_hooks[i].hook);",
          "new_line_content": "        pl_tex_destroy(p->gpu, &p->sub_tex[i]);",
          "content_same": false
        },
        {
          "line": 1627,
          "old_api": "hwdec_devices_set_loader",
          "new_api": "ra_hwdec_mapper_free",
          "old_text": "hwdec_devices_set_loader(vo->hwdec_devs, NULL, NULL)",
          "new_text": "ra_hwdec_mapper_free(&p->hwdec_mapper)",
          "old_line_content": "        hwdec_devices_set_loader(vo->hwdec_devs, NULL, NULL);",
          "new_line_content": "        ra_hwdec_mapper_free(&p->hwdec_mapper);",
          "content_same": false
        },
        {
          "line": 1628,
          "old_api": "hwdec_devices_destroy",
          "new_api": "ra_hwdec_ctx_uninit",
          "old_text": "hwdec_devices_destroy(vo->hwdec_devs)",
          "new_text": "ra_hwdec_ctx_uninit(&p->hwdec_ctx)",
          "old_line_content": "        hwdec_devices_destroy(vo->hwdec_devs);",
          "new_line_content": "        ra_hwdec_ctx_uninit(&p->hwdec_ctx);",
          "content_same": false
        },
        {
          "line": 1634,
          "old_api": "get_cache_file",
          "new_api": "pthread_mutex_destroy",
          "old_text": "get_cache_file(p)",
          "new_text": "pthread_mutex_destroy(&p->dr_lock)",
          "old_line_content": "    char *cache_file = get_cache_file(p);",
          "new_line_content": "    pthread_mutex_destroy(&p->dr_lock);",
          "content_same": false
        },
        {
          "line": 1636,
          "old_api": "fopen",
          "new_api": "get_cache_file",
          "old_text": "fopen(cache_file, \"wb\")",
          "new_text": "get_cache_file(p)",
          "old_line_content": "        FILE *cache = fopen(cache_file, \"wb\");",
          "new_line_content": "    char *cache_file = get_cache_file(p);",
          "content_same": false
        },
        {
          "line": 1638,
          "old_api": "pl_renderer_save",
          "new_api": "fopen",
          "old_text": "pl_renderer_save(p->rr, NULL)",
          "new_text": "fopen(cache_file, \"wb\")",
          "old_line_content": "            size_t size = pl_renderer_save(p->rr, NULL);",
          "new_line_content": "        FILE *cache = fopen(cache_file, \"wb\");",
          "content_same": false
        },
        {
          "line": 1641,
          "old_api": "fwrite",
          "new_api": "talloc_size",
          "old_text": "fwrite(buf, size, 1, cache)",
          "new_text": "talloc_size(NULL, size)",
          "old_line_content": "            fwrite(buf, size, 1, cache);",
          "new_line_content": "            uint8_t *buf = talloc_size(NULL, size);",
          "content_same": false
        },
        {
          "line": 1642,
          "old_api": "talloc_free",
          "new_api": "pl_renderer_save",
          "old_text": "talloc_free(buf)",
          "new_text": "pl_renderer_save(p->rr, buf)",
          "old_line_content": "            talloc_free(buf);",
          "new_line_content": "            pl_renderer_save(p->rr, buf);",
          "content_same": false
        },
        {
          "line": 1643,
          "old_api": "fclose",
          "new_api": "fwrite",
          "old_text": "fclose(cache)",
          "new_text": "fwrite(buf, size, 1, cache)",
          "old_line_content": "            fclose(cache);",
          "new_line_content": "            fwrite(buf, size, 1, cache);",
          "content_same": false
        },
        {
          "line": 1645,
          "old_api": "talloc_free",
          "new_api": "fclose",
          "old_text": "talloc_free(cache_file)",
          "new_text": "fclose(cache)",
          "old_line_content": "        talloc_free(cache_file);",
          "new_line_content": "            fclose(cache);",
          "content_same": false
        },
        {
          "line": 1694,
          "old_api": "ra_hwdec_ctx_init",
          "new_api": "hwdec_devices_create",
          "old_text": "ra_hwdec_ctx_init(&p->hwdec_ctx, vo->hwdec_devs, gl_opts->hwdec_interop, false)",
          "new_text": "hwdec_devices_create()",
          "old_line_content": "    ra_hwdec_ctx_init(&p->hwdec_ctx, vo->hwdec_devs, gl_opts->hwdec_interop, false);",
          "new_line_content": "    vo->hwdec_devs = hwdec_devices_create();",
          "content_same": false
        },
        {
          "line": 1695,
          "old_api": "pthread_mutex_init",
          "new_api": "hwdec_devices_set_loader",
          "old_text": "pthread_mutex_init(&p->dr_lock, NULL)",
          "new_text": "hwdec_devices_set_loader(vo->hwdec_devs, load_hwdec_api, vo)",
          "old_line_content": "    pthread_mutex_init(&p->dr_lock, NULL);",
          "new_line_content": "    hwdec_devices_set_loader(vo->hwdec_devs, load_hwdec_api, vo);",
          "content_same": false
        },
        {
          "line": 1708,
          "old_api": "pl_find_named_fmt",
          "new_api": "pl_renderer_create",
          "old_text": "pl_find_named_fmt(p->gpu, \"r8\")",
          "new_text": "pl_renderer_create(p->pllog, p->gpu)",
          "old_line_content": "    p->osd_fmt[SUBBITMAP_LIBASS] = pl_find_named_fmt(p->gpu, \"r8\");",
          "new_line_content": "    p->rr = pl_renderer_create(p->pllog, p->gpu);",
          "content_same": false
        },
        {
          "line": 1709,
          "old_api": "pl_find_named_fmt",
          "new_api": "pl_queue_create",
          "old_text": "pl_find_named_fmt(p->gpu, \"bgra8\")",
          "new_text": "pl_queue_create(p->gpu)",
          "old_line_content": "    p->osd_fmt[SUBBITMAP_BGRA] = pl_find_named_fmt(p->gpu, \"bgra8\");",
          "new_line_content": "    p->queue = pl_queue_create(p->gpu);",
          "content_same": false
        },
        {
          "line": 1714,
          "old_api": "stat",
          "new_api": "get_cache_file",
          "old_text": "stat(cache_file, &(struct stat){0})",
          "new_text": "get_cache_file(p)",
          "old_line_content": "        if (stat(cache_file, &(struct stat){0}) == 0) {",
          "new_line_content": "    char *cache_file = get_cache_file(p);",
          "content_same": false
        },
        {
          "line": 1716,
          "old_api": "pl_renderer_load",
          "new_api": "stat",
          "old_text": "pl_renderer_load(p->rr, c.start)",
          "new_text": "stat(cache_file, &(struct stat){0})",
          "old_line_content": "            pl_renderer_load(p->rr, c.start);",
          "new_line_content": "        if (stat(cache_file, &(struct stat){0}) == 0) {",
          "content_same": false
        },
        {
          "line": 1717,
          "old_api": "talloc_free",
          "new_api": "stream_read_file",
          "old_text": "talloc_free(c.start)",
          "new_text": "stream_read_file(cache_file, p, vo->global, 1000000000)",
          "old_line_content": "            talloc_free(c.start);",
          "new_line_content": "            bstr c = stream_read_file(cache_file, p, vo->global, 1000000000);",
          "content_same": false
        },
        {
          "line": 1769,
          "old_api": "pl_find_filter_function_preset",
          "new_api": "pl_find_filter_preset",
          "old_text": "pl_find_filter_function_preset(cfg->kernel.name)",
          "new_text": "pl_find_filter_preset(cfg->kernel.name)",
          "old_line_content": "    } else if ((fpreset = pl_find_filter_function_preset(cfg->kernel.name))) {",
          "new_line_content": "    if ((preset = pl_find_filter_preset(cfg->kernel.name))) {",
          "content_same": false
        },
        {
          "line": 1848,
          "old_api": "talloc_free",
          "new_api": "mp_get_user_path",
          "old_text": "talloc_free(fname)",
          "new_text": "mp_get_user_path(NULL, p->global, path)",
          "old_line_content": "    talloc_free(fname);",
          "new_line_content": "    char *fname = mp_get_user_path(NULL, p->global, path);",
          "content_same": false
        },
        {
          "line": 1854,
          "old_api": "MP_TARRAY_APPEND",
          "new_api": "pl_mpv_user_shader_parse",
          "old_text": "MP_TARRAY_APPEND(p, p->user_hooks, p->num_user_hooks, (struct user_hook) {\n        .path = talloc_strdup(p, path),\n        .hook = hook,\n    })",
          "new_text": "pl_mpv_user_shader_parse(p->gpu, shader.start, shader.len)",
          "old_line_content": "    MP_TARRAY_APPEND(p, p->user_hooks, p->num_user_hooks, (struct user_hook) {",
          "new_line_content": "        hook = pl_mpv_user_shader_parse(p->gpu, shader.start, shader.len);",
          "content_same": false
        },
        {
          "line": 1879,
          "old_api": "mp_find_user_file",
          "new_api": "mp_get_user_path",
          "old_text": "mp_find_user_file(NULL, p->global, \"cache\", \"\")",
          "new_text": "mp_get_user_path(NULL, p->global, cache_dir)",
          "old_line_content": "        cache_dir = mp_find_user_file(NULL, p->global, \"cache\", \"\");",
          "new_line_content": "        cache_dir = mp_get_user_path(NULL, p->global, cache_dir);",
          "content_same": false
        },
        {
          "line": 1962,
          "old_api": "stream_read_file",
          "new_api": "mp_get_user_path",
          "old_text": "stream_read_file(fname, p, p->global, 100000000)",
          "new_text": "mp_get_user_path(NULL, p->global, opts->profile)",
          "old_line_content": "    struct bstr icc = stream_read_file(fname, p, p->global, 100000000); // 100 MB",
          "new_line_content": "    char *fname = mp_get_user_path(NULL, p->global, opts->profile);",
          "content_same": false
        },
        {
          "line": 1963,
          "old_api": "talloc_free",
          "new_api": "MP_VERBOSE",
          "old_text": "talloc_free(fname)",
          "new_text": "MP_VERBOSE(p, \"Opening ICC profile '%s'\\n\", fname)",
          "old_line_content": "    talloc_free(fname);",
          "new_line_content": "    MP_VERBOSE(p, \"Opening ICC profile '%s'\\n\", fname);",
          "content_same": false
        },
        {
          "line": 1964,
          "old_api": "update_icc",
          "new_api": "stream_read_file",
          "old_text": "update_icc(p, icc)",
          "new_text": "stream_read_file(fname, p, p->global, 100000000)",
          "old_line_content": "    update_icc(p, icc);",
          "new_line_content": "    struct bstr icc = stream_read_file(fname, p, p->global, 100000000); // 100 MB",
          "content_same": false
        },
        {
          "line": 1985,
          "old_api": "talloc_strdup",
          "new_api": "pl_lut_free",
          "old_text": "talloc_strdup(p, lut->opt)",
          "new_text": "pl_lut_free(&lut->lut)",
          "old_line_content": "    lut->path = talloc_strdup(p, lut->opt);",
          "new_line_content": "    pl_lut_free(&lut->lut);",
          "content_same": false
        },
        {
          "line": 1990,
          "old_api": "stream_read_file",
          "new_api": "mp_get_user_path",
          "old_text": "stream_read_file(fname, p, p->global, 100000000)",
          "new_text": "mp_get_user_path(NULL, p->global, lut->path)",
          "old_line_content": "    struct bstr lutdata = stream_read_file(fname, p, p->global, 100000000); // 100 MB",
          "new_line_content": "    char *fname = mp_get_user_path(NULL, p->global, lut->path);",
          "content_same": false
        },
        {
          "line": 1991,
          "old_api": "pl_lut_parse_cube",
          "new_api": "MP_VERBOSE",
          "old_text": "pl_lut_parse_cube(p->pllog, lutdata.start, lutdata.len)",
          "new_text": "MP_VERBOSE(p, \"Loading custom LUT '%s'\\n\", fname)",
          "old_line_content": "    lut->lut = pl_lut_parse_cube(p->pllog, lutdata.start, lutdata.len);",
          "new_line_content": "    MP_VERBOSE(p, \"Loading custom LUT '%s'\\n\", fname);",
          "content_same": false
        },
        {
          "line": 1992,
          "old_api": "talloc_free",
          "new_api": "stream_read_file",
          "old_text": "talloc_free(lutdata.start)",
          "new_text": "stream_read_file(fname, p, p->global, 100000000)",
          "old_line_content": "    talloc_free(lutdata.start);",
          "new_line_content": "    struct bstr lutdata = stream_read_file(fname, p, p->global, 100000000); // 100 MB",
          "content_same": false
        },
        {
          "line": 2003,
          "old_api": "mp_splitext",
          "new_api": "mp_basename",
          "old_text": "mp_splitext(basename, &shadername)",
          "new_text": "mp_basename(shaderpath)",
          "old_line_content": "    if (!mp_splitext(basename, &shadername))",
          "new_line_content": "    const char *basename = mp_basename(shaderpath);",
          "content_same": false
        },
        {
          "line": 2010,
          "old_api": "bstrchr",
          "new_api": "bstr0",
          "old_text": "bstrchr(k, '/')",
          "new_text": "bstr0(opts[n * 2 + 1])",
          "old_line_content": "        if ((pos = bstrchr(k, '/')) >= 0) {",
          "new_line_content": "        struct bstr v = bstr0(opts[n * 2 + 1]);",
          "content_same": false
        },
        {
          "line": 2013,
          "old_api": "bstr_cut",
          "new_api": "bstr_splice",
          "old_text": "bstr_cut(k, pos + 1)",
          "new_text": "bstr_splice(k, 0, pos)",
          "old_line_content": "            k = bstr_cut(k, pos + 1);",
          "new_line_content": "            if (!bstr_equals(bstr_splice(k, 0, pos), shadername))",
          "content_same": false
        },
        {
          "line": 2155,
          "old_api": "MP_WARN",
          "new_api": "pl_find_error_diffusion_kernel",
          "old_text": "MP_WARN(p, \"Could not find error diffusion kernel '%s', falling \"\n                    \"back to fruit.\\n\", opts->error_diffusion)",
          "new_text": "pl_find_error_diffusion_kernel(opts->error_diffusion)",
          "old_line_content": "            MP_WARN(p, \"Could not find error diffusion kernel '%s', falling \"",
          "new_line_content": "        pars->params.error_diffusion = pl_find_error_diffusion_kernel(opts->error_diffusion);",
          "content_same": false
        },
        {
          "line": 2180,
          "old_api": "update_hook_opts",
          "new_api": "load_hook",
          "old_text": "update_hook_opts(p, opts->user_shader_opts, opts->user_shaders[i], hook)",
          "new_text": "load_hook(p, opts->user_shaders[i])",
          "old_line_content": "            update_hook_opts(p, opts->user_shader_opts, opts->user_shaders[i], hook);",
          "new_line_content": "        if ((hook = load_hook(p, opts->user_shaders[i]))) {",
          "content_same": false
        },
        {
          "line": 2226,
          "old_api": "OPT_STRING",
          "new_api": "M_RANGE",
          "old_text": "OPT_STRING(lut.opt)",
          "new_text": "M_RANGE(0, 1)",
          "old_line_content": "        {\"lut\", OPT_STRING(lut.opt), .flags = M_OPT_FILE},",
          "new_line_content": "        {\"corner-rounding\", OPT_FLOAT(corner_rounding), M_RANGE(0, 1)},",
          "content_same": false
        },
        {
          "line": 2227,
          "old_api": "OPT_CHOICE_C",
          "new_api": "OPT_BOOL",
          "old_text": "OPT_CHOICE_C(lut.type, lut_types)",
          "new_text": "OPT_BOOL(inter_preserve)",
          "old_line_content": "        {\"lut-type\", OPT_CHOICE_C(lut.type, lut_types)},",
          "new_line_content": "        {\"interpolation-preserve\", OPT_BOOL(inter_preserve)},",
          "content_same": false
        },
        {
          "line": 2231,
          "old_api": "OPT_BOOL",
          "new_api": "OPT_CHOICE_C",
          "old_text": "OPT_BOOL(target_hint)",
          "new_text": "OPT_CHOICE_C(image_lut.type, lut_types)",
          "old_line_content": "        {\"target-colorspace-hint\", OPT_BOOL(target_hint)},",
          "new_line_content": "        {\"image-lut-type\", OPT_CHOICE_C(image_lut.type, lut_types)},",
          "content_same": false
        },
        {
          "line": 2233,
          "old_api": "OPT_KEYVALUELIST",
          "new_api": "OPT_BOOL",
          "old_text": "OPT_KEYVALUELIST(raw_opts)",
          "new_text": "OPT_BOOL(target_hint)",
          "old_line_content": "        {\"libplacebo-opts\", OPT_KEYVALUELIST(raw_opts)},",
          "new_line_content": "        {\"target-colorspace-hint\", OPT_BOOL(target_hint)},",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1026,
          "old_api": null,
          "new_api": "start_frame",
          "old_text": null,
          "new_text": "sw->fns->start_frame(sw, NULL)",
          "old_line_content": "        if (frame->current) {",
          "new_line_content": "    bool should_draw = sw->fns->start_frame(sw, NULL); // for wayland logic",
          "content_same": false
        },
        {
          "line": 2051,
          "old_api": null,
          "new_api": "MPMIN",
          "old_text": null,
          "new_text": "MPMIN(hp->minimum.u, INT_MAX)",
          "old_line_content": "                break;",
          "new_line_content": "                opt.min = MPMIN(hp->minimum.u, INT_MAX);",
          "content_same": false
        },
        {
          "line": 2052,
          "old_api": null,
          "new_api": "MPMIN",
          "old_text": null,
          "new_text": "MPMIN(hp->maximum.u, INT_MAX)",
          "old_line_content": "            }",
          "new_line_content": "                opt.max = MPMIN(hp->maximum.u, INT_MAX);",
          "content_same": false
        },
        {
          "line": 1027,
          "old_api": null,
          "new_api": "pl_swapchain_start_frame",
          "old_text": null,
          "new_text": "pl_swapchain_start_frame(p->sw, &swframe)",
          "old_line_content": "            // Advance the queue state to the current PTS to discard unused frames",
          "new_line_content": "    if (!should_draw || !pl_swapchain_start_frame(p->sw, &swframe)) {",
          "content_same": false
        },
        {
          "line": 2056,
          "old_api": null,
          "new_api": "parse",
          "old_text": null,
          "new_text": "opt.type->parse(p->log, &opt, k, v, hp->data)",
          "old_line_content": "        }",
          "new_line_content": "            opt.type->parse(p->log, &opt, k, v, hp->data);",
          "content_same": false
        },
        {
          "line": 1032,
          "old_api": null,
          "new_api": "pl_frame_mix_radius",
          "old_text": null,
          "new_text": "pl_frame_mix_radius(&params)",
          "old_line_content": "        }",
          "new_line_content": "                .radius = pl_frame_mix_radius(&params),",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": null,
          "new_api": "av_q2d",
          "old_text": null,
          "new_text": "av_q2d(mdm->min_luminance)",
          "old_line_content": "            }",
          "new_line_content": "                csp.hdr.min_luma = av_q2d(mdm->min_luminance);",
          "content_same": false
        },
        {
          "line": 523,
          "old_api": null,
          "new_api": "av_q2d",
          "old_text": null,
          "new_text": "av_q2d(mdm->max_luminance)",
          "old_line_content": "",
          "new_line_content": "                csp.hdr.max_luma = av_q2d(mdm->max_luminance);",
          "content_same": false
        },
        {
          "line": 1529,
          "old_api": null,
          "new_api": "copy_frame_info_to_mp",
          "old_text": null,
          "new_text": "copy_frame_info_to_mp(&p->perf_redraw, &perf->redraw)",
          "old_line_content": "    }",
          "new_line_content": "        copy_frame_info_to_mp(&p->perf_redraw, &perf->redraw);",
          "content_same": false
        },
        {
          "line": 1549,
          "old_api": null,
          "new_api": "video_screenshot",
          "old_text": null,
          "new_text": "video_screenshot(vo, data)",
          "old_line_content": "",
          "new_line_content": "        video_screenshot(vo, data);",
          "content_same": false
        },
        {
          "line": 1553,
          "old_api": null,
          "new_api": "reconfig",
          "old_text": null,
          "new_text": "reconfig(vo, NULL)",
          "old_line_content": "",
          "new_line_content": "        reconfig(vo, NULL);",
          "content_same": false
        },
        {
          "line": 1044,
          "old_api": null,
          "new_api": "apply_target_options",
          "old_text": null,
          "new_text": "apply_target_options(p, &target)",
          "old_line_content": "                    (frame->current && opts->blend_subs) ? OSD_DRAW_OSD_ONLY : 0,",
          "new_line_content": "    apply_target_options(p, &target);",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": null,
          "new_api": "av_q2d",
          "old_text": null,
          "new_text": "av_q2d(mdm->white_point[0])",
          "old_line_content": "            }",
          "new_line_content": "                csp.hdr.prim.white.x = av_q2d(mdm->white_point[0]);",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": null,
          "new_api": "av_q2d",
          "old_text": null,
          "new_text": "av_q2d(mdm->white_point[1])",
          "old_line_content": "            break;",
          "new_line_content": "                csp.hdr.prim.white.y = av_q2d(mdm->white_point[1]);",
          "content_same": false
        },
        {
          "line": 1045,
          "old_api": null,
          "new_api": "update_overlays",
          "old_text": null,
          "new_text": "update_overlays(vo, p->osd_res,\n                    (frame->current && opts->blend_subs) ? OSD_DRAW_OSD_ONLY : 0,\n                    PL_OVERLAY_COORDS_DST_FRAME, &p->osd_state, &target, frame->current)",
          "old_line_content": "                    PL_OVERLAY_COORDS_DST_FRAME, &p->osd_state, &target, frame->current);",
          "new_line_content": "    update_overlays(vo, p->osd_res,",
          "content_same": false
        },
        {
          "line": 1048,
          "old_api": null,
          "new_api": "apply_crop",
          "old_text": null,
          "new_text": "apply_crop(&target, p->dst, swframe.fbo->params.w, swframe.fbo->params.h)",
          "old_line_content": "",
          "new_line_content": "    apply_crop(&target, p->dst, swframe.fbo->params.w, swframe.fbo->params.h);",
          "content_same": false
        },
        {
          "line": 1049,
          "old_api": null,
          "new_api": "update_tm_viz",
          "old_text": null,
          "new_text": "update_tm_viz(&pars->color_map_params, &target)",
          "old_line_content": "    struct pl_frame_mix mix = {0};",
          "new_line_content": "    update_tm_viz(&pars->color_map_params, &target);",
          "content_same": false
        },
        {
          "line": 1557,
          "old_api": null,
          "new_api": "ra_hwdec_ctx_load_fmt",
          "old_text": null,
          "new_text": "ra_hwdec_ctx_load_fmt(&p->hwdec_ctx, vo->hwdec_devs, data)",
          "old_line_content": "    }",
          "new_line_content": "        ra_hwdec_ctx_load_fmt(&p->hwdec_ctx, vo->hwdec_devs, data);",
          "content_same": false
        },
        {
          "line": 1564,
          "old_api": null,
          "new_api": "update_auto_profile",
          "old_text": null,
          "new_text": "update_auto_profile(p, &events)",
          "old_line_content": "    }",
          "new_line_content": "        if (update_auto_profile(p, &events))",
          "content_same": false
        },
        {
          "line": 1056,
          "old_api": null,
          "new_api": "pl_frame_mix_radius",
          "old_text": null,
          "new_text": "pl_frame_mix_radius(&params)",
          "old_line_content": "            .interpolation_threshold = opts->interpolation_threshold,",
          "new_line_content": "            .radius = pl_frame_mix_radius(&params),",
          "content_same": false
        },
        {
          "line": 1568,
          "old_api": null,
          "new_api": "resize",
          "old_text": null,
          "new_text": "resize(vo)",
          "old_line_content": "        vo->want_redraw = true;",
          "new_line_content": "        resize(vo);",
          "content_same": false
        },
        {
          "line": 1571,
          "old_api": null,
          "new_api": "vo_event",
          "old_text": null,
          "new_text": "vo_event(vo, events)",
          "old_line_content": "    return r;",
          "new_line_content": "    vo_event(vo, events);",
          "content_same": false
        },
        {
          "line": 2086,
          "old_api": null,
          "new_api": "map_scaler",
          "old_text": null,
          "new_text": "map_scaler(p, SCALER_CSCALE)",
          "old_line_content": "",
          "new_line_content": "    pars->params.plane_upscaler = map_scaler(p, SCALER_CSCALE);",
          "content_same": false
        },
        {
          "line": 2087,
          "old_api": null,
          "new_api": "map_scaler",
          "old_text": null,
          "new_text": "map_scaler(p, SCALER_TSCALE)",
          "old_line_content": "    // Request as many frames as required from the decoder",
          "new_line_content": "    pars->params.frame_mixer = opts->interpolation ? map_scaler(p, SCALER_TSCALE) : NULL;",
          "content_same": false
        },
        {
          "line": 550,
          "old_api": null,
          "new_api": "mp_image_params_equal",
          "old_text": null,
          "new_text": "mp_image_params_equal(par, &p->hwdec_mapper->src_params)",
          "old_line_content": "        } else {",
          "new_line_content": "        if (mp_image_params_equal(par, &p->hwdec_mapper->src_params)) {",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": null,
          "new_api": "ra_hwdec_mapper_free",
          "old_text": null,
          "new_text": "ra_hwdec_mapper_free(&p->hwdec_mapper)",
          "old_line_content": "    }",
          "new_line_content": "            ra_hwdec_mapper_free(&p->hwdec_mapper);",
          "content_same": false
        },
        {
          "line": 2092,
          "old_api": null,
          "new_api": "ceilf",
          "old_text": null,
          "new_text": "ceilf(pars->params.frame_mixer->kernel->radius)",
          "old_line_content": "",
          "new_line_content": "        req_frames += ceilf(pars->params.frame_mixer->kernel->radius);",
          "content_same": false
        },
        {
          "line": 2093,
          "old_api": null,
          "new_api": "vo_set_queue_params",
          "old_text": null,
          "new_text": "vo_set_queue_params(vo, 0, req_frames)",
          "old_line_content": "    pars->params.deband_params = opts->deband ? &pars->deband_params : NULL;",
          "new_line_content": "    vo_set_queue_params(vo, 0, req_frames);",
          "content_same": false
        },
        {
          "line": 1068,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(vo, \"Failed updating frames!\\n\")",
          "old_line_content": "        case PL_QUEUE_EOF:",
          "new_line_content": "            MP_ERR(vo, \"Failed updating frames!\\n\");",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(p, \"Initializing texture for hardware decoding failed.\\n\")",
          "old_line_content": "    }",
          "new_line_content": "        MP_ERR(p, \"Initializing texture for hardware decoding failed.\\n\");",
          "content_same": false
        },
        {
          "line": 1071,
          "old_api": null,
          "new_api": "abort",
          "old_text": null,
          "new_text": "abort()",
          "old_line_content": "            // This is expected to happen semi-frequently near the start and",
          "new_line_content": "            abort(); // we never signal EOF",
          "content_same": false
        },
        {
          "line": 1580,
          "old_api": null,
          "new_api": "wakeup",
          "old_text": null,
          "new_text": "p->ra_ctx->fns->wakeup(p->ra_ctx)",
          "old_line_content": "",
          "new_line_content": "        p->ra_ctx->fns->wakeup(p->ra_ctx);",
          "content_same": false
        },
        {
          "line": 1075,
          "old_api": null,
          "new_api": "MP_DBG",
          "old_text": null,
          "new_text": "MP_DBG(vo, \"Render queue underrun.\\n\")",
          "old_line_content": "        case PL_QUEUE_OK:",
          "new_line_content": "            MP_DBG(vo, \"Render queue underrun.\\n\");",
          "content_same": false
        },
        {
          "line": 1589,
          "old_api": null,
          "new_api": "vo_wait_default",
          "old_text": null,
          "new_text": "vo_wait_default(vo, until_time_ns)",
          "old_line_content": "}",
          "new_line_content": "        vo_wait_default(vo, until_time_ns);",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": null,
          "new_api": "ra_pl_get",
          "old_text": null,
          "new_text": "ra_pl_get(ra)",
          "old_line_content": "",
          "new_line_content": "    if (ra_pl_get(ra))",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": null,
          "new_api": "pl_opengl_get",
          "old_text": null,
          "new_text": "pl_opengl_get(p->gpu)",
          "old_line_content": "            .width = ratex->params.w,",
          "new_line_content": "    if (ra_is_gl(ra) && pl_opengl_get(p->gpu)) {",
          "content_same": false
        },
        {
          "line": 1089,
          "old_api": null,
          "new_api": "apply_crop",
          "old_text": null,
          "new_text": "apply_crop(image, p->src, vo->params->w, vo->params->h)",
          "old_line_content": "                if (p->paused || fp->osd_sync < p->osd_sync) {",
          "new_line_content": "            apply_crop(image, p->src, vo->params->w, vo->params->h);",
          "content_same": false
        },
        {
          "line": 1092,
          "old_api": null,
          "new_api": "pl_rect_w",
          "old_text": null,
          "new_text": "pl_rect_w(image->crop)",
          "old_line_content": "                    struct mp_osd_res res = {",
          "new_line_content": "                    float rx = pl_rect_w(p->dst) / pl_rect_w(image->crop);",
          "content_same": false
        },
        {
          "line": 1604,
          "old_api": null,
          "new_api": "mp_find_user_file",
          "old_text": null,
          "new_text": "mp_find_user_file(NULL, p->global, \"cache\", \"\")",
          "old_line_content": "    if (dir && dir[0]) {",
          "new_line_content": "        dir = mp_find_user_file(NULL, p->global, \"cache\", \"\");",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": null,
          "new_api": "ra_gl_get_raw_tex",
          "old_text": null,
          "new_text": "ra_gl_get_raw_tex(ra, ratex, &par.texture, &par.target)",
          "old_line_content": "    }",
          "new_line_content": "        ra_gl_get_raw_tex(ra, ratex, &par.texture, &par.target);",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": null,
          "new_api": "pl_opengl_wrap",
          "old_text": null,
          "new_text": "pl_opengl_wrap(p->gpu, &par)",
          "old_line_content": "#endif",
          "new_line_content": "        return pl_opengl_wrap(p->gpu, &par);",
          "content_same": false
        },
        {
          "line": 1095,
          "old_api": null,
          "new_api": "pl_rect_w",
          "old_text": null,
          "new_text": "pl_rect_w(p->dst)",
          "old_line_content": "                        .ml = -image->crop.x0 * rx,",
          "new_line_content": "                        .w = pl_rect_w(p->dst),",
          "content_same": false
        },
        {
          "line": 1096,
          "old_api": null,
          "new_api": "pl_rect_h",
          "old_text": null,
          "new_text": "pl_rect_h(p->dst)",
          "old_line_content": "                        .mr = (image->crop.x1 - vo->params->w) * rx,",
          "new_line_content": "                        .h = pl_rect_h(p->dst),",
          "content_same": false
        },
        {
          "line": 1607,
          "old_api": null,
          "new_api": "mp_path_join",
          "old_text": null,
          "new_text": "mp_path_join(NULL, dir, \"libplacebo.cache\")",
          "old_line_content": "    }",
          "new_line_content": "        file = mp_path_join(NULL, dir, \"libplacebo.cache\");",
          "content_same": false
        },
        {
          "line": 1610,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(dir)",
          "old_line_content": "    return file;",
          "new_line_content": "    talloc_free(dir);",
          "content_same": false
        },
        {
          "line": 591,
          "old_api": null,
          "new_api": "ra_d3d11_get_raw_tex",
          "old_text": null,
          "new_text": "ra_d3d11_get_raw_tex(ra, ratex, &array_slice)",
          "old_line_content": "            .tex = res,",
          "new_line_content": "        ID3D11Resource *res = ra_d3d11_get_raw_tex(ra, ratex, &array_slice);",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": null,
          "new_api": "pl_d3d11_wrap_params",
          "old_text": null,
          "new_text": "pl_d3d11_wrap_params(\n            .tex = res,\n            .array_slice = array_slice,\n            .fmt = ra_d3d11_get_format(ratex->params.format),\n            .w = ratex->params.w,\n            .h = ratex->params.h,\n        )",
          "old_line_content": "            .array_slice = array_slice,",
          "new_line_content": "        pl_tex tex = pl_d3d11_wrap(p->gpu, pl_d3d11_wrap_params(",
          "content_same": false
        },
        {
          "line": 1103,
          "old_api": null,
          "new_api": "update_overlays",
          "old_text": null,
          "new_text": "update_overlays(vo, res, OSD_DRAW_SUB_ONLY,\n                                    PL_OVERLAY_COORDS_DST_CROP,\n                                    &fp->subs, image, mpi)",
          "old_line_content": "                                    &fp->subs, image, mpi);",
          "new_line_content": "                    update_overlays(vo, res, OSD_DRAW_SUB_ONLY,",
          "content_same": false
        },
        {
          "line": 595,
          "old_api": null,
          "new_api": "ra_d3d11_get_format",
          "old_text": null,
          "new_text": "ra_d3d11_get_format(ratex->params.format)",
          "old_line_content": "            .h = ratex->params.h,",
          "new_line_content": "            .fmt = ra_d3d11_get_format(ratex->params.format),",
          "content_same": false
        },
        {
          "line": 1619,
          "old_api": null,
          "new_api": "MP_ARRAY_SIZE",
          "old_text": null,
          "new_text": "MP_ARRAY_SIZE(p->osd_state.entries)",
          "old_line_content": "    for (int i = 0; i < p->num_sub_tex; i++)",
          "new_line_content": "    for (int i = 0; i < MP_ARRAY_SIZE(p->osd_state.entries); i++)",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": null,
          "new_api": "SAFE_RELEASE",
          "old_text": null,
          "new_text": "SAFE_RELEASE(res)",
          "old_line_content": "    }",
          "new_line_content": "        SAFE_RELEASE(res);",
          "content_same": false
        },
        {
          "line": 1624,
          "old_api": null,
          "new_api": "pl_mpv_user_shader_destroy",
          "old_text": null,
          "new_text": "pl_mpv_user_shader_destroy(&p->user_hooks[i].hook)",
          "old_line_content": "    if (vo->hwdec_devs) {",
          "new_line_content": "        pl_mpv_user_shader_destroy(&p->user_hooks[i].hook);",
          "content_same": false
        },
        {
          "line": 604,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(p, \"Failed mapping hwdec frame? Open a bug!\\n\")",
          "old_line_content": "}",
          "new_line_content": "    MP_ERR(p, \"Failed mapping hwdec frame? Open a bug!\\n\");",
          "content_same": false
        },
        {
          "line": 1629,
          "old_api": null,
          "new_api": "hwdec_devices_set_loader",
          "old_text": null,
          "new_text": "hwdec_devices_set_loader(vo->hwdec_devs, NULL, NULL)",
          "old_line_content": "    }",
          "new_line_content": "        hwdec_devices_set_loader(vo->hwdec_devs, NULL, NULL);",
          "content_same": false
        },
        {
          "line": 2142,
          "old_api": null,
          "new_api": "isnan",
          "old_text": null,
          "new_text": "isnan(pars->color_map_params.tone_mapping_param)",
          "old_line_content": "    pars->color_map_params.inverse_tone_mapping = opts->tone_map.inverse;",
          "new_line_content": "    if (isnan(pars->color_map_params.tone_mapping_param)) // vo_gpu compatibility",
          "content_same": false
        },
        {
          "line": 1630,
          "old_api": null,
          "new_api": "hwdec_devices_destroy",
          "old_text": null,
          "new_text": "hwdec_devices_destroy(vo->hwdec_devs)",
          "old_line_content": "",
          "new_line_content": "        hwdec_devices_destroy(vo->hwdec_devs);",
          "content_same": false
        },
        {
          "line": 1633,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(p->num_dr_buffers == 0)",
          "old_line_content": "",
          "new_line_content": "    assert(p->num_dr_buffers == 0);",
          "content_same": false
        },
        {
          "line": 613,
          "old_api": null,
          "new_api": "hwdec_reconfig",
          "old_text": null,
          "new_text": "hwdec_reconfig(p, fp->hwdec, &mpi->params)",
          "old_line_content": "",
          "new_line_content": "    if (!hwdec_reconfig(p, fp->hwdec, &mpi->params))",
          "content_same": false
        },
        {
          "line": 1126,
          "old_api": null,
          "new_api": "pl_render_image_mix",
          "old_text": null,
          "new_text": "pl_render_image_mix(p->rr, &mix, &target, &params)",
          "old_line_content": "        goto done;",
          "new_line_content": "    if (!pl_render_image_mix(p->rr, &mix, &target, &params)) {",
          "content_same": false
        },
        {
          "line": 1127,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(vo, \"Failed rendering frame!\\n\")",
          "old_line_content": "    }",
          "new_line_content": "        MP_ERR(vo, \"Failed rendering frame!\\n\");",
          "content_same": false
        },
        {
          "line": 616,
          "old_api": null,
          "new_api": "ra_hwdec_mapper_map",
          "old_text": null,
          "new_text": "ra_hwdec_mapper_map(p->hwdec_mapper, mpi)",
          "old_line_content": "        return false;",
          "new_line_content": "    if (ra_hwdec_mapper_map(p->hwdec_mapper, mpi) < 0) {",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(p, \"Mapping hardware decoded surface failed.\\n\")",
          "old_line_content": "    }",
          "new_line_content": "        MP_ERR(p, \"Mapping hardware decoded surface failed.\\n\");",
          "content_same": false
        },
        {
          "line": 1644,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(buf)",
          "old_line_content": "        }",
          "new_line_content": "            talloc_free(buf);",
          "content_same": false
        },
        {
          "line": 2157,
          "old_api": null,
          "new_api": "MP_WARN",
          "old_text": null,
          "new_text": "MP_WARN(p, \"Could not find error diffusion kernel '%s', falling \"\n                    \"back to fruit.\\n\", opts->error_diffusion)",
          "old_line_content": "        }",
          "new_line_content": "            MP_WARN(p, \"Could not find error diffusion kernel '%s', falling \"",
          "content_same": false
        },
        {
          "line": 622,
          "old_api": null,
          "new_api": "hwdec_get_tex",
          "old_text": null,
          "new_text": "hwdec_get_tex(p, n)",
          "old_line_content": "    }",
          "new_line_content": "        if (!(frame->planes[n].texture = hwdec_get_tex(p, n)))",
          "content_same": false
        },
        {
          "line": 1647,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(cache_file)",
          "old_line_content": "",
          "new_line_content": "        talloc_free(cache_file);",
          "content_same": false
        },
        {
          "line": 1650,
          "old_api": null,
          "new_api": "pl_renderer_destroy",
          "old_text": null,
          "new_text": "pl_renderer_destroy(&p->rr)",
          "old_line_content": "    for (int i = 0; i < VO_PASS_PERF_MAX; ++i) {",
          "new_line_content": "    pl_renderer_destroy(&p->rr);",
          "content_same": false
        },
        {
          "line": 1653,
          "old_api": null,
          "new_api": "pl_shader_info_deref",
          "old_text": null,
          "new_text": "pl_shader_info_deref(&p->perf_fresh.info[i].shader)",
          "old_line_content": "    }",
          "new_line_content": "        pl_shader_info_deref(&p->perf_fresh.info[i].shader);",
          "content_same": false
        },
        {
          "line": 1142,
          "old_api": null,
          "new_api": "pl_renderer_get_hdr_metadata",
          "old_text": null,
          "new_text": "pl_renderer_get_hdr_metadata(p->rr, &p->last_hdr_metadata)",
          "old_line_content": "    } else {",
          "new_line_content": "        pl_renderer_get_hdr_metadata(p->rr, &p->last_hdr_metadata);",
          "content_same": false
        },
        {
          "line": 1654,
          "old_api": null,
          "new_api": "pl_shader_info_deref",
          "old_text": null,
          "new_text": "pl_shader_info_deref(&p->perf_redraw.info[i].shader)",
          "old_line_content": "",
          "new_line_content": "        pl_shader_info_deref(&p->perf_redraw.info[i].shader);",
          "content_same": false
        },
        {
          "line": 1657,
          "old_api": null,
          "new_api": "pl_options_free",
          "old_text": null,
          "new_text": "pl_options_free(&p->pars)",
          "old_line_content": "    p->ra_ctx = NULL;",
          "new_line_content": "    pl_options_free(&p->pars);",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": null,
          "new_api": "pl_tex_destroy",
          "old_text": null,
          "new_text": "pl_tex_destroy(p->gpu, &frame->planes[n].texture)",
          "old_line_content": "",
          "new_line_content": "            pl_tex_destroy(p->gpu, &frame->planes[n].texture);",
          "content_same": false
        },
        {
          "line": 639,
          "old_api": null,
          "new_api": "ra_hwdec_mapper_unmap",
          "old_text": null,
          "new_text": "ra_hwdec_mapper_unmap(p->hwdec_mapper)",
          "old_line_content": "",
          "new_line_content": "    ra_hwdec_mapper_unmap(p->hwdec_mapper);",
          "content_same": false
        },
        {
          "line": 2175,
          "old_api": null,
          "new_api": "update_icc_opts",
          "old_text": null,
          "new_text": "update_icc_opts(p, opts->icc_opts)",
          "old_line_content": "    pars->params.num_hooks = 0;",
          "new_line_content": "    update_icc_opts(p, opts->icc_opts);",
          "content_same": false
        },
        {
          "line": 1663,
          "old_api": null,
          "new_api": "gpu_ctx_destroy",
          "old_text": null,
          "new_text": "gpu_ctx_destroy(&p->context)",
          "old_line_content": "",
          "new_line_content": "    gpu_ctx_destroy(&p->context);",
          "content_same": false
        },
        {
          "line": 1156,
          "old_api": null,
          "new_api": "pl_gpu_flush",
          "old_text": null,
          "new_text": "pl_gpu_flush(gpu)",
          "old_line_content": "}",
          "new_line_content": "    pl_gpu_flush(gpu);",
          "content_same": false
        },
        {
          "line": 2181,
          "old_api": null,
          "new_api": "MP_TARRAY_APPEND",
          "old_text": null,
          "new_text": "MP_TARRAY_APPEND(p, p->hooks, pars->params.num_hooks, hook)",
          "old_line_content": "        }",
          "new_line_content": "            MP_TARRAY_APPEND(p, p->hooks, pars->params.num_hooks, hook);",
          "content_same": false
        },
        {
          "line": 2182,
          "old_api": null,
          "new_api": "update_hook_opts",
          "old_text": null,
          "new_text": "update_hook_opts(p, opts->user_shader_opts, opts->user_shaders[i], hook)",
          "old_line_content": "    }",
          "new_line_content": "            update_hook_opts(p, opts->user_shader_opts, opts->user_shaders[i], hook);",
          "content_same": false
        },
        {
          "line": 1668,
          "old_api": null,
          "new_api": "vo_control",
          "old_text": null,
          "new_text": "vo_control(ctx, VOCTRL_LOAD_HWDEC_API, params)",
          "old_line_content": "",
          "new_line_content": "    vo_control(ctx, VOCTRL_LOAD_HWDEC_API, params);",
          "content_same": false
        },
        {
          "line": 1674,
          "old_api": null,
          "new_api": "m_config_cache_alloc",
          "old_text": null,
          "new_text": "m_config_cache_alloc(p, vo->global, &gl_video_conf)",
          "old_line_content": "    p->global = vo->global;",
          "new_line_content": "    p->opts_cache = m_config_cache_alloc(p, vo->global, &gl_video_conf);",
          "content_same": false
        },
        {
          "line": 651,
          "old_api": null,
          "new_api": "ra_hwdec_get",
          "old_text": null,
          "new_text": "ra_hwdec_get(&p->hwdec_ctx, mpi->imgfmt)",
          "old_line_content": "        // Note: We don't actually need the mapper to map the frame yet, we",
          "new_line_content": "    fp->hwdec = ra_hwdec_get(&p->hwdec_ctx, mpi->imgfmt);",
          "content_same": false
        },
        {
          "line": 1675,
          "old_api": null,
          "new_api": "mp_csp_equalizer_create",
          "old_text": null,
          "new_text": "mp_csp_equalizer_create(p, vo->global)",
          "old_line_content": "    p->log = vo->log;",
          "new_line_content": "    p->video_eq = mp_csp_equalizer_create(p, vo->global);",
          "content_same": false
        },
        {
          "line": 1166,
          "old_api": null,
          "new_api": "pl_swapchain_submit_frame",
          "old_text": null,
          "new_text": "pl_swapchain_submit_frame(p->sw)",
          "old_line_content": "        p->frame_pending = false;",
          "new_line_content": "        if (!pl_swapchain_submit_frame(p->sw))",
          "content_same": false
        },
        {
          "line": 1167,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(vo, \"Failed presenting frame!\\n\")",
          "old_line_content": "    }",
          "new_line_content": "            MP_ERR(vo, \"Failed presenting frame!\\n\");",
          "content_same": false
        },
        {
          "line": 1680,
          "old_api": null,
          "new_api": "gpu_ctx_create",
          "old_text": null,
          "new_text": "gpu_ctx_create(vo, gl_opts)",
          "old_line_content": "        goto err_out;",
          "new_line_content": "    p->context = gpu_ctx_create(vo, gl_opts);",
          "content_same": false
        },
        {
          "line": 657,
          "old_api": null,
          "new_api": "hwdec_reconfig",
          "old_text": null,
          "new_text": "hwdec_reconfig(p, fp->hwdec, &mpi->params)",
          "old_line_content": "            return false;",
          "new_line_content": "        if (!hwdec_reconfig(p, fp->hwdec, &mpi->params)) {",
          "content_same": false
        },
        {
          "line": 658,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(mpi)",
          "old_line_content": "        }",
          "new_line_content": "            talloc_free(mpi);",
          "content_same": false
        },
        {
          "line": 1171,
          "old_api": null,
          "new_api": "swap_buffers",
          "old_text": null,
          "new_text": "sw->fns->swap_buffers(sw)",
          "old_line_content": "",
          "new_line_content": "    sw->fns->swap_buffers(sw);",
          "content_same": false
        },
        {
          "line": 1179,
          "old_api": null,
          "new_api": "get_vsync",
          "old_text": null,
          "new_text": "sw->fns->get_vsync(sw, info)",
          "old_line_content": "",
          "new_line_content": "        sw->fns->get_vsync(sw, info);",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": null,
          "new_api": "mp_levels_to_pl",
          "old_text": null,
          "new_text": "mp_levels_to_pl(par->color.levels)",
          "old_line_content": "        },",
          "new_line_content": "            .levels = mp_levels_to_pl(par->color.levels),",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": null,
          "new_api": "mp_alpha_to_pl",
          "old_text": null,
          "new_text": "mp_alpha_to_pl(par->alpha)",
          "old_line_content": "        .profile = {",
          "new_line_content": "            .alpha = mp_alpha_to_pl(par->alpha),",
          "content_same": false
        },
        {
          "line": 1696,
          "old_api": null,
          "new_api": "ra_hwdec_ctx_init",
          "old_text": null,
          "new_text": "ra_hwdec_ctx_init(&p->hwdec_ctx, vo->hwdec_devs, gl_opts->hwdec_interop, false)",
          "old_line_content": "",
          "new_line_content": "    ra_hwdec_ctx_init(&p->hwdec_ctx, vo->hwdec_devs, gl_opts->hwdec_interop, false);",
          "content_same": false
        },
        {
          "line": 1185,
          "old_api": null,
          "new_api": "ra_hwdec_get",
          "old_text": null,
          "new_text": "ra_hwdec_get(&p->hwdec_ctx, format)",
          "old_line_content": "",
          "new_line_content": "    if (ra_hwdec_get(&p->hwdec_ctx, format))",
          "content_same": false
        },
        {
          "line": 1697,
          "old_api": null,
          "new_api": "pthread_mutex_init",
          "old_text": null,
          "new_text": "pthread_mutex_init(&p->dr_lock, NULL)",
          "old_line_content": "#if PL_API_VER >= 320",
          "new_line_content": "    pthread_mutex_init(&p->dr_lock, NULL);",
          "content_same": false
        },
        {
          "line": 1700,
          "old_api": null,
          "new_api": "pl_cache_params",
          "old_text": null,
          "new_text": "pl_cache_params(\n        .log = p->pllog,\n        .max_object_size =  1 << 20, //  1 MB\n        .max_total_size  = 10 << 20, // 10 MB\n    )",
          "old_line_content": "        .max_object_size =  1 << 20, //  1 MB",
          "new_line_content": "    p->cache = pl_cache_create(pl_cache_params(",
          "content_same": false
        },
        {
          "line": 1190,
          "old_api": null,
          "new_api": "plane_data_from_imgfmt",
          "old_text": null,
          "new_text": "plane_data_from_imgfmt(data, &bits, format)",
          "old_line_content": "        return false;",
          "new_line_content": "    int planes = plane_data_from_imgfmt(data, &bits, format);",
          "content_same": false
        },
        {
          "line": 1705,
          "old_api": null,
          "new_api": "pl_gpu_set_cache",
          "old_text": null,
          "new_text": "pl_gpu_set_cache(p->gpu, p->cache)",
          "old_line_content": "",
          "new_line_content": "    pl_gpu_set_cache(p->gpu, p->cache);",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": null,
          "new_api": "mp_imgfmt_get_forced_csp",
          "old_text": null,
          "new_text": "mp_imgfmt_get_forced_csp(par->imgfmt)",
          "old_line_content": "        frame->repr.sys = PL_COLOR_SYSTEM_RGB;",
          "new_line_content": "    switch (mp_imgfmt_get_forced_csp(par->imgfmt)) {",
          "content_same": false
        },
        {
          "line": 1195,
          "old_api": null,
          "new_api": "pl_plane_find_fmt",
          "old_text": null,
          "new_text": "pl_plane_find_fmt(p->gpu, NULL, &data[i])",
          "old_line_content": "    }",
          "new_line_content": "        if (!pl_plane_find_fmt(p->gpu, NULL, &data[i]))",
          "content_same": false
        },
        {
          "line": 1710,
          "old_api": null,
          "new_api": "pl_find_named_fmt",
          "old_text": null,
          "new_text": "pl_find_named_fmt(p->gpu, \"r8\")",
          "old_line_content": "    p->osd_sync = 1;",
          "new_line_content": "    p->osd_fmt[SUBBITMAP_LIBASS] = pl_find_named_fmt(p->gpu, \"r8\");",
          "content_same": false
        },
        {
          "line": 1711,
          "old_api": null,
          "new_api": "pl_find_named_fmt",
          "old_text": null,
          "new_text": "pl_find_named_fmt(p->gpu, \"bgra8\")",
          "old_line_content": "",
          "new_line_content": "    p->osd_fmt[SUBBITMAP_BGRA] = pl_find_named_fmt(p->gpu, \"bgra8\");",
          "content_same": false
        },
        {
          "line": 692,
          "old_api": null,
          "new_api": "pl_color_system_guess_ycbcr",
          "old_text": null,
          "new_text": "pl_color_system_guess_ycbcr(par->w, par->h)",
          "old_line_content": "    default: break;",
          "new_line_content": "            frame->repr.sys = pl_color_system_guess_ycbcr(par->w, par->h);",
          "content_same": false
        },
        {
          "line": 1718,
          "old_api": null,
          "new_api": "pl_renderer_load",
          "old_text": null,
          "new_text": "pl_renderer_load(p->rr, c.start)",
          "old_line_content": "        }",
          "new_line_content": "            pl_renderer_load(p->rr, c.start);",
          "content_same": false
        },
        {
          "line": 2232,
          "old_api": null,
          "new_api": "OPT_STRING",
          "old_text": null,
          "new_text": "OPT_STRING(target_lut.opt)",
          "old_line_content": "        // No `target-lut-type` because we don't support non-RGB targets",
          "new_line_content": "        {\"target-lut\", OPT_STRING(target_lut.opt), .flags = M_OPT_FILE},",
          "content_same": false
        },
        {
          "line": 1209,
          "old_api": null,
          "new_api": "gpu_ctx_resize",
          "old_text": null,
          "new_text": "gpu_ctx_resize(p->context, vo->dwidth, vo->dheight)",
          "old_line_content": "    }",
          "new_line_content": "        gpu_ctx_resize(p->context, vo->dwidth, vo->dheight);",
          "content_same": false
        },
        {
          "line": 1721,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(cache_file)",
          "old_line_content": "",
          "new_line_content": "        talloc_free(cache_file);",
          "content_same": false
        },
        {
          "line": 2235,
          "old_api": null,
          "new_api": "OPT_KEYVALUELIST",
          "old_text": null,
          "new_text": "OPT_KEYVALUELIST(raw_opts)",
          "old_line_content": "    },",
          "new_line_content": "        {\"libplacebo-opts\", OPT_KEYVALUELIST(raw_opts)},",
          "content_same": false
        },
        {
          "line": 699,
          "old_api": null,
          "new_api": "mp_imgfmt_get_desc",
          "old_text": null,
          "new_text": "mp_imgfmt_get_desc(par->imgfmt)",
          "old_line_content": "        frame->release = hwdec_release;",
          "new_line_content": "        struct mp_imgfmt_desc desc = mp_imgfmt_get_desc(par->imgfmt);",
          "content_same": false
        },
        {
          "line": 1724,
          "old_api": null,
          "new_api": "pl_options_alloc",
          "old_text": null,
          "new_text": "pl_options_alloc(p->pllog)",
          "old_line_content": "    return 0;",
          "new_line_content": "    p->pars = pl_options_alloc(p->pllog);",
          "content_same": false
        },
        {
          "line": 1214,
          "old_api": null,
          "new_api": "mp_rect_equals",
          "old_text": null,
          "new_text": "mp_rect_equals(&p->dst, &dst)",
          "old_line_content": "        return;",
          "new_line_content": "        mp_rect_equals(&p->dst, &dst) &&",
          "content_same": false
        },
        {
          "line": 1215,
          "old_api": null,
          "new_api": "osd_res_equals",
          "old_text": null,
          "new_text": "osd_res_equals(p->osd_res, osd)",
          "old_line_content": "",
          "new_line_content": "        osd_res_equals(p->osd_res, osd))",
          "content_same": false
        },
        {
          "line": 1725,
          "old_api": null,
          "new_api": "update_render_options",
          "old_text": null,
          "new_text": "update_render_options(vo)",
          "old_line_content": "",
          "new_line_content": "    update_render_options(vo);",
          "content_same": false
        },
        {
          "line": 1729,
          "old_api": null,
          "new_api": "uninit",
          "old_text": null,
          "new_text": "uninit(vo)",
          "old_line_content": "}",
          "new_line_content": "    uninit(vo);",
          "content_same": false
        },
        {
          "line": 706,
          "old_api": null,
          "new_api": "mp_imgfmt_desc_get_num_comps",
          "old_text": null,
          "new_text": "mp_imgfmt_desc_get_num_comps(&desc)",
          "old_line_content": "                    continue;",
          "new_line_content": "            for (int c = 0; c < mp_imgfmt_desc_get_num_comps(&desc); c++) {",
          "content_same": false
        },
        {
          "line": 1227,
          "old_api": null,
          "new_api": "reconfig",
          "old_text": null,
          "new_text": "p->ra_ctx->fns->reconfig(p->ra_ctx)",
          "old_line_content": "",
          "new_line_content": "    if (!p->ra_ctx->fns->reconfig(p->ra_ctx))",
          "content_same": false
        },
        {
          "line": 1230,
          "old_api": null,
          "new_api": "resize",
          "old_text": null,
          "new_text": "resize(vo)",
          "old_line_content": "}",
          "new_line_content": "    resize(vo);",
          "content_same": false
        },
        {
          "line": 724,
          "old_api": null,
          "new_api": "plane_data_from_imgfmt",
          "old_text": null,
          "new_text": "plane_data_from_imgfmt(data, &frame->repr.bits, mpi->imgfmt)",
          "old_line_content": "            struct pl_plane *plane = &frame->planes[n];",
          "new_line_content": "        frame->num_planes = plane_data_from_imgfmt(data, &frame->repr.bits, mpi->imgfmt);",
          "content_same": false
        },
        {
          "line": 727,
          "old_api": null,
          "new_api": "mp_image_plane_w",
          "old_text": null,
          "new_text": "mp_image_plane_w(mpi, n)",
          "old_line_content": "            if (mpi->stride[n] < 0) {",
          "new_line_content": "            data[n].width = mp_image_plane_w(mpi, n);",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": null,
          "new_api": "mp_image_plane_h",
          "old_text": null,
          "new_text": "mp_image_plane_h(mpi, n)",
          "old_line_content": "                data[n].pixels = mpi->planes[n] + (data[n].height - 1) * mpi->stride[n];",
          "new_line_content": "            data[n].height = mp_image_plane_h(mpi, n);",
          "content_same": false
        },
        {
          "line": 1242,
          "old_api": null,
          "new_api": "pl_icc_profile_compute_signature",
          "old_text": null,
          "new_text": "pl_icc_profile_compute_signature(&profile)",
          "old_line_content": "#if PL_API_VER >= 327",
          "new_line_content": "    pl_icc_profile_compute_signature(&profile);",
          "content_same": false
        },
        {
          "line": 1245,
          "old_api": null,
          "new_api": "pl_icc_update",
          "old_text": null,
          "new_text": "pl_icc_update(p->pllog, &p->icc_profile, &profile, &p->icc_params)",
          "old_line_content": "    return ok;",
          "new_line_content": "    bool ok = pl_icc_update(p->pllog, &p->icc_profile, &profile, &p->icc_params);",
          "content_same": false
        },
        {
          "line": 1246,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(icc.start)",
          "old_line_content": "#else",
          "new_line_content": "    talloc_free(icc.start);",
          "content_same": false
        },
        {
          "line": 1249,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free((void *) p->icc_profile.data)",
          "old_line_content": "    p->icc_profile = profile;",
          "new_line_content": "    talloc_free((void *) p->icc_profile.data);",
          "content_same": false
        },
        {
          "line": 738,
          "old_api": null,
          "new_api": "get_dr_buf",
          "old_text": null,
          "new_text": "get_dr_buf(p, data[n].pixels)",
          "old_line_content": "                data[n].buf = buf;",
          "new_line_content": "            pl_buf buf = get_dr_buf(p, data[n].pixels);",
          "content_same": false
        },
        {
          "line": 1250,
          "old_api": null,
          "new_api": "talloc_steal",
          "old_text": null,
          "new_text": "talloc_steal(p, (void *) profile.data)",
          "old_line_content": "    return true;",
          "new_line_content": "    profile.data = talloc_steal(p, (void *) profile.data);",
          "content_same": false
        },
        {
          "line": 1761,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(cfg->kernel.name, fixed_presets[i].name)",
          "old_line_content": "    }",
          "new_line_content": "        if (strcmp(cfg->kernel.name, fixed_presets[i].name) == 0)",
          "content_same": false
        },
        {
          "line": 745,
          "old_api": null,
          "new_api": "mp_image_new_ref",
          "old_text": null,
          "new_text": "mp_image_new_ref(mpi)",
          "old_line_content": "",
          "new_line_content": "                data[n].priv = mp_image_new_ref(mpi);",
          "content_same": false
        },
        {
          "line": 1771,
          "old_api": null,
          "new_api": "pl_find_filter_function_preset",
          "old_text": null,
          "new_text": "pl_find_filter_function_preset(cfg->kernel.name)",
          "old_line_content": "            .kernel = fpreset->function,",
          "new_line_content": "    } else if ((fpreset = pl_find_filter_function_preset(cfg->kernel.name))) {",
          "content_same": false
        },
        {
          "line": 750,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(data[n].priv)",
          "old_line_content": "                return false;",
          "new_line_content": "                talloc_free(data[n].priv);",
          "content_same": false
        },
        {
          "line": 751,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(mpi)",
          "old_line_content": "            }",
          "new_line_content": "                talloc_free(mpi);",
          "content_same": false
        },
        {
          "line": 1265,
          "old_api": null,
          "new_api": "control",
          "old_text": null,
          "new_text": "p->ra_ctx->fns->control(p->ra_ctx, events, VOCTRL_GET_ICC_PROFILE, &icc)",
          "old_line_content": "    if (r != VO_NOTAVAIL) {",
          "new_line_content": "    int r = p->ra_ctx->fns->control(p->ra_ctx, events, VOCTRL_GET_ICC_PROFILE, &icc);",
          "content_same": false
        },
        {
          "line": 1780,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(p, \"Failed mapping filter function '%s', no libplacebo analog?\\n\",\n               cfg->kernel.name)",
          "old_line_content": "        return &pl_filter_bilinear;",
          "new_line_content": "        MP_ERR(p, \"Failed mapping filter function '%s', no libplacebo analog?\\n\",",
          "content_same": false
        },
        {
          "line": 759,
          "old_api": null,
          "new_api": "mp_chroma_to_pl",
          "old_text": null,
          "new_text": "mp_chroma_to_pl(par->chroma_location)",
          "old_line_content": "    // Set the frame DOVI metadata",
          "new_line_content": "    pl_frame_set_chroma_location(frame, mp_chroma_to_pl(par->chroma_location));",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": null,
          "new_api": "mp_lcm",
          "old_text": null,
          "new_text": "mp_lcm(stride_align, gpu->limits.align_tex_xfer_offset)",
          "old_line_content": "    if (size < 0)",
          "new_line_content": "    stride_align = mp_lcm(stride_align, gpu->limits.align_tex_xfer_offset);",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": null,
          "new_api": "mp_image_get_alloc_size",
          "old_text": null,
          "new_text": "mp_image_get_alloc_size(imgfmt, w, h, stride_align)",
          "old_line_content": "        return NULL;",
          "new_line_content": "    int size = mp_image_get_alloc_size(imgfmt, w, h, stride_align);",
          "content_same": false
        },
        {
          "line": 762,
          "old_api": null,
          "new_api": "mp_map_dovi_metadata_to_pl",
          "old_text": null,
          "new_text": "mp_map_dovi_metadata_to_pl(mpi, frame)",
          "old_line_content": "#ifdef PL_HAVE_LAV_FILM_GRAIN",
          "new_line_content": "    mp_map_dovi_metadata_to_pl(mpi, frame);",
          "content_same": false
        },
        {
          "line": 1271,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(p, \"icc-profile-auto not implemented on this platform.\\n\")",
          "old_line_content": "",
          "new_line_content": "            MP_ERR(p, \"icc-profile-auto not implemented on this platform.\\n\");",
          "content_same": false
        },
        {
          "line": 1274,
          "old_api": null,
          "new_api": "update_icc",
          "old_text": null,
          "new_text": "update_icc(p, icc)",
          "old_line_content": "    }",
          "new_line_content": "        update_icc(p, icc);",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": null,
          "new_api": "pl_buf_create",
          "old_text": null,
          "new_text": "pl_buf_create(gpu, &(struct pl_buf_params) {\n        .memory_type = PL_BUF_MEM_HOST,\n        .host_mapped = true,\n        .size = size + stride_align,\n    })",
          "old_line_content": "        .host_mapped = true,",
          "new_line_content": "    pl_buf buf = pl_buf_create(gpu, &(struct pl_buf_params) {",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": null,
          "new_api": "pl_film_grain_from_av",
          "old_text": null,
          "new_text": "pl_film_grain_from_av(&frame->film_grain, (AVFilmGrainParams *) mpi->film_grain->data)",
          "old_line_content": "",
          "new_line_content": "        pl_film_grain_from_av(&frame->film_grain, (AVFilmGrainParams *) mpi->film_grain->data);",
          "content_same": false
        },
        {
          "line": 1786,
          "old_api": null,
          "new_api": "pl_find_filter_function_preset",
          "old_text": null,
          "new_text": "pl_find_filter_function_preset(cfg->window.name)",
          "old_line_content": "#if PL_API_VER >= 303",
          "new_line_content": "    if ((wpreset = pl_find_filter_function_preset(cfg->window.name))) {",
          "content_same": false
        },
        {
          "line": 773,
          "old_api": null,
          "new_api": "pl_icc_profile_compute_signature",
          "old_text": null,
          "new_text": "pl_icc_profile_compute_signature(&frame->profile)",
          "old_line_content": "    // Update LUT attached to this frame",
          "new_line_content": "    pl_icc_profile_compute_signature(&frame->profile);",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": null,
          "new_api": "mp_image_from_buffer",
          "old_text": null,
          "new_text": "mp_image_from_buffer(imgfmt, w, h, stride_align,\n                                                buf->data, buf->params.size,\n                                                p, free_dr_buf)",
          "old_line_content": "                                                p, free_dr_buf);",
          "new_line_content": "    struct mp_image *mpi = mp_image_from_buffer(imgfmt, w, h, stride_align,",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": null,
          "new_api": "update_lut",
          "old_text": null,
          "new_text": "update_lut(p, &p->image_lut)",
          "old_line_content": "    frame->lut_type = p->image_lut.type;",
          "new_line_content": "    update_lut(p, &p->image_lut);",
          "content_same": false
        },
        {
          "line": 1289,
          "old_api": null,
          "new_api": "update_options",
          "old_text": null,
          "new_text": "update_options(vo)",
          "old_line_content": "    params.info_callback = NULL;",
          "new_line_content": "    update_options(vo);",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": null,
          "new_api": "pl_buf_destroy",
          "old_text": null,
          "new_text": "pl_buf_destroy(gpu, &buf)",
          "old_line_content": "    }",
          "new_line_content": "        pl_buf_destroy(gpu, &buf);",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": null,
          "new_api": "MP_TARRAY_APPEND",
          "old_text": null,
          "new_text": "MP_TARRAY_APPEND(p, p->dr_buffers, p->num_dr_buffers, buf)",
          "old_line_content": "",
          "new_line_content": "    MP_TARRAY_APPEND(p, p->dr_buffers, p->num_dr_buffers, buf);",
          "content_same": false
        },
        {
          "line": 272,
          "old_api": null,
          "new_api": "pthread_mutex_unlock",
          "old_text": null,
          "new_text": "pthread_mutex_unlock(&p->dr_lock)",
          "old_line_content": "    return mpi;",
          "new_line_content": "    pthread_mutex_unlock(&p->dr_lock);",
          "content_same": false
        },
        {
          "line": 1807,
          "old_api": null,
          "new_api": "isnan",
          "old_text": null,
          "new_text": "isnan(cfg->window.params[i])",
          "old_line_content": "#else",
          "new_line_content": "        if (!isnan(cfg->window.params[i]))",
          "content_same": false
        },
        {
          "line": 788,
          "old_api": null,
          "new_api": "MP_ARRAY_SIZE",
          "old_text": null,
          "new_text": "MP_ARRAY_SIZE(fp->subs.entries)",
          "old_line_content": "        if (tex)",
          "new_line_content": "    for (int i = 0; i < MP_ARRAY_SIZE(fp->subs.entries); i++) {",
          "content_same": false
        },
        {
          "line": 1812,
          "old_api": null,
          "new_api": "isnan",
          "old_text": null,
          "new_text": "isnan(cfg->window.params[i])",
          "old_line_content": "#endif",
          "new_line_content": "        if (!isnan(cfg->window.params[i]))",
          "content_same": false
        },
        {
          "line": 793,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(mpi)",
          "old_line_content": "",
          "new_line_content": "    talloc_free(mpi);",
          "content_same": false
        },
        {
          "line": 1306,
          "old_api": null,
          "new_api": "pl_queue_params",
          "old_text": null,
          "new_text": "pl_queue_params(.pts = p->last_pts)",
          "old_line_content": "    if (status == PL_QUEUE_ERR) {",
          "new_line_content": "    status = pl_queue_update(p->queue, &mix, pl_queue_params(.pts = p->last_pts));",
          "content_same": false
        },
        {
          "line": 1309,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(vo, \"Unknown error occurred while trying to take screenshot!\\n\")",
          "old_line_content": "    }",
          "new_line_content": "        MP_ERR(vo, \"Unknown error occurred while trying to take screenshot!\\n\");",
          "content_same": false
        },
        {
          "line": 799,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(mpi)",
          "old_line_content": "",
          "new_line_content": "    talloc_free(mpi);",
          "content_same": false
        },
        {
          "line": 1313,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(vo, \"No frames available to take screenshot of, is a file loaded?\\n\")",
          "old_line_content": "    }",
          "new_line_content": "        MP_ERR(vo, \"No frames available to take screenshot of, is a file loaded?\\n\");",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": null,
          "new_api": "osd_render",
          "old_text": null,
          "new_text": "osd_render(vo->osd, res, pts, flags, subfmt_all)",
          "old_line_content": "        p->osd_sync++;",
          "new_line_content": "    struct sub_bitmap_list *subs = osd_render(vo->osd, res, pts, flags, subfmt_all);",
          "content_same": false
        },
        {
          "line": 1830,
          "old_api": null,
          "new_api": "MP_WARN",
          "old_text": null,
          "new_text": "MP_WARN(p, \"Filter radius specified but filter '%s' is not \"\n                    \"resizable, ignoring\\n\", cfg->kernel.name)",
          "old_line_content": "        }",
          "new_line_content": "            MP_WARN(p, \"Filter radius specified but filter '%s' is not \"",
          "content_same": false
        },
        {
          "line": 813,
          "old_api": null,
          "new_api": "abort",
          "old_text": null,
          "new_text": "abort()",
          "old_line_content": "",
          "new_line_content": "    default: abort();",
          "content_same": false
        },
        {
          "line": 1325,
          "old_api": null,
          "new_api": "mp_image_params_get_dsize",
          "old_text": null,
          "new_text": "mp_image_params_get_dsize(&mpi->params, &w, &h)",
          "old_line_content": "            return;",
          "new_line_content": "        mp_image_params_get_dsize(&mpi->params, &w, &h);",
          "content_same": false
        },
        {
          "line": 305,
          "old_api": null,
          "new_api": "MP_TARRAY_POP",
          "old_text": null,
          "new_text": "MP_TARRAY_POP(p->sub_tex, p->num_sub_tex, &entry->tex)",
          "old_line_content": "            .format = tex_fmt,",
          "new_line_content": "            MP_TARRAY_POP(p->sub_tex, p->num_sub_tex, &entry->tex);",
          "content_same": false
        },
        {
          "line": 817,
          "old_api": null,
          "new_api": "pl_dispatch_info_move",
          "old_text": null,
          "new_text": "pl_dispatch_info_move(&frame->info[info->index], info->pass)",
          "old_line_content": "",
          "new_line_content": "    pl_dispatch_info_move(&frame->info[info->index], info->pass);",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": null,
          "new_api": "MPMAX",
          "old_text": null,
          "new_text": "MPMAX(item->packed_w, entry->tex ? entry->tex->params.w : 0)",
          "old_line_content": "            .host_writable = true,",
          "new_line_content": "            .w = MPMAX(item->packed_w, entry->tex ? entry->tex->params.w : 0),",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": null,
          "new_api": "MPMAX",
          "old_text": null,
          "new_text": "MPMAX(item->packed_h, entry->tex ? entry->tex->params.h : 0)",
          "old_line_content": "            .sampleable = true,",
          "new_line_content": "            .h = MPMAX(item->packed_h, entry->tex ? entry->tex->params.h : 0),",
          "content_same": false
        },
        {
          "line": 1334,
          "old_api": null,
          "new_api": "mp_image_crop_valid",
          "old_text": null,
          "new_text": "mp_image_crop_valid(&mpi->params)",
          "old_line_content": "",
          "new_line_content": "        if (mp_image_crop_valid(&mpi->params))",
          "content_same": false
        },
        {
          "line": 1844,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(p->user_hooks[i].path, path)",
          "old_line_content": "    }",
          "new_line_content": "        if (strcmp(p->user_hooks[i].path, path) == 0)",
          "content_same": false
        },
        {
          "line": 824,
          "old_api": null,
          "new_api": "m_config_cache_update",
          "old_text": null,
          "new_text": "m_config_cache_update(p->opts_cache)",
          "old_line_content": "",
          "new_line_content": "    if (m_config_cache_update(p->opts_cache))",
          "content_same": false
        },
        {
          "line": 1849,
          "old_api": null,
          "new_api": "stream_read_file",
          "old_text": null,
          "new_text": "stream_read_file(fname, p, p->global, 1000000000)",
          "old_line_content": "",
          "new_line_content": "    bstr shader = stream_read_file(fname, p, p->global, 1000000000); // 1GB",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(vo, \"Failed recreating OSD texture!\\n\")",
          "old_line_content": "        }",
          "new_line_content": "            MP_ERR(vo, \"Failed recreating OSD texture!\\n\");",
          "content_same": false
        },
        {
          "line": 827,
          "old_api": null,
          "new_api": "update_lut",
          "old_text": null,
          "new_text": "update_lut(p, &p->lut)",
          "old_line_content": "    pars->params.lut_type = p->lut.type;",
          "new_line_content": "    update_lut(p, &p->lut);",
          "content_same": false
        },
        {
          "line": 1850,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(fname)",
          "old_line_content": "    const struct pl_hook *hook = NULL;",
          "new_line_content": "    talloc_free(fname);",
          "content_same": false
        },
        {
          "line": 317,
          "old_api": null,
          "new_api": "pl_tex_upload",
          "old_text": null,
          "new_text": "pl_tex_upload(p->gpu, &(struct pl_tex_transfer_params) {\n            .tex        = entry->tex,\n            .rc         = { .x1 = item->packed_w, .y1 = item->packed_h, },\n            .row_pitch  = item->packed->stride[0],\n            .ptr        = item->packed->planes[0],\n        })",
          "old_line_content": "            .rc         = { .x1 = item->packed_w, .y1 = item->packed_h, },",
          "new_line_content": "        ok = pl_tex_upload(p->gpu, &(struct pl_tex_transfer_params) {",
          "content_same": false
        },
        {
          "line": 1341,
          "old_api": null,
          "new_api": "mp_rect_rotate",
          "old_text": null,
          "new_text": "mp_rect_rotate(&src, src_w, src_h, mpi->params.rotate)",
          "old_line_content": "",
          "new_line_content": "        mp_rect_rotate(&src, src_w, src_h, mpi->params.rotate);",
          "content_same": false
        },
        {
          "line": 1342,
          "old_api": null,
          "new_api": "mp_rect_rotate",
          "old_text": null,
          "new_text": "mp_rect_rotate(&dst, w, h, mpi->params.rotate)",
          "old_line_content": "        osd = (struct mp_osd_res) {",
          "new_line_content": "        mp_rect_rotate(&dst, w, h, mpi->params.rotate);",
          "content_same": false
        },
        {
          "line": 1856,
          "old_api": null,
          "new_api": "MP_TARRAY_APPEND",
          "old_text": null,
          "new_text": "MP_TARRAY_APPEND(p, p->user_hooks, p->num_user_hooks, (struct user_hook) {\n        .path = talloc_strdup(p, path),\n        .hook = hook,\n    })",
          "old_line_content": "        .hook = hook,",
          "new_line_content": "    MP_TARRAY_APPEND(p, p->user_hooks, p->num_user_hooks, (struct user_hook) {",
          "content_same": false
        },
        {
          "line": 833,
          "old_api": null,
          "new_api": "mp_csp_equalizer_state_get",
          "old_text": null,
          "new_text": "mp_csp_equalizer_state_get(p->video_eq, &cparams)",
          "old_line_content": "    pars->color_adjustment.contrast = cparams.contrast;",
          "new_line_content": "    mp_csp_equalizer_state_get(p->video_eq, &cparams);",
          "content_same": false
        },
        {
          "line": 1346,
          "old_api": null,
          "new_api": "mp_rect_w",
          "old_text": null,
          "new_text": "mp_rect_w(dst)",
          "old_line_content": "        };",
          "new_line_content": "            .w = mp_rect_w(dst),",
          "content_same": false
        },
        {
          "line": 1347,
          "old_api": null,
          "new_api": "mp_rect_h",
          "old_text": null,
          "new_text": "mp_rect_h(dst)",
          "old_line_content": "    }",
          "new_line_content": "            .h = mp_rect_h(dst),",
          "content_same": false
        },
        {
          "line": 324,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(vo, \"Failed uploading OSD texture!\\n\")",
          "old_line_content": "        }",
          "new_line_content": "            MP_ERR(vo, \"Failed uploading OSD texture!\\n\");",
          "content_same": false
        },
        {
          "line": 1857,
          "old_api": null,
          "new_api": "talloc_strdup",
          "old_text": null,
          "new_text": "talloc_strdup(p, path)",
          "old_line_content": "    });",
          "new_line_content": "        .path = talloc_strdup(p, path),",
          "content_same": false
        },
        {
          "line": 843,
          "old_api": null,
          "new_api": "pl_options_set_str",
          "old_text": null,
          "new_text": "pl_options_set_str(pars, kv[0], kv[1])",
          "old_line_content": "}",
          "new_line_content": "        pl_options_set_str(pars, kv[0], kv[1]);",
          "content_same": false
        },
        {
          "line": 1355,
          "old_api": null,
          "new_api": "pl_find_fmt",
          "old_text": null,
          "new_text": "pl_find_fmt(gpu, PL_FMT_UNORM, 4, depth, depth,\n                                 PL_FMT_CAP_RENDERABLE | PL_FMT_CAP_HOST_READABLE)",
          "old_line_content": "        if (!fmt)",
          "new_line_content": "        pl_fmt fmt = pl_find_fmt(gpu, PL_FMT_UNORM, 4, depth, depth,",
          "content_same": false
        },
        {
          "line": 1360,
          "old_api": null,
          "new_api": "pl_tex_params",
          "old_text": null,
          "new_text": "pl_tex_params(\n            .w = osd.w,\n            .h = osd.h,\n            .format = fmt,\n            .blit_dst = true,\n            .renderable = true,\n            .host_readable = true,\n            .storable = fmt->caps & PL_FMT_CAP_STORABLE,\n        )",
          "old_line_content": "            .h = osd.h,",
          "new_line_content": "        fbo = pl_tex_create(gpu, pl_tex_params(",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": null,
          "new_api": "MP_TARRAY_APPEND",
          "old_text": null,
          "new_text": "MP_TARRAY_APPEND(p, entry->parts, entry->num_parts, part)",
          "old_line_content": "",
          "new_line_content": "            MP_TARRAY_APPEND(p, entry->parts, entry->num_parts, part);",
          "content_same": false
        },
        {
          "line": 1881,
          "old_api": null,
          "new_api": "mp_find_user_file",
          "old_text": null,
          "new_text": "mp_find_user_file(NULL, p->global, \"cache\", \"\")",
          "old_line_content": "",
          "new_line_content": "        cache_dir = mp_find_user_file(NULL, p->global, \"cache\", \"\");",
          "content_same": false
        },
        {
          "line": 862,
          "old_api": null,
          "new_api": "pl_nominal_luma_params",
          "old_text": null,
          "new_text": "pl_nominal_luma_params(\n        .color = color,\n        // with HDR10 meta to respect value if already set\n        .metadata = PL_HDR_METADATA_HDR10,\n        .scaling = PL_HDR_NITS,\n        .out_max = &color->hdr.max_luma\n    )",
          "old_line_content": "        // with HDR10 meta to respect value if already set",
          "new_line_content": "    pl_color_space_nominal_luma_ex(pl_nominal_luma_params(",
          "content_same": false
        },
        {
          "line": 1374,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(vo, \"Failed creating target FBO for screenshot!\\n\")",
          "old_line_content": "    }",
          "new_line_content": "        MP_ERR(vo, \"Failed creating target FBO for screenshot!\\n\");",
          "content_same": false
        },
        {
          "line": 1887,
          "old_api": null,
          "new_api": "mp_path_join",
          "old_text": null,
          "new_text": "mp_path_join(NULL, cache_dir, cache_name)",
          "old_line_content": "    if (flags & STREAM_WRITE) {",
          "new_line_content": "    char *path = mp_path_join(NULL, cache_dir, cache_name);",
          "content_same": false
        },
        {
          "line": 1890,
          "old_api": null,
          "new_api": "mp_mkdirp",
          "old_text": null,
          "new_text": "mp_mkdirp(cache_dir)",
          "old_line_content": "        // Exit silently if the file does not exist",
          "new_line_content": "        mp_mkdirp(cache_dir);",
          "content_same": false
        },
        {
          "line": 1893,
          "old_api": null,
          "new_api": "stat",
          "old_text": null,
          "new_text": "stat(path, &(struct stat) {0})",
          "old_line_content": "    }",
          "new_line_content": "        if (stat(path, &(struct stat) {0}) < 0)",
          "content_same": false
        },
        {
          "line": 1898,
          "old_api": null,
          "new_api": "stream_create",
          "old_text": null,
          "new_text": "stream_create(path, flags, NULL, p->global)",
          "old_line_content": "done:",
          "new_line_content": "    stream = stream_create(path, flags, NULL, p->global);",
          "content_same": false
        },
        {
          "line": 875,
          "old_api": null,
          "new_api": "update_lut",
          "old_text": null,
          "new_text": "update_lut(p, &p->target_lut)",
          "old_line_content": "    target->lut_type = p->target_lut.type;",
          "new_line_content": "    update_lut(p, &p->target_lut);",
          "content_same": false
        },
        {
          "line": 365,
          "old_api": null,
          "new_api": "pl_color_transfer_is_hdr",
          "old_text": null,
          "new_text": "pl_color_transfer_is_hdr(ol->color.transfer)",
          "old_line_content": "                        .max_luma = PL_COLOR_SDR_WHITE,",
          "new_line_content": "                if (pl_color_transfer_is_hdr(ol->color.transfer)) {",
          "content_same": false
        },
        {
          "line": 1390,
          "old_api": null,
          "new_api": "apply_target_options",
          "old_text": null,
          "new_text": "apply_target_options(p, &target)",
          "old_line_content": "        target.color = image.color;",
          "new_line_content": "        apply_target_options(p, &target);",
          "content_same": false
        },
        {
          "line": 1901,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(cache_dir)",
          "old_line_content": "    return stream;",
          "new_line_content": "    talloc_free(cache_dir);",
          "content_same": false
        },
        {
          "line": 1902,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(path)",
          "old_line_content": "}",
          "new_line_content": "    talloc_free(path);",
          "content_same": false
        },
        {
          "line": 1909,
          "old_api": null,
          "new_api": "icc_open_cache",
          "old_text": null,
          "new_text": "icc_open_cache(p, sig, STREAM_WRITE)",
          "old_line_content": "        return;",
          "new_line_content": "    stream_t *s = icc_open_cache(p, sig, STREAM_WRITE);",
          "content_same": false
        },
        {
          "line": 886,
          "old_api": null,
          "new_api": "mp_trc_to_pl",
          "old_text": null,
          "new_text": "mp_trc_to_pl(opts->target_trc)",
          "old_line_content": "    if (opts->target_peak && !target->color.hdr.max_luma)",
          "new_line_content": "        target->color.transfer = mp_trc_to_pl(opts->target_trc);",
          "content_same": false
        },
        {
          "line": 1398,
          "old_api": null,
          "new_api": "apply_crop",
          "old_text": null,
          "new_text": "apply_crop(&target, dst, fbo->params.w, fbo->params.h)",
          "old_line_content": "",
          "new_line_content": "    apply_crop(&target, dst, fbo->params.w, fbo->params.h);",
          "content_same": false
        },
        {
          "line": 1399,
          "old_api": null,
          "new_api": "update_tm_viz",
          "old_text": null,
          "new_text": "update_tm_viz(&pars->color_map_params, &target)",
          "old_line_content": "    int osd_flags = 0;",
          "new_line_content": "    update_tm_viz(&pars->color_map_params, &target);",
          "content_same": false
        },
        {
          "line": 1912,
          "old_api": null,
          "new_api": "stream_write_buffer",
          "old_text": null,
          "new_text": "stream_write_buffer(s, (void *) cache, size)",
          "old_line_content": "}",
          "new_line_content": "    stream_write_buffer(s, (void *) cache, size);",
          "content_same": false
        },
        {
          "line": 1913,
          "old_api": null,
          "new_api": "free_stream",
          "old_text": null,
          "new_text": "free_stream(s)",
          "old_line_content": "",
          "new_line_content": "    free_stream(s);",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(subs)",
          "old_line_content": "",
          "new_line_content": "    talloc_free(subs);",
          "content_same": false
        },
        {
          "line": 891,
          "old_api": null,
          "new_api": "apply_target_contrast",
          "old_text": null,
          "new_text": "apply_target_contrast(p, &target->color)",
          "old_line_content": "        struct pl_bit_encoding *tbits = &target->repr.bits;",
          "new_line_content": "        apply_target_contrast(p, &target->color);",
          "content_same": false
        },
        {
          "line": 1919,
          "old_api": null,
          "new_api": "icc_open_cache",
          "old_text": null,
          "new_text": "icc_open_cache(p, sig, STREAM_READ)",
          "old_line_content": "        return false;",
          "new_line_content": "    stream_t *s = icc_open_cache(p, sig, STREAM_READ);",
          "content_same": false
        },
        {
          "line": 1410,
          "old_api": null,
          "new_api": "pl_rect_w",
          "old_text": null,
          "new_text": "pl_rect_w(image.crop)",
          "old_line_content": "        struct mp_osd_res res = {",
          "new_line_content": "        float rx = pl_rect_w(dst) / pl_rect_w(image.crop);",
          "content_same": false
        },
        {
          "line": 1923,
          "old_api": null,
          "new_api": "stream_read",
          "old_text": null,
          "new_text": "stream_read(s, cache, size)",
          "old_line_content": "    return len == size;",
          "new_line_content": "    int len = stream_read(s, cache, size);",
          "content_same": false
        },
        {
          "line": 1924,
          "old_api": null,
          "new_api": "free_stream",
          "old_text": null,
          "new_text": "free_stream(s)",
          "old_line_content": "}",
          "new_line_content": "    free_stream(s);",
          "content_same": false
        },
        {
          "line": 901,
          "old_api": null,
          "new_api": "pl_nominal_luma_params",
          "old_text": null,
          "new_text": "pl_nominal_luma_params(\n            .color    = &target->color,\n            .metadata = PL_HDR_METADATA_HDR10, // use only static HDR nits\n            .scaling  = PL_HDR_NITS,\n            .out_max  = &p->icc_params.max_luma,\n        )",
          "old_line_content": "            .metadata = PL_HDR_METADATA_HDR10, // use only static HDR nits",
          "new_line_content": "        pl_color_space_nominal_luma_ex(pl_nominal_luma_params(",
          "content_same": false
        },
        {
          "line": 1413,
          "old_api": null,
          "new_api": "pl_rect_w",
          "old_text": null,
          "new_text": "pl_rect_w(dst)",
          "old_line_content": "            .ml = -image.crop.x0 * rx,",
          "new_line_content": "            .w = pl_rect_w(dst),",
          "content_same": false
        },
        {
          "line": 1414,
          "old_api": null,
          "new_api": "pl_rect_h",
          "old_text": null,
          "new_text": "pl_rect_h(dst)",
          "old_line_content": "            .mr = (image.crop.x1 - vo->params->w) * rx,",
          "new_line_content": "            .h = pl_rect_h(dst),",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": null,
          "new_api": "mp_imgfmt_get_desc",
          "old_text": null,
          "new_text": "mp_imgfmt_get_desc(imgfmt)",
          "old_line_content": "        return 0;",
          "new_line_content": "    struct mp_imgfmt_desc desc = mp_imgfmt_get_desc(imgfmt);",
          "content_same": false
        },
        {
          "line": 1421,
          "old_api": null,
          "new_api": "update_overlays",
          "old_text": null,
          "new_text": "update_overlays(vo, res, osd_flags,\n                        PL_OVERLAY_COORDS_DST_CROP,\n                        &fp->subs, &image, mpi)",
          "old_line_content": "                        &fp->subs, &image, mpi);",
          "new_line_content": "        update_overlays(vo, res, osd_flags,",
          "content_same": false
        },
        {
          "line": 910,
          "old_api": null,
          "new_api": "pl_icc_update",
          "old_text": null,
          "new_text": "pl_icc_update(p->pllog, &p->icc_profile, NULL, &p->icc_params)",
          "old_line_content": "#else",
          "new_line_content": "    pl_icc_update(p->pllog, &p->icc_profile, NULL, &p->icc_params);",
          "content_same": false
        },
        {
          "line": 1935,
          "old_api": null,
          "new_api": "update_icc",
          "old_text": null,
          "new_text": "update_icc(p, (bstr) {0})",
          "old_line_content": "",
          "new_line_content": "        update_icc(p, (bstr) {0});",
          "content_same": false
        },
        {
          "line": 1426,
          "old_api": null,
          "new_api": "update_overlays",
          "old_text": null,
          "new_text": "update_overlays(vo, osd, osd_flags, PL_OVERLAY_COORDS_DST_FRAME,\n                        &p->osd_state, &target, mpi)",
          "old_line_content": "        image.num_overlays = 0;",
          "new_line_content": "        update_overlays(vo, osd, osd_flags, PL_OVERLAY_COORDS_DST_FRAME,",
          "content_same": false
        },
        {
          "line": 1939,
          "old_api": null,
          "new_api": "gl_parse_3dlut_size",
          "old_text": null,
          "new_text": "gl_parse_3dlut_size(opts->size_str, &s_r, &s_g, &s_b)",
          "old_line_content": "    p->icc_params.intent = opts->intent;",
          "new_line_content": "    gl_parse_3dlut_size(opts->size_str, &s_r, &s_g, &s_b);",
          "content_same": false
        },
        {
          "line": 1431,
          "old_api": null,
          "new_api": "pl_render_image",
          "old_text": null,
          "new_text": "pl_render_image(p->rr, &image, &target, &params)",
          "old_line_content": "        goto done;",
          "new_line_content": "    if (!pl_render_image(p->rr, &image, &target, &params)) {",
          "content_same": false
        },
        {
          "line": 1432,
          "old_api": null,
          "new_api": "MP_ERR",
          "old_text": null,
          "new_text": "MP_ERR(vo, \"Failed rendering frame!\\n\")",
          "old_line_content": "    }",
          "new_line_content": "        MP_ERR(vo, \"Failed rendering frame!\\n\");",
          "content_same": false
        },
        {
          "line": 1436,
          "old_api": null,
          "new_api": "mp_image_alloc",
          "old_text": null,
          "new_text": "mp_image_alloc(mpfmt, fbo->params.w, fbo->params.h)",
          "old_line_content": "        goto done;",
          "new_line_content": "    args->res = mp_image_alloc(mpfmt, fbo->params.w, fbo->params.h);",
          "content_same": false
        },
        {
          "line": 928,
          "old_api": null,
          "new_api": "pl_rect2df_rotate",
          "old_text": null,
          "new_text": "pl_rect2df_rotate(&frame->crop, -frame->rotation)",
          "old_line_content": "        frame->crop.x0 = width - frame->crop.x0;",
          "new_line_content": "    pl_rect2df_rotate(&frame->crop, -frame->rotation);",
          "content_same": false
        },
        {
          "line": 1441,
          "old_api": null,
          "new_api": "mp_trc_from_pl",
          "old_text": null,
          "new_text": "mp_trc_from_pl(target.color.transfer)",
          "old_line_content": "    args->res->params.color.sig_peak = target.color.hdr.max_luma / MP_REF_WHITE;",
          "new_line_content": "    args->res->params.color.gamma = mp_trc_from_pl(target.color.transfer);",
          "content_same": false
        },
        {
          "line": 1442,
          "old_api": null,
          "new_api": "mp_levels_from_pl",
          "old_text": null,
          "new_text": "mp_levels_from_pl(target.repr.levels)",
          "old_line_content": "    if (args->scaled)",
          "new_line_content": "    args->res->params.color.levels = mp_levels_from_pl(target.repr.levels);",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": null,
          "new_api": "mp_imgfmt_desc_get_num_comps",
          "old_text": null,
          "new_text": "mp_imgfmt_desc_get_num_comps(&desc)",
          "old_line_content": "                continue;",
          "new_line_content": "        for (int c = 0; c < mp_imgfmt_desc_get_num_comps(&desc); c++) {",
          "content_same": false
        },
        {
          "line": 1954,
          "old_api": null,
          "new_api": "update_icc",
          "old_text": null,
          "new_text": "update_icc(p, (bstr) {0})",
          "old_line_content": "        return;",
          "new_line_content": "        update_icc(p, (bstr) {0});",
          "content_same": false
        },
        {
          "line": 1955,
          "old_api": null,
          "new_api": "TA_FREEP",
          "old_text": null,
          "new_text": "TA_FREEP(&p->icc_path)",
          "old_line_content": "    }",
          "new_line_content": "        TA_FREEP(&p->icc_path);",
          "content_same": false
        },
        {
          "line": 1447,
          "old_api": null,
          "new_api": "pl_tex_transfer_params",
          "old_text": null,
          "new_text": "pl_tex_transfer_params(\n        .tex = fbo,\n        .ptr = args->res->planes[0],\n        .row_pitch = args->res->stride[0],\n    )",
          "old_line_content": "        .ptr = args->res->planes[0],",
          "new_line_content": "    bool ok = pl_tex_download(gpu, pl_tex_transfer_params(",
          "content_same": false
        },
        {
          "line": 1959,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(opts->profile, p->icc_path)",
          "old_line_content": "",
          "new_line_content": "    if (p->icc_path && strcmp(opts->profile, p->icc_path) == 0)",
          "content_same": false
        },
        {
          "line": 1965,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(fname)",
          "old_line_content": "",
          "new_line_content": "    talloc_free(fname);",
          "content_same": false
        },
        {
          "line": 1454,
          "old_api": null,
          "new_api": "TA_FREEP",
          "old_text": null,
          "new_text": "TA_FREEP(&args->res)",
          "old_line_content": "    // fall through",
          "new_line_content": "        TA_FREEP(&args->res);",
          "content_same": false
        },
        {
          "line": 1966,
          "old_api": null,
          "new_api": "update_icc",
          "old_text": null,
          "new_text": "update_icc(p, icc)",
          "old_line_content": "    // Update cached path",
          "new_line_content": "    update_icc(p, icc);",
          "content_same": false
        },
        {
          "line": 1969,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(p->icc_path)",
          "old_line_content": "}",
          "new_line_content": "    talloc_free(p->icc_path);",
          "content_same": false
        },
        {
          "line": 1458,
          "old_api": null,
          "new_api": "pl_tex_destroy",
          "old_text": null,
          "new_text": "pl_tex_destroy(gpu, &fbo)",
          "old_line_content": "",
          "new_line_content": "    pl_tex_destroy(gpu, &fbo);",
          "content_same": false
        },
        {
          "line": 1970,
          "old_api": null,
          "new_api": "talloc_strdup",
          "old_text": null,
          "new_text": "talloc_strdup(p, opts->profile)",
          "old_line_content": "",
          "new_line_content": "    p->icc_path = talloc_strdup(p, opts->profile);",
          "content_same": false
        },
        {
          "line": 948,
          "old_api": null,
          "new_api": "pl_rect_h",
          "old_text": null,
          "new_text": "pl_rect_h(target->crop)",
          "old_line_content": "    params->visualize_rect = (pl_rect2df) {",
          "new_line_content": "    const float out_h = fabsf(pl_rect_h(target->crop));",
          "content_same": false
        },
        {
          "line": 949,
          "old_api": null,
          "new_api": "MPMIN",
          "old_text": null,
          "new_text": "MPMIN(out_w / 2.0f, out_h)",
          "old_line_content": "        .x0 = 1.0f - size / out_w,",
          "new_line_content": "    const float size = MPMIN(out_w / 2.0f, out_h);",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(data->component_size, 0, sizeof(data->component_size))",
          "old_line_content": "            data->component_size[c] = sorted[c].size;",
          "new_line_content": "        memset(data->component_size, 0, sizeof(data->component_size));",
          "content_same": false
        },
        {
          "line": 1464,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(pl->count <= VO_PASS_PERF_MAX)",
          "old_line_content": "",
          "new_line_content": "    assert(pl->count <= VO_PASS_PERF_MAX);",
          "content_same": false
        },
        {
          "line": 1465,
          "old_api": null,
          "new_api": "MPMIN",
          "old_text": null,
          "new_text": "MPMIN(pl->count, VO_PASS_PERF_MAX)",
          "old_line_content": "    for (int i = 0; i < mp->count; ++i) {",
          "new_line_content": "    mp->count = MPMIN(pl->count, VO_PASS_PERF_MAX);",
          "content_same": false
        },
        {
          "line": 1976,
          "old_api": null,
          "new_api": "pl_lut_free",
          "old_text": null,
          "new_text": "pl_lut_free(&lut->lut)",
          "old_line_content": "        return;",
          "new_line_content": "        pl_lut_free(&lut->lut);",
          "content_same": false
        },
        {
          "line": 1977,
          "old_api": null,
          "new_api": "TA_FREEP",
          "old_text": null,
          "new_text": "TA_FREEP(&lut->path)",
          "old_line_content": "    }",
          "new_line_content": "        TA_FREEP(&lut->path);",
          "content_same": false
        },
        {
          "line": 1981,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(lut->path, lut->opt)",
          "old_line_content": "",
          "new_line_content": "    if (lut->path && strcmp(lut->path, lut->opt) == 0)",
          "content_same": false
        },
        {
          "line": 1470,
          "old_api": null,
          "new_api": "MP_ARRAY_SIZE",
          "old_text": null,
          "new_text": "MP_ARRAY_SIZE(pass->samples)",
          "old_line_content": "",
          "new_line_content": "        static_assert(VO_PERF_SAMPLE_COUNT >= MP_ARRAY_SIZE(pass->samples), \"\");",
          "content_same": false
        },
        {
          "line": 1471,
          "old_api": null,
          "new_api": "MP_ARRAY_SIZE",
          "old_text": null,
          "new_text": "MP_ARRAY_SIZE(pass->samples)",
          "old_line_content": "        struct mp_pass_perf *perf = &mp->perf[i];",
          "new_line_content": "        assert(pass->num_samples <= MP_ARRAY_SIZE(pass->samples));",
          "content_same": false
        },
        {
          "line": 1474,
          "old_api": null,
          "new_api": "MPMIN",
          "old_text": null,
          "new_text": "MPMIN(pass->num_samples, VO_PERF_SAMPLE_COUNT)",
          "old_line_content": "        perf->last = pass->last;",
          "new_line_content": "        perf->count = MPMIN(pass->num_samples, VO_PERF_SAMPLE_COUNT);",
          "content_same": false
        },
        {
          "line": 1475,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(perf->samples, pass->samples, perf->count * sizeof(pass->samples[0]))",
          "old_line_content": "        perf->peak = pass->peak;",
          "new_line_content": "        memcpy(perf->samples, pass->samples, perf->count * sizeof(pass->samples[0]));",
          "content_same": false
        },
        {
          "line": 1986,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(lut->path)",
          "old_line_content": "",
          "new_line_content": "    talloc_free(lut->path);",
          "content_same": false
        },
        {
          "line": 453,
          "old_api": null,
          "new_api": "abs",
          "old_text": null,
          "new_text": "abs(sorted[c].pad)",
          "old_line_content": "            };",
          "new_line_content": "                .color_depth = sorted[c].size - abs(sorted[c].pad),",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": null,
          "new_api": "MPMAX",
          "old_text": null,
          "new_text": "MPMAX(sorted[c].pad, 0)",
          "old_line_content": "",
          "new_line_content": "                .bit_shift = MPMAX(sorted[c].pad, 0),",
          "content_same": false
        },
        {
          "line": 966,
          "old_api": null,
          "new_api": "update_options",
          "old_text": null,
          "new_text": "update_options(vo)",
          "old_line_content": "    struct pl_render_params params = pars->params;",
          "new_line_content": "    update_options(vo);",
          "content_same": false
        },
        {
          "line": 1480,
          "old_api": null,
          "new_api": "strncpy",
          "old_text": null,
          "new_text": "strncpy(mp->desc[i], pass->shader->description, sizeof(mp->desc[i]) - 1)",
          "old_line_content": "    }",
          "new_line_content": "        strncpy(mp->desc[i], pass->shader->description, sizeof(mp->desc[i]) - 1);",
          "content_same": false
        },
        {
          "line": 1987,
          "old_api": null,
          "new_api": "talloc_strdup",
          "old_text": null,
          "new_text": "talloc_strdup(p, lut->opt)",
          "old_line_content": "    // Load LUT file",
          "new_line_content": "    lut->path = talloc_strdup(p, lut->opt);",
          "content_same": false
        },
        {
          "line": 1993,
          "old_api": null,
          "new_api": "pl_lut_parse_cube",
          "old_text": null,
          "new_text": "pl_lut_parse_cube(p->pllog, lutdata.start, lutdata.len)",
          "old_line_content": "}",
          "new_line_content": "    lut->lut = pl_lut_parse_cube(p->pllog, lutdata.start, lutdata.len);",
          "content_same": false
        },
        {
          "line": 1994,
          "old_api": null,
          "new_api": "talloc_free",
          "old_text": null,
          "new_text": "talloc_free(lutdata.start)",
          "old_line_content": "",
          "new_line_content": "    talloc_free(lutdata.start);",
          "content_same": false
        },
        {
          "line": 461,
          "old_api": null,
          "new_api": "pl_bit_encoding_equal",
          "old_text": null,
          "new_text": "pl_bit_encoding_equal(out_bits, &bits)",
          "old_line_content": "                    // cannot handle this",
          "new_line_content": "                if (!pl_bit_encoding_equal(out_bits, &bits)) {",
          "content_same": false
        },
        {
          "line": 1491,
          "old_api": null,
          "new_api": "resize",
          "old_text": null,
          "new_text": "resize(vo)",
          "old_line_content": "    case VOCTRL_SET_EQUALIZER:",
          "new_line_content": "        resize(vo);",
          "content_same": false
        },
        {
          "line": 2005,
          "old_api": null,
          "new_api": "mp_splitext",
          "old_text": null,
          "new_text": "mp_splitext(basename, &shadername)",
          "old_line_content": "",
          "new_line_content": "    if (!mp_splitext(basename, &shadername))",
          "content_same": false
        },
        {
          "line": 2006,
          "old_api": null,
          "new_api": "bstr0",
          "old_text": null,
          "new_text": "bstr0(basename)",
          "old_line_content": "    for (int n = 0; opts[n * 2]; n++) {",
          "new_line_content": "        shadername = bstr0(basename);",
          "content_same": false
        },
        {
          "line": 985,
          "old_api": null,
          "new_api": "pl_renderer_flush_cache",
          "old_text": null,
          "new_text": "pl_renderer_flush_cache(p->rr)",
          "old_line_content": "            p->last_pts = 0.0;",
          "new_line_content": "            pl_renderer_flush_cache(p->rr);",
          "content_same": false
        },
        {
          "line": 986,
          "old_api": null,
          "new_api": "pl_queue_reset",
          "old_text": null,
          "new_text": "pl_queue_reset(p->queue)",
          "old_line_content": "            p->want_reset = false;",
          "new_line_content": "            pl_queue_reset(p->queue);",
          "content_same": false
        },
        {
          "line": 2009,
          "old_api": null,
          "new_api": "bstr0",
          "old_text": null,
          "new_text": "bstr0(opts[n * 2 + 0])",
          "old_line_content": "        int pos;",
          "new_line_content": "        struct bstr k = bstr0(opts[n * 2 + 0]);",
          "content_same": false
        },
        {
          "line": 2012,
          "old_api": null,
          "new_api": "bstrchr",
          "old_text": null,
          "new_text": "bstrchr(k, '/')",
          "old_line_content": "                continue;",
          "new_line_content": "        if ((pos = bstrchr(k, '/')) >= 0) {",
          "content_same": false
        },
        {
          "line": 991,
          "old_api": null,
          "new_api": "mp_image_new_ref",
          "old_text": null,
          "new_text": "mp_image_new_ref(frame->frames[n])",
          "old_line_content": "        mpi->priv = fp;",
          "new_line_content": "        struct mp_image *mpi = mp_image_new_ref(frame->frames[n]);",
          "content_same": false
        },
        {
          "line": 992,
          "old_api": null,
          "new_api": "talloc_zero",
          "old_text": null,
          "new_text": "talloc_zero(mpi, struct frame_priv)",
          "old_line_content": "        fp->vo = vo;",
          "new_line_content": "        struct frame_priv *fp = talloc_zero(mpi, struct frame_priv);",
          "content_same": false
        },
        {
          "line": 1504,
          "old_api": null,
          "new_api": "m_config_cache_update",
          "old_text": null,
          "new_text": "m_config_cache_update(p->opts_cache)",
          "old_line_content": "        p->ra_ctx->opts.want_alpha = opts->alpha_mode == ALPHA_YES;",
          "new_line_content": "        m_config_cache_update(p->opts_cache);",
          "content_same": false
        },
        {
          "line": 2015,
          "old_api": null,
          "new_api": "bstr_cut",
          "old_text": null,
          "new_text": "bstr_cut(k, pos + 1)",
          "old_line_content": "",
          "new_line_content": "            k = bstr_cut(k, pos + 1);",
          "content_same": false
        },
        {
          "line": 996,
          "old_api": null,
          "new_api": "pl_queue_push",
          "old_text": null,
          "new_text": "pl_queue_push(p->queue, &(struct pl_source_frame) {\n            .pts = mpi->pts,\n            .duration = frame->ideal_frame_duration,\n            .frame_data = mpi,\n            .map = map_frame,\n            .unmap = unmap_frame,\n            .discard = discard_frame,\n        })",
          "old_line_content": "            .duration = frame->ideal_frame_duration,",
          "new_line_content": "        pl_queue_push(p->queue, &(struct pl_source_frame) {",
          "content_same": false
        },
        {
          "line": 1508,
          "old_api": null,
          "new_api": "update_render_opts",
          "old_text": null,
          "new_text": "p->ra_ctx->fns->update_render_opts(p->ra_ctx)",
          "old_line_content": "        vo->want_redraw = true;",
          "new_line_content": "            p->ra_ctx->fns->update_render_opts(p->ra_ctx);",
          "content_same": false
        },
        {
          "line": 1509,
          "old_api": null,
          "new_api": "update_render_options",
          "old_text": null,
          "new_text": "update_render_options(vo)",
          "old_line_content": "",
          "new_line_content": "        update_render_options(vo);",
          "content_same": false
        },
        {
          "line": 2020,
          "old_api": null,
          "new_api": "bstr_equals0",
          "old_text": null,
          "new_text": "bstr_equals0(k, hp->name)",
          "old_line_content": "",
          "new_line_content": "            if (!bstr_equals0(k, hp->name) != 0)",
          "content_same": false
        },
        {
          "line": 1516,
          "old_api": null,
          "new_api": "update_auto_profile",
          "old_text": null,
          "new_text": "update_auto_profile(p, &events)",
          "old_line_content": "        return VO_TRUE;",
          "new_line_content": "        update_auto_profile(p, &events);",
          "content_same": false
        },
        {
          "line": 1517,
          "old_api": null,
          "new_api": "vo_event",
          "old_text": null,
          "new_text": "vo_event(vo, events)",
          "old_line_content": "    }",
          "new_line_content": "        vo_event(vo, events);",
          "content_same": false
        },
        {
          "line": 2030,
          "old_api": null,
          "new_api": "bstr_equals0",
          "old_text": null,
          "new_text": "bstr_equals0(v, hp->names[j])",
          "old_line_content": "                        goto next_hook;",
          "new_line_content": "                    if (bstr_equals0(v, hp->names[j])) {",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": null,
          "new_api": "mp_prim_to_pl",
          "old_text": null,
          "new_text": "mp_prim_to_pl(mpi->params.color.primaries)",
          "old_line_content": "        .hdr.max_luma = mpi->params.color.sig_peak * MP_REF_WHITE,",
          "new_line_content": "        .primaries = mp_prim_to_pl(mpi->params.color.primaries),",
          "content_same": false
        },
        {
          "line": 499,
          "old_api": null,
          "new_api": "mp_trc_to_pl",
          "old_text": null,
          "new_text": "mp_trc_to_pl(mpi->params.color.gamma)",
          "old_line_content": "    };",
          "new_line_content": "        .transfer = mp_trc_to_pl(mpi->params.color.gamma),",
          "content_same": false
        },
        {
          "line": 1014,
          "old_api": null,
          "new_api": "mp_trc_to_pl",
          "old_text": null,
          "new_text": "mp_trc_to_pl(opts->target_trc)",
          "old_line_content": "            hint.hdr.max_luma = opts->target_peak;",
          "new_line_content": "            hint.transfer = mp_trc_to_pl(opts->target_trc);",
          "content_same": false
        },
        {
          "line": 1528,
          "old_api": null,
          "new_api": "copy_frame_info_to_mp",
          "old_text": null,
          "new_text": "copy_frame_info_to_mp(&p->perf_fresh, &perf->fresh)",
          "old_line_content": "        return true;",
          "new_line_content": "        copy_frame_info_to_mp(&p->perf_fresh, &perf->fresh);",
          "content_same": false
        },
        {
          "line": 1017,
          "old_api": null,
          "new_api": "apply_target_contrast",
          "old_text": null,
          "new_text": "apply_target_contrast(p, &hint)",
          "old_line_content": "    } else if (!p->target_hint) {",
          "new_line_content": "        apply_target_contrast(p, &hint);",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": null,
          "new_api": "get_side_data",
          "old_text": null,
          "new_text": "get_side_data(mpi, AV_FRAME_DATA_CONTENT_LIGHT_LEVEL)",
          "old_line_content": "    });",
          "new_line_content": "        .clm = get_side_data(mpi, AV_FRAME_DATA_CONTENT_LIGHT_LEVEL),",
          "content_same": false
        },
        {
          "line": 507,
          "old_api": null,
          "new_api": "get_side_data",
          "old_text": null,
          "new_text": "get_side_data(mpi, AV_FRAME_DATA_DYNAMIC_HDR_PLUS)",
          "old_line_content": "#else // back-compat fallback for older libplacebo",
          "new_line_content": "        .dhp = get_side_data(mpi, AV_FRAME_DATA_DYNAMIC_HDR_PLUS),",
          "content_same": false
        },
        {
          "line": 1020,
          "old_api": null,
          "new_api": "pl_swapchain_colorspace_hint",
          "old_text": null,
          "new_text": "pl_swapchain_colorspace_hint(p->sw, NULL)",
          "old_line_content": "",
          "new_line_content": "        pl_swapchain_colorspace_hint(p->sw, NULL);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1024,
          "old_api": "start_frame",
          "new_api": null,
          "old_text": "sw->fns->start_frame(sw, NULL)",
          "new_text": null,
          "old_line_content": "    bool should_draw = sw->fns->start_frame(sw, NULL); // for wayland logic",
          "new_line_content": "    struct ra_swapchain *sw = p->ra_ctx->swapchain;",
          "content_same": false
        },
        {
          "line": 2049,
          "old_api": "MPMIN",
          "new_api": null,
          "old_text": "MPMIN(hp->minimum.u, INT_MAX)",
          "new_text": null,
          "old_line_content": "                opt.min = MPMIN(hp->minimum.u, INT_MAX);",
          "new_line_content": "            case PL_VAR_UINT:",
          "content_same": false
        },
        {
          "line": 2050,
          "old_api": "MPMIN",
          "new_api": null,
          "old_text": "MPMIN(hp->maximum.u, INT_MAX)",
          "new_text": null,
          "old_line_content": "                opt.max = MPMIN(hp->maximum.u, INT_MAX);",
          "new_line_content": "                opt.type = &m_option_type_int;",
          "content_same": false
        },
        {
          "line": 1025,
          "old_api": "pl_swapchain_start_frame",
          "new_api": null,
          "old_text": "pl_swapchain_start_frame(p->sw, &swframe)",
          "new_text": null,
          "old_line_content": "    if (!should_draw || !pl_swapchain_start_frame(p->sw, &swframe)) {",
          "new_line_content": "    double vsync_offset = opts->interpolation ? frame->vsync_offset : 0;",
          "content_same": false
        },
        {
          "line": 1028,
          "old_api": "pl_queue_params",
          "new_api": null,
          "old_text": "pl_queue_params(\n                .pts = frame->current->pts + vsync_offset,\n                .radius = pl_frame_mix_radius(&params),\n            )",
          "new_text": null,
          "old_line_content": "            pl_queue_update(p->queue, NULL, pl_queue_params(",
          "new_line_content": "        if (frame->current) {",
          "content_same": false
        },
        {
          "line": 1527,
          "old_api": "copy_frame_info_to_mp",
          "new_api": null,
          "old_text": "copy_frame_info_to_mp(&p->perf_redraw, &perf->redraw)",
          "new_text": null,
          "old_line_content": "        copy_frame_info_to_mp(&p->perf_redraw, &perf->redraw);",
          "new_line_content": "        struct voctrl_performance_data *perf = data;",
          "content_same": false
        },
        {
          "line": 2054,
          "old_api": "parse",
          "new_api": null,
          "old_text": "opt.type->parse(p->log, &opt, k, v, hp->data)",
          "new_text": null,
          "old_line_content": "            opt.type->parse(p->log, &opt, k, v, hp->data);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 520,
          "old_api": "av_q2d",
          "new_api": null,
          "old_text": "av_q2d(mdm->min_luminance)",
          "new_text": null,
          "old_line_content": "                csp.hdr.min_luma = av_q2d(mdm->min_luminance);",
          "new_line_content": "            const AVMasteringDisplayMetadata *mdm = data;",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": "av_q2d",
          "new_api": null,
          "old_text": "av_q2d(mdm->max_luminance)",
          "new_text": null,
          "old_line_content": "                csp.hdr.max_luma = av_q2d(mdm->max_luminance);",
          "new_line_content": "            if (mdm->has_luminance) {",
          "content_same": false
        },
        {
          "line": 1547,
          "old_api": "video_screenshot",
          "new_api": null,
          "old_text": "video_screenshot(vo, data)",
          "new_text": null,
          "old_line_content": "        video_screenshot(vo, data);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 525,
          "old_api": "av_q2d",
          "new_api": null,
          "old_text": "av_q2d(mdm->display_primaries[0][0])",
          "new_text": null,
          "old_line_content": "                csp.hdr.prim.red.x   = av_q2d(mdm->display_primaries[0][0]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 526,
          "old_api": "av_q2d",
          "new_api": null,
          "old_text": "av_q2d(mdm->display_primaries[0][1])",
          "new_text": null,
          "old_line_content": "                csp.hdr.prim.red.y   = av_q2d(mdm->display_primaries[0][1]);",
          "new_line_content": "            if (mdm->has_primaries) {",
          "content_same": false
        },
        {
          "line": 1551,
          "old_api": "reconfig",
          "new_api": null,
          "old_text": "reconfig(vo, NULL)",
          "new_text": null,
          "old_line_content": "        reconfig(vo, NULL);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1041,
          "old_api": "pl_frame_from_swapchain",
          "new_api": null,
          "old_text": "pl_frame_from_swapchain(&target, &swframe)",
          "new_text": null,
          "old_line_content": "    pl_frame_from_swapchain(&target, &swframe);",
          "new_line_content": "    // Calculate target",
          "content_same": false
        },
        {
          "line": 1042,
          "old_api": "apply_target_options",
          "new_api": null,
          "old_text": "apply_target_options(p, &target)",
          "new_text": null,
          "old_line_content": "    apply_target_options(p, &target);",
          "new_line_content": "    struct pl_frame target;",
          "content_same": false
        },
        {
          "line": 1555,
          "old_api": "ra_hwdec_ctx_load_fmt",
          "new_api": null,
          "old_text": "ra_hwdec_ctx_load_fmt(&p->hwdec_ctx, vo->hwdec_devs, data)",
          "new_text": null,
          "old_line_content": "        ra_hwdec_ctx_load_fmt(&p->hwdec_ctx, vo->hwdec_devs, data);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1046,
          "old_api": "apply_crop",
          "new_api": null,
          "old_text": "apply_crop(&target, p->dst, swframe.fbo->params.w, swframe.fbo->params.h)",
          "new_text": null,
          "old_line_content": "    apply_crop(&target, p->dst, swframe.fbo->params.w, swframe.fbo->params.h);",
          "new_line_content": "                    (frame->current && opts->blend_subs) ? OSD_DRAW_OSD_ONLY : 0,",
          "content_same": false
        },
        {
          "line": 1047,
          "old_api": "update_tm_viz",
          "new_api": null,
          "old_text": "update_tm_viz(&pars->color_map_params, &target)",
          "new_text": null,
          "old_line_content": "    update_tm_viz(&pars->color_map_params, &target);",
          "new_line_content": "                    PL_OVERLAY_COORDS_DST_FRAME, &p->osd_state, &target, frame->current);",
          "content_same": false
        },
        {
          "line": 1560,
          "old_api": "control",
          "new_api": null,
          "old_text": "p->ra_ctx->fns->control(p->ra_ctx, &events, request, data)",
          "new_text": null,
          "old_line_content": "    int r = p->ra_ctx->fns->control(p->ra_ctx, &events, request, data);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1054,
          "old_api": "pl_frame_mix_radius",
          "new_api": null,
          "old_text": "pl_frame_mix_radius(&params)",
          "new_text": null,
          "old_line_content": "            .radius = pl_frame_mix_radius(&params),",
          "new_line_content": "        struct pl_queue_params qparams = {",
          "content_same": false
        },
        {
          "line": 1566,
          "old_api": "resize",
          "new_api": null,
          "old_text": "resize(vo)",
          "new_text": null,
          "old_line_content": "        resize(vo);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1569,
          "old_api": "vo_event",
          "new_api": null,
          "old_text": "vo_event(vo, events)",
          "new_text": null,
          "old_line_content": "    vo_event(vo, events);",
          "new_line_content": "    if (events & VO_EVENT_EXPOSE)",
          "content_same": false
        },
        {
          "line": 2082,
          "old_api": "map_scaler",
          "new_api": null,
          "old_text": "map_scaler(p, SCALER_SCALE)",
          "new_text": null,
          "old_line_content": "    pars->params.upscaler = map_scaler(p, SCALER_SCALE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2083,
          "old_api": "map_scaler",
          "new_api": null,
          "old_text": "map_scaler(p, SCALER_DSCALE)",
          "new_text": null,
          "old_line_content": "    pars->params.downscaler = map_scaler(p, SCALER_DSCALE);",
          "new_line_content": "    // Map scaler options as best we can",
          "content_same": false
        },
        {
          "line": 548,
          "old_api": "mp_image_params_equal",
          "new_api": null,
          "old_text": "mp_image_params_equal(par, &p->hwdec_mapper->src_params)",
          "new_text": null,
          "old_line_content": "        if (mp_image_params_equal(par, &p->hwdec_mapper->src_params)) {",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1062,
          "old_api": "MPMAX",
          "new_api": null,
          "old_text": "MPMAX(qparams.pts, p->last_pts)",
          "new_text": null,
          "old_line_content": "        qparams.pts = p->last_pts = MPMAX(qparams.pts, p->last_pts);",
          "new_line_content": "        // initialization, but pl_queue does not like these. Hard-clamp as",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": "ra_hwdec_mapper_free",
          "new_api": null,
          "old_text": "ra_hwdec_mapper_free(&p->hwdec_mapper)",
          "new_text": null,
          "old_line_content": "            ra_hwdec_mapper_free(&p->hwdec_mapper);",
          "new_line_content": "            return p->hwdec_mapper;",
          "content_same": false
        },
        {
          "line": 2090,
          "old_api": "ceilf",
          "new_api": null,
          "old_text": "ceilf(pars->params.frame_mixer->kernel->radius)",
          "new_text": null,
          "old_line_content": "        req_frames += ceilf(pars->params.frame_mixer->kernel->radius);",
          "new_line_content": "    int req_frames = 2;",
          "content_same": false
        },
        {
          "line": 2091,
          "old_api": "vo_set_queue_params",
          "new_api": null,
          "old_text": "vo_set_queue_params(vo, 0, req_frames)",
          "new_text": null,
          "old_line_content": "    vo_set_queue_params(vo, 0, req_frames);",
          "new_line_content": "    if (pars->params.frame_mixer)",
          "content_same": false
        },
        {
          "line": 555,
          "old_api": "ra_hwdec_mapper_create",
          "new_api": null,
          "old_text": "ra_hwdec_mapper_create(hwdec, par)",
          "new_text": null,
          "old_line_content": "    p->hwdec_mapper = ra_hwdec_mapper_create(hwdec, par);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1069,
          "old_api": "abort",
          "new_api": null,
          "old_text": "abort()",
          "new_text": null,
          "old_line_content": "            abort(); // we never signal EOF",
          "new_line_content": "            goto done;",
          "content_same": false
        },
        {
          "line": 1578,
          "old_api": "wakeup",
          "new_api": null,
          "old_text": "p->ra_ctx->fns->wakeup(p->ra_ctx)",
          "new_text": null,
          "old_line_content": "        p->ra_ctx->fns->wakeup(p->ra_ctx);",
          "new_line_content": "    struct priv *p = vo->priv;",
          "content_same": false
        },
        {
          "line": 1073,
          "old_api": "MP_DBG",
          "new_api": null,
          "old_text": "MP_DBG(vo, \"Render queue underrun.\\n\")",
          "new_text": null,
          "old_line_content": "            MP_DBG(vo, \"Render queue underrun.\\n\");",
          "new_line_content": "            // This is expected to happen semi-frequently near the start and",
          "content_same": false
        },
        {
          "line": 1585,
          "old_api": "wait_events",
          "new_api": null,
          "old_text": "p->ra_ctx->fns->wait_events(p->ra_ctx, until_time_ns)",
          "new_text": null,
          "old_line_content": "        p->ra_ctx->fns->wait_events(p->ra_ctx, until_time_ns);",
          "new_line_content": "    struct priv *p = vo->priv;",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "ra_pl_get",
          "new_api": null,
          "old_text": "ra_pl_get(ra)",
          "new_text": null,
          "old_line_content": "    if (ra_pl_get(ra))",
          "new_line_content": "    struct ra_tex *ratex = p->hwdec_mapper->tex[n];",
          "content_same": false
        },
        {
          "line": 573,
          "old_api": "pl_opengl_get",
          "new_api": null,
          "old_text": "pl_opengl_get(p->gpu)",
          "new_text": null,
          "old_line_content": "    if (ra_is_gl(ra) && pl_opengl_get(p->gpu)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1087,
          "old_api": "apply_crop",
          "new_api": null,
          "old_text": "apply_crop(image, p->src, vo->params->w, vo->params->h)",
          "new_text": null,
          "old_line_content": "            apply_crop(image, p->src, vo->params->w, vo->params->h);",
          "new_line_content": "            struct mp_image *mpi = image->user_data;",
          "content_same": false
        },
        {
          "line": 1600,
          "old_api": "mp_get_user_path",
          "new_api": null,
          "old_text": "mp_get_user_path(NULL, p->global, dir)",
          "new_text": null,
          "old_line_content": "        dir = mp_get_user_path(NULL, p->global, dir);",
          "new_line_content": "    char *dir = opts->shader_cache_dir;",
          "content_same": false
        },
        {
          "line": 1090,
          "old_api": "pl_rect_w",
          "new_api": null,
          "old_text": "pl_rect_w(image->crop)",
          "new_text": null,
          "old_line_content": "                    float rx = pl_rect_w(p->dst) / pl_rect_w(image->crop);",
          "new_line_content": "            if (opts->blend_subs) {",
          "content_same": false
        },
        {
          "line": 579,
          "old_api": "ra_gl_get_format",
          "new_api": null,
          "old_text": "ra_gl_get_format(ratex->params.format, &par.iformat,\n                         &(GLenum){0}, &(GLenum){0})",
          "new_text": null,
          "old_line_content": "        ra_gl_get_format(ratex->params.format, &par.iformat,",
          "new_line_content": "        };",
          "content_same": false
        },
        {
          "line": 1091,
          "old_api": "pl_rect_h",
          "new_api": null,
          "old_text": "pl_rect_h(image->crop)",
          "new_text": null,
          "old_line_content": "                    float ry = pl_rect_h(p->dst) / pl_rect_h(image->crop);",
          "new_line_content": "                if (p->paused || fp->osd_sync < p->osd_sync) {",
          "content_same": false
        },
        {
          "line": 1605,
          "old_api": "mp_path_join",
          "new_api": null,
          "old_text": "mp_path_join(NULL, dir, \"libplacebo.cache\")",
          "new_text": null,
          "old_line_content": "        file = mp_path_join(NULL, dir, \"libplacebo.cache\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 582,
          "old_api": "pl_opengl_wrap",
          "new_api": null,
          "old_text": "pl_opengl_wrap(p->gpu, &par)",
          "new_text": null,
          "old_line_content": "        return pl_opengl_wrap(p->gpu, &par);",
          "new_line_content": "                         &(GLenum){0}, &(GLenum){0});",
          "content_same": false
        },
        {
          "line": 1094,
          "old_api": "pl_rect_h",
          "new_api": null,
          "old_text": "pl_rect_h(p->dst)",
          "new_text": null,
          "old_line_content": "                        .h = pl_rect_h(p->dst),",
          "new_line_content": "                    struct mp_osd_res res = {",
          "content_same": false
        },
        {
          "line": 1606,
          "old_api": "mp_mkdirp",
          "new_api": null,
          "old_text": "mp_mkdirp(dir)",
          "new_text": null,
          "old_line_content": "        mp_mkdirp(dir);",
          "new_line_content": "    if (dir && dir[0]) {",
          "content_same": false
        },
        {
          "line": 587,
          "old_api": "ra_is_d3d11",
          "new_api": null,
          "old_text": "ra_is_d3d11(ra)",
          "new_text": null,
          "old_line_content": "    if (ra_is_d3d11(ra)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1101,
          "old_api": "update_overlays",
          "new_api": null,
          "old_text": "update_overlays(vo, res, OSD_DRAW_SUB_ONLY,\n                                    PL_OVERLAY_COORDS_DST_CROP,\n                                    &fp->subs, image, mpi)",
          "new_text": null,
          "old_line_content": "                    update_overlays(vo, res, OSD_DRAW_SUB_ONLY,",
          "new_line_content": "                        .display_par = 1.0,",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": "pl_d3d11_wrap_params",
          "new_api": null,
          "old_text": "pl_d3d11_wrap_params(\n            .tex = res,\n            .array_slice = array_slice,\n            .fmt = ra_d3d11_get_format(ratex->params.format),\n            .w = ratex->params.w,\n            .h = ratex->params.h,\n        )",
          "new_text": null,
          "old_line_content": "        pl_tex tex = pl_d3d11_wrap(p->gpu, pl_d3d11_wrap_params(",
          "new_line_content": "        int array_slice = 0;",
          "content_same": false
        },
        {
          "line": 1616,
          "old_api": "pl_queue_destroy",
          "new_api": null,
          "old_text": "pl_queue_destroy(&p->queue)",
          "new_text": null,
          "old_line_content": "    pl_queue_destroy(&p->queue); // destroy this first",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 593,
          "old_api": "ra_d3d11_get_format",
          "new_api": null,
          "old_text": "ra_d3d11_get_format(ratex->params.format)",
          "new_text": null,
          "old_line_content": "            .fmt = ra_d3d11_get_format(ratex->params.format),",
          "new_line_content": "            .tex = res,",
          "content_same": false
        },
        {
          "line": 1617,
          "old_api": "MP_ARRAY_SIZE",
          "new_api": null,
          "old_text": "MP_ARRAY_SIZE(p->osd_state.entries)",
          "new_text": null,
          "old_line_content": "    for (int i = 0; i < MP_ARRAY_SIZE(p->osd_state.entries); i++)",
          "new_line_content": "    struct priv *p = vo->priv;",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "SAFE_RELEASE",
          "new_api": null,
          "old_text": "SAFE_RELEASE(res)",
          "new_text": null,
          "old_line_content": "        SAFE_RELEASE(res);",
          "new_line_content": "            .h = ratex->params.h,",
          "content_same": false
        },
        {
          "line": 1625,
          "old_api": "ra_hwdec_mapper_free",
          "new_api": null,
          "old_text": "ra_hwdec_mapper_free(&p->hwdec_mapper)",
          "new_text": null,
          "old_line_content": "        ra_hwdec_mapper_free(&p->hwdec_mapper);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 602,
          "old_api": "MP_ERR",
          "new_api": null,
          "old_text": "MP_ERR(p, \"Failed mapping hwdec frame? Open a bug!\\n\")",
          "new_text": null,
          "old_line_content": "    MP_ERR(p, \"Failed mapping hwdec frame? Open a bug!\\n\");",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 1626,
          "old_api": "ra_hwdec_ctx_uninit",
          "new_api": null,
          "old_text": "ra_hwdec_ctx_uninit(&p->hwdec_ctx)",
          "new_text": null,
          "old_line_content": "        ra_hwdec_ctx_uninit(&p->hwdec_ctx);",
          "new_line_content": "    if (vo->hwdec_devs) {",
          "content_same": false
        },
        {
          "line": 2140,
          "old_api": "isnan",
          "new_api": null,
          "old_text": "isnan(pars->color_map_params.tone_mapping_param)",
          "new_text": null,
          "old_line_content": "    if (isnan(pars->color_map_params.tone_mapping_param)) // vo_gpu compatibility",
          "new_line_content": "    pars->color_map_params.tone_mapping_function = tone_map_funs[opts->tone_map.curve];",
          "content_same": false
        },
        {
          "line": 1631,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(p->num_dr_buffers == 0)",
          "new_text": null,
          "old_line_content": "    assert(p->num_dr_buffers == 0);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1632,
          "old_api": "pthread_mutex_destroy",
          "new_api": null,
          "old_text": "pthread_mutex_destroy(&p->dr_lock)",
          "new_text": null,
          "old_line_content": "    pthread_mutex_destroy(&p->dr_lock);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 611,
          "old_api": "hwdec_reconfig",
          "new_api": null,
          "old_text": "hwdec_reconfig(p, fp->hwdec, &mpi->params)",
          "new_text": null,
          "old_line_content": "    if (!hwdec_reconfig(p, fp->hwdec, &mpi->params))",
          "new_line_content": "    struct frame_priv *fp = mpi->priv;",
          "content_same": false
        },
        {
          "line": 1124,
          "old_api": "pl_render_image_mix",
          "new_api": null,
          "old_text": "pl_render_image_mix(p->rr, &mix, &target, &params)",
          "new_text": null,
          "old_line_content": "    if (!pl_render_image_mix(p->rr, &mix, &target, &params)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1125,
          "old_api": "MP_ERR",
          "new_api": null,
          "old_text": "MP_ERR(vo, \"Failed rendering frame!\\n\")",
          "new_text": null,
          "old_line_content": "        MP_ERR(vo, \"Failed rendering frame!\\n\");",
          "new_line_content": "    // Render frame",
          "content_same": false
        },
        {
          "line": 614,
          "old_api": "ra_hwdec_mapper_map",
          "new_api": null,
          "old_text": "ra_hwdec_mapper_map(p->hwdec_mapper, mpi)",
          "new_text": null,
          "old_line_content": "    if (ra_hwdec_mapper_map(p->hwdec_mapper, mpi) < 0) {",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 615,
          "old_api": "MP_ERR",
          "new_api": null,
          "old_text": "MP_ERR(p, \"Mapping hardware decoded surface failed.\\n\")",
          "new_text": null,
          "old_line_content": "        MP_ERR(p, \"Mapping hardware decoded surface failed.\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1639,
          "old_api": "talloc_size",
          "new_api": null,
          "old_text": "talloc_size(NULL, size)",
          "new_text": null,
          "old_line_content": "            uint8_t *buf = talloc_size(NULL, size);",
          "new_line_content": "        if (cache) {",
          "content_same": false
        },
        {
          "line": 2153,
          "old_api": "pl_find_error_diffusion_kernel",
          "new_api": null,
          "old_text": "pl_find_error_diffusion_kernel(opts->error_diffusion)",
          "new_text": null,
          "old_line_content": "        pars->params.error_diffusion = pl_find_error_diffusion_kernel(opts->error_diffusion);",
          "new_line_content": "        break;",
          "content_same": false
        },
        {
          "line": 620,
          "old_api": "hwdec_get_tex",
          "new_api": null,
          "old_text": "hwdec_get_tex(p, n)",
          "new_text": null,
          "old_line_content": "        if (!(frame->planes[n].texture = hwdec_get_tex(p, n)))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1648,
          "old_api": "pl_renderer_destroy",
          "new_api": null,
          "old_text": "pl_renderer_destroy(&p->rr)",
          "new_text": null,
          "old_line_content": "    pl_renderer_destroy(&p->rr);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1651,
          "old_api": "pl_shader_info_deref",
          "new_api": null,
          "old_text": "pl_shader_info_deref(&p->perf_fresh.info[i].shader)",
          "new_text": null,
          "old_line_content": "        pl_shader_info_deref(&p->perf_fresh.info[i].shader);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1140,
          "old_api": "pl_renderer_get_hdr_metadata",
          "new_api": null,
          "old_text": "pl_renderer_get_hdr_metadata(p->rr, &p->last_hdr_metadata)",
          "new_text": null,
          "old_line_content": "        pl_renderer_get_hdr_metadata(p->rr, &p->last_hdr_metadata);",
          "new_line_content": "#if PL_API_VER >= 314",
          "content_same": false
        },
        {
          "line": 1652,
          "old_api": "pl_shader_info_deref",
          "new_api": null,
          "old_text": "pl_shader_info_deref(&p->perf_redraw.info[i].shader)",
          "new_text": null,
          "old_line_content": "        pl_shader_info_deref(&p->perf_redraw.info[i].shader);",
          "new_line_content": "    for (int i = 0; i < VO_PASS_PERF_MAX; ++i) {",
          "content_same": false
        },
        {
          "line": 1655,
          "old_api": "pl_options_free",
          "new_api": null,
          "old_text": "pl_options_free(&p->pars)",
          "new_text": null,
          "old_line_content": "    pl_options_free(&p->pars);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 632,
          "old_api": "ra_pl_get",
          "new_api": null,
          "old_text": "ra_pl_get(p->hwdec_mapper->ra)",
          "new_text": null,
          "old_line_content": "    if (!ra_pl_get(p->hwdec_mapper->ra)) {",
          "new_line_content": "    struct frame_priv *fp = mpi->priv;",
          "content_same": false
        },
        {
          "line": 637,
          "old_api": "ra_hwdec_mapper_unmap",
          "new_api": null,
          "old_text": "ra_hwdec_mapper_unmap(p->hwdec_mapper)",
          "new_text": null,
          "old_line_content": "    ra_hwdec_mapper_unmap(p->hwdec_mapper);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2173,
          "old_api": "update_icc_opts",
          "new_api": null,
          "old_text": "update_icc_opts(p, opts->icc_opts)",
          "new_text": null,
          "old_line_content": "    update_icc_opts(p, opts->icc_opts);",
          "new_line_content": "        pars->params.dither_params = NULL;",
          "content_same": false
        },
        {
          "line": 1661,
          "old_api": "gpu_ctx_destroy",
          "new_api": null,
          "old_text": "gpu_ctx_destroy(&p->context)",
          "new_text": null,
          "old_line_content": "    gpu_ctx_destroy(&p->context);",
          "new_line_content": "    p->gpu = NULL;",
          "content_same": false
        },
        {
          "line": 1152,
          "old_api": "pl_tex_clear",
          "new_api": null,
          "old_text": "pl_tex_clear(gpu, swframe.fbo, (float[4]){ 0.5, 0.0, 1.0, 1.0 })",
          "new_text": null,
          "old_line_content": "        pl_tex_clear(gpu, swframe.fbo, (float[4]){ 0.5, 0.0, 1.0, 1.0 });",
          "new_line_content": "done:",
          "content_same": false
        },
        {
          "line": 2178,
          "old_api": "load_hook",
          "new_api": null,
          "old_text": "load_hook(p, opts->user_shaders[i])",
          "new_text": null,
          "old_line_content": "        if ((hook = load_hook(p, opts->user_shaders[i]))) {",
          "new_line_content": "    const struct pl_hook *hook;",
          "content_same": false
        },
        {
          "line": 2179,
          "old_api": "MP_TARRAY_APPEND",
          "new_api": null,
          "old_text": "MP_TARRAY_APPEND(p, p->hooks, pars->params.num_hooks, hook)",
          "new_text": null,
          "old_line_content": "            MP_TARRAY_APPEND(p, p->hooks, pars->params.num_hooks, hook);",
          "new_line_content": "    for (int i = 0; opts->user_shaders && opts->user_shaders[i]; i++) {",
          "content_same": false
        },
        {
          "line": 1666,
          "old_api": "vo_control",
          "new_api": null,
          "old_text": "vo_control(ctx, VOCTRL_LOAD_HWDEC_API, params)",
          "new_text": null,
          "old_line_content": "    vo_control(ctx, VOCTRL_LOAD_HWDEC_API, params);",
          "new_line_content": "static void load_hwdec_api(void *ctx, struct hwdec_imgfmt_request *params)",
          "content_same": false
        },
        {
          "line": 1672,
          "old_api": "m_config_cache_alloc",
          "new_api": null,
          "old_text": "m_config_cache_alloc(p, vo->global, &gl_video_conf)",
          "new_text": null,
          "old_line_content": "    p->opts_cache = m_config_cache_alloc(p, vo->global, &gl_video_conf);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 649,
          "old_api": "ra_hwdec_get",
          "new_api": null,
          "old_text": "ra_hwdec_get(&p->hwdec_ctx, mpi->imgfmt)",
          "new_text": null,
          "old_line_content": "    fp->hwdec = ra_hwdec_get(&p->hwdec_ctx, mpi->imgfmt);",
          "new_line_content": "    struct priv *p = vo->priv;",
          "content_same": false
        },
        {
          "line": 1673,
          "old_api": "mp_csp_equalizer_create",
          "new_api": null,
          "old_text": "mp_csp_equalizer_create(p, vo->global)",
          "new_text": null,
          "old_line_content": "    p->video_eq = mp_csp_equalizer_create(p, vo->global);",
          "new_line_content": "    struct priv *p = vo->priv;",
          "content_same": false
        },
        {
          "line": 1164,
          "old_api": "pl_swapchain_submit_frame",
          "new_api": null,
          "old_text": "pl_swapchain_submit_frame(p->sw)",
          "new_text": null,
          "old_line_content": "        if (!pl_swapchain_submit_frame(p->sw))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1165,
          "old_api": "MP_ERR",
          "new_api": null,
          "old_text": "MP_ERR(vo, \"Failed presenting frame!\\n\")",
          "new_text": null,
          "old_line_content": "            MP_ERR(vo, \"Failed presenting frame!\\n\");",
          "new_line_content": "    if (p->frame_pending) {",
          "content_same": false
        },
        {
          "line": 1678,
          "old_api": "gpu_ctx_create",
          "new_api": null,
          "old_text": "gpu_ctx_create(vo, gl_opts)",
          "new_text": null,
          "old_line_content": "    p->context = gpu_ctx_create(vo, gl_opts);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 655,
          "old_api": "hwdec_reconfig",
          "new_api": null,
          "old_text": "hwdec_reconfig(p, fp->hwdec, &mpi->params)",
          "new_text": null,
          "old_line_content": "        if (!hwdec_reconfig(p, fp->hwdec, &mpi->params)) {",
          "new_line_content": "        // `dst_params`. In practice, though, this should not matter unless the",
          "content_same": false
        },
        {
          "line": 656,
          "old_api": "talloc_free",
          "new_api": null,
          "old_text": "talloc_free(mpi)",
          "new_text": null,
          "old_line_content": "            talloc_free(mpi);",
          "new_line_content": "        // image format changes mid-stream.",
          "content_same": false
        },
        {
          "line": 1169,
          "old_api": "swap_buffers",
          "new_api": null,
          "old_text": "sw->fns->swap_buffers(sw)",
          "new_text": null,
          "old_line_content": "    sw->fns->swap_buffers(sw);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 664,
          "old_api": "get_mpi_csp",
          "new_api": null,
          "old_text": "get_mpi_csp(vo, mpi)",
          "new_text": null,
          "old_line_content": "        .color = get_mpi_csp(vo, mpi),",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1177,
          "old_api": "get_vsync",
          "new_api": null,
          "old_text": "sw->fns->get_vsync(sw, info)",
          "new_text": null,
          "old_line_content": "        sw->fns->get_vsync(sw, info);",
          "new_line_content": "    struct ra_swapchain *sw = p->ra_ctx->swapchain;",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": "mp_levels_to_pl",
          "new_api": null,
          "old_text": "mp_levels_to_pl(par->color.levels)",
          "new_text": null,
          "old_line_content": "            .levels = mp_levels_to_pl(par->color.levels),",
          "new_line_content": "        .repr = {",
          "content_same": false
        },
        {
          "line": 1692,
          "old_api": "hwdec_devices_create",
          "new_api": null,
          "old_text": "hwdec_devices_create()",
          "new_text": null,
          "old_line_content": "    vo->hwdec_devs = hwdec_devices_create();",
          "new_line_content": "    };",
          "content_same": false
        },
        {
          "line": 1693,
          "old_api": "hwdec_devices_set_loader",
          "new_api": null,
          "old_text": "hwdec_devices_set_loader(vo->hwdec_devs, load_hwdec_api, vo)",
          "new_text": null,
          "old_line_content": "    hwdec_devices_set_loader(vo->hwdec_devs, load_hwdec_api, vo);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1183,
          "old_api": "ra_hwdec_get",
          "new_api": null,
          "old_text": "ra_hwdec_get(&p->hwdec_ctx, format)",
          "new_text": null,
          "old_line_content": "    if (ra_hwdec_get(&p->hwdec_ctx, format))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1698,
          "old_api": "pl_cache_params",
          "new_api": null,
          "old_text": "pl_cache_params(\n        .log = p->pllog,\n        .max_object_size =  1 << 20, //  1 MB\n        .max_total_size  = 10 << 20, // 10 MB\n    )",
          "new_text": null,
          "old_line_content": "    p->cache = pl_cache_create(pl_cache_params(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1188,
          "old_api": "plane_data_from_imgfmt",
          "new_api": null,
          "old_text": "plane_data_from_imgfmt(data, &bits, format)",
          "new_text": null,
          "old_line_content": "    int planes = plane_data_from_imgfmt(data, &bits, format);",
          "new_line_content": "    struct pl_bit_encoding bits;",
          "content_same": false
        },
        {
          "line": 1703,
          "old_api": "pl_gpu_set_cache",
          "new_api": null,
          "old_text": "pl_gpu_set_cache(p->gpu, p->cache)",
          "new_text": null,
          "old_line_content": "    pl_gpu_set_cache(p->gpu, p->cache);",
          "new_line_content": "        .max_total_size  = 10 << 20, // 10 MB",
          "content_same": false
        },
        {
          "line": 680,
          "old_api": "mp_imgfmt_get_forced_csp",
          "new_api": null,
          "old_text": "mp_imgfmt_get_forced_csp(par->imgfmt)",
          "new_text": null,
          "old_line_content": "    switch (mp_imgfmt_get_forced_csp(par->imgfmt)) {",
          "new_line_content": "    // mp_image, like AVFrame, likes communicating RGB/XYZ/YCbCr status",
          "content_same": false
        },
        {
          "line": 1193,
          "old_api": "pl_plane_find_fmt",
          "new_api": null,
          "old_text": "pl_plane_find_fmt(p->gpu, NULL, &data[i])",
          "new_text": null,
          "old_line_content": "        if (!pl_plane_find_fmt(p->gpu, NULL, &data[i]))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1706,
          "old_api": "pl_renderer_create",
          "new_api": null,
          "old_text": "pl_renderer_create(p->pllog, p->gpu)",
          "new_text": null,
          "old_line_content": "    p->rr = pl_renderer_create(p->pllog, p->gpu);",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 1707,
          "old_api": "pl_queue_create",
          "new_api": null,
          "old_text": "pl_queue_create(p->gpu)",
          "new_text": null,
          "old_line_content": "    p->queue = pl_queue_create(p->gpu);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2223,
          "old_api": "OPT_BOOL",
          "new_api": null,
          "old_text": "OPT_BOOL(delayed_peak)",
          "new_text": null,
          "old_line_content": "        {\"allow-delayed-peak-detect\", OPT_BOOL(delayed_peak)},",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2224,
          "old_api": "M_RANGE",
          "new_api": null,
          "old_text": "M_RANGE(0, 1)",
          "new_text": null,
          "old_line_content": "        {\"corner-rounding\", OPT_FLOAT(corner_rounding), M_RANGE(0, 1)},",
          "new_line_content": "    .options = (const struct m_option[]) {",
          "content_same": false
        },
        {
          "line": 1712,
          "old_api": "get_cache_file",
          "new_api": null,
          "old_text": "get_cache_file(p)",
          "new_text": null,
          "old_line_content": "    char *cache_file = get_cache_file(p);",
          "new_line_content": "    p->osd_sync = 1;",
          "content_same": false
        },
        {
          "line": 690,
          "old_api": "pl_color_system_guess_ycbcr",
          "new_api": null,
          "old_text": "pl_color_system_guess_ycbcr(par->w, par->h)",
          "new_text": null,
          "old_line_content": "            frame->repr.sys = pl_color_system_guess_ycbcr(par->w, par->h);",
          "new_line_content": "    case MP_CSP_AUTO:",
          "content_same": false
        },
        {
          "line": 1715,
          "old_api": "stream_read_file",
          "new_api": null,
          "old_text": "stream_read_file(cache_file, p, vo->global, 1000000000)",
          "new_text": null,
          "old_line_content": "            bstr c = stream_read_file(cache_file, p, vo->global, 1000000000);",
          "new_line_content": "    if (cache_file) {",
          "content_same": false
        },
        {
          "line": 1205,
          "old_api": "vo_get_src_dst_rects",
          "new_api": null,
          "old_text": "vo_get_src_dst_rects(vo, &src, &dst, &osd)",
          "new_text": null,
          "old_line_content": "    vo_get_src_dst_rects(vo, &src, &dst, &osd);",
          "new_line_content": "    struct mp_rect src, dst;",
          "content_same": false
        },
        {
          "line": 697,
          "old_api": "mp_imgfmt_get_desc",
          "new_api": null,
          "old_text": "mp_imgfmt_get_desc(par->imgfmt)",
          "new_text": null,
          "old_line_content": "        struct mp_imgfmt_desc desc = mp_imgfmt_get_desc(par->imgfmt);",
          "new_line_content": "    if (fp->hwdec) {",
          "content_same": false
        },
        {
          "line": 1722,
          "old_api": "pl_options_alloc",
          "new_api": null,
          "old_text": "pl_options_alloc(p->pllog)",
          "new_text": null,
          "old_line_content": "    p->pars = pl_options_alloc(p->pllog);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1211,
          "old_api": "mp_rect_equals",
          "new_api": null,
          "old_text": "mp_rect_equals(&p->src, &src)",
          "new_text": null,
          "old_line_content": "    if (mp_rect_equals(&p->src, &src) &&",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1212,
          "old_api": "mp_rect_equals",
          "new_api": null,
          "old_text": "mp_rect_equals(&p->dst, &dst)",
          "new_text": null,
          "old_line_content": "        mp_rect_equals(&p->dst, &dst) &&",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1723,
          "old_api": "update_render_options",
          "new_api": null,
          "old_text": "update_render_options(vo)",
          "new_text": null,
          "old_line_content": "    update_render_options(vo);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1727,
          "old_api": "uninit",
          "new_api": null,
          "old_text": "uninit(vo)",
          "new_text": null,
          "old_line_content": "    uninit(vo);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": "mp_imgfmt_desc_get_num_comps",
          "new_api": null,
          "old_text": "mp_imgfmt_desc_get_num_comps(&desc)",
          "new_text": null,
          "old_line_content": "            for (int c = 0; c < mp_imgfmt_desc_get_num_comps(&desc); c++) {",
          "new_line_content": "            struct pl_plane *plane = &frame->planes[n];",
          "content_same": false
        },
        {
          "line": 1225,
          "old_api": "reconfig",
          "new_api": null,
          "old_text": "p->ra_ctx->fns->reconfig(p->ra_ctx)",
          "new_text": null,
          "old_line_content": "    if (!p->ra_ctx->fns->reconfig(p->ra_ctx))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1228,
          "old_api": "resize",
          "new_api": null,
          "old_text": "resize(vo)",
          "new_text": null,
          "old_line_content": "    resize(vo);",
          "new_line_content": "        return -1;",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": "plane_data_from_imgfmt",
          "new_api": null,
          "old_text": "plane_data_from_imgfmt(data, &frame->repr.bits, mpi->imgfmt)",
          "new_text": null,
          "old_line_content": "        frame->num_planes = plane_data_from_imgfmt(data, &frame->repr.bits, mpi->imgfmt);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 725,
          "old_api": "mp_image_plane_w",
          "new_api": null,
          "old_text": "mp_image_plane_w(mpi, n)",
          "new_text": null,
          "old_line_content": "            data[n].width = mp_image_plane_w(mpi, n);",
          "new_line_content": "        for (int n = 0; n < frame->num_planes; n++) {",
          "content_same": false
        },
        {
          "line": 726,
          "old_api": "mp_image_plane_h",
          "new_api": null,
          "old_text": "mp_image_plane_h(mpi, n)",
          "new_text": null,
          "old_line_content": "            data[n].height = mp_image_plane_h(mpi, n);",
          "new_line_content": "            struct pl_plane *plane = &frame->planes[n];",
          "content_same": false
        },
        {
          "line": 1240,
          "old_api": "pl_icc_profile_compute_signature",
          "new_api": null,
          "old_text": "pl_icc_profile_compute_signature(&profile)",
          "new_text": null,
          "old_line_content": "    pl_icc_profile_compute_signature(&profile);",
          "new_line_content": "    };",
          "content_same": false
        },
        {
          "line": 1243,
          "old_api": "pl_icc_update",
          "new_api": null,
          "old_text": "pl_icc_update(p->pllog, &p->icc_profile, &profile, &p->icc_params)",
          "new_text": null,
          "old_line_content": "    bool ok = pl_icc_update(p->pllog, &p->icc_profile, &profile, &p->icc_params);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1244,
          "old_api": "talloc_free",
          "new_api": null,
          "old_text": "talloc_free(icc.start)",
          "new_text": null,
          "old_line_content": "    talloc_free(icc.start);",
          "new_line_content": "#if PL_API_VER >= 327",
          "content_same": false
        },
        {
          "line": 1247,
          "old_api": "talloc_free",
          "new_api": null,
          "old_text": "talloc_free((void *) p->icc_profile.data)",
          "new_text": null,
          "old_line_content": "    talloc_free((void *) p->icc_profile.data);",
          "new_line_content": "    return ok;",
          "content_same": false
        },
        {
          "line": 736,
          "old_api": "get_dr_buf",
          "new_api": null,
          "old_text": "get_dr_buf(p, data[n].pixels)",
          "new_text": null,
          "old_line_content": "            pl_buf buf = get_dr_buf(p, data[n].pixels);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1248,
          "old_api": "talloc_steal",
          "new_api": null,
          "old_text": "talloc_steal(p, (void *) profile.data)",
          "new_text": null,
          "old_line_content": "    profile.data = talloc_steal(p, (void *) profile.data);",
          "new_line_content": "#else",
          "content_same": false
        },
        {
          "line": 1759,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(cfg->kernel.name, fixed_presets[i].name)",
          "new_text": null,
          "old_line_content": "        if (strcmp(cfg->kernel.name, fixed_presets[i].name) == 0)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 743,
          "old_api": "mp_image_new_ref",
          "new_api": null,
          "old_text": "mp_image_new_ref(mpi)",
          "new_text": null,
          "old_line_content": "                data[n].priv = mp_image_new_ref(mpi);",
          "new_line_content": "            } else if (gpu->limits.callbacks) {",
          "content_same": false
        },
        {
          "line": 1767,
          "old_api": "pl_find_filter_preset",
          "new_api": null,
          "old_text": "pl_find_filter_preset(cfg->kernel.name)",
          "new_text": null,
          "old_line_content": "    if ((preset = pl_find_filter_preset(cfg->kernel.name))) {",
          "new_line_content": "    const struct pl_filter_preset *preset;",
          "content_same": false
        },
        {
          "line": 746,
          "old_api": "pl_upload_plane",
          "new_api": null,
          "old_text": "pl_upload_plane(gpu, plane, &tex[n], &data[n])",
          "new_text": null,
          "old_line_content": "            if (!pl_upload_plane(gpu, plane, &tex[n], &data[n])) {",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 747,
          "old_api": "MP_ERR",
          "new_api": null,
          "old_text": "MP_ERR(vo, \"Failed uploading frame!\\n\")",
          "new_text": null,
          "old_line_content": "                MP_ERR(vo, \"Failed uploading frame!\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1261,
          "old_api": "MP_VERBOSE",
          "new_api": null,
          "old_text": "MP_VERBOSE(p, \"Querying ICC profile...\\n\")",
          "new_text": null,
          "old_line_content": "    MP_VERBOSE(p, \"Querying ICC profile...\\n\");",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 1778,
          "old_api": "MP_ERR",
          "new_api": null,
          "old_text": "MP_ERR(p, \"Failed mapping filter function '%s', no libplacebo analog?\\n\",\n               cfg->kernel.name)",
          "new_text": null,
          "old_line_content": "        MP_ERR(p, \"Failed mapping filter function '%s', no libplacebo analog?\\n\",",
          "new_line_content": "        };",
          "content_same": false
        },
        {
          "line": 1267,
          "old_api": "MP_WARN",
          "new_api": null,
          "old_text": "MP_WARN(p, \"Could not retrieve an ICC profile.\\n\")",
          "new_text": null,
          "old_line_content": "            MP_WARN(p, \"Could not retrieve an ICC profile.\\n\");",
          "new_line_content": "    if (r != VO_NOTAVAIL) {",
          "content_same": false
        },
        {
          "line": 757,
          "old_api": "mp_chroma_to_pl",
          "new_api": null,
          "old_text": "mp_chroma_to_pl(par->chroma_location)",
          "new_text": null,
          "old_line_content": "    pl_frame_set_chroma_location(frame, mp_chroma_to_pl(par->chroma_location));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 760,
          "old_api": "mp_map_dovi_metadata_to_pl",
          "new_api": null,
          "old_text": "mp_map_dovi_metadata_to_pl(mpi, frame)",
          "new_text": null,
          "old_line_content": "    mp_map_dovi_metadata_to_pl(mpi, frame);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1272,
          "old_api": "update_icc",
          "new_api": null,
          "old_text": "update_icc(p, icc)",
          "new_text": null,
          "old_line_content": "        update_icc(p, icc);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1784,
          "old_api": "pl_find_filter_function_preset",
          "new_api": null,
          "old_text": "pl_find_filter_function_preset(cfg->window.name)",
          "new_text": null,
          "old_line_content": "    if ((wpreset = pl_find_filter_function_preset(cfg->window.name))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 251,
          "old_api": "pl_buf_create",
          "new_api": null,
          "old_text": "pl_buf_create(gpu, &(struct pl_buf_params) {\n        .memory_type = PL_BUF_MEM_HOST,\n        .host_mapped = true,\n        .size = size + stride_align,\n    })",
          "new_text": null,
          "old_line_content": "    pl_buf buf = pl_buf_create(gpu, &(struct pl_buf_params) {",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 764,
          "old_api": "pl_film_grain_from_av",
          "new_api": null,
          "old_text": "pl_film_grain_from_av(&frame->film_grain, (AVFilmGrainParams *) mpi->film_grain->data)",
          "new_text": null,
          "old_line_content": "        pl_film_grain_from_av(&frame->film_grain, (AVFilmGrainParams *) mpi->film_grain->data);",
          "new_line_content": "#ifdef PL_HAVE_LAV_FILM_GRAIN",
          "content_same": false
        },
        {
          "line": 771,
          "old_api": "pl_icc_profile_compute_signature",
          "new_api": null,
          "old_text": "pl_icc_profile_compute_signature(&frame->profile)",
          "new_text": null,
          "old_line_content": "    pl_icc_profile_compute_signature(&frame->profile);",
          "new_line_content": "    // practice ICC profiles are overwhelmingly going to be attached to",
          "content_same": false
        },
        {
          "line": 260,
          "old_api": "mp_image_from_buffer",
          "new_api": null,
          "old_text": "mp_image_from_buffer(imgfmt, w, h, stride_align,\n                                                buf->data, buf->params.size,\n                                                p, free_dr_buf)",
          "new_text": null,
          "old_line_content": "    struct mp_image *mpi = mp_image_from_buffer(imgfmt, w, h, stride_align,",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 774,
          "old_api": "update_lut",
          "new_api": null,
          "old_text": "update_lut(p, &p->image_lut)",
          "new_text": null,
          "old_line_content": "    update_lut(p, &p->image_lut);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1287,
          "old_api": "update_options",
          "new_api": null,
          "old_text": "update_options(vo)",
          "new_text": null,
          "old_line_content": "    update_options(vo);",
          "new_line_content": "    args->res = NULL;",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": "pl_buf_destroy",
          "new_api": null,
          "old_text": "pl_buf_destroy(gpu, &buf)",
          "new_text": null,
          "old_line_content": "        pl_buf_destroy(gpu, &buf);",
          "new_line_content": "                                                p, free_dr_buf);",
          "content_same": false
        },
        {
          "line": 1803,
          "old_api": "isnan",
          "new_api": null,
          "old_text": "isnan(cfg->kernel.params[i])",
          "new_text": null,
          "old_line_content": "        if (!isnan(cfg->kernel.params[i]))",
          "new_line_content": "    for (int i = 0; i < 2; i++) {",
          "content_same": false
        },
        {
          "line": 268,
          "old_api": "pthread_mutex_lock",
          "new_api": null,
          "old_text": "pthread_mutex_lock(&p->dr_lock)",
          "new_text": null,
          "old_line_content": "    pthread_mutex_lock(&p->dr_lock);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 269,
          "old_api": "MP_TARRAY_APPEND",
          "new_api": null,
          "old_text": "MP_TARRAY_APPEND(p, p->dr_buffers, p->num_dr_buffers, buf)",
          "new_text": null,
          "old_line_content": "    MP_TARRAY_APPEND(p, p->dr_buffers, p->num_dr_buffers, buf);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1808,
          "old_api": "isnan",
          "new_api": null,
          "old_text": "isnan(cfg->kernel.params[i])",
          "new_text": null,
          "old_line_content": "        if (!isnan(cfg->kernel.params[i]))",
          "new_line_content": "            par->config.wparams[i] = cfg->window.params[i];",
          "content_same": false
        },
        {
          "line": 786,
          "old_api": "MP_ARRAY_SIZE",
          "new_api": null,
          "old_text": "MP_ARRAY_SIZE(fp->subs.entries)",
          "new_text": null,
          "old_line_content": "    for (int i = 0; i < MP_ARRAY_SIZE(fp->subs.entries); i++) {",
          "new_line_content": "    struct frame_priv *fp = mpi->priv;",
          "content_same": false
        },
        {
          "line": 789,
          "old_api": "MP_TARRAY_APPEND",
          "new_api": null,
          "old_text": "MP_TARRAY_APPEND(p, p->sub_tex, p->num_sub_tex, tex)",
          "new_text": null,
          "old_line_content": "            MP_TARRAY_APPEND(p, p->sub_tex, p->num_sub_tex, tex);",
          "new_line_content": "        pl_tex tex = fp->subs.entries[i].tex;",
          "content_same": false
        },
        {
          "line": 1304,
          "old_api": "pl_queue_params",
          "new_api": null,
          "old_text": "pl_queue_params(.pts = p->last_pts)",
          "new_text": null,
          "old_line_content": "    status = pl_queue_update(p->queue, &mix, pl_queue_params(.pts = p->last_pts));",
          "new_line_content": "    struct pl_frame_mix mix;",
          "content_same": false
        },
        {
          "line": 1305,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(status != PL_QUEUE_EOF)",
          "new_text": null,
          "old_line_content": "    assert(status != PL_QUEUE_EOF);",
          "new_line_content": "    enum pl_queue_status status;",
          "content_same": false
        },
        {
          "line": 797,
          "old_api": "talloc_free",
          "new_api": null,
          "old_text": "talloc_free(mpi)",
          "new_text": null,
          "old_line_content": "    talloc_free(mpi);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1311,
          "old_api": "MP_ERR",
          "new_api": null,
          "old_text": "MP_ERR(vo, \"No frames available to take screenshot of, is a file loaded?\\n\")",
          "new_text": null,
          "old_line_content": "        MP_ERR(vo, \"No frames available to take screenshot of, is a file loaded?\\n\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 289,
          "old_api": "osd_render",
          "new_api": null,
          "old_text": "osd_render(vo->osd, res, pts, flags, subfmt_all)",
          "new_text": null,
          "old_line_content": "    struct sub_bitmap_list *subs = osd_render(vo->osd, res, pts, flags, subfmt_all);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1828,
          "old_api": "MP_WARN",
          "new_api": null,
          "old_text": "MP_WARN(p, \"Filter radius specified but filter '%s' is not \"\n                    \"resizable, ignoring\\n\", cfg->kernel.name)",
          "new_text": null,
          "old_line_content": "            MP_WARN(p, \"Filter radius specified but filter '%s' is not \"",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 811,
          "old_api": "abort",
          "new_api": null,
          "old_text": "abort()",
          "new_text": null,
          "old_line_content": "    default: abort();",
          "new_line_content": "    case PL_RENDER_STAGE_FRAME: frame = &p->perf_fresh; break;",
          "content_same": false
        },
        {
          "line": 1323,
          "old_api": "mp_image_params_get_dsize",
          "new_api": null,
          "old_text": "mp_image_params_get_dsize(&mpi->params, &w, &h)",
          "new_text": null,
          "old_line_content": "        mp_image_params_get_dsize(&mpi->params, &w, &h);",
          "new_line_content": "    if (!args->scaled) {",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": "MP_TARRAY_POP",
          "new_api": null,
          "old_text": "MP_TARRAY_POP(p->sub_tex, p->num_sub_tex, &entry->tex)",
          "new_text": null,
          "old_line_content": "            MP_TARRAY_POP(p->sub_tex, p->num_sub_tex, &entry->tex);",
          "new_line_content": "        pl_fmt tex_fmt = p->osd_fmt[item->format];",
          "content_same": false
        },
        {
          "line": 304,
          "old_api": "pl_tex_recreate",
          "new_api": null,
          "old_text": "pl_tex_recreate(p->gpu, &entry->tex, &(struct pl_tex_params) {\n            .format = tex_fmt,\n            .w = MPMAX(item->packed_w, entry->tex ? entry->tex->params.w : 0),\n            .h = MPMAX(item->packed_h, entry->tex ? entry->tex->params.h : 0),\n            .host_writable = true,\n            .sampleable = true,\n        })",
          "new_text": null,
          "old_line_content": "        bool ok = pl_tex_recreate(p->gpu, &entry->tex, &(struct pl_tex_params) {",
          "new_line_content": "        if (!entry->tex)",
          "content_same": false
        },
        {
          "line": 815,
          "old_api": "pl_dispatch_info_move",
          "new_api": null,
          "old_text": "pl_dispatch_info_move(&frame->info[info->index], info->pass)",
          "new_text": null,
          "old_line_content": "    pl_dispatch_info_move(&frame->info[info->index], info->pass);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1842,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(p->user_hooks[i].path, path)",
          "new_text": null,
          "old_line_content": "        if (strcmp(p->user_hooks[i].path, path) == 0)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 307,
          "old_api": "MPMAX",
          "new_api": null,
          "old_text": "MPMAX(item->packed_h, entry->tex ? entry->tex->params.h : 0)",
          "new_text": null,
          "old_line_content": "            .h = MPMAX(item->packed_h, entry->tex ? entry->tex->params.h : 0),",
          "new_line_content": "            .format = tex_fmt,",
          "content_same": false
        },
        {
          "line": 1332,
          "old_api": "mp_image_crop_valid",
          "new_api": null,
          "old_text": "mp_image_crop_valid(&mpi->params)",
          "new_text": null,
          "old_line_content": "        if (mp_image_crop_valid(&mpi->params))",
          "new_line_content": "        dst = (struct mp_rect) {0, 0, w, h};",
          "content_same": false
        },
        {
          "line": 822,
          "old_api": "m_config_cache_update",
          "new_api": null,
          "old_text": "m_config_cache_update(p->opts_cache)",
          "new_text": null,
          "old_line_content": "    if (m_config_cache_update(p->opts_cache))",
          "new_line_content": "    struct priv *p = vo->priv;",
          "content_same": false
        },
        {
          "line": 823,
          "old_api": "update_render_options",
          "new_api": null,
          "old_text": "update_render_options(vo)",
          "new_text": null,
          "old_line_content": "        update_render_options(vo);",
          "new_line_content": "    pl_options pars = p->pars;",
          "content_same": false
        },
        {
          "line": 312,
          "old_api": "MP_ERR",
          "new_api": null,
          "old_text": "MP_ERR(vo, \"Failed recreating OSD texture!\\n\")",
          "new_text": null,
          "old_line_content": "            MP_ERR(vo, \"Failed recreating OSD texture!\\n\");",
          "new_line_content": "        });",
          "content_same": false
        },
        {
          "line": 1846,
          "old_api": "mp_get_user_path",
          "new_api": null,
          "old_text": "mp_get_user_path(NULL, p->global, path)",
          "new_text": null,
          "old_line_content": "    char *fname = mp_get_user_path(NULL, p->global, path);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1847,
          "old_api": "stream_read_file",
          "new_api": null,
          "old_text": "stream_read_file(fname, p, p->global, 1000000000)",
          "new_text": null,
          "old_line_content": "    bstr shader = stream_read_file(fname, p, p->global, 1000000000); // 1GB",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": "pl_tex_upload",
          "new_api": null,
          "old_text": "pl_tex_upload(p->gpu, &(struct pl_tex_transfer_params) {\n            .tex        = entry->tex,\n            .rc         = { .x1 = item->packed_w, .y1 = item->packed_h, },\n            .row_pitch  = item->packed->stride[0],\n            .ptr        = item->packed->planes[0],\n        })",
          "new_text": null,
          "old_line_content": "        ok = pl_tex_upload(p->gpu, &(struct pl_tex_transfer_params) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 1339,
          "old_api": "mp_rect_rotate",
          "new_api": null,
          "old_text": "mp_rect_rotate(&src, src_w, src_h, mpi->params.rotate)",
          "new_text": null,
          "old_line_content": "        mp_rect_rotate(&src, src_w, src_h, mpi->params.rotate);",
          "new_line_content": "            MPSWAP(int, src_w, src_h);",
          "content_same": false
        },
        {
          "line": 1340,
          "old_api": "mp_rect_rotate",
          "new_api": null,
          "old_text": "mp_rect_rotate(&dst, w, h, mpi->params.rotate)",
          "new_text": null,
          "old_line_content": "        mp_rect_rotate(&dst, w, h, mpi->params.rotate);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1852,
          "old_api": "pl_mpv_user_shader_parse",
          "new_api": null,
          "old_text": "pl_mpv_user_shader_parse(p->gpu, shader.start, shader.len)",
          "new_text": null,
          "old_line_content": "        hook = pl_mpv_user_shader_parse(p->gpu, shader.start, shader.len);",
          "new_line_content": "    const struct pl_hook *hook = NULL;",
          "content_same": false
        },
        {
          "line": 831,
          "old_api": "mp_csp_equalizer_state_get",
          "new_api": null,
          "old_text": "mp_csp_equalizer_state_get(p->video_eq, &cparams)",
          "new_text": null,
          "old_line_content": "    mp_csp_equalizer_state_get(p->video_eq, &cparams);",
          "new_line_content": "    // Update equalizer state",
          "content_same": false
        },
        {
          "line": 1344,
          "old_api": "mp_rect_w",
          "new_api": null,
          "old_text": "mp_rect_w(dst)",
          "new_text": null,
          "old_line_content": "            .w = mp_rect_w(dst),",
          "new_line_content": "        osd = (struct mp_osd_res) {",
          "content_same": false
        },
        {
          "line": 1345,
          "old_api": "mp_rect_h",
          "new_api": null,
          "old_text": "mp_rect_h(dst)",
          "new_text": null,
          "old_line_content": "            .h = mp_rect_h(dst),",
          "new_line_content": "            .display_par = 1.0,",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": "MP_ERR",
          "new_api": null,
          "old_text": "MP_ERR(vo, \"Failed uploading OSD texture!\\n\")",
          "new_text": null,
          "old_line_content": "            MP_ERR(vo, \"Failed uploading OSD texture!\\n\");",
          "new_line_content": "        });",
          "content_same": false
        },
        {
          "line": 1855,
          "old_api": "talloc_strdup",
          "new_api": null,
          "old_text": "talloc_strdup(p, path)",
          "new_text": null,
          "old_line_content": "        .path = talloc_strdup(p, path),",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 841,
          "old_api": "pl_options_set_str",
          "new_api": null,
          "old_text": "pl_options_set_str(pars, kv[0], kv[1])",
          "new_text": null,
          "old_line_content": "        pl_options_set_str(pars, kv[0], kv[1]);",
          "new_line_content": "#if PL_API_VER >= 309",
          "content_same": false
        },
        {
          "line": 1353,
          "old_api": "pl_find_fmt",
          "new_api": null,
          "old_text": "pl_find_fmt(gpu, PL_FMT_UNORM, 4, depth, depth,\n                                 PL_FMT_CAP_RENDERABLE | PL_FMT_CAP_HOST_READABLE)",
          "new_text": null,
          "old_line_content": "        pl_fmt fmt = pl_find_fmt(gpu, PL_FMT_UNORM, 4, depth, depth,",
          "new_line_content": "    for (int depth = args->high_bit_depth ? 16 : 8; depth; depth -= 8) {",
          "content_same": false
        },
        {
          "line": 1358,
          "old_api": "pl_tex_params",
          "new_api": null,
          "old_text": "pl_tex_params(\n            .w = osd.w,\n            .h = osd.h,\n            .format = fmt,\n            .blit_dst = true,\n            .renderable = true,\n            .host_readable = true,\n            .storable = fmt->caps & PL_FMT_CAP_STORABLE,\n        )",
          "new_text": null,
          "old_line_content": "        fbo = pl_tex_create(gpu, pl_tex_params(",
          "new_line_content": "            continue;",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": "MP_TARRAY_APPEND",
          "new_api": null,
          "old_text": "MP_TARRAY_APPEND(p, entry->parts, entry->num_parts, part)",
          "new_text": null,
          "old_line_content": "            MP_TARRAY_APPEND(p, entry->parts, entry->num_parts, part);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1877,
          "old_api": "mp_get_user_path",
          "new_api": null,
          "old_text": "mp_get_user_path(NULL, p->global, cache_dir)",
          "new_text": null,
          "old_line_content": "        cache_dir = mp_get_user_path(NULL, p->global, cache_dir);",
          "new_line_content": "    char *cache_dir = opts->icc_opts->cache_dir;",
          "content_same": false
        },
        {
          "line": 860,
          "old_api": "pl_nominal_luma_params",
          "new_api": null,
          "old_text": "pl_nominal_luma_params(\n        .color = color,\n        // with HDR10 meta to respect value if already set\n        .metadata = PL_HDR_METADATA_HDR10,\n        .scaling = PL_HDR_NITS,\n        .out_max = &color->hdr.max_luma\n    )",
          "new_text": null,
          "old_line_content": "    pl_color_space_nominal_luma_ex(pl_nominal_luma_params(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1372,
          "old_api": "MP_ERR",
          "new_api": null,
          "old_text": "MP_ERR(vo, \"Failed creating target FBO for screenshot!\\n\")",
          "new_text": null,
          "old_line_content": "        MP_ERR(vo, \"Failed creating target FBO for screenshot!\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1885,
          "old_api": "mp_path_join",
          "new_api": null,
          "old_text": "mp_path_join(NULL, cache_dir, cache_name)",
          "new_text": null,
          "old_line_content": "    char *path = mp_path_join(NULL, cache_dir, cache_name);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 1888,
          "old_api": "mp_mkdirp",
          "new_api": null,
          "old_text": "mp_mkdirp(cache_dir)",
          "new_text": null,
          "old_line_content": "        mp_mkdirp(cache_dir);",
          "new_line_content": "    stream_t *stream = NULL;",
          "content_same": false
        },
        {
          "line": 1891,
          "old_api": "stat",
          "new_api": null,
          "old_text": "stat(path, &(struct stat) {0})",
          "new_text": null,
          "old_line_content": "        if (stat(path, &(struct stat) {0}) < 0)",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 1896,
          "old_api": "stream_create",
          "new_api": null,
          "old_text": "stream_create(path, flags, NULL, p->global)",
          "new_text": null,
          "old_line_content": "    stream = stream_create(path, flags, NULL, p->global);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 361,
          "old_api": "get_mpi_csp",
          "new_api": null,
          "old_text": "get_mpi_csp(vo, src)",
          "new_text": null,
          "old_line_content": "                ol->color = get_mpi_csp(vo, src);",
          "new_line_content": "            // Infer bitmap colorspace from source",
          "content_same": false
        },
        {
          "line": 873,
          "old_api": "update_lut",
          "new_api": null,
          "old_text": "update_lut(p, &p->target_lut)",
          "new_text": null,
          "old_line_content": "    update_lut(p, &p->target_lut);",
          "new_line_content": "static void apply_target_options(struct priv *p, struct pl_frame *target)",
          "content_same": false
        },
        {
          "line": 1899,
          "old_api": "talloc_free",
          "new_api": null,
          "old_text": "talloc_free(cache_dir)",
          "new_text": null,
          "old_line_content": "    talloc_free(cache_dir);",
          "new_line_content": "    // fall through",
          "content_same": false
        },
        {
          "line": 1388,
          "old_api": "apply_target_options",
          "new_api": null,
          "old_text": "apply_target_options(p, &target)",
          "new_text": null,
          "old_line_content": "        apply_target_options(p, &target);",
          "new_line_content": "    if (args->scaled) {",
          "content_same": false
        },
        {
          "line": 1900,
          "old_api": "talloc_free",
          "new_api": null,
          "old_text": "talloc_free(path)",
          "new_text": null,
          "old_line_content": "    talloc_free(path);",
          "new_line_content": "done:",
          "content_same": false
        },
        {
          "line": 880,
          "old_api": "mp_levels_to_pl",
          "new_api": null,
          "old_text": "mp_levels_to_pl(p->output_levels)",
          "new_text": null,
          "old_line_content": "        target->repr.levels = mp_levels_to_pl(p->output_levels);",
          "new_line_content": "    const struct gl_video_opts *opts = p->opts_cache->opts;",
          "content_same": false
        },
        {
          "line": 1395,
          "old_api": "apply_crop",
          "new_api": null,
          "old_text": "apply_crop(&image, src, mpi->params.w, mpi->params.h)",
          "new_text": null,
          "old_line_content": "    apply_crop(&image, src, mpi->params.w, mpi->params.h);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1396,
          "old_api": "apply_crop",
          "new_api": null,
          "old_text": "apply_crop(&target, dst, fbo->params.w, fbo->params.h)",
          "new_text": null,
          "old_line_content": "    apply_crop(&target, dst, fbo->params.w, fbo->params.h);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1907,
          "old_api": "icc_open_cache",
          "new_api": null,
          "old_text": "icc_open_cache(p, sig, STREAM_WRITE)",
          "new_text": null,
          "old_line_content": "    stream_t *s = icc_open_cache(p, sig, STREAM_WRITE);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1910,
          "old_api": "stream_write_buffer",
          "new_api": null,
          "old_text": "stream_write_buffer(s, (void *) cache, size)",
          "new_text": null,
          "old_line_content": "    stream_write_buffer(s, (void *) cache, size);",
          "new_line_content": "    if (!s)",
          "content_same": false
        },
        {
          "line": 1911,
          "old_api": "free_stream",
          "new_api": null,
          "old_text": "free_stream(s)",
          "new_text": null,
          "old_line_content": "    free_stream(s);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 377,
          "old_api": "talloc_free",
          "new_api": null,
          "old_text": "talloc_free(subs)",
          "new_text": null,
          "old_line_content": "    talloc_free(subs);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 889,
          "old_api": "apply_target_contrast",
          "new_api": null,
          "old_text": "apply_target_contrast(p, &target->color)",
          "new_text": null,
          "old_line_content": "        apply_target_contrast(p, &target->color);",
          "new_line_content": "        target->color.hdr.max_luma = opts->target_peak;",
          "content_same": false
        },
        {
          "line": 1917,
          "old_api": "icc_open_cache",
          "new_api": null,
          "old_text": "icc_open_cache(p, sig, STREAM_READ)",
          "new_text": null,
          "old_line_content": "    stream_t *s = icc_open_cache(p, sig, STREAM_READ);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1408,
          "old_api": "pl_rect_w",
          "new_api": null,
          "old_text": "pl_rect_w(image.crop)",
          "new_text": null,
          "old_line_content": "        float rx = pl_rect_w(dst) / pl_rect_w(image.crop);",
          "new_line_content": "    struct frame_priv *fp = mpi->priv;",
          "content_same": false
        },
        {
          "line": 1409,
          "old_api": "pl_rect_h",
          "new_api": null,
          "old_text": "pl_rect_h(image.crop)",
          "new_text": null,
          "old_line_content": "        float ry = pl_rect_h(dst) / pl_rect_h(image.crop);",
          "new_line_content": "    if (opts->blend_subs) {",
          "content_same": false
        },
        {
          "line": 1921,
          "old_api": "stream_read",
          "new_api": null,
          "old_text": "stream_read(s, cache, size)",
          "new_text": null,
          "old_line_content": "    int len = stream_read(s, cache, size);",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 899,
          "old_api": "pl_nominal_luma_params",
          "new_api": null,
          "old_text": "pl_nominal_luma_params(\n            .color    = &target->color,\n            .metadata = PL_HDR_METADATA_HDR10, // use only static HDR nits\n            .scaling  = PL_HDR_NITS,\n            .out_max  = &p->icc_params.max_luma,\n        )",
          "new_text": null,
          "old_line_content": "        pl_color_space_nominal_luma_ex(pl_nominal_luma_params(",
          "new_line_content": "        p->icc_params.max_luma = 0.0f;",
          "content_same": false
        },
        {
          "line": 1412,
          "old_api": "pl_rect_h",
          "new_api": null,
          "old_text": "pl_rect_h(dst)",
          "new_text": null,
          "old_line_content": "            .h = pl_rect_h(dst),",
          "new_line_content": "        struct mp_osd_res res = {",
          "content_same": false
        },
        {
          "line": 1922,
          "old_api": "free_stream",
          "new_api": null,
          "old_text": "free_stream(s)",
          "new_text": null,
          "old_line_content": "    free_stream(s);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 391,
          "old_api": "mp_imgfmt_get_desc",
          "new_api": null,
          "old_text": "mp_imgfmt_get_desc(imgfmt)",
          "new_text": null,
          "old_line_content": "    struct mp_imgfmt_desc desc = mp_imgfmt_get_desc(imgfmt);",
          "new_line_content": "                                  enum mp_imgfmt imgfmt)",
          "content_same": false
        },
        {
          "line": 1419,
          "old_api": "update_overlays",
          "new_api": null,
          "old_text": "update_overlays(vo, res, osd_flags,\n                        PL_OVERLAY_COORDS_DST_CROP,\n                        &fp->subs, &image, mpi)",
          "new_text": null,
          "old_line_content": "        update_overlays(vo, res, osd_flags,",
          "new_line_content": "            .display_par = 1.0,",
          "content_same": false
        },
        {
          "line": 908,
          "old_api": "pl_icc_update",
          "new_api": null,
          "old_text": "pl_icc_update(p->pllog, &p->icc_profile, NULL, &p->icc_params)",
          "new_text": null,
          "old_line_content": "    pl_icc_update(p->pllog, &p->icc_profile, NULL, &p->icc_params);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1933,
          "old_api": "update_icc",
          "new_api": null,
          "old_text": "update_icc(p, (bstr) {0})",
          "new_text": null,
          "old_line_content": "        update_icc(p, (bstr) {0});",
          "new_line_content": "    if (!opts->profile_auto && !p->icc_path) {",
          "content_same": false
        },
        {
          "line": 1424,
          "old_api": "update_overlays",
          "new_api": null,
          "old_text": "update_overlays(vo, osd, osd_flags, PL_OVERLAY_COORDS_DST_FRAME,\n                        &p->osd_state, &target, mpi)",
          "new_text": null,
          "old_line_content": "        update_overlays(vo, osd, osd_flags, PL_OVERLAY_COORDS_DST_FRAME,",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 1937,
          "old_api": "gl_parse_3dlut_size",
          "new_api": null,
          "old_text": "gl_parse_3dlut_size(opts->size_str, &s_r, &s_g, &s_b)",
          "new_text": null,
          "old_line_content": "    gl_parse_3dlut_size(opts->size_str, &s_r, &s_g, &s_b);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1429,
          "old_api": "pl_render_image",
          "new_api": null,
          "old_text": "pl_render_image(p->rr, &image, &target, &params)",
          "new_text": null,
          "old_line_content": "    if (!pl_render_image(p->rr, &image, &target, &params)) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1430,
          "old_api": "MP_ERR",
          "new_api": null,
          "old_text": "MP_ERR(vo, \"Failed rendering frame!\\n\")",
          "new_text": null,
          "old_line_content": "        MP_ERR(vo, \"Failed rendering frame!\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1434,
          "old_api": "mp_image_alloc",
          "new_api": null,
          "old_text": "mp_image_alloc(mpfmt, fbo->params.w, fbo->params.h)",
          "new_text": null,
          "old_line_content": "    args->res = mp_image_alloc(mpfmt, fbo->params.w, fbo->params.h);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 926,
          "old_api": "pl_rect2df_rotate",
          "new_api": null,
          "old_text": "pl_rect2df_rotate(&frame->crop, -frame->rotation)",
          "new_text": null,
          "old_line_content": "    pl_rect2df_rotate(&frame->crop, -frame->rotation);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1438,
          "old_api": "mp_prim_from_pl",
          "new_api": null,
          "old_text": "mp_prim_from_pl(target.color.primaries)",
          "new_text": null,
          "old_line_content": "    args->res->params.color.primaries = mp_prim_from_pl(target.color.primaries);",
          "new_line_content": "        goto done;",
          "content_same": false
        },
        {
          "line": 1439,
          "old_api": "mp_trc_from_pl",
          "new_api": null,
          "old_text": "mp_trc_from_pl(target.color.transfer)",
          "new_text": null,
          "old_line_content": "    args->res->params.color.gamma = mp_trc_from_pl(target.color.transfer);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": "mp_imgfmt_desc_get_num_comps",
          "new_api": null,
          "old_text": "mp_imgfmt_desc_get_num_comps(&desc)",
          "new_text": null,
          "old_line_content": "        for (int c = 0; c < mp_imgfmt_desc_get_num_comps(&desc); c++) {",
          "new_line_content": "            return 0; // Pixel size is not byte-aligned",
          "content_same": false
        },
        {
          "line": 1952,
          "old_api": "update_icc",
          "new_api": null,
          "old_text": "update_icc(p, (bstr) {0})",
          "new_text": null,
          "old_line_content": "        update_icc(p, (bstr) {0});",
          "new_line_content": "    if (!opts->profile || !opts->profile[0]) {",
          "content_same": false
        },
        {
          "line": 1953,
          "old_api": "TA_FREEP",
          "new_api": null,
          "old_text": "TA_FREEP(&p->icc_path)",
          "new_text": null,
          "old_line_content": "        TA_FREEP(&p->icc_path);",
          "new_line_content": "        // No profile enabled, un-load any existing profiles",
          "content_same": false
        },
        {
          "line": 1445,
          "old_api": "pl_tex_transfer_params",
          "new_api": null,
          "old_text": "pl_tex_transfer_params(\n        .tex = fbo,\n        .ptr = args->res->planes[0],\n        .row_pitch = args->res->stride[0],\n    )",
          "new_text": null,
          "old_line_content": "    bool ok = pl_tex_download(gpu, pl_tex_transfer_params(",
          "new_line_content": "        args->res->params.p_w = args->res->params.p_h = 1;",
          "content_same": false
        },
        {
          "line": 1957,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(opts->profile, p->icc_path)",
          "new_text": null,
          "old_line_content": "    if (p->icc_path && strcmp(opts->profile, p->icc_path) == 0)",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1960,
          "old_api": "mp_get_user_path",
          "new_api": null,
          "old_text": "mp_get_user_path(NULL, p->global, opts->profile)",
          "new_text": null,
          "old_line_content": "    char *fname = mp_get_user_path(NULL, p->global, opts->profile);",
          "new_line_content": "        return; // ICC profile hasn't changed",
          "content_same": false
        },
        {
          "line": 1961,
          "old_api": "MP_VERBOSE",
          "new_api": null,
          "old_text": "MP_VERBOSE(p, \"Opening ICC profile '%s'\\n\", fname)",
          "new_text": null,
          "old_line_content": "    MP_VERBOSE(p, \"Opening ICC profile '%s'\\n\", fname);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1452,
          "old_api": "TA_FREEP",
          "new_api": null,
          "old_text": "TA_FREEP(&args->res)",
          "new_text": null,
          "old_line_content": "        TA_FREEP(&args->res);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1967,
          "old_api": "talloc_free",
          "new_api": null,
          "old_text": "talloc_free(p->icc_path)",
          "new_text": null,
          "old_line_content": "    talloc_free(p->icc_path);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1456,
          "old_api": "pl_tex_destroy",
          "new_api": null,
          "old_text": "pl_tex_destroy(gpu, &fbo)",
          "new_text": null,
          "old_line_content": "    pl_tex_destroy(gpu, &fbo);",
          "new_line_content": "    // fall through",
          "content_same": false
        },
        {
          "line": 945,
          "old_api": "pl_rect_w",
          "new_api": null,
          "old_text": "pl_rect_w(target->crop)",
          "new_text": null,
          "old_line_content": "    const float out_w = fabsf(pl_rect_w(target->crop));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 946,
          "old_api": "pl_rect_h",
          "new_api": null,
          "old_text": "pl_rect_h(target->crop)",
          "new_text": null,
          "old_line_content": "    const float out_h = fabsf(pl_rect_h(target->crop));",
          "new_line_content": "    // Use right half of sceen for TM visualization, constrain to 1:1 AR",
          "content_same": false
        },
        {
          "line": 1968,
          "old_api": "talloc_strdup",
          "new_api": null,
          "old_text": "talloc_strdup(p, opts->profile)",
          "new_text": null,
          "old_line_content": "    p->icc_path = talloc_strdup(p, opts->profile);",
          "new_line_content": "    // Update cached path",
          "content_same": false
        },
        {
          "line": 1461,
          "old_api": "MP_ARRAY_SIZE",
          "new_api": null,
          "old_text": "MP_ARRAY_SIZE(mp->perf)",
          "new_text": null,
          "old_line_content": "    static_assert(MP_ARRAY_SIZE(pl->info) == MP_ARRAY_SIZE(mp->perf), \"\");",
          "new_line_content": "static inline void copy_frame_info_to_mp(struct frame_info *pl,",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(data->component_size, 0, sizeof(data->component_size))",
          "new_text": null,
          "old_line_content": "        memset(data->component_size, 0, sizeof(data->component_size));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1462,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(pl->count <= VO_PASS_PERF_MAX)",
          "new_text": null,
          "old_line_content": "    assert(pl->count <= VO_PASS_PERF_MAX);",
          "new_line_content": "                                         struct mp_frame_perf *mp) {",
          "content_same": false
        },
        {
          "line": 1974,
          "old_api": "pl_lut_free",
          "new_api": null,
          "old_text": "pl_lut_free(&lut->lut)",
          "new_text": null,
          "old_line_content": "        pl_lut_free(&lut->lut);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1975,
          "old_api": "TA_FREEP",
          "new_api": null,
          "old_text": "TA_FREEP(&lut->path)",
          "new_text": null,
          "old_line_content": "        TA_FREEP(&lut->path);",
          "new_line_content": "    if (!lut->opt) {",
          "content_same": false
        },
        {
          "line": 1979,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(lut->path, lut->opt)",
          "new_text": null,
          "old_line_content": "    if (lut->path && strcmp(lut->path, lut->opt) == 0)",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1468,
          "old_api": "MP_ARRAY_SIZE",
          "new_api": null,
          "old_text": "MP_ARRAY_SIZE(pass->samples)",
          "new_text": null,
          "old_line_content": "        static_assert(VO_PERF_SAMPLE_COUNT >= MP_ARRAY_SIZE(pass->samples), \"\");",
          "new_line_content": "        const struct pl_dispatch_info *pass = &pl->info[i];",
          "content_same": false
        },
        {
          "line": 1469,
          "old_api": "MP_ARRAY_SIZE",
          "new_api": null,
          "old_text": "MP_ARRAY_SIZE(pass->samples)",
          "new_text": null,
          "old_line_content": "        assert(pass->num_samples <= MP_ARRAY_SIZE(pass->samples));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1983,
          "old_api": "pl_lut_free",
          "new_api": null,
          "old_text": "pl_lut_free(&lut->lut)",
          "new_text": null,
          "old_line_content": "    pl_lut_free(&lut->lut);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1472,
          "old_api": "MPMIN",
          "new_api": null,
          "old_text": "MPMIN(pass->num_samples, VO_PERF_SAMPLE_COUNT)",
          "new_text": null,
          "old_line_content": "        perf->count = MPMIN(pass->num_samples, VO_PERF_SAMPLE_COUNT);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1473,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(perf->samples, pass->samples, perf->count * sizeof(pass->samples[0]))",
          "new_text": null,
          "old_line_content": "        memcpy(perf->samples, pass->samples, perf->count * sizeof(pass->samples[0]));",
          "new_line_content": "        struct mp_pass_perf *perf = &mp->perf[i];",
          "content_same": false
        },
        {
          "line": 1984,
          "old_api": "talloc_free",
          "new_api": null,
          "old_text": "talloc_free(lut->path)",
          "new_text": null,
          "old_line_content": "    talloc_free(lut->path);",
          "new_line_content": "    // Update cached path",
          "content_same": false
        },
        {
          "line": 451,
          "old_api": "abs",
          "new_api": null,
          "old_text": "abs(sorted[c].pad)",
          "new_text": null,
          "old_line_content": "                .color_depth = sorted[c].size - abs(sorted[c].pad),",
          "new_line_content": "            struct pl_bit_encoding bits = {",
          "content_same": false
        },
        {
          "line": 452,
          "old_api": "MPMAX",
          "new_api": null,
          "old_text": "MPMAX(sorted[c].pad, 0)",
          "new_text": null,
          "old_line_content": "                .bit_shift = MPMAX(sorted[c].pad, 0),",
          "new_line_content": "                .sample_depth = data->component_size[c],",
          "content_same": false
        },
        {
          "line": 964,
          "old_api": "update_options",
          "new_api": null,
          "old_text": "update_options(vo)",
          "new_text": null,
          "old_line_content": "    update_options(vo);",
          "new_line_content": "    pl_options pars = p->pars;",
          "content_same": false
        },
        {
          "line": 1478,
          "old_api": "strncpy",
          "new_api": null,
          "old_text": "strncpy(mp->desc[i], pass->shader->description, sizeof(mp->desc[i]) - 1)",
          "new_text": null,
          "old_line_content": "        strncpy(mp->desc[i], pass->shader->description, sizeof(mp->desc[i]) - 1);",
          "new_line_content": "        perf->avg = pass->average;",
          "content_same": false
        },
        {
          "line": 1988,
          "old_api": "mp_get_user_path",
          "new_api": null,
          "old_text": "mp_get_user_path(NULL, p->global, lut->path)",
          "new_text": null,
          "old_line_content": "    char *fname = mp_get_user_path(NULL, p->global, lut->path);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1989,
          "old_api": "MP_VERBOSE",
          "new_api": null,
          "old_text": "MP_VERBOSE(p, \"Loading custom LUT '%s'\\n\", fname)",
          "new_text": null,
          "old_line_content": "    MP_VERBOSE(p, \"Loading custom LUT '%s'\\n\", fname);",
          "new_line_content": "    // Load LUT file",
          "content_same": false
        },
        {
          "line": 459,
          "old_api": "pl_bit_encoding_equal",
          "new_api": null,
          "old_text": "pl_bit_encoding_equal(out_bits, &bits)",
          "new_text": null,
          "old_line_content": "                if (!pl_bit_encoding_equal(out_bits, &bits)) {",
          "new_line_content": "                has_bits = true;",
          "content_same": false
        },
        {
          "line": 1489,
          "old_api": "resize",
          "new_api": null,
          "old_text": "resize(vo)",
          "new_text": null,
          "old_line_content": "        resize(vo);",
          "new_line_content": "    switch (request) {",
          "content_same": false
        },
        {
          "line": 2001,
          "old_api": "mp_basename",
          "new_api": null,
          "old_text": "mp_basename(shaderpath)",
          "new_text": null,
          "old_line_content": "    const char *basename = mp_basename(shaderpath);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 2004,
          "old_api": "bstr0",
          "new_api": null,
          "old_text": "bstr0(basename)",
          "new_text": null,
          "old_line_content": "        shadername = bstr0(basename);",
          "new_line_content": "    struct bstr shadername;",
          "content_same": false
        },
        {
          "line": 983,
          "old_api": "pl_renderer_flush_cache",
          "new_api": null,
          "old_text": "pl_renderer_flush_cache(p->rr)",
          "new_text": null,
          "old_line_content": "            pl_renderer_flush_cache(p->rr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 984,
          "old_api": "pl_queue_reset",
          "new_api": null,
          "old_text": "pl_queue_reset(p->queue)",
          "new_text": null,
          "old_line_content": "            pl_queue_reset(p->queue);",
          "new_line_content": "        if (p->want_reset) {",
          "content_same": false
        },
        {
          "line": 2007,
          "old_api": "bstr0",
          "new_api": null,
          "old_text": "bstr0(opts[n * 2 + 0])",
          "new_text": null,
          "old_line_content": "        struct bstr k = bstr0(opts[n * 2 + 0]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2008,
          "old_api": "bstr0",
          "new_api": null,
          "old_text": "bstr0(opts[n * 2 + 1])",
          "new_text": null,
          "old_line_content": "        struct bstr v = bstr0(opts[n * 2 + 1]);",
          "new_line_content": "    for (int n = 0; opts[n * 2]; n++) {",
          "content_same": false
        },
        {
          "line": 2011,
          "old_api": "bstr_splice",
          "new_api": null,
          "old_text": "bstr_splice(k, 0, pos)",
          "new_text": null,
          "old_line_content": "            if (!bstr_equals(bstr_splice(k, 0, pos), shadername))",
          "new_line_content": "        int pos;",
          "content_same": false
        },
        {
          "line": 989,
          "old_api": "mp_image_new_ref",
          "new_api": null,
          "old_text": "mp_image_new_ref(frame->frames[n])",
          "new_text": null,
          "old_line_content": "        struct mp_image *mpi = mp_image_new_ref(frame->frames[n]);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 990,
          "old_api": "talloc_zero",
          "new_api": null,
          "old_text": "talloc_zero(mpi, struct frame_priv)",
          "new_text": null,
          "old_line_content": "        struct frame_priv *fp = talloc_zero(mpi, struct frame_priv);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1502,
          "old_api": "m_config_cache_update",
          "new_api": null,
          "old_text": "m_config_cache_update(p->opts_cache)",
          "new_text": null,
          "old_line_content": "        m_config_cache_update(p->opts_cache);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 994,
          "old_api": "pl_queue_push",
          "new_api": null,
          "old_text": "pl_queue_push(p->queue, &(struct pl_source_frame) {\n            .pts = mpi->pts,\n            .duration = frame->ideal_frame_duration,\n            .frame_data = mpi,\n            .map = map_frame,\n            .unmap = unmap_frame,\n            .discard = discard_frame,\n        })",
          "new_text": null,
          "old_line_content": "        pl_queue_push(p->queue, &(struct pl_source_frame) {",
          "new_line_content": "        fp->vo = vo;",
          "content_same": false
        },
        {
          "line": 1506,
          "old_api": "update_render_opts",
          "new_api": null,
          "old_text": "p->ra_ctx->fns->update_render_opts(p->ra_ctx)",
          "new_text": null,
          "old_line_content": "            p->ra_ctx->fns->update_render_opts(p->ra_ctx);",
          "new_line_content": "        p->ra_ctx->opts.want_alpha = opts->alpha_mode == ALPHA_YES;",
          "content_same": false
        },
        {
          "line": 1507,
          "old_api": "update_render_options",
          "new_api": null,
          "old_text": "update_render_options(vo)",
          "new_text": null,
          "old_line_content": "        update_render_options(vo);",
          "new_line_content": "        if (p->ra_ctx->fns->update_render_opts)",
          "content_same": false
        },
        {
          "line": 2018,
          "old_api": "bstr_equals0",
          "new_api": null,
          "old_text": "bstr_equals0(k, hp->name)",
          "new_text": null,
          "old_line_content": "            if (!bstr_equals0(k, hp->name) != 0)",
          "new_line_content": "        for (int i = 0; i < hook->num_parameters; i++) {",
          "content_same": false
        },
        {
          "line": 1514,
          "old_api": "update_auto_profile",
          "new_api": null,
          "old_text": "update_auto_profile(p, &events)",
          "new_text": null,
          "old_line_content": "        update_auto_profile(p, &events);",
          "new_line_content": "        // icc-profile-auto",
          "content_same": false
        },
        {
          "line": 1515,
          "old_api": "vo_event",
          "new_api": null,
          "old_text": "vo_event(vo, events)",
          "new_text": null,
          "old_line_content": "        vo_event(vo, events);",
          "new_line_content": "        int events = 0;",
          "content_same": false
        },
        {
          "line": 2028,
          "old_api": "bstr_equals0",
          "new_api": null,
          "old_text": "bstr_equals0(v, hp->names[j])",
          "new_text": null,
          "old_line_content": "                    if (bstr_equals0(v, hp->names[j])) {",
          "new_line_content": "            if (hp->names) {",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": "mp_prim_to_pl",
          "new_api": null,
          "old_text": "mp_prim_to_pl(mpi->params.color.primaries)",
          "new_text": null,
          "old_line_content": "        .primaries = mp_prim_to_pl(mpi->params.color.primaries),",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 497,
          "old_api": "mp_trc_to_pl",
          "new_api": null,
          "old_text": "mp_trc_to_pl(mpi->params.color.gamma)",
          "new_text": null,
          "old_line_content": "        .transfer = mp_trc_to_pl(mpi->params.color.gamma),",
          "new_line_content": "    struct pl_color_space csp = {",
          "content_same": false
        },
        {
          "line": 1008,
          "old_api": "get_mpi_csp",
          "new_api": null,
          "old_text": "get_mpi_csp(vo, frame->current)",
          "new_text": null,
          "old_line_content": "        struct pl_color_space hint = get_mpi_csp(vo, frame->current);",
          "new_line_content": "    const struct gl_video_opts *opts = p->opts_cache->opts;",
          "content_same": false
        },
        {
          "line": 1015,
          "old_api": "apply_target_contrast",
          "new_api": null,
          "old_text": "apply_target_contrast(p, &hint)",
          "new_text": null,
          "old_line_content": "        apply_target_contrast(p, &hint);",
          "new_line_content": "        if (opts->target_peak)",
          "content_same": false
        },
        {
          "line": 502,
          "old_api": "pl_map_hdr_metadata",
          "new_api": null,
          "old_text": "pl_map_hdr_metadata(&csp.hdr, &(struct pl_av_hdr_metadata) {\n        .mdm = get_side_data(mpi, AV_FRAME_DATA_MASTERING_DISPLAY_METADATA),\n        .clm = get_side_data(mpi, AV_FRAME_DATA_CONTENT_LIGHT_LEVEL),\n        .dhp = get_side_data(mpi, AV_FRAME_DATA_DYNAMIC_HDR_PLUS),\n    })",
          "new_text": null,
          "old_line_content": "    pl_map_hdr_metadata(&csp.hdr, &(struct pl_av_hdr_metadata) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": "get_side_data",
          "new_api": null,
          "old_text": "get_side_data(mpi, AV_FRAME_DATA_MASTERING_DISPLAY_METADATA)",
          "new_text": null,
          "old_line_content": "        .mdm = get_side_data(mpi, AV_FRAME_DATA_MASTERING_DISPLAY_METADATA),",
          "new_line_content": "#ifdef PL_HAVE_LAV_HDR",
          "content_same": false
        },
        {
          "line": 1016,
          "old_api": "pl_swapchain_colorspace_hint",
          "new_api": null,
          "old_text": "pl_swapchain_colorspace_hint(p->sw, &hint)",
          "new_text": null,
          "old_line_content": "        pl_swapchain_colorspace_hint(p->sw, &hint);",
          "new_line_content": "            hint.hdr.max_luma = opts->target_peak;",
          "content_same": false
        },
        {
          "line": 1526,
          "old_api": "copy_frame_info_to_mp",
          "new_api": null,
          "old_text": "copy_frame_info_to_mp(&p->perf_fresh, &perf->fresh)",
          "new_text": null,
          "old_line_content": "        copy_frame_info_to_mp(&p->perf_fresh, &perf->fresh);",
          "new_line_content": "    case VOCTRL_PERFORMANCE_DATA: {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 77,
      "total_additions": 281,
      "total_deletions": 279,
      "total_api_changes": 637
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 637,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 404,
    "api_calls_after": 406,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 0,
      "total_diff_lines": 14
    }
  }
}