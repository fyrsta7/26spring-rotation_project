{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mysql-server/modified_file/aea6bd5081a4785593512467f504bcf8242ce5be",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mysql-server/modified_file/aea6bd5081a4785593512467f504bcf8242ce5be/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mysql-server/modified_file/aea6bd5081a4785593512467f504bcf8242ce5be/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mysql-server/modified_file/aea6bd5081a4785593512467f504bcf8242ce5be/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 75,
          "old_api": "findUniqueId",
          "new_api": "unlock",
          "old_text": "findUniqueId()",
          "new_text": "m_processes.unlock()",
          "old_line_content": "    arg->m_id = findUniqueId();",
          "new_line_content": "  m_processes.unlock();",
          "content_same": false
        },
        {
          "line": 82,
          "old_api": "c_str",
          "new_api": "findUniqueId",
          "old_text": "proc->m_name.c_str()",
          "new_text": "findUniqueId()",
          "old_line_content": "    if((strcmp(arg->m_name.c_str(), proc->m_name.c_str()) == 0) && ",
          "new_line_content": "    arg->m_id = findUniqueId();",
          "content_same": false
        },
        {
          "line": 98,
          "old_api": "notifyChanges",
          "new_api": "err",
          "old_text": "notifyChanges()",
          "new_text": "rs->err(AlreadyExists, \"Id already exists\")",
          "old_line_content": "  notifyChanges();",
          "new_line_content": "      rs->err(AlreadyExists, \"Id already exists\");",
          "content_same": false
        },
        {
          "line": 160,
          "old_api": "start",
          "new_api": "err",
          "old_text": "proc->start()",
          "new_text": "rs->err(NotExists, \"No such process\")",
          "old_line_content": "      if(proc->start() != 0){",
          "new_line_content": "      rs->err(NotExists, \"No such process\");",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": "notifyChanges",
          "new_api": "err",
          "old_text": "notifyChanges()",
          "new_text": "rs->err(Error, \"Already started\")",
          "old_line_content": "    notifyChanges();",
          "new_line_content": "      rs->err(Error, \"Already started\");",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": "stop",
          "new_api": "err",
          "old_text": "proc->stop()",
          "new_text": "rs->err(NotExists, \"No such process\")",
          "old_line_content": "    proc->stop();",
          "new_line_content": "    rs->err(NotExists, \"No such process\");",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": "err",
          "new_api": "stop",
          "old_text": "rs->err(Error, \"Already stopping\")",
          "new_text": "proc->stop()",
          "old_line_content": "    rs->err(Error, \"Already stopping\");",
          "new_line_content": "    proc->stop();",
          "content_same": false
        },
        {
          "line": 263,
          "old_api": "strerror",
          "new_api": "c_str",
          "old_text": "strerror(errno)",
          "new_text": "m_procfile.c_str()",
          "old_line_content": "    logger.critical(\"Cannot open `%s': %s\\n\", newfile, strerror(errno));",
          "new_line_content": "  BaseString::snprintf(oldfile, sizeof(oldfile), \"%s.old\", m_procfile.c_str());",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": "printf",
          "new_api": "unlink",
          "old_text": "printf(\"-->%d\\n\", __LINE__)",
          "new_text": "unlink(curfile)",
          "old_line_content": "    printf(\"-->%d\\n\", __LINE__);",
          "new_line_content": "    if(unlink(curfile) != 0) { /* remove the running config file */",
          "content_same": false
        },
        {
          "line": 356,
          "old_api": "c_str",
          "new_api": "info",
          "old_text": "m_procfile.c_str()",
          "new_text": "logger.info(\"Configuration file `%s' not found\",\n\t\t  m_procfile.c_str())",
          "old_line_content": "\t\t  m_procfile.c_str());",
          "new_line_content": "      logger.info(\"Configuration file `%s' not found\",",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": "info",
          "new_api": "c_str",
          "old_text": "logger.info(\"Backup configuration file `%s' is used\",\n\t\t  secondfile.c_str())",
          "new_text": "m_procfile.c_str()",
          "old_line_content": "      logger.info(\"Backup configuration file `%s' is used\",",
          "new_line_content": "\t\t  m_procfile.c_str());",
          "content_same": false
        },
        {
          "line": 358,
          "old_api": "c_str",
          "new_api": "info",
          "old_text": "secondfile.c_str()",
          "new_text": "logger.info(\"Starting with empty configuration\")",
          "old_line_content": "\t\t  secondfile.c_str());",
          "new_line_content": "      logger.info(\"Starting with empty configuration\");",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": "readPid",
          "new_api": "loadFile",
          "old_text": "proc->readPid()",
          "new_text": "sess.loadFile()",
          "old_line_content": "    proc->readPid();",
          "new_line_content": "  sess.loadFile();",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": "signal",
          "new_api": "size",
          "old_text": "m_monitor->signal()",
          "new_text": "temporary.size()",
          "old_line_content": "  m_monitor->signal();",
          "new_line_content": "  for(i = 0; i<temporary.size(); i++){",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 389,
          "old_api": null,
          "new_api": "undefineProcess",
          "old_text": null,
          "new_text": "undefineProcess(&rs, temporary[i])",
          "old_line_content": "}",
          "new_line_content": "    undefineProcess(&rs, temporary[i]);",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "m_procfile.c_str()",
          "old_line_content": "    /* XXX What should be done here? */",
          "new_line_content": "  BaseString::snprintf(newfile, sizeof(newfile), \"%s.new\", m_procfile.c_str());",
          "content_same": false
        },
        {
          "line": 134,
          "old_api": null,
          "new_api": "stop",
          "old_text": null,
          "new_text": "proc->stop()",
          "old_line_content": "  return true;",
          "new_line_content": "    proc->stop();",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "m_procfile.c_str()",
          "old_line_content": "    return false;",
          "new_line_content": "  BaseString::snprintf(curfile, sizeof(curfile), \"%s\", m_procfile.c_str());",
          "content_same": false
        },
        {
          "line": 135,
          "old_api": null,
          "new_api": "erase",
          "old_text": null,
          "new_text": "m_processes.erase(i, false /* Already locked */)",
          "old_line_content": "}",
          "new_line_content": "    m_processes.erase(i, false /* Already locked */);",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": null,
          "new_api": "fopen",
          "old_text": null,
          "new_text": "fopen(newfile, \"w\")",
          "old_line_content": "",
          "new_line_content": "  f = fopen(newfile, \"w\");",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": null,
          "new_api": "notifyChanges",
          "old_text": null,
          "new_text": "notifyChanges()",
          "old_line_content": "",
          "new_line_content": "  notifyChanges();",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": null,
          "new_api": "signal",
          "old_text": null,
          "new_text": "m_monitor->signal()",
          "old_line_content": "}",
          "new_line_content": "  m_monitor->signal();",
          "content_same": false
        },
        {
          "line": 270,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "",
          "new_line_content": "    logger.critical(\"Cannot open `%s': %s\\n\", newfile, strerror(errno));",
          "content_same": false
        },
        {
          "line": 274,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "m_processes.size()",
          "old_line_content": "       */",
          "new_line_content": "  for(unsigned i = 0; i<m_processes.size(); i++){",
          "content_same": false
        },
        {
          "line": 275,
          "old_api": null,
          "new_api": "print",
          "old_text": null,
          "new_text": "m_processes[i]->print(f)",
          "old_line_content": "      continue;",
          "new_line_content": "    m_processes[i]->print(f);",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(f, \"\\n\")",
          "old_line_content": "    }",
          "new_line_content": "    fprintf(f, \"\\n\");",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": null,
          "new_api": "BaseString::snprintf(m_errorstring, sizeof(m_errorstring), \"%s\", msg)",
          "old_text": null,
          "new_text": "BaseString::snprintf(m_errorstring, sizeof(m_errorstring), \"%s\", msg)",
          "old_line_content": "",
          "new_line_content": "  BaseString::snprintf(m_errorstring, sizeof(m_errorstring), \"%s\", msg);",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "m_processes.size()",
          "old_line_content": "    if(proc == 0){",
          "new_line_content": "    for(unsigned i = 0; i < m_processes.size(); i++) {",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(f, \"start process\\nid: %d\\n\\n\", m_processes[i]->m_id)",
          "old_line_content": "  /* This will probably only work on reasonably Unix-like systems. You have",
          "new_line_content": "      fprintf(f, \"start process\\nid: %d\\n\\n\", m_processes[i]->m_id);",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(f)",
          "old_line_content": "   * crash right in the middle of updating the configuration file, and in",
          "new_line_content": "  fclose(f);",
          "content_same": false
        },
        {
          "line": 167,
          "old_api": null,
          "new_api": "start",
          "old_text": null,
          "new_text": "proc->start()",
          "old_line_content": "      return false;",
          "new_line_content": "      if(proc->start() != 0){",
          "content_same": false
        },
        {
          "line": 168,
          "old_api": null,
          "new_api": "err",
          "old_text": null,
          "new_text": "rs->err(Error, \"Failed to start\")",
          "old_line_content": "    case RUNNING:",
          "new_line_content": "\trs->err(Error, \"Failed to start\");",
          "content_same": false
        },
        {
          "line": 173,
          "old_api": null,
          "new_api": "err",
          "old_text": null,
          "new_text": "rs->err(Error, \"Already starting\")",
          "old_line_content": "      return false;",
          "new_line_content": "      rs->err(Error, \"Already starting\");",
          "content_same": false
        },
        {
          "line": 305,
          "old_api": null,
          "new_api": "unlink",
          "old_text": null,
          "new_text": "unlink(oldfile)",
          "old_line_content": "      return false;",
          "new_line_content": "  unlink(oldfile);",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": null,
          "new_api": "err",
          "old_text": null,
          "new_text": "rs->err(Error, \"Currently stopping\")",
          "old_line_content": "  return true;",
          "new_line_content": "      rs->err(Error, \"Currently stopping\");",
          "content_same": false
        },
        {
          "line": 307,
          "old_api": null,
          "new_api": "link",
          "old_text": null,
          "new_text": "link(curfile, oldfile)",
          "old_line_content": "  }",
          "new_line_content": "  if(link(curfile, oldfile) != 0) /* make a backup of the running config */",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "logger.error(\"Cannot rename '%s' -> '%s'\", curfile, oldfile)",
          "old_line_content": "",
          "new_line_content": "    logger.error(\"Cannot rename '%s' -> '%s'\", curfile, oldfile);",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": null,
          "new_api": "notifyChanges",
          "old_text": null,
          "new_text": "notifyChanges()",
          "old_line_content": "CPCD::stopProcess(CPCD::RequestStatus *rs, int id) {",
          "new_line_content": "    notifyChanges();",
          "content_same": false
        },
        {
          "line": 311,
          "old_api": null,
          "new_api": "critical",
          "old_text": null,
          "new_text": "logger.critical(\"Cannot remove file '%s'\", curfile)",
          "old_line_content": "",
          "new_line_content": "      logger.critical(\"Cannot remove file '%s'\", curfile);",
          "content_same": false
        },
        {
          "line": 316,
          "old_api": null,
          "new_api": "link",
          "old_text": null,
          "new_text": "link(newfile, curfile)",
          "old_line_content": "",
          "new_line_content": "  if(link(newfile, curfile) != 0) { /* put the new config file in place */",
          "content_same": false
        },
        {
          "line": 317,
          "old_api": null,
          "new_api": "printf",
          "old_text": null,
          "new_text": "printf(\"-->%d\\n\", __LINE__)",
          "old_line_content": "  /* XXX Ideally we would fsync() the directory here, but I'm not sure if",
          "new_line_content": "    printf(\"-->%d\\n\", __LINE__);",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": null,
          "new_api": "critical",
          "old_text": null,
          "new_text": "logger.critical(\"Cannot rename '%s' -> '%s': %s\", \n\t\t    curfile, newfile, strerror(errno))",
          "old_line_content": "   */",
          "new_line_content": "    logger.critical(\"Cannot rename '%s' -> '%s': %s\", ",
          "content_same": false
        },
        {
          "line": 320,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "",
          "new_line_content": "\t\t    curfile, newfile, strerror(errno));",
          "content_same": false
        },
        {
          "line": 66,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "m_processes.size()",
          "old_line_content": "    }",
          "new_line_content": "    for(unsigned i = 0; i<m_processes.size(); i++)",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "m_processes.size()",
          "old_line_content": "  if(proc == 0){",
          "new_line_content": "  for(unsigned i = 0; i < m_processes.size(); i++) {",
          "content_same": false
        },
        {
          "line": 328,
          "old_api": null,
          "new_api": "unlink",
          "old_text": null,
          "new_text": "unlink(newfile)",
          "old_line_content": "",
          "new_line_content": "  unlink(newfile); /* remove the temporary file */",
          "content_same": false
        },
        {
          "line": 329,
          "old_api": null,
          "new_api": "unlink",
          "old_text": null,
          "new_text": "unlink(oldfile)",
          "old_line_content": "bool",
          "new_line_content": "  unlink(oldfile); /* remove the old file */",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": null,
          "new_api": "info",
          "old_text": null,
          "new_text": "logger.info(\"Process list saved as '%s'\", curfile)",
          "old_line_content": "  BaseString secondfile;",
          "new_line_content": "  logger.info(\"Process list saved as '%s'\", curfile);",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": null,
          "new_api": "err",
          "old_text": null,
          "new_text": "rs->err(AlreadyStopped, \"Already stopped\")",
          "old_line_content": "  ",
          "new_line_content": "    rs->err(AlreadyStopped, \"Already stopped\");",
          "content_same": false
        },
        {
          "line": 86,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "m_processes.size()",
          "old_line_content": "      return false;",
          "new_line_content": "  for(unsigned i = 0; i<m_processes.size(); i++) {",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "m_procfile.c_str()",
          "old_line_content": "   */",
          "new_line_content": "  secondfile.assfmt(\"%s.new\", m_procfile.c_str());",
          "content_same": false
        },
        {
          "line": 89,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "proc->m_name.c_str()",
          "old_line_content": "    if(arg->m_id == proc->m_id) {",
          "new_line_content": "    if((strcmp(arg->m_name.c_str(), proc->m_name.c_str()) == 0) && ",
          "content_same": false
        },
        {
          "line": 90,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "proc->m_group.c_str()",
          "old_line_content": "      /* Identical ID numbers */",
          "new_line_content": "       (strcmp(arg->m_group.c_str(), proc->m_group.c_str()) == 0)) {",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": null,
          "new_api": "err",
          "old_text": null,
          "new_text": "rs->err(Error, \"Already stopping\")",
          "old_line_content": "}",
          "new_line_content": "    rs->err(Error, \"Already stopping\");",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": null,
          "new_api": "err",
          "old_text": null,
          "new_text": "rs->err(AlreadyExists, \"Name already exists\")",
          "old_line_content": "      return false;",
          "new_line_content": "      rs->err(AlreadyExists, \"Name already exists\");",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": null,
          "new_api": "notifyChanges",
          "old_text": null,
          "new_text": "notifyChanges()",
          "old_line_content": "  bool ret = true;",
          "new_line_content": "  notifyChanges();",
          "content_same": false
        },
        {
          "line": 346,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "m_procfile.c_str()",
          "old_line_content": "    ",
          "new_line_content": "  f = fopen(m_procfile.c_str(), \"r\");",
          "content_same": false
        },
        {
          "line": 352,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "secondfile.c_str()",
          "old_line_content": "      loadingProcessList = false;",
          "new_line_content": "    f = fopen(secondfile.c_str(), \"r\");",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": null,
          "new_api": "saveProcessList",
          "old_text": null,
          "new_text": "saveProcessList()",
          "old_line_content": "",
          "new_line_content": "    ret = saveProcessList();",
          "content_same": false
        },
        {
          "line": 103,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "m_processes.push_back(arg, false)",
          "old_line_content": "bool",
          "new_line_content": "  m_processes.push_back(arg, false);",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": null,
          "new_api": "signal",
          "old_text": null,
          "new_text": "m_monitor->signal()",
          "old_line_content": "static int link(const char* from_file, const char* to_file)",
          "new_line_content": "  m_monitor->signal();",
          "content_same": false
        },
        {
          "line": 105,
          "old_api": null,
          "new_api": "notifyChanges",
          "old_text": null,
          "new_text": "notifyChanges()",
          "old_line_content": "",
          "new_line_content": "  notifyChanges();",
          "content_same": false
        },
        {
          "line": 362,
          "old_api": null,
          "new_api": "info",
          "old_text": null,
          "new_text": "logger.info(\"Configuration file `%s' missing\",\n\t\t  m_procfile.c_str())",
          "old_line_content": "    }",
          "new_line_content": "      logger.info(\"Configuration file `%s' missing\",",
          "content_same": false
        },
        {
          "line": 363,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "m_procfile.c_str()",
          "old_line_content": "  }",
          "new_line_content": "\t\t  m_procfile.c_str());",
          "content_same": false
        },
        {
          "line": 364,
          "old_api": null,
          "new_api": "info",
          "old_text": null,
          "new_text": "logger.info(\"Backup configuration file `%s' is used\",\n\t\t  secondfile.c_str())",
          "old_line_content": "",
          "new_line_content": "      logger.info(\"Backup configuration file `%s' is used\",",
          "content_same": false
        },
        {
          "line": 365,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "secondfile.c_str()",
          "old_line_content": "  CPCDAPISession sess(f, *this);",
          "new_line_content": "\t\t  secondfile.c_str());",
          "content_same": false
        },
        {
          "line": 242,
          "old_api": null,
          "new_api": "CopyFile",
          "old_text": null,
          "new_text": "CopyFile(from_file, to_file, fail_if_exists)",
          "old_line_content": "}",
          "new_line_content": "  if (CopyFile(from_file, to_file, fail_if_exists) == 0)",
          "content_same": false
        },
        {
          "line": 117,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "m_processes.size()",
          "old_line_content": "  if(proc == 0){",
          "new_line_content": "  for(i = 0; i < m_processes.size(); i++) {",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(f)",
          "old_line_content": "    Process * proc = m_processes[i];",
          "new_line_content": "  fclose(f);",
          "content_same": false
        },
        {
          "line": 125,
          "old_api": null,
          "new_api": "err",
          "old_text": null,
          "new_text": "rs->err(NotExists, \"No such process\")",
          "old_line_content": "  case STOPPING:",
          "new_line_content": "    rs->err(NotExists, \"No such process\");",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "m_processes.size()",
          "old_line_content": "  ",
          "new_line_content": "  for(i = 0; i<m_processes.size(); i++){",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": null,
          "new_api": "readPid",
          "old_text": null,
          "new_text": "proc->readPid()",
          "old_line_content": "    RequestStatus rs;",
          "new_line_content": "    proc->readPid();",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "temporary.push_back(proc->m_id)",
          "old_line_content": "  }",
          "new_line_content": "      temporary.push_back(proc->m_id);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 128,
          "old_api": "erase",
          "new_api": null,
          "old_text": "m_processes.erase(i, false /* Already locked */)",
          "new_text": null,
          "old_line_content": "    m_processes.erase(i, false /* Already locked */);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 256,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "m_procfile.c_str()",
          "new_text": null,
          "old_line_content": "  BaseString::snprintf(oldfile, sizeof(oldfile), \"%s.old\", m_procfile.c_str());",
          "new_line_content": "  char newfile[PATH_MAX+4];",
          "content_same": false
        },
        {
          "line": 257,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "m_procfile.c_str()",
          "new_text": null,
          "old_line_content": "  BaseString::snprintf(curfile, sizeof(curfile), \"%s\", m_procfile.c_str());",
          "new_line_content": "  char oldfile[PATH_MAX+4];",
          "content_same": false
        },
        {
          "line": 259,
          "old_api": "fopen",
          "new_api": null,
          "old_text": "fopen(newfile, \"w\")",
          "new_text": null,
          "old_line_content": "  f = fopen(newfile, \"w\");",
          "new_line_content": "  FILE *f;",
          "content_same": false
        },
        {
          "line": 132,
          "old_api": "notifyChanges",
          "new_api": null,
          "old_text": "notifyChanges()",
          "new_text": null,
          "old_line_content": "  notifyChanges();",
          "new_line_content": "  case STOPPING:",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": "size",
          "new_api": null,
          "old_text": "m_processes.size()",
          "new_text": null,
          "old_line_content": "  for(unsigned i = 0; i<m_processes.size(); i++){",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 268,
          "old_api": "print",
          "new_api": null,
          "old_text": "m_processes[i]->print(f)",
          "new_text": null,
          "old_line_content": "    m_processes[i]->print(f);",
          "new_line_content": "  if(f == NULL) {",
          "content_same": false
        },
        {
          "line": 269,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(f, \"\\n\")",
          "new_text": null,
          "old_line_content": "    fprintf(f, \"\\n\");",
          "new_line_content": "    /* XXX What should be done here? */",
          "content_same": false
        },
        {
          "line": 399,
          "old_api": "BaseString::snprintf(m_errorstring, sizeof(m_errorstring), \"%s\", msg)",
          "new_api": null,
          "old_text": "BaseString::snprintf(m_errorstring, sizeof(m_errorstring), \"%s\", msg)",
          "new_text": null,
          "old_line_content": "  BaseString::snprintf(m_errorstring, sizeof(m_errorstring), \"%s\", msg);",
          "new_line_content": "CPCD::getProcessList() {",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": "size",
          "new_api": null,
          "old_text": "m_processes.size()",
          "new_text": null,
          "old_line_content": "    for(unsigned i = 0; i < m_processes.size(); i++) {",
          "new_line_content": "CPCD::startProcess(CPCD::RequestStatus *rs, int id) {",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(f, \"start process\\nid: %d\\n\\n\", m_processes[i]->m_id)",
          "new_text": null,
          "old_line_content": "      fprintf(f, \"start process\\nid: %d\\n\\n\", m_processes[i]->m_id);",
          "new_line_content": "       * Interactive process should never be \"restarted\" on cpcd restart",
          "content_same": false
        },
        {
          "line": 153,
          "old_api": "err",
          "new_api": null,
          "old_text": "rs->err(NotExists, \"No such process\")",
          "new_text": null,
          "old_line_content": "      rs->err(NotExists, \"No such process\");",
          "new_line_content": "      if(m_processes[i]->m_id == id) {",
          "content_same": false
        },
        {
          "line": 284,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(f)",
          "new_text": null,
          "old_line_content": "  fclose(f);",
          "new_line_content": "    ",
          "content_same": false
        },
        {
          "line": 161,
          "old_api": "err",
          "new_api": null,
          "old_text": "rs->err(Error, \"Failed to start\")",
          "new_text": null,
          "old_line_content": "\trs->err(Error, \"Failed to start\");",
          "new_line_content": "      return false;",
          "content_same": false
        },
        {
          "line": 166,
          "old_api": "err",
          "new_api": null,
          "old_text": "rs->err(Error, \"Already starting\")",
          "new_text": null,
          "old_line_content": "      rs->err(Error, \"Already starting\");",
          "new_line_content": "      proc->m_status = STARTING;",
          "content_same": false
        },
        {
          "line": 169,
          "old_api": "err",
          "new_api": null,
          "old_text": "rs->err(Error, \"Already started\")",
          "new_text": null,
          "old_line_content": "      rs->err(Error, \"Already started\");",
          "new_line_content": "\treturn false;",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": "unlink",
          "new_api": null,
          "old_text": "unlink(oldfile)",
          "new_text": null,
          "old_line_content": "  unlink(oldfile);",
          "new_line_content": "   * crash right in the middle of updating the configuration file, and in",
          "content_same": false
        },
        {
          "line": 172,
          "old_api": "err",
          "new_api": null,
          "old_text": "rs->err(Error, \"Currently stopping\")",
          "new_text": null,
          "old_line_content": "      rs->err(Error, \"Currently stopping\");",
          "new_line_content": "    case STARTING:",
          "content_same": false
        },
        {
          "line": 300,
          "old_api": "link",
          "new_api": null,
          "old_text": "link(curfile, oldfile)",
          "new_text": null,
          "old_line_content": "  if(link(curfile, oldfile) != 0) /* make a backup of the running config */",
          "new_line_content": "   * guaranteed that there is always at least one copy of either the old or",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": "error",
          "new_api": null,
          "old_text": "logger.error(\"Cannot rename '%s' -> '%s'\", curfile, oldfile)",
          "new_text": null,
          "old_line_content": "    logger.error(\"Cannot rename '%s' -> '%s'\", curfile, oldfile);",
          "new_line_content": "   * the new configuration file left.",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": "unlink",
          "new_api": null,
          "old_text": "unlink(curfile)",
          "new_text": null,
          "old_line_content": "    if(unlink(curfile) != 0) { /* remove the running config file */",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 304,
          "old_api": "critical",
          "new_api": null,
          "old_text": "logger.critical(\"Cannot remove file '%s'\", curfile)",
          "new_text": null,
          "old_line_content": "      logger.critical(\"Cannot remove file '%s'\", curfile);",
          "new_line_content": "  /* Remove an old config file if it exists */",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": "link",
          "new_api": null,
          "old_text": "link(newfile, curfile)",
          "new_text": null,
          "old_line_content": "  if(link(newfile, curfile) != 0) { /* put the new config file in place */",
          "new_line_content": "  else {",
          "content_same": false
        },
        {
          "line": 312,
          "old_api": "critical",
          "new_api": null,
          "old_text": "logger.critical(\"Cannot rename '%s' -> '%s': %s\", \n\t\t    curfile, newfile, strerror(errno))",
          "new_text": null,
          "old_line_content": "    logger.critical(\"Cannot rename '%s' -> '%s': %s\", ",
          "new_line_content": "      return false;",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "\t\t    curfile, newfile, strerror(errno));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "size",
          "new_api": null,
          "old_text": "m_processes.size()",
          "new_text": null,
          "old_line_content": "  for(unsigned i = 0; i < m_processes.size(); i++) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 63,
          "old_api": "size",
          "new_api": null,
          "old_text": "m_processes.size()",
          "new_text": null,
          "old_line_content": "    for(unsigned i = 0; i<m_processes.size(); i++) {",
          "new_line_content": "      continue;",
          "content_same": false
        },
        {
          "line": 321,
          "old_api": "unlink",
          "new_api": null,
          "old_text": "unlink(newfile)",
          "new_text": null,
          "old_line_content": "  unlink(newfile); /* remove the temporary file */",
          "new_line_content": "    return false;",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": "unlink",
          "new_api": null,
          "old_text": "unlink(oldfile)",
          "new_text": null,
          "old_line_content": "  unlink(oldfile); /* remove the old file */",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 68,
          "old_api": "unlock",
          "new_api": null,
          "old_text": "m_processes.unlock()",
          "new_text": null,
          "old_line_content": "  m_processes.unlock();",
          "new_line_content": "      if(m_processes[i]->m_id == id)",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": "err",
          "new_api": null,
          "old_text": "rs->err(NotExists, \"No such process\")",
          "new_text": null,
          "old_line_content": "    rs->err(NotExists, \"No such process\");",
          "new_line_content": "    if(m_processes[i]->m_id == id) {",
          "content_same": false
        },
        {
          "line": 324,
          "old_api": "info",
          "new_api": null,
          "old_text": "logger.info(\"Process list saved as '%s'\", curfile)",
          "new_text": null,
          "old_line_content": "  logger.info(\"Process list saved as '%s'\", curfile);",
          "new_line_content": "  /* XXX Ideally we would fsync() the directory here, but I'm not sure if",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "err",
          "new_api": null,
          "old_text": "rs->err(AlreadyStopped, \"Already stopped\")",
          "new_text": null,
          "old_line_content": "    rs->err(AlreadyStopped, \"Already stopped\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 79,
          "old_api": "size",
          "new_api": null,
          "old_text": "m_processes.size()",
          "new_text": null,
          "old_line_content": "  for(unsigned i = 0; i<m_processes.size(); i++) {",
          "new_line_content": "bool",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "m_procfile.c_str()",
          "new_text": null,
          "old_line_content": "  secondfile.assfmt(\"%s.new\", m_procfile.c_str());",
          "new_line_content": "bool",
          "content_same": false
        },
        {
          "line": 83,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "proc->m_group.c_str()",
          "new_text": null,
          "old_line_content": "       (strcmp(arg->m_group.c_str(), proc->m_group.c_str()) == 0)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 339,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "m_procfile.c_str()",
          "new_text": null,
          "old_line_content": "  f = fopen(m_procfile.c_str(), \"r\");",
          "new_line_content": "  FILE *f;",
          "content_same": false
        },
        {
          "line": 85,
          "old_api": "err",
          "new_api": null,
          "old_text": "rs->err(AlreadyExists, \"Name already exists\")",
          "new_text": null,
          "old_line_content": "      rs->err(AlreadyExists, \"Name already exists\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": "notifyChanges",
          "new_api": null,
          "old_text": "notifyChanges()",
          "new_text": null,
          "old_line_content": "  notifyChanges();",
          "new_line_content": "    return false;",
          "content_same": false
        },
        {
          "line": 345,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "secondfile.c_str()",
          "new_text": null,
          "old_line_content": "    f = fopen(secondfile.c_str(), \"r\");",
          "new_line_content": "  /* Try to open the config file */",
          "content_same": false
        },
        {
          "line": 91,
          "old_api": "err",
          "new_api": null,
          "old_text": "rs->err(AlreadyExists, \"Id already exists\")",
          "new_text": null,
          "old_line_content": "      rs->err(AlreadyExists, \"Id already exists\");",
          "new_line_content": "      /* Identical names in the same group */",
          "content_same": false
        },
        {
          "line": 349,
          "old_api": "info",
          "new_api": null,
          "old_text": "logger.info(\"Configuration file `%s' not found\",\n\t\t  m_procfile.c_str())",
          "new_text": null,
          "old_line_content": "      logger.info(\"Configuration file `%s' not found\",",
          "new_line_content": "   * method for an explanation why it is done this way.",
          "content_same": false
        },
        {
          "line": 350,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "m_procfile.c_str()",
          "new_text": null,
          "old_line_content": "\t\t  m_procfile.c_str());",
          "new_line_content": "   */",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": "saveProcessList",
          "new_api": null,
          "old_text": "saveProcessList()",
          "new_text": null,
          "old_line_content": "    ret = saveProcessList();",
          "new_line_content": "  return true;",
          "content_same": false
        },
        {
          "line": 96,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "m_processes.push_back(arg, false)",
          "new_text": null,
          "old_line_content": "  m_processes.push_back(arg, false);",
          "new_line_content": "    if(arg->m_id == proc->m_id) {",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "signal",
          "new_api": null,
          "old_text": "m_monitor->signal()",
          "new_text": null,
          "old_line_content": "  m_monitor->signal();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 351,
          "old_api": "info",
          "new_api": null,
          "old_text": "logger.info(\"Starting with empty configuration\")",
          "new_text": null,
          "old_line_content": "      logger.info(\"Starting with empty configuration\");",
          "new_line_content": "  if(f == NULL) {",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": "info",
          "new_api": null,
          "old_text": "logger.info(\"Configuration file `%s' missing\",\n\t\t  m_procfile.c_str())",
          "new_text": null,
          "old_line_content": "      logger.info(\"Configuration file `%s' missing\",",
          "new_line_content": "      /* XXX What to do here? */",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": "CopyFile",
          "new_api": null,
          "old_text": "CopyFile(from_file, to_file, fail_if_exists)",
          "new_text": null,
          "old_line_content": "  if (CopyFile(from_file, to_file, fail_if_exists) == 0)",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 127,
          "old_api": "stop",
          "new_api": null,
          "old_text": "proc->stop()",
          "new_text": null,
          "old_line_content": "    proc->stop();",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 110,
          "old_api": "size",
          "new_api": null,
          "old_text": "m_processes.size()",
          "new_text": null,
          "old_line_content": "  for(i = 0; i < m_processes.size(); i++) {",
          "new_line_content": "bool",
          "content_same": false
        },
        {
          "line": 366,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(f)",
          "new_text": null,
          "old_line_content": "  fclose(f);",
          "new_line_content": "      /* XXX Maybe we should just rename the backup file to the official",
          "content_same": false
        },
        {
          "line": 367,
          "old_api": "loadFile",
          "new_api": null,
          "old_text": "sess.loadFile()",
          "new_text": null,
          "old_line_content": "  sess.loadFile();",
          "new_line_content": "       * name, and be done with it?",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": "size",
          "new_api": null,
          "old_text": "m_processes.size()",
          "new_text": null,
          "old_line_content": "  for(i = 0; i<m_processes.size(); i++){",
          "new_line_content": "  CPCDAPISession sess(f, *this);",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": "err",
          "new_api": null,
          "old_text": "rs->err(NotExists, \"No such process\")",
          "new_text": null,
          "old_line_content": "    rs->err(NotExists, \"No such process\");",
          "new_line_content": "    if(m_processes[i]->m_id == id) {",
          "content_same": false
        },
        {
          "line": 376,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "temporary.push_back(proc->m_id)",
          "new_text": null,
          "old_line_content": "      temporary.push_back(proc->m_id);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": "size",
          "new_api": null,
          "old_text": "temporary.size()",
          "new_text": null,
          "old_line_content": "  for(i = 0; i<temporary.size(); i++){",
          "new_line_content": "    Process * proc = m_processes[i];",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": "undefineProcess",
          "new_api": null,
          "old_text": "undefineProcess(&rs, temporary[i])",
          "new_text": null,
          "old_line_content": "    undefineProcess(&rs, temporary[i]);",
          "new_line_content": "    if(proc->m_processType == TEMPORARY){",
          "content_same": false
        },
        {
          "line": 255,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "m_procfile.c_str()",
          "new_text": null,
          "old_line_content": "  BaseString::snprintf(newfile, sizeof(newfile), \"%s.new\", m_procfile.c_str());",
          "new_line_content": "CPCD::saveProcessList(){",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 14,
      "total_additions": 59,
      "total_deletions": 59,
      "total_api_changes": 132
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 8,
        "api_related_lines": 132,
        "non_api_lines": 6,
        "non_api_line_numbers": [
          64,
          67,
          69,
          71,
          72,
          61
        ]
      }
    },
    "api_calls_before": 87,
    "api_calls_after": 87,
    "diff_info": {
      "added_lines": 8,
      "removed_lines": 1,
      "total_diff_lines": 25
    }
  }
}