{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mysql-server/modified_file/b908f410fbe1c9e27042fb40950398baca0e7db7",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mysql-server/modified_file/b908f410fbe1c9e27042fb40950398baca0e7db7/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mysql-server/modified_file/b908f410fbe1c9e27042fb40950398baca0e7db7/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mysql-server/modified_file/b908f410fbe1c9e27042fb40950398baca0e7db7/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 3222,
          "old_api": "innobase_get_free_space",
          "new_api": "strlen",
          "old_text": "innobase_get_free_space()",
          "new_text": "strlen(comment)",
          "old_line_content": "\t\t\t\t\t(ulong) innobase_get_free_space());",
          "new_line_content": "  \tuint \t\tlength \t= strlen(comment);",
          "content_same": false
        },
        {
          "line": 3336,
          "old_api": "thr_lock_init",
          "new_api": "hash_search",
          "old_text": "thr_lock_init(&share->lock)",
          "new_text": "hash_search(&innobase_open_tables,\n\t\t\t\t\t(mysql_byte*) table_name,\n\t\t\t\t\t    length)",
          "old_line_content": "      thr_lock_init(&share->lock);",
          "new_line_content": "  if (!(share=(INNOBASE_SHARE*) hash_search(&innobase_open_tables,",
          "content_same": false
        },
        {
          "line": 3341,
          "old_api": "pthread_mutex_unlock",
          "new_api": "MYF",
          "old_text": "pthread_mutex_unlock(&innobase_mutex)",
          "new_text": "MYF(MY_WME | MY_ZEROFILL)",
          "old_line_content": "  pthread_mutex_unlock(&innobase_mutex);",
          "new_line_content": "\t\t\t\t       MYF(MY_WME | MY_ZEROFILL))))",
          "content_same": false
        },
        {
          "line": 3352,
          "old_api": "pthread_mutex_destroy",
          "new_api": "thr_lock_init",
          "old_text": "pthread_mutex_destroy(&share->mutex)",
          "new_text": "thr_lock_init(&share->lock)",
          "old_line_content": "    pthread_mutex_destroy(&share->mutex);",
          "new_line_content": "      thr_lock_init(&share->lock);",
          "content_same": false
        },
        {
          "line": 3353,
          "old_api": "MYF",
          "new_api": "pthread_mutex_init",
          "old_text": "MYF(0)",
          "new_text": "pthread_mutex_init(&share->mutex,MY_MUTEX_INIT_FAST)",
          "old_line_content": "    my_free((gptr) share, MYF(0));",
          "new_line_content": "      pthread_mutex_init(&share->mutex,MY_MUTEX_INIT_FAST);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 3200,
          "old_api": null,
          "new_api": "row_check_table_for_mysql",
          "old_text": null,
          "new_text": "row_check_table_for_mysql(prebuilt)",
          "old_line_content": "/*==============================*/",
          "new_line_content": "\tret = row_check_table_for_mysql(prebuilt);",
          "content_same": false
        },
        {
          "line": 3460,
          "old_api": null,
          "new_api": "table->next_number_field->\n                        val_int_offset(table->rec_buff_length)",
          "old_text": null,
          "new_text": "table->next_number_field->\n                        val_int_offset(table->rec_buff_length)",
          "old_line_content": "",
          "new_line_content": "    nr = (longlong) table->next_number_field->",
          "content_same": false
        },
        {
          "line": 3334,
          "old_api": null,
          "new_api": "pthread_mutex_lock",
          "old_text": null,
          "new_text": "pthread_mutex_lock(&innobase_mutex)",
          "old_line_content": "\treturn 0;",
          "new_line_content": "  pthread_mutex_lock(&innobase_mutex);",
          "content_same": false
        },
        {
          "line": 3335,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(table_name)",
          "old_line_content": "      }",
          "new_line_content": "  uint length=(uint) strlen(table_name);",
          "content_same": false
        },
        {
          "line": 3464,
          "old_api": null,
          "new_api": "extra",
          "old_text": null,
          "new_text": "extra(HA_EXTRA_NO_KEYREAD)",
          "old_line_content": "",
          "new_line_content": "  (void) extra(HA_EXTRA_NO_KEYREAD);",
          "content_same": false
        },
        {
          "line": 3466,
          "old_api": null,
          "new_api": "index_end",
          "old_text": null,
          "new_text": "index_end()",
          "old_line_content": "",
          "new_line_content": "  index_end();",
          "content_same": false
        },
        {
          "line": 3340,
          "old_api": null,
          "new_api": "my_malloc",
          "old_text": null,
          "new_text": "my_malloc(sizeof(*share)+length+1,\n\t\t\t\t       MYF(MY_WME | MY_ZEROFILL))",
          "old_line_content": "  share->use_count++;",
          "new_line_content": "    if ((share=(INNOBASE_SHARE *) my_malloc(sizeof(*share)+length+1,",
          "content_same": false
        },
        {
          "line": 3345,
          "old_api": null,
          "new_api": "strmov",
          "old_text": null,
          "new_text": "strmov(share->table_name,table_name)",
          "old_line_content": "static void free_share(INNOBASE_SHARE *share)",
          "new_line_content": "      strmov(share->table_name,table_name);",
          "content_same": false
        },
        {
          "line": 3346,
          "old_api": null,
          "new_api": "hash_insert",
          "old_text": null,
          "new_text": "hash_insert(&innobase_open_tables, (mysql_byte*) share)",
          "old_line_content": "{",
          "new_line_content": "      if (hash_insert(&innobase_open_tables, (mysql_byte*) share))",
          "content_same": false
        },
        {
          "line": 3348,
          "old_api": null,
          "new_api": "pthread_mutex_unlock",
          "old_text": null,
          "new_text": "pthread_mutex_unlock(&innobase_mutex)",
          "old_line_content": "  if (!--share->use_count)",
          "new_line_content": "\tpthread_mutex_unlock(&innobase_mutex);",
          "content_same": false
        },
        {
          "line": 3349,
          "old_api": null,
          "new_api": "my_free",
          "old_text": null,
          "new_text": "my_free((gptr) share,0)",
          "old_line_content": "  {",
          "new_line_content": "\tmy_free((gptr) share,0);",
          "content_same": false
        },
        {
          "line": 3223,
          "old_api": null,
          "new_api": "MYF",
          "old_text": null,
          "new_text": "MYF(0)",
          "old_line_content": "",
          "new_line_content": "  \tchar*\t\tstr \t= my_malloc(length + 550, MYF(0));",
          "content_same": false
        },
        {
          "line": 3357,
          "old_api": null,
          "new_api": "pthread_mutex_unlock",
          "old_text": null,
          "new_text": "pthread_mutex_unlock(&innobase_mutex)",
          "old_line_content": "",
          "new_line_content": "  pthread_mutex_unlock(&innobase_mutex);",
          "content_same": false
        },
        {
          "line": 3232,
          "old_api": null,
          "new_api": "strmov",
          "old_text": null,
          "new_text": "strmov(str, comment)",
          "old_line_content": "As MySQL will execute an external lock for every new table it uses when it",
          "new_line_content": "    \t\tpos=strmov(str, comment);",
          "content_same": false
        },
        {
          "line": 3363,
          "old_api": null,
          "new_api": "pthread_mutex_lock",
          "old_text": null,
          "new_text": "pthread_mutex_lock(&innobase_mutex)",
          "old_line_content": "/*====================*/",
          "new_line_content": "  pthread_mutex_lock(&innobase_mutex);",
          "content_same": false
        },
        {
          "line": 3237,
          "old_api": null,
          "new_api": "sprintf",
          "old_text": null,
          "new_text": "sprintf(pos, \"InnoDB free: %lu kB\",\n\t\t\t\t\t(ulong) innobase_get_free_space())",
          "old_line_content": "the SQL statement in case of an error. */",
          "new_line_content": "  \tpos += sprintf(pos, \"InnoDB free: %lu kB\",",
          "content_same": false
        },
        {
          "line": 3238,
          "old_api": null,
          "new_api": "innobase_get_free_space",
          "old_text": null,
          "new_text": "innobase_get_free_space()",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t\t(ulong) innobase_get_free_space());",
          "content_same": false
        },
        {
          "line": 3366,
          "old_api": null,
          "new_api": "hash_delete",
          "old_text": null,
          "new_text": "hash_delete(&innobase_open_tables, (mysql_byte*) share)",
          "old_line_content": "\tTHD*\t\t\tthd,\t\t/* in: user thread handle */",
          "new_line_content": "    hash_delete(&innobase_open_tables, (mysql_byte*) share);",
          "content_same": false
        },
        {
          "line": 3367,
          "old_api": null,
          "new_api": "thr_lock_delete",
          "old_text": null,
          "new_text": "thr_lock_delete(&share->lock)",
          "old_line_content": "\tTHR_LOCK_DATA**\t\tto,\t\t/* in: pointer to an array",
          "new_line_content": "    thr_lock_delete(&share->lock);",
          "content_same": false
        },
        {
          "line": 3368,
          "old_api": null,
          "new_api": "pthread_mutex_destroy",
          "old_text": null,
          "new_text": "pthread_mutex_destroy(&share->mutex)",
          "old_line_content": "\t\t\t\t\t\tof pointers to lock structs;",
          "new_line_content": "    pthread_mutex_destroy(&share->mutex);",
          "content_same": false
        },
        {
          "line": 3242,
          "old_api": null,
          "new_api": "dict_print_info_on_foreign_keys",
          "old_text": null,
          "new_text": "dict_print_info_on_foreign_keys(pos, 500, prebuilt->table)",
          "old_line_content": "\tTHD*\tthd,\t\t/* in: handle to the user thread */",
          "new_line_content": "  \tdict_print_info_on_foreign_keys(pos, 500, prebuilt->table);",
          "content_same": false
        },
        {
          "line": 3369,
          "old_api": null,
          "new_api": "MYF",
          "old_text": null,
          "new_text": "MYF(0)",
          "old_line_content": "\t\t\t\t\t\tpointer to the 'lock' field",
          "new_line_content": "    my_free((gptr) share, MYF(0));",
          "content_same": false
        },
        {
          "line": 3371,
          "old_api": null,
          "new_api": "pthread_mutex_unlock",
          "old_text": null,
          "new_text": "pthread_mutex_unlock(&innobase_mutex)",
          "old_line_content": "\t\t\t\t\t\tnext to this array */",
          "new_line_content": "  pthread_mutex_unlock(&innobase_mutex);",
          "content_same": false
        },
        {
          "line": 3265,
          "old_api": null,
          "new_api": "DBUG_ENTER",
          "old_text": null,
          "new_text": "DBUG_ENTER(\"ha_innobase::external_lock\")",
          "old_line_content": "\t}",
          "new_line_content": "  \tDBUG_ENTER(\"ha_innobase::external_lock\");",
          "content_same": false
        },
        {
          "line": 3267,
          "old_api": null,
          "new_api": "update_thd",
          "old_text": null,
          "new_text": "update_thd(thd)",
          "old_line_content": "\tif (lock_type != F_UNLCK) {",
          "new_line_content": "\tupdate_thd(thd);",
          "content_same": false
        },
        {
          "line": 3153,
          "old_api": null,
          "new_api": "dict_table_get_next_index_noninline",
          "old_text": null,
          "new_text": "dict_table_get_next_index_noninline(index)",
          "old_line_content": "\tif (prebuilt->trx) {",
          "new_line_content": "\t\t\tindex = dict_table_get_next_index_noninline(index);",
          "content_same": false
        },
        {
          "line": 3285,
          "old_api": null,
          "new_api": "trx_mark_sql_stat_end",
          "old_text": null,
          "new_text": "trx_mark_sql_stat_end(trx)",
          "old_line_content": "\t\t  \ttrx->mysql_n_tables_locked = 0;",
          "new_line_content": "\t\t\ttrx_mark_sql_stat_end(trx);",
          "content_same": false
        },
        {
          "line": 3164,
          "old_api": null,
          "new_api": "row_get_mysql_key_number_for_index",
          "old_text": null,
          "new_text": "row_get_mysql_key_number_for_index(\n\t\t\t\t       (dict_index_t*)\n\t\t\t\t       trx_get_error_info(prebuilt->trx))",
          "old_line_content": "",
          "new_line_content": "\t\terrkey = (unsigned int) row_get_mysql_key_number_for_index(",
          "content_same": false
        },
        {
          "line": 3166,
          "old_api": null,
          "new_api": "trx_get_error_info",
          "old_text": null,
          "new_text": "trx_get_error_info(prebuilt->trx)",
          "old_line_content": "ha_innobase::check(",
          "new_line_content": "\t\t\t\t       trx_get_error_info(prebuilt->trx));",
          "content_same": false
        },
        {
          "line": 3306,
          "old_api": null,
          "new_api": "innobase_release_stat_resources",
          "old_text": null,
          "new_text": "innobase_release_stat_resources(trx)",
          "old_line_content": "****************************************************************************/",
          "new_line_content": "\t\t\tinnobase_release_stat_resources(trx);",
          "content_same": false
        },
        {
          "line": 3311,
          "old_api": null,
          "new_api": "innobase_commit",
          "old_text": null,
          "new_text": "innobase_commit(thd, trx)",
          "old_line_content": "  *length=share->table_name_length;",
          "new_line_content": "\t\t    \t\tinnobase_commit(thd, trx);",
          "content_same": false
        },
        {
          "line": 3442,
          "old_api": null,
          "new_api": "extra",
          "old_text": null,
          "new_text": "extra(HA_EXTRA_KEYREAD)",
          "old_line_content": "    nr = 1;",
          "new_line_content": "  (void) extra(HA_EXTRA_KEYREAD);",
          "content_same": false
        },
        {
          "line": 3443,
          "old_api": null,
          "new_api": "index_init",
          "old_text": null,
          "new_text": "index_init(table->next_number_index)",
          "old_line_content": "  } else {",
          "new_line_content": "  index_init(table->next_number_index);",
          "content_same": false
        },
        {
          "line": 3316,
          "old_api": null,
          "new_api": "DBUG_RETURN",
          "old_text": null,
          "new_text": "DBUG_RETURN(error)",
          "old_line_content": "{",
          "new_line_content": "\tDBUG_RETURN(error);",
          "content_same": false
        },
        {
          "line": 3197,
          "old_api": null,
          "new_api": "build_template",
          "old_text": null,
          "new_text": "build_template(prebuilt, NULL, table, ROW_MYSQL_WHOLE_ROW)",
          "old_line_content": "",
          "new_line_content": "\t\tbuild_template(prebuilt, NULL, table, ROW_MYSQL_WHOLE_ROW);",
          "content_same": false
        },
        {
          "line": 3455,
          "old_api": null,
          "new_api": "index_last",
          "old_text": null,
          "new_text": "index_last(table->record[1])",
          "old_line_content": "",
          "new_line_content": "  error=index_last(table->record[1]);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 3329,
          "old_api": "strmov",
          "new_api": null,
          "old_text": "strmov(share->table_name,table_name)",
          "new_text": null,
          "old_line_content": "      strmov(share->table_name,table_name);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3330,
          "old_api": "hash_insert",
          "new_api": null,
          "old_text": "hash_insert(&innobase_open_tables, (mysql_byte*) share)",
          "new_text": null,
          "old_line_content": "      if (hash_insert(&innobase_open_tables, (mysql_byte*) share))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3332,
          "old_api": "pthread_mutex_unlock",
          "new_api": null,
          "old_text": "pthread_mutex_unlock(&innobase_mutex)",
          "new_text": null,
          "old_line_content": "\tpthread_mutex_unlock(&innobase_mutex);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3333,
          "old_api": "my_free",
          "new_api": null,
          "old_text": "my_free((gptr) share,0)",
          "new_text": null,
          "old_line_content": "\tmy_free((gptr) share,0);",
          "new_line_content": "  INNOBASE_SHARE *share;",
          "content_same": false
        },
        {
          "line": 3206,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(comment)",
          "new_text": null,
          "old_line_content": "  \tuint \t\tlength \t= strlen(comment);",
          "new_line_content": "  \treturn(HA_ADMIN_CORRUPT); ",
          "content_same": false
        },
        {
          "line": 3207,
          "old_api": "MYF",
          "new_api": null,
          "old_text": "MYF(0)",
          "new_text": null,
          "old_line_content": "  \tchar*\t\tstr \t= my_malloc(length + 550, MYF(0));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3337,
          "old_api": "pthread_mutex_init",
          "new_api": null,
          "old_text": "pthread_mutex_init(&share->mutex,MY_MUTEX_INIT_FAST)",
          "new_text": null,
          "old_line_content": "      pthread_mutex_init(&share->mutex,MY_MUTEX_INIT_FAST);",
          "new_line_content": "\t\t\t\t\t(mysql_byte*) table_name,",
          "content_same": false
        },
        {
          "line": 3216,
          "old_api": "strmov",
          "new_api": null,
          "old_text": "strmov(str, comment)",
          "new_text": null,
          "old_line_content": "    \t\tpos=strmov(str, comment);",
          "new_line_content": "/*==============================*/",
          "content_same": false
        },
        {
          "line": 3347,
          "old_api": "pthread_mutex_lock",
          "new_api": null,
          "old_text": "pthread_mutex_lock(&innobase_mutex)",
          "new_text": null,
          "old_line_content": "  pthread_mutex_lock(&innobase_mutex);",
          "new_line_content": "      {",
          "content_same": false
        },
        {
          "line": 3221,
          "old_api": "sprintf",
          "new_api": null,
          "old_text": "sprintf(pos, \"InnoDB free: %lu kB\",\n\t\t\t\t\t(ulong) innobase_get_free_space())",
          "new_text": null,
          "old_line_content": "  \tpos += sprintf(pos, \"InnoDB free: %lu kB\",",
          "new_line_content": "\trow_prebuilt_t* prebuilt = (row_prebuilt_t*)innobase_prebuilt;",
          "content_same": false
        },
        {
          "line": 3350,
          "old_api": "hash_delete",
          "new_api": null,
          "old_text": "hash_delete(&innobase_open_tables, (mysql_byte*) share)",
          "new_text": null,
          "old_line_content": "    hash_delete(&innobase_open_tables, (mysql_byte*) share);",
          "new_line_content": "\treturn 0;",
          "content_same": false
        },
        {
          "line": 3351,
          "old_api": "thr_lock_delete",
          "new_api": null,
          "old_text": "thr_lock_delete(&share->lock)",
          "new_text": null,
          "old_line_content": "    thr_lock_delete(&share->lock);",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 3226,
          "old_api": "dict_print_info_on_foreign_keys",
          "new_api": null,
          "old_text": "dict_print_info_on_foreign_keys(pos, 500, prebuilt->table)",
          "new_text": null,
          "old_line_content": "  \tdict_print_info_on_foreign_keys(pos, 500, prebuilt->table);",
          "new_line_content": "\tif (!str) {",
          "content_same": false
        },
        {
          "line": 3355,
          "old_api": "pthread_mutex_unlock",
          "new_api": null,
          "old_text": "pthread_mutex_unlock(&innobase_mutex)",
          "new_text": null,
          "old_line_content": "  pthread_mutex_unlock(&innobase_mutex);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 3249,
          "old_api": "DBUG_ENTER",
          "new_api": null,
          "old_text": "DBUG_ENTER(\"ha_innobase::external_lock\")",
          "new_text": null,
          "old_line_content": "  \tDBUG_ENTER(\"ha_innobase::external_lock\");",
          "new_line_content": "starts to process an SQL statement, we can use this function to store the",
          "content_same": false
        },
        {
          "line": 3251,
          "old_api": "update_thd",
          "new_api": null,
          "old_text": "update_thd(thd)",
          "new_text": null,
          "old_line_content": "\tupdate_thd(thd);",
          "new_line_content": "to InnoDB that a new SQL statement has started and that we must store a",
          "content_same": false
        },
        {
          "line": 3137,
          "old_api": "dict_table_get_next_index_noninline",
          "new_api": null,
          "old_text": "dict_table_get_next_index_noninline(index)",
          "new_text": null,
          "old_line_content": "\t\t\tindex = dict_table_get_next_index_noninline(index);",
          "new_line_content": "\t\t\t\tby assuming the selectivity of any prefix",
          "content_same": false
        },
        {
          "line": 3448,
          "old_api": "extra",
          "new_api": null,
          "old_text": "extra(HA_EXTRA_NO_KEYREAD)",
          "new_text": null,
          "old_line_content": "  (void) extra(HA_EXTRA_NO_KEYREAD);",
          "new_line_content": "  id of the auto-increment column is not changed, and previously InnoDB",
          "content_same": false
        },
        {
          "line": 3269,
          "old_api": "trx_mark_sql_stat_end",
          "new_api": null,
          "old_text": "trx_mark_sql_stat_end(trx)",
          "new_text": null,
          "old_line_content": "\t\t\ttrx_mark_sql_stat_end(trx);",
          "new_line_content": "\ttrx = prebuilt->trx;",
          "content_same": false
        },
        {
          "line": 3148,
          "old_api": "row_get_mysql_key_number_for_index",
          "new_api": null,
          "old_text": "row_get_mysql_key_number_for_index(\n\t\t\t\t       (dict_index_t*)\n\t\t\t\t       trx_get_error_info(prebuilt->trx))",
          "new_text": null,
          "old_line_content": "\t\terrkey = (unsigned int) row_get_mysql_key_number_for_index(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3150,
          "old_api": "trx_get_error_info",
          "new_api": null,
          "old_text": "trx_get_error_info(prebuilt->trx)",
          "new_text": null,
          "old_line_content": "\t\t\t\t       trx_get_error_info(prebuilt->trx));",
          "new_line_content": "\t\t\t\t\t\t\t\t= rec_per_key;",
          "content_same": false
        },
        {
          "line": 3290,
          "old_api": "innobase_release_stat_resources",
          "new_api": null,
          "old_text": "innobase_release_stat_resources(trx)",
          "new_text": null,
          "old_line_content": "\t\t\tinnobase_release_stat_resources(trx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3295,
          "old_api": "innobase_commit",
          "new_api": null,
          "old_text": "innobase_commit(thd, trx)",
          "new_text": null,
          "old_line_content": "\t\t    \t\tinnobase_commit(thd, trx);",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 3426,
          "old_api": "extra",
          "new_api": null,
          "old_text": "extra(HA_EXTRA_KEYREAD)",
          "new_text": null,
          "old_line_content": "  (void) extra(HA_EXTRA_KEYREAD);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3427,
          "old_api": "index_init",
          "new_api": null,
          "old_text": "index_init(table->next_number_index)",
          "new_text": null,
          "old_line_content": "  index_init(table->next_number_index);",
          "new_line_content": "/***********************************************************************",
          "content_same": false
        },
        {
          "line": 3300,
          "old_api": "DBUG_RETURN",
          "new_api": null,
          "old_text": "DBUG_RETURN(error)",
          "new_text": null,
          "old_line_content": "\tDBUG_RETURN(error);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3181,
          "old_api": "build_template",
          "new_api": null,
          "old_text": "build_template(prebuilt, NULL, table, ROW_MYSQL_WHOLE_ROW)",
          "new_text": null,
          "old_line_content": "\t\tbuild_template(prebuilt, NULL, table, ROW_MYSQL_WHOLE_ROW);",
          "new_line_content": "int",
          "content_same": false
        },
        {
          "line": 3439,
          "old_api": "index_last",
          "new_api": null,
          "old_text": "index_last(table->record[1])",
          "new_text": null,
          "old_line_content": "  error=index_last(table->record[1]);",
          "new_line_content": "  longlong        nr;",
          "content_same": false
        },
        {
          "line": 3184,
          "old_api": "row_check_table_for_mysql",
          "new_api": null,
          "old_text": "row_check_table_for_mysql(prebuilt)",
          "new_text": null,
          "old_line_content": "\tret = row_check_table_for_mysql(prebuilt);",
          "new_line_content": "\t\t\t\t\t/* out: HA_ADMIN_CORRUPT or",
          "content_same": false
        },
        {
          "line": 3444,
          "old_api": "table->next_number_field->\n                        val_int_offset(table->rec_buff_length)",
          "new_api": null,
          "old_text": "table->next_number_field->\n                        val_int_offset(table->rec_buff_length)",
          "new_text": null,
          "old_line_content": "    nr = (longlong) table->next_number_field->",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3318,
          "old_api": "pthread_mutex_lock",
          "new_api": null,
          "old_text": "pthread_mutex_lock(&innobase_mutex)",
          "new_text": null,
          "old_line_content": "  pthread_mutex_lock(&innobase_mutex);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3319,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(table_name)",
          "new_text": null,
          "old_line_content": "  uint length=(uint) strlen(table_name);",
          "new_line_content": "/****************************************************************************",
          "content_same": false
        },
        {
          "line": 3320,
          "old_api": "hash_search",
          "new_api": null,
          "old_text": "hash_search(&innobase_open_tables,\n\t\t\t\t\t(mysql_byte*) table_name,\n\t\t\t\t\t    length)",
          "new_text": null,
          "old_line_content": "  if (!(share=(INNOBASE_SHARE*) hash_search(&innobase_open_tables,",
          "new_line_content": " Handling the shared INNOBASE_SHARE structure that is needed to provide table",
          "content_same": false
        },
        {
          "line": 3450,
          "old_api": "index_end",
          "new_api": null,
          "old_text": "index_end()",
          "new_text": null,
          "old_line_content": "  index_end();",
          "new_line_content": "  for the autoinc column. */",
          "content_same": false
        },
        {
          "line": 3324,
          "old_api": "my_malloc",
          "new_api": null,
          "old_text": "my_malloc(sizeof(*share)+length+1,\n\t\t\t\t       MYF(MY_WME | MY_ZEROFILL))",
          "new_text": null,
          "old_line_content": "    if ((share=(INNOBASE_SHARE *) my_malloc(sizeof(*share)+length+1,",
          "new_line_content": "static mysql_byte* innobase_get_key(INNOBASE_SHARE *share,uint *length,",
          "content_same": false
        },
        {
          "line": 3325,
          "old_api": "MYF",
          "new_api": null,
          "old_text": "MYF(MY_WME | MY_ZEROFILL)",
          "new_text": null,
          "old_line_content": "\t\t\t\t       MYF(MY_WME | MY_ZEROFILL))))",
          "new_line_content": "\t\t\t      my_bool not_used __attribute__((unused)))",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 5,
      "total_additions": 36,
      "total_deletions": 36,
      "total_api_changes": 77
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 16,
        "api_related_lines": 77,
        "non_api_lines": 14,
        "non_api_line_numbers": [
          3136,
          3138,
          3139,
          3140,
          3141,
          3142,
          3143,
          3144,
          3145,
          3146,
          3147,
          3133,
          3134,
          3135
        ]
      }
    },
    "api_calls_before": 431,
    "api_calls_after": 431,
    "diff_info": {
      "added_lines": 16,
      "removed_lines": 0,
      "total_diff_lines": 28
    }
  }
}