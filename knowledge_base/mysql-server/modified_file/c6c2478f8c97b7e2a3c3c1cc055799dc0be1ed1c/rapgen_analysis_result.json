{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mysql-server/modified_file/c6c2478f8c97b7e2a3c3c1cc055799dc0be1ed1c",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mysql-server/modified_file/c6c2478f8c97b7e2a3c3c1cc055799dc0be1ed1c/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mysql-server/modified_file/c6c2478f8c97b7e2a3c3c1cc055799dc0be1ed1c/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mysql-server/modified_file/c6c2478f8c97b7e2a3c3c1cc055799dc0be1ed1c/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 2763,
          "old_api": "ut_ad",
          "new_api": "os_thread_get_curr_id",
          "old_text": "ut_ad(index && pcur && search_tuple)",
          "new_text": "os_thread_get_curr_id()",
          "old_line_content": "\tut_ad(index && pcur && search_tuple);",
          "new_line_content": "\tut_ad(trx->mysql_thread_id == os_thread_get_curr_id());",
          "content_same": false
        },
        {
          "line": 3091,
          "old_api": "fprintf",
          "new_api": "trx_print",
          "old_text": "fprintf(stderr,\n\"InnoDB: Error: MySQL is trying to perform a consistent read\\n\"\n\"InnoDB: but the read view is not assigned!\\n%s\\n\", err_buf)",
          "new_text": "trx_print(err_buf, trx)",
          "old_line_content": "\t\t\tfprintf(stderr,",
          "new_line_content": "\t\t\ttrx_print(err_buf, trx);",
          "content_same": false
        },
        {
          "line": 3174,
          "old_api": "buf_frame_get_page_no",
          "new_api": "buf_frame_align",
          "old_text": "buf_frame_get_page_no(rec)",
          "new_text": "buf_frame_align(rec)",
          "old_line_content": "\t\t\t   (ulong) buf_frame_get_page_no(rec), index->name,",
          "new_line_content": "\t\t\t   (ulong) (rec - buf_frame_align(rec)),",
          "content_same": false
        },
        {
          "line": 3189,
          "old_api": "buf_frame_get_page_no",
          "new_api": "buf_frame_align",
          "old_text": "buf_frame_get_page_no(rec)",
          "new_text": "buf_frame_align(rec)",
          "old_line_content": "\t\t\t   (ulong) buf_frame_get_page_no(rec), index->name,",
          "new_line_content": "\t\t\t   (ulong) (rec - buf_frame_align(rec)),",
          "content_same": false
        },
        {
          "line": 3201,
          "old_api": "fprintf",
          "new_api": "btr_index_rec_validate",
          "old_text": "fprintf(stderr,\n\"InnoDB: Index record corruption: rec offs %lu next offs %lu, page no %lu,\\n\"\n\"InnoDB: index %s, table %s. We try to skip the record.\\n\",\n\t\t\t   (ulong) (rec - buf_frame_align(rec)),\n\t\t\t   (ulong) next_offs,\n\t\t\t   (ulong) buf_frame_get_page_no(rec), index->name,\n\t\t\t   index->table_name)",
          "new_text": "btr_index_rec_validate(rec, index,\n\t\t\t\t\t\t\t\tFALSE)",
          "old_line_content": "\t\t\tfprintf(stderr,",
          "new_line_content": "\t\tif (!rec_validate(rec) || !btr_index_rec_validate(rec, index,",
          "content_same": false
        },
        {
          "line": 3206,
          "old_api": "buf_frame_get_page_no",
          "new_api": "buf_frame_align",
          "old_text": "buf_frame_get_page_no(rec)",
          "new_text": "buf_frame_align(rec)",
          "old_line_content": "\t\t\t   (ulong) buf_frame_get_page_no(rec), index->name,",
          "new_line_content": "\t\t\t   (ulong) (rec - buf_frame_align(rec)),",
          "content_same": false
        },
        {
          "line": 3433,
          "old_api": "row_sel_store_mysql_rec",
          "new_api": "rec_get_extra_size",
          "old_text": "row_sel_store_mysql_rec(buf, prebuilt, rec)",
          "new_text": "rec_get_extra_size(rec)",
          "old_line_content": "\t\t\tif (!row_sel_store_mysql_rec(buf, prebuilt, rec)) {",
          "new_line_content": "\t\t\tmach_write_to_4(buf, rec_get_extra_size(rec) + 4);",
          "content_same": false
        },
        {
          "line": 3478,
          "old_api": "mtr_commit",
          "new_api": "btr_pcur_store_position",
          "old_text": "mtr_commit(&mtr)",
          "new_text": "btr_pcur_store_position(pcur, &mtr)",
          "old_line_content": "\t\tmtr_commit(&mtr);",
          "new_line_content": "\t\tbtr_pcur_store_position(pcur, &mtr);",
          "content_same": false
        },
        {
          "line": 3494,
          "old_api": "btr_pcur_move_to_prev",
          "new_api": "btr_pcur_move_to_next",
          "old_text": "btr_pcur_move_to_prev(pcur, &mtr)",
          "new_text": "btr_pcur_move_to_next(pcur, &mtr)",
          "old_line_content": "\t\tmoved = btr_pcur_move_to_prev(pcur, &mtr);",
          "new_line_content": "\t\tmoved = btr_pcur_move_to_next(pcur, &mtr);",
          "content_same": false
        },
        {
          "line": 3518,
          "old_api": "mtr_commit",
          "new_api": "btr_pcur_store_position",
          "old_text": "mtr_commit(&mtr)",
          "new_text": "btr_pcur_store_position(pcur, &mtr)",
          "old_line_content": "\tmtr_commit(&mtr);",
          "new_line_content": "\tbtr_pcur_store_position(pcur, &mtr);",
          "content_same": false
        },
        {
          "line": 3527,
          "old_api": "row_mysql_handle_errors",
          "new_api": "que_thr_stop_for_mysql",
          "old_text": "row_mysql_handle_errors(&err, trx, thr, NULL)",
          "new_text": "que_thr_stop_for_mysql(thr)",
          "old_line_content": "\twas_lock_wait = row_mysql_handle_errors(&err, trx, thr, NULL);",
          "new_line_content": "\tque_thr_stop_for_mysql(thr);",
          "content_same": false
        },
        {
          "line": 3532,
          "old_api": "sel_restore_position_for_mysql",
          "new_api": "mtr_start",
          "old_text": "sel_restore_position_for_mysql(BTR_SEARCH_LEAF, pcur,\n\t\t\t\t\t\t\tmoves_up, &mtr)",
          "new_text": "mtr_start(&mtr)",
          "old_line_content": "\t\tsel_restore_position_for_mysql(BTR_SEARCH_LEAF, pcur,",
          "new_line_content": "\t\tmtr_start(&mtr);",
          "content_same": false
        },
        {
          "line": 3549,
          "old_api": "mtr_commit",
          "new_api": "que_thr_stop_for_mysql_no_error",
          "old_text": "mtr_commit(&mtr)",
          "new_text": "que_thr_stop_for_mysql_no_error(thr, trx)",
          "old_line_content": "\tmtr_commit(&mtr);",
          "new_line_content": "\tque_thr_stop_for_mysql_no_error(thr, trx);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 3586,
          "old_api": null,
          "new_api": "dict_table_get",
          "old_text": null,
          "new_text": "dict_table_get(norm_name, trx)",
          "old_line_content": "\tif (table == NULL) {",
          "new_line_content": "\ttable = dict_table_get(norm_name, trx);",
          "content_same": false
        },
        {
          "line": 3203,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr,\n\"InnoDB: Index record corruption: rec offs %lu next offs %lu, page no %lu,\\n\"\n\"InnoDB: index %s, table %s. We try to skip the record.\\n\",\n\t\t\t   (ulong) (rec - buf_frame_align(rec)),\n\t\t\t   (ulong) next_offs,\n\t\t\t   (ulong) buf_frame_get_page_no(rec), index->name,\n\t\t\t   index->table_name)",
          "old_line_content": "\"InnoDB: index %s, table %s. We try to skip the record.\\n\",",
          "new_line_content": "\t\t\tfprintf(stderr,",
          "content_same": false
        },
        {
          "line": 3461,
          "old_api": null,
          "new_api": "btr_pcur_store_position",
          "old_text": null,
          "new_text": "btr_pcur_store_position(pcur, &mtr)",
          "old_line_content": "",
          "new_line_content": "\t\tbtr_pcur_store_position(pcur, &mtr);",
          "content_same": false
        },
        {
          "line": 3208,
          "old_api": null,
          "new_api": "buf_frame_get_page_no",
          "old_text": null,
          "new_text": "buf_frame_get_page_no(rec)",
          "old_line_content": "",
          "new_line_content": "\t\t\t   (ulong) buf_frame_get_page_no(rec), index->name,",
          "content_same": false
        },
        {
          "line": 3593,
          "old_api": null,
          "new_api": "mutex_enter",
          "old_text": null,
          "new_text": "mutex_enter(&kernel_mutex)",
          "old_line_content": "\t/* Start the transaction if it is not started yet */",
          "new_line_content": "\tmutex_enter(&kernel_mutex);",
          "content_same": false
        },
        {
          "line": 3597,
          "old_api": null,
          "new_api": "trx_start_if_not_started_low",
          "old_text": null,
          "new_text": "trx_start_if_not_started_low(trx)",
          "old_line_content": "\t/* If there are locks on the table or some trx has invalidated the",
          "new_line_content": "\ttrx_start_if_not_started_low(trx);",
          "content_same": false
        },
        {
          "line": 3342,
          "old_api": null,
          "new_api": "lock_sec_rec_cons_read_sees",
          "old_text": null,
          "new_text": "lock_sec_rec_cons_read_sees(rec, index,\n\t\t\t\t\t\t\ttrx->read_view)",
          "old_line_content": "\t\t\t/* We are looking into a non-clustered index,",
          "new_line_content": "\t\t} else if (!lock_sec_rec_cons_read_sees(rec, index,",
          "content_same": false
        },
        {
          "line": 3604,
          "old_api": null,
          "new_api": "UT_LIST_GET_LEN",
          "old_text": null,
          "new_text": "UT_LIST_GET_LEN(table->locks)",
          "old_line_content": "",
          "new_line_content": "\tif (UT_LIST_GET_LEN(table->locks) == 0",
          "content_same": false
        },
        {
          "line": 3093,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr,\n\"InnoDB: Error: MySQL is trying to perform a consistent read\\n\"\n\"InnoDB: but the read view is not assigned!\\n%s\\n\", err_buf)",
          "old_line_content": "\"InnoDB: but the read view is not assigned!\\n%s\\n\", err_buf);",
          "new_line_content": "\t\t\tfprintf(stderr,",
          "content_same": false
        },
        {
          "line": 3605,
          "old_api": null,
          "new_api": "ut_dulint_cmp",
          "old_text": null,
          "new_text": "ut_dulint_cmp(trx->id, table->query_cache_inv_trx_id)",
          "old_line_content": "\t\tret = TRUE;",
          "new_line_content": "\t    && ut_dulint_cmp(trx->id, table->query_cache_inv_trx_id) >= 0) {",
          "content_same": false
        },
        {
          "line": 3480,
          "old_api": null,
          "new_api": "mtr_commit",
          "old_text": null,
          "new_text": "mtr_commit(&mtr)",
          "old_line_content": "\t",
          "new_line_content": "\t\tmtr_commit(&mtr);",
          "content_same": false
        },
        {
          "line": 3097,
          "old_api": null,
          "new_api": "ut_a",
          "old_text": null,
          "new_text": "ut_a(0)",
          "old_line_content": "\t} else if (prebuilt->select_lock_type == LOCK_NONE) {",
          "new_line_content": "\t\t\tut_a(0);",
          "content_same": false
        },
        {
          "line": 3354,
          "old_api": null,
          "new_api": "rec_get_deleted_flag",
          "old_text": null,
          "new_text": "rec_get_deleted_flag(rec)",
          "old_line_content": "\t\t/* The record is delete-marked: we can skip it if this is",
          "new_line_content": "\tif (rec_get_deleted_flag(rec) && !cons_read_requires_clust_rec) {",
          "content_same": false
        },
        {
          "line": 3483,
          "old_api": null,
          "new_api": "mtr_start",
          "old_text": null,
          "new_text": "mtr_start(&mtr)",
          "old_line_content": "\t\t\t\t\t\t\tmoves_up, &mtr);",
          "new_line_content": "\t\tmtr_start(&mtr);",
          "content_same": false
        },
        {
          "line": 3228,
          "old_api": null,
          "new_api": "cmp_dtuple_rec",
          "old_text": null,
          "new_text": "cmp_dtuple_rec(search_tuple, rec)",
          "old_line_content": "\t\t\tif (prebuilt->select_lock_type != LOCK_NONE",
          "new_line_content": "\t\tif (0 != cmp_dtuple_rec(search_tuple, rec)) {",
          "content_same": false
        },
        {
          "line": 3484,
          "old_api": null,
          "new_api": "sel_restore_position_for_mysql",
          "old_text": null,
          "new_text": "sel_restore_position_for_mysql(BTR_SEARCH_LEAF, pcur,\n\t\t\t\t\t\t\tmoves_up, &mtr)",
          "old_line_content": "\t\tif (moved) {",
          "new_line_content": "\t\tmoved = sel_restore_position_for_mysql(BTR_SEARCH_LEAF, pcur,",
          "content_same": false
        },
        {
          "line": 3103,
          "old_api": null,
          "new_api": "trx_assign_read_view",
          "old_text": null,
          "new_text": "trx_assign_read_view(trx)",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\ttrx_assign_read_view(trx);",
          "content_same": false
        },
        {
          "line": 3615,
          "old_api": null,
          "new_api": "read_view_open_now",
          "old_text": null,
          "new_text": "read_view_open_now(trx,\n\t\t\t\t\t\ttrx->read_view_heap)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\ttrx->read_view = read_view_open_now(trx,",
          "content_same": false
        },
        {
          "line": 3234,
          "old_api": null,
          "new_api": "sel_set_rec_lock",
          "old_text": null,
          "new_text": "sel_set_rec_lock(rec, index,\n\t\t\t\t\t\tprebuilt->select_lock_type,\n\t\t\t\t\t\tLOCK_GAP, thr)",
          "old_line_content": "\t\t\t\t\t\tLOCK_GAP, thr);",
          "new_line_content": "\t\t\t\terr = sel_set_rec_lock(rec, index,",
          "content_same": false
        },
        {
          "line": 3620,
          "old_api": null,
          "new_api": "mutex_exit",
          "old_text": null,
          "new_text": "mutex_exit(&kernel_mutex)",
          "old_line_content": "\treturn(ret);",
          "new_line_content": "\tmutex_exit(&kernel_mutex);",
          "content_same": false
        },
        {
          "line": 3109,
          "old_api": null,
          "new_api": "lock_table",
          "old_text": null,
          "new_text": "lock_table(0, index->table, LOCK_IX, thr)",
          "old_line_content": "",
          "new_line_content": "\t\t\terr = lock_table(0, index->table, LOCK_IX, thr);",
          "content_same": false
        },
        {
          "line": 3496,
          "old_api": null,
          "new_api": "btr_pcur_move_to_prev",
          "old_text": null,
          "new_text": "btr_pcur_move_to_prev(pcur, &mtr)",
          "old_line_content": "",
          "new_line_content": "\t\tmoved = btr_pcur_move_to_prev(pcur, &mtr);",
          "content_same": false
        },
        {
          "line": 3243,
          "old_api": null,
          "new_api": "btr_pcur_store_position",
          "old_text": null,
          "new_text": "btr_pcur_store_position(pcur, &mtr)",
          "old_line_content": "\t\t\tret = DB_RECORD_NOT_FOUND;",
          "new_line_content": "\t\t\tbtr_pcur_store_position(pcur, &mtr);",
          "content_same": false
        },
        {
          "line": 3500,
          "old_api": null,
          "new_api": "btr_pcur_store_position",
          "old_text": null,
          "new_text": "btr_pcur_store_position(pcur, &mtr)",
          "old_line_content": "\t\tif (match_mode != 0) {",
          "new_line_content": "\t\tbtr_pcur_store_position(pcur, &mtr);",
          "content_same": false
        },
        {
          "line": 3376,
          "old_api": null,
          "new_api": "row_sel_get_clust_rec_for_mysql",
          "old_text": null,
          "new_text": "row_sel_get_clust_rec_for_mysql(prebuilt, index, rec,\n\t\t\t\t\t\t\tthr, &clust_rec, &mtr)",
          "old_line_content": "\t\tif (err != DB_SUCCESS) {",
          "new_line_content": "\t\terr = row_sel_get_clust_rec_for_mysql(prebuilt, index, rec,",
          "content_same": false
        },
        {
          "line": 3123,
          "old_api": null,
          "new_api": "btr_pcur_get_rec",
          "old_text": null,
          "new_text": "btr_pcur_get_rec(pcur)",
          "old_line_content": "\tprintf(\"Using index %s cnt %lu \", index->name, cnt);",
          "new_line_content": "\trec = btr_pcur_get_rec(pcur);",
          "content_same": false
        },
        {
          "line": 3253,
          "old_api": null,
          "new_api": "cmp_dtuple_is_prefix_of_rec",
          "old_text": null,
          "new_text": "cmp_dtuple_is_prefix_of_rec(search_tuple, rec)",
          "old_line_content": "\t\t\tif (prebuilt->select_lock_type != LOCK_NONE",
          "new_line_content": "\t\tif (!cmp_dtuple_is_prefix_of_rec(search_tuple, rec)) {",
          "content_same": false
        },
        {
          "line": 3385,
          "old_api": null,
          "new_api": "ut_ad",
          "old_text": null,
          "new_text": "ut_ad(prebuilt->select_lock_type == LOCK_NONE)",
          "old_line_content": "\t\t\tgoto next_rec;",
          "new_line_content": "\t\t\tut_ad(prebuilt->select_lock_type == LOCK_NONE);",
          "content_same": false
        },
        {
          "line": 3130,
          "old_api": null,
          "new_api": "buf_frame_align",
          "old_text": null,
          "new_text": "buf_frame_align(rec)",
          "old_line_content": "\t\t/* The infimum record on a page cannot be in the result set,",
          "new_line_content": "\tif (rec == page_get_infimum_rec(buf_frame_align(rec))) {",
          "content_same": false
        },
        {
          "line": 3259,
          "old_api": null,
          "new_api": "sel_set_rec_lock",
          "old_text": null,
          "new_text": "sel_set_rec_lock(rec, index,\n\t\t\t\t\t\tprebuilt->select_lock_type,\n\t\t\t\t\t\tLOCK_GAP, thr)",
          "old_line_content": "\t\t\t\t\t\tLOCK_GAP, thr);",
          "new_line_content": "\t\t\t\terr = sel_set_rec_lock(rec, index,",
          "content_same": false
        },
        {
          "line": 3390,
          "old_api": null,
          "new_api": "rec_get_deleted_flag",
          "old_text": null,
          "new_text": "rec_get_deleted_flag(clust_rec)",
          "old_line_content": "\t\t\t/* The record is delete marked: we can skip it */",
          "new_line_content": "\t\tif (rec_get_deleted_flag(clust_rec)) {",
          "content_same": false
        },
        {
          "line": 3520,
          "old_api": null,
          "new_api": "mtr_commit",
          "old_text": null,
          "new_text": "mtr_commit(&mtr)",
          "old_line_content": "\t\t",
          "new_line_content": "\tmtr_commit(&mtr);",
          "content_same": false
        },
        {
          "line": 3139,
          "old_api": null,
          "new_api": "buf_frame_align",
          "old_text": null,
          "new_text": "buf_frame_align(rec)",
          "old_line_content": "\t\tif (prebuilt->select_lock_type != LOCK_NONE",
          "new_line_content": "\tif (rec == page_get_supremum_rec(buf_frame_align(rec))) {",
          "content_same": false
        },
        {
          "line": 3268,
          "old_api": null,
          "new_api": "btr_pcur_store_position",
          "old_text": null,
          "new_text": "btr_pcur_store_position(pcur, &mtr)",
          "old_line_content": "\t\t\tret = DB_RECORD_NOT_FOUND;",
          "new_line_content": "\t\t\tbtr_pcur_store_position(pcur, &mtr);",
          "content_same": false
        },
        {
          "line": 3529,
          "old_api": null,
          "new_api": "row_mysql_handle_errors",
          "old_text": null,
          "new_text": "row_mysql_handle_errors(&err, trx, thr, NULL)",
          "old_line_content": "\tif (was_lock_wait) {",
          "new_line_content": "\twas_lock_wait = row_mysql_handle_errors(&err, trx, thr, NULL);",
          "content_same": false
        },
        {
          "line": 2762,
          "old_api": null,
          "new_api": "ut_ad",
          "old_text": null,
          "new_text": "ut_ad(index && pcur && search_tuple)",
          "old_line_content": "\t",
          "new_line_content": "\tut_ad(index && pcur && search_tuple);",
          "content_same": false
        },
        {
          "line": 3146,
          "old_api": null,
          "new_api": "sel_set_rec_lock",
          "old_text": null,
          "new_text": "sel_set_rec_lock(rec, index,\n\t\t\t\t\t\tprebuilt->select_lock_type,\n\t\t\t\t\t\tLOCK_ORDINARY, thr)",
          "old_line_content": "\t\t\t\t\t\tLOCK_ORDINARY, thr);",
          "new_line_content": "\t\t\terr = sel_set_rec_lock(rec, index,",
          "content_same": false
        },
        {
          "line": 2766,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr,\n\t\t\"InnoDB: Error: trying to free a corrupt\\n\"\n\t\t\"InnoDB: table handle. Magic n %lu, table name %s\\n\",\n\t\t(ulong) prebuilt->magic_n, prebuilt->table->name)",
          "old_line_content": "\tif (prebuilt->magic_n != ROW_PREBUILT_ALLOCATED) {",
          "new_line_content": "\t\tfprintf(stderr,",
          "content_same": false
        },
        {
          "line": 3534,
          "old_api": null,
          "new_api": "sel_restore_position_for_mysql",
          "old_text": null,
          "new_text": "sel_restore_position_for_mysql(BTR_SEARCH_LEAF, pcur,\n\t\t\t\t\t\t\tmoves_up, &mtr)",
          "old_line_content": "\t\tmode = pcur->search_mode;",
          "new_line_content": "\t\tsel_restore_position_for_mysql(BTR_SEARCH_LEAF, pcur,",
          "content_same": false
        },
        {
          "line": 2771,
          "old_api": null,
          "new_api": "mem_analyze_corruption",
          "old_text": null,
          "new_text": "mem_analyze_corruption((byte*)prebuilt)",
          "old_line_content": "",
          "new_line_content": "\t\tmem_analyze_corruption((byte*)prebuilt);",
          "content_same": false
        },
        {
          "line": 2773,
          "old_api": null,
          "new_api": "ut_a",
          "old_text": null,
          "new_text": "ut_a(0)",
          "old_line_content": "",
          "new_line_content": "\t\tut_a(0);",
          "content_same": false
        },
        {
          "line": 3289,
          "old_api": null,
          "new_api": "rec_get_deleted_flag",
          "old_text": null,
          "new_text": "rec_get_deleted_flag(rec)",
          "old_line_content": "\t\t\t\t\t\tprebuilt->select_lock_type,",
          "new_line_content": "\t\t    || (unique_search && !rec_get_deleted_flag(rec))) {",
          "content_same": false
        },
        {
          "line": 3290,
          "old_api": null,
          "new_api": "sel_set_rec_lock",
          "old_text": null,
          "new_text": "sel_set_rec_lock(rec, index,\n\t\t\t\t\t\tprebuilt->select_lock_type,\n\t\t\t\t\t\tLOCK_REC_NOT_GAP, thr)",
          "old_line_content": "\t\t\t\t\t\tLOCK_REC_NOT_GAP, thr);",
          "new_line_content": "\t\t\terr = sel_set_rec_lock(rec, index,",
          "content_same": false
        },
        {
          "line": 3164,
          "old_api": null,
          "new_api": "rec_get_next_offs",
          "old_text": null,
          "new_text": "rec_get_next_offs(rec)",
          "old_line_content": "\tif (next_offs >= UNIV_PAGE_SIZE || next_offs < PAGE_SUPREMUM) {",
          "new_line_content": "\tnext_offs = rec_get_next_offs(rec);",
          "content_same": false
        },
        {
          "line": 3421,
          "old_api": null,
          "new_api": "row_sel_push_cache_row_for_mysql",
          "old_text": null,
          "new_text": "row_sel_push_cache_row_for_mysql(prebuilt, rec)",
          "old_line_content": "\t\tif (prebuilt->n_fetch_cached == MYSQL_FETCH_CACHE_SIZE) {",
          "new_line_content": "\t\trow_sel_push_cache_row_for_mysql(prebuilt, rec);",
          "content_same": false
        },
        {
          "line": 3294,
          "old_api": null,
          "new_api": "sel_set_rec_lock",
          "old_text": null,
          "new_text": "sel_set_rec_lock(rec, index,\n\t\t\t\t\t\tprebuilt->select_lock_type,\n\t\t\t\t\t\tLOCK_ORDINARY, thr)",
          "old_line_content": "\t\t\t\t\t\tLOCK_ORDINARY, thr);",
          "new_line_content": "\t\t\terr = sel_set_rec_lock(rec, index,",
          "content_same": false
        },
        {
          "line": 3551,
          "old_api": null,
          "new_api": "mtr_commit",
          "old_text": null,
          "new_text": "mtr_commit(&mtr)",
          "old_line_content": "\tif (prebuilt->n_fetch_cached > 0) {",
          "new_line_content": "\tmtr_commit(&mtr);",
          "content_same": false
        },
        {
          "line": 3169,
          "old_api": null,
          "new_api": "ut_print_timestamp",
          "old_text": null,
          "new_text": "ut_print_timestamp(stderr)",
          "old_line_content": "\"  InnoDB: Index corruption: rec offs %lu next offs %lu, page no %lu,\\n\"",
          "new_line_content": "\t\t\tut_print_timestamp(stderr);",
          "content_same": false
        },
        {
          "line": 3170,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr,\n\"  InnoDB: Index corruption: rec offs %lu next offs %lu, page no %lu,\\n\"\n\"InnoDB: index %s, table %s. Run CHECK TABLE to table. You may need to\\n\"\n\"InnoDB: restore from a backup, or dump + drop + reimport the table.\\n\",\n\t\t\t   (ulong) (rec - buf_frame_align(rec)),\n\t\t\t   (ulong) next_offs,\n\t\t\t   (ulong) buf_frame_get_page_no(rec), index->name,\n\t\t\t   index->table_name)",
          "old_line_content": "\"InnoDB: index %s, table %s. Run CHECK TABLE to table. You may need to\\n\"",
          "new_line_content": "\t\t\tfprintf(stderr,",
          "content_same": false
        },
        {
          "line": 3554,
          "old_api": null,
          "new_api": "row_sel_pop_cached_row_for_mysql",
          "old_text": null,
          "new_text": "row_sel_pop_cached_row_for_mysql(buf, prebuilt)",
          "old_line_content": "\t\tret = DB_SUCCESS;",
          "new_line_content": "\t\trow_sel_pop_cached_row_for_mysql(buf, prebuilt);",
          "content_same": false
        },
        {
          "line": 3176,
          "old_api": null,
          "new_api": "buf_frame_get_page_no",
          "old_text": null,
          "new_text": "buf_frame_get_page_no(rec)",
          "old_line_content": "\t\t",
          "new_line_content": "\t\t\t   (ulong) buf_frame_get_page_no(rec), index->name,",
          "content_same": false
        },
        {
          "line": 3432,
          "old_api": null,
          "new_api": "rec_get_size",
          "old_text": null,
          "new_text": "rec_get_size(rec)",
          "old_line_content": "\t\t} else {",
          "new_line_content": "\t\t\t\t\t\trec_get_size(rec));",
          "content_same": false
        },
        {
          "line": 3435,
          "old_api": null,
          "new_api": "row_sel_store_mysql_rec",
          "old_text": null,
          "new_text": "row_sel_store_mysql_rec(buf, prebuilt, rec)",
          "old_line_content": "",
          "new_line_content": "\t\t\tif (!row_sel_store_mysql_rec(buf, prebuilt, rec)) {",
          "content_same": false
        },
        {
          "line": 3186,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr,\n\"InnoDB: Index corruption: rec offs %lu next offs %lu, page no %lu,\\n\"\n\"InnoDB: index %s, table %s. We try to skip the rest of the page.\\n\",\n\t\t\t   (ulong) (rec - buf_frame_align(rec)),\n\t\t\t   (ulong) next_offs,\n\t\t\t   (ulong) buf_frame_get_page_no(rec), index->name,\n\t\t\t   index->table_name)",
          "old_line_content": "\"InnoDB: index %s, table %s. We try to skip the rest of the page.\\n\",",
          "new_line_content": "\t\t\tfprintf(stderr,",
          "content_same": false
        },
        {
          "line": 3443,
          "old_api": null,
          "new_api": "row_sel_store_row_id_to_prebuilt",
          "old_text": null,
          "new_text": "row_sel_store_row_id_to_prebuilt(prebuilt, index_rec,\n\t\t\t\t\t\t\t\t\tindex)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\trow_sel_store_row_id_to_prebuilt(prebuilt, index_rec,",
          "content_same": false
        },
        {
          "line": 3191,
          "old_api": null,
          "new_api": "buf_frame_get_page_no",
          "old_text": null,
          "new_text": "buf_frame_get_page_no(rec)",
          "old_line_content": "",
          "new_line_content": "\t\t\t   (ulong) buf_frame_get_page_no(rec), index->name,",
          "content_same": false
        },
        {
          "line": 3320,
          "old_api": null,
          "new_api": "lock_clust_rec_cons_read_sees",
          "old_text": null,
          "new_text": "lock_clust_rec_cons_read_sees(rec, index,\n\t\t\t\t\t\t\ttrx->read_view)",
          "old_line_content": "",
          "new_line_content": "                            && !lock_clust_rec_cons_read_sees(rec, index,",
          "content_same": false
        },
        {
          "line": 3194,
          "old_api": null,
          "new_api": "btr_pcur_move_to_last_on_page",
          "old_text": null,
          "new_text": "btr_pcur_move_to_last_on_page(pcur, &mtr)",
          "old_line_content": "\t\t\tgoto next_rec;",
          "new_line_content": "\t\t\tbtr_pcur_move_to_last_on_page(pcur, &mtr);",
          "content_same": false
        },
        {
          "line": 3323,
          "old_api": null,
          "new_api": "row_sel_build_prev_vers_for_mysql",
          "old_text": null,
          "new_text": "row_sel_build_prev_vers_for_mysql(\n\t\t\t\t\t\ttrx->read_view, clust_index,\n\t\t\t\t\t\tprebuilt, rec,\n\t\t\t\t\t\t&old_vers, &mtr)",
          "old_line_content": "\t\t\t\t\t\tprebuilt, rec,",
          "new_line_content": "\t\t\t\terr = row_sel_build_prev_vers_for_mysql(",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 3584,
          "old_api": "dict_table_get",
          "new_api": null,
          "old_text": "dict_table_get(norm_name, trx)",
          "new_text": null,
          "old_line_content": "\ttable = dict_table_get(norm_name, trx);",
          "new_line_content": "\tibool\t\tret \t= FALSE;",
          "content_same": false
        },
        {
          "line": 3459,
          "old_api": "btr_pcur_store_position",
          "new_api": null,
          "old_text": "btr_pcur_store_position(pcur, &mtr)",
          "new_text": null,
          "old_line_content": "\t\tbtr_pcur_store_position(pcur, &mtr);",
          "new_line_content": "\t\t/* Inside an update always store the cursor position */",
          "content_same": false
        },
        {
          "line": 3204,
          "old_api": "buf_frame_align",
          "new_api": null,
          "old_text": "buf_frame_align(rec)",
          "new_text": null,
          "old_line_content": "\t\t\t   (ulong) (rec - buf_frame_align(rec)),",
          "new_line_content": "\"InnoDB: Index record corruption: rec offs %lu next offs %lu, page no %lu,\\n\"",
          "content_same": false
        },
        {
          "line": 3591,
          "old_api": "mutex_enter",
          "new_api": null,
          "old_text": "mutex_enter(&kernel_mutex)",
          "new_text": null,
          "old_line_content": "\tmutex_enter(&kernel_mutex);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 3595,
          "old_api": "trx_start_if_not_started_low",
          "new_api": null,
          "old_text": "trx_start_if_not_started_low(trx)",
          "new_text": null,
          "old_line_content": "\ttrx_start_if_not_started_low(trx);",
          "new_line_content": "\t/* Start the transaction if it is not started yet */",
          "content_same": false
        },
        {
          "line": 3340,
          "old_api": "lock_sec_rec_cons_read_sees",
          "new_api": null,
          "old_text": "lock_sec_rec_cons_read_sees(rec, index,\n\t\t\t\t\t\t\ttrx->read_view)",
          "new_text": null,
          "old_line_content": "\t\t} else if (!lock_sec_rec_cons_read_sees(rec, index,",
          "new_line_content": "\t\t\t\trec = old_vers;",
          "content_same": false
        },
        {
          "line": 3089,
          "old_api": "trx_print",
          "new_api": null,
          "old_text": "trx_print(err_buf, trx)",
          "new_text": null,
          "old_line_content": "\t\t\ttrx_print(err_buf, trx);",
          "new_line_content": "\t\t\tchar\terr_buf[1000];",
          "content_same": false
        },
        {
          "line": 3602,
          "old_api": "UT_LIST_GET_LEN",
          "new_api": null,
          "old_text": "UT_LIST_GET_LEN(table->locks)",
          "new_text": null,
          "old_line_content": "\tif (UT_LIST_GET_LEN(table->locks) == 0",
          "new_line_content": "\tIX type locks actually would require ret = FALSE. */",
          "content_same": false
        },
        {
          "line": 3603,
          "old_api": "ut_dulint_cmp",
          "new_api": null,
          "old_text": "ut_dulint_cmp(trx->id, table->query_cache_inv_trx_id)",
          "new_text": null,
          "old_line_content": "\t    && ut_dulint_cmp(trx->id, table->query_cache_inv_trx_id) >= 0) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3476,
          "old_api": "btr_pcur_store_position",
          "new_api": null,
          "old_text": "btr_pcur_store_position(pcur, &mtr)",
          "new_text": null,
          "old_line_content": "\t\tbtr_pcur_store_position(pcur, &mtr);",
          "new_line_content": "\t\tindex page right away without releasing the previous. */",
          "content_same": false
        },
        {
          "line": 3095,
          "old_api": "ut_a",
          "new_api": null,
          "old_text": "ut_a(0)",
          "new_text": null,
          "old_line_content": "\t\t\tut_a(0);",
          "new_line_content": "\"InnoDB: but the read view is not assigned!\\n%s\\n\", err_buf);",
          "content_same": false
        },
        {
          "line": 3352,
          "old_api": "rec_get_deleted_flag",
          "new_api": null,
          "old_text": "rec_get_deleted_flag(rec)",
          "new_text": null,
          "old_line_content": "\tif (rec_get_deleted_flag(rec) && !cons_read_requires_clust_rec) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 3481,
          "old_api": "mtr_start",
          "new_api": null,
          "old_text": "mtr_start(&mtr)",
          "new_text": null,
          "old_line_content": "\t\tmtr_start(&mtr);",
          "new_line_content": "\t\tmtr_has_extra_clust_latch = FALSE;",
          "content_same": false
        },
        {
          "line": 3226,
          "old_api": "cmp_dtuple_rec",
          "new_api": null,
          "old_text": "cmp_dtuple_rec(search_tuple, rec)",
          "new_text": null,
          "old_line_content": "\t\tif (0 != cmp_dtuple_rec(search_tuple, rec)) {",
          "new_line_content": "\t\t/* printf(\"Comparing rec and search tuple\\n\"); */",
          "content_same": false
        },
        {
          "line": 3482,
          "old_api": "sel_restore_position_for_mysql",
          "new_api": null,
          "old_text": "sel_restore_position_for_mysql(BTR_SEARCH_LEAF, pcur,\n\t\t\t\t\t\t\tmoves_up, &mtr)",
          "new_text": null,
          "old_line_content": "\t\tmoved = sel_restore_position_for_mysql(BTR_SEARCH_LEAF, pcur,",
          "new_line_content": "\t",
          "content_same": false
        },
        {
          "line": 3101,
          "old_api": "trx_assign_read_view",
          "new_api": null,
          "old_text": "trx_assign_read_view(trx)",
          "new_text": null,
          "old_line_content": "\t\ttrx_assign_read_view(trx);",
          "new_line_content": "\t\t/* Assign a read view for the query */",
          "content_same": false
        },
        {
          "line": 3613,
          "old_api": "read_view_open_now",
          "new_api": null,
          "old_text": "read_view_open_now(trx,\n\t\t\t\t\t\ttrx->read_view_heap)",
          "new_text": null,
          "old_line_content": "\t\t\ttrx->read_view = read_view_open_now(trx,",
          "new_line_content": "\t\t    && !trx->read_view) {",
          "content_same": false
        },
        {
          "line": 3232,
          "old_api": "sel_set_rec_lock",
          "new_api": null,
          "old_text": "sel_set_rec_lock(rec, index,\n\t\t\t\t\t\tprebuilt->select_lock_type,\n\t\t\t\t\t\tLOCK_GAP, thr)",
          "new_text": null,
          "old_line_content": "\t\t\t\terr = sel_set_rec_lock(rec, index,",
          "new_line_content": "\t\t\t\t/* Try to place a lock on the index record */",
          "content_same": false
        },
        {
          "line": 3105,
          "old_api": "lock_table",
          "new_api": null,
          "old_text": "lock_table(0, index->table, LOCK_IS, thr)",
          "new_text": null,
          "old_line_content": "\t\t\terr = lock_table(0, index->table, LOCK_IS, thr);",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 3618,
          "old_api": "mutex_exit",
          "new_api": null,
          "old_text": "mutex_exit(&kernel_mutex)",
          "new_text": null,
          "old_line_content": "\tmutex_exit(&kernel_mutex);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 3492,
          "old_api": "btr_pcur_move_to_next",
          "new_api": null,
          "old_text": "btr_pcur_move_to_next(pcur, &mtr)",
          "new_text": null,
          "old_line_content": "\t\tmoved = btr_pcur_move_to_next(pcur, &mtr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3241,
          "old_api": "btr_pcur_store_position",
          "new_api": null,
          "old_text": "btr_pcur_store_position(pcur, &mtr)",
          "new_text": null,
          "old_line_content": "\t\t\tbtr_pcur_store_position(pcur, &mtr);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 3498,
          "old_api": "btr_pcur_store_position",
          "new_api": null,
          "old_text": "btr_pcur_store_position(pcur, &mtr)",
          "new_text": null,
          "old_line_content": "\t\tbtr_pcur_store_position(pcur, &mtr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3374,
          "old_api": "row_sel_get_clust_rec_for_mysql",
          "new_api": null,
          "old_text": "row_sel_get_clust_rec_for_mysql(prebuilt, index, rec,\n\t\t\t\t\t\t\tthr, &clust_rec, &mtr)",
          "new_text": null,
          "old_line_content": "\t\terr = row_sel_get_clust_rec_for_mysql(prebuilt, index, rec,",
          "new_line_content": "\t\tmtr_has_extra_clust_latch = TRUE;",
          "content_same": false
        },
        {
          "line": 3121,
          "old_api": "btr_pcur_get_rec",
          "new_api": null,
          "old_text": "btr_pcur_get_rec(pcur)",
          "new_text": null,
          "old_line_content": "\trec = btr_pcur_get_rec(pcur);",
          "new_line_content": "\t/* PHASE 4: Look for matching records in a loop */",
          "content_same": false
        },
        {
          "line": 3251,
          "old_api": "cmp_dtuple_is_prefix_of_rec",
          "new_api": null,
          "old_text": "cmp_dtuple_is_prefix_of_rec(search_tuple, rec)",
          "new_text": null,
          "old_line_content": "\t\tif (!cmp_dtuple_is_prefix_of_rec(search_tuple, rec)) {",
          "new_line_content": "\t} else if (match_mode == ROW_SEL_EXACT_PREFIX) {",
          "content_same": false
        },
        {
          "line": 3383,
          "old_api": "ut_ad",
          "new_api": null,
          "old_text": "ut_ad(prebuilt->select_lock_type == LOCK_NONE)",
          "new_text": null,
          "old_line_content": "\t\t\tut_ad(prebuilt->select_lock_type == LOCK_NONE);",
          "new_line_content": "\t\tif (clust_rec == NULL) {",
          "content_same": false
        },
        {
          "line": 3128,
          "old_api": "buf_frame_align",
          "new_api": null,
          "old_text": "buf_frame_align(rec)",
          "new_text": null,
          "old_line_content": "\tif (rec == page_get_infimum_rec(buf_frame_align(rec))) {",
          "new_line_content": "\trec_print(rec);",
          "content_same": false
        },
        {
          "line": 3257,
          "old_api": "sel_set_rec_lock",
          "new_api": null,
          "old_text": "sel_set_rec_lock(rec, index,\n\t\t\t\t\t\tprebuilt->select_lock_type,\n\t\t\t\t\t\tLOCK_GAP, thr)",
          "new_text": null,
          "old_line_content": "\t\t\t\terr = sel_set_rec_lock(rec, index,",
          "new_line_content": "\t\t\t\t/* Try to place a lock on the index record */\t",
          "content_same": false
        },
        {
          "line": 3388,
          "old_api": "rec_get_deleted_flag",
          "new_api": null,
          "old_text": "rec_get_deleted_flag(clust_rec)",
          "new_text": null,
          "old_line_content": "\t\tif (rec_get_deleted_flag(clust_rec)) {",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 3516,
          "old_api": "btr_pcur_store_position",
          "new_api": null,
          "old_text": "btr_pcur_store_position(pcur, &mtr)",
          "new_text": null,
          "old_line_content": "\tbtr_pcur_store_position(pcur, &mtr);",
          "new_line_content": "\t/*-------------------------------------------------------------*/",
          "content_same": false
        },
        {
          "line": 3137,
          "old_api": "buf_frame_align",
          "new_api": null,
          "old_text": "buf_frame_align(rec)",
          "new_text": null,
          "old_line_content": "\tif (rec == page_get_supremum_rec(buf_frame_align(rec))) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 3266,
          "old_api": "btr_pcur_store_position",
          "new_api": null,
          "old_text": "btr_pcur_store_position(pcur, &mtr)",
          "new_text": null,
          "old_line_content": "\t\t\tbtr_pcur_store_position(pcur, &mtr);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 3525,
          "old_api": "que_thr_stop_for_mysql",
          "new_api": null,
          "old_text": "que_thr_stop_for_mysql(thr)",
          "new_text": null,
          "old_line_content": "\tque_thr_stop_for_mysql(thr);",
          "new_line_content": "\t/* The following is a patch for MySQL */",
          "content_same": false
        },
        {
          "line": 3144,
          "old_api": "sel_set_rec_lock",
          "new_api": null,
          "old_text": "sel_set_rec_lock(rec, index,\n\t\t\t\t\t\tprebuilt->select_lock_type,\n\t\t\t\t\t\tLOCK_ORDINARY, thr)",
          "new_text": null,
          "old_line_content": "\t\t\terr = sel_set_rec_lock(rec, index,",
          "new_line_content": "\t\t\t/* Try to place a lock on the index record */\t",
          "content_same": false
        },
        {
          "line": 3530,
          "old_api": "mtr_start",
          "new_api": null,
          "old_text": "mtr_start(&mtr)",
          "new_text": null,
          "old_line_content": "\t\tmtr_start(&mtr);",
          "new_line_content": "\t",
          "content_same": false
        },
        {
          "line": 2764,
          "old_api": "os_thread_get_curr_id",
          "new_api": null,
          "old_text": "os_thread_get_curr_id()",
          "new_text": null,
          "old_line_content": "\tut_ad(trx->mysql_thread_id == os_thread_get_curr_id());",
          "new_line_content": "\t\t",
          "content_same": false
        },
        {
          "line": 2767,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr,\n\t\t\"InnoDB: Error: trying to free a corrupt\\n\"\n\t\t\"InnoDB: table handle. Magic n %lu, table name %s\\n\",\n\t\t(ulong) prebuilt->magic_n, prebuilt->table->name)",
          "new_text": null,
          "old_line_content": "\t\tfprintf(stderr,",
          "new_line_content": "\t\t\"InnoDB: Error: trying to free a corrupt\\n\"",
          "content_same": false
        },
        {
          "line": 2772,
          "old_api": "mem_analyze_corruption",
          "new_api": null,
          "old_text": "mem_analyze_corruption((byte*)prebuilt)",
          "new_text": null,
          "old_line_content": "\t\tmem_analyze_corruption((byte*)prebuilt);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2774,
          "old_api": "ut_a",
          "new_api": null,
          "old_text": "ut_a(0)",
          "new_text": null,
          "old_line_content": "\t\tut_a(0);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 3287,
          "old_api": "rec_get_deleted_flag",
          "new_api": null,
          "old_text": "rec_get_deleted_flag(rec)",
          "new_text": null,
          "old_line_content": "\t\t    || (unique_search && !rec_get_deleted_flag(rec))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3288,
          "old_api": "sel_set_rec_lock",
          "new_api": null,
          "old_text": "sel_set_rec_lock(rec, index,\n\t\t\t\t\t\tprebuilt->select_lock_type,\n\t\t\t\t\t\tLOCK_REC_NOT_GAP, thr)",
          "new_text": null,
          "old_line_content": "\t\t\terr = sel_set_rec_lock(rec, index,",
          "new_line_content": "\t\tif (!set_also_gap_locks",
          "content_same": false
        },
        {
          "line": 3162,
          "old_api": "rec_get_next_offs",
          "new_api": null,
          "old_text": "rec_get_next_offs(rec)",
          "new_text": null,
          "old_line_content": "\tnext_offs = rec_get_next_offs(rec);",
          "new_line_content": "\tcorruption */",
          "content_same": false
        },
        {
          "line": 3419,
          "old_api": "row_sel_push_cache_row_for_mysql",
          "new_api": null,
          "old_text": "row_sel_push_cache_row_for_mysql(prebuilt, rec)",
          "new_text": null,
          "old_line_content": "\t\trow_sel_push_cache_row_for_mysql(prebuilt, rec);",
          "new_line_content": "\t\tcursor. */",
          "content_same": false
        },
        {
          "line": 3292,
          "old_api": "sel_set_rec_lock",
          "new_api": null,
          "old_text": "sel_set_rec_lock(rec, index,\n\t\t\t\t\t\tprebuilt->select_lock_type,\n\t\t\t\t\t\tLOCK_ORDINARY, thr)",
          "new_text": null,
          "old_line_content": "\t\t\terr = sel_set_rec_lock(rec, index,",
          "new_line_content": "\t\t\t\t\t\tLOCK_REC_NOT_GAP, thr);",
          "content_same": false
        },
        {
          "line": 3547,
          "old_api": "que_thr_stop_for_mysql_no_error",
          "new_api": null,
          "old_text": "que_thr_stop_for_mysql_no_error(thr, trx)",
          "new_text": null,
          "old_line_content": "\tque_thr_stop_for_mysql_no_error(thr, trx);",
          "new_line_content": "normal_return:",
          "content_same": false
        },
        {
          "line": 3167,
          "old_api": "ut_print_timestamp",
          "new_api": null,
          "old_text": "ut_print_timestamp(stderr)",
          "new_text": null,
          "old_line_content": "\t\t\tut_print_timestamp(stderr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3168,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr,\n\"  InnoDB: Index corruption: rec offs %lu next offs %lu, page no %lu,\\n\"\n\"InnoDB: index %s, table %s. Run CHECK TABLE to table. You may need to\\n\"\n\"InnoDB: restore from a backup, or dump + drop + reimport the table.\\n\",\n\t\t\t   (ulong) (rec - buf_frame_align(rec)),\n\t\t\t   (ulong) next_offs,\n\t\t\t   (ulong) buf_frame_get_page_no(rec), index->name,\n\t\t\t   index->table_name)",
          "new_text": null,
          "old_line_content": "\t\t\tfprintf(stderr,",
          "new_line_content": "\t\tif (srv_force_recovery == 0 || moves_up == FALSE) {",
          "content_same": false
        },
        {
          "line": 3552,
          "old_api": "row_sel_pop_cached_row_for_mysql",
          "new_api": null,
          "old_text": "row_sel_pop_cached_row_for_mysql(buf, prebuilt)",
          "new_text": null,
          "old_line_content": "\t\trow_sel_pop_cached_row_for_mysql(buf, prebuilt);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3172,
          "old_api": "buf_frame_align",
          "new_api": null,
          "old_text": "buf_frame_align(rec)",
          "new_text": null,
          "old_line_content": "\t\t\t   (ulong) (rec - buf_frame_align(rec)),",
          "new_line_content": "\"InnoDB: index %s, table %s. Run CHECK TABLE to table. You may need to\\n\"",
          "content_same": false
        },
        {
          "line": 3429,
          "old_api": "rec_get_extra_size",
          "new_api": null,
          "old_text": "rec_get_extra_size(rec)",
          "new_text": null,
          "old_line_content": "\t\t\tut_memcpy(buf + 4, rec - rec_get_extra_size(rec),",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 3430,
          "old_api": "rec_get_size",
          "new_api": null,
          "old_text": "rec_get_size(rec)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\trec_get_size(rec));",
          "new_line_content": "\t\tif (prebuilt->template_type == ROW_MYSQL_DUMMY_TEMPLATE) {",
          "content_same": false
        },
        {
          "line": 3184,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr,\n\"InnoDB: Index corruption: rec offs %lu next offs %lu, page no %lu,\\n\"\n\"InnoDB: index %s, table %s. We try to skip the rest of the page.\\n\",\n\t\t\t   (ulong) (rec - buf_frame_align(rec)),\n\t\t\t   (ulong) next_offs,\n\t\t\t   (ulong) buf_frame_get_page_no(rec), index->name,\n\t\t\t   index->table_name)",
          "new_text": null,
          "old_line_content": "\t\t\tfprintf(stderr,",
          "new_line_content": "\t\t\tover the corruption to recover as much as possible. */",
          "content_same": false
        },
        {
          "line": 3441,
          "old_api": "row_sel_store_row_id_to_prebuilt",
          "new_api": null,
          "old_text": "row_sel_store_row_id_to_prebuilt(prebuilt, index_rec,\n\t\t\t\t\t\t\t\t\tindex)",
          "new_text": null,
          "old_line_content": "\t\t\trow_sel_store_row_id_to_prebuilt(prebuilt, index_rec,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3187,
          "old_api": "buf_frame_align",
          "new_api": null,
          "old_text": "buf_frame_align(rec)",
          "new_text": null,
          "old_line_content": "\t\t\t   (ulong) (rec - buf_frame_align(rec)),",
          "new_line_content": "\"InnoDB: Index corruption: rec offs %lu next offs %lu, page no %lu,\\n\"",
          "content_same": false
        },
        {
          "line": 3318,
          "old_api": "lock_clust_rec_cons_read_sees",
          "new_api": null,
          "old_text": "lock_clust_rec_cons_read_sees(rec, index,\n\t\t\t\t\t\t\ttrx->read_view)",
          "new_text": null,
          "old_line_content": "                            && !lock_clust_rec_cons_read_sees(rec, index,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3192,
          "old_api": "btr_pcur_move_to_last_on_page",
          "new_api": null,
          "old_text": "btr_pcur_move_to_last_on_page(pcur, &mtr)",
          "new_text": null,
          "old_line_content": "\t\t\tbtr_pcur_move_to_last_on_page(pcur, &mtr);",
          "new_line_content": "\t\t\t   index->table_name);",
          "content_same": false
        },
        {
          "line": 3321,
          "old_api": "row_sel_build_prev_vers_for_mysql",
          "new_api": null,
          "old_text": "row_sel_build_prev_vers_for_mysql(\n\t\t\t\t\t\ttrx->read_view, clust_index,\n\t\t\t\t\t\tprebuilt, rec,\n\t\t\t\t\t\t&old_vers, &mtr)",
          "new_text": null,
          "old_line_content": "\t\t\t\terr = row_sel_build_prev_vers_for_mysql(",
          "new_line_content": "\t\t\t\t\t\t\ttrx->read_view)) {",
          "content_same": false
        },
        {
          "line": 3199,
          "old_api": "btr_index_rec_validate",
          "new_api": null,
          "old_text": "btr_index_rec_validate(rec, index,\n\t\t\t\t\t\t\t\tFALSE)",
          "new_text": null,
          "old_line_content": "\t\tif (!rec_validate(rec) || !btr_index_rec_validate(rec, index,",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 13,
      "total_additions": 59,
      "total_deletions": 59,
      "total_api_changes": 131
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 131,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          2778,
          2761,
          3090,
          2777
        ]
      }
    },
    "api_calls_before": 495,
    "api_calls_after": 495,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 2,
      "total_diff_lines": 32
    }
  }
}