diff --git a/sql/auth/sql_auth_cache.h b/sql/auth/sql_auth_cache.h
index 75d156e7ed4..aae519f50cc 100644
--- a/sql/auth/sql_auth_cache.h
+++ b/sql/auth/sql_auth_cache.h
@@ -143,7 +143,7 @@ class ACL_HOST_AND_IP {
 
   bool has_wildcard() {
     return (strchr(get_host(), wild_many) || strchr(get_host(), wild_one) ||
-            ip_mask);
+            (ip_mask && (ip_mask != (long)UINT_MAX32)));
   }
 
   bool check_allow_all_hosts() {
