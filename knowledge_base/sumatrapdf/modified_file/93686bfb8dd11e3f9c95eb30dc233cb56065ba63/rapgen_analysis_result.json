{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/sumatrapdf/modified_file/93686bfb8dd11e3f9c95eb30dc233cb56065ba63",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/sumatrapdf/modified_file/93686bfb8dd11e3f9c95eb30dc233cb56065ba63/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/sumatrapdf/modified_file/93686bfb8dd11e3f9c95eb30dc233cb56065ba63/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/sumatrapdf/modified_file/93686bfb8dd11e3f9c95eb30dc233cb56065ba63/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 719,
          "old_api": "fz_throw",
          "new_api": "fz_free",
          "old_text": "fz_throw(ctx, FZ_ERROR_GENERIC, \"scan conversion failed (malloc failure)\")",
          "new_text": "fz_free(ctx, deltas)",
          "old_line_content": "\t\tfz_throw(ctx, FZ_ERROR_GENERIC, \"scan conversion failed (malloc failure)\");",
          "new_line_content": "\t\tfz_free(ctx, deltas);",
          "content_same": false
        },
        {
          "line": 788,
          "old_api": "blit_aa",
          "new_api": "undelta_aa",
          "old_text": "blit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color)",
          "new_text": "undelta_aa(ctxaa, alphas, deltas, skipx + clipn)",
          "old_line_content": "\t\t\tblit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color);",
          "new_line_content": "\t\t\tundelta_aa(ctxaa, alphas, deltas, skipx + clipn);",
          "content_same": false
        },
        {
          "line": 789,
          "old_api": "memset",
          "new_api": "blit_aa",
          "old_text": "memset(deltas, 0, (skipx + clipn) * sizeof(int))",
          "new_text": "blit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color)",
          "old_line_content": "\t\t\tmemset(deltas, 0, (skipx + clipn) * sizeof(int));",
          "new_line_content": "\t\t\tblit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color);",
          "content_same": false
        },
        {
          "line": 810,
          "old_api": "undelta_aa",
          "new_api": "non_zero_winding_aa",
          "old_text": "undelta_aa(ctxaa, alphas, deltas, skipx + clipn)",
          "new_text": "non_zero_winding_aa(gel, deltas, xofs, rh)",
          "old_line_content": "\t\t\t\tundelta_aa(ctxaa, alphas, deltas, skipx + clipn);",
          "new_line_content": "\t\t\t\t\tnon_zero_winding_aa(gel, deltas, xofs, rh);",
          "content_same": false
        },
        {
          "line": 811,
          "old_api": "blit_aa",
          "new_api": "undelta_aa",
          "old_text": "blit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color)",
          "new_text": "undelta_aa(ctxaa, alphas, deltas, skipx + clipn)",
          "old_line_content": "\t\t\t\tblit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color);",
          "new_line_content": "\t\t\t\tundelta_aa(ctxaa, alphas, deltas, skipx + clipn);",
          "content_same": false
        },
        {
          "line": 812,
          "old_api": "memset",
          "new_api": "blit_aa",
          "old_text": "memset(deltas, 0, (skipx + clipn) * sizeof(int))",
          "new_text": "blit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color)",
          "old_line_content": "\t\t\t\tmemset(deltas, 0, (skipx + clipn) * sizeof(int));",
          "new_line_content": "\t\t\t\tblit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color);",
          "content_same": false
        },
        {
          "line": 827,
          "old_api": "undelta_aa",
          "new_api": "non_zero_winding_aa",
          "old_text": "undelta_aa(ctxaa, alphas, deltas, skipx + clipn)",
          "new_text": "non_zero_winding_aa(gel, deltas, xofs, fz_aa_vscale)",
          "old_line_content": "\t\t\t\tundelta_aa(ctxaa, alphas, deltas, skipx + clipn);",
          "new_line_content": "\t\t\t\t\tnon_zero_winding_aa(gel, deltas, xofs, fz_aa_vscale);",
          "content_same": false
        },
        {
          "line": 861,
          "old_api": "blit_aa",
          "new_api": "undelta_aa",
          "old_text": "blit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color)",
          "new_text": "undelta_aa(ctxaa, alphas, deltas, skipx + clipn)",
          "old_line_content": "\t\tblit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color);",
          "new_line_content": "\t\tundelta_aa(ctxaa, alphas, deltas, skipx + clipn);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 386,
          "old_api": null,
          "new_api": "fz_clamp",
          "old_text": null,
          "new_text": "fz_clamp(fy1, BBOX_MIN * fz_aa_vscale, BBOX_MAX * fz_aa_vscale)",
          "old_line_content": "",
          "new_line_content": "\ty1 = (int)fz_clamp(fy1, BBOX_MIN * fz_aa_vscale, BBOX_MAX * fz_aa_vscale);",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": null,
          "new_api": "clip_lerp_y",
          "old_text": null,
          "new_text": "clip_lerp_y(gel->clip.y0, 0, x0, y0, x1, y1, &v)",
          "old_line_content": "\tif (d == OUTSIDE) return;",
          "new_line_content": "\td = clip_lerp_y(gel->clip.y0, 0, x0, y0, x1, y1, &v);",
          "content_same": false
        },
        {
          "line": 645,
          "old_api": null,
          "new_api": "add_span_aa",
          "old_text": null,
          "new_text": "add_span_aa(ctxaa, list, x, gel->active[i]->x, xofs, h)",
          "old_line_content": "\t\twinding += gel->active[i]->ydir;",
          "new_line_content": "\t\t\tadd_span_aa(ctxaa, list, x, gel->active[i]->x, xofs, h);",
          "content_same": false
        },
        {
          "line": 773,
          "old_api": null,
          "new_api": "advance_active",
          "old_text": null,
          "new_text": "advance_active(gel, height)",
          "old_line_content": "",
          "new_line_content": "\t\tadvance_active(gel, height);",
          "content_same": false
        },
        {
          "line": 900,
          "old_api": null,
          "new_api": "blit_sharp",
          "old_text": null,
          "new_text": "blit_sharp(x, gel->active[i]->x, y, clip, dst, color)",
          "old_line_content": "\t\twinding += gel->active[i]->ydir;",
          "new_line_content": "\t\t\tblit_sharp(x, gel->active[i]->x, y, clip, dst, color);",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": null,
          "new_api": "clip_lerp_y",
          "old_text": null,
          "new_text": "clip_lerp_y(gel->clip.y1, 1, x0, y0, x1, y1, &v)",
          "old_line_content": "\tif (d == OUTSIDE) return;",
          "new_line_content": "\td = clip_lerp_y(gel->clip.y1, 1, x0, y0, x1, y1, &v);",
          "content_same": false
        },
        {
          "line": 781,
          "old_api": null,
          "new_api": "fz_idiv",
          "old_text": null,
          "new_text": "fz_idiv(y, fz_aa_vscale)",
          "old_line_content": "\t\t/* rh = remaining height = number of subscanlines left to be",
          "new_line_content": "\t\tyc = fz_idiv(y, fz_aa_vscale);\t/* yc = current scanline */",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": null,
          "new_api": "clip_lerp_x",
          "old_text": null,
          "new_text": "clip_lerp_x(gel->clip.x0, 0, x0, y0, x1, y1, &v)",
          "old_line_content": "\tif (d == OUTSIDE) {",
          "new_line_content": "\td = clip_lerp_x(gel->clip.x0, 0, x0, y0, x1, y1, &v);",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": null,
          "new_api": "fz_insert_gel_raw",
          "old_text": null,
          "new_text": "fz_insert_gel_raw(gel, gel->clip.x0, v, gel->clip.x0, y1)",
          "old_line_content": "\t\tx1 = gel->clip.x0;",
          "new_line_content": "\t\tfz_insert_gel_raw(gel, gel->clip.x0, v, gel->clip.x0, y1);",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": null,
          "new_api": "fz_resize_array",
          "old_text": null,
          "new_text": "fz_resize_array(gel->ctx, gel->active, newcap, sizeof(fz_edge*))",
          "old_line_content": "\t\t\t\tgel->active = newactive;",
          "new_line_content": "\t\t\t\tfz_edge **newactive = fz_resize_array(gel->ctx, gel->active, newcap, sizeof(fz_edge*));",
          "content_same": false
        },
        {
          "line": 916,
          "old_api": null,
          "new_api": "blit_sharp",
          "old_text": null,
          "new_text": "blit_sharp(x, gel->active[i]->x, y, clip, dst, color)",
          "old_line_content": "\t\teven = !even;",
          "new_line_content": "\t\t\tblit_sharp(x, gel->active[i]->x, y, clip, dst, color);",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": null,
          "new_api": "add_span_aa",
          "old_text": null,
          "new_text": "add_span_aa(ctxaa, list, x, gel->active[i]->x, xofs, h)",
          "old_line_content": "\t\teven = !even;",
          "new_line_content": "\t\t\tadd_span_aa(ctxaa, list, x, gel->active[i]->x, xofs, h);",
          "content_same": false
        },
        {
          "line": 790,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(deltas, 0, (skipx + clipn) * sizeof(int))",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tmemset(deltas, 0, (skipx + clipn) * sizeof(int));",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": null,
          "new_api": "fz_insert_gel_raw",
          "old_text": null,
          "new_text": "fz_insert_gel_raw(gel, gel->clip.x0, y0, gel->clip.x0, v)",
          "old_line_content": "\t\tx0 = gel->clip.x0;",
          "new_line_content": "\t\tfz_insert_gel_raw(gel, gel->clip.x0, y0, gel->clip.x0, v);",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": null,
          "new_api": "restrict",
          "old_text": null,
          "new_text": "restrict",
          "old_line_content": "{",
          "new_line_content": "static inline void undelta_aa(fz_aa_context *ctxaa, unsigned char * restrict out, int * restrict in, int n)",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": null,
          "new_api": "clip_lerp_x",
          "old_text": null,
          "new_text": "clip_lerp_x(gel->clip.x1, 1, x0, y0, x1, y1, &v)",
          "old_line_content": "\tif (d == OUTSIDE) {",
          "new_line_content": "\td = clip_lerp_x(gel->clip.x1, 1, x0, y0, x1, y1, &v);",
          "content_same": false
        },
        {
          "line": 798,
          "old_api": null,
          "new_api": "insert_active",
          "old_text": null,
          "new_text": "insert_active(gel, y, &e)",
          "old_line_content": "\t\th0 = height;",
          "new_line_content": "\t\theight = insert_active(gel, y, &e);",
          "content_same": false
        },
        {
          "line": 673,
          "old_api": null,
          "new_api": "AA_SCALE",
          "old_text": null,
          "new_text": "AA_SCALE(d)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t*out++ = AA_SCALE(d);",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": null,
          "new_api": "fz_insert_gel_raw",
          "old_text": null,
          "new_text": "fz_insert_gel_raw(gel, gel->clip.x1, v, gel->clip.x1, y1)",
          "old_line_content": "\t\tx1 = gel->clip.x1;",
          "new_line_content": "\t\tfz_insert_gel_raw(gel, gel->clip.x1, v, gel->clip.x1, y1);",
          "content_same": false
        },
        {
          "line": 423,
          "old_api": null,
          "new_api": "fz_insert_gel_raw",
          "old_text": null,
          "new_text": "fz_insert_gel_raw(gel, gel->clip.x1, y0, gel->clip.x1, v)",
          "old_line_content": "\t\tx0 = gel->clip.x1;",
          "new_line_content": "\t\tfz_insert_gel_raw(gel, gel->clip.x1, y0, gel->clip.x1, v);",
          "content_same": false
        },
        {
          "line": 808,
          "old_api": null,
          "new_api": "even_odd_aa",
          "old_text": null,
          "new_text": "even_odd_aa(gel, deltas, xofs, rh)",
          "old_line_content": "\t\t\t\telse",
          "new_line_content": "\t\t\t\t\teven_odd_aa(gel, deltas, xofs, rh);",
          "content_same": false
        },
        {
          "line": 936,
          "old_api": null,
          "new_api": "insert_active",
          "old_text": null,
          "new_text": "insert_active(gel, y, &e)",
          "old_line_content": "\t\t\ty += height;",
          "new_line_content": "\t\t\theight = insert_active(gel, y, &e);",
          "content_same": false
        },
        {
          "line": 683,
          "old_api": null,
          "new_api": "fz_paint_span_with_color",
          "old_text": null,
          "new_text": "fz_paint_span_with_color(dp, mp, dst->n, w, color)",
          "old_line_content": "\telse",
          "new_line_content": "\t\tfz_paint_span_with_color(dp, mp, dst->n, w, color);",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": null,
          "new_api": "fz_insert_gel_raw",
          "old_text": null,
          "new_text": "fz_insert_gel_raw(gel, x0, y0, x1, y1)",
          "old_line_content": "}",
          "new_line_content": "\tfz_insert_gel_raw(gel, x0, y0, x1, y1);",
          "content_same": false
        },
        {
          "line": 685,
          "old_api": null,
          "new_api": "fz_paint_span",
          "old_text": null,
          "new_text": "fz_paint_span(dp, mp, 1, w, 255)",
          "old_line_content": "}",
          "new_line_content": "\t\tfz_paint_span(dp, mp, 1, w, 255);",
          "content_same": false
        },
        {
          "line": 813,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(deltas, 0, (skipx + clipn) * sizeof(int))",
          "old_line_content": "\t\t\t\tyd++;",
          "new_line_content": "\t\t\t\tmemset(deltas, 0, (skipx + clipn) * sizeof(int));",
          "content_same": false
        },
        {
          "line": 560,
          "old_api": null,
          "new_api": "sort_active",
          "old_text": null,
          "new_text": "sort_active(gel->active, gel->alen)",
          "old_line_content": "",
          "new_line_content": "\tsort_active(gel->active, gel->alen);",
          "content_same": false
        },
        {
          "line": 949,
          "old_api": null,
          "new_api": "insert_active",
          "old_text": null,
          "new_text": "insert_active(gel, y, &e)",
          "old_line_content": "",
          "new_line_content": "\t\theight = insert_active(gel, y, &e);",
          "content_same": false
        },
        {
          "line": 825,
          "old_api": null,
          "new_api": "even_odd_aa",
          "old_text": null,
          "new_text": "even_odd_aa(gel, deltas, xofs, fz_aa_vscale)",
          "old_line_content": "\t\t\t\telse",
          "new_line_content": "\t\t\t\t\teven_odd_aa(gel, deltas, xofs, fz_aa_vscale);",
          "content_same": false
        },
        {
          "line": 828,
          "old_api": null,
          "new_api": "undelta_aa",
          "old_text": null,
          "new_text": "undelta_aa(ctxaa, alphas, deltas, skipx + clipn)",
          "old_line_content": "\t\t\t\tdo",
          "new_line_content": "\t\t\t\tundelta_aa(ctxaa, alphas, deltas, skipx + clipn);",
          "content_same": false
        },
        {
          "line": 701,
          "old_api": null,
          "new_api": "fz_idiv",
          "old_text": null,
          "new_text": "fz_idiv(gel->bbox.x1, fz_aa_hscale)",
          "old_line_content": "",
          "new_line_content": "\tint xmax = fz_idiv(gel->bbox.x1, fz_aa_hscale) + 1;",
          "content_same": false
        },
        {
          "line": 833,
          "old_api": null,
          "new_api": "blit_aa",
          "old_text": null,
          "new_text": "blit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color)",
          "old_line_content": "\t\t\t\t\tyd++;",
          "new_line_content": "\t\t\t\t\tblit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color);",
          "content_same": false
        },
        {
          "line": 963,
          "old_api": null,
          "new_api": "even_odd_sharp",
          "old_text": null,
          "new_text": "even_odd_sharp(gel, y, clip, dst, color)",
          "old_line_content": "\t\t\t\telse",
          "new_line_content": "\t\t\t\t\teven_odd_sharp(gel, y, clip, dst, color);",
          "content_same": false
        },
        {
          "line": 965,
          "old_api": null,
          "new_api": "non_zero_winding_sharp",
          "old_text": null,
          "new_text": "non_zero_winding_sharp(gel, y, clip, dst, color)",
          "old_line_content": "\t\t\t\ty++;",
          "new_line_content": "\t\t\t\t\tnon_zero_winding_sharp(gel, y, clip, dst, color);",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(clip->x1 <= xmax)",
          "old_line_content": "",
          "new_line_content": "\tassert(clip->x1 <= xmax);",
          "content_same": false
        },
        {
          "line": 715,
          "old_api": null,
          "new_api": "fz_malloc_no_throw",
          "old_text": null,
          "new_text": "fz_malloc_no_throw(ctx, (xmax - xmin + 1) * sizeof(int))",
          "old_line_content": "\tif (alphas == NULL || deltas == NULL)",
          "new_line_content": "\tdeltas = fz_malloc_no_throw(ctx, (xmax - xmin + 1) * sizeof(int));",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": null,
          "new_api": "fz_resize_array",
          "old_text": null,
          "new_text": "fz_resize_array(gel->ctx, gel->edges, new_cap, sizeof(fz_edge))",
          "old_line_content": "\t\tgel->cap = new_cap;",
          "new_line_content": "\t\tgel->edges = fz_resize_array(gel->ctx, gel->edges, new_cap, sizeof(fz_edge));",
          "content_same": false
        },
        {
          "line": 845,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(deltas, 0, (skipx + clipn) * sizeof(int))",
          "old_line_content": "\t\t\t\th0 += fz_aa_vscale;",
          "new_line_content": "\t\t\t\tmemset(deltas, 0, (skipx + clipn) * sizeof(int));",
          "content_same": false
        },
        {
          "line": 972,
          "old_api": null,
          "new_api": "advance_active",
          "old_text": null,
          "new_text": "advance_active(gel, height)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tadvance_active(gel, height);",
          "content_same": false
        },
        {
          "line": 720,
          "old_api": null,
          "new_api": "fz_throw",
          "old_text": null,
          "new_text": "fz_throw(ctx, FZ_ERROR_GENERIC, \"scan conversion failed (malloc failure)\")",
          "old_line_content": "\t}",
          "new_line_content": "\t\tfz_throw(ctx, FZ_ERROR_GENERIC, \"scan conversion failed (malloc failure)\");",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(deltas, 0, (xmax - xmin + 1) * sizeof(int))",
          "old_line_content": "\tgel->alen = 0;",
          "new_line_content": "\tmemset(deltas, 0, (xmax - xmin + 1) * sizeof(int));",
          "content_same": false
        },
        {
          "line": 850,
          "old_api": null,
          "new_api": "even_odd_aa",
          "old_text": null,
          "new_text": "even_odd_aa(gel, deltas, xofs, h0)",
          "old_line_content": "\t\telse",
          "new_line_content": "\t\t\teven_odd_aa(gel, deltas, xofs, h0);",
          "content_same": false
        },
        {
          "line": 339,
          "old_api": null,
          "new_api": "fz_absi",
          "old_text": null,
          "new_text": "fz_absi(dx)",
          "old_line_content": "",
          "new_line_content": "\twidth = fz_absi(dx);",
          "content_same": false
        },
        {
          "line": 852,
          "old_api": null,
          "new_api": "non_zero_winding_aa",
          "old_text": null,
          "new_text": "non_zero_winding_aa(gel, deltas, xofs, h0)",
          "old_line_content": "advance:",
          "new_line_content": "\t\t\tnon_zero_winding_aa(gel, deltas, xofs, h0);",
          "content_same": false
        },
        {
          "line": 854,
          "old_api": null,
          "new_api": "advance_active",
          "old_text": null,
          "new_text": "advance_active(gel, height)",
          "old_line_content": "",
          "new_line_content": "\t\tadvance_active(gel, height);",
          "content_same": false
        },
        {
          "line": 983,
          "old_api": null,
          "new_api": "fz_pixmap_bbox_no_ctx",
          "old_text": null,
          "new_text": "fz_pixmap_bbox_no_ctx(dst, &local_clip)",
          "old_line_content": "\t\treturn;",
          "new_line_content": "\tif (fz_is_empty_irect(fz_intersect_irect(fz_pixmap_bbox_no_ctx(dst, &local_clip), clip)))",
          "content_same": false
        },
        {
          "line": 987,
          "old_api": null,
          "new_api": "fz_scan_convert_aa",
          "old_text": null,
          "new_text": "fz_scan_convert_aa(gel, eofill, &local_clip, dst, color)",
          "old_line_content": "\telse",
          "new_line_content": "\t\tfz_scan_convert_aa(gel, eofill, &local_clip, dst, color);",
          "content_same": false
        },
        {
          "line": 989,
          "old_api": null,
          "new_api": "fz_scan_convert_sharp",
          "old_text": null,
          "new_text": "fz_scan_convert_sharp(gel, eofill, &local_clip, dst, color)",
          "old_line_content": "}",
          "new_line_content": "\t\tfz_scan_convert_sharp(gel, eofill, &local_clip, dst, color);",
          "content_same": false
        },
        {
          "line": 862,
          "old_api": null,
          "new_api": "blit_aa",
          "old_text": null,
          "new_text": "blit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tblit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color);",
          "content_same": false
        },
        {
          "line": 866,
          "old_api": null,
          "new_api": "fz_free",
          "old_text": null,
          "new_text": "fz_free(ctx, alphas)",
          "old_line_content": "}",
          "new_line_content": "\tfz_free(ctx, alphas);",
          "content_same": false
        },
        {
          "line": 739,
          "old_api": null,
          "new_api": "fz_idiv",
          "old_text": null,
          "new_text": "fz_idiv(y, fz_aa_vscale)",
          "old_line_content": "",
          "new_line_content": "\tyd = fz_idiv(y, fz_aa_vscale);",
          "content_same": false
        },
        {
          "line": 878,
          "old_api": null,
          "new_api": "fz_clampi",
          "old_text": null,
          "new_text": "fz_clampi(x1, dst->x, dst->x + dst->w)",
          "old_line_content": "\tif (x0 < x1)",
          "new_line_content": "\tx1 = fz_clampi(x1, dst->x, dst->x + dst->w);",
          "content_same": false
        },
        {
          "line": 751,
          "old_api": null,
          "new_api": "insert_active",
          "old_text": null,
          "new_text": "insert_active(gel, y, &e)",
          "old_line_content": "\t\th0 = height;",
          "new_line_content": "\t\theight = insert_active(gel, y, &e);",
          "content_same": false
        },
        {
          "line": 883,
          "old_api": null,
          "new_api": "fz_paint_solid_color",
          "old_text": null,
          "new_text": "fz_paint_solid_color(dp, dst->n, x1 - x0, color)",
          "old_line_content": "\t\telse",
          "new_line_content": "\t\t\tfz_paint_solid_color(dp, dst->n, x1 - x0, color);",
          "content_same": false
        },
        {
          "line": 885,
          "old_api": null,
          "new_api": "fz_paint_solid_alpha",
          "old_text": null,
          "new_text": "fz_paint_solid_alpha(dp, x1 - x0, 255)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tfz_paint_solid_alpha(dp, x1 - x0, 255);",
          "content_same": false
        },
        {
          "line": 377,
          "old_api": null,
          "new_api": "floorf",
          "old_text": null,
          "new_text": "floorf(fy1 * fz_aa_vscale)",
          "old_line_content": "",
          "new_line_content": "\tfy1 = floorf(fy1 * fz_aa_vscale);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 387,
          "old_api": "clip_lerp_y",
          "new_api": null,
          "old_text": "clip_lerp_y(gel->clip.y0, 0, x0, y0, x1, y1, &v)",
          "new_text": null,
          "old_line_content": "\td = clip_lerp_y(gel->clip.y0, 0, x0, y0, x1, y1, &v);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": "add_span_aa",
          "new_api": null,
          "old_text": "add_span_aa(ctxaa, list, x, gel->active[i]->x, xofs, h)",
          "new_text": null,
          "old_line_content": "\t\t\tadd_span_aa(ctxaa, list, x, gel->active[i]->x, xofs, h);",
          "new_line_content": "\t\tif (winding && !(winding + gel->active[i]->ydir))",
          "content_same": false
        },
        {
          "line": 772,
          "old_api": "advance_active",
          "new_api": null,
          "old_text": "advance_active(gel, height)",
          "new_text": null,
          "old_line_content": "\t\tadvance_active(gel, height);",
          "new_line_content": "\t\theight -= h0;",
          "content_same": false
        },
        {
          "line": 899,
          "old_api": "blit_sharp",
          "new_api": null,
          "old_text": "blit_sharp(x, gel->active[i]->x, y, clip, dst, color)",
          "new_text": null,
          "old_line_content": "\t\t\tblit_sharp(x, gel->active[i]->x, y, clip, dst, color);",
          "new_line_content": "\t\tif (winding && !(winding + gel->active[i]->ydir))",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": "clip_lerp_y",
          "new_api": null,
          "old_text": "clip_lerp_y(gel->clip.y1, 1, x0, y0, x1, y1, &v)",
          "new_text": null,
          "old_line_content": "\td = clip_lerp_y(gel->clip.y1, 1, x0, y0, x1, y1, &v);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 780,
          "old_api": "fz_idiv",
          "new_api": null,
          "old_text": "fz_idiv(y, fz_aa_vscale)",
          "new_text": null,
          "old_line_content": "\t\tyc = fz_idiv(y, fz_aa_vscale);\t/* yc = current scanline */",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": "clip_lerp_x",
          "new_api": null,
          "old_text": "clip_lerp_x(gel->clip.x0, 0, x0, y0, x1, y1, &v)",
          "new_text": null,
          "old_line_content": "\td = clip_lerp_x(gel->clip.x0, 0, x0, y0, x1, y1, &v);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": "fz_insert_gel_raw",
          "new_api": null,
          "old_text": "fz_insert_gel_raw(gel, gel->clip.x0, v, gel->clip.x0, y1)",
          "new_text": null,
          "old_line_content": "\t\tfz_insert_gel_raw(gel, gel->clip.x0, v, gel->clip.x0, y1);",
          "new_line_content": "\tif (d == LEAVE) {",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": "fz_resize_array",
          "new_api": null,
          "old_text": "fz_resize_array(gel->ctx, gel->active, newcap, sizeof(fz_edge*))",
          "new_text": null,
          "old_line_content": "\t\t\t\tfz_edge **newactive = fz_resize_array(gel->ctx, gel->active, newcap, sizeof(fz_edge*));",
          "new_line_content": "\t\t\t\tint newcap = gel->acap + 64;",
          "content_same": false
        },
        {
          "line": 787,
          "old_api": "undelta_aa",
          "new_api": null,
          "old_text": "undelta_aa(ctxaa, alphas, deltas, skipx + clipn)",
          "new_text": null,
          "old_line_content": "\t\t\tundelta_aa(ctxaa, alphas, deltas, skipx + clipn);",
          "new_line_content": "\t\t{",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": "add_span_aa",
          "new_api": null,
          "old_text": "add_span_aa(ctxaa, list, x, gel->active[i]->x, xofs, h)",
          "new_text": null,
          "old_line_content": "\t\t\tadd_span_aa(ctxaa, list, x, gel->active[i]->x, xofs, h);",
          "new_line_content": "\t\telse",
          "content_same": false
        },
        {
          "line": 915,
          "old_api": "blit_sharp",
          "new_api": null,
          "old_text": "blit_sharp(x, gel->active[i]->x, y, clip, dst, color)",
          "new_text": null,
          "old_line_content": "\t\t\tblit_sharp(x, gel->active[i]->x, y, clip, dst, color);",
          "new_line_content": "\t\telse",
          "content_same": false
        },
        {
          "line": 407,
          "old_api": "fz_insert_gel_raw",
          "new_api": null,
          "old_text": "fz_insert_gel_raw(gel, gel->clip.x0, y0, gel->clip.x0, v)",
          "new_text": null,
          "old_line_content": "\t\tfz_insert_gel_raw(gel, gel->clip.x0, y0, gel->clip.x0, v);",
          "new_line_content": "\tif (d == ENTER) {",
          "content_same": false
        },
        {
          "line": 666,
          "old_api": "restrict",
          "new_api": null,
          "old_text": "restrict",
          "new_text": null,
          "old_line_content": "static inline void undelta_aa(fz_aa_context *ctxaa, unsigned char * restrict out, int * restrict in, int n)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": "clip_lerp_x",
          "new_api": null,
          "old_text": "clip_lerp_x(gel->clip.x1, 1, x0, y0, x1, y1, &v)",
          "new_text": null,
          "old_line_content": "\td = clip_lerp_x(gel->clip.x1, 1, x0, y0, x1, y1, &v);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 797,
          "old_api": "insert_active",
          "new_api": null,
          "old_text": "insert_active(gel, y, &e)",
          "new_text": null,
          "old_line_content": "\t\theight = insert_active(gel, y, &e);",
          "new_line_content": "\t\t * positions (i.e. 1 if we have any non vertical edges). */",
          "content_same": false
        },
        {
          "line": 672,
          "old_api": "AA_SCALE",
          "new_api": null,
          "old_text": "AA_SCALE(d)",
          "new_text": null,
          "old_line_content": "\t\t*out++ = AA_SCALE(d);",
          "new_line_content": "\t\td += *in++;",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": "fz_insert_gel_raw",
          "new_api": null,
          "old_text": "fz_insert_gel_raw(gel, gel->clip.x1, v, gel->clip.x1, y1)",
          "new_text": null,
          "old_line_content": "\t\tfz_insert_gel_raw(gel, gel->clip.x1, v, gel->clip.x1, y1);",
          "new_line_content": "\tif (d == LEAVE) {",
          "content_same": false
        },
        {
          "line": 422,
          "old_api": "fz_insert_gel_raw",
          "new_api": null,
          "old_text": "fz_insert_gel_raw(gel, gel->clip.x1, y0, gel->clip.x1, v)",
          "new_text": null,
          "old_line_content": "\t\tfz_insert_gel_raw(gel, gel->clip.x1, y0, gel->clip.x1, v);",
          "new_line_content": "\tif (d == ENTER) {",
          "content_same": false
        },
        {
          "line": 807,
          "old_api": "even_odd_aa",
          "new_api": null,
          "old_text": "even_odd_aa(gel, deltas, xofs, rh)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\teven_odd_aa(gel, deltas, xofs, rh);",
          "new_line_content": "\t\t\t\tif (eofill)",
          "content_same": false
        },
        {
          "line": 935,
          "old_api": "insert_active",
          "new_api": null,
          "old_text": "insert_active(gel, y, &e)",
          "new_text": null,
          "old_line_content": "\t\t\theight = insert_active(gel, y, &e);",
          "new_line_content": "\t\t{",
          "content_same": false
        },
        {
          "line": 809,
          "old_api": "non_zero_winding_aa",
          "new_api": null,
          "old_text": "non_zero_winding_aa(gel, deltas, xofs, rh)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tnon_zero_winding_aa(gel, deltas, xofs, rh);",
          "new_line_content": "\t\t\t\telse",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": "fz_paint_span_with_color",
          "new_api": null,
          "old_text": "fz_paint_span_with_color(dp, mp, dst->n, w, color)",
          "new_text": null,
          "old_line_content": "\t\tfz_paint_span_with_color(dp, mp, dst->n, w, color);",
          "new_line_content": "\tif (color)",
          "content_same": false
        },
        {
          "line": 427,
          "old_api": "fz_insert_gel_raw",
          "new_api": null,
          "old_text": "fz_insert_gel_raw(gel, x0, y0, x1, y1)",
          "new_text": null,
          "old_line_content": "\tfz_insert_gel_raw(gel, x0, y0, x1, y1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 684,
          "old_api": "fz_paint_span",
          "new_api": null,
          "old_text": "fz_paint_span(dp, mp, 1, w, 255)",
          "new_text": null,
          "old_line_content": "\t\tfz_paint_span(dp, mp, 1, w, 255);",
          "new_line_content": "\telse",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": "sort_active",
          "new_api": null,
          "old_text": "sort_active(gel->active, gel->alen)",
          "new_text": null,
          "old_line_content": "\tsort_active(gel->active, gel->alen);",
          "new_line_content": "\t/* shell-sort the edges by increasing x */",
          "content_same": false
        },
        {
          "line": 948,
          "old_api": "insert_active",
          "new_api": null,
          "old_text": "insert_active(gel, y, &e)",
          "new_text": null,
          "old_line_content": "\t\theight = insert_active(gel, y, &e);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 824,
          "old_api": "even_odd_aa",
          "new_api": null,
          "old_text": "even_odd_aa(gel, deltas, xofs, fz_aa_vscale)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\teven_odd_aa(gel, deltas, xofs, fz_aa_vscale);",
          "new_line_content": "\t\t\t\tif (eofill)",
          "content_same": false
        },
        {
          "line": 826,
          "old_api": "non_zero_winding_aa",
          "new_api": null,
          "old_text": "non_zero_winding_aa(gel, deltas, xofs, fz_aa_vscale)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tnon_zero_winding_aa(gel, deltas, xofs, fz_aa_vscale);",
          "new_line_content": "\t\t\t\telse",
          "content_same": false
        },
        {
          "line": 699,
          "old_api": "fz_idiv",
          "new_api": null,
          "old_text": "fz_idiv(gel->bbox.x0, fz_aa_hscale)",
          "new_text": null,
          "old_line_content": "\tint xmin = fz_idiv(gel->bbox.x0, fz_aa_hscale);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 832,
          "old_api": "blit_aa",
          "new_api": null,
          "old_text": "blit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tblit_aa(dst, xmin + skipx, yd, alphas + skipx, clipn, color);",
          "new_line_content": "\t\t\t\t\t * to recalculate deltas here. */",
          "content_same": false
        },
        {
          "line": 962,
          "old_api": "even_odd_sharp",
          "new_api": null,
          "old_text": "even_odd_sharp(gel, y, clip, dst, color)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\teven_odd_sharp(gel, y, clip, dst, color);",
          "new_line_content": "\t\t\t\tif (eofill)",
          "content_same": false
        },
        {
          "line": 964,
          "old_api": "non_zero_winding_sharp",
          "new_api": null,
          "old_text": "non_zero_winding_sharp(gel, y, clip, dst, color)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tnon_zero_winding_sharp(gel, y, clip, dst, color);",
          "new_line_content": "\t\t\t\telse",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(clip->x0 >= xmin)",
          "new_text": null,
          "old_line_content": "\tassert(clip->x0 >= xmin);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 713,
          "old_api": "fz_malloc_no_throw",
          "new_api": null,
          "old_text": "fz_malloc_no_throw(ctx, xmax - xmin + 1)",
          "new_text": null,
          "old_line_content": "\talphas = fz_malloc_no_throw(ctx, xmax - xmin + 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": "fz_resize_array",
          "new_api": null,
          "old_text": "fz_resize_array(gel->ctx, gel->edges, new_cap, sizeof(fz_edge))",
          "new_text": null,
          "old_line_content": "\t\tgel->edges = fz_resize_array(gel->ctx, gel->edges, new_cap, sizeof(fz_edge));",
          "new_line_content": "\t\tint new_cap = gel->cap * 2;",
          "content_same": false
        },
        {
          "line": 971,
          "old_api": "advance_active",
          "new_api": null,
          "old_text": "advance_active(gel, height)",
          "new_text": null,
          "old_line_content": "\t\tadvance_active(gel, height);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 844,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(deltas, 0, (skipx + clipn) * sizeof(int))",
          "new_text": null,
          "old_line_content": "\t\t\t\tmemset(deltas, 0, (skipx + clipn) * sizeof(int));",
          "new_line_content": "\t\t\t\t\tgoto advance;",
          "content_same": false
        },
        {
          "line": 717,
          "old_api": "fz_free",
          "new_api": null,
          "old_text": "fz_free(ctx, alphas)",
          "new_text": null,
          "old_line_content": "\t\tfz_free(ctx, alphas);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(deltas, 0, (xmax - xmin + 1) * sizeof(int))",
          "new_text": null,
          "old_line_content": "\tmemset(deltas, 0, (xmax - xmin + 1) * sizeof(int));",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 849,
          "old_api": "even_odd_aa",
          "new_api": null,
          "old_text": "even_odd_aa(gel, deltas, xofs, h0)",
          "new_text": null,
          "old_line_content": "\t\t\teven_odd_aa(gel, deltas, xofs, h0);",
          "new_line_content": "\t\tif (eofill)",
          "content_same": false
        },
        {
          "line": 338,
          "old_api": "fz_absi",
          "new_api": null,
          "old_text": "fz_absi(dx)",
          "new_text": null,
          "old_line_content": "\twidth = fz_absi(dx);",
          "new_line_content": "\tdx = x1 - x0;",
          "content_same": false
        },
        {
          "line": 851,
          "old_api": "non_zero_winding_aa",
          "new_api": null,
          "old_text": "non_zero_winding_aa(gel, deltas, xofs, h0)",
          "new_text": null,
          "old_line_content": "\t\t\tnon_zero_winding_aa(gel, deltas, xofs, h0);",
          "new_line_content": "\t\telse",
          "content_same": false
        },
        {
          "line": 853,
          "old_api": "advance_active",
          "new_api": null,
          "old_text": "advance_active(gel, height)",
          "new_text": null,
          "old_line_content": "\t\tadvance_active(gel, height);",
          "new_line_content": "advance:",
          "content_same": false
        },
        {
          "line": 982,
          "old_api": "fz_pixmap_bbox_no_ctx",
          "new_api": null,
          "old_text": "fz_pixmap_bbox_no_ctx(dst, &local_clip)",
          "new_text": null,
          "old_line_content": "\tif (fz_is_empty_irect(fz_intersect_irect(fz_pixmap_bbox_no_ctx(dst, &local_clip), clip)))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 986,
          "old_api": "fz_scan_convert_aa",
          "new_api": null,
          "old_text": "fz_scan_convert_aa(gel, eofill, &local_clip, dst, color)",
          "new_text": null,
          "old_line_content": "\t\tfz_scan_convert_aa(gel, eofill, &local_clip, dst, color);",
          "new_line_content": "\tif (fz_aa_bits > 0)",
          "content_same": false
        },
        {
          "line": 860,
          "old_api": "undelta_aa",
          "new_api": null,
          "old_text": "undelta_aa(ctxaa, alphas, deltas, skipx + clipn)",
          "new_text": null,
          "old_line_content": "\t\tundelta_aa(ctxaa, alphas, deltas, skipx + clipn);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 988,
          "old_api": "fz_scan_convert_sharp",
          "new_api": null,
          "old_text": "fz_scan_convert_sharp(gel, eofill, &local_clip, dst, color)",
          "new_text": null,
          "old_line_content": "\t\tfz_scan_convert_sharp(gel, eofill, &local_clip, dst, color);",
          "new_line_content": "\telse",
          "content_same": false
        },
        {
          "line": 864,
          "old_api": "fz_free",
          "new_api": null,
          "old_text": "fz_free(ctx, deltas)",
          "new_text": null,
          "old_line_content": "\tfz_free(ctx, deltas);",
          "new_line_content": "clip_ended:",
          "content_same": false
        },
        {
          "line": 738,
          "old_api": "fz_idiv",
          "new_api": null,
          "old_text": "fz_idiv(y, fz_aa_vscale)",
          "new_text": null,
          "old_line_content": "\tyd = fz_idiv(y, fz_aa_vscale);",
          "new_line_content": "\ty = gel->edges[0].y;",
          "content_same": false
        },
        {
          "line": 876,
          "old_api": "fz_clampi",
          "new_api": null,
          "old_text": "fz_clampi(x0, dst->x, dst->x + dst->w)",
          "new_text": null,
          "old_line_content": "\tx0 = fz_clampi(x0, dst->x, dst->x + dst->w);",
          "new_line_content": "\tunsigned char *dp;",
          "content_same": false
        },
        {
          "line": 750,
          "old_api": "insert_active",
          "new_api": null,
          "old_text": "insert_active(gel, y, &e)",
          "new_text": null,
          "old_line_content": "\t\theight = insert_active(gel, y, &e);",
          "new_line_content": "\t\t * positions (i.e. 1 if we have any non vertical edges). */",
          "content_same": false
        },
        {
          "line": 882,
          "old_api": "fz_paint_solid_color",
          "new_api": null,
          "old_text": "fz_paint_solid_color(dp, dst->n, x1 - x0, color)",
          "new_text": null,
          "old_line_content": "\t\t\tfz_paint_solid_color(dp, dst->n, x1 - x0, color);",
          "new_line_content": "\t\tif (color)",
          "content_same": false
        },
        {
          "line": 884,
          "old_api": "fz_paint_solid_alpha",
          "new_api": null,
          "old_text": "fz_paint_solid_alpha(dp, x1 - x0, 255)",
          "new_text": null,
          "old_line_content": "\t\t\tfz_paint_solid_alpha(dp, x1 - x0, 255);",
          "new_line_content": "\t\telse",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": "floorf",
          "new_api": null,
          "old_text": "floorf(fx0 * fz_aa_hscale)",
          "new_text": null,
          "old_line_content": "\tfx0 = floorf(fx0 * fz_aa_hscale);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": "fz_clamp",
          "new_api": null,
          "old_text": "fz_clamp(fx0, BBOX_MIN * fz_aa_hscale, BBOX_MAX * fz_aa_hscale)",
          "new_text": null,
          "old_line_content": "\tx0 = (int)fz_clamp(fx0, BBOX_MIN * fz_aa_hscale, BBOX_MAX * fz_aa_hscale);",
          "new_line_content": "\t * over/underflowing and flipping sign at extreme values. */",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 8,
      "total_additions": 56,
      "total_deletions": 56,
      "total_api_changes": 120
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 120,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          329
        ]
      }
    },
    "api_calls_before": 97,
    "api_calls_after": 97,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 1,
      "total_diff_lines": 15
    }
  }
}