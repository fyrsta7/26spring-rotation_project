diff --git a/src/utils/StrUtil.cpp b/src/utils/StrUtil.cpp
index 9a31a2180..bc0c97ed0 100644
--- a/src/utils/StrUtil.cpp
+++ b/src/utils/StrUtil.cpp
@@ -1155,13 +1155,14 @@ Failure:
     return NULL;
 }
 
-size_t Utf8ToWcharBuf(const char *s, size_t sLen, WCHAR *bufOut, size_t cchBufOutSize)
+size_t Utf8ToWcharBuf(const char *s, size_t cbLen, WCHAR *bufOut, size_t cchBufOutSize)
 {
     CrashIf(0 == cchBufOutSize);
-    int cchConverted = MultiByteToWideChar(CP_UTF8, 0, s, (int)sLen, NULL, 0);
-    if ((size_t)cchConverted >= cchBufOutSize)
+    int iCbLen = (int)cbLen;
+    int cchConverted = MultiByteToWideChar(CP_UTF8, 0, s, iCbLen, bufOut, cchBufOutSize);
+    if ((size_t)cchConverted >= cchBufOutSize) {
         cchConverted = (int)cchBufOutSize - 1;
-    MultiByteToWideChar(CP_UTF8, 0, s, (int)sLen, bufOut, cchConverted);
+    }
     bufOut[cchConverted] = '\0';
     return cchConverted;
 }
