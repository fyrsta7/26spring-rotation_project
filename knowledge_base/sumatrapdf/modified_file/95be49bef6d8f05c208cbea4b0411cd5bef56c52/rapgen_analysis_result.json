{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/sumatrapdf/modified_file/95be49bef6d8f05c208cbea4b0411cd5bef56c52",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/sumatrapdf/modified_file/95be49bef6d8f05c208cbea4b0411cd5bef56c52/before.h",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/sumatrapdf/modified_file/95be49bef6d8f05c208cbea4b0411cd5bef56c52/after.h",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/sumatrapdf/modified_file/95be49bef6d8f05c208cbea4b0411cd5bef56c52/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [],
      "additions": [
        {
          "line": 481,
          "old_api": null,
          "new_api": "hash == hash",
          "old_text": null,
          "new_text": "hash == hash ",
          "old_line_content": "        return count;",
          "new_line_content": "        return items.At(idx).string;",
          "content_same": false
        },
        {
          "line": 515,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "",
          "new_line_content": "        return -1 != Find(str);",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": null,
          "new_api": "*item = items.Lend",
          "old_text": null,
          "new_text": "*item = items.Lend",
          "old_line_content": "    int Find(const WCHAR *str, size_t startAt=0) const {",
          "new_line_content": "        items.Append(Item(str, GetQuickHashI(str)));",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "    }",
          "new_line_content": "            if (item[i].hash == hash && str::EqI(item[i].string, str))",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": null,
          "new_api": "].string, str))",
          "old_text": null,
          "new_text": "].string, str))\n  ",
          "old_line_content": "                return (int)i;",
          "new_line_content": "        uint32_t hash = GetQuickHashI(str);",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": null,
          "new_api": "t)i;\n        }",
          "old_text": null,
          "new_text": "t)i;\n        }\n ",
          "old_line_content": "        }",
          "new_line_content": "        Item *item = items.LendData();",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": null,
          "new_api": "str);\n    }\n};",
          "old_text": null,
          "new_text": "str);\n    }\n};\n",
          "old_line_content": "    }",
          "new_line_content": "            if (item[i].hash == hash && str::Eq(item[i].string, str))",
          "content_same": false
        },
        {
          "line": 505,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "                return (int)i;",
          "new_line_content": "        uint32_t hash = GetQuickHashI(str);",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "        }",
          "new_line_content": "        Item *item = items.LendData();",
          "content_same": false
        },
        {
          "line": 475,
          "old_api": null,
          "new_api": "uint32_t hash",
          "old_text": null,
          "new_text": "  uint32_t hash ",
          "old_line_content": "",
          "new_line_content": "        for (Item *item = items.IterStart(); item; item = items.IterNext()) {",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": null,
          "new_api": "tr);\n        Item *item = items.LendData",
          "old_text": null,
          "new_text": "tr);\n        Item *item = items.LendData",
          "old_line_content": "    const WCHAR *At(size_t idx) const {",
          "new_line_content": "            Allocator::Free(allocator, item->string);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 486,
          "old_api": "tem *item = items.",
          "new_api": null,
          "old_text": "tem *item = items.",
          "new_text": null,
          "old_line_content": "        items.Append(Item(str, GetQuickHashI(str)));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": "or",
          "new_api": null,
          "old_text": "or(allocator) { }\n\n   ",
          "new_text": null,
          "old_line_content": "            uint32_t bits = (crc ^ ((towlower((wint_t)*str) & 0xFF) << 24)) & 0xFF000000L;",
          "new_line_content": "            if ((c & 0xFF80))",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "            if (item[i].hash == hash && str::EqI(item[i].string, str))",
          "new_line_content": "    int FindI(const WCHAR *str, size_t startAt=0) const {",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": "em[i].string, str)",
          "new_api": null,
          "old_text": "em[i].string, str)",
          "new_text": null,
          "old_line_content": "        uint32_t hash = GetQuickHashI(str);",
          "new_line_content": "        count++;",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": "(int)i;",
          "new_api": null,
          "old_text": " (int)i;\n       ",
          "new_text": null,
          "old_line_content": "        Item *item = items.LendData();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": "ind",
          "new_api": null,
          "old_text": "ind(str);\n    }\n};\n",
          "new_text": null,
          "old_line_content": "            if (item[i].hash == hash && str::Eq(item[i].string, str))",
          "new_line_content": "    int Find(const WCHAR *str, size_t startAt=0) const {",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        uint32_t hash = GetQuickHashI(str);",
          "new_line_content": "        return -1;",
          "content_same": false
        },
        {
          "line": 502,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        Item *item = items.LendData();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": "uint32_t h",
          "new_api": null,
          "old_text": "      uint32_t h",
          "new_text": null,
          "old_line_content": "        for (Item *item = items.IterStart(); item; item = items.IterNext()) {",
          "new_line_content": "    WStrList(size_t capHint=0, Allocator *allocator=NULL) :",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": "hI",
          "new_api": null,
          "old_text": "hI(str);\n        Item *item = items.Lend",
          "new_text": null,
          "old_line_content": "            Allocator::Free(allocator, item->string);",
          "new_line_content": "        items(capHint, allocator), count(0), allocator(allocator) { }",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": "[i].hash == h",
          "new_api": null,
          "old_text": "[i].hash == h",
          "new_text": null,
          "old_line_content": "        return items.At(idx).string;",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 511,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        return -1 != Find(str);",
          "new_line_content": "        return -1;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 0,
      "total_additions": 11,
      "total_deletions": 12,
      "total_api_changes": 23
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 6,
        "api_related_lines": 23,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          453,
          455,
          456,
          457,
          458
        ]
      }
    },
    "api_calls_before": 113,
    "api_calls_after": 112,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 2,
      "total_diff_lines": 20
    }
  }
}