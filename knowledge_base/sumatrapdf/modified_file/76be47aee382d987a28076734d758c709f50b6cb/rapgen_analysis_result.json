{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/sumatrapdf/modified_file/76be47aee382d987a28076734d758c709f50b6cb",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/sumatrapdf/modified_file/76be47aee382d987a28076734d758c709f50b6cb/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/sumatrapdf/modified_file/76be47aee382d987a28076734d758c709f50b6cb/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/sumatrapdf/modified_file/76be47aee382d987a28076734d758c709f50b6cb/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 91,
          "old_api": "< w; i++",
          "new_api": "j++) {",
          "old_text": " < w; i++",
          "new_text": "j++) {\n  ",
          "old_line_content": null,
          "new_line_content": "        uint32_t *palette = (uint32_t *)bmi.Get()->bmiColors;",
          "content_same": true
        },
        {
          "line": 130,
          "old_api": "rash",
          "new_api": "rspace *color",
          "old_text": "rash(hasPalette || bgrPixmap);\n\n    BITMA",
          "new_text": "rspace *color",
          "old_line_content": "            fz_convert_pixmap(ctx, bgrPixmap, pixmap);",
          "new_line_content": "        free(bmpData);",
          "content_same": false
        },
        {
          "line": 136,
          "old_api": "biWidth = w;\n    bmih->biHeight = -h",
          "new_api": "asPalette || bgrPixmap);\n\n    BITMAPINFOH",
          "old_text": "biWidth = w;\n    bmih->biHeight = -h",
          "new_text": "asPalette || bgrPixmap);\n\n    BITMAPINFOH",
          "old_line_content": "    AssertCrash(hasPalette || bgrPixmap);",
          "new_line_content": "            fz_convert_pixmap(ctx, bgrPixmap, pixmap);",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": "h rendering e",
          "new_api": "&data, hMap, 0);\n    if (hbmp)\n        memcpy(data, hasPalette ? bmpData : bgrPixmap->sam",
          "old_text": "h rendering e",
          "new_text": "&data, hMap, 0);\n    if (hbmp)\n        memcpy(data, hasPalette ? bmpData : bgrPixmap->sam",
          "old_line_content": "        free(bmpData);",
          "new_line_content": "    HANDLE hMap = CreateFileMapping(INVALID_HANDLE_VALUE, NULL, PAGE_READWRITE, 0, bmih->biSizeImage, NULL);",
          "content_same": false
        },
        {
          "line": 168,
          "old_api": "D\n    if (fileSize > 0",
          "new_api": "// load sm",
          "old_text": "D\n    if (fileSize > 0 ",
          "new_text": " // load sm",
          "old_line_content": "    int64 fileSize = file::GetSize(filePath);",
          "new_line_content": "    return new RenderedBitmap(hbmp, SizeI(w, h), hMap);",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": "NULL;\n    }\n    return fi",
          "new_api": "z_drop_buffer",
          "old_text": "NULL;\n    }\n    return fi",
          "new_text": "z_drop_buffer(ctx, data);\n        if (file)\n        ",
          "old_line_content": "        fz_drop_buffer(ctx, data);",
          "new_line_content": "            if (file::ReadN(filePath, (char *)data->data, data->len))",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": "eek",
          "new_api": "}\n    return file;\n}",
          "old_text": "eek(stream, 0, 2);\n    int fi",
          "new_text": "    }\n    return file;\n}\n",
          "old_line_content": "        file = fz_open_file_w(ctx, filePath);",
          "new_line_content": "        fz_drop_buffer(ctx, data);",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "act_stream_data\");\n    return dat",
          "new_api": "r->len);\n    if",
          "old_text": "act_stream_data\");\n    return dat",
          "new_text": "r->len);\n    if",
          "old_line_content": "    unsigned char *data = (unsigned char *)memdup(buffer->data, buffer->len);",
          "new_line_content": "    int fileLen = fz_tell(stream);",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": "har digest[16])\n{\n    int fileLen =",
          "new_api": "(!data)\n        fz_throw(stre",
          "old_text": "har digest[16])\n{\n    int fileLen =",
          "new_text": " (!data)\n        fz_throw(stre",
          "old_line_content": "    fz_drop_buffer(stream->ctx, buffer);",
          "new_line_content": "    assert(fileLen == buffer->len);",
          "content_same": false
        },
        {
          "line": 228,
          "old_api": "len);\n\n    fz_md5 m",
          "new_api": "ad stream data, u",
          "old_text": "len);\n\n    fz_md5 m",
          "new_text": "ad stream data, u",
          "old_line_content": "    fz_catch(file->ctx) {",
          "new_line_content": "    fz_try(file->ctx) {",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": "d5_init",
          "new_api": "fingerprint instead",
          "old_text": "d5_init(&md5);\n    fz_md5_update(&md5, buffer->data, buffer->len);\n    fz_md5_fin",
          "new_text": "fingerprint instead",
          "old_line_content": "        fz_warn(file->ctx, \"couldn't read stream data, using a NULL fingerprint instead\");",
          "new_line_content": "        fz_seek(file, 0, 2);",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": "gest);\n\n    fz_drop_bu",
          "new_api": "y",
          "old_text": "gest);\n\n    fz_drop_bu",
          "new_text": "y(digest, 16)",
          "old_line_content": "        ZeroMemory(digest, 16);",
          "new_line_content": "        fileLen = fz_tell(file);",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": "t_page *text, WCHAR *lineSep, R",
          "new_api": "fz_md5 md5;",
          "old_text": "t_page *text, WCHAR *lineSep, R",
          "new_text": "\n    fz_md5 md5;\n  ",
          "old_line_content": "    CrashIf(fileLen != buffer->len);",
          "new_line_content": "    fz_catch(file->ctx) {",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": "z_page_block *block = text",
          "new_api": "_text_page_to_str",
          "old_text": "z_page_block *block = text",
          "new_text": "_text_page_to_str(fz_te",
          "old_line_content": "    fz_md5_final(&md5, digest);",
          "new_line_content": "    CrashIf(NULL == buffer);",
          "content_same": false
        },
        {
          "line": 265,
          "old_api": "->type != FZ_PAGE_BLOCK_TEXT)",
          "new_api": "L;\n        }\n    }\n\n    WCHAR",
          "old_text": "->type != FZ_PAGE_BLOCK_TEXT)\n",
          "new_text": "L;\n        }\n    }\n\n    WCHAR ",
          "old_line_content": "        destRect = *coords_out = AllocArray<RectI>(textLen + 1);",
          "new_line_content": "    WCHAR *content = AllocArray<WCHAR>(textLen + 1);",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": "ediabox->y0);",
          "new_api": "pen_istream;\n    return stm;\n}\n\nfz_matrix",
          "old_text": "ediabox->y0);\n  ",
          "new_text": "pen_istream;\n    return stm;\n}\n\nfz_matrix",
          "old_line_content": "    stream->AddRef();",
          "new_line_content": "    HRESULT res = stream->Seek(zero, STREAM_SEEK_SET, NULL);",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": "60) % 360;\n    if (90 == rotation)\n        fz_pre_translate(",
          "new_api": "*mediabox, float zoom, int rotation)\n{\n    fz_matrix ctm;",
          "old_text": "60) % 360;\n    if (90 == rotation)\n        fz_pre_translate(",
          "new_text": " *mediabox, float zoom, int rotation)\n{\n    fz_matrix ctm;\n   ",
          "old_line_content": "    fz_stream *stm = fz_new_stream(ctx, state, next_istream, close_istream, NULL);",
          "new_line_content": "        fz_throw(ctx, FZ_ERROR_GENERIC, \"IStream seek error: %x\", res);",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": "where the current line e",
          "new_api": "};\n\nstatic bool LinkifyCheckMultiline(c",
          "old_text": " where the current line e",
          "new_text": "\n};\n\nstatic bool LinkifyCheckMultiline(c",
          "old_line_content": "    assert(fz_matrix_expansion(&ctm) > 0);",
          "new_line_content": "        fz_pre_translate(&ctm, 0, -mediabox->y1);",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "n't contain any opening one\n    i",
          "new_api": "].dy * 1.2 &&",
          "old_text": "n't contain any opening one\n    i",
          "new_text": "].dy * 1.2 &&\n   ",
          "old_line_content": "        !str::StartsWith(pos + 1, L\"http\");",
          "new_line_content": "        !iswalnum(pos[-1]) && !str::IsWs(pos[1]) &&",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": "At",
          "new_api": "list->coords.App",
          "old_text": "ial links\n    list->links.At(lastIx) = str::Dup(uri);\n  ",
          "new_text": "    list->coords.App",
          "old_line_content": "        end = LinkifyFindEnd(next, start > pageText ? start[-1] : ' ');",
          "new_line_content": "    size_t lastIx = list->coords.Count() - 1;",
          "content_same": false
        },
        {
          "line": 467,
          "old_api": "Count",
          "new_api": "t<double>()));",
          "old_text": "x + 1; i < list->coords.Count(); i++)\n      ",
          "new_text": "t<double>()));\n\n      ",
          "old_line_content": "        multiline = LinkifyCheckMultiline(pageText, end, coords);",
          "new_line_content": "    ScopedMem<WCHAR> uri(list->links.At(lastIx));",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": "the list, as it is mo",
          "new_api": "At",
          "old_text": " the list, as it is mo",
          "new_text": "nks\n    list->links.At(lastIx) = str::Dup(uri);\n    for ",
          "old_line_content": "        list->coords.Append(fz_RectD_to_rect(bbox.Convert<double>()));",
          "new_line_content": "        end = LinkifyFindEnd(next, start > pageText ? start[-1] : ' ');",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": "nline bool Is",
          "new_api": "ist, as it is more",
          "old_text": "nline bool Is",
          "new_text": "ist, as it is more\n   ",
          "old_line_content": "    list->links.At(lastIx) = str::Dup(uri);",
          "new_line_content": "        list->coords.Append(fz_RectD_to_rect(bbox.Convert<double>()));",
          "content_same": false
        },
        {
          "line": 500,
          "old_api": "end++);\n    } while ('.' == *end",
          "new_api": "(end++; Is",
          "old_text": "end++);\n    } while ('.' == *end ",
          "new_text": " (end++; Is",
          "old_line_content": "    for (start = at; start > pageText && IsEmailUsernameChar(*(start - 1)); start--);",
          "new_line_content": "    return iswalnum(c) || '-' == c;",
          "content_same": false
        },
        {
          "line": 514,
          "old_api": "const WCHAR",
          "new_api": "start; start++) {\n        con",
          "old_text": "            const WCHAR",
          "new_text": "start; start++) {\n        con",
          "old_line_content": "        for (end++; IsEmailDomainChar(*end); end++);",
          "new_line_content": "    if (end == start || *end != '@' || !IsEmailDomainChar(*(end + 1)))",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": "nd",
          "new_api": "{\n            end = LinkifyFindE",
          "old_text": "nd(start, start > p",
          "new_text": " {\n            end = LinkifyFindE",
          "old_line_content": "        else if (start > pageText && ('/' == start[-1] || iswalnum(start[-1]))) {",
          "new_line_content": "            const WCHAR *email = LinkifyFindEmail(pageText, start);",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": "art && str::StartsWith(start, L\"mailto:\")) {",
          "new_api": "rt, start > pageTex",
          "old_text": "art && str::StartsWith(start, L\"mailto:\")) {",
          "new_text": "rt, start > pageTex",
          "old_line_content": "            multiline = LinkifyCheckMultiline(pageText, end, coords);",
          "new_line_content": "        else if (start > pageText && ('/' == start[-1] || iswalnum(start[-1]))) {",
          "content_same": false
        },
        {
          "line": 547,
          "old_api": "rotocol ? str::Join(protocol, part) : part.S",
          "new_api": "line && (!wcschr(start + 5, '.')",
          "old_text": "rotocol ? str::Join(protocol, part) : part.S",
          "new_text": "line && (!wcschr(start + 5, '.')",
          "old_line_content": "            multiline = LinkifyCheckMultiline(pageText, end, coords);",
          "new_line_content": "        else if ('h' == *start && str::Parse(start, L\"http%?s://\")) {",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": "+ 1, coords);\n\n        start = en",
          "new_api": "l ? str::Join(protocol, part) : part.StealDa",
          "old_text": " + 1, coords);\n\n        start = en",
          "new_text": "l ? str::Join(protocol, part) : part.StealDa",
          "old_line_content": "        else if ('m' == *start && str::StartsWith(start, L\"mailto:\")) {",
          "new_line_content": "            multiline = LinkifyCheckMultiline(pageText, end, coords);",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": "-most,\n    // i.e. links that",
          "new_api": "coords);\n\n        start = end;",
          "old_text": "-most,\n    // i.e. links that",
          "new_text": "coords);\n\n        start = end;\n   ",
          "old_line_content": "        ScopedMem<WCHAR> part(str::DupN(start, end - start));",
          "new_line_content": "        else if ('m' == *start && str::StartsWith(start, L\"mailto:\")) {",
          "content_same": false
        },
        {
          "line": 560,
          "old_api": "pearing before.",
          "new_api": "static fz_link *FixupPageLink",
          "old_text": "pearing before. ",
          "new_text": "\nstatic fz_link *FixupPageLink",
          "old_line_content": "        WCHAR *uri = protocol ? str::Join(protocol, part) : part.StealData();",
          "new_line_content": "            end = LinkifyEmailAddress(start + 7);",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": "fz_link *tmp = root->next;\n        root->next = new_root;",
          "new_api": "// i.e. links that appea",
          "old_text": " fz_link *tmp = root->next;\n        root->next = new_root;\n ",
          "new_text": "\n    // i.e. links that appea",
          "old_line_content": "            end = LinkifyMultilineText(list, pageText, start, end + 1, coords);",
          "new_line_content": "        ScopedMem<WCHAR> part(str::DupN(start, end - start));",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": "tion_stroke_text",
          "new_api": "n \"C\" static void\nfz_inspection_fill",
          "old_text": "tion_stroke_text(fz_device *dev, fz_",
          "new_text": "n \"C\" static void\nfz_inspection_fill",
          "old_line_content": null,
          "new_line_content": "    fz_inspection_handle_path(dev, path);",
          "content_same": true
        },
        {
          "line": 675,
          "old_api": "xt);\n}\n\nextern \"C\" static void\nfz_inspecti",
          "new_api": "troke_text",
          "old_text": "xt);\n}\n\nextern \"C\" static void\nfz_inspecti",
          "new_text": "troke_text(fz_device *dev, fz_text *",
          "old_line_content": "    fz_inspection_handle_path(dev, path, true);",
          "new_line_content": "    fz_inspection_handle_path(dev, path);",
          "content_same": false
        },
        {
          "line": 681,
          "old_api": "_stroke_text",
          "new_api": "extern \"C\" static void\nfz_inspection_cli",
          "old_text": "_stroke_text(fz_device *dev, fz_text *text",
          "new_text": "\n\nextern \"C\" static void\nfz_inspection_cli",
          "old_line_content": null,
          "new_line_content": "    fz_inspection_handle_path(dev, path, true);",
          "content_same": true
        },
        {
          "line": 687,
          "old_api": "hade, const fz_matrix *ctm, float al",
          "new_api": "e_text",
          "old_text": "hade, const fz_matrix *ctm, float al",
          "new_text": "e_text(fz_device *dev, fz_text *text, fz_s",
          "old_line_content": "    fz_inspection_handle_text(dev, text);",
          "new_line_content": "    fz_inspection_handle_path(dev, path, true);",
          "content_same": false
        },
        {
          "line": 693,
          "old_api": "{\n    fz_inspection_handle_image(de",
          "new_api": "const fz_matrix *ctm, float alpha)\n{",
          "old_text": "\n{\n    fz_inspection_handle_image(de",
          "new_text": "const fz_matrix *ctm, float alpha)\n{",
          "old_line_content": null,
          "new_line_content": "    fz_inspection_handle_text(dev, text);",
          "content_same": true
        },
        {
          "line": 699,
          "old_api": "ht actually want to extract\n    if (",
          "new_api": "fz_inspection_handle_image(dev, ima",
          "old_text": "ht actually want to extract\n    if (",
          "new_text": " fz_inspection_handle_image(dev, ima",
          "old_line_content": null,
          "new_line_content": "    fz_inspection_handle_text(dev, text);",
          "content_same": true
        },
        {
          "line": 705,
          "old_api": "((ListInspectionData *)dev-",
          "new_api": "ually want to extract\n    if (image-",
          "old_text": "\n        ((ListInspectionData *)dev-",
          "new_text": "ually want to extract\n    if (image-",
          "old_line_content": null,
          "new_line_content": "    fz_inspection_handle_text(dev, text);",
          "content_same": true
        },
        {
          "line": 723,
          "old_api": "dev->fill_path = fz_inspect",
          "new_api": "age *image, const fz_rect *rect, const",
          "old_text": "  dev->fill_path = fz_inspect",
          "new_text": "age *image, const fz_rect *rect, const",
          "old_line_content": "    fz_transform_rect(&rect, ctm);",
          "new_line_content": "    fz_inspection_handle_image(dev, image);",
          "content_same": false
        },
        {
          "line": 731,
          "old_api": "n_clip_text;\n    dev->clip_stroke_text",
          "new_api": "ip_path;\n    dev->clip_st",
          "old_text": "n_clip_text;\n    dev->clip_stroke_text",
          "new_text": "ip_path;\n    dev->clip_st",
          "old_line_content": "    fz_inspection_handle_image(dev, image);",
          "new_line_content": "        ((ListInspectionData *)dev->user)->images->Append(FitzImagePos(image, rect));",
          "content_same": false
        },
        {
          "line": 737,
          "old_api": "image_mask = fz_inspection_fill_image_",
          "new_api": "_text;\n    dev->clip_stroke_text = fz_",
          "old_text": "image_mask = fz_inspection_fill_image_",
          "new_text": "_text;\n    dev->clip_stroke_text = fz_",
          "old_line_content": null,
          "new_line_content": "    fz_inspection_handle_image(dev, image);",
          "content_same": true
        },
        {
          "line": 796,
          "old_api": "= fz_RectD_to_rec",
          "new_api": "i = 0; i < pageAnnots.Co",
          "old_text": " = fz_RectD_to_rec",
          "new_text": "i = 0; i < pageAnnots.Co",
          "old_line_content": "    for (size_t i = 0; i < userAnnots.Count(); i++) {",
          "new_line_content": "    LeaveCriticalSection(cs);",
          "content_same": false
        },
        {
          "line": 803,
          "old_api": "dev->ctx);\n        f",
          "new_api": "ctm);\n        fz",
          "old_text": "dev->ctx);\n        f",
          "new_text": "ctm);\n        fz",
          "old_line_content": "            result.Append(annot);",
          "new_line_content": "        PageAnnotation& annot = userAnnots.At(i);",
          "content_same": false
        },
        {
          "line": 818,
          "old_api": ");\n            fz_lineto(dev->ctx,",
          "new_api": "fz_lineto(dev->",
          "old_text": ");\n            fz_lineto(dev->ctx, ",
          "new_text": "   fz_lineto(dev->",
          "old_line_content": "        if (cliprect && fz_is_empty_rect(fz_intersect_rect(&isect, cliprect)))",
          "new_line_content": "    for (size_t i = 0; i < pageAnnots.Count() && (!cookie || !cookie->abort); i++) {",
          "content_same": false
        },
        {
          "line": 822,
          "old_api": "ot.rect.dy / 2);",
          "new_api": "nnot_Underline:\n            f",
          "old_text": "ot.rect.dy / 2);\n    ",
          "new_text": "nnot_Underline:\n            f",
          "old_line_content": "        fz_path *path = fz_new_path(dev->ctx);",
          "new_line_content": "        fz_transform_rect(&rect, ctm);",
          "content_same": false
        },
        {
          "line": 828,
          "old_api": "o",
          "new_api": "t.dy / 2);",
          "old_text": "o(dev->ctx, pat",
          "new_text": "t.dy / 2);\n          ",
          "old_line_content": "            fz_lineto(dev->ctx, path, annot.rect.BR().x, annot.rect.BR().y);",
          "new_line_content": "        fz_path *path = fz_new_path(dev->ctx);",
          "content_same": false
        },
        {
          "line": 833,
          "old_api": ".5f;",
          "new_api": "->ctx, path, an",
          "old_text": ".5f;\n          ",
          "new_text": "->ctx, path, an",
          "old_line_content": "            fz_moveto(dev->ctx, path, annot.rect.TL().x, annot.rect.BR().y - 0.25f);",
          "new_line_content": "            fz_lineto(dev->ctx, path, annot.rect.BR().x, annot.rect.TL().y);",
          "content_same": false
        },
        {
          "line": 834,
          "old_api": "ist[stroke->das",
          "new_api": ">ctx, path, ann",
          "old_text": "ist[stroke->das",
          "new_text": ">ctx, path, ann",
          "old_line_content": "            fz_lineto(dev->ctx, path, annot.rect.BR().x, annot.rect.BR().y - 0.25f);",
          "new_line_content": "            fz_lineto(dev->ctx, path, annot.rect.BR().x, annot.rect.BR().y);",
          "content_same": false
        },
        {
          "line": 843,
          "old_api": "else {",
          "new_api": "(dev->ctx);",
          "old_text": "     else {\n   ",
          "new_text": "(dev->ctx);\n   ",
          "old_line_content": "            fz_moveto(dev->ctx, path, annot.rect.TL().x, annot.rect.BR().y - 0.5f);",
          "new_line_content": "            fz_moveto(dev->ctx, path, annot.rect.TL().x, annot.rect.TL().y + annot.rect.dy / 2);",
          "content_same": false
        },
        {
          "line": 844,
          "old_api": "->ctx);",
          "new_api": "/ 255.f };",
          "old_text": "->ctx);\n       ",
          "new_text": " / 255.f };\n   ",
          "old_line_content": "            fz_lineto(dev->ctx, path, annot.rect.BR().x, annot.rect.BR().y - 0.5f);",
          "new_line_content": "            fz_lineto(dev->ctx, path, annot.rect.BR().x, annot.rect.TL().y + annot.rect.dy / 2);",
          "content_same": false
        },
        {
          "line": 851,
          "old_api": "ol endGroup,",
          "new_api": "tm, cs, color, 1.0f);\n            fz_drop_stro",
          "old_text": "ol endGroup, ",
          "new_text": "tm, cs, color, 1.0f);\n            fz_drop_stro",
          "old_line_content": "            CrashIf(true);",
          "new_line_content": "            stroke = fz_new_stroke_state_with_dash_len(dev->ctx, 2);",
          "content_same": false
        },
        {
          "line": 857,
          "old_api": "ue;\n            break;\n        }\n    }\n    if (!needsTra",
          "new_api": "Group, bool h",
          "old_text": "ue;\n            break;\n        }\n    }\n    if (!needsTra",
          "new_text": "Group, bool h",
          "old_line_content": "            fz_begin_group(dev, &rect, 0, 0, FZ_BLEND_MULTIPLY, 1.f);",
          "new_line_content": "            CrashIf(true);",
          "content_same": false
        },
        {
          "line": 859,
          "old_api": "&fz_infinite_rec",
          "new_api": "rency || pageAnnots.Cou",
          "old_text": " &fz_infinite_rec",
          "new_text": "rency || pageAnnots.Cou",
          "old_line_content": "            fz_end_group(dev);",
          "new_line_content": "        fz_colorspace *cs = fz_device_rgb(dev->ctx);",
          "content_same": false
        },
        {
          "line": 863,
          "old_api": "ons to Fitz/MuPDF /////\n\nexte",
          "new_api": "break;\n        }\n    }\n    if (!needsTranspare",
          "old_text": "ons to Fitz/MuPDF /////\n\nexte",
          "new_text": "          break;\n        }\n    }\n    if (!needsTranspare",
          "old_line_content": "                stroke = fz_new_stroke_state(dev->ctx);",
          "new_line_content": "            fz_begin_group(dev, &rect, 0, 0, FZ_BLEND_MULTIPLY, 1.f);",
          "content_same": false
        },
        {
          "line": 864,
          "old_api": "de <mupdf/pdf.h>\n}\n\nnamespace str {\n    namespace conv",
          "new_api": "turn;\n    if (!endGroup)\n        fz_begin_group(dev, cliprect ? c",
          "old_text": "de <mupdf/pdf.h>\n}\n\nnamespace str {\n    namespace conv ",
          "new_text": "turn;\n    if (!endGroup)\n        fz_begin_group(dev, cliprect ? c",
          "old_line_content": "            fz_stroke_path(dev, path, stroke, ctm, cs, color, 1.0f);",
          "new_line_content": "            fz_fill_path(dev, path, 0, ctm, cs, color, annot.color.a / 255.f);",
          "content_same": false
        },
        {
          "line": 865,
          "old_api": "*FromPdf(pdf_obj *obj)\n{\n    ScopedMe",
          "new_api": "nfinite_rect, 1,",
          "old_text": " *FromPdf(pdf_obj *obj)\n{\n    ScopedMe",
          "new_text": "nfinite_rect, 1, ",
          "old_line_content": "            fz_drop_stroke_state(dev->ctx, stroke);",
          "new_line_content": "            fz_end_group(dev);",
          "content_same": false
        },
        {
          "line": 873,
          "old_api": "_clean_string",
          "new_api": "R>(pdf_to_str_len(obj) + 1))",
          "old_text": "_clean_string(WCHA",
          "new_text": "R>(pdf_to_str_len(obj) + 1))",
          "old_line_content": "    if (hasTransparency || pageAnnots.Count() == 0)",
          "new_line_content": "        fz_free_path(dev->ctx, path);",
          "content_same": false
        },
        {
          "line": 927,
          "old_api": "= 1;\n        node->dest.",
          "new_api": "contin",
          "old_text": " = 1;\n        node->dest.",
          "new_text": "\n            contin",
          "old_line_content": "            pdf_dict_put(copy, pdf_dict_get_key(copy, i), val2);",
          "new_line_content": "    pdf_obj *copy = pdf_copy_dict(dict);",
          "content_same": false
        },
        {
          "line": 928,
          "old_api": "= pdf_to_num(embe",
          "new_api": "ext = (fz_outline",
          "old_text": " = pdf_to_num(embe",
          "new_text": "ext = (fz_outline ",
          "old_line_content": "            pdf_drop_obj(val2);",
          "new_line_content": "    for (int i = 0; i < pdf_dict_len(copy); i++) {",
          "content_same": false
        },
        {
          "line": 943,
          "old_api": "abelInfo *)b)->startAt;\n}",
          "new_api": "uct PageLabelInfo {\n    int startAt, cou",
          "old_text": "abelInfo *)b)->startAt;\n}",
          "new_text": "uct PageLabelInfo {\n    int startAt, cou",
          "old_line_content": "        pdf_obj *name = pdf_dict_get_key(dict, i);",
          "new_line_content": "    pdf_obj *dict = pdf_load_name_tree(doc, \"EmbeddedFiles\");",
          "content_same": false
        },
        {
          "line": 949,
          "old_api": "ScopedMem<WCHAR> number(str::FormatRo",
          "new_api": "fo *)b)->startAt;\n}\n\nWCHA",
          "old_text": " ScopedMem<WCHAR> number(str::FormatRo",
          "new_text": "fo *)b)->startAt;\n}\n\nWCHA",
          "old_line_content": "        node = node->next = (fz_outline *)fz_malloc_struct(doc->ctx, fz_outline);",
          "new_line_content": "        pdf_obj *name = pdf_dict_get_key(dict, i);",
          "content_same": false
        },
        {
          "line": 950,
          "old_api": ")\n            str",
          "new_api": "ar *type, int pageNo, con",
          "old_text": ")\n            str",
          "new_text": "ar *type, int pageNo, con",
          "old_line_content": "        node->title = fz_strdup(doc->ctx, pdf_to_name(name));",
          "new_line_content": "        pdf_obj *dest = pdf_dict_get_val(dict, i);",
          "content_same": false
        },
        {
          "line": 955,
          "old_api": "i = 0; i < (pageNo",
          "new_api": "dMem<WCHAR> number(str::FormatRomanNum",
          "old_text": " i = 0; i < (pageNo ",
          "new_text": "dMem<WCHAR> number(str::FormatRomanNum",
          "old_line_content": "        node->dest.ld.launch.embedded_gen = pdf_to_gen(embedded);",
          "new_line_content": "        node = node->next = (fz_outline *)fz_malloc_struct(doc->ctx, fz_outline);",
          "content_same": false
        },
        {
          "line": 958,
          "old_api": "if (*type",
          "new_api": "r::EqI(type, \"A\")) {\n        //",
          "old_text": "\n        if (*type",
          "new_text": "r::EqI(type, \"A\")) {\n        //",
          "old_line_content": "    pdf_drop_obj(dict);",
          "new_line_content": "        node->dest.ld.launch.file_spec = pdf_file_spec_to_str(doc, dest);",
          "content_same": false
        },
        {
          "line": 982,
          "old_api": "bj *info = p",
          "new_api": "(obj); i++)",
          "old_text": "bj *info = p",
          "new_text": "(obj); i++)\n      ",
          "old_line_content": "            str::ToLower(number.Get());",
          "new_line_content": "    if (str::Eq(type, \"D\"))",
          "content_same": false
        },
        {
          "line": 983,
          "old_api": "+ 1);\n            PageLabelInfo pli",
          "new_api": "elRec",
          "old_text": " + 1);\n            PageLabelInfo pli",
          "new_text": "elRec(pdf_array_get(obj, i), pageCou",
          "old_line_content": "        return str::Format(L\"%s%s\", prefix, number);",
          "new_line_content": "        return str::Format(L\"%s%d\", prefix, pageNo);",
          "content_same": false
        },
        {
          "line": 988,
          "old_api": "f_to_name",
          "new_api": "fo = pdf_arr",
          "old_text": "f_to_name(pdf_dict_gets(info, \"S\"));\n ",
          "new_text": "fo = pdf_arr",
          "old_line_content": "        number.Append('A' + (pageNo - 1) % 26);",
          "new_line_content": "            str::ToLower(number.Get());",
          "content_same": false
        },
        {
          "line": 1001,
          "old_api": "= 0)\n        retur",
          "new_api": "PageLabelVec",
          "old_text": "= 0)\n        retur",
          "new_text": "PageLabelVec(pdf",
          "old_line_content": "    if ((obj = pdf_dict_gets(node, \"Kids\")) != NULL && !pdf_mark_obj(node)) {",
          "new_line_content": "    return str::Dup(prefix);",
          "content_same": false
        },
        {
          "line": 1007,
          "old_api": "trVec *labels = ne",
          "new_api": "return NULL",
          "old_text": "trVec *labels = ne",
          "new_text": "       return NULL",
          "old_line_content": "        for (int i = 0; i < pdf_array_len(obj); i += 2) {",
          "new_line_content": "    if ((obj = pdf_dict_gets(node, \"Kids\")) != NULL && !pdf_mark_obj(node)) {",
          "content_same": false
        },
        {
          "line": 1008,
          "old_api": "eCount);\n\n    for (size_t",
          "new_api": "At",
          "old_text": "eCount);\n\n    for (size_t",
          "new_text": "ata.At(0).startAt ",
          "old_line_content": "            pdf_obj *info = pdf_array_get(obj, i + 1);",
          "new_line_content": "        for (int i = 0; i < pdf_array_len(obj); i++)",
          "content_same": false
        },
        {
          "line": 1010,
          "old_api": "int secLen = page",
          "new_api": "pe, \"D\")) {",
          "old_text": "    int secLen = page",
          "new_text": "pe, \"D\")) {\n        ",
          "old_line_content": "            pli.startAt = pdf_to_int(pdf_array_get(obj, i)) + 1;",
          "new_line_content": "        pdf_unmark_obj(node);",
          "content_same": false
        },
        {
          "line": 1014,
          "old_api": "secLen = data",
          "new_api": ");\n\n    for (size_t i = 0",
          "old_text": "           secLen = data",
          "new_text": ");\n\n    for (size_t i = 0",
          "old_line_content": "            pli.type = pdf_to_name(pdf_dict_gets(info, \"S\"));",
          "new_line_content": "            pdf_obj *info = pdf_array_get(obj, i + 1);",
          "content_same": false
        },
        {
          "line": 1016,
          "old_api": "At",
          "new_api": "t secLen = pageCount",
          "old_text": "a.At(i).prefix));\n       ",
          "new_text": "t secLen = pageCount ",
          "old_line_content": "            pli.countFrom = pdf_to_int(pdf_dict_gets(info, \"St\"));",
          "new_line_content": "            pli.startAt = pdf_to_int(pdf_array_get(obj, i)) + 1;",
          "content_same": false
        },
        {
          "line": 1033,
          "old_api": "a number",
          "new_api": "}\n    }\n\n    for (int ix = 0; (i",
          "old_text": " a number ",
          "new_text": "        }\n    }\n\n    for (int ix = 0; (i",
          "old_line_content": "    if (data.Count() == 1 && data.At(0).startAt == 1 && data.At(0).countFrom == 1 &&",
          "new_line_content": "    BuildPageLabelRec(root, pageCount, data);",
          "content_same": false
        },
        {
          "line": 1034,
          "old_api": "for (",
          "new_api": "Find",
          "old_text": "\n    for (",
          "new_text": "els->Find(NULL, ix)) != -1;",
          "old_line_content": "        !data.At(0).prefix && str::Eq(data.At(0).type, \"D\")) {",
          "new_line_content": "    data.Sort(CmpPageLabelInfo);",
          "content_same": false
        },
        {
          "line": 1040,
          "old_api": "nter = 0;\n        while ((ix =",
          "new_api": "or (size_t",
          "old_text": "nter = 0;\n        while ((ix = ",
          "new_text": "or (size_t",
          "old_line_content": "    labels->AppendBlanks(pageCount);",
          "new_line_content": "        !data.At(0).prefix && str::Eq(data.At(0).type, \"D\")) {",
          "content_same": false
        },
        {
          "line": 1046,
          "old_api": "), dups.At",
          "new_api": "0;\n        while ((ix = labels",
          "old_text": "), dups.At",
          "new_text": " 0;\n        while ((ix = labels",
          "old_line_content": "        ScopedMem<WCHAR> prefix(str::conv::FromPdf(data.At(i).prefix));",
          "new_line_content": "    labels->AppendBlanks(pageCount);",
          "content_same": false
        },
        {
          "line": 1048,
          "old_api": "*kids;",
          "new_api": "ScopedMem",
          "old_text": "*kids;\n   ",
          "new_text": " ScopedMem",
          "old_line_content": "            free(labels->At(data.At(i).startAt + j - 1));",
          "new_line_content": "    for (size_t i = 0; i < data.Count() && data.At(i).startAt <= pageCount; i++) {",
          "content_same": false
        },
        {
          "line": 1049,
          "old_api": "TreeStackI",
          "new_api": "mat",
          "old_text": "TreeStackI",
          "new_text": "mat(L\"%s.%",
          "old_line_content": "            labels->At(data.At(i).startAt + j - 1) =",
          "new_line_content": "        int secLen = pageCount + 1 - data.At(i).startAt;",
          "content_same": false
        },
        {
          "line": 1050,
          "old_api": "geTreeStac",
          "new_api": "e (labels->Con",
          "old_text": "geTreeStac",
          "new_text": "e (labels->Con",
          "old_line_content": "                FormatPageLabel(data.At(i).type, data.At(i).countFrom + j, prefix);",
          "new_line_content": "        if (i < data.Count() - 1 && data.At(i + 1).startAt <= pageCount)",
          "content_same": false
        },
        {
          "line": 1054,
          "old_api": "(pdf_array_len(kids)),",
          "new_api": "int i",
          "old_text": "(pdf_array_len(kids)),",
          "new_text": "\n    int i",
          "old_line_content": "    for (int ix = 0; (ix = labels->Find(NULL, ix)) != -1; ix++)",
          "new_line_content": "            free(labels->At(data.At(i).startAt + j - 1));",
          "content_same": false
        },
        {
          "line": 1055,
          "old_api": "c void\npdf_lo",
          "new_api": "ackItem",
          "old_text": "c void\npdf_lo",
          "new_text": "ackItem() ",
          "old_line_content": "        labels->At(ix) = str::Dup(L\"\");",
          "new_line_content": "            labels->At(data.At(i).startAt + j - 1) =",
          "content_same": false
        },
        {
          "line": 1060,
          "old_api": "m top(pdf_di",
          "new_api": "rray_len",
          "old_text": "m top(pdf_di",
          "new_text": "rray_len(kids)), next_",
          "old_line_content": "    for (size_t i = 1; i < dups.Count(); i++) {",
          "new_line_content": "    for (int ix = 0; (ix = labels->Find(NULL, ix)) != -1; ix++)",
          "content_same": false
        },
        {
          "line": 1061,
          "old_api": "));\n\n    if (p",
          "new_api": "pdf_load_pag",
          "old_text": "));\n\n    if (p",
          "new_text": "\npdf_load_pag",
          "old_line_content": "        if (!str::Eq(dups.At(i), dups.At(i - 1)))",
          "new_line_content": "        labels->At(ix) = str::Dup(L\"\");",
          "content_same": false
        },
        {
          "line": 1067,
          "old_api": "op.next_pa",
          "new_api": "if (pdf_mar",
          "old_text": "op.next_pa",
          "new_text": "   if (pdf_mar",
          "old_line_content": "                unique.Set(str::Format(L\"%s.%d\", dups.At(i), ++counter));",
          "new_line_content": "        if (!str::Eq(dups.At(i), dups.At(i - 1)))",
          "content_same": false
        },
        {
          "line": 1069,
          "old_api": "",
          "new_api": "\"cycle in",
          "old_text": "              ",
          "new_text": "\"cycle in ",
          "old_line_content": "            str::ReplacePtr(&labels->At(ix), unique);",
          "new_line_content": "        int ix = labels->Find(dups.At(i)), counter = 0;",
          "content_same": false
        },
        {
          "line": 1103,
          "old_api": "if (pdf_mark_ob",
          "new_api": "if (count > 0) {\n                    stack.",
          "old_text": "         if (pdf_mark_ob",
          "new_text": "          if (count > 0) {\n                    stack.",
          "old_line_content": "                pdf_unmark_obj(top.kids);",
          "new_line_content": "        fz_throw(ctx, FZ_ERROR_GENERIC, \"cycle in page tree\");",
          "content_same": false
        },
        {
          "line": 1112,
          "old_api": "}\n        }\n    }\n    fz_catch",
          "new_api": "els",
          "old_text": "}\n        }\n    }\n    fz_catch",
          "new_text": "         els",
          "old_line_content": "            pdf_obj *kid = pdf_array_get(top.kids, top.i);",
          "new_line_content": "                if (stack.Size() == 0)",
          "content_same": false
        },
        {
          "line": 1114,
          "old_api": "k_obj",
          "new_api": "tree (%s)\",",
          "old_text": "k_obj(top.kids);\n        fz_re",
          "new_text": "tree (%s)\",",
          "old_line_content": "            if (str::Eq(type, \"Page\") || str::IsEmpty(type) && pdf_dict_gets(kid, \"MediaBox\")) {",
          "new_line_content": "                top = stack.Pop();",
          "content_same": false
        },
        {
          "line": 1119,
          "old_api": "n;\n    size_t cli",
          "new_api": "ize",
          "old_text": "n;\n    size_t cli",
          "new_text": "ize(); i++) {\n            ",
          "old_line_content": "                page_objs[page_no] = pdf_keep_obj(kid);",
          "new_line_content": "            char *type = pdf_to_name(pdf_dict_gets(kid, \"Type\"));",
          "content_same": false
        },
        {
          "line": 1122,
          "old_api": "page(page), list(list),",
          "new_api": "follows PdfEngine /",
          "old_text": "  page(page), list(list), ",
          "new_text": " follows PdfEngine /",
          "old_line_content": "            else if (str::Eq(type, \"Pages\") || str::IsEmpty(type) && pdf_dict_gets(kid, \"Kids\")) {",
          "new_line_content": "                if (page_no >= pdf_count_pages(doc))",
          "content_same": false
        },
        {
          "line": 1123,
          "old_api": "ta.req_t3_fonts),\n        p",
          "new_api": "{\n    pdf_page *page;\n    fz_display_list *list;\n    size_t size_est;\n    b",
          "old_text": "ta.req_t3_fonts),\n        p",
          "new_text": " {\n    pdf_page *page;\n    fz_display_list *list;\n    size_t size_est;\n    b",
          "old_line_content": "                int count = pdf_to_int(pdf_dict_gets(kid, \"Count\"));",
          "new_line_content": "                    fz_throw(ctx, FZ_ERROR_GENERIC, \"found more /Page objects than anticipated\");",
          "content_same": false
        },
        {
          "line": 1125,
          "old_api": "refs(1) { }\n};",
          "new_api": "size_t clip_path",
          "old_text": " refs(1) { }\n};",
          "new_text": " size_t clip_path",
          "old_line_content": "                    stack.Push(top);",
          "new_line_content": "                page_objs[page_no] = pdf_keep_obj(kid);",
          "content_same": false
        },
        {
          "line": 1128,
          "old_api": "iend PdfImage;\n\npublic",
          "new_api": "(page), list(list), size_e",
          "old_text": "iend PdfImage;\n\npublic",
          "new_text": "(page), list(list), size_e",
          "old_line_content": "                    if (pdf_mark_obj(top.kids))",
          "new_line_content": "            else if (str::Eq(type, \"Pages\") || str::IsEmpty(type) && pdf_dict_gets(kid, \"Kids\")) {",
          "content_same": false
        },
        {
          "line": 1129,
          "old_api": "virtual ~PdfEngineImpl();\n    virtual BaseEngine *Clo",
          "new_api": "_t3_fonts),\n        path_le",
          "old_text": "virtual ~PdfEngineImpl();\n    virtual BaseEngine *Clo",
          "new_text": "_t3_fonts),\n        path_le",
          "old_line_content": "                        fz_throw(ctx, FZ_ERROR_GENERIC, \"cycle in page tree\");",
          "new_line_content": "                int count = pdf_to_int(pdf_dict_gets(kid, \"Count\"));",
          "content_same": false
        },
        {
          "line": 1139,
          "old_api": "f_count_page",
          "new_api": "tual int PageCount() const {\n        // make sure that",
          "old_text": "f_count_page",
          "new_text": "tual int PageCount() const {\n        // make sure that ",
          "old_line_content": "        for (size_t i = 0; i < stack.Size(); i++) {",
          "new_line_content": "                fz_warn(ctx, \"non-page object in page tree (%s)\", type);",
          "content_same": false
        },
        {
          "line": 1221,
          "old_api": "Objs;\n\n    bool",
          "new_api": "r to avoid deadlocks\n    CRITICAL_SECTI",
          "old_text": "Objs;\n\n    bool   ",
          "new_text": "r to avoid deadlocks\n    CRITICAL_SECTI",
          "old_line_content": "    virtual bool BenchLoadPage(int pageNo) { return GetPdfPage(pageNo) != NULL; }",
          "new_line_content": "        return pdf_has_permission(_doc, PDF_PERM_COPY);",
          "content_same": false
        },
        {
          "line": 1354,
          "old_api": "t_cs;\n    ctx = f",
          "new_api": "_decryptionKey(NUL",
          "old_text": "t_cs;\n    ctx = f",
          "new_text": "\n    _decryptionKey(NUL",
          "old_line_content": "    virtual WCHAR *GetValue() const { return str::Dup(content); }",
          "new_line_content": "        annot(Annot_None, pageNo, rect, PageAnnotation::Color()),",
          "content_same": false
        },
        {
          "line": 1398,
          "old_api": ";\n}\n\nclass PasswordCloner : public PasswordUI {\n    uns",
          "new_api": "elete _pagelabels;\n    free(_fileName);",
          "old_text": ";\n}\n\nclass PasswordCloner : public PasswordUI {\n    uns",
          "new_text": "elete _pagelabels;\n    free(_fileName);",
          "old_line_content": "    ctx = fz_new_context(NULL, &fz_locks_ctx, MAX_CONTEXT_MEMORY);",
          "new_line_content": "    InitializeCriticalSection(&pagesAccess);",
          "content_same": false
        },
        {
          "line": 1407,
          "old_api": "fileName, unsigned char *fileDig",
          "new_api": "explicit PasswordCloner(unsigned char",
          "old_text": "fileName, unsigned char *fileDig",
          "new_text": "  explicit PasswordCloner(unsigned char",
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "        pdf_install_load_system_font_funcs(ctx);",
          "content_same": false
        },
        {
          "line": 1413,
          "old_api": "*sa",
          "new_api": "me, unsigned char *fileDigest,",
          "old_text": "\n        *sa",
          "new_text": "me, unsigned char *fileDigest,\n ",
          "old_line_content": "        free(_pages);",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 1416,
          "old_api": "EngineImpl:",
          "new_api": "ionKeyOut[3",
          "old_text": "EngineImpl:",
          "new_text": "ionKeyOut[3",
          "old_line_content": null,
          "new_line_content": "        for (int i = 0; i < PageCount(); i++) {",
          "content_same": true
        },
        {
          "line": 1417,
          "old_api": "ritSec scope(&ctxAccess);",
          "new_api": "memcpy(decryptionKeyOut",
          "old_text": "ritSec scope(&ctxAccess);\n",
          "new_text": "       memcpy(decryptionKeyOut",
          "old_line_content": "            pdf_drop_obj(_pageObjs[i]);",
          "new_line_content": "            pdf_free_page(_doc, _pages[i]);",
          "content_same": false
        },
        {
          "line": 1419,
          "old_api": "ent's encryptio",
          "new_api": "*saveKey",
          "old_text": "ent's encryptio",
          "new_text": "   *saveKey ",
          "old_line_content": "        free(_pageObjs);",
          "new_line_content": "        free(_pages);",
          "content_same": false
        },
        {
          "line": 1422,
          "old_api": "o load the clone\n    Password",
          "new_api": "Impl::Clone",
          "old_text": "o load the clone\n    Password",
          "new_text": "Impl::Clone",
          "old_line_content": "    fz_free_outline(ctx, outline);",
          "new_line_content": "        for (int i = 0; i < PageCount(); i++) {",
          "content_same": false
        },
        {
          "line": 1423,
          "old_api": "*pwdUI = NULL;\n    if (pdf_crypt_",
          "new_api": "scope(&ctxAccess);\n\n    /",
          "old_text": "*pwdUI = NULL;\n    if (pdf_crypt_",
          "new_text": " scope(&ctxAccess);\n\n    /",
          "old_line_content": "    fz_free_outline(ctx, attachments);",
          "new_line_content": "            pdf_drop_obj(_pageObjs[i]);",
          "content_same": false
        },
        {
          "line": 1428,
          "old_api": ";\n    if (!clone ||",
          "new_api": "the clone\n    PasswordCloner",
          "old_text": ";\n    if (!clone ||",
          "new_text": " the clone\n    PasswordCloner",
          "old_line_content": "            free(pageAnnots[i]);",
          "new_line_content": "    fz_free_outline(ctx, outline);",
          "content_same": false
        },
        {
          "line": 1430,
          "old_api": "Load",
          "new_api": "pwdUI = new P",
          "old_text": "Load(_fileName, ",
          "new_text": "      pwdUI = new P",
          "old_line_content": "        free(pageAnnots);",
          "new_line_content": "    pdf_drop_obj(_info);",
          "content_same": false
        },
        {
          "line": 1433,
          "old_api": "one;",
          "new_api": "clone = new",
          "old_text": "one;\n      ",
          "new_text": "clone = new",
          "old_line_content": null,
          "new_line_content": "        for (int i = 0; i < PageCount(); i++) {",
          "content_same": true
        },
        {
          "line": 1434,
          "old_api": "return NULL;",
          "new_api": "if (!clone || !(_fi",
          "old_text": "  return NULL;\n    ",
          "new_text": "if (!clone || !(_fi",
          "old_line_content": "            free(imageRects[i]);",
          "new_line_content": "            free(pageAnnots[i]);",
          "content_same": false
        },
        {
          "line": 1436,
          "old_api": "if (!_decrypt",
          "new_api": "fileName, pwdUI)",
          "old_text": "   if (!_decrypt",
          "new_text": "fileName, pwdUI)",
          "old_line_content": "        free(imageRects);",
          "new_line_content": "        free(pageAnnots);",
          "content_same": false
        },
        {
          "line": 1439,
          "old_api": "{\n        delete",
          "new_api": "dele",
          "old_text": "{\n        delete",
          "new_text": "       dele",
          "old_line_content": "    while (runCache.Count() > 0) {",
          "new_line_content": "        for (int i = 0; i < PageCount(); i++) {",
          "content_same": false
        },
        {
          "line": 1440,
          "old_api": "clone->",
          "new_api": "rn NULL;\n    }",
          "old_text": "        clone->",
          "new_text": "rn NULL;\n    }\n    ",
          "old_line_content": "        assert(runCache.Last()->refs == 1);",
          "new_line_content": "            free(imageRects[i]);",
          "content_same": false
        },
        {
          "line": 1446,
          "old_api": "dEmbedMarks",
          "new_api": "clone->_decry",
          "old_text": "dEmbedMarks(const WC",
          "new_text": "  clone->_decry",
          "old_line_content": "    fz_free_context(ctx);",
          "new_line_content": "        assert(runCache.Last()->refs == 1);",
          "content_same": false
        },
        {
          "line": 1452,
          "old_api": "R *c = fileName + st",
          "new_api": "Marks",
          "old_text": "R *c = fileName + st",
          "new_text": "Marks(const WCHAR *f",
          "old_line_content": "    free(_decryptionKey);",
          "new_line_content": "    fz_free_context(ctx);",
          "content_same": false
        },
        {
          "line": 1455,
          "old_api": "if (*c == ':') {\n            i",
          "new_api": "*embedMarks = NU",
          "old_text": "   if (*c == ':') {\n            i",
          "new_text": " *embedMarks = NU",
          "old_line_content": "    DeleteCriticalSection(&ctxAccess);",
          "new_line_content": "    free(_mediaboxes);",
          "content_same": false
        },
        {
          "line": 1457,
          "old_api": "k;\n            if (++colonCount % 2",
          "new_api": "for (const WCH",
          "old_text": "k;\n            if (++colonCount % 2",
          "new_text": " for (const WCH",
          "old_line_content": "    DeleteCriticalSection(&pagesAccess);",
          "new_line_content": "    free(_fileName);",
          "content_same": false
        },
        {
          "line": 1552,
          "old_api": "gned char digest[16 + 32] = {",
          "new_api": "e",
          "old_text": "gned char digest[16 + 32] = {",
          "new_text": "e(stm);\n    }\n    fz_cat",
          "old_line_content": "    if (!embedMarks || !pdf_is_stream(_doc, num, gen))",
          "new_line_content": "    if (str::IsEmpty(embedMarks))",
          "content_same": false
        },
        {
          "line": 1556,
          "old_api": "ok = false, sa",
          "new_api": "if (!isProtected)\n        return true;",
          "old_text": "ok = false, sa",
          "new_text": "    if (!isProtected)\n        return true;\n\n ",
          "old_line_content": "    fz_var(buffer);",
          "new_line_content": "    embedMarks = (WCHAR *)str::Parse(embedMarks, L\":%d:%d\", &num, &gen);",
          "content_same": false
        },
        {
          "line": 1558,
          "old_api": "ScopedMem<WCHAR> pwd(pwdUI->G",
          "new_api": "har digest[16 + 32] = { 0 };",
          "old_text": "  ScopedMem<WCHAR> pwd(pwdUI->G",
          "new_text": "har digest[16 + 32] = { 0 };\n",
          "old_line_content": "        buffer = pdf_load_stream(_doc, num, gen);",
          "new_line_content": "    if (!embedMarks || !pdf_is_stream(_doc, num, gen))",
          "content_same": false
        },
        {
          "line": 1562,
          "old_api": "// password not g",
          "new_api": "alse, saveKey",
          "old_text": "          // password not g",
          "new_text": "alse, saveKey ",
          "old_line_content": "        fz_drop_buffer(ctx, buffer);",
          "new_line_content": "    fz_var(buffer);",
          "content_same": false
        },
        {
          "line": 1568,
          "old_api": ";\n            break;",
          "new_api": "// password not given o",
          "old_text": ";\n            break;\n   ",
          "new_text": "    // password not given o",
          "old_line_content": "    pdf_close_document(_doc);",
          "new_line_content": "        fz_drop_buffer(ctx, buffer);",
          "content_same": false
        },
        {
          "line": 1582,
          "old_api": "// for crypt revisions 5",
          "new_api": "= pwd_utf8 && pdf_authenticate_pa",
          "old_text": "    // for crypt revisions 5",
          "new_text": " = pwd_utf8 && pdf_authenticate_pa",
          "old_line_content": "        stm = fz_open_istream(ctx, stream);",
          "new_line_content": "    assert(!_fileName && !_doc && ctx);",
          "content_same": false
        },
        {
          "line": 1624,
          "old_api": "}\n    }\n\n    if (",
          "new_api": "(pwd_cp1252))",
          "old_text": "       }\n    }\n\n    if (",
          "new_text": "(pwd_cp1252))",
          "old_line_content": "    isProtected = pdf_needs_password(_doc);",
          "new_line_content": "        fz_close(stm);",
          "content_same": false
        },
        {
          "line": 1658,
          "old_api": "(ctx) {",
          "new_api": "d_outline",
          "old_text": "(ctx) {\n",
          "new_text": "d_outline(_doc);\n    }",
          "old_line_content": "        if (!ok && GetACP() != 1252) {",
          "new_line_content": "                pwd_utf8.Set(str::conv::ToUtf8(pwd));",
          "content_same": false
        },
        {
          "line": 1667,
          "old_api": "(pdf_trailer(_doc),",
          "new_api": "onary, as accessing the origi",
          "old_text": "(pdf_trailer(_doc),",
          "new_text": "onary, as accessing the origi",
          "old_line_content": "        memcpy(digest + 16, pdf_crypt_key(_doc), 32);",
          "new_line_content": "            pwd_utf8.Set(str::conv::ToUtf8(pwd_cp1252));",
          "content_same": false
        },
        {
          "line": 1668,
          "old_api": "_info = pd",
          "new_api": "and we don't want to block for this when",
          "old_text": "        _info = pd",
          "new_text": "and we don't want to block for this when\n",
          "old_line_content": "        _decryptionKey = _MemToHex(&digest);",
          "new_line_content": "            ok = pwd_utf8 && pdf_authenticate_password(_doc, pwd_utf8);",
          "content_same": false
        },
        {
          "line": 1684,
          "old_api": "));\n        if (pdf_to_bool(pdf_dict_",
          "new_api": "is point\n        if (",
          "old_text": "));\n        if (pdf_to_bool(pdf_dict_",
          "new_text": "is point\n        if (",
          "old_line_content": "        fz_warn(ctx, \"document has no pages\");",
          "new_line_content": "        pdf_count_pages(_doc);",
          "content_same": false
        },
        {
          "line": 1689,
          "old_api": "// al",
          "new_api": "\", pdf_new_",
          "old_text": "      // al",
          "new_text": "\", pdf_new_",
          "old_line_content": "    _pageObjs = AllocArray<pdf_obj *>(PageCount());",
          "new_line_content": "    if (PageCount() == 0) {",
          "content_same": false
        },
        {
          "line": 1690,
          "old_api": "etc.)",
          "new_api": "if (pdf_to_bool(pdf_dict_getp(p",
          "old_text": " etc.)\n    ",
          "new_text": "      if (pdf_to_bool(pdf_dict_getp(p",
          "old_line_content": "    _mediaboxes = AllocArray<RectD>(PageCount());",
          "new_line_content": "        fz_warn(ctx, \"document has no pages\");",
          "content_same": false
        },
        {
          "line": 1706,
          "old_api": "pdf",
          "new_api": "t_gets",
          "old_text": "                   pdf",
          "new_text": "t_gets(pdf_array_get(intents, i), \"",
          "old_line_content": "        outline = pdf_load_outline(_doc);",
          "new_line_content": "        pdf_load_page_objs(_doc, _pageObjs);",
          "content_same": false
        },
        {
          "line": 1719,
          "old_api": "\"Root/PageLabels\");\n        if (pagelabel",
          "new_api": "ties\");\n        pdf_drop_obj(_info);",
          "old_text": "\"Root/PageLabels\");\n        if (pagelabel",
          "new_text": "ties\");\n        pdf_drop_obj(_info);\n",
          "old_line_content": "        fz_warn(ctx, \"Couldn't load attachments\");",
          "new_line_content": "        fz_warn(ctx, \"Couldn't load outline\");",
          "content_same": false
        },
        {
          "line": 1725,
          "old_api": "BuildTocTree",
          "new_api": "PageLabels\");\n        if (pagelabels)",
          "old_text": "BuildTocTree(fz_o",
          "new_text": "PageLabels\");\n        if (pagelabels)\n   ",
          "old_line_content": "        _info = pdf_dict_gets(pdf_trailer(_doc), \"Info\");",
          "new_line_content": "        fz_warn(ctx, \"Couldn't load attachments\");",
          "content_same": false
        },
        {
          "line": 1731,
          "old_api": "= new PdfTocItem(",
          "new_api": "ocTree",
          "old_text": " = new PdfTocItem(",
          "new_text": "ocTree(fz_outline",
          "old_line_content": "        if (IsLinearizedFile())",
          "new_line_content": "        _info = pdf_dict_gets(pdf_trailer(_doc), \"Info\");",
          "content_same": false
        },
        {
          "line": 1733,
          "old_api": "entry->dest.kind",
          "new_api": "LL;\n\n    for (; entry; entry =",
          "old_text": "entry->dest.kind ",
          "new_text": "LL;\n\n    for (; entry; entry =",
          "old_line_content": "        if (pdf_to_bool(pdf_dict_getp(pdf_trailer(_doc), \"Root/MarkInfo/Marked\")))",
          "new_line_content": "            _info = pdf_copy_str_dict(_doc, _info);",
          "content_same": false
        },
        {
          "line": 1737,
          "old_api": "}\n\n    return node",
          "new_api": "PdfTocItem(name,",
          "old_text": "   }\n\n    return node",
          "new_text": " PdfTocItem(name, ",
          "old_line_content": "        if (pdf_is_array(intents)) {",
          "new_line_content": "        if (IsLinearizedFile())",
          "content_same": false
        },
        {
          "line": 1738,
          "old_api": "fTocItem *node = NULL;",
          "new_api": "y->is_open;\n        i",
          "old_text": "fTocItem *node = NULL;",
          "new_text": "y->is_open;\n        i",
          "old_line_content": "            pdf_obj *list = pdf_new_array(_doc, pdf_array_len(intents));",
          "new_line_content": "            pdf_dict_puts_drop(_info, \"Linearized\", pdf_new_bool(_doc, 1));",
          "content_same": false
        },
        {
          "line": 1739,
          "old_api": "line) {\n        node =",
          "new_api": ">dest.kind == FZ_",
          "old_text": "line) {\n        node =",
          "new_text": ">dest.kind == FZ_",
          "old_line_content": "            for (int i = 0; i < pdf_array_len(intents); i++) {",
          "new_line_content": "        if (pdf_to_bool(pdf_dict_getp(pdf_trailer(_doc), \"Root/MarkInfo/Marked\")))",
          "content_same": false
        },
        {
          "line": 1740,
          "old_api": ")\n            node->AddSi",
          "new_api": "if (entry->down)",
          "old_text": ")\n            node->AddSi",
          "new_text": "if (entry->down)\n    ",
          "old_line_content": "                pdf_obj *intent = pdf_dict_gets(pdf_array_get(intents, i), \"S\");",
          "new_line_content": "            pdf_dict_puts_drop(_info, \"Marked\", pdf_new_bool(_doc, 1));",
          "content_same": false
        },
        {
          "line": 1742,
          "old_api": "eDestination *PdfEngineImpl:",
          "new_api": "else",
          "old_text": "eDestination *PdfEngineImpl:",
          "new_text": "       else\n     ",
          "old_line_content": "                    pdf_array_push(list, intent);",
          "new_line_content": "        pdf_obj *intents = pdf_dict_getp(pdf_trailer(_doc), \"Root/OutputIntents\");",
          "content_same": false
        },
        {
          "line": 1744,
          "old_api": "e)\n{\n    ScopedCritSec scope(&ctxAccess);\n\n    S",
          "new_api": "em *node = NULL;\n    i",
          "old_text": "e)\n{\n    ScopedCritSec scope(&ctxAccess);\n\n    S",
          "new_text": "em *node = NULL;\n    i",
          "old_line_content": "            pdf_dict_puts_drop(_info, \"OutputIntents\", list);",
          "new_line_content": "            pdf_obj *list = pdf_new_array(_doc, pdf_array_len(intents));",
          "content_same": false
        },
        {
          "line": 1747,
          "old_api": "f8",
          "new_api": "ttachments, idCount",
          "old_text": "f8(name));\n    pdf_obj *dest = NULL;\n",
          "new_text": "ttachments, idCount",
          "old_line_content": "            pdf_dict_dels(_info, \"OutputIntents\");",
          "new_line_content": "                if (pdf_is_name(intent) && !pdf_is_indirect(intent) && str::StartsWith(pdf_to_name(intent), \"GTS_PDF\"))",
          "content_same": false
        },
        {
          "line": 1750,
          "old_api": "obj = pdf_new_string(_doc, name_utf8, (int)str::L",
          "new_api": "ScopedCritSec scope(&ctxAccess);\n\n    ScopedM",
          "old_text": "obj = pdf_new_string(_doc, name_utf8, (int)str::L",
          "new_text": "   ScopedCritSec scope(&ctxAccess);\n\n    ScopedM",
          "old_line_content": "        fz_warn(ctx, \"Couldn't load document properties\");",
          "new_line_content": "            pdf_dict_puts_drop(_info, \"OutputIntents\", list);",
          "content_same": false
        },
        {
          "line": 1757,
          "old_api": "ld",
          "new_api": "dest = pdf_l",
          "old_text": "        ld ",
          "new_text": "       dest = pdf_l",
          "old_line_content": "            _pagelabels = BuildPageLabelVec(pagelabels, PageCount());",
          "new_line_content": "        pdf_drop_obj(_info);",
          "content_same": false
        },
        {
          "line": 1763,
          "old_api": "(FZ_LINK_GOTO == ld.ki",
          "new_api": "ld = pdf_",
          "old_text": "(FZ_LINK_GOTO == ld.ki",
          "new_text": "  ld = pdf_",
          "old_line_content": "    AssertCrash(!pdf_js_supported(_doc));",
          "new_line_content": "            _pagelabels = BuildPageLabelVec(pagelabels, PageCount());",
          "content_same": false
        },
        {
          "line": 1887,
          "old_api": "op_display_list",
          "new_api": "isplay_list",
          "old_text": "op_display_list(ctx",
          "new_text": "isplay_list",
          "old_line_content": "    fz_free_device(dev);",
          "new_line_content": "    fz_var(dev);",
          "content_same": false
        },
        {
          "line": 1890,
          "old_api": ");\n\n        if",
          "new_api": "oc, page, dev, &fz_identity, NULL);\n        }\n        fz",
          "old_text": ");\n\n        if ",
          "new_text": "oc, page, dev, &fz_identity, NULL);\n        }\n        fz",
          "old_line_content": "    int pageNo = GetPageNo(page);",
          "new_line_content": "        fz_run_display_list(list, dev, &fz_identity, NULL, NULL);",
          "content_same": false
        },
        {
          "line": 1893,
          "old_api": "t Most Recently U",
          "new_api": "play_list",
          "old_text": "t Most Recently U",
          "new_text": "play_list(ctx, list",
          "old_line_content": "        fz_rect *rects = AllocArray<fz_rect>(positions.Count() + 1);",
          "new_line_content": "    fz_free_device(dev);",
          "content_same": false
        },
        {
          "line": 1896,
          "old_api": ">refs++;\n    re",
          "new_api": "if (list)",
          "old_text": ">refs++;\n    re",
          "new_text": "      if (list)",
          "old_line_content": "                rects[i] = positions.At(i).rect;",
          "new_line_content": "    int pageNo = GetPageNo(page);",
          "content_same": false
        },
        {
          "line": 1919,
          "old_api": ", page, &pagerec",
          "new_api": "nots",
          "old_text": ", page, &pagerec",
          "new_text": "nots(userAnnot",
          "old_line_content": "        for (size_t i = 0; i < runCache.Count(); i++) {",
          "new_line_content": "            result = runCache.At(i);",
          "content_same": false
        },
        {
          "line": 1925,
          "old_api": "ts",
          "new_api": ", &pagerect), ct",
          "old_text": "ts(pageAnnots,",
          "new_text": ", &pagerect), ct",
          "old_line_content": "                mem += runCache.At(i)->size_est;",
          "new_line_content": "        for (size_t i = 0; i < runCache.Count(); i++) {",
          "content_same": false
        },
        {
          "line": 1928,
          "old_api": "fz_catch(ct",
          "new_api": "ookie : NULL);",
          "old_text": "     fz_catch(ct",
          "new_text": "ookie : NULL);",
          "old_line_content": "            assert(runCache.Count() == MAX_PAGE_RUN_CACHE);",
          "new_line_content": "            if (i >= 2 && mem + runCache.At(i)->size_est >= MAX_PAGE_RUN_MEMORY)",
          "content_same": false
        },
        {
          "line": 1929,
          "old_api": "veCriticalSecti",
          "new_api": "true, page->tra",
          "old_text": "veCriticalSecti",
          "new_text": " true, page->tra",
          "old_line_content": "            DropPageRun(runCache.Last(), true);",
          "new_line_content": "                DropPageRun(runCache.At(i--), true);",
          "content_same": false
        },
        {
          "line": 1947,
          "old_api": "pageAnnots, dev, cl",
          "new_api": "page));\n        fz_try(ctx) {\n            fz_rect",
          "old_text": "pageAnnots, dev, cl",
          "new_text": "page));\n        fz_try(ctx) {\n            fz_rect",
          "old_line_content": "        fz_free_device(dev);",
          "new_line_content": "            pdf_run_page(_doc, page, dev, &fz_identity, NULL);",
          "content_same": false
        },
        {
          "line": 1950,
          "old_api": "pdf_run_page_with_usage(",
          "new_api": "_page",
          "old_text": " pdf_run_page_with_usage(",
          "new_text": "_page(_doc, page, &pagerect), c",
          "old_line_content": "            result = CreatePageRun(page, list);",
          "new_line_content": "            fz_drop_display_list(ctx, list);",
          "content_same": false
        },
        {
          "line": 1956,
          "old_api": "un_user_page_annots",
          "new_api": "un_page_with_usage",
          "old_text": "un_user_page_annots(pag",
          "new_text": "un_page_with_usage(_doc, ",
          "old_line_content": "        runCache.Remove(result);",
          "new_line_content": "            result = CreatePageRun(page, list);",
          "content_same": false
        },
        {
          "line": 1957,
          "old_api": "v, ctm, cliprect, cookie ? &",
          "new_api": "targetName, cookie ? &cooki",
          "old_text": "v, ctm, cliprect, cookie ? &",
          "new_text": " targetName, cookie ? &cooki",
          "old_line_content": "        runCache.InsertAt(0, result);",
          "new_line_content": "            runCache.InsertAt(0, result);",
          "content_same": false
        },
        {
          "line": 1976,
          "old_api": "x",
          "new_api": "rceRemove)\n{\n    ScopedCrit",
          "old_text": "x(int pageNo)\n{\n    assert(1 <= pageNo && pageNo <= PageCount());\n    if (!_me",
          "new_text": "rceRemove)\n{\n    ScopedCrit",
          "old_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, false, page->transparency);",
          "new_line_content": "    if (Target_View == target && (run = GetPageRun(page, !cacheRun)) != NULL) {",
          "content_same": false
        },
        {
          "line": 1977,
          "old_api": "IsEmpty",
          "new_api": ");\n    run->refs--;\n\n    if (0 =",
          "old_text": "-1].IsEmpty())\n        return _mediaboxes[pageNo-1];\n\n    pdf_obj *page = _pageObjs",
          "new_text": ");\n    run->refs--;\n\n    if (0 =",
          "old_line_content": "            fz_run_display_list(run->list, dev, ctm, cliprect, cookie ? &cookie->cookie : NULL);",
          "new_line_content": "        EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 1978,
          "old_api": "if (!page)\n        return RectD();\n\n    ScopedCritSec scope(&ctxAccess);",
          "new_api": "s) {\n        Sc",
          "old_text": "   if (!page)\n        return RectD();\n\n    ScopedCritSec scope(&ctxAccess);\n\n",
          "new_text": "s) {\n        Sc",
          "old_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, true, page->transparency);",
          "new_line_content": "        Vec<PageAnnotation> pageAnnots = fz_get_user_page_annots(userAnnots, GetPageNo(page));",
          "content_same": false
        },
        {
          "line": 1985,
          "old_api": "c, page, \"MediaBox\"), &mbox);",
          "new_api": "'s pdf_load_page\n    fz_rect mbox = fz_empty_rect, cbox = fz_empty_rect;\n    int rotate",
          "old_text": "c, page, \"MediaBox\"), &mbox);\n  ",
          "new_text": "'s pdf_load_page\n    fz_rect mbox = fz_empty_rect, cbox = fz_empty_rect;\n    int rotate ",
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "            fz_run_user_page_annots(pageAnnots, dev, ctm, cliprect, cookie ? &cookie->cookie : NULL);",
          "content_same": false
        },
        {
          "line": 1986,
          "old_api": "o_rect",
          "new_api": "userunit = 1.0;",
          "old_text": "o_rect(ctx, pdf_",
          "new_text": "userunit = 1.0;\n",
          "old_line_content": "        DropPageRun(run);",
          "new_line_content": "            fz_end_page(dev);",
          "content_same": false
        },
        {
          "line": 1992,
          "old_api": "fz_catch(ctx)",
          "new_api": "(ctx, pdf_lookup",
          "old_text": "  fz_catch(ctx)",
          "new_text": "(ctx, pdf_lookup",
          "old_line_content": "        Vec<PageAnnotation> pageAnnots = fz_get_user_page_annots(userAnnots, GetPageNo(page));",
          "new_line_content": "        DropPageRun(run);",
          "content_same": false
        },
        {
          "line": 1998,
          "old_api": "ate % 90) != 0)\n        rotate = 0;\n\n    // cf. pdf-page.c's pdf_bound_page",
          "new_api": "atch",
          "old_text": "ate % 90) != 0)\n        rotate = 0;\n\n    // cf. pdf-page.c's pdf_bound_page\n ",
          "new_text": "atch(ctx) { }\n ",
          "old_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, true, page->transparency);",
          "new_line_content": "        Vec<PageAnnotation> pageAnnots = fz_get_user_page_annots(userAnnots, GetPageNo(page));",
          "content_same": false
        },
        {
          "line": 2037,
          "old_api": "rect2 =",
          "new_api": "ntity, targ",
          "old_text": "rect2 =",
          "new_text": "ntity, targ",
          "old_line_content": "        return RectD();",
          "new_line_content": "    assert(1 <= pageNo && pageNo <= PageCount());",
          "content_same": false
        },
        {
          "line": 2054,
          "old_api": "o_rect",
          "new_api": "pl::Transform(RectD rect, int pageNo, float zoom, in",
          "old_text": "o_rect(rect);\n    fz_tr",
          "new_text": "pl::Transform(RectD rect, int pageNo, float zoom, in",
          "old_line_content": "    if (fz_is_empty_rect(&mbox)) {",
          "new_line_content": "        rotate = pdf_to_int(pdf_lookup_inherited_page_item(_doc, page, \"Rotate\"));",
          "content_same": false
        },
        {
          "line": 2055,
          "old_api": "&rect2, &ctm);\n    return fz_rect_to_RectD(rect2);\n}\n\nboo",
          "new_api": "fz_matrix ctm = viewctm(pa",
          "old_text": "&rect2, &ctm);\n    return fz_rect_to_RectD(rect2);\n}\n\nboo",
          "new_text": "\n    fz_matrix ctm = viewctm(pa",
          "old_line_content": "        fz_warn(ctx, \"cannot find page size for page %d\", pageNo);",
          "new_line_content": "        pdf_obj *obj = pdf_dict_gets(page, \"UserUnit\");",
          "content_same": false
        },
        {
          "line": 2060,
          "old_api": "eRect, RenderTarget target, Abo",
          "new_api": "(rect);\n    fz_transfor",
          "old_text": "eRect, RenderTarget target, Abo",
          "new_text": "(rect);\n    fz_transfor",
          "old_line_content": "        fz_intersect_rect(&mbox, &cbox);",
          "new_line_content": "    if (fz_is_empty_rect(&mbox)) {",
          "content_same": false
        },
        {
          "line": 2061,
          "old_api": "ie_out)\n{\n    if (!page",
          "new_api": ", &ctm);\n    return fz_rect_to_RectD(rect2);\n}\n\nbool PdfE",
          "old_text": "ie_out)\n{\n    if (!page",
          "new_text": ", &ctm);\n    return fz_rect_to_RectD(rect2);\n}\n\nbool PdfE",
          "old_line_content": "        if (fz_is_empty_rect(&mbox))",
          "new_line_content": "        fz_warn(ctx, \"cannot find page size for page %d\", pageNo);",
          "content_same": false
        },
        {
          "line": 2077,
          "old_api": "float)scree",
          "new_api": "else\n            pdf_bound_page(_doc, page, &pRect);\n        fz_irect",
          "old_text": "float)scree",
          "new_text": "      else\n            pdf_bound_page(_doc, page, &pRect);\n        fz_irect",
          "old_line_content": "    assert(1 <= pageNo && pageNo <= PageCount());",
          "new_line_content": "    _mediaboxes[pageNo-1] = RectD(0, 0, (mbox.x1 - mbox.x0) * userunit, (mbox.y1 - mbox.y0) * userunit);",
          "content_same": false
        },
        {
          "line": 2084,
          "old_api": "T",
          "new_api": "nRect.y - bbox.y0)",
          "old_text": "T();\n    FillRect(hDC, &tmpRect,",
          "new_text": "nRect.y - bbox.y0)",
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "    pdf_page *page = GetPdfPage(pageNo);",
          "content_same": false
        },
        {
          "line": 2086,
          "old_api": "round\n    DeleteObject(bgBrush",
          "new_api": "ateSoli",
          "old_text": "round\n    DeleteObject(bgBrush",
          "new_text": "ateSoli",
          "old_line_content": "        dev = fz_new_bbox_device(ctx, &rect);",
          "new_line_content": "        return RectD();",
          "content_same": false
        },
        {
          "line": 2090,
          "old_api": "ct) {",
          "new_api": "FillRect(hDC, &tmpRect, bgBru",
          "old_text": "ct) {\n ",
          "new_text": "   FillRect(hDC, &tmpRect, bgBru",
          "old_line_content": "        return RectD();",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2092,
          "old_api": "pageclip = fz_RectD_to_rect(*pa",
          "new_api": "DeleteObject(bgBrush);",
          "old_text": " pageclip = fz_RectD_to_rect(*pa",
          "new_text": "    DeleteObject(bgBrush);\n\n  ",
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "        dev = fz_new_bbox_device(ctx, &rect);",
          "content_same": false
        },
        {
          "line": 2095,
          "old_api": "ct",
          "new_api": "creenRect.Convert<double>());",
          "old_text": "ct(&cliprect, fz_transform_rect(&page",
          "new_text": "creenRect.Convert<double>());\n  ",
          "old_line_content": "    pdf_bound_page(_doc, page, &pagerect);",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2096,
          "old_api": "}\n    fz_irect tmp;\n    fz_rect_from_irect(&cliprect, fz_r",
          "new_api": "",
          "old_text": "}\n    fz_irect tmp;\n    fz_rect_from_irect(&cliprect, fz_r",
          "new_text": "       ",
          "old_line_content": "    bool ok = RunPage(page, dev, &fz_identity, target, &pagerect, false);",
          "new_line_content": "        return RectD();",
          "content_same": false
        },
        {
          "line": 2098,
          "old_api": "fz_device *dev = N",
          "new_api": "lip = fz_RectD_to_rect(*pageRect",
          "old_text": "  fz_device *dev = N",
          "new_text": "lip = fz_RectD_to_rect(*pageRect",
          "old_line_content": "        return PageMediabox(pageNo);",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2102,
          "old_api": "tx, hDC, &cliprect);",
          "new_api": "fz_irect tmp;\n    fz_rect_from_irect(&cliprect, fz_round_r",
          "old_text": "tx, hDC, &cliprect);\n ",
          "new_text": "fz_irect tmp;\n    fz_rect_from_irect(&cliprect, fz_round_r",
          "old_line_content": "    RectD rect2 = fz_rect_to_RectD(rect);",
          "new_line_content": "    bool ok = RunPage(page, dev, &fz_identity, target, &pagerect, false);",
          "content_same": false
        },
        {
          "line": 2108,
          "old_api": "cookie_out)\n        *cookie_out",
          "new_api": "C, &cliprect);\n    }",
          "old_text": "cookie_out)\n        *cookie_out",
          "new_text": "C, &cliprect);\n    }\n ",
          "old_line_content": "    fz_matrix ctm = viewctm(pageNo, zoom, rotation);",
          "new_line_content": "    RectD rect2 = fz_rect_to_RectD(rect);",
          "content_same": false
        },
        {
          "line": 2118,
          "old_api": "age);\n    if (!run)\n        ret",
          "new_api": "uristics for deciding when to",
          "old_text": "age);\n    if (!run)\n        ret",
          "new_text": "uristics for deciding when to ",
          "old_line_content": "    fz_matrix ctm = viewctm(pageNo, zoom, rotation);",
          "new_line_content": "    fz_transform_point(&pt2, &ctm);",
          "content_same": false
        },
        {
          "line": 2128,
          "old_api": "nts)\n        result =",
          "new_api": "f (run->clip_path_len > 50000)",
          "old_text": "nts)\n        result =",
          "new_text": "f (run->clip_path_len > 50000)\n",
          "old_line_content": "    if (!page || !pdf_is_dict(page->me))",
          "new_line_content": "    fz_transform_rect(&rect2, &ctm);",
          "content_same": false
        },
        {
          "line": 2139,
          "old_api": "pageBox;\n        fz_round_rect(&c",
          "new_api": "aths\n    // (only required wh",
          "old_text": " pageBox;\n        fz_round_rect(&c",
          "new_text": "aths\n    // (only required wh",
          "old_line_content": "            pdf_bound_page(_doc, page, &pRect);",
          "new_line_content": "        ctm2 = viewctm(page, zoom, rotation);",
          "content_same": false
        },
        {
          "line": 2143,
          "old_api": "x1 ||\n                 clipBox.y0 > pageBox.y0 || clipBox.y1 < pageBox.y1;\n    }",
          "new_api": "00) {\n        fz_rect r;",
          "old_text": "x1 ||\n                 clipBox.y0 > pageBox.y0 || clipBox.y1 < pageBox.y1;\n    }\n ",
          "new_text": "00) {\n        fz_rect r;\n  ",
          "old_line_content": "        fz_concat(&ctm2, ctm, fz_translate(&trans, (float)screenRect.x - bbox.x0, (float)screenRect.y - bbox.y0));",
          "new_line_content": "            pRect = fz_RectD_to_rect(*pageRect);",
          "content_same": false
        },
        {
          "line": 2147,
          "old_api": "No, float zoom, int",
          "new_api": "(_doc, page, &r));\n        res",
          "old_text": "No, float zoom, int",
          "new_text": "(_doc, page, &r));\n        res",
          "old_line_content": "    RECT tmpRect = screenRect.ToRECT();",
          "new_line_content": "        fz_round_rect(&bbox, fz_transform_rect(&pRect, ctm));",
          "content_same": false
        },
        {
          "line": 2149,
          "old_api": "pdf_page* page =",
          "new_api": "clipBox.y0 > pageBox.y0 || clipBox.y1 < pageBox.y1;\n    }\n    Dro",
          "old_text": "    pdf_page* page = ",
          "new_text": "                 clipBox.y0 > pageBox.y0 || clipBox.y1 < pageBox.y1;\n    }\n    Dro",
          "old_line_content": "    DeleteObject(bgBrush);",
          "new_line_content": "        fz_concat(&ctm2, ctm, fz_translate(&trans, (float)screenRect.x - bbox.x0, (float)screenRect.y - bbox.y0));",
          "content_same": false
        },
        {
          "line": 2153,
          "old_api": "pRect = fz_RectD_to_rect",
          "new_api": "oat zoom, int rotat",
          "old_text": "   pRect = fz_RectD_to_rect",
          "new_text": "oat zoom, int rotat",
          "old_line_content": "        fz_rect pageclip = fz_RectD_to_rect(*pageRect);",
          "new_line_content": "    RECT tmpRect = screenRect.ToRECT();",
          "content_same": false
        },
        {
          "line": 2154,
          "old_api": "page",
          "new_api": "ctD *pageRect, RenderTarget targ",
          "old_text": "page(_doc, page, &pRect);\n    fz_",
          "new_text": "ctD *pageRect, RenderTarget targ",
          "old_line_content": "        fz_intersect_rect(&cliprect, fz_transform_rect(&pageclip, ctm));",
          "new_line_content": "    FillRect(hDC, &tmpRect, bgBrush); // initialize white background",
          "content_same": false
        },
        {
          "line": 2157,
          "old_api": "t;\n    fz_irect bbox;\n    fz_r",
          "new_api": "age->me))\n        return NUL",
          "old_text": "t;\n    fz_irect bbox;\n    fz_r",
          "new_text": "age->me))\n        return NUL",
          "old_line_content": "    fz_rect_from_irect(&cliprect, fz_round_rect(&tmp, &cliprect));",
          "new_line_content": "    fz_rect cliprect = fz_RectD_to_rect(screenRect.Convert<double>());",
          "content_same": false
        },
        {
          "line": 2160,
          "old_api": "&ctm));\n\n    if (PreferGdiPlusD",
          "new_api": "doc, page, &pRect);\n    fz_matrix",
          "old_text": " &ctm));\n\n    if (PreferGdiPlusD",
          "new_text": "doc, page, &pRect);\n    fz_matrix",
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "        fz_intersect_rect(&cliprect, fz_transform_rect(&pageclip, ctm));",
          "content_same": false
        },
        {
          "line": 2168,
          "old_api": "float)-bbox.x0, (float)-bbox.y0)",
          "new_api": "evice) {\n        int w = bbox.x1 - bbox.x0",
          "old_text": "float)-bbox.x0, (float)-bbox.y0)",
          "new_text": "evice) {\n        int w = bbox.x1 - bbox.x0",
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "        dev = fz_new_gdiplus_device(ctx, hDC, &cliprect);",
          "content_same": false
        },
        {
          "line": 2179,
          "old_api": "ct);\n        boo",
          "new_api": "= CreateMemoryBitmap(SizeI(w, h), &hMap);\n        HDC h",
          "old_text": "ct);\n        boo",
          "new_text": " = CreateMemoryBitmap(SizeI(w, h), &hMap);\n        HDC h",
          "old_line_content": "    PdfPageRun *run = GetPageRun(page);",
          "new_line_content": "    return RunPage(page, dev, ctm, target, &cliprect, true, cookie);",
          "content_same": false
        },
        {
          "line": 2209,
          "old_api": "ScopedCritSec s",
          "new_api": "ie = NULL;\n    i",
          "old_text": "   ScopedCritSec s",
          "new_text": "ie = NULL;\n    i",
          "old_line_content": "    pdf_page* page = GetPdfPage(pageNo);",
          "new_line_content": "    DropPageRun(run);",
          "content_same": false
        },
        {
          "line": 2215,
          "old_api": "z_drop_pixmap",
          "new_api": "pedCritSec scope(&",
          "old_text": "z_drop_pixmap(ctx, image);\n",
          "new_text": "pedCritSec scope(&",
          "old_line_content": "        pRect = fz_RectD_to_rect(*pageRect);",
          "new_line_content": "    pdf_page* page = GetPdfPage(pageNo);",
          "content_same": false
        },
        {
          "line": 2221,
          "old_api": "fz_point p = { (float)pt.x,",
          "new_api": "_pixmap",
          "old_text": "fz_point p = { (float)pt.x,",
          "new_text": "_pixmap(ctx, image);\n    re",
          "old_line_content": "    fz_round_rect(&bbox, fz_transform_rect(&r, &ctm));",
          "new_line_content": "        pRect = fz_RectD_to_rect(*pageRect);",
          "content_same": false
        },
        {
          "line": 2223,
          "old_api": ";\n    for (fz_link *link = page->links",
          "new_api": "lement *PdfEngineImpl::GetElementA",
          "old_text": ";\n    for (fz_link *link = page->links",
          "new_text": "lement *PdfEngineImpl::GetElementA",
          "old_line_content": "    if (PreferGdiPlusDevice(page, zoom, pRect) != gDebugGdiPlusDevice) {",
          "new_line_content": "        pdf_bound_page(_doc, page, &pRect);",
          "content_same": false
        },
        {
          "line": 2232,
          "old_api": "if (fz_is_pt_in_",
          "new_api": "nk->dest, link->rect, pageNo, &p);\n    }\n\n    if (page",
          "old_text": "       if (fz_is_pt_in_",
          "new_text": "nk->dest, link->rect, pageNo, &p);\n    }\n\n    if (page",
          "old_line_content": "        HDC hDCMem = CreateCompatibleDC(hDC);",
          "new_line_content": "        fz_concat(&ctm, &ctm, fz_translate(&trans, (float)-bbox.x0, (float)-bbox.y0));",
          "content_same": false
        },
        {
          "line": 2236,
          "old_api": ":conv::FromPdf(pdf_dict",
          "new_api": "annot->rec",
          "old_text": ":conv::FromPdf(pdf_dict",
          "new_text": " annot->rec",
          "old_line_content": "        RectD pageRect2 = fz_rect_to_RectD(pRect);",
          "new_line_content": "        HBITMAP hbmp = CreateMemoryBitmap(SizeI(w, h), &hMap);",
          "content_same": false
        },
        {
          "line": 2237,
          "old_api": "ntents\")));\n                return new PdfComment(contents, fz_rect_to_R",
          "new_api": "ect",
          "old_text": "ntents\")));\n                return new PdfComment(contents, fz_rect_to_R",
          "new_text": "ect(&rect, ",
          "old_line_content": "        bool ok = RenderPage(hDCMem, page, rc, &ctm, 0, 0, &pageRect2, target, cookie_out);",
          "new_line_content": "        HDC hDC = GetDC(NULL);",
          "content_same": false
        },
        {
          "line": 2238,
          "old_api": "pageNo);",
          "new_api": "if (fz_is_pt_in_rect(r",
          "old_text": " pageNo);\n      ",
          "new_text": " if (fz_is_pt_in_rect(r",
          "old_line_content": "        DeleteDC(hDCMem);",
          "new_line_content": "        HDC hDCMem = CreateCompatibleDC(hDC);",
          "content_same": false
        },
        {
          "line": 2239,
          "old_api": "}\n    }\n\n    if",
          "new_api": "ScopedCritSec scope(&ct",
          "old_text": "     }\n    }\n\n    if",
          "new_text": "   ScopedCritSec scope(&ct",
          "old_line_content": "        ReleaseDC(NULL, hDC);",
          "new_line_content": "        DeleteObject(SelectObject(hDCMem, hbmp));",
          "content_same": false
        },
        {
          "line": 2242,
          "old_api": "ct",
          "new_api": ":FromPdf(pdf_dict_gets(",
          "old_text": "ct(&imageRects[pa",
          "new_text": ":FromPdf(pdf_dict_gets(",
          "old_line_content": "            CloseHandle(hMap);",
          "new_line_content": "        RectD pageRect2 = fz_rect_to_RectD(pRect);",
          "content_same": false
        },
        {
          "line": 2245,
          "old_api": "",
          "new_api": "}\n\n    if (imag",
          "old_text": "           ",
          "new_text": "\n    }\n\n    if (imag",
          "old_line_content": "        return new RenderedBitmap(hbmp, SizeI(w, h), hMap);",
          "new_line_content": "        ReleaseDC(NULL, hDC);",
          "content_same": false
        },
        {
          "line": 2251,
          "old_api": "nt pageNo)\n{\n    p",
          "new_api": "r",
          "old_text": "nt pageNo)\n{\n    p",
          "new_text": "          r",
          "old_line_content": "        fz_colorspace *colorspace = fz_device_rgb(ctx);",
          "new_line_content": "        return new RenderedBitmap(hbmp, SizeI(w, h), hMap);",
          "content_same": false
        },
        {
          "line": 2262,
          "old_api": "(imageRects[pageNo-1]) {",
          "new_api": "whole list at the end\n    Vec<Pa",
          "old_text": "(imageRects[pageNo-1]) {\n     ",
          "new_text": "whole list at the end\n    Vec<Pa",
          "old_line_content": "        dev = fz_new_draw_device(ctx, image);",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2275,
          "old_api": "rect rect = annot->rect;",
          "new_api": ");\n    }\n\n    if (pageAnnots[pag",
          "old_text": "rect rect = annot->rect;\n           ",
          "new_text": ");\n    }\n\n    if (pageAnnots[pag",
          "old_line_content": "    bool ok = RunPage(page, dev, &ctm, target, fz_rect_from_irect(&cliprect, &bbox), true, cookie);",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2281,
          "old_api": "tents\")));\n            els->Append",
          "new_api": "ect = annot->rect;\n            fz_tr",
          "old_text": "tents\")));\n            els->Append",
          "new_text": "ect = annot->rect;\n            fz_tr",
          "old_line_content": "        bitmap = new_rendered_fz_pixmap(ctx, image);",
          "new_line_content": "    bool ok = RunPage(page, dev, &ctm, target, fz_rect_from_irect(&cliprect, &bbox), true, cookie);",
          "content_same": false
        },
        {
          "line": 2288,
          "old_api": "(link->dest.kind != FZ_L",
          "new_api": "nt",
          "old_text": "(link->dest.kind != FZ_L",
          "new_text": "nt(contents, fz_rect_to_Re",
          "old_line_content": "    pdf_page *page = GetPdfPage(pageNo, true);",
          "new_line_content": "    fz_drop_pixmap(ctx, image);",
          "content_same": false
        },
        {
          "line": 2294,
          "old_api": "age->links = FixupPageLinks(pag",
          "new_api": ">dest.kind != FZ_LINK_NO",
          "old_text": "age->links = FixupPageLinks(pag",
          "new_text": ">dest.kind != FZ_LINK_NO",
          "old_line_content": "        if (link->dest.kind != FZ_LINK_NONE && fz_is_pt_in_rect(link->rect, p))",
          "new_line_content": "    pdf_page *page = GetPdfPage(pageNo, true);",
          "content_same": false
        },
        {
          "line": 2313,
          "old_api": "i.uri = fz_strdup(ctx, uri);\n            /",
          "new_api": "At",
          "old_text": "i.uri = fz_strdup(ctx, uri);\n            /",
          "new_text": "(list->links.At(i)));\n",
          "old_line_content": "        for (size_t i = 0; !fz_is_empty_rect(&imageRects[pageNo-1][i]); i++)",
          "new_line_content": "                return new PdfComment(contents, fz_rect_to_RectD(rect), pageNo);",
          "content_same": false
        },
        {
          "line": 2352,
          "old_api": "page->links = link;\n                // TODO: e",
          "new_api": "// add",
          "old_text": "\n                page->links = link;\n                // TODO: e",
          "new_text": "                // add",
          "old_line_content": "            els->Append(new PdfLink(this, &link->dest, link->rect, pageNo));",
          "new_line_content": "            els->Append(new PdfComment(contents, fz_rect_to_RectD(rect), pageNo));",
          "content_same": false
        },
        {
          "line": 2362,
          "old_api": "ents\")))) {",
          "new_api": "e file path",
          "old_text": "ents\")))) {\n               ",
          "new_text": "e file path\n  ",
          "old_line_content": "    page->links = FixupPageLinks(page->links);",
          "new_line_content": "    els->Reverse();",
          "content_same": false
        },
        {
          "line": 2376,
          "old_api": "age)\n        retu",
          "new_api": "Count",
          "old_text": "age)\n        retu",
          "new_text": "nnots.Count() == 0)\n        r",
          "old_line_content": "            ScopedMem<char> uri(str::conv::ToUtf8(list->links.At(i)));",
          "new_line_content": "    LinkRectList *list = LinkifyText(pageText, coords);",
          "content_same": false
        },
        {
          "line": 2404,
          "old_api": "fz_text_sheet *sheet = NULL",
          "new_api": "tch",
          "old_text": "\n    fz_text_sheet *sheet = NULL",
          "new_text": "tch(ctx) {\n        return",
          "old_line_content": "                ld.ld.launch.file_spec = pdf_file_spec_to_str(_doc, file);",
          "new_line_content": "            pdf_obj *embedded = pdf_dict_getsa(pdf_dict_gets(file, \"EF\"), \"DOS\", \"F\");",
          "content_same": false
        },
        {
          "line": 2406,
          "old_api": "t);\n\n    EnterCritic",
          "new_api": "p);\n    fz_drop_pixmap(ctx, pixma",
          "old_text": "t);\n\n    EnterCritic",
          "new_text": "p);\n    fz_drop_pixmap(ctx, pixma",
          "old_line_content": "                ld.ld.launch.embedded_num = pdf_to_num(embedded);",
          "new_line_content": "            pdf_to_rect(ctx, pdf_dict_gets(annot->obj, \"Rect\"), &rect);",
          "content_same": false
        },
        {
          "line": 2407,
          "old_api": "sheet = fz_new_tex",
          "new_api": "tractPageText",
          "old_text": "  sheet = fz_new_tex",
          "new_text": "tractPageText(pdf_page ",
          "old_line_content": "                ld.ld.launch.embedded_gen = pdf_to_gen(embedded);",
          "new_line_content": "            if (file && embedded && !fz_is_empty_rect(&rect)) {",
          "content_same": false
        },
        {
          "line": 2417,
          "old_api": "etween cached runs u",
          "new_api": "LeaveCriticalSection(&c",
          "old_text": "etween cached runs u",
          "new_text": "    LeaveCriticalSection(&c",
          "old_line_content": "                annots.Append(annot);",
          "new_line_content": "                fz_link *link = fz_new_link(ctx, &rect, ld);",
          "content_same": false
        },
        {
          "line": 2431,
          "old_api": ";\n\n    return conte",
          "new_api": "content = NULL",
          "old_text": ";\n\n    return conte",
          "new_text": "content = NULL",
          "old_line_content": "    annots.Append(NULL);",
          "new_line_content": "    if (annots.Count() == 0)",
          "content_same": false
        },
        {
          "line": 2437,
          "old_api": "ageNo, true);",
          "new_api": "return content;\n}",
          "old_text": "ageNo, true);\n    ",
          "new_text": " return content;\n}\n",
          "old_line_content": "    pdf_page *page = GetPdfPage(pageNo);",
          "new_line_content": "    annots.Append(NULL);",
          "content_same": false
        },
        {
          "line": 2453,
          "old_api": "ExtractPageText(page, lineSep,",
          "new_api": "ch",
          "old_text": " ExtractPageText(page, lineSep, ",
          "new_text": "ch(ctx) {\n        LeaveCriticalSecti",
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "        dev = fz_new_inspection_device(ctx, &data);",
          "content_same": false
        },
        {
          "line": 2472,
          "old_api": "pdf_xref_len",
          "new_api": "oc->file, 0, 0);",
          "old_text": "pdf_xref_len(_doc))\n        return ",
          "new_text": "oc->file, 0, 0);\n    ",
          "old_line_content": "    RenderedBitmap *bmp = new_rendered_fz_pixmap(ctx, pixmap);",
          "new_line_content": "        fz_image *image = positions.At(imageIx).image;",
          "content_same": false
        },
        {
          "line": 2473,
          "old_api": "// check whether it's a",
          "new_api": "le, &_doc->lexbuf.base);\n    if (tok != PDF_TOK_INT)",
          "old_text": "    // check whether it's a",
          "new_text": "le, &_doc->lexbuf.base);\n    if (tok != PDF_TOK_INT)\n   ",
          "old_line_content": "    fz_drop_pixmap(ctx, pixmap);",
          "new_line_content": "        pixmap = fz_new_pixmap_from_image(ctx, image, image->w, image->h);",
          "content_same": false
        },
        {
          "line": 2492,
          "old_api": "dict_gets",
          "new_api": "if (pdf_to",
          "old_text": "dict_gets(obj, \"L\")) ",
          "new_text": "   if (pdf_to",
          "old_line_content": "        text = fz_new_text_page(ctx);",
          "new_line_content": "    fz_var(sheet);",
          "content_same": false
        },
        {
          "line": 2493,
          "old_api": "e)\n        return false;\n    // /O m",
          "new_api": "df_dict_gets",
          "old_text": "e)\n        return false;\n    // /O m",
          "new_text": "df_dict_gets",
          "old_line_content": "        dev = fz_new_text_device(ctx, sheet, text);",
          "new_line_content": "    fz_var(text);",
          "content_same": false
        },
        {
          "line": 2497,
          "old_api": "j, \"O\")) != pdf_to_num(_pageOb",
          "new_api": "file size\n    if (pdf",
          "old_text": "j, \"O\")) != pdf_to_num(_pageOb",
          "new_text": " file size\n    if (pdf",
          "old_line_content": "        fz_free_text_sheet(ctx, sheet);",
          "new_line_content": "        sheet = fz_new_text_sheet(ctx);",
          "content_same": false
        },
        {
          "line": 2498,
          "old_api": "return false;\n    // /N mus",
          "new_api": "ets",
          "old_text": "     return false;\n    // /N mus",
          "new_text": "ets(obj, \"L\")) != _do",
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "        text = fz_new_text_page(ctx);",
          "content_same": false
        },
        {
          "line": 2504,
          "old_api": "turn false;\n    // /H must be an array a",
          "new_api": "eturn false;\n    // /N must be t",
          "old_text": "turn false;\n    // /H must be an array a",
          "new_text": "eturn false;\n    // /N must be t",
          "old_line_content": "        fz_enable_device_hints(dev, FZ_NO_CACHE);",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2515,
          "old_api": "Contains",
          "new_api": "t_gets",
          "old_text": " if (font && !fontList.Contains(font))\n       ",
          "new_text": "t_gets(res, \"Font\");\n    for (int k = 0; k < pdf_dict_le",
          "old_line_content": "        content = fz_text_page_to_str(text, lineSep, coords_out);",
          "new_line_content": "    bool ok = RunPage(page, dev, &fz_identity, target, NULL, cacheRun);",
          "content_same": false
        },
        {
          "line": 2530,
          "old_api": "nmark_obj",
          "new_api": ", k);\n        pdf_obj *x",
          "old_text": "nmark_obj(xobj);\n        }\n    }\n}\n\nWCHAR *PdfEngineImpl::E",
          "new_text": ", k);\n        pdf_obj *x",
          "old_line_content": "        page = pdf_load_page_by_obj(_doc, pageNo - 1, _pageObjs[pageNo-1]);",
          "new_line_content": "    pdf_page *page = GetPdfPage(pageNo, true);",
          "content_same": false
        },
        {
          "line": 2536,
          "old_api": "t i = 1; i <= PageCount(); i++)",
          "new_api": "obj",
          "old_text": "t i = 1; i <= PageCount(); i++) ",
          "new_text": "obj(xobj);\n        }\n    }\n}\n\nWCHAR *PdfEngineImpl::Extract",
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "        page = pdf_load_page_by_obj(_doc, pageNo - 1, _pageObjs[pageNo-1]);",
          "content_same": false
        },
        {
          "line": 2542,
          "old_api": "tract_fonts",
          "new_api": "1; i <= PageCount(); i++) {",
          "old_text": "tract_fonts(page->resources, fon",
          "new_text": "1; i <= PageCount(); i++) {\n    ",
          "old_line_content": null,
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": true
        },
        {
          "line": 2562,
          "old_api": "pdf_obj *font2 =",
          "new_api": "const char *",
          "old_text": "   pdf_obj *font2 =",
          "new_text": "      const char *",
          "old_line_content": "    fz_catch(_doc->ctx) {",
          "new_line_content": "    if (num < 0 || num >= pdf_xref_len(_doc))",
          "content_same": false
        },
        {
          "line": 2565,
          "old_api": ", 0);\n            if (!font2)",
          "new_api": "fz_try",
          "old_text": ", 0);\n            if (!font2)",
          "new_text": "fz_try(ctx) {\n   ",
          "old_line_content": "    pdf_obj *obj = pdf_get_xref_entry(_doc, num)->obj;",
          "new_line_content": "    fz_try(_doc->ctx) {",
          "content_same": false
        },
        {
          "line": 2566,
          "old_api": "font2 = font;",
          "new_api": "At",
          "old_text": "font2 = font;\n\n ",
          "new_text": "_obj *font = fontList.At(i);\n ",
          "old_line_content": "    if (!pdf_is_dict(obj))",
          "new_line_content": "        pdf_cache_object(_doc, num, 0);",
          "content_same": false
        },
        {
          "line": 2572,
          "old_api": "se;\n            pdf_obj",
          "new_api": "= font;",
          "old_text": "se;\n            pdf_obj",
          "new_text": "= font;\n\n       ",
          "old_line_content": "    if (pdf_to_int(pdf_dict_gets(obj, \"L\")) != _doc->file_size)",
          "new_line_content": "    if (!pdf_is_dict(obj))",
          "content_same": false
        },
        {
          "line": 2575,
          "old_api": "File3\")))",
          "new_api": "pty",
          "old_text": "File3\")))\n              ",
          "new_text": "pty(name))\n                fz_th",
          "old_line_content": "    if (pdf_to_int(pdf_dict_gets(obj, \"O\")) != pdf_to_num(_pageObjs[0]))",
          "new_line_content": "    if (pdf_to_real(pdf_dict_gets(obj, \"Linearized\")) != 1.0f)",
          "content_same": false
        },
        {
          "line": 2578,
          "old_api": "type",
          "new_api": "pdf_obj *desc",
          "old_text": "       type",
          "new_text": "          pdf_obj *desc",
          "old_line_content": "    if (pdf_to_int(pdf_dict_gets(obj, \"N\")) != PageCount())",
          "new_line_content": "    if (pdf_to_int(pdf_dict_gets(obj, \"L\")) != _doc->file_size)",
          "content_same": false
        },
        {
          "line": 2581,
          "old_api": "type2 = pdf_to_name(pdf",
          "new_api": ")))\n                embe",
          "old_text": "type2 = pdf_to_name(pdf",
          "new_text": ")))\n                embe",
          "old_line_content": "    return pdf_is_array(pdf_dict_gets(obj, \"H\")) &&",
          "new_line_content": "    if (pdf_to_int(pdf_dict_gets(obj, \"O\")) != pdf_to_num(_pageObjs[0]))",
          "content_same": false
        },
        {
          "line": 2588,
          "old_api": "= \"TrueType (CID)\";",
          "new_api": "if (str::E",
          "old_text": " = \"TrueType (CID)\";\n     ",
          "new_text": "             if (str::E",
          "old_line_content": "    pdf_obj *fonts = pdf_dict_gets(res, \"Font\");",
          "new_line_content": "           pdf_is_int(pdf_dict_gets(obj, \"E\")) &&",
          "content_same": false
        },
        {
          "line": 2589,
          "old_api": "ing = pdf_to_name(p",
          "new_api": "type",
          "old_text": "ing = pdf_to_name(p",
          "new_text": "                  type ",
          "old_line_content": "    for (int k = 0; k < pdf_dict_len(fonts); k++) {",
          "new_line_content": "           pdf_is_int(pdf_dict_gets(obj, \"T\"));",
          "content_same": false
        },
        {
          "line": 2595,
          "old_api": "g, \"MacExpertEncoding\"))",
          "new_api": "pdf_to_name",
          "old_text": "g, \"MacExpertEncoding\"))\n    ",
          "new_text": "pdf_to_name(pdf_dic",
          "old_line_content": "    pdf_obj *xobjs = pdf_dict_gets(res, \"XObject\");",
          "new_line_content": "    for (int k = 0; k < pdf_dict_len(fonts); k++) {",
          "content_same": false
        },
        {
          "line": 2596,
          "old_api": "ert\";\n        }",
          "new_api": "ding, \"WinAnsiEncoding\"))",
          "old_text": "ert\";\n        }\n   ",
          "new_text": "ding, \"WinAnsiEncoding\"))\n",
          "old_line_content": "    for (int k = 0; k < pdf_dict_len(xobjs); k++) {",
          "new_line_content": "        pdf_obj *font = pdf_resolve_indirect(pdf_dict_get_val(fonts, k));",
          "content_same": false
        },
        {
          "line": 2597,
          "old_api": "ontinue;\n        }",
          "new_api": "= \"Ansi\";\n            e",
          "old_text": "ontinue;\n        }\n       ",
          "new_text": "= \"Ansi\";\n            e",
          "old_line_content": "        pdf_obj *xobj = pdf_dict_get_val(xobjs, k);",
          "new_line_content": "        if (font && !fontList.Contains(font))",
          "content_same": false
        },
        {
          "line": 2598,
          "old_api": "!encoding);\n\n        str::Str<ch",
          "new_api": "(encoding, \"MacRomanE",
          "old_text": "!encoding);\n\n        str::Str<ch",
          "new_text": "(encoding, \"MacRomanE",
          "old_line_content": "        pdf_obj *xres = pdf_dict_gets(xobj, \"Resources\");",
          "new_line_content": "            fontList.Append(font);",
          "content_same": false
        },
        {
          "line": 2601,
          "old_api": "Append",
          "new_api": "cExpertEncoding\"))",
          "old_text": " info.Append(ScopedM",
          "new_text": "cExpertEncoding\"))\n          ",
          "old_line_content": "            pdf_unmark_obj(xobj);",
          "new_line_content": "    pdf_obj *xobjs = pdf_dict_gets(res, \"XObject\");",
          "content_same": false
        },
        {
          "line": 2639,
          "old_api": "Level %d\", major,",
          "new_api": "{\n        int",
          "old_text": "Level %d\", major, ",
          "new_text": " {\n        int",
          "old_line_content": "            if (str::IsEmpty(name))",
          "new_line_content": "            pdf_obj *font = fontList.At(i);",
          "content_same": false
        },
        {
          "line": 2640,
          "old_api": "if (pdf_crypt_revision(_doc) == 6)\n                return st",
          "new_api": "sion % 10;\n        if (1 == major && 7",
          "old_text": "    if (pdf_crypt_revision(_doc) == 6)\n                return st",
          "new_text": "sion % 10;\n        if (1 == major && 7",
          "old_line_content": "                fz_throw(ctx, FZ_ERROR_GENERIC, \"ignoring font with empty name\");",
          "new_line_content": "            pdf_obj *font2 = pdf_array_get(pdf_dict_gets(font, \"DescendantFonts\"), 0);",
          "content_same": false
        },
        {
          "line": 2645,
          "old_api": "Append",
          "new_api": "%d\", major, minor,",
          "old_text": "uct.Append(str",
          "new_text": "%d\", major, minor,",
          "old_line_content": "            if (embedded && str::Len(name) > 7 && name[6] == '+')",
          "new_line_content": "            if (str::IsEmpty(name))",
          "content_same": false
        },
        {
          "line": 2648,
          "old_api": "Append",
          "new_api": "}\n        return str::Format(L\"%d.%",
          "old_text": "      fstruct.Append(str::Dup(",
          "new_text": "   }\n        return str::Format(L\"%d.%",
          "old_line_content": "            type = pdf_to_name(pdf_dict_gets(font, \"Subtype\"));",
          "new_line_content": "            pdf_obj *desc = pdf_dict_gets(font2, \"FontDescriptor\");",
          "content_same": false
        },
        {
          "line": 2651,
          "old_api": "ntents\")); i++) {",
          "new_api": "pend",
          "old_text": "ntents\")); i++) {\n            ",
          "new_text": "pend(str::Dup(",
          "old_line_content": "                if (str::Eq(type2, \"CIDFontType0\"))",
          "new_line_content": "            if (embedded && str::Len(name) > 7 && name[6] == '+')",
          "content_same": false
        },
        {
          "line": 2657,
          "old_api": "pdf_to_name",
          "new_api": "\")); i++) {\n                pd",
          "old_text": "pdf_to_name(intent) + 4));\n    ",
          "new_text": "\")); i++) {\n                pd",
          "old_line_content": "            encoding = pdf_to_name(pdf_dict_gets(font, \"Encoding\"));",
          "new_line_content": "                if (str::Eq(type2, \"CIDFontType0\"))",
          "content_same": false
        },
        {
          "line": 2668,
          "old_api": "pyright\" },\n        { Prop_CreationD",
          "new_api": "*name;\n    } pdfPropNames[] = {",
          "old_text": "pyright\" },\n        { Prop_CreationD",
          "new_text": " *name;\n    } pdfPropNames[] = {\n     ",
          "old_line_content": "        CrashIf(!name || !type || !encoding);",
          "new_line_content": "            else if (str::Eq(encoding, \"MacExpertEncoding\"))",
          "content_same": false
        },
        {
          "line": 2674,
          "old_api": "// _",
          "new_api": "t\" },\n        { Prop_CreationDate, \"",
          "old_text": "\n            // _",
          "new_text": "t\" },\n        { Prop_CreationDate, \"",
          "old_line_content": "            info.Append(name);",
          "new_line_content": "        CrashIf(!name || !type || !encoding);",
          "content_same": false
        },
        {
          "line": 2677,
          "old_api": "df_dict_gets",
          "new_api": "{ Prop_CreatorApp, \"Creator\" }, { Prop_PdfProducer, \"Producer\" }",
          "old_text": "df_dict_gets(_info",
          "new_text": " { Prop_CreatorApp, \"Creator\" }, { Prop_PdfProducer, \"Producer\" }",
          "old_line_content": "            if (!str::IsEmpty(type))",
          "new_line_content": "        if (name[0] < 0 && MultiByteToWideChar(936, MB_ERR_INVALID_CHARS, name, -1, NULL, 0))",
          "content_same": false
        },
        {
          "line": 2678,
          "old_api": "ame);\n            return obj",
          "new_api": "ropNames); i++) {\n        if (pdfPro",
          "old_text": "ame);\n            return obj",
          "new_text": "ropNames); i++) {\n        if (pdfPro",
          "old_line_content": "                info.AppendFmt(\"%s; \", type);",
          "new_line_content": "            info.Append(ScopedMem<char>(str::ToMultiByte(name, 936, CP_UTF8)));",
          "content_same": false
        },
        {
          "line": 2680,
          "old_api": "}\n    }\n    return NULL;\n};\n\nboo",
          "new_api": "// _info i",
          "old_text": "}\n    }\n    return NULL;\n};\n\nboo",
          "new_text": "       // _info i",
          "old_line_content": "                info.AppendFmt(\"%s; \", encoding);",
          "new_line_content": "            info.Append(name);",
          "content_same": false
        },
        {
          "line": 2682,
          "old_api": "ving) const\n{\n    if (for",
          "new_api": "ss\n            pd",
          "old_text": "ving) const\n{\n    if (for",
          "new_text": "ss\n            pd",
          "old_line_content": "                info.Append(\"embedded; \");",
          "new_line_content": "            info.Append(\" (\");",
          "content_same": false
        },
        {
          "line": 2683,
          "old_api": "pport updati",
          "new_api": "t_gets",
          "old_text": "pport updati",
          "new_text": "t_gets(_info, pdfP",
          "old_line_content": "            info.RemoveAt(info.Count() - 2, 2);",
          "new_line_content": "            if (!str::IsEmpty(type))",
          "content_same": false
        },
        {
          "line": 2684,
          "old_api": "ages aren't all",
          "new_api": "return obj ? pdf",
          "old_text": "ages aren't all ",
          "new_text": "            return obj ? pdf",
          "old_line_content": "            info.Append(\")\");",
          "new_line_content": "                info.AppendFmt(\"%s; \", type);",
          "content_same": false
        },
        {
          "line": 2688,
          "old_api": "return fal",
          "new_api": "const\n{\n    if (forSaving",
          "old_text": "              return fal",
          "new_text": "const\n{\n    if (forSaving",
          "old_line_content": "        if (fontInfo && !fonts.Contains(fontInfo))",
          "new_line_content": "                info.Append(\"embedded; \");",
          "content_same": false
        },
        {
          "line": 2689,
          "old_api": "rn true;\n}\n\nvoid Pdf",
          "new_api": "updating of",
          "old_text": "rn true;\n}\n\nvoid Pdf",
          "new_text": "updating of ",
          "old_line_content": "            fonts.Append(fontInfo.StealData());",
          "new_line_content": "            info.RemoveAt(info.Count() - 2, 2);",
          "content_same": false
        },
        {
          "line": 2694,
          "old_api": "/ TODO: use a new c",
          "new_api": "return false;",
          "old_text": "/ TODO: use a new c",
          "new_text": "        return false;\n  ",
          "old_line_content": "    fonts.SortNatural();",
          "new_line_content": "        if (fontInfo && !fonts.Contains(fontInfo))",
          "content_same": false
        },
        {
          "line": 2695,
          "old_api": "n to avoid blocki",
          "new_api": "e;\n}\n\nvoid PdfEngine",
          "old_text": "n to avoid blocki",
          "new_text": "e;\n}\n\nvoid PdfEngine",
          "old_line_content": "    return fonts.Join(L\"\\n\");",
          "new_line_content": "            fonts.Append(fontInfo.StealData());",
          "content_same": false
        },
        {
          "line": 2711,
          "old_api": "r *name = pdf_to_name(pdf_dict_gets",
          "new_api": "nKey);\n}\n\nPageLayoutTyp",
          "old_text": "r *name = pdf_to_name(pdf_dict_gets",
          "new_text": "nKey);\n}\n\nPageLayoutTyp",
          "old_line_content": "        return str::Format(L\"%d.%d\", major, minor);",
          "new_line_content": "        if (1 == major && 7 == minor && pdf_crypt_version(_doc) == 5) {",
          "content_same": false
        },
        {
          "line": 2717,
          "old_api": "yout_Facing;\n    }",
          "new_api": "e = pdf_to_name(pdf_dict_gets(root,",
          "old_text": "yout_Facing;\n    }\n    ",
          "new_text": "e = pdf_to_name(pdf_dict_gets(root,",
          "old_line_content": "            fstruct.Append(str::Dup(L\"linearized\"));",
          "new_line_content": "        return str::Format(L\"%d.%d\", major, minor);",
          "content_same": false
        },
        {
          "line": 2722,
          "old_api": "return layout;\n}\n\nunsigned char *Pd",
          "new_api": "e if (str::StartsWith(name, \"Two\")",
          "old_text": "  return layout;\n}\n\nunsigned char *Pd",
          "new_text": "e if (str::StartsWith(name, \"Two\")",
          "old_line_content": "                pdf_obj *intent = pdf_array_get(pdf_dict_gets(_info, \"OutputIntents\"), i);",
          "new_line_content": "        if (pdf_to_bool(pdf_dict_gets(_info, \"Linearized\")))",
          "content_same": false
        },
        {
          "line": 2723,
          "old_api": "unsigned char *data",
          "new_api": "acing;\n    }\n    fz_cat",
          "old_text": "unsigned char *data",
          "new_text": "acing;\n    }\n    fz_cat",
          "old_line_content": "                CrashIf(!str::StartsWith(pdf_to_name(intent), \"GTS_\"));",
          "new_line_content": "            fstruct.Append(str::Dup(L\"linearized\"));",
          "content_same": false
        },
        {
          "line": 2724,
          "old_api": "data = fz_e",
          "new_api": "{\n        pdf_obj *prefs = pd",
          "old_text": "        data = fz_e",
          "new_text": " {\n        pdf_obj *prefs = pd",
          "old_line_content": "                fstruct.Append(str::conv::FromUtf8(pdf_to_name(intent) + 4));",
          "new_line_content": "        if (pdf_to_bool(pdf_dict_gets(_info, \"Marked\")))",
          "content_same": false
        },
        {
          "line": 2727,
          "old_api": "return _fileNam",
          "new_api": "layout = (PageLayoutType)(",
          "old_text": "   return _fileNam",
          "new_text": "           layout = (PageLayoutType)(",
          "old_line_content": "        return fstruct.Count() > 0 ? fstruct.Join(L\",\") : NULL;",
          "new_line_content": "            for (int i = 0; i < pdf_array_len(pdf_dict_gets(_info, \"OutputIntents\")); i++) {",
          "content_same": false
        },
        {
          "line": 2805,
          "old_api": ";\n    // convert the annotation's rectan",
          "new_api": "= annot.type ? \"Squiggly\"  :",
          "old_text": ";\n    // convert the annotation's rectan",
          "new_text": "= annot.type ? \"Squiggly\"  :",
          "old_line_content": "        pdf_obj *prefs = pdf_dict_gets(root, \"ViewerPreferences\");",
          "new_line_content": "        else if (str::StartsWith(name, \"Two\"))",
          "content_same": false
        },
        {
          "line": 2839,
          "old_api": "r.x0, r.y0, r.x1, r.y1, rgb[0], rgb[1],",
          "new_api": "tion)",
          "old_text": " r.x0, r.y0, r.x1, r.y1, rgb[0], rgb[1],",
          "new_text": "tion)\n    ",
          "old_line_content": "    bool ok = CopyFile(_fileName, copyFileName, FALSE);",
          "new_line_content": "        bool ok = file::WriteAll(copyFileName, data.Get(), dataLen);",
          "content_same": false
        },
        {
          "line": 2876,
          "old_api": "ot;\n            p",
          "new_api": "case A",
          "old_text": "ot;\n            p",
          "new_text": "        case A",
          "old_line_content": "    CrashIf(!subtype);",
          "new_line_content": "    fz_var(ap_buf);",
          "content_same": false
        },
        {
          "line": 2882,
          "old_api": "tream)));\n        pdf_dict_puts_drop(",
          "new_api": "pdf_dic",
          "old_text": "tream)));\n        pdf_dict_puts_drop(",
          "new_text": "          pdf_dic",
          "old_line_content": "    fz_transform_rect(&r, fz_invert_matrix(&invctm, &page->ctm));",
          "new_line_content": "    CrashIf(!subtype);",
          "content_same": false
        },
        {
          "line": 2896,
          "old_api": "cess);\n\n    bool ok = true;\n    ScopedMem<char> pathUtf8(str::conv::ToUtf",
          "new_api": "}\n    fz_always(ctx) {\n        pdf_drop_obj(ap_obj);\n        fz_drop_b",
          "old_text": "cess);\n\n    bool ok = true;\n    ScopedMem<char> pathUtf8(str::conv::ToUtf",
          "new_text": "   }\n    fz_always(ctx) {\n        pdf_drop_obj(ap_obj);\n        fz_drop_b",
          "old_line_content": "        quad_tpl.Set(str::Format(obj_quad_tpl, r.x1, r.y1, r.x1, r.y0, r.x0, r.y1, r.x0, r.y0));",
          "new_line_content": "        quad_tpl.Set(str::Format(obj_quad_tpl, r.x0, r.y1, r.x1, r.y1, r.x0, r.y0, r.x1, r.y0));",
          "content_same": false
        },
        {
          "line": 2905,
          "old_api": "= fz_get_user_page_annots(userAnnot",
          "new_api": "// TODO: th",
          "old_text": " = fz_get_user_page_annots(userAnnot",
          "new_text": "         // TODO: th",
          "old_line_content": "        annot_obj = pdf_new_obj_from_str(doc, annot_tpl);",
          "new_line_content": "        F_Print, pdf_to_num(page_obj), pdf_to_gen(page_obj), //F and P",
          "content_same": false
        },
        {
          "line": 2907,
          "old_api": "// get the page's /An",
          "new_api": "|| !pdf_to_num(_pageObjs[pageNo - 1])) {",
          "old_text": "      // get the page's /An",
          "new_text": "|| !pdf_to_num(_pageObjs[pageNo - 1])) {\n          ",
          "old_line_content": "        pdf_array_push_drop(annots, pdf_new_ref(doc, annot_obj));",
          "new_line_content": "    ScopedMem<char> annot_ap_dict(str::Format(ap_dict, dx, dy, annot.color.a / 255.f));",
          "content_same": false
        },
        {
          "line": 2923,
          "old_api": "pdf_dict_puts_drop(_pageObjs[pageNo",
          "new_api": "(_pageObjs[pageNo - 1],",
          "old_text": "    pdf_dict_puts_drop(_pageObjs[pageNo ",
          "new_text": "(_pageObjs[pageNo - 1],",
          "old_line_content": "        ap_obj = pdf_new_obj_from_str(doc, annot_ap_dict);",
          "new_line_content": "        pdf_drop_obj(annot_obj);",
          "content_same": false
        },
        {
          "line": 2929,
          "old_api": "At",
          "new_api": "f_dict_puts_drop",
          "old_text": "e, _pageObjs[pageNo - 1], pageAnnots.At(i), annots);\n",
          "new_text": "f_dict_puts_drop(_pageObjs[pageNo - 1], ",
          "old_line_content": "            annot_ap_stream.Set(str::Format(ap_underline, rgb[0], rgb[1], rgb[2], dx));",
          "new_line_content": "        ap_obj = pdf_new_obj_from_str(doc, annot_ap_dict);",
          "content_same": false
        },
        {
          "line": 2932,
          "old_api": "opts.do_incremental = 1;\n            pdf_write_document(_do",
          "new_api": "current page\n            for (size_t i = 0; i < pageAnno",
          "old_text": "          opts.do_incremental = 1;\n            pdf_write_document(_do",
          "new_text": " current page\n            for (size_t i = 0; i < pageAnno",
          "old_line_content": "            annot_ap_stream.Set(str::Format(ap_strikeout, rgb[0], rgb[1], rgb[2], dy / 2, dx, dy / 2));",
          "new_line_content": "            annot_ap_stream.Set(str::Format(ap_highlight, rgb[0], rgb[1], rgb[2], dx, dy));",
          "content_same": false
        },
        {
          "line": 2935,
          "old_api": "return ok;\n}\n\nbool PdfEngineImpl::SaveEmbedded(LinkSave",
          "new_api": "At",
          "old_text": " return ok;\n}\n\nbool PdfEngineImpl::SaveEmbedded(LinkSave",
          "new_text": "geObjs[pageNo - 1], pageAnnots.At(i), annots);\n      ",
          "old_line_content": "            annot_ap_stream.Set(str::Format(ap_squiggly, rgb[0], rgb[1], rgb[2], dx, dx));",
          "new_line_content": "            annot_ap_stream.Set(str::Format(ap_underline, rgb[0], rgb[1], rgb[2], dx));",
          "content_same": false
        },
        {
          "line": 2945,
          "old_api": "true);\n    // GetPdfPage",
          "new_api": "tx) {\n        data = pdf_load_stre",
          "old_text": " true);\n    // GetPdfPage",
          "new_text": "tx) {\n        data = pdf_load_stre",
          "old_line_content": "        memcpy(ap_buf->data, annot_ap_stream, (ap_buf->len = (int)str::Len(annot_ap_stream)));",
          "new_line_content": "            pdf_dict_dels(pdf_dict_gets(ap_obj, \"Resources\"), \"ExtGState\");",
          "content_same": false
        },
        {
          "line": 2948,
          "old_api": "/ check if any image c",
          "new_api": "data->data, data->len);",
          "old_text": "/ check if any image c",
          "new_text": "data->data, data->len);\n ",
          "old_line_content": "        int num = pdf_create_object(doc);",
          "new_line_content": "            pdf_dict_puts_drop(ap_obj, \"Matrix\", pdf_new_matrix(doc, fz_rotate(&rot, rotation)));",
          "content_same": false
        },
        {
          "line": 2950,
          "old_api": "_empty_rect",
          "new_api": "PdfEngineImpl::HasClipOpt",
          "old_text": "_empty_rect(&imageRects[pageNo-1][i",
          "new_text": "PdfEngineImpl::HasClipOpt",
          "old_line_content": "        pdf_update_stream(doc, num, ap_buf);",
          "new_line_content": "        ap_buf = fz_new_buffer(ctx, (int)str::Len(annot_ap_stream));",
          "content_same": false
        },
        {
          "line": 2951,
          "old_api": ">= 0.9f)\n            return",
          "new_api": ";\n    // GetPdfPage extra",
          "old_text": " >= 0.9f)\n            return ",
          "new_text": ";\n    // GetPdfPage extra",
          "old_line_content": "        pdf_dict_puts_drop(pdf_dict_gets(annot_obj, \"AP\"), \"N\", pdf_new_indirect(doc, num, 0));",
          "new_line_content": "        memcpy(ap_buf->data, annot_ap_stream, (ap_buf->len = (int)str::Len(annot_ap_stream)));",
          "content_same": false
        },
        {
          "line": 2954,
          "old_api": "neImpl::GetPageLabel",
          "new_api": "k if any image covers",
          "old_text": "neImpl::GetPageLabel",
          "new_text": "k if any image covers ",
          "old_line_content": "        pdf_drop_obj(ap_obj);",
          "new_line_content": "        int num = pdf_create_object(doc);",
          "content_same": false
        },
        {
          "line": 2955,
          "old_api": ") const\n{\n    if (!_pagelab",
          "new_api": "% of the page\n    for (int i = 0; !",
          "old_text": ") const\n{\n    if (!_pagelab",
          "new_text": "% of the page\n    for (int i = 0; !",
          "old_line_content": "        fz_drop_buffer(ctx, ap_buf);",
          "new_line_content": "        pdf_update_object(doc, num, ap_obj);",
          "content_same": false
        },
        {
          "line": 2956,
          "old_api": "No < 1 || PageCount() <",
          "new_api": "_rect",
          "old_text": "No < 1 || PageCount() <",
          "new_text": "_rect(&imageRects[pageNo-1][i]); i+",
          "old_line_content": "        pdf_drop_obj(annot_obj);",
          "new_line_content": "        pdf_update_stream(doc, num, ap_buf);",
          "content_same": false
        },
        {
          "line": 2985,
          "old_api": "s);\n\n    WCHAR *path = NULL;\n\n    switch (l",
          "new_api": "fLink::GetValue()",
          "old_text": "s);\n\n    WCHAR *path = NULL;\n\n    switch (l",
          "new_text": "fLink::GetValue() ",
          "old_line_content": "            pageAnnots = fz_get_user_page_annots(userAnnots, pageNo);",
          "new_line_content": "            pdf_page *page = GetPdfPage(pageNo);",
          "content_same": false
        },
        {
          "line": 2991,
          "old_api": "i",
          "new_api": "WCHAR *path = NULL;\n\n    switch (link->k",
          "old_text": "\n                i",
          "new_text": "   WCHAR *path = NULL;\n\n    switch (link->k",
          "old_line_content": "                pdf_dict_puts_drop(_pageObjs[pageNo - 1], \"Annots\", pdf_new_array(_doc, (int)pageAnnots.Count()));",
          "new_line_content": "            pageAnnots = fz_get_user_page_annots(userAnnots, pageNo);",
          "content_same": false
        },
        {
          "line": 2992,
          "old_api": "Set",
          "new_api": "LINK_URI:",
          "old_text": "se.Set(str::conv::FromPdf(obj));\n            }",
          "new_text": "LINK_URI:\n        ",
          "old_line_content": "                annots = pdf_dict_gets(_pageObjs[pageNo - 1], \"Annots\");",
          "new_line_content": "            if (pageAnnots.Count() == 0)",
          "content_same": false
        },
        {
          "line": 2996,
          "old_api": "StealData",
          "new_api": "gets",
          "old_text": " uri.StealData();\n       ",
          "new_text": "gets(pdf_trailer(eng",
          "old_line_content": "                pdf_dict_puts_drop(_pageObjs[pageNo - 1], \"Annots\", pdf_new_ref(_doc, annots));",
          "new_line_content": "            if (!pdf_is_array(annots)) {",
          "content_same": false
        },
        {
          "line": 3000,
          "old_api": "Scope",
          "new_api": "if (!str::IsE",
          "old_text": "           Scope",
          "new_text": "          if (!str::IsE",
          "old_line_content": "                ok &= pdf_file_update_add_annotation(_doc, page, _pageObjs[pageNo - 1], pageAnnots.At(i), annots);",
          "new_line_content": "            if (!pdf_is_indirect(annots)) {",
          "content_same": false
        },
        {
          "line": 3006,
          "old_api": "_LINK_LAUNCH:\n        // note: we (intent",
          "new_api": "ScopedMem<W",
          "old_text": "_LINK_LAUNCH:\n        // note: we (intent",
          "new_text": "     ScopedMem<W",
          "old_line_content": "            pdf_write_document(_doc, pathUtf8, &opts);",
          "new_line_content": "                ok &= pdf_file_update_add_annotation(_doc, page, _pageObjs[pageNo - 1], pageAnnots.At(i), annots);",
          "content_same": false
        },
        {
          "line": 3027,
          "old_api": "_gen);\n        }\n        break;\n    case F",
          "new_api": "path = str::Format(L\"",
          "old_text": "_gen);\n        }\n        break;\n    case F",
          "new_text": "          path = str::Format(L\"",
          "old_line_content": "    bool result = saveUI.SaveEmbedded(data->data, data->len);",
          "new_line_content": "        data = pdf_load_stream(_doc, num, gen);",
          "content_same": false
        },
        {
          "line": 3034,
          "old_api": "return path;\n}\n\nst",
          "new_api": "if (link->ld.got",
          "old_text": "\n\n    return path;\n}\n\nst",
          "new_text": "\n        if (link->ld.got",
          "old_line_content": "    pdf_page *page = GetPdfPage(pageNo, true);",
          "new_line_content": "    fz_drop_buffer(ctx, data);",
          "content_same": false
        },
        {
          "line": 3094,
          "old_api": "Link::GetDestRect() con",
          "new_api": "Dest_None; // unsu",
          "old_text": "Link::GetDestRect() con",
          "new_text": " Dest_None; // unsu",
          "old_line_content": "                    base.Set(str::conv::FromPdf(obj));",
          "new_line_content": "        if (IsRelativeURI(path)) {",
          "content_same": false
        },
        {
          "line": 3096,
          "old_api": "DEFAULT, DEST_USE_DEF",
          "new_api": "const\n{\n    if (lin",
          "old_text": "DEFAULT, DEST_USE_DEF",
          "new_text": "const\n{\n    if (lin",
          "old_line_content": "            fz_catch(engine->ctx) { }",
          "new_line_content": "            fz_try(engine->ctx) {",
          "content_same": false
        },
        {
          "line": 3097,
          "old_api": "AULT);",
          "new_api": "ink->ld.gotor.page + 1;",
          "old_text": "AULT);\n   ",
          "new_text": "ink->ld.gotor.page + 1;\n ",
          "old_line_content": "            if (!str::IsEmpty(base.Get())) {",
          "new_line_content": "                pdf_obj *obj = pdf_dict_gets(pdf_trailer(engine->_doc), \"Root\");",
          "content_same": false
        },
        {
          "line": 3100,
          "old_api": "age < 0 || link",
          "new_api": "GetDestRect",
          "old_text": "age < 0 || link",
          "new_text": "GetDestRect() const\n{\n ",
          "old_line_content": "                path = uri.StealData();",
          "new_line_content": "                    base.Set(str::conv::FromPdf(obj));",
          "content_same": false
        },
        {
          "line": 3105,
          "old_api": ".gotor.page + 1);",
          "new_api": "sult;",
          "old_text": ".gotor.page + 1);",
          "new_text": "sult;\n    ",
          "old_line_content": "            if (rect.Contains(pt)) {",
          "new_line_content": "                free(path);",
          "content_same": false
        },
        {
          "line": 3111,
          "old_api": "om)) {",
          "new_api": ".page + 1);\n    i",
          "old_text": "om)) {\n        ",
          "new_text": ".page + 1);\n    i",
          "old_line_content": "            path = uri.StealData();",
          "new_line_content": "            if (rect.Contains(pt)) {",
          "content_same": false
        },
        {
          "line": 3117,
          "old_api": "gs & fz_link_flag_t_valid))\n            result",
          "new_api": "// /XY",
          "old_text": "gs & fz_link_flag_t_valid))\n            result",
          "new_text": "\n        // /XY",
          "old_line_content": "            path = str::conv::FromUtf8(link->ld.launch.file_spec);",
          "new_line_content": "            path = uri.StealData();",
          "content_same": false
        },
        {
          "line": 3126,
          "old_api": "lt.y, rb.x, rb.y);\n        // an empty destin",
          "new_api": "_flag_fit_v) &&",
          "old_text": "lt.y, rb.x, rb.y);\n        // an empty destin",
          "new_text": "_flag_fit_v) &&\n  ",
          "old_line_content": "            path = str::conv::FromUtf8(link->ld.gotor.file_spec);",
          "new_line_content": "            path = str::Format(L\"%s:%d:%d\", engine->FileName(),",
          "content_same": false
        },
        {
          "line": 3145,
          "old_api": "return str::conv::F",
          "new_api": "y affect the zoom le",
          "old_text": "   return str::conv::F",
          "new_text": "y affect the zoom le",
          "old_line_content": "    HandleTypeDialog(Find);",
          "new_line_content": "    HandleType(NextPage);",
          "content_same": false
        },
        {
          "line": 3146,
          "old_api": "(link->ld.gotor.dest);",
          "new_api": "ich we intentionally",
          "old_text": "(link->ld.gotor.dest);",
          "new_text": "ich we intentionally",
          "old_line_content": "    HandleType(FullScreen);",
          "new_line_content": "    HandleType(PrevPage);",
          "content_same": false
        },
        {
          "line": 3147,
          "old_api": "l PdfLink::SaveEmb",
          "new_api": "alone\n    return resu",
          "old_text": "l PdfLink::SaveEmb",
          "new_text": "alone\n    return resu",
          "old_line_content": "    HandleType(GoBack);",
          "new_line_content": "    HandleType(FirstPage);",
          "content_same": false
        },
        {
          "line": 3148,
          "old_api": "inkSaverUI& saveUI)\n{",
          "new_api": "WCHAR *PdfLink::GetD",
          "old_text": "inkSaverUI& saveUI)\n{",
          "new_text": "WCHAR *PdfLink::GetD",
          "old_line_content": "    HandleType(GoForward);",
          "new_line_content": "    HandleType(LastPage);",
          "content_same": false
        },
        {
          "line": 3151,
          "old_api": "mbedded",
          "new_api": "urn str::conv::FromUtf",
          "old_text": "mbedded(saveUI, link->ld",
          "new_text": "urn str::conv::FromUtf",
          "old_line_content": "    HandleTypeDialog(SaveAs);",
          "new_line_content": "    HandleTypeDialog(Find);",
          "content_same": false
        },
        {
          "line": 3152,
          "old_api": ".embedded_num, link->ld.",
          "new_api": ">ld.gotor.dest);\n}\n\nbo",
          "old_text": ".embedded_num, link->ld.",
          "new_text": ">ld.gotor.dest);\n}\n\nbo",
          "old_line_content": "    HandleTypeDialog(ZoomTo);",
          "new_line_content": "    HandleType(FullScreen);",
          "content_same": false
        },
        {
          "line": 3243,
          "old_api": "ml *root = NULL;\n    xps_part *part = xps_read_part(doc, path);\n\n    fz_try(doc->ctx) {",
          "new_api": "copedMem<WCHAR> creation_date;\n    Scope",
          "old_text": "ml *root = NULL;\n    xps_part *part = xps_read_part(doc, path);\n\n    fz_try(doc->ctx) {\n",
          "new_text": "copedMem<WCHAR> creation_date;\n    Scope",
          "old_line_content": "    return engine->SaveEmbedded(saveUI, link->ld.launch.embedded_num, link->ld.launch.embedded_gen);",
          "new_line_content": "    return str::conv::FromUtf8(link->ld.gotor.dest);",
          "content_same": false
        },
        {
          "line": 3249,
          "old_api": "doc->ctx);\n    }\n\n    return",
          "new_api": "ot = NULL;\n    xps_part *part = xps_read_part(doc, path);\n\n    fz_try(doc->ctx) {",
          "old_text": "doc->ctx);\n    }\n\n    return ",
          "new_text": "ot = NULL;\n    xps_part *part = xps_read_part(doc, path);\n\n    fz_try(doc->ctx) {\n      ",
          "old_line_content": "    if (!engine || !fileName || !engine->Load(fileName, pwdUI)) {",
          "new_line_content": "    return engine->SaveEmbedded(saveUI, link->ld.launch.embedded_num, link->ld.launch.embedded_gen);",
          "content_same": false
        },
        {
          "line": 3281,
          "old_api": ", \"/_rels/.rels\");",
          "new_api": "ge/2006/relationships/metadata/",
          "old_text": ", \"/_rels/.rels\");\n\n    ",
          "new_text": "ge/2006/relationships/metadata/",
          "old_line_content": "    return str::EndsWithI(fileName, L\".pdf\") || findEmbedMarks(fileName);",
          "new_line_content": "            if (str::EqN(header + i, \"%PDF\", 4))",
          "content_same": false
        },
        {
          "line": 3326,
          "old_api": "Set",
          "new_api": ":Eq(fz_xml_tag(item), /*\"dc:\"*/\"ti",
          "old_text": "ops->author.Set(xps_get_core_prop(doc->ctx, item));\n        else if (s",
          "new_text": ":Eq(fz_xml_tag(item), /*\"dc:\"*/\"ti",
          "old_line_content": "        dataUtf8.Set(str::conv::ToUtf8((const WCHAR *)(part->data + 2), part->size / 2 - 1));",
          "new_line_content": "    if (str::StartsWith(data, UTF16BE_BOM)) {",
          "content_same": false
        },
        {
          "line": 3328,
          "old_api": "rops->subject)",
          "new_api": "op",
          "old_text": "rops->subject)\n   ",
          "new_text": "op(doc->ctx, item));\n        else if",
          "old_line_content": "        data_size = str::Len(dataUtf8);",
          "new_line_content": "            Swap(part->data[i], part->data[i+1]);",
          "content_same": false
        },
        {
          "line": 3336,
          "old_api": "s->creat",
          "new_api": "ps_get_core_prop",
          "old_text": "s->creat",
          "new_text": "ps_get_core_prop(doc->ctx, item",
          "old_line_content": "    HtmlToken *tok = p.Next();",
          "new_line_content": "    else if (str::StartsWith(data, UTF8_BOM)) {",
          "content_same": false
        },
        {
          "line": 3342,
          "old_api": "Engine is also based on Fitz and shares quite so",
          "new_api": "ation_da",
          "old_text": "Engine is also based on Fitz and shares quite so",
          "new_text": "ation_da",
          "old_line_content": "        attr = tok->GetAttrByNameNS(\"Height\", NS_XPS_MICROSOFT);",
          "new_line_content": "    HtmlToken *tok = p.Next();",
          "content_same": false
        },
        {
          "line": 3344,
          "old_api": "n {\n    xps_page *",
          "new_api": "ag",
          "old_text": "n {\n    xps_page *",
          "new_text": "ag(item), /*\"dcterms:\"*/\"modified\") && !prop",
          "old_line_content": "            bounds.y1 = fz_atof(attr->val) * 72.0f / 96.0f;",
          "new_line_content": "    if (tok && tok->IsStartTag() && tok->NameIsNS(\"FixedPage\", NS_XPS_MICROSOFT)) {",
          "content_same": false
        },
        {
          "line": 3347,
          "old_api": "size_t size_est;",
          "new_api": "c->ctx, root);",
          "old_text": "\n    size_t size_est;\n  ",
          "new_text": "c->ctx, root);\n\n  ",
          "old_line_content": "    xps_free_part(doc, part);",
          "new_line_content": "            bounds.x1 = fz_atof(attr->val) * 72.0f / 96.0f;",
          "content_same": false
        },
        {
          "line": 3371,
          "old_api": "}\n\n    virtual Rect",
          "new_api": ");\n\n    virtual const WC",
          "old_text": "\n    }\n\n    virtual Rect",
          "new_text": ");\n\n    virtual const WC",
          "old_line_content": "        xps_free_part(doc, part);",
          "new_line_content": "    xps_part *part = xps_read_part(doc, path);",
          "content_same": false
        },
        {
          "line": 3373,
          "old_api": "(int pageNo);",
          "new_api": "Name",
          "old_text": "(int pageNo);\n    ",
          "new_text": "Name() const { r",
          "old_line_content": "    fz_catch(doc->ctx) {",
          "new_line_content": "    fz_try(doc->ctx) {",
          "content_same": false
        },
        {
          "line": 3374,
          "old_api": "D PageContentBox(int",
          "new_api": "virtual int PageCount() const {\n        r",
          "old_text": "D PageContentBox(int",
          "new_text": "\n    virtual int PageCount() const {\n        r",
          "old_line_content": "        fz_rethrow(doc->ctx);",
          "new_line_content": "        root = fz_parse_xml(doc->ctx, part->data, part->size);",
          "content_same": false
        },
        {
          "line": 3394,
          "old_api": "ookie **cookie_out=NU",
          "new_api": "t=NULL);\n    vir",
          "old_text": "ookie **cookie_out=NU",
          "new_text": "t=NULL);\n    vir",
          "old_line_content": "    for (end = start + strlen(start); end > start && str::IsWs(*(end - 1)); end--);",
          "new_line_content": "        fz_warn(ctx, \"non-text content for property %s\", fz_xml_tag(item));",
          "content_same": false
        },
        {
          "line": 3413,
          "old_api": "View) {\n        r",
          "new_api": "(size_t *cbCount",
          "old_text": "View) {\n        r",
          "new_text": "(size_t *cbCount",
          "old_line_content": "    for (fz_xml *item = fz_xml_down(root); item; item = fz_xml_next(item)) {",
          "new_line_content": "    if (!root || !str::Eq(fz_xml_tag(root), \"Relationships\")) {",
          "content_same": false
        },
        {
          "line": 3414,
          "old_api": "XpsPage",
          "new_api": "const WCHAR *copyFileName,",
          "old_text": "XpsPage(pageNo),",
          "new_text": "const WCHAR *copyFileName, ",
          "old_line_content": "        if (str::Eq(fz_xml_tag(item), \"Relationship\") &&",
          "new_line_content": "        fz_free_xml(doc->ctx, root);",
          "content_same": false
        },
        {
          "line": 3415,
          "old_api": "WCHAR *GetProperty(Documen",
          "new_api": "eUserAnnots=false);\n    virtual WCHAR * ExtractPageText(int pageNo, WCHAR",
          "old_text": "WCHAR *GetProperty(Documen",
          "new_text": "eUserAnnots=false);\n    virtual WCHAR * ExtractPageText(int pageNo, WCHAR ",
          "old_line_content": "            str::Eq(fz_xml_att(item, \"Type\"), REL_CORE_PROPERTIES) && fz_xml_att(item, \"Target\")) {",
          "new_line_content": "        fz_throw(doc->ctx, FZ_ERROR_GENERIC, \"couldn't parse part '/_rels/.rels'\");",
          "content_same": false
        },
        {
          "line": 3419,
          "old_api": "PI",
          "new_api": "{\n        return",
          "old_text": "PI() const { return 72.0f; }\n",
          "new_text": "{\n        return ",
          "old_line_content": "            root = xps_open_and_parse(doc, path);",
          "new_line_content": "    for (fz_xml *item = fz_xml_down(root); item; item = fz_xml_next(item)) {",
          "content_same": false
        },
        {
          "line": 3432,
          "old_api": "al PageDestinatio",
          "new_api": "etXpsPage",
          "old_text": "al PageDestinatio",
          "new_text": "etXpsPage(pageNo) != NULL; ",
          "old_line_content": "    for (fz_xml *item = fz_xml_down(root); item; item = fz_xml_next(item)) {",
          "new_line_content": "        fz_free_xml(doc->ctx, root);",
          "content_same": false
        },
        {
          "line": 3438,
          "old_api": "protected critical section in or",
          "new_api": "eDestination *Get",
          "old_text": " protected critical section in or",
          "new_text": "eDestination *Get",
          "old_line_content": "            props->subject.Set(xps_get_core_prop(doc->ctx, item));",
          "new_line_content": "    for (fz_xml *item = fz_xml_down(root); item; item = fz_xml_next(item)) {",
          "content_same": false
        },
        {
          "line": 3439,
          "old_api": "ITICAL_SECTION c",
          "new_api": "me);\n    virtual",
          "old_text": "ITICAL_SECTION c",
          "new_text": "me);\n    virtual",
          "old_line_content": "        else if (str::Eq(fz_xml_tag(item), /*\"dcterms:\"*/\"created\") && !props->creation_date)",
          "new_line_content": "        if (str::Eq(fz_xml_tag(item), /*\"dc:\"*/\"title\") && !props->title)",
          "content_same": false
        },
        {
          "line": 3440,
          "old_api": "doc;\n\n    CRITICAL_SECTION _pages",
          "new_api": "cTocItem *GetTocTree();\n\n    fz_r",
          "old_text": "doc;\n\n    CRITICAL_SECTION _pages",
          "new_text": "cTocItem *GetTocTree();\n\n    fz_r",
          "old_line_content": "            props->creation_date.Set(xps_get_core_prop(doc->ctx, item));",
          "new_line_content": "            props->title.Set(xps_get_core_prop(doc->ctx, item));",
          "content_same": false
        },
        {
          "line": 3441,
          "old_api": "pages;\n\n    bool",
          "new_api": "target);\n\n    st",
          "old_text": "pages;\n\n    bool",
          "new_text": "target);\n\n    st",
          "old_line_content": "        else if (str::Eq(fz_xml_tag(item), /*\"dcterms:\"*/\"modified\") && !props->modification_date)",
          "new_line_content": "        else if (str::Eq(fz_xml_tag(item), /*\"dc:\"*/\"creator\") && !props->author)",
          "content_same": false
        },
        {
          "line": 3442,
          "old_api": "Load(fz_stream *stm);\n    boo",
          "new_api": "ngine *CreateFromStream(IStream *",
          "old_text": "    Load(fz_stream *stm);\n    boo",
          "new_text": "ngine *CreateFromStream(IStream *",
          "old_line_content": "            props->modification_date.Set(xps_get_core_prop(doc->ctx, item));",
          "new_line_content": "            props->author.Set(xps_get_core_prop(doc->ctx, item));",
          "content_same": false
        },
        {
          "line": 3444,
          "old_api": "adFromStream",
          "new_api": "cted critical section in order to",
          "old_text": "adFromStream(fz_stream *stm",
          "new_text": "cted critical section in order to",
          "old_line_content": "    fz_free_xml(doc->ctx, root);",
          "new_line_content": "            props->subject.Set(xps_get_core_prop(doc->ctx, item));",
          "content_same": false
        },
        {
          "line": 3656,
          "old_api": "fz_var(page);\n        fz_try(ctx) {\n            /",
          "new_api": "ages)\n        return NULL;\n    if (failI",
          "old_text": "      fz_var(page);\n        fz_try(ctx) {\n            /",
          "new_text": "ages)\n        return NULL;\n    if (failI",
          "old_line_content": "    ctx = fz_new_context(NULL, &fz_locks_ctx, MAX_CONTEXT_MEMORY);",
          "new_line_content": "    InitializeCriticalSection(&_pagesAccess);",
          "content_same": false
        },
        {
          "line": 3662,
          "old_api": "out reference counting)",
          "new_api": "fz_var",
          "old_text": "out reference counting)\n        ",
          "new_text": "fz_var(page);\n        fz_try(ctx) {\n            // caut",
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "    ctx = fz_new_context(NULL, &fz_locks_ctx, MAX_CONTEXT_MEMORY);",
          "content_same": false
        },
        {
          "line": 3667,
          "old_api": "assert(",
          "new_api": "// same xps_page object (wit",
          "old_text": "     assert(",
          "new_text": "       // same xps_page object (wit",
          "old_line_content": "        free(_pages);",
          "new_line_content": "    EnterCriticalSection(&_pagesAccess);",
          "content_same": false
        },
        {
          "line": 3676,
          "old_api": "if (page == _pa",
          "new_api": "}\n        fz_catch(ct",
          "old_text": " if (page == _pa",
          "new_text": "\n        }\n        fz_catch(ct",
          "old_line_content": "        free(imageRects);",
          "new_line_content": "    fz_free_outline(ctx, _outline);",
          "content_same": false
        },
        {
          "line": 3680,
          "old_api": "XpsEngineImpl::",
          "new_api": "ge)\n{\n    f",
          "old_text": "XpsEngineImpl::",
          "new_text": "ge)\n{\n    f",
          "old_line_content": "        assert(runCache.Last()->refs == 1);",
          "new_line_content": "        for (int i = 0; i < PageCount(); i++)",
          "content_same": false
        },
        {
          "line": 3681,
          "old_api": "splay_list *lis",
          "new_api": "ageCount",
          "old_text": "splay_list *lis",
          "new_text": "ageCount(); i++)\n  ",
          "old_line_content": "        DropPageRun(runCache.Last(), true);",
          "new_line_content": "            free(imageRects[i]);",
          "content_same": false
        },
        {
          "line": 3686,
          "old_api": "ons);\n    fz_device",
          "new_api": "ineImpl::Create",
          "old_text": "ons);\n    fz_device ",
          "new_text": "ineImpl::Create",
          "old_line_content": "    fz_free_context(ctx);",
          "new_line_content": "        assert(runCache.Last()->refs == 1);",
          "content_same": false
        },
        {
          "line": 3690,
          "old_api": "dev = fz",
          "new_api": "sitions;\n    ListInspect",
          "old_text": "       dev = fz",
          "new_text": "sitions;\n    ListInspect",
          "old_line_content": "    free(_fileName);",
          "new_line_content": "    xps_close_document(_doc);",
          "content_same": false
        },
        {
          "line": 3692,
          "old_api": "ection_device",
          "new_api": "fz_device *dev =",
          "old_text": "ection_device(ctx, &data);\n     ",
          "new_text": "    fz_device *dev =",
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "    fz_free_context(ctx);",
          "content_same": false
        },
        {
          "line": 3695,
          "old_api": "fz_free_device(dev);\n\n    // sav",
          "new_api": "fz_try(ctx) {",
          "old_text": "    fz_free_device(dev);\n\n    // sav",
          "new_text": "   fz_try(ctx) {\n",
          "old_line_content": "    DeleteCriticalSection(&_pagesAccess);",
          "new_line_content": "    free(_mediaboxes);",
          "content_same": false
        },
        {
          "line": 3746,
          "old_api": "DropPageRun(runCac",
          "new_api": "r the very recently",
          "old_text": "          DropPageRun(runCac",
          "new_text": "r the very recently ",
          "old_line_content": "        stm = fz_open_istream(ctx, stream);",
          "new_line_content": "    assert(!_doc && ctx);",
          "content_same": false
        },
        {
          "line": 3784,
          "old_api": ", list);",
          "new_api": "NULL);",
          "old_text": ", list);\n  ",
          "new_text": " NULL);\n     ",
          "old_line_content": "    if (PageCount() == 0) {",
          "new_line_content": "        fz_close(stm);",
          "content_same": false
        },
        {
          "line": 3790,
          "old_api": "}\n    }",
          "new_api": ");",
          "old_text": "    }\n    }",
          "new_text": ");\n        ",
          "old_line_content": "    _mediaboxes = AllocArray<RectD>(PageCount());",
          "new_line_content": "    if (PageCount() == 0) {",
          "content_same": false
        },
        {
          "line": 3791,
          "old_api": "At",
          "new_api": "}\n        fz_free_device(dev);",
          "old_text": "At(0)) {\n  ",
          "new_text": "       }\n        fz_free_device(dev);",
          "old_line_content": "    imageRects = AllocArray<fz_rect *>(PageCount());",
          "new_line_content": "        fz_warn(ctx, \"document has no pages\");",
          "content_same": false
        },
        {
          "line": 3797,
          "old_api": "}\n\n    if (result",
          "new_api": "{",
          "old_text": "\n    }\n\n    if (result",
          "new_text": " {\n        ",
          "old_line_content": "        _outline = xps_load_outline(_doc);",
          "new_line_content": "    imageRects = AllocArray<fz_rect *>(PageCount());",
          "content_same": false
        },
        {
          "line": 3803,
          "old_api": "ix *ctm, const fz_rect *cli",
          "new_api": "if (result)",
          "old_text": "ix *ctm, const fz_rect *cli",
          "new_text": "\n\n    if (result)\n    ",
          "old_line_content": "        _info = xps_extract_doc_props(_doc);",
          "new_line_content": "        _outline = xps_load_outline(_doc);",
          "content_same": false
        },
        {
          "line": 3806,
          "old_api": "cookie)\n{\n    bool ok = true;\n\n    XpsPageRun *ru",
          "new_api": "}\n\nbool XpsEngineImpl::RunPage(xps_pa",
          "old_text": "cookie)\n{\n    bool ok = true;\n\n    XpsPageRun *ru",
          "new_text": "}\n\nbool XpsEngineImpl::RunPage(xps_pa",
          "old_line_content": "        fz_warn(ctx, \"Couldn't load document properties\");",
          "new_line_content": "        fz_warn(ctx, \"Couldn't load outline\");",
          "content_same": false
        },
        {
          "line": 3830,
          "old_api": "ie ? &cookie->cookie : NULL);",
          "new_api": "dev, clipre",
          "old_text": "ie ? &cookie->cookie : NULL);",
          "new_text": " dev, clipre",
          "old_line_content": "            LinkifyPageText(page, pageNo);",
          "new_line_content": "        fz_var(page);",
          "content_same": false
        },
        {
          "line": 3859,
          "old_api": "ue);\n            fz",
          "new_api": "ageAnnots,",
          "old_text": "ue);\n            fz",
          "new_text": "ageAnnots, ",
          "old_line_content": "    fz_free_device(dev);",
          "new_line_content": "    fz_var(dev);",
          "content_same": false
        },
        {
          "line": 3862,
          "old_api": "->cookie : NULL",
          "new_api": "kie->cookie : NULL);\n            fz_run_page_transparenc",
          "old_text": "->cookie : NULL",
          "new_text": "kie->cookie : NULL);\n            fz_run_page_transparenc",
          "old_line_content": "    int pageNo = GetPageNo(page);",
          "new_line_content": "        fz_run_display_list(list, dev, &fz_identity, NULL, NULL);",
          "content_same": false
        },
        {
          "line": 3865,
          "old_api": "ection",
          "new_api": "fz_run_u",
          "old_text": "ection(&ctxAccess",
          "new_text": "           fz_run_u",
          "old_line_content": "        fz_rect *rects = AllocArray<fz_rect>(positions.Count() + 1);",
          "new_line_content": "    fz_free_device(dev);",
          "content_same": false
        },
        {
          "line": 3868,
          "old_api": "emove)\n{\n    Sc",
          "new_api": "ie : NULL);",
          "old_text": "emove)\n{\n    Sc",
          "new_text": "ie : NULL);\n   ",
          "old_line_content": "                rects[i] = positions.At(i).rect;",
          "new_line_content": "    int pageNo = GetPageNo(page);",
          "content_same": false
        },
        {
          "line": 3891,
          "old_api": "if (!page) {",
          "new_api": "RectD mbo",
          "old_text": "  if (!page) {\n ",
          "new_text": "\n    RectD mbo",
          "old_line_content": "        for (size_t i = 0; i < runCache.Count(); i++) {",
          "new_line_content": "            result = runCache.At(i);",
          "content_same": false
        },
        {
          "line": 3897,
          "old_api": "age = GetXpsPa",
          "new_api": "!page) {",
          "old_text": "age = GetXpsPa",
          "new_text": "!page) {\n       ",
          "old_line_content": "                mem += runCache.At(i)->size_est;",
          "new_line_content": "        for (size_t i = 0; i < runCache.Count(); i++) {",
          "content_same": false
        },
        {
          "line": 3900,
          "old_api": "_rect_to_RectD",
          "new_api": "(!mbox.IsEmpty",
          "old_text": "_rect_to_RectD(*",
          "new_text": "(!mbox.IsEmpty",
          "old_line_content": "            assert(runCache.Count() == MAX_PAGE_RUN_CACHE);",
          "new_line_content": "            if (i >= 2 && mem + runCache.At(i)->size_est >= MAX_PAGE_RUN_MEMORY)",
          "content_same": false
        },
        {
          "line": 3901,
          "old_api": "_mediaboxes[pa",
          "new_api": "rn _mediaboxes[p",
          "old_text": " _mediaboxes[pa",
          "new_text": "rn _mediaboxes[p",
          "old_line_content": "            DropPageRun(runCache.Last(), true);",
          "new_line_content": "                DropPageRun(runCache.At(i--), true);",
          "content_same": false
        },
        {
          "line": 3919,
          "old_api": "ion",
          "new_api": "(ctx) {\n        dev = fz_new_bbox_device(ctx, &re",
          "old_text": "ion(&ctxAccess);\n\n ",
          "new_text": "(ctx) {\n        dev = fz_new_bbox_device(ctx, &re",
          "old_line_content": "        fz_free_device(dev);",
          "new_line_content": "            xps_run_page(_doc, page, dev, &fz_identity, NULL);",
          "content_same": false
        },
        {
          "line": 3922,
          "old_api": "age, &pagerect);\n    bool",
          "new_api": "lSection",
          "old_text": "age, &pagerect);\n    bool",
          "new_text": "lSection(&ctxAccess);\n        r",
          "old_line_content": "            result = CreatePageRun(page, list);",
          "new_line_content": "            fz_drop_display_list(ctx, list);",
          "content_same": false
        },
        {
          "line": 3928,
          "old_api": "eNo);\n\n    RectD rect2",
          "new_api": "pagerect);\n    bool ok =",
          "old_text": "eNo);\n\n    RectD rect2 ",
          "new_text": "pagerect);\n    bool ok = ",
          "old_line_content": "        runCache.Remove(result);",
          "new_line_content": "            result = CreatePageRun(page, list);",
          "content_same": false
        },
        {
          "line": 3929,
          "old_api": "o_RectD",
          "new_api": "ev, &fz_identity, &pagerect,",
          "old_text": "o_RectD(rect);\n    return re",
          "new_text": "ev, &fz_identity, &pagerect,",
          "old_line_content": "        runCache.InsertAt(0, result);",
          "new_line_content": "            runCache.InsertAt(0, result);",
          "content_same": false
        },
        {
          "line": 3947,
          "old_api": "nvert_matrix",
          "new_api": "loat)pt.y };\n    fz_transfo",
          "old_text": "nvert_matrix(&ctm, &ctm);\n    fz_rect",
          "new_text": "loat)pt.y };\n    fz_transfo",
          "old_line_content": "            fz_begin_page(dev, xps_bound_page(_doc, page, &pagerect), ctm);",
          "new_line_content": "    XpsPageRun *run = GetPageRun(page, !cacheRun);",
          "content_same": false
        },
        {
          "line": 3949,
          "old_api": "ctD",
          "new_api": "eturn PointD(pt2.x, pt2.y);\n}\n\nR",
          "old_text": "ctD(rect2);\n}\n\nbool XpsEngineImpl::RenderPage(HDC hDC, xps_page *page, RectI screen",
          "new_text": "eturn PointD(pt2.x, pt2.y);\n}\n\nR",
          "old_line_content": "            fz_run_display_list(run->list, dev, ctm, cliprect, cookie ? &cookie->cookie : NULL);",
          "new_line_content": "        EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 3950,
          "old_api": "matrix *ctm, float zoom, int rotation, RectD *pageRect, A",
          "new_api": "bool inverse)\n{",
          "old_text": "matrix *ctm, float zoom, int rotation, RectD *pageRect, A",
          "new_text": "bool inverse)\n{",
          "old_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, true);",
          "new_line_content": "        Vec<PageAnnotation> pageAnnots = fz_get_user_page_annots(userAnnots, GetPageNo(page));",
          "content_same": false
        },
        {
          "line": 3957,
          "old_api": "pRect = fz_RectD_to_rect",
          "new_api": "ut)\n{\n    if (!page)\n        return false;\n\n    fz_matrix ctm2;\n    if (!ctm) {",
          "old_text": "        pRect = fz_RectD_to_rect",
          "new_text": "ut)\n{\n    if (!page)\n        return false;\n\n    fz_matrix ctm2;\n    if (!ctm) {\n        ",
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "            fz_run_user_page_annots(pageAnnots, dev, ctm, cliprect, cookie ? &cookie->cookie : NULL);",
          "content_same": false
        },
        {
          "line": 3958,
          "old_api": ";\n        else",
          "new_api": "page, zoom, rota",
          "old_text": ";\n        else\n ",
          "new_text": "page, zoom, rota",
          "old_line_content": "        DropPageRun(run);",
          "new_line_content": "            fz_end_page(dev);",
          "content_same": false
        },
        {
          "line": 3968,
          "old_api": "lize white background\n    DeleteObject(bgBrush);\n\n    fz_",
          "new_api": "ix trans;",
          "old_text": "lize white background\n    DeleteObject(bgBrush);\n\n    fz_",
          "new_text": "ix trans;\n     ",
          "old_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, true);",
          "new_line_content": "        Vec<PageAnnotation> pageAnnots = fz_get_user_page_annots(userAnnots, GetPageNo(page));",
          "content_same": false
        },
        {
          "line": 4009,
          "old_api": "if (pageRect)",
          "new_api": "ie **co",
          "old_text": "  if (pageRect)\n        ",
          "new_text": "ie **co",
          "old_line_content": "    xps_page *page = GetXpsPage(pageNo, true);",
          "new_line_content": "        return RectD();",
          "content_same": false
        },
        {
          "line": 4022,
          "old_api": "1 - bbo",
          "new_api": "m_rect",
          "old_text": "1 - bbo",
          "new_text": "m_rect(&r, &ct",
          "old_line_content": "        return RectD();",
          "new_line_content": "        if (!mbox.IsEmpty()) {",
          "content_same": false
        },
        {
          "line": 4031,
          "old_api": "yBitmap",
          "new_api": ", (float)-bbox.x0, (float)-bbox.y0));",
          "old_text": "yBitmap(Siz",
          "new_text": ", (float)-bbox.x0, (float)-bbox.y0));",
          "old_line_content": "    assert(1 <= pageNo && pageNo <= PageCount());",
          "new_line_content": "    _mediaboxes[pageNo-1] = fz_rect_to_RectD(*xps_bound_page(_doc, page, &pagerect));",
          "content_same": false
        },
        {
          "line": 4038,
          "old_api": "ctI rc(0, 0, w, h);\n        bool",
          "new_api": "DC = GetDC(NULL);",
          "old_text": "ctI rc(0, 0, w, h);\n        bool",
          "new_text": "DC = GetDC(NULL);\n",
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "    xps_page *page = GetXpsPage(pageNo);",
          "content_same": false
        },
        {
          "line": 4040,
          "old_api": "ctm, 0, 0, pageRect, cookie_ou",
          "new_api": "bleDC",
          "old_text": "ctm, 0, 0, pageRect, cookie_ou",
          "new_text": "bleDC(h",
          "old_line_content": "        dev = fz_new_bbox_device(ctx, &rect);",
          "new_line_content": "        return RectD();",
          "content_same": false
        },
        {
          "line": 4044,
          "old_api": "Delet",
          "new_api": "(0, 0, w, h);\n        bool ok =",
          "old_text": "  Delet",
          "new_text": "(0, 0, w, h);\n        bool ok = ",
          "old_line_content": "        return RectD();",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4046,
          "old_api": "CloseHandle(hMap);",
          "new_api": ", 0, pageRect, cookie_out);",
          "old_text": "\n            CloseHandle(hMap);\n",
          "new_text": ", 0, pageRect, cookie_out);\n  ",
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "        dev = fz_new_bbox_device(ctx, &rect);",
          "content_same": false
        },
        {
          "line": 4049,
          "old_api": "}\n        return new RenderedBitmap(",
          "new_api": "DC",
          "old_text": " }\n        return new RenderedBitmap(",
          "new_text": "DC(NULL, hDC);\n        if (!ok) ",
          "old_line_content": "    xps_bound_page(_doc, page, &pagerect);",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4050,
          "old_api": ", hMap);\n    }\n\n    fz_pixmap *image = NULL;\n    E",
          "new_api": "teObjec",
          "old_text": ", hMap);\n    }\n\n    fz_pixmap *image = NULL;\n    E",
          "new_text": "teObjec",
          "old_line_content": "    bool ok = RunPage(page, dev, &fz_identity, &pagerect, false);",
          "new_line_content": "        return RectD();",
          "content_same": false
        },
        {
          "line": 4052,
          "old_api": "fz_try(ctx) {",
          "new_api": "CloseHandle(hMap);",
          "old_text": "\n    fz_try(ctx) {\n ",
          "new_text": "       CloseHandle(hMap);\n      ",
          "old_line_content": "        return PageMediabox(pageNo);",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4056,
          "old_api": ", colorspace, &bbox);",
          "new_api": ");\n    }\n\n    fz_pixmap *image = NULL;\n    EnterCr",
          "old_text": ", colorspace, &bbox);\n",
          "new_text": ");\n    }\n\n    fz_pixmap *image = NULL;\n    EnterCr",
          "old_line_content": "    RectD rect2 = fz_rect_to_RectD(rect);",
          "new_line_content": "    bool ok = RunPage(page, dev, &fz_identity, &pagerect, false);",
          "content_same": false
        },
        {
          "line": 4062,
          "old_api": "}\n\n    fz_device *dev = NULL;",
          "new_api": "rspace, &bbox);",
          "old_text": "}\n\n    fz_device *dev = NULL;\n ",
          "new_text": "rspace, &bbox);\n      ",
          "old_line_content": "    fz_matrix ctm = viewctm(pageNo, zoom, rotation);",
          "new_line_content": "    RectD rect2 = fz_rect_to_RectD(rect);",
          "content_same": false
        },
        {
          "line": 4072,
          "old_api": "out = cookie = new FitzAbortCoo",
          "new_api": "ge);\n        LeaveCriticalSect",
          "old_text": "out = cookie = new FitzAbortCoo",
          "new_text": "ge);\n        LeaveCriticalSect",
          "old_line_content": "    fz_matrix ctm = viewctm(pageNo, zoom, rotation);",
          "new_line_content": "    fz_transform_point(&pt2, &ctm);",
          "content_same": false
        },
        {
          "line": 4093,
          "old_api": "fz_try(ctx) {\n        sheet =",
          "new_api": "L;\n\n    fz_text_sheet *sheet",
          "old_text": "    fz_try(ctx) {\n        sheet = ",
          "new_text": "L;\n\n    fz_text_sheet *sheet ",
          "old_line_content": "            xps_bound_page(_doc, page, &pRect);",
          "new_line_content": "        ctm2 = viewctm(page, zoom, rotation);",
          "content_same": false
        },
        {
          "line": 4097,
          "old_api": "fz_free_text_page(ctx, text);\n        fz_free_text_sheet(ctx, sheet);\n        Le",
          "new_api": "var",
          "old_text": "  fz_free_text_page(ctx, text);\n        fz_free_text_sheet(ctx, sheet);\n        Le",
          "new_text": "var(text);\n\n    EnterCritic",
          "old_line_content": "        fz_concat(&ctm2, ctm, fz_translate(&trans, (float)screenRect.x - bbox.x0, (float)screenRect.y - bbox.y0));",
          "new_line_content": "            pRect = fz_RectD_to_rect(*pageRect);",
          "content_same": false
        },
        {
          "line": 4103,
          "old_api": "_enable_device_hint",
          "new_api": "ree_text_page",
          "old_text": "_enable_device_hint",
          "new_text": "ree_text_page(ctx, text);\n        fz_free_text_sheet(ctx, sheet);\n        LeaveCri",
          "old_line_content": "    RECT tmpRect = screenRect.ToRECT();",
          "new_line_content": "        fz_concat(&ctm2, ctm, fz_translate(&trans, (float)screenRect.x - bbox.x0, (float)screenRect.y - bbox.y0));",
          "content_same": false
        },
        {
          "line": 4109,
          "old_api": "st device omits text outsid",
          "new_api": "e_device_hints",
          "old_text": "st device omits text outsid",
          "new_text": "e_device_hints(dev,",
          "old_line_content": "        fz_rect pageclip = fz_RectD_to_rect(*pageRect);",
          "new_line_content": "    RECT tmpRect = screenRect.ToRECT();",
          "content_same": false
        },
        {
          "line": 4110,
          "old_api": "dev, &fz_identity, NULL, cacheRu",
          "new_api": "CACHE);\n\n    // use an infinite",
          "old_text": " dev, &fz_identity, NULL, cacheRu",
          "new_text": "CACHE);\n\n    // use an infinite ",
          "old_line_content": "        fz_intersect_rect(&cliprect, fz_transform_rect(&pageclip, ctm));",
          "new_line_content": "    FillRect(hDC, &tmpRect, bgBrush); // initialize white background",
          "content_same": false
        },
        {
          "line": 4113,
          "old_api": "fz_text_page_to_str",
          "new_api": "en cached runs using a list",
          "old_text": "fz_text_page_to_str(text, line",
          "new_text": "en cached runs using a list ",
          "old_line_content": "    fz_rect_from_irect(&cliprect, fz_round_rect(&tmp, &cliprect));",
          "new_line_content": "    fz_rect cliprect = fz_RectD_to_rect(screenRect.Convert<double>());",
          "content_same": false
        },
        {
          "line": 4116,
          "old_api": "e",
          "new_api": "&fz_identity, NULL, cacheRun);",
          "old_text": "e(ctx, text);\n    fz_free_text_s",
          "new_text": "&fz_identity, NULL, cacheRun);\n\n ",
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "        fz_intersect_rect(&cliprect, fz_transform_rect(&pageclip, ctm));",
          "content_same": false
        },
        {
          "line": 4124,
          "old_api": ") {\n        data = fz_extract_st",
          "new_api": "unsigned char *XpsEngineImpl::GetFileData(",
          "old_text": ") {\n        data = fz_extract_st",
          "new_text": "unsigned char *XpsEngineImpl::GetFileData(",
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "        dev = fz_new_gdiplus_device(ctx, hDC, &cliprect);",
          "content_same": false
        },
        {
          "line": 4140,
          "old_api": "!_fileName)\n        return",
          "new_api": "k = file::WriteAll",
          "old_text": "!_fileName)\n        return ",
          "new_text": "k = file::WriteAll",
          "old_line_content": "        pRect = fz_RectD_to_rect(*pageRect);",
          "new_line_content": "    xps_page* page = GetXpsPage(pageNo);",
          "content_same": false
        },
        {
          "line": 4146,
          "old_api": "GetXpsPage(i);",
          "new_api": "Name)\n        return false;",
          "old_text": "\n        GetXpsPage(i);\n\n  ",
          "new_text": "Name)\n        return false;",
          "old_line_content": "    fz_round_rect(&bbox, fz_transform_rect(&r, &ctm));",
          "new_line_content": "        pRect = fz_RectD_to_rect(*pageRect);",
          "content_same": false
        },
        {
          "line": 4152,
          "old_api": "ScopedMem<WCHAR> name(str::conv::FromUtf8(font->fon",
          "new_api": "GetXpsPage(i);\n\n    Scop",
          "old_text": "   ScopedMem<WCHAR> name(str::conv::FromUtf8(font->fon",
          "new_text": "   GetXpsPage(i);\n\n    Scop",
          "old_line_content": "        fz_concat(&ctm, &ctm, fz_translate(&trans, (float)-bbox.x0, (float)-bbox.y0));",
          "new_line_content": "    fz_round_rect(&bbox, fz_transform_rect(&r, &ctm));",
          "content_same": false
        },
        {
          "line": 4158,
          "old_api": "(DocumentProperty prop)",
          "new_api": "pedMem<WCHAR> name(str::conv::FromUtf8(font->font->nam",
          "old_text": "(DocumentProperty prop)",
          "new_text": "pedMem<WCHAR> name(str::conv::FromUtf8(font->font->nam",
          "old_line_content": "        HDC hDCMem = CreateCompatibleDC(hDC);",
          "new_line_content": "        fz_concat(&ctm, &ctm, fz_translate(&trans, (float)-bbox.x0, (float)-bbox.y0));",
          "content_same": false
        },
        {
          "line": 4162,
          "old_api": "switch (prop) {\n    case Prop_Title: return str::Dup(_inf",
          "new_api": ");\n    retu",
          "old_text": "\n    switch (prop) {\n    case Prop_Title: return str::Dup(_inf",
          "new_text": ");\n    retu",
          "old_line_content": "        bool ok = RenderPage(hDCMem, page, rc, &ctm, 0, 0, pageRect, cookie_out);",
          "new_line_content": "        HBITMAP hbmp = CreateMemoryBitmap(SizeI(w, h), &hMap);",
          "content_same": false
        },
        {
          "line": 4163,
          "old_api": "case Prop_Au",
          "new_api": "R *XpsEngin",
          "old_text": "    case Prop_Au",
          "new_text": "R *XpsEngin",
          "old_line_content": "        DeleteDC(hDCMem);",
          "new_line_content": "        HDC hDC = GetDC(NULL);",
          "content_same": false
        },
        {
          "line": 4164,
          "old_api": "n str::Dup(_info->au",
          "new_api": "entProperty prop)\n{",
          "old_text": "n str::Dup(_info->au",
          "new_text": "entProperty prop)\n{\n   ",
          "old_line_content": "        ReleaseDC(NULL, hDC);",
          "new_line_content": "        HDC hDCMem = CreateCompatibleDC(hDC);",
          "content_same": false
        },
        {
          "line": 4170,
          "old_api": "urn str::Du",
          "new_api": ":Dup(_info->author);",
          "old_text": "urn str::Du",
          "new_text": ":Dup(_info->author);",
          "old_line_content": "        return new RenderedBitmap(hbmp, SizeI(w, h), hMap);",
          "new_line_content": "        ReleaseDC(NULL, hDC);",
          "content_same": false
        },
        {
          "line": 4176,
          "old_api": "Saving; // for now",
          "new_api": "r::Dup(_inf",
          "old_text": "Saving; // for now",
          "new_text": "r::Dup(_inf",
          "old_line_content": "        fz_colorspace *colorspace = fz_device_rgb(ctx);",
          "new_line_content": "        return new RenderedBitmap(hbmp, SizeI(w, h), hMap);",
          "content_same": false
        },
        {
          "line": 4187,
          "old_api": "No, PointD pt)\n{\n    xps_page",
          "new_api": "userAnnots = *list;",
          "old_text": "No, PointD pt)\n{\n    xps_page ",
          "new_text": "\n        userAnnots = *list;\n   ",
          "old_line_content": "        dev = fz_new_draw_device(ctx, image);",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4200,
          "old_api": "z_is_empty_rect",
          "new_api": "inks; link; link = link->next)",
          "old_text": "z_is_empty_rect(&imageRects[pageNo-1",
          "new_text": "inks; link; link = link->next)\n ",
          "old_line_content": "    bool ok = RunPage(page, dev, &ctm, fz_rect_from_irect(&cliprect, &bbox), true, cookie);",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4206,
          "old_api": "ageRects[pageNo-1][i], i);\n    }",
          "new_api": "mpty_rect",
          "old_text": "ageRects[pageNo-1][i], i);\n    }\n\n",
          "new_text": "mpty_rect(&imageRects[pageNo-1][i]);",
          "old_line_content": "        bitmap = new_rendered_fz_pixmap(ctx, image);",
          "new_line_content": "    bool ok = RunPage(page, dev, &ctm, fz_rect_from_irect(&cliprect, &bbox), true, cookie);",
          "content_same": false
        },
        {
          "line": 4225,
          "old_api": "_empty_rect",
          "new_api": "ageElement *>",
          "old_text": "_empty_rect(&imageRec",
          "new_text": "ageElement *>",
          "old_line_content": "        text = fz_new_text_page(ctx);",
          "new_line_content": "    fz_var(sheet);",
          "content_same": false
        },
        {
          "line": 4226,
          "old_api": "Append",
          "new_api": "new Vec<Pag",
          "old_text": " i++) {\n            els->Append(new ",
          "new_text": " new Vec<Pag",
          "old_line_content": "        dev = fz_new_text_device(ctx, sheet, text);",
          "new_line_content": "    fz_var(text);",
          "content_same": false
        },
        {
          "line": 4230,
          "old_api": "(fz_link *link = page->links;",
          "new_api": ") {\n        for (int i",
          "old_text": "(fz_link *link = page->links; ",
          "new_text": ") {\n        for (int i",
          "old_line_content": "        fz_free_text_sheet(ctx, sheet);",
          "new_line_content": "        sheet = fz_new_text_sheet(ctx);",
          "content_same": false
        },
        {
          "line": 4231,
          "old_api": "= link->next) {\n        els->App",
          "new_api": "_rect",
          "old_text": "= link->next) {\n        els->App",
          "new_text": "_rect(&imageRects[pag",
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "        text = fz_new_text_page(ctx);",
          "content_same": false
        },
        {
          "line": 4237,
          "old_api": "void XpsEngineImpl::LinkifyPageText(xp",
          "new_api": "Append",
          "old_text": "\n\nvoid XpsEngineImpl::LinkifyPageText(xp",
          "new_text": "->next) {\n        els->Append(ne",
          "old_line_content": "        fz_enable_device_hints(dev, FZ_NO_CACHE);",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4248,
          "old_api": "ext)\n        return;\n\n    Link",
          "new_api": "page->links_resolved = 1;\n    assert(!pa",
          "old_text": "ext)\n        return;\n\n    Link",
          "new_text": "        page->links_resolved = 1;\n    assert(!pa",
          "old_line_content": "    fz_free_text_sheet(ctx, sheet);",
          "new_line_content": "    RunPage(page, dev, &fz_identity, NULL, cacheRun);",
          "content_same": false
        },
        {
          "line": 4277,
          "old_api": "delete list;\n    free(coords);\n}\n\nR",
          "new_api": "link",
          "old_text": "\n    delete list;\n    free(coords);\n}\n\nR",
          "new_text": "link(ctx, ",
          "old_line_content": "    return CopyFile(_fileName, copyFileName, FALSE);",
          "new_line_content": "        bool ok = file::WriteAll(copyFileName, data.Get(), dataLen);",
          "content_same": false
        },
        {
          "line": 4283,
          "old_api": "psPage",
          "new_api": "elete list;\n    free(coords);\n}\n\nRendere",
          "old_text": "psPage(page",
          "new_text": "elete list;\n    free(coords);\n}\n\nRendere",
          "old_line_content": "    for (int i = 1; i <= PageCount(); i++)",
          "new_line_content": "    return CopyFile(_fileName, copyFileName, FALSE);",
          "content_same": false
        },
        {
          "line": 4298,
          "old_api": "ageIx).rect) != rec",
          "new_api": "return NULL;\n    }\n    Leave",
          "old_text": "ageIx).rect) != rec",
          "new_text": "\n        return NULL;\n    }\n    Leave",
          "old_line_content": "    fonts.SortNatural();",
          "new_line_content": "        ScopedMem<WCHAR> name(str::conv::FromUtf8(font->font->name));",
          "content_same": false
        },
        {
          "line": 4299,
          "old_api": "ssert",
          "new_api": "z_identity);\n\n    if (i",
          "old_text": "ssert(0);\n       ",
          "new_text": "z_identity);\n\n    if (i",
          "old_line_content": "    return fonts.Join(L\"\\n\");",
          "new_line_content": "        fonts.Append(str::Format(L\"%s (%s)\", name, path::GetBaseName(path)));",
          "content_same": false
        },
        {
          "line": 4305,
          "old_api": "z_image *image =",
          "new_api": "0);\n        retur",
          "old_text": "z_image *image = ",
          "new_text": "0);\n        retur",
          "old_line_content": "        return ExtractFontList();",
          "new_line_content": "    return fonts.Join(L\"\\n\");",
          "content_same": false
        },
        {
          "line": 4311,
          "old_api": "LL;\n    }\n    RenderedB",
          "new_api": "e *image = positi",
          "old_text": "LL;\n    }\n    RenderedB",
          "new_text": "e *image = positi",
          "old_line_content": "    case Prop_Author: return str::Dup(_info->author);",
          "new_line_content": "        return ExtractFontList();",
          "content_same": false
        },
        {
          "line": 4342,
          "old_api": ">name, name_utf8))",
          "new_api": ":StartsWith(name_utf8.Ge",
          "old_text": ">name, name_utf8))\n            ",
          "new_text": ":StartsWith(name_utf8.Ge",
          "old_line_content": "        if (fz_is_pt_in_rect(link->rect, p))",
          "new_line_content": "    xps_page *page = GetXpsPage(pageNo, true);",
          "content_same": false
        },
        {
          "line": 4373,
          "old_api": "ageNo, true);\n    // GetXpsPage extracts imageRects for us",
          "new_api": "::GetTocTree()\n{\n    if (!HasTocTree())",
          "old_text": "ageNo, true);\n    // GetXpsPage extracts imageRects for us\n    ",
          "new_text": "::GetTocTree()\n{\n    if (!HasTocTree())\n  ",
          "old_line_content": "        els->Append(new XpsLink(this, &link->dest, link->rect, pageNo));",
          "new_line_content": "        for (int i = 0; !fz_is_empty_rect(&imageRects[pageNo-1][i]); i++) {",
          "content_same": false
        },
        {
          "line": 4390,
          "old_api": "AR *fileName)\n{\n    XpsEngineImpl *engine = ne",
          "new_api": "c_overlap",
          "old_text": "AR *fileName)\n{\n    XpsEngineImpl *engine = ne",
          "new_text": "c_overlap(mbox, ",
          "old_line_content": "    assert(!page->links || page->links->refs == 1);",
          "new_line_content": "    XpsPageRun *run = GetPageRun(page);",
          "content_same": false
        },
        {
          "line": 4393,
          "old_api": "Load",
          "new_api": "n true;\n}\n\nBaseE",
          "old_text": "ine->Load(fileName)) {\n        delete engin",
          "new_text": "n true;\n}\n\nBaseE",
          "old_line_content": "    ScopedMem<WCHAR> pageText(ExtractPageText(page, L\"\\n\", &coords, true));",
          "new_line_content": "        DropPageRun(run);",
          "content_same": false
        },
        {
          "line": 4403,
          "old_api": "ening uncompresse",
          "new_api": "mpl::CreateFromStream(IStream",
          "old_text": "ening uncompresse",
          "new_text": "mpl::CreateFromStream(IStream",
          "old_line_content": "            ScopedMem<char> uri(str::conv::ToUtf8(list->links.At(i)));",
          "new_line_content": "    LinkRectList *list = LinkifyText(pageText, coords);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 4099,
          "old_api": null,
          "new_api": "_try",
          "old_text": null,
          "new_text": "_try(ctx) {\n        sheet = fz_new",
          "old_line_content": "    else",
          "new_line_content": "            xps_bound_page(_doc, page, &pRect);",
          "content_same": false
        },
        {
          "line": 2052,
          "old_api": null,
          "new_api": "erse)\n        fz_invert_matrix(&ctm, &ctm);\n    fz_poi",
          "old_text": null,
          "new_text": "erse)\n        fz_invert_matrix(&ctm, &ctm);\n    fz_poi",
          "old_line_content": "    }",
          "new_line_content": "        pdf_to_rect(ctx, pdf_lookup_inherited_page_item(_doc, page, \"MediaBox\"), &mbox);",
          "content_same": false
        },
        {
          "line": 2053,
          "old_api": null,
          "new_api": "};\n    fz_transform_point(&pt2, &ctm);\n    return Poi",
          "old_text": null,
          "new_text": "};\n    fz_transform_point(&pt2, &ctm);\n    return Poi",
          "old_line_content": "    fz_catch(ctx) { }",
          "new_line_content": "        pdf_to_rect(ctx, pdf_lookup_inherited_page_item(_doc, page, \"CropBox\"), &cbox);",
          "content_same": false
        },
        {
          "line": 4101,
          "old_api": null,
          "new_api": "dev = fz_new_text_devi",
          "old_text": null,
          "new_text": "        dev = fz_new_text_devi",
          "old_line_content": "",
          "new_line_content": "        fz_round_rect(&bbox, fz_transform_rect(&pRect, ctm));",
          "content_same": false
        },
        {
          "line": 2056,
          "old_api": null,
          "new_api": "ation);\n    if (",
          "old_text": null,
          "new_text": "ation);\n    if (",
          "old_line_content": "        mbox.x0 = 0; mbox.y0 = 0;",
          "new_line_content": "        if (pdf_is_real(obj))",
          "content_same": false
        },
        {
          "line": 2057,
          "old_api": null,
          "new_api": "_matrix",
          "old_text": null,
          "new_text": "_matrix(&ctm, &c",
          "old_line_content": "        mbox.x1 = 612; mbox.y1 = 792;",
          "new_line_content": "            userunit = pdf_to_real(obj);",
          "content_same": false
        },
        {
          "line": 4108,
          "old_api": null,
          "new_api": "ccess);\n\n    if (!cac",
          "old_text": null,
          "new_text": "ccess);\n\n    if (!cac",
          "old_line_content": "    if (pageRect) {",
          "new_line_content": "    HBRUSH bgBrush = CreateSolidBrush(RGB(0xFF, 0xFF, 0xFF));",
          "content_same": false
        },
        {
          "line": 4111,
          "old_api": null,
          "new_api": "abox) to ensure that",
          "old_text": null,
          "new_text": "abox) to ensure that\n",
          "old_line_content": "    }",
          "new_line_content": "    DeleteObject(bgBrush);",
          "content_same": false
        },
        {
          "line": 2065,
          "old_api": null,
          "new_api": "zoom, int rotation, Rec",
          "old_text": null,
          "new_text": "zoom, int rotation, Rec",
          "old_line_content": "        rotate = 0;",
          "new_line_content": "    if (!fz_is_empty_rect(&cbox)) {",
          "content_same": false
        },
        {
          "line": 2066,
          "old_api": null,
          "new_api": "RenderTarget target, AbortCook",
          "old_text": null,
          "new_text": " RenderTarget target, AbortCook",
          "old_line_content": "",
          "new_line_content": "        fz_intersect_rect(&mbox, &cbox);",
          "content_same": false
        },
        {
          "line": 2067,
          "old_api": null,
          "new_api": ")\n{\n    if (!page || !p",
          "old_text": null,
          "new_text": ")\n{\n    if (!page || !p",
          "old_line_content": "    // cf. pdf-page.c's pdf_bound_page",
          "new_line_content": "        if (fz_is_empty_rect(&mbox))",
          "content_same": false
        },
        {
          "line": 2068,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "       ",
          "old_line_content": "    fz_matrix ctm;",
          "new_line_content": "            return RectD();",
          "content_same": false
        },
        {
          "line": 4115,
          "old_api": null,
          "new_api": "ice omits text outside the",
          "old_text": null,
          "new_text": "ice omits text outside the ",
          "old_line_content": "    fz_device *dev = NULL;",
          "new_line_content": "        fz_rect pageclip = fz_RectD_to_rect(*pageRect);",
          "content_same": false
        },
        {
          "line": 4119,
          "old_api": null,
          "new_api": "t_page_to_str",
          "old_text": null,
          "new_text": "t_page_to_str(text, lineSep, c",
          "old_line_content": "    }",
          "new_line_content": "    fz_rect_from_irect(&cliprect, fz_round_rect(&tmp, &cliprect));",
          "content_same": false
        },
        {
          "line": 4122,
          "old_api": null,
          "new_api": "text);\n    fz_free_text_sheet(c",
          "old_text": null,
          "new_text": " text);\n    fz_free_text_sheet(c",
          "old_line_content": "        return false;",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2075,
          "old_api": null,
          "new_api": "f (pageRect)\n            pRect",
          "old_text": null,
          "new_text": "f (pageRect)\n            pRect",
          "old_line_content": "RectD PdfEngineImpl::PageContentBox(int pageNo, RenderTarget target)",
          "new_line_content": "    fz_transform_rect(&mbox, fz_rotate(&ctm, (float)rotate));",
          "content_same": false
        },
        {
          "line": 4127,
          "old_api": null,
          "new_api": "ata = NULL;\n    ScopedCritSec sc",
          "old_text": null,
          "new_text": "ata = NULL;\n    ScopedCritSec sc",
          "old_line_content": "    if (cookie_out)",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4130,
          "old_api": null,
          "new_api": "data = fz_extract_stream_d",
          "old_text": null,
          "new_text": "      data = fz_extract_stream_d",
          "old_line_content": "}",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2083,
          "old_api": null,
          "new_api": "screenRect.",
          "old_text": null,
          "new_text": "screenRect.",
          "old_line_content": "    fz_device *dev = NULL;",
          "new_line_content": "    assert(1 <= pageNo && pageNo <= PageCount());",
          "content_same": false
        },
        {
          "line": 4135,
          "old_api": null,
          "new_api": ": NULL;\n    }\n    return data;\n}\n\nbool XpsEngin",
          "old_text": null,
          "new_text": " : NULL;\n    }\n    return data;\n}\n\nbool XpsEngin",
          "old_line_content": "    if (!page)",
          "new_line_content": "    return RunPage(page, dev, ctm, &cliprect, true, cookie);",
          "content_same": false
        },
        {
          "line": 4148,
          "old_api": null,
          "new_api": "_fileName, copyFileName, FALSE);\n}",
          "old_text": null,
          "new_text": "_fileName, copyFileName, FALSE);\n}",
          "old_line_content": "    // GDI+ seems to render quicker and more reliably at high zoom levels",
          "new_line_content": "        xps_bound_page(_doc, page, &pRect);",
          "content_same": false
        },
        {
          "line": 2101,
          "old_api": null,
          "new_api": "iprect, fz_transform_rect(&pageclip,",
          "old_text": null,
          "new_text": "iprect, fz_transform_rect(&pageclip, ",
          "old_line_content": "",
          "new_line_content": "    pdf_bound_page(_doc, page, &pagerect);",
          "content_same": false
        },
        {
          "line": 4149,
          "old_api": null,
          "new_api": ":ExtractFontList()\n{\n    // l",
          "old_text": null,
          "new_text": ":ExtractFontList()\n{\n    // l",
          "old_line_content": "    if ((zoom > 40.0) != gDebugGdiPlusDevice) {",
          "new_line_content": "    fz_matrix ctm = viewctm(page, zoom, rotation);",
          "content_same": false
        },
        {
          "line": 2104,
          "old_api": null,
          "new_api": "evice *dev = NULL;",
          "old_text": null,
          "new_text": "evice *dev = NULL;\n ",
          "old_line_content": "}",
          "new_line_content": "        return PageMediabox(pageNo);",
          "content_same": false
        },
        {
          "line": 2105,
          "old_api": null,
          "new_api": "ticalSection",
          "old_text": null,
          "new_text": "ticalSection(&ctxAccess);\n",
          "old_line_content": "",
          "new_line_content": "    if (fz_is_infinite_rect(&rect))",
          "content_same": false
        },
        {
          "line": 2106,
          "old_api": null,
          "new_api": "dev = fz_new",
          "old_text": null,
          "new_text": "        dev = fz_new",
          "old_line_content": "PointD PdfEngineImpl::Transform(PointD pt, int pageNo, float zoom, int rotation, bool inverse)",
          "new_line_content": "        return PageMediabox(pageNo);",
          "content_same": false
        },
        {
          "line": 2109,
          "old_api": null,
          "new_api": "veCriticalSection",
          "old_text": null,
          "new_text": "veCriticalSection(&c",
          "old_line_content": "    if (inverse)",
          "new_line_content": "    return rect2.Intersect(PageMediabox(pageNo));",
          "content_same": false
        },
        {
          "line": 2114,
          "old_api": null,
          "new_api": "_out)\n        *cookie_out = coo",
          "old_text": null,
          "new_text": "_out)\n        *cookie_out = coo",
          "old_line_content": "}",
          "new_line_content": "    fz_matrix ctm = viewctm(pageNo, zoom, rotation);",
          "content_same": false
        },
        {
          "line": 2116,
          "old_api": null,
          "new_api": "return RunPage(page, dev",
          "old_text": null,
          "new_text": "    return RunPage(page, dev",
          "old_line_content": "RectD PdfEngineImpl::Transform(RectD rect, int pageNo, float zoom, int rotation, bool inverse)",
          "new_line_content": "        fz_invert_matrix(&ctm, &ctm);",
          "content_same": false
        },
        {
          "line": 4165,
          "old_api": null,
          "new_api": "op)\n        return Extract",
          "old_text": null,
          "new_text": "op)\n        return Extract",
          "old_line_content": "        if (!ok) {",
          "new_line_content": "        DeleteObject(SelectObject(hDCMem, hbmp));",
          "content_same": false
        },
        {
          "line": 2119,
          "old_api": null,
          "new_api": "s instead of fitz/dr",
          "old_text": null,
          "new_text": "s instead of fitz/dr",
          "old_line_content": "    if (inverse)",
          "new_line_content": "    return PointD(pt2.x, pt2.y);",
          "content_same": false
        },
        {
          "line": 4168,
          "old_api": null,
          "new_api": "witch (prop) {\n    case Prop_Title: return str::Dup(_info->tit",
          "old_text": null,
          "new_text": "witch (prop) {\n    case Prop_Title: return str::Dup(_info->tit",
          "old_line_content": "            return NULL;",
          "new_line_content": "        bool ok = RenderPage(hDCMem, page, rc, &ctm, 0, 0, pageRect, cookie_out);",
          "content_same": false
        },
        {
          "line": 4169,
          "old_api": null,
          "new_api": "se Prop_Author:",
          "old_text": null,
          "new_text": "se Prop_Author: ",
          "old_line_content": "        }",
          "new_line_content": "        DeleteDC(hDCMem);",
          "content_same": false
        },
        {
          "line": 2124,
          "old_api": null,
          "new_api": "if (!run)\n        return fa",
          "old_text": null,
          "new_text": "    if (!run)\n        return fa",
          "old_line_content": "}",
          "new_line_content": "    fz_matrix ctm = viewctm(pageNo, zoom, rotation);",
          "content_same": false
        },
        {
          "line": 4172,
          "old_api": null,
          "new_api": ":Dup(_info->subjec",
          "old_text": null,
          "new_text": ":Dup(_info->subjec",
          "old_line_content": "",
          "new_line_content": "            DeleteObject(hbmp);",
          "content_same": false
        },
        {
          "line": 2126,
          "old_api": null,
          "new_api": ";\n    // dev_gdiplus seems s",
          "old_text": null,
          "new_text": ";\n    // dev_gdiplus seems s",
          "old_line_content": "bool PdfEngineImpl::RenderPage(HDC hDC, pdf_page *page, RectI screenRect, const fz_matrix *ctm, float zoom, int rotation, RectD *pageRect, RenderTarget target, AbortCookie **cookie_out)",
          "new_line_content": "        fz_invert_matrix(&ctm, &ctm);",
          "content_same": false
        },
        {
          "line": 2127,
          "old_api": null,
          "new_api": "clipping than fitz/dra",
          "old_text": null,
          "new_text": "clipping than fitz/dra",
          "old_line_content": "{",
          "new_line_content": "    fz_rect rect2 = fz_RectD_to_rect(rect);",
          "content_same": false
        },
        {
          "line": 4173,
          "old_api": null,
          "new_api": "op_CreationDate:",
          "old_text": null,
          "new_text": "op_CreationDate: ",
          "old_line_content": "    fz_pixmap *image = NULL;",
          "new_line_content": "            CloseHandle(hMap);",
          "content_same": false
        },
        {
          "line": 2129,
          "old_api": null,
          "new_api": "= false;\n    // dev_gd",
          "old_text": null,
          "new_text": " = false;\n    // dev_gd",
          "old_line_content": "        return false;",
          "new_line_content": "    return fz_rect_to_RectD(rect2);",
          "content_same": false
        },
        {
          "line": 4180,
          "old_api": null,
          "new_api": "}\n};\n\nbool XpsEngineImpl::Suppor",
          "old_text": null,
          "new_text": "}\n};\n\nbool XpsEngineImpl::Suppor",
          "old_line_content": "    fz_catch(ctx) {",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2134,
          "old_api": null,
          "new_api": "result = false",
          "old_text": null,
          "new_text": "       result = false",
          "old_line_content": "        ctm = &ctm2;",
          "new_line_content": "    if (!page || !pdf_is_dict(page->me))",
          "content_same": false
        },
        {
          "line": 4182,
          "old_api": null,
          "new_api": "; // for now\n}\n\nvo",
          "old_text": null,
          "new_text": "; // for now\n}\n\nvo",
          "old_line_content": "        return NULL;",
          "new_line_content": "        fz_colorspace *colorspace = fz_device_rgb(ctx);",
          "content_same": false
        },
        {
          "line": 4183,
          "old_api": null,
          "new_api": "pdateUserAnnotations",
          "old_text": null,
          "new_text": "pdateUserAnnotations(Vec<PageAnnotation> *list)",
          "old_line_content": "    }",
          "new_line_content": "        image = fz_new_pixmap_with_bbox(ctx, colorspace, &bbox);",
          "content_same": false
        },
        {
          "line": 4184,
          "old_api": null,
          "new_api": "ODO: use a new critical section to avoid blo",
          "old_text": null,
          "new_text": "ODO: use a new critical section to avoid blo",
          "old_line_content": "",
          "new_line_content": "        fz_clear_pixmap_with_value(ctx, image, 0xFF); // initialize white background",
          "content_same": false
        },
        {
          "line": 2145,
          "old_api": null,
          "new_api": "ox;\n        fz_round_rect(&clipBox",
          "old_text": null,
          "new_text": "ox;\n        fz_round_rect(&clipBox",
          "old_line_content": "",
          "new_line_content": "            pdf_bound_page(_doc, page, &pRect);",
          "content_same": false
        },
        {
          "line": 4193,
          "old_api": null,
          "new_api": "intD pt)\n{\n    xps_page *page",
          "old_text": null,
          "new_text": "intD pt)\n{\n    xps_page *page ",
          "old_line_content": "    }",
          "new_line_content": "        dev = fz_new_draw_device(ctx, image);",
          "content_same": false
        },
        {
          "line": 4196,
          "old_api": null,
          "new_api": "ge)\n        return NULL;",
          "old_text": null,
          "new_text": "ge)\n        return NULL;\n\n",
          "old_line_content": "    FitzAbortCookie *cookie = NULL;",
          "new_line_content": "        fz_drop_pixmap(ctx, image);",
          "content_same": false
        },
        {
          "line": 4197,
          "old_api": null,
          "new_api": "t p = { (float)pt.x, (float)pt.y",
          "old_text": null,
          "new_text": "t p = { (float)pt.x, (float)pt.y",
          "old_line_content": "    if (cookie_out)",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2152,
          "old_api": null,
          "new_api": "*PdfEngineImpl::Rend",
          "old_text": null,
          "new_text": " *PdfEngineImpl::Rend",
          "old_line_content": "    if (pageRect) {",
          "new_line_content": "    HBRUSH bgBrush = CreateSolidBrush(RGB(0xFF, 0xFF, 0xFF));",
          "content_same": false
        },
        {
          "line": 2155,
          "old_api": null,
          "new_api": "f_page* page = GetPdf",
          "old_text": null,
          "new_text": "f_page* page = GetPdf",
          "old_line_content": "    }",
          "new_line_content": "    DeleteObject(bgBrush);",
          "content_same": false
        },
        {
          "line": 2159,
          "old_api": null,
          "new_api": "ct = fz_RectD_to_rect(*page",
          "old_text": null,
          "new_text": "ct = fz_RectD_to_rect(*page",
          "old_line_content": "    fz_device *dev = NULL;",
          "new_line_content": "        fz_rect pageclip = fz_RectD_to_rect(*pageRect);",
          "content_same": false
        },
        {
          "line": 2163,
          "old_api": null,
          "new_api": "fz_irect bbox;\n    fz_round_r",
          "old_text": null,
          "new_text": " fz_irect bbox;\n    fz_round_r",
          "old_line_content": "    }",
          "new_line_content": "    fz_rect_from_irect(&cliprect, fz_round_rect(&tmp, &cliprect));",
          "content_same": false
        },
        {
          "line": 4212,
          "old_api": null,
          "new_api": "ts[pageNo-1][i], i);\n    }\n\n    re",
          "old_text": null,
          "new_text": "ts[pageNo-1][i], i);\n    }\n\n    re",
          "old_line_content": "{",
          "new_line_content": "        bitmap = new_rendered_fz_pixmap(ctx, image);",
          "content_same": false
        },
        {
          "line": 4213,
          "old_api": null,
          "new_api": "LL;\n}\n\nVec<PageElement *>",
          "old_text": null,
          "new_text": "LL;\n}\n\nVec<PageElement *> ",
          "old_line_content": "    if (!page)",
          "new_line_content": "    fz_drop_pixmap(ctx, image);",
          "content_same": false
        },
        {
          "line": 2166,
          "old_api": null,
          "new_api": ");\n\n    if (PreferGdiPlusDevice(",
          "old_text": null,
          "new_text": ");\n\n    if (PreferGdiPlusDevice(",
          "old_line_content": "        return false;",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2171,
          "old_api": null,
          "new_api": "rix trans;\n        fz_concat(&ct",
          "old_text": null,
          "new_text": "rix trans;\n        fz_concat(&ct",
          "old_line_content": "    if (cookie_out)",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2174,
          "old_api": null,
          "new_api": "-bbox.x0, (float)-bbox.y0));",
          "old_text": null,
          "new_text": "-bbox.x0, (float)-bbox.y0));\n\n  ",
          "old_line_content": "}",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4228,
          "old_api": null,
          "new_api": "*>();\n    if (!els)\n        retu",
          "old_text": null,
          "new_text": "*>();\n    if (!els)\n        retu",
          "old_line_content": "    fz_catch(ctx) {",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 134,
          "old_api": null,
          "new_api": "fz_convert_pixmap",
          "old_text": null,
          "new_text": " fz_convert_pixmap",
          "old_line_content": "        }",
          "new_line_content": "            fz_colorspace *colorspace = fz_device_bgr(ctx);",
          "content_same": false
        },
        {
          "line": 135,
          "old_api": null,
          "new_api": "return NULL;\n        }\n    }",
          "old_text": null,
          "new_text": "    return NULL;\n        }\n    }\n ",
          "old_line_content": "    }",
          "new_line_content": "            bgrPixmap = fz_new_pixmap_with_bbox(ctx, colorspace, fz_pixmap_bbox(ctx, pixmap, &bbox));",
          "content_same": false
        },
        {
          "line": 4232,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": "{\n            els->Append(new XpsIma",
          "old_line_content": "        return NULL;",
          "new_line_content": "        dev = fz_new_text_device(ctx, sheet, text);",
          "content_same": false
        },
        {
          "line": 2185,
          "old_api": null,
          "new_api": "bool ok =",
          "old_text": null,
          "new_text": "       bool ok =",
          "old_line_content": "    if (run->clip_path_len > 50000)",
          "new_line_content": "    PdfPageRun *run = GetPageRun(page);",
          "content_same": false
        },
        {
          "line": 4235,
          "old_api": null,
          "new_api": "], i));\n        }\n    }",
          "old_text": null,
          "new_text": "], i));\n        }\n    }\n\n   ",
          "old_line_content": "",
          "new_line_content": "        fz_free_text_page(ctx, text);",
          "content_same": false
        },
        {
          "line": 4236,
          "old_api": null,
          "new_api": "nk *link = page->links; link;",
          "old_text": null,
          "new_text": "nk *link = page->links; link; ",
          "old_line_content": "    if (!cacheRun)",
          "new_line_content": "        fz_free_text_sheet(ctx, sheet);",
          "content_same": false
        },
        {
          "line": 142,
          "old_api": null,
          "new_api": "h = w;\n    bmih->biHeight = -h;",
          "old_text": null,
          "new_text": "h = w;\n    bmih->biHeight = -h;\n    ",
          "old_line_content": "    bmih->biPlanes = 1;",
          "new_line_content": "    AssertCrash(hasPalette || bgrPixmap);",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": null,
          "new_api": "pression",
          "old_text": null,
          "new_text": "pression ",
          "old_line_content": "    bmih->biBitCount = hasPalette ? 8 : 32;",
          "new_line_content": "    BITMAPINFOHEADER *bmih = &bmi.Get()->bmiHeader;",
          "content_same": false
        },
        {
          "line": 4240,
          "old_api": null,
          "new_api": "ect, pageNo));\n    }\n\n    els->R",
          "old_text": null,
          "new_text": "ect, pageNo));\n    }\n\n    els->R",
          "old_line_content": "    // the extracted text is consistent between cached runs using a list device and",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4243,
          "old_api": null,
          "new_api": "XpsEngineImpl::LinkifyPageText(xps_page",
          "old_text": null,
          "new_text": " XpsEngineImpl::LinkifyPageText(xps_page",
          "old_line_content": "",
          "new_line_content": "        fz_enable_device_hints(dev, FZ_NO_CACHE);",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": null,
          "new_api": "e);\n\n    if (hasPalette)\n        free(bmpData);\n    else",
          "old_text": null,
          "new_text": "e);\n\n    if (hasPalette)\n        free(bmpData);\n    else\n  ",
          "old_line_content": "    else",
          "new_line_content": "    HBITMAP hbmp = CreateDIBSection(NULL, bmi, DIB_RGB_COLORS, &data, hMap, 0);",
          "content_same": false
        },
        {
          "line": 2204,
          "old_api": null,
          "new_api": "try",
          "old_text": null,
          "new_text": "try(ctx) {\n        dev = fz_ne",
          "old_line_content": "    return result;",
          "new_line_content": "        fz_round_rect(&clipBox, &clip);",
          "content_same": false
        },
        {
          "line": 158,
          "old_api": null,
          "new_api": "bgrPixmap);\n\n    // return a RenderedBitmap even if hbmp is NULL so that c",
          "old_text": null,
          "new_text": "bgrPixmap);\n\n    // return a RenderedBitmap even if hbmp is NULL so that c",
          "old_line_content": "",
          "new_line_content": "        memcpy(data, hasPalette ? bmpData : bgrPixmap->samples, bmih->biSizeImage);",
          "content_same": false
        },
        {
          "line": 2205,
          "old_api": null,
          "new_api": "fz_catch(ctx) {\n        fz_d",
          "old_text": null,
          "new_text": "  fz_catch(ctx) {\n        fz_d",
          "old_line_content": "}",
          "new_line_content": "        fz_round_rect(&pageBox, pdf_bound_page(_doc, page, &r));",
          "content_same": false
        },
        {
          "line": 4252,
          "old_api": null,
          "new_api": "edMem<WCHAR> pageText(ExtractPageText(page, L\"",
          "old_text": null,
          "new_text": "edMem<WCHAR> pageText(ExtractPageText(page, L\"",
          "old_line_content": "",
          "new_line_content": "    WCHAR *content = fz_text_page_to_str(text, lineSep, coords_out);",
          "content_same": false
        },
        {
          "line": 161,
          "old_api": null,
          "new_api": "ering errors",
          "old_text": null,
          "new_text": "ering errors ",
          "old_line_content": "    // (and in the latter case retry using smaller target rectangles)",
          "new_line_content": "        free(bmpData);",
          "content_same": false
        },
        {
          "line": 4253,
          "old_api": null,
          "new_api": "oords, true));\n    if (!page",
          "old_text": null,
          "new_text": "oords, true));\n    if (!page",
          "old_line_content": "unsigned char *XpsEngineImpl::GetFileData(size_t *cbCount)",
          "new_line_content": "    fz_free_text_page(ctx, text);",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": null,
          "new_api": "austion\n    // (and in the lat",
          "old_text": null,
          "new_text": "austion\n    // (and in the lat",
          "old_line_content": "}",
          "new_line_content": "        fz_drop_pixmap(ctx, bgrPixmap);",
          "content_same": false
        },
        {
          "line": 4254,
          "old_api": null,
          "new_api": "return;\n\n    LinkRectLi",
          "old_text": null,
          "new_text": "       return;\n\n    LinkRectLi",
          "old_line_content": "{",
          "new_line_content": "    fz_free_text_sheet(ctx, sheet);",
          "content_same": false
        },
        {
          "line": 2216,
          "old_api": null,
          "new_api": "eredBitmap *bitmap =",
          "old_text": null,
          "new_text": "eredBitmap *bitmap = ",
          "old_line_content": "    else",
          "new_line_content": "    if (!page || !pdf_is_dict(page->me))",
          "content_same": false
        },
        {
          "line": 4264,
          "old_api": null,
          "new_api": "t->next)\n            overlaps = fz_calc_ove",
          "old_text": null,
          "new_text": "t->next)\n            overlaps = fz_calc_ove",
          "old_line_content": "}",
          "new_line_content": "        data = fz_extract_stream_data(_doc->file, cbCount);",
          "content_same": false
        },
        {
          "line": 4267,
          "old_api": null,
          "new_api": "ScopedMem<char> uri(str:",
          "old_text": null,
          "new_text": "         ScopedMem<char> uri(str:",
          "old_line_content": "{",
          "new_line_content": "        return _fileName ? (unsigned char *)file::ReadAll(_fileName, cbCount) : NULL;",
          "content_same": false
        },
        {
          "line": 174,
          "old_api": null,
          "new_api": "if (fileSize > 0 && fil",
          "old_text": null,
          "new_text": "if (fileSize > 0 && fil",
          "old_line_content": "        fz_try(ctx) {",
          "new_line_content": "    int64 fileSize = file::GetSize(filePath);",
          "content_same": false
        },
        {
          "line": 2224,
          "old_api": null,
          "new_api": "pt)\n{\n    pdf_page *page = G",
          "old_text": null,
          "new_text": " pt)\n{\n    pdf_page *page = G",
          "old_line_content": "        int w = bbox.x1 - bbox.x0, h = bbox.y1 - bbox.y0;",
          "new_line_content": "    fz_matrix ctm = viewctm(page, zoom, rotation);",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": null,
          "new_api": "a->data, dat",
          "old_text": null,
          "new_text": "a->data, dat",
          "old_line_content": "        }",
          "new_line_content": "        fz_var(data);",
          "content_same": false
        },
        {
          "line": 2227,
          "old_api": null,
          "new_api": "nt p = { (float)pt.x, (floa",
          "old_text": null,
          "new_text": "nt p = { (float)pt.x, (floa",
          "old_line_content": "",
          "new_line_content": "    fz_round_rect(&bbox, fz_transform_rect(&r, &ctm));",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": null,
          "new_api": "r",
          "old_text": null,
          "new_text": "r(ctx, data);\n        }\n        f",
          "old_line_content": "            file = NULL;",
          "new_line_content": "            data = fz_new_buffer(ctx, (int)fileSize);",
          "content_same": false
        },
        {
          "line": 2229,
          "old_api": null,
          "new_api": "for (fz_link *link = page->links; link",
          "old_text": null,
          "new_text": "for (fz_link *link = page->links; link",
          "old_line_content": "        HANDLE hMap = NULL;",
          "new_line_content": "    if (PreferGdiPlusDevice(page, zoom, pRect) != gDebugGdiPlusDevice) {",
          "content_same": false
        },
        {
          "line": 4275,
          "old_api": null,
          "new_api": "add links in top-to-b",
          "old_text": null,
          "new_text": "add links in top-to-b",
          "old_line_content": "    if (!_fileName)",
          "new_line_content": "    ScopedMem<unsigned char> data(GetFileData(&dataLen));",
          "content_same": false
        },
        {
          "line": 184,
          "old_api": null,
          "new_api": "fz_try(ctx) {\n        f",
          "old_text": null,
          "new_text": "  fz_try(ctx) {\n        f",
          "old_line_content": "        if (file)",
          "new_line_content": "                file = fz_open_buffer(ctx, data);",
          "content_same": false
        },
        {
          "line": 4289,
          "old_api": null,
          "new_api": "(pageNo);",
          "old_text": null,
          "new_text": "(pageNo);\n ",
          "old_line_content": "    WStrVec fonts;",
          "new_line_content": "    for (int i = 1; i <= PageCount(); i++)",
          "content_same": false
        },
        {
          "line": 4290,
          "old_api": null,
          "new_api": "return",
          "old_text": null,
          "new_text": "      return ",
          "old_line_content": "    for (xps_font_cache *font = _doc->font_table; font; font = font->next) {",
          "new_line_content": "        GetXpsPage(i);",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": null,
          "new_api": "ream, 0, 2);\n    int fileLen",
          "old_text": null,
          "new_text": "ream, 0, 2);\n    int fileLen ",
          "old_line_content": "}",
          "new_line_content": "        file = fz_open_file_w(ctx, filePath);",
          "content_same": false
        },
        {
          "line": 2243,
          "old_api": null,
          "new_api": "\")));\n                return new PdfComment(contents, fz_rect_to_RectD(r",
          "old_text": null,
          "new_text": "\")));\n                return new PdfComment(contents, fz_rect_to_RectD(r",
          "old_line_content": "            return NULL;",
          "new_line_content": "        bool ok = RenderPage(hDCMem, page, rc, &ctm, 0, 0, &pageRect2, target, cookie_out);",
          "content_same": false
        },
        {
          "line": 2244,
          "old_api": null,
          "new_api": "o);",
          "old_text": null,
          "new_text": "o);\n            ",
          "old_line_content": "        }",
          "new_line_content": "        DeleteDC(hDCMem);",
          "content_same": false
        },
        {
          "line": 2247,
          "old_api": null,
          "new_api": "ze_t i = 0; !fz_is",
          "old_text": null,
          "new_text": "ze_t i = 0; !fz_is",
          "old_line_content": "",
          "new_line_content": "            DeleteObject(hbmp);",
          "content_same": false
        },
        {
          "line": 2248,
          "old_api": null,
          "new_api": "ageRects[pageNo-1",
          "old_text": null,
          "new_text": "ageRects[pageNo-1",
          "old_line_content": "    fz_pixmap *image = NULL;",
          "new_line_content": "            CloseHandle(hMap);",
          "content_same": false
        },
        {
          "line": 4297,
          "old_api": null,
          "new_api": "}\n    fz_catch(ctx) {",
          "old_text": null,
          "new_text": "  }\n    fz_catch(ctx) {\n       ",
          "old_line_content": "",
          "new_line_content": "        ScopedMem<WCHAR> path(str::conv::FromUtf8(font->name));",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": null,
          "new_api": "unsigned char *)memdu",
          "old_text": null,
          "new_text": "unsigned char *)memdu",
          "old_line_content": "",
          "new_line_content": "    fz_seek(stream, 0, 2);",
          "content_same": false
        },
        {
          "line": 4301,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "Count() || fz",
          "old_line_content": "",
          "new_line_content": "    if (fonts.Count() == 0)",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": null,
          "new_api": "nt)\n        *cbCount",
          "old_text": null,
          "new_text": "nt)\n        *cbCount ",
          "old_line_content": "    if (cbCount)",
          "new_line_content": "    fz_seek(stream, 0, 0);",
          "content_same": false
        },
        {
          "line": 2255,
          "old_api": null,
          "new_api": "[i], i);\n    }\n\n    return NULL;",
          "old_text": null,
          "new_text": "[i], i);\n    }\n\n    return NULL;",
          "old_line_content": "    fz_catch(ctx) {",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": null,
          "new_api": "uffer",
          "old_text": null,
          "new_text": "uffer(stream->ctx, buffer);\n",
          "old_line_content": "",
          "new_line_content": "    fz_buffer *buffer = fz_read_all(stream, fileLen);",
          "content_same": false
        },
        {
          "line": 2257,
          "old_api": null,
          "new_api": "eNo)\n{\n    pdf_pag",
          "old_text": null,
          "new_text": "eNo)\n{\n    pdf_pag",
          "old_line_content": "        return NULL;",
          "new_line_content": "        fz_colorspace *colorspace = fz_device_rgb(ctx);",
          "content_same": false
        },
        {
          "line": 2258,
          "old_api": null,
          "new_api": "e",
          "old_text": null,
          "new_text": "e(pageNo, true);\n    if (!page)\n        return ",
          "old_line_content": "    }",
          "new_line_content": "        image = fz_new_pixmap_with_bbox(ctx, colorspace, &bbox);",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": null,
          "new_api": "ream_data\");\n    return data;\n}",
          "old_text": null,
          "new_text": "ream_data\");\n    return data;\n}\n\n",
          "old_line_content": "    if (!data)",
          "new_line_content": "    unsigned char *data = (unsigned char *)memdup(buffer->data, buffer->len);",
          "content_same": false
        },
        {
          "line": 2259,
          "old_api": null,
          "new_api": "// since all elements lists are in last-to-f",
          "old_text": null,
          "new_text": "// since all elements lists are in last-to-f",
          "old_line_content": "",
          "new_line_content": "        fz_clear_pixmap_with_value(ctx, image, 0xFF); // initialize white background",
          "content_same": false
        },
        {
          "line": 4304,
          "old_api": null,
          "new_api": ".rect) != rect) {",
          "old_text": null,
          "new_text": ".rect) != rect) {\n ",
          "old_line_content": "    if (Prop_FontList == prop)",
          "new_line_content": "    fonts.SortNatural();",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": null,
          "new_api": "gest[16])\n{\n    int fileLen = -1;",
          "old_text": null,
          "new_text": "gest[16])\n{\n    int fileLen = -1;\n ",
          "old_line_content": "",
          "new_line_content": "    fz_drop_buffer(stream->ctx, buffer);",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": null,
          "new_api": "fz_try(file->ctx) {\n        fz_seek(file, 0, 2);\n        fileLen =",
          "old_text": null,
          "new_text": "\n    fz_try(file->ctx) {\n        fz_seek(file, 0, 2);\n        fileLen = ",
          "old_line_content": "    int fileLen = -1;",
          "new_line_content": "        fz_throw(stream->ctx, FZ_ERROR_GENERIC, \"OOM in fz_extract_stream_data\");",
          "content_same": false
        },
        {
          "line": 2268,
          "old_api": null,
          "new_api": "Rects[pageNo-1]) {\n        for",
          "old_text": null,
          "new_text": "Rects[pageNo-1]) {\n        for",
          "old_line_content": "    }",
          "new_line_content": "        dev = fz_new_draw_device(ctx, image);",
          "content_same": false
        },
        {
          "line": 4316,
          "old_api": null,
          "new_api": ">h);\n    }\n    fz_catc",
          "old_text": null,
          "new_text": ">h);\n    }\n    fz_catc",
          "old_line_content": "    }",
          "new_line_content": "    case Prop_Title: return str::Dup(_info->title);",
          "content_same": false
        },
        {
          "line": 4317,
          "old_api": null,
          "new_api": "}\n    RenderedBitmap",
          "old_text": null,
          "new_text": "  }\n    RenderedBitmap ",
          "old_line_content": "};",
          "new_line_content": "    case Prop_Author: return str::Dup(_info->author);",
          "content_same": false
        },
        {
          "line": 2271,
          "old_api": null,
          "new_api": "eRects[pageNo-1][i]); i++)",
          "old_text": null,
          "new_text": "eRects[pageNo-1][i]); i++)",
          "old_line_content": "    FitzAbortCookie *cookie = NULL;",
          "new_line_content": "        fz_drop_pixmap(ctx, image);",
          "content_same": false
        },
        {
          "line": 2272,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": "  els->Append(new PdfImage(this,",
          "old_line_content": "    if (cookie_out)",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4318,
          "old_api": null,
          "new_api": ", pixmap);\n    fz_drop_p",
          "old_text": null,
          "new_text": ", pixmap);\n    fz_drop_p",
          "old_line_content": "",
          "new_line_content": "    case Prop_Subject: return str::Dup(_info->subject);",
          "content_same": false
        },
        {
          "line": 4319,
          "old_api": null,
          "new_api": "fz_rect XpsEngineImpl::FindD",
          "old_text": null,
          "new_text": "\n\nfz_rect XpsEngineImpl::FindD",
          "old_line_content": "bool XpsEngineImpl::SupportsAnnotation(bool forSaving) const",
          "new_line_content": "    case Prop_CreationDate: return str::Dup(_info->creation_date);",
          "content_same": false
        },
        {
          "line": 4320,
          "old_api": null,
          "new_api": ":IsEmpty(target))\n        return f",
          "old_text": null,
          "new_text": ":IsEmpty(target))\n        return f",
          "old_line_content": "{",
          "new_line_content": "    case Prop_ModificationDate: return str::Dup(_info->modification_date);",
          "content_same": false
        },
        {
          "line": 231,
          "old_api": null,
          "new_api": "eturn;\n    }\n    Cr",
          "old_text": null,
          "new_text": "eturn;\n    }\n    Cr",
          "old_line_content": "        return;",
          "new_line_content": "        fz_seek(file, 0, 0);",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": null,
          "new_api": ");\n    CrashIf(fileLen !=",
          "old_text": null,
          "new_text": ");\n    CrashIf(fileLen != ",
          "old_line_content": "    }",
          "new_line_content": "        buffer = fz_read_all(file, fileLen);",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": null,
          "new_api": "t",
          "old_text": null,
          "new_text": "t(&md5);\n    fz_md5_update(&md5, buffer->data, buffer->len);\n    fz_md5_final(&md",
          "old_line_content": "",
          "new_line_content": "        fz_warn(file->ctx, \"couldn't read stream data, using a NULL fingerprint instead\");",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": null,
          "new_api": "fz_drop_buffer(f",
          "old_text": null,
          "new_text": "\n\n    fz_drop_buffer(f",
          "old_line_content": "    fz_md5 md5;",
          "new_line_content": "        ZeroMemory(digest, 16);",
          "content_same": false
        },
        {
          "line": 2287,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": ")));\n            els->Append(new P",
          "old_line_content": "{",
          "new_line_content": "        bitmap = new_rendered_fz_pixmap(ctx, image);",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": null,
          "new_api": "*text, WCHAR *lineSep, RectI *",
          "old_text": null,
          "new_text": " *text, WCHAR *lineSep, RectI *",
          "old_line_content": "",
          "new_line_content": "    CrashIf(fileLen != buffer->len);",
          "content_same": false
        },
        {
          "line": 4337,
          "old_api": null,
          "new_api": "XpsEngineImpl::Get",
          "old_text": null,
          "new_text": "XpsEngineImpl::Get",
          "old_line_content": "    if (!page)",
          "new_line_content": "        userAnnots.Reset();",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": null,
          "new_api": "ze_t lineSepLen =",
          "old_text": null,
          "new_text": "ze_t lineSepLen =",
          "old_line_content": "",
          "new_line_content": "    fz_md5_init(&md5);",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": null,
          "new_api": "en",
          "old_text": null,
          "new_text": "en(lineSep);\n    size_t textLen = 0;\n    for (",
          "old_line_content": "WCHAR *fz_text_page_to_str(fz_text_page *text, WCHAR *lineSep, RectI **coords_out=NULL)",
          "new_line_content": "    fz_md5_update(&md5, buffer->data, buffer->len);",
          "content_same": false
        },
        {
          "line": 245,
          "old_api": null,
          "new_api": "_block *block = text->bloc",
          "old_text": null,
          "new_text": "_block *block = text->bloc",
          "old_line_content": "{",
          "new_line_content": "    fz_md5_final(&md5, digest);",
          "content_same": false
        },
        {
          "line": 247,
          "old_api": null,
          "new_api": "< text->blocks + text->len; bloc",
          "old_text": null,
          "new_text": " < text->blocks + text->len; bloc",
          "old_line_content": "    size_t textLen = 0;",
          "new_line_content": "    fz_drop_buffer(file->ctx, buffer);",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": null,
          "new_api": ">lines; line < bl",
          "old_text": null,
          "new_text": ">lines; line < bl",
          "old_line_content": "            for (fz_text_span *span = line->first_span; span; span = span->next) {",
          "new_line_content": "    size_t lineSepLen = str::Len(lineSep);",
          "content_same": false
        },
        {
          "line": 2300,
          "old_api": null,
          "new_api": "inks = FixupPageLinks(page->lin",
          "old_text": null,
          "new_text": "inks = FixupPageLinks(page->lin",
          "old_line_content": "            pdf_annot *annot = pageAnnots[pageNo-1][i];",
          "new_line_content": "        if (link->dest.kind != FZ_LINK_NONE && fz_is_pt_in_rect(link->rect, p))",
          "content_same": false
        },
        {
          "line": 4348,
          "old_api": null,
          "new_api": "name_utf8))\n            return",
          "old_text": null,
          "new_text": " name_utf8))\n            return",
          "old_line_content": "                return new XpsImage(this, pageNo, imageRects[pageNo-1][i], i);",
          "new_line_content": "        if (fz_is_pt_in_rect(link->rect, p))",
          "content_same": false
        },
        {
          "line": 4352,
          "old_api": null,
          "new_api": "*entry, int& idCounter)\n{\n    XpsTocItem *",
          "old_text": null,
          "new_text": "*entry, int& idCounter)\n{\n    XpsTocItem *",
          "old_line_content": "}",
          "new_line_content": "        for (int i = 0; !fz_is_empty_rect(&imageRects[pageNo-1][i]); i++)",
          "content_same": false
        },
        {
          "line": 4353,
          "old_api": null,
          "new_api": "entry; entry = entry->next) {\n        WCHAR",
          "old_text": null,
          "new_text": " entry; entry = entry->next) {\n        WCHAR",
          "old_line_content": "",
          "new_line_content": "            if (fz_is_pt_in_rect(imageRects[pageNo-1][i], p))",
          "content_same": false
        },
        {
          "line": 2308,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "links.Count(); i++) {\n        bool o",
          "old_line_content": "            }",
          "new_line_content": "            fz_transform_rect(&rect, &page->ctm);",
          "content_same": false
        },
        {
          "line": 2309,
          "old_api": null,
          "new_api": "for (fz_link *next",
          "old_text": null,
          "new_text": "      for (fz_link *next ",
          "old_line_content": "        }",
          "new_line_content": "            if (fz_is_pt_in_rect(rect, p)) {",
          "content_same": false
        },
        {
          "line": 2312,
          "old_api": null,
          "new_api": "rect) >= 0.25f;\n        if (!overlaps",
          "old_text": null,
          "new_text": "rect) >= 0.25f;\n        if (!overlaps",
          "old_line_content": "    if (imageRects[pageNo-1]) {",
          "new_line_content": "                ScopedMem<WCHAR> contents(str::conv::FromPdf(pdf_dict_gets(annot->obj, \"Contents\")));",
          "content_same": false
        },
        {
          "line": 4362,
          "old_api": null,
          "new_api": "open = entry->is_open;",
          "old_text": null,
          "new_text": "open = entry->is_open;\n\n",
          "old_line_content": "    Vec<PageElement *> *els = new Vec<PageElement *>();",
          "new_line_content": "    xps_page *page = GetXpsPage(pageNo, true);",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": null,
          "new_api": "!= FZ_PAGE_BLOCK_TEXT)",
          "old_text": null,
          "new_text": " != FZ_PAGE_BLOCK_TEXT)\n      ",
          "old_line_content": "",
          "new_line_content": "        destRect = *coords_out = AllocArray<RectI>(textLen + 1);",
          "content_same": false
        },
        {
          "line": 2319,
          "old_api": null,
          "new_api": "= fz_strdup(ctx, uri);\n            // add",
          "old_text": null,
          "new_text": "= fz_strdup(ctx, uri);\n            // add ",
          "old_line_content": "}",
          "new_line_content": "        for (size_t i = 0; !fz_is_empty_rect(&imageRects[pageNo-1][i]); i++)",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": null,
          "new_api": "ine = block->",
          "old_text": null,
          "new_text": "ine = block->",
          "old_line_content": "    for (fz_page_block *block = text->blocks; block < text->blocks + text->len; block++) {",
          "new_line_content": "            free(content);",
          "content_same": false
        },
        {
          "line": 2320,
          "old_api": null,
          "new_api": "rder (i.e. last-to-first)\n            fz_lin",
          "old_text": null,
          "new_text": "rder (i.e. last-to-first)\n            fz_lin",
          "old_line_content": "",
          "new_line_content": "            if (fz_is_pt_in_rect(imageRects[pageNo-1][i], p))",
          "content_same": false
        },
        {
          "line": 4374,
          "old_api": null,
          "new_api": "int idCounter = 0;\n    return BuildTocTree(_outline, idCounter);",
          "old_text": null,
          "new_text": "  int idCounter = 0;\n    return BuildTocTree(_outline, idCounter);\n",
          "old_line_content": "    }",
          "new_line_content": "            els->Append(new XpsImage(this, pageNo, imageRects[pageNo-1][i], i));",
          "content_same": false
        },
        {
          "line": 2329,
          "old_api": null,
          "new_api": "Impl::ProcessPageAnnotat",
          "old_text": null,
          "new_text": "Impl::ProcessPageAnnotat",
          "old_line_content": "    Vec<PageElement *> *els = new Vec<PageElement *>();",
          "new_line_content": "    pdf_page *page = GetPdfPage(pageNo, true);",
          "content_same": false
        },
        {
          "line": 4379,
          "old_api": null,
          "new_api": "true);\n    // GetXpsPage extracts imageRects for us\n    if (!p",
          "old_text": null,
          "new_text": " true);\n    // GetXpsPage extracts imageRects for us\n    if (!p",
          "old_line_content": "",
          "new_line_content": "        els->Append(new XpsLink(this, &link->dest, link->rect, pageNo));",
          "content_same": false
        },
        {
          "line": 4382,
          "old_api": null,
          "new_api": "ts[pageNo-1])",
          "old_text": null,
          "new_text": "ts[pageNo-1])\n",
          "old_line_content": "    // make MuXPS extract all links and named destinations from the page",
          "new_line_content": "    els->Reverse();",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "                ",
          "old_line_content": "                            continue;",
          "new_line_content": "                        if (!str::IsWs(*dest))",
          "content_same": false
        },
        {
          "line": 290,
          "old_api": null,
          "new_api": "_bbox",
          "old_text": null,
          "new_text": "_bbox(&bbox, span, ",
          "old_line_content": "                    if (destRect) {",
          "new_line_content": "                        else if (dest > content && !str::IsWs(dest[-1]))",
          "content_same": false
        },
        {
          "line": 2340,
          "old_api": null,
          "new_api": "fz_rect rect;\n            pdf_to_rect(c",
          "old_text": null,
          "new_text": "   fz_rect rect;\n            pdf_to_rect(c",
          "old_line_content": "",
          "new_line_content": "        for (size_t i = 0; !fz_is_empty_rect(&imageRects[pageNo-1][i]); i++)",
          "content_same": false
        },
        {
          "line": 2341,
          "old_api": null,
          "new_api": "not->obj, \"Rect\"), &rect);\n            if (file && embedded && !fz_",
          "old_text": null,
          "new_text": "not->obj, \"Rect\"), &rect);\n            if (file && embedded && !fz_",
          "old_line_content": "        for (size_t i = 0; pageAnnots[pageNo-1][i]; i++) {",
          "new_line_content": "            els->Append(new PdfImage(this, pageNo, imageRects[pageNo-1][i], i));",
          "content_same": false
        },
        {
          "line": 4389,
          "old_api": null,
          "new_api": "mageRects[pageNo-1][i]",
          "old_text": null,
          "new_text": "mageRects[pageNo-1][i]",
          "old_line_content": "        page->links_resolved = 1;",
          "new_line_content": "    assert(!GetPageRun(page, true));",
          "content_same": false
        },
        {
          "line": 4391,
          "old_api": null,
          "new_api": "cts[pageNo-1][i]) >= 0.9f)",
          "old_text": null,
          "new_text": "cts[pageNo-1][i]) >= 0.9f)\n          ",
          "old_line_content": "",
          "new_line_content": "    assert(!run == !page->links_resolved);",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": null,
          "new_api": "might be a table)\n                    *dest++",
          "old_text": null,
          "new_text": "might be a table)\n                    *dest++ ",
          "old_line_content": "                    *dest++ = ' ';",
          "new_line_content": "                        fz_text_char_bbox(&bbox, span, c - span->text);",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": null,
          "new_api": "{\n                        Rect",
          "old_text": null,
          "new_text": "{\n                        Rect",
          "old_line_content": "                    if (destRect) {",
          "new_line_content": "                        *destRect++ = fz_rect_to_RectD(bbox).Round();",
          "content_same": false
        },
        {
          "line": 4396,
          "old_api": null,
          "new_api": "leName)\n{\n    XpsEngineImpl *engine = new XpsE",
          "old_text": null,
          "new_text": "leName)\n{\n    XpsEngineImpl *engine = new XpsE",
          "old_line_content": "",
          "new_line_content": "    assert(!page->links || page->links->refs == 1);",
          "content_same": false
        },
        {
          "line": 2350,
          "old_api": null,
          "new_api": "m = pdf_to_num(embedded);",
          "old_text": null,
          "new_text": "m = pdf_to_num(embedded);\n          ",
          "old_line_content": "    for (fz_link *link = page->links; link; link = link->next) {",
          "new_line_content": "            fz_transform_rect(&rect, &page->ctm);",
          "content_same": false
        },
        {
          "line": 2351,
          "old_api": null,
          "new_api": "ld.ld.launch.is_uri = 0;",
          "old_text": null,
          "new_text": "            ld.ld.launch.is_uri = 0;\n",
          "old_line_content": "        if (link->dest.kind != FZ_LINK_NONE) {",
          "new_line_content": "            ScopedMem<WCHAR> contents(str::conv::FromPdf(pdf_dict_gets(annot->obj, \"Contents\")));",
          "content_same": false
        },
        {
          "line": 4399,
          "old_api": null,
          "new_api": "oad",
          "old_text": null,
          "new_text": "oad(fileName)) {\n        delete engine;\n   ",
          "old_line_content": "        bool overlaps = false;",
          "new_line_content": "    ScopedMem<WCHAR> pageText(ExtractPageText(page, L\"\\n\", &coords, true));",
          "content_same": false
        },
        {
          "line": 4404,
          "old_api": null,
          "new_api": "*engine = new XpsEn",
          "old_text": null,
          "new_text": "*engine = new XpsEn",
          "old_line_content": "            if (!uri) continue;",
          "new_line_content": "    for (size_t i = 0; i < list->links.Count(); i++) {",
          "content_same": false
        },
        {
          "line": 2358,
          "old_api": null,
          "new_api": "page->links = link;\n                // TODO: expose",
          "old_text": null,
          "new_text": "           page->links = link;\n                // TODO: expose ",
          "old_line_content": "}",
          "new_line_content": "            els->Append(new PdfLink(this, &link->dest, link->rect, pageNo));",
          "content_same": false
        },
        {
          "line": 4407,
          "old_api": null,
          "new_api": "onst WCHAR *fileNa",
          "old_text": null,
          "new_text": "onst WCHAR *fileNa",
          "old_line_content": "            // add links in top-to-bottom order (i.e. last-to-first)",
          "new_line_content": "            overlaps = fz_calc_overlap(list->coords.At(i), next->rect) >= 0.25f;",
          "content_same": false
        },
        {
          "line": 4409,
          "old_api": null,
          "new_api": "uncompressed XPS",
          "old_text": null,
          "new_text": "uncompressed XPS ",
          "old_line_content": "            link->next = page->links;",
          "new_line_content": "            ScopedMem<char> uri(str::conv::ToUtf8(list->links.At(i)));",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": null,
          "new_api": "}\n\nstruct istream_f",
          "old_text": null,
          "new_text": "}\n\nstruct istream_f",
          "old_line_content": "            dest += lineSepLen;",
          "new_line_content": "            if (lineSepLen > 0 && dest > content && str::IsWs(dest[-1])) {",
          "content_same": false
        },
        {
          "line": 4412,
          "old_api": null,
          "new_api": "Exists",
          "old_text": null,
          "new_text": "Exists(relsPath) ||",
          "old_line_content": "    }",
          "new_line_content": "            ld.ld.uri.uri = fz_strdup(ctx, uri);",
          "content_same": false
        },
        {
          "line": 317,
          "old_api": null,
          "new_api": "eam *st",
          "old_text": null,
          "new_text": "eam *st",
          "old_line_content": "        }",
          "new_line_content": "                    *--destRect = RectI();",
          "content_same": false
        },
        {
          "line": 4414,
          "old_api": null,
          "new_api": "!= (size_t)-1 ||",
          "old_text": null,
          "new_text": "!= (size_t)-1 ||\n ",
          "old_line_content": "    delete list;",
          "new_line_content": "            fz_link *link = fz_new_link(ctx, &list->coords.At(i), ld);",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": null,
          "new_api": "er *state = (istream_f",
          "old_text": null,
          "new_text": "er *state = (istream_f",
          "old_line_content": "",
          "new_line_content": "            lstrcpy(dest, lineSep);",
          "content_same": false
        },
        {
          "line": 2368,
          "old_api": null,
          "new_api": "))) {\n                annot",
          "old_text": null,
          "new_text": "))) {\n                annot",
          "old_line_content": "        return;",
          "new_line_content": "    page->links = FixupPageLinks(page->links);",
          "content_same": false
        },
        {
          "line": 2369,
          "old_api": null,
          "new_api": "d",
          "old_text": null,
          "new_text": "d(annot);\n            }\n        }\n        else",
          "old_line_content": "",
          "new_line_content": "    assert(!page->links || page->links->refs == 1);",
          "content_same": false
        },
        {
          "line": 2372,
          "old_api": null,
          "new_api": "obj, \"Contents\"))) && annot->annot_type != FZ_ANNOT_FREE",
          "old_text": null,
          "new_text": "obj, \"Contents\"))) && annot->annot_type != FZ_ANNOT_FREE",
          "old_line_content": "        bool overlaps = false;",
          "new_line_content": "    ScopedMem<WCHAR> pageText(ExtractPageText(page, L\"\\n\", &coords, Target_View, true));",
          "content_same": false
        },
        {
          "line": 4421,
          "old_api": null,
          "new_api": "].last.piece",
          "old_text": null,
          "new_text": "].last.piece",
          "old_line_content": "    if (!page)",
          "new_line_content": "    free(coords);",
          "content_same": false
        },
        {
          "line": 2377,
          "old_api": null,
          "new_api": "ist into top-to-bot",
          "old_text": null,
          "new_text": "ist into top-to-bot",
          "old_line_content": "            if (!uri) continue;",
          "new_line_content": "    for (size_t i = 0; i < list->links.Count(); i++) {",
          "content_same": false
        },
        {
          "line": 4426,
          "old_api": null,
          "new_api": "ngine *CreateFromF",
          "old_text": null,
          "new_text": "ngine *CreateFromF",
          "old_line_content": "    fz_device *dev = NULL;",
          "new_line_content": "    xps_page *page = GetXpsPage(pageNo);",
          "content_same": false
        },
        {
          "line": 2380,
          "old_api": null,
          "new_api": "eImpl::GetPageImag",
          "old_text": null,
          "new_text": "eImpl::GetPageImag",
          "old_line_content": "            // add links in top-to-bottom order (i.e. last-to-first)",
          "new_line_content": "            overlaps = fz_calc_overlap(list->coords.At(i), next->rect) >= 0.25f;",
          "content_same": false
        },
        {
          "line": 2382,
          "old_api": null,
          "new_api": "return NUL",
          "old_text": null,
          "new_text": "       return NUL",
          "old_line_content": "            link->next = page->links;",
          "new_line_content": "            ScopedMem<char> uri(str::conv::ToUtf8(list->links.At(i)));",
          "content_same": false
        },
        {
          "line": 2385,
          "old_api": null,
          "new_api": "ticalSection",
          "old_text": null,
          "new_text": "ticalSection(&ctxAc",
          "old_line_content": "    }",
          "new_line_content": "            ld.ld.uri.uri = fz_strdup(ctx, uri);",
          "content_same": false
        },
        {
          "line": 338,
          "old_api": null,
          "new_api": "m, int offset, int whence)\n{\n    istream_filter *state = (is",
          "old_text": null,
          "new_text": "m, int offset, int whence)\n{\n    istream_filter *state = (is",
          "old_line_content": "",
          "new_line_content": "    HRESULT res = state->stream->Read(state->buf, sizeof(state->buf), &cbRead);",
          "content_same": false
        },
        {
          "line": 339,
          "old_api": null,
          "new_api": "r *)stm->st",
          "old_text": null,
          "new_text": "r *)stm->st",
          "old_line_content": "    return cbRead > 0 ? *stm->rp++ : EOF;",
          "new_line_content": "    if (FAILED(res))",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": null,
          "new_api": "RGE_INTEGER off;\n    ULARGE_INTEGER n;\n    off.QuadPart = offset;",
          "old_text": null,
          "new_text": "RGE_INTEGER off;\n    ULARGE_INTEGER n;\n    off.QuadPart = offset;\n ",
          "old_line_content": "}",
          "new_line_content": "        fz_throw(stm->ctx, FZ_ERROR_GENERIC, \"IStream read error: %x\", res);",
          "content_same": false
        },
        {
          "line": 2387,
          "old_api": null,
          "new_api": "ticalSection",
          "old_text": null,
          "new_text": "ticalSection(&ctxA",
          "old_line_content": "    delete list;",
          "new_line_content": "            fz_link *link = fz_new_link(ctx, &list->coords.At(i), ld);",
          "content_same": false
        },
        {
          "line": 4434,
          "old_api": null,
          "new_api": "Impl::CreateFromStream(stream);",
          "old_text": null,
          "new_text": "Impl::CreateFromStream(stream);\n",
          "old_line_content": "        return NULL;",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4439,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2394,
          "old_api": null,
          "new_api": "mageIx >= po",
          "old_text": null,
          "new_text": "mageIx >= po",
          "old_line_content": "",
          "new_line_content": "    free(coords);",
          "content_same": false
        },
        {
          "line": 4442,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "        return NULL;",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4444,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "",
          "new_line_content": "    RunPage(page, dev, &fz_identity);",
          "content_same": false
        },
        {
          "line": 4446,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "",
          "new_line_content": "    if (imageIx >= positions.Count() || fz_rect_to_RectD(positions.At(imageIx).rect) != rect) {",
          "content_same": false
        },
        {
          "line": 4447,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "    fz_pixmap *pixmap = NULL;",
          "new_line_content": "        assert(0);",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": null,
          "new_api": "void close_istream(fz_context *ctx,",
          "old_text": null,
          "new_text": " void close_istream(fz_context *ctx,",
          "old_line_content": "    stm->rp = stm->wp = state->buf;",
          "new_line_content": "    HRESULT res = state->stream->Seek(off, whence, &n);",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": null,
          "new_api": "e_)\n{\n    i",
          "old_text": null,
          "new_text": "e_)\n{\n    i",
          "old_line_content": "}",
          "new_line_content": "    if (FAILED(res))",
          "content_same": false
        },
        {
          "line": 356,
          "old_api": null,
          "new_api": "Release",
          "old_text": null,
          "new_text": "er *state = (istream_filter *)state_;\n    state->stream->Release();",
          "old_line_content": "",
          "new_line_content": "        fz_throw(stm->ctx, FZ_ERROR_GENERIC, \"IStream seek error: %x\", res);",
          "content_same": false
        },
        {
          "line": 2403,
          "old_api": null,
          "new_api": "ixmap = fz_new_pixmap_from_imag",
          "old_text": null,
          "new_text": "ixmap = fz_new_pixmap_from_imag",
          "old_line_content": "                ld.kind = FZ_LINK_LAUNCH;",
          "new_line_content": "            pdf_obj *file = pdf_dict_gets(annot->obj, \"FS\");",
          "content_same": false
        },
        {
          "line": 358,
          "old_api": null,
          "new_api": "ontext *ctx, IStream *stream);\n\nextern \"C\" static fz_stream *reopen_istream(f",
          "old_text": null,
          "new_text": "ontext *ctx, IStream *stream);\n\nextern \"C\" static fz_stream *reopen_istream(f",
          "old_line_content": "{",
          "new_line_content": "        fz_throw(stm->ctx, FZ_ERROR_GENERIC, \"documents beyond 2GB aren't supported\");",
          "content_same": false
        },
        {
          "line": 2410,
          "old_api": null,
          "new_api": "z_text_sheet *sheet = NULL;",
          "old_text": null,
          "new_text": "z_text_sheet *sheet = NULL;\n    ",
          "old_line_content": "                // add links in top-to-bottom order (i.e. last-to-first)",
          "new_line_content": "                ld.ld.launch.file_spec = pdf_file_spec_to_str(_doc, file);",
          "content_same": false
        },
        {
          "line": 2412,
          "old_api": null,
          "new_api": "EnterCriticalSect",
          "old_text": null,
          "new_text": "   EnterCriticalSect",
          "old_line_content": "                link->next = page->links;",
          "new_line_content": "                ld.ld.launch.embedded_num = pdf_to_num(embedded);",
          "content_same": false
        },
        {
          "line": 2413,
          "old_api": null,
          "new_api": "t = fz_new_text_shee",
          "old_text": null,
          "new_text": "t = fz_new_text_shee",
          "old_line_content": "                page->links = link;",
          "new_line_content": "                ld.ld.launch.embedded_gen = pdf_to_gen(embedded);",
          "content_same": false
        },
        {
          "line": 366,
          "old_api": null,
          "new_api": "fz_throw(ctx, FZ",
          "old_text": null,
          "new_text": "        fz_throw(ctx, FZ",
          "old_line_content": "extern \"C\" static fz_stream *reopen_istream(fz_context *ctx, fz_stream *stm)",
          "new_line_content": "    state->stream->Release();",
          "content_same": false
        },
        {
          "line": 367,
          "old_api": null,
          "new_api": "GENERIC, \"IStream d",
          "old_text": null,
          "new_text": "GENERIC, \"IStream d",
          "old_line_content": "{",
          "new_line_content": "    fz_free(ctx, state);",
          "content_same": false
        },
        {
          "line": 2415,
          "old_api": null,
          "new_api": "z_new_text_device",
          "old_text": null,
          "new_text": "z_new_text_device(ctx, sheet, text);",
          "old_line_content": "            }",
          "new_line_content": "                fz_transform_rect(&rect, &page->ctm);",
          "content_same": false
        },
        {
          "line": 4461,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "fz_rect XpsEngineImpl::FindDestRect(const char *target)",
          "new_line_content": "    RenderedBitmap *bmp = new_rendered_fz_pixmap(ctx, pixmap);",
          "content_same": false
        },
        {
          "line": 4462,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "{",
          "new_line_content": "    fz_drop_pixmap(ctx, pixmap);",
          "content_same": false
        },
        {
          "line": 2422,
          "old_api": null,
          "new_api": "ensure that\n    // the extracted tex",
          "old_text": null,
          "new_text": " ensure that\n    // the extracted tex",
          "old_line_content": "        }",
          "new_line_content": "            else if (!str::IsEmpty(pdf_to_str_buf(pdf_dict_gets(annot->obj, \"Contents\")))) {",
          "content_same": false
        },
        {
          "line": 2423,
          "old_api": null,
          "new_api": "cached runs using a",
          "old_text": null,
          "new_text": " cached runs using a",
          "old_line_content": "    }",
          "new_line_content": "                annots.Append(annot);",
          "content_same": false
        },
        {
          "line": 376,
          "old_api": null,
          "new_api": "LARGE_INTEGER zero = { 0 }",
          "old_text": null,
          "new_text": "    LARGE_INTEGER zero = { 0 }",
          "old_line_content": "}",
          "new_line_content": "    HRESULT res = state->stream->Clone(&stream2);",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": null,
          "new_api": "STREAM_SEEK_SET, NULL);\n    if (FAILED(res))\n        fz_throw(ctx",
          "old_text": null,
          "new_text": " STREAM_SEEK_SET, NULL);\n    if (FAILED(res))\n        fz_throw(ctx",
          "old_line_content": "fz_stream *fz_open_istream(fz_context *ctx, IStream *stream)",
          "new_line_content": "        fz_throw(ctx, FZ_ERROR_GENERIC, \"IStream doesn't support cloning\");",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": null,
          "new_api": "GENERIC, \"I",
          "old_text": null,
          "new_text": "GENERIC, \"I",
          "old_line_content": "{",
          "new_line_content": "    if (FAILED(res))",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": null,
          "new_api": "error: %x\", res);\n\n    istream_filter *state = fz_malloc_struc",
          "old_text": null,
          "new_text": " error: %x\", res);\n\n    istream_filter *state = fz_malloc_struc",
          "old_line_content": "    if (!stream)",
          "new_line_content": "        fz_throw(ctx, FZ_ERROR_GENERIC, \"IStream clone error: %x\", res);",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": null,
          "new_api": "_filter);\n    state->stream =",
          "old_text": null,
          "new_text": "_filter);\n    state->stream =",
          "old_line_content": "        return NULL;",
          "new_line_content": "    return fz_open_istream(ctx, stream2);",
          "content_same": false
        },
        {
          "line": 2426,
          "old_api": null,
          "new_api": "tside the mediabox bounds)\n    bool o",
          "old_text": null,
          "new_text": "tside the mediabox bounds)\n    bool o",
          "old_line_content": "        return NULL;",
          "new_line_content": "        else if (!str::IsEmpty(pdf_to_str_buf(pdf_dict_gets(annot->obj, \"Contents\"))) && annot->annot_type != FZ_ANNOT_FREETEXT) {",
          "content_same": false
        },
        {
          "line": 2427,
          "old_api": null,
          "new_api": "ScopedCritSec",
          "old_text": null,
          "new_text": "\n\n    ScopedCritSec ",
          "old_line_content": "",
          "new_line_content": "            annots.Append(annot);",
          "content_same": false
        },
        {
          "line": 4475,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "}",
          "new_line_content": "    if (fz_is_empty_rect(&found->rect)) {",
          "content_same": false
        },
        {
          "line": 4478,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "{",
          "new_line_content": "        GetXpsPage(found->page + 1);",
          "content_same": false
        },
        {
          "line": 2435,
          "old_api": null,
          "new_api": "x, text);\n    fz",
          "old_text": null,
          "new_text": "x, text);\n    fz",
          "old_line_content": "RenderedBitmap *PdfEngineImpl::GetPageImage(int pageNo, RectD rect, size_t imageIx)",
          "new_line_content": "    annots.Reverse();",
          "content_same": false
        },
        {
          "line": 2438,
          "old_api": null,
          "new_api": "ineImpl::ExtractPa",
          "old_text": null,
          "new_text": "ineImpl::ExtractPa",
          "old_line_content": "    if (!page)",
          "new_line_content": "    return annots.StealData();",
          "content_same": false
        },
        {
          "line": 391,
          "old_api": null,
          "new_api": "view_ctm",
          "old_text": null,
          "new_text": "view_ctm(co",
          "old_line_content": "",
          "new_line_content": "    if (FAILED(res))",
          "content_same": false
        },
        {
          "line": 4486,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "",
          "new_line_content": "    if (!str::StartsWith(name_utf8.Get(), \"#\"))",
          "content_same": false
        },
        {
          "line": 4487,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "    return NULL;",
          "new_line_content": "        name_utf8.Set(str::Join(\"#\", name_utf8));",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": null,
          "new_api": "oat)rotation), zoom, zoom);\n\n    asse",
          "old_text": null,
          "new_text": "oat)rotation), zoom, zoom);\n\n    asse",
          "old_line_content": "    stm->reopen = reopen_istream;",
          "new_line_content": "    istream_filter *state = fz_malloc_struct(ctx, istream_filter);",
          "content_same": false
        },
        {
          "line": 2443,
          "old_api": null,
          "new_api": "true);\n    if (pa",
          "old_text": null,
          "new_text": " true);\n    if (pa",
          "old_line_content": "    fz_device *dev = NULL;",
          "new_line_content": "    pdf_page *page = GetPdfPage(pageNo);",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": null,
          "new_api": "x->y0);\n    rota",
          "old_text": null,
          "new_text": "x->y0);\n    rota",
          "old_line_content": "}",
          "new_line_content": "    stream->AddRef();",
          "content_same": false
        },
        {
          "line": 4490,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "XpsTocItem *XpsEngineImpl::BuildTocTree(fz_outline *entry, int& idCounter)",
          "new_line_content": "        if (str::EndsWithI(dest->name, name_utf8))",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": null,
          "new_api": "360;\n    if (90 == rotation)\n        fz_pre_translate(&ctm,",
          "old_text": null,
          "new_text": "360;\n    if (90 == rotation)\n        fz_pre_translate(&ctm, ",
          "old_line_content": "fz_matrix fz_create_view_ctm(const fz_rect *mediabox, float zoom, int rotation)",
          "new_line_content": "    fz_stream *stm = fz_new_stream(ctx, state, next_istream, close_istream, NULL);",
          "content_same": false
        },
        {
          "line": 4491,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "{",
          "new_line_content": "            return new SimpleDest(dest->page + 1, fz_rect_to_RectD(dest->rect));",
          "content_same": false
        },
        {
          "line": 2451,
          "old_api": null,
          "new_api": "page_by_obj",
          "old_text": null,
          "new_text": "page_by_obj(_doc, pageNo - 1, _p",
          "old_line_content": "        return NULL;",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4501,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "            item->pageNo = entry->dest.ld.gotor.page + 1;",
          "new_line_content": "        WCHAR *name = entry->title ? str::conv::FromUtf8(entry->title) : str::Dup(L\"\");",
          "content_same": false
        },
        {
          "line": 4502,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "        if (entry->down)",
          "new_line_content": "        XpsTocItem *item = new XpsTocItem(name, XpsLink(this, &entry->dest));",
          "content_same": false
        },
        {
          "line": 407,
          "old_api": null,
          "new_api": "_expansion",
          "old_text": null,
          "new_text": "_expansion(&ctm) > 0);\n    if (f",
          "old_line_content": "    else if (180 == rotation)",
          "new_line_content": "    fz_pre_scale(fz_rotate(&ctm, (float)rotation), zoom, zoom);",
          "content_same": false
        },
        {
          "line": 2456,
          "old_api": null,
          "new_api": "}\n    LeaveCriticalSection(&ct",
          "old_text": null,
          "new_text": "  }\n    LeaveCriticalSection(&ct",
          "old_line_content": "",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": null,
          "new_api": "m) == 0)\n        return fz_identity;\n\n    retu",
          "old_text": null,
          "new_text": "m) == 0)\n        return fz_identity;\n\n    retu",
          "old_line_content": "    else if (270 == rotation)",
          "new_line_content": "    assert(0 == mediabox->x0 && 0 == mediabox->y0);",
          "content_same": false
        },
        {
          "line": 2459,
          "old_api": null,
          "new_api": "ctPageText",
          "old_text": null,
          "new_text": "ctPageText(page, lineSep, coords",
          "old_line_content": "        return NULL;",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2461,
          "old_api": null,
          "new_api": "get);\n\n    EnterCriticalSection(",
          "old_text": null,
          "new_text": "get);\n\n    EnterCriticalSection(",
          "old_line_content": "",
          "new_line_content": "    RunPage(page, dev, &fz_identity);",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": null,
          "new_api": "ctI *coords)\n{\n    // multiline links end in a non-a",
          "old_text": null,
          "new_text": "ctI *coords)\n{\n    // multiline links end in a non-a",
          "old_line_content": "        return fz_identity;",
          "new_line_content": "        fz_pre_translate(&ctm, -mediabox->x1, -mediabox->y1);",
          "content_same": false
        },
        {
          "line": 2463,
          "old_api": null,
          "new_api": "ection",
          "old_text": null,
          "new_text": "ection(&ctxAccess);\n\n",
          "old_line_content": "",
          "new_line_content": "    if (imageIx >= positions.Count() || fz_rect_to_RectD(positions.At(imageIx).rect) != rect) {",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": null,
          "new_api": "ne\n    // that starts left and only slig",
          "old_text": null,
          "new_text": "ne\n    // that starts left and only slig",
          "old_line_content": "    return ctm;",
          "new_line_content": "        fz_pre_translate(&ctm, -mediabox->x1, 0);",
          "content_same": false
        },
        {
          "line": 2464,
          "old_api": null,
          "new_api": "PdfEngine",
          "old_text": null,
          "new_text": "PdfEngine",
          "old_line_content": "    fz_pixmap *pixmap = NULL;",
          "new_line_content": "        assert(0);",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": null,
          "new_api": "the current line ended",
          "old_text": null,
          "new_text": " the current line ended\n ",
          "old_line_content": "",
          "new_line_content": "    assert(fz_matrix_expansion(&ctm) > 0);",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": null,
          "new_api": "doesn't start with http o",
          "old_text": null,
          "new_text": "doesn't start with http o",
          "old_line_content": "struct LinkRectList {",
          "new_line_content": "    if (fz_matrix_expansion(&ctm) == 0)",
          "content_same": false
        },
        {
          "line": 4509,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "    }",
          "new_line_content": "            item->child = BuildTocTree(entry->down, idCounter);",
          "content_same": false
        },
        {
          "line": 4514,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "DocTocItem *XpsEngineImpl::GetTocTree()",
          "new_line_content": "            node->AddSibling(item);",
          "content_same": false
        },
        {
          "line": 4522,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "",
          "new_line_content": "    if (!HasTocTree())",
          "content_same": false
        },
        {
          "line": 2478,
          "old_api": null,
          "new_api": "ef_len",
          "old_text": null,
          "new_text": "ef_len(_doc))\n        return false;",
          "old_line_content": "WCHAR *PdfEngineImpl::ExtractPageText(pdf_page *page, WCHAR *lineSep, RectI **coords_out, RenderTarget target, bool cacheRun)",
          "new_line_content": "    RenderedBitmap *bmp = new_rendered_fz_pixmap(ctx, pixmap);",
          "content_same": false
        },
        {
          "line": 2479,
          "old_api": null,
          "new_api": "check whether it's a linea",
          "old_text": null,
          "new_text": " check whether it's a linea",
          "old_line_content": "{",
          "new_line_content": "    fz_drop_pixmap(ctx, pixmap);",
          "content_same": false
        },
        {
          "line": 4526,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "    // GetXpsPage extracts imageRects for us",
          "new_line_content": "    return BuildTocTree(_outline, idCounter);",
          "content_same": false
        },
        {
          "line": 4531,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "    // check if any image covers at least 90% of the page",
          "new_line_content": "    xps_page *page = GetXpsPage(pageNo, true);",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": null,
          "new_api": "artsWith",
          "old_text": null,
          "new_text": "artsWith(pos + 1, L\"http\");\n}\n\n",
          "old_line_content": "}",
          "new_line_content": "        coords[pos - pageText + 1].BR().y > coords[pos - pageText - 1].y &&",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": null,
          "new_api": "onst WCHAR *end, *quote;\n\n    /",
          "old_text": null,
          "new_text": "onst WCHAR *end, *quote;\n\n    /",
          "old_line_content": "",
          "new_line_content": "        coords[pos - pageText + 1].y <= coords[pos - pageText - 1].BR().y + coords[pos - pageText - 1].dy * 0.35 &&",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": null,
          "new_api": "for (end = start; *end && !st",
          "old_text": null,
          "new_text": "  for (end = start; *end && !st",
          "old_line_content": "static const WCHAR *LinkifyFindEnd(const WCHAR *start, WCHAR prevChar)",
          "new_line_content": "        coords[pos - pageText + 1].x < coords[pos - pageText - 1].BR().x &&",
          "content_same": false
        },
        {
          "line": 4536,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "}",
          "new_line_content": "    fz_rect mbox = fz_RectD_to_rect(PageMediabox(pageNo));",
          "content_same": false
        },
        {
          "line": 4538,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "BaseEngine *XpsEngineImpl::CreateFromFile(const WCHAR *fileName)",
          "new_line_content": "    for (int i = 0; !fz_is_empty_rect(&imageRects[pageNo-1][i]); i++)",
          "content_same": false
        },
        {
          "line": 443,
          "old_api": null,
          "new_api": "ntain any opening one\n    if (')'",
          "old_text": null,
          "new_text": "ntain any opening one\n    if (')'",
          "old_line_content": "",
          "new_line_content": "        !str::StartsWith(pos + 1, L\"http\");",
          "content_same": false
        },
        {
          "line": 4539,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "{",
          "new_line_content": "        if (fz_calc_overlap(mbox, imageRects[pageNo-1][i]) >= 0.9f)",
          "content_same": false
        },
        {
          "line": 2495,
          "old_api": null,
          "new_api": "nearized\")) != 1.0f)\n        ret",
          "old_text": null,
          "new_text": "nearized\")) != 1.0f)\n        ret",
          "old_line_content": "    fz_catch(ctx) {",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 451,
          "old_api": null,
          "new_api": ":FindChar(start",
          "old_text": null,
          "new_text": ":FindChar(start",
          "old_line_content": "    // cut the link at the first quotation mark, if it's also preceded by one",
          "new_line_content": "    for (end = start; *end && !str::IsWs(*end); end++);",
          "content_same": false
        },
        {
          "line": 2499,
          "old_api": null,
          "new_api": "return false;\n    // /O must be",
          "old_text": null,
          "new_text": "     return false;\n    // /O must be",
          "old_line_content": "        return NULL;",
          "new_line_content": "        dev = fz_new_text_device(ctx, sheet, text);",
          "content_same": false
        },
        {
          "line": 4547,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "",
          "new_line_content": "    if (!engine || !fileName || !engine->Load(fileName)) {",
          "content_same": false
        },
        {
          "line": 2502,
          "old_api": null,
          "new_api": "if (pdf_to_int(pdf_dict_ge",
          "old_text": null,
          "new_text": "  if (pdf_to_int(pdf_dict_ge",
          "old_line_content": "",
          "new_line_content": "        fz_free_text_page(ctx, text);",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "s.Count() - 1;\n    Scoped",
          "old_line_content": "    return end;",
          "new_line_content": "    if (')' == end[-1] && (!str::FindChar(start, '(') || str::FindChar(start, '(') >= end))",
          "content_same": false
        },
        {
          "line": 2503,
          "old_api": null,
          "new_api": ")) != pdf_to_num(_pageObjs[0])",
          "old_text": null,
          "new_text": ")) != pdf_to_num(_pageObjs[0])",
          "old_line_content": "    if (!cacheRun)",
          "new_line_content": "        fz_free_text_sheet(ctx, sheet);",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": null,
          "new_api": "rt[-1] : ' ');\n        multili",
          "old_text": null,
          "new_text": "rt[-1] : ' ');\n        multili",
          "old_line_content": "static const WCHAR *LinkifyMultilineText(LinkRectList *list, const WCHAR *pageText, const WCHAR *start, const WCHAR *next, RectI *coords)",
          "new_line_content": "    if (('\"' == prevChar || '\\'' == prevChar) && (quote = str::FindChar(start, prevChar)) != NULL && quote < end)",
          "content_same": false
        },
        {
          "line": 2507,
          "old_api": null,
          "new_api": "_to_int",
          "old_text": null,
          "new_text": "_to_int(pdf_dict_gets(obj, \"N\"))",
          "old_line_content": "    // the extracted text is consistent between cached runs using a list device and",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4557,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "",
          "new_line_content": "    if (!engine->Load(stream)) {",
          "content_same": false
        },
        {
          "line": 2510,
          "old_api": null,
          "new_api": "alse;\n    // /H must be an array and /E",
          "old_text": null,
          "new_text": "alse;\n    // /H must be an array and /E ",
          "old_line_content": "",
          "new_line_content": "        fz_enable_device_hints(dev, FZ_NO_CACHE);",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": " i < list->coords.Count(); i++)\n        list",
          "old_line_content": "",
          "new_line_content": "        multiline = LinkifyCheckMultiline(pageText, end, coords);",
          "content_same": false
        },
        {
          "line": 2521,
          "old_api": null,
          "new_api": "Contains",
          "old_text": null,
          "new_text": "ont && !fontList.Contains(font))\n            f",
          "old_line_content": "",
          "new_line_content": "        content = fz_text_page_to_str(text, lineSep, coords_out);",
          "content_same": false
        },
        {
          "line": 475,
          "old_api": null,
          "new_api": "return end;\n}\n\n// cf. http",
          "old_text": null,
          "new_text": " return end;\n}\n\n// cf. http",
          "old_line_content": "    } while (multiline);",
          "new_line_content": "        ScopedMem<WCHAR> part(str::DupN(next, end - next));",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": null,
          "new_api": "ne.org/gerv/archives",
          "old_text": null,
          "new_text": "ne.org/gerv/archives",
          "old_line_content": "",
          "new_line_content": "        uri.Set(str::Join(uri, part));",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": null,
          "new_api": "ess_regexp.html\ninline bool IsEmailUsernameChar(WCHAR c)",
          "old_text": null,
          "new_text": "ess_regexp.html\ninline bool IsEmailUsernameChar(WCHAR c)\n",
          "old_line_content": "    // update the link URL for all partial links",
          "new_line_content": "        RectI bbox = coords[next - pageText].Union(coords[end - pageText - 1]);",
          "content_same": false
        },
        {
          "line": 2522,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": ".Append(font);\n    }\n    // ",
          "old_line_content": "WCHAR *PdfEngineImpl::ExtractPageText(int pageNo, WCHAR *lineSep, RectI **coords_out, RenderTarget target)",
          "new_line_content": "    fz_free_text_page(ctx, text);",
          "content_same": false
        },
        {
          "line": 2523,
          "old_api": null,
          "new_api": "tract fonts for all XObjects (",
          "old_text": null,
          "new_text": "tract fonts for all XObjects (",
          "old_line_content": "{",
          "new_line_content": "    fz_free_text_sheet(ctx, sheet);",
          "content_same": false
        },
        {
          "line": 4572,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "    }",
          "new_line_content": "            return file::Exists(relsPath) || dir::Exists(relsPath);",
          "content_same": false
        },
        {
          "line": 4575,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "}",
          "new_line_content": "        return zip.GetFileIndex(L\"_rels/.rels\") != (size_t)-1 ||",
          "content_same": false
        },
        {
          "line": 4576,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "",
          "new_line_content": "               zip.GetFileIndex(L\"_rels/.rels/[0].piece\") != (size_t)-1 ||",
          "content_same": false
        },
        {
          "line": 4577,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "BaseEngine *CreateFromFile(const WCHAR *fileName)",
          "new_line_content": "               zip.GetFileIndex(L\"_rels/.rels/[0].last.piece\") != (size_t)-1;",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": null,
          "new_api": "bool IsEmailD",
          "old_text": null,
          "new_text": "bool IsEmailD",
          "old_line_content": "",
          "new_line_content": "    list->links.At(lastIx) = str::Dup(uri);",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": null,
          "new_api": "m",
          "old_text": null,
          "new_text": "m(c) || '-' == c;\n}\n",
          "old_line_content": "// cf. http://weblogs.mozillazine.org/gerv/archives/2011/05/html5_email_address_regexp.html",
          "new_line_content": "    for (size_t i = lastIx + 1; i < list->coords.Count(); i++)",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": null,
          "new_api": "il",
          "old_text": null,
          "new_text": "il(const WCHA",
          "old_line_content": "inline bool IsEmailUsernameChar(WCHAR c)",
          "new_line_content": "        list->links.Append(str::Dup(uri));",
          "content_same": false
        },
        {
          "line": 2532,
          "old_api": null,
          "new_api": "ces\");\n        if (xobj && xres && !pdf_mark_obj(x",
          "old_text": null,
          "new_text": "ces\");\n        if (xobj && xres && !pdf_mark_obj(x",
          "old_line_content": "    fz_catch(ctx) {",
          "new_line_content": "        return ExtractPageText(page, lineSep, coords_out, target);",
          "content_same": false
        },
        {
          "line": 2534,
          "old_api": null,
          "new_api": "pdf_extract_fonts(xre",
          "old_text": null,
          "new_text": "           pdf_extract_fonts(xre",
          "old_line_content": "        return NULL;",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4580,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "}",
          "new_line_content": "    return str::EndsWithI(fileName, L\".xps\") || str::EndsWithI(fileName, L\".oxps\");",
          "content_same": false
        },
        {
          "line": 4585,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "}",
          "new_line_content": "    return XpsEngineImpl::CreateFromFile(fileName);",
          "content_same": false
        },
        {
          "line": 2539,
          "old_api": null,
          "new_api": "t;\n\n    // collect all fonts fro",
          "old_text": null,
          "new_text": "t;\n\n    // collect all fonts fro",
          "old_line_content": "",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4590,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "",
          "new_line_content": "    return XpsEngineImpl::CreateFromStream(stream);",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": null,
          "new_api": "if (end == start || *end != '@' ||",
          "old_text": null,
          "new_text": "\n    if (end == start || *end != '@' || ",
          "old_line_content": "",
          "new_line_content": "    return iswalnum(c) || c && str::FindChar(L\".!#$%&'*+=?^_`{|}~-\", c);",
          "content_same": false
        },
        {
          "line": 2544,
          "old_api": null,
          "new_api": "dfPage",
          "old_text": null,
          "new_text": "dfPage(i);\n        if (page) {\n            ScopedC",
          "old_line_content": "    return result;",
          "new_line_content": "    WCHAR *result = ExtractPageText(page, lineSep, coords_out, target);",
          "content_same": false
        },
        {
          "line": 2546,
          "old_api": null,
          "new_api": "ope",
          "old_text": null,
          "new_text": "ope(&ctxAccess);\n            fz_",
          "old_line_content": "",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2547,
          "old_api": null,
          "new_api": ") {\n                pdf_e",
          "old_text": null,
          "new_text": ") {\n                pdf_e",
          "old_line_content": "bool PdfEngineImpl::IsLinearizedFile()",
          "new_line_content": "    pdf_free_page(_doc, page);",
          "content_same": false
        },
        {
          "line": 2548,
          "old_api": null,
          "new_api": "fonts",
          "old_text": null,
          "new_text": "fonts(page->resources, fontList)",
          "old_line_content": "{",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": null,
          "new_api": ";\n    } while ('.' == *end && IsE",
          "old_text": null,
          "new_text": ";\n    } while ('.' == *end && IsE",
          "old_line_content": "    const WCHAR *end;",
          "new_line_content": "    for (start = at; start > pageText && IsEmailUsernameChar(*(start - 1)); start--);",
          "content_same": false
        },
        {
          "line": 2557,
          "old_api": null,
          "new_api": "tList);\n                }",
          "old_text": null,
          "new_text": "tList);\n                }",
          "old_line_content": "        return false;",
          "new_line_content": "    fz_seek(_doc->file, 0, 0);",
          "content_same": false
        },
        {
          "line": 2558,
          "old_api": null,
          "new_api": "fz_catch(ctx) { }\n        }",
          "old_text": null,
          "new_text": "          fz_catch(ctx) { }\n        }\n ",
          "old_line_content": "    // check whether it's a linearization dictionary",
          "new_line_content": "    int tok = pdf_lex(_doc->file, &_doc->lexbuf.base);",
          "content_same": false
        },
        {
          "line": 513,
          "old_api": null,
          "new_api": "ectList *list = new LinkR",
          "old_text": null,
          "new_text": "ectList *list = new LinkR",
          "old_line_content": "    do {",
          "new_line_content": "    for (end = start; IsEmailUsernameChar(*end); end++);",
          "content_same": false
        },
        {
          "line": 516,
          "old_api": null,
          "new_api": "ine = false;\n        co",
          "old_text": null,
          "new_text": "ine = false;\n        co",
          "old_line_content": "    return end;",
          "new_line_content": "    for (end++; IsEmailDomainChar(*end); end++);",
          "content_same": false
        },
        {
          "line": 517,
          "old_api": null,
          "new_api": "if ('@' == *start) {",
          "old_text": null,
          "new_text": "  if ('@' == *start) {\n      ",
          "old_line_content": "}",
          "new_line_content": "    if ('.' != *end || !IsEmailDomainChar(*(end + 1)))",
          "content_same": false
        },
        {
          "line": 520,
          "old_api": null,
          "new_api": "const WCHAR *emai",
          "old_text": null,
          "new_text": "      const WCHAR *emai",
          "old_line_content": "static LinkRectList *LinkifyText(const WCHAR *pageText, RectI *coords)",
          "new_line_content": "        for (end++; IsEmailDomainChar(*end); end++);",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": null,
          "new_api": "end = email ? Lin",
          "old_text": null,
          "new_text": "            end = email ? Lin",
          "old_line_content": "{",
          "new_line_content": "    } while ('.' == *end && IsEmailDomainChar(*(end + 1)));",
          "content_same": false
        },
        {
          "line": 2568,
          "old_api": null,
          "new_api": "_obj *font2 = pdf_a",
          "old_text": null,
          "new_text": "_obj *font2 = pdf_a",
          "old_line_content": "    // /Linearized format must be version 1.0",
          "new_line_content": "    fz_catch(_doc->ctx) {",
          "content_same": false
        },
        {
          "line": 2571,
          "old_api": null,
          "new_api": "if (!font2)",
          "old_text": null,
          "new_text": "            if (!font2)\n     ",
          "old_line_content": "    // /L must be the exact file size",
          "new_line_content": "    pdf_obj *obj = pdf_get_xref_entry(_doc, num)->obj;",
          "content_same": false
        },
        {
          "line": 2584,
          "old_api": null,
          "new_api": "type = pdf",
          "old_text": null,
          "new_text": " type = pdf",
          "old_line_content": "}",
          "new_line_content": "    if (pdf_to_int(pdf_dict_gets(obj, \"N\")) != PageCount())",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": null,
          "new_api": "start[-1] : ' ');",
          "old_text": null,
          "new_text": "start[-1] : ' ');\n        ",
          "old_line_content": "            // hyperlinks must not be preceded by a slash (indicates a different protocol)",
          "new_line_content": "            end = email ? LinkifyEmailAddress(email) : NULL;",
          "content_same": false
        },
        {
          "line": 2587,
          "old_api": null,
          "new_api": "= pdf_to_name(pdf_dict_",
          "old_text": null,
          "new_text": "= pdf_to_name(pdf_dict_",
          "old_line_content": "{",
          "new_line_content": "    return pdf_is_array(pdf_dict_gets(obj, \"H\")) &&",
          "content_same": false
        },
        {
          "line": 2594,
          "old_api": null,
          "new_api": "ueType (CID)\";",
          "old_text": null,
          "new_text": "ueType (CID)\";\n           ",
          "old_line_content": "    // also extract fonts for all XObjects (recursively)",
          "new_line_content": "    pdf_obj *fonts = pdf_dict_gets(res, \"Font\");",
          "content_same": false
        },
        {
          "line": 548,
          "old_api": null,
          "new_api": ".') >= end))\n                end = NULL;\n        }",
          "old_text": null,
          "new_text": ".') >= end))\n                end = NULL;\n        }\n      ",
          "old_line_content": "            protocol = L\"http://\";",
          "new_line_content": "            end = LinkifyFindEnd(start, start > pageText ? start[-1] : ' ');",
          "content_same": false
        },
        {
          "line": 549,
          "old_api": null,
          "new_api": "str::StartsWith(start, L\"mailto:\")) {",
          "old_text": null,
          "new_text": " str::StartsWith(start, L\"mailto:\")) {\n     ",
          "old_line_content": "            // ignore www. links without a top-level domain",
          "new_line_content": "            multiline = LinkifyCheckMultiline(pageText, end, coords);",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": null,
          "new_api": "}\n        if (!end)",
          "old_text": null,
          "new_text": "     }\n        if (!end)\n      ",
          "old_line_content": "                end = NULL;",
          "new_line_content": "        else if ('w' == *start && str::StartsWith(start, L\"www.\")) {",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": null,
          "new_api": "ScopedMem<WCHAR> part(str::DupN(start, end - start));",
          "old_text": null,
          "new_text": "  ScopedMem<WCHAR> part(str::DupN(start, end - start));\n ",
          "old_line_content": "        }",
          "new_line_content": "            end = LinkifyFindEnd(start, start > pageText ? start[-1] : ' ');",
          "content_same": false
        },
        {
          "line": 2602,
          "old_api": null,
          "new_api": "}\n        f",
          "old_text": null,
          "new_text": "        }\n        f",
          "old_line_content": "        }",
          "new_line_content": "    for (int k = 0; k < pdf_dict_len(xobjs); k++) {",
          "content_same": false
        },
        {
          "line": 2603,
          "old_api": null,
          "new_api": "e;\n        }\n        Crash",
          "old_text": null,
          "new_text": "e;\n        }\n        Crash",
          "old_line_content": "    }",
          "new_line_content": "        pdf_obj *xobj = pdf_dict_get_val(xobjs, k);",
          "content_same": false
        },
        {
          "line": 556,
          "old_api": null,
          "new_api": "double>()));\n        i",
          "old_text": null,
          "new_text": "double>()));\n        i",
          "old_line_content": "        if (!end)",
          "new_line_content": "            if (end - start <= 4 || !multiline && (!wcschr(start + 5, '.') || wcschr(start + 5, '.') >= end))",
          "content_same": false
        },
        {
          "line": 2604,
          "old_api": null,
          "new_api": "ing);\n\n        str::Str<char> in",
          "old_text": null,
          "new_text": "ing);\n\n        str::Str<char> in",
          "old_line_content": "}",
          "new_line_content": "        pdf_obj *xres = pdf_dict_gets(xobj, \"Resources\");",
          "content_same": false
        },
        {
          "line": 2605,
          "old_api": null,
          "new_api": "ultiByteToWideChar",
          "old_text": null,
          "new_text": "ultiByteToWideChar",
          "old_line_content": "",
          "new_line_content": "        if (xobj && xres && !pdf_mark_obj(xobj)) {",
          "content_same": false
        },
        {
          "line": 2606,
          "old_api": null,
          "new_api": "LID_CHARS, name, -1, NULL, 0))",
          "old_text": null,
          "new_text": "LID_CHARS, name, -1, NULL, 0))\n  ",
          "old_line_content": "WCHAR *PdfEngineImpl::ExtractFontList()",
          "new_line_content": "            pdf_extract_fonts(xres, fontList);",
          "content_same": false
        },
        {
          "line": 2607,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": "Append(ScopedMem<cha",
          "old_line_content": "{",
          "new_line_content": "            pdf_unmark_obj(xobj);",
          "content_same": false
        },
        {
          "line": 566,
          "old_api": null,
          "new_api": "g before. Since",
          "old_text": null,
          "new_text": "g before. Since ",
          "old_line_content": "",
          "new_line_content": "        WCHAR *uri = protocol ? str::Join(protocol, part) : part.StealData();",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": null,
          "new_api": "rom the start of\n    //",
          "old_text": null,
          "new_text": "rom the start of\n    //",
          "old_line_content": "        start = end;",
          "new_line_content": "        list->links.Append(uri);",
          "content_same": false
        },
        {
          "line": 568,
          "old_api": null,
          "new_api": "t, we have to reverse the order of links\n    // (cf. http:",
          "old_text": null,
          "new_text": "t, we have to reverse the order of links\n    // (cf. http:",
          "old_line_content": "    }",
          "new_line_content": "        RectI bbox = coords[start - pageText].Union(coords[end - pageText - 1]);",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": null,
          "new_api": "1303 )\n    fz_link *ne",
          "old_text": null,
          "new_text": "1303 )\n    fz_link *ne",
          "old_line_content": "",
          "new_line_content": "        list->coords.Append(fz_RectD_to_rect(bbox.Convert<double>()));",
          "content_same": false
        },
        {
          "line": 2617,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": "fo.Append(\"",
          "old_line_content": "                for (pdf_annot *annot = page->annots; annot; annot = annot->next) {",
          "new_line_content": "    for (int i = 1; i <= PageCount(); i++) {",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": null,
          "new_api": "nk *tmp = root->next;\n        root->next = new_root;",
          "old_text": null,
          "new_text": "nk *tmp = root->next;\n        root->next = new_root;\n       ",
          "old_line_content": "}",
          "new_line_content": "            end = LinkifyMultilineText(list, pageText, start, end + 1, coords);",
          "content_same": false
        },
        {
          "line": 2618,
          "old_api": null,
          "new_api": "(type))",
          "old_text": null,
          "new_text": "(type))\n     ",
          "old_line_content": "                    if (annot->ap)",
          "new_line_content": "        pdf_page *page = GetPdfPage(i);",
          "content_same": false
        },
        {
          "line": 2622,
          "old_api": null,
          "new_api": "\"%s; \", encoding);\n            if (embedded)",
          "old_text": null,
          "new_text": "\"%s; \", encoding);\n            if (embedded)",
          "old_line_content": "            fz_catch(ctx) { }",
          "new_line_content": "                pdf_extract_fonts(page->resources, fontList);",
          "content_same": false
        },
        {
          "line": 2625,
          "old_api": null,
          "new_api": "em<WCHAR> fontInfo(str::conv::FromUtf8(info.LendD",
          "old_text": null,
          "new_text": "em<WCHAR> fontInfo(str::conv::FromUtf8(info.LendD",
          "old_line_content": "",
          "new_line_content": "                        pdf_extract_fonts(annot->ap->resources, fontList);",
          "content_same": false
        },
        {
          "line": 2635,
          "old_api": null,
          "new_api": "ortNatural",
          "old_text": null,
          "new_text": "ortNatural();\n  ",
          "old_line_content": "            if (!font2)",
          "new_line_content": "    for (size_t i = 0; i < fontList.Count(); i++) {",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": null,
          "new_api": ";\n\nstruct FitzImagePos {\n    fz_im",
          "old_text": null,
          "new_text": ";\n\nstruct FitzImagePos {\n    fz_im",
          "old_line_content": "    return new_root;",
          "new_line_content": "            Swap(link->rect.x0, link->rect.x1);",
          "content_same": false
        },
        {
          "line": 2644,
          "old_api": null,
          "new_api": "return str::Format(L\"%d.%d Ad",
          "old_text": null,
          "new_text": "            return str::Format(L\"%d.%d Ad",
          "old_line_content": "                embedded = true;",
          "new_line_content": "            name = pdf_to_name(pdf_dict_getsa(font2, \"BaseFont\", \"Name\"));",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": null,
          "new_api": "_image *image=NULL, fz_rect rect=f",
          "old_text": null,
          "new_text": "_image *image=NULL, fz_rect rect=f",
          "old_line_content": "",
          "new_line_content": "            Swap(link->rect.y0, link->rect.y1);",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": null,
          "new_api": ") :\n        image(image), rect(rect) {",
          "old_text": null,
          "new_text": ") :\n        image(image), rect(rect) {",
          "old_line_content": "class SimpleDest : public PageDestination {",
          "new_line_content": "        assert(link->rect.x1 >= link->rect.x0);",
          "content_same": false
        },
        {
          "line": 600,
          "old_api": null,
          "new_api": "ct ListInspectionData {\n    Vec<FitzIm",
          "old_text": null,
          "new_text": "ct ListInspectionData {\n    Vec<FitzIm",
          "old_line_content": "    int pageNo;",
          "new_line_content": "        assert(link->rect.y1 >= link->rect.y0);",
          "content_same": false
        },
        {
          "line": 2646,
          "old_api": null,
          "new_api": "(pdf_crypt_revision(_doc) == 6)\n                return str::For",
          "old_text": null,
          "new_text": " (pdf_crypt_revision(_doc) == 6)\n                return str::For",
          "old_line_content": "                name += 7;",
          "new_line_content": "                fz_throw(ctx, FZ_ERROR_GENERIC, \"ignoring font with empty name\");",
          "content_same": false
        },
        {
          "line": 2649,
          "old_api": null,
          "new_api": ") {\n        WStrVec fstruct;\n        if (pdf_t",
          "old_text": null,
          "new_text": ") {\n        WStrVec fstruct;\n        if (pdf_t",
          "old_line_content": "            if (font2 != font) {",
          "new_line_content": "            if (desc && (pdf_dict_gets(desc, \"FontFile\") || pdf_dict_getsa(desc, \"FontFile2\", \"FontFile3\")))",
          "content_same": false
        },
        {
          "line": 2654,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": "fstruct.Append(str::Dup(L\"tagg",
          "old_line_content": "                    type = \"TrueType (CID)\";",
          "new_line_content": "            type = pdf_to_name(pdf_dict_gets(font, \"Subtype\"));",
          "content_same": false
        },
        {
          "line": 2656,
          "old_api": null,
          "new_api": "; i < pdf_array_len(pdf_dict_ge",
          "old_text": null,
          "new_text": "; i < pdf_array_len(pdf_dict_ge",
          "old_line_content": "",
          "new_line_content": "                const char *type2 = pdf_to_name(pdf_dict_gets(font2, \"Subtype\"));",
          "content_same": false
        },
        {
          "line": 2659,
          "old_api": null,
          "new_api": ";\n                CrashIf(!str",
          "old_text": null,
          "new_text": ";\n                CrashIf(!str",
          "old_line_content": "                encoding = \"Ansi\";",
          "new_line_content": "                else if (str::Eq(type2, \"CIDFontType2\"))",
          "content_same": false
        },
        {
          "line": 2663,
          "old_api": null,
          "new_api": "_name",
          "old_text": null,
          "new_text": "_name(intent) + 4));\n          ",
          "old_line_content": "                encoding = \"Expert\";",
          "new_line_content": "            encoding = pdf_to_name(pdf_dict_gets(font, \"Encoding\"));",
          "content_same": false
        },
        {
          "line": 2664,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "  return fstruct.Count() > 0 ? fstru",
          "old_line_content": "        }",
          "new_line_content": "            if (str::Eq(encoding, \"WinAnsiEncoding\"))",
          "content_same": false
        },
        {
          "line": 2666,
          "old_api": null,
          "new_api": "return ExtractFontList();",
          "old_text": null,
          "new_text": "        return ExtractFontList();\n\n  ",
          "old_line_content": "            continue;",
          "new_line_content": "            else if (str::Eq(encoding, \"MacRomanEncoding\"))",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": null,
          "new_api": "ce image",
          "old_text": null,
          "new_text": "ce image",
          "old_line_content": "    bool req_t3_fonts;",
          "new_line_content": "    explicit FitzImagePos(fz_image *image=NULL, fz_rect rect=fz_unit_rect) :",
          "content_same": false
        },
        {
          "line": 632,
          "old_api": null,
          "new_api": "(!clippi",
          "old_text": null,
          "new_text": "(!clippi",
          "old_line_content": "{",
          "new_line_content": "    explicit ListInspectionData(Vec<FitzImagePos>& images) : images(&images),",
          "content_same": false
        },
        {
          "line": 2681,
          "old_api": null,
          "new_api": "ferences,",
          "old_text": null,
          "new_text": "ferences,\n        ",
          "old_line_content": "            if (embedded)",
          "new_line_content": "        if (!str::IsEmpty(encoding) || !str::IsEmpty(type) || embedded) {",
          "content_same": false
        },
        {
          "line": 2685,
          "old_api": null,
          "new_api": "onv::FromPdf(obj)) : N",
          "old_text": null,
          "new_text": "onv::FromPdf(obj)) : N",
          "old_line_content": "        }",
          "new_line_content": "            if (!str::IsEmpty(encoding))",
          "content_same": false
        },
        {
          "line": 2686,
          "old_api": null,
          "new_api": "}\n    return NULL;\n};\n\nbool PdfE",
          "old_text": null,
          "new_text": "}\n    return NULL;\n};\n\nbool PdfE",
          "old_line_content": "",
          "new_line_content": "                info.AppendFmt(\"%s; \", encoding);",
          "content_same": false
        },
        {
          "line": 642,
          "old_api": null,
          "new_api": "_handle_image",
          "old_text": null,
          "new_text": "_handle_image(fz_device *dev, fz_image *image)\n{\n  ",
          "old_line_content": "    if (!clipping)",
          "new_line_content": "    ((ListInspectionData *)dev->user)->images->Reverse();",
          "content_same": false
        },
        {
          "line": 2690,
          "old_api": null,
          "new_api": "ren't all number",
          "old_text": null,
          "new_text": "ren't all number",
          "old_line_content": "    }",
          "new_line_content": "            info.Append(\")\");",
          "content_same": false
        },
        {
          "line": 2693,
          "old_api": null,
          "new_api": "if (pdf_to_nu",
          "old_text": null,
          "new_text": "  if (pdf_to_nu",
          "old_line_content": "",
          "new_line_content": "        ScopedMem<WCHAR> fontInfo(str::conv::FromUtf8(info.LendData()));",
          "content_same": false
        },
        {
          "line": 2697,
          "old_api": null,
          "new_api": "otations",
          "old_text": null,
          "new_text": "otations(Vec<",
          "old_line_content": "",
          "new_line_content": "    if (fonts.Count() == 0)",
          "content_same": false
        },
        {
          "line": 2700,
          "old_api": null,
          "new_api": ": use a new critica",
          "old_text": null,
          "new_text": ": use a new critica",
          "old_line_content": "    if (!_doc)",
          "new_line_content": "    fonts.SortNatural();",
          "content_same": false
        },
        {
          "line": 2701,
          "old_api": null,
          "new_api": "void blocking the",
          "old_text": null,
          "new_text": "void blocking the",
          "old_line_content": "        return NULL;",
          "new_line_content": "    return fonts.Join(L\"\\n\");",
          "content_same": false
        },
        {
          "line": 2712,
          "old_api": null,
          "new_api": "Layout",
          "old_text": null,
          "new_text": "Layout()\n{\n    PageLayou",
          "old_line_content": "    }",
          "new_line_content": "            if (pdf_crypt_revision(_doc) == 5)",
          "content_same": false
        },
        {
          "line": 2713,
          "old_api": null,
          "new_api": "ScopedCritSec scope(&ctxAccess);\n    pdf_obj *root = NULL;",
          "old_text": null,
          "new_text": "    ScopedCritSec scope(&ctxAccess);\n    pdf_obj *root = NULL;\n",
          "old_line_content": "",
          "new_line_content": "                return str::Format(L\"%d.%d Adobe Extension Level %d\", major, minor, 3);",
          "content_same": false
        },
        {
          "line": 2714,
          "old_api": null,
          "new_api": "root = pdf_dict_g",
          "old_text": null,
          "new_text": "       root = pdf_dict_g",
          "old_line_content": "    if (Prop_PdfFileStructure == prop) {",
          "new_line_content": "            if (pdf_crypt_revision(_doc) == 6)",
          "content_same": false
        },
        {
          "line": 2715,
          "old_api": null,
          "new_api": "}\n    fz_catch(ctx) {\n        return layout;\n    }\n\n    fz",
          "old_text": null,
          "new_text": "\n    }\n    fz_catch(ctx) {\n        return layout;\n    }\n\n    fz",
          "old_line_content": "        WStrVec fstruct;",
          "new_line_content": "                return str::Format(L\"%d.%d Adobe Extension Level %d\", major, minor, 8);",
          "content_same": false
        },
        {
          "line": 2725,
          "old_api": null,
          "new_api": "ences\");\n        ch",
          "old_text": null,
          "new_text": "ences\");\n        ch",
          "old_line_content": "            }",
          "new_line_content": "            fstruct.Append(str::Dup(L\"tagged\"));",
          "content_same": false
        },
        {
          "line": 2726,
          "old_api": null,
          "new_api": "pdf_to_name",
          "old_text": null,
          "new_text": "pdf_to_name(pdf_dict_gets(prefs, \"Dir",
          "old_line_content": "        }",
          "new_line_content": "        if (pdf_dict_gets(_info, \"OutputIntents\")) {",
          "content_same": false
        },
        {
          "line": 2728,
          "old_api": null,
          "new_api": "rn layout;\n}\n\nunsigned char *PdfEngin",
          "old_text": null,
          "new_text": "rn layout;\n}\n\nunsigned char *PdfEngin",
          "old_line_content": "    }",
          "new_line_content": "                pdf_obj *intent = pdf_array_get(pdf_dict_gets(_info, \"OutputIntents\"), i);",
          "content_same": false
        },
        {
          "line": 2729,
          "old_api": null,
          "new_api": "ed char *data = NUL",
          "old_text": null,
          "new_text": "ed char *data = NUL",
          "old_line_content": "",
          "new_line_content": "                CrashIf(!str::StartsWith(pdf_to_name(intent), \"GTS_\"));",
          "content_same": false
        },
        {
          "line": 2730,
          "old_api": null,
          "new_api": "data = fz_extract",
          "old_text": null,
          "new_text": "  data = fz_extract",
          "old_line_content": "    if (Prop_FontList == prop)",
          "new_line_content": "                fstruct.Append(str::conv::FromUtf8(pdf_to_name(intent) + 4));",
          "content_same": false
        },
        {
          "line": 2733,
          "old_api": null,
          "new_api": "urn _fileName ? (u",
          "old_text": null,
          "new_text": "urn _fileName ? (u",
          "old_line_content": "    static struct {",
          "new_line_content": "        return fstruct.Count() > 0 ? fstruct.Join(L\",\") : NULL;",
          "content_same": false
        },
        {
          "line": 2737,
          "old_api": null,
          "new_api": "return data;\n}",
          "old_text": null,
          "new_text": " return data;\n}\n\n",
          "old_line_content": "        { Prop_Title, \"Title\" }, { Prop_Author, \"Author\" },",
          "new_line_content": "        return ExtractFontList();",
          "content_same": false
        },
        {
          "line": 2748,
          "old_api": null,
          "new_api": "FALSE);\n    if (!ok",
          "old_text": null,
          "new_text": "FALSE);\n    if (!ok",
          "old_line_content": "        }",
          "new_line_content": "    for (int i = 0; i < dimof(pdfPropNames); i++) {",
          "content_same": false
        },
        {
          "line": 2752,
          "old_api": null,
          "new_api": "t *doc, pdf_page *page, pdf_obj *page_obj,",
          "old_text": null,
          "new_text": "t *doc, pdf_page *page, pdf_obj *page_obj,",
          "old_line_content": "",
          "new_line_content": "            pdf_obj *obj = pdf_dict_gets(_info, pdfPropNames[i].name);",
          "content_same": false
        },
        {
          "line": 2753,
          "old_api": null,
          "new_api": "static const char *ob",
          "old_text": null,
          "new_text": "  static const char *ob",
          "old_line_content": "bool PdfEngineImpl::SupportsAnnotation(bool forSaving) const",
          "new_line_content": "            return obj ? pdf_clean_string(str::conv::FromPdf(obj)) : NULL;",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": null,
          "new_api": "((ListInspectionData *)dev->user)",
          "old_text": null,
          "new_text": "   ((ListInspectionData *)dev->user)",
          "old_line_content": "    ((ListInspectionData *)dev->user)->mem_estimate += sizeof(fz_shade);",
          "new_line_content": "    fz_inspection_handle_text(dev, text);",
          "content_same": false
        },
        {
          "line": 2763,
          "old_api": null,
          "new_api": "<< /Type /X",
          "old_text": null,
          "new_text": "<< /Type /X",
          "old_line_content": "}",
          "new_line_content": "        for (int i = 0; i < PageCount(); i++) {",
          "content_same": false
        },
        {
          "line": 2764,
          "old_api": null,
          "new_api": "x [0 0 %f %f] /Resources",
          "old_text": null,
          "new_text": "x [0 0 %f %f] /Resources",
          "old_line_content": "",
          "new_line_content": "            if (pdf_to_num(_pageObjs[i]) == 0)",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": null,
          "new_api": ">fill_path = fz_inspection_fi",
          "old_text": null,
          "new_text": ">fill_path = fz_inspection_fi",
          "old_line_content": "fz_inspection_fill_image_mask(fz_device *dev, fz_image *image, const fz_matrix *ctm, fz_colorspace *colorspace, float *color, float alpha)",
          "new_line_content": "    fz_transform_rect(&rect, ctm);",
          "content_same": false
        },
        {
          "line": 730,
          "old_api": null,
          "new_api": "dev->stroke_path = fz_",
          "old_text": null,
          "new_text": " dev->stroke_path = fz_",
          "old_line_content": "{",
          "new_line_content": "    if (!fz_is_empty_rect(&rect))",
          "content_same": false
        },
        {
          "line": 2778,
          "old_api": null,
          "new_api": "ap_strikeout = \"q",
          "old_text": null,
          "new_text": "ap_strikeout = \"q ",
          "old_line_content": "        return NULL;",
          "new_line_content": "        userAnnots.Reset();",
          "content_same": false
        },
        {
          "line": 2785,
          "old_api": null,
          "new_api": "%f %f RG 0.5 w [1] 1.5 d",
          "old_text": null,
          "new_text": "%f %f RG 0.5 w [1] 1.5 d",
          "old_line_content": "",
          "new_line_content": "    return str::Dup(_decryptionKey);",
          "content_same": false
        },
        {
          "line": 743,
          "old_api": null,
          "new_api": "mask = fz_inspection_fill_image_mask;",
          "old_text": null,
          "new_text": "mask = fz_inspection_fill_image_mask;\n",
          "old_line_content": "    dev->free_user = fz_inspection_free;",
          "new_line_content": "    fz_inspection_handle_image(dev, image);",
          "content_same": false
        },
        {
          "line": 2795,
          "old_api": null,
          "new_api": "_var",
          "old_text": null,
          "new_text": "_var(ap_buf);\n\n  ",
          "old_line_content": "    fz_try(ctx) {",
          "new_line_content": "        root = pdf_dict_gets(pdf_trailer(_doc), \"Root\");",
          "content_same": false
        },
        {
          "line": 748,
          "old_api": null,
          "new_api": "e {\npublic:\n    fz_cooki",
          "old_text": null,
          "new_text": "e {\npublic:\n    fz_cooki",
          "old_line_content": "    dev->clip_stroke_path = fz_inspection_clip_stroke_path;",
          "new_line_content": "    fz_device *dev = fz_new_device(ctx, data);",
          "content_same": false
        },
        {
          "line": 2802,
          "old_api": null,
          "new_api": "? \"Underline\" :",
          "old_text": null,
          "new_text": " ? \"Underline\" :\n                ",
          "old_line_content": "    fz_catch(ctx) { }",
          "new_line_content": "        char *name = pdf_to_name(pdf_dict_gets(root, \"PageLayout\"));",
          "content_same": false
        },
        {
          "line": 2803,
          "old_api": null,
          "new_api": "StrikeOut == annot.type ? \"S",
          "old_text": null,
          "new_text": "StrikeOut == annot.type ? \"S",
          "old_line_content": "",
          "new_line_content": "        if (str::EndsWith(name, \"Right\"))",
          "content_same": false
        },
        {
          "line": 2811,
          "old_api": null,
          "new_api": "// convert the annotation's rectangle ba",
          "old_text": null,
          "new_text": "// convert the annotation's rectangle ba",
          "old_line_content": "",
          "new_line_content": "        pdf_obj *prefs = pdf_dict_gets(root, \"ViewerPreferences\");",
          "content_same": false
        },
        {
          "line": 2812,
          "old_api": null,
          "new_api": "ectD_to_rect",
          "old_text": null,
          "new_text": "ectD_to_rect(annot.rect);\n    fz_",
          "old_line_content": "    return layout;",
          "new_line_content": "        char *direction = pdf_to_name(pdf_dict_gets(prefs, \"Direction\"));",
          "content_same": false
        },
        {
          "line": 2813,
          "old_api": null,
          "new_api": "fz_transform_rect(&r,",
          "old_text": null,
          "new_text": "   fz_transform_rect(&r, ",
          "old_line_content": "}",
          "new_line_content": "        if (str::Eq(direction, \"R2L\"))",
          "content_same": false
        },
        {
          "line": 2814,
          "old_api": null,
          "new_api": "&page->ctm));\n    double dx = r.x1",
          "old_text": null,
          "new_text": " &page->ctm));\n    double dx = r.x1 ",
          "old_line_content": "",
          "new_line_content": "            layout = (PageLayoutType)(layout | Layout_R2L);",
          "content_same": false
        },
        {
          "line": 772,
          "old_api": null,
          "new_api": "fz_get_user_page_annots",
          "old_text": null,
          "new_text": "fz_get_user_page_annots(Vec<PageAn",
          "old_line_content": "{",
          "new_line_content": "    FitzAbortCookie() { memset(&cookie, 0, sizeof(cookie)); }",
          "content_same": false
        },
        {
          "line": 2826,
          "old_api": null,
          "new_api": "dMem<char> quad_tpl;\n    if (0 == rotation)",
          "old_text": null,
          "new_text": "dMem<char> quad_tpl;\n    if (0 == rotation)",
          "old_line_content": "}",
          "new_line_content": "        data = fz_extract_stream_data(_doc->file, cbCount);",
          "content_same": false
        },
        {
          "line": 2829,
          "old_api": null,
          "new_api": "0, r.y0, r.x1, r.y0));\n    else i",
          "old_text": null,
          "new_text": "0, r.y0, r.x1, r.y0));\n    else i",
          "old_line_content": "{",
          "new_line_content": "        return _fileName ? (unsigned char *)file::ReadAll(_fileName, cbCount) : NULL;",
          "content_same": false
        },
        {
          "line": 785,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": "sult.Append(annot);\n       ",
          "old_line_content": "",
          "new_line_content": "    BOOL ok = TryEnterCriticalSection(cs);",
          "content_same": false
        },
        {
          "line": 787,
          "old_api": null,
          "new_api": "return r",
          "old_text": null,
          "new_text": "\n    return r",
          "old_line_content": "fz_unlock_context_cs(void *user, int lock)",
          "new_line_content": "        CrashIf(true);",
          "content_same": false
        },
        {
          "line": 788,
          "old_api": null,
          "new_api": "tatic void fz_run_user_p",
          "old_text": null,
          "new_text": "tatic void fz_run_user_p",
          "old_line_content": "{",
          "new_line_content": "        EnterCriticalSection(cs);",
          "content_same": false
        },
        {
          "line": 2837,
          "old_api": null,
          "new_api": "j_quad_tpl, r.x1, r.y",
          "old_text": null,
          "new_text": "j_quad_tpl, r.x1, r.y",
          "old_line_content": "    if (!_fileName)",
          "new_line_content": "    ScopedMem<unsigned char> data(GetFileData(&dataLen));",
          "content_same": false
        },
        {
          "line": 2841,
          "old_api": null,
          "new_api": ", r.y1, r.x0, r.y0));\n    Sc",
          "old_text": null,
          "new_text": ", r.y1, r.x0, r.y0));\n    Sc",
          "old_line_content": "        return false;",
          "new_line_content": "            return !includeUserAnnots || SaveUserAnnots(copyFileName);",
          "content_same": false
        },
        {
          "line": 2845,
          "old_api": null,
          "new_api": "r.y0, r.x1, r.y1, rgb[0], rgb[1], rgb[2",
          "old_text": null,
          "new_text": " r.y0, r.x1, r.y1, rgb[0], rgb[1], rgb[2",
          "old_line_content": "",
          "new_line_content": "    bool ok = CopyFile(_fileName, copyFileName, FALSE);",
          "content_same": false
        },
        {
          "line": 2849,
          "old_api": null,
          "new_api": "> annot_ap_dict(str::Format(",
          "old_text": null,
          "new_text": "> annot_ap_dict(str::Format(",
          "old_line_content": "    /Type /Annot /Subtype /%s\\",
          "new_line_content": "    return !includeUserAnnots || SaveUserAnnots(copyFileName);",
          "content_same": false
        },
        {
          "line": 802,
          "old_api": null,
          "new_api": "RectD_to_rect",
          "old_text": null,
          "new_text": "RectD_to_rect(anno",
          "old_line_content": "        case Annot_Highlight: case Annot_Underline: case Annot_StrikeOut: case Annot_Squiggly:",
          "new_line_content": "    for (size_t i = 0; i < userAnnots.Count(); i++) {",
          "content_same": false
        },
        {
          "line": 809,
          "old_api": null,
          "new_api": "tx);\n        fz_stro",
          "old_text": null,
          "new_text": "tx);\n        fz_stro",
          "old_line_content": "",
          "new_line_content": "            result.Append(annot);",
          "content_same": false
        },
        {
          "line": 819,
          "old_api": null,
          "new_api": "ev->ctx, path, a",
          "old_text": null,
          "new_text": "ev->ctx, path, a",
          "old_line_content": "            continue;",
          "new_line_content": "        PageAnnotation& annot = pageAnnots.At(i);",
          "content_same": false
        },
        {
          "line": 821,
          "old_api": null,
          "new_api": "ath);\n            break;",
          "old_text": null,
          "new_text": "ath);\n            break;\n   ",
          "old_line_content": "        // and pdf_create_markup_annot in pdf_annot.c)",
          "new_line_content": "        fz_rect rect = fz_RectD_to_rect(annot.rect);",
          "content_same": false
        },
        {
          "line": 824,
          "old_api": null,
          "new_api": "fz_lineto(dev->ctx, path,",
          "old_text": null,
          "new_text": "         fz_lineto(dev->ctx, path, ",
          "old_line_content": "        switch (annot.type) {",
          "new_line_content": "        if (cliprect && fz_is_empty_rect(fz_intersect_rect(&isect, cliprect)))",
          "content_same": false
        },
        {
          "line": 2874,
          "old_api": null,
          "new_api": "2], dy / 2, dx, d",
          "old_text": null,
          "new_text": "2], dy / 2, dx, d",
          "old_line_content": "                          Annot_StrikeOut == annot.type ? \"StrikeOut\" :",
          "new_line_content": "    fz_var(annot_obj);",
          "content_same": false
        },
        {
          "line": 2875,
          "old_api": null,
          "new_api": ";",
          "old_text": null,
          "new_text": ";\n            ",
          "old_line_content": "                          Annot_Squiggly  == annot.type ? \"Squiggly\"  : NULL;",
          "new_line_content": "    fz_var(ap_obj);",
          "content_same": false
        },
        {
          "line": 832,
          "old_api": null,
          "new_api": "tx, path, annot",
          "old_text": null,
          "new_text": "tx, path, annot",
          "old_line_content": "        case Annot_Underline:",
          "new_line_content": "            fz_moveto(dev->ctx, path, annot.rect.TL().x, annot.rect.TL().y);",
          "content_same": false
        },
        {
          "line": 835,
          "old_api": null,
          "new_api": "o",
          "old_text": null,
          "new_text": "o(dev->ctx, pat",
          "old_line_content": "            break;",
          "new_line_content": "            fz_lineto(dev->ctx, path, annot.rect.TL().x, annot.rect.BR().y);",
          "content_same": false
        },
        {
          "line": 836,
          "old_api": null,
          "new_api": "BR",
          "old_text": null,
          "new_text": ".x, annot.rect.BR().y - 0.5f",
          "old_line_content": "        case Annot_StrikeOut:",
          "new_line_content": "            fz_closepath(dev->ctx, path);",
          "content_same": false
        },
        {
          "line": 2884,
          "old_api": null,
          "new_api": "tate",
          "old_text": null,
          "new_text": "tate(&rot, rotation)));\n     ",
          "old_line_content": "    if ((rotation % 180) == 90)",
          "new_line_content": "    CrashIf((rotation % 90) != 0);",
          "content_same": false
        },
        {
          "line": 2886,
          "old_api": null,
          "new_api": "cpy",
          "old_text": null,
          "new_text": "cpy(ap_buf->data, annot_ap_s",
          "old_line_content": "    float rgb[3] = { annot.color.r / 255.f, annot.color.g / 255.f, annot.color.b / 255.f };",
          "new_line_content": "    fz_rect r = fz_RectD_to_rect(annot.rect);",
          "content_same": false
        },
        {
          "line": 839,
          "old_api": null,
          "new_api": "stro",
          "old_text": null,
          "new_text": "           stro",
          "old_line_content": "            break;",
          "new_line_content": "            fz_moveto(dev->ctx, path, annot.rect.TL().x, annot.rect.BR().y - 0.25f);",
          "content_same": false
        },
        {
          "line": 840,
          "old_api": null,
          "new_api": "roke->dash_len+",
          "old_text": null,
          "new_text": "roke->dash_len+",
          "old_line_content": "        case Annot_Squiggly:",
          "new_line_content": "            fz_lineto(dev->ctx, path, annot.rect.BR().x, annot.rect.BR().y - 0.25f);",
          "content_same": false
        },
        {
          "line": 2888,
          "old_api": null,
          "new_api": "));\n        pdf_dict_puts_drop(ap_obj",
          "old_text": null,
          "new_text": "));\n        pdf_dict_puts_drop(ap_obj",
          "old_line_content": "    ScopedMem<char> quad_tpl;",
          "new_line_content": "    fz_transform_rect(&r, fz_invert_matrix(&invctm, &page->ctm));",
          "content_same": false
        },
        {
          "line": 2891,
          "old_api": null,
          "new_api": "le\n        i",
          "old_text": null,
          "new_text": "le\n        i",
          "old_line_content": "    else if (90 == rotation)",
          "new_line_content": "        Swap(dx, dy);",
          "content_same": false
        },
        {
          "line": 847,
          "old_api": null,
          "new_api": ", FZ_BLEND_MULT",
          "old_text": null,
          "new_text": ", FZ_BLEND_MULT",
          "old_line_content": "            stroke->dash_list[stroke->dash_len++] = 1;",
          "new_line_content": "            fz_moveto(dev->ctx, path, annot.rect.TL().x + 1, annot.rect.BR().y);",
          "content_same": false
        },
        {
          "line": 848,
          "old_api": null,
          "new_api": "or, annot.color",
          "old_text": null,
          "new_text": "or, annot.color",
          "old_line_content": "            stroke->dash_list[stroke->dash_len++] = 1;",
          "new_line_content": "            fz_lineto(dev->ctx, path, annot.rect.BR().x, annot.rect.BR().y);",
          "content_same": false
        },
        {
          "line": 849,
          "old_api": null,
          "new_api": "lse {",
          "old_text": null,
          "new_text": "lse {\n         ",
          "old_line_content": "            break;",
          "new_line_content": "            fz_moveto(dev->ctx, path, annot.rect.TL().x, annot.rect.BR().y - 0.5f);",
          "content_same": false
        },
        {
          "line": 850,
          "old_api": null,
          "new_api": ";\n            f",
          "old_text": null,
          "new_text": ";\n            f",
          "old_line_content": "        default:",
          "new_line_content": "            fz_lineto(dev->ctx, path, annot.rect.BR().x, annot.rect.BR().y - 0.5f);",
          "content_same": false
        },
        {
          "line": 2898,
          "old_api": null,
          "new_api": "}\n    fz_catch(ctx) {\n        return false;\n    }\n\n    return true;\n}",
          "old_text": null,
          "new_text": "  }\n    fz_catch(ctx) {\n        return false;\n    }\n\n    return true;\n}\n\n",
          "old_line_content": "        r.x0, r.y0, r.x1, r.y1, rgb[0], rgb[1], rgb[2], //Rect and Color",
          "new_line_content": "        quad_tpl.Set(str::Format(obj_quad_tpl, r.x0, r.y0, r.x0, r.y1, r.x1, r.y0, r.x1, r.y1));",
          "content_same": false
        },
        {
          "line": 2900,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": ")\n{\n    if (!userAnnots.Count())\n        return true;\n\n    ScopedCritSec ",
          "old_line_content": "        quad_tpl));",
          "new_line_content": "        quad_tpl.Set(str::Format(obj_quad_tpl, r.x1, r.y0, r.x0, r.y0, r.x1, r.y1, r.x0, r.y1));",
          "content_same": false
        },
        {
          "line": 2902,
          "old_api": null,
          "new_api": "bool ok = true;\n    ScopedMem<char> pathUtf8(str::conv::ToUtf8(file",
          "old_text": null,
          "new_text": "\n\n    bool ok = true;\n    ScopedMem<char> pathUtf8(str::conv::ToUtf8(file",
          "old_line_content": "    ScopedMem<char> annot_ap_stream;",
          "new_line_content": "        quad_tpl.Set(str::Format(obj_quad_tpl, r.x1, r.y1, r.x1, r.y0, r.x0, r.y1, r.x0, r.y0));",
          "content_same": false
        },
        {
          "line": 2903,
          "old_api": null,
          "new_api": "geAnnots;\n\n    fz_try(ctx) {\n        for (int pageNo = 1; pageNo <= PageCount(); pageNo++) {\n            pdf_page *page = GetPdfPage(pageNo);\n            // TODO: this will skip annotations for b",
          "old_text": null,
          "new_text": "geAnnots;\n\n    fz_try(ctx) {\n        for (int pageNo = 1; pageNo <= PageCount(); pageNo++) {\n            pdf_page *page = GetPdfPage(pageNo);\n            // TODO: this will skip annotations for b",
          "old_line_content": "",
          "new_line_content": "    ScopedMem<char> annot_tpl(str::Format(obj_dict, subtype,",
          "content_same": false
        },
        {
          "line": 2911,
          "old_api": null,
          "new_api": "get_user_page_annots",
          "old_text": null,
          "new_text": "get_user_page_annots(userAnnots, pag",
          "old_line_content": "        return false;",
          "new_line_content": "        annot_obj = pdf_new_obj_from_str(doc, annot_tpl);",
          "content_same": false
        },
        {
          "line": 2913,
          "old_api": null,
          "new_api": "// get the page's /Annots a",
          "old_text": null,
          "new_text": "// get the page's /Annots a",
          "old_line_content": "",
          "new_line_content": "        pdf_array_push_drop(annots, pdf_new_ref(doc, annot_obj));",
          "content_same": false
        },
        {
          "line": 2916,
          "old_api": null,
          "new_api": "annots = pdf_dict_gets(",
          "old_text": null,
          "new_text": "annots = pdf_dict_gets(",
          "old_line_content": "        // the readers will have to synthesize an appearance stream themselves",
          "new_line_content": "        pdf_drop_obj(annot_obj);",
          "content_same": false
        },
        {
          "line": 869,
          "old_api": null,
          "new_api": "Fitz/MuPDF /////\n\nextern \"C\"",
          "old_text": null,
          "new_text": " Fitz/MuPDF /////\n\nextern \"C\"",
          "old_line_content": "}",
          "new_line_content": "                stroke = fz_new_stroke_state(dev->ctx);",
          "content_same": false
        },
        {
          "line": 870,
          "old_api": null,
          "new_api": "pdf/pdf.h>\n}\n\nnamespace str {\n    namespace conv {\n\ninl",
          "old_text": null,
          "new_text": "pdf/pdf.h>\n}\n\nnamespace str {\n    namespace conv {\n\ninl",
          "old_line_content": "",
          "new_line_content": "            fz_stroke_path(dev, path, stroke, ctm, cs, color, 1.0f);",
          "content_same": false
        },
        {
          "line": 871,
          "old_api": null,
          "new_api": "Pdf",
          "old_text": null,
          "new_text": "Pdf(pdf_obj *obj)\n{\n    ScopedMem<WCHA",
          "old_line_content": "static void fz_run_page_transparency(Vec<PageAnnotation>& pageAnnots, fz_device *dev, const fz_rect *cliprect, bool endGroup, bool hasTransparency=false)",
          "new_line_content": "            fz_drop_stroke_state(dev->ctx, stroke);",
          "content_same": false
        },
        {
          "line": 879,
          "old_api": null,
          "new_api": "_string",
          "old_text": null,
          "new_text": "_string(WCHAR *str",
          "old_line_content": "            break;",
          "new_line_content": "    if (hasTransparency || pageAnnots.Count() == 0)",
          "content_same": false
        },
        {
          "line": 882,
          "old_api": null,
          "new_api": "= '\\r' && *c != '\\",
          "old_text": null,
          "new_text": "= '\\r' && *c != '\\",
          "old_line_content": "    if (!needsTransparency)",
          "new_line_content": "    for (size_t i = 0; i < pageAnnots.Count(); i++) {",
          "content_same": false
        },
        {
          "line": 883,
          "old_api": null,
          "new_api": "n string;\n}\n\npdf",
          "old_text": null,
          "new_text": "n string;\n}\n\npdf",
          "old_line_content": "        return;",
          "new_line_content": "        if (Annot_Highlight == pageAnnots.At(i).type) {",
          "content_same": false
        },
        {
          "line": 2938,
          "old_api": null,
          "new_api": "opts.do_incremental = 1;\n            pdf_write_document(_doc, pat",
          "old_text": null,
          "new_text": "    opts.do_incremental = 1;\n            pdf_write_document(_doc, pat",
          "old_line_content": "        if (annot.type != Annot_Highlight)",
          "new_line_content": "            annot_ap_stream.Set(str::Format(ap_strikeout, rgb[0], rgb[1], rgb[2], dy / 2, dx, dy / 2));",
          "content_same": false
        },
        {
          "line": 891,
          "old_api": null,
          "new_api": "df_obj *val = pdf_dict_get_val(copy, i);\n        // resolve all indirect",
          "old_text": null,
          "new_text": "df_obj *val = pdf_dict_get_val(copy, i);\n        // resolve all indirect",
          "old_line_content": "",
          "new_line_content": "        fz_begin_group(dev, cliprect ? cliprect : &fz_infinite_rect, 1, 0, 0, 1);",
          "content_same": false
        },
        {
          "line": 893,
          "old_api": null,
          "new_api": "f (pdf_is_indirec",
          "old_text": null,
          "new_text": "f (pdf_is_indirec",
          "old_line_content": "#include <mupdf/pdf.h>",
          "new_line_content": "        fz_end_group(dev);",
          "content_same": false
        },
        {
          "line": 2941,
          "old_api": null,
          "new_api": "n ok;\n}\n\nbool PdfEngineImpl::SaveEmbedded(LinkSaverUI& s",
          "old_text": null,
          "new_text": "n ok;\n}\n\nbool PdfEngineImpl::SaveEmbedded(LinkSaverUI& s",
          "old_line_content": "            fz_matrix rot;",
          "new_line_content": "            annot_ap_stream.Set(str::Format(ap_squiggly, rgb[0], rgb[1], rgb[2], dx, dx));",
          "content_same": false
        },
        {
          "line": 2952,
          "old_api": null,
          "new_api": "[pageNo-1])\n        return tr",
          "old_text": null,
          "new_text": "[pageNo-1])\n        return tr",
          "old_line_content": "    }",
          "new_line_content": "        pdf_dict_puts_drop(ap_obj, \"Length\", pdf_new_int(doc, ap_buf->len));",
          "content_same": false
        },
        {
          "line": 907,
          "old_api": null,
          "new_api": "y;\n}\n\n// Note: make",
          "old_text": null,
          "new_text": "y;\n}\n\n// Note: make",
          "old_line_content": "}",
          "new_line_content": "    ScopedMem<WCHAR> str(AllocArray<WCHAR>(pdf_to_str_len(obj) + 1));",
          "content_same": false
        },
        {
          "line": 908,
          "old_api": null,
          "new_api": "df_loadat",
          "old_text": null,
          "new_text": "df_loadat",
          "old_line_content": "",
          "new_line_content": "    pdf_to_ucs2_buf((unsigned short *)str.Get(), obj);",
          "content_same": false
        },
        {
          "line": 909,
          "old_api": null,
          "new_api": "nt *doc)\n{",
          "old_text": null,
          "new_text": "nt *doc)\n{\n    ",
          "old_line_content": "// some PDF documents contain control characters in outline titles or /Info properties",
          "new_line_content": "    return str.StealData();",
          "content_same": false
        },
        {
          "line": 2957,
          "old_api": null,
          "new_api": "9f)\n            return false;",
          "old_text": null,
          "new_text": "9f)\n            return false;",
          "old_line_content": "    }",
          "new_line_content": "        pdf_dict_puts_drop(pdf_dict_gets(annot_obj, \"AP\"), \"N\", pdf_new_indirect(doc, num, 0));",
          "content_same": false
        },
        {
          "line": 2960,
          "old_api": null,
          "new_api": "::GetPageLabel(int p",
          "old_text": null,
          "new_text": "::GetPageLabel(int p",
          "old_line_content": "    }",
          "new_line_content": "        pdf_drop_obj(ap_obj);",
          "content_same": false
        },
        {
          "line": 2961,
          "old_api": null,
          "new_api": "t\n{\n    if (!_pagelabels ||",
          "old_text": null,
          "new_text": "t\n{\n    if (!_pagelabels ||",
          "old_line_content": "",
          "new_line_content": "        fz_drop_buffer(ctx, ap_buf);",
          "content_same": false
        },
        {
          "line": 2962,
          "old_api": null,
          "new_api": "|| PageCount() < pageN",
          "old_text": null,
          "new_text": " || PageCount() < pageN",
          "old_line_content": "    return true;",
          "new_line_content": "        pdf_drop_obj(annot_obj);",
          "content_same": false
        },
        {
          "line": 2973,
          "old_api": null,
          "new_api": "l) const\n{\n    int",
          "old_text": null,
          "new_text": "l) const\n{\n    int",
          "old_line_content": "    bool ok = true;",
          "new_line_content": "    if (!userAnnots.Count())",
          "content_same": false
        },
        {
          "line": 929,
          "old_api": null,
          "new_api": "utline);\n        node->ti",
          "old_text": null,
          "new_text": "utline);\n        node->ti",
          "old_line_content": "        }",
          "new_line_content": "        pdf_obj *val = pdf_dict_get_val(copy, i);",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": null,
          "new_api": ">dest.kind = FZ_LINK",
          "old_text": null,
          "new_text": ">dest.kind = FZ_LINK",
          "old_line_content": "    return copy;",
          "new_line_content": "        if (pdf_is_indirect(val)) {",
          "content_same": false
        },
        {
          "line": 932,
          "old_api": null,
          "new_api": ", dest);\n        no",
          "old_text": null,
          "new_text": ", dest);\n        no",
          "old_line_content": "}",
          "new_line_content": "            pdf_obj *val2 = pdf_new_string(doc, pdf_to_str_buf(val), pdf_to_str_len(val));",
          "content_same": false
        },
        {
          "line": 933,
          "old_api": null,
          "new_api": "node->dest.ld.lau",
          "old_text": null,
          "new_text": "        node->dest.ld.lau",
          "old_line_content": "",
          "new_line_content": "            pdf_dict_put(copy, pdf_dict_get_key(copy, i), val2);",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": null,
          "new_api": "_to_num",
          "old_text": null,
          "new_text": "_to_num(embedded);",
          "old_line_content": "// Note: make sure to only call with ctxAccess",
          "new_line_content": "            pdf_drop_obj(val2);",
          "content_same": false
        },
        {
          "line": 2984,
          "old_api": null,
          "new_api": "{\n        c",
          "old_text": null,
          "new_text": "{\n        c",
          "old_line_content": "            }",
          "new_line_content": "        for (int pageNo = 1; pageNo <= PageCount(); pageNo++) {",
          "content_same": false
        },
        {
          "line": 2987,
          "old_api": null,
          "new_api": "ind != FZ_LINK_LAUNCH &&",
          "old_text": null,
          "new_text": "ind != FZ_LINK_LAUNCH &&\n        ",
          "old_line_content": "                continue;",
          "new_line_content": "            if (!page || !pdf_to_num(_pageObjs[pageNo - 1])) {",
          "content_same": false
        },
        {
          "line": 2995,
          "old_api": null,
          "new_api": "fz_try(engine->ctx) {\n                pdf_",
          "old_text": null,
          "new_text": "    fz_try(engine->ctx) {\n                pdf_",
          "old_line_content": "                // make /Annots indirect for the current /Page",
          "new_line_content": "            pdf_obj *annots = pdf_dict_gets(_pageObjs[pageNo - 1], \"Annots\");",
          "content_same": false
        },
        {
          "line": 948,
          "old_api": null,
          "new_api": "return ((PageLabel",
          "old_text": null,
          "new_text": "return ((PageLabel",
          "old_line_content": "",
          "new_line_content": "    for (int i = 0; i < pdf_dict_len(dict); i++) {",
          "content_same": false
        },
        {
          "line": 2997,
          "old_api": null,
          "new_api": "if (obj",
          "old_text": null,
          "new_text": "           if (obj",
          "old_line_content": "            }",
          "new_line_content": "                pdf_dict_puts_drop(_pageObjs[pageNo - 1], \"Annots\", pdf_new_array(_doc, (int)pageAnnots.Count()));",
          "content_same": false
        },
        {
          "line": 2998,
          "old_api": null,
          "new_api": "(str::conv::FromPdf(obj));\n            }",
          "old_text": null,
          "new_text": "(str::conv::FromPdf(obj));\n            }\n     ",
          "old_line_content": "            // append all annotations for the current page",
          "new_line_content": "                annots = pdf_dict_gets(_pageObjs[pageNo - 1], \"Annots\");",
          "content_same": false
        },
        {
          "line": 951,
          "old_api": null,
          "new_api": ")\n        return str::For",
          "old_text": null,
          "new_text": ")\n        return str::For",
          "old_line_content": "        node->dest.kind = FZ_LINK_LAUNCH;",
          "new_line_content": "        pdf_obj *embedded = pdf_dict_getsa(pdf_dict_gets(dest, \"EF\"), \"DOS\", \"F\");",
          "content_same": false
        },
        {
          "line": 3002,
          "old_api": null,
          "new_api": "tealData",
          "old_text": null,
          "new_text": "tealData();\n            }",
          "old_line_content": "        }",
          "new_line_content": "                pdf_dict_puts_drop(_pageObjs[pageNo - 1], \"Annots\", pdf_new_ref(_doc, annots));",
          "content_same": false
        },
        {
          "line": 956,
          "old_api": null,
          "new_api": "str::ToLo",
          "old_text": null,
          "new_text": "        str::ToLo",
          "old_line_content": "        node->dest.ld.launch.is_uri = 0;",
          "new_line_content": "        node->title = fz_strdup(doc->ctx, pdf_to_name(name));",
          "content_same": false
        },
        {
          "line": 3005,
          "old_api": null,
          "new_api": "x =",
          "old_text": null,
          "new_text": "               x =",
          "old_line_content": "            opts.do_incremental = 1;",
          "new_line_content": "            for (size_t i = 0; i < pageAnnots.Count(); i++) {",
          "content_same": false
        },
        {
          "line": 960,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": "     number.Append('",
          "old_line_content": "    return root.next;",
          "new_line_content": "        node->dest.ld.launch.embedded_num = pdf_to_num(embedded);",
          "content_same": false
        },
        {
          "line": 961,
          "old_api": null,
          "new_api": "; i < (pageNo - 1) /",
          "old_text": null,
          "new_text": "; i < (pageNo - 1) /",
          "old_line_content": "}",
          "new_line_content": "        node->dest.ld.launch.embedded_gen = pdf_to_gen(embedded);",
          "content_same": false
        },
        {
          "line": 964,
          "old_api": null,
          "new_api": "if (*type == 'a",
          "old_text": null,
          "new_text": "   if (*type == 'a",
          "old_line_content": "    int startAt, countFrom;",
          "new_line_content": "    pdf_drop_obj(dict);",
          "content_same": false
        },
        {
          "line": 3012,
          "old_api": null,
          "new_api": "LAUNCH:\n        // note: we (intentionall",
          "old_text": null,
          "new_text": "LAUNCH:\n        // note: we (intentionall",
          "old_line_content": "    return ok;",
          "new_line_content": "            pdf_write_document(_doc, pathUtf8, &opts);",
          "content_same": false
        },
        {
          "line": 984,
          "old_api": null,
          "new_api": "pdf_unmark_",
          "old_text": null,
          "new_text": "        pdf_unmark_",
          "old_line_content": "    }",
          "new_line_content": "    if (str::EqI(type, \"R\")) {",
          "content_same": false
        },
        {
          "line": 3032,
          "old_api": null,
          "new_api": "bedded_num, link->ld.",
          "old_text": null,
          "new_text": "bedded_num, link->ld.",
          "old_line_content": "bool PdfEngineImpl::HasClipOptimizations(int pageNo)",
          "new_line_content": "    CrashIf(NULL == data);",
          "content_same": false
        },
        {
          "line": 3033,
          "old_api": null,
          "new_api": "}\n        break;\n    case FZ_LINK",
          "old_text": null,
          "new_text": "\n        }\n        break;\n    case FZ_LINK",
          "old_line_content": "{",
          "new_line_content": "    bool result = saveUI.SaveEmbedded(data->data, data->len);",
          "content_same": false
        },
        {
          "line": 989,
          "old_api": null,
          "new_api": "PageLabelInfo pli;",
          "old_text": null,
          "new_text": "\n            PageLabelInfo pli;\n    ",
          "old_line_content": "        for (int i = 0; i < (pageNo - 1) / 26; i++)",
          "new_line_content": "        return str::Format(L\"%s%s\", prefix, number);",
          "content_same": false
        },
        {
          "line": 991,
          "old_api": null,
          "new_api": "t = pdf_to_int(pdf_",
          "old_text": null,
          "new_text": "t = pdf_to_int(pdf_",
          "old_line_content": "        if (*type == 'a')",
          "new_line_content": "    if (str::EqI(type, \"A\")) {",
          "content_same": false
        },
        {
          "line": 3040,
          "old_api": null,
          "new_api": "return path;\n}\n\nstatic P",
          "old_text": null,
          "new_text": "return path;\n}\n\nstatic P",
          "old_line_content": "    // check if any image covers at least 90% of the page",
          "new_line_content": "    pdf_page *page = GetPdfPage(pageNo, true);",
          "content_same": false
        },
        {
          "line": 994,
          "old_api": null,
          "new_api": "ame",
          "old_text": null,
          "new_text": "ame(pdf_dict_gets(info, \"S\"));\n       ",
          "old_line_content": "    }",
          "new_line_content": "        number.Append('A' + (pageNo - 1) % 26);",
          "content_same": false
        },
        {
          "line": 996,
          "old_api": null,
          "new_api": "(pdf_dict_ge",
          "old_text": null,
          "new_text": "(pdf_dict_ge",
          "old_line_content": "}",
          "new_line_content": "            number.Append(number.At(0));",
          "content_same": false
        },
        {
          "line": 3045,
          "old_api": null,
          "new_api": "(str::Eq(name, #typ",
          "old_text": null,
          "new_text": " (str::Eq(name, #typ",
          "old_line_content": "}",
          "new_line_content": "    fz_rect mbox = fz_RectD_to_rect(PageMediabox(pageNo));",
          "content_same": false
        },
        {
          "line": 998,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "            ",
          "old_line_content": "void BuildPageLabelRec(pdf_obj *node, int pageCount, Vec<PageLabelInfo>& data)",
          "new_line_content": "            str::ToLower(number.Get());",
          "content_same": false
        },
        {
          "line": 999,
          "old_api": null,
          "new_api": "}",
          "old_text": null,
          "new_text": "\n        }\n ",
          "old_line_content": "{",
          "new_line_content": "        return str::Format(L\"%s%s\", prefix, number.Get());",
          "content_same": false
        },
        {
          "line": 3047,
          "old_api": null,
          "new_api": "turn Dest_ ## type ## Dialog\n    // predef",
          "old_text": null,
          "new_text": "turn Dest_ ## type ## Dialog\n    // predef",
          "old_line_content": "WCHAR *PdfEngineImpl::GetPageLabel(int pageNo) const",
          "new_line_content": "    for (int i = 0; !fz_is_empty_rect(&imageRects[pageNo-1][i]); i++)",
          "content_same": false
        },
        {
          "line": 3048,
          "old_api": null,
          "new_api": "HandleType(NextPage);\n    HandleType(PrevPa",
          "old_text": null,
          "new_text": "   HandleType(NextPage);\n    HandleType(PrevPa",
          "old_line_content": "{",
          "new_line_content": "        if (fz_calc_overlap(mbox, imageRects[pageNo-1][i]) >= 0.9f)",
          "content_same": false
        },
        {
          "line": 3055,
          "old_api": null,
          "new_api": "ual.html",
          "old_text": null,
          "new_text": "ual.html\n  ",
          "old_line_content": "int PdfEngineImpl::GetPageByLabel(const WCHAR *label) const",
          "new_line_content": "    if (!_pagelabels || pageNo < 1 || PageCount() < pageNo)",
          "content_same": false
        },
        {
          "line": 3056,
          "old_api": null,
          "new_api": "HandleType(FullScreen);\n    H",
          "old_text": null,
          "new_text": "   HandleType(FullScreen);\n    H",
          "old_line_content": "{",
          "new_line_content": "        return BaseEngine::GetPageLabel(pageNo);",
          "content_same": false
        },
        {
          "line": 1009,
          "old_api": null,
          "new_api": "At",
          "old_text": null,
          "new_text": "       !data.At(0).pr",
          "old_line_content": "            PageLabelInfo pli;",
          "new_line_content": "            BuildPageLabelRec(pdf_array_get(obj, i), pageCount, data);",
          "content_same": false
        },
        {
          "line": 3058,
          "old_api": null,
          "new_api": "ndleType",
          "old_text": null,
          "new_text": "ndleType(GoForward);\n    Ha",
          "old_line_content": "    if (!pageNo)",
          "new_line_content": "    return str::Dup(_pagelabels->At(pageNo - 1));",
          "content_same": false
        },
        {
          "line": 1012,
          "old_api": null,
          "new_api": "o need for special treatmen",
          "old_text": null,
          "new_text": "o need for special treatmen",
          "old_line_content": "                continue;",
          "new_line_content": "    else if ((obj = pdf_dict_gets(node, \"Nums\")) != NULL) {",
          "content_same": false
        },
        {
          "line": 1013,
          "old_api": null,
          "new_api": "*labels = new WStr",
          "old_text": null,
          "new_text": "*labels = new WStr",
          "old_line_content": "",
          "new_line_content": "        for (int i = 0; i < pdf_array_len(obj); i += 2) {",
          "content_same": false
        },
        {
          "line": 3063,
          "old_api": null,
          "new_api": "g",
          "old_text": null,
          "new_text": "g(ZoomTo);\n#undef Handle",
          "old_line_content": "",
          "new_line_content": "    int pageNo = _pagelabels ? _pagelabels->Find(label) + 1 : 0;",
          "content_same": false
        },
        {
          "line": 3065,
          "old_api": null,
          "new_api": "tion that we don't support (or in",
          "old_text": null,
          "new_text": "tion that we don't support (or in",
          "old_line_content": "{",
          "new_line_content": "        return BaseEngine::GetPageByLabel(label);",
          "content_same": false
        },
        {
          "line": 1020,
          "old_api": null,
          "new_api": "At",
          "old_text": null,
          "new_text": "     secLen = data.At(i ",
          "old_line_content": "        }",
          "new_line_content": "            pli.type = pdf_to_name(pdf_dict_gets(info, \"S\"));",
          "content_same": false
        },
        {
          "line": 1021,
          "old_api": null,
          "new_api": "rtAt;\n        ScopedMem<",
          "old_text": null,
          "new_text": "rtAt;\n        ScopedMem<",
          "old_line_content": "    }",
          "new_line_content": "            pli.prefix = pdf_dict_gets(info, \"P\");",
          "content_same": false
        },
        {
          "line": 1022,
          "old_api": null,
          "new_api": ").prefix));\n        for (",
          "old_text": null,
          "new_text": ").prefix));\n        for (",
          "old_line_content": "}",
          "new_line_content": "            pli.countFrom = pdf_to_int(pdf_dict_gets(info, \"St\"));",
          "content_same": false
        },
        {
          "line": 1025,
          "old_api": null,
          "new_api": "labe",
          "old_text": null,
          "new_text": "            labe",
          "old_line_content": "{",
          "new_line_content": "            data.Append(pli);",
          "content_same": false
        },
        {
          "line": 1036,
          "old_api": null,
          "new_api": "labels->At",
          "old_text": null,
          "new_text": "  labels->At",
          "old_line_content": "        return NULL;",
          "new_line_content": "    if (data.Count() == 0)",
          "content_same": false
        },
        {
          "line": 1039,
          "old_api": null,
          "new_api": "ber to dup",
          "old_text": null,
          "new_text": "ber to dup",
          "old_line_content": "    WStrVec *labels = new WStrVec();",
          "new_line_content": "    if (data.Count() == 1 && data.At(0).startAt == 1 && data.At(0).countFrom == 1 &&",
          "content_same": false
        },
        {
          "line": 3093,
          "old_api": null,
          "new_api": "return Dest_LaunchFile;\n    default:",
          "old_text": null,
          "new_text": " return Dest_LaunchFile;\n    default:",
          "old_line_content": "                if (obj)",
          "new_line_content": "        path = str::conv::FromUtf8(link->ld.uri.uri);",
          "content_same": false
        },
        {
          "line": 3098,
          "old_api": null,
          "new_api": "ink->ld.gotor.dest)",
          "old_text": null,
          "new_text": "ink->ld.gotor.dest)\n     ",
          "old_line_content": "                ScopedMem<WCHAR> uri(str::Join(base, path));",
          "new_line_content": "                obj = pdf_dict_gets(pdf_dict_gets(obj, \"URI\"), \"Base\");",
          "content_same": false
        },
        {
          "line": 1051,
          "old_api": null,
          "new_api": "}",
          "old_text": null,
          "new_text": "        }\n",
          "old_line_content": "        }",
          "new_line_content": "            secLen = data.At(i + 1).startAt - data.At(i).startAt;",
          "content_same": false
        },
        {
          "line": 1052,
          "old_api": null,
          "new_api": "At",
          "old_text": null,
          "new_text": "s.At(i + 1",
          "old_line_content": "    }",
          "new_line_content": "        ScopedMem<WCHAR> prefix(str::conv::FromPdf(data.At(i).prefix));",
          "content_same": false
        },
        {
          "line": 3102,
          "old_api": null,
          "new_api": "T, DEST_USE_DEFAULT,",
          "old_text": null,
          "new_text": "T, DEST_USE_DEFAULT, ",
          "old_line_content": "        }",
          "new_line_content": "            fz_catch(engine->ctx) { }",
          "content_same": false
        },
        {
          "line": 3103,
          "old_api": null,
          "new_api": "if (!",
          "old_text": null,
          "new_text": "\n    if (!",
          "old_line_content": "        if (link->ld.uri.is_map) {",
          "new_line_content": "            if (!str::IsEmpty(base.Get())) {",
          "content_same": false
        },
        {
          "line": 1056,
          "old_api": null,
          "new_api": "StackItem",
          "old_text": null,
          "new_text": "StackItem(",
          "old_line_content": "",
          "new_line_content": "                FormatPageLabel(data.At(i).type, data.At(i).countFrom + j, prefix);",
          "content_same": false
        },
        {
          "line": 3106,
          "old_api": null,
          "new_api": "0 || link->ld.g",
          "old_text": null,
          "new_text": "0 || link->ld.g",
          "old_line_content": "                x = (int)(pt.x - rect.x + 0.5);",
          "new_line_content": "                path = uri.StealData();",
          "content_same": false
        },
        {
          "line": 1065,
          "old_api": null,
          "new_api": "ckItem> sta",
          "old_text": null,
          "new_text": "ckItem> sta",
          "old_line_content": "            ScopedMem<WCHAR> unique;",
          "new_line_content": "    dups.Sort();",
          "content_same": false
        },
        {
          "line": 1066,
          "old_api": null,
          "new_api": "pdf_dict_get",
          "old_text": null,
          "new_text": "pdf_dict_get",
          "old_line_content": "            do {",
          "new_line_content": "    for (size_t i = 1; i < dups.Count(); i++) {",
          "content_same": false
        },
        {
          "line": 3115,
          "old_api": null,
          "new_api": "_point",
          "old_text": null,
          "new_text": "_point(&rb, &page->ctm);\n\n    if ((l",
          "old_line_content": "        // note: we (intentionally) don't support the /Win specific Launch parameters",
          "new_line_content": "            ScopedMem<WCHAR> uri(str::Format(L\"%s?%d,%d\", path, x, y));",
          "content_same": false
        },
        {
          "line": 3116,
          "old_api": null,
          "new_api": "ags & fz_l",
          "old_text": null,
          "new_text": "ags & fz_l",
          "old_line_content": "        if (link->ld.launch.file_spec)",
          "new_line_content": "            free(path);",
          "content_same": false
        },
        {
          "line": 1070,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "          ",
          "old_line_content": "        }",
          "new_line_content": "        while ((ix = labels->Find(dups.At(i), ix + 1)) != -1) {",
          "content_same": false
        },
        {
          "line": 1073,
          "old_api": null,
          "new_api": "t_page_no)",
          "old_text": null,
          "new_text": "t_page_no)",
          "old_line_content": "",
          "new_line_content": "                unique.Set(str::Format(L\"%s.%d\", dups.At(i), ++counter));",
          "content_same": false
        },
        {
          "line": 1074,
          "old_api": null,
          "new_api": "xt_page_no;",
          "old_text": null,
          "new_text": "xt_page_no;\n            ",
          "old_line_content": "    return labels;",
          "new_line_content": "            } while (labels->Contains(unique));",
          "content_same": false
        },
        {
          "line": 1075,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "              ",
          "old_line_content": "}",
          "new_line_content": "            str::ReplacePtr(&labels->At(ix), unique);",
          "content_same": false
        },
        {
          "line": 3123,
          "old_api": null,
          "new_api": "z_link_flag_t_valid))\n            result.y = l",
          "old_text": null,
          "new_text": "z_link_flag_t_valid))\n            result.y = l",
          "old_line_content": "        break;",
          "new_line_content": "            path = str::conv::FromUtf8(link->ld.launch.file_spec);",
          "content_same": false
        },
        {
          "line": 1077,
          "old_api": null,
          "new_api": "p",
          "old_text": null,
          "new_text": "\n            p",
          "old_line_content": "struct PageTreeStackItem {",
          "new_line_content": "        for (; i + 1 < dups.Count() && str::Eq(dups.At(i), dups.At(i + 1)); i++);",
          "content_same": false
        },
        {
          "line": 3124,
          "old_api": null,
          "new_api": "if ((link->ld.gotor.flags & (",
          "old_text": null,
          "new_text": "if ((link->ld.gotor.flags & (",
          "old_line_content": "    case FZ_LINK_GOTOR:",
          "new_line_content": "        if (path && link->ld.launch.embedded_num && str::EndsWithI(path, L\".pdf\")) {",
          "content_same": false
        },
        {
          "line": 3125,
          "old_api": null,
          "new_api": "h | fz_lin",
          "old_text": null,
          "new_text": "h | fz_lin",
          "old_line_content": "        if (link->ld.gotor.file_spec)",
          "new_line_content": "            free(path);",
          "content_same": false
        },
        {
          "line": 3132,
          "old_api": null,
          "new_api": "rb.x, rb.y);\n        // an empty destination",
          "old_text": null,
          "new_text": "rb.x, rb.y);\n        // an empty destination ",
          "old_line_content": "",
          "new_line_content": "            path = str::conv::FromUtf8(link->ld.gotor.file_spec);",
          "content_same": false
        },
        {
          "line": 1089,
          "old_api": null,
          "new_api": "erate_br",
          "old_text": null,
          "new_text": "erate_br",
          "old_line_content": "{",
          "new_line_content": "    explicit PageTreeStackItem(pdf_obj *kids, int next_page_no=0) :",
          "content_same": false
        },
        {
          "line": 1090,
          "old_api": null,
          "new_api": "fz_throw(ctx, FZ_E",
          "old_text": null,
          "new_text": " fz_throw(ctx, FZ_E",
          "old_line_content": "    fz_context *ctx = doc->ctx;",
          "new_line_content": "        kids(kids), i(-1), len(pdf_array_len(kids)), next_page_no(next_page_no) { }",
          "content_same": false
        },
        {
          "line": 1100,
          "old_api": null,
          "new_api": "ds\")) {",
          "old_text": null,
          "new_text": "ds\")) {\n        ",
          "old_line_content": "        for (;;) {",
          "new_line_content": "    PageTreeStackItem top(pdf_dict_getp(pdf_trailer(doc), \"Root/Pages/Kids\"));",
          "content_same": false
        },
        {
          "line": 1102,
          "old_api": null,
          "new_api": "_dict_gets",
          "old_text": null,
          "new_text": "_dict_gets(kid, \"Count",
          "old_line_content": "            if (top.i == top.len) {",
          "new_line_content": "    if (pdf_mark_obj(top.kids))",
          "content_same": false
        },
        {
          "line": 3153,
          "old_api": null,
          "new_api": "ink::SaveEmbedded(",
          "old_text": null,
          "new_text": "ink::SaveEmbedded(",
          "old_line_content": "#undef HandleType",
          "new_line_content": "    HandleType(GoBack);",
          "content_same": false
        },
        {
          "line": 3154,
          "old_api": null,
          "new_api": "erUI& saveUI)\n{\n    S",
          "old_text": null,
          "new_text": "erUI& saveUI)\n{\n    S",
          "old_line_content": "#undef HandleTypeDialog",
          "new_line_content": "    HandleType(GoForward);",
          "content_same": false
        },
        {
          "line": 3155,
          "old_api": null,
          "new_api": "itSec scope(&engine->ctxAc",
          "old_text": null,
          "new_text": "itSec scope(&engine->ctxAc",
          "old_line_content": "    // named action that we don't support (or invalid action name)",
          "new_line_content": "    HandleTypeDialog(GoToPage);",
          "content_same": false
        },
        {
          "line": 3156,
          "old_api": null,
          "new_api": "return engine->Save",
          "old_text": null,
          "new_text": "    return engine->Save",
          "old_line_content": "    return Dest_None;",
          "new_line_content": "    HandleTypeDialog(Print);",
          "content_same": false
        },
        {
          "line": 1109,
          "old_api": null,
          "new_api": "if (pdf_mark_obj(top.",
          "old_text": null,
          "new_text": "   if (pdf_mark_obj(top.",
          "old_line_content": "                continue;",
          "new_line_content": "                pdf_unmark_obj(top.kids);",
          "content_same": false
        },
        {
          "line": 3157,
          "old_api": null,
          "new_api": "d",
          "old_text": null,
          "new_text": "d(saveUI, link->ld.launc",
          "old_line_content": "}",
          "new_line_content": "    HandleTypeDialog(SaveAs);",
          "content_same": false
        },
        {
          "line": 3158,
          "old_api": null,
          "new_api": "ded_num, link->ld.launch",
          "old_text": null,
          "new_text": "ded_num, link->ld.launch",
          "old_line_content": "",
          "new_line_content": "    HandleTypeDialog(ZoomTo);",
          "content_same": false
        },
        {
          "line": 1118,
          "old_api": null,
          "new_api": "}\n    }\n    fz_catch(ctx)",
          "old_text": null,
          "new_text": "    }\n    }\n    fz_catch(ctx) ",
          "old_line_content": "",
          "new_line_content": "            pdf_obj *kid = pdf_array_get(top.kids, top.i);",
          "content_same": false
        },
        {
          "line": 1120,
          "old_api": null,
          "new_api": "top.kids);\n        fz_rethrow(",
          "old_text": null,
          "new_text": "top.kids);\n        fz_rethrow(",
          "old_line_content": "                page_no++;",
          "new_line_content": "            if (str::Eq(type, \"Page\") || str::IsEmpty(type) && pdf_dict_gets(kid, \"MediaBox\")) {",
          "content_same": false
        },
        {
          "line": 3176,
          "old_api": null,
          "new_api": "Load",
          "old_text": null,
          "new_text": "gineImpl();\n    if (!engine->Load(stre",
          "old_line_content": "        return Dest_LaunchFile;",
          "new_line_content": "        return DestTypeFromName(link->ld.named.named);",
          "content_same": false
        },
        {
          "line": 1131,
          "old_api": null,
          "new_api": "1) { }\n};\n\nclas",
          "old_text": null,
          "new_text": "1) { }\n};\n\nclas",
          "old_line_content": "            }",
          "new_line_content": "                    stack.Push(top);",
          "content_same": false
        },
        {
          "line": 1132,
          "old_api": null,
          "new_api": "lass PdfEngineImpl : publi",
          "old_text": null,
          "new_text": "lass PdfEngineImpl : publi",
          "old_line_content": "            else {",
          "new_line_content": "                    top = PageTreeStackItem(pdf_dict_gets(kid, \"Kids\"), page_no + count);",
          "content_same": false
        },
        {
          "line": 1134,
          "old_api": null,
          "new_api": "dfImage;\n\npublic:",
          "old_text": null,
          "new_text": "dfImage;\n\npublic:\n    ",
          "old_line_content": "                goto tolerate_broken_page_tree;",
          "new_line_content": "                    if (pdf_mark_obj(top.kids))",
          "content_same": false
        },
        {
          "line": 1135,
          "old_api": null,
          "new_api": "l ~PdfEngineImpl();\n    virtual BaseEngine *Clone();",
          "old_text": null,
          "new_text": "l ~PdfEngineImpl();\n    virtual BaseEngine *Clone();\n",
          "old_line_content": "            }",
          "new_line_content": "                        fz_throw(ctx, FZ_ERROR_GENERIC, \"cycle in page tree\");",
          "content_same": false
        },
        {
          "line": 1145,
          "old_api": null,
          "new_api": "t_pages",
          "old_text": null,
          "new_text": "t_pages(_doc",
          "old_line_content": "}",
          "new_line_content": "        for (size_t i = 0; i < stack.Size(); i++) {",
          "content_same": false
        },
        {
          "line": 1146,
          "old_api": null,
          "new_api": "ediabox",
          "old_text": null,
          "new_text": "ediabox(int",
          "old_line_content": "",
          "new_line_content": "            pdf_unmark_obj(stack.At(i).kids);",
          "content_same": false
        },
        {
          "line": 1148,
          "old_api": null,
          "new_api": "PageContentBox",
          "old_text": null,
          "new_text": "PageContentBox(int pageN",
          "old_line_content": "",
          "new_line_content": "        pdf_unmark_obj(top.kids);",
          "content_same": false
        },
        {
          "line": 1149,
          "old_api": null,
          "new_api": "rget target=Tar",
          "old_text": null,
          "new_text": "rget target=Tar",
          "old_line_content": "struct PdfPageRun {",
          "new_line_content": "        fz_rethrow(ctx);",
          "content_same": false
        },
        {
          "line": 3204,
          "old_api": null,
          "new_api": "//schemas.openxps.o",
          "old_text": null,
          "new_text": "//schemas.openxps.o",
          "old_line_content": "    fz_point lt = link->ld.gotor.lt, rb = link->ld.gotor.rb;",
          "new_line_content": "    if (link->ld.gotor.page < 0 || link->ld.gotor.page >= engine->PageCount())",
          "content_same": false
        },
        {
          "line": 3207,
          "old_api": null,
          "new_api": "ine NS_XPS_MICROSOFT \"http://schemas.micros",
          "old_text": null,
          "new_text": "ine NS_XPS_MICROSOFT \"http://schemas.micros",
          "old_line_content": "",
          "new_line_content": "    pdf_page *page = engine->GetPdfPage(link->ld.gotor.page + 1);",
          "content_same": false
        },
        {
          "line": 3211,
          "old_api": null,
          "new_api": ">first_page;\n    for (int n = 0; n",
          "old_text": null,
          "new_text": ">first_page;\n    for (int n = 0; n ",
          "old_line_content": "            result.x = lt.x;",
          "new_line_content": "    fz_transform_point(&lt, &page->ctm);",
          "content_same": false
        },
        {
          "line": 3212,
          "old_api": null,
          "new_api": "r && page; n++)\n        page = page",
          "old_text": null,
          "new_text": "r && page; n++)\n        page = page",
          "old_line_content": "        if ((link->ld.gotor.flags & fz_link_flag_t_valid))",
          "new_line_content": "    fz_transform_point(&rb, &page->ctm);",
          "content_same": false
        },
        {
          "line": 3225,
          "old_api": null,
          "new_api": "data_size -= 3;\n    }\n\n    HtmlP",
          "old_text": null,
          "new_text": "     data_size -= 3;\n    }\n\n    HtmlP",
          "old_line_content": "        (link->ld.gotor.flags & fz_link_flag_t_valid)) {",
          "new_line_content": "        result = RectD::FromXY(lt.x, lt.y, rb.x, rb.y);",
          "content_same": false
        },
        {
          "line": 3227,
          "old_api": null,
          "new_api": "if (tok && tok",
          "old_text": null,
          "new_text": "  if (tok && tok",
          "old_line_content": "        result.y = lt.y;",
          "new_line_content": "        if (result.IsEmpty())",
          "content_same": false
        },
        {
          "line": 1186,
          "old_api": null,
          "new_api": "return SaveFileAs",
          "old_text": null,
          "new_text": "    return SaveFileAs",
          "old_line_content": "    virtual RenderedBitmap *RenderBitmap(int pageNo, float zoom, int rotation,",
          "new_line_content": "        return _doc ? pdf_count_pages(_doc) : 0;",
          "content_same": false
        },
        {
          "line": 1197,
          "old_api": null,
          "new_api": "n pdf_has_permissi",
          "old_text": null,
          "new_text": "n pdf_has_permissi",
          "old_line_content": "    virtual unsigned char *GetFileData(size_t *cbCount);",
          "new_line_content": "        return RenderPage(hDC, GetPdfPage(pageNo), screenRect, NULL, zoom, rotation, pageRect, target, cookie_out);",
          "content_same": false
        },
        {
          "line": 1206,
          "old_api": null,
          "new_api": "virtual DocTocItem *GetTocTree();\n\n    vi",
          "old_text": null,
          "new_text": " virtual DocTocItem *GetTocTree();\n\n    vi",
          "old_line_content": "    virtual WCHAR *GetProperty(DocumentProperty prop);",
          "new_line_content": "        return SaveFileAs(pdfFileName, includeUserAnnots);",
          "content_same": false
        },
        {
          "line": 3255,
          "old_api": null,
          "new_api": "tx);\n    }\n\n    return root;",
          "old_text": null,
          "new_text": "tx);\n    }\n\n    return root;\n",
          "old_line_content": "",
          "new_line_content": "    if (!engine || !fileName || !engine->Load(fileName, pwdUI)) {",
          "content_same": false
        },
        {
          "line": 3265,
          "old_api": null,
          "new_api": "content for property %s\", f",
          "old_text": null,
          "new_text": "content for property %s\", f",
          "old_line_content": "",
          "new_line_content": "    if (!engine->Load(stream, pwdUI)) {",
          "content_same": false
        },
        {
          "line": 1218,
          "old_api": null,
          "new_api": "ected;\n\n    // make sure to never ask fo",
          "old_text": null,
          "new_text": "ected;\n\n    // make sure to never ask fo",
          "old_line_content": "    virtual float GetFileDPI() const { return 72.0f; }",
          "new_line_content": "        return pdf_has_permission(_doc, PDF_PERM_PRINT);",
          "content_same": false
        },
        {
          "line": 1227,
          "old_api": null,
          "new_api": "bool",
          "old_text": null,
          "new_text": "\n    bool         ",
          "old_line_content": "    virtual bool HasTocTree() const {",
          "new_line_content": "    virtual bool BenchLoadPage(int pageNo) { return GetPdfPage(pageNo) != NULL; }",
          "content_same": false
        },
        {
          "line": 3278,
          "old_api": null,
          "new_api": "str::conv::FromHtmlUtf8(start, end - start);",
          "old_text": null,
          "new_text": "str::conv::FromHtmlUtf8(start, end - start);\n",
          "old_line_content": "        return false;",
          "new_line_content": "        file::ReadN(fileName, header, sizeof(header));",
          "content_same": false
        },
        {
          "line": 3287,
          "old_api": null,
          "new_api": "els/.rels\");\n\n    if (!r",
          "old_text": null,
          "new_text": "els/.rels\");\n\n    if (!r",
          "old_line_content": "}",
          "new_line_content": "    return str::EndsWithI(fileName, L\".pdf\") || findEmbedMarks(fileName);",
          "content_same": false
        },
        {
          "line": 3292,
          "old_api": null,
          "new_api": "fz_throw(doc->ctx, FZ_ERROR_GENERIC, \"c",
          "old_text": null,
          "new_text": "       fz_throw(doc->ctx, FZ_ERROR_GENERIC, \"c",
          "old_line_content": "}",
          "new_line_content": "    return PdfEngineImpl::CreateFromFile(fileName, pwdUI);",
          "content_same": false
        },
        {
          "line": 3297,
          "old_api": null,
          "new_api": "fz_xml *item = fz_xml_down(root); item; item =",
          "old_text": null,
          "new_text": "fz_xml *item = fz_xml_down(root); item; item =",
          "old_line_content": "",
          "new_line_content": "    return PdfEngineImpl::CreateFromStream(stream, pwdUI);",
          "content_same": false
        },
        {
          "line": 3318,
          "old_api": null,
          "new_api": "_root) {\n        fz_free_xml(d",
          "old_text": null,
          "new_text": "_root) {\n        fz_free_xml(d",
          "old_line_content": "",
          "new_line_content": "    xps_part *part = page ? xps_read_part(doc, page->name) : NULL;",
          "content_same": false
        },
        {
          "line": 1273,
          "old_api": null,
          "new_api": "ortCookie *cookie=NU",
          "old_text": null,
          "new_text": "ortCookie *cookie=NU",
          "old_line_content": "    }",
          "new_line_content": "        const fz_rect tmpRc = fz_RectD_to_rect(PageMediabox(pageNo));",
          "content_same": false
        },
        {
          "line": 1274,
          "old_api": null,
          "new_api": "DropPageRun(PdfPageRun *run, bool fo",
          "old_text": null,
          "new_text": "      DropPageRun(PdfPageRun *run, bool fo",
          "old_line_content": "    bool            RenderPage(HDC hDC, pdf_page *page, RectI screenRect,",
          "new_line_content": "        return fz_create_view_ctm(&tmpRc, zoom, rotation);",
          "content_same": false
        },
        {
          "line": 1278,
          "old_api": null,
          "new_api": "e);\n    pdf_annot    ** Proces",
          "old_text": null,
          "new_text": "e);\n    pdf_annot    ** Proces",
          "old_line_content": "    WCHAR         * ExtractPageText(pdf_page *page, WCHAR *lineSep, RectI **coords_out=NULL,",
          "new_line_content": "        return fz_create_view_ctm(pdf_bound_page(_doc, page, &r), zoom, rotation);",
          "content_same": false
        },
        {
          "line": 3331,
          "old_api": null,
          "new_api": "*\"dc:\"*/\"creator\") && !props->au",
          "old_text": null,
          "new_text": "*\"dc:\"*/\"creator\") && !props->au",
          "old_line_content": "        data += 3;",
          "new_line_content": "    if (str::StartsWith(data, UTF16_BOM)) {",
          "content_same": false
        },
        {
          "line": 3332,
          "old_api": null,
          "new_api": "Set",
          "old_text": null,
          "new_text": "uthor.Set(xps_get_core_prop(doc->ctx, item));\n        else if (str::Eq",
          "old_line_content": "        data_size -= 3;",
          "new_line_content": "        dataUtf8.Set(str::conv::ToUtf8((const WCHAR *)(part->data + 2), part->size / 2 - 1));",
          "content_same": false
        },
        {
          "line": 3334,
          "old_api": null,
          "new_api": "subject)",
          "old_text": null,
          "new_text": "subject)\n         ",
          "old_line_content": "",
          "new_line_content": "        data_size = str::Len(dataUtf8);",
          "content_same": false
        },
        {
          "line": 3345,
          "old_api": null,
          "new_api": "Set",
          "old_text": null,
          "new_text": "    props->modification_date.Set(xps_get_core_p",
          "old_line_content": "    }",
          "new_line_content": "        AttrInfo *attr = tok->GetAttrByNameNS(\"Width\", NS_XPS_MICROSOFT);",
          "content_same": false
        },
        {
          "line": 3348,
          "old_api": null,
          "new_api": "is also based on Fitz and shares quite some cod",
          "old_text": null,
          "new_text": " is also based on Fitz and shares quite some cod",
          "old_line_content": "",
          "new_line_content": "        attr = tok->GetAttrByNameNS(\"Height\", NS_XPS_MICROSOFT);",
          "content_same": false
        },
        {
          "line": 3350,
          "old_api": null,
          "new_api": "xps_page *page;",
          "old_text": null,
          "new_text": "  xps_page *page;\n",
          "old_line_content": "}",
          "new_line_content": "            bounds.y1 = fz_atof(attr->val) * 72.0f / 96.0f;",
          "content_same": false
        },
        {
          "line": 3353,
          "old_api": null,
          "new_api": "ize_t size_est;\n    int",
          "old_text": null,
          "new_text": "ize_t size_est;\n    int ",
          "old_line_content": "public:",
          "new_line_content": "    xps_free_part(doc, part);",
          "content_same": false
        },
        {
          "line": 1327,
          "old_api": null,
          "new_api": "AR *title, PdfLink lin",
          "old_text": null,
          "new_text": "AR *title, PdfLink lin",
          "old_line_content": "    virtual PageElementType GetType() const { return Element_Link; }",
          "new_line_content": "        engine(engine), link(link), rect(fz_rect_to_RectD(rect)), pageNo(pageNo) {",
          "content_same": false
        },
        {
          "line": 3376,
          "old_api": null,
          "new_api": "ps_count_pages",
          "old_text": null,
          "new_text": "ps_count_pages(_doc",
          "old_line_content": "",
          "new_line_content": "    fz_always(doc->ctx) {",
          "content_same": false
        },
        {
          "line": 3377,
          "old_api": null,
          "new_api": "virtual RectD Page",
          "old_text": null,
          "new_text": "\n\n    virtual RectD Page",
          "old_line_content": "    return root;",
          "new_line_content": "        xps_free_part(doc, part);",
          "content_same": false
        },
        {
          "line": 1330,
          "old_api": null,
          "new_api": "age : public PageEle",
          "old_text": null,
          "new_text": "age : public PageEle",
          "old_line_content": "    virtual WCHAR *GetValue() const;",
          "new_line_content": "            this->pt = PointD(pt->x, pt->y);",
          "content_same": false
        },
        {
          "line": 3379,
          "old_api": null,
          "new_api": "ageNo);\n    virtua",
          "old_text": null,
          "new_text": "ageNo);\n    virtua",
          "old_line_content": "",
          "new_line_content": "    fz_catch(doc->ctx) {",
          "content_same": false
        },
        {
          "line": 3380,
          "old_api": null,
          "new_api": "ContentBox",
          "old_text": null,
          "new_text": "ContentBox(int pageN",
          "old_line_content": "static WCHAR *",
          "new_line_content": "        fz_rethrow(doc->ctx);",
          "content_same": false
        },
        {
          "line": 3389,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "                 ",
          "old_line_content": "        return NULL;",
          "new_line_content": "    fz_xml *text = fz_xml_down(item);",
          "content_same": false
        },
        {
          "line": 1342,
          "old_api": null,
          "new_api": "GetValue",
          "old_text": null,
          "new_text": "GetValue()",
          "old_line_content": "class PdfComment : public PageElement {",
          "new_line_content": "    virtual WCHAR *GetDestValue() const { return GetValue(); }",
          "content_same": false
        },
        {
          "line": 3399,
          "old_api": null,
          "new_api": "R",
          "old_text": null,
          "new_text": "                R",
          "old_line_content": "#define REL_CORE_PROPERTIES \\",
          "new_line_content": "    for (start = fz_xml_text(text); str::IsWs(*start); start++);",
          "content_same": false
        },
        {
          "line": 3400,
          "old_api": null,
          "new_api": "**cookie_out=NULL) {",
          "old_text": null,
          "new_text": "**cookie_out=NULL) {\n",
          "old_line_content": "    \"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties\"",
          "new_line_content": "    for (end = start + strlen(start); end > start && str::IsWs(*(end - 1)); end--);",
          "content_same": false
        },
        {
          "line": 3402,
          "old_api": null,
          "new_api": "e",
          "old_text": null,
          "new_text": "e(hDC, GetXpsPage(pageNo), screenRect, NULL",
          "old_line_content": "xps_doc_props *",
          "new_line_content": "    return str::conv::FromHtmlUtf8(start, end - start);",
          "content_same": false
        },
        {
          "line": 1355,
          "old_api": null,
          "new_api": "e),\n    pageAnnot",
          "old_text": null,
          "new_text": "e),\n    pageAnnot",
          "old_line_content": "};",
          "new_line_content": "        content(str::Dup(content)) { }",
          "content_same": false
        },
        {
          "line": 1360,
          "old_api": null,
          "new_api": "ctx = fz_new_",
          "old_text": null,
          "new_text": "    ctx = fz_new_",
          "old_line_content": "public:",
          "new_line_content": "    virtual WCHAR *GetValue() const { return str::Dup(content); }",
          "content_same": false
        },
        {
          "line": 3411,
          "old_api": null,
          "new_api": "rotation, bool inverse=false);\n\n    vir",
          "old_text": null,
          "new_text": "rotation, bool inverse=false);\n\n    vir",
          "old_line_content": "",
          "new_line_content": "    fz_xml *root = xps_open_and_parse(doc, \"/_rels/.rels\");",
          "content_same": false
        },
        {
          "line": 3420,
          "old_api": null,
          "new_api": "e",
          "old_text": null,
          "new_text": "e(pageNo), lineS",
          "old_line_content": "            has_correct_root = true;",
          "new_line_content": "        if (str::Eq(fz_xml_tag(item), \"Relationship\") &&",
          "content_same": false
        },
        {
          "line": 3421,
          "old_api": null,
          "new_api": "*GetProperty(DocumentPrope",
          "old_text": null,
          "new_text": "*GetProperty(DocumentPrope",
          "old_line_content": "            break;",
          "new_line_content": "            str::Eq(fz_xml_att(item, \"Type\"), REL_CORE_PROPERTIES) && fz_xml_att(item, \"Target\")) {",
          "content_same": false
        },
        {
          "line": 3423,
          "old_api": null,
          "new_api": "serAnnotati",
          "old_text": null,
          "new_text": "serAnnotati",
          "old_line_content": "    }",
          "new_line_content": "            xps_resolve_url(path, \"\", fz_xml_att(item, \"Target\"), nelem(path));",
          "content_same": false
        },
        {
          "line": 3424,
          "old_api": null,
          "new_api": "tation> *list);\n\n    virtua",
          "old_text": null,
          "new_text": "tation> *list);\n\n    virtua",
          "old_line_content": "",
          "new_line_content": "            fz_free_xml(doc->ctx, root);",
          "content_same": false
        },
        {
          "line": 3425,
          "old_api": null,
          "new_api": "onst { return 72.0f; }\n    vi",
          "old_text": null,
          "new_text": "onst { return 72.0f; }\n    vi",
          "old_line_content": "    if (!has_correct_root) {",
          "new_line_content": "            root = xps_open_and_parse(doc, path);",
          "content_same": false
        },
        {
          "line": 1380,
          "old_api": null,
          "new_api": "}\n        free",
          "old_text": null,
          "new_text": "        }\n        free",
          "old_line_content": "",
          "new_line_content": "        engine(engine), pageNo(pageNo), rect(fz_rect_to_RectD(rect)), imageIx(imageIx) { }",
          "content_same": false
        },
        {
          "line": 1388,
          "old_api": null,
          "new_api": "geCount",
          "old_text": null,
          "new_text": "geCount(); i++) {\n            free(imageRec",
          "old_line_content": "    outline(NULL), attachments(NULL), _pagelabels(NULL),",
          "new_line_content": "        return engine->GetPageImage(pageNo, rect, imageIx);",
          "content_same": false
        },
        {
          "line": 3443,
          "old_api": null,
          "new_api": "R *_fileName;",
          "old_text": null,
          "new_text": "R *_fileName;\n\n ",
          "old_line_content": "    }",
          "new_line_content": "        else if (str::Eq(fz_xml_tag(item), /*\"dc:\"*/\"subject\") && !props->subject)",
          "content_same": false
        },
        {
          "line": 3445,
          "old_api": null,
          "new_api": "_SECTION ctxAcce",
          "old_text": null,
          "new_text": "_SECTION ctxAcce",
          "old_line_content": "",
          "new_line_content": "        else if (str::Eq(fz_xml_tag(item), /*\"dcterms:\"*/\"created\") && !props->creation_date)",
          "content_same": false
        },
        {
          "line": 3446,
          "old_api": null,
          "new_api": "CRITICAL_SECTION _pagesAccess",
          "old_text": null,
          "new_text": "    CRITICAL_SECTION _pagesAccess",
          "old_line_content": "    return props;",
          "new_line_content": "            props->creation_date.Set(xps_get_core_prop(doc->ctx, item));",
          "content_same": false
        },
        {
          "line": 1399,
          "old_api": null,
          "new_api": "ee",
          "old_text": null,
          "new_text": "ee(_decryptionKey);\n\n    LeaveCritica",
          "old_line_content": "",
          "new_line_content": "    InitializeCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 3447,
          "old_api": null,
          "new_api": "bool",
          "old_text": null,
          "new_text": "\n\n    bool      ",
          "old_line_content": "}",
          "new_line_content": "        else if (str::Eq(fz_xml_tag(item), /*\"dcterms:\"*/\"modified\") && !props->modification_date)",
          "content_same": false
        },
        {
          "line": 3448,
          "old_api": null,
          "new_api": "ad",
          "old_text": null,
          "new_text": "ad(fz_stream *stm);\n    bool     ",
          "old_line_content": "",
          "new_line_content": "            props->modification_date.Set(xps_get_core_prop(doc->ctx, item));",
          "content_same": false
        },
        {
          "line": 3450,
          "old_api": null,
          "new_api": "Stream",
          "old_text": null,
          "new_text": "Stream(fz_stream *stm);\n\n  ",
          "old_line_content": "",
          "new_line_content": "    fz_free_xml(doc->ctx, root);",
          "content_same": false
        },
        {
          "line": 1404,
          "old_api": null,
          "new_api": "lass PasswordCloner : public PasswordUI {\n    unsigned",
          "old_text": null,
          "new_text": "lass PasswordCloner : public PasswordUI {\n    unsigned ",
          "old_line_content": "PdfEngineImpl::~PdfEngineImpl()",
          "new_line_content": "    ctx = fz_new_context(NULL, &fz_locks_ctx, MAX_CONTEXT_MEMORY);",
          "content_same": false
        },
        {
          "line": 1412,
          "old_api": null,
          "new_api": "l WCHAR * GetPassword(const WCHAR",
          "old_text": null,
          "new_text": "l WCHAR * GetPassword(const WCHAR ",
          "old_line_content": "        }",
          "new_line_content": "    EnterCriticalSection(&pagesAccess);",
          "content_same": false
        },
        {
          "line": 1425,
          "old_api": null,
          "new_api": "encryption key",
          "old_text": null,
          "new_text": "encryption key ",
          "old_line_content": "",
          "new_line_content": "        free(_pageObjs);",
          "content_same": false
        },
        {
          "line": 1429,
          "old_api": null,
          "new_api": "= NULL;\n    if (pdf_crypt_key(_d",
          "old_text": null,
          "new_text": " = NULL;\n    if (pdf_crypt_key(_d",
          "old_line_content": "        }",
          "new_line_content": "    fz_free_outline(ctx, attachments);",
          "content_same": false
        },
        {
          "line": 3480,
          "old_api": null,
          "new_api": "ie_out);\n    WCHAR",
          "old_text": null,
          "new_text": "ie_out);\n    WCHAR   ",
          "old_line_content": "    virtual RenderedBitmap *RenderBitmap(int pageNo, float zoom, int rotation,",
          "new_line_content": "        return _doc ? xps_count_pages(_doc) : 0;",
          "content_same": false
        },
        {
          "line": 1442,
          "old_api": null,
          "new_api": "(!_decryptionKey",
          "old_text": null,
          "new_text": "(!_decryptionKey",
          "old_line_content": "    }",
          "new_line_content": "        free(imageRects);",
          "content_same": false
        },
        {
          "line": 3491,
          "old_api": null,
          "new_api": "ceRemove=false);",
          "old_text": null,
          "new_text": "ceRemove=false);\n\n",
          "old_line_content": "    virtual unsigned char *GetFileData(size_t *cbCount);",
          "new_line_content": "        return RenderPage(hDC, GetXpsPage(pageNo), screenRect, NULL, zoom, rotation, pageRect, cookie_out);",
          "content_same": false
        },
        {
          "line": 1445,
          "old_api": null,
          "new_api": "delete clone",
          "old_text": null,
          "new_text": "    delete clone",
          "old_line_content": "    _doc = NULL;",
          "new_line_content": "    while (runCache.Count() > 0) {",
          "content_same": false
        },
        {
          "line": 1447,
          "old_api": null,
          "new_api": "UpdateUserAnnot",
          "old_text": null,
          "new_text": "UpdateUserAnnot",
          "old_line_content": "    ctx = NULL;",
          "new_line_content": "        DropPageRun(runCache.Last(), true);",
          "content_same": false
        },
        {
          "line": 1450,
          "old_api": null,
          "new_api": "return clone;\n}\n\nstat",
          "old_text": null,
          "new_text": "   return clone;\n}\n\nstat",
          "old_line_content": "    delete _pagelabels;",
          "new_line_content": "    pdf_close_document(_doc);",
          "content_same": false
        },
        {
          "line": 3501,
          "old_api": null,
          "new_api": "nk",
          "old_text": null,
          "new_text": "nk() : engine(NULL",
          "old_line_content": "    virtual void UpdateUserAnnotations(Vec<PageAnnotation> *list);",
          "new_line_content": "        return ExtractPageText(GetXpsPage(pageNo), lineSep, coords_out);",
          "content_same": false
        },
        {
          "line": 1458,
          "old_api": null,
          "new_api": "fileName + str::Len",
          "old_text": null,
          "new_text": " fileName + str::Len",
          "old_line_content": "}",
          "new_line_content": "    free(_decryptionKey);",
          "content_same": false
        },
        {
          "line": 1460,
          "old_api": null,
          "new_api": ") - 1; c > fileName; c--) {",
          "old_text": null,
          "new_text": ") - 1; c > fileName; c--) {\n    ",
          "old_line_content": "class PasswordCloner : public PasswordUI {",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 1461,
          "old_api": null,
          "new_api": "(*c == ':') {\n            if (!st",
          "old_text": null,
          "new_text": "(*c == ':') {\n            if (!st",
          "old_line_content": "    unsigned char *cryptKey;",
          "new_line_content": "    DeleteCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 1462,
          "old_api": null,
          "new_api": "git",
          "old_text": null,
          "new_text": "git(*(c + 1)))\n                bre",
          "old_line_content": "",
          "new_line_content": "    LeaveCriticalSection(&pagesAccess);",
          "content_same": false
        },
        {
          "line": 1463,
          "old_api": null,
          "new_api": "if (++colonCount % 2 == 0)",
          "old_text": null,
          "new_text": "         if (++colonCount % 2 == 0)",
          "old_line_content": "public:",
          "new_line_content": "    DeleteCriticalSection(&pagesAccess);",
          "content_same": false
        },
        {
          "line": 3512,
          "old_api": null,
          "new_api": "= link->kind)",
          "old_text": null,
          "new_text": "= link->kind)\n    ",
          "old_line_content": "    virtual bool HasTocTree() const { return _outline != NULL; }",
          "new_line_content": "    virtual bool BenchLoadPage(int pageNo) { return GetXpsPage(pageNo) != NULL; }",
          "content_same": false
        },
        {
          "line": 1470,
          "old_api": null,
          "new_api": "}",
          "old_text": null,
          "new_text": "\n    }\n\n",
          "old_line_content": "        return NULL;",
          "new_line_content": "    explicit PasswordCloner(unsigned char *cryptKey) : cryptKey(cryptKey) { }",
          "content_same": false
        },
        {
          "line": 1474,
          "old_api": null,
          "new_api": "LL;\n    // File names ending in :<digi",
          "old_text": null,
          "new_text": "LL;\n    // File names ending in :<digi",
          "old_line_content": "BaseEngine *PdfEngineImpl::Clone()",
          "new_line_content": "        memcpy(decryptionKeyOut, cryptKey, 32);",
          "content_same": false
        },
        {
          "line": 1486,
          "old_api": null,
          "new_api": "file = fz_",
          "old_text": null,
          "new_text": "\n        file = fz_",
          "old_line_content": "        delete pwdUI;",
          "new_line_content": "    if (pdf_crypt_key(_doc))",
          "content_same": false
        },
        {
          "line": 1487,
          "old_api": null,
          "new_api": "fz_catch",
          "old_text": null,
          "new_text": "fz_catch(ctx) {\n   ",
          "old_line_content": "        return NULL;",
          "new_line_content": "        pwdUI = new PasswordCloner(pdf_crypt_key(_doc));",
          "content_same": false
        },
        {
          "line": 1490,
          "old_api": null,
          "new_api": "pwdUI))\n        return false;",
          "old_text": null,
          "new_text": " pwdUI))\n        return false;",
          "old_line_content": "",
          "new_line_content": "    if (!clone || !(_fileName ? clone->Load(_fileName, pwdUI) : clone->Load(_doc->file, pwdUI))) {",
          "content_same": false
        },
        {
          "line": 3547,
          "old_api": null,
          "new_api": "public:\n    XpsImag",
          "old_text": null,
          "new_text": "\npublic:\n    XpsImag",
          "old_line_content": "    }",
          "new_line_content": "        const fz_rect tmpRect = fz_RectD_to_rect(PageMediabox(pageNo));",
          "content_same": false
        },
        {
          "line": 3548,
          "old_api": null,
          "new_api": "gine, int pageNo, fz_rect rect, size_t image",
          "old_text": null,
          "new_text": "gine, int pageNo, fz_rect rect, size_t image",
          "old_line_content": "    bool            RenderPage(HDC hDC, xps_page *page, RectI screenRect,",
          "new_line_content": "        return fz_create_view_ctm(&tmpRect, zoom, rotation);",
          "content_same": false
        },
        {
          "line": 1502,
          "old_api": null,
          "new_api": "))\n        return false;\n\n    fz_buffer *",
          "old_text": null,
          "new_text": "))\n        return false;\n\n    fz_buffer *",
          "old_line_content": "{",
          "new_line_content": "    clone->UpdateUserAnnotations(&userAnnots);",
          "content_same": false
        },
        {
          "line": 3552,
          "old_api": null,
          "new_api": "onst { return Element_Image; }",
          "old_text": null,
          "new_text": "onst { return Element_Image; }",
          "old_line_content": "                                    RectI **coords_out=NULL, bool cacheRun=false);",
          "new_line_content": "        return fz_create_view_ctm(xps_bound_page(_doc, page, &r), zoom, rotation);",
          "content_same": false
        },
        {
          "line": 1512,
          "old_api": null,
          "new_api": "ffer",
          "old_text": null,
          "new_text": "ffer(ctx, buffer);",
          "old_line_content": "        }",
          "new_line_content": "    for (const WCHAR *c = fileName + str::Len(fileName) - 1; c > fileName; c--) {",
          "content_same": false
        },
        {
          "line": 1514,
          "old_api": null,
          "new_api": "ocument",
          "old_text": null,
          "new_text": "ocument(_doc);\n    _do",
          "old_line_content": "            break;",
          "new_line_content": "            if (!str::IsDigit(*(c + 1)))",
          "content_same": false
        },
        {
          "line": 1519,
          "old_api": null,
          "new_api": "!_doc && ctx);",
          "old_text": null,
          "new_text": "!_doc && ctx);\n ",
          "old_line_content": "",
          "new_line_content": "        else if (!str::IsDigit(*c))",
          "content_same": false
        },
        {
          "line": 1528,
          "old_api": null,
          "new_api": "z_catch",
          "old_text": null,
          "new_text": "z_catch(ctx) {\n        return fals",
          "old_line_content": "    // File names ending in :<digits>:<digits> are interpreted as containing",
          "new_line_content": "    assert(!_fileName && !_doc && ctx);",
          "content_same": false
        },
        {
          "line": 1529,
          "old_api": null,
          "new_api": "oadFromStream",
          "old_text": null,
          "new_text": "oadFromStream(stm,",
          "old_line_content": "    // embedded PDF documents (the digits are :<num>:<gen> of the embedded file stream)",
          "new_line_content": "    _fileName = str::Dup(fileName);",
          "content_same": false
        },
        {
          "line": 1536,
          "old_api": null,
          "new_api": "return false;",
          "old_text": null,
          "new_text": "        return false;\n   ",
          "old_line_content": "    fz_catch(ctx) {",
          "new_line_content": "    WCHAR *embedMarks = (WCHAR *)findEmbedMarks(_fileName);",
          "content_same": false
        },
        {
          "line": 1540,
          "old_api": null,
          "new_api": ");\n}\n\nbool PdfEngineImpl::Loa",
          "old_text": null,
          "new_text": ");\n}\n\nbool PdfEngineImpl::Loa",
          "old_line_content": "        *embedMarks = ':';",
          "new_line_content": "        file = fz_open_file2(ctx, _fileName);",
          "content_same": false
        },
        {
          "line": 3590,
          "old_api": null,
          "new_api": "Load",
          "old_text": null,
          "new_text": "Load(_doc->file))) {\n ",
          "old_line_content": "        if (link && FZ_LINK_URI == link->kind)",
          "new_line_content": "        engine(engine), link(link), rect(fz_rect_to_RectD(rect)), pageNo(pageNo) { }",
          "content_same": false
        },
        {
          "line": 1549,
          "old_api": null,
          "new_api": "th_stream",
          "old_text": null,
          "new_text": "th_stream(ctx, stm);\n    }\n",
          "old_line_content": "    int num, gen;",
          "new_line_content": "    if (!LoadFromStream(file, pwdUI))",
          "content_same": false
        },
        {
          "line": 3597,
          "old_api": null,
          "new_api": ":Exists(_fileName)) {\n        // load",
          "old_text": null,
          "new_text": ":Exists(_fileName)) {\n        // load",
          "old_line_content": "        if (!link)",
          "new_line_content": "            return str::conv::FromUtf8(link->ld.uri.uri);",
          "content_same": false
        },
        {
          "line": 1553,
          "old_api": null,
          "new_api": "return false;",
          "old_text": null,
          "new_text": "return false;\n ",
          "old_line_content": "        return false;",
          "new_line_content": "        return FinishLoading();",
          "content_same": false
        },
        {
          "line": 1557,
          "old_api": null,
          "new_api": "!pwdUI)\n        re",
          "old_text": null,
          "new_text": "!pwdUI)\n        re",
          "old_line_content": "    fz_try(ctx) {",
          "new_line_content": "    assert(embedMarks);",
          "content_same": false
        },
        {
          "line": 1564,
          "old_api": null,
          "new_api": "edMem<WCHAR> pwd(pwdUI->GetPass",
          "old_text": null,
          "new_text": "edMem<WCHAR> pwd(pwdUI->GetPass",
          "old_line_content": "    fz_catch(ctx) {",
          "new_line_content": "        buffer = pdf_load_stream(_doc, num, gen);",
          "content_same": false
        },
        {
          "line": 1565,
          "old_api": null,
          "new_api": "gest, pdf_crypt_key(_doc),",
          "old_text": null,
          "new_text": "gest, pdf_crypt_key(_doc), ",
          "old_line_content": "        return false;",
          "new_line_content": "        file = fz_open_buffer(ctx, buffer);",
          "content_same": false
        },
        {
          "line": 3618,
          "old_api": null,
          "new_api": "bool XpsEngineImpl::Load(fz_stream *stm)\n{\n    assert(!_fileName && !_doc &",
          "old_text": null,
          "new_text": "\n\nbool XpsEngineImpl::Load(fz_stream *stm)\n{\n    assert(!_fileName && !_doc &",
          "old_line_content": "class XpsTocItem : public DocTocItem {",
          "new_line_content": "            return RectD(DEST_USE_DEFAULT, DEST_USE_DEFAULT, DEST_USE_DEFAULT, DEST_USE_DEFAULT);",
          "content_same": false
        },
        {
          "line": 3619,
          "old_api": null,
          "new_api": "n false;\n\n    fz_try(ctx) {\n        stm =",
          "old_text": null,
          "new_text": "n false;\n\n    fz_try(ctx) {\n        stm =",
          "old_line_content": "    XpsLink link;",
          "new_line_content": "        return fz_rect_to_RectD(engine->FindDestRect(link->ld.gotor.dest));",
          "content_same": false
        },
        {
          "line": 3621,
          "old_api": null,
          "new_api": "return f",
          "old_text": null,
          "new_text": "  return f",
          "old_line_content": "public:",
          "new_line_content": "    virtual WCHAR *GetDestValue() const { return GetValue(); }",
          "content_same": false
        },
        {
          "line": 1574,
          "old_api": null,
          "new_api": "break;\n        }",
          "old_text": null,
          "new_text": "        break;\n        }",
          "old_line_content": "bool PdfEngineImpl::Load(IStream *stream, PasswordUI *pwdUI)",
          "new_line_content": "    pdf_close_document(_doc);",
          "content_same": false
        },
        {
          "line": 1588,
          "old_api": null,
          "new_api": "for crypt revisions 5 and a",
          "old_text": null,
          "new_text": " for crypt revisions 5 and a",
          "old_line_content": "        return false;",
          "new_line_content": "        stm = fz_open_istream(ctx, stream);",
          "content_same": false
        },
        {
          "line": 1593,
          "old_api": null,
          "new_api": "ODO: this is only part of",
          "old_text": null,
          "new_text": "ODO: this is only part of ",
          "old_line_content": "{",
          "new_line_content": "    if (!LoadFromStream(stm, pwdUI))",
          "content_same": false
        },
        {
          "line": 3641,
          "old_api": null,
          "new_api": "= AllocArray<RectD>(Pa",
          "old_text": null,
          "new_text": "= AllocArray<RectD>(Pa",
          "old_line_content": "",
          "new_line_content": "        engine(engine), pageNo(pageNo), rect(fz_rect_to_RectD(rect)), imageIx(imageIx) { }",
          "content_same": false
        },
        {
          "line": 1595,
          "old_api": null,
          "new_api": "eString",
          "old_text": null,
          "new_text": "eString(pwd, 5 ",
          "old_line_content": "    if (!ctx)",
          "new_line_content": "    return FinishLoading();",
          "content_same": false
        },
        {
          "line": 1600,
          "old_api": null,
          "new_api": "(str::conv::ToUtf8(pwd));",
          "old_text": null,
          "new_text": "(str::conv::ToUtf8(pwd));\n        ",
          "old_line_content": "    }",
          "new_line_content": "    assert(!_fileName && !_doc && ctx);",
          "content_same": false
        },
        {
          "line": 3649,
          "old_api": null,
          "new_api": "tract_doc_props",
          "old_text": null,
          "new_text": "tract_doc_props(_doc);\n    }\n    fz_catch(c",
          "old_line_content": "{",
          "new_line_content": "        return engine->GetPageImage(pageNo, rect, imageIx);",
          "content_same": false
        },
        {
          "line": 1605,
          "old_api": null,
          "new_api": "}\n        }\n        /",
          "old_text": null,
          "new_text": "    }\n        }\n        /",
          "old_line_content": "        return false;",
          "new_line_content": "        stm = fz_clone_stream(ctx, stm);",
          "content_same": false
        },
        {
          "line": 3657,
          "old_api": null,
          "new_api": "return _pages[pageNo-1];",
          "old_text": null,
          "new_text": "        return _pages[pageNo-1];\n\n   ",
          "old_line_content": "}",
          "new_line_content": "    InitializeCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 1610,
          "old_api": null,
          "new_api": "depage 1252\n        // not",
          "old_text": null,
          "new_text": "depage 1252\n        // not",
          "old_line_content": "{",
          "new_line_content": "    if (!LoadFromStream(stm, pwdUI))",
          "content_same": false
        },
        {
          "line": 1612,
          "old_api": null,
          "new_api": "n stored as Uni",
          "old_text": null,
          "new_text": "n stored as Uni",
          "old_line_content": "        return false;",
          "new_line_content": "    return FinishLoading();",
          "content_same": false
        },
        {
          "line": 3668,
          "old_api": null,
          "new_api": "ference counting)\n            pa",
          "old_text": null,
          "new_text": "ference counting)\n            pa",
          "old_line_content": "    }",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 1621,
          "old_api": null,
          "new_api": "conv::FromCodePage(pwd_ansi, 1252));",
          "old_text": null,
          "new_text": "conv::FromCodePage(pwd_ansi, 1252));\n  ",
          "old_line_content": "        return false;",
          "new_line_content": "        _doc = pdf_open_document_with_stream(ctx, stm);",
          "content_same": false
        },
        {
          "line": 3672,
          "old_api": null,
          "new_api": "pageNo);",
          "old_text": null,
          "new_text": " pageNo);\n  ",
          "old_line_content": "",
          "new_line_content": "        assert(_doc);",
          "content_same": false
        },
        {
          "line": 3673,
          "old_api": null,
          "new_api": "ssert",
          "old_text": null,
          "new_text": "ssert(page->",
          "old_line_content": "    if (imageRects) {",
          "new_line_content": "        free(_pages);",
          "content_same": false
        },
        {
          "line": 1630,
          "old_api": null,
          "new_api": "}\n    }\n\n    if (ok &&",
          "old_text": null,
          "new_text": " }\n    }\n\n    if (ok && ",
          "old_line_content": "",
          "new_line_content": "    isProtected = pdf_needs_password(_doc);",
          "content_same": false
        },
        {
          "line": 3682,
          "old_api": null,
          "new_api": "age == _pages[i]",
          "old_text": null,
          "new_text": "age == _pages[i]",
          "old_line_content": "    }",
          "new_line_content": "        free(imageRects);",
          "content_same": false
        },
        {
          "line": 3685,
          "old_api": null,
          "new_api": "+ 1;\n    return",
          "old_text": null,
          "new_text": "+ 1;\n    return ",
          "old_line_content": "    _doc = NULL;",
          "new_line_content": "    while (runCache.Count() > 0) {",
          "content_same": false
        },
        {
          "line": 1638,
          "old_api": null,
          "new_api": "PdfEngineImpl::FinishLoading()\n{\n    fz_t",
          "old_text": null,
          "new_text": "PdfEngineImpl::FinishLoading()\n{\n    fz_t",
          "old_line_content": "            // password not given or encryption key has been remembered",
          "new_line_content": "    fz_stream_fingerprint(_doc->file, digest);",
          "content_same": false
        },
        {
          "line": 3687,
          "old_api": null,
          "new_api": "list *list)\n{",
          "old_text": null,
          "new_text": "list *list)\n{\n ",
          "old_line_content": "    ctx = NULL;",
          "new_line_content": "        DropPageRun(runCache.Last(), true);",
          "content_same": false
        },
        {
          "line": 1642,
          "old_api": null,
          "new_api": "false;\n    }\n    if",
          "old_text": null,
          "new_text": "false;\n    }\n    if",
          "old_line_content": "",
          "new_line_content": "        ScopedMem<WCHAR> pwd(pwdUI->GetPassword(_fileName, digest, pdf_crypt_key(_doc), &saveKey));",
          "content_same": false
        },
        {
          "line": 3696,
          "old_api": null,
          "new_api": "dev = fz_new_i",
          "old_text": null,
          "new_text": " dev = fz_new_i",
          "old_line_content": "}",
          "new_line_content": "    free(_fileName);",
          "content_same": false
        },
        {
          "line": 3698,
          "old_api": null,
          "new_api": "_device",
          "old_text": null,
          "new_text": "_device(ctx, &data);\n        fz_",
          "old_line_content": "BaseEngine *XpsEngineImpl::Clone()",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 1651,
          "old_api": null,
          "new_api": "imageRects = AllocArray<fz_rect *>(PageC",
          "old_text": null,
          "new_text": " imageRects = AllocArray<fz_rect *>(PageC",
          "old_line_content": "            if (pwd) {",
          "new_line_content": "        ok = pwd_utf8 && pdf_authenticate_password(_doc, pwd_utf8);",
          "content_same": false
        },
        {
          "line": 3699,
          "old_api": null,
          "new_api": "play_list",
          "old_text": null,
          "new_text": "play_list(list, dev, &fz_identity",
          "old_line_content": "{",
          "new_line_content": "    DeleteCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 3700,
          "old_api": null,
          "new_api": "NULL);\n    }\n    fz_catch(ctx) { }",
          "old_text": null,
          "new_text": " NULL);\n    }\n    fz_catch(ctx) { }",
          "old_line_content": "    ScopedCritSec scope(&ctxAccess);",
          "new_line_content": "    LeaveCriticalSection(&_pagesAccess);",
          "content_same": false
        },
        {
          "line": 3701,
          "old_api": null,
          "new_api": "_free_device",
          "old_text": null,
          "new_text": "_free_device(dev);\n\n    // save the ",
          "old_line_content": "",
          "new_line_content": "    DeleteCriticalSection(&_pagesAccess);",
          "content_same": false
        },
        {
          "line": 1656,
          "old_api": null,
          "new_api": "fz_warn(ctx, \"Couldn't load all page obj",
          "old_text": null,
          "new_text": "     fz_warn(ctx, \"Couldn't load all page obj",
          "old_line_content": "        // older Acrobat versions seem to have considered passwords to be in codepage 1252",
          "new_line_content": "            pwd.Set(NormalizeString(pwd, 5 /* NormalizationKC */));",
          "content_same": false
        },
        {
          "line": 1659,
          "old_api": null,
          "new_api": "e errors from pdf_load_outline()",
          "old_text": null,
          "new_text": "e errors from pdf_load_outline()\n        ",
          "old_line_content": "            ScopedMem<char> pwd_ansi(str::conv::ToAnsi(pwd));",
          "new_line_content": "                ok = pwd_utf8 && pdf_authenticate_password(_doc, pwd_utf8);",
          "content_same": false
        },
        {
          "line": 3709,
          "old_api": null,
          "new_api": "-rectangle\n        fz_r",
          "old_text": null,
          "new_text": "-rectangle\n        fz_r",
          "old_line_content": "",
          "new_line_content": "    if (!clone || !(_fileName ? clone->Load(_fileName) : clone->Load(_doc->file))) {",
          "content_same": false
        },
        {
          "line": 1664,
          "old_api": null,
          "new_api": "{",
          "old_text": null,
          "new_text": "{\n      ",
          "old_line_content": "    }",
          "new_line_content": "        if (!ok && GetACP() != 1252) {",
          "content_same": false
        },
        {
          "line": 1666,
          "old_api": null,
          "new_api": "\");\n    }\n    fz_try(ctx) {\n        //",
          "old_text": null,
          "new_text": "\");\n    }\n    fz_try(ctx) {\n        // ",
          "old_line_content": "    if (ok && saveKey) {",
          "new_line_content": "            ScopedMem<WCHAR> pwd_cp1252(str::conv::FromCodePage(pwd_ansi, 1252));",
          "content_same": false
        },
        {
          "line": 3714,
          "old_api": null,
          "new_api": "if (rects) {\n            for (size_t i =",
          "old_text": null,
          "new_text": " if (rects) {\n            for (size_t i =",
          "old_line_content": "{",
          "new_line_content": "    clone->UpdateUserAnnotations(&userAnnots);",
          "content_same": false
        },
        {
          "line": 1673,
          "old_api": null,
          "new_api": "railer",
          "old_text": null,
          "new_text": "railer(_doc), \"Info",
          "old_line_content": "",
          "new_line_content": "        memcpy(digest + 16, pdf_crypt_key(_doc), 32);",
          "content_same": false
        },
        {
          "line": 1674,
          "old_api": null,
          "new_api": "_info = pdf_copy",
          "old_text": null,
          "new_text": "  _info = pdf_copy",
          "old_line_content": "bool PdfEngineImpl::FinishLoading()",
          "new_line_content": "        _decryptionKey = _MemToHex(&digest);",
          "content_same": false
        },
        {
          "line": 3721,
          "old_api": null,
          "new_api": "}\n            imageRects",
          "old_text": null,
          "new_text": "          }\n            imageRects",
          "old_line_content": "        // load uncompressed documents as a recompressed ZIP stream",
          "new_line_content": "    assert(!_fileName && !_doc && ctx);",
          "content_same": false
        },
        {
          "line": 3722,
          "old_api": null,
          "new_api": "}\n    }",
          "old_text": null,
          "new_text": "\n        }\n    }\n\n",
          "old_line_content": "        ScopedComPtr<IStream> zipStream(OpenDirAsZipStream(_fileName, true));",
          "new_line_content": "    _fileName = str::Dup(fileName);",
          "content_same": false
        },
        {
          "line": 3726,
          "old_api": null,
          "new_api": "gineImpl::GetPageRun(x",
          "old_text": null,
          "new_text": "gineImpl::GetPageRun(x",
          "old_line_content": "    }",
          "new_line_content": "    if (dir::Exists(_fileName)) {",
          "content_same": false
        },
        {
          "line": 3731,
          "old_api": null,
          "new_api": "At",
          "old_text": null,
          "new_text": " runCache.At(i)",
          "old_line_content": "    }",
          "new_line_content": "        return Load(zipStream);",
          "content_same": false
        },
        {
          "line": 3736,
          "old_api": null,
          "new_api": "size_t mem = 0;\n        fo",
          "old_text": null,
          "new_text": "   size_t mem = 0;\n        fo",
          "old_line_content": "}",
          "new_line_content": "        stm = fz_open_file2(ctx, _fileName);",
          "content_same": false
        },
        {
          "line": 3741,
          "old_api": null,
          "new_api": "uns that take up to",
          "old_text": null,
          "new_text": "uns that take up to",
          "old_line_content": "    if (!ctx)",
          "new_line_content": "    return LoadFromStream(stm);",
          "content_same": false
        },
        {
          "line": 1694,
          "old_api": null,
          "new_api": "rop",
          "old_text": null,
          "new_text": "rop(_info, ",
          "old_line_content": "    if (!_pages || !_pageObjs || !_mediaboxes || !pageAnnots || !imageRects)",
          "new_line_content": "    _pages = AllocArray<pdf_page *>(PageCount());",
          "content_same": false
        },
        {
          "line": 1695,
          "old_api": null,
          "new_api": "// also rem",
          "old_text": null,
          "new_text": "// also rem",
          "old_line_content": "        return false;",
          "new_line_content": "    _pageObjs = AllocArray<pdf_obj *>(PageCount());",
          "content_same": false
        },
        {
          "line": 1696,
          "old_api": null,
          "new_api": "pd",
          "old_text": null,
          "new_text": "\n        pd",
          "old_line_content": "",
          "new_line_content": "    _mediaboxes = AllocArray<RectD>(PageCount());",
          "content_same": false
        },
        {
          "line": 1697,
          "old_api": null,
          "new_api": "c), \"Root/O",
          "old_text": null,
          "new_text": "c), \"Root/O",
          "old_line_content": "    ScopedCritSec scope(&ctxAccess);",
          "new_line_content": "    pageAnnots = AllocArray<pdf_annot **>(PageCount());",
          "content_same": false
        },
        {
          "line": 1698,
          "old_api": null,
          "new_api": "tents)) {",
          "old_text": null,
          "new_text": "tents)) {\n ",
          "old_line_content": "",
          "new_line_content": "    imageRects = AllocArray<fz_rect *>(PageCount());",
          "content_same": false
        },
        {
          "line": 3752,
          "old_api": null,
          "new_api": "At",
          "old_text": null,
          "new_text": "    DropPageRun(runCache.At(",
          "old_line_content": "}",
          "new_line_content": "        stm = fz_open_istream(ctx, stream);",
          "content_same": false
        },
        {
          "line": 1709,
          "old_api": null,
          "new_api": "tent) && !pdf_is_indirect(intent) && str::Star",
          "old_text": null,
          "new_text": "tent) && !pdf_is_indirect(intent) && str::Star",
          "old_line_content": "        // ignore errors from pdf_load_outline()",
          "new_line_content": "        fz_warn(ctx, \"Couldn't load all page objects\");",
          "content_same": false
        },
        {
          "line": 3757,
          "old_api": null,
          "new_api": "e_est;\n        }",
          "old_text": null,
          "new_text": "e_est;\n        }\n  ",
          "old_line_content": "    if (!ctx)",
          "new_line_content": "    return LoadFromStream(stm);",
          "content_same": false
        },
        {
          "line": 1712,
          "old_api": null,
          "new_api": "pdf_array",
          "old_text": null,
          "new_text": "             pdf_array",
          "old_line_content": "        // otherwise get displayed",
          "new_line_content": "        outline = pdf_load_outline(_doc);",
          "content_same": false
        },
        {
          "line": 3762,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "       assert(runCache.Count() == ",
          "old_line_content": "    }",
          "new_line_content": "    assert(!_fileName && !_doc && ctx);",
          "content_same": false
        },
        {
          "line": 3767,
          "old_api": null,
          "new_api": "}\n\n        ScopedCritSec",
          "old_text": null,
          "new_text": " }\n\n        ScopedCritSec",
          "old_line_content": "}",
          "new_line_content": "        stm = fz_clone_stream(ctx, stm);",
          "content_same": false
        },
        {
          "line": 1722,
          "old_api": null,
          "new_api": "pdf_obj *pagelabels =",
          "old_text": null,
          "new_text": "   pdf_obj *pagelabels = ",
          "old_line_content": "        // keep a copy of the Info dictionary, as accessing the original",
          "new_line_content": "        attachments = pdf_loadattachments(_doc);",
          "content_same": false
        },
        {
          "line": 3772,
          "old_api": null,
          "new_api": "_device *dev = NULL",
          "old_text": null,
          "new_text": "_device *dev = NULL",
          "old_line_content": "        return false;",
          "new_line_content": "    return LoadFromStream(stm);",
          "content_same": false
        },
        {
          "line": 3781,
          "old_api": null,
          "new_api": "list_device",
          "old_text": null,
          "new_text": "list_device(ctx, list);\n            xps",
          "old_line_content": "        return false;",
          "new_line_content": "        _doc = xps_open_document_with_stream(ctx, stm);",
          "content_same": false
        },
        {
          "line": 1735,
          "old_api": null,
          "new_api": ">title ? pdf_clean_st",
          "old_text": null,
          "new_text": ">title ? pdf_clean_st",
          "old_line_content": "        // also remember known output intents (PDF/X, etc.)",
          "new_line_content": "            _info = pdf_new_dict(_doc, 4);",
          "content_same": false
        },
        {
          "line": 1743,
          "old_api": null,
          "new_api": "return node;\n}\n\nD",
          "old_text": null,
          "new_text": "    return node;\n}\n\nD",
          "old_line_content": "            }",
          "new_line_content": "        if (pdf_is_array(intents)) {",
          "content_same": false
        },
        {
          "line": 1745,
          "old_api": null,
          "new_api": "{\n        node = Build",
          "old_text": null,
          "new_text": "{\n        node = Build",
          "old_line_content": "        }",
          "new_line_content": "            for (int i = 0; i < pdf_array_len(intents); i++) {",
          "content_same": false
        },
        {
          "line": 1746,
          "old_api": null,
          "new_api": "AddSibling",
          "old_text": null,
          "new_text": "        node->AddSibling(",
          "old_line_content": "        else",
          "new_line_content": "                pdf_obj *intent = pdf_dict_gets(pdf_array_get(intents, i), \"S\");",
          "content_same": false
        },
        {
          "line": 3795,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "           ",
          "old_line_content": "",
          "new_line_content": "    _pages = AllocArray<xps_page *>(PageCount());",
          "content_same": false
        },
        {
          "line": 1748,
          "old_api": null,
          "new_api": "nation *PdfEngineImpl::GetNa",
          "old_text": null,
          "new_text": "nation *PdfEngineImpl::GetNa",
          "old_line_content": "    }",
          "new_line_content": "                    pdf_array_push(list, intent);",
          "content_same": false
        },
        {
          "line": 3796,
          "old_api": null,
          "new_api": "}\n    e",
          "old_text": null,
          "new_text": "    }\n    e",
          "old_line_content": "    fz_try(ctx) {",
          "new_line_content": "    _mediaboxes = AllocArray<RectD>(PageCount());",
          "content_same": false
        },
        {
          "line": 1753,
          "old_api": null,
          "new_api": "e));\n    pdf_obj *dest = NULL;\n    fz",
          "old_text": null,
          "new_text": "e));\n    pdf_obj *dest = NULL;\n    fz",
          "old_line_content": "    }",
          "new_line_content": "            pdf_dict_dels(_info, \"OutputIntents\");",
          "content_same": false
        },
        {
          "line": 1756,
          "old_api": null,
          "new_api": "pdf_new_string",
          "old_text": null,
          "new_text": "pdf_new_string(_doc, name_utf8, (int)str::Len(nam",
          "old_line_content": "        if (pagelabels)",
          "new_line_content": "        fz_warn(ctx, \"Couldn't load document properties\");",
          "content_same": false
        },
        {
          "line": 1761,
          "old_api": null,
          "new_api": "rn NULL;\n    }",
          "old_text": null,
          "new_text": "rn NULL;\n    }\n\n ",
          "old_line_content": "    }",
          "new_line_content": "        pdf_obj *pagelabels = pdf_dict_getp(pdf_trailer(_doc), \"Root/PageLabels\");",
          "content_same": false
        },
        {
          "line": 3809,
          "old_api": null,
          "new_api": "m, const fz_rect *cliprect,",
          "old_text": null,
          "new_text": "m, const fz_rect *cliprect,",
          "old_line_content": "    return true;",
          "new_line_content": "        _info = xps_extract_doc_props(_doc);",
          "content_same": false
        },
        {
          "line": 3812,
          "old_api": null,
          "new_api": ")\n{\n    bool ok = true;\n\n    XpsPageRun *run = Ge",
          "old_text": null,
          "new_text": ")\n{\n    bool ok = true;\n\n    XpsPageRun *run = Ge",
          "old_line_content": "xps_page *XpsEngineImpl::GetXpsPage(int pageNo, bool failIfBusy)",
          "new_line_content": "        fz_warn(ctx, \"Couldn't load document properties\");",
          "content_same": false
        },
        {
          "line": 1766,
          "old_api": null,
          "new_api": ");\n    }\n    fz_catch(ctx) {\n        retu",
          "old_text": null,
          "new_text": ");\n    }\n    fz_catch(ctx) {\n        retu",
          "old_line_content": "}",
          "new_line_content": "        fz_warn(ctx, \"Couldn't load page labels\");",
          "content_same": false
        },
        {
          "line": 1769,
          "old_api": null,
          "new_api": "NK_GOTO == ld.kind) {",
          "old_text": null,
          "new_text": "NK_GOTO == ld.kind) {\n",
          "old_line_content": "{",
          "new_line_content": "    AssertCrash(!pdf_js_supported(_doc));",
          "content_same": false
        },
        {
          "line": 1779,
          "old_api": null,
          "new_api": "f_page *PdfEn",
          "old_text": null,
          "new_text": "f_page *PdfEn",
          "old_line_content": "            item->pageNo = entry->dest.ld.gotor.page + 1;",
          "new_line_content": "        WCHAR *name = entry->title ? pdf_clean_string(str::conv::FromUtf8(entry->title)) : str::Dup(L\"\");",
          "content_same": false
        },
        {
          "line": 1780,
          "old_api": null,
          "new_api": "if (!_pages)\n        r",
          "old_text": null,
          "new_text": "\n    if (!_pages)\n        r",
          "old_line_content": "        if (entry->down)",
          "new_line_content": "        PdfTocItem *item = new PdfTocItem(name, PdfLink(this, &entry->dest));",
          "content_same": false
        },
        {
          "line": 3834,
          "old_api": null,
          "new_api": "rue);\n            fz_run_user_p",
          "old_text": null,
          "new_text": "rue);\n            fz_run_user_p",
          "old_line_content": "    }",
          "new_line_content": "            page = xps_load_page(_doc, pageNo - 1);",
          "content_same": false
        },
        {
          "line": 1787,
          "old_api": null,
          "new_api": "fz_try(ctx) {\n            page = pd",
          "old_text": null,
          "new_text": " fz_try(ctx) {\n            page = pd",
          "old_line_content": "    }",
          "new_line_content": "            item->child = BuildTocTree(entry->down, idCounter);",
          "content_same": false
        },
        {
          "line": 3836,
          "old_api": null,
          "new_api": "cookie->cookie : NULL);",
          "old_text": null,
          "new_text": "cookie->cookie : NULL);\n     ",
          "old_line_content": "    return page;",
          "new_line_content": "            LinkifyPageText(page, pageNo);",
          "content_same": false
        },
        {
          "line": 3837,
          "old_api": null,
          "new_api": "age",
          "old_text": null,
          "new_text": "age(dev);\n        }\n        ",
          "old_line_content": "}",
          "new_line_content": "            assert(page->links_resolved);",
          "content_same": false
        },
        {
          "line": 1792,
          "old_api": null,
          "new_api": "[pageNo-1] = page;",
          "old_text": null,
          "new_text": "[pageNo-1] = page;\n   ",
          "old_line_content": "DocTocItem *PdfEngineImpl::GetTocTree()",
          "new_line_content": "            node->AddSibling(item);",
          "content_same": false
        },
        {
          "line": 3847,
          "old_api": null,
          "new_api": "pedCritSec",
          "old_text": null,
          "new_text": "pedCritSec ",
          "old_line_content": "XpsPageRun *XpsEngineImpl::CreatePageRun(xps_page *page, fz_display_list *list)",
          "new_line_content": "    for (int i = 0; i < PageCount(); i++)",
          "content_same": false
        },
        {
          "line": 1804,
          "old_api": null,
          "new_api": "ineImpl::GetPageNo(pdf_page *pag",
          "old_text": null,
          "new_text": "ineImpl::GetPageNo(pdf_page *pag",
          "old_line_content": "    return node;",
          "new_line_content": "        node = BuildTocTree(outline, idCounter);",
          "content_same": false
        },
        {
          "line": 1806,
          "old_api": null,
          "new_api": "(page == _pages[i])\n            retu",
          "old_text": null,
          "new_text": "(page == _pages[i])\n            retu",
          "old_line_content": "",
          "new_line_content": "            node->AddSibling(BuildTocTree(attachments, idCounter));",
          "content_same": false
        },
        {
          "line": 1808,
          "old_api": null,
          "new_api": "Impl::CreatePageRun(pdf_page *page,",
          "old_text": null,
          "new_text": "Impl::CreatePageRun(pdf_page *page, ",
          "old_line_content": "{",
          "new_line_content": "        node = BuildTocTree(attachments, idCounter);",
          "content_same": false
        },
        {
          "line": 3861,
          "old_api": null,
          "new_api": "ps_run_page",
          "old_text": null,
          "new_text": "ps_run_page(_doc, page, dev, ctm, co",
          "old_line_content": "    // save the image rectangles for this page",
          "new_line_content": "        dev = fz_new_inspection_device(ctx, &data);",
          "content_same": false
        },
        {
          "line": 1820,
          "old_api": null,
          "new_api": "{ }\n    fz_free_dev",
          "old_text": null,
          "new_text": "{ }\n    fz_free_dev",
          "old_line_content": "    }",
          "new_line_content": "        pdf_obj *nameobj = pdf_new_string(_doc, name_utf8, (int)str::Len(name_utf8));",
          "content_same": false
        },
        {
          "line": 1821,
          "old_api": null,
          "new_api": "ave the image rectangles for t",
          "old_text": null,
          "new_text": "ave the image rectangles for t",
          "old_line_content": "",
          "new_line_content": "        dest = pdf_lookup_dest(_doc, nameobj);",
          "content_same": false
        },
        {
          "line": 1822,
          "old_api": null,
          "new_api": "int pageNo = GetPag",
          "old_text": null,
          "new_text": "  int pageNo = GetPag",
          "old_line_content": "    PageDestination *pageDest = NULL;",
          "new_line_content": "        pdf_drop_obj(nameobj);",
          "content_same": false
        },
        {
          "line": 3869,
          "old_api": null,
          "new_api": "fz_catch",
          "old_text": null,
          "new_text": "\n        fz_catch",
          "old_line_content": "            }",
          "new_line_content": "    if (!imageRects[pageNo-1] && positions.Count() > 0) {",
          "content_same": false
        },
        {
          "line": 3871,
          "old_api": null,
          "new_api": "(&ctxAccess);",
          "old_text": null,
          "new_text": "(&ctxAccess);\n\n  ",
          "old_line_content": "        }",
          "new_line_content": "        fz_rect *rects = AllocArray<fz_rect>(positions.Count() + 1);",
          "content_same": false
        },
        {
          "line": 3873,
          "old_api": null,
          "new_api": "neImpl::DropPageR",
          "old_text": null,
          "new_text": "neImpl::DropPageR",
          "old_line_content": "",
          "new_line_content": "            for (size_t i = 0; i < positions.Count(); i++) {",
          "content_same": false
        },
        {
          "line": 3874,
          "old_api": null,
          "new_api": "{\n    ScopedCr",
          "old_text": null,
          "new_text": "\n{\n    ScopedCr",
          "old_line_content": "    return new XpsPageRun(page, list, data);",
          "new_line_content": "                rects[i] = positions.At(i).rect;",
          "content_same": false
        },
        {
          "line": 1831,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "locArray<fz_rect>(positions.Count() + 1);\n   ",
          "old_line_content": "    if (FZ_LINK_GOTO == ld.kind) {",
          "new_line_content": "        ld = pdf_parse_link_dest(_doc, FZ_LINK_GOTO, dest);",
          "content_same": false
        },
        {
          "line": 1841,
          "old_api": null,
          "new_api": "df_page *page, bo",
          "old_text": null,
          "new_text": "df_page *page, bo",
          "old_line_content": "",
          "new_line_content": "        pageDest = new SimpleDest(tmp.GetDestPageNo(), tmp.GetDestRect());",
          "content_same": false
        },
        {
          "line": 3889,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(1 <= page",
          "old_line_content": "    if (!result && !tryOnly) {",
          "new_line_content": "    for (size_t i = 0; i < runCache.Count(); i++) {",
          "content_same": false
        },
        {
          "line": 1843,
          "old_api": null,
          "new_api": "PdfPageRun *result = NUL",
          "old_text": null,
          "new_text": "   PdfPageRun *result = NUL",
          "old_line_content": "{",
          "new_line_content": "    fz_free_link_dest(ctx, &ld);",
          "content_same": false
        },
        {
          "line": 3890,
          "old_api": null,
          "new_api": "unt",
          "old_text": null,
          "new_text": "unt());\n    if",
          "old_line_content": "        size_t mem = 0;",
          "new_line_content": "        if (runCache.At(i)->page == page) {",
          "content_same": false
        },
        {
          "line": 3903,
          "old_api": null,
          "new_api": "GetXpsPage",
          "old_text": null,
          "new_text": "GetXpsPage(pag",
          "old_line_content": "",
          "new_line_content": "                mem += runCache.At(i)->size_est;",
          "content_same": false
        },
        {
          "line": 3905,
          "old_api": null,
          "new_api": ");\n\n    fz_rect",
          "old_text": null,
          "new_text": ");\n\n    fz_rect ",
          "old_line_content": "",
          "new_line_content": "        if (runCache.Count() >= MAX_PAGE_RUN_CACHE) {",
          "content_same": false
        },
        {
          "line": 3906,
          "old_api": null,
          "new_api": "to_RectD",
          "old_text": null,
          "new_text": "to_RectD(*xps_bo",
          "old_line_content": "        fz_display_list *list = NULL;",
          "new_line_content": "            assert(runCache.Count() == MAX_PAGE_RUN_CACHE);",
          "content_same": false
        },
        {
          "line": 3907,
          "old_api": null,
          "new_api": "aboxes[pageNo-1",
          "old_text": null,
          "new_text": "aboxes[pageNo-1",
          "old_line_content": "        fz_device *dev = NULL;",
          "new_line_content": "            DropPageRun(runCache.Last(), true);",
          "content_same": false
        },
        {
          "line": 1860,
          "old_api": null,
          "new_api": "s that take",
          "old_text": null,
          "new_text": "s that take ",
          "old_line_content": "        }",
          "new_line_content": "        fz_var(page);",
          "content_same": false
        },
        {
          "line": 1862,
          "old_api": null,
          "new_api": "// (except for the very recently used ones)",
          "old_text": null,
          "new_text": "     // (except for the very recently used ones)\n          ",
          "old_line_content": "    }",
          "new_line_content": "            page = pdf_load_page_by_obj(_doc, pageNo - 1, _pageObjs[pageNo-1]);",
          "content_same": false
        },
        {
          "line": 1864,
          "old_api": null,
          "new_api": "_PAGE_RUN_MEMORY)",
          "old_text": null,
          "new_text": "_PAGE_RUN_MEMORY)\n   ",
          "old_line_content": "    return page;",
          "new_line_content": "            LinkifyPageText(page);",
          "content_same": false
        },
        {
          "line": 1865,
          "old_api": null,
          "new_api": "--), true);\n            else",
          "old_text": null,
          "new_text": "--), true);\n            else",
          "old_line_content": "}",
          "new_line_content": "            pageAnnots[pageNo-1] = ProcessPageAnnotations(page);",
          "content_same": false
        },
        {
          "line": 3914,
          "old_api": null,
          "new_api": "etXpsPage",
          "old_text": null,
          "new_text": "etXpsPage(pa",
          "old_line_content": "        }",
          "new_line_content": "        fz_var(list);",
          "content_same": false
        },
        {
          "line": 3915,
          "old_api": null,
          "new_api": "if (!page)",
          "old_text": null,
          "new_text": "if (!page)\n",
          "old_line_content": "        fz_catch(ctx) {",
          "new_line_content": "        fz_var(dev);",
          "content_same": false
        },
        {
          "line": 3917,
          "old_api": null,
          "new_api": "z_empty_rect;\n    fz_dev",
          "old_text": null,
          "new_text": "z_empty_rect;\n    fz_dev",
          "old_line_content": "            list = NULL;",
          "new_line_content": "            list = fz_new_display_list(ctx);",
          "content_same": false
        },
        {
          "line": 3918,
          "old_api": null,
          "new_api": "EnterCriticalSection",
          "old_text": null,
          "new_text": "EnterCriticalSection(&ctxAcce",
          "old_line_content": "        }",
          "new_line_content": "            dev = fz_new_list_device(ctx, list);",
          "content_same": false
        },
        {
          "line": 1875,
          "old_api": null,
          "new_api": "t",
          "old_text": null,
          "new_text": "t() == MAX_",
          "old_line_content": "PdfPageRun *PdfEngineImpl::CreatePageRun(pdf_page *page, fz_display_list *list)",
          "new_line_content": "    for (int i = 0; i < PageCount(); i++)",
          "content_same": false
        },
        {
          "line": 3925,
          "old_api": null,
          "new_api": "txAccess);\n\n    fz_",
          "old_text": null,
          "new_text": "txAccess);\n\n    fz_",
          "old_line_content": "    }",
          "new_line_content": "        fz_free_device(dev);",
          "content_same": false
        },
        {
          "line": 3932,
          "old_api": null,
          "new_api": "No);\n    if (f",
          "old_text": null,
          "new_text": "No);\n    if (f",
          "old_line_content": "    if (result)",
          "new_line_content": "    else if (result && result != runCache.At(0)) {",
          "content_same": false
        },
        {
          "line": 3934,
          "old_api": null,
          "new_api": "RectD rect2 = fz_r",
          "old_text": null,
          "new_text": "\n    RectD rect2 = fz_r",
          "old_line_content": "    return result;",
          "new_line_content": "        runCache.Remove(result);",
          "content_same": false
        },
        {
          "line": 3935,
          "old_api": null,
          "new_api": "D",
          "old_text": null,
          "new_text": "D(rect);\n    return rect2.In",
          "old_line_content": "}",
          "new_line_content": "        runCache.InsertAt(0, result);",
          "content_same": false
        },
        {
          "line": 1889,
          "old_api": null,
          "new_api": "_device",
          "old_text": null,
          "new_text": "_device(ctx, list);\n            pdf_",
          "old_line_content": "    // save the image rectangles for this page",
          "new_line_content": "        dev = fz_new_inspection_device(ctx, &data);",
          "content_same": false
        },
        {
          "line": 1897,
          "old_api": null,
          "new_api": "n",
          "old_text": null,
          "new_text": "n(page, list);\n  ",
          "old_line_content": "            }",
          "new_line_content": "    if (!imageRects[pageNo-1] && positions.Count() > 0) {",
          "content_same": false
        },
        {
          "line": 1899,
          "old_api": null,
          "new_api": "Recently Used fi",
          "old_text": null,
          "new_text": " Recently Used fi",
          "old_line_content": "        }",
          "new_line_content": "        fz_rect *rects = AllocArray<fz_rect>(positions.Count() + 1);",
          "content_same": false
        },
        {
          "line": 1901,
          "old_api": null,
          "new_api": "result);\n    }",
          "old_text": null,
          "new_text": " result);\n    }\n\n",
          "old_line_content": "",
          "new_line_content": "            for (size_t i = 0; i < positions.Count(); i++) {",
          "content_same": false
        },
        {
          "line": 1902,
          "old_api": null,
          "new_api": "+;\n    return r",
          "old_text": null,
          "new_text": "+;\n    return r",
          "old_line_content": "    return new PdfPageRun(page, list, data);",
          "new_line_content": "                rects[i] = positions.At(i).rect;",
          "content_same": false
        },
        {
          "line": 3953,
          "old_api": null,
          "new_api": "matrix",
          "old_text": null,
          "new_text": "matrix(&ctm, &ctm);\n    fz_rect rect2",
          "old_line_content": "        }",
          "new_line_content": "            fz_begin_page(dev, xps_bound_page(_doc, page, &pagerect), ctm);",
          "content_same": false
        },
        {
          "line": 3954,
          "old_api": null,
          "new_api": "ect);\n    fz_transform_rect(&rect2, &ctm);\n    return fz_r",
          "old_text": null,
          "new_text": "ect);\n    fz_transform_rect(&rect2, &ctm);\n    return fz_r",
          "old_line_content": "        fz_catch(ctx) {",
          "new_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, false);",
          "content_same": false
        },
        {
          "line": 3955,
          "old_api": null,
          "new_api": "ct2);\n}\n\nbool XpsEngineImpl::RenderPage(HDC hDC, xps_page *page, RectI screenRect,",
          "old_text": null,
          "new_text": "ct2);\n}\n\nbool XpsEngineImpl::RenderPage(HDC hDC, xps_page *page, RectI screenRect, ",
          "old_line_content": "            ok = false;",
          "new_line_content": "            fz_run_display_list(run->list, dev, ctm, cliprect, cookie ? &cookie->cookie : NULL);",
          "content_same": false
        },
        {
          "line": 3956,
          "old_api": null,
          "new_api": "*ctm, float zoom, int rotation, RectD *pageRect, AbortCo",
          "old_text": null,
          "new_text": " *ctm, float zoom, int rotation, RectD *pageRect, AbortCo",
          "old_line_content": "        }",
          "new_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, true);",
          "content_same": false
        },
        {
          "line": 3963,
          "old_api": null,
          "new_api": "pRect = fz_RectD_to_rect(*page",
          "old_text": null,
          "new_text": "  pRect = fz_RectD_to_rect(*page",
          "old_line_content": "        fz_try(ctx) {",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 3964,
          "old_api": null,
          "new_api": "else",
          "old_text": null,
          "new_text": "    else\n       ",
          "old_line_content": "            fz_rect pagerect;",
          "new_line_content": "        DropPageRun(run);",
          "content_same": false
        },
        {
          "line": 1917,
          "old_api": null,
          "new_api": "terCriticalSecti",
          "old_text": null,
          "new_text": "terCriticalSecti",
          "old_line_content": "    if (!result && !tryOnly) {",
          "new_line_content": "    for (size_t i = 0; i < runCache.Count(); i++) {",
          "content_same": false
        },
        {
          "line": 1918,
          "old_api": null,
          "new_api": "Vec<PageAnno",
          "old_text": null,
          "new_text": "  Vec<PageAnno",
          "old_line_content": "        size_t mem = 0;",
          "new_line_content": "        if (runCache.At(i)->page == page) {",
          "content_same": false
        },
        {
          "line": 3971,
          "old_api": null,
          "new_api": "nRect.y - bbox.y0));\n    }\n    else",
          "old_text": null,
          "new_text": "nRect.y - bbox.y0));\n    }\n    else\n ",
          "old_line_content": "        }",
          "new_line_content": "            fz_begin_page(dev, xps_bound_page(_doc, page, &pagerect), ctm);",
          "content_same": false
        },
        {
          "line": 3972,
          "old_api": null,
          "new_api": "HBRUSH bgBrush = CreateSolidBrush(RGB(0xFF, 0xFF, 0xFF",
          "old_text": null,
          "new_text": "    HBRUSH bgBrush = CreateSolidBrush(RGB(0xFF, 0xFF, 0xFF",
          "old_line_content": "        fz_catch(ctx) {",
          "new_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, false);",
          "content_same": false
        },
        {
          "line": 3973,
          "old_api": null,
          "new_api": "ToRECT",
          "old_text": null,
          "new_text": "pRect = screenRect.ToRECT();\n    FillRect(hDC, &tmpRect, bgBrush); ",
          "old_line_content": "            ok = false;",
          "new_line_content": "            xps_run_page(_doc, page, dev, ctm, cookie ? &cookie->cookie : NULL);",
          "content_same": false
        },
        {
          "line": 3974,
          "old_api": null,
          "new_api": "hite background\n    DeleteObject(bgBrush);\n\n    fz_rect c",
          "old_text": null,
          "new_text": "hite background\n    DeleteObject(bgBrush);\n\n    fz_rect c",
          "old_line_content": "        }",
          "new_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, true);",
          "content_same": false
        },
        {
          "line": 3975,
          "old_api": null,
          "new_api": "ctD_to_rect",
          "old_text": null,
          "new_text": "ctD_to_rect(screenRect.Convert<double>());\n    if (pageRect) {\n        fz_rect pageclip ",
          "old_line_content": "    }",
          "new_line_content": "            fz_run_user_page_annots(pageAnnots, dev, ctm, cliprect, cookie ? &cookie->cookie : NULL);",
          "content_same": false
        },
        {
          "line": 3976,
          "old_api": null,
          "new_api": "ect",
          "old_text": null,
          "new_text": "ect(*pageRect);\n",
          "old_line_content": "",
          "new_line_content": "            fz_end_page(dev);",
          "content_same": false
        },
        {
          "line": 1931,
          "old_api": null,
          "new_api": "eAnnots, dev,",
          "old_text": null,
          "new_text": "eAnnots, dev, ",
          "old_line_content": "",
          "new_line_content": "                mem += runCache.At(i)->size_est;",
          "content_same": false
        },
        {
          "line": 1933,
          "old_api": null,
          "new_api": "kie : NULL);",
          "old_text": null,
          "new_text": "kie : NULL);\n   ",
          "old_line_content": "",
          "new_line_content": "        if (runCache.Count() >= MAX_PAGE_RUN_CACHE) {",
          "content_same": false
        },
        {
          "line": 1934,
          "old_api": null,
          "new_api": "z_catch",
          "old_text": null,
          "new_text": "z_catch(ctx) {\n ",
          "old_line_content": "        fz_display_list *list = NULL;",
          "new_line_content": "            assert(runCache.Count() == MAX_PAGE_RUN_CACHE);",
          "content_same": false
        },
        {
          "line": 1935,
          "old_api": null,
          "new_api": "icalSection",
          "old_text": null,
          "new_text": "icalSection(&ct",
          "old_line_content": "        fz_device *dev = NULL;",
          "new_line_content": "            DropPageRun(runCache.Last(), true);",
          "content_same": false
        },
        {
          "line": 3983,
          "old_api": null,
          "new_api": "ect tmp;\n    fz_rect_from_irect(",
          "old_text": null,
          "new_text": "ect tmp;\n    fz_rect_from_irect(",
          "old_line_content": "",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 3984,
          "old_api": null,
          "new_api": "ct, fz_round_rect(&",
          "old_text": null,
          "new_text": "ct, fz_round_rect(&",
          "old_line_content": "void XpsEngineImpl::DropPageRun(XpsPageRun *run, bool forceRemove)",
          "new_line_content": "    fz_free_device(dev);",
          "content_same": false
        },
        {
          "line": 3985,
          "old_api": null,
          "new_api": "liprect));\n\n    fz_device *dev =",
          "old_text": null,
          "new_text": "liprect));\n\n    fz_device *dev =",
          "old_line_content": "{",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 1942,
          "old_api": null,
          "new_api": "Print\" :",
          "old_text": null,
          "new_text": "Print\" :\n   ",
          "old_line_content": "        }",
          "new_line_content": "        fz_var(list);",
          "content_same": false
        },
        {
          "line": 1943,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "           ",
          "old_line_content": "        fz_catch(ctx) {",
          "new_line_content": "        fz_var(dev);",
          "content_same": false
        },
        {
          "line": 1945,
          "old_api": null,
          "new_api": ";\n        Vec<PageAnnota",
          "old_text": null,
          "new_text": ";\n        Vec<PageAnnota",
          "old_line_content": "            list = NULL;",
          "new_line_content": "            list = fz_new_display_list(ctx);",
          "content_same": false
        },
        {
          "line": 1946,
          "old_api": null,
          "new_api": "_get_user_page_annots",
          "old_text": null,
          "new_text": "_get_user_page_annots(userAnn",
          "old_line_content": "        }",
          "new_line_content": "            dev = fz_new_list_device(ctx, list);",
          "content_same": false
        },
        {
          "line": 3996,
          "old_api": null,
          "new_api": "ctxAccess);\n\n    Fit",
          "old_text": null,
          "new_text": "ctxAccess);\n\n    Fit",
          "old_line_content": "    }",
          "new_line_content": "        runCache.Remove(run);",
          "content_same": false
        },
        {
          "line": 4000,
          "old_api": null,
          "new_api": "itzAbortCookie",
          "old_text": null,
          "new_text": "itzAbortCookie();\n    return RunPage",
          "old_line_content": "{",
          "new_line_content": "        fz_drop_display_list(ctx, run->list);",
          "content_same": false
        },
        {
          "line": 1953,
          "old_api": null,
          "new_api": "nots, dev, cliprect",
          "old_text": null,
          "new_text": "nots, dev, cliprect",
          "old_line_content": "    }",
          "new_line_content": "        fz_free_device(dev);",
          "content_same": false
        },
        {
          "line": 4007,
          "old_api": null,
          "new_api": "tion, RectD",
          "old_text": null,
          "new_text": "tion, RectD",
          "old_line_content": "        return mbox;",
          "new_line_content": "    assert(1 <= pageNo && pageNo <= PageCount());",
          "content_same": false
        },
        {
          "line": 1960,
          "old_api": null,
          "new_api": "y",
          "old_text": null,
          "new_text": "y(pageAnnots, ",
          "old_line_content": "    if (result)",
          "new_line_content": "    else if (result && result != runCache.At(0)) {",
          "content_same": false
        },
        {
          "line": 1962,
          "old_api": null,
          "new_api": "r_page_annots",
          "old_text": null,
          "new_text": "r_page_annots(pageAnnot",
          "old_line_content": "    return result;",
          "new_line_content": "        runCache.Remove(result);",
          "content_same": false
        },
        {
          "line": 1963,
          "old_api": null,
          "new_api": ", cliprect, cookie ? &cookie",
          "old_text": null,
          "new_text": ", cliprect, cookie ? &cookie",
          "old_line_content": "}",
          "new_line_content": "        runCache.InsertAt(0, result);",
          "content_same": false
        },
        {
          "line": 4012,
          "old_api": null,
          "new_api": "if (!page)",
          "old_text": null,
          "new_text": "  if (!page)\n ",
          "old_line_content": "        fz_try(ctx) {",
          "new_line_content": "    if (!mbox.IsEmpty())",
          "content_same": false
        },
        {
          "line": 4015,
          "old_api": null,
          "new_api": "pageRect)\n        pRect",
          "old_text": null,
          "new_text": "pageRect)\n        pRect ",
          "old_line_content": "        fz_catch(ctx) { }",
          "new_line_content": "    xps_page *page = GetXpsPage(pageNo, true);",
          "content_same": false
        },
        {
          "line": 4019,
          "old_api": null,
          "new_api": ", rotation);\n    fz_rect r = pRect;",
          "old_text": null,
          "new_text": ", rotation);\n    fz_rect r = pRect;\n",
          "old_line_content": "        }",
          "new_line_content": "            mbox = fz_rect_to_RectD(xps_bound_page_quick(_doc, pageNo-1));",
          "content_same": false
        },
        {
          "line": 4027,
          "old_api": null,
          "new_api": "int w = bbox.x1",
          "old_text": null,
          "new_text": "  int w = bbox.x1 ",
          "old_line_content": "}",
          "new_line_content": "    if (!page && (page = GetXpsPage(pageNo)) == NULL)",
          "content_same": false
        },
        {
          "line": 4028,
          "old_api": null,
          "new_api": "ox.y0;",
          "old_text": null,
          "new_text": "ox.y0;\n",
          "old_line_content": "",
          "new_line_content": "        return RectD();",
          "content_same": false
        },
        {
          "line": 1981,
          "old_api": null,
          "new_api": "elete run;\n    }\n}\n\nRectD PdfEngineIm",
          "old_text": null,
          "new_text": "elete run;\n    }\n}\n\nRectD PdfEngineIm",
          "old_line_content": "        }",
          "new_line_content": "            fz_begin_page(dev, pdf_bound_page(_doc, page, &pagerect), ctm);",
          "content_same": false
        },
        {
          "line": 1982,
          "old_api": null,
          "new_api": "pageNo)\n{\n    assert(1 <= pageNo && pageNo <= PageCount());\n    if (!_mediabox",
          "old_text": null,
          "new_text": "pageNo)\n{\n    assert(1 <= pageNo && pageNo <= PageCount());\n    if (!_mediabox",
          "old_line_content": "        fz_catch(ctx) {",
          "new_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, false, page->transparency);",
          "content_same": false
        },
        {
          "line": 1983,
          "old_api": null,
          "new_api": "Empty",
          "old_text": null,
          "new_text": "Empty())\n        return _mediaboxes[pageNo-1];\n\n    pdf_obj *page = _pageObjs[pageN",
          "old_line_content": "            ok = false;",
          "new_line_content": "            fz_run_display_list(run->list, dev, ctm, cliprect, cookie ? &cookie->cookie : NULL);",
          "content_same": false
        },
        {
          "line": 1984,
          "old_api": null,
          "new_api": "(!page)\n        return RectD();\n\n    ScopedCritSec scope(&ctxAccess);\n\n    //",
          "old_text": null,
          "new_text": "(!page)\n        return RectD();\n\n    ScopedCritSec scope(&ctxAccess);\n\n    //",
          "old_line_content": "        }",
          "new_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, true, page->transparency);",
          "content_same": false
        },
        {
          "line": 4037,
          "old_api": null,
          "new_api": "p",
          "old_text": null,
          "new_text": "p(SizeI(w, ",
          "old_line_content": "    fz_device *dev = NULL;",
          "new_line_content": "    assert(1 <= pageNo && pageNo <= PageCount());",
          "content_same": false
        },
        {
          "line": 1991,
          "old_api": null,
          "new_api": "e, \"MediaBox\"), &mbox);",
          "old_text": null,
          "new_text": "e, \"MediaBox\"), &mbox);\n        ",
          "old_line_content": "                           target == Target_Export ? \"Export\" : \"View\";",
          "new_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2001,
          "old_api": null,
          "new_api": "\", pageNo);\n        mbox.x0 = 0; mbox",
          "old_text": null,
          "new_text": "\", pageNo);\n        mbox.x0 = 0; mbox",
          "old_line_content": "        }",
          "new_line_content": "            fz_begin_page(dev, pdf_bound_page(_doc, page, &pagerect), ctm);",
          "content_same": false
        },
        {
          "line": 2002,
          "old_api": null,
          "new_api": ".x1 = 612; mbox.y1 = 792;\n    }\n    if (!fz_is_empty_rect(&cbox)) {\n        fz",
          "old_text": null,
          "new_text": ".x1 = 612; mbox.y1 = 792;\n    }\n    if (!fz_is_empty_rect(&cbox)) {\n        fz",
          "old_line_content": "        fz_catch(ctx) {",
          "new_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, false, page->transparency);",
          "content_same": false
        },
        {
          "line": 2003,
          "old_api": null,
          "new_api": "(&mbox, &cbox);\n        if (fz_is_empty_rect(&mbox))\n            return RectD();\n    }",
          "old_text": null,
          "new_text": "(&mbox, &cbox);\n        if (fz_is_empty_rect(&mbox))\n            return RectD();\n    }\n   ",
          "old_line_content": "            ok = false;",
          "new_line_content": "            pdf_run_page_with_usage(_doc, page, dev, ctm, targetName, cookie ? &cookie->cookie : NULL);",
          "content_same": false
        },
        {
          "line": 2004,
          "old_api": null,
          "new_api": "90) != 0)\n        rotate = 0;\n\n    // cf. pdf-page.c's pdf_bound_page\n    fz_",
          "old_text": null,
          "new_text": "90) != 0)\n        rotate = 0;\n\n    // cf. pdf-page.c's pdf_bound_page\n    fz_",
          "old_line_content": "        }",
          "new_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, true, page->transparency);",
          "content_same": false
        },
        {
          "line": 2005,
          "old_api": null,
          "new_api": "fz_transform_rect(&mbox, fz_rotate(&ctm, (float)rotate));\n\n    _mediaboxes[pageNo-1] =",
          "old_text": null,
          "new_text": " fz_transform_rect(&mbox, fz_rotate(&ctm, (float)rotate));\n\n    _mediaboxes[pageNo-1] = ",
          "old_line_content": "    }",
          "new_line_content": "            fz_run_user_page_annots(pageAnnots, dev, ctm, cliprect, cookie ? &cookie->cookie : NULL);",
          "content_same": false
        },
        {
          "line": 2006,
          "old_api": null,
          "new_api": "ox.x1 - mbox.x0)",
          "old_text": null,
          "new_text": "ox.x1 - mbox.x0)",
          "old_line_content": "",
          "new_line_content": "            fz_end_page(dev);",
          "content_same": false
        },
        {
          "line": 4055,
          "old_api": null,
          "new_api": "return new RenderedBitmap(hbmp,",
          "old_text": null,
          "new_text": "     return new RenderedBitmap(hbmp, ",
          "old_line_content": "",
          "new_line_content": "    xps_bound_page(_doc, page, &pagerect);",
          "content_same": false
        },
        {
          "line": 4058,
          "old_api": null,
          "new_api": "z_try",
          "old_text": null,
          "new_text": "z_try(ctx) {\n       ",
          "old_line_content": "}",
          "new_line_content": "        return PageMediabox(pageNo);",
          "content_same": false
        },
        {
          "line": 4059,
          "old_api": null,
          "new_api": "ace *colorspace = fz_devic",
          "old_text": null,
          "new_text": "ace *colorspace = fz_devic",
          "old_line_content": "",
          "new_line_content": "    if (fz_is_infinite_rect(&rect))",
          "content_same": false
        },
        {
          "line": 4060,
          "old_api": null,
          "new_api": "image = fz_new_pix",
          "old_text": null,
          "new_text": "  image = fz_new_pix",
          "old_line_content": "PointD XpsEngineImpl::Transform(PointD pt, int pageNo, float zoom, int rotation, bool inverse)",
          "new_line_content": "        return PageMediabox(pageNo);",
          "content_same": false
        },
        {
          "line": 2013,
          "old_api": null,
          "new_api": "PdfEngineImpl::PageContentBox(i",
          "old_text": null,
          "new_text": " PdfEngineImpl::PageContentBox(i",
          "old_line_content": "",
          "new_line_content": "    EnterCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2014,
          "old_api": null,
          "new_api": "No, RenderTarget ta",
          "old_text": null,
          "new_text": "No, RenderTarget ta",
          "old_line_content": "void PdfEngineImpl::DropPageRun(PdfPageRun *run, bool forceRemove)",
          "new_line_content": "    fz_free_device(dev);",
          "content_same": false
        },
        {
          "line": 2015,
          "old_api": null,
          "new_api": "assert(1 <= pageNo && pageN",
          "old_text": null,
          "new_text": "\n    assert(1 <= pageNo && pageN",
          "old_line_content": "{",
          "new_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4063,
          "old_api": null,
          "new_api": "tx, image, 0xFF); //",
          "old_text": null,
          "new_text": "tx, image, 0xFF); //",
          "old_line_content": "    if (inverse)",
          "new_line_content": "    return rect2.Intersect(PageMediabox(pageNo));",
          "content_same": false
        },
        {
          "line": 4068,
          "old_api": null,
          "new_api": "fz_device *dev = NULL;\n    fz_",
          "old_text": null,
          "new_text": " fz_device *dev = NULL;\n    fz_",
          "old_line_content": "}",
          "new_line_content": "    fz_matrix ctm = viewctm(pageNo, zoom, rotation);",
          "content_same": false
        },
        {
          "line": 4070,
          "old_api": null,
          "new_api": "ew_draw_device",
          "old_text": null,
          "new_text": "ew_draw_device(ctx, image);\n",
          "old_line_content": "RectD XpsEngineImpl::Transform(RectD rect, int pageNo, float zoom, int rotation, bool inverse)",
          "new_line_content": "        fz_invert_matrix(&ctm, &ctm);",
          "content_same": false
        },
        {
          "line": 4073,
          "old_api": null,
          "new_api": ");\n        return NU",
          "old_text": null,
          "new_text": ");\n        return NU",
          "old_line_content": "    if (inverse)",
          "new_line_content": "    return PointD(pt2.x, pt2.y);",
          "content_same": false
        },
        {
          "line": 2026,
          "old_api": null,
          "new_api": "_device",
          "old_text": null,
          "new_text": "_device(ctx, &rect);",
          "old_line_content": "    }",
          "new_line_content": "        runCache.Remove(run);",
          "content_same": false
        },
        {
          "line": 2030,
          "old_api": null,
          "new_api": "ectD",
          "old_text": null,
          "new_text": "ectD();\n    }\n    LeaveCriticalSecti",
          "old_line_content": "{",
          "new_line_content": "        fz_drop_display_list(ctx, run->list);",
          "content_same": false
        },
        {
          "line": 4078,
          "old_api": null,
          "new_api": "cookie = new FitzAbortCookie();",
          "old_text": null,
          "new_text": "cookie = new FitzAbortCookie();",
          "old_line_content": "}",
          "new_line_content": "    fz_matrix ctm = viewctm(pageNo, zoom, rotation);",
          "content_same": false
        },
        {
          "line": 4080,
          "old_api": null,
          "new_api": "ol ok = RunPage(page, dev, &",
          "old_text": null,
          "new_text": "ol ok = RunPage(page, dev, &",
          "old_line_content": "bool XpsEngineImpl::RenderPage(HDC hDC, xps_page *page, RectI screenRect, const fz_matrix *ctm, float zoom, int rotation, RectD *pageRect, AbortCookie **cookie_out)",
          "new_line_content": "        fz_invert_matrix(&ctm, &ctm);",
          "content_same": false
        },
        {
          "line": 4081,
          "old_api": null,
          "new_api": "(&cliprect, &bbox), tr",
          "old_text": null,
          "new_text": "(&cliprect, &bbox), tr",
          "old_line_content": "{",
          "new_line_content": "    fz_rect rect2 = fz_RectD_to_rect(rect);",
          "content_same": false
        },
        {
          "line": 4082,
          "old_api": null,
          "new_api": "kie);\n\n    ScopedCritSec scope(",
          "old_text": null,
          "new_text": "kie);\n\n    ScopedCritSec scope(",
          "old_line_content": "    if (!page)",
          "new_line_content": "    fz_transform_rect(&rect2, &ctm);",
          "content_same": false
        },
        {
          "line": 4083,
          "old_api": null,
          "new_api": "RenderedBitmap *bit",
          "old_text": null,
          "new_text": "    RenderedBitmap *bit",
          "old_line_content": "        return false;",
          "new_line_content": "    return fz_rect_to_RectD(rect2);",
          "content_same": false
        },
        {
          "line": 2038,
          "old_api": null,
          "new_api": ", false);\n    if (!ok)",
          "old_text": null,
          "new_text": ", false);\n    if (!ok)\n        ",
          "old_line_content": "",
          "new_line_content": "    if (!_mediaboxes[pageNo-1].IsEmpty())",
          "content_same": false
        },
        {
          "line": 2043,
          "old_api": null,
          "new_api": "= fz_re",
          "old_text": null,
          "new_text": "= fz_re",
          "old_line_content": "    int rotate = 0;",
          "new_line_content": "        return RectD();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 2048,
          "old_api": "gineImpl::Transform(RectD rect, int pageNo, float zo",
          "new_api": null,
          "old_text": "gineImpl::Transform(RectD rect, int pageNo, float zo",
          "new_text": null,
          "old_line_content": "        rotate = pdf_to_int(pdf_lookup_inherited_page_item(_doc, page, \"Rotate\"));",
          "new_line_content": "    fz_rect mbox = fz_empty_rect, cbox = fz_empty_rect;",
          "content_same": false
        },
        {
          "line": 2049,
          "old_api": "rse)\n{\n    fz_matrix ctm = view",
          "new_api": null,
          "old_text": "rse)\n{\n    fz_matrix ctm = view",
          "new_text": null,
          "old_line_content": "        pdf_obj *obj = pdf_dict_gets(page, \"UserUnit\");",
          "new_line_content": "    int rotate = 0;",
          "content_same": false
        },
        {
          "line": 2050,
          "old_api": "m, rotation);",
          "new_api": null,
          "old_text": "m, rotation);\n  ",
          "new_text": null,
          "old_line_content": "        if (pdf_is_real(obj))",
          "new_line_content": "    float userunit = 1.0;",
          "content_same": false
        },
        {
          "line": 2051,
          "old_api": "invert_matrix",
          "new_api": null,
          "old_text": "invert_matrix(&c",
          "new_text": null,
          "old_line_content": "            userunit = pdf_to_real(obj);",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 4102,
          "old_api": "(&ctxAccess);\n\n    if",
          "new_api": null,
          "old_text": "(&ctxAccess);\n\n    if",
          "new_text": null,
          "old_line_content": "    HBRUSH bgBrush = CreateSolidBrush(RGB(0xFF, 0xFF, 0xFF));",
          "new_line_content": "        fz_matrix trans;",
          "content_same": false
        },
        {
          "line": 4104,
          "old_api": "FZ_NO_CACHE);\n\n    // use an inf",
          "new_api": null,
          "old_text": "FZ_NO_CACHE);\n\n    // use an inf",
          "new_text": null,
          "old_line_content": "    FillRect(hDC, &tmpRect, bgBrush); // initialize white background",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4105,
          "old_api": "a mediabox) to ensure",
          "new_api": null,
          "old_text": "a mediabox) to ensure",
          "new_text": null,
          "old_line_content": "    DeleteObject(bgBrush);",
          "new_line_content": "    else",
          "content_same": false
        },
        {
          "line": 2059,
          "old_api": "float zoom, int rotatio",
          "new_api": null,
          "old_text": "float zoom, int rotatio",
          "new_text": null,
          "old_line_content": "    if (!fz_is_empty_rect(&cbox)) {",
          "new_line_content": "    fz_catch(ctx) { }",
          "content_same": false
        },
        {
          "line": 4107,
          "old_api": "between cached runs using a",
          "new_api": null,
          "old_text": " between cached runs using a",
          "new_text": null,
          "old_line_content": "    fz_rect cliprect = fz_RectD_to_rect(screenRect.Convert<double>());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2062,
          "old_api": ">me))",
          "new_api": null,
          "old_text": ">me))\n ",
          "new_text": null,
          "old_line_content": "            return RectD();",
          "new_line_content": "        mbox.x0 = 0; mbox.y0 = 0;",
          "content_same": false
        },
        {
          "line": 2069,
          "old_api": "if (pageRect)",
          "new_api": null,
          "old_text": "     if (pageRect)\n           ",
          "new_text": null,
          "old_line_content": "    fz_transform_rect(&mbox, fz_rotate(&ctm, (float)rotate));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4118,
          "old_api": "t;\n}\n\nunsigned char *XpsEngineImpl::GetFil",
          "new_api": null,
          "old_text": "t;\n}\n\nunsigned char *XpsEngineImpl::GetFil",
          "new_text": null,
          "old_line_content": "        dev = fz_new_gdiplus_device(ctx, hDC, &cliprect);",
          "new_line_content": "    fz_irect tmp;",
          "content_same": false
        },
        {
          "line": 2071,
          "old_api": "t);\n        else\n            pdf_bound_page(_doc, page, &pRect);\n        fz",
          "new_api": null,
          "old_text": "t);\n        else\n            pdf_bound_page(_doc, page, &pRect);\n        fz",
          "new_text": null,
          "old_line_content": "    _mediaboxes[pageNo-1] = RectD(0, 0, (mbox.x1 - mbox.x0) * userunit, (mbox.y1 - mbox.y0) * userunit);",
          "new_line_content": "        rotate = 0;",
          "content_same": false
        },
        {
          "line": 4121,
          "old_api": "har *data = NULL;\n    ScopedCrit",
          "new_api": null,
          "old_text": "har *data = NULL;\n    ScopedCrit",
          "new_text": null,
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "    fz_device *dev = NULL;",
          "content_same": false
        },
        {
          "line": 2078,
          "old_api": ")screenRect.y - bb",
          "new_api": null,
          "old_text": ")screenRect.y - bb",
          "new_text": null,
          "old_line_content": "    pdf_page *page = GetPdfPage(pageNo);",
          "new_line_content": "    return _mediaboxes[pageNo-1];",
          "content_same": false
        },
        {
          "line": 2080,
          "old_api": "= Crea",
          "new_api": null,
          "old_text": " = Crea",
          "new_text": null,
          "old_line_content": "        return RectD();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4129,
          "old_api": "Count) : NULL;\n    }\n    return data;\n}\n\nbool Xp",
          "new_api": null,
          "old_text": "Count) : NULL;\n    }\n    return data;\n}\n\nbool Xp",
          "new_text": null,
          "old_line_content": "    return RunPage(page, dev, ctm, &cliprect, true, cookie);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4134,
          "old_api": "bool ok = file::Wr",
          "new_api": null,
          "old_text": "bool ok = file::Wr",
          "new_text": null,
          "old_line_content": "    xps_page* page = GetXpsPage(pageNo);",
          "new_line_content": "        *cookie_out = cookie = new FitzAbortCookie();",
          "content_same": false
        },
        {
          "line": 2089,
          "old_api": "rect",
          "new_api": null,
          "old_text": "rect(screenRect.Convert<double>(",
          "new_text": null,
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "    fz_device *dev = NULL;",
          "content_same": false
        },
        {
          "line": 4142,
          "old_api": "yFile",
          "new_api": null,
          "old_text": "yFile(_fileName, copyFileName, FAL",
          "new_text": null,
          "old_line_content": "        xps_bound_page(_doc, page, &pRect);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 4143,
          "old_api": "eImpl::ExtractFontList()\n{",
          "new_api": null,
          "old_text": "eImpl::ExtractFontList()\n{\n  ",
          "new_text": null,
          "old_line_content": "    fz_matrix ctm = viewctm(page, zoom, rotation);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2099,
          "old_api": "terCriticalSection",
          "new_api": null,
          "old_text": "terCriticalSection(&ctxAcc",
          "new_text": null,
          "old_line_content": "    if (fz_is_infinite_rect(&rect))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2100,
          "old_api": "tx) {\n        dev =",
          "new_api": null,
          "old_text": "tx) {\n        dev = ",
          "new_text": null,
          "old_line_content": "        return PageMediabox(pageNo);",
          "new_line_content": "    fz_rect pagerect;",
          "content_same": false
        },
        {
          "line": 2103,
          "old_api": "LeaveCriticalSect",
          "new_api": null,
          "old_text": "   LeaveCriticalSect",
          "new_text": null,
          "old_line_content": "    return rect2.Intersect(PageMediabox(pageNo));",
          "new_line_content": "    if (!ok)",
          "content_same": false
        },
        {
          "line": 4156,
          "old_api": "tural",
          "new_api": null,
          "old_text": "tural();\n  ",
          "new_text": null,
          "old_line_content": "        HBITMAP hbmp = CreateMemoryBitmap(SizeI(w, h), &hMap);",
          "new_line_content": "        int w = bbox.x1 - bbox.x0, h = bbox.y1 - bbox.y0;",
          "content_same": false
        },
        {
          "line": 4157,
          "old_api": "WCHAR *Xp",
          "new_api": null,
          "old_text": "\n\nWCHAR *Xp",
          "new_text": null,
          "old_line_content": "        HDC hDC = GetDC(NULL);",
          "new_line_content": "        fz_matrix trans;",
          "content_same": false
        },
        {
          "line": 2110,
          "old_api": "ie",
          "new_api": null,
          "old_text": "ie();\n    return RunPage(pag",
          "new_text": null,
          "old_line_content": "        fz_invert_matrix(&ctm, &ctm);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 4159,
          "old_api": "== prop)\n        return E",
          "new_api": null,
          "old_text": " == prop)\n        return E",
          "new_text": null,
          "old_line_content": "        DeleteObject(SelectObject(hDCMem, hbmp));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2112,
          "old_api": "ous heuristics for deciding wh",
          "new_api": null,
          "old_text": "ous heuristics for deciding wh",
          "new_text": null,
          "old_line_content": "    fz_transform_point(&pt2, &ctm);",
          "new_line_content": "PointD PdfEngineImpl::Transform(PointD pt, int pageNo, float zoom, int rotation, bool inverse)",
          "content_same": false
        },
        {
          "line": 2113,
          "old_api": "gdiplus instead of f",
          "new_api": null,
          "old_text": "gdiplus instead of f",
          "new_text": null,
          "old_line_content": "    return PointD(pt2.x, pt2.y);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 4166,
          "old_api": "n str::Dup(_info->",
          "new_api": null,
          "old_text": "n str::Dup(_info->",
          "new_text": null,
          "old_line_content": "            DeleteObject(hbmp);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4167,
          "old_api": "ase Prop_Creation",
          "new_api": null,
          "old_text": "ase Prop_Creation",
          "new_text": null,
          "old_line_content": "            CloseHandle(hMap);",
          "new_line_content": "        RectI rc(0, 0, w, h);",
          "content_same": false
        },
        {
          "line": 2120,
          "old_api": "false;\n    // dev_gdiplus s",
          "new_api": null,
          "old_text": " false;\n    // dev_gdiplus s",
          "new_text": null,
          "old_line_content": "        fz_invert_matrix(&ctm, &ctm);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2121,
          "old_api": "er at clipping than fi",
          "new_api": null,
          "old_text": "er at clipping than fi",
          "new_text": null,
          "old_line_content": "    fz_rect rect2 = fz_RectD_to_rect(rect);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2122,
          "old_api": "if (run->clip_path_len > 5",
          "new_api": null,
          "old_text": "\n    if (run->clip_path_len > 5",
          "new_text": null,
          "old_line_content": "    fz_transform_rect(&rect2, &ctm);",
          "new_line_content": "RectD PdfEngineImpl::Transform(RectD rect, int pageNo, float zoom, int rotation, bool inverse)",
          "content_same": false
        },
        {
          "line": 2123,
          "old_api": "result = false;\n    //",
          "new_api": null,
          "old_text": "result = false;\n    // ",
          "new_text": null,
          "old_line_content": "    return fz_rect_to_RectD(rect2);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 4174,
          "old_api": ";\n    }\n};\n\nbool XpsEngineImpl::",
          "new_api": null,
          "old_text": ";\n    }\n};\n\nbool XpsEngineImpl::",
          "new_text": null,
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "            return NULL;",
          "content_same": false
        },
        {
          "line": 4177,
          "old_api": "mpl::UpdateUserAnnotations(Vec<PageAnnotation>",
          "new_api": null,
          "old_text": "mpl::UpdateUserAnnotations(Vec<PageAnnotation> ",
          "new_text": null,
          "old_line_content": "        image = fz_new_pixmap_with_bbox(ctx, colorspace, &bbox);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4178,
          "old_api": "// TODO: use a new critical section to avo",
          "new_api": null,
          "old_text": "  // TODO: use a new critical section to avo",
          "new_text": null,
          "old_line_content": "        fz_clear_pixmap_with_value(ctx, image, 0xFF); // initialize white background",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2133,
          "old_api": "of) paths\n    // (only requi",
          "new_api": null,
          "old_text": " of) paths\n    // (only requi",
          "new_text": null,
          "old_line_content": "        ctm2 = viewctm(page, zoom, rotation);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 4181,
          "old_api": "(list)\n        userAnnots = *lis",
          "new_api": null,
          "old_text": "(list)\n        userAnnots = *lis",
          "new_text": null,
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 2137,
          "old_api": "> 100000) {\n        fz_rect",
          "new_api": null,
          "old_text": "> 100000) {\n        fz_rect",
          "new_text": null,
          "old_line_content": "            pRect = fz_RectD_to_rect(*pageRect);",
          "new_line_content": "    fz_matrix ctm2;",
          "content_same": false
        },
        {
          "line": 2141,
          "old_api": "d_page",
          "new_api": null,
          "old_text": "d_page(_doc, page, &r));\n     ",
          "new_text": null,
          "old_line_content": "        fz_round_rect(&bbox, fz_transform_rect(&pRect, ctm));",
          "new_line_content": "        fz_rect pRect;",
          "content_same": false
        },
        {
          "line": 4190,
          "old_api": "f (!page)\n        return N",
          "new_api": null,
          "old_text": "f (!page)\n        return N",
          "new_text": null,
          "old_line_content": "        fz_drop_pixmap(ctx, image);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4191,
          "old_api": "z_point p = { (float)pt.x, (floa",
          "new_api": null,
          "old_text": "z_point p = { (float)pt.x, (floa",
          "new_text": null,
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "    fz_device *dev = NULL;",
          "content_same": false
        },
        {
          "line": 2146,
          "old_api": "Bitmap *PdfEngineImpl",
          "new_api": null,
          "old_text": "Bitmap *PdfEngineImpl",
          "new_text": null,
          "old_line_content": "    HBRUSH bgBrush = CreateSolidBrush(RGB(0xFF, 0xFF, 0xFF));",
          "new_line_content": "        fz_irect bbox;",
          "content_same": false
        },
        {
          "line": 4194,
          "old_api": "age->links; link; link = link->n",
          "new_api": null,
          "old_text": "age->links; link; link = link->n",
          "new_text": null,
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2148,
          "old_api": "on, RectD *pageRect, RenderTarge",
          "new_api": null,
          "old_text": "on, RectD *pageRect, RenderTarge",
          "new_text": null,
          "old_line_content": "    FillRect(hDC, &tmpRect, bgBrush); // initialize white background",
          "new_line_content": "        fz_matrix trans;",
          "content_same": false
        },
        {
          "line": 2151,
          "old_api": "dict",
          "new_api": null,
          "old_text": "dict(page->me))\n        retu",
          "new_text": null,
          "old_line_content": "    fz_rect cliprect = fz_RectD_to_rect(screenRect.Convert<double>());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4207,
          "old_api": "urn NULL;\n}\n\nVec<PageEleme",
          "new_api": null,
          "old_text": "urn NULL;\n}\n\nVec<PageEleme",
          "new_text": null,
          "old_line_content": "    fz_drop_pixmap(ctx, image);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2162,
          "old_api": "iPlusDevice) {\n        int w = bbox.x1 - b",
          "new_api": null,
          "old_text": "iPlusDevice) {\n        int w = bbox.x1 - b",
          "new_text": null,
          "old_line_content": "        dev = fz_new_gdiplus_device(ctx, hDC, &cliprect);",
          "new_line_content": "    fz_irect tmp;",
          "content_same": false
        },
        {
          "line": 2165,
          "old_api": "fz_matrix trans;\n        fz_conc",
          "new_api": null,
          "old_text": "fz_matrix trans;\n        fz_conc",
          "new_text": null,
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "    fz_device *dev = NULL;",
          "content_same": false
        },
        {
          "line": 4095,
          "old_api": "ctx);\n        dev = fz_new_tex",
          "new_api": null,
          "old_text": "ctx);\n        dev = fz_new_tex",
          "new_text": null,
          "old_line_content": "        fz_round_rect(&bbox, fz_transform_rect(&pRect, ctm));",
          "new_line_content": "        fz_rect pRect;",
          "content_same": false
        },
        {
          "line": 124,
          "old_api": "z_colorspace",
          "new_api": null,
          "old_text": "z_colorspace ",
          "new_text": null,
          "old_line_content": "        free(bmpData);",
          "new_line_content": "            dest += rows8 - w;",
          "content_same": false
        },
        {
          "line": 2173,
          "old_api": "P hbmp = CreateMemoryBitmap(SizeI(w, h), &hMap);",
          "new_api": null,
          "old_text": "P hbmp = CreateMemoryBitmap(SizeI(w, h), &hMap);\n       ",
          "new_text": null,
          "old_line_content": "    return RunPage(page, dev, ctm, target, &cliprect, true, cookie);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4219,
          "old_api": "Vec<PageElem",
          "new_api": null,
          "old_text": " Vec<PageElem",
          "new_text": null,
          "old_line_content": "    fz_var(sheet);",
          "new_line_content": "    if (!page)",
          "content_same": false
        },
        {
          "line": 4220,
          "old_api": "*els = new V",
          "new_api": null,
          "old_text": "*els = new V",
          "new_text": null,
          "old_line_content": "    fz_var(text);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 128,
          "old_api": "fz_convert_",
          "new_api": null,
          "old_text": "       fz_convert_",
          "new_text": null,
          "old_line_content": "            fz_colorspace *colorspace = fz_device_bgr(ctx);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 129,
          "old_api": "return NULL;\n        }",
          "new_api": null,
          "old_text": "          return NULL;\n        }\n ",
          "new_text": null,
          "old_line_content": "            bgrPixmap = fz_new_pixmap_with_bbox(ctx, colorspace, fz_pixmap_bbox(ctx, pixmap, &bbox));",
          "new_line_content": "    if (!hasPalette) {",
          "content_same": false
        },
        {
          "line": 4222,
          "old_api": "ement *>();\n    if (!els)",
          "new_api": null,
          "old_text": "ement *>();\n    if (!els)\n      ",
          "new_text": null,
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "    fz_text_sheet *sheet = NULL;",
          "content_same": false
        },
        {
          "line": 4224,
          "old_api": "eNo-1]) {\n        for",
          "new_api": null,
          "old_text": "eNo-1]) {\n        for ",
          "new_text": null,
          "old_line_content": "        sheet = fz_new_text_sheet(ctx);",
          "new_line_content": "    fz_device *dev = NULL;",
          "content_same": false
        },
        {
          "line": 4229,
          "old_api": "o-1][i], i));\n        }",
          "new_api": null,
          "old_text": "o-1][i], i));\n        }\n    ",
          "new_text": null,
          "old_line_content": "        fz_free_text_page(ctx, text);",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 138,
          "old_api": ">biCompre",
          "new_api": null,
          "old_text": ">biCompre",
          "new_text": null,
          "old_line_content": "    BITMAPINFOHEADER *bmih = &bmi.Get()->bmiHeader;",
          "new_line_content": "        fz_catch(ctx) {",
          "content_same": false
        },
        {
          "line": 4234,
          "old_api": "ink->rect, pageNo));\n    }",
          "new_api": null,
          "old_text": "ink->rect, pageNo));\n    }\n\n    ",
          "new_text": null,
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "    fz_catch(ctx) {",
          "content_same": false
        },
        {
          "line": 4242,
          "old_api": "else\n        page->links_resolved = 1;\n    asse",
          "new_api": null,
          "old_text": " else\n        page->links_resolved = 1;\n    asse",
          "new_text": null,
          "old_line_content": "    RunPage(page, dev, &fz_identity, NULL, cacheRun);",
          "new_line_content": "    if (!cacheRun)",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": "LORS, &data, hMap, 0);\n    if (hbmp)\n        memcpy(data, hasPalette ? bmpData : bgrPixma",
          "new_api": null,
          "old_text": "LORS, &data, hMap, 0);\n    if (hbmp)\n        memcpy(data, hasPalette ? bmpData : bgrPixma",
          "new_text": null,
          "old_line_content": "    HANDLE hMap = CreateFileMapping(INVALID_HANDLE_VALUE, NULL, PAGE_READWRITE, 0, bmih->biSizeImage, NULL);",
          "new_line_content": "    bmih->biCompression = BI_RGB;",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": "zeImage);\n\n    if (hasPalette)\n        free(bmpData);\n    e",
          "new_api": null,
          "old_text": "zeImage);\n\n    if (hasPalette)\n        free(bmpData);\n    e",
          "new_text": null,
          "old_line_content": "    HBITMAP hbmp = CreateDIBSection(NULL, bmi, DIB_RGB_COLORS, &data, hMap, 0);",
          "new_line_content": "    bmih->biBitCount = hasPalette ? 8 : 32;",
          "content_same": false
        },
        {
          "line": 2198,
          "old_api": "fz_try(ctx) {\n        dev =",
          "new_api": null,
          "old_text": "   fz_try(ctx) {\n        dev =",
          "new_text": null,
          "old_line_content": "        fz_round_rect(&clipBox, &clip);",
          "new_line_content": "        result = false;",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": "(ctx, bgrPixmap);\n\n    // return a RenderedBitmap even if hbmp is NULL so",
          "new_api": null,
          "old_text": "(ctx, bgrPixmap);\n\n    // return a RenderedBitmap even if hbmp is NULL so ",
          "new_text": null,
          "old_line_content": "        memcpy(data, hasPalette ? bmpData : bgrPixmap->samples, bmih->biSizeImage);",
          "new_line_content": "    bmih->biClrUsed = hasPalette ? paletteSize : 0;",
          "content_same": false
        },
        {
          "line": 2199,
          "old_api": "}\n    fz_catch(ctx) {",
          "new_api": null,
          "old_text": "  }\n    fz_catch(ctx) {\n      ",
          "new_text": null,
          "old_line_content": "        fz_round_rect(&pageBox, pdf_bound_page(_doc, page, &r));",
          "new_line_content": "    // dev_gdiplus seems significantly faster at rendering large (amounts of) paths",
          "content_same": false
        },
        {
          "line": 4246,
          "old_api": "ScopedMem<WCHAR> pageText(ExtractPageText(pa",
          "new_api": null,
          "old_text": "  ScopedMem<WCHAR> pageText(ExtractPageText(pa",
          "new_text": null,
          "old_line_content": "    WCHAR *content = fz_text_page_to_str(text, lineSep, coords_out);",
          "new_line_content": "    // the extracted text is consistent between cached runs using a list device and",
          "content_same": false
        },
        {
          "line": 2203,
          "old_api": "*cookie = NULL;",
          "new_api": null,
          "old_text": " *cookie = NULL;",
          "new_text": null,
          "old_line_content": "    DropPageRun(run);",
          "new_line_content": "        fz_irect clipBox, pageBox;",
          "content_same": false
        },
        {
          "line": 4247,
          "old_api": "n\", &coords, true));\n    if",
          "new_api": null,
          "old_text": "n\", &coords, true));\n    if ",
          "new_text": null,
          "old_line_content": "    fz_free_text_page(ctx, text);",
          "new_line_content": "    // fresh runs (otherwise the list device omits text outside the mediabox bounds)",
          "content_same": false
        },
        {
          "line": 157,
          "old_api": "ce exhaustion\n    // (and in t",
          "new_api": null,
          "old_text": "ce exhaustion\n    // (and in t",
          "new_text": null,
          "old_line_content": "        fz_drop_pixmap(ctx, bgrPixmap);",
          "new_line_content": "    if (hbmp)",
          "content_same": false
        },
        {
          "line": 162,
          "old_api": ");\n    // l",
          "new_api": null,
          "old_text": ");\n    // l",
          "new_text": null,
          "old_line_content": "    return new RenderedBitmap(hbmp, SizeI(w, h), hMap);",
          "new_line_content": "    else",
          "content_same": false
        },
        {
          "line": 2210,
          "old_api": "RenderedBitmap *bit",
          "new_api": null,
          "old_text": "  RenderedBitmap *bit",
          "new_text": null,
          "old_line_content": "    if (!page || !pdf_is_dict(page->me))",
          "new_line_content": "    return result;",
          "content_same": false
        },
        {
          "line": 4258,
          "old_api": "= next->next)\n            overlaps = fz_ca",
          "new_api": null,
          "old_text": " = next->next)\n            overlaps = fz_ca",
          "new_text": null,
          "old_line_content": "        data = fz_extract_stream_data(_doc->file, cbCount);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4261,
          "old_api": "{\n            ScopedMem<char> ur",
          "new_api": null,
          "old_text": " {\n            ScopedMem<char> ur",
          "new_text": null,
          "old_line_content": "        return _fileName ? (unsigned char *)file::ReadAll(_fileName, cbCount) : NULL;",
          "new_line_content": "    unsigned char *data = NULL;",
          "content_same": false
        },
        {
          "line": 2217,
          "old_api": "PageElement *PdfEngineImpl::GetEl",
          "new_api": null,
          "old_text": "\nPageElement *PdfEngineImpl::GetEl",
          "new_text": null,
          "old_line_content": "        pdf_bound_page(_doc, page, &pRect);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 2218,
          "old_api": "PointD pt)\n{\n    pdf_page *pa",
          "new_api": null,
          "old_text": "PointD pt)\n{\n    pdf_page *pa",
          "new_text": null,
          "old_line_content": "    fz_matrix ctm = viewctm(page, zoom, rotation);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 173,
          "old_api": "*)data->dat",
          "new_api": null,
          "old_text": " *)data->dat",
          "new_text": null,
          "old_line_content": "        fz_var(data);",
          "new_line_content": "    fz_stream *file = NULL;",
          "content_same": false
        },
        {
          "line": 4269,
          "old_api": "// add links in to",
          "new_api": null,
          "old_text": "   // add links in to",
          "new_text": null,
          "old_line_content": "    ScopedMem<unsigned char> data(GetFileData(&dataLen));",
          "new_line_content": "    return data;",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": "_buffer",
          "new_api": null,
          "old_text": "_buffer(ctx, data);\n        }\n   ",
          "new_text": null,
          "old_line_content": "            data = fz_new_buffer(ctx, (int)fileSize);",
          "new_line_content": "    // load small files entirely into memory so that they can be",
          "content_same": false
        },
        {
          "line": 4271,
          "old_api": "z_new_link",
          "new_api": null,
          "old_text": "z_new_link",
          "new_text": null,
          "old_line_content": "        bool ok = file::WriteAll(copyFileName, data.Get(), dataLen);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 177,
          "old_api": "fz_drop_buffer(ctx, data);\n        if (file)",
          "new_api": null,
          "old_text": "     fz_drop_buffer(ctx, data);\n        if (file)\n  ",
          "new_text": null,
          "old_line_content": "            if (file::ReadN(filePath, (char *)data->data, data->len))",
          "new_line_content": "    if (fileSize > 0 && fileSize < MAX_MEMORY_FILE_SIZE) {",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": "}\n\n    fz_try(ctx) {",
          "new_api": null,
          "old_text": " }\n\n    fz_try(ctx) {\n   ",
          "new_text": null,
          "old_line_content": "                file = fz_open_buffer(ctx, data);",
          "new_line_content": "        fz_buffer *data = NULL;",
          "content_same": false
        },
        {
          "line": 2226,
          "old_api": "s, &link->dest, link->rect, pageNo, &p);\n    }\n\n    if",
          "new_api": null,
          "old_text": "s, &link->dest, link->rect, pageNo, &p);\n    }\n\n    if",
          "new_text": null,
          "old_line_content": "        fz_concat(&ctm, &ctm, fz_translate(&trans, (float)-bbox.x0, (float)-bbox.y0));",
          "new_line_content": "    fz_irect bbox;",
          "content_same": false
        },
        {
          "line": 2230,
          "old_api": "rect = anno",
          "new_api": null,
          "old_text": "rect = anno",
          "new_text": null,
          "old_line_content": "        HBITMAP hbmp = CreateMemoryBitmap(SizeI(w, h), &hMap);",
          "new_line_content": "        int w = bbox.x1 - bbox.x0, h = bbox.y1 - bbox.y0;",
          "content_same": false
        },
        {
          "line": 2231,
          "old_api": "form_rect",
          "new_api": null,
          "old_text": "form_rect(&",
          "new_text": null,
          "old_line_content": "        HDC hDC = GetDC(NULL);",
          "new_line_content": "        fz_matrix trans;",
          "content_same": false
        },
        {
          "line": 2233,
          "old_api": "ScopedCritSec sco",
          "new_api": null,
          "old_text": "         ScopedCritSec sco",
          "new_text": null,
          "old_line_content": "        DeleteObject(SelectObject(hDCMem, hbmp));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4284,
          "old_api": "ge)\n        r",
          "new_api": null,
          "old_text": "ge)\n        r",
          "new_text": null,
          "old_line_content": "        GetXpsPage(i);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2241,
          "old_api": "or (size_t i = 0;",
          "new_api": null,
          "old_text": "or (size_t i = 0; ",
          "new_text": null,
          "old_line_content": "            DeleteObject(hbmp);",
          "new_line_content": "        RectI rc(0, 0, w, h);",
          "content_same": false
        },
        {
          "line": 4291,
          "old_api": "a);\n    }\n    fz_catch(ctx) {",
          "new_api": null,
          "old_text": "a);\n    }\n    fz_catch(ctx) {\n ",
          "new_text": null,
          "old_line_content": "        ScopedMem<WCHAR> path(str::conv::FromUtf8(font->name));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4292,
          "old_api": "cess);\n        return NULL;\n    }",
          "new_api": null,
          "old_text": "cess);\n        return NULL;\n    }\n   ",
          "new_text": null,
          "old_line_content": "        ScopedMem<WCHAR> name(str::conv::FromUtf8(font->font->name));",
          "new_line_content": "    ScopedCritSec scope(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4293,
          "old_api": "ev, &fz_identity);",
          "new_api": null,
          "old_text": "ev, &fz_identity);\n\n   ",
          "new_text": null,
          "old_line_content": "        fonts.Append(str::Format(L\"%s (%s)\", name, path::GetBaseName(path)));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": "ta = (unsigned char *",
          "new_api": null,
          "old_text": "ta = (unsigned char *",
          "new_text": null,
          "old_line_content": "    fz_seek(stream, 0, 2);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": "buffer->len);",
          "new_api": null,
          "old_text": " buffer->len);\n",
          "new_text": null,
          "old_line_content": "    int fileLen = fz_tell(stream);",
          "new_line_content": "    return file;",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "(cbCount)\n        *cb",
          "new_api": null,
          "old_text": "(cbCount)\n        *cb",
          "new_text": null,
          "old_line_content": "    fz_seek(stream, 0, 0);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2249,
          "old_api": "eNo-1][i], i);\n    }\n\n    return",
          "new_api": null,
          "old_text": "eNo-1][i], i);\n    }\n\n    return",
          "new_text": null,
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "            return NULL;",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": "drop_buffer",
          "new_api": null,
          "old_text": "drop_buffer(stream->ctx, buf",
          "new_text": null,
          "old_line_content": "    fz_buffer *buffer = fz_read_all(stream, fileLen);",
          "new_line_content": "unsigned char *fz_extract_stream_data(fz_stream *stream, size_t *cbCount)",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": "if (!data)\n        fz_thro",
          "new_api": null,
          "old_text": "    if (!data)\n        fz_thro",
          "new_text": null,
          "old_line_content": "    assert(fileLen == buffer->len);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2252,
          "old_api": "PdfPage",
          "new_api": null,
          "old_text": "PdfPage(pageNo, true);\n    if (!page)\n        r",
          "new_text": null,
          "old_line_content": "        image = fz_new_pixmap_with_bbox(ctx, colorspace, &bbox);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2253,
          "old_api": "// since all elements lists are in las",
          "new_api": null,
          "old_text": "\n\n    // since all elements lists are in las",
          "new_text": null,
          "old_line_content": "        fz_clear_pixmap_with_value(ctx, image, 0xFF); // initialize white background",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4295,
          "old_api": "Count",
          "new_api": null,
          "old_text": "tions.Count()",
          "new_text": null,
          "old_line_content": "    if (fonts.Count() == 0)",
          "new_line_content": "    WStrVec fonts;",
          "content_same": false
        },
        {
          "line": 2256,
          "old_api": "e the whole list at the end",
          "new_api": null,
          "old_text": "e the whole list at the end\n    ",
          "new_text": null,
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": "NULL;\n\n    fz_try(file->ctx) {\n        fz_seek(file, 0, 2);\n        file",
          "new_api": null,
          "old_text": "NULL;\n\n    fz_try(file->ctx) {\n        fz_seek(file, 0, 2);\n        file",
          "new_text": null,
          "old_line_content": "        fz_throw(stream->ctx, FZ_ERROR_GENERIC, \"OOM in fz_extract_stream_data\");",
          "new_line_content": "    if (cbCount)",
          "content_same": false
        },
        {
          "line": 4310,
          "old_api": "image->h);\n    }\n    f",
          "new_api": null,
          "old_text": "image->h);\n    }\n    f",
          "new_text": null,
          "old_line_content": "    case Prop_Title: return str::Dup(_info->title);",
          "new_line_content": "    if (Prop_FontList == prop)",
          "content_same": false
        },
        {
          "line": 4312,
          "old_api": "ap",
          "new_api": null,
          "old_text": "ap(ctx, pixmap);\n    fz_",
          "new_text": null,
          "old_line_content": "    case Prop_Subject: return str::Dup(_info->subject);",
          "new_line_content": "    if (!_info)",
          "content_same": false
        },
        {
          "line": 2265,
          "old_api": "(&imageRects[pageNo-1][i])",
          "new_api": null,
          "old_text": "(&imageRects[pageNo-1][i])",
          "new_text": null,
          "old_line_content": "        fz_drop_pixmap(ctx, image);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2266,
          "old_api": "Append",
          "new_api": null,
          "old_text": "        els->Append(new PdfImage",
          "new_text": null,
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "    fz_device *dev = NULL;",
          "content_same": false
        },
        {
          "line": 4313,
          "old_api": "bmp;\n}\n\nfz_rect XpsEngineImpl:",
          "new_api": null,
          "old_text": "bmp;\n}\n\nfz_rect XpsEngineImpl:",
          "new_text": null,
          "old_line_content": "    case Prop_CreationDate: return str::Dup(_info->creation_date);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 4314,
          "old_api": "(str::IsEmpty(target))\n        re",
          "new_api": null,
          "old_text": " (str::IsEmpty(target))\n        re",
          "new_text": null,
          "old_line_content": "    case Prop_ModificationDate: return str::Dup(_info->modification_date);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2269,
          "old_api": "i], i));\n    }\n\n    if (pageAnno",
          "new_api": null,
          "old_text": "i], i));\n    }\n\n    if (pageAnno",
          "new_text": null,
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 222,
          "old_api": "n't read stream d",
          "new_api": null,
          "old_text": "n't read stream d",
          "new_text": null,
          "old_line_content": "    fz_try(file->ctx) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": "NULL fingerprint i",
          "new_api": null,
          "old_text": " NULL fingerprint i",
          "new_text": null,
          "old_line_content": "        fz_seek(file, 0, 2);",
          "new_line_content": "void fz_stream_fingerprint(fz_stream *file, unsigned char digest[16])",
          "content_same": false
        },
        {
          "line": 224,
          "old_api": "oMemory",
          "new_api": null,
          "old_text": "oMemory(diges",
          "new_text": null,
          "old_line_content": "        fileLen = fz_tell(file);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "return;\n    }",
          "new_api": null,
          "old_text": "     return;\n    }\n",
          "new_text": null,
          "old_line_content": "        fz_seek(file, 0, 0);",
          "new_line_content": "    int fileLen = -1;",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": "buffer);\n    CrashIf(fileL",
          "new_api": null,
          "old_text": "buffer);\n    CrashIf(fileL",
          "new_text": null,
          "old_line_content": "        buffer = fz_read_all(file, fileLen);",
          "new_line_content": "    fz_buffer *buffer = NULL;",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": "AR *fz_text_page_to_str",
          "new_api": null,
          "old_text": "AR *fz_text_page_to_str",
          "new_text": null,
          "old_line_content": "    CrashIf(NULL == buffer);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2282,
          "old_api": "fComment",
          "new_api": null,
          "old_text": "fComment(contents, fz_rect",
          "new_text": null,
          "old_line_content": "    fz_drop_pixmap(ctx, image);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4331,
          "old_api": "tion *XpsEngineImp",
          "new_api": null,
          "old_text": "tion *XpsEngineImp",
          "new_text": null,
          "old_line_content": "        userAnnots.Reset();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": "size_t lineSe",
          "new_api": null,
          "old_text": "    size_t lineSe",
          "new_text": null,
          "old_line_content": "    fz_md5_init(&md5);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": "str::Len(lineSep);\n    size_t textLen = 0;",
          "new_api": null,
          "old_text": "str::Len(lineSep);\n    size_t textLen = 0;\n   ",
          "new_text": null,
          "old_line_content": "    fz_md5_update(&md5, buffer->data, buffer->len);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4336,
          "old_api": "(!str::StartsWith(name_u",
          "new_api": null,
          "old_text": "(!str::StartsWith(name_u",
          "new_text": null,
          "old_line_content": "    xps_page *page = GetXpsPage(pageNo, true);",
          "new_line_content": "    else",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": "block < text->blocks + text->len",
          "new_api": null,
          "old_text": " block < text->blocks + text->len",
          "new_text": null,
          "old_line_content": "    fz_drop_buffer(file->ctx, buffer);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 246,
          "old_api": ".text->lines; lin",
          "new_api": null,
          "old_text": ".text->lines; lin",
          "new_text": null,
          "old_line_content": "    size_t lineSepLen = str::Len(lineSep);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4346,
          "old_api": "tline *entry, int& idCounter)\n{\n    XpsToc",
          "new_api": null,
          "old_text": "tline *entry, int& idCounter)\n{\n    XpsToc",
          "new_text": null,
          "old_line_content": "        for (int i = 0; !fz_is_empty_rect(&imageRects[pageNo-1][i]); i++)",
          "new_line_content": "    fz_point p = { (float)pt.x, (float)pt.y };",
          "content_same": false
        },
        {
          "line": 4347,
          "old_api": "for (; entry; entry = entry->next) {",
          "new_api": null,
          "old_text": "for (; entry; entry = entry->next) {\n       ",
          "new_text": null,
          "old_line_content": "            if (fz_is_pt_in_rect(imageRects[pageNo-1][i], p))",
          "new_line_content": "    for (fz_link *link = page->links; link; link = link->next)",
          "content_same": false
        },
        {
          "line": 2302,
          "old_api": "Count",
          "new_api": null,
          "old_text": "list->links.Count(); i++) {\n        ",
          "new_text": null,
          "old_line_content": "            fz_transform_rect(&rect, &page->ctm);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2303,
          "old_api": "se;\n        for (fz_link",
          "new_api": null,
          "old_text": "se;\n        for (fz_link ",
          "new_text": null,
          "old_line_content": "            if (fz_is_pt_in_rect(rect, p)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2306,
          "old_api": "next->rect) >= 0.25f;\n        if (!ov",
          "new_api": null,
          "old_text": "next->rect) >= 0.25f;\n        if (!ov",
          "new_text": null,
          "old_line_content": "                ScopedMem<WCHAR> contents(str::conv::FromPdf(pdf_dict_gets(annot->obj, \"Contents\")));",
          "new_line_content": "            pdf_annot *annot = pageAnnots[pageNo-1][i];",
          "content_same": false
        },
        {
          "line": 259,
          "old_api": "rn NULL;\n        }\n    }",
          "new_api": null,
          "old_text": "rn NULL;\n        }\n    }\n\n    ",
          "new_text": null,
          "old_line_content": "    WCHAR *content = AllocArray<WCHAR>(textLen + 1);",
          "new_line_content": "                textLen += span->len + 1;",
          "content_same": false
        },
        {
          "line": 2307,
          "old_api": "At",
          "new_api": null,
          "old_text": "ToUtf8(list->links.At(",
          "new_text": null,
          "old_line_content": "                return new PdfComment(contents, fz_rect_to_RectD(rect), pageNo);",
          "new_line_content": "            fz_rect rect = annot->rect;",
          "content_same": false
        },
        {
          "line": 4356,
          "old_api": "item->open = entry->is_o",
          "new_api": null,
          "old_text": "item->open = entry->is_o",
          "new_text": null,
          "old_line_content": "    xps_page *page = GetXpsPage(pageNo, true);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2314,
          "old_api": "ttom order (i.e. last-to-first)",
          "new_api": null,
          "old_text": "ttom order (i.e. last-to-first)\n            ",
          "new_text": null,
          "old_line_content": "            if (fz_is_pt_in_rect(imageRects[pageNo-1][i], p))",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": "ine *line = b",
          "new_api": null,
          "old_text": "ine *line = b",
          "new_text": null,
          "old_line_content": "            free(content);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 4367,
          "old_api": "neImpl::GetTocTree()\n{\n    if (!HasTocTree",
          "new_api": null,
          "old_text": "neImpl::GetTocTree()\n{\n    if (!HasTocTree",
          "new_text": null,
          "old_line_content": "        for (int i = 0; !fz_is_empty_rect(&imageRects[pageNo-1][i]); i++) {",
          "new_line_content": "    // item types in inverse order and reverse the whole list at the end",
          "content_same": false
        },
        {
          "line": 4368,
          "old_api": "L;\n\n    int idCounter = 0;\n    return BuildTocTree(_outline, idCoun",
          "new_api": null,
          "old_text": "L;\n\n    int idCounter = 0;\n    return BuildTocTree(_outline, idCoun",
          "new_text": null,
          "old_line_content": "            els->Append(new XpsImage(this, pageNo, imageRects[pageNo-1][i], i));",
          "new_line_content": "    Vec<PageElement *> *els = new Vec<PageElement *>();",
          "content_same": false
        },
        {
          "line": 2323,
          "old_api": "EngineImpl::ProcessPageA",
          "new_api": null,
          "old_text": "EngineImpl::ProcessPageA",
          "new_text": null,
          "old_line_content": "    pdf_page *page = GetPdfPage(pageNo, true);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4376,
          "old_api": "ageRects[pageN",
          "new_api": null,
          "old_text": "ageRects[pageN",
          "new_text": null,
          "old_line_content": "    els->Reverse();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": "",
          "new_api": null,
          "old_text": "                ",
          "new_text": null,
          "old_line_content": "                        if (!str::IsWs(*dest))",
          "new_line_content": "            continue;",
          "content_same": false
        },
        {
          "line": 284,
          "old_api": "t_char_bbox",
          "new_api": null,
          "old_text": "t_char_bbox(&bbox, ",
          "new_text": null,
          "old_line_content": "                        else if (dest > content && !str::IsWs(dest[-1]))",
          "new_line_content": "                for (fz_text_char *c = span->text; c < span->text + span->len; c++) {",
          "content_same": false
        },
        {
          "line": 2334,
          "old_api": "fz_rect rect;\n            pdf_to_",
          "new_api": null,
          "old_text": "         fz_rect rect;\n            pdf_to_",
          "new_text": null,
          "old_line_content": "        for (size_t i = 0; !fz_is_empty_rect(&imageRects[pageNo-1][i]); i++)",
          "new_line_content": "    // item types in inverse order and reverse the whole list at the end",
          "content_same": false
        },
        {
          "line": 2335,
          "old_api": "ets",
          "new_api": null,
          "old_text": "ets(annot->obj, \"Rect\"), &rect);\n            if (file && embedded &",
          "new_text": null,
          "old_line_content": "            els->Append(new PdfImage(this, pageNo, imageRects[pageNo-1][i], i));",
          "new_line_content": "    Vec<PageElement *> *els = new Vec<PageElement *>();",
          "content_same": false
        },
        {
          "line": 4383,
          "old_api": "ect",
          "new_api": null,
          "old_text": "ect(&imageRects[pageNo",
          "new_text": null,
          "old_line_content": "    assert(!GetPageRun(page, true));",
          "new_line_content": "    return els;",
          "content_same": false
        },
        {
          "line": 4384,
          "old_api": "fz_calc_overlap",
          "new_api": null,
          "old_text": "fz_calc_overlap(",
          "new_text": null,
          "old_line_content": "    XpsPageRun *run = GetPageRun(page);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 4385,
          "old_api": "mageRects[pageNo-1][i]) >= 0.9f)",
          "new_api": null,
          "old_text": "mageRects[pageNo-1][i]) >= 0.9f)\n    ",
          "new_text": null,
          "old_line_content": "    assert(!run == !page->links_resolved);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4387,
          "old_api": "return true;\n}",
          "new_api": null,
          "old_text": " return true;\n}\n",
          "new_text": null,
          "old_line_content": "        DropPageRun(run);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": "(this might be a table)\n                    *d",
          "new_api": null,
          "old_text": "(this might be a table)\n                    *d",
          "new_text": null,
          "old_line_content": "                        fz_text_char_bbox(&bbox, span, c - span->text);",
          "new_line_content": "                        else",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": "Rect) {",
          "new_api": null,
          "old_text": "Rect) {\n                      ",
          "new_text": null,
          "old_line_content": "                        *destRect++ = fz_rect_to_RectD(bbox).Round();",
          "new_line_content": "                            continue;",
          "content_same": false
        },
        {
          "line": 2344,
          "old_api": "ded_num = pdf_to_num(embedded);",
          "new_api": null,
          "old_text": "ded_num = pdf_to_num(embedded);\n    ",
          "new_text": null,
          "old_line_content": "            fz_transform_rect(&rect, &page->ctm);",
          "new_line_content": "    if (pageAnnots[pageNo-1]) {",
          "content_same": false
        },
        {
          "line": 2345,
          "old_api": ";\n                ld.ld.launch.is_uri",
          "new_api": null,
          "old_text": ";\n                ld.ld.launch.is_uri",
          "new_text": null,
          "old_line_content": "            ScopedMem<WCHAR> contents(str::conv::FromPdf(pdf_dict_gets(annot->obj, \"Contents\")));",
          "new_line_content": "        ScopedCritSec scope(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 2346,
          "old_api": "ctm);",
          "new_api": null,
          "old_text": "ctm);\n                ",
          "new_text": null,
          "old_line_content": "            els->Append(new PdfComment(contents, fz_rect_to_RectD(rect), pageNo));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4397,
          "old_api": "ngineImpl::CreateFromStream(I",
          "new_api": null,
          "old_text": "ngineImpl::CreateFromStream(I",
          "new_text": null,
          "old_line_content": "    LinkRectList *list = LinkifyText(pageText, coords);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4398,
          "old_api": "eImpl *engine = new",
          "new_api": null,
          "old_text": "eImpl *engine = new",
          "new_text": null,
          "old_line_content": "    for (size_t i = 0; i < list->links.Count(); i++) {",
          "new_line_content": "    RectI *coords;",
          "content_same": false
        },
        {
          "line": 4401,
          "old_api": "File",
          "new_api": null,
          "old_text": "File(const WCHAR *",
          "new_text": null,
          "old_line_content": "            overlaps = fz_calc_overlap(list->coords.At(i), next->rect) >= 0.25f;",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": "tent;\n}\n\nstruct ist",
          "new_api": null,
          "old_text": "tent;\n}\n\nstruct ist",
          "new_text": null,
          "old_line_content": "            if (lineSepLen > 0 && dest > content && str::IsWs(dest[-1])) {",
          "new_line_content": "                        prev.dx /= 2;",
          "content_same": false
        },
        {
          "line": 2356,
          "old_api": "to the file p",
          "new_api": null,
          "old_text": " to the file p",
          "new_text": null,
          "old_line_content": "    els->Reverse();",
          "new_line_content": "    for (fz_link *link = page->links; link; link = link->next) {",
          "content_same": false
        },
        {
          "line": 4406,
          "old_api": "file::Exists(relsPa",
          "new_api": null,
          "old_text": "file::Exists(relsPa",
          "new_text": null,
          "old_line_content": "            ld.ld.uri.uri = fz_strdup(ctx, uri);",
          "new_line_content": "        for (fz_link *next = page->links; next && !overlaps; next = next->next)",
          "content_same": false
        },
        {
          "line": 311,
          "old_api": "fz_stre",
          "new_api": null,
          "old_text": "fz_stre",
          "new_text": null,
          "old_line_content": "                    *--destRect = RectI();",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 4408,
          "old_api": "els\") != (size_t)-",
          "new_api": null,
          "old_text": "els\") != (size_t)-",
          "new_text": null,
          "old_line_content": "            fz_link *link = fz_new_link(ctx, &list->coords.At(i), ld);",
          "new_line_content": "        if (!overlaps) {",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": "m_filter *state = (ist",
          "new_api": null,
          "old_text": "m_filter *state = (ist",
          "new_text": null,
          "old_line_content": "            lstrcpy(dest, lineSep);",
          "new_line_content": "            // remove trailing spaces",
          "content_same": false
        },
        {
          "line": 2363,
          "old_api": "Append",
          "new_api": null,
          "old_text": ".Append(annot);\n            }\n        }\n      ",
          "new_text": null,
          "old_line_content": "    assert(!page->links || page->links->refs == 1);",
          "new_line_content": "    return els;",
          "content_same": false
        },
        {
          "line": 2366,
          "old_api": "nnot->obj, \"Contents\"))) && annot->annot_type != FZ_ANNO",
          "new_api": null,
          "old_text": "nnot->obj, \"Contents\"))) && annot->annot_type != FZ_ANNO",
          "new_text": null,
          "old_line_content": "    ScopedMem<WCHAR> pageText(ExtractPageText(page, L\"\\n\", &coords, Target_View, true));",
          "new_line_content": "void PdfEngineImpl::LinkifyPageText(pdf_page *page)",
          "content_same": false
        },
        {
          "line": 4415,
          "old_api": "els/[0].last",
          "new_api": null,
          "old_text": "els/[0].last",
          "new_text": null,
          "old_line_content": "    free(coords);",
          "new_line_content": "            link->next = page->links;",
          "content_same": false
        },
        {
          "line": 2370,
          "old_api": "Count",
          "new_api": null,
          "old_text": " if (annots.Count() == 0)\n   ",
          "new_text": null,
          "old_line_content": "    LinkRectList *list = LinkifyText(pageText, coords);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2371,
          "old_api": "rder list into top-",
          "new_api": null,
          "old_text": "rder list into top-",
          "new_text": null,
          "old_line_content": "    for (size_t i = 0; i < list->links.Count(); i++) {",
          "new_line_content": "    RectI *coords;",
          "content_same": false
        },
        {
          "line": 4420,
          "old_api": "BaseEngine *Creat",
          "new_api": null,
          "old_text": "\nBaseEngine *Creat",
          "new_text": null,
          "old_line_content": "    xps_page *page = GetXpsPage(pageNo);",
          "new_line_content": "    delete list;",
          "content_same": false
        },
        {
          "line": 2374,
          "old_api": "fEngineImpl::GetPa",
          "new_api": null,
          "old_text": "fEngineImpl::GetPa",
          "new_text": null,
          "old_line_content": "            overlaps = fz_calc_overlap(list->coords.At(i), next->rect) >= 0.25f;",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 2379,
          "old_api": "terCriticalSection",
          "new_api": null,
          "old_text": "terCriticalSection(",
          "new_text": null,
          "old_line_content": "            ld.ld.uri.uri = fz_strdup(ctx, uri);",
          "new_line_content": "        for (fz_link *next = page->links; next && !overlaps; next = next->next)",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": "am *stm, int offset, int whence)\n{\n    istream_filter *state",
          "new_api": null,
          "old_text": "am *stm, int offset, int whence)\n{\n    istream_filter *state",
          "new_text": null,
          "old_line_content": "    HRESULT res = state->stream->Read(state->buf, sizeof(state->buf), &cbRead);",
          "new_line_content": "};",
          "content_same": false
        },
        {
          "line": 333,
          "old_api": "_filter *)s",
          "new_api": null,
          "old_text": "_filter *)s",
          "new_text": null,
          "old_line_content": "    if (FAILED(res))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": "LARGE_INTEGER off;\n    ULARGE_INTEGER n;\n    off.QuadPart = off",
          "new_api": null,
          "old_text": "    LARGE_INTEGER off;\n    ULARGE_INTEGER n;\n    off.QuadPart = off",
          "new_text": null,
          "old_line_content": "        fz_throw(stm->ctx, FZ_ERROR_GENERIC, \"IStream read error: %x\", res);",
          "new_line_content": "extern \"C\" static int next_istream(fz_stream *stm, int max)",
          "content_same": false
        },
        {
          "line": 2381,
          "old_api": "aveCriticalSection",
          "new_api": null,
          "old_text": "aveCriticalSection",
          "new_text": null,
          "old_line_content": "            fz_link *link = fz_new_link(ctx, &list->coords.At(i), ld);",
          "new_line_content": "        if (!overlaps) {",
          "content_same": false
        },
        {
          "line": 4428,
          "old_api": "EngineImpl::CreateFromStream(str",
          "new_api": null,
          "old_text": "EngineImpl::CreateFromStream(str",
          "new_text": null,
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 4430,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        dev = fz_new_inspection_device(ctx, &data);",
          "new_line_content": "    Vec<FitzImagePos> positions;",
          "content_same": false
        },
        {
          "line": 4433,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2388,
          "old_api": "if (imageIx",
          "new_api": null,
          "old_text": " if (imageIx",
          "new_text": null,
          "old_line_content": "    free(coords);",
          "new_line_content": "            link->next = page->links;",
          "content_same": false
        },
        {
          "line": 4438,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    RunPage(page, dev, &fz_identity);",
          "new_line_content": "    fz_catch(ctx) {",
          "content_same": false
        },
        {
          "line": 4440,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    if (imageIx >= positions.Count() || fz_rect_to_RectD(positions.At(imageIx).rect) != rect) {",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 4441,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        assert(0);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": "static void close_istream(fz_context",
          "new_api": null,
          "old_text": "static void close_istream(fz_context",
          "new_text": null,
          "old_line_content": "    HRESULT res = state->stream->Seek(off, whence, &n);",
          "new_line_content": "extern \"C\" static void seek_istream(fz_stream *stm, int offset, int whence)",
          "content_same": false
        },
        {
          "line": 349,
          "old_api": "*state_)\n{",
          "new_api": null,
          "old_text": " *state_)\n{",
          "new_text": null,
          "old_line_content": "    if (FAILED(res))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 350,
          "old_api": "m_filter *state = (istream_filter *)state_;\n    state->stream->Rele",
          "new_api": null,
          "old_text": "m_filter *state = (istream_filter *)state_;\n    state->stream->Rele",
          "new_text": null,
          "old_line_content": "        fz_throw(stm->ctx, FZ_ERROR_GENERIC, \"IStream seek error: %x\", res);",
          "new_line_content": "    istream_filter *state = (istream_filter *)stm->state;",
          "content_same": false
        },
        {
          "line": 2397,
          "old_api": "pixmap = fz_new_pixmap_fro",
          "new_api": null,
          "old_text": "     pixmap = fz_new_pixmap_fro",
          "new_text": null,
          "old_line_content": "            pdf_obj *file = pdf_dict_gets(annot->obj, \"FS\");",
          "new_line_content": "pdf_annot **PdfEngineImpl::ProcessPageAnnotations(pdf_page *page)",
          "content_same": false
        },
        {
          "line": 352,
          "old_api": "m",
          "new_api": null,
          "old_text": "m(fz_context *ctx, IStream *stream);\n\nextern \"C\" static fz_stream *reopen_ist",
          "new_text": null,
          "old_line_content": "        fz_throw(stm->ctx, FZ_ERROR_GENERIC, \"documents beyond 2GB aren't supported\");",
          "new_line_content": "    ULARGE_INTEGER n;",
          "content_same": false
        },
        {
          "line": 2398,
          "old_api": "fz_catch(ctx) {",
          "new_api": null,
          "old_text": " fz_catch(ctx) {\n        ",
          "new_text": null,
          "old_line_content": "            pdf_obj *embedded = pdf_dict_getsa(pdf_dict_gets(file, \"EF\"), \"DOS\", \"F\");",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2400,
          "old_api": "pixmap);\n    fz_drop_pixmap(ctx,",
          "new_api": null,
          "old_text": " pixmap);\n    fz_drop_pixmap(ctx,",
          "new_text": null,
          "old_line_content": "            pdf_to_rect(ctx, pdf_dict_gets(annot->obj, \"Rect\"), &rect);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2401,
          "old_api": "pl::ExtractPageText(pdf",
          "new_api": null,
          "old_text": "pl::ExtractPageText(pdf",
          "new_text": null,
          "old_line_content": "            if (file && embedded && !fz_is_empty_rect(&rect)) {",
          "new_line_content": "    for (pdf_annot *annot = page->annots; annot; annot = annot->next) {",
          "content_same": false
        },
        {
          "line": 4449,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        fz_image *image = positions.At(imageIx).image;",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4450,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        pixmap = fz_new_pixmap_from_image(ctx, image, image->w, image->h);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": "res)\n        fz_throw(c",
          "new_api": null,
          "old_text": " res)\n        fz_throw(c",
          "new_text": null,
          "old_line_content": "    state->stream->Release();",
          "new_line_content": "    stm->rp = stm->wp = state->buf;",
          "content_same": false
        },
        {
          "line": 361,
          "old_api": "ERROR_GENERIC, \"ISt",
          "new_api": null,
          "old_text": "ERROR_GENERIC, \"ISt",
          "new_text": null,
          "old_line_content": "    fz_free(ctx, state);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2409,
          "old_api": "ev = fz_new_text_device(ctx, sheet,",
          "new_api": null,
          "old_text": "ev = fz_new_text_device(ctx, sheet, ",
          "new_text": null,
          "old_line_content": "                fz_transform_rect(&rect, &page->ctm);",
          "new_line_content": "                ld.kind = FZ_LINK_LAUNCH;",
          "content_same": false
        },
        {
          "line": 2411,
          "old_api": ";\n        LeaveCriticalSect",
          "new_api": null,
          "old_text": ";\n        LeaveCriticalSect",
          "new_text": null,
          "old_line_content": "                fz_link *link = fz_new_link(ctx, &rect, ld);",
          "new_line_content": "                ld.ld.launch.new_window = 1;",
          "content_same": false
        },
        {
          "line": 4463,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    if (str::IsEmpty(target))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2416,
          "old_api": "ge) to ensure that\n    // the extract",
          "new_api": null,
          "old_text": "ge) to ensure that\n    // the extract",
          "new_text": null,
          "old_line_content": "            else if (!str::IsEmpty(pdf_to_str_buf(pdf_dict_gets(annot->obj, \"Contents\")))) {",
          "new_line_content": "                // add links in top-to-bottom order (i.e. last-to-first)",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": "ULL;\n\n    LARGE_INTEGER zero =",
          "new_api": null,
          "old_text": "ULL;\n\n    LARGE_INTEGER zero =",
          "new_text": null,
          "old_line_content": "    HRESULT res = state->stream->Clone(&stream2);",
          "new_line_content": "fz_stream *fz_open_istream(fz_context *ctx, IStream *stream);",
          "content_same": false
        },
        {
          "line": 4466,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    xps_target *found = xps_lookup_link_target_obj(_doc, (char *)target);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": "(zero, STREAM_SEEK_SET, NULL);\n    if (FAILED(res))\n        fz_thr",
          "new_api": null,
          "old_text": "(zero, STREAM_SEEK_SET, NULL);\n    if (FAILED(res))\n        fz_thr",
          "new_text": null,
          "old_line_content": "        fz_throw(ctx, FZ_ERROR_GENERIC, \"IStream doesn't support cloning\");",
          "new_line_content": "extern \"C\" static fz_stream *reopen_istream(fz_context *ctx, fz_stream *stm)",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": "ERROR_GENER",
          "new_api": null,
          "old_text": "ERROR_GENER",
          "new_text": null,
          "old_line_content": "    if (FAILED(res))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": "m seek error: %x\", res);\n\n    istream_filter *state = fz_malloc",
          "new_api": null,
          "old_text": "m seek error: %x\", res);\n\n    istream_filter *state = fz_malloc",
          "new_text": null,
          "old_line_content": "        fz_throw(ctx, FZ_ERROR_GENERIC, \"IStream clone error: %x\", res);",
          "new_line_content": "    istream_filter *state = (istream_filter *)stm->state;",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": "stream_filter);\n    state->st",
          "new_api": null,
          "old_text": "stream_filter);\n    state->st",
          "new_text": null,
          "old_line_content": "    return fz_open_istream(ctx, stream2);",
          "new_line_content": "    ScopedComPtr<IStream> stream2;",
          "content_same": false
        },
        {
          "line": 2420,
          "old_api": "ext outside the mediabox bounds)",
          "new_api": null,
          "old_text": "ext outside the mediabox bounds)\n    ",
          "new_text": null,
          "old_line_content": "        else if (!str::IsEmpty(pdf_to_str_buf(pdf_dict_gets(annot->obj, \"Contents\"))) && annot->annot_type != FZ_ANNOT_FREETEXT) {",
          "new_line_content": "                // TODO: expose /Contents in addition to the file path",
          "content_same": false
        },
        {
          "line": 2421,
          "old_api": "eRun);\n\n    ScopedCr",
          "new_api": null,
          "old_text": "eRun);\n\n    ScopedCr",
          "new_text": null,
          "old_line_content": "            annots.Append(annot);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2425,
          "old_api": "CHAR *content",
          "new_api": null,
          "old_text": "CHAR *content ",
          "new_text": null,
          "old_line_content": "    if (annots.Count() == 0)",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2429,
          "old_api": "age",
          "new_api": null,
          "old_text": "age(ctx, text);\n",
          "new_text": null,
          "old_line_content": "    annots.Reverse();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 384,
          "old_api": "= reopen_istream;\n    return stm;\n}\n\nfz_",
          "new_api": null,
          "old_text": " = reopen_istream;\n    return stm;\n}\n\nfz_",
          "new_text": null,
          "old_line_content": "    HRESULT res = stream->Seek(zero, STREAM_SEEK_SET, NULL);",
          "new_line_content": "fz_stream *fz_open_istream(fz_context *ctx, IStream *stream)",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": "reate_view_",
          "new_api": null,
          "old_text": "reate_view_",
          "new_text": null,
          "old_line_content": "    if (FAILED(res))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 386,
          "old_api": "z_rect *mediabox, float zoom, int rotation)\n{\n    fz_matrix ct",
          "new_api": null,
          "old_text": "z_rect *mediabox, float zoom, int rotation)\n{\n    fz_matrix ct",
          "new_text": null,
          "old_line_content": "        fz_throw(ctx, FZ_ERROR_GENERIC, \"IStream seek error: %x\", res);",
          "new_line_content": "    if (!stream)",
          "content_same": false
        },
        {
          "line": 2432,
          "old_api": "PdfEngineImpl::Ext",
          "new_api": null,
          "old_text": "PdfEngineImpl::Ext",
          "new_text": null,
          "old_line_content": "    return annots.StealData();",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "m, (float)rotation), zoom, zoom);",
          "new_api": null,
          "old_text": "m, (float)rotation), zoom, zoom);\n\n  ",
          "new_text": null,
          "old_line_content": "    istream_filter *state = fz_malloc_struct(ctx, istream_filter);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4480,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    if (!str::StartsWith(name_utf8.Get(), \"#\"))",
          "new_line_content": "    return found->rect;",
          "content_same": false
        },
        {
          "line": 4481,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        name_utf8.Set(str::Join(\"#\", name_utf8));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 4484,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        if (str::EndsWithI(dest->name, name_utf8))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 4485,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "            return new SimpleDest(dest->page + 1, fz_rect_to_RectD(dest->rect));",
          "new_line_content": "    ScopedMem<char> name_utf8(str::conv::ToUtf8(name));",
          "content_same": false
        },
        {
          "line": 2445,
          "old_api": "_load_page_by_obj",
          "new_api": null,
          "old_text": "_load_page_by_obj(_doc, pageNo -",
          "new_text": null,
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 2447,
          "old_api": "fz_catch",
          "new_api": null,
          "old_text": "fz_catch(ctx) {\n        LeaveCritica",
          "new_text": null,
          "old_line_content": "        dev = fz_new_inspection_device(ctx, &data);",
          "new_line_content": "    Vec<FitzImagePos> positions;",
          "content_same": false
        },
        {
          "line": 4495,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        WCHAR *name = entry->title ? str::conv::FromUtf8(entry->title) : str::Dup(L\"\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": "matrix_expansion",
          "new_api": null,
          "old_text": "matrix_expansion(&ctm) > 0);\n   ",
          "new_text": null,
          "old_line_content": "    fz_pre_scale(fz_rotate(&ctm, (float)rotation), zoom, zoom);",
          "new_line_content": "    return stm;",
          "content_same": false
        },
        {
          "line": 2450,
          "old_api": "LL;\n    }\n    LeaveCriticalSecti",
          "new_api": null,
          "old_text": "LL;\n    }\n    LeaveCriticalSecti",
          "new_text": null,
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": "on",
          "new_api": null,
          "old_text": "on(&ctm) == 0)\n        return fz_identity;\n\n  ",
          "new_text": null,
          "old_line_content": "    assert(0 == mediabox->x0 && 0 == mediabox->y0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4496,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        XpsTocItem *item = new XpsTocItem(name, XpsLink(this, &entry->dest));",
          "new_line_content": "XpsTocItem *XpsEngineImpl::BuildTocTree(fz_outline *entry, int& idCounter)",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": "oords;\n};\n\nstatic bool LinkifyCheckMulti",
          "new_api": null,
          "old_text": "oords;\n};\n\nstatic bool LinkifyCheckMulti",
          "new_text": null,
          "old_line_content": "        fz_pre_translate(&ctm, 0, -mediabox->y1);",
          "new_line_content": "    fz_matrix ctm;",
          "content_same": false
        },
        {
          "line": 2455,
          "old_api": "t, target);\n\n    EnterCriticalSe",
          "new_api": null,
          "old_text": "t, target);\n\n    EnterCriticalSe",
          "new_text": null,
          "old_line_content": "    RunPage(page, dev, &fz_identity);",
          "new_line_content": "    fz_catch(ctx) {",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": "os, RectI *coords)\n{\n    // multiline links end in a",
          "new_api": null,
          "old_text": "os, RectI *coords)\n{\n    // multiline links end in a",
          "new_text": null,
          "old_line_content": "        fz_pre_translate(&ctm, -mediabox->x1, -mediabox->y1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2457,
          "old_api": "ticalSection",
          "new_api": null,
          "old_text": "ticalSection(&ctxAcce",
          "new_text": null,
          "old_line_content": "    if (imageIx >= positions.Count() || fz_rect_to_RectD(positions.At(imageIx).rect) != rect) {",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 410,
          "old_api": "n a line\n    // that starts left and onl",
          "new_api": null,
          "old_text": "n a line\n    // that starts left and onl",
          "new_text": null,
          "old_line_content": "        fz_pre_translate(&ctm, -mediabox->x1, 0);",
          "new_line_content": "    rotation = (rotation + 360) % 360;",
          "content_same": false
        },
        {
          "line": 2458,
          "old_api": "bool Pdf",
          "new_api": null,
          "old_text": "\nbool Pdf",
          "new_text": null,
          "old_line_content": "        assert(0);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4503,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "            item->child = BuildTocTree(entry->down, idCounter);",
          "new_line_content": "        item->id = ++idCounter;",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": "that doesn't start with",
          "new_api": null,
          "old_text": " that doesn't start with ",
          "new_text": null,
          "old_line_content": "    if (fz_matrix_expansion(&ctm) == 0)",
          "new_line_content": "    else if (180 == rotation)",
          "content_same": false
        },
        {
          "line": 4508,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "            node->AddSibling(item);",
          "new_line_content": "        if (entry->down)",
          "content_same": false
        },
        {
          "line": 2466,
          "old_api": "eek",
          "new_api": null,
          "old_text": "eek(_doc->file, 0, 0)",
          "new_text": null,
          "old_line_content": "        fz_image *image = positions.At(imageIx).image;",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2467,
          "old_api": "oc->file, &_doc->lexbuf.base);\n    if (tok != PDF_TOK_IN",
          "new_api": null,
          "old_text": "oc->file, &_doc->lexbuf.base);\n    if (tok != PDF_TOK_IN",
          "new_text": null,
          "old_line_content": "        pixmap = fz_new_pixmap_from_image(ctx, image, image->w, image->h);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4516,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    if (!HasTocTree())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4520,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    return BuildTocTree(_outline, idCounter);",
          "new_line_content": "DocTocItem *XpsEngineImpl::GetTocTree()",
          "content_same": false
        },
        {
          "line": 4525,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    xps_page *page = GetXpsPage(pageNo, true);",
          "new_line_content": "    int idCounter = 0;",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": "xt - 1].dy * 1.2",
          "new_api": null,
          "old_text": "xt - 1].dy * 1.2 ",
          "new_text": null,
          "old_line_content": "        !iswalnum(pos[-1]) && !str::IsWs(pos[1]) &&",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": "tr::StartsWith(pos + 1, L\"http\"",
          "new_api": null,
          "old_text": "tr::StartsWith(pos + 1, L\"http\"",
          "new_text": null,
          "old_line_content": "        coords[pos - pageText + 1].BR().y > coords[pos - pageText - 1].y &&",
          "new_line_content": "    // multiline links end in a non-alphanumeric character and continue on a line",
          "content_same": false
        },
        {
          "line": 433,
          "old_api": "const WCHAR *end, *quote;",
          "new_api": null,
          "old_text": "\n    const WCHAR *end, *quote;\n",
          "new_text": null,
          "old_line_content": "        coords[pos - pageText + 1].y <= coords[pos - pageText - 1].BR().y + coords[pos - pageText - 1].dy * 0.35 &&",
          "new_line_content": "    // that starts left and only slightly below where the current line ended",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": "on)\n    for (end = start; *end",
          "new_api": null,
          "old_text": "on)\n    for (end = start; *end ",
          "new_text": null,
          "old_line_content": "        coords[pos - pageText + 1].x < coords[pos - pageText - 1].BR().x &&",
          "new_line_content": "    // (and that doesn't start with http or a footnote numeral)",
          "content_same": false
        },
        {
          "line": 4530,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    fz_rect mbox = fz_RectD_to_rect(PageMediabox(pageNo));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 4532,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    for (int i = 0; !fz_is_empty_rect(&imageRects[pageNo-1][i]); i++)",
          "new_line_content": "    // GetXpsPage extracts imageRects for us",
          "content_same": false
        },
        {
          "line": 4533,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        if (fz_calc_overlap(mbox, imageRects[pageNo-1][i]) >= 0.9f)",
          "new_line_content": "    if (!page || !imageRects[pageNo-1])",
          "content_same": false
        },
        {
          "line": 2486,
          "old_api": "1.0\n    if (",
          "new_api": null,
          "old_text": " 1.0\n    if (",
          "new_text": null,
          "old_line_content": "    fz_var(sheet);",
          "new_line_content": "    if (!page)",
          "content_same": false
        },
        {
          "line": 2487,
          "old_api": "real",
          "new_api": null,
          "old_text": "real(pdf_dic",
          "new_text": null,
          "old_line_content": "    fz_var(text);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 2489,
          "old_api": "j, \"Linearized\")) != 1.0f)",
          "new_api": null,
          "old_text": "j, \"Linearized\")) != 1.0f)\n     ",
          "new_text": null,
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "    fz_text_sheet *sheet = NULL;",
          "content_same": false
        },
        {
          "line": 2491,
          "old_api": "exact file size\n    i",
          "new_api": null,
          "old_text": " exact file size\n    i",
          "new_text": null,
          "old_line_content": "        sheet = fz_new_text_sheet(ctx);",
          "new_line_content": "    fz_device *dev = NULL;",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": "= str::FindChar",
          "new_api": null,
          "old_text": "= str::FindChar",
          "new_text": null,
          "old_line_content": "    for (end = start; *end && !str::IsWs(*end); end++);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4541,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    if (!engine || !fileName || !engine->Load(fileName)) {",
          "new_line_content": "    return true;",
          "content_same": false
        },
        {
          "line": 2496,
          "old_api": "age\n    if (pdf_to_int(pdf_d",
          "new_api": null,
          "old_text": "age\n    if (pdf_to_int(pdf_d",
          "new_text": null,
          "old_line_content": "        fz_free_text_page(ctx, text);",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 449,
          "old_api": "Count",
          "new_api": null,
          "old_text": ">coords.Count() - 1;\n    ",
          "new_text": null,
          "old_line_content": "    if (')' == end[-1] && (!str::FindChar(start, '(') || str::FindChar(start, '(') >= end))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 452,
          "old_api": "? start[-1] : ' ');\n        m",
          "new_api": null,
          "old_text": " ? start[-1] : ' ');\n        m",
          "new_text": null,
          "old_line_content": "    if (('\"' == prevChar || '\\'' == prevChar) && (quote = str::FindChar(start, prevChar)) != NULL && quote < end)",
          "new_line_content": "    if (',' == end[-1] || '.' == end[-1] || '?' == end[-1] || '!' == end[-1])",
          "content_same": false
        },
        {
          "line": 2501,
          "old_api": "f (pdf_to_int(pdf_dict_gets(obj,",
          "new_api": null,
          "old_text": "f (pdf_to_int(pdf_dict_gets(obj,",
          "new_text": null,
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "    fz_catch(ctx) {",
          "content_same": false
        },
        {
          "line": 4551,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    if (!engine->Load(stream)) {",
          "new_line_content": "    return engine;",
          "content_same": false
        },
        {
          "line": 460,
          "old_api": ";\n        list->coor",
          "new_api": null,
          "old_text": ";\n        list->coor",
          "new_text": null,
          "old_line_content": "    size_t lastIx = list->coords.Count() - 1;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 461,
          "old_api": "Convert<double>()));",
          "new_api": null,
          "old_text": "Convert<double>()));\n\n",
          "new_text": null,
          "old_line_content": "    ScopedMem<WCHAR> uri(list->links.At(lastIx));",
          "new_line_content": "    return end;",
          "content_same": false
        },
        {
          "line": 2509,
          "old_api": "df_dict_gets",
          "new_api": null,
          "old_text": "df_dict_gets(res, \"Font\");\n    for (int k = 0; k < pdf_d",
          "new_text": null,
          "old_line_content": "    bool ok = RunPage(page, dev, &fz_identity, target, NULL, cacheRun);",
          "new_line_content": "    if (!cacheRun)",
          "content_same": false
        },
        {
          "line": 4563,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "        if (dir::Exists(fileName)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2516,
          "old_api": "Append",
          "new_api": null,
          "old_text": "ntList.Append(font);\n    }\n ",
          "new_text": null,
          "old_line_content": "    fz_free_text_page(ctx, text);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": ";\n\n    return end;\n}\n\n// cf",
          "new_api": null,
          "old_text": ";\n\n    return end;\n}\n\n// cf",
          "new_text": null,
          "old_line_content": "        ScopedMem<WCHAR> part(str::DupN(next, end - next));",
          "new_line_content": "    bool multiline = false;",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": "illazine.org/gerv/ar",
          "new_api": null,
          "old_text": "illazine.org/gerv/ar",
          "new_text": null,
          "old_line_content": "        uri.Set(str::Join(uri, part));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": "l_address_regexp.html\ninline bool IsEmailUsernameChar(WCH",
          "new_api": null,
          "old_text": "l_address_regexp.html\ninline bool IsEmailUsernameChar(WCH",
          "new_text": null,
          "old_line_content": "        RectI bbox = coords[next - pageText].Union(coords[end - pageText - 1]);",
          "new_line_content": "    do {",
          "content_same": false
        },
        {
          "line": 2517,
          "old_api": "lso extract fonts for all XObj",
          "new_api": null,
          "old_text": "lso extract fonts for all XObj",
          "new_text": null,
          "old_line_content": "    fz_free_text_sheet(ctx, sheet);",
          "new_line_content": "    ScopedCritSec scope(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 4565,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "            ScopedMem<WCHAR> relsPath(path::Join(fileName, L\"_rels\\\\.rels\"));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4566,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "            return file::Exists(relsPath) || dir::Exists(relsPath);",
          "new_line_content": "bool IsSupportedFile(const WCHAR *fileName, bool sniff)",
          "content_same": false
        },
        {
          "line": 4570,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "               zip.GetFileIndex(L\"_rels/.rels/[0].piece\") != (size_t)-1 ||",
          "new_line_content": "            // allow opening uncompressed XPS files as well",
          "content_same": false
        },
        {
          "line": 2524,
          "old_api": "(xobjs, k);\n        pdf_",
          "new_api": null,
          "old_text": "(xobjs, k);\n        pdf_",
          "new_text": null,
          "old_line_content": "    pdf_page *page = GetPdfPage(pageNo, true);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2526,
          "old_api": "Resources\");\n        if (xobj && xres && !pdf_mark",
          "new_api": null,
          "old_text": "Resources\");\n        if (xobj && xres && !pdf_mark",
          "new_text": null,
          "old_line_content": "        return ExtractPageText(page, lineSep, coords_out, target);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": "swalnum",
          "new_api": null,
          "old_text": "swalnum(c) || '-' ==",
          "new_text": null,
          "old_line_content": "    for (size_t i = lastIx + 1; i < list->coords.Count(); i++)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": "indEmail",
          "new_api": null,
          "old_text": "indEmail(cons",
          "new_text": null,
          "old_line_content": "        list->links.Append(str::Dup(uri));",
          "new_line_content": "        next = end + 1;",
          "content_same": false
        },
        {
          "line": 2528,
          "old_api": ")) {\n            pdf_extract_fon",
          "new_api": null,
          "old_text": ")) {\n            pdf_extract_fon",
          "new_text": null,
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "WCHAR *PdfEngineImpl::ExtractPageText(int pageNo, WCHAR *lineSep, RectI **coords_out, RenderTarget target)",
          "content_same": false
        },
        {
          "line": 4574,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    return str::EndsWithI(fileName, L\".xps\") || str::EndsWithI(fileName, L\".oxps\");",
          "new_line_content": "        ZipFile zip(fileName, true);",
          "content_same": false
        },
        {
          "line": 4579,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    return XpsEngineImpl::CreateFromFile(fileName);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2533,
          "old_api": "ontList;\n\n    // collect all fon",
          "new_api": null,
          "old_text": "ontList;\n\n    // collect all fon",
          "new_text": null,
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4584,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "    return XpsEngineImpl::CreateFromStream(stream);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": "nd++);\n    if (end == start || *end != '",
          "new_api": null,
          "old_text": "nd++);\n    if (end == start || *end != '",
          "new_text": null,
          "old_line_content": "    return iswalnum(c) || c && str::FindChar(L\".!#$%&'*+=?^_`{|}~-\", c);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2538,
          "old_api": "= GetPdfPage(i);\n        if (page) {\n            S",
          "new_api": null,
          "old_text": "= GetPdfPage(i);\n        if (page) {\n            S",
          "new_text": null,
          "old_line_content": "    WCHAR *result = ExtractPageText(page, lineSep, coords_out, target);",
          "new_line_content": "    fz_catch(ctx) {",
          "content_same": false
        },
        {
          "line": 2540,
          "old_api": "Sec scope(&ctxAccess);",
          "new_api": null,
          "old_text": "Sec scope(&ctxAccess);\n         ",
          "new_text": null,
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 2541,
          "old_api": "ry",
          "new_api": null,
          "old_text": "ry(ctx) {\n               ",
          "new_text": null,
          "old_line_content": "    pdf_free_page(_doc, page);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": "for (end",
          "new_api": null,
          "old_text": "   for (end",
          "new_text": null,
          "old_line_content": "    return iswalnum(c) || '-' == c;",
          "new_line_content": "    // explicitly excluding the '/' from the list, as it is more",
          "content_same": false
        },
        {
          "line": 2551,
          "old_api": "s, fontList);",
          "new_api": null,
          "old_text": "s, fontList);\n           ",
          "new_text": null,
          "old_line_content": "    fz_seek(_doc->file, 0, 0);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2552,
          "old_api": "}\n            fz_catch(ctx) { }",
          "new_api": null,
          "old_text": "  }\n            fz_catch(ctx) { }\n     ",
          "new_text": null,
          "old_line_content": "    int tok = pdf_lex(_doc->file, &_doc->lexbuf.base);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 507,
          "old_api": "LinkRectList *list = new",
          "new_api": null,
          "old_text": " LinkRectList *list = new",
          "new_text": null,
          "old_line_content": "    for (end = start; IsEmailUsernameChar(*end); end++);",
          "new_line_content": "    return start != at ? start : NULL;",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": "ext; *start; start++) {",
          "new_api": null,
          "old_text": "ext; *start; start++) {\n     ",
          "new_text": null,
          "old_line_content": "    if (end == start || *end != '@' || !IsEmailDomainChar(*(end + 1)))",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2556,
          "old_api": ") {\n        const",
          "new_api": null,
          "old_text": ") {\n        const ",
          "new_text": null,
          "old_line_content": "    if (num < 0 || num >= pdf_xref_len(_doc))",
          "new_line_content": "    // determine the object number of the very first object in the file",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": "multiline = false;",
          "new_api": null,
          "old_text": "multiline = false;\n    ",
          "new_text": null,
          "old_line_content": "    for (end++; IsEmailDomainChar(*end); end++);",
          "new_line_content": "static const WCHAR *LinkifyEmailAddress(const WCHAR *start)",
          "content_same": false
        },
        {
          "line": 511,
          "old_api": "if ('@' == *start) {",
          "new_api": null,
          "old_text": "        if ('@' == *start) {\n",
          "new_text": null,
          "old_line_content": "    if ('.' != *end || !IsEmailDomainChar(*(end + 1)))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2559,
          "old_api": "fz_try(ctx)",
          "new_api": null,
          "old_text": "      fz_try(ctx)",
          "new_text": null,
          "old_line_content": "    fz_try(_doc->ctx) {",
          "new_line_content": "    if (tok != PDF_TOK_INT)",
          "content_same": false
        },
        {
          "line": 2560,
          "old_api": "pdf_obj *font = fontList.At",
          "new_api": null,
          "old_text": "   pdf_obj *font = fontList.At",
          "new_text": null,
          "old_line_content": "        pdf_cache_object(_doc, num, 0);",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 515,
          "old_api": "art);\n            end = email",
          "new_api": null,
          "old_text": "art);\n            end = email",
          "new_text": null,
          "old_line_content": "    } while ('.' == *end && IsEmailDomainChar(*(end + 1)));",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 2569,
          "old_api": "::IsEmpty(name))",
          "new_api": null,
          "old_text": "::IsEmpty(name))\n               ",
          "new_text": null,
          "old_line_content": "    if (pdf_to_real(pdf_dict_gets(obj, \"Linearized\")) != 1.0f)",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": "://\")) {\n            end = Linkif",
          "new_api": null,
          "old_text": "://\")) {\n            end = Linkif",
          "new_text": null,
          "old_line_content": "            const WCHAR *email = LinkifyFindEmail(pageText, start);",
          "new_line_content": "        const WCHAR *end = NULL;",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": "ext ? start[-1] : ' ');",
          "new_api": null,
          "old_text": "ext ? start[-1] : ' ');\n  ",
          "new_text": null,
          "old_line_content": "            end = email ? LinkifyEmailAddress(email) : NULL;",
          "new_line_content": "        bool multiline = false;",
          "content_same": false
        },
        {
          "line": 2582,
          "old_api": ");\n                if (",
          "new_api": null,
          "old_text": ");\n                if (",
          "new_text": null,
          "old_line_content": "           pdf_is_int(pdf_dict_gets(obj, \"E\")) &&",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 2583,
          "old_api": "\"))",
          "new_api": null,
          "old_text": "\"))\n                   ",
          "new_text": null,
          "old_line_content": "           pdf_is_int(pdf_dict_gets(obj, \"T\"));",
          "new_line_content": "    // /N must be the total number of pages",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": "!multiline && (!wcschr(start + 5",
          "new_api": null,
          "old_text": "!multiline && (!wcschr(start + 5",
          "new_text": null,
          "old_line_content": "        else if ('h' == *start && str::Parse(start, L\"http%?s://\")) {",
          "new_line_content": "                start = email;",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": "+ 5, '.') >= end))\n                end = NULL;\n        }",
          "new_api": null,
          "old_text": "+ 5, '.') >= end))\n                end = NULL;\n        }\n",
          "new_text": null,
          "old_line_content": "            end = LinkifyFindEnd(start, start > pageText ? start[-1] : ' ');",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2590,
          "old_api": "q",
          "new_api": null,
          "old_text": "q(encoding, \"WinAnsiEncodi",
          "new_text": null,
          "old_line_content": "        pdf_obj *font = pdf_resolve_indirect(pdf_dict_get_val(fonts, k));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2591,
          "old_api": "oding = \"Ansi\";",
          "new_api": null,
          "old_text": "oding = \"Ansi\";\n       ",
          "new_text": null,
          "old_line_content": "        if (font && !fontList.Contains(font))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 545,
          "old_api": ");\n        }\n        if (!end)",
          "new_api": null,
          "old_text": ");\n        }\n        if (!end)\n",
          "new_text": null,
          "old_line_content": "        else if ('w' == *start && str::StartsWith(start, L\"www.\")) {",
          "new_line_content": "            // or an alphanumeric character (indicates part of a different protocol)",
          "content_same": false
        },
        {
          "line": 546,
          "old_api": "ScopedMem<WCHAR> part(str::DupN(start, end - star",
          "new_api": null,
          "old_text": "        ScopedMem<WCHAR> part(str::DupN(start, end - star",
          "new_text": null,
          "old_line_content": "            end = LinkifyFindEnd(start, start > pageText ? start[-1] : ' ');",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2592,
          "old_api": "tr::Eq(encoding, \"Mac",
          "new_api": null,
          "old_text": "tr::Eq(encoding, \"Mac",
          "new_text": null,
          "old_line_content": "            fontList.Append(font);",
          "new_line_content": "static void pdf_extract_fonts(pdf_obj *res, Vec<pdf_obj *>& fontList)",
          "content_same": false
        },
        {
          "line": 550,
          "old_api": "nvert<double>()));",
          "new_api": null,
          "old_text": "nvert<double>()));\n   ",
          "new_text": null,
          "old_line_content": "            if (end - start <= 4 || !multiline && (!wcschr(start + 5, '.') || wcschr(start + 5, '.') >= end))",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2599,
          "old_api": "0 && MultiByteToWi",
          "new_api": null,
          "old_text": "0 && MultiByteToWi",
          "new_text": null,
          "old_line_content": "        if (xobj && xres && !pdf_mark_obj(xobj)) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2600,
          "old_api": "R_INVALID_CHARS, name, -1, NULL,",
          "new_api": null,
          "old_text": "R_INVALID_CHARS, name, -1, NULL, ",
          "new_text": null,
          "old_line_content": "            pdf_extract_fonts(xres, fontList);",
          "new_line_content": "    // also extract fonts for all XObjects (recursively)",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": "st;\n}\n\nstatic fz_link *FixupPa",
          "new_api": null,
          "old_text": "st;\n}\n\nstatic fz_link *FixupPa",
          "new_text": null,
          "old_line_content": "            end = LinkifyEmailAddress(start + 7);",
          "new_line_content": "            protocol = L\"http://\";",
          "content_same": false
        },
        {
          "line": 561,
          "old_api": "arch from the start of",
          "new_api": null,
          "old_text": "arch from the start of\n",
          "new_text": null,
          "old_line_content": "        list->links.Append(uri);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 562,
          "old_api": "d) list, we have to reverse the order of links\n    // (cf.",
          "new_api": null,
          "old_text": "d) list, we have to reverse the order of links\n    // (cf.",
          "new_text": null,
          "old_line_content": "        RectI bbox = coords[start - pageText].Union(coords[end - pageText - 1]);",
          "new_line_content": "        if (!end)",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": "il?id=1303 )\n    fz_li",
          "new_api": null,
          "old_text": "il?id=1303 )\n    fz_li",
          "new_text": null,
          "old_line_content": "        list->coords.Append(fz_RectD_to_rect(bbox.Convert<double>()));",
          "new_line_content": "            continue;",
          "content_same": false
        },
        {
          "line": 2611,
          "old_api": "info.Ap",
          "new_api": null,
          "old_text": "    info.Ap",
          "new_text": null,
          "old_line_content": "    for (int i = 1; i <= PageCount(); i++) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2612,
          "old_api": "sEmpty",
          "new_api": null,
          "old_text": "sEmpty(type))",
          "new_text": null,
          "old_line_content": "        pdf_page *page = GetPdfPage(i);",
          "new_line_content": "WCHAR *PdfEngineImpl::ExtractFontList()",
          "content_same": false
        },
        {
          "line": 2616,
          "old_api": "ndFmt",
          "new_api": null,
          "old_text": "ndFmt(\"%s; \", encoding);\n            if (emb",
          "new_text": null,
          "old_line_content": "                pdf_extract_fonts(page->resources, fontList);",
          "new_line_content": "    // collect all fonts from all page objects",
          "content_same": false
        },
        {
          "line": 2619,
          "old_api": "copedMem<WCHAR> fontInfo(str::conv::FromUtf8(info",
          "new_api": null,
          "old_text": "copedMem<WCHAR> fontInfo(str::conv::FromUtf8(info",
          "new_text": null,
          "old_line_content": "                        pdf_extract_fonts(annot->ap->resources, fontList);",
          "new_line_content": "        if (page) {",
          "content_same": false
        },
        {
          "line": 2629,
          "old_api": "onts.SortNatural",
          "new_api": null,
          "old_text": "onts.SortNatural",
          "new_text": null,
          "old_line_content": "    for (size_t i = 0; i < fontList.Count(); i++) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2633,
          "old_api": "prop) {",
          "new_api": null,
          "old_text": " prop) {\n     ",
          "new_text": null,
          "old_line_content": "            pdf_obj *font = fontList.At(i);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2634,
          "old_api": "c->version % 10;\n        if (1 == majo",
          "new_api": null,
          "old_text": "c->version % 10;\n        if (1 == majo",
          "new_text": null,
          "old_line_content": "            pdf_obj *font2 = pdf_array_get(pdf_dict_gets(font, \"DescendantFonts\"), 0);",
          "new_line_content": "    WStrVec fonts;",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": "t; }\n};\n\nstruct FitzImagePos {",
          "new_api": null,
          "old_text": "t; }\n};\n\nstruct FitzImagePos {\n   ",
          "new_text": null,
          "old_line_content": "            Swap(link->rect.x0, link->rect.x1);",
          "new_line_content": "        new_root = root;",
          "content_same": false
        },
        {
          "line": 2638,
          "old_api": ")\n                return str::Format(L\"%d",
          "new_api": null,
          "old_text": ")\n                return str::Format(L\"%d",
          "new_text": null,
          "old_line_content": "            name = pdf_to_name(pdf_dict_getsa(font2, \"BaseFont\", \"Name\"));",
          "new_line_content": "        fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": "Pos",
          "new_api": null,
          "old_text": "Pos(fz_image *image=NULL, fz_rect ",
          "new_text": null,
          "old_line_content": "            Swap(link->rect.y0, link->rect.y1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 593,
          "old_api": "t_rect) :\n        image(image), rect(r",
          "new_api": null,
          "old_text": "t_rect) :\n        image(image), rect(r",
          "new_text": null,
          "old_line_content": "        assert(link->rect.x1 >= link->rect.x0);",
          "new_line_content": "        // there are PDFs that have x,y positions in reverse order, so fix them up",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": "struct ListInspectionData {\n    Vec<",
          "new_api": null,
          "old_text": "\n\nstruct ListInspectionData {\n    Vec<",
          "new_text": null,
          "old_line_content": "        assert(link->rect.y1 >= link->rect.y0);",
          "new_line_content": "        fz_link *link = new_root;",
          "content_same": false
        },
        {
          "line": 2642,
          "old_api": "}\n        return str::Format(",
          "new_api": null,
          "old_text": "\n        }\n        return str::Format(",
          "new_text": null,
          "old_line_content": "            pdf_obj *desc = pdf_dict_gets(font2, \"FontDescriptor\");",
          "new_line_content": "                font2 = font;",
          "content_same": false
        },
        {
          "line": 2643,
          "old_api": "= prop) {\n        WStrVec fstruct;\n        if",
          "new_api": null,
          "old_text": "= prop) {\n        WStrVec fstruct;\n        if ",
          "new_text": null,
          "old_line_content": "            if (desc && (pdf_dict_gets(desc, \"FontFile\") || pdf_dict_getsa(desc, \"FontFile2\", \"FontFile3\")))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2650,
          "old_api": "i = 0; i < pdf_array_len(pdf_d",
          "new_api": null,
          "old_text": " i = 0; i < pdf_array_len(pdf_d",
          "new_text": null,
          "old_line_content": "                const char *type2 = pdf_to_name(pdf_dict_gets(font2, \"Subtype\"));",
          "new_line_content": "                embedded = true;",
          "content_same": false
        },
        {
          "line": 2653,
          "old_api": "\"), i);\n                CrashI",
          "new_api": null,
          "old_text": "\"), i);\n                CrashI",
          "new_text": null,
          "old_line_content": "                else if (str::Eq(type2, \"CIDFontType2\"))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2658,
          "old_api": "Count",
          "new_api": null,
          "old_text": "        return fstruct.Count() > 0 ?",
          "new_text": null,
          "old_line_content": "            if (str::Eq(encoding, \"WinAnsiEncoding\"))",
          "new_line_content": "                    type = \"Type1 (CID)\";",
          "content_same": false
        },
        {
          "line": 2660,
          "old_api": "prop)\n        return ExtractFontList(",
          "new_api": null,
          "old_text": "prop)\n        return ExtractFontList(",
          "new_text": null,
          "old_line_content": "            else if (str::Eq(encoding, \"MacRomanEncoding\"))",
          "new_line_content": "                    type = \"TrueType (CID)\";",
          "content_same": false
        },
        {
          "line": 2662,
          "old_api": "char *name;\n    } pdfPropNames[] = {",
          "new_api": null,
          "old_text": "  char *name;\n    } pdfPropNames[] = {",
          "new_text": null,
          "old_line_content": "            else if (str::Eq(encoding, \"MacExpertEncoding\"))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 615,
          "old_api": "r (since",
          "new_api": null,
          "old_text": "r (since",
          "new_text": null,
          "old_line_content": "    explicit FitzImagePos(fz_image *image=NULL, fz_rect rect=fz_unit_rect) :",
          "new_line_content": "};",
          "content_same": false
        },
        {
          "line": 2671,
          "old_api": "{ Prop_CreatorApp, \"Creator\" }, { Prop_PdfProducer, \"Produ",
          "new_api": null,
          "old_text": "       { Prop_CreatorApp, \"Creator\" }, { Prop_PdfProducer, \"Produ",
          "new_text": null,
          "old_line_content": "        if (name[0] < 0 && MultiByteToWideChar(936, MB_ERR_INVALID_CHARS, name, -1, NULL, 0))",
          "new_line_content": "        fz_catch(ctx) {",
          "content_same": false
        },
        {
          "line": 2672,
          "old_api": "f",
          "new_api": null,
          "old_text": "f(pdfPropNames); i++) {\n        if (",
          "new_text": null,
          "old_line_content": "            info.Append(ScopedMem<char>(str::ToMultiByte(name, 936, CP_UTF8)));",
          "new_line_content": "            continue;",
          "content_same": false
        },
        {
          "line": 626,
          "old_api": "if (!",
          "new_api": null,
          "old_text": "   if (!",
          "new_text": null,
          "old_line_content": "    explicit ListInspectionData(Vec<FitzImagePos>& images) : images(&images),",
          "new_line_content": "    Vec<FitzImagePos> *images;",
          "content_same": false
        },
        {
          "line": 2675,
          "old_api": "ect references,",
          "new_api": null,
          "old_text": "ect references,\n  ",
          "new_text": null,
          "old_line_content": "        if (!str::IsEmpty(encoding) || !str::IsEmpty(type) || embedded) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2676,
          "old_api": "txAccess",
          "new_api": null,
          "old_text": "txAccess\n        ",
          "new_text": null,
          "old_line_content": "            info.Append(\" (\");",
          "new_line_content": "        str::Str<char> info;",
          "content_same": false
        },
        {
          "line": 2679,
          "old_api": "str::conv::FromPdf(obj",
          "new_api": null,
          "old_text": "str::conv::FromPdf(obj",
          "new_text": null,
          "old_line_content": "            if (!str::IsEmpty(encoding))",
          "new_line_content": "        else",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": "ection_handle_image",
          "new_api": null,
          "old_text": "ection_handle_image(fz_device *dev, fz_image *image",
          "new_text": null,
          "old_line_content": "    ((ListInspectionData *)dev->user)->images->Reverse();",
          "new_line_content": "extern \"C\" static void",
          "content_same": false
        },
        {
          "line": 2687,
          "old_api": "if (pdf",
          "new_api": null,
          "old_text": "        if (pdf",
          "new_text": null,
          "old_line_content": "        ScopedMem<WCHAR> fontInfo(str::conv::FromUtf8(info.LendData()));",
          "new_line_content": "            if (embedded)",
          "content_same": false
        },
        {
          "line": 2691,
          "old_api": "serAnnotation",
          "new_api": null,
          "old_text": "serAnnotation",
          "new_text": null,
          "old_line_content": "    if (fonts.Count() == 0)",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2705,
          "old_api": "ryptionKey);\n}\n\nPageLay",
          "new_api": null,
          "old_text": "ryptionKey);\n}\n\nPageLay",
          "new_text": null,
          "old_line_content": "        if (1 == major && 7 == minor && pdf_crypt_version(_doc) == 5) {",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2706,
          "old_api": "ferredLayout",
          "new_api": null,
          "old_text": "ferredLayout()\n{\n    Pag",
          "new_text": null,
          "old_line_content": "            if (pdf_crypt_revision(_doc) == 5)",
          "new_line_content": "    if (!_doc)",
          "content_same": false
        },
        {
          "line": 2707,
          "old_api": "gle;\n\n    ScopedCritSec scope(&ctxAccess);\n    pdf_obj *root =",
          "new_api": null,
          "old_text": "gle;\n\n    ScopedCritSec scope(&ctxAccess);\n    pdf_obj *root = ",
          "new_text": null,
          "old_line_content": "                return str::Format(L\"%d.%d Adobe Extension Level %d\", major, minor, 3);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 2708,
          "old_api": "x) {\n        root = pdf_",
          "new_api": null,
          "old_text": "x) {\n        root = pdf_",
          "new_text": null,
          "old_line_content": "            if (pdf_crypt_revision(_doc) == 6)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2709,
          "old_api": "oot\");\n    }\n    fz_catch(ctx) {\n        return layout;\n    }",
          "new_api": null,
          "old_text": "oot\");\n    }\n    fz_catch(ctx) {\n        return layout;\n    }\n\n",
          "new_text": null,
          "old_line_content": "                return str::Format(L\"%d.%d Adobe Extension Level %d\", major, minor, 8);",
          "new_line_content": "    if (Prop_PdfVersion == prop) {",
          "content_same": false
        },
        {
          "line": 663,
          "old_api": "extern \"C\" static void\nfz_inspectio",
          "new_api": null,
          "old_text": "\nextern \"C\" static void\nfz_inspectio",
          "new_text": null,
          "old_line_content": "    fz_inspection_handle_path(dev, path);",
          "new_line_content": "    ((ListInspectionData *)dev->user)->mem_estimate += sizeof(fz_image) + image->w * image->h * n;",
          "content_same": false
        },
        {
          "line": 2716,
          "old_api": "else if (str::StartsWith(name,",
          "new_api": null,
          "old_text": "   else if (str::StartsWith(name, ",
          "new_text": null,
          "old_line_content": "        if (pdf_to_bool(pdf_dict_gets(_info, \"Linearized\")))",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2718,
          "old_api": "y",
          "new_api": null,
          "old_text": "y(ctx) {\n        pdf_obj *pref",
          "new_text": null,
          "old_line_content": "        if (pdf_to_bool(pdf_dict_gets(_info, \"Marked\")))",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2719,
          "old_api": "Preferences\");",
          "new_api": null,
          "old_text": "Preferences\");\n    ",
          "new_text": null,
          "old_line_content": "            fstruct.Append(str::Dup(L\"tagged\"));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2720,
          "old_api": "ion = pdf_to_name(pdf_dict_gets(prefs",
          "new_api": null,
          "old_text": "ion = pdf_to_name(pdf_dict_gets(prefs",
          "new_text": null,
          "old_line_content": "        if (pdf_dict_gets(_info, \"OutputIntents\")) {",
          "new_line_content": "    if (Prop_PdfFileStructure == prop) {",
          "content_same": false
        },
        {
          "line": 2721,
          "old_api": "L\"))\n            layout = (PageLayout",
          "new_api": null,
          "old_text": "L\"))\n            layout = (PageLayout",
          "new_text": null,
          "old_line_content": "            for (int i = 0; i < pdf_array_len(pdf_dict_gets(_info, \"OutputIntents\")); i++) {",
          "new_line_content": "        WStrVec fstruct;",
          "content_same": false
        },
        {
          "line": 2731,
          "old_api": "}\n    return dat",
          "new_api": null,
          "old_text": " }\n    return dat",
          "new_text": null,
          "old_line_content": "        return ExtractFontList();",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2742,
          "old_api": "Name, FALSE);\n    i",
          "new_api": null,
          "old_text": "Name, FALSE);\n    i",
          "new_text": null,
          "old_line_content": "    for (int i = 0; i < dimof(pdfPropNames); i++) {",
          "new_line_content": "    } pdfPropNames[] = {",
          "content_same": false
        },
        {
          "line": 2746,
          "old_api": "ocument *doc, pdf_page *page, pdf_obj *pag",
          "new_api": null,
          "old_text": "ocument *doc, pdf_page *page, pdf_obj *pag",
          "new_text": null,
          "old_line_content": "            pdf_obj *obj = pdf_dict_gets(_info, pdfPropNames[i].name);",
          "new_line_content": "        { Prop_CreatorApp, \"Creator\" }, { Prop_PdfProducer, \"Producer\" },",
          "content_same": false
        },
        {
          "line": 2747,
          "old_api": ")\n{\n    static const ch",
          "new_api": null,
          "old_text": ")\n{\n    static const ch",
          "new_text": null,
          "old_line_content": "            return obj ? pdf_clean_string(str::conv::FromPdf(obj)) : NULL;",
          "new_line_content": "    };",
          "content_same": false
        },
        {
          "line": 2757,
          "old_api": "ct = \"<< /T",
          "new_api": null,
          "old_text": "ct = \"<< /T",
          "new_text": null,
          "old_line_content": "        for (int i = 0; i < PageCount(); i++) {",
          "new_line_content": "};",
          "content_same": false
        },
        {
          "line": 2758,
          "old_api": "m /BBox [0 0 %f %f] /Res",
          "new_api": null,
          "old_text": "m /BBox [0 0 %f %f] /Res",
          "new_text": null,
          "old_line_content": "            if (pdf_to_num(_pageObjs[i]) == 0)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 717,
          "old_api": "fz_image *image, const fz_rect *rect,",
          "new_api": null,
          "old_text": " fz_image *image, const fz_rect *rect,",
          "new_text": null,
          "old_line_content": "    fz_inspection_handle_image(dev, image);",
          "new_line_content": "    ((ListInspectionData *)dev->user)->mem_estimate += sizeof(fz_shade);",
          "content_same": false
        },
        {
          "line": 724,
          "old_api": "h;\n    dev->stroke_path",
          "new_api": null,
          "old_text": "h;\n    dev->stroke_path",
          "new_text": null,
          "old_line_content": "    if (!fz_is_empty_rect(&rect))",
          "new_line_content": "    // extract rectangles for images a user might want to extract",
          "content_same": false
        },
        {
          "line": 725,
          "old_api": "ion_clip_path;\n    dev->c",
          "new_api": null,
          "old_text": "ion_clip_path;\n    dev->c",
          "new_text": null,
          "old_line_content": "        ((ListInspectionData *)dev->user)->images->Append(FitzImagePos(image, rect));",
          "new_line_content": "    // TODO: try to better distinguish images a user might actually want to extract",
          "content_same": false
        },
        {
          "line": 2772,
          "old_api": "char *ap_strikeout",
          "new_api": null,
          "old_text": "char *ap_strikeout",
          "new_text": null,
          "old_line_content": "        userAnnots.Reset();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2779,
          "old_api": "CS %f %f %f RG 0.5 w [1]",
          "new_api": null,
          "old_text": "CS %f %f %f RG 0.5 w [1]",
          "new_text": null,
          "old_line_content": "    return str::Dup(_decryptionKey);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2789,
          "old_api": "fz_var(ap_buf",
          "new_api": null,
          "old_text": "    fz_var(ap_buf",
          "new_text": null,
          "old_line_content": "        root = pdf_dict_gets(pdf_trailer(_doc), \"Root\");",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 742,
          "old_api": "tCookie {\npublic:\n    fz",
          "new_api": null,
          "old_text": "tCookie {\npublic:\n    fz",
          "new_text": null,
          "old_line_content": "    fz_device *dev = fz_new_device(ctx, data);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2796,
          "old_api": "t.type ? \"Underline\" :",
          "new_api": null,
          "old_text": "t.type ? \"Underline\" :\n          ",
          "new_text": null,
          "old_line_content": "        char *name = pdf_to_name(pdf_dict_gets(root, \"PageLayout\"));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2797,
          "old_api": "Annot_StrikeOut == annot.typ",
          "new_api": null,
          "old_text": "Annot_StrikeOut == annot.typ",
          "new_text": null,
          "old_line_content": "        if (str::EndsWith(name, \"Right\"))",
          "new_line_content": "    fz_catch(ctx) {",
          "content_same": false
        },
        {
          "line": 2799,
          "old_api": "gly  == annot.type ? \"Squigg",
          "new_api": null,
          "old_text": "gly  == annot.type ? \"Squigg",
          "new_text": null,
          "old_line_content": "        else if (str::StartsWith(name, \"Two\"))",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2806,
          "old_api": "= fz_RectD_to_rect(annot.rect);",
          "new_api": null,
          "old_text": "= fz_RectD_to_rect(annot.rect);\n ",
          "new_text": null,
          "old_line_content": "        char *direction = pdf_to_name(pdf_dict_gets(prefs, \"Direction\"));",
          "new_line_content": "            layout = Layout_Facing;",
          "content_same": false
        },
        {
          "line": 2807,
          "old_api": "ctm;\n    fz_transform_rec",
          "new_api": null,
          "old_text": "ctm;\n    fz_transform_rec",
          "new_text": null,
          "old_line_content": "        if (str::Eq(direction, \"R2L\"))",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2808,
          "old_api": "nvctm, &page->ctm));\n    double dx =",
          "new_api": null,
          "old_text": "nvctm, &page->ctm));\n    double dx =",
          "new_text": null,
          "old_line_content": "            layout = (PageLayoutType)(layout | Layout_R2L);",
          "new_line_content": "    fz_catch(ctx) { }",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": "tion> fz_get_user_page_annots(Vec<",
          "new_api": null,
          "old_text": "tion> fz_get_user_page_annots(Vec<",
          "new_text": null,
          "old_line_content": "    FitzAbortCookie() { memset(&cookie, 0, sizeof(cookie)); }",
          "new_line_content": "    return dev;",
          "content_same": false
        },
        {
          "line": 2820,
          "old_api": "ScopedMem<char> quad_tpl;\n    if (0 == rot",
          "new_api": null,
          "old_text": " ScopedMem<char> quad_tpl;\n    if (0 == rot",
          "new_text": null,
          "old_line_content": "        data = fz_extract_stream_data(_doc->file, cbCount);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2823,
          "old_api": "1, r.x0, r.y0, r.x1, r.y0));",
          "new_api": null,
          "old_text": "1, r.x0, r.y0, r.x1, r.y0));\n    ",
          "new_text": null,
          "old_line_content": "        return _fileName ? (unsigned char *)file::ReadAll(_fileName, cbCount) : NULL;",
          "new_line_content": "    unsigned char *data = NULL;",
          "content_same": false
        },
        {
          "line": 779,
          "old_api": "Append",
          "new_api": null,
          "old_text": "    result.Append(annot);\n ",
          "new_text": null,
          "old_line_content": "    BOOL ok = TryEnterCriticalSection(cs);",
          "new_line_content": "    // we use a single critical section for all locks,",
          "content_same": false
        },
        {
          "line": 781,
          "old_api": "}\n    re",
          "new_api": null,
          "old_text": "\n    }\n    re",
          "new_text": null,
          "old_line_content": "        CrashIf(true);",
          "new_line_content": "    // be guarding all fz_context access anyway and",
          "content_same": false
        },
        {
          "line": 782,
          "old_api": ";\n}\n\nstatic void fz_run_",
          "new_api": null,
          "old_text": ";\n}\n\nstatic void fz_run_",
          "new_text": null,
          "old_line_content": "        EnterCriticalSection(cs);",
          "new_line_content": "    // thus already be in place (in debug builds we",
          "content_same": false
        },
        {
          "line": 2831,
          "old_api": "mat",
          "new_api": null,
          "old_text": "mat(obj_quad_tpl, r.x",
          "new_text": null,
          "old_line_content": "    ScopedMem<unsigned char> data(GetFileData(&dataLen));",
          "new_line_content": "    return data;",
          "content_same": false
        },
        {
          "line": 2833,
          "old_api": "= rotation",
          "new_api": null,
          "old_text": "= rotation",
          "new_text": null,
          "old_line_content": "        bool ok = file::WriteAll(copyFileName, data.Get(), dataLen);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2835,
          "old_api": ", r.x0, r.y1, r.x0, r.y0));",
          "new_api": null,
          "old_text": ", r.x0, r.y1, r.x0, r.y0));\n",
          "new_text": null,
          "old_line_content": "            return !includeUserAnnots || SaveUserAnnots(copyFileName);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 790,
          "old_api": "ize_t i = 0; i < pageAnn",
          "new_api": null,
          "old_text": "ize_t i = 0; i < pageAnn",
          "new_text": null,
          "old_line_content": "    LeaveCriticalSection(cs);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2843,
          "old_api": "m<char> annot_ap_dict(str::F",
          "new_api": null,
          "old_text": "m<char> annot_ap_dict(str::F",
          "new_text": null,
          "old_line_content": "    return !includeUserAnnots || SaveUserAnnots(copyFileName);",
          "new_line_content": "    if (!_fileName)",
          "content_same": false
        },
        {
          "line": 797,
          "old_api": "rect, ctm);",
          "new_api": null,
          "old_text": "rect, ctm);\n    ",
          "new_text": null,
          "old_line_content": "        PageAnnotation& annot = userAnnots.At(i);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 812,
          "old_api": "fz_lineto",
          "new_api": null,
          "old_text": "         fz_lineto",
          "new_text": null,
          "old_line_content": "    for (size_t i = 0; i < pageAnnots.Count() && (!cookie || !cookie->abort); i++) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 813,
          "old_api": "neto",
          "new_api": null,
          "old_text": "neto(dev->ctx, p",
          "new_text": null,
          "old_line_content": "        PageAnnotation& annot = pageAnnots.At(i);",
          "new_line_content": "    return result;",
          "content_same": false
        },
        {
          "line": 815,
          "old_api": "ctx, path);\n            brea",
          "new_api": null,
          "old_text": "ctx, path);\n            brea",
          "new_text": null,
          "old_line_content": "        fz_rect rect = fz_RectD_to_rect(annot.rect);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 816,
          "old_api": "case Annot_Underline:",
          "new_api": null,
          "old_text": "case Annot_Underline:\n       ",
          "new_text": null,
          "old_line_content": "        fz_transform_rect(&rect, ctm);",
          "new_line_content": "static void fz_run_user_page_annots(Vec<PageAnnotation>& pageAnnots, fz_device *dev, const fz_matrix *ctm, const fz_rect *cliprect, fz_cookie *cookie)",
          "content_same": false
        },
        {
          "line": 2868,
          "old_api": ", rgb[2], dy / 2,",
          "new_api": null,
          "old_text": ", rgb[2], dy / 2,",
          "new_text": null,
          "old_line_content": "    fz_var(annot_obj);",
          "new_line_content": "    static const char *ap_squiggly = \"q /DeviceRGB CS %f %f %f RG 0.5 w [1] 1.5 d 0 0.25 m %f 0.25 l S [1] 0.5 d 0 0.75 m %f 0.75 l S Q\\n\";",
          "content_same": false
        },
        {
          "line": 2869,
          "old_api": "/ 2));",
          "new_api": null,
          "old_text": " / 2));\n      ",
          "new_text": null,
          "old_line_content": "    fz_var(ap_obj);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2870,
          "old_api": "reak;",
          "new_api": null,
          "old_text": "reak;\n        ",
          "new_text": null,
          "old_line_content": "    fz_var(ap_buf);",
          "new_line_content": "    fz_context *ctx = doc->ctx;",
          "content_same": false
        },
        {
          "line": 826,
          "old_api": "dev->ctx, path,",
          "new_api": null,
          "old_text": "dev->ctx, path,",
          "new_text": null,
          "old_line_content": "            fz_moveto(dev->ctx, path, annot.rect.TL().x, annot.rect.TL().y);",
          "new_line_content": "        // prepare text highlighting path (cf. pdf_create_highlight_annot",
          "content_same": false
        },
        {
          "line": 827,
          "old_api": "to",
          "new_api": null,
          "old_text": "to(dev->ctx, pa",
          "new_text": null,
          "old_line_content": "            fz_lineto(dev->ctx, path, annot.rect.BR().x, annot.rect.TL().y);",
          "new_line_content": "        // and pdf_create_markup_annot in pdf_annot.c)",
          "content_same": false
        },
        {
          "line": 829,
          "old_api": "_lineto",
          "new_api": null,
          "old_text": "_lineto(dev->ct",
          "new_text": null,
          "old_line_content": "            fz_lineto(dev->ctx, path, annot.rect.TL().x, annot.rect.BR().y);",
          "new_line_content": "        fz_stroke_state *stroke = NULL;",
          "content_same": false
        },
        {
          "line": 830,
          "old_api": "BR",
          "new_api": null,
          "old_text": "t.BR().x, annot.rect.BR().y ",
          "new_text": null,
          "old_line_content": "            fz_closepath(dev->ctx, path);",
          "new_line_content": "        switch (annot.type) {",
          "content_same": false
        },
        {
          "line": 2878,
          "old_api": "fz_rotate(&rot, rotation)));",
          "new_api": null,
          "old_text": " fz_rotate(&rot, rotation)));",
          "new_text": null,
          "old_line_content": "    CrashIf((rotation % 90) != 0);",
          "new_line_content": "    const char *subtype = Annot_Highlight == annot.type ? \"Highlight\" :",
          "content_same": false
        },
        {
          "line": 2880,
          "old_api": "memcpy(ap_buf->data, anno",
          "new_api": null,
          "old_text": "   memcpy(ap_buf->data, anno",
          "new_text": null,
          "old_line_content": "    fz_rect r = fz_RectD_to_rect(annot.rect);",
          "new_line_content": "                          Annot_StrikeOut == annot.type ? \"StrikeOut\" :",
          "content_same": false
        },
        {
          "line": 837,
          "old_api": "ce_rgb",
          "new_api": null,
          "old_text": "ce_rgb(dev->ctx",
          "new_text": null,
          "old_line_content": "            fz_moveto(dev->ctx, path, annot.rect.TL().x, annot.rect.TL().y + annot.rect.dy / 2);",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 838,
          "old_api": "olor.b / 255.f",
          "new_api": null,
          "old_text": "olor.b / 255.f ",
          "new_text": null,
          "old_line_content": "            fz_lineto(dev->ctx, path, annot.rect.BR().x, annot.rect.TL().y + annot.rect.dy / 2);",
          "new_line_content": "        case Annot_Underline:",
          "content_same": false
        },
        {
          "line": 2885,
          "old_api": "the file",
          "new_api": null,
          "old_text": "the file\n   ",
          "new_text": null,
          "old_line_content": "        Swap(dx, dy);",
          "new_line_content": "    // convert the annotation's rectangle back to raw user space",
          "content_same": false
        },
        {
          "line": 841,
          "old_api": ", 0, 0, FZ_BLEN",
          "new_api": null,
          "old_text": ", 0, 0, FZ_BLEN",
          "new_text": null,
          "old_line_content": "            fz_moveto(dev->ctx, path, annot.rect.TL().x + 1, annot.rect.BR().y);",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 842,
          "old_api": "s, color, annot",
          "new_api": null,
          "old_text": "s, color, annot",
          "new_text": null,
          "old_line_content": "            fz_lineto(dev->ctx, path, annot.rect.BR().x, annot.rect.BR().y);",
          "new_line_content": "        case Annot_StrikeOut:",
          "content_same": false
        },
        {
          "line": 2890,
          "old_api": "0));\n    }\n    fz_always(ctx) {\n        pdf_drop_obj(ap_obj);\n        fz_",
          "new_api": null,
          "old_text": "0));\n    }\n    fz_always(ctx) {\n        pdf_drop_obj(ap_obj);\n        fz_",
          "new_text": null,
          "old_line_content": "        quad_tpl.Set(str::Format(obj_quad_tpl, r.x0, r.y1, r.x1, r.y1, r.x0, r.y0, r.x1, r.y0));",
          "new_line_content": "    if ((rotation % 180) == 90)",
          "content_same": false
        },
        {
          "line": 2892,
          "old_api": "j);\n    }\n    fz_catch(ctx) {\n        return false;\n    }\n\n    return tru",
          "new_api": null,
          "old_text": "j);\n    }\n    fz_catch(ctx) {\n        return false;\n    }\n\n    return tru",
          "new_text": null,
          "old_line_content": "        quad_tpl.Set(str::Format(obj_quad_tpl, r.x0, r.y0, r.x0, r.y1, r.x1, r.y0, r.x1, r.y1));",
          "new_line_content": "    float rgb[3] = { annot.color.r / 255.f, annot.color.g / 255.f, annot.color.b / 255.f };",
          "content_same": false
        },
        {
          "line": 845,
          "old_api": "oke, ctm, cs, color, 1.0f);\n            fz_dro",
          "new_api": null,
          "old_text": "oke, ctm, cs, color, 1.0f);\n            fz_dro",
          "new_text": null,
          "old_line_content": "            stroke = fz_new_stroke_state_with_dash_len(dev->ctx, 2);",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 2894,
          "old_api": "Count",
          "new_api": null,
          "old_text": "leName)\n{\n    if (!userAnnots.Count())\n        return true;\n\n    ScopedCr",
          "new_text": null,
          "old_line_content": "        quad_tpl.Set(str::Format(obj_quad_tpl, r.x1, r.y0, r.x0, r.y0, r.x1, r.y1, r.x0, r.y1));",
          "new_line_content": "    ScopedMem<char> quad_tpl;",
          "content_same": false
        },
        {
          "line": 2897,
          "old_api": "on> pageAnnots;\n\n    fz_try(ctx) {\n        for (int pageNo = 1; pageNo <= PageCount(); pageNo++) {\n            pdf_page *page = GetPdfPage(pageNo);\n            // TODO: this will skip annotations",
          "new_api": null,
          "old_text": "on> pageAnnots;\n\n    fz_try(ctx) {\n        for (int pageNo = 1; pageNo <= PageCount(); pageNo++) {\n            pdf_page *page = GetPdfPage(pageNo);\n            // TODO: this will skip annotations",
          "new_text": null,
          "old_line_content": "    ScopedMem<char> annot_tpl(str::Format(obj_dict, subtype,",
          "new_line_content": "    else if (90 == rotation)",
          "content_same": false
        },
        {
          "line": 2899,
          "old_api": ");\n            // TO",
          "new_api": null,
          "old_text": ");\n            // TO",
          "new_text": null,
          "old_line_content": "        F_Print, pdf_to_num(page_obj), pdf_to_gen(page_obj), //F and P",
          "new_line_content": "    else if (180 == rotation)",
          "content_same": false
        },
        {
          "line": 853,
          "old_api": "ransparency || pageAnno",
          "new_api": null,
          "old_text": "ransparency || pageAnno",
          "new_text": null,
          "old_line_content": "        fz_colorspace *cs = fz_device_rgb(dev->ctx);",
          "new_line_content": "            stroke->dash_list[stroke->dash_len++] = 1;",
          "content_same": false
        },
        {
          "line": 2901,
          "old_api": "!page || !pdf_to_num(_pageObjs[pageNo - 1])) {",
          "new_api": null,
          "old_text": "!page || !pdf_to_num(_pageObjs[pageNo - 1])) {\n    ",
          "new_text": null,
          "old_line_content": "    ScopedMem<char> annot_ap_dict(str::Format(ap_dict, dx, dy, annot.color.a / 255.f));",
          "new_line_content": "    else // if (270 == rotation)",
          "content_same": false
        },
        {
          "line": 858,
          "old_api": "return;\n    if (!endGroup)\n        fz_begin_group(dev, clipre",
          "new_api": null,
          "old_text": "    return;\n    if (!endGroup)\n        fz_begin_group(dev, clipre",
          "new_text": null,
          "old_line_content": "            fz_fill_path(dev, path, 0, ctm, cs, color, annot.color.a / 255.f);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2910,
          "old_api": "_obj *annots = pdf_dict",
          "new_api": null,
          "old_text": "_obj *annots = pdf_dict",
          "new_text": null,
          "old_line_content": "        pdf_drop_obj(annot_obj);",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 867,
          "old_api": "y<WCHAR>(pdf_to_str_len(obj)",
          "new_api": null,
          "old_text": "y<WCHAR>(pdf_to_str_len(obj)",
          "new_text": null,
          "old_line_content": "        fz_free_path(dev->ctx, path);",
          "new_line_content": "        else {",
          "content_same": false
        },
        {
          "line": 2917,
          "old_api": "t_gets",
          "new_api": null,
          "old_text": "t_gets(_pageObjs[pageNo",
          "new_text": null,
          "old_line_content": "        pdf_drop_obj(annot_obj);",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 876,
          "old_api": "& *c != '\\r' && *c",
          "new_api": null,
          "old_text": "& *c != '\\r' && *c",
          "new_text": null,
          "old_line_content": "    for (size_t i = 0; i < pageAnnots.Count(); i++) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 877,
          "old_api": "return string;",
          "new_api": null,
          "old_text": " return string;\n",
          "new_text": null,
          "old_line_content": "        if (Annot_Highlight == pageAnnots.At(i).type) {",
          "new_line_content": "static void fz_run_page_transparency(Vec<PageAnnotation>& pageAnnots, fz_device *dev, const fz_rect *cliprect, bool endGroup, bool hasTransparency=false)",
          "content_same": false
        },
        {
          "line": 2926,
          "old_api": "or the current page\n            for (size_t i = 0; i < pa",
          "new_api": null,
          "old_text": "or the current page\n            for (size_t i = 0; i < pa",
          "new_text": null,
          "old_line_content": "            annot_ap_stream.Set(str::Format(ap_highlight, rgb[0], rgb[1], rgb[2], dx, dy));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 885,
          "old_api": "pdf_obj *val = pdf_dict_get_val(copy, i);\n        // resolve all in",
          "new_api": null,
          "old_text": "     pdf_obj *val = pdf_dict_get_val(copy, i);\n        // resolve all in",
          "new_text": null,
          "old_line_content": "        fz_begin_group(dev, cliprect ? cliprect : &fz_infinite_rect, 1, 0, 0, 1);",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 887,
          "old_api": "if (pdf_is_i",
          "new_api": null,
          "old_text": "     if (pdf_is_i",
          "new_text": null,
          "old_line_content": "        fz_end_group(dev);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2939,
          "old_api": "_try",
          "new_api": null,
          "old_text": "_try(ctx) {\n        data = pdf_loa",
          "new_text": null,
          "old_line_content": "            pdf_dict_dels(pdf_dict_gets(ap_obj, \"Resources\"), \"ExtGState\");",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 2942,
          "old_api": "edded",
          "new_api": null,
          "old_text": "edded(data->data, data->l",
          "new_text": null,
          "old_line_content": "            pdf_dict_puts_drop(ap_obj, \"Matrix\", pdf_new_matrix(doc, fz_rotate(&rot, rotation)));",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 2944,
          "old_api": "bool PdfEngineImpl::HasC",
          "new_api": null,
          "old_text": "\nbool PdfEngineImpl::HasC",
          "new_text": null,
          "old_line_content": "        ap_buf = fz_new_buffer(ctx, (int)str::Len(annot_ap_stream));",
          "new_line_content": "        if (annot.type != Annot_Highlight)",
          "content_same": false
        },
        {
          "line": 2946,
          "old_api": "eRects[pageNo-1])\n        ret",
          "new_api": null,
          "old_text": "eRects[pageNo-1])\n        ret",
          "new_text": null,
          "old_line_content": "        pdf_dict_puts_drop(ap_obj, \"Length\", pdf_new_int(doc, ap_buf->len));",
          "new_line_content": "        if (rotation) {",
          "content_same": false
        },
        {
          "line": 901,
          "old_api": "rn copy;\n}\n\n// Note",
          "new_api": null,
          "old_text": "rn copy;\n}\n\n// Note",
          "new_text": null,
          "old_line_content": "    ScopedMem<WCHAR> str(AllocArray<WCHAR>(pdf_to_str_len(obj) + 1));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 902,
          "old_api": "ine *pdf_",
          "new_api": null,
          "old_text": "ine *pdf_",
          "new_text": null,
          "old_line_content": "    pdf_to_ucs2_buf((unsigned short *)str.Get(), obj);",
          "new_line_content": "namespace str {",
          "content_same": false
        },
        {
          "line": 903,
          "old_api": "document *doc)",
          "new_api": null,
          "old_text": "document *doc)\n",
          "new_text": null,
          "old_line_content": "    return str.StealData();",
          "new_line_content": "    namespace conv {",
          "content_same": false
        },
        {
          "line": 2949,
          "old_api": "ast 90% of the page\n    for (int i",
          "new_api": null,
          "old_text": "ast 90% of the page\n    for (int i ",
          "new_text": null,
          "old_line_content": "        pdf_update_object(doc, num, ap_obj);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2967,
          "old_api": "*label) const\n{",
          "new_api": null,
          "old_text": " *label) const\n{\n ",
          "new_text": null,
          "old_line_content": "    if (!userAnnots.Count())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 921,
          "old_api": "edded)",
          "new_api": null,
          "old_text": "edded)\n            ",
          "new_text": null,
          "old_line_content": "    pdf_obj *copy = pdf_copy_dict(dict);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 922,
          "old_api": "ode->next = (fz_ou",
          "new_api": null,
          "old_text": "ode->next = (fz_ou",
          "new_text": null,
          "old_line_content": "    for (int i = 0; i < pdf_dict_len(copy); i++) {",
          "new_line_content": "    return string;",
          "content_same": false
        },
        {
          "line": 923,
          "old_api": ", fz_outline);\n        no",
          "new_api": null,
          "old_text": ", fz_outline);\n        no",
          "new_text": null,
          "old_line_content": "        pdf_obj *val = pdf_dict_get_val(copy, i);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 925,
          "old_api": "node->dest.kind = F",
          "new_api": null,
          "old_text": " node->dest.kind = F",
          "new_text": null,
          "old_line_content": "        if (pdf_is_indirect(val)) {",
          "new_line_content": "pdf_obj *pdf_copy_str_dict(pdf_document *doc, pdf_obj *dict)",
          "content_same": false
        },
        {
          "line": 926,
          "old_api": "tr",
          "new_api": null,
          "old_text": "tr(doc, dest);\n    ",
          "new_text": null,
          "old_line_content": "            pdf_obj *val2 = pdf_new_string(doc, pdf_to_str_buf(val), pdf_to_str_len(val));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2978,
          "old_api": "'#') {",
          "new_api": null,
          "old_text": " '#') {\n   ",
          "new_text": null,
          "old_line_content": "        for (int pageNo = 1; pageNo <= PageCount(); pageNo++) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2979,
          "old_api": "AR *PdfLink::GetVa",
          "new_api": null,
          "old_text": "AR *PdfLink::GetVa",
          "new_text": null,
          "old_line_content": "            pdf_page *page = GetPdfPage(pageNo);",
          "new_line_content": "    bool ok = true;",
          "content_same": false
        },
        {
          "line": 2981,
          "old_api": "ink->kind != FZ_LINK_LAUNCH &&",
          "new_api": null,
          "old_text": "ink->kind != FZ_LINK_LAUNCH &&\n  ",
          "new_text": null,
          "old_line_content": "            if (!page || !pdf_to_num(_pageObjs[pageNo - 1])) {",
          "new_line_content": "    Vec<PageAnnotation> pageAnnots;",
          "content_same": false
        },
        {
          "line": 937,
          "old_api": "}\n\nstruct PageLabelInfo {\n    int startA",
          "new_api": null,
          "old_text": "}\n\nstruct PageLabelInfo {\n    int startA",
          "new_text": null,
          "old_line_content": "    pdf_obj *dict = pdf_load_name_tree(doc, \"EmbeddedFiles\");",
          "new_line_content": "    return copy;",
          "content_same": false
        },
        {
          "line": 2986,
          "old_api": "se FZ_LINK_URI:",
          "new_api": null,
          "old_text": "se FZ_LINK_URI:\n  ",
          "new_text": null,
          "old_line_content": "            if (pageAnnots.Count() == 0)",
          "new_line_content": "            // TODO: this will skip annotations for broken documents",
          "content_same": false
        },
        {
          "line": 2989,
          "old_api": "fz_try(engine->ctx) {",
          "new_api": null,
          "old_text": "          fz_try(engine->ctx) {\n              ",
          "new_text": null,
          "old_line_content": "            pdf_obj *annots = pdf_dict_gets(_pageObjs[pageNo - 1], \"Annots\");",
          "new_line_content": "                break;",
          "content_same": false
        },
        {
          "line": 942,
          "old_api": "{\n    return ((Pag",
          "new_api": null,
          "old_text": "{\n    return ((Pag",
          "new_text": null,
          "old_line_content": "    for (int i = 0; i < pdf_dict_len(dict); i++) {",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2990,
          "old_api": "_dict_gets",
          "new_api": null,
          "old_text": "_dict_gets(pdf_trail",
          "new_text": null,
          "old_line_content": "            if (!pdf_is_array(annots)) {",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 944,
          "old_api": "nst char *type, int pageN",
          "new_api": null,
          "old_text": "nst char *type, int pageN",
          "new_text": null,
          "old_line_content": "        pdf_obj *dest = pdf_dict_get_val(dict, i);",
          "new_line_content": "    if (!dict)",
          "content_same": false
        },
        {
          "line": 945,
          "old_api": ", \"D\"))\n        return st",
          "new_api": null,
          "old_text": ", \"D\"))\n        return st",
          "new_text": null,
          "old_line_content": "        pdf_obj *embedded = pdf_dict_getsa(pdf_dict_gets(dest, \"EF\"), \"DOS\", \"F\");",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 2994,
          "old_api": "{ }\n            if (!st",
          "new_api": null,
          "old_text": "{ }\n            if (!st",
          "new_text": null,
          "old_line_content": "            if (!pdf_is_indirect(annots)) {",
          "new_line_content": "            // get the page's /Annots array for appending",
          "content_same": false
        },
        {
          "line": 2999,
          "old_api": ")) {",
          "new_api": null,
          "old_text": ")) {\n             ",
          "new_text": null,
          "old_line_content": "            for (size_t i = 0; i < pageAnnots.Count(); i++) {",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 952,
          "old_api": "if (str::EqI(type, \"A\")) {",
          "new_api": null,
          "old_text": "if (str::EqI(type, \"A\")) {\n    ",
          "new_text": null,
          "old_line_content": "        node->dest.ld.launch.file_spec = pdf_file_spec_to_str(doc, dest);",
          "new_line_content": "        if (!embedded)",
          "content_same": false
        },
        {
          "line": 954,
          "old_api": "r;\n        number.Ap",
          "new_api": null,
          "old_text": "r;\n        number.Ap",
          "new_text": null,
          "old_line_content": "        node->dest.ld.launch.embedded_num = pdf_to_num(embedded);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3021,
          "old_api": "h);\n            path = str::For",
          "new_api": null,
          "old_text": "h);\n            path = str::For",
          "new_text": null,
          "old_line_content": "        data = pdf_load_stream(_doc, num, gen);",
          "new_line_content": "bool PdfEngineImpl::SaveEmbedded(LinkSaverUI& saveUI, int num, int gen)",
          "content_same": false
        },
        {
          "line": 976,
          "old_api": "ay_len",
          "new_api": null,
          "old_text": "ay_len(obj); i++)\n",
          "new_text": null,
          "old_line_content": "    if (str::Eq(type, \"D\"))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 977,
          "old_api": "ageLabelRec",
          "new_api": null,
          "old_text": "ageLabelRec(pdf_array_get(obj, i), p",
          "new_text": null,
          "old_line_content": "        return str::Format(L\"%s%d\", prefix, pageNo);",
          "new_line_content": "    return ((PageLabelInfo *)a)->startAt - ((PageLabelInfo *)b)->startAt;",
          "content_same": false
        },
        {
          "line": 978,
          "old_api": "ata);\n        pdf_u",
          "new_api": null,
          "old_text": "ata);\n        pdf_u",
          "new_text": null,
          "old_line_content": "    if (str::EqI(type, \"R\")) {",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3026,
          "old_api": "nch.embedded_num, lin",
          "new_api": null,
          "old_text": "nch.embedded_num, lin",
          "new_text": null,
          "old_line_content": "    CrashIf(NULL == data);",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 3028,
          "old_api": "GOTOR:\n        if (link->",
          "new_api": null,
          "old_text": "GOTOR:\n        if (link->",
          "new_text": null,
          "old_line_content": "    fz_drop_buffer(ctx, data);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 985,
          "old_api": "startAt = pdf_to_in",
          "new_api": null,
          "old_text": "startAt = pdf_to_in",
          "new_text": null,
          "old_line_content": "    if (str::EqI(type, \"A\")) {",
          "new_line_content": "        // roman numbering style",
          "content_same": false
        },
        {
          "line": 990,
          "old_api": "to_int",
          "new_api": null,
          "old_text": "to_int(pdf_d",
          "new_text": null,
          "old_line_content": "            number.Append(number.At(0));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3039,
          "old_api": "pe) if (str::Eq(name",
          "new_api": null,
          "old_text": "pe) if (str::Eq(name",
          "new_text": null,
          "old_line_content": "    fz_rect mbox = fz_RectD_to_rect(PageMediabox(pageNo));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 992,
          "old_api": ")",
          "new_api": null,
          "old_text": ")\n          ",
          "new_text": null,
          "old_line_content": "            str::ToLower(number.Get());",
          "new_line_content": "        // alphabetic numbering style (A..Z, AA..ZZ, AAA..ZZZ, ...)",
          "content_same": false
        },
        {
          "line": 993,
          "old_api": "(pli);",
          "new_api": null,
          "old_text": "(pli);\n     ",
          "new_text": null,
          "old_line_content": "        return str::Format(L\"%s%s\", prefix, number.Get());",
          "new_line_content": "        str::Str<WCHAR> number;",
          "content_same": false
        },
        {
          "line": 3041,
          "old_api": "e)) return Dest_ ## type ## Dialog\n    //",
          "new_api": null,
          "old_text": "e)) return Dest_ ## type ## Dialog\n    // ",
          "new_text": null,
          "old_line_content": "    for (int i = 0; !fz_is_empty_rect(&imageRects[pageNo-1][i]); i++)",
          "new_line_content": "    // GetPdfPage extracts imageRects for us",
          "content_same": false
        },
        {
          "line": 995,
          "old_api": "*BuildPageLabelV",
          "new_api": null,
          "old_text": "*BuildPageLabelV",
          "new_text": null,
          "old_line_content": "    return str::Dup(prefix);",
          "new_line_content": "        for (int i = 0; i < (pageNo - 1) / 26; i++)",
          "content_same": false
        },
        {
          "line": 3042,
          "old_api": "ions\n    HandleType(NextPage);\n    HandleType(",
          "new_api": null,
          "old_text": "ions\n    HandleType(NextPage);\n    HandleType(",
          "new_text": null,
          "old_line_content": "        if (fz_calc_overlap(mbox, imageRects[pageNo-1][i]) >= 0.9f)",
          "new_line_content": "    if (!page || !imageRects[pageNo-1])",
          "content_same": false
        },
        {
          "line": 3049,
          "old_api": "ef/manual.h",
          "new_api": null,
          "old_text": "ef/manual.h",
          "new_text": null,
          "old_line_content": "    if (!_pagelabels || pageNo < 1 || PageCount() < pageNo)",
          "new_line_content": "            return false;",
          "content_same": false
        },
        {
          "line": 1002,
          "old_api": "At",
          "new_api": null,
          "old_text": "1 && data.At(0).st",
          "new_text": null,
          "old_line_content": "        for (int i = 0; i < pdf_array_len(obj); i++)",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1003,
          "old_api": "1 &&\n        !data.At",
          "new_api": null,
          "old_text": "1 &&\n        !data.At",
          "new_text": null,
          "old_line_content": "            BuildPageLabelRec(pdf_array_get(obj, i), pageCount, data);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1004,
          "old_api": "(0).type, \"D\")) {",
          "new_api": null,
          "old_text": "(0).type, \"D\")) {\n  ",
          "new_text": null,
          "old_line_content": "        pdf_unmark_obj(node);",
          "new_line_content": "void BuildPageLabelRec(pdf_obj *node, int pageCount, Vec<PageLabelInfo>& data)",
          "content_same": false
        },
        {
          "line": 3050,
          "old_api": "nd);\n    HandleType(FullScreen);",
          "new_api": null,
          "old_text": "nd);\n    HandleType(FullScreen);",
          "new_text": null,
          "old_line_content": "        return BaseEngine::GetPageLabel(pageNo);",
          "new_line_content": "    return true;",
          "content_same": false
        },
        {
          "line": 1006,
          "old_api": "ase, no need for special tr",
          "new_api": null,
          "old_text": "ase, no need for special tr",
          "new_text": null,
          "old_line_content": "    else if ((obj = pdf_dict_gets(node, \"Nums\")) != NULL) {",
          "new_line_content": "    pdf_obj *obj;",
          "content_same": false
        },
        {
          "line": 3052,
          "old_api": "HandleType(GoForward);",
          "new_api": null,
          "old_text": "    HandleType(GoForward);\n",
          "new_text": null,
          "old_line_content": "    return str::Dup(_pagelabels->At(pageNo - 1));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3057,
          "old_api": "eDialog",
          "new_api": null,
          "old_text": "eDialog(ZoomTo);\n#undef ",
          "new_text": null,
          "old_line_content": "    int pageNo = _pagelabels ? _pagelabels->Find(label) + 1 : 0;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3059,
          "old_api": "med action that we don't support",
          "new_api": null,
          "old_text": "med action that we don't support ",
          "new_text": null,
          "old_line_content": "        return BaseEngine::GetPageByLabel(label);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1015,
          "old_api": "i).startAt;\n        Scop",
          "new_api": null,
          "old_text": "i).startAt;\n        Scop",
          "new_text": null,
          "old_line_content": "            pli.prefix = pdf_dict_gets(info, \"P\");",
          "new_line_content": "            PageLabelInfo pli;",
          "content_same": false
        },
        {
          "line": 1019,
          "old_api": "1));",
          "new_api": null,
          "old_text": " 1));\n          ",
          "new_text": null,
          "old_line_content": "            data.Append(pli);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1027,
          "old_api": "fix);\n        }\n    }\n\n    for (int ix =",
          "new_api": null,
          "old_text": "fix);\n        }\n    }\n\n    for (int ix =",
          "new_text": null,
          "old_line_content": "    BuildPageLabelRec(root, pageCount, data);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1028,
          "old_api": "Find",
          "new_api": null,
          "old_text": " = labels->Find(NULL, ix)) ",
          "new_text": null,
          "old_line_content": "    data.Sort(CmpPageLabelInfo);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1030,
          "old_api": "labe",
          "new_api": null,
          "old_text": "        labe",
          "new_text": null,
          "old_line_content": "    if (data.Count() == 0)",
          "new_line_content": "WStrVec *BuildPageLabelVec(pdf_obj *root, int pageCount)",
          "content_same": false
        },
        {
          "line": 3087,
          "old_api": "return Dest_LaunchFile;\n    de",
          "new_api": null,
          "old_text": "       return Dest_LaunchFile;\n    de",
          "new_text": null,
          "old_line_content": "        path = str::conv::FromUtf8(link->ld.uri.uri);",
          "new_line_content": "    ScopedCritSec scope(&engine->ctxAccess);",
          "content_same": false
        },
        {
          "line": 3088,
          "old_api": "return Dest_None; /",
          "new_api": null,
          "old_text": "return Dest_None; /",
          "new_text": null,
          "old_line_content": "        if (IsRelativeURI(path)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1042,
          "old_api": "Sco",
          "new_api": null,
          "old_text": "       Sco",
          "new_text": null,
          "old_line_content": "    for (size_t i = 0; i < data.Count() && data.At(i).startAt <= pageCount; i++) {",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 1043,
          "old_api": "r::Format(",
          "new_api": null,
          "old_text": "r::Format(",
          "new_text": null,
          "old_line_content": "        int secLen = pageCount + 1 - data.At(i).startAt;",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1044,
          "old_api": "} while (label",
          "new_api": null,
          "old_text": "} while (label",
          "new_text": null,
          "old_line_content": "        if (i < data.Count() - 1 && data.At(i + 1).startAt <= pageCount)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1045,
          "old_api": "que);",
          "new_api": null,
          "old_text": "que);\n    ",
          "new_text": null,
          "old_line_content": "            secLen = data.At(i + 1).startAt - data.At(i).startAt;",
          "new_line_content": "    WStrVec *labels = new WStrVec();",
          "content_same": false
        },
        {
          "line": 3090,
          "old_api": "eNo",
          "new_api": null,
          "old_text": "eNo() const\n{\n    i",
          "new_text": null,
          "old_line_content": "            fz_try(engine->ctx) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3091,
          "old_api": "turn link->ld.gotor.page",
          "new_api": null,
          "old_text": "turn link->ld.gotor.page ",
          "new_text": null,
          "old_line_content": "                pdf_obj *obj = pdf_dict_gets(pdf_trailer(engine->_doc), \"Root\");",
          "new_line_content": "    switch (link->kind) {",
          "content_same": false
        },
        {
          "line": 3092,
          "old_api": "&& !link->ld.gotor.dest)",
          "new_api": null,
          "old_text": " && !link->ld.gotor.dest)",
          "new_text": null,
          "old_line_content": "                obj = pdf_dict_gets(pdf_dict_gets(obj, \"URI\"), \"Base\");",
          "new_line_content": "    case FZ_LINK_URI:",
          "content_same": false
        },
        {
          "line": 3099,
          "old_api": "urn result",
          "new_api": null,
          "old_text": "urn result",
          "new_text": null,
          "old_line_content": "                free(path);",
          "new_line_content": "                if (obj)",
          "content_same": false
        },
        {
          "line": 1059,
          "old_api": "reeStackIte",
          "new_api": null,
          "old_text": "reeStackIte",
          "new_text": null,
          "old_line_content": "    dups.Sort();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3109,
          "old_api": "nsform_point",
          "new_api": null,
          "old_text": "nsform_point(&rb, &page->ctm);\n\n    ",
          "new_text": null,
          "old_line_content": "            ScopedMem<WCHAR> uri(str::Format(L\"%s?%d,%d\", path, x, y));",
          "new_line_content": "        if (link->ld.uri.is_map) {",
          "content_same": false
        },
        {
          "line": 3110,
          "old_api": "tor.flags",
          "new_api": null,
          "old_text": "tor.flags ",
          "new_text": null,
          "old_line_content": "            free(path);",
          "new_line_content": "            int x = 0, y = 0;",
          "content_same": false
        },
        {
          "line": 1063,
          "old_api": "ERIC, \"cyc",
          "new_api": null,
          "old_text": "ERIC, \"cyc",
          "new_text": null,
          "old_line_content": "        int ix = labels->Find(dups.At(i)), counter = 0;",
          "new_line_content": "    // ensure that all page labels are unique (by appending a number to duplicates)",
          "content_same": false
        },
        {
          "line": 1064,
          "old_api": ";;) {",
          "new_api": null,
          "old_text": ";;) {\n    ",
          "new_text": null,
          "old_line_content": "        while ((ix = labels->Find(dups.At(i), ix + 1)) != -1) {",
          "new_line_content": "    WStrVec dups(*labels);",
          "content_same": false
        },
        {
          "line": 1068,
          "old_api": "top.next_page_no;",
          "new_api": null,
          "old_text": "top.next_page_no;\n      ",
          "new_text": null,
          "old_line_content": "            } while (labels->Contains(unique));",
          "new_line_content": "            continue;",
          "content_same": false
        },
        {
          "line": 3118,
          "old_api": "else if ((link->ld.gotor.fla",
          "new_api": null,
          "old_text": " else if ((link->ld.gotor.fla",
          "new_text": null,
          "old_line_content": "        if (path && link->ld.launch.embedded_num && str::EndsWithI(path, L\".pdf\")) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1071,
          "old_api": "}",
          "new_api": null,
          "old_text": "    }\n\n       ",
          "new_text": null,
          "old_line_content": "        for (; i + 1 < dups.Count() && str::Eq(dups.At(i), dups.At(i + 1)); i++);",
          "new_line_content": "            ScopedMem<WCHAR> unique;",
          "content_same": false
        },
        {
          "line": 3119,
          "old_api": "g_fit_h |",
          "new_api": null,
          "old_text": "g_fit_h | ",
          "new_text": null,
          "old_line_content": "            free(path);",
          "new_line_content": "        break;",
          "content_same": false
        },
        {
          "line": 3120,
          "old_api": "z_link_flag_fit_v)",
          "new_api": null,
          "old_text": "z_link_flag_fit_v)",
          "new_text": null,
          "old_line_content": "            path = str::Format(L\"%s:%d:%d\", engine->FileName(),",
          "new_line_content": "    case FZ_LINK_LAUNCH:",
          "content_same": false
        },
        {
          "line": 1083,
          "old_api": "{\ntoler",
          "new_api": null,
          "old_text": " {\ntoler",
          "new_text": null,
          "old_line_content": "    explicit PageTreeStackItem(pdf_obj *kids, int next_page_no=0) :",
          "new_line_content": "struct PageTreeStackItem {",
          "content_same": false
        },
        {
          "line": 1084,
          "old_api": "fz_throw(ctx",
          "new_api": null,
          "old_text": "       fz_throw(ctx",
          "new_text": null,
          "old_line_content": "        kids(kids), i(-1), len(pdf_array_len(kids)), next_page_no(next_page_no) { }",
          "new_line_content": "    pdf_obj *kids;",
          "content_same": false
        },
        {
          "line": 3139,
          "old_api": "es only affect the z",
          "new_api": null,
          "old_text": "es only affect the z",
          "new_text": null,
          "old_line_content": "    HandleType(NextPage);",
          "new_line_content": "static PageDestType DestTypeFromName(const char *name)",
          "content_same": false
        },
        {
          "line": 3140,
          "old_api": "el, which we intenti",
          "new_api": null,
          "old_text": "el, which we intenti",
          "new_text": null,
          "old_line_content": "    HandleType(PrevPage);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3141,
          "old_api": "leave alone\n    retur",
          "new_api": null,
          "old_text": "leave alone\n    retur",
          "new_text": null,
          "old_line_content": "    HandleType(FirstPage);",
          "new_line_content": "    // named actions are converted either to Dest_Name or Dest_NameDialog",
          "content_same": false
        },
        {
          "line": 1094,
          "old_api": "d, \"Kids\")) {",
          "new_api": null,
          "old_text": "d, \"Kids\")) {\n  ",
          "new_text": null,
          "old_line_content": "    PageTreeStackItem top(pdf_dict_getp(pdf_trailer(doc), \"Root/Pages/Kids\"));",
          "new_line_content": "pdf_load_page_objs(pdf_document *doc, pdf_obj **page_objs)",
          "content_same": false
        },
        {
          "line": 3142,
          "old_api": "t;\n}\n\nWCHAR *PdfLink",
          "new_api": null,
          "old_text": "t;\n}\n\nWCHAR *PdfLink",
          "new_text": null,
          "old_line_content": "    HandleType(LastPage);",
          "new_line_content": "#define HandleType(type) if (str::Eq(name, #type)) return Dest_ ## type",
          "content_same": false
        },
        {
          "line": 1096,
          "old_api": "nt",
          "new_api": null,
          "old_text": "nt(pdf_dict_gets(kid, ",
          "new_text": null,
          "old_line_content": "    if (pdf_mark_obj(top.kids))",
          "new_line_content": "    fz_context *ctx = doc->ctx;",
          "content_same": false
        },
        {
          "line": 1097,
          "old_api": "if (count > 0) {",
          "new_api": null,
          "old_text": "                if (count > 0) {\n                    ",
          "new_text": null,
          "old_line_content": "        fz_throw(ctx, FZ_ERROR_GENERIC, \"cycle in page tree\");",
          "new_line_content": "    int page_no = 0;",
          "content_same": false
        },
        {
          "line": 3149,
          "old_api": "opedCritSec scope(&engine-",
          "new_api": null,
          "old_text": "opedCritSec scope(&engine-",
          "new_text": null,
          "old_line_content": "    HandleTypeDialog(GoToPage);",
          "new_line_content": "    // Adobe Reader extensions to the spec",
          "content_same": false
        },
        {
          "line": 3150,
          "old_api": "ess);\n    return engine",
          "new_api": null,
          "old_text": "ess);\n    return engine",
          "new_text": null,
          "old_line_content": "    HandleTypeDialog(Print);",
          "new_line_content": "    // cf. http://www.tug.org/applications/hyperref/manual.html",
          "content_same": false
        },
        {
          "line": 1106,
          "old_api": "}",
          "new_api": null,
          "old_text": " }\n         ",
          "new_text": null,
          "old_line_content": "                if (stack.Size() == 0)",
          "new_line_content": "        for (;;) {",
          "content_same": false
        },
        {
          "line": 1108,
          "old_api": "page tree",
          "new_api": null,
          "old_text": " page tree ",
          "new_text": null,
          "old_line_content": "                top = stack.Pop();",
          "new_line_content": "            if (top.i == top.len) {",
          "content_same": false
        },
        {
          "line": 1113,
          "old_api": "Size",
          "new_api": null,
          "old_text": "tack.Size(); i++) {\n      ",
          "new_text": null,
          "old_line_content": "            char *type = pdf_to_name(pdf_dict_gets(kid, \"Type\"));",
          "new_line_content": "                    break;",
          "content_same": false
        },
        {
          "line": 1116,
          "old_api": "F, now follows PdfEn",
          "new_api": null,
          "old_text": "F, now follows PdfEn",
          "new_text": null,
          "old_line_content": "                if (page_no >= pdf_count_pages(doc))",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1117,
          "old_api": "ageRun {\n    pdf_page *page;\n    fz_display_list *list;\n    size_t size_est;",
          "new_api": null,
          "old_text": "ageRun {\n    pdf_page *page;\n    fz_display_list *list;\n    size_t size_est;",
          "new_text": null,
          "old_line_content": "                    fz_throw(ctx, FZ_ERROR_GENERIC, \"found more /Page objects than anticipated\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3170,
          "old_api": "PdfEngineImpl();\n    if (!engine->Loa",
          "new_api": null,
          "old_text": " PdfEngineImpl();\n    if (!engine->Loa",
          "new_text": null,
          "old_line_content": "        return DestTypeFromName(link->ld.named.named);",
          "new_line_content": "    switch (link->kind) {",
          "content_same": false
        },
        {
          "line": 1126,
          "old_api": "ge;\n\nclass PdfEngineImpl :",
          "new_api": null,
          "old_text": "ge;\n\nclass PdfEngineImpl :",
          "new_text": null,
          "old_line_content": "                    top = PageTreeStackItem(pdf_dict_gets(kid, \"Kids\"), page_no + count);",
          "new_line_content": "                page_no++;",
          "content_same": false
        },
        {
          "line": 1133,
          "old_api": "virtual int PageCount() const {\n        // make sure",
          "new_api": null,
          "old_text": "   virtual int PageCount() const {\n        // make sure",
          "new_text": null,
          "old_line_content": "                fz_warn(ctx, \"non-page object in page tree (%s)\", type);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1140,
          "old_api": "PageMediab",
          "new_api": null,
          "old_text": " PageMediab",
          "new_text": null,
          "old_line_content": "            pdf_unmark_obj(stack.At(i).kids);",
          "new_line_content": "                goto tolerate_broken_page_tree;",
          "content_same": false
        },
        {
          "line": 1142,
          "old_api": "RectD PageContentBox(int",
          "new_api": null,
          "old_text": "RectD PageContentBox(int",
          "new_text": null,
          "old_line_content": "        pdf_unmark_obj(top.kids);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1143,
          "old_api": "nderTarget targ",
          "new_api": null,
          "old_text": "nderTarget targ",
          "new_text": null,
          "old_line_content": "        fz_rethrow(ctx);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3198,
          "old_api": "http://schemas.ope",
          "new_api": null,
          "old_text": " http://schemas.ope",
          "new_text": null,
          "old_line_content": "    if (link->ld.gotor.page < 0 || link->ld.gotor.page >= engine->PageCount())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3201,
          "old_api": "s\n#define NS_XPS_MICROSOFT \"http://schemas.",
          "new_api": null,
          "old_text": "s\n#define NS_XPS_MICROSOFT \"http://schemas.",
          "new_text": null,
          "old_line_content": "    pdf_page *page = engine->GetPdfPage(link->ld.gotor.page + 1);",
          "new_line_content": "    RectD result(DEST_USE_DEFAULT, DEST_USE_DEFAULT, DEST_USE_DEFAULT, DEST_USE_DEFAULT);",
          "content_same": false
        },
        {
          "line": 3205,
          "old_api": "= doc->first_page;\n    for (int n =",
          "new_api": null,
          "old_text": "= doc->first_page;\n    for (int n =",
          "new_text": null,
          "old_line_content": "    fz_transform_point(&lt, &page->ctm);",
          "new_line_content": "        return result;",
          "content_same": false
        },
        {
          "line": 3206,
          "old_api": "number && page; n++)\n        page",
          "new_api": null,
          "old_text": " number && page; n++)\n        page ",
          "new_text": null,
          "old_line_content": "    fz_transform_point(&rb, &page->ctm);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3219,
          "old_api": "3;\n        data_size -= 3;\n    }",
          "new_api": null,
          "old_text": "3;\n        data_size -= 3;\n    }\n\n   ",
          "new_text": null,
          "old_line_content": "        result = RectD::FromXY(lt.x, lt.y, rb.x, rb.y);",
          "new_line_content": "            result.y = lt.y;",
          "content_same": false
        },
        {
          "line": 3221,
          "old_api": "ct;\n    if (tok",
          "new_api": null,
          "old_text": "ct;\n    if (tok ",
          "new_text": null,
          "old_line_content": "        if (result.IsEmpty())",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1180,
          "old_api": "{\n        return Save",
          "new_api": null,
          "old_text": "{\n        return Save",
          "new_text": null,
          "old_line_content": "        return _doc ? pdf_count_pages(_doc) : 0;",
          "new_line_content": "    virtual BaseEngine *Clone();",
          "content_same": false
        },
        {
          "line": 3237,
          "old_api": "ScopedMem<WCHAR> creation_date;",
          "new_api": null,
          "old_text": "\n    ScopedMem<WCHAR> creation_date;\n   ",
          "new_text": null,
          "old_line_content": "    return str::conv::FromUtf8(link->ld.gotor.dest);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1191,
          "old_api": "return pdf_has_pe",
          "new_api": null,
          "old_text": " return pdf_has_pe",
          "new_text": null,
          "old_line_content": "        return RenderPage(hDC, GetPdfPage(pageNo), screenRect, NULL, zoom, rotation, pageRect, target, cookie_out);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1200,
          "old_api": "}\n    virtual DocTocItem *GetTocTree();",
          "new_api": null,
          "old_text": " }\n    virtual DocTocItem *GetTocTree();\n\n",
          "new_text": null,
          "old_line_content": "        return SaveFileAs(pdfFileName, includeUserAnnots);",
          "new_line_content": "    virtual PointD Transform(PointD pt, int pageNo, float zoom, int rotation, bool inverse=false);",
          "content_same": false
        },
        {
          "line": 3259,
          "old_api": "-text content for property",
          "new_api": null,
          "old_text": "-text content for property ",
          "new_text": null,
          "old_line_content": "    if (!engine->Load(stream, pwdUI)) {",
          "new_line_content": "    return engine;",
          "content_same": false
        },
        {
          "line": 1212,
          "old_api": "isProtected;\n\n    // make sure to never",
          "new_api": null,
          "old_text": "isProtected;\n\n    // make sure to never ",
          "new_text": null,
          "old_line_content": "        return pdf_has_permission(_doc, PDF_PERM_PRINT);",
          "new_line_content": "    virtual WCHAR *GetProperty(DocumentProperty prop);",
          "content_same": false
        },
        {
          "line": 1215,
          "old_api": "n order to avoid deadlocks\n    CRITICAL",
          "new_api": null,
          "old_text": "n order to avoid deadlocks\n    CRITICAL",
          "new_text": null,
          "old_line_content": "        return pdf_has_permission(_doc, PDF_PERM_COPY);",
          "new_line_content": "    virtual void UpdateUserAnnotations(Vec<PageAnnotation> *list);",
          "content_same": false
        },
        {
          "line": 3272,
          "old_api": "eturn str::conv::FromHtmlUtf8(start, end - st",
          "new_api": null,
          "old_text": "eturn str::conv::FromHtmlUtf8(start, end - st",
          "new_text": null,
          "old_line_content": "        file::ReadN(fileName, header, sizeof(header));",
          "new_line_content": "namespace PdfEngine {",
          "content_same": false
        },
        {
          "line": 3275,
          "old_api": "/package/2006/relationships/met",
          "new_api": null,
          "old_text": "/package/2006/relationships/met",
          "new_text": null,
          "old_line_content": "            if (str::EqN(header + i, \"%PDF\", 4))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3286,
          "old_api": "ot);\n        fz_throw(doc->ctx, FZ_ERROR_GENER",
          "new_api": null,
          "old_text": "ot);\n        fz_throw(doc->ctx, FZ_ERROR_GENER",
          "new_text": null,
          "old_line_content": "    return PdfEngineImpl::CreateFromFile(fileName, pwdUI);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3291,
          "old_api": "for (fz_xml *item = fz_xml_down(root); item;",
          "new_api": null,
          "old_text": " for (fz_xml *item = fz_xml_down(root); item; ",
          "new_text": null,
          "old_line_content": "    return PdfEngineImpl::CreateFromStream(stream, pwdUI);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3312,
          "old_api": "orrect_root) {\n        fz_free",
          "new_api": null,
          "old_text": "orrect_root) {\n        fz_free",
          "new_text": null,
          "old_line_content": "    xps_part *part = page ? xps_read_part(doc, page->name) : NULL;",
          "new_line_content": "xps_bound_page_quick(xps_document *doc, int number)",
          "content_same": false
        },
        {
          "line": 1267,
          "old_api": "FitzAbortCookie *coo",
          "new_api": null,
          "old_text": "FitzAbortCookie *coo",
          "new_text": null,
          "old_line_content": "        const fz_rect tmpRc = fz_RectD_to_rect(PageMediabox(pageNo));",
          "new_line_content": "    bool            LoadFromStream(fz_stream *stm, PasswordUI *pwdUI=NULL);",
          "content_same": false
        },
        {
          "line": 1268,
          "old_api": "DropPageRun(PdfPageRun *run, b",
          "new_api": null,
          "old_text": "            DropPageRun(PdfPageRun *run, b",
          "new_text": null,
          "old_line_content": "        return fz_create_view_ctm(&tmpRc, zoom, rotation);",
          "new_line_content": "    bool            FinishLoading();",
          "content_same": false
        },
        {
          "line": 1272,
          "old_api": "e *page);\n    pdf_annot    **",
          "new_api": null,
          "old_text": "e *page);\n    pdf_annot    ** ",
          "new_text": null,
          "old_line_content": "        return fz_create_view_ctm(pdf_bound_page(_doc, page, &r), zoom, rotation);",
          "new_line_content": "    fz_matrix       viewctm(int pageNo, float zoom, int rotation) {",
          "content_same": false
        },
        {
          "line": 3320,
          "old_api": "(str::Eq(fz_xml_tag(item), /*\"dc:",
          "new_api": null,
          "old_text": " (str::Eq(fz_xml_tag(item), /*\"dc:",
          "new_text": null,
          "old_line_content": "    if (str::StartsWith(data, UTF16BE_BOM)) {",
          "new_line_content": "        return fz_empty_rect;",
          "content_same": false
        },
        {
          "line": 3322,
          "old_api": "ore_prop",
          "new_api": null,
          "old_text": "ore_prop(doc->ctx, item));\n        e",
          "new_text": null,
          "old_line_content": "            Swap(part->data[i], part->data[i+1]);",
          "new_line_content": "    const char *data = (const char *)part->data;",
          "content_same": false
        },
        {
          "line": 3325,
          "old_api": "em), /*\"dc:\"*/\"creator\") && !pro",
          "new_api": null,
          "old_text": "em), /*\"dc:\"*/\"creator\") && !pro",
          "new_text": null,
          "old_line_content": "    if (str::StartsWith(data, UTF16_BOM)) {",
          "new_line_content": "    ScopedMem<char> dataUtf8;",
          "content_same": false
        },
        {
          "line": 3330,
          "old_api": "Set",
          "new_api": null,
          "old_text": ".Set(xps_get_core_prop(doc->ctx",
          "new_text": null,
          "old_line_content": "    else if (str::StartsWith(data, UTF8_BOM)) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3338,
          "old_api": "_xml_tag",
          "new_api": null,
          "old_text": "_xml_tag(item), /*\"dcterms:\"*/\"modified\") &&",
          "new_text": null,
          "old_line_content": "    if (tok && tok->IsStartTag() && tok->NameIsNS(\"FixedPage\", NS_XPS_MICROSOFT)) {",
          "new_line_content": "        data_size -= 3;",
          "content_same": false
        },
        {
          "line": 3339,
          "old_api": "Set",
          "new_api": null,
          "old_text": "          props->modification_date.Set(xps_get_",
          "new_text": null,
          "old_line_content": "        AttrInfo *attr = tok->GetAttrByNameNS(\"Width\", NS_XPS_MICROSOFT);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3341,
          "old_api": "xml",
          "new_api": null,
          "old_text": "xml(doc->ctx, root",
          "new_text": null,
          "old_line_content": "            bounds.x1 = fz_atof(attr->val) * 72.0f / 96.0f;",
          "new_line_content": "    HtmlPullParser p(data, data_size);",
          "content_same": false
        },
        {
          "line": 3365,
          "old_api": "Clone",
          "new_api": null,
          "old_text": "Clone();\n\n    virtual co",
          "new_text": null,
          "old_line_content": "    xps_part *part = xps_read_part(doc, path);",
          "new_line_content": "};",
          "content_same": false
        },
        {
          "line": 3367,
          "old_api": "*FileName() con",
          "new_api": null,
          "old_text": " *FileName() con",
          "new_text": null,
          "old_line_content": "    fz_try(doc->ctx) {",
          "new_line_content": "static fz_xml *",
          "content_same": false
        },
        {
          "line": 3368,
          "old_api": "me; };\n    virtual int PageCount() const {",
          "new_api": null,
          "old_text": "me; };\n    virtual int PageCount() const {\n   ",
          "new_text": null,
          "old_line_content": "        root = fz_parse_xml(doc->ctx, part->data, part->size);",
          "new_line_content": "xps_open_and_parse(xps_document *doc, char *path)",
          "content_same": false
        },
        {
          "line": 1321,
          "old_api": "em",
          "new_api": null,
          "old_text": "em(WCHAR *title, PdfLi",
          "new_text": null,
          "old_line_content": "        engine(engine), link(link), rect(fz_rect_to_RectD(rect)), pageNo(pageNo) {",
          "new_line_content": "    int pageNo;",
          "content_same": false
        },
        {
          "line": 3370,
          "old_api": "oc ? xps_count_page",
          "new_api": null,
          "old_text": "oc ? xps_count_page",
          "new_text": null,
          "old_line_content": "    fz_always(doc->ctx) {",
          "new_line_content": "    fz_xml *root = NULL;",
          "content_same": false
        },
        {
          "line": 1324,
          "old_api": "PdfImage : public P",
          "new_api": null,
          "old_text": " PdfImage : public P",
          "new_text": null,
          "old_line_content": "            this->pt = PointD(pt->x, pt->y);",
          "new_line_content": "public:",
          "content_same": false
        },
        {
          "line": 3383,
          "old_api": "",
          "new_api": null,
          "old_text": "                 ",
          "new_text": null,
          "old_line_content": "    fz_xml *text = fz_xml_down(item);",
          "new_line_content": "    return root;",
          "content_same": false
        },
        {
          "line": 1336,
          "old_api": "CHAR *GetV",
          "new_api": null,
          "old_text": "CHAR *GetV",
          "new_text": null,
          "old_line_content": "    virtual WCHAR *GetDestValue() const { return GetValue(); }",
          "new_line_content": "    virtual WCHAR *GetValue() const;",
          "content_same": false
        },
        {
          "line": 3387,
          "old_api": "*/",
          "new_api": null,
          "old_text": " */\n             ",
          "new_text": null,
          "old_line_content": "    if (!fz_xml_text(text) || fz_xml_next(text)) {",
          "new_line_content": "xps_get_core_prop(fz_context *ctx, fz_xml *item)",
          "content_same": false
        },
        {
          "line": 3388,
          "old_api": "kie_out=NULL);",
          "new_api": null,
          "old_text": "kie_out=NULL);\n ",
          "new_text": null,
          "old_line_content": "        fz_warn(ctx, \"non-text content for property %s\", fz_xml_tag(item));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1348,
          "old_api": "NULL),\n    _decryptionK",
          "new_api": null,
          "old_text": "NULL),\n    _decryptionK",
          "new_text": null,
          "old_line_content": "        annot(Annot_None, pageNo, rect, PageAnnotation::Color()),",
          "new_line_content": "class PdfComment : public PageElement {",
          "content_same": false
        },
        {
          "line": 1349,
          "old_api": "d",
          "new_api": null,
          "old_text": "d(false),\n    pag",
          "new_text": null,
          "old_line_content": "        content(str::Dup(content)) { }",
          "new_line_content": "    PageAnnotation annot;",
          "content_same": false
        },
        {
          "line": 3396,
          "old_api": "derPage",
          "new_api": null,
          "old_text": "derPage(hDC, GetXpsPage(pageNo), screenRect",
          "new_text": null,
          "old_line_content": "    return str::conv::FromHtmlUtf8(start, end - start);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3405,
          "old_api": ", int rotation, bool inverse=false);",
          "new_api": null,
          "old_text": ", int rotation, bool inverse=false);\n\n ",
          "new_text": null,
          "old_line_content": "    fz_xml *root = xps_open_and_parse(doc, \"/_rels/.rels\");",
          "new_line_content": "#define REL_CORE_PROPERTIES \\",
          "content_same": false
        },
        {
          "line": 3407,
          "old_api": "leData",
          "new_api": null,
          "old_text": "leData(size_t *c",
          "new_text": null,
          "old_line_content": "    if (!root || !str::Eq(fz_xml_tag(root), \"Relationships\")) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3408,
          "old_api": "ileAs",
          "new_api": null,
          "old_text": "ileAs(const WCHAR *copyFile",
          "new_text": null,
          "old_line_content": "        fz_free_xml(doc->ctx, root);",
          "new_line_content": "xps_doc_props *",
          "content_same": false
        },
        {
          "line": 3409,
          "old_api": "includeUserAnnots=false);\n    virtual WCHAR * ExtractPageText(int pageNo,",
          "new_api": null,
          "old_text": "includeUserAnnots=false);\n    virtual WCHAR * ExtractPageText(int pageNo, ",
          "new_text": null,
          "old_line_content": "        fz_throw(doc->ctx, FZ_ERROR_GENERIC, \"couldn't parse part '/_rels/.rels'\");",
          "new_line_content": "xps_extract_doc_props(xps_document *doc)",
          "content_same": false
        },
        {
          "line": 3417,
          "old_api": "pdateUserAn",
          "new_api": null,
          "old_text": "pdateUserAn",
          "new_text": null,
          "old_line_content": "            xps_resolve_url(path, \"\", fz_xml_att(item, \"Target\"), nelem(path));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3418,
          "old_api": "geAnnotation> *list);",
          "new_api": null,
          "old_text": "geAnnotation> *list);\n\n    ",
          "new_text": null,
          "old_line_content": "            fz_free_xml(doc->ctx, root);",
          "new_line_content": "    bool has_correct_root = false;",
          "content_same": false
        },
        {
          "line": 1374,
          "old_api": "[i]);\n        }",
          "new_api": null,
          "old_text": "[i]);\n        }\n      ",
          "new_text": null,
          "old_line_content": "        engine(engine), pageNo(pageNo), rect(fz_rect_to_RectD(rect)), imageIx(imageIx) { }",
          "new_line_content": "    int pageNo;",
          "content_same": false
        },
        {
          "line": 3426,
          "old_api": "turn GetXpsPage(pageNo) !=",
          "new_api": null,
          "old_text": "turn GetXpsPage(pageNo) != ",
          "new_text": null,
          "old_line_content": "        fz_free_xml(doc->ctx, root);",
          "new_line_content": "            has_correct_root = true;",
          "content_same": false
        },
        {
          "line": 1382,
          "old_api": "i < PageCount(); i++) {\n            free(im",
          "new_api": null,
          "old_text": "i < PageCount(); i++) {\n            free(im",
          "new_text": null,
          "old_line_content": "        return engine->GetPageImage(pageNo, rect, imageIx);",
          "new_line_content": "    virtual PageElementType GetType() const { return Element_Image; }",
          "content_same": false
        },
        {
          "line": 3433,
          "old_api": "AR *name);\n    v",
          "new_api": null,
          "old_text": "AR *name);\n    v",
          "new_text": null,
          "old_line_content": "        if (str::Eq(fz_xml_tag(item), /*\"dc:\"*/\"title\") && !props->title)",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 3434,
          "old_api": "ual DocTocItem *GetTocTree();",
          "new_api": null,
          "old_text": "ual DocTocItem *GetTocTree();\n\n  ",
          "new_text": null,
          "old_line_content": "            props->title.Set(xps_get_core_prop(doc->ctx, item));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3435,
          "old_api": "char *target);",
          "new_api": null,
          "old_text": "char *target);\n\n",
          "new_text": null,
          "old_line_content": "        else if (str::Eq(fz_xml_tag(item), /*\"dc:\"*/\"creator\") && !props->author)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3436,
          "old_api": "BaseEngine *CreateFromStream(ISt",
          "new_api": null,
          "old_text": " BaseEngine *CreateFromStream(ISt",
          "new_text": null,
          "old_line_content": "            props->author.Set(xps_get_core_prop(doc->ctx, item));",
          "new_line_content": "    xps_doc_props *props = new xps_doc_props();",
          "content_same": false
        },
        {
          "line": 3437,
          "old_api": "WCHAR *_fileNa",
          "new_api": null,
          "old_text": "  WCHAR *_fileNa",
          "new_text": null,
          "old_line_content": "        else if (str::Eq(fz_xml_tag(item), /*\"dc:\"*/\"subject\") && !props->subject)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1392,
          "old_api": "delete _pagelabels;\n    free(_file",
          "new_api": null,
          "old_text": "\n    delete _pagelabels;\n    free(_file",
          "new_text": null,
          "old_line_content": "    InitializeCriticalSection(&pagesAccess);",
          "new_line_content": "PdfEngineImpl::PdfEngineImpl() : _fileName(NULL), _doc(NULL),",
          "content_same": false
        },
        {
          "line": 1393,
          "old_api": "free(_decryptionKey);\n\n    LeaveC",
          "new_api": null,
          "old_text": "    free(_decryptionKey);\n\n    LeaveC",
          "new_text": null,
          "old_line_content": "    InitializeCriticalSection(&ctxAccess);",
          "new_line_content": "    _pages(NULL), _pageObjs(NULL), _mediaboxes(NULL), _info(NULL),",
          "content_same": false
        },
        {
          "line": 1401,
          "old_api": "ic:\n    explicit PasswordCloner(unsigne",
          "new_api": null,
          "old_text": "ic:\n    explicit PasswordCloner(unsigne",
          "new_text": null,
          "old_line_content": "        pdf_install_load_system_font_funcs(ctx);",
          "new_line_content": "    fz_locks_ctx.user = &ctxAccess;",
          "content_same": false
        },
        {
          "line": 1406,
          "old_api": "virtual WCHAR * GetPassword(const",
          "new_api": null,
          "old_text": "virtual WCHAR * GetPassword(const ",
          "new_text": null,
          "old_line_content": "    EnterCriticalSection(&pagesAccess);",
          "new_line_content": "    if (ctx)",
          "content_same": false
        },
        {
          "line": 1410,
          "old_api": "ecryptionKe",
          "new_api": null,
          "old_text": "ecryptionKe",
          "new_text": null,
          "old_line_content": "        for (int i = 0; i < PageCount(); i++) {",
          "new_line_content": "PdfEngineImpl::~PdfEngineImpl()",
          "content_same": false
        },
        {
          "line": 1411,
          "old_api": "y) {\n        memcpy(decryption",
          "new_api": null,
          "old_text": "y) {\n        memcpy(decryption",
          "new_text": null,
          "old_line_content": "            pdf_free_page(_doc, _pages[i]);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1424,
          "old_api": "c))\n        pwdUI =",
          "new_api": null,
          "old_text": "c))\n        pwdUI =",
          "new_text": null,
          "old_line_content": "    pdf_drop_obj(_info);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3474,
          "old_api": "**cookie_out);\n    WC",
          "new_api": null,
          "old_text": "**cookie_out);\n    WC",
          "new_text": null,
          "old_line_content": "        return _doc ? xps_count_pages(_doc) : 0;",
          "new_line_content": "    XpsEngineImpl();",
          "content_same": false
        },
        {
          "line": 1427,
          "old_api": "Impl *clone",
          "new_api": null,
          "old_text": "Impl *clone",
          "new_text": null,
          "old_line_content": "        for (int i = 0; i < PageCount(); i++) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3485,
          "old_api": "ol forceRemove=fal",
          "new_api": null,
          "old_text": "ol forceRemove=fal",
          "new_text": null,
          "old_line_content": "        return RenderPage(hDC, GetXpsPage(pageNo), screenRect, NULL, zoom, rotation, pageRect, cookie_out);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1441,
          "old_api": "lone->UpdateUse",
          "new_api": null,
          "old_text": "lone->UpdateUse",
          "new_text": null,
          "old_line_content": "        DropPageRun(runCache.Last(), true);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1444,
          "old_api": "s);\n\n    return clone;\n}",
          "new_api": null,
          "old_text": "s);\n\n    return clone;\n}",
          "new_text": null,
          "old_line_content": "    pdf_close_document(_doc);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3495,
          "old_api": "XpsLink() : engin",
          "new_api": null,
          "old_text": " XpsLink() : engin",
          "new_text": null,
          "old_line_content": "        return ExtractPageText(GetXpsPage(pageNo), lineSep, coords_out);",
          "new_line_content": "    virtual RectD Transform(RectD rect, int pageNo, float zoom, int rotation, bool inverse=false);",
          "content_same": false
        },
        {
          "line": 1449,
          "old_api": "WCHAR *embedMark",
          "new_api": null,
          "old_text": " WCHAR *embedMark",
          "new_text": null,
          "old_line_content": "    free(_mediaboxes);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1451,
          "old_api": "0;\n    for (con",
          "new_api": null,
          "old_text": "0;\n    for (con",
          "new_text": null,
          "old_line_content": "    free(_fileName);",
          "new_line_content": "    _doc = NULL;",
          "content_same": false
        },
        {
          "line": 1454,
          "old_api": "leName) - 1; c > fileName; c--)",
          "new_api": null,
          "old_text": "leName) - 1; c > fileName; c--) ",
          "new_text": null,
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1456,
          "old_api": "::IsDigit(*(c + 1)))",
          "new_api": null,
          "old_text": "::IsDigit(*(c + 1)))\n             ",
          "new_text": null,
          "old_line_content": "    LeaveCriticalSection(&pagesAccess);",
          "new_line_content": "    delete _pagelabels;",
          "content_same": false
        },
        {
          "line": 3506,
          "old_api": "_URI == link->kind",
          "new_api": null,
          "old_text": "_URI == link->kind",
          "new_text": null,
          "old_line_content": "    virtual bool BenchLoadPage(int pageNo) { return GetXpsPage(pageNo) != NULL; }",
          "new_line_content": "    virtual bool SupportsAnnotation(bool forSaving=false) const;",
          "content_same": false
        },
        {
          "line": 1464,
          "old_api": "break;",
          "new_api": null,
          "old_text": "break;\n ",
          "new_text": null,
          "old_line_content": "    explicit PasswordCloner(unsigned char *cryptKey) : cryptKey(cryptKey) { }",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1468,
          "old_api": "e = NULL;\n    // File names ending in",
          "new_api": null,
          "old_text": "e = NULL;\n    // File names ending in ",
          "new_text": null,
          "old_line_content": "        memcpy(decryptionKeyOut, cryptKey, 32);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1480,
          "old_api": "ctx) {\n        file",
          "new_api": null,
          "old_text": "ctx) {\n        file",
          "new_text": null,
          "old_line_content": "    if (pdf_crypt_key(_doc))",
          "new_line_content": "BaseEngine *PdfEngineImpl::Clone()",
          "content_same": false
        },
        {
          "line": 1481,
          "old_api": "}\n    fz_catch(ctx)",
          "new_api": null,
          "old_text": "}\n    fz_catch(ctx)",
          "new_text": null,
          "old_line_content": "        pwdUI = new PasswordCloner(pdf_crypt_key(_doc));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1484,
          "old_api": "(file, pwdUI))\n        return",
          "new_api": null,
          "old_text": "(file, pwdUI))\n        return ",
          "new_text": null,
          "old_line_content": "    if (!clone || !(_fileName ? clone->Load(_fileName, pwdUI) : clone->Load(_doc->file, pwdUI))) {",
          "new_line_content": "    // use this document's encryption key (if any) to load the clone",
          "content_same": false
        },
        {
          "line": 3541,
          "old_api": "geIx;\n\npublic:\n    X",
          "new_api": null,
          "old_text": "geIx;\n\npublic:\n    X",
          "new_text": null,
          "old_line_content": "        const fz_rect tmpRect = fz_RectD_to_rect(PageMediabox(pageNo));",
          "new_line_content": "    bool            Load(fz_stream *stm);",
          "content_same": false
        },
        {
          "line": 3542,
          "old_api": "pl *engine, int pageNo, fz_rect rect, size_t",
          "new_api": null,
          "old_text": "pl *engine, int pageNo, fz_rect rect, size_t",
          "new_text": null,
          "old_line_content": "        return fz_create_view_ctm(&tmpRect, zoom, rotation);",
          "new_line_content": "    bool            LoadFromStream(fz_stream *stm);",
          "content_same": false
        },
        {
          "line": 1496,
          "old_api": "m, gen))\n        return false;\n\n    fz_bu",
          "new_api": null,
          "old_text": "m, gen))\n        return false;\n\n    fz_bu",
          "new_text": null,
          "old_line_content": "    clone->UpdateUserAnnotations(&userAnnots);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3546,
          "old_api": "pe",
          "new_api": null,
          "old_text": "pe() const { return Element_Im",
          "new_text": null,
          "old_line_content": "        return fz_create_view_ctm(xps_bound_page(_doc, page, &r), zoom, rotation);",
          "new_line_content": "    fz_matrix       viewctm(int pageNo, float zoom, int rotation) {",
          "content_same": false
        },
        {
          "line": 1506,
          "old_api": "rop_buffer",
          "new_api": null,
          "old_text": "rop_buffer(ctx, bu",
          "new_text": null,
          "old_line_content": "    for (const WCHAR *c = fileName + str::Len(fileName) - 1; c > fileName; c--) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1508,
          "old_api": "lose_document",
          "new_api": null,
          "old_text": "lose_document(_doc);\n ",
          "new_text": null,
          "old_line_content": "            if (!str::IsDigit(*(c + 1)))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1513,
          "old_api": "me && !_doc && c",
          "new_api": null,
          "old_text": "me && !_doc && c",
          "new_text": null,
          "old_line_content": "        else if (!str::IsDigit(*c))",
          "new_line_content": "        if (*c == ':') {",
          "content_same": false
        },
        {
          "line": 1522,
          "old_api": "fz_catch(ctx) {\n        retur",
          "new_api": null,
          "old_text": "\n    fz_catch(ctx) {\n        retur",
          "new_text": null,
          "old_line_content": "    assert(!_fileName && !_doc && ctx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1523,
          "old_api": "if (!LoadFromStrea",
          "new_api": null,
          "old_text": "if (!LoadFromStrea",
          "new_text": null,
          "old_line_content": "    _fileName = str::Dup(fileName);",
          "new_line_content": "    return embedMarks;",
          "content_same": false
        },
        {
          "line": 1530,
          "old_api": "tx) {\n        return fals",
          "new_api": null,
          "old_text": "tx) {\n        return fals",
          "new_text": null,
          "old_line_content": "    WCHAR *embedMarks = (WCHAR *)findEmbedMarks(_fileName);",
          "new_line_content": "    if (!_fileName || !ctx)",
          "content_same": false
        },
        {
          "line": 1534,
          "old_api": "ading",
          "new_api": null,
          "old_text": "ading();\n}\n\nbool PdfEngineImp",
          "new_text": null,
          "old_line_content": "        file = fz_open_file2(ctx, _fileName);",
          "new_line_content": "    // File names ending in :<digits>:<digits> are interpreted as containing",
          "content_same": false
        },
        {
          "line": 3584,
          "old_api": "Load",
          "new_api": null,
          "old_text": "lone->Load(_doc->file)",
          "new_text": null,
          "old_line_content": "        engine(engine), link(link), rect(fz_rect_to_RectD(rect)), pageNo(pageNo) { }",
          "new_line_content": "    RectD rect;",
          "content_same": false
        },
        {
          "line": 1543,
          "old_api": "ent_with_stream",
          "new_api": null,
          "old_text": "ent_with_stream(ctx, stm);\n",
          "new_text": null,
          "old_line_content": "    if (!LoadFromStream(file, pwdUI))",
          "new_line_content": "        file = NULL;",
          "content_same": false
        },
        {
          "line": 3591,
          "old_api": "(dir::Exists(_fileName)) {\n        /",
          "new_api": null,
          "old_text": " (dir::Exists(_fileName)) {\n        /",
          "new_text": null,
          "old_line_content": "            return str::conv::FromUtf8(link->ld.uri.uri);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1546,
          "old_api": "z_close",
          "new_api": null,
          "old_text": "z_close(stm);\n    }\n    ",
          "new_text": null,
          "old_line_content": "    if (str::IsEmpty(embedMarks))",
          "new_line_content": "        *embedMarks = ':';",
          "content_same": false
        },
        {
          "line": 1547,
          "old_api": "return fa",
          "new_api": null,
          "old_text": "      return fa",
          "new_text": null,
          "old_line_content": "        return FinishLoading();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1550,
          "old_api": "doc);\n    if (!isProtected)\n        return tr",
          "new_api": null,
          "old_text": "doc);\n    if (!isProtected)\n        return tr",
          "new_text": null,
          "old_line_content": "    embedMarks = (WCHAR *)str::Parse(embedMarks, L\":%d:%d\", &num, &gen);",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 1551,
          "old_api": "if (!pwdUI)",
          "new_api": null,
          "old_text": "  if (!pwdUI)\n    ",
          "new_text": null,
          "old_line_content": "    assert(embedMarks);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1559,
          "old_api": "me, digest, pdf_crypt_key(_",
          "new_api": null,
          "old_text": "me, digest, pdf_crypt_key(_",
          "new_text": null,
          "old_line_content": "        file = fz_open_buffer(ctx, buffer);",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 3612,
          "old_api": "tm);\n}\n\nbool XpsEngineImpl::Load(fz_stream *stm)\n{\n    assert(!_fileName && !",
          "new_api": null,
          "old_text": "tm);\n}\n\nbool XpsEngineImpl::Load(fz_stream *stm)\n{\n    assert(!_fileName && !",
          "new_text": null,
          "old_line_content": "            return RectD(DEST_USE_DEFAULT, DEST_USE_DEFAULT, DEST_USE_DEFAULT, DEST_USE_DEFAULT);",
          "new_line_content": "        if (!link || link->kind != FZ_LINK_GOTO)",
          "content_same": false
        },
        {
          "line": 3613,
          "old_api": "return false;\n\n    fz_try(ctx) {",
          "new_api": null,
          "old_text": " return false;\n\n    fz_try(ctx) {\n       ",
          "new_text": null,
          "old_line_content": "        return fz_rect_to_RectD(engine->FindDestRect(link->ld.gotor.dest));",
          "new_line_content": "            return 0;",
          "content_same": false
        },
        {
          "line": 3615,
          "old_api": "re",
          "new_api": null,
          "old_text": "        re",
          "new_text": null,
          "old_line_content": "    virtual WCHAR *GetDestValue() const { return GetValue(); }",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1576,
          "old_api": "ok = pwd_utf8 && pdf_authentic",
          "new_api": null,
          "old_text": "    ok = pwd_utf8 && pdf_authentic",
          "new_text": null,
          "old_line_content": "    assert(!_fileName && !_doc && ctx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1587,
          "old_api": "// TODO: this is only pa",
          "new_api": null,
          "old_text": "  // TODO: this is only pa",
          "new_text": null,
          "old_line_content": "    if (!LoadFromStream(stm, pwdUI))",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 3635,
          "old_api": "boxes = AllocArray<Rec",
          "new_api": null,
          "old_text": "boxes = AllocArray<Rec",
          "new_text": null,
          "old_line_content": "        engine(engine), pageNo(pageNo), rect(fz_rect_to_RectD(rect)), imageIx(imageIx) { }",
          "new_line_content": "    int pageNo;",
          "content_same": false
        },
        {
          "line": 1589,
          "old_api": "rmalizeString",
          "new_api": null,
          "old_text": "rmalizeString(p",
          "new_text": null,
          "old_line_content": "    return FinishLoading();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1594,
          "old_api": "Set",
          "new_api": null,
          "old_text": "f8.Set(str::conv::ToUtf8(pwd));\n  ",
          "new_text": null,
          "old_line_content": "    assert(!_fileName && !_doc && ctx);",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 3643,
          "old_api": "xps_extract_doc_props",
          "new_api": null,
          "old_text": "xps_extract_doc_props(_doc);\n    }\n    fz_c",
          "new_text": null,
          "old_line_content": "        return engine->GetPageImage(pageNo, rect, imageIx);",
          "new_line_content": "    virtual PageElementType GetType() const { return Element_Image; }",
          "content_same": false
        },
        {
          "line": 1599,
          "old_api": "}\n        }",
          "new_api": null,
          "old_text": "          }\n        }\n   ",
          "new_text": null,
          "old_line_content": "        stm = fz_clone_stream(ctx, stm);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3650,
          "old_api": "f (!_pages)\n        return NULL;\n    if",
          "new_api": null,
          "old_text": "f (!_pages)\n        return NULL;\n    if ",
          "new_text": null,
          "old_line_content": "    InitializeCriticalSection(&_pagesAccess);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3651,
          "old_api": "Busy)\n        return _pages[pageNo-1]",
          "new_api": null,
          "old_text": "Busy)\n        return _pages[pageNo-1]",
          "new_text": null,
          "old_line_content": "    InitializeCriticalSection(&ctxAccess);",
          "new_line_content": "};",
          "content_same": false
        },
        {
          "line": 1604,
          "old_api": "in codepage 1252",
          "new_api": null,
          "old_text": " in codepage 1252\n        ",
          "new_text": null,
          "old_line_content": "    if (!LoadFromStream(stm, pwdUI))",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 1606,
          "old_api": "le when stored",
          "new_api": null,
          "old_text": "le when stored ",
          "new_text": null,
          "old_line_content": "    return FinishLoading();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3661,
          "old_api": "// same xps_page objec",
          "new_api": null,
          "old_text": "\n            // same xps_page objec",
          "new_text": null,
          "old_line_content": "    EnterCriticalSection(&_pagesAccess);",
          "new_line_content": "    fz_locks_ctx.unlock = fz_unlock_context_cs;",
          "content_same": false
        },
        {
          "line": 1615,
          "old_api": "(str::conv::FromCodePage(pwd_ansi, 1252",
          "new_api": null,
          "old_text": "(str::conv::FromCodePage(pwd_ansi, 1252",
          "new_text": null,
          "old_line_content": "        _doc = pdf_open_document_with_stream(ctx, stm);",
          "new_line_content": "bool PdfEngineImpl::LoadFromStream(fz_stream *stm, PasswordUI *pwdUI)",
          "content_same": false
        },
        {
          "line": 1618,
          "old_api": "ToUtf8",
          "new_api": null,
          "old_text": "ToUtf8(pwd_cp",
          "new_text": null,
          "old_line_content": "        fz_close(stm);",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 3666,
          "old_api": "(page, pageN",
          "new_api": null,
          "old_text": "(page, pageN",
          "new_text": null,
          "old_line_content": "        assert(_doc);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3670,
          "old_api": "lved);\n        }\n        fz_ca",
          "new_api": null,
          "old_text": "lved);\n        }\n        fz_ca",
          "new_text": null,
          "old_line_content": "    fz_free_outline(ctx, _outline);",
          "new_line_content": "    if (_pages) {",
          "content_same": false
        },
        {
          "line": 3674,
          "old_api": "ge *page)\n{",
          "new_api": null,
          "old_text": "ge *page)\n{",
          "new_text": null,
          "old_line_content": "        for (int i = 0; i < PageCount(); i++)",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3675,
          "old_api": "i < PageCount(); i",
          "new_api": null,
          "old_text": " i < PageCount(); i",
          "new_text": null,
          "old_line_content": "            free(imageRects[i]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3679,
          "old_api": "urn i + 1;\n    r",
          "new_api": null,
          "old_text": "urn i + 1;\n    r",
          "new_text": null,
          "old_line_content": "    while (runCache.Count() > 0) {",
          "new_line_content": "    if (imageRects) {",
          "content_same": false
        },
        {
          "line": 1632,
          "old_api": "bool PdfEngineImpl::FinishLoading()\n{",
          "new_api": null,
          "old_text": "\nbool PdfEngineImpl::FinishLoading()\n{\n  ",
          "new_text": null,
          "old_line_content": "    fz_stream_fingerprint(_doc->file, digest);",
          "new_line_content": "        return true;",
          "content_same": false
        },
        {
          "line": 1636,
          "old_api": "eturn false;\n    }",
          "new_api": null,
          "old_text": "eturn false;\n    }\n",
          "new_text": null,
          "old_line_content": "        ScopedMem<WCHAR> pwd(pwdUI->GetPassword(_fileName, digest, pdf_crypt_key(_doc), &saveKey));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3684,
          "old_api": "os> positions;\n    ListI",
          "new_api": null,
          "old_text": "os> positions;\n    ListI",
          "new_text": null,
          "old_line_content": "    xps_close_document(_doc);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3689,
          "old_api": "ev);\n    fz_try(c",
          "new_api": null,
          "old_text": "ev);\n    fz_try(c",
          "new_text": null,
          "old_line_content": "    free(_mediaboxes);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1645,
          "old_api": ");\n    imageRects = AllocArray<fz_rect *>",
          "new_api": null,
          "old_text": ");\n    imageRects = AllocArray<fz_rect *>",
          "new_text": null,
          "old_line_content": "        ok = pwd_utf8 && pdf_authenticate_password(_doc, pwd_utf8);",
          "new_line_content": "            ok = saveKey;",
          "content_same": false
        },
        {
          "line": 3693,
          "old_api": "un_display_list",
          "new_api": null,
          "old_text": "un_display_list(list, dev, &fz_id",
          "new_text": null,
          "old_line_content": "    DeleteCriticalSection(&ctxAccess);",
          "new_line_content": "    ctx = NULL;",
          "content_same": false
        },
        {
          "line": 3694,
          "old_api": "NULL, NULL);\n    }\n    fz_catch(ct",
          "new_api": null,
          "old_text": " NULL, NULL);\n    }\n    fz_catch(ct",
          "new_text": null,
          "old_line_content": "    LeaveCriticalSection(&_pagesAccess);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1650,
          "old_api": "{\n        fz_warn(ctx, \"Couldn't load all pa",
          "new_api": null,
          "old_text": " {\n        fz_warn(ctx, \"Couldn't load all pa",
          "new_text": null,
          "old_line_content": "            pwd.Set(NormalizeString(pwd, 5 /* NormalizationKC */));",
          "new_line_content": "        ScopedMem<char> pwd_utf8(str::conv::ToUtf8(pwd));",
          "content_same": false
        },
        {
          "line": 1652,
          "old_api": "df_load_outline",
          "new_api": null,
          "old_text": "df_load_outline(_doc);",
          "new_text": null,
          "old_line_content": "                pwd_utf8.Set(str::conv::ToUtf8(pwd));",
          "new_line_content": "        // according to the spec (1.7 ExtensionLevel 3), the password",
          "content_same": false
        },
        {
          "line": 1653,
          "old_api": "ignore errors from pdf_load_outline()",
          "new_api": null,
          "old_text": " ignore errors from pdf_load_outline()\n  ",
          "new_text": null,
          "old_line_content": "                ok = pwd_utf8 && pdf_authenticate_password(_doc, pwd_utf8);",
          "new_line_content": "        // for crypt revisions 5 and above are in SASLprep normalization",
          "content_same": false
        },
        {
          "line": 3703,
          "old_api": "a null-rectangle",
          "new_api": null,
          "old_text": "a null-rectangle\n      ",
          "new_text": null,
          "old_line_content": "    if (!clone || !(_fileName ? clone->Load(_fileName) : clone->Load(_doc->file))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1660,
          "old_api": "hments\");\n    }\n    fz_try(ctx) {",
          "new_api": null,
          "old_text": "hments\");\n    }\n    fz_try(ctx) {\n     ",
          "new_text": null,
          "old_line_content": "            ScopedMem<WCHAR> pwd_cp1252(str::conv::FromCodePage(pwd_ansi, 1252));",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1661,
          "old_api": "dictionary, as accessing the",
          "new_api": null,
          "old_text": " dictionary, as accessing the",
          "new_text": null,
          "old_line_content": "            pwd_utf8.Set(str::conv::ToUtf8(pwd_cp1252));",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1662,
          "old_api": "safe and we don't want to block for this",
          "new_api": null,
          "old_text": " safe and we don't want to block for this",
          "new_text": null,
          "old_line_content": "            ok = pwd_utf8 && pdf_authenticate_password(_doc, pwd_utf8);",
          "new_line_content": "        // older Acrobat versions seem to have considered passwords to be in codepage 1252",
          "content_same": false
        },
        {
          "line": 3708,
          "old_api": "if (rects) {\n            for (size",
          "new_api": null,
          "old_text": "       if (rects) {\n            for (size",
          "new_text": null,
          "old_line_content": "    clone->UpdateUserAnnotations(&userAnnots);",
          "new_line_content": "    XpsEngineImpl *clone = new XpsEngineImpl();",
          "content_same": false
        },
        {
          "line": 3715,
          "old_api": "ct;\n            }\n            imag",
          "new_api": null,
          "old_text": "ct;\n            }\n            imag",
          "new_text": null,
          "old_line_content": "    assert(!_fileName && !_doc && ctx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3716,
          "old_api": "rects;\n        }",
          "new_api": null,
          "old_text": "rects;\n        }\n ",
          "new_text": null,
          "old_line_content": "    _fileName = str::Dup(fileName);",
          "new_line_content": "    return clone;",
          "content_same": false
        },
        {
          "line": 3720,
          "old_api": "*XpsEngineImpl::GetPag",
          "new_api": null,
          "old_text": "*XpsEngineImpl::GetPag",
          "new_text": null,
          "old_line_content": "    if (dir::Exists(_fileName)) {",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3725,
          "old_api": "sult = runCache",
          "new_api": null,
          "old_text": "sult = runCache",
          "new_text": null,
          "old_line_content": "        return Load(zipStream);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1678,
          "old_api": "at this point",
          "new_api": null,
          "old_text": " at this point\n      ",
          "new_text": null,
          "old_line_content": "        pdf_count_pages(_doc);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3730,
          "old_api": "size_t mem = 0;",
          "new_api": null,
          "old_text": "\n        size_t mem = 0;\n    ",
          "new_text": null,
          "old_line_content": "        stm = fz_open_file2(ctx, _fileName);",
          "new_line_content": "            return false;",
          "content_same": false
        },
        {
          "line": 1683,
          "old_api": "arized\", pd",
          "new_api": null,
          "old_text": "arized\", pd",
          "new_text": null,
          "old_line_content": "    if (PageCount() == 0) {",
          "new_line_content": "        // this call might throw the first time",
          "content_same": false
        },
        {
          "line": 3735,
          "old_api": "page runs that take",
          "new_api": null,
          "old_text": "page runs that take",
          "new_text": null,
          "old_line_content": "    return LoadFromStream(stm);",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 1688,
          "old_api": "puts_drop",
          "new_api": null,
          "old_text": "puts_drop(_",
          "new_text": null,
          "old_line_content": "    _pages = AllocArray<pdf_page *>(PageCount());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1691,
          "old_api": "er",
          "new_api": null,
          "old_text": "er(_doc), \"",
          "new_text": null,
          "old_line_content": "    pageAnnots = AllocArray<pdf_annot **>(PageCount());",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 1692,
          "old_api": "ray",
          "new_api": null,
          "old_text": "ray(intents",
          "new_text": null,
          "old_line_content": "    imageRects = AllocArray<fz_rect *>(PageCount());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3740,
          "old_api": "ept for the very rec",
          "new_api": null,
          "old_text": "ept for the very rec",
          "new_text": null,
          "old_line_content": "    assert(!_doc && ctx);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1700,
          "old_api": "df_dict_gets",
          "new_api": null,
          "old_text": "df_dict_gets(pdf_array_get(intents,",
          "new_text": null,
          "old_line_content": "        pdf_load_page_objs(_doc, _pageObjs);",
          "new_line_content": "    if (!_pages || !_pageObjs || !_mediaboxes || !pageAnnots || !imageRects)",
          "content_same": false
        },
        {
          "line": 1703,
          "old_api": "ame",
          "new_api": null,
          "old_text": "ame(intent) && !pdf_is_indirect(intent) && str",
          "new_text": null,
          "old_line_content": "        fz_warn(ctx, \"Couldn't load all page objects\");",
          "new_line_content": "    ScopedCritSec scope(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 3751,
          "old_api": ")->size_est;",
          "new_api": null,
          "old_text": ")->size_est;\n      ",
          "new_text": null,
          "old_line_content": "    return LoadFromStream(stm);",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 3756,
          "old_api": "assert(runCache.Count",
          "new_api": null,
          "old_text": "\n            assert(runCache.Count",
          "new_text": null,
          "old_line_content": "    assert(!_fileName && !_doc && ctx);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1713,
          "old_api": "properties\");\n        pdf_drop_obj(_i",
          "new_api": null,
          "old_text": "properties\");\n        pdf_drop_obj(_i",
          "new_text": null,
          "old_line_content": "        fz_warn(ctx, \"Couldn't load outline\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3761,
          "old_api": "}\n\n        ScopedC",
          "new_api": null,
          "old_text": "       }\n\n        ScopedC",
          "new_text": null,
          "old_line_content": "        stm = fz_clone_stream(ctx, stm);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1716,
          "old_api": "pdf_obj *pagelab",
          "new_api": null,
          "old_text": "\n        pdf_obj *pagelab",
          "new_text": null,
          "old_line_content": "        attachments = pdf_loadattachments(_doc);",
          "new_line_content": "        // this information is not critical and checking the",
          "content_same": false
        },
        {
          "line": 3766,
          "old_api": "fz_device *dev",
          "new_api": null,
          "old_text": "    fz_device *dev ",
          "new_text": null,
          "old_line_content": "    return LoadFromStream(stm);",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 1727,
          "old_api": "e = NULL;\n\n    for (; entry; e",
          "new_api": null,
          "old_text": "e = NULL;\n\n    for (; entry; e",
          "new_text": null,
          "old_line_content": "            _info = pdf_copy_str_dict(_doc, _info);",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 3775,
          "old_api": "z_new_list_device",
          "new_api": null,
          "old_text": "z_new_list_device(ctx, list);\n         ",
          "new_text": null,
          "old_line_content": "        _doc = xps_open_document_with_stream(ctx, stm);",
          "new_line_content": "bool XpsEngineImpl::LoadFromStream(fz_stream *stm)",
          "content_same": false
        },
        {
          "line": 1729,
          "old_api": "entry->title ? pdf_cl",
          "new_api": null,
          "old_text": "entry->title ? pdf_cl",
          "new_text": null,
          "old_line_content": "            _info = pdf_new_dict(_doc, 4);",
          "new_line_content": "        // isn't thread safe and we don't want to block for this when",
          "content_same": false
        },
        {
          "line": 3778,
          "old_api": "ntity, NULL);",
          "new_api": null,
          "old_text": "ntity, NULL);",
          "new_text": null,
          "old_line_content": "        fz_close(stm);",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 1732,
          "old_api": "= entry->is_open;",
          "new_api": null,
          "old_text": "= entry->is_open;\n   ",
          "new_text": null,
          "old_line_content": "            pdf_dict_puts_drop(_info, \"Linearized\", pdf_new_bool(_doc, 1));",
          "new_line_content": "        if (_info)",
          "content_same": false
        },
        {
          "line": 1734,
          "old_api": "if (entry->down",
          "new_api": null,
          "old_text": "      if (entry->down",
          "new_text": null,
          "old_line_content": "            pdf_dict_puts_drop(_info, \"Marked\", pdf_new_bool(_doc, 1));",
          "new_line_content": "        if (!_info)",
          "content_same": false
        },
        {
          "line": 1736,
          "old_api": "tem;\n        else",
          "new_api": null,
          "old_text": "tem;\n        else",
          "new_text": null,
          "old_line_content": "        pdf_obj *intents = pdf_dict_getp(pdf_trailer(_doc), \"Root/OutputIntents\");",
          "new_line_content": "        // also remember linearization and tagged states at this point",
          "content_same": false
        },
        {
          "line": 3785,
          "old_api": "ULL;\n        }\n        fz_free_device",
          "new_api": null,
          "old_text": "ULL;\n        }\n        fz_free_device",
          "new_text": null,
          "old_line_content": "        fz_warn(ctx, \"document has no pages\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1741,
          "old_api": "Tree",
          "new_api": null,
          "old_text": "Tree(attachments, i",
          "new_text": null,
          "old_line_content": "                if (pdf_is_name(intent) && !pdf_is_indirect(intent) && str::StartsWith(pdf_to_name(intent), \"GTS_PDF\"))",
          "new_line_content": "        // also remember known output intents (PDF/X, etc.)",
          "content_same": false
        },
        {
          "line": 3789,
          "old_api": "st);",
          "new_api": null,
          "old_text": "st);\n      ",
          "new_text": null,
          "old_line_content": "    _pages = AllocArray<xps_page *>(PageCount());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1751,
          "old_api": "8));\n        dest =",
          "new_api": null,
          "old_text": "8));\n        dest =",
          "new_text": null,
          "old_line_content": "        pdf_drop_obj(_info);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3800,
          "old_api": "sult;\n}\n\nbool XpsEngineImpl::RunPage(",
          "new_api": null,
          "old_text": "sult;\n}\n\nbool XpsEngineImpl::RunPage(",
          "new_text": null,
          "old_line_content": "        fz_warn(ctx, \"Couldn't load outline\");",
          "new_line_content": "        return false;",
          "content_same": false
        },
        {
          "line": 1755,
          "old_api": "return NULL;",
          "new_api": null,
          "old_text": "  return NULL;\n  ",
          "new_text": null,
          "old_line_content": "        pdf_obj *pagelabels = pdf_dict_getp(pdf_trailer(_doc), \"Root/PageLabels\");",
          "new_line_content": "    fz_catch(ctx) {",
          "content_same": false
        },
        {
          "line": 1760,
          "old_api": ", dest);\n    }\n    fz_catch(ctx) {",
          "new_api": null,
          "old_text": ", dest);\n    }\n    fz_catch(ctx) {\n      ",
          "new_text": null,
          "old_line_content": "        fz_warn(ctx, \"Couldn't load page labels\");",
          "new_line_content": "    fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 1773,
          "old_api": "}\n\npdf_page",
          "new_api": null,
          "old_text": "\n}\n\npdf_page ",
          "new_text": null,
          "old_line_content": "        WCHAR *name = entry->title ? pdf_clean_string(str::conv::FromUtf8(entry->title)) : str::Dup(L\"\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1774,
          "old_api": "usy)\n{\n    if (!_pages)",
          "new_api": null,
          "old_text": "usy)\n{\n    if (!_pages)\n   ",
          "new_text": null,
          "old_line_content": "        PdfTocItem *item = new PdfTocItem(name, PdfLink(this, &entry->dest));",
          "new_line_content": "PdfTocItem *PdfEngineImpl::BuildTocTree(fz_outline *entry, int& idCounter)",
          "content_same": false
        },
        {
          "line": 3824,
          "old_api": "nnots, dev,",
          "new_api": null,
          "old_text": "nnots, dev, ",
          "new_text": null,
          "old_line_content": "        fz_var(page);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3828,
          "old_api": "ect, true);\n            fz_run_",
          "new_api": null,
          "old_text": "ect, true);\n            fz_run_",
          "new_text": null,
          "old_line_content": "            page = xps_load_page(_doc, pageNo - 1);",
          "new_line_content": "    if (!page) {",
          "content_same": false
        },
        {
          "line": 1781,
          "old_api": "fz_try(ctx) {\n            pag",
          "new_api": null,
          "old_text": "       fz_try(ctx) {\n            pag",
          "new_text": null,
          "old_line_content": "            item->child = BuildTocTree(entry->down, idCounter);",
          "new_line_content": "        item->open = entry->is_open;",
          "content_same": false
        },
        {
          "line": 3831,
          "old_api": "_end_page",
          "new_api": null,
          "old_text": "_end_page(dev);\n        }\n  ",
          "new_text": null,
          "old_line_content": "            assert(page->links_resolved);",
          "new_line_content": "        fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 1786,
          "old_api": "_pages[pageNo-1] = pag",
          "new_api": null,
          "old_text": "_pages[pageNo-1] = pag",
          "new_text": null,
          "old_line_content": "            node->AddSibling(item);",
          "new_line_content": "        if (entry->down)",
          "content_same": false
        },
        {
          "line": 3841,
          "old_api": "ScopedCr",
          "new_api": null,
          "old_text": "   ScopedCr",
          "new_text": null,
          "old_line_content": "    for (int i = 0; i < PageCount(); i++)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1798,
          "old_api": "PdfEngineImpl::GetPageNo(pdf_pag",
          "new_api": null,
          "old_text": "PdfEngineImpl::GetPageNo(pdf_pag",
          "new_text": null,
          "old_line_content": "        node = BuildTocTree(outline, idCounter);",
          "new_line_content": "DocTocItem *PdfEngineImpl::GetTocTree()",
          "content_same": false
        },
        {
          "line": 1800,
          "old_api": "if (page == _pages[i])",
          "new_api": null,
          "old_text": "   if (page == _pages[i])\n          ",
          "new_text": null,
          "old_line_content": "            node->AddSibling(BuildTocTree(attachments, idCounter));",
          "new_line_content": "    PdfTocItem *node = NULL;",
          "content_same": false
        },
        {
          "line": 1802,
          "old_api": "EngineImpl::CreatePageRun(pdf_page *",
          "new_api": null,
          "old_text": "EngineImpl::CreatePageRun(pdf_page *",
          "new_text": null,
          "old_line_content": "        node = BuildTocTree(attachments, idCounter);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3853,
          "old_api": "ency",
          "new_api": null,
          "old_text": "ency(pageAn",
          "new_text": null,
          "old_line_content": "    fz_var(dev);",
          "new_line_content": "XpsPageRun *XpsEngineImpl::CreatePageRun(xps_page *page, fz_display_list *list)",
          "content_same": false
        },
        {
          "line": 3855,
          "old_api": "xps_run_page(_doc, page, dev, c",
          "new_api": null,
          "old_text": "     xps_run_page(_doc, page, dev, c",
          "new_text": null,
          "old_line_content": "        dev = fz_new_inspection_device(ctx, &data);",
          "new_line_content": "    Vec<FitzImagePos> positions;",
          "content_same": false
        },
        {
          "line": 3856,
          "old_api": "? &cookie->cookie : NULL);\n            fz_run_page_trans",
          "new_api": null,
          "old_text": "? &cookie->cookie : NULL);\n            fz_run_page_trans",
          "new_text": null,
          "old_line_content": "        fz_run_display_list(list, dev, &fz_identity, NULL, NULL);",
          "new_line_content": "    ListInspectionData data(positions);",
          "content_same": false
        },
        {
          "line": 1814,
          "old_api": "(ctx) { }\n    fz_fr",
          "new_api": null,
          "old_text": "(ctx) { }\n    fz_fr",
          "new_text": null,
          "old_line_content": "        pdf_obj *nameobj = pdf_new_string(_doc, name_utf8, (int)str::Len(name_utf8));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1815,
          "old_api": "// save the image rectangles",
          "new_api": null,
          "old_text": "  // save the image rectangles",
          "new_text": null,
          "old_line_content": "        dest = pdf_lookup_dest(_doc, nameobj);",
          "new_line_content": "    ScopedCritSec scope(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 1816,
          "old_api": "age\n    int pageNo =",
          "new_api": null,
          "old_text": "age\n    int pageNo = ",
          "new_text": null,
          "old_line_content": "        pdf_drop_obj(nameobj);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3863,
          "old_api": "}\n        fz",
          "new_api": null,
          "old_text": "     }\n        fz",
          "new_text": null,
          "old_line_content": "    if (!imageRects[pageNo-1] && positions.Count() > 0) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3867,
          "old_api": "psEngineImpl::Dro",
          "new_api": null,
          "old_text": "psEngineImpl::Dro",
          "new_text": null,
          "old_line_content": "            for (size_t i = 0; i < positions.Count(); i++) {",
          "new_line_content": "    // save the image rectangles for this page",
          "content_same": false
        },
        {
          "line": 1825,
          "old_api": "Count",
          "new_api": null,
          "old_text": "s = AllocArray<fz_rect>(positions.Count() + 1",
          "new_text": null,
          "old_line_content": "        ld = pdf_parse_link_dest(_doc, FZ_LINK_GOTO, dest);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 1835,
          "old_api": "eRun",
          "new_api": null,
          "old_text": "eRun(pdf_page *pa",
          "new_text": null,
          "old_line_content": "        pageDest = new SimpleDest(tmp.GetDestPageNo(), tmp.GetDestRect());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3883,
          "old_api": "{\n    assert(1 <",
          "new_api": null,
          "old_text": "{\n    assert(1 <",
          "new_text": null,
          "old_line_content": "    for (size_t i = 0; i < runCache.Count(); i++) {",
          "new_line_content": "XpsPageRun *XpsEngineImpl::GetPageRun(xps_page *page, bool tryOnly)",
          "content_same": false
        },
        {
          "line": 1837,
          "old_api": "y)\n{\n    PdfPageRun *result",
          "new_api": null,
          "old_text": "y)\n{\n    PdfPageRun *result",
          "new_text": null,
          "old_line_content": "    fz_free_link_dest(ctx, &ld);",
          "new_line_content": "    if (FZ_LINK_GOTO == ld.kind) {",
          "content_same": false
        },
        {
          "line": 3884,
          "old_api": "PageCount",
          "new_api": null,
          "old_text": "PageCount());\n",
          "new_text": null,
          "old_line_content": "        if (runCache.At(i)->page == page) {",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3885,
          "old_api": "tD",
          "new_api": null,
          "old_text": "tD();\n\n    Rec",
          "new_text": null,
          "old_line_content": "            result = runCache.At(i);",
          "new_line_content": "    ScopedCritSec scope(&_pagesAccess);",
          "content_same": false
        },
        {
          "line": 3894,
          "old_api": "if (!mbox.I",
          "new_api": null,
          "old_text": "   if (!mbox.I",
          "new_text": null,
          "old_line_content": "            if (i >= 2 && mem + runCache.At(i)->size_est >= MAX_PAGE_RUN_MEMORY)",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3895,
          "old_api": "return _mediab",
          "new_api": null,
          "old_text": "  return _mediab",
          "new_text": null,
          "old_line_content": "                DropPageRun(runCache.At(i--), true);",
          "new_line_content": "    if (!result && !tryOnly) {",
          "content_same": false
        },
        {
          "line": 3899,
          "old_api": "RectD",
          "new_api": null,
          "old_text": "RectD();\n\n    fz",
          "new_text": null,
          "old_line_content": "        if (runCache.Count() >= MAX_PAGE_RUN_CACHE) {",
          "new_line_content": "            // (except for the very recently used ones)",
          "content_same": false
        },
        {
          "line": 1854,
          "old_api": "ge runs that",
          "new_api": null,
          "old_text": "ge runs that",
          "new_text": null,
          "old_line_content": "        fz_var(page);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1856,
          "old_api": "// (except for the very recently used ones)",
          "new_api": null,
          "old_text": "           // (except for the very recently used ones)\n    ",
          "new_text": null,
          "old_line_content": "            page = pdf_load_page_by_obj(_doc, pageNo - 1, _pageObjs[pageNo-1]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1858,
          "old_api": ">= MAX_PAGE_RUN_MEMOR",
          "new_api": null,
          "old_text": ">= MAX_PAGE_RUN_MEMOR",
          "new_text": null,
          "old_line_content": "            LinkifyPageText(page);",
          "new_line_content": "    if (!page) {",
          "content_same": false
        },
        {
          "line": 1859,
          "old_api": "At",
          "new_api": null,
          "old_text": "e.At(i--), true);\n          ",
          "new_text": null,
          "old_line_content": "            pageAnnots[pageNo-1] = ProcessPageAnnotations(page);",
          "new_line_content": "        ScopedCritSec ctxScope(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 3908,
          "old_api": "ge = GetXpsP",
          "new_api": null,
          "old_text": "ge = GetXpsP",
          "new_text": null,
          "old_line_content": "        fz_var(list);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3909,
          "old_api": ";\n    if (!",
          "new_api": null,
          "old_text": ";\n    if (!",
          "new_text": null,
          "old_line_content": "        fz_var(dev);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3911,
          "old_api": "ct = fz_empty_rect;",
          "new_api": null,
          "old_text": "ct = fz_empty_rect;\n    ",
          "new_text": null,
          "old_line_content": "            list = fz_new_display_list(ctx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3912,
          "old_api": ";\n    EnterCriticalSection(&c",
          "new_api": null,
          "old_text": ";\n    EnterCriticalSection(&c",
          "new_text": null,
          "old_line_content": "            dev = fz_new_list_device(ctx, list);",
          "new_line_content": "        fz_display_list *list = NULL;",
          "content_same": false
        },
        {
          "line": 3913,
          "old_api": "fz_try",
          "new_api": null,
          "old_text": "fz_try(ctx) {\n        dev = fz_new_bbox_device(ct",
          "new_text": null,
          "old_line_content": "            xps_run_page(_doc, page, dev, &fz_identity, NULL);",
          "new_line_content": "        fz_device *dev = NULL;",
          "content_same": false
        },
        {
          "line": 3916,
          "old_api": "riticalSection",
          "new_api": null,
          "old_text": "riticalSection(&ctxAccess);\n   ",
          "new_text": null,
          "old_line_content": "            fz_drop_display_list(ctx, list);",
          "new_line_content": "        fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 1869,
          "old_api": "Count",
          "new_api": null,
          "old_text": "e.Count() =",
          "new_text": null,
          "old_line_content": "    for (int i = 0; i < PageCount(); i++)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3923,
          "old_api": "age, dev, &fz_identity, &pag",
          "new_api": null,
          "old_text": "age, dev, &fz_identity, &pag",
          "new_text": null,
          "old_line_content": "            runCache.InsertAt(0, result);",
          "new_line_content": "            list = NULL;",
          "content_same": false
        },
        {
          "line": 3926,
          "old_api": "x",
          "new_api": null,
          "old_text": "x(pageNo);\n   ",
          "new_text": null,
          "old_line_content": "    else if (result && result != runCache.At(0)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1881,
          "old_api": "_new_displa",
          "new_api": null,
          "old_text": "_new_displa",
          "new_text": null,
          "old_line_content": "    fz_var(dev);",
          "new_line_content": "PdfPageRun *PdfEngineImpl::CreatePageRun(pdf_page *page, fz_display_list *list)",
          "content_same": false
        },
        {
          "line": 1883,
          "old_api": "w_list_device",
          "new_api": null,
          "old_text": "w_list_device(ctx, list);\n          ",
          "new_text": null,
          "old_line_content": "        dev = fz_new_inspection_device(ctx, &data);",
          "new_line_content": "    Vec<FitzImagePos> positions;",
          "content_same": false
        },
        {
          "line": 1884,
          "old_api": "age",
          "new_api": null,
          "old_text": "age(_doc, page, dev, &fz_identity, NULL);\n        }\n    ",
          "new_text": null,
          "old_line_content": "        fz_run_display_list(list, dev, &fz_identity, NULL, NULL);",
          "new_line_content": "    ListInspectionData data(positions);",
          "content_same": false
        },
        {
          "line": 1891,
          "old_api": "PageRun",
          "new_api": null,
          "old_text": "PageRun(page, lis",
          "new_text": null,
          "old_line_content": "    if (!imageRects[pageNo-1] && positions.Count() > 0) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3941,
          "old_api": ".x, (float)pt.y };\n    fz_t",
          "new_api": null,
          "old_text": ".x, (float)pt.y };\n    fz_t",
          "new_text": null,
          "old_line_content": "    XpsPageRun *run = GetPageRun(page, !cacheRun);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1895,
          "old_api": "tAt",
          "new_api": null,
          "old_text": "tAt(0, result);\n ",
          "new_text": null,
          "old_line_content": "            for (size_t i = 0; i < positions.Count(); i++) {",
          "new_line_content": "    // save the image rectangles for this page",
          "content_same": false
        },
        {
          "line": 3943,
          "old_api": "return PointD(pt2.x, pt2.y)",
          "new_api": null,
          "old_text": "\n    return PointD(pt2.x, pt2.y)",
          "new_text": null,
          "old_line_content": "        EnterCriticalSection(&ctxAccess);",
          "new_line_content": "bool XpsEngineImpl::RunPage(xps_page *page, fz_device *dev, const fz_matrix *ctm, const fz_rect *cliprect, bool cacheRun, FitzAbortCookie *cookie)",
          "content_same": false
        },
        {
          "line": 3944,
          "old_api": "tion, bool inve",
          "new_api": null,
          "old_text": "tion, bool inve",
          "new_text": null,
          "old_line_content": "        Vec<PageAnnotation> pageAnnots = fz_get_user_page_annots(userAnnots, GetPageNo(page));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 3948,
          "old_api": "rect",
          "new_api": null,
          "old_text": "rect(rect);\n    fz_transform_rect(&rect2, &ctm);\n    retur",
          "new_text": null,
          "old_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, false);",
          "new_line_content": "    if (run) {",
          "content_same": false
        },
        {
          "line": 3951,
          "old_api": "okie_out)\n{\n    if (!page)\n        return false;\n\n    fz_matrix ctm2;\n    if (!ctm) {",
          "new_api": null,
          "old_text": "okie_out)\n{\n    if (!page)\n        return false;\n\n    fz_matrix ctm2;\n    if (!ctm) {\n  ",
          "new_text": null,
          "old_line_content": "            fz_run_user_page_annots(pageAnnots, dev, ctm, cliprect, cookie ? &cookie->cookie : NULL);",
          "new_line_content": "        fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 3952,
          "old_api": "ewctm",
          "new_api": null,
          "old_text": "ewctm(page, zoom",
          "new_text": null,
          "old_line_content": "            fz_end_page(dev);",
          "new_line_content": "            fz_rect pagerect;",
          "content_same": false
        },
        {
          "line": 1911,
          "old_api": "EnterCritica",
          "new_api": null,
          "old_text": "    EnterCritica",
          "new_text": null,
          "old_line_content": "    for (size_t i = 0; i < runCache.Count(); i++) {",
          "new_line_content": "PdfPageRun *PdfEngineImpl::GetPageRun(pdf_page *page, bool tryOnly)",
          "content_same": false
        },
        {
          "line": 1912,
          "old_api": "Vec<Pa",
          "new_api": null,
          "old_text": "        Vec<Pa",
          "new_text": null,
          "old_line_content": "        if (runCache.At(i)->page == page) {",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1913,
          "old_api": "age_annots",
          "new_api": null,
          "old_text": "age_annots(use",
          "new_text": null,
          "old_line_content": "            result = runCache.At(i);",
          "new_line_content": "    PdfPageRun *result = NULL;",
          "content_same": false
        },
        {
          "line": 3962,
          "old_api": "z_matrix trans;",
          "new_api": null,
          "old_text": "z_matrix trans;",
          "new_text": null,
          "old_line_content": "        Vec<PageAnnotation> pageAnnots = fz_get_user_page_annots(userAnnots, GetPageNo(page));",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3965,
          "old_api": ")screenRect.y - bbox.y0));\n    }",
          "new_api": null,
          "old_text": ")screenRect.y - bbox.y0));\n    }\n    ",
          "new_text": null,
          "old_line_content": "            fz_begin_page(dev, xps_bound_page(_doc, page, &pagerect), ctm);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 3966,
          "old_api": "ctm;\n\n    HBRUSH bgBrush = CreateSolidBrush(RGB(0xFF, 0xFF",
          "new_api": null,
          "old_text": "ctm;\n\n    HBRUSH bgBrush = CreateSolidBrush(RGB(0xFF, 0xFF",
          "new_text": null,
          "old_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, false);",
          "new_line_content": "    else {",
          "content_same": false
        },
        {
          "line": 3967,
          "old_api": "ToRECT",
          "new_api": null,
          "old_text": "ECT tmpRect = screenRect.ToRECT();\n    FillRect(hDC, &tmpRect, bgBr",
          "new_text": null,
          "old_line_content": "            xps_run_page(_doc, page, dev, ctm, cookie ? &cookie->cookie : NULL);",
          "new_line_content": "        ScopedCritSec scope(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 3969,
          "old_api": "fz_RectD_to_rect(screenRect.Convert<double>());\n    if (pageRect) {\n        fz_rect pag",
          "new_api": null,
          "old_text": " fz_RectD_to_rect(screenRect.Convert<double>());\n    if (pageRect) {\n        fz_rect pag",
          "new_text": null,
          "old_line_content": "            fz_run_user_page_annots(pageAnnots, dev, ctm, cliprect, cookie ? &cookie->cookie : NULL);",
          "new_line_content": "        fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 1922,
          "old_api": "kie->cookie :",
          "new_api": null,
          "old_text": "kie->cookie : ",
          "new_text": null,
          "old_line_content": "            if (i >= 2 && mem + runCache.At(i)->size_est >= MAX_PAGE_RUN_MEMORY)",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1923,
          "old_api": "prect, true, pag",
          "new_api": null,
          "old_text": "prect, true, pag",
          "new_text": null,
          "old_line_content": "                DropPageRun(runCache.At(i--), true);",
          "new_line_content": "    if (!result && !tryOnly) {",
          "content_same": false
        },
        {
          "line": 3970,
          "old_api": "D_to_rect",
          "new_api": null,
          "old_text": "D_to_rect(*pageR",
          "new_text": null,
          "old_line_content": "            fz_end_page(dev);",
          "new_line_content": "            fz_rect pagerect;",
          "content_same": false
        },
        {
          "line": 1927,
          "old_api": "e->cookie : NULL",
          "new_api": null,
          "old_text": "e->cookie : NULL",
          "new_text": null,
          "old_line_content": "        if (runCache.Count() >= MAX_PAGE_RUN_CACHE) {",
          "new_line_content": "            // (except for the very recently used ones)",
          "content_same": false
        },
        {
          "line": 3977,
          "old_api": "fz_irect tmp;\n    fz_rect_from_",
          "new_api": null,
          "old_text": " fz_irect tmp;\n    fz_rect_from_",
          "new_text": null,
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 3978,
          "old_api": "cliprect, fz_round_",
          "new_api": null,
          "old_text": "cliprect, fz_round_",
          "new_text": null,
          "old_line_content": "    fz_free_device(dev);",
          "new_line_content": "        fz_catch(ctx) {",
          "content_same": false
        },
        {
          "line": 3979,
          "old_api": "mp, &cliprect));\n\n    fz_device",
          "new_api": null,
          "old_text": "mp, &cliprect));\n\n    fz_device ",
          "new_text": null,
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "            ok = false;",
          "content_same": false
        },
        {
          "line": 1936,
          "old_api": "nt ? \"Print\"",
          "new_api": null,
          "old_text": "nt ? \"Print\"",
          "new_text": null,
          "old_line_content": "        fz_var(list);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1937,
          "old_api": "",
          "new_api": null,
          "old_text": "           ",
          "new_text": null,
          "old_line_content": "        fz_var(dev);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1939,
          "old_api": "\"View\";\n        Vec<Page",
          "new_api": null,
          "old_text": "\"View\";\n        Vec<Page",
          "new_text": null,
          "old_line_content": "            list = fz_new_display_list(ctx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1940,
          "old_api": "s = fz_get_user_page_annots(u",
          "new_api": null,
          "old_text": "s = fz_get_user_page_annots(u",
          "new_text": null,
          "old_line_content": "            dev = fz_new_list_device(ctx, list);",
          "new_line_content": "        fz_display_list *list = NULL;",
          "content_same": false
        },
        {
          "line": 1941,
          "old_api": "ageNo",
          "new_api": null,
          "old_text": "ageNo(page));\n        fz_try(ctx) {\n            f",
          "new_text": null,
          "old_line_content": "            pdf_run_page(_doc, page, dev, &fz_identity, NULL);",
          "new_line_content": "        fz_device *dev = NULL;",
          "content_same": false
        },
        {
          "line": 3990,
          "old_api": "tion",
          "new_api": null,
          "old_text": "tion(&ctxAccess);\n\n ",
          "new_text": null,
          "old_line_content": "        runCache.Remove(run);",
          "new_line_content": "void XpsEngineImpl::DropPageRun(XpsPageRun *run, bool forceRemove)",
          "content_same": false
        },
        {
          "line": 1944,
          "old_api": "_bound_page",
          "new_api": null,
          "old_text": "_bound_page(_doc, page, &pagere",
          "new_text": null,
          "old_line_content": "            fz_drop_display_list(ctx, list);",
          "new_line_content": "        fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 3994,
          "old_api": "new FitzAbortCookie();\n    return R",
          "new_api": null,
          "old_text": " new FitzAbortCookie();\n    return R",
          "new_text": null,
          "old_line_content": "        fz_drop_display_list(ctx, run->list);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1951,
          "old_api": ", ctm, targetName, cookie ?",
          "new_api": null,
          "old_text": ", ctm, targetName, cookie ? ",
          "new_text": null,
          "old_line_content": "            runCache.InsertAt(0, result);",
          "new_line_content": "            list = NULL;",
          "content_same": false
        },
        {
          "line": 4001,
          "old_api": "t rotation,",
          "new_api": null,
          "old_text": "t rotation,",
          "new_text": null,
          "old_line_content": "    assert(1 <= pageNo && pageNo <= PageCount());",
          "new_line_content": "        delete run;",
          "content_same": false
        },
        {
          "line": 1954,
          "old_api": "parency",
          "new_api": null,
          "old_text": "parency(pageAn",
          "new_text": null,
          "old_line_content": "    else if (result && result != runCache.At(0)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4003,
          "old_api": "rtCooki",
          "new_api": null,
          "old_text": "rtCooki",
          "new_text": null,
          "old_line_content": "        return RectD();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 4006,
          "old_api": "o);\n    if (!p",
          "new_api": null,
          "old_text": "o);\n    if (!p",
          "new_text": null,
          "old_line_content": "    if (!mbox.IsEmpty())",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 4013,
          "old_api": ", zoom, rotation);\n    fz_rect r = p",
          "new_api": null,
          "old_text": ", zoom, rotation);\n    fz_rect r = p",
          "new_text": null,
          "old_line_content": "            mbox = fz_rect_to_RectD(xps_bound_page_quick(_doc, pageNo-1));",
          "new_line_content": "        return mbox;",
          "content_same": false
        },
        {
          "line": 4016,
          "old_api": "ansform_rect",
          "new_api": null,
          "old_text": "ansform_rect(&",
          "new_text": null,
          "old_line_content": "        if (!mbox.IsEmpty()) {",
          "new_line_content": "    if (!page) {",
          "content_same": false
        },
        {
          "line": 1970,
          "old_api": "ool forceRemove)\n{\n    Scop",
          "new_api": null,
          "old_text": "ool forceRemove)\n{\n    Scop",
          "new_text": null,
          "old_line_content": "    if (Target_View == target && (run = GetPageRun(page, !cacheRun)) != NULL) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1971,
          "old_api": "Access);\n    run->refs--;\n\n    i",
          "new_api": null,
          "old_text": "Access);\n    run->refs--;\n\n    i",
          "new_text": null,
          "old_line_content": "        EnterCriticalSection(&ctxAccess);",
          "new_line_content": "bool PdfEngineImpl::RunPage(pdf_page *page, fz_device *dev, const fz_matrix *ctm, RenderTarget target, const fz_rect *cliprect, bool cacheRun, FitzAbortCookie *cookie)",
          "content_same": false
        },
        {
          "line": 1972,
          "old_api": "n->refs) {",
          "new_api": null,
          "old_text": "n->refs) {\n    ",
          "new_text": null,
          "old_line_content": "        Vec<PageAnnotation> pageAnnots = fz_get_user_page_annots(userAnnots, GetPageNo(page));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 4021,
          "old_api": "int w = bb",
          "new_api": null,
          "old_text": "        int w = bb",
          "new_text": null,
          "old_line_content": "    if (!page && (page = GetXpsPage(pageNo)) == NULL)",
          "new_line_content": "        fz_catch(ctx) { }",
          "content_same": false
        },
        {
          "line": 1975,
          "old_api": "delete run;\n    }\n}\n\nRectD PdfEn",
          "new_api": null,
          "old_text": "     delete run;\n    }\n}\n\nRectD PdfEn",
          "new_text": null,
          "old_line_content": "            fz_begin_page(dev, pdf_bound_page(_doc, page, &pagerect), ctm);",
          "new_line_content": "    PdfPageRun *run;",
          "content_same": false
        },
        {
          "line": 4025,
          "old_api": "&trans, (float)-bbox.x0, (float)-bbox",
          "new_api": null,
          "old_text": "&trans, (float)-bbox.x0, (float)-bbox",
          "new_text": null,
          "old_line_content": "    _mediaboxes[pageNo-1] = fz_rect_to_RectD(*xps_bound_page(_doc, page, &pagerect));",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1979,
          "old_api": "page.c's pdf_load_page\n    fz_rect mbox = fz_empty_rect, cbox = fz_empty_rect;\n    int r",
          "new_api": null,
          "old_text": "page.c's pdf_load_page\n    fz_rect mbox = fz_empty_rect, cbox = fz_empty_rect;\n    int r",
          "new_text": null,
          "old_line_content": "            fz_run_user_page_annots(pageAnnots, dev, ctm, cliprect, cookie ? &cookie->cookie : NULL);",
          "new_line_content": "        fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 1980,
          "old_api": "float userunit =",
          "new_api": null,
          "old_text": "float userunit =",
          "new_text": null,
          "old_line_content": "            fz_end_page(dev);",
          "new_line_content": "            fz_rect pagerect;",
          "content_same": false
        },
        {
          "line": 4032,
          "old_api": "HDC hDC = GetDC(N",
          "new_api": null,
          "old_text": " HDC hDC = GetDC(N",
          "new_text": null,
          "old_line_content": "    xps_page *page = GetXpsPage(pageNo);",
          "new_line_content": "    return _mediaboxes[pageNo-1];",
          "content_same": false
        },
        {
          "line": 4034,
          "old_api": "ompatib",
          "new_api": null,
          "old_text": "ompatib",
          "new_text": null,
          "old_line_content": "        return RectD();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1995,
          "old_api": "age %d\", pageNo);\n        mbox.x0 = 0",
          "new_api": null,
          "old_text": "age %d\", pageNo);\n        mbox.x0 = 0",
          "new_text": null,
          "old_line_content": "            fz_begin_page(dev, pdf_bound_page(_doc, page, &pagerect), ctm);",
          "new_line_content": "        ScopedCritSec scope(&ctxAccess);",
          "content_same": false
        },
        {
          "line": 1996,
          "old_api": "mbox.x1 = 612; mbox.y1 = 792;\n    }\n    if (!fz_is_empty_rect(&cbox)) {",
          "new_api": null,
          "old_text": "  mbox.x1 = 612; mbox.y1 = 792;\n    }\n    if (!fz_is_empty_rect(&cbox)) {\n    ",
          "new_text": null,
          "old_line_content": "            fz_run_page_transparency(pageAnnots, dev, cliprect, false, page->transparency);",
          "new_line_content": "        char *targetName = target == Target_Print ? \"Print\" :",
          "content_same": false
        },
        {
          "line": 1997,
          "old_api": "t_rect",
          "new_api": null,
          "old_text": "t_rect(&mbox, &cbox);\n        if (fz_is_empty_rect(&mbox))\n            return RectD();\n   ",
          "new_text": null,
          "old_line_content": "            pdf_run_page_with_usage(_doc, page, dev, ctm, targetName, cookie ? &cookie->cookie : NULL);",
          "new_line_content": "                           target == Target_Export ? \"Export\" : \"View\";",
          "content_same": false
        },
        {
          "line": 4043,
          "old_api": "eleaseDC",
          "new_api": null,
          "old_text": "eleaseDC(NULL, hDC);\n        if ",
          "new_text": null,
          "old_line_content": "        LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "    fz_device *dev = NULL;",
          "content_same": false
        },
        {
          "line": 1999,
          "old_api": "m;\n    fz_transform_rect(&mbox, fz_rotate(&ctm, (float)rotate));\n\n    _mediaboxes[pageNo",
          "new_api": null,
          "old_text": "m;\n    fz_transform_rect(&mbox, fz_rotate(&ctm, (float)rotate));\n\n    _mediaboxes[pageNo",
          "new_text": null,
          "old_line_content": "            fz_run_user_page_annots(pageAnnots, dev, ctm, cliprect, cookie ? &cookie->cookie : NULL);",
          "new_line_content": "        fz_try(ctx) {",
          "content_same": false
        },
        {
          "line": 2000,
          "old_api": "0, (mbox.x1 - mb",
          "new_api": null,
          "old_text": "0, (mbox.x1 - mb",
          "new_text": null,
          "old_line_content": "            fz_end_page(dev);",
          "new_line_content": "            fz_rect pagerect;",
          "content_same": false
        },
        {
          "line": 4053,
          "old_api": "olorspace *colorspace = fz",
          "new_api": null,
          "old_text": "olorspace *colorspace = fz",
          "new_text": null,
          "old_line_content": "    if (fz_is_infinite_rect(&rect))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4054,
          "old_api": "image = fz_n",
          "new_api": null,
          "old_text": "        image = fz_n",
          "new_text": null,
          "old_line_content": "        return PageMediabox(pageNo);",
          "new_line_content": "    fz_rect pagerect;",
          "content_same": false
        },
        {
          "line": 2007,
          "old_api": "RectD PdfEngineImpl::PageConten",
          "new_api": null,
          "old_text": "\nRectD PdfEngineImpl::PageConten",
          "new_text": null,
          "old_line_content": "    EnterCriticalSection(&ctxAccess);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2008,
          "old_api": "t pageNo, RenderTar",
          "new_api": null,
          "old_text": "t pageNo, RenderTar",
          "new_text": null,
          "old_line_content": "    fz_free_device(dev);",
          "new_line_content": "        fz_catch(ctx) {",
          "content_same": false
        },
        {
          "line": 2009,
          "old_api": "get)\n{\n    assert(1 <= pageNo &&",
          "new_api": null,
          "old_text": "get)\n{\n    assert(1 <= pageNo &&",
          "new_text": null,
          "old_line_content": "    LeaveCriticalSection(&ctxAccess);",
          "new_line_content": "            ok = false;",
          "content_same": false
        },
        {
          "line": 4057,
          "old_api": "alue",
          "new_api": null,
          "old_text": "alue(ctx, image, 0xF",
          "new_text": null,
          "old_line_content": "    return rect2.Intersect(PageMediabox(pageNo));",
          "new_line_content": "    if (!ok)",
          "content_same": false
        },
        {
          "line": 4064,
          "old_api": "= fz_new_draw_device(ctx, im",
          "new_api": null,
          "old_text": "= fz_new_draw_device(ctx, im",
          "new_text": null,
          "old_line_content": "        fz_invert_matrix(&ctm, &ctm);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 4066,
          "old_api": "x, image);\n        LeaveCritic",
          "new_api": null,
          "old_text": "x, image);\n        LeaveCritic",
          "new_text": null,
          "old_line_content": "    fz_transform_point(&pt2, &ctm);",
          "new_line_content": "PointD XpsEngineImpl::Transform(PointD pt, int pageNo, float zoom, int rotation, bool inverse)",
          "content_same": false
        },
        {
          "line": 4067,
          "old_api": "Access);\n        ret",
          "new_api": null,
          "old_text": "Access);\n        ret",
          "new_text": null,
          "old_line_content": "    return PointD(pt2.x, pt2.y);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2020,
          "old_api": "w_bbox_device",
          "new_api": null,
          "old_text": "w_bbox_device(ctx, &",
          "new_text": null,
          "old_line_content": "        runCache.Remove(run);",
          "new_line_content": "void PdfEngineImpl::DropPageRun(PdfPageRun *run, bool forceRemove)",
          "content_same": false
        },
        {
          "line": 2024,
          "old_api": "turn RectD();\n    }\n    LeaveCritica",
          "new_api": null,
          "old_text": "turn RectD();\n    }\n    LeaveCritica",
          "new_text": null,
          "old_line_content": "        fz_drop_display_list(ctx, run->list);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4074,
          "old_api": "bool ok = RunPage(page,",
          "new_api": null,
          "old_text": "    bool ok = RunPage(page, ",
          "new_text": null,
          "old_line_content": "        fz_invert_matrix(&ctm, &ctm);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 4075,
          "old_api": "_irect",
          "new_api": null,
          "old_text": "_irect(&cliprect, &bbo",
          "new_text": null,
          "old_line_content": "    fz_rect rect2 = fz_RectD_to_rect(rect);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4076,
          "old_api": "e, cookie);\n\n    ScopedCritSec",
          "new_api": null,
          "old_text": "e, cookie);\n\n    ScopedCritSec ",
          "new_text": null,
          "old_line_content": "    fz_transform_rect(&rect2, &ctm);",
          "new_line_content": "RectD XpsEngineImpl::Transform(RectD rect, int pageNo, float zoom, int rotation, bool inverse)",
          "content_same": false
        },
        {
          "line": 4077,
          "old_api": "ss);\n\n    RenderedBitma",
          "new_api": null,
          "old_text": "ss);\n\n    RenderedBitma",
          "new_text": null,
          "old_line_content": "    return fz_rect_to_RectD(rect2);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2031,
          "old_api": "fz_identity",
          "new_api": null,
          "old_text": "fz_identity",
          "new_text": null,
          "old_line_content": "    assert(1 <= pageNo && pageNo <= PageCount());",
          "new_line_content": "        delete run;",
          "content_same": false
        },
        {
          "line": 2032,
          "old_api": "gerect, false);\n    if (!ok)",
          "new_api": null,
          "old_text": "gerect, false);\n    if (!ok)\n  ",
          "new_text": null,
          "old_line_content": "    if (!_mediaboxes[pageNo-1].IsEmpty())",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4087,
          "old_api": "rn NULL;\n\n    fz_text_sheet *",
          "new_api": null,
          "old_text": "rn NULL;\n\n    fz_text_sheet *",
          "new_text": null,
          "old_line_content": "        ctm2 = viewctm(page, zoom, rotation);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 4091,
          "old_api": "fz_var(text);\n\n    Enter",
          "new_api": null,
          "old_text": "   fz_var(text);\n\n    Enter",
          "new_text": null,
          "old_line_content": "            pRect = fz_RectD_to_rect(*pageRect);",
          "new_line_content": "    fz_matrix ctm2;",
          "content_same": false
        },
        {
          "line": 2046,
          "old_api": "f (inverse)\n        fz_invert_matrix(&ctm, &ctm);",
          "new_api": null,
          "old_text": "f (inverse)\n        fz_invert_matrix(&ctm, &ctm);\n    ",
          "new_text": null,
          "old_line_content": "        pdf_to_rect(ctx, pdf_lookup_inherited_page_item(_doc, page, \"MediaBox\"), &mbox);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2047,
          "old_api": ")pt.y };\n    fz_transform_point(&pt2, &ctm);\n    retu",
          "new_api": null,
          "old_text": ")pt.y };\n    fz_transform_point(&pt2, &ctm);\n    retu",
          "new_text": null,
          "old_line_content": "        pdf_to_rect(ctx, pdf_lookup_inherited_page_item(_doc, page, \"CropBox\"), &cbox);",
          "new_line_content": "    // cf. pdf-page.c's pdf_load_page",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 419,
      "total_additions": 801,
      "total_deletions": 801,
      "total_api_changes": 2021
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 10,
        "api_related_lines": 2021,
        "non_api_lines": 10,
        "non_api_line_numbers": [
          105,
          106,
          107,
          108,
          109,
          110,
          111,
          117,
          118,
          92
        ]
      }
    },
    "api_calls_before": 1547,
    "api_calls_after": 1547,
    "diff_info": {
      "added_lines": 9,
      "removed_lines": 3,
      "total_diff_lines": 36
    }
  }
}