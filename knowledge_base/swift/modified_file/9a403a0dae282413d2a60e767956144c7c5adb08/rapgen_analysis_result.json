{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/9a403a0dae282413d2a60e767956144c7c5adb08",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/9a403a0dae282413d2a60e767956144c7c5adb08/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/9a403a0dae282413d2a60e767956144c7c5adb08/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/9a403a0dae282413d2a60e767956144c7c5adb08/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 4022,
          "old_api": "str",
          "new_api": "findAssociatedTypeName",
          "old_text": "fatalError(0,\n               \"failed to demangle witness for associated type '%s' in \"\n               \"conformance '%s: %s' from mangled name '%s'\\n\",\n               assocTypeName.str().c_str(),\n               conformingTypeName.str().c_str(),\n               protocol->Name.get(),\n               mangledName.str().c_str())",
          "new_text": "findAssociatedTypeName(protocol, assocType)",
          "old_line_content": "    fatalError(0,",
          "new_line_content": "    StringRef assocTypeName = findAssociatedTypeName(protocol, assocType);",
          "content_same": false
        },
        {
          "line": 4027,
          "old_api": "get",
          "new_api": "str",
          "old_text": "protocol->Name.get()",
          "new_text": "conformingTypeName.str().c_str()",
          "old_line_content": "               protocol->Name.get(),",
          "new_line_content": "               conformingTypeName.str().c_str(),",
          "content_same": false
        },
        {
          "line": 4028,
          "old_api": "str",
          "new_api": "get",
          "old_text": "mangledName.str().c_str()",
          "new_text": "protocol->Name.get()",
          "old_line_content": "               mangledName.str().c_str());",
          "new_line_content": "               protocol->Name.get(),",
          "content_same": false
        },
        {
          "line": 4056,
          "old_api": "dyn_cast<ForeignClassMetadata>(metadata)",
          "new_api": "dyn_cast<ClassMetadata>(metadata)",
          "old_text": "dyn_cast<ForeignClassMetadata>(metadata)",
          "new_text": "dyn_cast<ClassMetadata>(metadata)",
          "old_line_content": "  } else if (auto foreignClass = dyn_cast<ForeignClassMetadata>(metadata)) {",
          "new_line_content": "  if (auto classMetadata = dyn_cast<ClassMetadata>(metadata)) {",
          "content_same": false
        },
        {
          "line": 4057,
          "old_api": "forForeignMetadata",
          "new_api": "getDescription",
          "old_text": "std::move(callbacks).forForeignMetadata(foreignClass,\n                                                foreignClass->getDescription())",
          "new_text": "classMetadata->getDescription()",
          "old_line_content": "    return std::move(callbacks).forForeignMetadata(foreignClass,",
          "new_line_content": "    description = classMetadata->getDescription();",
          "content_same": false
        },
        {
          "line": 4058,
          "old_api": "getDescription",
          "new_api": "dyn_cast<ValueMetadata>(metadata)",
          "old_text": "foreignClass->getDescription()",
          "new_text": "dyn_cast<ValueMetadata>(metadata)",
          "old_line_content": "                                                foreignClass->getDescription());",
          "new_line_content": "  } else if (auto valueMetadata = dyn_cast<ValueMetadata>(metadata)) {",
          "content_same": false
        },
        {
          "line": 4060,
          "old_api": "forOtherMetadata",
          "new_api": "dyn_cast<TupleTypeMetadata>(metadata)",
          "old_text": "std::move(callbacks).forOtherMetadata(metadata)",
          "new_text": "dyn_cast<TupleTypeMetadata>(metadata)",
          "old_line_content": "    return std::move(callbacks).forOtherMetadata(metadata);",
          "new_line_content": "  } else if (auto tupleMetadata = dyn_cast<TupleTypeMetadata>(metadata)) {",
          "content_same": false
        },
        {
          "line": 4063,
          "old_api": "isGeneric",
          "new_api": "forOtherMetadata",
          "old_text": "description->isGeneric()",
          "new_text": "std::move(callbacks).forOtherMetadata(tupleMetadata)",
          "old_line_content": "  if (!description->isGeneric()) {",
          "new_line_content": "      return std::move(callbacks).forOtherMetadata(tupleMetadata);",
          "content_same": false
        },
        {
          "line": 4064,
          "old_api": "getMetadataInitialization",
          "new_api": "forTupleMetadata",
          "old_text": "description->getMetadataInitialization()",
          "new_text": "std::move(callbacks).forTupleMetadata(tupleMetadata)",
          "old_line_content": "    switch (description->getMetadataInitialization()) {",
          "new_line_content": "    return std::move(callbacks).forTupleMetadata(tupleMetadata);",
          "content_same": false
        },
        {
          "line": 4066,
          "old_api": "forOtherMetadata",
          "new_api": "forForeignMetadata",
          "old_text": "std::move(callbacks).forOtherMetadata(metadata)",
          "new_text": "std::move(callbacks).forForeignMetadata(foreignClass,\n                                                foreignClass->getDescription())",
          "old_line_content": "      return std::move(callbacks).forOtherMetadata(metadata);",
          "new_line_content": "    return std::move(callbacks).forForeignMetadata(foreignClass,",
          "content_same": false
        },
        {
          "line": 4069,
          "old_api": "forForeignMetadata",
          "new_api": "forOtherMetadata",
          "old_text": "std::move(callbacks).forForeignMetadata(metadata, description)",
          "new_text": "std::move(callbacks).forOtherMetadata(metadata)",
          "old_line_content": "      return std::move(callbacks).forForeignMetadata(metadata, description);",
          "new_line_content": "    return std::move(callbacks).forOtherMetadata(metadata);",
          "content_same": false
        },
        {
          "line": 4072,
          "old_api": "forSingletonMetadata",
          "new_api": "isGeneric",
          "old_text": "std::move(callbacks).forSingletonMetadata(description)",
          "new_text": "description->isGeneric()",
          "old_line_content": "      return std::move(callbacks).forSingletonMetadata(description);",
          "new_line_content": "  if (!description->isGeneric()) {",
          "content_same": false
        },
        {
          "line": 4081,
          "old_api": "getGenericArguments",
          "new_api": "forSingletonMetadata",
          "old_text": "description->getGenericArguments(metadata)",
          "new_text": "std::move(callbacks).forSingletonMetadata(description)",
          "old_line_content": "                                    description->getGenericArguments(metadata));",
          "new_line_content": "      return std::move(callbacks).forSingletonMetadata(description);",
          "content_same": false
        },
        {
          "line": 4083,
          "old_api": "MetadataCacheKey",
          "new_api": "swift_runtime_unreachable",
          "old_text": "MetadataCacheKey(genericArgs, numGenericArgs)",
          "new_text": "swift_runtime_unreachable(\"bad metadata initialization kind\")",
          "old_line_content": "  auto key = MetadataCacheKey(genericArgs, numGenericArgs);",
          "new_line_content": "    swift_runtime_unreachable(\"bad metadata initialization kind\");",
          "content_same": false
        },
        {
          "line": 4086,
          "old_api": "getCache",
          "new_api": "getFullGenericContextHeader",
          "old_text": "getCache(generics)",
          "new_text": "description->getFullGenericContextHeader()",
          "old_line_content": "                                                 getCache(generics), key);",
          "new_line_content": "  auto &generics = description->getFullGenericContextHeader();",
          "content_same": false
        },
        {
          "line": 4108,
          "old_api": "get",
          "new_api": "enqueue",
          "old_text": "SingletonMetadata.get().enqueue(description, QueueEntry, Dependency)",
          "new_text": "cache.enqueue(key, QueueEntry, Dependency)",
          "old_line_content": "      return SingletonMetadata.get().enqueue(description, QueueEntry, Dependency);",
          "new_line_content": "      return cache.enqueue(key, QueueEntry, Dependency);",
          "content_same": false
        },
        {
          "line": 4140,
          "old_api": "get",
          "new_api": "resumeInitialization",
          "old_text": "SingletonMetadata.get().resumeInitialization(description, QueueEntry)",
          "new_text": "cache.resumeInitialization(key, QueueEntry)",
          "old_line_content": "      SingletonMetadata.get().resumeInitialization(description, QueueEntry);",
          "new_line_content": "      cache.resumeInitialization(key, QueueEntry);",
          "content_same": false
        },
        {
          "line": 4153,
          "old_api": "std::move(callbacks)",
          "new_api": "get",
          "old_text": "std::move(callbacks)",
          "new_text": "TupleTypes.get().resumeInitialization(metadata, QueueEntry)",
          "old_line_content": "  performOnMetadataCache<void>(metadata, std::move(callbacks));",
          "new_line_content": "      TupleTypes.get().resumeInitialization(metadata, QueueEntry);",
          "content_same": false
        },
        {
          "line": 4189,
          "old_api": "std::move(callbacks)",
          "new_api": "get",
          "old_text": "std::move(callbacks)",
          "new_text": "TupleTypes.get().await(metadata, Request)",
          "old_line_content": "  return performOnMetadataCache<MetadataResponse>(type, std::move(callbacks));",
          "new_line_content": "      return TupleTypes.get().await(metadata, Request);",
          "content_same": false
        },
        {
          "line": 4209,
          "old_api": "getDescription",
          "new_api": "dyn_cast<ClassMetadata>(type)",
          "old_text": "valueType->getDescription()",
          "new_text": "dyn_cast<ClassMetadata>(type)",
          "old_line_content": "    description = valueType->getDescription();",
          "new_line_content": "  if (auto classType = dyn_cast<ClassMetadata>(type)) {",
          "content_same": false
        },
        {
          "line": 4212,
          "old_api": "dyn_cast<TupleTypeMetadata>(type)",
          "new_api": "predicate",
          "old_text": "dyn_cast<TupleTypeMetadata>(type)",
          "new_text": "predicate(super)",
          "old_line_content": "  } else if (auto tupleType = dyn_cast<TupleTypeMetadata>(type)) {",
          "new_line_content": "      if (super->isTypeMetadata() && predicate(super))",
          "content_same": false
        },
        {
          "line": 4243,
          "old_api": "hasExtraArgument",
          "new_api": "getFullGenericContextHeader",
          "old_text": "param.hasExtraArgument()",
          "new_text": "description->getFullGenericContextHeader()",
          "old_line_content": "      } else if (param.hasExtraArgument()) {",
          "new_line_content": "    auto &generics = description->getFullGenericContextHeader();",
          "content_same": false
        },
        {
          "line": 4463,
          "old_api": "std::move(callbacks)",
          "new_api": "get",
          "old_text": "std::move(callbacks)",
          "new_text": "TupleTypes.get().checkDependency(metadata, Requirement)",
          "old_line_content": "                                                    std::move(callbacks));",
          "new_line_content": "      return TupleTypes.get().checkDependency(metadata, Requirement);",
          "content_same": false
        },
        {
          "line": 4472,
          "old_api": "push_back",
          "new_api": "std::move(callbacks)",
          "old_text": "links.push_back(newLink)",
          "new_text": "std::move(callbacks)",
          "old_line_content": "    links.push_back(newLink);",
          "new_line_content": "                                                    std::move(callbacks));",
          "content_same": false
        },
        {
          "line": 4484,
          "old_api": "checkNewLink",
          "new_api": "end",
          "old_text": "checkNewLink(firstLink)",
          "new_text": "links.end()",
          "old_line_content": "  checkNewLink(firstLink);",
          "new_line_content": "    for (auto i = links.begin(), e = links.end() - 1; i != e; ++i) {",
          "content_same": false
        },
        {
          "line": 4487,
          "old_api": "back",
          "new_api": "end",
          "old_text": "links.back()",
          "new_text": "diagnoseMetadataDependencyCycle(i->Value,\n                                llvm::makeArrayRef(&*next, links.end() - next))",
          "old_line_content": "    auto newLink = checkMetadataDependency(links.back());",
          "new_line_content": "        diagnoseMetadataDependencyCycle(i->Value,",
          "content_same": false
        },
        {
          "line": 4550,
          "old_api": "__msan_allocated_memory",
          "new_api": "__asan_poison_memory_region",
          "old_text": "__msan_allocated_memory(allocation, size)",
          "new_text": "__asan_poison_memory_region(allocation, PoolRange::PageSize)",
          "old_line_content": "      __msan_allocated_memory(allocation, size);",
          "new_line_content": "      __asan_poison_memory_region(allocation, PoolRange::PageSize);",
          "content_same": false
        },
        {
          "line": 4572,
          "old_api": "load",
          "new_api": "__asan_poison_memory_region",
          "old_text": "AllocationPool.load(std::memory_order_relaxed)",
          "new_text": "__asan_poison_memory_region(allocation, size)",
          "old_line_content": "  PoolRange curState = AllocationPool.load(std::memory_order_relaxed);",
          "new_line_content": "  __asan_poison_memory_region(allocation, size);",
          "content_same": false
        },
        {
          "line": 4582,
          "old_api": "std::atomic_compare_exchange_strong_explicit(&AllocationPool,\n                                                 &curState, newState,\n                                                 std::memory_order_relaxed,\n                                                 std::memory_order_relaxed)",
          "new_api": "reinterpret_cast<const char*>(allocation)",
          "old_text": "std::atomic_compare_exchange_strong_explicit(&AllocationPool,\n                                                 &curState, newState,\n                                                 std::memory_order_relaxed,\n                                                 std::memory_order_relaxed)",
          "new_text": "reinterpret_cast<const char*>(allocation)",
          "old_line_content": "    std::atomic_compare_exchange_strong_explicit(&AllocationPool,",
          "new_line_content": "  if (reinterpret_cast<const char*>(allocation) + size != curState.Begin) {",
          "content_same": false
        },
        {
          "line": 4604,
          "old_api": "getKind",
          "new_api": "dyn_cast<ExistentialTypeMetadata>(this)",
          "old_text": "node->getKind()",
          "new_text": "dyn_cast<ExistentialTypeMetadata>(this)",
          "old_line_content": "  if (node->getKind() == Demangle::Node::Kind::AnonymousContext)",
          "new_line_content": "  if (auto *existential = dyn_cast<ExistentialTypeMetadata>(this))",
          "content_same": false
        },
        {
          "line": 4639,
          "old_api": "c_str",
          "new_api": "referencesAnonymousContext",
          "old_text": "mangledName.c_str()",
          "new_text": "referencesAnonymousContext(node)",
          "old_line_content": "                   metadata, mangledName.c_str(), (const Metadata *)result);",
          "new_line_content": "  if (referencesAnonymousContext(node))",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 4608,
          "old_api": null,
          "new_api": "isAnyClass",
          "old_text": null,
          "new_text": "isAnyClass()",
          "old_line_content": "      return true;",
          "new_line_content": "  return isAnyClass();",
          "content_same": false
        },
        {
          "line": 4613,
          "old_api": null,
          "new_api": "getKind",
          "old_text": null,
          "new_text": "node->getKind()",
          "old_line_content": "void swift::verifyMangledNameRoundtrip(const Metadata *metadata) {",
          "new_line_content": "  if (node->getKind() == Demangle::Node::Kind::AnonymousContext)",
          "content_same": false
        },
        {
          "line": 4615,
          "old_api": null,
          "new_api": "getNumChildren",
          "old_text": null,
          "new_text": "node->getNumChildren()",
          "old_line_content": "  // Some metatypes crash when going through the mangler or demangler. A",
          "new_line_content": "  for (unsigned i = 0, e = node->getNumChildren(); i < e; ++i)",
          "content_same": false
        },
        {
          "line": 4616,
          "old_api": null,
          "new_api": "getChild",
          "old_text": null,
          "new_text": "node->getChild(i)",
          "old_line_content": "  // lot of tests currently trigger those crashes, resulting in failing",
          "new_line_content": "    if (referencesAnonymousContext(node->getChild(i)))",
          "content_same": false
        },
        {
          "line": 4113,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "ForeignMetadata.get().enqueue(description, QueueEntry, Dependency)",
          "old_line_content": "    }",
          "new_line_content": "      return ForeignMetadata.get().enqueue(description, QueueEntry, Dependency);",
          "content_same": false
        },
        {
          "line": 4117,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "SingletonMetadata.get().enqueue(description, QueueEntry, Dependency)",
          "old_line_content": "    }",
          "new_line_content": "      return SingletonMetadata.get().enqueue(description, QueueEntry, Dependency);",
          "content_same": false
        },
        {
          "line": 4631,
          "old_api": null,
          "new_api": "getenv",
          "old_text": null,
          "new_text": "getenv(\"SWIFT_ENABLE_MANGLED_NAME_VERIFICATION\")",
          "old_line_content": "    return;",
          "new_line_content": "    SWIFT_LAZY_CONSTANT((bool)getenv(\"SWIFT_ENABLE_MANGLED_NAME_VERIFICATION\"));",
          "content_same": false
        },
        {
          "line": 4121,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "TupleTypes.get().enqueue(metadata, QueueEntry, Dependency)",
          "old_line_content": "}",
          "new_line_content": "      return TupleTypes.get().enqueue(metadata, QueueEntry, Dependency);",
          "content_same": false
        },
        {
          "line": 4636,
          "old_api": null,
          "new_api": "_swift_buildDemanglingForMetadata",
          "old_text": null,
          "new_text": "_swift_buildDemanglingForMetadata(metadata, Dem)",
          "old_line_content": "  if (metadata != result)",
          "new_line_content": "  auto node = _swift_buildDemanglingForMetadata(metadata, Dem);",
          "content_same": false
        },
        {
          "line": 4125,
          "old_api": null,
          "new_api": "swift_runtime_unreachable",
          "old_text": null,
          "new_text": "swift_runtime_unreachable(\"metadata should always be complete\")",
          "old_line_content": "    MetadataCompletionQueueEntry *QueueEntry;",
          "new_line_content": "      swift_runtime_unreachable(\"metadata should always be complete\");",
          "content_same": false
        },
        {
          "line": 4129,
          "old_api": null,
          "new_api": "std::move(callbacks)",
          "old_text": null,
          "new_text": "std::move(callbacks)",
          "old_line_content": "                            GenericMetadataCache &cache,",
          "new_line_content": "  return performOnMetadataCache<bool>(dependency.Value, std::move(callbacks));",
          "content_same": false
        },
        {
          "line": 4642,
          "old_api": null,
          "new_api": "Demangle::mangleNode(node)",
          "old_text": null,
          "new_text": "Demangle::mangleNode(node)",
          "old_line_content": "",
          "new_line_content": "  auto mangledName = Demangle::mangleNode(node);",
          "content_same": false
        },
        {
          "line": 4643,
          "old_api": null,
          "new_api": "_getTypeByMangledName",
          "old_text": null,
          "new_text": "_getTypeByMangledName(mangledName,\n                                      [](unsigned, unsigned){ return nullptr; })",
          "old_line_content": "const TypeContextDescriptor *swift::swift_getTypeContextDescriptor(const Metadata *type) {",
          "new_line_content": "  auto result = _getTypeByMangledName(mangledName,",
          "content_same": false
        },
        {
          "line": 4646,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "swift::warning(RuntimeErrorFlagNone,\n                   \"Metadata mangled name failed to roundtrip: %p -> %s -> %p\\n\",\n                   metadata, mangledName.c_str(), (const Metadata *)result)",
          "old_line_content": "",
          "new_line_content": "    swift::warning(RuntimeErrorFlagNone,",
          "content_same": false
        },
        {
          "line": 4648,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "mangledName.c_str()",
          "old_line_content": "// implementation of these functions is in the standard library in",
          "new_line_content": "                   metadata, mangledName.c_str(), (const Metadata *)result);",
          "content_same": false
        },
        {
          "line": 4653,
          "old_api": null,
          "new_api": "getTypeContextDescriptor",
          "old_text": null,
          "new_text": "type->getTypeContextDescriptor()",
          "old_line_content": "                                       const void *arguments);",
          "new_line_content": "    return type->getTypeContextDescriptor();",
          "content_same": false
        },
        {
          "line": 4145,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "ForeignMetadata.get().resumeInitialization(description, QueueEntry)",
          "old_line_content": "    }",
          "new_line_content": "      ForeignMetadata.get().resumeInitialization(description, QueueEntry);",
          "content_same": false
        },
        {
          "line": 4149,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "SingletonMetadata.get().resumeInitialization(description, QueueEntry)",
          "old_line_content": "    }",
          "new_line_content": "      SingletonMetadata.get().resumeInitialization(description, QueueEntry);",
          "content_same": false
        },
        {
          "line": 4157,
          "old_api": null,
          "new_api": "swift_runtime_unreachable",
          "old_text": null,
          "new_text": "swift_runtime_unreachable(\"metadata should always be complete\")",
          "old_line_content": "                                                 const Metadata *type) {",
          "new_line_content": "      swift_runtime_unreachable(\"metadata should always be complete\");",
          "content_same": false
        },
        {
          "line": 4162,
          "old_api": null,
          "new_api": "std::move(callbacks)",
          "old_text": null,
          "new_text": "std::move(callbacks)",
          "old_line_content": "    MetadataResponse forGenericMetadata(const Metadata *type,",
          "new_line_content": "  performOnMetadataCache<void>(metadata, std::move(callbacks));",
          "content_same": false
        },
        {
          "line": 4175,
          "old_api": null,
          "new_api": "await",
          "old_text": null,
          "new_text": "cache.await(key, Request)",
          "old_line_content": "                                  const TypeContextDescriptor *description) && {",
          "new_line_content": "      return cache.await(key, Request);",
          "content_same": false
        },
        {
          "line": 4185,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "SingletonMetadata.get().await(description, Request)",
          "old_line_content": "      return MetadataResponse{type, MetadataState::Complete};",
          "new_line_content": "      return SingletonMetadata.get().await(description, Request);",
          "content_same": false
        },
        {
          "line": 4198,
          "old_api": null,
          "new_api": "std::move(callbacks)",
          "old_text": null,
          "new_text": "std::move(callbacks)",
          "old_line_content": "  // Classes require their superclass to be transitively complete,",
          "new_line_content": "  return performOnMetadataCache<MetadataResponse>(type, std::move(callbacks));",
          "content_same": false
        },
        {
          "line": 4210,
          "old_api": null,
          "new_api": "getDescription",
          "old_text": null,
          "new_text": "classType->getDescription()",
          "old_line_content": "",
          "new_line_content": "    description = classType->getDescription();",
          "content_same": false
        },
        {
          "line": 4217,
          "old_api": null,
          "new_api": "dyn_cast<ValueMetadata>(type)",
          "old_text": null,
          "new_text": "dyn_cast<ValueMetadata>(type)",
          "old_line_content": "    return false;",
          "new_line_content": "  } else if (auto valueType = dyn_cast<ValueMetadata>(type)) {",
          "content_same": false
        },
        {
          "line": 4218,
          "old_api": null,
          "new_api": "getDescription",
          "old_text": null,
          "new_text": "valueType->getDescription()",
          "old_line_content": "",
          "new_line_content": "    description = valueType->getDescription();",
          "content_same": false
        },
        {
          "line": 4221,
          "old_api": null,
          "new_api": "dyn_cast<TupleTypeMetadata>(type)",
          "old_text": null,
          "new_text": "dyn_cast<TupleTypeMetadata>(type)",
          "old_line_content": "    if (auto super = foreignClassType->Superclass) {",
          "new_line_content": "  } else if (auto tupleType = dyn_cast<TupleTypeMetadata>(type)) {",
          "content_same": false
        },
        {
          "line": 4223,
          "old_api": null,
          "new_api": "getElement",
          "old_text": null,
          "new_text": "tupleType->getElement(i)",
          "old_line_content": "        return true;",
          "new_line_content": "      if (predicate(tupleType->getElement(i).Type))",
          "content_same": false
        },
        {
          "line": 4229,
          "old_api": null,
          "new_api": "dyn_cast<ForeignClassMetadata>(type)",
          "old_text": null,
          "new_text": "dyn_cast<ForeignClassMetadata>(type)",
          "old_line_content": "    return false;",
          "new_line_content": "  } else if (auto foreignClassType = dyn_cast<ForeignClassMetadata>(type)) {",
          "content_same": false
        },
        {
          "line": 4231,
          "old_api": null,
          "new_api": "predicate",
          "old_text": null,
          "new_text": "predicate(super)",
          "old_line_content": "",
          "new_line_content": "      if (predicate(super))",
          "content_same": false
        },
        {
          "line": 4242,
          "old_api": null,
          "new_api": "isGeneric",
          "old_text": null,
          "new_text": "description->isGeneric()",
          "old_line_content": "          return true;",
          "new_line_content": "  if (description->isGeneric()) {",
          "content_same": false
        },
        {
          "line": 4245,
          "old_api": null,
          "new_api": "getGenericArguments",
          "old_text": null,
          "new_text": "description->getGenericArguments(type)",
          "old_line_content": "          return true;",
          "new_line_content": "    auto keyArguments = description->getGenericArguments(type);",
          "content_same": false
        },
        {
          "line": 4248,
          "old_api": null,
          "new_api": "getGenericParams",
          "old_text": null,
          "new_text": "description->getGenericParams()",
          "old_line_content": "    }",
          "new_line_content": "    for (auto &param : description->getGenericParams()) {",
          "content_same": false
        },
        {
          "line": 4249,
          "old_api": null,
          "new_api": "hasKeyArgument",
          "old_text": null,
          "new_text": "param.hasKeyArgument()",
          "old_line_content": "  }",
          "new_line_content": "      if (param.hasKeyArgument()) {",
          "content_same": false
        },
        {
          "line": 4250,
          "old_api": null,
          "new_api": "predicate",
          "old_text": null,
          "new_text": "predicate(*keyArguments++)",
          "old_line_content": "",
          "new_line_content": "        if (predicate(*keyArguments++))",
          "content_same": false
        },
        {
          "line": 4252,
          "old_api": null,
          "new_api": "hasExtraArgument",
          "old_text": null,
          "new_text": "param.hasExtraArgument()",
          "old_line_content": "  return false;",
          "new_line_content": "      } else if (param.hasExtraArgument()) {",
          "content_same": false
        },
        {
          "line": 4253,
          "old_api": null,
          "new_api": "predicate",
          "old_text": null,
          "new_text": "predicate(*extraArguments++)",
          "old_line_content": "}",
          "new_line_content": "        if (predicate(*extraArguments++))",
          "content_same": false
        },
        {
          "line": 4268,
          "old_api": null,
          "new_api": "getForeignMetadataInitialization",
          "old_text": null,
          "new_text": "findAnyTransitiveMetadata(type, [](const Metadata *type) {\n    struct IsIncompleteCallbacks {\n      bool forGenericMetadata(const Metadata *type,\n                              const TypeContextDescriptor *description,\n                              GenericMetadataCache &cache,\n                              MetadataCacheKey key) && {\n        // Metadata cache lookups aren't really cheap enough for this\n        // optimization.\n        return true;\n      }\n\n      bool forForeignMetadata(const Metadata *metadata,\n                              const TypeContextDescriptor *description) {\n        // If the type doesn't have a completion function, we can assume\n        // it's transitively complete by construction.\n        if (!description->getForeignMetadataInitialization().CompletionFunction)\n          return false;\n\n        // TODO: it might be worth doing a quick check against the cache here.\n        return false;\n      }\n\n      bool forSingletonMetadata(const TypeContextDescriptor *description) && {\n        // TODO: this could be cheap enough.\n        return true;\n      }\n\n      bool forTupleMetadata(const TupleTypeMetadata *metadata) {\n        // TODO: this could be cheap enough.\n        return true;\n      }\n\n      bool forOtherMetadata(const Metadata *type) && {\n        return false;\n      }\n    } callbacks;\n\n    return performOnMetadataCache<bool>(type, std::move(callbacks));\n  })",
          "old_line_content": "      }",
          "new_line_content": "  return !findAnyTransitiveMetadata(type, [](const Metadata *type) {",
          "content_same": false
        },
        {
          "line": 4283,
          "old_api": null,
          "new_api": "getForeignMetadataInitialization",
          "old_text": null,
          "new_text": "description->getForeignMetadataInitialization()",
          "old_line_content": "        return true;",
          "new_line_content": "        if (!description->getForeignMetadataInitialization().CompletionFunction)",
          "content_same": false
        },
        {
          "line": 4305,
          "old_api": null,
          "new_api": "std::move(callbacks)",
          "old_text": null,
          "new_text": "std::move(callbacks)",
          "old_line_content": "/// something that thinks it's still transitively incomplete, we can just",
          "new_line_content": "    return performOnMetadataCache<bool>(type, std::move(callbacks));",
          "content_same": false
        },
        {
          "line": 4331,
          "old_api": null,
          "new_api": "insert",
          "old_text": null,
          "new_text": "presumedCompleteTypes.insert(type)",
          "old_line_content": "    // This is the most likely result.",
          "new_line_content": "    if (!presumedCompleteTypes.insert(type).second)",
          "content_same": false
        },
        {
          "line": 4335,
          "old_api": null,
          "new_api": "MetadataRequest",
          "old_text": null,
          "new_text": "MetadataRequest(MetadataState::Complete,\n                                   /*non-blocking*/ true)",
          "old_line_content": "    // Otherwise, if the state is actually incomplete, set a dependency",
          "new_line_content": "    auto request = MetadataRequest(MetadataState::Complete,",
          "content_same": false
        },
        {
          "line": 4337,
          "old_api": null,
          "new_api": "swift_checkMetadataState",
          "old_text": null,
          "new_text": "swift_checkMetadataState(request, type)",
          "old_line_content": "    // because we can potentially resolve ourselves if we find completeness.",
          "new_line_content": "    auto state = swift_checkMetadataState(request, type).State;",
          "content_same": false
        },
        {
          "line": 4347,
          "old_api": null,
          "new_api": "isAtLeast",
          "old_text": null,
          "new_text": "isAtLeast(state, MetadataState::NonTransitiveComplete)",
          "old_line_content": "  };",
          "new_line_content": "    if (!isAtLeast(state, MetadataState::NonTransitiveComplete)) {",
          "content_same": false
        },
        {
          "line": 4354,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "worklist.push_back(type)",
          "old_line_content": "",
          "new_line_content": "    worklist.push_back(type);",
          "content_same": false
        },
        {
          "line": 4360,
          "old_api": null,
          "new_api": "insert",
          "old_text": null,
          "new_text": "presumedCompleteTypes.insert(initialType)",
          "old_line_content": "",
          "new_line_content": "  presumedCompleteTypes.insert(initialType);",
          "content_same": false
        },
        {
          "line": 4361,
          "old_api": null,
          "new_api": "findAnyTransitiveMetadata",
          "old_text": null,
          "new_text": "findAnyTransitiveMetadata(initialType, isIncomplete)",
          "old_line_content": "    // Search for incomplete dependencies.  This will set Dependency",
          "new_line_content": "  if (findAnyTransitiveMetadata(initialType, isIncomplete))",
          "content_same": false
        },
        {
          "line": 4366,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "worklist.empty()",
          "old_line_content": "",
          "new_line_content": "  while (!worklist.empty()) {",
          "content_same": false
        },
        {
          "line": 4367,
          "old_api": null,
          "new_api": "back",
          "old_text": null,
          "new_text": "worklist.back()",
          "old_line_content": "  // Otherwise, we're transitively complete.",
          "new_line_content": "    auto type = worklist.back();",
          "content_same": false
        },
        {
          "line": 4368,
          "old_api": null,
          "new_api": "pop_back",
          "old_text": null,
          "new_text": "worklist.pop_back()",
          "old_line_content": "  return { nullptr, MetadataState::Complete };",
          "new_line_content": "    worklist.pop_back();",
          "content_same": false
        },
        {
          "line": 4372,
          "old_api": null,
          "new_api": "findAnyTransitiveMetadata",
          "old_text": null,
          "new_text": "findAnyTransitiveMetadata(type, isIncomplete)",
          "old_line_content": "LLVM_ATTRIBUTE_NORETURN",
          "new_line_content": "    if (findAnyTransitiveMetadata(type, isIncomplete))",
          "content_same": false
        },
        {
          "line": 4384,
          "old_api": null,
          "new_api": "back",
          "old_text": null,
          "new_text": "links.back()",
          "old_line_content": "      diagnostic += \"\\n  (limiting diagnostic text at 128KB)\";",
          "new_line_content": "  assert(start == links.back().Value);",
          "content_same": false
        },
        {
          "line": 4388,
          "old_api": null,
          "new_api": "nameForMetadata",
          "old_text": null,
          "new_text": "nameForMetadata(start)",
          "old_line_content": "    diagnostic += \"\\n  depends on \";",
          "new_line_content": "  diagnostic += nameForMetadata(start);",
          "content_same": false
        },
        {
          "line": 4392,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "diagnostic.size()",
          "old_line_content": "      diagnostic += \"transitive completion of \";",
          "new_line_content": "    if (diagnostic.size() >= 128 * 1024) {",
          "content_same": false
        },
        {
          "line": 4414,
          "old_api": null,
          "new_api": "nameForMetadata",
          "old_text": null,
          "new_text": "nameForMetadata(link.Value)",
          "old_line_content": "      .version = RuntimeErrorDetails::currentVersion,",
          "new_line_content": "    diagnostic += nameForMetadata(link.Value);",
          "content_same": false
        },
        {
          "line": 4419,
          "old_api": null,
          "new_api": "_swift_shouldReportFatalErrorsToDebugger",
          "old_text": null,
          "new_text": "_swift_shouldReportFatalErrorsToDebugger()",
          "old_line_content": "      // TODO: describe the cycle using notes instead of one huge message?",
          "new_line_content": "  if (_swift_shouldReportFatalErrorsToDebugger()) {",
          "content_same": false
        },
        {
          "line": 4432,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "diagnostic.c_str()",
          "old_line_content": "static MetadataDependency",
          "new_line_content": "    _swift_reportToDebugger(RuntimeErrorFlagFatal, diagnostic.c_str(),",
          "content_same": false
        },
        {
          "line": 4436,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "diagnostic.c_str()",
          "old_line_content": "    MetadataDependency forGenericMetadata(const Metadata *type,",
          "new_line_content": "  fatalError(0, diagnostic.c_str());",
          "content_same": false
        },
        {
          "line": 4449,
          "old_api": null,
          "new_api": "checkDependency",
          "old_text": null,
          "new_text": "cache.checkDependency(key, Requirement)",
          "old_line_content": "                              const TypeContextDescriptor *description) && {",
          "new_line_content": "      return cache.checkDependency(key, Requirement);",
          "content_same": false
        },
        {
          "line": 4459,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "SingletonMetadata.get().checkDependency(description, Requirement)",
          "old_line_content": "    }",
          "new_line_content": "      return SingletonMetadata.get().checkDependency(description, Requirement);",
          "content_same": false
        },
        {
          "line": 4467,
          "old_api": null,
          "new_api": "MetadataDependency",
          "old_text": null,
          "new_text": "MetadataDependency()",
          "old_line_content": "void swift::checkMetadataDependencyCycle(const Metadata *startMetadata,",
          "new_line_content": "      return MetadataDependency();",
          "content_same": false
        },
        {
          "line": 4471,
          "old_api": null,
          "new_api": "performOnMetadataCache<MetadataDependency>(dependency.Value,\n                                                    std::move(callbacks))",
          "old_text": null,
          "new_text": "performOnMetadataCache<MetadataDependency>(dependency.Value,\n                                                    std::move(callbacks))",
          "old_line_content": "  auto checkNewLink = [&](MetadataDependency newLink) {",
          "new_line_content": "  return performOnMetadataCache<MetadataDependency>(dependency.Value,",
          "content_same": false
        },
        {
          "line": 4481,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "links.push_back(newLink)",
          "old_line_content": "    }",
          "new_line_content": "    links.push_back(newLink);",
          "content_same": false
        },
        {
          "line": 4483,
          "old_api": null,
          "new_api": "diagnoseMetadataDependencyCycle",
          "old_text": null,
          "new_text": "diagnoseMetadataDependencyCycle(startMetadata, links)",
          "old_line_content": "",
          "new_line_content": "      diagnoseMetadataDependencyCycle(startMetadata, links);",
          "content_same": false
        },
        {
          "line": 4488,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "links.end()",
          "old_line_content": "    if (!newLink) return;",
          "new_line_content": "                                llvm::makeArrayRef(&*next, links.end() - next));",
          "content_same": false
        },
        {
          "line": 4493,
          "old_api": null,
          "new_api": "checkNewLink",
          "old_text": null,
          "new_text": "checkNewLink(firstLink)",
          "old_line_content": "/***************************************************************************/",
          "new_line_content": "  checkNewLink(firstLink);",
          "content_same": false
        },
        {
          "line": 4494,
          "old_api": null,
          "new_api": "checkNewLink",
          "old_text": null,
          "new_text": "checkNewLink(secondLink)",
          "old_line_content": "/*** Allocator implementation **********************************************/",
          "new_line_content": "  checkNewLink(secondLink);",
          "content_same": false
        },
        {
          "line": 4496,
          "old_api": null,
          "new_api": "back",
          "old_text": null,
          "new_text": "links.back()",
          "old_line_content": "",
          "new_line_content": "    auto newLink = checkMetadataDependency(links.back());",
          "content_same": false
        },
        {
          "line": 4498,
          "old_api": null,
          "new_api": "checkNewLink",
          "old_text": null,
          "new_text": "checkNewLink(newLink)",
          "old_line_content": "  struct PoolRange {",
          "new_line_content": "    checkNewLink(newLink);",
          "content_same": false
        },
        {
          "line": 3991,
          "old_api": null,
          "new_api": "Demangle::makeSymbolicMangledNameStringRef(mangledNameBase)",
          "old_text": null,
          "new_text": "Demangle::makeSymbolicMangledNameStringRef(mangledNameBase)",
          "old_line_content": "",
          "new_line_content": "    Demangle::makeSymbolicMangledNameStringRef(mangledNameBase);",
          "content_same": false
        },
        {
          "line": 4508,
          "old_api": null,
          "new_api": "constexpr",
          "old_text": null,
          "new_text": "constexpr",
          "old_line_content": "} // end anonymous namespace",
          "new_line_content": "    static constexpr uintptr_t PageSize = 16 * 1024;",
          "content_same": false
        },
        {
          "line": 4509,
          "old_api": null,
          "new_api": "constexpr",
          "old_text": null,
          "new_text": "constexpr",
          "old_line_content": "",
          "new_line_content": "    static constexpr uintptr_t MaxPoolAllocationSize = PageSize / 2;",
          "content_same": false
        },
        {
          "line": 3999,
          "old_api": null,
          "new_api": "_getTypeByMangledName",
          "old_text": null,
          "new_text": "_getTypeByMangledName(mangledName,\n         [conformingType](unsigned depth, unsigned index) -> const Metadata * {\n        if (depth == 0 && index == 0)\n          return conformingType;\n\n        return nullptr;\n      })",
          "old_line_content": "         [conformingType](unsigned depth, unsigned index) -> const Metadata * {",
          "new_line_content": "      _getTypeByMangledName(mangledName,",
          "content_same": false
        },
        {
          "line": 4012,
          "old_api": null,
          "new_api": "findConformingSuperclass",
          "old_text": null,
          "new_text": "findConformingSuperclass(conformingType,\n                                                           protocol)",
          "old_line_content": "                                                           protocol);",
          "new_line_content": "    auto originalConformingType = findConformingSuperclass(conformingType,",
          "content_same": false
        },
        {
          "line": 4527,
          "old_api": null,
          "new_api": "alignof",
          "old_text": null,
          "new_text": "alignof(void*)",
          "old_line_content": "  while (true) {",
          "new_line_content": "  assert(alignment <= alignof(void*));",
          "content_same": false
        },
        {
          "line": 4528,
          "old_api": null,
          "new_api": "alignof",
          "old_text": null,
          "new_text": "alignof(void*)",
          "old_line_content": "    char *allocation;",
          "new_line_content": "  assert(size % alignof(void*) == 0);",
          "content_same": false
        },
        {
          "line": 4015,
          "old_api": null,
          "new_api": "_getTypeByMangledName",
          "old_text": null,
          "new_text": "_getTypeByMangledName(mangledName, substitutions)",
          "old_line_content": "  }",
          "new_line_content": "    assocTypeMetadata = _getTypeByMangledName(mangledName, substitutions);",
          "content_same": false
        },
        {
          "line": 4019,
          "old_api": null,
          "new_api": "swift_getTypeName",
          "old_text": null,
          "new_text": "swift_getTypeName(conformingType, true)",
          "old_line_content": "    StringRef conformingTypeName(conformingTypeNameInfo.data,",
          "new_line_content": "    auto conformingTypeNameInfo = swift_getTypeName(conformingType, true);",
          "content_same": false
        },
        {
          "line": 4532,
          "old_api": null,
          "new_api": "malloc",
          "old_text": null,
          "new_text": "malloc(size)",
          "old_line_content": "    // Try to allocate out of the current page.",
          "new_line_content": "    return malloc(size);",
          "content_same": false
        },
        {
          "line": 4535,
          "old_api": null,
          "new_api": "load",
          "old_text": null,
          "new_text": "AllocationPool.load(std::memory_order_relaxed)",
          "old_line_content": "      allocation = curState.Begin;",
          "new_line_content": "  PoolRange curState = AllocationPool.load(std::memory_order_relaxed);",
          "content_same": false
        },
        {
          "line": 4023,
          "old_api": null,
          "new_api": "str",
          "old_text": null,
          "new_text": "fatalError(0,\n               \"failed to demangle witness for associated type '%s' in \"\n               \"conformance '%s: %s' from mangled name '%s'\\n\",\n               assocTypeName.str().c_str(),\n               conformingTypeName.str().c_str(),\n               protocol->Name.get(),\n               mangledName.str().c_str())",
          "old_line_content": "               \"failed to demangle witness for associated type '%s' in \"",
          "new_line_content": "    fatalError(0,",
          "content_same": false
        },
        {
          "line": 4029,
          "old_api": null,
          "new_api": "str",
          "old_text": null,
          "new_text": "mangledName.str().c_str()",
          "old_line_content": "  }",
          "new_line_content": "               mangledName.str().c_str());",
          "content_same": false
        },
        {
          "line": 4033,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert((uintptr_t(assocTypeMetadata) &\n            ProtocolRequirementFlags::AssociatedTypeMangledNameBit) == 0)",
          "old_line_content": "            ProtocolRequirementFlags::AssociatedTypeMangledNameBit) == 0);",
          "new_line_content": "  assert((uintptr_t(assocTypeMetadata) &",
          "content_same": false
        },
        {
          "line": 4037,
          "old_api": null,
          "new_api": "swift_checkMetadataState",
          "old_text": null,
          "new_text": "swift_checkMetadataState(request, assocTypeMetadata)",
          "old_line_content": "",
          "new_line_content": "  auto response = swift_checkMetadataState(request, assocTypeMetadata);",
          "content_same": false
        },
        {
          "line": 4041,
          "old_api": null,
          "new_api": "reinterpret_cast<const void**>(wtable)",
          "old_text": null,
          "new_text": "reinterpret_cast<const void**>(wtable)",
          "old_line_content": "",
          "new_line_content": "    reinterpret_cast<const void**>(wtable)[witnessIndex] = assocTypeMetadata;",
          "content_same": false
        },
        {
          "line": 4554,
          "old_api": null,
          "new_api": "std::atomic_compare_exchange_weak_explicit(&AllocationPool,\n                                                   &curState, newState,\n                                              std::memory_order_relaxed,\n                                              std::memory_order_relaxed)",
          "old_text": null,
          "new_text": "std::atomic_compare_exchange_weak_explicit(&AllocationPool,\n                                                   &curState, newState,\n                                              std::memory_order_relaxed,\n                                              std::memory_order_relaxed)",
          "old_line_content": "",
          "new_line_content": "    if (std::atomic_compare_exchange_weak_explicit(&AllocationPool,",
          "content_same": false
        },
        {
          "line": 4559,
          "old_api": null,
          "new_api": "__msan_allocated_memory",
          "old_text": null,
          "new_text": "__msan_allocated_memory(allocation, size)",
          "old_line_content": "  }",
          "new_line_content": "      __msan_allocated_memory(allocation, size);",
          "content_same": false
        },
        {
          "line": 4560,
          "old_api": null,
          "new_api": "__asan_unpoison_memory_region",
          "old_text": null,
          "new_text": "__asan_unpoison_memory_region(allocation, size)",
          "old_line_content": "}",
          "new_line_content": "      __asan_unpoison_memory_region(allocation, size);",
          "content_same": false
        },
        {
          "line": 4059,
          "old_api": null,
          "new_api": "getDescription",
          "old_text": null,
          "new_text": "valueMetadata->getDescription()",
          "old_line_content": "  } else {",
          "new_line_content": "    description = valueMetadata->getDescription();",
          "content_same": false
        },
        {
          "line": 4575,
          "old_api": null,
          "new_api": "const_cast<void*>(allocation)",
          "old_text": null,
          "new_text": "const_cast<void*>(allocation)",
          "old_line_content": "  }",
          "new_line_content": "    free(const_cast<void*>(allocation));",
          "content_same": false
        },
        {
          "line": 4065,
          "old_api": null,
          "new_api": "dyn_cast<ForeignClassMetadata>(metadata)",
          "old_text": null,
          "new_text": "dyn_cast<ForeignClassMetadata>(metadata)",
          "old_line_content": "    case TypeContextDescriptorFlags::NoMetadataInitialization:",
          "new_line_content": "  } else if (auto foreignClass = dyn_cast<ForeignClassMetadata>(metadata)) {",
          "content_same": false
        },
        {
          "line": 4067,
          "old_api": null,
          "new_api": "getDescription",
          "old_text": null,
          "new_text": "foreignClass->getDescription()",
          "old_line_content": "",
          "new_line_content": "                                                foreignClass->getDescription());",
          "content_same": false
        },
        {
          "line": 4581,
          "old_api": null,
          "new_api": "load",
          "old_text": null,
          "new_text": "AllocationPool.load(std::memory_order_relaxed)",
          "old_line_content": "  (void)",
          "new_line_content": "  PoolRange curState = AllocationPool.load(std::memory_order_relaxed);",
          "content_same": false
        },
        {
          "line": 4073,
          "old_api": null,
          "new_api": "getMetadataInitialization",
          "old_text": null,
          "new_text": "description->getMetadataInitialization()",
          "old_line_content": "    }",
          "new_line_content": "    switch (description->getMetadataInitialization()) {",
          "content_same": false
        },
        {
          "line": 4075,
          "old_api": null,
          "new_api": "forOtherMetadata",
          "old_text": null,
          "new_text": "std::move(callbacks).forOtherMetadata(metadata)",
          "old_line_content": "  }",
          "new_line_content": "      return std::move(callbacks).forOtherMetadata(metadata);",
          "content_same": false
        },
        {
          "line": 4588,
          "old_api": null,
          "new_api": "const_cast<void*>(allocation)",
          "old_text": null,
          "new_text": "const_cast<void*>(allocation)",
          "old_line_content": "void *swift::allocateMetadata(size_t size, size_t alignment) {",
          "new_line_content": "  PoolRange newState = { reinterpret_cast<char*>(const_cast<void*>(allocation)),",
          "content_same": false
        },
        {
          "line": 4078,
          "old_api": null,
          "new_api": "forForeignMetadata",
          "old_text": null,
          "new_text": "std::move(callbacks).forForeignMetadata(metadata, description)",
          "old_line_content": "",
          "new_line_content": "      return std::move(callbacks).forForeignMetadata(metadata, description);",
          "content_same": false
        },
        {
          "line": 4591,
          "old_api": null,
          "new_api": "std::atomic_compare_exchange_strong_explicit(&AllocationPool,\n                                                 &curState, newState,\n                                                 std::memory_order_relaxed,\n                                                 std::memory_order_relaxed)",
          "old_text": null,
          "new_text": "std::atomic_compare_exchange_strong_explicit(&AllocationPool,\n                                                 &curState, newState,\n                                                 std::memory_order_relaxed,\n                                                 std::memory_order_relaxed)",
          "old_line_content": "",
          "new_line_content": "    std::atomic_compare_exchange_strong_explicit(&AllocationPool,",
          "content_same": false
        },
        {
          "line": 4598,
          "old_api": null,
          "new_api": "Allocate",
          "old_text": null,
          "new_text": "MetadataAllocator().Allocate(size, alignment)",
          "old_line_content": "  // or it's a class.",
          "new_line_content": "  return MetadataAllocator().Allocate(size, alignment);",
          "content_same": false
        },
        {
          "line": 4089,
          "old_api": null,
          "new_api": "getGenericArguments",
          "old_text": null,
          "new_text": "reinterpret_cast<const void * const *>(\n                                    description->getGenericArguments(metadata))",
          "old_line_content": "bool swift::addToMetadataQueue(MetadataCompletionQueueEntry *queueEntry,",
          "new_line_content": "    reinterpret_cast<const void * const *>(",
          "content_same": false
        },
        {
          "line": 4090,
          "old_api": null,
          "new_api": "getGenericArguments",
          "old_text": null,
          "new_text": "description->getGenericArguments(metadata)",
          "old_line_content": "                               MetadataDependency dependency) {",
          "new_line_content": "                                    description->getGenericArguments(metadata));",
          "content_same": false
        },
        {
          "line": 4092,
          "old_api": null,
          "new_api": "MetadataCacheKey",
          "old_text": null,
          "new_text": "MetadataCacheKey(genericArgs, numGenericArgs)",
          "old_line_content": "    MetadataCompletionQueueEntry *QueueEntry;",
          "new_line_content": "  auto key = MetadataCacheKey(genericArgs, numGenericArgs);",
          "content_same": false
        },
        {
          "line": 4605,
          "old_api": null,
          "new_api": "isObjC",
          "old_text": null,
          "new_text": "existential->isObjC()",
          "old_line_content": "    return true;",
          "new_line_content": "    return existential->isObjC();",
          "content_same": false
        },
        {
          "line": 4094,
          "old_api": null,
          "new_api": "forGenericMetadata",
          "old_text": null,
          "new_text": "std::move(callbacks).forGenericMetadata(metadata, description,\n                                                 getCache(generics), key)",
          "old_line_content": "",
          "new_line_content": "  return std::move(callbacks).forGenericMetadata(metadata, description,",
          "content_same": false
        },
        {
          "line": 4095,
          "old_api": null,
          "new_api": "getCache",
          "old_text": null,
          "new_text": "getCache(generics)",
          "old_line_content": "    bool forGenericMetadata(const Metadata *metadata,",
          "new_line_content": "                                                 getCache(generics), key);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 4099,
          "old_api": "enqueue",
          "new_api": null,
          "old_text": "cache.enqueue(key, QueueEntry, Dependency)",
          "new_text": null,
          "old_line_content": "      return cache.enqueue(key, QueueEntry, Dependency);",
          "new_line_content": "                               MetadataDependency dependency) {",
          "content_same": false
        },
        {
          "line": 4104,
          "old_api": "get",
          "new_api": null,
          "old_text": "ForeignMetadata.get().enqueue(description, QueueEntry, Dependency)",
          "new_text": null,
          "old_line_content": "      return ForeignMetadata.get().enqueue(description, QueueEntry, Dependency);",
          "new_line_content": "    bool forGenericMetadata(const Metadata *metadata,",
          "content_same": false
        },
        {
          "line": 4622,
          "old_api": "getenv",
          "new_api": null,
          "old_text": "getenv(\"SWIFT_ENABLE_MANGLED_NAME_VERIFICATION\")",
          "new_text": null,
          "old_line_content": "    SWIFT_LAZY_CONSTANT((bool)getenv(\"SWIFT_ENABLE_MANGLED_NAME_VERIFICATION\"));",
          "new_line_content": "void swift::verifyMangledNameRoundtrip(const Metadata *metadata) {",
          "content_same": false
        },
        {
          "line": 4112,
          "old_api": "get",
          "new_api": null,
          "old_text": "TupleTypes.get().enqueue(metadata, QueueEntry, Dependency)",
          "new_text": null,
          "old_line_content": "      return TupleTypes.get().enqueue(metadata, QueueEntry, Dependency);",
          "new_line_content": "                            const TypeContextDescriptor *description) {",
          "content_same": false
        },
        {
          "line": 4627,
          "old_api": "_swift_buildDemanglingForMetadata",
          "new_api": null,
          "old_text": "_swift_buildDemanglingForMetadata(metadata, Dem)",
          "new_text": null,
          "old_line_content": "  auto node = _swift_buildDemanglingForMetadata(metadata, Dem);",
          "new_line_content": "  // variable lets us easily turn on verification to find and fix these",
          "content_same": false
        },
        {
          "line": 4116,
          "old_api": "swift_runtime_unreachable",
          "new_api": null,
          "old_text": "swift_runtime_unreachable(\"metadata should always be complete\")",
          "new_text": null,
          "old_line_content": "      swift_runtime_unreachable(\"metadata should always be complete\");",
          "new_line_content": "    bool forSingletonMetadata(const TypeContextDescriptor *description) && {",
          "content_same": false
        },
        {
          "line": 4630,
          "old_api": "referencesAnonymousContext",
          "new_api": null,
          "old_text": "referencesAnonymousContext(node)",
          "new_text": null,
          "old_line_content": "  if (referencesAnonymousContext(node))",
          "new_line_content": "  bool verificationEnabled =",
          "content_same": false
        },
        {
          "line": 4120,
          "old_api": "std::move(callbacks)",
          "new_api": null,
          "old_text": "std::move(callbacks)",
          "new_text": null,
          "old_line_content": "  return performOnMetadataCache<bool>(dependency.Value, std::move(callbacks));",
          "new_line_content": "    bool forTupleMetadata(const TupleTypeMetadata *metadata) {",
          "content_same": false
        },
        {
          "line": 4633,
          "old_api": "Demangle::mangleNode(node)",
          "new_api": null,
          "old_text": "Demangle::mangleNode(node)",
          "new_text": null,
          "old_line_content": "  auto mangledName = Demangle::mangleNode(node);",
          "new_line_content": "  if (!verificationEnabled) return;",
          "content_same": false
        },
        {
          "line": 4634,
          "old_api": "_getTypeByMangledName",
          "new_api": null,
          "old_text": "_getTypeByMangledName(mangledName,\n                                      [](unsigned, unsigned){ return nullptr; })",
          "new_text": null,
          "old_line_content": "  auto result = _getTypeByMangledName(mangledName,",
          "new_line_content": "  ",
          "content_same": false
        },
        {
          "line": 4637,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "swift::warning(RuntimeErrorFlagNone,\n                   \"Metadata mangled name failed to roundtrip: %p -> %s -> %p\\n\",\n                   metadata, mangledName.c_str(), (const Metadata *)result)",
          "new_text": null,
          "old_line_content": "    swift::warning(RuntimeErrorFlagNone,",
          "new_line_content": "  // If the mangled node involves types in an AnonymousContext, then by design,",
          "content_same": false
        },
        {
          "line": 4131,
          "old_api": "resumeInitialization",
          "new_api": null,
          "old_text": "cache.resumeInitialization(key, QueueEntry)",
          "new_text": null,
          "old_line_content": "      cache.resumeInitialization(key, QueueEntry);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4644,
          "old_api": "getTypeContextDescriptor",
          "new_api": null,
          "old_text": "type->getTypeContextDescriptor()",
          "new_text": null,
          "old_line_content": "    return type->getTypeContextDescriptor();",
          "new_line_content": "                                      [](unsigned, unsigned){ return nullptr; });",
          "content_same": false
        },
        {
          "line": 4136,
          "old_api": "get",
          "new_api": null,
          "old_text": "ForeignMetadata.get().resumeInitialization(description, QueueEntry)",
          "new_text": null,
          "old_line_content": "      ForeignMetadata.get().resumeInitialization(description, QueueEntry);",
          "new_line_content": "    void forGenericMetadata(const Metadata *metadata,",
          "content_same": false
        },
        {
          "line": 4144,
          "old_api": "get",
          "new_api": null,
          "old_text": "TupleTypes.get().resumeInitialization(metadata, QueueEntry)",
          "new_text": null,
          "old_line_content": "      TupleTypes.get().resumeInitialization(metadata, QueueEntry);",
          "new_line_content": "                            const TypeContextDescriptor *description) {",
          "content_same": false
        },
        {
          "line": 4148,
          "old_api": "swift_runtime_unreachable",
          "new_api": null,
          "old_text": "swift_runtime_unreachable(\"metadata should always be complete\")",
          "new_text": null,
          "old_line_content": "      swift_runtime_unreachable(\"metadata should always be complete\");",
          "new_line_content": "    void forSingletonMetadata(const TypeContextDescriptor *description) && {",
          "content_same": false
        },
        {
          "line": 4166,
          "old_api": "await",
          "new_api": null,
          "old_text": "cache.await(key, Request)",
          "new_text": null,
          "old_line_content": "      return cache.await(key, Request);",
          "new_line_content": "                                                 const Metadata *type) {",
          "content_same": false
        },
        {
          "line": 4171,
          "old_api": "get",
          "new_api": null,
          "old_text": "ForeignMetadata.get().await(description, Request)",
          "new_text": null,
          "old_line_content": "      return ForeignMetadata.get().await(description, Request);",
          "new_line_content": "    MetadataResponse forGenericMetadata(const Metadata *type,",
          "content_same": false
        },
        {
          "line": 4176,
          "old_api": "get",
          "new_api": null,
          "old_text": "SingletonMetadata.get().await(description, Request)",
          "new_text": null,
          "old_line_content": "      return SingletonMetadata.get().await(description, Request);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4200,
          "old_api": "dyn_cast<ClassMetadata>(type)",
          "new_api": null,
          "old_text": "dyn_cast<ClassMetadata>(type)",
          "new_text": null,
          "old_line_content": "  if (auto classType = dyn_cast<ClassMetadata>(type)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4201,
          "old_api": "getDescription",
          "new_api": null,
          "old_text": "classType->getDescription()",
          "new_text": null,
          "old_line_content": "    description = classType->getDescription();",
          "new_line_content": "/// Search all the metadata that the given type has transitive completeness",
          "content_same": false
        },
        {
          "line": 4203,
          "old_api": "predicate",
          "new_api": null,
          "old_text": "predicate(super)",
          "new_text": null,
          "old_line_content": "      if (super->isTypeMetadata() && predicate(super))",
          "new_line_content": "template <class T>",
          "content_same": false
        },
        {
          "line": 4208,
          "old_api": "dyn_cast<ValueMetadata>(type)",
          "new_api": null,
          "old_text": "dyn_cast<ValueMetadata>(type)",
          "new_text": null,
          "old_line_content": "  } else if (auto valueType = dyn_cast<ValueMetadata>(type)) {",
          "new_line_content": "  // and they can be generic.",
          "content_same": false
        },
        {
          "line": 4214,
          "old_api": "getElement",
          "new_api": null,
          "old_text": "tupleType->getElement(i)",
          "new_text": null,
          "old_line_content": "      if (predicate(tupleType->getElement(i).Type))",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4220,
          "old_api": "dyn_cast<ForeignClassMetadata>(type)",
          "new_api": null,
          "old_text": "dyn_cast<ForeignClassMetadata>(type)",
          "new_text": null,
          "old_line_content": "  } else if (auto foreignClassType = dyn_cast<ForeignClassMetadata>(type)) {",
          "new_line_content": "  // Tuples require their element types to be transitively complete.",
          "content_same": false
        },
        {
          "line": 4222,
          "old_api": "predicate",
          "new_api": null,
          "old_text": "predicate(super)",
          "new_text": null,
          "old_line_content": "      if (predicate(super))",
          "new_line_content": "    for (size_t i = 0, e = tupleType->NumElements; i != e; ++i)",
          "content_same": false
        },
        {
          "line": 4233,
          "old_api": "isGeneric",
          "new_api": null,
          "old_text": "description->isGeneric()",
          "new_text": null,
          "old_line_content": "  if (description->isGeneric()) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4234,
          "old_api": "getFullGenericContextHeader",
          "new_api": null,
          "old_text": "description->getFullGenericContextHeader()",
          "new_text": null,
          "old_line_content": "    auto &generics = description->getFullGenericContextHeader();",
          "new_line_content": "    return false;",
          "content_same": false
        },
        {
          "line": 4236,
          "old_api": "getGenericArguments",
          "new_api": null,
          "old_text": "description->getGenericArguments(type)",
          "new_text": null,
          "old_line_content": "    auto keyArguments = description->getGenericArguments(type);",
          "new_line_content": "  // Other types do not have transitive completeness requirements.",
          "content_same": false
        },
        {
          "line": 4239,
          "old_api": "getGenericParams",
          "new_api": null,
          "old_text": "description->getGenericParams()",
          "new_text": null,
          "old_line_content": "    for (auto &param : description->getGenericParams()) {",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 4240,
          "old_api": "hasKeyArgument",
          "new_api": null,
          "old_text": "param.hasKeyArgument()",
          "new_text": null,
          "old_line_content": "      if (param.hasKeyArgument()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4241,
          "old_api": "predicate",
          "new_api": null,
          "old_text": "predicate(*keyArguments++)",
          "new_text": null,
          "old_line_content": "        if (predicate(*keyArguments++))",
          "new_line_content": "  // Generic types require their type arguments to be transitively complete.",
          "content_same": false
        },
        {
          "line": 4244,
          "old_api": "predicate",
          "new_api": null,
          "old_text": "predicate(*extraArguments++)",
          "new_text": null,
          "old_line_content": "        if (predicate(*extraArguments++))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4259,
          "old_api": "getForeignMetadataInitialization",
          "new_api": null,
          "old_text": "findAnyTransitiveMetadata(type, [](const Metadata *type) {\n    struct IsIncompleteCallbacks {\n      bool forGenericMetadata(const Metadata *type,\n                              const TypeContextDescriptor *description,\n                              GenericMetadataCache &cache,\n                              MetadataCacheKey key) && {\n        // Metadata cache lookups aren't really cheap enough for this\n        // optimization.\n        return true;\n      }\n\n      bool forForeignMetadata(const Metadata *metadata,\n                              const TypeContextDescriptor *description) {\n        // If the type doesn't have a completion function, we can assume\n        // it's transitively complete by construction.\n        if (!description->getForeignMetadataInitialization().CompletionFunction)\n          return false;\n\n        // TODO: it might be worth doing a quick check against the cache here.\n        return false;\n      }\n\n      bool forSingletonMetadata(const TypeContextDescriptor *description) && {\n        // TODO: this could be cheap enough.\n        return true;\n      }\n\n      bool forTupleMetadata(const TupleTypeMetadata *metadata) {\n        // TODO: this could be cheap enough.\n        return true;\n      }\n\n      bool forOtherMetadata(const Metadata *type) && {\n        return false;\n      }\n    } callbacks;\n\n    return performOnMetadataCache<bool>(type, std::move(callbacks));\n  })",
          "new_text": null,
          "old_line_content": "  return !findAnyTransitiveMetadata(type, [](const Metadata *type) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4274,
          "old_api": "getForeignMetadataInitialization",
          "new_api": null,
          "old_text": "description->getForeignMetadataInitialization()",
          "new_text": null,
          "old_line_content": "        if (!description->getForeignMetadataInitialization().CompletionFunction)",
          "new_line_content": "        // Metadata cache lookups aren't really cheap enough for this",
          "content_same": false
        },
        {
          "line": 4296,
          "old_api": "std::move(callbacks)",
          "new_api": null,
          "old_text": "std::move(callbacks)",
          "new_text": null,
          "old_line_content": "    return performOnMetadataCache<bool>(type, std::move(callbacks));",
          "new_line_content": "        // TODO: this could be cheap enough.",
          "content_same": false
        },
        {
          "line": 4322,
          "old_api": "insert",
          "new_api": null,
          "old_text": "presumedCompleteTypes.insert(type)",
          "new_text": null,
          "old_line_content": "    if (!presumedCompleteTypes.insert(type).second)",
          "new_line_content": "  // usually only add a handful of types to the map.",
          "content_same": false
        },
        {
          "line": 4326,
          "old_api": "MetadataRequest",
          "new_api": null,
          "old_text": "MetadataRequest(MetadataState::Complete,\n                                   /*non-blocking*/ true)",
          "new_text": null,
          "old_line_content": "    auto request = MetadataRequest(MetadataState::Complete,",
          "new_line_content": "  MetadataDependency dependency;",
          "content_same": false
        },
        {
          "line": 4328,
          "old_api": "swift_checkMetadataState",
          "new_api": null,
          "old_text": "swift_checkMetadataState(request, type)",
          "new_text": null,
          "old_line_content": "    auto state = swift_checkMetadataState(request, type).State;",
          "new_line_content": "    // Add the type to the presumed-complete-types set.  If this doesn't",
          "content_same": false
        },
        {
          "line": 4338,
          "old_api": "isAtLeast",
          "new_api": null,
          "old_text": "isAtLeast(state, MetadataState::NonTransitiveComplete)",
          "new_text": null,
          "old_line_content": "    if (!isAtLeast(state, MetadataState::NonTransitiveComplete)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4345,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "worklist.push_back(type)",
          "new_text": null,
          "old_line_content": "    worklist.push_back(type);",
          "new_line_content": "    // and leave.  We set the dependency at non-transitive completeness",
          "content_same": false
        },
        {
          "line": 4351,
          "old_api": "insert",
          "new_api": null,
          "old_text": "presumedCompleteTypes.insert(initialType)",
          "new_text": null,
          "old_line_content": "  presumedCompleteTypes.insert(initialType);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4352,
          "old_api": "findAnyTransitiveMetadata",
          "new_api": null,
          "old_text": "findAnyTransitiveMetadata(initialType, isIncomplete)",
          "new_text": null,
          "old_line_content": "  if (findAnyTransitiveMetadata(initialType, isIncomplete))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4357,
          "old_api": "empty",
          "new_api": null,
          "old_text": "worklist.empty()",
          "new_text": null,
          "old_line_content": "  while (!worklist.empty()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4358,
          "old_api": "back",
          "new_api": null,
          "old_text": "worklist.back()",
          "new_text": null,
          "old_line_content": "    auto type = worklist.back();",
          "new_line_content": "  // Consider the type itself to be presumed-complete.  We're looking for",
          "content_same": false
        },
        {
          "line": 4359,
          "old_api": "pop_back",
          "new_api": null,
          "old_text": "worklist.pop_back()",
          "new_text": null,
          "old_line_content": "    worklist.pop_back();",
          "new_line_content": "  // a greatest fixed point.",
          "content_same": false
        },
        {
          "line": 4363,
          "old_api": "findAnyTransitiveMetadata",
          "new_api": null,
          "old_text": "findAnyTransitiveMetadata(type, isIncomplete)",
          "new_text": null,
          "old_line_content": "    if (findAnyTransitiveMetadata(type, isIncomplete))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4375,
          "old_api": "back",
          "new_api": null,
          "old_text": "links.back()",
          "new_text": null,
          "old_line_content": "  assert(start == links.back().Value);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4379,
          "old_api": "nameForMetadata",
          "new_api": null,
          "old_text": "nameForMetadata(start)",
          "new_text": null,
          "old_line_content": "  diagnostic += nameForMetadata(start);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4383,
          "old_api": "size",
          "new_api": null,
          "old_text": "diagnostic.size()",
          "new_text": null,
          "old_line_content": "    if (diagnostic.size() >= 128 * 1024) {",
          "new_line_content": "                                            ArrayRef<MetadataDependency> links){",
          "content_same": false
        },
        {
          "line": 4405,
          "old_api": "nameForMetadata",
          "new_api": null,
          "old_text": "nameForMetadata(link.Value)",
          "new_text": null,
          "old_line_content": "    diagnostic += nameForMetadata(link.Value);",
          "new_line_content": "      break;",
          "content_same": false
        },
        {
          "line": 4410,
          "old_api": "_swift_shouldReportFatalErrorsToDebugger",
          "new_api": null,
          "old_text": "_swift_shouldReportFatalErrorsToDebugger()",
          "new_text": null,
          "old_line_content": "  if (_swift_shouldReportFatalErrorsToDebugger()) {",
          "new_line_content": "      diagnostic += \"<corruption> of \";",
          "content_same": false
        },
        {
          "line": 4423,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "diagnostic.c_str()",
          "new_text": null,
          "old_line_content": "    _swift_reportToDebugger(RuntimeErrorFlagFatal, diagnostic.c_str(),",
          "new_line_content": "      .version = RuntimeErrorDetails::currentVersion,",
          "content_same": false
        },
        {
          "line": 4427,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "diagnostic.c_str()",
          "new_text": null,
          "old_line_content": "  fatalError(0, diagnostic.c_str());",
          "new_line_content": "      .memoryAddress = start",
          "content_same": false
        },
        {
          "line": 4440,
          "old_api": "checkDependency",
          "new_api": null,
          "old_text": "cache.checkDependency(key, Requirement)",
          "new_text": null,
          "old_line_content": "      return cache.checkDependency(key, Requirement);",
          "new_line_content": "/// return its current dependency, if one exists.",
          "content_same": false
        },
        {
          "line": 4445,
          "old_api": "get",
          "new_api": null,
          "old_text": "ForeignMetadata.get().checkDependency(description, Requirement)",
          "new_text": null,
          "old_line_content": "      return ForeignMetadata.get().checkDependency(description, Requirement);",
          "new_line_content": "    MetadataDependency forGenericMetadata(const Metadata *type,",
          "content_same": false
        },
        {
          "line": 4450,
          "old_api": "get",
          "new_api": null,
          "old_text": "SingletonMetadata.get().checkDependency(description, Requirement)",
          "new_text": null,
          "old_line_content": "      return SingletonMetadata.get().checkDependency(description, Requirement);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4458,
          "old_api": "MetadataDependency",
          "new_api": null,
          "old_text": "MetadataDependency()",
          "new_text": null,
          "old_line_content": "      return MetadataDependency();",
          "new_line_content": "                              const TypeContextDescriptor *description) && {",
          "content_same": false
        },
        {
          "line": 4462,
          "old_api": "performOnMetadataCache<MetadataDependency>(dependency.Value,\n                                                    std::move(callbacks))",
          "new_api": null,
          "old_text": "performOnMetadataCache<MetadataDependency>(dependency.Value,\n                                                    std::move(callbacks))",
          "new_text": null,
          "old_line_content": "  return performOnMetadataCache<MetadataDependency>(dependency.Value,",
          "new_line_content": "    MetadataDependency forTupleMetadata(const TupleTypeMetadata *metadata) {",
          "content_same": false
        },
        {
          "line": 4474,
          "old_api": "diagnoseMetadataDependencyCycle",
          "new_api": null,
          "old_text": "diagnoseMetadataDependencyCycle(startMetadata, links)",
          "new_text": null,
          "old_line_content": "      diagnoseMetadataDependencyCycle(startMetadata, links);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4475,
          "old_api": "end",
          "new_api": null,
          "old_text": "links.end()",
          "new_text": null,
          "old_line_content": "    for (auto i = links.begin(), e = links.end() - 1; i != e; ++i) {",
          "new_line_content": "/// Check for an unbreakable metadata-dependency cycle.",
          "content_same": false
        },
        {
          "line": 4478,
          "old_api": "end",
          "new_api": null,
          "old_text": "diagnoseMetadataDependencyCycle(i->Value,\n                                llvm::makeArrayRef(&*next, links.end() - next))",
          "new_text": null,
          "old_line_content": "        diagnoseMetadataDependencyCycle(i->Value,",
          "new_line_content": "                                         MetadataDependency secondLink) {",
          "content_same": false
        },
        {
          "line": 4479,
          "old_api": "end",
          "new_api": null,
          "old_text": "links.end()",
          "new_text": null,
          "old_line_content": "                                llvm::makeArrayRef(&*next, links.end() - next));",
          "new_line_content": "  std::vector<MetadataDependency> links;",
          "content_same": false
        },
        {
          "line": 3971,
          "old_api": "swift_checkMetadataState",
          "new_api": null,
          "old_text": "swift_checkMetadataState(request, (const Metadata *)witness)",
          "new_text": null,
          "old_line_content": "    return swift_checkMetadataState(request, (const Metadata *)witness);",
          "new_line_content": "    // Cached metadata pointers are always complete.",
          "content_same": false
        },
        {
          "line": 4485,
          "old_api": "checkNewLink",
          "new_api": null,
          "old_text": "checkNewLink(secondLink)",
          "new_text": null,
          "old_line_content": "  checkNewLink(secondLink);",
          "new_line_content": "      if (i->Value == newLink.Value) {",
          "content_same": false
        },
        {
          "line": 4489,
          "old_api": "checkNewLink",
          "new_api": null,
          "old_text": "checkNewLink(newLink)",
          "new_text": null,
          "old_line_content": "    checkNewLink(newLink);",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 4499,
          "old_api": "constexpr",
          "new_api": null,
          "old_text": "constexpr",
          "new_text": null,
          "old_line_content": "    static constexpr uintptr_t PageSize = 16 * 1024;",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 4500,
          "old_api": "constexpr",
          "new_api": null,
          "old_text": "constexpr",
          "new_text": null,
          "old_line_content": "    static constexpr uintptr_t MaxPoolAllocationSize = PageSize / 2;",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 3990,
          "old_api": "Demangle::makeSymbolicMangledNameStringRef(mangledNameBase)",
          "new_api": null,
          "old_text": "Demangle::makeSymbolicMangledNameStringRef(mangledNameBase)",
          "new_text": null,
          "old_line_content": "    Demangle::makeSymbolicMangledNameStringRef(mangledNameBase);",
          "new_line_content": "  StringRef mangledName =",
          "content_same": false
        },
        {
          "line": 3998,
          "old_api": "_getTypeByMangledName",
          "new_api": null,
          "old_text": "_getTypeByMangledName(mangledName,\n         [conformingType](unsigned depth, unsigned index) -> const Metadata * {\n        if (depth == 0 && index == 0)\n          return conformingType;\n\n        return nullptr;\n      })",
          "new_text": null,
          "old_line_content": "      _getTypeByMangledName(mangledName,",
          "new_line_content": "    assocTypeMetadata =",
          "content_same": false
        },
        {
          "line": 4518,
          "old_api": "alignof",
          "new_api": null,
          "old_text": "alignof(void*)",
          "new_text": null,
          "old_line_content": "  assert(alignment <= alignof(void*));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4519,
          "old_api": "alignof",
          "new_api": null,
          "old_text": "alignof(void*)",
          "new_text": null,
          "old_line_content": "  assert(size % alignof(void*) == 0);",
          "new_line_content": "// A statically-allocated pool.  It's zero-initialized, so this",
          "content_same": false
        },
        {
          "line": 4523,
          "old_api": "malloc",
          "new_api": null,
          "old_text": "malloc(size)",
          "new_text": null,
          "old_line_content": "    return malloc(size);",
          "new_line_content": "AllocationPool{PoolRange{InitialAllocationPool,",
          "content_same": false
        },
        {
          "line": 4011,
          "old_api": "findConformingSuperclass",
          "new_api": null,
          "old_text": "findConformingSuperclass(conformingType,\n                                                           protocol)",
          "new_text": null,
          "old_line_content": "    auto originalConformingType = findConformingSuperclass(conformingType,",
          "new_line_content": "    // type that specified the conformance.",
          "content_same": false
        },
        {
          "line": 4526,
          "old_api": "load",
          "new_api": null,
          "old_text": "AllocationPool.load(std::memory_order_relaxed)",
          "new_text": null,
          "old_line_content": "  PoolRange curState = AllocationPool.load(std::memory_order_relaxed);",
          "new_line_content": "void *MetadataAllocator::Allocate(size_t size, size_t alignment) {",
          "content_same": false
        },
        {
          "line": 4014,
          "old_api": "_getTypeByMangledName",
          "new_api": null,
          "old_text": "_getTypeByMangledName(mangledName, substitutions)",
          "new_text": null,
          "old_line_content": "    assocTypeMetadata = _getTypeByMangledName(mangledName, substitutions);",
          "new_line_content": "    SubstGenericParametersFromMetadata substitutions(originalConformingType);",
          "content_same": false
        },
        {
          "line": 4018,
          "old_api": "swift_getTypeName",
          "new_api": null,
          "old_text": "swift_getTypeName(conformingType, true)",
          "new_text": null,
          "old_line_content": "    auto conformingTypeNameInfo = swift_getTypeName(conformingType, true);",
          "new_line_content": "  if (!assocTypeMetadata) {",
          "content_same": false
        },
        {
          "line": 4021,
          "old_api": "findAssociatedTypeName",
          "new_api": null,
          "old_text": "findAssociatedTypeName(protocol, assocType)",
          "new_text": null,
          "old_line_content": "    StringRef assocTypeName = findAssociatedTypeName(protocol, assocType);",
          "new_line_content": "                                 conformingTypeNameInfo.length);",
          "content_same": false
        },
        {
          "line": 4025,
          "old_api": "str",
          "new_api": null,
          "old_text": "assocTypeName.str().c_str()",
          "new_text": null,
          "old_line_content": "               assocTypeName.str().c_str(),",
          "new_line_content": "               \"conformance '%s: %s' from mangled name '%s'\\n\",",
          "content_same": false
        },
        {
          "line": 4541,
          "old_api": "__asan_poison_memory_region",
          "new_api": null,
          "old_text": "__asan_poison_memory_region(allocation, PoolRange::PageSize)",
          "new_text": null,
          "old_line_content": "      __asan_poison_memory_region(allocation, PoolRange::PageSize);",
          "new_line_content": "    // Try to allocate out of the current page.",
          "content_same": false
        },
        {
          "line": 4032,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert((uintptr_t(assocTypeMetadata) &\n            ProtocolRequirementFlags::AssociatedTypeMangledNameBit) == 0)",
          "new_text": null,
          "old_line_content": "  assert((uintptr_t(assocTypeMetadata) &",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4545,
          "old_api": "std::atomic_compare_exchange_weak_explicit(&AllocationPool,\n                                                   &curState, newState,\n                                              std::memory_order_relaxed,\n                                              std::memory_order_relaxed)",
          "new_api": null,
          "old_text": "std::atomic_compare_exchange_weak_explicit(&AllocationPool,\n                                                   &curState, newState,\n                                              std::memory_order_relaxed,\n                                              std::memory_order_relaxed)",
          "new_text": null,
          "old_line_content": "    if (std::atomic_compare_exchange_weak_explicit(&AllocationPool,",
          "new_line_content": "      newState = PoolRange{curState.Begin + size, curState.Remaining - size};",
          "content_same": false
        },
        {
          "line": 4034,
          "old_api": "reinterpret_cast<const void**>(wtable)",
          "new_api": null,
          "old_text": "reinterpret_cast<const void**>(wtable)",
          "new_text": null,
          "old_line_content": "  reinterpret_cast<const void**>(wtable)[witnessIndex] = assocTypeMetadata;",
          "new_line_content": "            ProtocolRequirementFlags::AssociatedTypeMangledNameBit) == 0);",
          "content_same": false
        },
        {
          "line": 4035,
          "old_api": "swift_checkMetadataState",
          "new_api": null,
          "old_text": "swift_checkMetadataState(request, assocTypeMetadata)",
          "new_text": null,
          "old_line_content": "  return swift_checkMetadataState(request, assocTypeMetadata);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4551,
          "old_api": "__asan_unpoison_memory_region",
          "new_api": null,
          "old_text": "__asan_unpoison_memory_region(allocation, size)",
          "new_text": null,
          "old_line_content": "      __asan_unpoison_memory_region(allocation, size);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4047,
          "old_api": "dyn_cast<ClassMetadata>(metadata)",
          "new_api": null,
          "old_text": "dyn_cast<ClassMetadata>(metadata)",
          "new_text": null,
          "old_line_content": "  if (auto classMetadata = dyn_cast<ClassMetadata>(metadata)) {",
          "new_line_content": "/***************************************************************************/",
          "content_same": false
        },
        {
          "line": 4048,
          "old_api": "getDescription",
          "new_api": null,
          "old_text": "classMetadata->getDescription()",
          "new_text": null,
          "old_line_content": "    description = classMetadata->getDescription();",
          "new_line_content": "/*** Recursive metadata dependencies ***************************************/",
          "content_same": false
        },
        {
          "line": 4049,
          "old_api": "dyn_cast<ValueMetadata>(metadata)",
          "new_api": null,
          "old_text": "dyn_cast<ValueMetadata>(metadata)",
          "new_text": null,
          "old_line_content": "  } else if (auto valueMetadata = dyn_cast<ValueMetadata>(metadata)) {",
          "new_line_content": "/***************************************************************************/",
          "content_same": false
        },
        {
          "line": 4050,
          "old_api": "getDescription",
          "new_api": null,
          "old_text": "valueMetadata->getDescription()",
          "new_text": null,
          "old_line_content": "    description = valueMetadata->getDescription();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4563,
          "old_api": "__asan_poison_memory_region",
          "new_api": null,
          "old_text": "__asan_poison_memory_region(allocation, size)",
          "new_text": null,
          "old_line_content": "  __asan_poison_memory_region(allocation, size);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4051,
          "old_api": "dyn_cast<TupleTypeMetadata>(metadata)",
          "new_api": null,
          "old_text": "dyn_cast<TupleTypeMetadata>(metadata)",
          "new_text": null,
          "old_line_content": "  } else if (auto tupleMetadata = dyn_cast<TupleTypeMetadata>(metadata)) {",
          "new_line_content": "template <class Result, class Callbacks>",
          "content_same": false
        },
        {
          "line": 4566,
          "old_api": "const_cast<void*>(allocation)",
          "new_api": null,
          "old_text": "const_cast<void*>(allocation)",
          "new_text": null,
          "old_line_content": "    free(const_cast<void*>(allocation));",
          "new_line_content": "      delete[] allocation;",
          "content_same": false
        },
        {
          "line": 4054,
          "old_api": "forOtherMetadata",
          "new_api": null,
          "old_text": "std::move(callbacks).forOtherMetadata(tupleMetadata)",
          "new_text": null,
          "old_line_content": "      return std::move(callbacks).forOtherMetadata(tupleMetadata);",
          "new_line_content": "  // Handle different kinds of type that can delay their metadata.",
          "content_same": false
        },
        {
          "line": 4055,
          "old_api": "forTupleMetadata",
          "new_api": null,
          "old_text": "std::move(callbacks).forTupleMetadata(tupleMetadata)",
          "new_text": null,
          "old_line_content": "    return std::move(callbacks).forTupleMetadata(tupleMetadata);",
          "new_line_content": "  const TypeContextDescriptor *description;",
          "content_same": false
        },
        {
          "line": 4573,
          "old_api": "reinterpret_cast<const char*>(allocation)",
          "new_api": null,
          "old_text": "reinterpret_cast<const char*>(allocation)",
          "new_text": null,
          "old_line_content": "  if (reinterpret_cast<const char*>(allocation) + size != curState.Begin) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4579,
          "old_api": "const_cast<void*>(allocation)",
          "new_api": null,
          "old_text": "const_cast<void*>(allocation)",
          "new_text": null,
          "old_line_content": "  PoolRange newState = { reinterpret_cast<char*>(const_cast<void*>(allocation)),",
          "new_line_content": "  // Check whether the allocation pool is still in the state it was in",
          "content_same": false
        },
        {
          "line": 4074,
          "old_api": "swift_runtime_unreachable",
          "new_api": null,
          "old_text": "swift_runtime_unreachable(\"bad metadata initialization kind\")",
          "new_text": null,
          "old_line_content": "    swift_runtime_unreachable(\"bad metadata initialization kind\");",
          "new_line_content": "    case TypeContextDescriptorFlags::NoMetadataInitialization:",
          "content_same": false
        },
        {
          "line": 4589,
          "old_api": "Allocate",
          "new_api": null,
          "old_text": "MetadataAllocator().Allocate(size, alignment)",
          "new_text": null,
          "old_line_content": "  return MetadataAllocator().Allocate(size, alignment);",
          "new_line_content": "                         curState.Remaining + size };",
          "content_same": false
        },
        {
          "line": 4077,
          "old_api": "getFullGenericContextHeader",
          "new_api": null,
          "old_text": "description->getFullGenericContextHeader()",
          "new_text": null,
          "old_line_content": "  auto &generics = description->getFullGenericContextHeader();",
          "new_line_content": "    case TypeContextDescriptorFlags::ForeignMetadataInitialization:",
          "content_same": false
        },
        {
          "line": 4080,
          "old_api": "getGenericArguments",
          "new_api": null,
          "old_text": "reinterpret_cast<const void * const *>(\n                                    description->getGenericArguments(metadata))",
          "new_text": null,
          "old_line_content": "    reinterpret_cast<const void * const *>(",
          "new_line_content": "    case TypeContextDescriptorFlags::SingletonMetadataInitialization:",
          "content_same": false
        },
        {
          "line": 4595,
          "old_api": "dyn_cast<ExistentialTypeMetadata>(this)",
          "new_api": null,
          "old_text": "dyn_cast<ExistentialTypeMetadata>(this)",
          "new_text": null,
          "old_line_content": "  if (auto *existential = dyn_cast<ExistentialTypeMetadata>(this))",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 4596,
          "old_api": "isObjC",
          "new_api": null,
          "old_text": "existential->isObjC()",
          "new_text": null,
          "old_line_content": "    return existential->isObjC();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4085,
          "old_api": "forGenericMetadata",
          "new_api": null,
          "old_text": "std::move(callbacks).forGenericMetadata(metadata, description,\n                                                 getCache(generics), key)",
          "new_text": null,
          "old_line_content": "  return std::move(callbacks).forGenericMetadata(metadata, description,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4599,
          "old_api": "isAnyClass",
          "new_api": null,
          "old_text": "isAnyClass()",
          "new_text": null,
          "old_line_content": "  return isAnyClass();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 4606,
          "old_api": "getNumChildren",
          "new_api": null,
          "old_text": "node->getNumChildren()",
          "new_text": null,
          "old_line_content": "  for (unsigned i = 0, e = node->getNumChildren(); i < e; ++i)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4607,
          "old_api": "getChild",
          "new_api": null,
          "old_text": "node->getChild(i)",
          "new_text": null,
          "old_line_content": "    if (referencesAnonymousContext(node->getChild(i)))",
          "new_line_content": "  // or it's a class.",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 31,
      "total_additions": 105,
      "total_deletions": 106,
      "total_api_changes": 242
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 15,
        "api_related_lines": 242,
        "non_api_lines": 9,
        "non_api_line_numbers": [
          4036,
          3972,
          4038,
          4039,
          4040,
          4042,
          4043,
          4044,
          4031
        ]
      }
    },
    "api_calls_before": 1157,
    "api_calls_after": 1156,
    "diff_info": {
      "added_lines": 13,
      "removed_lines": 4,
      "total_diff_lines": 38
    }
  }
}