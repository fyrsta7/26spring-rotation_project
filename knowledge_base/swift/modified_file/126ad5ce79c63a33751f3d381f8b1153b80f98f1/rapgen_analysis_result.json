{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/126ad5ce79c63a33751f3d381f8b1153b80f98f1",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/126ad5ce79c63a33751f3d381f8b1153b80f98f1/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/126ad5ce79c63a33751f3d381f8b1153b80f98f1/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/126ad5ce79c63a33751f3d381f8b1153b80f98f1/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 185,
          "old_api": "findBufferContainingLoc",
          "new_api": "rangeContainsTokenLoc",
          "old_text": "sourceMgr.findBufferContainingLoc(parentRange.Start)",
          "new_text": "sourceMgr.rangeContainsTokenLoc(parentRange, childLoc)",
          "old_line_content": "  auto parentBuffer = sourceMgr.findBufferContainingLoc(parentRange.Start);",
          "new_line_content": "  if (sourceMgr.rangeContainsTokenLoc(parentRange, childLoc))",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "getGeneratedSourceInfo",
          "new_api": "findBufferContainingLoc",
          "old_text": "sourceMgr.getGeneratedSourceInfo(childBuffer)",
          "new_text": "sourceMgr.findBufferContainingLoc(childLoc)",
          "old_line_content": "    auto info = sourceMgr.getGeneratedSourceInfo(childBuffer);",
          "new_line_content": "  auto childBuffer = sourceMgr.findBufferContainingLoc(childLoc);",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": "findBufferContainingLoc",
          "new_api": "isInvalid",
          "old_text": "sourceMgr.findBufferContainingLoc(childLoc)",
          "new_text": "childLoc.isInvalid()",
          "old_line_content": "    childBuffer = sourceMgr.findBufferContainingLoc(childLoc);",
          "new_line_content": "    if (childLoc.isInvalid())",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": "rangeContainsTokenLoc",
          "new_api": "findBufferContainingLoc",
          "old_text": "sourceMgr.rangeContainsTokenLoc(parentRange, childLoc)",
          "new_text": "sourceMgr.findBufferContainingLoc(childLoc)",
          "old_line_content": "  return sourceMgr.rangeContainsTokenLoc(parentRange, childLoc);",
          "new_line_content": "    childBuffer = sourceMgr.findBufferContainingLoc(childLoc);",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": "rangeContainsTokenLocWithGeneratedSource",
          "new_api": "isValid",
          "old_text": "rangeContainsTokenLocWithGeneratedSource(Ctx.SourceMgr, SrcRange, Loc)",
          "new_text": "Loc.isValid()",
          "old_line_content": "      !rangeContainsTokenLocWithGeneratedSource(Ctx.SourceMgr, SrcRange, Loc))",
          "new_line_content": "  assert(Loc.isValid());",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "evaluateOrDefault",
          "new_api": "rangeContainsTokenLocWithGeneratedSource",
          "old_text": "evaluateOrDefault(\n      Ctx.evaluator, ExpandChildTypeRefinementContextsRequest{this}, {})",
          "new_text": "rangeContainsTokenLocWithGeneratedSource(Ctx.SourceMgr, SrcRange, Loc)",
          "old_line_content": "  auto expandedChildren = evaluateOrDefault(",
          "new_line_content": "      !rangeContainsTokenLocWithGeneratedSource(Ctx.SourceMgr, SrcRange, Loc))",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": "getAsDecl",
          "new_api": "getReason",
          "old_text": "Node.getAsDecl()->getLoc()",
          "new_text": "getReason()",
          "old_line_content": "    return Node.getAsDecl()->getLoc();",
          "new_line_content": "  switch (getReason()) {",
          "content_same": false
        },
        {
          "line": 247,
          "old_api": "getAsPoundAvailableInfo",
          "new_api": "getAsIfStmt",
          "old_text": "Node.getAsPoundAvailableInfo()->getStartLoc()",
          "new_text": "Node.getAsIfStmt()->getIfLoc()",
          "old_line_content": "    return Node.getAsPoundAvailableInfo()->getStartLoc();",
          "new_line_content": "    return Node.getAsIfStmt()->getIfLoc();",
          "content_same": false
        },
        {
          "line": 258,
          "old_api": "SourceLoc",
          "new_api": "getAsWhileStmt",
          "old_text": "SourceLoc()",
          "new_text": "Node.getAsWhileStmt()->getStartLoc()",
          "old_line_content": "    return SourceLoc();",
          "new_line_content": "    return Node.getAsWhileStmt()->getStartLoc();",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": "llvm_unreachable",
          "new_api": "SourceLoc",
          "old_text": "llvm_unreachable(\"Unhandled Reason in switch.\")",
          "new_text": "SourceLoc()",
          "old_line_content": "  llvm_unreachable(\"Unhandled Reason in switch.\");",
          "new_line_content": "    return SourceLoc();",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": "isValid",
          "new_api": "dyn_cast<PlatformVersionConstraintAvailabilitySpec>(S)",
          "old_text": "Range.isValid()",
          "new_text": "dyn_cast<PlatformVersionConstraintAvailabilitySpec>(S)",
          "old_line_content": "        if (Range.isValid())",
          "new_line_content": "    if (auto *V = dyn_cast<PlatformVersionConstraintAvailabilitySpec>(S)) {",
          "content_same": false
        },
        {
          "line": 274,
          "old_api": "SourceRange",
          "new_api": "getVersion",
          "old_text": "SourceRange()",
          "new_text": "V->getVersion()",
          "old_line_content": "          return SourceRange();",
          "new_line_content": "      if (V->getPlatform() == Platform && V->getVersion() == Version) {",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": "getVersionSrcRange",
          "new_api": "isValid",
          "old_text": "V->getVersionSrcRange()",
          "new_text": "Range.isValid()",
          "old_line_content": "          Range = V->getVersionSrcRange();",
          "new_line_content": "        if (Range.isValid())",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": "isValid",
          "new_api": "getAvailability",
          "old_text": "Range.isValid()",
          "new_text": "getAvailabilityConditionVersionSourceRange(\n        C.getAvailability(), Platform, Version)",
          "old_line_content": "      if (Range.isValid())",
          "new_line_content": "      SourceRange R = getAvailabilityConditionVersionSourceRange(",
          "content_same": false
        },
        {
          "line": 295,
          "old_api": "SourceRange",
          "new_api": "getAvailability",
          "old_text": "SourceRange()",
          "new_text": "C.getAvailability()",
          "old_line_content": "        return SourceRange();",
          "new_line_content": "        C.getAvailability(), Platform, Version);",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": "getAsDecl",
          "new_api": "getReason",
          "old_text": "Node.getAsDecl()->getAttrs()",
          "new_text": "getReason()",
          "old_line_content": "      Node.getAsDecl()->getAttrs(), Platform, Version);",
          "new_line_content": "  switch (getReason()) {",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": "getAsPoundAvailableInfo",
          "new_api": "getAsIfStmt",
          "old_text": "::getAvailabilityConditionVersionSourceRange(\n      Node.getAsPoundAvailableInfo(), Platform, Version)",
          "new_text": "Node.getAsIfStmt()->getCond()",
          "old_line_content": "    return ::getAvailabilityConditionVersionSourceRange(",
          "new_line_content": "      Node.getAsIfStmt()->getCond(), Platform, Version);",
          "content_same": false
        },
        {
          "line": 349,
          "old_api": "getAsWhileStmt",
          "new_api": "getAsGuardStmt",
          "old_text": "::getAvailabilityConditionVersionSourceRange(\n      Node.getAsWhileStmt()->getCond(), Platform, Version)",
          "new_text": "Node.getAsGuardStmt()->getCond()",
          "old_line_content": "    return ::getAvailabilityConditionVersionSourceRange(",
          "new_line_content": "      Node.getAsGuardStmt()->getCond(), Platform, Version);",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": "llvm_unreachable",
          "new_api": "SourceRange",
          "old_text": "llvm_unreachable(\"Unhandled Reason in switch.\")",
          "new_text": "SourceRange()",
          "old_line_content": "  llvm_unreachable(\"Unhandled Reason in switch.\");",
          "new_line_content": "    return SourceRange();",
          "content_same": false
        },
        {
          "line": 365,
          "old_api": "getOSVersion",
          "new_api": "indent",
          "old_text": "AvailabilityInfo.getOSVersion().getAsString()",
          "new_text": "OS.indent(Indent)",
          "old_line_content": "  OS << \" versions=\" << AvailabilityInfo.getOSVersion().getAsString();",
          "new_line_content": "  OS.indent(Indent);",
          "content_same": false
        },
        {
          "line": 368,
          "old_api": "getAsDecl",
          "new_api": "getOSVersion",
          "old_text": "Node.getAsDecl()",
          "new_text": "AvailabilityInfo.getOSVersion().getAsString()",
          "old_line_content": "    Decl *D = Node.getAsDecl();",
          "new_line_content": "  OS << \" versions=\" << AvailabilityInfo.getOSVersion().getAsString();",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": "dyn_cast<ValueDecl>(D)",
          "new_api": "getReason",
          "old_text": "dyn_cast<ValueDecl>(D)",
          "new_text": "getReason()",
          "old_line_content": "    if (auto VD = dyn_cast<ValueDecl>(D)) {",
          "new_line_content": "  if (getReason() == Reason::Decl || getReason() == Reason::DeclImplicit) {",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": "getName",
          "new_api": "getAsDecl",
          "old_text": "VD->getName()",
          "new_text": "Node.getAsDecl()",
          "old_line_content": "      OS << VD->getName();",
          "new_line_content": "    Decl *D = Node.getAsDecl();",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": "getString",
          "new_api": "dyn_cast<ValueDecl>(D)",
          "old_text": "ED->getExtendedType().getString()",
          "new_text": "dyn_cast<ValueDecl>(D)",
          "old_line_content": "      OS << \"extension.\" << ED->getExtendedType().getString();",
          "new_line_content": "    if (auto VD = dyn_cast<ValueDecl>(D)) {",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": "isa<TopLevelCodeDecl>(D)",
          "new_api": "getName",
          "old_text": "isa<TopLevelCodeDecl>(D)",
          "new_text": "VD->getName()",
          "old_line_content": "    } else if (isa<TopLevelCodeDecl>(D)) {",
          "new_line_content": "      OS << VD->getName();",
          "content_same": false
        },
        {
          "line": 376,
          "old_api": "dyn_cast<PatternBindingDecl>(D)",
          "new_api": "getString",
          "old_text": "dyn_cast<PatternBindingDecl>(D)",
          "new_text": "ED->getExtendedType().getString()",
          "old_line_content": "    } else if (auto PBD = dyn_cast<PatternBindingDecl>(D)) {",
          "new_line_content": "      OS << \"extension.\" << ED->getExtendedType().getString();",
          "content_same": false
        },
        {
          "line": 377,
          "old_api": "getAnchoringVarDecl",
          "new_api": "isa<TopLevelCodeDecl>(D)",
          "old_text": "PBD->getAnchoringVarDecl(0)",
          "new_text": "isa<TopLevelCodeDecl>(D)",
          "old_line_content": "      if (auto VD = PBD->getAnchoringVarDecl(0)) {",
          "new_line_content": "    } else if (isa<TopLevelCodeDecl>(D)) {",
          "content_same": false
        },
        {
          "line": 386,
          "old_api": "print",
          "new_api": "getSourceRange",
          "old_text": "R.print(OS, SrcMgr, /*PrintText=*/false)",
          "new_text": "getSourceRange()",
          "old_line_content": "    R.print(OS, SrcMgr, /*PrintText=*/false);",
          "new_line_content": "  auto R = getSourceRange();",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": "isAlwaysAvailable",
          "new_api": "print",
          "old_text": "ExplicitAvailabilityInfo.isAlwaysAvailable()",
          "new_text": "R.print(OS, SrcMgr, /*PrintText=*/false)",
          "old_line_content": "  if (!ExplicitAvailabilityInfo.isAlwaysAvailable())",
          "new_line_content": "    R.print(OS, SrcMgr, /*PrintText=*/false);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 387,
          "old_api": null,
          "new_api": "isValid",
          "old_text": null,
          "new_text": "R.isValid()",
          "old_line_content": "  }",
          "new_line_content": "  if (R.isValid()) {",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": null,
          "new_api": "llvm_unreachable",
          "old_text": null,
          "new_text": "llvm_unreachable(\"Unhandled Reason in switch.\")",
          "old_line_content": "static SourceRange",
          "new_line_content": "  llvm_unreachable(\"Unhandled Reason in switch.\");",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": null,
          "new_api": "isAlwaysAvailable",
          "old_text": null,
          "new_text": "ExplicitAvailabilityInfo.isAlwaysAvailable()",
          "old_line_content": "",
          "new_line_content": "  if (!ExplicitAvailabilityInfo.isAlwaysAvailable())",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": null,
          "new_api": "getOSVersion",
          "old_text": null,
          "new_text": "ExplicitAvailabilityInfo.getOSVersion().getAsString()",
          "old_line_content": "    OS << '\\n';",
          "new_line_content": "       << ExplicitAvailabilityInfo.getOSVersion().getAsString();",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": null,
          "new_api": "print",
          "old_text": null,
          "new_text": "Child->print(OS, SrcMgr, Indent + 2)",
          "old_line_content": "  OS << \")\";",
          "new_line_content": "    Child->print(OS, SrcMgr, Indent + 2);",
          "content_same": false
        },
        {
          "line": 272,
          "old_api": null,
          "new_api": "getQueries",
          "old_text": null,
          "new_text": "PAI->getQueries()",
          "old_line_content": "        // More than one: return invalid range, no unique choice.",
          "new_line_content": "  for (auto *S : PAI->getQueries()) {",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": null,
          "new_api": "indent",
          "old_text": null,
          "new_text": "OS.indent(Indent)",
          "old_line_content": "",
          "new_line_content": "  OS.indent(Indent);",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": null,
          "new_api": "SourceRange",
          "old_text": null,
          "new_text": "SourceRange()",
          "old_line_content": "      }",
          "new_line_content": "          return SourceRange();",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": null,
          "new_api": "getReason",
          "old_text": null,
          "new_text": "Node.getReason()",
          "old_line_content": "StringRef TypeRefinementContext::getReasonName(Reason R) {",
          "new_line_content": "  return Node.getReason();",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": null,
          "new_api": "getVersionSrcRange",
          "old_text": null,
          "new_text": "V->getVersionSrcRange()",
          "old_line_content": "  }",
          "new_line_content": "          Range = V->getVersionSrcRange();",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": null,
          "new_api": "getKind",
          "old_text": null,
          "new_text": "C.getKind()",
          "old_line_content": "      // More than one: return invalid range.",
          "new_line_content": "    if (C.getKind() == StmtConditionElement::CK_Availability) {",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": null,
          "new_api": "isValid",
          "old_text": null,
          "new_text": "Range.isValid()",
          "old_line_content": "        Range = R;",
          "new_line_content": "      if (Range.isValid())",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": null,
          "new_api": "SourceRange",
          "old_text": null,
          "new_text": "SourceRange()",
          "old_line_content": "    }",
          "new_line_content": "        return SourceRange();",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": null,
          "new_api": "llvm_unreachable",
          "old_text": null,
          "new_text": "llvm_unreachable(\"Unhandled Reason in switch.\")",
          "old_line_content": "void swift::simple_display(",
          "new_line_content": "  llvm_unreachable(\"Unhandled Reason in switch.\");",
          "content_same": false
        },
        {
          "line": 312,
          "old_api": null,
          "new_api": "dyn_cast<AvailableAttr>(Attr)",
          "old_text": null,
          "new_text": "dyn_cast<AvailableAttr>(Attr)",
          "old_line_content": "          AA->Platform == Platform) {",
          "new_line_content": "    if (auto *AA = dyn_cast<AvailableAttr>(Attr)) {",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": null,
          "new_api": "has_value",
          "old_text": null,
          "new_text": "AA->Introduced.has_value()",
          "old_line_content": "",
          "new_line_content": "      if (AA->Introduced.has_value() &&",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "AA->Introduced.value()",
          "old_line_content": "        // More than one: return invalid range.",
          "new_line_content": "          AA->Introduced.value() == Version &&",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": null,
          "new_api": "rangeContainsTokenLoc",
          "old_text": null,
          "new_text": "sourceMgr.rangeContainsTokenLoc(\n      sourceMgr.getRangeForBuffer(childBuffer), parentRange.Start)",
          "old_line_content": "    if (!info)",
          "new_line_content": "  while (!sourceMgr.rangeContainsTokenLoc(",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": null,
          "new_api": "getRangeForBuffer",
          "old_text": null,
          "new_text": "sourceMgr.getRangeForBuffer(childBuffer)",
          "old_line_content": "      return false;",
          "new_line_content": "      sourceMgr.getRangeForBuffer(childBuffer), parentRange.Start)) {",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": null,
          "new_api": "getGeneratedSourceInfo",
          "old_text": null,
          "new_text": "sourceMgr.getGeneratedSourceInfo(childBuffer)",
          "old_line_content": "",
          "new_line_content": "    auto *info = sourceMgr.getGeneratedSourceInfo(childBuffer);",
          "content_same": false
        },
        {
          "line": 318,
          "old_api": null,
          "new_api": "isValid",
          "old_text": null,
          "new_text": "Range.isValid()",
          "old_line_content": "          Range = AA->IntroducedRange;",
          "new_line_content": "        if (Range.isValid())",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": null,
          "new_api": "SourceRange",
          "old_text": null,
          "new_text": "SourceRange()",
          "old_line_content": "      }",
          "new_line_content": "          return SourceRange();",
          "content_same": false
        },
        {
          "line": 448,
          "old_api": null,
          "new_api": "getStorage",
          "old_text": null,
          "new_text": "getStorage()",
          "old_line_content": "  return TRC->Children;",
          "new_line_content": "  auto *TRC = std::get<0>(getStorage());",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": null,
          "new_api": "getStart",
          "old_text": null,
          "new_text": "info->originalSourceRange.getStart()",
          "old_line_content": "",
          "new_line_content": "    childLoc = info->originalSourceRange.getStart();",
          "content_same": false
        },
        {
          "line": 449,
          "old_api": null,
          "new_api": "getNeedsExpansion",
          "old_text": null,
          "new_text": "TRC->getNeedsExpansion()",
          "old_line_content": "}",
          "new_line_content": "  if (TRC->getNeedsExpansion())",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": null,
          "new_api": "getStorage",
          "old_text": null,
          "new_text": "getStorage()",
          "old_line_content": "}",
          "new_line_content": "  auto *TRC = std::get<0>(getStorage());",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": null,
          "new_api": "rangeContainsTokenLoc",
          "old_text": null,
          "new_text": "sourceMgr.rangeContainsTokenLoc(parentRange, childLoc)",
          "old_line_content": "TypeRefinementContext *",
          "new_line_content": "  return sourceMgr.rangeContainsTokenLoc(parentRange, childLoc);",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": null,
          "new_api": "setNeedsExpansion",
          "old_text": null,
          "new_text": "TRC->setNeedsExpansion(false)",
          "old_line_content": "",
          "new_line_content": "  TRC->setNeedsExpansion(false);",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": null,
          "new_api": "getAsDecl",
          "old_text": null,
          "new_text": "::getAvailabilityConditionVersionSourceRange(\n      Node.getAsDecl()->getAttrs(), Platform, Version)",
          "old_line_content": "  case Reason::IfStmtThenBranch:",
          "new_line_content": "    return ::getAvailabilityConditionVersionSourceRange(",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": null,
          "new_api": "getAsDecl",
          "old_text": null,
          "new_text": "Node.getAsDecl()->getAttrs()",
          "old_line_content": "  case Reason::IfStmtElseBranch:",
          "new_line_content": "      Node.getAsDecl()->getAttrs(), Platform, Version);",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": null,
          "new_api": "isValid",
          "old_text": null,
          "new_text": "SrcRange.isValid()",
          "old_line_content": "",
          "new_line_content": "  if (SrcRange.isValid() &&",
          "content_same": false
        },
        {
          "line": 339,
          "old_api": null,
          "new_api": "getAsIfStmt",
          "old_text": null,
          "new_text": "::getAvailabilityConditionVersionSourceRange(\n      Node.getAsIfStmt()->getCond(), Platform, Version)",
          "old_line_content": "  case Reason::ConditionFollowingAvailabilityQuery:",
          "new_line_content": "    return ::getAvailabilityConditionVersionSourceRange(",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": null,
          "new_api": "evaluateOrDefault",
          "old_text": null,
          "new_text": "evaluateOrDefault(\n      Ctx.evaluator, ExpandChildTypeRefinementContextsRequest{this}, {})",
          "old_line_content": "  // For the moment, we perform a linear search here, but we can and should",
          "new_line_content": "  auto expandedChildren = evaluateOrDefault(",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": null,
          "new_api": "getAsPoundAvailableInfo",
          "old_text": null,
          "new_text": "::getAvailabilityConditionVersionSourceRange(\n      Node.getAsPoundAvailableInfo(), Platform, Version)",
          "old_line_content": "  case Reason::GuardStmtFallthrough:",
          "new_line_content": "    return ::getAvailabilityConditionVersionSourceRange(",
          "content_same": false
        },
        {
          "line": 344,
          "old_api": null,
          "new_api": "getAsPoundAvailableInfo",
          "old_text": null,
          "new_text": "Node.getAsPoundAvailableInfo()",
          "old_line_content": "  case Reason::GuardStmtElseBranch:",
          "new_line_content": "      Node.getAsPoundAvailableInfo(), Platform, Version);",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": null,
          "new_api": "findMostRefinedSubContext",
          "old_text": null,
          "new_text": "Child->findMostRefinedSubContext(Loc, Ctx)",
          "old_line_content": "  }",
          "new_line_content": "    if (auto *Found = Child->findMostRefinedSubContext(Loc, Ctx)) {",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": null,
          "new_api": "getAsGuardStmt",
          "old_text": null,
          "new_text": "::getAvailabilityConditionVersionSourceRange(\n      Node.getAsGuardStmt()->getCond(), Platform, Version)",
          "old_line_content": "  case Reason::WhileStmtBody:",
          "new_line_content": "    return ::getAvailabilityConditionVersionSourceRange(",
          "content_same": false
        },
        {
          "line": 352,
          "old_api": null,
          "new_api": "getAsWhileStmt",
          "old_text": null,
          "new_text": "::getAvailabilityConditionVersionSourceRange(\n      Node.getAsWhileStmt()->getCond(), Platform, Version)",
          "old_line_content": "  case Reason::Root:",
          "new_line_content": "    return ::getAvailabilityConditionVersionSourceRange(",
          "content_same": false
        },
        {
          "line": 353,
          "old_api": null,
          "new_api": "getAsWhileStmt",
          "old_text": null,
          "new_text": "Node.getAsWhileStmt()->getCond()",
          "old_line_content": "  case Reason::DeclImplicit:",
          "new_line_content": "      Node.getAsWhileStmt()->getCond(), Platform, Version);",
          "content_same": false
        },
        {
          "line": 231,
          "old_api": null,
          "new_api": "llvm::errs()",
          "old_text": null,
          "new_text": "llvm::errs()",
          "old_line_content": "void TypeRefinementContext::dump(raw_ostream &OS, SourceManager &SrcMgr) const {",
          "new_line_content": "  dump(llvm::errs(), SrcMgr);",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": null,
          "new_api": "llvm_unreachable",
          "old_text": null,
          "new_text": "llvm_unreachable(\"Unhandled Reason in switch.\")",
          "old_line_content": "void TypeRefinementContext::print(raw_ostream &OS, SourceManager &SrcMgr,",
          "new_line_content": "  llvm_unreachable(\"Unhandled Reason in switch.\");",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": null,
          "new_api": "print",
          "old_text": null,
          "new_text": "print(OS, SrcMgr, 0)",
          "old_line_content": "",
          "new_line_content": "  print(OS, SrcMgr, 0);",
          "content_same": false
        },
        {
          "line": 366,
          "old_api": null,
          "new_api": "getReason",
          "old_text": null,
          "new_text": "getReason()",
          "old_line_content": "",
          "new_line_content": "  OS << \"(\" << getReasonName(getReason());",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": null,
          "new_api": "getAsDecl",
          "old_text": null,
          "new_text": "Node.getAsDecl()->getLoc()",
          "old_line_content": "  case Reason::IfStmtElseBranch:",
          "new_line_content": "    return Node.getAsDecl()->getLoc();",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": null,
          "new_api": "dyn_cast<ExtensionDecl>(D)",
          "old_text": null,
          "new_text": "dyn_cast<ExtensionDecl>(D)",
          "old_line_content": "      OS << \"<top-level-code>\";",
          "new_line_content": "    } else if (auto *ED = dyn_cast<ExtensionDecl>(D)) {",
          "content_same": false
        },
        {
          "line": 250,
          "old_api": null,
          "new_api": "getAsPoundAvailableInfo",
          "old_text": null,
          "new_text": "Node.getAsPoundAvailableInfo()->getStartLoc()",
          "old_line_content": "  case Reason::GuardStmtElseBranch:",
          "new_line_content": "    return Node.getAsPoundAvailableInfo()->getStartLoc();",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": null,
          "new_api": "dyn_cast<PatternBindingDecl>(D)",
          "old_text": null,
          "new_text": "dyn_cast<PatternBindingDecl>(D)",
          "old_line_content": "      }",
          "new_line_content": "    } else if (auto PBD = dyn_cast<PatternBindingDecl>(D)) {",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": null,
          "new_api": "getAnchoringVarDecl",
          "old_text": null,
          "new_text": "PBD->getAnchoringVarDecl(0)",
          "old_line_content": "    }",
          "new_line_content": "      if (auto VD = PBD->getAnchoringVarDecl(0)) {",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "VD->getName()",
          "old_line_content": "  }",
          "new_line_content": "        OS << VD->getName();",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": null,
          "new_api": "getAsGuardStmt",
          "old_text": null,
          "new_text": "Node.getAsGuardStmt()->getGuardLoc()",
          "old_line_content": "  case Reason::WhileStmtBody:",
          "new_line_content": "    return Node.getAsGuardStmt()->getGuardLoc();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 384,
          "old_api": "isValid",
          "new_api": null,
          "old_text": "R.isValid()",
          "new_text": null,
          "old_line_content": "  if (R.isValid()) {",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": "getSourceRange",
          "new_api": null,
          "old_text": "getSourceRange()",
          "new_text": null,
          "old_line_content": "  auto R = getSourceRange();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 391,
          "old_api": "getOSVersion",
          "new_api": null,
          "old_text": "ExplicitAvailabilityInfo.getOSVersion().getAsString()",
          "new_text": null,
          "old_line_content": "       << ExplicitAvailabilityInfo.getOSVersion().getAsString();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": "print",
          "new_api": null,
          "old_text": "Child->print(OS, SrcMgr, Indent + 2)",
          "new_text": null,
          "old_line_content": "    Child->print(OS, SrcMgr, Indent + 2);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 269,
          "old_api": "getQueries",
          "new_api": null,
          "old_text": "PAI->getQueries()",
          "new_text": null,
          "old_line_content": "  for (auto *S : PAI->getQueries()) {",
          "new_line_content": "                                           PlatformKind Platform,",
          "content_same": false
        },
        {
          "line": 270,
          "old_api": "dyn_cast<PlatformVersionConstraintAvailabilitySpec>(S)",
          "new_api": null,
          "old_text": "dyn_cast<PlatformVersionConstraintAvailabilitySpec>(S)",
          "new_text": null,
          "old_line_content": "    if (auto *V = dyn_cast<PlatformVersionConstraintAvailabilitySpec>(S)) {",
          "new_line_content": "                                           const llvm::VersionTuple &Version) {",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": "getVersion",
          "new_api": null,
          "old_text": "V->getVersion()",
          "new_text": null,
          "old_line_content": "      if (V->getPlatform() == Platform && V->getVersion() == Version) {",
          "new_line_content": "  SourceRange Range;",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": "indent",
          "new_api": null,
          "old_text": "OS.indent(Indent)",
          "new_text": null,
          "old_line_content": "  OS.indent(Indent);",
          "new_line_content": "    OS << '\\n';",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": "getReason",
          "new_api": null,
          "old_text": "Node.getReason()",
          "new_text": null,
          "old_line_content": "  return Node.getReason();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 290,
          "old_api": "getKind",
          "new_api": null,
          "old_text": "C.getKind()",
          "new_text": null,
          "old_line_content": "    if (C.getKind() == StmtConditionElement::CK_Availability) {",
          "new_line_content": "    const llvm::VersionTuple &Version) {",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": "getAvailability",
          "new_api": null,
          "old_text": "getAvailabilityConditionVersionSourceRange(\n        C.getAvailability(), Platform, Version)",
          "new_text": null,
          "old_line_content": "      SourceRange R = getAvailabilityConditionVersionSourceRange(",
          "new_line_content": "  SourceRange Range;",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": "getAvailability",
          "new_api": null,
          "old_text": "C.getAvailability()",
          "new_text": null,
          "old_line_content": "        C.getAvailability(), Platform, Version);",
          "new_line_content": "  for (auto const& C : Conds) {",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": "llvm_unreachable",
          "new_api": null,
          "old_text": "llvm_unreachable(\"Unhandled Reason in switch.\")",
          "new_text": null,
          "old_line_content": "  llvm_unreachable(\"Unhandled Reason in switch.\");",
          "new_line_content": "    return \"while_body\";",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": "dyn_cast<AvailableAttr>(Attr)",
          "new_api": null,
          "old_text": "dyn_cast<AvailableAttr>(Attr)",
          "new_text": null,
          "old_line_content": "    if (auto *AA = dyn_cast<AvailableAttr>(Attr)) {",
          "new_line_content": "                                           const llvm::VersionTuple &Version) {",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": "has_value",
          "new_api": null,
          "old_text": "AA->Introduced.has_value()",
          "new_text": null,
          "old_line_content": "      if (AA->Introduced.has_value() &&",
          "new_line_content": "  SourceRange Range;",
          "content_same": false
        },
        {
          "line": 311,
          "old_api": "value",
          "new_api": null,
          "old_text": "AA->Introduced.value()",
          "new_text": null,
          "old_line_content": "          AA->Introduced.value() == Version &&",
          "new_line_content": "  for (auto *Attr : DeclAttrs) {",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": "findBufferContainingLoc",
          "new_api": null,
          "old_text": "sourceMgr.findBufferContainingLoc(childLoc)",
          "new_text": null,
          "old_line_content": "  auto childBuffer = sourceMgr.findBufferContainingLoc(childLoc);",
          "new_line_content": "    return true;",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": "isValid",
          "new_api": null,
          "old_text": "Range.isValid()",
          "new_text": null,
          "old_line_content": "        if (Range.isValid())",
          "new_line_content": "          AA->Platform == Platform) {",
          "content_same": false
        },
        {
          "line": 316,
          "old_api": "SourceRange",
          "new_api": null,
          "old_text": "SourceRange()",
          "new_text": null,
          "old_line_content": "          return SourceRange();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": "getStorage",
          "new_api": null,
          "old_text": "getStorage()",
          "new_text": null,
          "old_line_content": "  auto *TRC = std::get<0>(getStorage());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 446,
          "old_api": "getNeedsExpansion",
          "new_api": null,
          "old_text": "TRC->getNeedsExpansion()",
          "new_text": null,
          "old_line_content": "  if (TRC->getNeedsExpansion())",
          "new_line_content": "std::optional<std::vector<TypeRefinementContext *>>",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": "getStart",
          "new_api": null,
          "old_text": "info->originalSourceRange.getStart()",
          "new_text": null,
          "old_line_content": "    childLoc = info->originalSourceRange.getStart();",
          "new_line_content": "    if (!info)",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": "isInvalid",
          "new_api": null,
          "old_text": "childLoc.isInvalid()",
          "new_text": null,
          "old_line_content": "    if (childLoc.isInvalid())",
          "new_line_content": "      return false;",
          "content_same": false
        },
        {
          "line": 453,
          "old_api": "getStorage",
          "new_api": null,
          "old_text": "getStorage()",
          "new_text": null,
          "old_line_content": "  auto *TRC = std::get<0>(getStorage());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": "setNeedsExpansion",
          "new_api": null,
          "old_text": "TRC->setNeedsExpansion(false)",
          "new_text": null,
          "old_line_content": "  TRC->setNeedsExpansion(false);",
          "new_line_content": "    std::vector<TypeRefinementContext *> children) const {",
          "content_same": false
        },
        {
          "line": 329,
          "old_api": "getReason",
          "new_api": null,
          "old_text": "getReason()",
          "new_text": null,
          "old_line_content": "  switch (getReason()) {",
          "new_line_content": "TypeRefinementContext::getAvailabilityConditionVersionSourceRange(",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": "getAsDecl",
          "new_api": null,
          "old_text": "::getAvailabilityConditionVersionSourceRange(\n      Node.getAsDecl()->getAttrs(), Platform, Version)",
          "new_text": null,
          "old_line_content": "    return ::getAvailabilityConditionVersionSourceRange(",
          "new_line_content": "    const llvm::VersionTuple &Version) const {",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "isValid",
          "new_api": null,
          "old_text": "Loc.isValid()",
          "new_text": null,
          "old_line_content": "  assert(Loc.isValid());",
          "new_line_content": "TypeRefinementContext *",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": "isValid",
          "new_api": null,
          "old_text": "SrcRange.isValid()",
          "new_text": null,
          "old_line_content": "  if (SrcRange.isValid() &&",
          "new_line_content": "                                                 ASTContext &Ctx) {",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": "getAsIfStmt",
          "new_api": null,
          "old_text": "::getAvailabilityConditionVersionSourceRange(\n      Node.getAsIfStmt()->getCond(), Platform, Version)",
          "new_text": null,
          "old_line_content": "    return ::getAvailabilityConditionVersionSourceRange(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": "getAsIfStmt",
          "new_api": null,
          "old_text": "Node.getAsIfStmt()->getCond()",
          "new_text": null,
          "old_line_content": "      Node.getAsIfStmt()->getCond(), Platform, Version);",
          "new_line_content": "  case Reason::IfStmtThenBranch:",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": "getAsPoundAvailableInfo",
          "new_api": null,
          "old_text": "Node.getAsPoundAvailableInfo()",
          "new_text": null,
          "old_line_content": "      Node.getAsPoundAvailableInfo(), Platform, Version);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": "findMostRefinedSubContext",
          "new_api": null,
          "old_text": "Child->findMostRefinedSubContext(Loc, Ctx)",
          "new_text": null,
          "old_line_content": "    if (auto *Found = Child->findMostRefinedSubContext(Loc, Ctx)) {",
          "new_line_content": "  // For the moment, we perform a linear search here, but we can and should",
          "content_same": false
        },
        {
          "line": 345,
          "old_api": "getAsGuardStmt",
          "new_api": null,
          "old_text": "::getAvailabilityConditionVersionSourceRange(\n      Node.getAsGuardStmt()->getCond(), Platform, Version)",
          "new_text": null,
          "old_line_content": "    return ::getAvailabilityConditionVersionSourceRange(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 346,
          "old_api": "getAsGuardStmt",
          "new_api": null,
          "old_text": "Node.getAsGuardStmt()->getCond()",
          "new_text": null,
          "old_line_content": "      Node.getAsGuardStmt()->getCond(), Platform, Version);",
          "new_line_content": "  case Reason::GuardStmtFallthrough:",
          "content_same": false
        },
        {
          "line": 350,
          "old_api": "getAsWhileStmt",
          "new_api": null,
          "old_text": "Node.getAsWhileStmt()->getCond()",
          "new_text": null,
          "old_line_content": "      Node.getAsWhileStmt()->getCond(), Platform, Version);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": "SourceRange",
          "new_api": null,
          "old_text": "SourceRange()",
          "new_text": null,
          "old_line_content": "    return SourceRange();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 228,
          "old_api": "llvm::errs()",
          "new_api": null,
          "old_text": "llvm::errs()",
          "new_text": null,
          "old_line_content": "  dump(llvm::errs(), SrcMgr);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "print",
          "new_api": null,
          "old_text": "print(OS, SrcMgr, 0)",
          "new_text": null,
          "old_line_content": "  print(OS, SrcMgr, 0);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 362,
          "old_api": "indent",
          "new_api": null,
          "old_text": "OS.indent(Indent)",
          "new_text": null,
          "old_line_content": "  OS.indent(Indent);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 363,
          "old_api": "getReason",
          "new_api": null,
          "old_text": "getReason()",
          "new_text": null,
          "old_line_content": "  OS << \"(\" << getReasonName(getReason());",
          "new_line_content": "void TypeRefinementContext::print(raw_ostream &OS, SourceManager &SrcMgr,",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": "getReason",
          "new_api": null,
          "old_text": "getReason()",
          "new_text": null,
          "old_line_content": "  switch (getReason()) {",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 367,
          "old_api": "getReason",
          "new_api": null,
          "old_text": "getReason()",
          "new_text": null,
          "old_line_content": "  if (getReason() == Reason::Decl || getReason() == Reason::DeclImplicit) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": "getAsIfStmt",
          "new_api": null,
          "old_text": "Node.getAsIfStmt()->getIfLoc()",
          "new_text": null,
          "old_line_content": "    return Node.getAsIfStmt()->getIfLoc();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": "dyn_cast<ExtensionDecl>(D)",
          "new_api": null,
          "old_text": "dyn_cast<ExtensionDecl>(D)",
          "new_text": null,
          "old_line_content": "    } else if (auto *ED = dyn_cast<ExtensionDecl>(D)) {",
          "new_line_content": "    OS << \" decl=\";",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": "getName",
          "new_api": null,
          "old_text": "VD->getName()",
          "new_text": null,
          "old_line_content": "        OS << VD->getName();",
          "new_line_content": "      OS << \"<top-level-code>\";",
          "content_same": false
        },
        {
          "line": 251,
          "old_api": "getAsGuardStmt",
          "new_api": null,
          "old_text": "Node.getAsGuardStmt()->getGuardLoc()",
          "new_text": null,
          "old_line_content": "    return Node.getAsGuardStmt()->getGuardLoc();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 255,
          "old_api": "getAsWhileStmt",
          "new_api": null,
          "old_text": "Node.getAsWhileStmt()->getStartLoc()",
          "new_text": null,
          "old_line_content": "    return Node.getAsWhileStmt()->getStartLoc();",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 29,
      "total_additions": 50,
      "total_deletions": 48,
      "total_api_changes": 127
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 127,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          187
        ]
      }
    },
    "api_calls_before": 153,
    "api_calls_after": 155,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 3,
      "total_diff_lines": 22
    }
  }
}