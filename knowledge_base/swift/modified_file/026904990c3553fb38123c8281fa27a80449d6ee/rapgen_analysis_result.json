{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/026904990c3553fb38123c8281fa27a80449d6ee",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/026904990c3553fb38123c8281fa27a80449d6ee/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/026904990c3553fb38123c8281fa27a80449d6ee/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/026904990c3553fb38123c8281fa27a80449d6ee/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 4413,
          "old_api": "getConstraintLocator",
          "new_api": "size",
          "old_text": "CS.getConstraintLocator({})",
          "new_text": "LookupResult.ViableCandidates.size()",
          "old_line_content": "  ConstraintLocator *Locator = CS.getConstraintLocator({});",
          "new_line_content": "  if (LookupResult.ViableCandidates.size() == 1) {",
          "content_same": false
        },
        {
          "line": 4414,
          "old_api": "createTypeVariable",
          "new_api": "size",
          "old_text": "CS.createTypeVariable(Locator,\n                                               TVO_CanBindToLValue |\n                                               TVO_CanBindToNoEscape)",
          "new_text": "Result.Impl->AllDecls.size()",
          "old_line_content": "  TypeVariableType *TV = CS.createTypeVariable(Locator,",
          "new_line_content": "    Result.Impl->BestIdx = Result.Impl->AllDecls.size();",
          "content_same": false
        },
        {
          "line": 4420,
          "old_api": "hasValue",
          "new_api": "getConstraintLocator",
          "old_text": "OpSolution.hasValue()",
          "new_text": "CS.getConstraintLocator({})",
          "old_line_content": "  if (OpSolution.hasValue()) {",
          "new_line_content": "  ConstraintLocator *Locator = CS.getConstraintLocator({});",
          "content_same": false
        },
        {
          "line": 4421,
          "old_api": "getValue",
          "new_api": "createTypeVariable",
          "old_text": "OpSolution.getValue().overloadChoices[Locator].choice.getDecl()",
          "new_text": "CS.createTypeVariable(Locator,\n                                               TVO_CanBindToLValue |\n                                               TVO_CanBindToNoEscape)",
          "old_line_content": "    Selected = OpSolution.getValue().overloadChoices[Locator].choice.getDecl();",
          "new_line_content": "  TypeVariableType *TV = CS.createTypeVariable(Locator,",
          "content_same": false
        },
        {
          "line": 4424,
          "old_api": "getDecl",
          "new_api": "addOverloadSet",
          "old_text": "Choice.getDecl()",
          "new_text": "CS.addOverloadSet(TV, LookupResult.ViableCandidates, &DC, Locator)",
          "old_line_content": "    ValueDecl *VD = Choice.getDecl();",
          "new_line_content": "  CS.addOverloadSet(TV, LookupResult.ViableCandidates, &DC, Locator);",
          "content_same": false
        },
        {
          "line": 4428,
          "old_api": "size",
          "new_api": "getValue",
          "old_text": "Result.Impl->AllDecls.size()",
          "new_text": "OpSolution.getValue().overloadChoices[Locator].choice.getDecl()",
          "old_line_content": "      Result.Impl->BestIdx = Result.Impl->AllDecls.size();",
          "new_line_content": "    Selected = OpSolution.getValue().overloadChoices[Locator].choice.getDecl();",
          "content_same": false
        },
        {
          "line": 4446,
          "old_api": "push_back",
          "new_api": "isa<DefaultArgumentExpr>(arg)",
          "old_text": "result.args.push_back(elt)",
          "new_text": "isa<DefaultArgumentExpr>(arg)",
          "old_line_content": "          result.args.push_back(elt);",
          "new_line_content": "    if (isa<DefaultArgumentExpr>(arg)) {",
          "content_same": false
        },
        {
          "line": 4450,
          "old_api": "Identifier",
          "new_api": "dyn_cast<VarargExpansionExpr>(arg)",
          "old_text": "Identifier()",
          "new_text": "dyn_cast<VarargExpansionExpr>(arg)",
          "old_line_content": "          label = Identifier();",
          "new_line_content": "    if (auto *varargExpr = dyn_cast<VarargExpansionExpr>(arg)) {",
          "content_same": false
        },
        {
          "line": 4451,
          "old_api": "SourceLoc",
          "new_api": "getSubExpr",
          "old_text": "SourceLoc()",
          "new_text": "varargExpr->getSubExpr()",
          "old_line_content": "          labelLoc = SourceLoc();",
          "new_line_content": "      if (auto *arrayExpr = dyn_cast<ArrayExpr>(varargExpr->getSubExpr())) {",
          "content_same": false
        },
        {
          "line": 4458,
          "old_api": "push_back",
          "new_api": "SourceLoc",
          "old_text": "result.args.push_back(arg)",
          "new_text": "SourceLoc()",
          "old_line_content": "    result.args.push_back(arg);",
          "new_line_content": "          labelLoc = SourceLoc();",
          "content_same": false
        },
        {
          "line": 4465,
          "old_api": "getRParenLoc",
          "new_api": "push_back",
          "old_text": "parenExpr->getRParenLoc()",
          "new_text": "result.args.push_back(arg)",
          "old_line_content": "    result.rParenLoc = parenExpr->getRParenLoc();",
          "new_line_content": "    result.args.push_back(arg);",
          "content_same": false
        },
        {
          "line": 4466,
          "old_api": "hasTrailingClosure",
          "new_api": "push_back",
          "old_text": "parenExpr->hasTrailingClosure()",
          "new_text": "result.labels.push_back(label)",
          "old_line_content": "    result.hasTrailingClosure = parenExpr->hasTrailingClosure();",
          "new_line_content": "    result.labels.push_back(label);",
          "content_same": false
        },
        {
          "line": 4467,
          "old_api": "SourceLoc",
          "new_api": "push_back",
          "old_text": "SourceLoc()",
          "new_text": "result.labelLocs.push_back(labelLoc)",
          "old_line_content": "    add(parenExpr->getSubExpr(), Identifier(), SourceLoc());",
          "new_line_content": "    result.labelLocs.push_back(labelLoc);",
          "content_same": false
        },
        {
          "line": 4470,
          "old_api": "getRParenLoc",
          "new_api": "dyn_cast<ParenExpr>(expr)",
          "old_text": "tupleExpr->getRParenLoc()",
          "new_text": "dyn_cast<ParenExpr>(expr)",
          "old_line_content": "    result.rParenLoc = tupleExpr->getRParenLoc();",
          "new_line_content": "  if (auto *parenExpr = dyn_cast<ParenExpr>(expr)) {",
          "content_same": false
        },
        {
          "line": 4471,
          "old_api": "hasTrailingClosure",
          "new_api": "getLParenLoc",
          "old_text": "tupleExpr->hasTrailingClosure()",
          "new_text": "parenExpr->getLParenLoc()",
          "old_line_content": "    result.hasTrailingClosure = tupleExpr->hasTrailingClosure();",
          "new_line_content": "    result.lParenLoc = parenExpr->getLParenLoc();",
          "content_same": false
        },
        {
          "line": 4473,
          "old_api": "getElements",
          "new_api": "hasTrailingClosure",
          "old_text": "tupleExpr->getElements()",
          "new_text": "parenExpr->hasTrailingClosure()",
          "old_line_content": "    auto args = tupleExpr->getElements();",
          "new_line_content": "    result.hasTrailingClosure = parenExpr->hasTrailingClosure();",
          "content_same": false
        },
        {
          "line": 4474,
          "old_api": "getElementNames",
          "new_api": "SourceLoc",
          "old_text": "tupleExpr->getElementNames()",
          "new_text": "SourceLoc()",
          "old_line_content": "    auto labels = tupleExpr->getElementNames();",
          "new_line_content": "    add(parenExpr->getSubExpr(), Identifier(), SourceLoc());",
          "content_same": false
        },
        {
          "line": 4475,
          "old_api": "getElementNameLocs",
          "new_api": "dyn_cast<TupleExpr>(expr)",
          "old_text": "tupleExpr->getElementNameLocs()",
          "new_text": "dyn_cast<TupleExpr>(expr)",
          "old_line_content": "    auto labelLocs = tupleExpr->getElementNameLocs();",
          "new_line_content": "  } else if (auto *tupleExpr = dyn_cast<TupleExpr>(expr)) {",
          "content_same": false
        },
        {
          "line": 4476,
          "old_api": "size",
          "new_api": "getLParenLoc",
          "old_text": "args.size()",
          "new_text": "tupleExpr->getLParenLoc()",
          "old_line_content": "    for (unsigned i = 0, e = args.size(); i != e; ++i) {",
          "new_line_content": "    result.lParenLoc = tupleExpr->getLParenLoc();",
          "content_same": false
        },
        {
          "line": 4478,
          "old_api": "empty",
          "new_api": "hasTrailingClosure",
          "old_text": "add(args[i], labels[i],\n          labelLocs.empty() ? SourceLoc() : labelLocs[i])",
          "new_text": "tupleExpr->hasTrailingClosure()",
          "old_line_content": "      add(args[i], labels[i],",
          "new_line_content": "    result.hasTrailingClosure = tupleExpr->hasTrailingClosure();",
          "content_same": false
        },
        {
          "line": 4482,
          "old_api": "SourceLoc",
          "new_api": "getElementNameLocs",
          "old_text": "SourceLoc()",
          "new_text": "tupleExpr->getElementNameLocs()",
          "old_line_content": "    add(expr, Identifier(), SourceLoc());",
          "new_line_content": "    auto labelLocs = tupleExpr->getElementNameLocs();",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 4480,
          "old_api": null,
          "new_api": "getElements",
          "old_text": null,
          "new_text": "tupleExpr->getElements()",
          "old_line_content": "    }",
          "new_line_content": "    auto args = tupleExpr->getElements();",
          "content_same": false
        },
        {
          "line": 4481,
          "old_api": null,
          "new_api": "getElementNames",
          "old_text": null,
          "new_text": "tupleExpr->getElementNames()",
          "old_line_content": "  } else {",
          "new_line_content": "    auto labels = tupleExpr->getElementNames();",
          "content_same": false
        },
        {
          "line": 4483,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "args.size()",
          "old_line_content": "  }",
          "new_line_content": "    for (unsigned i = 0, e = args.size(); i != e; ++i) {",
          "content_same": false
        },
        {
          "line": 4485,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "add(args[i], labels[i],\n          labelLocs.empty() ? SourceLoc() : labelLocs[i])",
          "old_line_content": "  return result;",
          "new_line_content": "      add(args[i], labels[i],",
          "content_same": false
        },
        {
          "line": 4486,
          "old_api": null,
          "new_api": "SourceLoc",
          "old_text": null,
          "new_text": "SourceLoc()",
          "old_line_content": "}",
          "new_line_content": "          labelLocs.empty() ? SourceLoc() : labelLocs[i]);",
          "content_same": false
        },
        {
          "line": 4489,
          "old_api": null,
          "new_api": "SourceLoc",
          "old_text": null,
          "new_text": "SourceLoc()",
          "old_line_content": "",
          "new_line_content": "    add(expr, Identifier(), SourceLoc());",
          "content_same": false
        },
        {
          "line": 4415,
          "old_api": null,
          "new_api": "getDecl",
          "old_text": null,
          "new_text": "LookupResult.ViableCandidates[0].getDecl()",
          "old_line_content": "                                               TVO_CanBindToLValue |",
          "new_line_content": "    Result.Impl->AllDecls.push_back(LookupResult.ViableCandidates[0].getDecl());",
          "content_same": false
        },
        {
          "line": 4425,
          "old_api": null,
          "new_api": "solveSingle",
          "old_text": null,
          "new_text": "CS.solveSingle()",
          "old_line_content": "",
          "new_line_content": "  Optional<Solution> OpSolution = CS.solveSingle();",
          "content_same": false
        },
        {
          "line": 4427,
          "old_api": null,
          "new_api": "hasValue",
          "old_text": null,
          "new_text": "OpSolution.hasValue()",
          "old_line_content": "    if (VD == Selected)",
          "new_line_content": "  if (OpSolution.hasValue()) {",
          "content_same": false
        },
        {
          "line": 4431,
          "old_api": null,
          "new_api": "getDecl",
          "old_text": null,
          "new_text": "Choice.getDecl()",
          "old_line_content": "  return Result;",
          "new_line_content": "    ValueDecl *VD = Choice.getDecl();",
          "content_same": false
        },
        {
          "line": 4435,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "Result.Impl->AllDecls.size()",
          "old_line_content": "swift::getOriginalArgumentList(Expr *expr) {",
          "new_line_content": "      Result.Impl->BestIdx = Result.Impl->AllDecls.size();",
          "content_same": false
        },
        {
          "line": 4436,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "Result.Impl->AllDecls.push_back(VD)",
          "old_line_content": "  OriginalArgumentList result;",
          "new_line_content": "    Result.Impl->AllDecls.push_back(VD);",
          "content_same": false
        },
        {
          "line": 4452,
          "old_api": null,
          "new_api": "getElements",
          "old_text": null,
          "new_text": "arrayExpr->getElements()",
          "old_line_content": "        }",
          "new_line_content": "        for (auto *elt : arrayExpr->getElements()) {",
          "content_same": false
        },
        {
          "line": 4453,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "result.args.push_back(elt)",
          "old_line_content": "",
          "new_line_content": "          result.args.push_back(elt);",
          "content_same": false
        },
        {
          "line": 4454,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "result.labels.push_back(label)",
          "old_line_content": "        return;",
          "new_line_content": "          result.labels.push_back(label);",
          "content_same": false
        },
        {
          "line": 4455,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "result.labelLocs.push_back(labelLoc)",
          "old_line_content": "      }",
          "new_line_content": "          result.labelLocs.push_back(labelLoc);",
          "content_same": false
        },
        {
          "line": 4457,
          "old_api": null,
          "new_api": "Identifier",
          "old_text": null,
          "new_text": "Identifier()",
          "old_line_content": "",
          "new_line_content": "          label = Identifier();",
          "content_same": false
        },
        {
          "line": 4472,
          "old_api": null,
          "new_api": "getRParenLoc",
          "old_text": null,
          "new_text": "parenExpr->getRParenLoc()",
          "old_line_content": "",
          "new_line_content": "    result.rParenLoc = parenExpr->getRParenLoc();",
          "content_same": false
        },
        {
          "line": 4477,
          "old_api": null,
          "new_api": "getRParenLoc",
          "old_text": null,
          "new_text": "tupleExpr->getRParenLoc()",
          "old_line_content": "      // Implicit TupleExprs don't always store label locations.",
          "new_line_content": "    result.rParenLoc = tupleExpr->getRParenLoc();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 4448,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "result.labelLocs.push_back(labelLoc)",
          "new_text": null,
          "old_line_content": "          result.labelLocs.push_back(labelLoc);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4417,
          "old_api": "addOverloadSet",
          "new_api": null,
          "old_text": "CS.addOverloadSet(TV, LookupResult.ViableCandidates, &DC, Locator)",
          "new_text": null,
          "old_line_content": "  CS.addOverloadSet(TV, LookupResult.ViableCandidates, &DC, Locator);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 4418,
          "old_api": "solveSingle",
          "new_api": null,
          "old_text": "CS.solveSingle()",
          "new_text": null,
          "old_line_content": "  Optional<Solution> OpSolution = CS.solveSingle();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4479,
          "old_api": "SourceLoc",
          "new_api": null,
          "old_text": "SourceLoc()",
          "new_text": null,
          "old_line_content": "          labelLocs.empty() ? SourceLoc() : labelLocs[i]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4459,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "result.labels.push_back(label)",
          "new_text": null,
          "old_line_content": "    result.labels.push_back(label);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 4460,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "result.labelLocs.push_back(labelLoc)",
          "new_text": null,
          "old_line_content": "    result.labelLocs.push_back(labelLoc);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4429,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "Result.Impl->AllDecls.push_back(VD)",
          "new_text": null,
          "old_line_content": "    Result.Impl->AllDecls.push_back(VD);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 4463,
          "old_api": "dyn_cast<ParenExpr>(expr)",
          "new_api": null,
          "old_text": "dyn_cast<ParenExpr>(expr)",
          "new_text": null,
          "old_line_content": "  if (auto *parenExpr = dyn_cast<ParenExpr>(expr)) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 4464,
          "old_api": "getLParenLoc",
          "new_api": null,
          "old_text": "parenExpr->getLParenLoc()",
          "new_text": null,
          "old_line_content": "    result.lParenLoc = parenExpr->getLParenLoc();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4468,
          "old_api": "dyn_cast<TupleExpr>(expr)",
          "new_api": null,
          "old_text": "dyn_cast<TupleExpr>(expr)",
          "new_text": null,
          "old_line_content": "  } else if (auto *tupleExpr = dyn_cast<TupleExpr>(expr)) {",
          "new_line_content": "  };",
          "content_same": false
        },
        {
          "line": 4469,
          "old_api": "getLParenLoc",
          "new_api": null,
          "old_text": "tupleExpr->getLParenLoc()",
          "new_text": null,
          "old_line_content": "    result.lParenLoc = tupleExpr->getLParenLoc();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4439,
          "old_api": "isa<DefaultArgumentExpr>(arg)",
          "new_api": null,
          "old_text": "isa<DefaultArgumentExpr>(arg)",
          "new_text": null,
          "old_line_content": "    if (isa<DefaultArgumentExpr>(arg)) {",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 4443,
          "old_api": "dyn_cast<VarargExpansionExpr>(arg)",
          "new_api": null,
          "old_text": "dyn_cast<VarargExpansionExpr>(arg)",
          "new_text": null,
          "old_line_content": "    if (auto *varargExpr = dyn_cast<VarargExpansionExpr>(arg)) {",
          "new_line_content": "  OriginalArgumentList result;",
          "content_same": false
        },
        {
          "line": 4444,
          "old_api": "getSubExpr",
          "new_api": null,
          "old_text": "varargExpr->getSubExpr()",
          "new_text": null,
          "old_line_content": "      if (auto *arrayExpr = dyn_cast<ArrayExpr>(varargExpr->getSubExpr())) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 4445,
          "old_api": "getElements",
          "new_api": null,
          "old_text": "arrayExpr->getElements()",
          "new_text": null,
          "old_line_content": "        for (auto *elt : arrayExpr->getElements()) {",
          "new_line_content": "  auto add = [&](Expr *arg, Identifier label, SourceLoc labelLoc) {",
          "content_same": false
        },
        {
          "line": 4447,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "result.labels.push_back(label)",
          "new_text": null,
          "old_line_content": "          result.labels.push_back(label);",
          "new_line_content": "      return;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 21,
      "total_additions": 19,
      "total_deletions": 16,
      "total_api_changes": 56
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 56,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          4416,
          4412
        ]
      }
    },
    "api_calls_before": 1822,
    "api_calls_after": 1826,
    "diff_info": {
      "added_lines": 7,
      "removed_lines": 0,
      "total_diff_lines": 19
    }
  }
}