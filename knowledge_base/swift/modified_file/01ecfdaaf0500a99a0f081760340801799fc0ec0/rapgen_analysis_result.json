{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/01ecfdaaf0500a99a0f081760340801799fc0ec0",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/01ecfdaaf0500a99a0f081760340801799fc0ec0/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/01ecfdaaf0500a99a0f081760340801799fc0ec0/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/01ecfdaaf0500a99a0f081760340801799fc0ec0/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 553,
          "old_api": "getFullName",
          "new_api": "insert",
          "old_text": "resolveValueMember(*DC, BaseTy,\n                                                       VD->getFullName())",
          "new_text": "DefaultMap.insert({Default, VD})",
          "old_line_content": "      ResolvedMemberResult Result = resolveValueMember(*DC, BaseTy,",
          "new_line_content": "          DefaultMap.insert({Default, VD});",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 548,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "VD->getBaseName().empty()",
          "old_line_content": "",
          "new_line_content": "      if (VD->getBaseName().empty())",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": null,
          "new_api": "getFullName",
          "old_text": null,
          "new_text": "VD->getFullName()",
          "old_line_content": "        continue;",
          "new_line_content": "      for (auto *Default: PD->lookupDirect(VD->getFullName())) {",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": null,
          "new_api": "getDeclContext",
          "old_text": null,
          "new_text": "Default->getDeclContext()->getExtendedProtocolDecl()",
          "old_line_content": "",
          "new_line_content": "        if (Default->getDeclContext()->getExtendedProtocolDecl() == PD) {",
          "content_same": false
        },
        {
          "line": 560,
          "old_api": null,
          "new_api": "getMembers",
          "old_text": null,
          "new_text": "PD->getMembers()",
          "old_line_content": "      }",
          "new_line_content": "  HandleMembers(PD->getMembers());",
          "content_same": false
        },
        {
          "line": 564,
          "old_api": null,
          "new_api": "getInheritedProtocols",
          "old_text": null,
          "new_text": "PD->getInheritedProtocols()",
          "old_line_content": "  // Collect the default implementations for the members in this given protocol.",
          "new_line_content": "  for (auto *IP : PD->getInheritedProtocols())",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": null,
          "new_api": "dyn_cast<ValueDecl>(D)",
          "old_text": null,
          "new_text": "dyn_cast<ValueDecl>(D)",
          "old_line_content": "  auto HandleMembers = [&](DeclRange Members) {",
          "new_line_content": "      auto *VD = dyn_cast<ValueDecl>(D);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 550,
          "old_api": "empty",
          "new_api": null,
          "old_text": "VD->getBaseName().empty()",
          "new_text": null,
          "old_line_content": "      if (VD->getBaseName().empty())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": "getFullName",
          "new_api": null,
          "old_text": "VD->getFullName()",
          "new_text": null,
          "old_line_content": "                                                       VD->getFullName());",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 555,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(Result)",
          "new_text": null,
          "old_line_content": "      assert(Result);",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 556,
          "old_api": "getMemberDecls",
          "new_api": null,
          "old_text": "Result.getMemberDecls(InterestedMemberKind::All)",
          "new_text": null,
          "old_line_content": "      for (auto *Default : Result.getMemberDecls(InterestedMemberKind::All)) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": "getDeclContext",
          "new_api": null,
          "old_text": "Default->getDeclContext()->getExtendedProtocolDecl()",
          "new_text": null,
          "old_line_content": "        if (PD == Default->getDeclContext()->getExtendedProtocolDecl()) {",
          "new_line_content": "  };",
          "content_same": false
        },
        {
          "line": 558,
          "old_api": "insert",
          "new_api": null,
          "old_text": "DefaultMap.insert({Default, VD})",
          "new_text": null,
          "old_line_content": "          DefaultMap.insert({Default, VD});",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "getInheritedProtocols",
          "new_api": null,
          "old_text": "PD->getInheritedProtocols()",
          "new_text": null,
          "old_line_content": "  for (auto *IP : PD->getInheritedProtocols())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 570,
          "old_api": "getMembers",
          "new_api": null,
          "old_text": "IP->getMembers()",
          "new_text": null,
          "old_line_content": "    HandleMembers(IP->getMembers());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": "getDeclaredInterfaceType",
          "new_api": null,
          "old_text": "PD->getDeclaredInterfaceType()",
          "new_text": null,
          "old_line_content": "  Type BaseTy = PD->getDeclaredInterfaceType();",
          "new_line_content": "  auto HandleMembers = [&](DeclRange Members) {",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": "getInnermostDeclContext",
          "new_api": null,
          "old_text": "PD->getInnermostDeclContext()",
          "new_text": null,
          "old_line_content": "  DeclContext *DC = PD->getInnermostDeclContext();",
          "new_line_content": "    for (Decl *D : Members) {",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": "dyn_cast<ValueDecl>(D)",
          "new_api": null,
          "old_text": "dyn_cast<ValueDecl>(D)",
          "new_text": null,
          "old_line_content": "      auto *VD = dyn_cast<ValueDecl>(D);",
          "new_line_content": "      // Skip non-value decl.",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 1,
      "total_additions": 6,
      "total_deletions": 11,
      "total_api_changes": 18
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 9,
        "api_related_lines": 18,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 181,
    "api_calls_after": 177,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 7,
      "total_diff_lines": 28
    }
  }
}