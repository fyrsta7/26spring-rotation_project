{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/946b142b335e8d97ff7b2e61f34ab7f6729e4f41",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/946b142b335e8d97ff7b2e61f34ab7f6729e4f41/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/946b142b335e8d97ff7b2e61f34ab7f6729e4f41/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/946b142b335e8d97ff7b2e61f34ab7f6729e4f41/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 768,
          "old_api": "pop_back_val",
          "new_api": "push_back",
          "old_text": "Worklist.pop_back_val()",
          "new_text": "Worklist.push_back(&Allocation)",
          "old_line_content": "    Instruction *I = Worklist.pop_back_val();",
          "new_line_content": "  Worklist.push_back(&Allocation);",
          "content_same": false
        },
        {
          "line": 778,
          "old_api": "assert",
          "new_api": "insert",
          "old_text": "assert(0 && \"These should be canonicalized away\")",
          "new_text": "InvolvedInstructions.insert(I)",
          "old_line_content": "      assert(0 && \"These should be canonicalized away\");",
          "new_line_content": "    if (!InvolvedInstructions.insert(I)) continue;",
          "content_same": false
        },
        {
          "line": 822,
          "old_api": "dyn_cast<StoreInst>(User)",
          "new_api": "cast<Instruction>(*UI)",
          "old_text": "dyn_cast<StoreInst>(User)",
          "new_text": "cast<Instruction>(*UI)",
          "old_line_content": "      if (StoreInst *SI = dyn_cast<StoreInst>(User)) {",
          "new_line_content": "      Instruction *User = cast<Instruction>(*UI);",
          "content_same": false
        },
        {
          "line": 831,
          "old_api": "dyn_cast<MemIntrinsic>(User)",
          "new_api": "insert",
          "old_text": "dyn_cast<MemIntrinsic>(User)",
          "new_text": "InvolvedInstructions.insert(SI)",
          "old_line_content": "      if (MemIntrinsic *MI = dyn_cast<MemIntrinsic>(User)) {",
          "new_line_content": "          InvolvedInstructions.insert(SI);",
          "content_same": false
        },
        {
          "line": 858,
          "old_api": "getType",
          "new_api": "count",
          "old_text": "I->getType()",
          "new_text": "InvolvedInstructions.count(BBI)",
          "old_line_content": "      I->replaceAllUsesWith(UndefValue::get(I->getType()));",
          "new_line_content": "  while (InvolvedInstructions.count(BBI))",
          "content_same": false
        },
        {
          "line": 884,
          "old_api": "cast<CallInst>(I)",
          "new_api": "classifyInstruction",
          "old_text": "cast<CallInst>(I)",
          "new_text": "classifyInstruction(I)",
          "old_line_content": "        Changed |= performLocalReleaseMotion(cast<CallInst>(I), BB);",
          "new_line_content": "      switch (classifyInstruction(I)) {",
          "content_same": false
        },
        {
          "line": 987,
          "old_api": "FindInsertedValue",
          "new_api": "getNumElements",
          "old_text": "FindInsertedValue(RetVal, i)",
          "new_text": "RetSTy->getNumElements()",
          "old_line_content": "    RetVals[i] = FindInsertedValue(RetVal, i);",
          "new_line_content": "  if (RetSTy == 0 || RetSTy->getNumElements() != 3) return false;",
          "content_same": false
        },
        {
          "line": 1069,
          "old_api": "getParent",
          "new_api": "getType",
          "old_text": "TheReturn->getParent()->getParent()",
          "new_text": "Elt->getType()",
          "old_line_content": "  Function &F = *TheReturn->getParent()->getParent();",
          "new_line_content": "    if (isa<PointerType>(Elt->getType()))",
          "content_same": false
        },
        {
          "line": 1087,
          "old_api": "getType",
          "new_api": "CreateExtractValue",
          "old_text": "RetVal->getType()",
          "new_text": "B.CreateExtractValue(NR, i)",
          "old_line_content": "  Value *RV = UndefValue::get(RetVal->getType());",
          "new_line_content": "    RetVals[i] = B.CreateExtractValue(NR, i);",
          "content_same": false
        },
        {
          "line": 1089,
          "old_api": "CreateInsertValue",
          "new_api": "getElementType",
          "old_text": "B.CreateInsertValue(RV, RetVals[i], i)",
          "new_text": "RetSTy->getElementType(i)",
          "old_line_content": "    RV = B.CreateInsertValue(RV, RetVals[i], i);",
          "new_line_content": "      RetVals[i] = B.CreateIntToPtr(RetVals[i], RetSTy->getElementType(i));",
          "content_same": false
        },
        {
          "line": 1093,
          "old_api": "setOperand",
          "new_api": "getType",
          "old_text": "TheReturn->setOperand(0, RV)",
          "new_text": "RetVal->getType()",
          "old_line_content": "  TheReturn->setOperand(0, RV);",
          "new_line_content": "  Value *RV = UndefValue::get(RetVal->getType());",
          "content_same": false
        },
        {
          "line": 1099,
          "old_api": "eraseFromParent",
          "new_api": "setOperand",
          "old_text": "TheRetain->eraseFromParent()",
          "new_text": "TheReturn->setOperand(0, RV)",
          "old_line_content": "  TheRetain->eraseFromParent();",
          "new_line_content": "  TheReturn->setOperand(0, RV);",
          "content_same": false
        },
        {
          "line": 1183,
          "old_api": "push_back",
          "new_api": "setArgOperand",
          "old_text": "GlobalEntry.push_back(&CI)",
          "new_text": "CI.setArgOperand(0, LocalEntry)",
          "old_line_content": "        GlobalEntry.push_back(&CI);",
          "new_line_content": "          CI.setArgOperand(0, LocalEntry);",
          "content_same": false
        },
        {
          "line": 1208,
          "old_api": "clear",
          "new_api": "getNumOperands",
          "old_text": "LocalUpdates.clear()",
          "new_text": "Inst.getNumOperands()",
          "old_line_content": "    LocalUpdates.clear();",
          "new_line_content": "      for (unsigned i = 0, e = Inst.getNumOperands(); i != e; ++i)",
          "content_same": false
        },
        {
          "line": 1227,
          "old_api": "getName",
          "new_api": "getEntryBlock",
          "old_text": "Ptr->getName()",
          "new_text": "F.getEntryBlock()",
          "old_line_content": "    Updater.Initialize(Ptr->getType(), Ptr->getName());",
          "new_line_content": "      PtrBlock = &F.getEntryBlock();",
          "content_same": false
        },
        {
          "line": 1250,
          "old_api": "isa<PHINode>(User)",
          "new_api": "getUse",
          "old_text": "isa<PHINode>(User)",
          "new_text": "UI.getUse()",
          "old_line_content": "      if (User->getParent() == PtrBlock && !isa<PHINode>(User))",
          "new_line_content": "      Use &U = UI.getUse();",
          "content_same": false
        },
        {
          "line": 1256,
          "old_api": "get",
          "new_api": "isa<PHINode>(User)",
          "old_text": "U.get()",
          "new_text": "isa<PHINode>(User)",
          "old_line_content": "      if (U.get() != Ptr)",
          "new_line_content": "      if (User->getParent() == PtrBlock && !isa<PHINode>(User))",
          "content_same": false
        },
        {
          "line": 1286,
          "old_api": "PassRegistry::getPassRegistry()",
          "new_api": "performARCExpansion",
          "old_text": "PassRegistry::getPassRegistry()",
          "new_text": "performARCExpansion(F)",
          "old_line_content": "      initializeSwiftARCExpandPassPass(*PassRegistry::getPassRegistry());",
          "new_line_content": "      return performARCExpansion(F);",
          "content_same": false
        },
        {
          "line": 1292,
          "old_api": "INITIALIZE_PASS",
          "new_api": "PassRegistry::getPassRegistry()",
          "old_text": "INITIALIZE_PASS(SwiftARCExpandPass,\n                \"swift-arc-expand\", \"Swift ARC expansion\", false, false)",
          "new_text": "PassRegistry::getPassRegistry()",
          "old_line_content": "INITIALIZE_PASS(SwiftARCExpandPass,",
          "new_line_content": "      initializeSwiftARCExpandPassPass(*PassRegistry::getPassRegistry());",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1031,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "RetainedPointers.empty()",
          "old_line_content": "  for (unsigned i = 0; i != 3; ++i) {",
          "new_line_content": "  if (RetainedPointers.empty())",
          "content_same": false
        },
        {
          "line": 1044,
          "old_api": null,
          "new_api": "dyn_cast<CallInst>(RetVals[i])",
          "old_text": null,
          "new_text": "dyn_cast<CallInst>(RetVals[i])",
          "old_line_content": "",
          "new_line_content": "    if (CallInst *CI = dyn_cast<CallInst>(RetVals[i]))",
          "content_same": false
        },
        {
          "line": 1045,
          "old_api": null,
          "new_api": "classifyInstruction",
          "old_text": null,
          "new_text": "classifyInstruction(*CI)",
          "old_line_content": "  // If none of the three values was retained, we can't form a return3.",
          "new_line_content": "      if (classifyInstruction(*CI) == RT_Retain) {",
          "content_same": false
        },
        {
          "line": 1046,
          "old_api": null,
          "new_api": "getArgOperand",
          "old_text": null,
          "new_text": "CI->getArgOperand(0)",
          "old_line_content": "  if (TheRetain == 0)",
          "new_line_content": "        TheRetain = RetainedPointers[CI->getArgOperand(0)];",
          "content_same": false
        },
        {
          "line": 1058,
          "old_api": null,
          "new_api": "getArgOperand",
          "old_text": null,
          "new_text": "TheRetain->getArgOperand(0)",
          "old_line_content": "  // The swift_retainAndReturnThree function takes the three arguments as i64.",
          "new_line_content": "  Value *RetainedObject = TheRetain->getArgOperand(0);",
          "content_same": false
        },
        {
          "line": 1062,
          "old_api": null,
          "new_api": "getInt64Ty",
          "old_text": null,
          "new_text": "B.getInt64Ty()",
          "old_line_content": "  for (Value *&Elt : RetVals) {",
          "new_line_content": "  Type *Int64Ty = B.getInt64Ty();",
          "content_same": false
        },
        {
          "line": 1070,
          "old_api": null,
          "new_api": "CreatePtrToInt",
          "old_text": null,
          "new_text": "B.CreatePtrToInt(Elt, Int64Ty)",
          "old_line_content": "  Constant *Cache = 0;  // Not utilized.",
          "new_line_content": "      Elt = B.CreatePtrToInt(Elt, Int64Ty);",
          "content_same": false
        },
        {
          "line": 1075,
          "old_api": null,
          "new_api": "getParent",
          "old_text": null,
          "new_text": "TheReturn->getParent()->getParent()",
          "old_line_content": "",
          "new_line_content": "  Function &F = *TheReturn->getParent()->getParent();",
          "content_same": false
        },
        {
          "line": 1077,
          "old_api": null,
          "new_api": "getType",
          "old_text": null,
          "new_text": "RetainedObject->getType()",
          "old_line_content": "  // the pointers is a pointer (we retained it afterall!) we have to unpack",
          "new_line_content": "  Value *LibCall = getRetainAndReturnThree(F,RetainedObject->getType(),Cache);",
          "content_same": false
        },
        {
          "line": 1078,
          "old_api": null,
          "new_api": "CreateCall4",
          "old_text": null,
          "new_text": "B.CreateCall4(LibCall, RetainedObject, RetVals[0],RetVals[1],\n                               RetVals[2])",
          "old_line_content": "  // the elements, bitcast at least that one, and then repack to the proper",
          "new_line_content": "  CallInst *NR = B.CreateCall4(LibCall, RetainedObject, RetVals[0],RetVals[1],",
          "content_same": false
        },
        {
          "line": 1080,
          "old_api": null,
          "new_api": "setTailCall",
          "old_text": null,
          "new_text": "NR->setTailCall(true)",
          "old_line_content": "  for (unsigned i = 0; i != 3; ++i) {",
          "new_line_content": "  NR->setTailCall(true);",
          "content_same": false
        },
        {
          "line": 1088,
          "old_api": null,
          "new_api": "getElementType",
          "old_text": null,
          "new_text": "RetSTy->getElementType(i)",
          "old_line_content": "  for (unsigned i = 0; i != 3; ++i)",
          "new_line_content": "    if (RetVals[i]->getType() != RetSTy->getElementType(i))",
          "content_same": false
        },
        {
          "line": 1095,
          "old_api": null,
          "new_api": "CreateInsertValue",
          "old_text": null,
          "new_text": "B.CreateInsertValue(RV, RetVals[i], i)",
          "old_line_content": "",
          "new_line_content": "    RV = B.CreateInsertValue(RV, RetVals[i], i);",
          "content_same": false
        },
        {
          "line": 1100,
          "old_api": null,
          "new_api": "RecursivelyDeleteTriviallyDeadInstructions",
          "old_text": null,
          "new_text": "RecursivelyDeleteTriviallyDeadInstructions(RetVal)",
          "old_line_content": "  ++NumReturnThreeTailCallsFormed;",
          "new_line_content": "  RecursivelyDeleteTriviallyDeadInstructions(RetVal);",
          "content_same": false
        },
        {
          "line": 1103,
          "old_api": null,
          "new_api": "use_empty",
          "old_text": null,
          "new_text": "TheRetain->use_empty()",
          "old_line_content": "",
          "new_line_content": "  if (!TheRetain->use_empty())",
          "content_same": false
        },
        {
          "line": 1104,
          "old_api": null,
          "new_api": "replaceAllUsesWith",
          "old_text": null,
          "new_text": "TheRetain->replaceAllUsesWith(RetainedObject)",
          "old_line_content": "//===----------------------------------------------------------------------===//",
          "new_line_content": "    TheRetain->replaceAllUsesWith(RetainedObject);",
          "content_same": false
        },
        {
          "line": 1105,
          "old_api": null,
          "new_api": "eraseFromParent",
          "old_text": null,
          "new_text": "TheRetain->eraseFromParent()",
          "old_line_content": "//                        SwiftARCExpandPass Pass",
          "new_line_content": "  TheRetain->eraseFromParent();",
          "content_same": false
        },
        {
          "line": 1149,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "BB.end()",
          "old_line_content": "      case RT_RetainAndReturnThree:",
          "new_line_content": "    for (auto II = BB.begin(), E = BB.end(); II != E; ) {",
          "content_same": false
        },
        {
          "line": 1153,
          "old_api": null,
          "new_api": "classifyInstruction",
          "old_text": null,
          "new_text": "classifyInstruction(Inst)",
          "old_line_content": "        // First step: rewrite swift_retain_noresult to swift_retain, exposing",
          "new_line_content": "      switch (classifyInstruction(Inst)) {",
          "content_same": false
        },
        {
          "line": 1154,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(0 && \"This should be canonicalized away!\")",
          "old_line_content": "        // the result value.",
          "new_line_content": "      case RT_Retain: assert(0 && \"This should be canonicalized away!\");",
          "content_same": false
        },
        {
          "line": 1157,
          "old_api": null,
          "new_api": "getArgOperand",
          "old_text": null,
          "new_text": "cast<CallInst>(Inst).getArgOperand(0)",
          "old_line_content": "                             ArgVal, \"\", &Inst);",
          "new_line_content": "        Value *ArgVal = cast<CallInst>(Inst).getArgOperand(0);",
          "content_same": false
        },
        {
          "line": 1162,
          "old_api": null,
          "new_api": "getType",
          "old_text": null,
          "new_text": "ArgVal->getType()",
          "old_line_content": "          continue;",
          "new_line_content": "           *CallInst::Create(getRetain(F, ArgVal->getType(), RetainCache),",
          "content_same": false
        },
        {
          "line": 1164,
          "old_api": null,
          "new_api": "setTailCall",
          "old_text": null,
          "new_text": "CI.setTailCall(true)",
          "old_line_content": "        TinyPtrVector<Instruction*> &GlobalEntry = DefsOfValue[ArgVal];",
          "new_line_content": "        CI.setTailCall(true);",
          "content_same": false
        },
        {
          "line": 1165,
          "old_api": null,
          "new_api": "eraseFromParent",
          "old_text": null,
          "new_text": "Inst.eraseFromParent()",
          "old_line_content": "",
          "new_line_content": "        Inst.eraseFromParent();",
          "content_same": false
        },
        {
          "line": 1167,
          "old_api": null,
          "new_api": "isa<Instruction>(ArgVal)",
          "old_text": null,
          "new_text": "isa<Instruction>(ArgVal)",
          "old_line_content": "        // we've seen, keep track of it in DefOrder.",
          "new_line_content": "        if (!isa<Instruction>(ArgVal))",
          "content_same": false
        },
        {
          "line": 1174,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "GlobalEntry.empty()",
          "old_line_content": "        Value *&LocalEntry = LocalUpdates[ArgVal];",
          "new_line_content": "        if (GlobalEntry.empty())",
          "content_same": false
        },
        {
          "line": 1175,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "DefOrder.push_back(ArgVal)",
          "old_line_content": "        if (LocalEntry) {",
          "new_line_content": "          DefOrder.push_back(ArgVal);",
          "content_same": false
        },
        {
          "line": 1184,
          "old_api": null,
          "new_api": "back",
          "old_text": null,
          "new_text": "GlobalEntry.back()",
          "old_line_content": "        continue;",
          "new_line_content": "          assert(GlobalEntry.back() == LocalEntry && \"Local/Global mismatch?\");",
          "content_same": false
        },
        {
          "line": 1185,
          "old_api": null,
          "new_api": "pop_back",
          "old_text": null,
          "new_text": "GlobalEntry.pop_back()",
          "old_line_content": "      }",
          "new_line_content": "          GlobalEntry.pop_back();",
          "content_same": false
        },
        {
          "line": 1189,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "GlobalEntry.push_back(&CI)",
          "old_line_content": "      case RT_NoMemoryAccessed:",
          "new_line_content": "        GlobalEntry.push_back(&CI);",
          "content_same": false
        },
        {
          "line": 1199,
          "old_api": null,
          "new_api": "dyn_cast<ReturnInst>(&Inst)",
          "old_text": null,
          "new_text": "dyn_cast<ReturnInst>(&Inst)",
          "old_line_content": "      ",
          "new_line_content": "        if (ReturnInst *RI = dyn_cast<ReturnInst>(&Inst))",
          "content_same": false
        },
        {
          "line": 1200,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "Returns.push_back(RI)",
          "old_line_content": "      // Check to see if there are any uses of a value in the LocalUpdates",
          "new_line_content": "          Returns.push_back(RI);",
          "content_same": false
        },
        {
          "line": 1209,
          "old_api": null,
          "new_api": "getOperand",
          "old_text": null,
          "new_text": "Inst.getOperand(i)",
          "old_line_content": "  }",
          "new_line_content": "        if (Value *V = LocalUpdates.lookup(Inst.getOperand(i))) {",
          "content_same": false
        },
        {
          "line": 1211,
          "old_api": null,
          "new_api": "setOperand",
          "old_text": null,
          "new_text": "Inst.setOperand(i, V)",
          "old_line_content": "  // Now that we've collected all of the interesting heap object values that are",
          "new_line_content": "          Inst.setOperand(i, V);",
          "content_same": false
        },
        {
          "line": 1214,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "LocalUpdates.clear()",
          "old_line_content": "  for (Value *Ptr : DefOrder) {",
          "new_line_content": "    LocalUpdates.clear();",
          "content_same": false
        },
        {
          "line": 1224,
          "old_api": null,
          "new_api": "dyn_cast<Instruction>(Ptr)",
          "old_text": null,
          "new_text": "dyn_cast<Instruction>(Ptr)",
          "old_line_content": "    // This is the same problem as SSA construction, so we just use LLVM's",
          "new_line_content": "    if (Instruction *PI = dyn_cast<Instruction>(Ptr))",
          "content_same": false
        },
        {
          "line": 1225,
          "old_api": null,
          "new_api": "getParent",
          "old_text": null,
          "new_text": "PI->getParent()",
          "old_line_content": "    // SSAUpdater, with each retain as a definition of the virtual value.",
          "new_line_content": "      PtrBlock = PI->getParent();",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": null,
          "new_api": "onlyReadsMemory",
          "old_text": null,
          "new_text": "DtorFn->onlyReadsMemory()",
          "old_line_content": "",
          "new_line_content": "  if (DtorFn->onlyReadsMemory())",
          "content_same": false
        },
        {
          "line": 1233,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "Ptr->getName()",
          "old_line_content": "    ",
          "new_line_content": "    Updater.Initialize(Ptr->getType(), Ptr->getName());",
          "content_same": false
        },
        {
          "line": 725,
          "old_api": null,
          "new_api": "isVarArg",
          "old_text": null,
          "new_text": "DtorFn->isVarArg()",
          "old_line_content": "      // Ignore all instructions with side effects.",
          "new_line_content": "  assert(DtorFn->arg_size() == 1 && !DtorFn->isVarArg() &&",
          "content_same": false
        },
        {
          "line": 1238,
          "old_api": null,
          "new_api": "getParent",
          "old_text": null,
          "new_text": "D->getParent()",
          "old_line_content": "      ",
          "new_line_content": "      Updater.AddAvailableValue(D->getParent(), D);",
          "content_same": false
        },
        {
          "line": 1242,
          "old_api": null,
          "new_api": "HasValueForBlock",
          "old_text": null,
          "new_text": "Updater.HasValueForBlock(PtrBlock)",
          "old_line_content": "      // Make sure to increment the use iterator before potentially rewriting",
          "new_line_content": "    if (!Updater.HasValueForBlock(PtrBlock))",
          "content_same": false
        },
        {
          "line": 1243,
          "old_api": null,
          "new_api": "AddAvailableValue",
          "old_text": null,
          "new_text": "Updater.AddAvailableValue(PtrBlock, Ptr)",
          "old_line_content": "      // it.",
          "new_line_content": "      Updater.AddAvailableValue(PtrBlock, Ptr);",
          "content_same": false
        },
        {
          "line": 732,
          "old_api": null,
          "new_api": "mayHaveSideEffects",
          "old_text": null,
          "new_text": "I.mayHaveSideEffects()",
          "old_line_content": "      // Okay, the function has some side effects, if it doesn't capture the",
          "new_line_content": "      if (!I.mayHaveSideEffects()) continue;",
          "content_same": false
        },
        {
          "line": 1247,
          "old_api": null,
          "new_api": "use_end",
          "old_text": null,
          "new_text": "Ptr->use_end()",
          "old_line_content": "      // If the use is in the same block that defines it and the User is not a",
          "new_line_content": "    for (auto UI = Ptr->use_begin(), E = Ptr->use_end(); UI != E; ) {",
          "content_same": false
        },
        {
          "line": 740,
          "old_api": null,
          "new_api": "doesNotCapture",
          "old_text": null,
          "new_text": "DtorFn->doesNotCapture(0)",
          "old_line_content": "}",
          "new_line_content": "      return DtorFn->doesNotCapture(0) ? DtorKind::NoEscape : DtorKind::Unknown;",
          "content_same": false
        },
        {
          "line": 1255,
          "old_api": null,
          "new_api": "getUser",
          "old_text": null,
          "new_text": "U.getUser()",
          "old_line_content": "      ",
          "new_line_content": "      Instruction *User = cast<Instruction>(U.getUser());",
          "content_same": false
        },
        {
          "line": 1260,
          "old_api": null,
          "new_api": "RewriteUse",
          "old_text": null,
          "new_text": "Updater.RewriteUse(U)",
          "old_line_content": "",
          "new_line_content": "      Updater.RewriteUse(U);",
          "content_same": false
        },
        {
          "line": 1262,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "U.get()",
          "old_line_content": "  for (ReturnInst *RI : Returns)",
          "new_line_content": "      if (U.get() != Ptr)",
          "content_same": false
        },
        {
          "line": 756,
          "old_api": null,
          "new_api": "getArgOperand",
          "old_text": null,
          "new_text": "Allocation.getArgOperand(0)",
          "old_line_content": "  // Do a depth first search exploring all of the uses of the object pointer,",
          "new_line_content": "  DtorKind DtorInfo = analyzeDestructor(Allocation.getArgOperand(0));",
          "content_same": false
        },
        {
          "line": 1269,
          "old_api": null,
          "new_api": "optimizeReturn3",
          "old_text": null,
          "new_text": "optimizeReturn3(RI)",
          "old_line_content": "",
          "new_line_content": "    Changed |= optimizeReturn3(RI);",
          "content_same": false
        },
        {
          "line": 1283,
          "old_api": null,
          "new_api": "setPreservesCFG",
          "old_text": null,
          "new_text": "AU.setPreservesCFG()",
          "old_line_content": "  public:",
          "new_line_content": "      AU.setPreservesCFG();",
          "content_same": false
        },
        {
          "line": 773,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "Worklist.empty()",
          "old_line_content": "    ",
          "new_line_content": "  while (!Worklist.empty()) {",
          "content_same": false
        },
        {
          "line": 774,
          "old_api": null,
          "new_api": "pop_back_val",
          "old_text": null,
          "new_text": "Worklist.pop_back_val()",
          "old_line_content": "    // Okay, this is the first time we've seen this instruction, proceed.",
          "new_line_content": "    Instruction *I = Worklist.pop_back_val();",
          "content_same": false
        },
        {
          "line": 781,
          "old_api": null,
          "new_api": "classifyInstruction",
          "old_text": null,
          "new_text": "classifyInstruction(*I)",
          "old_line_content": "      // If this is a different swift_allocObject than we started with, then",
          "new_line_content": "    switch (classifyInstruction(*I)) {",
          "content_same": false
        },
        {
          "line": 784,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(0 && \"These should be canonicalized away\")",
          "old_line_content": "      // well.",
          "new_line_content": "      assert(0 && \"These should be canonicalized away\");",
          "content_same": false
        },
        {
          "line": 1298,
          "old_api": null,
          "new_api": "INITIALIZE_PASS",
          "old_text": null,
          "new_text": "INITIALIZE_PASS(SwiftARCExpandPass,\n                \"swift-arc-expand\", \"Swift ARC expansion\", false, false)",
          "old_line_content": "",
          "new_line_content": "INITIALIZE_PASS(SwiftARCExpandPass,",
          "content_same": false
        },
        {
          "line": 798,
          "old_api": null,
          "new_api": "isa<TerminatorInst>(I)",
          "old_text": null,
          "new_text": "isa<TerminatorInst>(I)",
          "old_line_content": "    case RT_Release:",
          "new_line_content": "      if (I->mayHaveSideEffects() || isa<TerminatorInst>(I))",
          "content_same": false
        },
        {
          "line": 821,
          "old_api": null,
          "new_api": "use_end",
          "old_text": null,
          "new_text": "I->use_end()",
          "old_line_content": "      // short-cut the classification scheme above.",
          "new_line_content": "    for (auto UI = I->use_begin(), E = I->use_end(); UI != E; ++UI) {",
          "content_same": false
        },
        {
          "line": 828,
          "old_api": null,
          "new_api": "dyn_cast<StoreInst>(User)",
          "old_text": null,
          "new_text": "dyn_cast<StoreInst>(User)",
          "old_line_content": "        // Otherwise, using the object as a source (or size) is an escape.",
          "new_line_content": "      if (StoreInst *SI = dyn_cast<StoreInst>(User)) {",
          "content_same": false
        },
        {
          "line": 830,
          "old_api": null,
          "new_api": "StoreInst::getPointerOperandIndex()",
          "old_text": null,
          "new_text": "StoreInst::getPointerOperandIndex()",
          "old_line_content": "      }",
          "new_line_content": "        if (UI.getOperandNo() == StoreInst::getPointerOperandIndex()) {",
          "content_same": false
        },
        {
          "line": 837,
          "old_api": null,
          "new_api": "dyn_cast<MemIntrinsic>(User)",
          "old_text": null,
          "new_text": "dyn_cast<MemIntrinsic>(User)",
          "old_line_content": "        // Otherwise, using the object as a source (or size) is an escape.",
          "new_line_content": "      if (MemIntrinsic *MI = dyn_cast<MemIntrinsic>(User)) {",
          "content_same": false
        },
        {
          "line": 839,
          "old_api": null,
          "new_api": "getOperandNo",
          "old_text": null,
          "new_text": "UI.getOperandNo()",
          "old_line_content": "      }",
          "new_line_content": "        if (UI.getOperandNo() == 0) {",
          "content_same": false
        },
        {
          "line": 840,
          "old_api": null,
          "new_api": "insert",
          "old_text": null,
          "new_text": "InvolvedInstructions.insert(MI)",
          "old_line_content": "      ",
          "new_line_content": "          InvolvedInstructions.insert(MI);",
          "content_same": false
        },
        {
          "line": 848,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "Worklist.push_back(User)",
          "old_line_content": "  // don't invalidate \"BBI\" (the iterator the outer walk of the optimization",
          "new_line_content": "      Worklist.push_back(User);",
          "content_same": false
        },
        {
          "line": 863,
          "old_api": null,
          "new_api": "use_empty",
          "old_text": null,
          "new_text": "I->use_empty()",
          "old_line_content": "  return true;",
          "new_line_content": "    if (!I->use_empty())",
          "content_same": false
        },
        {
          "line": 864,
          "old_api": null,
          "new_api": "getType",
          "old_text": null,
          "new_text": "I->getType()",
          "old_line_content": "}",
          "new_line_content": "      I->replaceAllUsesWith(UndefValue::get(I->getType()));",
          "content_same": false
        },
        {
          "line": 865,
          "old_api": null,
          "new_api": "eraseFromParent",
          "old_text": null,
          "new_text": "I->eraseFromParent()",
          "old_line_content": "",
          "new_line_content": "    I->eraseFromParent();",
          "content_same": false
        },
        {
          "line": 879,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "BB.end()",
          "old_line_content": "      default: break;",
          "new_line_content": "    for (BasicBlock::iterator BBI = BB.begin(), E = BB.end(); BBI != E; ) {",
          "content_same": false
        },
        {
          "line": 887,
          "old_api": null,
          "new_api": "cast<CallInst>(I)",
          "old_text": null,
          "new_text": "cast<CallInst>(I)",
          "old_line_content": "      case RT_ObjCRetain: {",
          "new_line_content": "        Changed |= performStoreOnlyObjectElimination(cast<CallInst>(I), BBI);",
          "content_same": false
        },
        {
          "line": 890,
          "old_api": null,
          "new_api": "cast<CallInst>(I)",
          "old_text": null,
          "new_text": "cast<CallInst>(I)",
          "old_line_content": "        BasicBlock::iterator Safe = &I;",
          "new_line_content": "        Changed |= performLocalReleaseMotion(cast<CallInst>(I), BB);",
          "content_same": false
        },
        {
          "line": 897,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "BB.end()",
          "old_line_content": "        }",
          "new_line_content": "        Safe = Safe != BB.begin() ? std::prev(Safe) : BB.end();",
          "content_same": false
        },
        {
          "line": 898,
          "old_api": null,
          "new_api": "cast<CallInst>(I)",
          "old_text": null,
          "new_text": "cast<CallInst>(I)",
          "old_line_content": "        break;",
          "new_line_content": "        if (performLocalRetainMotion(cast<CallInst>(I), BB)) {",
          "content_same": false
        },
        {
          "line": 901,
          "old_api": null,
          "new_api": "begin",
          "old_text": null,
          "new_text": "BB.begin()",
          "old_line_content": "    }",
          "new_line_content": "          BBI = Safe != BB.end() ? std::next(Safe) : BB.begin();",
          "content_same": false
        },
        {
          "line": 925,
          "old_api": null,
          "new_api": "AU.addRequired<SwiftAliasAnalysis>()",
          "old_text": null,
          "new_text": "AU.addRequired<SwiftAliasAnalysis>()",
          "old_line_content": "    static char ID;",
          "new_line_content": "      AU.addRequired<SwiftAliasAnalysis>();",
          "content_same": false
        },
        {
          "line": 926,
          "old_api": null,
          "new_api": "setPreservesCFG",
          "old_text": null,
          "new_text": "AU.setPreservesCFG()",
          "old_line_content": "    SwiftARCOpt() : FunctionPass(ID) {",
          "new_line_content": "      AU.setPreservesCFG();",
          "content_same": false
        },
        {
          "line": 933,
          "old_api": null,
          "new_api": "PassRegistry::getPassRegistry()",
          "old_text": null,
          "new_text": "PassRegistry::getPassRegistry()",
          "old_line_content": "                  \"swift-arc-optimize\", \"Swift ARC optimization\", false, false)",
          "new_line_content": "      initializeSwiftARCOptPass(*PassRegistry::getPassRegistry());",
          "content_same": false
        },
        {
          "line": 938,
          "old_api": null,
          "new_api": "INITIALIZE_PASS_BEGIN",
          "old_text": null,
          "new_text": "INITIALIZE_PASS_BEGIN(SwiftARCOpt,\n                  \"swift-arc-optimize\", \"Swift ARC optimization\", false, false)",
          "old_line_content": "// Optimization passes.",
          "new_line_content": "INITIALIZE_PASS_BEGIN(SwiftARCOpt,",
          "content_same": false
        },
        {
          "line": 940,
          "old_api": null,
          "new_api": "INITIALIZE_PASS_DEPENDENCY",
          "old_text": null,
          "new_text": "INITIALIZE_PASS_DEPENDENCY(SwiftAliasAnalysis)",
          "old_line_content": "  return new SwiftARCOpt();",
          "new_line_content": "INITIALIZE_PASS_DEPENDENCY(SwiftAliasAnalysis)",
          "content_same": false
        },
        {
          "line": 941,
          "old_api": null,
          "new_api": "INITIALIZE_PASS_END",
          "old_text": null,
          "new_text": "INITIALIZE_PASS_END(SwiftARCOpt,\n                    \"swift-arc-optimize\", \"Swift ARC optimization\", false,false)",
          "old_line_content": "}",
          "new_line_content": "INITIALIZE_PASS_END(SwiftARCOpt,",
          "content_same": false
        },
        {
          "line": 956,
          "old_api": null,
          "new_api": "canonicalizeInputFunction",
          "old_text": null,
          "new_text": "canonicalizeInputFunction(F)",
          "old_line_content": "  // 2) deletion of stored-only objects - objects that are allocated and",
          "new_line_content": "  Changed |= canonicalizeInputFunction(F);",
          "content_same": false
        },
        {
          "line": 965,
          "old_api": null,
          "new_api": "performGeneralOptimizations",
          "old_text": null,
          "new_text": "performGeneralOptimizations(F)",
          "old_line_content": "",
          "new_line_content": "  Changed |= performGeneralOptimizations(F);",
          "content_same": false
        },
        {
          "line": 982,
          "old_api": null,
          "new_api": "getNumOperands",
          "old_text": null,
          "new_text": "TheReturn->getNumOperands()",
          "old_line_content": "",
          "new_line_content": "  if (TheReturn->getNumOperands() == 0) return false;",
          "content_same": false
        },
        {
          "line": 985,
          "old_api": null,
          "new_api": "getOperand",
          "old_text": null,
          "new_text": "TheReturn->getOperand(0)",
          "old_line_content": "  Value *RetVals[3];",
          "new_line_content": "  Value *RetVal = TheReturn->getOperand(0);",
          "content_same": false
        },
        {
          "line": 986,
          "old_api": null,
          "new_api": "getType",
          "old_text": null,
          "new_text": "RetVal->getType()",
          "old_line_content": "  for (unsigned i = 0; i != 3; ++i) {",
          "new_line_content": "  StructType *RetSTy = dyn_cast<StructType>(RetVal->getType());",
          "content_same": false
        },
        {
          "line": 993,
          "old_api": null,
          "new_api": "FindInsertedValue",
          "old_text": null,
          "new_text": "FindInsertedValue(RetVal, i)",
          "old_line_content": "      return false;",
          "new_line_content": "    RetVals[i] = FindInsertedValue(RetVal, i);",
          "content_same": false
        },
        {
          "line": 997,
          "old_api": null,
          "new_api": "getType",
          "old_text": null,
          "new_text": "RetVals[i]->getType()",
          "old_line_content": "  // return, past any insertvalues.  We tolerate other non-memory instructions",
          "new_line_content": "    if (!isa<PointerType>(RetVals[i]->getType()) &&",
          "content_same": false
        },
        {
          "line": 998,
          "old_api": null,
          "new_api": "getType",
          "old_text": null,
          "new_text": "RetVals[i]->getType()->isIntegerTy(64)",
          "old_line_content": "  // though, in case other optimizations have moved them around.  Collect all",
          "new_line_content": "        !RetVals[i]->getType()->isIntegerTy(64))",
          "content_same": false
        },
        {
          "line": 1008,
          "old_api": null,
          "new_api": "getParent",
          "old_text": null,
          "new_text": "TheReturn->getParent()->begin()",
          "old_line_content": "      // Collect retained pointers.  If a pointer is multiply retained, it",
          "new_line_content": "  for (BasicBlock::iterator BBI = TheReturn,E = TheReturn->getParent()->begin();",
          "content_same": false
        },
        {
          "line": 1012,
          "old_api": null,
          "new_api": "classifyInstruction",
          "old_text": null,
          "new_text": "classifyInstruction(I)",
          "old_line_content": "      break;",
          "new_line_content": "    switch (classifyInstruction(I)) {",
          "content_same": false
        },
        {
          "line": 1016,
          "old_api": null,
          "new_api": "cast<CallInst>(I)",
          "old_text": null,
          "new_text": "cast<CallInst>(I)",
          "old_line_content": "      break;",
          "new_line_content": "      CallInst &TheRetain = cast<CallInst>(I);",
          "content_same": false
        },
        {
          "line": 1017,
          "old_api": null,
          "new_api": "getArgOperand",
          "old_text": null,
          "new_text": "TheRetain.getArgOperand(0)",
          "old_line_content": "    default:",
          "new_line_content": "      RetainedPointers[TheRetain.getArgOperand(0)] = &TheRetain;",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1025,
          "old_api": "empty",
          "new_api": null,
          "old_text": "RetainedPointers.empty()",
          "new_text": null,
          "old_line_content": "  if (RetainedPointers.empty())",
          "new_line_content": "      BBI = E;",
          "content_same": false
        },
        {
          "line": 1038,
          "old_api": "dyn_cast<CallInst>(RetVals[i])",
          "new_api": null,
          "old_text": "dyn_cast<CallInst>(RetVals[i])",
          "new_text": null,
          "old_line_content": "    if (CallInst *CI = dyn_cast<CallInst>(RetVals[i]))",
          "new_line_content": "    // If the return value is also retained, we found our retain.",
          "content_same": false
        },
        {
          "line": 1039,
          "old_api": "classifyInstruction",
          "new_api": null,
          "old_text": "classifyInstruction(*CI)",
          "new_text": null,
          "old_line_content": "      if (classifyInstruction(*CI) == RT_Retain) {",
          "new_line_content": "    TheRetain = RetainedPointers[RetVals[i]];",
          "content_same": false
        },
        {
          "line": 1040,
          "old_api": "getArgOperand",
          "new_api": null,
          "old_text": "CI->getArgOperand(0)",
          "new_text": null,
          "old_line_content": "        TheRetain = RetainedPointers[CI->getArgOperand(0)];",
          "new_line_content": "    if (TheRetain) break;",
          "content_same": false
        },
        {
          "line": 1052,
          "old_api": "getArgOperand",
          "new_api": null,
          "old_text": "TheRetain->getArgOperand(0)",
          "new_text": null,
          "old_line_content": "  Value *RetainedObject = TheRetain->getArgOperand(0);",
          "new_line_content": "  if (TheRetain == 0)",
          "content_same": false
        },
        {
          "line": 1056,
          "old_api": "getInt64Ty",
          "new_api": null,
          "old_text": "B.getInt64Ty()",
          "new_text": null,
          "old_line_content": "  Type *Int64Ty = B.getInt64Ty();",
          "new_line_content": "  // argument to swift_retain (the result will be zapped when we zap the call)",
          "content_same": false
        },
        {
          "line": 1063,
          "old_api": "getType",
          "new_api": null,
          "old_text": "Elt->getType()",
          "new_text": null,
          "old_line_content": "    if (isa<PointerType>(Elt->getType()))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1064,
          "old_api": "CreatePtrToInt",
          "new_api": null,
          "old_text": "B.CreatePtrToInt(Elt, Int64Ty)",
          "new_text": null,
          "old_line_content": "      Elt = B.CreatePtrToInt(Elt, Int64Ty);",
          "new_line_content": "  // The swift_retainAndReturnThree function takes the three arguments as i64.",
          "content_same": false
        },
        {
          "line": 1071,
          "old_api": "getType",
          "new_api": null,
          "old_text": "RetainedObject->getType()",
          "new_text": null,
          "old_line_content": "  Value *LibCall = getRetainAndReturnThree(F,RetainedObject->getType(),Cache);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 1072,
          "old_api": "CreateCall4",
          "new_api": null,
          "old_text": "B.CreateCall4(LibCall, RetainedObject, RetVals[0],RetVals[1],\n                               RetVals[2])",
          "new_text": null,
          "old_line_content": "  CallInst *NR = B.CreateCall4(LibCall, RetainedObject, RetVals[0],RetVals[1],",
          "new_line_content": "    ",
          "content_same": false
        },
        {
          "line": 1074,
          "old_api": "setTailCall",
          "new_api": null,
          "old_text": "NR->setTailCall(true)",
          "new_text": null,
          "old_line_content": "  NR->setTailCall(true);",
          "new_line_content": "  // i64's.",
          "content_same": false
        },
        {
          "line": 1081,
          "old_api": "CreateExtractValue",
          "new_api": null,
          "old_text": "B.CreateExtractValue(NR, i)",
          "new_text": null,
          "old_line_content": "    RetVals[i] = B.CreateExtractValue(NR, i);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1082,
          "old_api": "getElementType",
          "new_api": null,
          "old_text": "RetSTy->getElementType(i)",
          "new_text": null,
          "old_line_content": "    if (RetVals[i]->getType() != RetSTy->getElementType(i))",
          "new_line_content": "  // The return type of the libcall is (i64,i64,i64).  Since at least one of",
          "content_same": false
        },
        {
          "line": 1083,
          "old_api": "getElementType",
          "new_api": null,
          "old_text": "RetSTy->getElementType(i)",
          "new_text": null,
          "old_line_content": "      RetVals[i] = B.CreateIntToPtr(RetVals[i], RetSTy->getElementType(i));",
          "new_line_content": "  // the pointers is a pointer (we retained it afterall!) we have to unpack",
          "content_same": false
        },
        {
          "line": 1094,
          "old_api": "RecursivelyDeleteTriviallyDeadInstructions",
          "new_api": null,
          "old_text": "RecursivelyDeleteTriviallyDeadInstructions(RetVal)",
          "new_text": null,
          "old_line_content": "  RecursivelyDeleteTriviallyDeadInstructions(RetVal);",
          "new_line_content": "  for (unsigned i = 0; i != 3; ++i)",
          "content_same": false
        },
        {
          "line": 1097,
          "old_api": "use_empty",
          "new_api": null,
          "old_text": "TheRetain->use_empty()",
          "new_text": null,
          "old_line_content": "  if (!TheRetain->use_empty())",
          "new_line_content": "  // Return the right thing and zap any instruction tree of inserts that",
          "content_same": false
        },
        {
          "line": 1098,
          "old_api": "replaceAllUsesWith",
          "new_api": null,
          "old_text": "TheRetain->replaceAllUsesWith(RetainedObject)",
          "new_text": null,
          "old_line_content": "    TheRetain->replaceAllUsesWith(RetainedObject);",
          "new_line_content": "  // existed just to feed the old return.",
          "content_same": false
        },
        {
          "line": 1143,
          "old_api": "end",
          "new_api": null,
          "old_text": "BB.end()",
          "new_text": null,
          "old_line_content": "    for (auto II = BB.begin(), E = BB.end(); II != E; ) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1147,
          "old_api": "classifyInstruction",
          "new_api": null,
          "old_text": "classifyInstruction(Inst)",
          "new_text": null,
          "old_line_content": "      switch (classifyInstruction(Inst)) {",
          "new_line_content": "  DenseMap<Value*, Value*> LocalUpdates;",
          "content_same": false
        },
        {
          "line": 1148,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(0 && \"This should be canonicalized away!\")",
          "new_text": null,
          "old_line_content": "      case RT_Retain: assert(0 && \"This should be canonicalized away!\");",
          "new_line_content": "  for (BasicBlock &BB : F) {",
          "content_same": false
        },
        {
          "line": 1151,
          "old_api": "getArgOperand",
          "new_api": null,
          "old_text": "cast<CallInst>(Inst).getArgOperand(0)",
          "new_text": null,
          "old_line_content": "        Value *ArgVal = cast<CallInst>(Inst).getArgOperand(0);",
          "new_line_content": "      Instruction &Inst = *II++;",
          "content_same": false
        },
        {
          "line": 1156,
          "old_api": "getType",
          "new_api": null,
          "old_text": "ArgVal->getType()",
          "new_text": null,
          "old_line_content": "           *CallInst::Create(getRetain(F, ArgVal->getType(), RetainCache),",
          "new_line_content": "      case RT_RetainNoResult: {",
          "content_same": false
        },
        {
          "line": 1158,
          "old_api": "setTailCall",
          "new_api": null,
          "old_text": "CI.setTailCall(true)",
          "new_text": null,
          "old_line_content": "        CI.setTailCall(true);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1159,
          "old_api": "eraseFromParent",
          "new_api": null,
          "old_text": "Inst.eraseFromParent()",
          "new_text": null,
          "old_line_content": "        Inst.eraseFromParent();",
          "new_line_content": "        // First step: rewrite swift_retain_noresult to swift_retain, exposing",
          "content_same": false
        },
        {
          "line": 1161,
          "old_api": "isa<Instruction>(ArgVal)",
          "new_api": null,
          "old_text": "isa<Instruction>(ArgVal)",
          "new_text": null,
          "old_line_content": "        if (!isa<Instruction>(ArgVal))",
          "new_line_content": "        CallInst &CI =",
          "content_same": false
        },
        {
          "line": 1168,
          "old_api": "empty",
          "new_api": null,
          "old_text": "GlobalEntry.empty()",
          "new_text": null,
          "old_line_content": "        if (GlobalEntry.empty())",
          "new_line_content": "          continue;",
          "content_same": false
        },
        {
          "line": 1169,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "DefOrder.push_back(ArgVal)",
          "new_text": null,
          "old_line_content": "          DefOrder.push_back(ArgVal);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1177,
          "old_api": "setArgOperand",
          "new_api": null,
          "old_text": "CI.setArgOperand(0, LocalEntry)",
          "new_text": null,
          "old_line_content": "          CI.setArgOperand(0, LocalEntry);",
          "new_line_content": "        // Check to see if there is already an entry for this basic block.  If",
          "content_same": false
        },
        {
          "line": 1178,
          "old_api": "back",
          "new_api": null,
          "old_text": "GlobalEntry.back()",
          "new_text": null,
          "old_line_content": "          assert(GlobalEntry.back() == LocalEntry && \"Local/Global mismatch?\");",
          "new_line_content": "        // there is another local entry, switch to using the local value and",
          "content_same": false
        },
        {
          "line": 1179,
          "old_api": "pop_back",
          "new_api": null,
          "old_text": "GlobalEntry.pop_back()",
          "new_text": null,
          "old_line_content": "          GlobalEntry.pop_back();",
          "new_line_content": "        // remove the previous value from the GlobalEntry.",
          "content_same": false
        },
        {
          "line": 1193,
          "old_api": "dyn_cast<ReturnInst>(&Inst)",
          "new_api": null,
          "old_text": "dyn_cast<ReturnInst>(&Inst)",
          "new_text": null,
          "old_line_content": "        if (ReturnInst *RI = dyn_cast<ReturnInst>(&Inst))",
          "new_line_content": "      case RT_Release:",
          "content_same": false
        },
        {
          "line": 1194,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "Returns.push_back(RI)",
          "new_text": null,
          "old_line_content": "          Returns.push_back(RI);",
          "new_line_content": "      case RT_AllocObject:",
          "content_same": false
        },
        {
          "line": 1202,
          "old_api": "getNumOperands",
          "new_api": null,
          "old_text": "Inst.getNumOperands()",
          "new_text": null,
          "old_line_content": "      for (unsigned i = 0, e = Inst.getNumOperands(); i != e; ++i)",
          "new_line_content": "        // Just remap any uses in the value.",
          "content_same": false
        },
        {
          "line": 1203,
          "old_api": "getOperand",
          "new_api": null,
          "old_text": "Inst.getOperand(i)",
          "new_text": null,
          "old_line_content": "        if (Value *V = LocalUpdates.lookup(Inst.getOperand(i))) {",
          "new_line_content": "        break;",
          "content_same": false
        },
        {
          "line": 1205,
          "old_api": "setOperand",
          "new_api": null,
          "old_text": "Inst.setOperand(i, V)",
          "new_text": null,
          "old_line_content": "          Inst.setOperand(i, V);",
          "new_line_content": "      ",
          "content_same": false
        },
        {
          "line": 1218,
          "old_api": "dyn_cast<Instruction>(Ptr)",
          "new_api": null,
          "old_text": "dyn_cast<Instruction>(Ptr)",
          "new_text": null,
          "old_line_content": "    if (Instruction *PI = dyn_cast<Instruction>(Ptr))",
          "new_line_content": "  // passed into argument-returning functions, rewrite uses of these pointers",
          "content_same": false
        },
        {
          "line": 1219,
          "old_api": "getParent",
          "new_api": null,
          "old_text": "PI->getParent()",
          "new_text": null,
          "old_line_content": "      PtrBlock = PI->getParent();",
          "new_line_content": "  // with optimized lifetime-shorted versions of it.",
          "content_same": false
        },
        {
          "line": 1221,
          "old_api": "getEntryBlock",
          "new_api": null,
          "old_text": "F.getEntryBlock()",
          "new_text": null,
          "old_line_content": "      PtrBlock = &F.getEntryBlock();",
          "new_line_content": "    // If Ptr is an instruction, remember its block.  If not, use the entry",
          "content_same": false
        },
        {
          "line": 719,
          "old_api": "isVarArg",
          "new_api": null,
          "old_text": "DTorFn->isVarArg()",
          "new_text": null,
          "old_line_content": "  assert(DTorFn->arg_size() == 1 && !DTorFn->isVarArg() &&",
          "new_line_content": "  // readonly, then we know it can't have any interesting side effects, so we",
          "content_same": false
        },
        {
          "line": 1232,
          "old_api": "getParent",
          "new_api": null,
          "old_text": "D->getParent()",
          "new_text": null,
          "old_line_content": "      Updater.AddAvailableValue(D->getParent(), D);",
          "new_line_content": "    SSAUpdater Updater;",
          "content_same": false
        },
        {
          "line": 1236,
          "old_api": "HasValueForBlock",
          "new_api": null,
          "old_text": "Updater.HasValueForBlock(PtrBlock)",
          "new_text": null,
          "old_line_content": "    if (!Updater.HasValueForBlock(PtrBlock))",
          "new_line_content": "    // virtual value.",
          "content_same": false
        },
        {
          "line": 1237,
          "old_api": "AddAvailableValue",
          "new_api": null,
          "old_text": "Updater.AddAvailableValue(PtrBlock, Ptr)",
          "new_text": null,
          "old_line_content": "      Updater.AddAvailableValue(PtrBlock, Ptr);",
          "new_line_content": "    for (auto D : Defs)",
          "content_same": false
        },
        {
          "line": 726,
          "old_api": "mayHaveSideEffects",
          "new_api": null,
          "old_text": "I.mayHaveSideEffects()",
          "new_text": null,
          "old_line_content": "      if (!I.mayHaveSideEffects()) continue;",
          "new_line_content": "         \"expected a single object argument to destructors\");",
          "content_same": false
        },
        {
          "line": 1241,
          "old_api": "use_end",
          "new_api": null,
          "old_text": "Ptr->use_end()",
          "new_text": null,
          "old_line_content": "    for (auto UI = Ptr->use_begin(), E = Ptr->use_end(); UI != E; ) {",
          "new_line_content": "    // available in its block.",
          "content_same": false
        },
        {
          "line": 1244,
          "old_api": "getUse",
          "new_api": null,
          "old_text": "UI.getUse()",
          "new_text": null,
          "old_line_content": "      Use &U = UI.getUse();",
          "new_line_content": "      ",
          "content_same": false
        },
        {
          "line": 734,
          "old_api": "doesNotCapture",
          "new_api": null,
          "old_text": "DTorFn->doesNotCapture(0)",
          "new_text": null,
          "old_line_content": "      return DTorFn->doesNotCapture(0) ? DtorKind::NoEscape : DtorKind::Unknown;",
          "new_line_content": "      // TODO: Ignore instructions that just side effect the object",
          "content_same": false
        },
        {
          "line": 1249,
          "old_api": "getUser",
          "new_api": null,
          "old_text": "U.getUser()",
          "new_text": null,
          "old_line_content": "      Instruction *User = cast<Instruction>(U.getUser());",
          "new_line_content": "      // it.",
          "content_same": false
        },
        {
          "line": 1254,
          "old_api": "RewriteUse",
          "new_api": null,
          "old_text": "Updater.RewriteUse(U)",
          "new_text": null,
          "old_line_content": "      Updater.RewriteUse(U);",
          "new_line_content": "      // PHI node, then this is a local use that shouldn't be rewritten.",
          "content_same": false
        },
        {
          "line": 750,
          "old_api": "getArgOperand",
          "new_api": null,
          "old_text": "Allocation.getArgOperand(0)",
          "new_text": null,
          "old_line_content": "  DtorKind DtorInfo = analyzeDestructor(Allocation.getArgOperand(0));",
          "new_line_content": "/// object allocation.  If the object does not escape and is only stored to",
          "content_same": false
        },
        {
          "line": 1263,
          "old_api": "optimizeReturn3",
          "new_api": null,
          "old_text": "optimizeReturn3(RI)",
          "new_text": null,
          "old_line_content": "    Changed |= optimizeReturn3(RI);",
          "new_line_content": "        Changed = true;",
          "content_same": false
        },
        {
          "line": 762,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "Worklist.push_back(&Allocation)",
          "new_text": null,
          "old_line_content": "  Worklist.push_back(&Allocation);",
          "new_line_content": "  // Do a depth first search exploring all of the uses of the object pointer,",
          "content_same": false
        },
        {
          "line": 1277,
          "old_api": "setPreservesCFG",
          "new_api": null,
          "old_text": "AU.setPreservesCFG()",
          "new_text": null,
          "old_line_content": "      AU.setPreservesCFG();",
          "new_line_content": "  void initializeSwiftARCExpandPassPass(PassRegistry&);",
          "content_same": false
        },
        {
          "line": 767,
          "old_api": "empty",
          "new_api": null,
          "old_text": "Worklist.empty()",
          "new_text": null,
          "old_line_content": "  while (!Worklist.empty()) {",
          "new_line_content": "  SmallVector<Instruction*, 16> Worklist;",
          "content_same": false
        },
        {
          "line": 1280,
          "old_api": "performARCExpansion",
          "new_api": null,
          "old_text": "performARCExpansion(F)",
          "new_text": null,
          "old_line_content": "      return performARCExpansion(F);",
          "new_line_content": "namespace {",
          "content_same": false
        },
        {
          "line": 772,
          "old_api": "insert",
          "new_api": null,
          "old_text": "InvolvedInstructions.insert(I)",
          "new_text": null,
          "old_line_content": "    if (!InvolvedInstructions.insert(I)) continue;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 775,
          "old_api": "classifyInstruction",
          "new_api": null,
          "old_text": "classifyInstruction(*I)",
          "new_text": null,
          "old_line_content": "    switch (classifyInstruction(*I)) {",
          "new_line_content": "    ",
          "content_same": false
        },
        {
          "line": 792,
          "old_api": "isa<TerminatorInst>(I)",
          "new_api": null,
          "old_text": "isa<TerminatorInst>(I)",
          "new_text": null,
          "old_line_content": "      if (I->mayHaveSideEffects() || isa<TerminatorInst>(I))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 815,
          "old_api": "use_end",
          "new_api": null,
          "old_text": "I->use_end()",
          "new_text": null,
          "old_line_content": "    for (auto UI = I->use_begin(), E = I->use_end(); UI != E; ++UI) {",
          "new_line_content": "      return false;",
          "content_same": false
        },
        {
          "line": 816,
          "old_api": "cast<Instruction>(*UI)",
          "new_api": null,
          "old_text": "cast<Instruction>(*UI)",
          "new_text": null,
          "old_line_content": "      Instruction *User = cast<Instruction>(*UI);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 824,
          "old_api": "StoreInst::getPointerOperandIndex()",
          "new_api": null,
          "old_text": "StoreInst::getPointerOperandIndex()",
          "new_text": null,
          "old_line_content": "        if (UI.getOperandNo() == StoreInst::getPointerOperandIndex()) {",
          "new_line_content": "      // Handle stores as a special case here: we want to make sure that the",
          "content_same": false
        },
        {
          "line": 825,
          "old_api": "insert",
          "new_api": null,
          "old_text": "InvolvedInstructions.insert(SI)",
          "new_text": null,
          "old_line_content": "          InvolvedInstructions.insert(SI);",
          "new_line_content": "      // object is being stored *to*, not itself being stored (which would be an",
          "content_same": false
        },
        {
          "line": 833,
          "old_api": "getOperandNo",
          "new_api": null,
          "old_text": "UI.getOperandNo()",
          "new_text": null,
          "old_line_content": "        if (UI.getOperandNo() == 0) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 834,
          "old_api": "insert",
          "new_api": null,
          "old_text": "InvolvedInstructions.insert(MI)",
          "new_text": null,
          "old_line_content": "          InvolvedInstructions.insert(MI);",
          "new_line_content": "        // Otherwise, using the object as a source (or size) is an escape.",
          "content_same": false
        },
        {
          "line": 842,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "Worklist.push_back(User)",
          "new_text": null,
          "old_line_content": "      Worklist.push_back(User);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 852,
          "old_api": "count",
          "new_api": null,
          "old_text": "InvolvedInstructions.count(BBI)",
          "new_text": null,
          "old_line_content": "  while (InvolvedInstructions.count(BBI))",
          "new_line_content": "  // Ok, we succeeded!  This means we can zap all of the instructions that use",
          "content_same": false
        },
        {
          "line": 857,
          "old_api": "use_empty",
          "new_api": null,
          "old_text": "I->use_empty()",
          "new_text": null,
          "old_line_content": "    if (!I->use_empty())",
          "new_line_content": "  // iterator if that would happen.",
          "content_same": false
        },
        {
          "line": 859,
          "old_api": "eraseFromParent",
          "new_api": null,
          "old_text": "I->eraseFromParent()",
          "new_text": null,
          "old_line_content": "    I->eraseFromParent();",
          "new_line_content": "    ++BBI;",
          "content_same": false
        },
        {
          "line": 873,
          "old_api": "end",
          "new_api": null,
          "old_text": "BB.end()",
          "new_text": null,
          "old_line_content": "    for (BasicBlock::iterator BBI = BB.begin(), E = BB.end(); BBI != E; ) {",
          "new_line_content": "/// looking for interesting local optimizations that can be done.",
          "content_same": false
        },
        {
          "line": 878,
          "old_api": "classifyInstruction",
          "new_api": null,
          "old_text": "classifyInstruction(I)",
          "new_text": null,
          "old_line_content": "      switch (classifyInstruction(I)) {",
          "new_line_content": "  for (BasicBlock &BB : F) {",
          "content_same": false
        },
        {
          "line": 881,
          "old_api": "cast<CallInst>(I)",
          "new_api": null,
          "old_text": "cast<CallInst>(I)",
          "new_text": null,
          "old_line_content": "        Changed |= performStoreOnlyObjectElimination(cast<CallInst>(I), BBI);",
          "new_line_content": "      Instruction &I = *BBI++;",
          "content_same": false
        },
        {
          "line": 891,
          "old_api": "end",
          "new_api": null,
          "old_text": "BB.end()",
          "new_text": null,
          "old_line_content": "        Safe = Safe != BB.begin() ? std::prev(Safe) : BB.end();",
          "new_line_content": "        break;",
          "content_same": false
        },
        {
          "line": 892,
          "old_api": "cast<CallInst>(I)",
          "new_api": null,
          "old_text": "cast<CallInst>(I)",
          "new_text": null,
          "old_line_content": "        if (performLocalRetainMotion(cast<CallInst>(I), BB)) {",
          "new_line_content": "      case RT_RetainNoResult:",
          "content_same": false
        },
        {
          "line": 895,
          "old_api": "begin",
          "new_api": null,
          "old_text": "BB.begin()",
          "new_text": null,
          "old_line_content": "          BBI = Safe != BB.end() ? std::next(Safe) : BB.begin();",
          "new_line_content": "        // invalidate our iterators by parking it on the instruction before I.",
          "content_same": false
        },
        {
          "line": 919,
          "old_api": "AU.addRequired<SwiftAliasAnalysis>()",
          "new_api": null,
          "old_text": "AU.addRequired<SwiftAliasAnalysis>()",
          "new_text": null,
          "old_line_content": "      AU.addRequired<SwiftAliasAnalysis>();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 920,
          "old_api": "setPreservesCFG",
          "new_api": null,
          "old_text": "AU.setPreservesCFG()",
          "new_text": null,
          "old_line_content": "      AU.setPreservesCFG();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 927,
          "old_api": "PassRegistry::getPassRegistry()",
          "new_api": null,
          "old_text": "PassRegistry::getPassRegistry()",
          "new_text": null,
          "old_line_content": "      initializeSwiftARCOptPass(*PassRegistry::getPassRegistry());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 932,
          "old_api": "INITIALIZE_PASS_BEGIN",
          "new_api": null,
          "old_text": "INITIALIZE_PASS_BEGIN(SwiftARCOpt,\n                  \"swift-arc-optimize\", \"Swift ARC optimization\", false, false)",
          "new_text": null,
          "old_line_content": "INITIALIZE_PASS_BEGIN(SwiftARCOpt,",
          "new_line_content": "    SwiftARCOpt() : FunctionPass(ID) {",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": "INITIALIZE_PASS_DEPENDENCY",
          "new_api": null,
          "old_text": "INITIALIZE_PASS_DEPENDENCY(SwiftAliasAnalysis)",
          "new_text": null,
          "old_line_content": "INITIALIZE_PASS_DEPENDENCY(SwiftAliasAnalysis)",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 935,
          "old_api": "INITIALIZE_PASS_END",
          "new_api": null,
          "old_text": "INITIALIZE_PASS_END(SwiftARCOpt,\n                    \"swift-arc-optimize\", \"Swift ARC optimization\", false,false)",
          "new_text": null,
          "old_line_content": "INITIALIZE_PASS_END(SwiftARCOpt,",
          "new_line_content": "  };",
          "content_same": false
        },
        {
          "line": 950,
          "old_api": "canonicalizeInputFunction",
          "new_api": null,
          "old_text": "canonicalizeInputFunction(F)",
          "new_text": null,
          "old_line_content": "  Changed |= canonicalizeInputFunction(F);",
          "new_line_content": "bool SwiftARCOpt::runOnFunction(Function &F) {",
          "content_same": false
        },
        {
          "line": 959,
          "old_api": "performGeneralOptimizations",
          "new_api": null,
          "old_text": "performGeneralOptimizations(F)",
          "new_text": null,
          "old_line_content": "  Changed |= performGeneralOptimizations(F);",
          "new_line_content": "  // 1) release() motion, eliminating retain/release pairs when it turns out",
          "content_same": false
        },
        {
          "line": 976,
          "old_api": "getNumOperands",
          "new_api": null,
          "old_text": "TheReturn->getNumOperands()",
          "new_text": null,
          "old_line_content": "  if (TheReturn->getNumOperands() == 0) return false;",
          "new_line_content": "/// optimizeReturn3 - Look to see if we can optimize \"ret (a,b,c)\" - where one",
          "content_same": false
        },
        {
          "line": 979,
          "old_api": "getOperand",
          "new_api": null,
          "old_text": "TheReturn->getOperand(0)",
          "new_text": null,
          "old_line_content": "  Value *RetVal = TheReturn->getOperand(0);",
          "new_line_content": "/// a string or array slice.",
          "content_same": false
        },
        {
          "line": 980,
          "old_api": "getType",
          "new_api": null,
          "old_text": "RetVal->getType()",
          "new_text": null,
          "old_line_content": "  StructType *RetSTy = dyn_cast<StructType>(RetVal->getType());",
          "new_line_content": "static bool optimizeReturn3(ReturnInst *TheReturn) {",
          "content_same": false
        },
        {
          "line": 981,
          "old_api": "getNumElements",
          "new_api": null,
          "old_text": "RetSTy->getNumElements()",
          "new_text": null,
          "old_line_content": "  if (RetSTy == 0 || RetSTy->getNumElements() != 3) return false;",
          "new_line_content": "  // Ignore ret void.",
          "content_same": false
        },
        {
          "line": 991,
          "old_api": "getType",
          "new_api": null,
          "old_text": "RetVals[i]->getType()",
          "new_text": null,
          "old_line_content": "    if (!isa<PointerType>(RetVals[i]->getType()) &&",
          "new_line_content": "  Value *RetVals[3];",
          "content_same": false
        },
        {
          "line": 992,
          "old_api": "getType",
          "new_api": null,
          "old_text": "RetVals[i]->getType()->isIntegerTy(64)",
          "new_text": null,
          "old_line_content": "        !RetVals[i]->getType()->isIntegerTy(64))",
          "new_line_content": "  for (unsigned i = 0; i != 3; ++i) {",
          "content_same": false
        },
        {
          "line": 1002,
          "old_api": "getParent",
          "new_api": null,
          "old_text": "TheReturn->getParent()->begin()",
          "new_text": null,
          "old_line_content": "  for (BasicBlock::iterator BBI = TheReturn,E = TheReturn->getParent()->begin();",
          "new_line_content": "  // The ARC optimizer will push the retains to be immediately before the",
          "content_same": false
        },
        {
          "line": 1006,
          "old_api": "classifyInstruction",
          "new_api": null,
          "old_text": "classifyInstruction(I)",
          "new_text": null,
          "old_line_content": "    switch (classifyInstruction(I)) {",
          "new_line_content": "  SmallDenseMap<Value*, CallInst*, 8> RetainedPointers;",
          "content_same": false
        },
        {
          "line": 1010,
          "old_api": "cast<CallInst>(I)",
          "new_api": null,
          "old_text": "cast<CallInst>(I)",
          "new_text": null,
          "old_line_content": "      CallInst &TheRetain = cast<CallInst>(I);",
          "new_line_content": "    Instruction &I = *--BBI;",
          "content_same": false
        },
        {
          "line": 1011,
          "old_api": "getArgOperand",
          "new_api": null,
          "old_text": "TheRetain.getArgOperand(0)",
          "new_text": null,
          "old_line_content": "      RetainedPointers[TheRetain.getArgOperand(0)] = &TheRetain;",
          "new_line_content": "    ",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 19,
      "total_additions": 92,
      "total_deletions": 91,
      "total_api_changes": 202
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 13,
        "api_related_lines": 202,
        "non_api_lines": 8,
        "non_api_line_numbers": [
          714,
          715,
          718,
          720,
          722,
          723,
          724,
          729
        ]
      }
    },
    "api_calls_before": 311,
    "api_calls_after": 312,
    "diff_info": {
      "added_lines": 12,
      "removed_lines": 6,
      "total_diff_lines": 42
    }
  }
}