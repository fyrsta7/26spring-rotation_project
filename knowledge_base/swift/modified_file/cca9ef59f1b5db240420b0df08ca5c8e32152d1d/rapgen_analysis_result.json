{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/cca9ef59f1b5db240420b0df08ca5c8e32152d1d",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/cca9ef59f1b5db240420b0df08ca5c8e32152d1d/before.h",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/cca9ef59f1b5db240420b0df08ca5c8e32152d1d/after.h",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/cca9ef59f1b5db240420b0df08ca5c8e32152d1d/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 268,
          "old_api": "FindNodeOrInsertPos",
          "new_api": "AddPointer",
          "old_text": "Set.FindNodeOrInsertPos(ID, InsertPt)",
          "new_text": "ID.AddPointer(Ptr)",
          "old_line_content": "    if (auto *PSet = Set.FindNodeOrInsertPos(ID, InsertPt)) {",
          "new_line_content": "      ID.AddPointer(Ptr);",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": "end",
          "new_api": "Allocate",
          "old_text": "S2->end()",
          "new_text": "Allocator.Allocate(MemSize, AllocAlignment)",
          "old_line_content": "    std::set_union(S1->begin(), S1->end(), S2->begin(), S2->end(),",
          "new_line_content": "        reinterpret_cast<PtrSet *>(Allocator.Allocate(MemSize, AllocAlignment));",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": "InsertNode",
          "new_api": "reinterpret_cast<PtrTy *>(&Mem[1])",
          "old_text": "Set.InsertNode(NewNode, InsertPt)",
          "new_text": "reinterpret_cast<PtrTy *>(&Mem[1])",
          "old_line_content": "    Set.InsertNode(NewNode, InsertPt);",
          "new_line_content": "    MutableArrayRef<PtrTy> DataMem(reinterpret_cast<PtrTy *>(&Mem[1]), NumElts);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 288,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "S2->end()",
          "old_line_content": "    return NewNode;",
          "new_line_content": "    std::set_union(S1->begin(), S1->end(), S2->begin(), S2->end(),",
          "content_same": false
        },
        {
          "line": 289,
          "old_api": null,
          "new_api": "begin",
          "old_text": null,
          "new_text": "DataMem.begin()",
          "old_line_content": "  }",
          "new_line_content": "                   DataMem.begin());",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": null,
          "new_api": "InsertNode",
          "old_text": null,
          "new_text": "Set.InsertNode(NewNode, InsertPt)",
          "old_line_content": "ImmutablePointerSet<T> ImmutablePointerSetFactory<T>::EmptyPtrSet =",
          "new_line_content": "    Set.InsertNode(NewNode, InsertPt);",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": null,
          "new_api": "AddPointer",
          "old_text": null,
          "new_text": "set_union_for_each(*S1, *S2, [&ID, &NumElts](const PtrTy Ptr) -> void {\n      ID.AddPointer(Ptr);\n      NumElts++;\n    })",
          "old_line_content": "    void *InsertPt;",
          "new_line_content": "    set_union_for_each(*S1, *S2, [&ID, &NumElts](const PtrTy Ptr) -> void {",
          "content_same": false
        },
        {
          "line": 300,
          "old_api": null,
          "new_api": "ImmutablePointerSet<T>(nullptr, {})",
          "old_text": null,
          "new_text": "ImmutablePointerSet<T>(nullptr, {})",
          "old_line_content": "",
          "new_line_content": "    ImmutablePointerSet<T>(nullptr, {});",
          "content_same": false
        },
        {
          "line": 274,
          "old_api": null,
          "new_api": "FindNodeOrInsertPos",
          "old_text": null,
          "new_text": "Set.FindNodeOrInsertPos(ID, InsertPt)",
          "old_line_content": "    // Allocate the memory.",
          "new_line_content": "    if (auto *PSet = Set.FindNodeOrInsertPos(ID, InsertPt)) {",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 261,
          "old_api": "AddPointer",
          "new_api": null,
          "old_text": "set_union_for_each(*S1, *S2, [&ID, &NumElts](const PtrTy Ptr) -> void {\n      ID.AddPointer(Ptr);\n      NumElts++;\n    })",
          "new_text": null,
          "old_line_content": "    set_union_for_each(*S1, *S2, [&ID, &NumElts](const PtrTy Ptr) -> void {",
          "new_line_content": "    llvm::FoldingSetNodeID ID;",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": "AddPointer",
          "new_api": null,
          "old_text": "ID.AddPointer(Ptr)",
          "new_text": null,
          "old_line_content": "      ID.AddPointer(Ptr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": "ImmutablePointerSet<T>(nullptr, {})",
          "new_api": null,
          "old_text": "ImmutablePointerSet<T>(nullptr, {})",
          "new_text": null,
          "old_line_content": "    ImmutablePointerSet<T>(nullptr, {});",
          "new_line_content": "    return NewNode;",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": "Allocate",
          "new_api": null,
          "old_text": "Allocator.Allocate(MemSize, AllocAlignment)",
          "new_text": null,
          "old_line_content": "        reinterpret_cast<PtrSet *>(Allocator.Allocate(MemSize, AllocAlignment));",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": "reinterpret_cast<PtrTy *>(&Mem[1])",
          "new_api": null,
          "old_text": "reinterpret_cast<PtrTy *>(&Mem[1])",
          "new_text": null,
          "old_line_content": "    MutableArrayRef<PtrTy> DataMem(reinterpret_cast<PtrTy *>(&Mem[1]), NumElts);",
          "new_line_content": "    auto *Mem =",
          "content_same": false
        },
        {
          "line": 283,
          "old_api": "begin",
          "new_api": null,
          "old_text": "DataMem.begin()",
          "new_text": null,
          "old_line_content": "                   DataMem.begin());",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 3,
      "total_additions": 6,
      "total_deletions": 6,
      "total_api_changes": 15
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 6,
        "api_related_lines": 15,
        "non_api_lines": 6,
        "non_api_line_numbers": [
          256,
          257,
          258,
          259,
          260,
          255
        ]
      }
    },
    "api_calls_before": 79,
    "api_calls_after": 79,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 0,
      "total_diff_lines": 18
    }
  }
}