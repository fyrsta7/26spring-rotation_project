{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/601b1e6bd4a6fb489a33b9f5ab3fbd3fb28cae1f",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/601b1e6bd4a6fb489a33b9f5ab3fbd3fb28cae1f/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/601b1e6bd4a6fb489a33b9f5ab3fbd3fb28cae1f/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/601b1e6bd4a6fb489a33b9f5ab3fbd3fb28cae1f/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [],
      "additions": [
        {
          "line": 439,
          "old_api": null,
          "new_api": "getBuiltinInfo",
          "old_text": null,
          "new_text": "BI->getBuiltinInfo()",
          "old_line_content": "        return InlineCost::Free;",
          "new_line_content": "      if (BI->getBuiltinInfo().ID == BuiltinValueKind::OnFastPath)",
          "content_same": false
        },
        {
          "line": 452,
          "old_api": null,
          "new_api": "llvm_unreachable",
          "old_text": null,
          "new_text": "llvm_unreachable(\"not valid in canonical sil\")",
          "old_line_content": "  }",
          "new_line_content": "      llvm_unreachable(\"not valid in canonical sil\");",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": null,
          "new_api": "cast<BeginAccessInst>(I)",
          "old_text": null,
          "new_text": "cast<BeginAccessInst>(I)",
          "old_line_content": "    case ValueKind::EndAccessInst:",
          "new_line_content": "      return getEnforcementCost(cast<BeginAccessInst>(I));",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": null,
          "new_api": "llvm_unreachable",
          "old_text": null,
          "new_text": "llvm_unreachable(\"Unhandled ValueKind in switch.\")",
          "old_line_content": "}",
          "new_line_content": "  llvm_unreachable(\"Unhandled ValueKind in switch.\");",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": null,
          "new_api": "getBeginAccess",
          "old_text": null,
          "new_text": "cast<EndAccessInst>(I).getBeginAccess()",
          "old_line_content": "",
          "new_line_content": "      return getEnforcementCost(*cast<EndAccessInst>(I).getBeginAccess());",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": null,
          "new_api": "cast<BuiltinInst>(&I)",
          "old_text": null,
          "new_text": "cast<BuiltinInst>(&I)",
          "old_line_content": "      // Expect intrinsics are 'free' instructions.",
          "new_line_content": "      auto *BI = cast<BuiltinInst>(&I);",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": null,
          "new_api": "getIntrinsicInfo",
          "old_text": null,
          "new_text": "BI->getIntrinsicInfo()",
          "old_line_content": "        return InlineCost::Free;",
          "new_line_content": "      if (BI->getIntrinsicInfo().ID == llvm::Intrinsic::expect)",
          "content_same": false
        },
        {
          "line": 311,
          "old_api": null,
          "new_api": "getType",
          "old_text": null,
          "new_text": "I.getType().castTo<MetatypeType>()->getRepresentation()",
          "old_line_content": "            == MetatypeRepresentation::Thin)",
          "new_line_content": "      if (I.getType().castTo<MetatypeType>()->getRepresentation()",
          "content_same": false
        },
        {
          "line": 447,
          "old_api": null,
          "new_api": "llvm_unreachable",
          "old_text": null,
          "new_text": "llvm_unreachable(\"Only instructions should be passed into this \"\n                       \"function.\")",
          "old_line_content": "                       \"function.\");",
          "new_line_content": "      llvm_unreachable(\"Only instructions should be passed into this \"",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 451,
          "old_api": "llvm_unreachable",
          "new_api": null,
          "old_text": "llvm_unreachable(\"not valid in canonical sil\")",
          "new_text": null,
          "old_line_content": "      llvm_unreachable(\"not valid in canonical sil\");",
          "new_line_content": "    case ValueKind::MarkUninitializedBehaviorInst:",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": "cast<BeginAccessInst>(I)",
          "new_api": null,
          "old_text": "cast<BeginAccessInst>(I)",
          "new_text": null,
          "old_line_content": "      return getEnforcementCost(cast<BeginAccessInst>(I));",
          "new_line_content": "    case ValueKind::BeginAccessInst:",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": "llvm_unreachable",
          "new_api": null,
          "old_text": "llvm_unreachable(\"Unhandled ValueKind in switch.\")",
          "new_text": null,
          "old_line_content": "  llvm_unreachable(\"Unhandled ValueKind in switch.\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 295,
          "old_api": "getBeginAccess",
          "new_api": null,
          "old_text": "cast<EndAccessInst>(I).getBeginAccess()",
          "new_text": null,
          "old_line_content": "      return getEnforcementCost(*cast<EndAccessInst>(I).getBeginAccess());",
          "new_line_content": "    case ValueKind::EndAccessInst:",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": "cast<BuiltinInst>(&I)",
          "new_api": null,
          "old_text": "cast<BuiltinInst>(&I)",
          "new_text": null,
          "old_line_content": "      auto *BI = cast<BuiltinInst>(&I);",
          "new_line_content": "    case ValueKind::BuiltinInst: {",
          "content_same": false
        },
        {
          "line": 436,
          "old_api": "getIntrinsicInfo",
          "new_api": null,
          "old_text": "BI->getIntrinsicInfo()",
          "new_text": null,
          "old_line_content": "      if (BI->getIntrinsicInfo().ID == llvm::Intrinsic::expect)",
          "new_line_content": "      // Expect intrinsics are 'free' instructions.",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": "getType",
          "new_api": null,
          "old_text": "I.getType().castTo<MetatypeType>()->getRepresentation()",
          "new_text": null,
          "old_line_content": "      if (I.getType().castTo<MetatypeType>()->getRepresentation()",
          "new_line_content": "      // Thin metatypes are always free.",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": "getBuiltinInfo",
          "new_api": null,
          "old_text": "BI->getBuiltinInfo()",
          "new_text": null,
          "old_line_content": "      if (BI->getBuiltinInfo().ID == BuiltinValueKind::OnFastPath)",
          "new_line_content": "        return InlineCost::Free;",
          "content_same": false
        },
        {
          "line": 446,
          "old_api": "llvm_unreachable",
          "new_api": null,
          "old_text": "llvm_unreachable(\"Only instructions should be passed into this \"\n                       \"function.\")",
          "new_text": null,
          "old_line_content": "      llvm_unreachable(\"Only instructions should be passed into this \"",
          "new_line_content": "    case ValueKind::SILUndef:",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 0,
      "total_additions": 9,
      "total_deletions": 9,
      "total_api_changes": 18
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 1,
        "api_related_lines": 18,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          243
        ]
      }
    },
    "api_calls_before": 130,
    "api_calls_after": 130,
    "diff_info": {
      "added_lines": 1,
      "removed_lines": 0,
      "total_diff_lines": 13
    }
  }
}