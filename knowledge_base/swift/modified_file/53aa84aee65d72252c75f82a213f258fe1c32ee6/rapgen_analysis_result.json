{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/53aa84aee65d72252c75f82a213f258fe1c32ee6",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/53aa84aee65d72252c75f82a213f258fe1c32ee6/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/53aa84aee65d72252c75f82a213f258fe1c32ee6/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/swift/modified_file/53aa84aee65d72252c75f82a213f258fe1c32ee6/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 125,
          "old_api": "size",
          "new_api": "find",
          "old_text": "Name.size()",
          "new_text": "DemangledName.find(Name, pos)",
          "old_line_content": "    if (pos1 == pos && !isalpha(DemangledName[pos1+Name.size()])) {",
          "new_line_content": "    auto pos1 = DemangledName.find(Name, pos);",
          "content_same": false
        },
        {
          "line": 146,
          "old_api": "getLinkage",
          "new_api": "getOptions",
          "old_text": "F->getLinkage()",
          "new_text": "M.getOptions()",
          "old_line_content": "      F->getLinkage() != SILLinkage::Public &&",
          "new_line_content": "  if (M.getOptions().Optimization >= SILOptions::SILOptMode::Optimize &&",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "getSwiftModule",
          "new_api": "getLinkage",
          "old_text": "F->getModule().getSwiftModule()->getName().str()",
          "new_text": "F->getLinkage()",
          "old_line_content": "      F->getModule().getSwiftModule()->getName().str() == STDLIB_NAME) {",
          "new_line_content": "      F->getLinkage() != SILLinkage::Public &&",
          "content_same": false
        },
        {
          "line": 148,
          "old_api": "getLinkage",
          "new_api": "getSwiftModule",
          "old_text": "F->getLinkage()",
          "new_text": "F->getModule().getSwiftModule()->getName().str()",
          "old_line_content": "    if (F->getLinkage() != SILLinkage::Public &&",
          "new_line_content": "      F->getModule().getSwiftModule()->getName().str() == STDLIB_NAME) {",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": "getName",
          "new_api": "getLinkage",
          "old_text": "F->getName()",
          "new_text": "F->getLinkage()",
          "old_line_content": "        isWhitelistedSpecialization(F->getName())) {",
          "new_line_content": "    if (F->getLinkage() != SILLinkage::Public &&",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": "getName",
          "new_api": "llvm::dbgs()",
          "old_text": "F->getName()",
          "new_text": "llvm::dbgs()",
          "old_line_content": "                     << F->getName() << \"\\n\");",
          "new_line_content": "        llvm::dbgs() << \"Keep specialization: \" << DemangledName << \" : \"",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": "isWhitelistedSpecialization",
          "new_api": "getOptions",
          "old_text": "isWhitelistedSpecialization(FunctionName)",
          "new_text": "M.getOptions()",
          "old_line_content": "      isWhitelistedSpecialization(FunctionName) &&",
          "new_line_content": "  if (M.getOptions().UsePrespecialized &&",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": "linkFunction",
          "new_api": "isWhitelistedSpecialization",
          "old_text": "M.linkFunction(FunctionName, SILOptions::LinkingMode::LinkNormal)",
          "new_text": "isWhitelistedSpecialization(FunctionName)",
          "old_line_content": "      M.linkFunction(FunctionName, SILOptions::LinkingMode::LinkNormal))",
          "new_line_content": "      isWhitelistedSpecialization(FunctionName) &&",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "lookUpFunction",
          "new_api": "linkFunction",
          "old_text": "M.lookUpFunction(FunctionName)",
          "new_text": "M.linkFunction(FunctionName, SILOptions::LinkingMode::LinkNormal)",
          "old_line_content": "    return M.lookUpFunction(FunctionName);",
          "new_line_content": "      M.linkFunction(FunctionName, SILOptions::LinkingMode::LinkNormal))",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "convertToDeclaration",
          "new_api": "isDefinition",
          "old_text": "Specialization->convertToDeclaration()",
          "new_text": "Specialization->isDefinition()",
          "old_line_content": "      Specialization->convertToDeclaration();",
          "new_line_content": "    if (Specialization->isDefinition())",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "setLinkage",
          "new_api": "convertToDeclaration",
          "old_text": "Specialization->setLinkage(SILLinkage::PublicExternal)",
          "new_text": "Specialization->convertToDeclaration()",
          "old_line_content": "    Specialization->setLinkage(SILLinkage::PublicExternal);",
          "new_line_content": "      Specialization->convertToDeclaration();",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": "convertExtenralDefinitionIntoDeclaration",
          "new_api": "isExternalDeclaration",
          "old_text": "convertExtenralDefinitionIntoDeclaration(Specialization)",
          "new_text": "Specialization->isExternalDeclaration()",
          "old_line_content": "            convertExtenralDefinitionIntoDeclaration(Specialization)) &&",
          "new_line_content": "    assert((Specialization->isExternalDeclaration() ||",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "DEBUG",
          "new_api": "convertExtenralDefinitionIntoDeclaration",
          "old_text": "DEBUG(\n          llvm::dbgs() << \"Could not remove body of specialization: \"\n                       << FunctionName << '\\n')",
          "new_text": "convertExtenralDefinitionIntoDeclaration(Specialization)",
          "old_line_content": "      DEBUG(",
          "new_line_content": "    if (!convertExtenralDefinitionIntoDeclaration(Specialization)) {",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": "llvm::dbgs()",
          "new_api": "DEBUG",
          "old_text": "llvm::dbgs()",
          "new_text": "DEBUG(\n          llvm::dbgs() << \"Could not remove body of specialization: \"\n                       << FunctionName << '\\n')",
          "old_line_content": "          llvm::dbgs() << \"Could not remove body of specialization: \"",
          "new_line_content": "      DEBUG(",
          "content_same": false
        },
        {
          "line": 218,
          "old_api": "llvm::dbgs()",
          "new_api": "DEBUG",
          "old_text": "llvm::dbgs()",
          "new_text": "DEBUG(\n        llvm::dbgs() << \"Found existing specialization for: \"\n                     << FunctionName << '\\n'",
          "old_line_content": "        llvm::dbgs() << \"Found existing specialization for: \"",
          "new_line_content": "    DEBUG(",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "getName",
          "new_api": "llvm::dbgs()",
          "old_text": "Specialization->getName()",
          "new_text": "llvm::dbgs()",
          "old_line_content": "           << swift::Demangle::demangleSymbolAsString(Specialization->getName())",
          "new_line_content": "    DEBUG(llvm::dbgs() << \"Cannot reuse the specialization: \"",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": "hasSubstitutions",
          "new_api": "empty",
          "old_text": "Apply.hasSubstitutions()",
          "new_text": "NewApplyPairs.empty()",
          "old_line_content": "  assert(Apply.hasSubstitutions() && \"Expected an apply with substitutions!\");",
          "new_line_content": "  assert(NewApplyPairs.empty() && \"Expected no new applies in vector yet!\");",
          "content_same": false
        },
        {
          "line": 242,
          "old_api": "isDefinition",
          "new_api": "getCallee",
          "old_text": "F->isDefinition()",
          "new_text": "Apply.getCallee()",
          "old_line_content": "  assert(F->isDefinition() && \"Expected definition to specialize!\");",
          "new_line_content": "  auto *F = cast<FunctionRefInst>(Apply.getCallee())->getReferencedFunction();",
          "content_same": false
        },
        {
          "line": 251,
          "old_api": "getSubstitutions",
          "new_api": "getLoweredFunctionType",
          "old_text": "F->getLoweredFunctionType()->getGenericSignature()\n      ->getSubstitutionMap(Apply.getSubstitutions())",
          "new_text": "F->getLoweredFunctionType()->getGenericSignature()",
          "old_line_content": "    InterfaceSubs = F->getLoweredFunctionType()->getGenericSignature()",
          "new_line_content": "  if (F->getLoweredFunctionType()->getGenericSignature())",
          "content_same": false
        },
        {
          "line": 256,
          "old_api": "getSubstitutions",
          "new_api": "getContextGenericParams",
          "old_text": "F->getContextGenericParams()\n      ->getSubstitutionMap(Apply.getSubstitutions())",
          "new_text": "F->getContextGenericParams()",
          "old_line_content": "    ContextSubs = F->getContextGenericParams()",
          "new_line_content": "  if (F->getContextGenericParams())",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": "llvm::dbgs()",
          "new_api": "hasUnboundGenericTypes",
          "old_text": "llvm::dbgs()",
          "new_text": "hasUnboundGenericTypes(InterfaceSubs)",
          "old_line_content": "    DEBUG(llvm::dbgs() << \"    Can not specialize with interface subs.\\n\");",
          "new_line_content": "  if (hasUnboundGenericTypes(InterfaceSubs)) {",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": "ApplySite",
          "new_api": "llvm::dbgs()",
          "old_text": "ApplySite()",
          "new_text": "llvm::dbgs()",
          "old_line_content": "    return ApplySite();",
          "new_line_content": "    DEBUG(llvm::dbgs() << \"    Can not specialize with interface subs.\\n\");",
          "content_same": false
        },
        {
          "line": 265,
          "old_api": "llvm::dbgs()",
          "new_api": "hasDynamicSelfTypes",
          "old_text": "llvm::dbgs()",
          "new_text": "hasDynamicSelfTypes(InterfaceSubs)",
          "old_line_content": "    DEBUG(llvm::dbgs() << \"    Cannot specialize with dynamic self.\\n\");",
          "new_line_content": "  if (hasDynamicSelfTypes(InterfaceSubs)) {",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": "ApplySite",
          "new_api": "llvm::dbgs()",
          "old_text": "ApplySite()",
          "new_text": "llvm::dbgs()",
          "old_line_content": "    return ApplySite();",
          "new_line_content": "    DEBUG(llvm::dbgs() << \"    Cannot specialize with dynamic self.\\n\");",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": "ApplySite",
          "new_api": "getOptions",
          "old_text": "ApplySite()",
          "new_text": "M.getOptions()",
          "old_line_content": "      return ApplySite();",
          "new_line_content": "    if (M.getOptions().Optimization <= SILOptions::SILOptMode::None)",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": "getApplyPairs",
          "new_api": "getCallback",
          "old_text": "Collector.getApplyPairs()",
          "new_text": "Collector.getCallback()",
          "old_line_content": "    for (auto &P : Collector.getApplyPairs())",
          "new_line_content": "                                        Collector.getCallback());",
          "content_same": false
        },
        {
          "line": 311,
          "old_api": "push_back",
          "new_api": "getApplyPairs",
          "old_text": "NewApplyPairs.push_back(P)",
          "new_text": "Collector.getApplyPairs()",
          "old_line_content": "      NewApplyPairs.push_back(P);",
          "new_line_content": "    for (auto &P : Collector.getApplyPairs())",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 258,
          "old_api": null,
          "new_api": "getSubstitutions",
          "old_text": null,
          "new_text": "Apply.getSubstitutions()",
          "old_line_content": "",
          "new_line_content": "      ->getSubstitutionMap(Apply.getSubstitutions());",
          "content_same": false
        },
        {
          "line": 263,
          "old_api": null,
          "new_api": "ApplySite",
          "old_text": null,
          "new_text": "ApplySite()",
          "old_line_content": "  }",
          "new_line_content": "    return ApplySite();",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": null,
          "new_api": "ApplySite",
          "old_text": null,
          "new_text": "ApplySite()",
          "old_line_content": "  }",
          "new_line_content": "    return ApplySite();",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": null,
          "new_api": "getSubstitutions",
          "old_text": null,
          "new_text": "Apply.getSubstitutions()",
          "old_line_content": "    Mangle::Mangler M(buffer);",
          "new_line_content": "    ArrayRef<Substitution> Subs = Apply.getSubstitutions();",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": null,
          "new_api": "mangle",
          "old_text": null,
          "new_text": "Mangler.mangle()",
          "old_line_content": "  }",
          "new_line_content": "    Mangler.mangle();",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "F->getName()",
          "old_line_content": "",
          "new_line_content": "        isWhitelistedSpecialization(F->getName())) {",
          "content_same": false
        },
        {
          "line": 278,
          "old_api": null,
          "new_api": "llvm::dbgs()",
          "old_text": null,
          "new_text": "llvm::dbgs()",
          "old_line_content": "",
          "new_line_content": "  DEBUG(llvm::dbgs() << \"    Specialized function \" << ClonedName << '\\n');",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": null,
          "new_api": "getInstruction",
          "old_text": null,
          "new_text": "Apply.getInstruction()->getModule()",
          "old_line_content": "  // If we already have this specialization, reuse it.",
          "new_line_content": "  auto &M = Apply.getInstruction()->getModule();",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": null,
          "new_api": "lookUpFunction",
          "old_text": null,
          "new_text": "M.lookUpFunction(ClonedName)",
          "old_line_content": "",
          "new_line_content": "  auto NewF = M.lookUpFunction(ClonedName);",
          "content_same": false
        },
        {
          "line": 157,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "F->getName()",
          "old_line_content": "      // Make it public, so that others can refer to it.",
          "new_line_content": "                     << F->getName() << \"\\n\");",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": null,
          "new_api": "getSubstitutions",
          "old_text": null,
          "new_text": "Apply.getSubstitutions()",
          "old_line_content": "    auto FTy =",
          "new_line_content": "    auto Subs = Apply.getSubstitutions();",
          "content_same": false
        },
        {
          "line": 290,
          "old_api": null,
          "new_api": "getSwiftModule",
          "old_text": null,
          "new_text": "M.getSwiftModule()",
          "old_line_content": "                                                    Subs);",
          "new_line_content": "                                                    M.getSwiftModule(),",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": null,
          "new_api": "getLoweredFunctionType",
          "old_text": null,
          "new_text": "NewF->getLoweredFunctionType()",
          "old_line_content": "           \"Previously specialized function does not match expected type.\");",
          "new_line_content": "    assert(FTy == NewF->getLoweredFunctionType() &&",
          "content_same": false
        },
        {
          "line": 169,
          "old_api": null,
          "new_api": "setKeepAsPublic",
          "old_text": null,
          "new_text": "F->setKeepAsPublic(true)",
          "old_line_content": "      return true;",
          "new_line_content": "      F->setKeepAsPublic(true);",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": null,
          "new_api": "ApplySite",
          "old_text": null,
          "new_text": "ApplySite()",
          "old_line_content": "",
          "new_line_content": "      return ApplySite();",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": null,
          "new_api": "getOptions",
          "old_text": null,
          "new_text": "DEBUG(\n      if (M.getOptions().Optimization <= SILOptions::SILOptMode::Debug) {\n        llvm::dbgs() << \"Creating a specialization: \" << ClonedName << \"\\n\"; })",
          "old_line_content": "      if (M.getOptions().Optimization <= SILOptions::SILOptMode::Debug) {",
          "new_line_content": "    DEBUG(",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": null,
          "new_api": "llvm::dbgs()",
          "old_text": null,
          "new_text": "llvm::dbgs()",
          "old_line_content": "",
          "new_line_content": "        llvm::dbgs() << \"Creating a specialization: \" << ClonedName << \"\\n\"; });",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": null,
          "new_api": "getCallback",
          "old_text": null,
          "new_text": "GenericCloner::cloneFunction(F, InterfaceSubs, ContextSubs,\n                                        ClonedName, Apply,\n                                        Collector.getCallback())",
          "old_line_content": "                                        ClonedName, Apply,",
          "new_line_content": "    NewF = GenericCloner::cloneFunction(F, InterfaceSubs, ContextSubs,",
          "content_same": false
        },
        {
          "line": 312,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "NewApplyPairs.push_back(P)",
          "old_line_content": "",
          "new_line_content": "      NewApplyPairs.push_back(P);",
          "content_same": false
        },
        {
          "line": 317,
          "old_api": null,
          "new_api": "cacheSpecialization",
          "old_text": null,
          "new_text": "cacheSpecialization(M, NewF)",
          "old_line_content": "  }",
          "new_line_content": "    cacheSpecialization(M, NewF);",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": null,
          "new_api": "replaceWithSpecializedFunction",
          "old_text": null,
          "new_text": "replaceWithSpecializedFunction(Apply, NewF)",
          "old_line_content": "}",
          "new_line_content": "  return replaceWithSpecializedFunction(Apply, NewF);",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": null,
          "new_api": "lookUpFunction",
          "old_text": null,
          "new_text": "M.lookUpFunction(FunctionName)",
          "old_line_content": "",
          "new_line_content": "    return M.lookUpFunction(FunctionName);",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": null,
          "new_api": "lookupExistingSpecialization",
          "old_text": null,
          "new_text": "lookupExistingSpecialization(M, FunctionName)",
          "old_line_content": "  if (!Specialization)",
          "new_line_content": "  auto *Specialization = lookupExistingSpecialization(M, FunctionName);",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": null,
          "new_api": "getLinkage",
          "old_text": null,
          "new_text": "Specialization->getLinkage()",
          "old_line_content": "    // The bodies of existing specializations cannot be used,",
          "new_line_content": "  if (hasPublicVisibility(Specialization->getLinkage())) {",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": null,
          "new_api": "setLinkage",
          "old_text": null,
          "new_text": "Specialization->setLinkage(SILLinkage::PublicExternal)",
          "old_line_content": "    // Ignore body for -Onone and -Odebug.",
          "new_line_content": "    Specialization->setLinkage(SILLinkage::PublicExternal);",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": null,
          "new_api": "convertExtenralDefinitionIntoDeclaration",
          "old_text": null,
          "new_text": "convertExtenralDefinitionIntoDeclaration(Specialization)",
          "old_line_content": "           \"Could not remove body of the found specialization\");",
          "new_line_content": "            convertExtenralDefinitionIntoDeclaration(Specialization)) &&",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": null,
          "new_api": "llvm::dbgs()",
          "old_text": null,
          "new_text": "llvm::dbgs()",
          "old_line_content": "                       << FunctionName << '\\n');",
          "new_line_content": "          llvm::dbgs() << \"Could not remove body of specialization: \"",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": null,
          "new_api": "llvm::dbgs()",
          "old_text": null,
          "new_text": "llvm::dbgs()",
          "old_line_content": "                     << FunctionName << '\\n';",
          "new_line_content": "        llvm::dbgs() << \"Found existing specialization for: \"",
          "content_same": false
        },
        {
          "line": 222,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "Specialization->getName()",
          "old_line_content": "  } else {",
          "new_line_content": "                            Specialization->getName()) << \"\\n\\n\");",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "Specialization->getName()",
          "old_line_content": "           <<\"\\n\");",
          "new_line_content": "           << swift::Demangle::demangleSymbolAsString(Specialization->getName())",
          "content_same": false
        },
        {
          "line": 101,
          "old_api": null,
          "new_api": "swift::Demangle::demangleSymbolAsString(SpecName)",
          "old_text": null,
          "new_text": "swift::Demangle::demangleSymbolAsString(SpecName)",
          "old_line_content": "",
          "new_line_content": "     swift::Demangle::demangleSymbolAsString(SpecName);",
          "content_same": false
        },
        {
          "line": 105,
          "old_api": null,
          "new_api": "find",
          "old_text": null,
          "new_text": "DemangledName.find(\"generic \", 0)",
          "old_line_content": "  if (pos == StringRef::npos)",
          "new_line_content": "  auto pos = DemangledName.find(\"generic \", 0);",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": null,
          "new_api": "hasSubstitutions",
          "old_text": null,
          "new_text": "Apply.hasSubstitutions()",
          "old_line_content": "",
          "new_line_content": "  assert(Apply.hasSubstitutions() && \"Expected an apply with substitutions!\");",
          "content_same": false
        },
        {
          "line": 115,
          "old_api": null,
          "new_api": "str",
          "old_text": null,
          "new_text": "buffer.str()",
          "old_line_content": "",
          "new_line_content": "  StringRef OfStr = buffer.str();",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": null,
          "new_api": "isDefinition",
          "old_text": null,
          "new_text": "F->isDefinition()",
          "old_line_content": "",
          "new_line_content": "  assert(F->isDefinition() && \"Expected definition to specialize!\");",
          "content_same": false
        },
        {
          "line": 117,
          "old_api": null,
          "new_api": "find",
          "old_text": null,
          "new_text": "DemangledName.find(OfStr, pos)",
          "old_line_content": "",
          "new_line_content": "  pos = DemangledName.find(OfStr, pos);",
          "content_same": false
        },
        {
          "line": 245,
          "old_api": null,
          "new_api": "getInstruction",
          "old_text": null,
          "new_text": "Apply.getInstruction()",
          "old_line_content": "",
          "new_line_content": "  DEBUG(llvm::dbgs() << \"  ApplyInst: \" << *Apply.getInstruction());",
          "content_same": false
        },
        {
          "line": 122,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "OfStr.size()",
          "old_line_content": "",
          "new_line_content": "  pos += OfStr.size();",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": null,
          "new_api": "getSubstitutions",
          "old_text": null,
          "new_text": "Apply.getSubstitutions()",
          "old_line_content": "",
          "new_line_content": "      ->getSubstitutionMap(Apply.getSubstitutions());",
          "content_same": false
        },
        {
          "line": 126,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "Name.size()",
          "old_line_content": "      return true;",
          "new_line_content": "    if (pos1 == pos && !isalpha(DemangledName[pos1+Name.size()])) {",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 260,
          "old_api": "hasUnboundGenericTypes",
          "new_api": null,
          "old_text": "hasUnboundGenericTypes(InterfaceSubs)",
          "new_text": null,
          "old_line_content": "  if (hasUnboundGenericTypes(InterfaceSubs)) {",
          "new_line_content": "  // We do not support partial specialization.",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": "hasDynamicSelfTypes",
          "new_api": null,
          "old_text": "hasDynamicSelfTypes(InterfaceSubs)",
          "new_text": null,
          "old_line_content": "  if (hasDynamicSelfTypes(InterfaceSubs)) {",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 272,
          "old_api": "getSubstitutions",
          "new_api": null,
          "old_text": "Apply.getSubstitutions()",
          "new_text": null,
          "old_line_content": "    ArrayRef<Substitution> Subs = Apply.getSubstitutions();",
          "new_line_content": "    llvm::raw_svector_ostream buffer(ClonedName);",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": "getOptions",
          "new_api": null,
          "old_text": "M.getOptions()",
          "new_text": null,
          "old_line_content": "  if (M.getOptions().Optimization >= SILOptions::SILOptMode::Optimize &&",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 275,
          "old_api": "mangle",
          "new_api": null,
          "old_text": "Mangler.mangle()",
          "new_text": null,
          "old_line_content": "    Mangler.mangle();",
          "new_line_content": "    Mangle::GenericSpecializationMangler Mangler(M, F, Subs);",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": "llvm::dbgs()",
          "new_api": null,
          "old_text": "llvm::dbgs()",
          "new_text": null,
          "old_line_content": "  DEBUG(llvm::dbgs() << \"    Specialized function \" << ClonedName << '\\n');",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": "getInstruction",
          "new_api": null,
          "old_text": "Apply.getInstruction()->getModule()",
          "new_text": null,
          "old_line_content": "  auto &M = Apply.getInstruction()->getModule();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": "lookUpFunction",
          "new_api": null,
          "old_text": "M.lookUpFunction(ClonedName)",
          "new_text": null,
          "old_line_content": "  auto NewF = M.lookUpFunction(ClonedName);",
          "new_line_content": "  // If we already have this specialization, reuse it.",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": "llvm::dbgs()",
          "new_api": null,
          "old_text": "llvm::dbgs()",
          "new_text": null,
          "old_line_content": "        llvm::dbgs() << \"Keep specialization: \" << DemangledName << \" : \"",
          "new_line_content": "        StringRef DemangledName = DemangledNameString;",
          "content_same": false
        },
        {
          "line": 286,
          "old_api": "getSubstitutions",
          "new_api": null,
          "old_text": "Apply.getSubstitutions()",
          "new_text": null,
          "old_line_content": "    auto Subs = Apply.getSubstitutions();",
          "new_line_content": "    // Make sure that NewF's subst type matches the expected type.",
          "content_same": false
        },
        {
          "line": 288,
          "old_api": "getSwiftModule",
          "new_api": null,
          "old_text": "F->getLoweredFunctionType()->substGenericArgs(M,\n                                                    M.getSwiftModule(),\n                                                    Subs)",
          "new_text": null,
          "old_line_content": "      F->getLoweredFunctionType()->substGenericArgs(M,",
          "new_line_content": "    auto FTy =",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": "getLoweredFunctionType",
          "new_api": null,
          "old_text": "NewF->getLoweredFunctionType()",
          "new_text": null,
          "old_line_content": "    assert(FTy == NewF->getLoweredFunctionType() &&",
          "new_line_content": "                                                    Subs);",
          "content_same": false
        },
        {
          "line": 168,
          "old_api": "setKeepAsPublic",
          "new_api": null,
          "old_text": "F->setKeepAsPublic(true)",
          "new_text": null,
          "old_line_content": "      F->setKeepAsPublic(true);",
          "new_line_content": "      // and preserve it if required.",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": "getOptions",
          "new_api": null,
          "old_text": "M.getOptions()",
          "new_text": null,
          "old_line_content": "    if (M.getOptions().Optimization <= SILOptions::SILOptMode::None)",
          "new_line_content": "    // Do not create any new specializations at Onone.",
          "content_same": false
        },
        {
          "line": 300,
          "old_api": "getOptions",
          "new_api": null,
          "old_text": "DEBUG(\n      if (M.getOptions().Optimization <= SILOptions::SILOptMode::Debug) {\n        llvm::dbgs() << \"Creating a specialization: \" << ClonedName << \"\\n\"; })",
          "new_text": null,
          "old_line_content": "    DEBUG(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": "llvm::dbgs()",
          "new_api": null,
          "old_text": "llvm::dbgs()",
          "new_text": null,
          "old_line_content": "        llvm::dbgs() << \"Creating a specialization: \" << ClonedName << \"\\n\"; });",
          "new_line_content": "      if (M.getOptions().Optimization <= SILOptions::SILOptMode::Debug) {",
          "content_same": false
        },
        {
          "line": 307,
          "old_api": "getCallback",
          "new_api": null,
          "old_text": "GenericCloner::cloneFunction(F, InterfaceSubs, ContextSubs,\n                                        ClonedName, Apply,\n                                        Collector.getCallback())",
          "new_text": null,
          "old_line_content": "    NewF = GenericCloner::cloneFunction(F, InterfaceSubs, ContextSubs,",
          "new_line_content": "    // Create a new function.",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": "getCallback",
          "new_api": null,
          "old_text": "Collector.getCallback()",
          "new_text": null,
          "old_line_content": "                                        Collector.getCallback());",
          "new_line_content": "                                        ClonedName, Apply,",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "getOptions",
          "new_api": null,
          "old_text": "M.getOptions()",
          "new_text": null,
          "old_line_content": "  if (M.getOptions().UsePrespecialized &&",
          "new_line_content": "  // its body. It can save some compile-time.",
          "content_same": false
        },
        {
          "line": 316,
          "old_api": "cacheSpecialization",
          "new_api": null,
          "old_text": "cacheSpecialization(M, NewF)",
          "new_text": null,
          "old_line_content": "    cacheSpecialization(M, NewF);",
          "new_line_content": "    // Check if this specialization should be cached.",
          "content_same": false
        },
        {
          "line": 318,
          "old_api": "replaceWithSpecializedFunction",
          "new_api": null,
          "old_text": "replaceWithSpecializedFunction(Apply, NewF)",
          "new_text": null,
          "old_line_content": "  return replaceWithSpecializedFunction(Apply, NewF);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": "lookupExistingSpecialization",
          "new_api": null,
          "old_text": "lookupExistingSpecialization(M, FunctionName)",
          "new_text": null,
          "old_line_content": "  auto *Specialization = lookupExistingSpecialization(M, FunctionName);",
          "new_line_content": "                                              StringRef FunctionName) {",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "getLinkage",
          "new_api": null,
          "old_text": "Specialization->getLinkage()",
          "new_text": null,
          "old_line_content": "  if (hasPublicVisibility(Specialization->getLinkage())) {",
          "new_line_content": "    return nullptr;",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": "isDefinition",
          "new_api": null,
          "old_text": "Specialization->isDefinition()",
          "new_text": null,
          "old_line_content": "    if (Specialization->isDefinition())",
          "new_line_content": "    // as they may refer to non-public symbols.",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": "isExternalDeclaration",
          "new_api": null,
          "old_text": "Specialization->isExternalDeclaration()",
          "new_text": null,
          "old_line_content": "    assert((Specialization->isExternalDeclaration() ||",
          "new_line_content": "    // Ignore body for -Onone and -Odebug.",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "convertExtenralDefinitionIntoDeclaration",
          "new_api": null,
          "old_text": "convertExtenralDefinitionIntoDeclaration(Specialization)",
          "new_text": null,
          "old_line_content": "    if (!convertExtenralDefinitionIntoDeclaration(Specialization)) {",
          "new_line_content": "           \"Could not remove body of the found specialization\");",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": "DEBUG",
          "new_api": null,
          "old_text": "DEBUG(\n        llvm::dbgs() << \"Found existing specialization for: \"\n                     << FunctionName << '\\n'",
          "new_text": null,
          "old_line_content": "    DEBUG(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": "getName",
          "new_api": null,
          "old_text": "swift::Demangle::demangleSymbolAsString(\n                            Specialization->getName())",
          "new_text": null,
          "old_line_content": "        llvm::dbgs() << swift::Demangle::demangleSymbolAsString(",
          "new_line_content": "                     << FunctionName << '\\n';",
          "content_same": false
        },
        {
          "line": 224,
          "old_api": "llvm::dbgs()",
          "new_api": null,
          "old_text": "llvm::dbgs()",
          "new_text": null,
          "old_line_content": "    DEBUG(llvm::dbgs() << \"Cannot reuse the specialization: \"",
          "new_line_content": "    // Forget about this function.",
          "content_same": false
        },
        {
          "line": 100,
          "old_api": "swift::Demangle::demangleSymbolAsString(SpecName)",
          "new_api": null,
          "old_text": "swift::Demangle::demangleSymbolAsString(SpecName)",
          "new_text": null,
          "old_line_content": "     swift::Demangle::demangleSymbolAsString(SpecName);",
          "new_line_content": "  auto DemangledNameString =",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": "find",
          "new_api": null,
          "old_text": "DemangledName.find(\"generic \", 0)",
          "new_text": null,
          "old_line_content": "  auto pos = DemangledName.find(\"generic \", 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": "empty",
          "new_api": null,
          "old_text": "NewApplyPairs.empty()",
          "new_text": null,
          "old_line_content": "  assert(NewApplyPairs.empty() && \"Expected no new applies in vector yet!\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": "getCallee",
          "new_api": null,
          "old_text": "Apply.getCallee()",
          "new_text": null,
          "old_line_content": "  auto *F = cast<FunctionRefInst>(Apply.getCallee())->getReferencedFunction();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 114,
          "old_api": "str",
          "new_api": null,
          "old_text": "buffer.str()",
          "new_text": null,
          "old_line_content": "  StringRef OfStr = buffer.str();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 116,
          "old_api": "find",
          "new_api": null,
          "old_text": "DemangledName.find(OfStr, pos)",
          "new_text": null,
          "old_line_content": "  pos = DemangledName.find(OfStr, pos);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": "getInstruction",
          "new_api": null,
          "old_text": "Apply.getInstruction()",
          "new_text": null,
          "old_line_content": "  DEBUG(llvm::dbgs() << \"  ApplyInst: \" << *Apply.getInstruction());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 121,
          "old_api": "size",
          "new_api": null,
          "old_text": "OfStr.size()",
          "new_text": null,
          "old_line_content": "  pos += OfStr.size();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 250,
          "old_api": "getLoweredFunctionType",
          "new_api": null,
          "old_text": "F->getLoweredFunctionType()->getGenericSignature()",
          "new_text": null,
          "old_line_content": "  if (F->getLoweredFunctionType()->getGenericSignature())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 124,
          "old_api": "find",
          "new_api": null,
          "old_text": "DemangledName.find(Name, pos)",
          "new_text": null,
          "old_line_content": "    auto pos1 = DemangledName.find(Name, pos);",
          "new_line_content": "  for(auto Name: Whitelist) {",
          "content_same": false
        },
        {
          "line": 255,
          "old_api": "getContextGenericParams",
          "new_api": null,
          "old_text": "F->getContextGenericParams()",
          "new_text": null,
          "old_line_content": "  if (F->getContextGenericParams())",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 27,
      "total_additions": 40,
      "total_deletions": 40,
      "total_api_changes": 107
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 1,
        "api_related_lines": 107,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          88
        ]
      }
    },
    "api_calls_before": 127,
    "api_calls_after": 127,
    "diff_info": {
      "added_lines": 1,
      "removed_lines": 0,
      "total_diff_lines": 13
    }
  }
}