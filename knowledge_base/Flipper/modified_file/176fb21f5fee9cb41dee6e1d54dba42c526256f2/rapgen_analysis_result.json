{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/Flipper/modified_file/176fb21f5fee9cb41dee6e1d54dba42c526256f2",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/Flipper/modified_file/176fb21f5fee9cb41dee6e1d54dba42c526256f2/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/Flipper/modified_file/176fb21f5fee9cb41dee6e1d54dba42c526256f2/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/Flipper/modified_file/176fb21f5fee9cb41dee6e1d54dba42c526256f2/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 349,
          "old_api": "storage_file_get_error",
          "new_api": "storage_file_close",
          "old_text": "storage_file_get_error(file)",
          "new_text": "storage_file_close(file)",
          "old_line_content": "            storage_cli_print_error(storage_file_get_error(file));",
          "new_line_content": "        storage_file_close(file);",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": "furi_record_open",
          "new_api": "furi_string_cmp_str",
          "old_text": "furi_record_open(RECORD_STORAGE)",
          "new_text": "furi_string_cmp_str(path, \"/\")",
          "old_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "new_line_content": "    if(furi_string_cmp_str(path, \"/\") == 0) {",
          "content_same": false
        },
        {
          "line": 363,
          "old_api": "printf",
          "new_api": "furi_string_cmp_str",
          "old_text": "printf(\"Storage\\r\\n\")",
          "new_text": "furi_string_cmp_str(path, STORAGE_EXT_PATH_PREFIX)",
          "old_line_content": "        printf(\"Storage\\r\\n\");",
          "new_line_content": "        furi_string_cmp_str(path, STORAGE_EXT_PATH_PREFIX) == 0 ||",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": "storage_cli_print_error",
          "new_api": "printf",
          "old_text": "storage_cli_print_error(error)",
          "new_text": "printf(\n                \"Storage, %luKiB total, %luKiB free\\r\\n\",\n                (uint32_t)(total_space / 1024),\n                (uint32_t)(free_space / 1024))",
          "old_line_content": "            storage_cli_print_error(error);",
          "new_line_content": "            printf(",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": "furi_record_open",
          "new_api": "furi_string_alloc",
          "old_text": "furi_record_open(RECORD_STORAGE)",
          "new_text": "furi_string_alloc()",
          "old_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "new_line_content": "    new_path = furi_string_alloc();",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": "furi_string_alloc",
          "new_api": "args_read_probably_quoted_string_and_trim",
          "old_text": "furi_string_alloc()",
          "new_text": "args_read_probably_quoted_string_and_trim(args, new_path)",
          "old_line_content": "    new_path = furi_string_alloc();",
          "new_line_content": "    if(!args_read_probably_quoted_string_and_trim(args, new_path)) {",
          "content_same": false
        },
        {
          "line": 422,
          "old_api": "storage_cli_print_usage",
          "new_api": "storage_common_copy",
          "old_text": "storage_cli_print_usage()",
          "new_text": "storage_common_copy(\n            api, furi_string_get_cstr(old_path), furi_string_get_cstr(new_path))",
          "old_line_content": "        storage_cli_print_usage();",
          "new_line_content": "        FS_Error error = storage_common_copy(",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "UNUSED",
          "new_api": "furi_string_get_cstr",
          "old_text": "UNUSED(cli)",
          "new_text": "furi_string_get_cstr(path)",
          "old_line_content": "    UNUSED(cli);",
          "new_line_content": "    FS_Error error = storage_common_remove(api, furi_string_get_cstr(path));",
          "content_same": false
        },
        {
          "line": 450,
          "old_api": "furi_record_open",
          "new_api": "furi_string_alloc",
          "old_text": "furi_record_open(RECORD_STORAGE)",
          "new_text": "furi_string_alloc()",
          "old_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "new_line_content": "    new_path = furi_string_alloc();",
          "content_same": false
        },
        {
          "line": 452,
          "old_api": "furi_string_alloc",
          "new_api": "args_read_probably_quoted_string_and_trim",
          "old_text": "furi_string_alloc()",
          "new_text": "args_read_probably_quoted_string_and_trim(args, new_path)",
          "old_line_content": "    new_path = furi_string_alloc();",
          "new_line_content": "    if(!args_read_probably_quoted_string_and_trim(args, new_path)) {",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": "storage_cli_print_usage",
          "new_api": "storage_common_rename",
          "old_text": "storage_cli_print_usage()",
          "new_text": "storage_common_rename(\n            api, furi_string_get_cstr(old_path), furi_string_get_cstr(new_path))",
          "old_line_content": "        storage_cli_print_usage();",
          "new_line_content": "        FS_Error error = storage_common_rename(",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": "UNUSED",
          "new_api": "furi_string_get_cstr",
          "old_text": "UNUSED(cli)",
          "new_text": "furi_string_get_cstr(path)",
          "old_line_content": "    UNUSED(cli);",
          "new_line_content": "    FS_Error error = storage_common_mkdir(api, furi_string_get_cstr(path));",
          "content_same": false
        },
        {
          "line": 482,
          "old_api": "UNUSED",
          "new_api": "storage_file_alloc",
          "old_text": "UNUSED(cli)",
          "new_text": "storage_file_alloc(api)",
          "old_line_content": "    UNUSED(cli);",
          "new_line_content": "    File* file = storage_file_alloc(api);",
          "content_same": false
        },
        {
          "line": 483,
          "old_api": "furi_record_open",
          "new_api": "furi_string_alloc",
          "old_text": "furi_record_open(RECORD_STORAGE)",
          "new_text": "furi_string_alloc()",
          "old_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "new_line_content": "    FuriString* md5 = furi_string_alloc();",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": "furi_string_get_cstr",
          "new_api": "storage_cli_print_error",
          "old_text": "furi_string_get_cstr(md5)",
          "new_text": "storage_cli_print_error(file_error)",
          "old_line_content": "        printf(\"%s\\r\\n\", furi_string_get_cstr(md5));",
          "new_line_content": "        storage_cli_print_error(file_error);",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": "furi_string_free",
          "new_api": "storage_file_free",
          "old_text": "furi_string_free(md5)",
          "new_text": "storage_file_free(file)",
          "old_line_content": "    furi_string_free(md5);",
          "new_line_content": "    storage_file_free(file);",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": "storage_file_free",
          "new_api": "furi_record_close",
          "old_text": "storage_file_free(file)",
          "new_text": "furi_record_close(RECORD_STORAGE)",
          "old_line_content": "    storage_file_free(file);",
          "new_line_content": "    furi_record_close(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 602,
          "old_api": "UNUSED",
          "new_api": "printf",
          "old_text": "UNUSED(args)",
          "new_text": "printf(\"All data will be lost! Are you sure (y/n)?\\r\\n\")",
          "old_line_content": "    UNUSED(args);",
          "new_line_content": "    printf(\"All data will be lost! Are you sure (y/n)?\\r\\n\");",
          "content_same": false
        },
        {
          "line": 603,
          "old_api": "UNUSED",
          "new_api": "cli_getc",
          "old_text": "UNUSED(context)",
          "new_text": "cli_getc(cli)",
          "old_line_content": "    UNUSED(context);",
          "new_line_content": "    char c = cli_getc(cli);",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": "cli_getc",
          "new_api": "printf",
          "old_text": "cli_getc(cli)",
          "new_text": "printf(\"Data will be wiped after reboot.\\r\\n\")",
          "old_line_content": "    char c = cli_getc(cli);",
          "new_line_content": "        printf(\"Data will be wiped after reboot.\\r\\n\");",
          "content_same": false
        },
        {
          "line": 607,
          "old_api": "printf",
          "new_api": "power_reboot",
          "old_text": "printf(\"Data will be wiped after reboot.\\r\\n\")",
          "new_text": "power_reboot(PowerBootModeNormal)",
          "old_line_content": "        printf(\"Data will be wiped after reboot.\\r\\n\");",
          "new_line_content": "        power_reboot(PowerBootModeNormal);",
          "content_same": false
        },
        {
          "line": 609,
          "old_api": "power_reboot",
          "new_api": "printf",
          "old_text": "power_reboot(PowerBootModeNormal)",
          "new_text": "printf(\"Safe choice.\\r\\n\")",
          "old_line_content": "        power_reboot(PowerBootModeNormal);",
          "new_line_content": "        printf(\"Safe choice.\\r\\n\");",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": "furi_record_open",
          "new_api": "cli_add_command",
          "old_text": "furi_record_open(RECORD_CLI)",
          "new_text": "cli_add_command(\n        cli, \"factory_reset\", CliCommandFlagParallelSafe, storage_cli_factory_reset, NULL)",
          "old_line_content": "    Cli* cli = furi_record_open(RECORD_CLI);",
          "new_line_content": "    cli_add_command(",
          "content_same": false
        },
        {
          "line": 619,
          "old_api": "cli_add_command",
          "new_api": "furi_record_close",
          "old_text": "cli_add_command(\n        cli, \"factory_reset\", CliCommandFlagParallelSafe, storage_cli_factory_reset, NULL)",
          "new_text": "furi_record_close(RECORD_CLI)",
          "old_line_content": "    cli_add_command(",
          "new_line_content": "    furi_record_close(RECORD_CLI);",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": "furi_record_close",
          "new_api": "UNUSED",
          "old_text": "furi_record_close(RECORD_CLI)",
          "new_text": "UNUSED(storage_cli_factory_reset)",
          "old_line_content": "    furi_record_close(RECORD_CLI);",
          "new_line_content": "    UNUSED(storage_cli_factory_reset);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 512,
          "old_api": null,
          "new_api": "args_read_probably_quoted_string_and_trim",
          "old_text": null,
          "new_text": "args_read_probably_quoted_string_and_trim(args, path)",
          "old_line_content": "        }",
          "new_line_content": "        if(!args_read_probably_quoted_string_and_trim(args, path)) {",
          "content_same": false
        },
        {
          "line": 513,
          "old_api": null,
          "new_api": "storage_cli_print_usage",
          "old_text": null,
          "new_text": "storage_cli_print_usage()",
          "old_line_content": "",
          "new_line_content": "            storage_cli_print_usage();",
          "content_same": false
        },
        {
          "line": 517,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"info\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"info\") == 0) {",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": null,
          "new_api": "storage_cli_info",
          "old_text": null,
          "new_text": "storage_cli_info(cli, path)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_info(cli, path);",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"format\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"format\") == 0) {",
          "content_same": false
        },
        {
          "line": 523,
          "old_api": null,
          "new_api": "storage_cli_format",
          "old_text": null,
          "new_text": "storage_cli_format(cli, path)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_format(cli, path);",
          "content_same": false
        },
        {
          "line": 527,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"list\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"list\") == 0) {",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": null,
          "new_api": "storage_cli_list",
          "old_text": null,
          "new_text": "storage_cli_list(cli, path)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_list(cli, path);",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"tree\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"tree\") == 0) {",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": null,
          "new_api": "storage_cli_tree",
          "old_text": null,
          "new_text": "storage_cli_tree(cli, path)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_tree(cli, path);",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"read\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"read\") == 0) {",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": null,
          "new_api": "storage_cli_read",
          "old_text": null,
          "new_text": "storage_cli_read(cli, path)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_read(cli, path);",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"read_chunks\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"read_chunks\") == 0) {",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": null,
          "new_api": "storage_cli_read_chunks",
          "old_text": null,
          "new_text": "storage_cli_read_chunks(cli, path, args)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_read_chunks(cli, path, args);",
          "content_same": false
        },
        {
          "line": 547,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"write\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"write\") == 0) {",
          "content_same": false
        },
        {
          "line": 548,
          "old_api": null,
          "new_api": "storage_cli_write",
          "old_text": null,
          "new_text": "storage_cli_write(cli, path)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_write(cli, path);",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"write_chunk\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"write_chunk\") == 0) {",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": null,
          "new_api": "storage_cli_write_chunk",
          "old_text": null,
          "new_text": "storage_cli_write_chunk(cli, path, args)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_write_chunk(cli, path, args);",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"copy\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"copy\") == 0) {",
          "content_same": false
        },
        {
          "line": 558,
          "old_api": null,
          "new_api": "storage_cli_copy",
          "old_text": null,
          "new_text": "storage_cli_copy(cli, path, args)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_copy(cli, path, args);",
          "content_same": false
        },
        {
          "line": 562,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"remove\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"remove\") == 0) {",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": null,
          "new_api": "storage_cli_remove",
          "old_text": null,
          "new_text": "storage_cli_remove(cli, path)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_remove(cli, path);",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"rename\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"rename\") == 0) {",
          "content_same": false
        },
        {
          "line": 568,
          "old_api": null,
          "new_api": "storage_cli_rename",
          "old_text": null,
          "new_text": "storage_cli_rename(cli, path, args)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_rename(cli, path, args);",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"mkdir\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"mkdir\") == 0) {",
          "content_same": false
        },
        {
          "line": 573,
          "old_api": null,
          "new_api": "storage_cli_mkdir",
          "old_text": null,
          "new_text": "storage_cli_mkdir(cli, path)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_mkdir(cli, path);",
          "content_same": false
        },
        {
          "line": 577,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"md5\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"md5\") == 0) {",
          "content_same": false
        },
        {
          "line": 578,
          "old_api": null,
          "new_api": "storage_cli_md5",
          "old_text": null,
          "new_text": "storage_cli_md5(cli, path)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_md5(cli, path);",
          "content_same": false
        },
        {
          "line": 582,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"stat\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"stat\") == 0) {",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": null,
          "new_api": "storage_cli_stat",
          "old_text": null,
          "new_text": "storage_cli_stat(cli, path)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_stat(cli, path);",
          "content_same": false
        },
        {
          "line": 587,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(cmd, \"timestamp\")",
          "old_line_content": "        }",
          "new_line_content": "        if(furi_string_cmp_str(cmd, \"timestamp\") == 0) {",
          "content_same": false
        },
        {
          "line": 588,
          "old_api": null,
          "new_api": "storage_cli_timestamp",
          "old_text": null,
          "new_text": "storage_cli_timestamp(cli, path)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_timestamp(cli, path);",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": null,
          "new_api": "storage_cli_print_usage",
          "old_text": null,
          "new_text": "storage_cli_print_usage()",
          "old_line_content": "        }",
          "new_line_content": "        storage_cli_print_usage();",
          "content_same": false
        },
        {
          "line": 595,
          "old_api": null,
          "new_api": "furi_string_free",
          "old_text": null,
          "new_text": "furi_string_free(path)",
          "old_line_content": "    } while(false);",
          "new_line_content": "    furi_string_free(path);",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": null,
          "new_api": "furi_string_free",
          "old_text": null,
          "new_text": "furi_string_free(cmd)",
          "old_line_content": "",
          "new_line_content": "    furi_string_free(cmd);",
          "content_same": false
        },
        {
          "line": 600,
          "old_api": null,
          "new_api": "UNUSED",
          "old_text": null,
          "new_text": "UNUSED(args)",
          "old_line_content": "",
          "new_line_content": "    UNUSED(args);",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": null,
          "new_api": "UNUSED",
          "old_text": null,
          "new_text": "UNUSED(context)",
          "old_line_content": "static void storage_cli_factory_reset(Cli* cli, FuriString* args, void* context) {",
          "new_line_content": "    UNUSED(context);",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": null,
          "new_api": "furi_hal_rtc_set_flag",
          "old_text": null,
          "new_text": "furi_hal_rtc_set_flag(FuriHalRtcFlagFactoryReset)",
          "old_line_content": "    if(c == 'y' || c == 'Y') {",
          "new_line_content": "        furi_hal_rtc_set_flag(FuriHalRtcFlagFactoryReset);",
          "content_same": false
        },
        {
          "line": 615,
          "old_api": null,
          "new_api": "furi_record_open",
          "old_text": null,
          "new_text": "furi_record_open(RECORD_CLI)",
          "old_line_content": "void storage_on_system_start() {",
          "new_line_content": "    Cli* cli = furi_record_open(RECORD_CLI);",
          "content_same": false
        },
        {
          "line": 616,
          "old_api": null,
          "new_api": "cli_add_command",
          "old_text": null,
          "new_text": "cli_add_command(cli, RECORD_STORAGE, CliCommandFlagParallelSafe, storage_cli, NULL)",
          "old_line_content": "#ifdef SRV_CLI",
          "new_line_content": "    cli_add_command(cli, RECORD_STORAGE, CliCommandFlagParallelSafe, storage_cli, NULL);",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": null,
          "new_api": "cli_read",
          "old_text": null,
          "new_text": "cli_read(cli, buffer, buffer_size)",
          "old_line_content": "                for(uint32_t i = 0; i < buffer_size; i++) {",
          "new_line_content": "                size_t read_bytes = cli_read(cli, buffer, buffer_size);",
          "content_same": false
        },
        {
          "line": 338,
          "old_api": null,
          "new_api": "storage_file_write",
          "old_text": null,
          "new_text": "storage_file_write(file, buffer, read_bytes)",
          "old_line_content": "                }",
          "new_line_content": "                uint16_t written_size = storage_file_write(file, buffer, read_bytes);",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": null,
          "new_api": "storage_file_get_error",
          "old_text": null,
          "new_text": "storage_file_get_error(file)",
          "old_line_content": "",
          "new_line_content": "                    storage_cli_print_error(storage_file_get_error(file));",
          "content_same": false
        },
        {
          "line": 344,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(buffer)",
          "old_line_content": "                }",
          "new_line_content": "                free(buffer);",
          "content_same": false
        },
        {
          "line": 347,
          "old_api": null,
          "new_api": "storage_file_get_error",
          "old_text": null,
          "new_text": "storage_file_get_error(file)",
          "old_line_content": "            }",
          "new_line_content": "            storage_cli_print_error(storage_file_get_error(file));",
          "content_same": false
        },
        {
          "line": 352,
          "old_api": null,
          "new_api": "storage_file_free",
          "old_text": null,
          "new_text": "storage_file_free(file)",
          "old_line_content": "    }",
          "new_line_content": "    storage_file_free(file);",
          "content_same": false
        },
        {
          "line": 353,
          "old_api": null,
          "new_api": "furi_record_close",
          "old_text": null,
          "new_text": "furi_record_close(RECORD_STORAGE)",
          "old_line_content": "",
          "new_line_content": "    furi_record_close(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": null,
          "new_api": "UNUSED",
          "old_text": null,
          "new_text": "UNUSED(cli)",
          "old_line_content": "",
          "new_line_content": "    UNUSED(cli);",
          "content_same": false
        },
        {
          "line": 358,
          "old_api": null,
          "new_api": "furi_record_open",
          "old_text": null,
          "new_text": "furi_record_open(RECORD_STORAGE)",
          "old_line_content": "static void storage_cli_stat(Cli* cli, FuriString* path) {",
          "new_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 361,
          "old_api": null,
          "new_api": "printf",
          "old_text": null,
          "new_text": "printf(\"Storage\\r\\n\")",
          "old_line_content": "",
          "new_line_content": "        printf(\"Storage\\r\\n\");",
          "content_same": false
        },
        {
          "line": 364,
          "old_api": null,
          "new_api": "furi_string_cmp_str",
          "old_text": null,
          "new_text": "furi_string_cmp_str(path, STORAGE_INT_PATH_PREFIX)",
          "old_line_content": "    } else if(",
          "new_line_content": "        furi_string_cmp_str(path, STORAGE_INT_PATH_PREFIX) == 0 ||",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": null,
          "new_api": "furi_string_get_cstr",
          "old_text": null,
          "new_text": "furi_string_get_cstr(path)",
          "old_line_content": "        uint64_t free_space;",
          "new_line_content": "            storage_common_fs_info(api, furi_string_get_cstr(path), &total_space, &free_space);",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": null,
          "new_api": "storage_cli_print_error",
          "old_text": null,
          "new_text": "storage_cli_print_error(error)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_print_error(error);",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": null,
          "new_api": "furi_string_get_cstr",
          "old_text": null,
          "new_text": "furi_string_get_cstr(path)",
          "old_line_content": "    } else {",
          "new_line_content": "        FS_Error error = storage_common_stat(api, furi_string_get_cstr(path), &fileinfo);",
          "content_same": false
        },
        {
          "line": 384,
          "old_api": null,
          "new_api": "file_info_is_dir",
          "old_text": null,
          "new_text": "file_info_is_dir(&fileinfo)",
          "old_line_content": "",
          "new_line_content": "            if(file_info_is_dir(&fileinfo)) {",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": null,
          "new_api": "printf",
          "old_text": null,
          "new_text": "printf(\"Directory\\r\\n\")",
          "old_line_content": "        if(error == FSE_OK) {",
          "new_line_content": "                printf(\"Directory\\r\\n\");",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": null,
          "new_api": "storage_cli_print_error",
          "old_text": null,
          "new_text": "storage_cli_print_error(error)",
          "old_line_content": "            }",
          "new_line_content": "            storage_cli_print_error(error);",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": null,
          "new_api": "furi_record_close",
          "old_text": null,
          "new_text": "furi_record_close(RECORD_STORAGE)",
          "old_line_content": "    }",
          "new_line_content": "    furi_record_close(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": null,
          "new_api": "UNUSED",
          "old_text": null,
          "new_text": "UNUSED(cli)",
          "old_line_content": "",
          "new_line_content": "    UNUSED(cli);",
          "content_same": false
        },
        {
          "line": 399,
          "old_api": null,
          "new_api": "furi_record_open",
          "old_text": null,
          "new_text": "furi_record_open(RECORD_STORAGE)",
          "old_line_content": "static void storage_cli_timestamp(Cli* cli, FuriString* path) {",
          "new_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": null,
          "new_api": "furi_string_get_cstr",
          "old_text": null,
          "new_text": "furi_string_get_cstr(path)",
          "old_line_content": "",
          "new_line_content": "    FS_Error error = storage_common_timestamp(api, furi_string_get_cstr(path), &timestamp);",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": null,
          "new_api": "printf",
          "old_text": null,
          "new_text": "printf(\"Invalid arguments\\r\\n\")",
          "old_line_content": "",
          "new_line_content": "        printf(\"Invalid arguments\\r\\n\");",
          "content_same": false
        },
        {
          "line": 410,
          "old_api": null,
          "new_api": "furi_record_close",
          "old_text": null,
          "new_text": "furi_record_close(RECORD_STORAGE)",
          "old_line_content": "    }",
          "new_line_content": "    furi_record_close(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": null,
          "new_api": "UNUSED",
          "old_text": null,
          "new_text": "UNUSED(cli)",
          "old_line_content": "",
          "new_line_content": "    UNUSED(cli);",
          "content_same": false
        },
        {
          "line": 415,
          "old_api": null,
          "new_api": "furi_record_open",
          "old_text": null,
          "new_text": "furi_record_open(RECORD_STORAGE)",
          "old_line_content": "static void storage_cli_copy(Cli* cli, FuriString* old_path, FuriString* args) {",
          "new_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 420,
          "old_api": null,
          "new_api": "storage_cli_print_usage",
          "old_text": null,
          "new_text": "storage_cli_print_usage()",
          "old_line_content": "",
          "new_line_content": "        storage_cli_print_usage();",
          "content_same": false
        },
        {
          "line": 423,
          "old_api": null,
          "new_api": "furi_string_get_cstr",
          "old_text": null,
          "new_text": "furi_string_get_cstr(new_path)",
          "old_line_content": "    } else {",
          "new_line_content": "            api, furi_string_get_cstr(old_path), furi_string_get_cstr(new_path));",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": null,
          "new_api": "storage_cli_print_error",
          "old_text": null,
          "new_text": "storage_cli_print_error(error)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_print_error(error);",
          "content_same": false
        },
        {
          "line": 430,
          "old_api": null,
          "new_api": "furi_string_free",
          "old_text": null,
          "new_text": "furi_string_free(new_path)",
          "old_line_content": "    }",
          "new_line_content": "    furi_string_free(new_path);",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": null,
          "new_api": "furi_record_close",
          "old_text": null,
          "new_text": "furi_record_close(RECORD_STORAGE)",
          "old_line_content": "",
          "new_line_content": "    furi_record_close(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": null,
          "new_api": "UNUSED",
          "old_text": null,
          "new_text": "UNUSED(cli)",
          "old_line_content": "",
          "new_line_content": "    UNUSED(cli);",
          "content_same": false
        },
        {
          "line": 436,
          "old_api": null,
          "new_api": "furi_record_open",
          "old_text": null,
          "new_text": "furi_record_open(RECORD_STORAGE)",
          "old_line_content": "static void storage_cli_remove(Cli* cli, FuriString* path) {",
          "new_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": null,
          "new_api": "storage_cli_print_error",
          "old_text": null,
          "new_text": "storage_cli_print_error(error)",
          "old_line_content": "",
          "new_line_content": "        storage_cli_print_error(error);",
          "content_same": false
        },
        {
          "line": 443,
          "old_api": null,
          "new_api": "furi_record_close",
          "old_text": null,
          "new_text": "furi_record_close(RECORD_STORAGE)",
          "old_line_content": "    }",
          "new_line_content": "    furi_record_close(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 447,
          "old_api": null,
          "new_api": "UNUSED",
          "old_text": null,
          "new_text": "UNUSED(cli)",
          "old_line_content": "",
          "new_line_content": "    UNUSED(cli);",
          "content_same": false
        },
        {
          "line": 448,
          "old_api": null,
          "new_api": "furi_record_open",
          "old_text": null,
          "new_text": "furi_record_open(RECORD_STORAGE)",
          "old_line_content": "static void storage_cli_rename(Cli* cli, FuriString* old_path, FuriString* args) {",
          "new_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 453,
          "old_api": null,
          "new_api": "storage_cli_print_usage",
          "old_text": null,
          "new_text": "storage_cli_print_usage()",
          "old_line_content": "",
          "new_line_content": "        storage_cli_print_usage();",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": null,
          "new_api": "furi_string_get_cstr",
          "old_text": null,
          "new_text": "furi_string_get_cstr(new_path)",
          "old_line_content": "    } else {",
          "new_line_content": "            api, furi_string_get_cstr(old_path), furi_string_get_cstr(new_path));",
          "content_same": false
        },
        {
          "line": 459,
          "old_api": null,
          "new_api": "storage_cli_print_error",
          "old_text": null,
          "new_text": "storage_cli_print_error(error)",
          "old_line_content": "",
          "new_line_content": "            storage_cli_print_error(error);",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": null,
          "new_api": "furi_string_free",
          "old_text": null,
          "new_text": "furi_string_free(new_path)",
          "old_line_content": "    }",
          "new_line_content": "    furi_string_free(new_path);",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": null,
          "new_api": "furi_record_close",
          "old_text": null,
          "new_text": "furi_record_close(RECORD_STORAGE)",
          "old_line_content": "",
          "new_line_content": "    furi_record_close(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": null,
          "new_api": "UNUSED",
          "old_text": null,
          "new_text": "UNUSED(cli)",
          "old_line_content": "",
          "new_line_content": "    UNUSED(cli);",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": null,
          "new_api": "furi_record_open",
          "old_text": null,
          "new_text": "furi_record_open(RECORD_STORAGE)",
          "old_line_content": "static void storage_cli_mkdir(Cli* cli, FuriString* path) {",
          "new_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": null,
          "new_api": "storage_cli_print_error",
          "old_text": null,
          "new_text": "storage_cli_print_error(error)",
          "old_line_content": "",
          "new_line_content": "        storage_cli_print_error(error);",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": null,
          "new_api": "furi_record_close",
          "old_text": null,
          "new_text": "furi_record_close(RECORD_STORAGE)",
          "old_line_content": "    }",
          "new_line_content": "    furi_record_close(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": null,
          "new_api": "UNUSED",
          "old_text": null,
          "new_text": "UNUSED(cli)",
          "old_line_content": "",
          "new_line_content": "    UNUSED(cli);",
          "content_same": false
        },
        {
          "line": 481,
          "old_api": null,
          "new_api": "furi_record_open",
          "old_text": null,
          "new_text": "furi_record_open(RECORD_STORAGE)",
          "old_line_content": "static void storage_cli_md5(Cli* cli, FuriString* path) {",
          "new_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": null,
          "new_api": "furi_string_get_cstr",
          "old_text": null,
          "new_text": "furi_string_get_cstr(path)",
          "old_line_content": "    FS_Error file_error;",
          "new_line_content": "    if(md5_string_calc_file(file, furi_string_get_cstr(path), md5, &file_error)) {",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": null,
          "new_api": "furi_string_get_cstr",
          "old_text": null,
          "new_text": "furi_string_get_cstr(md5)",
          "old_line_content": "",
          "new_line_content": "        printf(\"%s\\r\\n\", furi_string_get_cstr(md5));",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": null,
          "new_api": "furi_string_free",
          "old_text": null,
          "new_text": "furi_string_free(md5)",
          "old_line_content": "    }",
          "new_line_content": "    furi_string_free(md5);",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": null,
          "new_api": "storage_file_close",
          "old_text": null,
          "new_text": "storage_file_close(file)",
          "old_line_content": "",
          "new_line_content": "    storage_file_close(file);",
          "content_same": false
        },
        {
          "line": 500,
          "old_api": null,
          "new_api": "UNUSED",
          "old_text": null,
          "new_text": "UNUSED(context)",
          "old_line_content": "",
          "new_line_content": "    UNUSED(context);",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": null,
          "new_api": "furi_string_alloc",
          "old_text": null,
          "new_text": "furi_string_alloc()",
          "old_line_content": "    FuriString* cmd;",
          "new_line_content": "    cmd = furi_string_alloc();",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": null,
          "new_api": "furi_string_alloc",
          "old_text": null,
          "new_text": "furi_string_alloc()",
          "old_line_content": "    FuriString* path;",
          "new_line_content": "    path = furi_string_alloc();",
          "content_same": false
        },
        {
          "line": 507,
          "old_api": null,
          "new_api": "args_read_string_and_trim",
          "old_text": null,
          "new_text": "args_read_string_and_trim(args, cmd)",
          "old_line_content": "",
          "new_line_content": "        if(!args_read_string_and_trim(args, cmd)) {",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": null,
          "new_api": "storage_cli_print_usage",
          "old_text": null,
          "new_text": "storage_cli_print_usage()",
          "old_line_content": "    do {",
          "new_line_content": "            storage_cli_print_usage();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 514,
          "old_api": "args_read_probably_quoted_string_and_trim",
          "new_api": null,
          "old_text": "args_read_probably_quoted_string_and_trim(args, path)",
          "new_text": null,
          "old_line_content": "        if(!args_read_probably_quoted_string_and_trim(args, path)) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 515,
          "old_api": "storage_cli_print_usage",
          "new_api": null,
          "old_text": "storage_cli_print_usage()",
          "new_text": null,
          "old_line_content": "            storage_cli_print_usage();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 519,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"info\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"info\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 520,
          "old_api": "storage_cli_info",
          "new_api": null,
          "old_text": "storage_cli_info(cli, path)",
          "new_text": null,
          "old_line_content": "            storage_cli_info(cli, path);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"format\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"format\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 525,
          "old_api": "storage_cli_format",
          "new_api": null,
          "old_text": "storage_cli_format(cli, path)",
          "new_text": null,
          "old_line_content": "            storage_cli_format(cli, path);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 529,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"list\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"list\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 530,
          "old_api": "storage_cli_list",
          "new_api": null,
          "old_text": "storage_cli_list(cli, path)",
          "new_text": null,
          "old_line_content": "            storage_cli_list(cli, path);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"tree\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"tree\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 535,
          "old_api": "storage_cli_tree",
          "new_api": null,
          "old_text": "storage_cli_tree(cli, path)",
          "new_text": null,
          "old_line_content": "            storage_cli_tree(cli, path);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"read\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"read\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": "storage_cli_read",
          "new_api": null,
          "old_text": "storage_cli_read(cli, path)",
          "new_text": null,
          "old_line_content": "            storage_cli_read(cli, path);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 544,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"read_chunks\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"read_chunks\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 545,
          "old_api": "storage_cli_read_chunks",
          "new_api": null,
          "old_text": "storage_cli_read_chunks(cli, path, args)",
          "new_text": null,
          "old_line_content": "            storage_cli_read_chunks(cli, path, args);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 549,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"write\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"write\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 550,
          "old_api": "storage_cli_write",
          "new_api": null,
          "old_text": "storage_cli_write(cli, path)",
          "new_text": null,
          "old_line_content": "            storage_cli_write(cli, path);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"write_chunk\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"write_chunk\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 555,
          "old_api": "storage_cli_write_chunk",
          "new_api": null,
          "old_text": "storage_cli_write_chunk(cli, path, args)",
          "new_text": null,
          "old_line_content": "            storage_cli_write_chunk(cli, path, args);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"copy\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"copy\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 560,
          "old_api": "storage_cli_copy",
          "new_api": null,
          "old_text": "storage_cli_copy(cli, path, args)",
          "new_text": null,
          "old_line_content": "            storage_cli_copy(cli, path, args);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 564,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"remove\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"remove\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": "storage_cli_remove",
          "new_api": null,
          "old_text": "storage_cli_remove(cli, path)",
          "new_text": null,
          "old_line_content": "            storage_cli_remove(cli, path);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"rename\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"rename\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 570,
          "old_api": "storage_cli_rename",
          "new_api": null,
          "old_text": "storage_cli_rename(cli, path, args)",
          "new_text": null,
          "old_line_content": "            storage_cli_rename(cli, path, args);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"mkdir\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"mkdir\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": "storage_cli_mkdir",
          "new_api": null,
          "old_text": "storage_cli_mkdir(cli, path)",
          "new_text": null,
          "old_line_content": "            storage_cli_mkdir(cli, path);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 579,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"md5\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"md5\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 580,
          "old_api": "storage_cli_md5",
          "new_api": null,
          "old_text": "storage_cli_md5(cli, path)",
          "new_text": null,
          "old_line_content": "            storage_cli_md5(cli, path);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"stat\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"stat\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": "storage_cli_stat",
          "new_api": null,
          "old_text": "storage_cli_stat(cli, path)",
          "new_text": null,
          "old_line_content": "            storage_cli_stat(cli, path);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(cmd, \"timestamp\")",
          "new_text": null,
          "old_line_content": "        if(furi_string_cmp_str(cmd, \"timestamp\") == 0) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": "storage_cli_timestamp",
          "new_api": null,
          "old_text": "storage_cli_timestamp(cli, path)",
          "new_text": null,
          "old_line_content": "            storage_cli_timestamp(cli, path);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": "storage_cli_print_usage",
          "new_api": null,
          "old_text": "storage_cli_print_usage()",
          "new_text": null,
          "old_line_content": "        storage_cli_print_usage();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "furi_string_free",
          "new_api": null,
          "old_text": "furi_string_free(path)",
          "new_text": null,
          "old_line_content": "    furi_string_free(path);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": "furi_string_free",
          "new_api": null,
          "old_text": "furi_string_free(cmd)",
          "new_text": null,
          "old_line_content": "    furi_string_free(cmd);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 604,
          "old_api": "printf",
          "new_api": null,
          "old_text": "printf(\"All data will be lost! Are you sure (y/n)?\\r\\n\")",
          "new_text": null,
          "old_line_content": "    printf(\"All data will be lost! Are you sure (y/n)?\\r\\n\");",
          "new_line_content": "    if(c == 'y' || c == 'Y') {",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": "furi_hal_rtc_set_flag",
          "new_api": null,
          "old_text": "furi_hal_rtc_set_flag(FuriHalRtcFlagFactoryReset)",
          "new_text": null,
          "old_line_content": "        furi_hal_rtc_set_flag(FuriHalRtcFlagFactoryReset);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 611,
          "old_api": "printf",
          "new_api": null,
          "old_text": "printf(\"Safe choice.\\r\\n\")",
          "new_text": null,
          "old_line_content": "        printf(\"Safe choice.\\r\\n\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": "cli_add_command",
          "new_api": null,
          "old_text": "cli_add_command(cli, RECORD_STORAGE, CliCommandFlagParallelSafe, storage_cli, NULL)",
          "new_text": null,
          "old_line_content": "    cli_add_command(cli, RECORD_STORAGE, CliCommandFlagParallelSafe, storage_cli, NULL);",
          "new_line_content": "        cli, \"factory_reset\", CliCommandFlagParallelSafe, storage_cli_factory_reset, NULL);",
          "content_same": false
        },
        {
          "line": 623,
          "old_api": "UNUSED",
          "new_api": null,
          "old_text": "UNUSED(storage_cli_factory_reset)",
          "new_text": null,
          "old_line_content": "    UNUSED(storage_cli_factory_reset);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": "cli_getc",
          "new_api": null,
          "old_text": "cli_getc(cli)",
          "new_text": null,
          "old_line_content": "                    buffer[i] = cli_getc(cli);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": "storage_file_write",
          "new_api": null,
          "old_text": "storage_file_write(file, buffer, buffer_size)",
          "new_text": null,
          "old_line_content": "                uint16_t written_size = storage_file_write(file, buffer, buffer_size);",
          "new_line_content": "                if(written_size != buffer_size) {",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": "storage_file_get_error",
          "new_api": null,
          "old_text": "storage_file_get_error(file)",
          "new_text": null,
          "old_line_content": "                    storage_cli_print_error(storage_file_get_error(file));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 346,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(buffer)",
          "new_text": null,
          "old_line_content": "                free(buffer);",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 351,
          "old_api": "storage_file_close",
          "new_api": null,
          "old_text": "storage_file_close(file)",
          "new_text": null,
          "old_line_content": "        storage_file_close(file);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": "storage_file_free",
          "new_api": null,
          "old_text": "storage_file_free(file)",
          "new_text": null,
          "old_line_content": "    storage_file_free(file);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": "furi_record_close",
          "new_api": null,
          "old_text": "furi_record_close(RECORD_STORAGE)",
          "new_text": null,
          "old_line_content": "    furi_record_close(RECORD_STORAGE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 359,
          "old_api": "UNUSED",
          "new_api": null,
          "old_text": "UNUSED(cli)",
          "new_text": null,
          "old_line_content": "    UNUSED(cli);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 362,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(path, \"/\")",
          "new_text": null,
          "old_line_content": "    if(furi_string_cmp_str(path, \"/\") == 0) {",
          "new_line_content": "    } else if(",
          "content_same": false
        },
        {
          "line": 366,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(path, STORAGE_INT_PATH_PREFIX)",
          "new_text": null,
          "old_line_content": "        furi_string_cmp_str(path, STORAGE_INT_PATH_PREFIX) == 0 ||",
          "new_line_content": "        uint64_t total_space;",
          "content_same": false
        },
        {
          "line": 367,
          "old_api": "furi_string_cmp_str",
          "new_api": null,
          "old_text": "furi_string_cmp_str(path, STORAGE_ANY_PATH_PREFIX)",
          "new_text": null,
          "old_line_content": "        furi_string_cmp_str(path, STORAGE_ANY_PATH_PREFIX) == 0) {",
          "new_line_content": "        uint64_t free_space;",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": "furi_string_get_cstr",
          "new_api": null,
          "old_text": "furi_string_get_cstr(path)",
          "new_text": null,
          "old_line_content": "            storage_common_fs_info(api, furi_string_get_cstr(path), &total_space, &free_space);",
          "new_line_content": "        if(error != FSE_OK) {",
          "content_same": false
        },
        {
          "line": 376,
          "old_api": "printf",
          "new_api": null,
          "old_text": "printf(\n                \"Storage, %luKiB total, %luKiB free\\r\\n\",\n                (uint32_t)(total_space / 1024),\n                (uint32_t)(free_space / 1024))",
          "new_text": null,
          "old_line_content": "            printf(",
          "new_line_content": "                (uint32_t)(total_space / 1024),",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": "furi_string_get_cstr",
          "new_api": null,
          "old_text": "furi_string_get_cstr(path)",
          "new_text": null,
          "old_line_content": "        FS_Error error = storage_common_stat(api, furi_string_get_cstr(path), &fileinfo);",
          "new_line_content": "        if(error == FSE_OK) {",
          "content_same": false
        },
        {
          "line": 386,
          "old_api": "file_info_is_dir",
          "new_api": null,
          "old_text": "file_info_is_dir(&fileinfo)",
          "new_text": null,
          "old_line_content": "            if(file_info_is_dir(&fileinfo)) {",
          "new_line_content": "            } else {",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": "printf",
          "new_api": null,
          "old_text": "printf(\"File, size: %lub\\r\\n\", (uint32_t)(fileinfo.size))",
          "new_text": null,
          "old_line_content": "                printf(\"File, size: %lub\\r\\n\", (uint32_t)(fileinfo.size));",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": "storage_cli_print_error",
          "new_api": null,
          "old_text": "storage_cli_print_error(error)",
          "new_text": null,
          "old_line_content": "            storage_cli_print_error(error);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": "furi_record_close",
          "new_api": null,
          "old_text": "furi_record_close(RECORD_STORAGE)",
          "new_text": null,
          "old_line_content": "    furi_record_close(RECORD_STORAGE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": "UNUSED",
          "new_api": null,
          "old_text": "UNUSED(cli)",
          "new_text": null,
          "old_line_content": "    UNUSED(cli);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": "furi_record_open",
          "new_api": null,
          "old_text": "furi_record_open(RECORD_STORAGE)",
          "new_text": null,
          "old_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "new_line_content": "    uint32_t timestamp = 0;",
          "content_same": false
        },
        {
          "line": 404,
          "old_api": "furi_string_get_cstr",
          "new_api": null,
          "old_text": "furi_string_get_cstr(path)",
          "new_text": null,
          "old_line_content": "    FS_Error error = storage_common_timestamp(api, furi_string_get_cstr(path), &timestamp);",
          "new_line_content": "    if(error != FSE_OK) {",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": "printf",
          "new_api": null,
          "old_text": "printf(\"Timestamp %lu\\r\\n\", timestamp)",
          "new_text": null,
          "old_line_content": "        printf(\"Timestamp %lu\\r\\n\", timestamp);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": "furi_record_close",
          "new_api": null,
          "old_text": "furi_record_close(RECORD_STORAGE)",
          "new_text": null,
          "old_line_content": "    furi_record_close(RECORD_STORAGE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": "UNUSED",
          "new_api": null,
          "old_text": "UNUSED(cli)",
          "new_text": null,
          "old_line_content": "    UNUSED(cli);",
          "new_line_content": "    FuriString* new_path;",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": "args_read_probably_quoted_string_and_trim",
          "new_api": null,
          "old_text": "args_read_probably_quoted_string_and_trim(args, new_path)",
          "new_text": null,
          "old_line_content": "    if(!args_read_probably_quoted_string_and_trim(args, new_path)) {",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": "storage_common_copy",
          "new_api": null,
          "old_text": "storage_common_copy(\n            api, furi_string_get_cstr(old_path), furi_string_get_cstr(new_path))",
          "new_text": null,
          "old_line_content": "        FS_Error error = storage_common_copy(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 425,
          "old_api": "furi_string_get_cstr",
          "new_api": null,
          "old_text": "furi_string_get_cstr(new_path)",
          "new_text": null,
          "old_line_content": "            api, furi_string_get_cstr(old_path), furi_string_get_cstr(new_path));",
          "new_line_content": "        if(error != FSE_OK) {",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": "storage_cli_print_error",
          "new_api": null,
          "old_text": "storage_cli_print_error(error)",
          "new_text": null,
          "old_line_content": "            storage_cli_print_error(error);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": "furi_string_free",
          "new_api": null,
          "old_text": "furi_string_free(new_path)",
          "new_text": null,
          "old_line_content": "    furi_string_free(new_path);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 433,
          "old_api": "furi_record_close",
          "new_api": null,
          "old_text": "furi_record_close(RECORD_STORAGE)",
          "new_text": null,
          "old_line_content": "    furi_record_close(RECORD_STORAGE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": "furi_record_open",
          "new_api": null,
          "old_text": "furi_record_open(RECORD_STORAGE)",
          "new_text": null,
          "old_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": "furi_string_get_cstr",
          "new_api": null,
          "old_text": "furi_string_get_cstr(path)",
          "new_text": null,
          "old_line_content": "    FS_Error error = storage_common_remove(api, furi_string_get_cstr(path));",
          "new_line_content": "    if(error != FSE_OK) {",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": "storage_cli_print_error",
          "new_api": null,
          "old_text": "storage_cli_print_error(error)",
          "new_text": null,
          "old_line_content": "        storage_cli_print_error(error);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": "furi_record_close",
          "new_api": null,
          "old_text": "furi_record_close(RECORD_STORAGE)",
          "new_text": null,
          "old_line_content": "    furi_record_close(RECORD_STORAGE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 449,
          "old_api": "UNUSED",
          "new_api": null,
          "old_text": "UNUSED(cli)",
          "new_text": null,
          "old_line_content": "    UNUSED(cli);",
          "new_line_content": "    FuriString* new_path;",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": "args_read_probably_quoted_string_and_trim",
          "new_api": null,
          "old_text": "args_read_probably_quoted_string_and_trim(args, new_path)",
          "new_text": null,
          "old_line_content": "    if(!args_read_probably_quoted_string_and_trim(args, new_path)) {",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": "storage_common_rename",
          "new_api": null,
          "old_text": "storage_common_rename(\n            api, furi_string_get_cstr(old_path), furi_string_get_cstr(new_path))",
          "new_text": null,
          "old_line_content": "        FS_Error error = storage_common_rename(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": "furi_string_get_cstr",
          "new_api": null,
          "old_text": "furi_string_get_cstr(new_path)",
          "new_text": null,
          "old_line_content": "            api, furi_string_get_cstr(old_path), furi_string_get_cstr(new_path));",
          "new_line_content": "        if(error != FSE_OK) {",
          "content_same": false
        },
        {
          "line": 461,
          "old_api": "storage_cli_print_error",
          "new_api": null,
          "old_text": "storage_cli_print_error(error)",
          "new_text": null,
          "old_line_content": "            storage_cli_print_error(error);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": "furi_string_free",
          "new_api": null,
          "old_text": "furi_string_free(new_path)",
          "new_text": null,
          "old_line_content": "    furi_string_free(new_path);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": "furi_record_close",
          "new_api": null,
          "old_text": "furi_record_close(RECORD_STORAGE)",
          "new_text": null,
          "old_line_content": "    furi_record_close(RECORD_STORAGE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": "furi_record_open",
          "new_api": null,
          "old_text": "furi_record_open(RECORD_STORAGE)",
          "new_text": null,
          "old_line_content": "    Storage* api = furi_record_open(RECORD_STORAGE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": "furi_string_get_cstr",
          "new_api": null,
          "old_text": "furi_string_get_cstr(path)",
          "new_text": null,
          "old_line_content": "    FS_Error error = storage_common_mkdir(api, furi_string_get_cstr(path));",
          "new_line_content": "    if(error != FSE_OK) {",
          "content_same": false
        },
        {
          "line": 475,
          "old_api": "storage_cli_print_error",
          "new_api": null,
          "old_text": "storage_cli_print_error(error)",
          "new_text": null,
          "old_line_content": "        storage_cli_print_error(error);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": "furi_record_close",
          "new_api": null,
          "old_text": "furi_record_close(RECORD_STORAGE)",
          "new_text": null,
          "old_line_content": "    furi_record_close(RECORD_STORAGE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": "storage_file_alloc",
          "new_api": null,
          "old_text": "storage_file_alloc(api)",
          "new_text": null,
          "old_line_content": "    File* file = storage_file_alloc(api);",
          "new_line_content": "    FS_Error file_error;",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": "furi_string_alloc",
          "new_api": null,
          "old_text": "furi_string_alloc()",
          "new_text": null,
          "old_line_content": "    FuriString* md5 = furi_string_alloc();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": "furi_string_get_cstr",
          "new_api": null,
          "old_text": "furi_string_get_cstr(path)",
          "new_text": null,
          "old_line_content": "    if(md5_string_calc_file(file, furi_string_get_cstr(path), md5, &file_error)) {",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": "storage_cli_print_error",
          "new_api": null,
          "old_text": "storage_cli_print_error(file_error)",
          "new_text": null,
          "old_line_content": "        storage_cli_print_error(file_error);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": "storage_file_close",
          "new_api": null,
          "old_text": "storage_file_close(file)",
          "new_text": null,
          "old_line_content": "    storage_file_close(file);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": "furi_record_close",
          "new_api": null,
          "old_text": "furi_record_close(RECORD_STORAGE)",
          "new_text": null,
          "old_line_content": "    furi_record_close(RECORD_STORAGE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 502,
          "old_api": "UNUSED",
          "new_api": null,
          "old_text": "UNUSED(context)",
          "new_text": null,
          "old_line_content": "    UNUSED(context);",
          "new_line_content": "    FuriString* path;",
          "content_same": false
        },
        {
          "line": 505,
          "old_api": "furi_string_alloc",
          "new_api": null,
          "old_text": "furi_string_alloc()",
          "new_text": null,
          "old_line_content": "    cmd = furi_string_alloc();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": "furi_string_alloc",
          "new_api": null,
          "old_text": "furi_string_alloc()",
          "new_text": null,
          "old_line_content": "    path = furi_string_alloc();",
          "new_line_content": "    do {",
          "content_same": false
        },
        {
          "line": 509,
          "old_api": "args_read_string_and_trim",
          "new_api": null,
          "old_text": "args_read_string_and_trim(args, cmd)",
          "new_text": null,
          "old_line_content": "        if(!args_read_string_and_trim(args, cmd)) {",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": "storage_cli_print_usage",
          "new_api": null,
          "old_text": "storage_cli_print_usage()",
          "new_text": null,
          "old_line_content": "            storage_cli_print_usage();",
          "new_line_content": "        }",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 25,
      "total_additions": 96,
      "total_deletions": 96,
      "total_api_changes": 217
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 4,
        "api_related_lines": 217,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 294,
    "api_calls_after": 294,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 4,
      "total_diff_lines": 19
    }
  }
}