{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tesseract/modified_file/0a3a351cb3f321f61148cb3fd0dc94590b85f6f7",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tesseract/modified_file/0a3a351cb3f321f61148cb3fd0dc94590b85f6f7/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tesseract/modified_file/0a3a351cb3f321f61148cb3fd0dc94590b85f6f7/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/tesseract/modified_file/0a3a351cb3f321f61148cb3fd0dc94590b85f6f7/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 123,
          "old_api": "__cpuid",
          "new_api": "_xgetbv",
          "old_text": "__cpuid(cpuInfo, 1)",
          "new_text": "_xgetbv(0)",
          "old_line_content": "    __cpuid(cpuInfo, 1);",
          "new_line_content": "    bool xmm_ymm_state_enabled = (_xgetbv(0) & 6) == 6;",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 136,
          "old_api": null,
          "new_api": "__cpuid",
          "old_text": null,
          "new_text": "__cpuid(cpuInfo, 7)",
          "old_line_content": "      avx2_available_ = (cpuInfo[1] & 0x00000020) != 0;",
          "new_line_content": "      __cpuid(cpuInfo, 7);",
          "content_same": false
        },
        {
          "line": 154,
          "old_api": null,
          "new_api": "SetDotProduct",
          "old_text": null,
          "new_text": "SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixAVX2)",
          "old_line_content": "#endif",
          "new_line_content": "    SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixAVX2);",
          "content_same": false
        },
        {
          "line": 159,
          "old_api": null,
          "new_api": "SetDotProduct",
          "old_text": null,
          "new_text": "SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixSSE)",
          "old_line_content": "#endif",
          "new_line_content": "    SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixSSE);",
          "content_same": false
        },
        {
          "line": 164,
          "old_api": null,
          "new_api": "SetDotProduct",
          "old_text": null,
          "new_text": "SetDotProduct(DotProductSSE, &IntSimdMatrix::intSimdMatrixSSE)",
          "old_line_content": "#endif",
          "new_line_content": "    SetDotProduct(DotProductSSE, &IntSimdMatrix::intSimdMatrixSSE);",
          "content_same": false
        },
        {
          "line": 173,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "dotproduct.string()",
          "old_line_content": "    // Automatic detection. Nothing to be done.",
          "new_line_content": "  if (!strcmp(dotproduct.string(), \"auto\")) {",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "dotproduct.string()",
          "old_line_content": "    // Generic code selected by config variable.",
          "new_line_content": "  } else if (!strcmp(dotproduct.string(), \"generic\")) {",
          "content_same": false
        },
        {
          "line": 177,
          "old_api": null,
          "new_api": "SetDotProduct",
          "old_text": null,
          "new_text": "SetDotProduct(DotProductGeneric)",
          "old_line_content": "    dotproduct_method = \"generic\";",
          "new_line_content": "    SetDotProduct(DotProductGeneric);",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "dotproduct.string()",
          "old_line_content": "    // Native optimized code selected by config variable.",
          "new_line_content": "  } else if (!strcmp(dotproduct.string(), \"native\")) {",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": null,
          "new_api": "SetDotProduct",
          "old_text": null,
          "new_text": "SetDotProduct(DotProductNative)",
          "old_line_content": "    dotproduct_method = \"native\";",
          "new_line_content": "    SetDotProduct(DotProductNative);",
          "content_same": false
        },
        {
          "line": 184,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "dotproduct.string()",
          "old_line_content": "    // AVX2 selected by config variable.",
          "new_line_content": "  } else if (!strcmp(dotproduct.string(), \"avx2\")) {",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": null,
          "new_api": "SetDotProduct",
          "old_text": null,
          "new_text": "SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixAVX2)",
          "old_line_content": "    dotproduct_method = \"avx2\";",
          "new_line_content": "    SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixAVX2);",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "dotproduct.string()",
          "old_line_content": "    // AVX selected by config variable.",
          "new_line_content": "  } else if (!strcmp(dotproduct.string(), \"avx\")) {",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": null,
          "new_api": "SetDotProduct",
          "old_text": null,
          "new_text": "SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixSSE)",
          "old_line_content": "    dotproduct_method = \"avx\";",
          "new_line_content": "    SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixSSE);",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "dotproduct.string()",
          "old_line_content": "    // FMA selected by config variable.",
          "new_line_content": "  } else if (!strcmp(dotproduct.string(), \"fma\")) {",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": null,
          "new_api": "SetDotProduct",
          "old_text": null,
          "new_text": "SetDotProduct(DotProductFMA, IntSimdMatrix::intSimdMatrix)",
          "old_line_content": "    dotproduct_method = \"fma\";",
          "new_line_content": "    SetDotProduct(DotProductFMA, IntSimdMatrix::intSimdMatrix);",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "dotproduct.string()",
          "old_line_content": "    // SSE selected by config variable.",
          "new_line_content": "  } else if (!strcmp(dotproduct.string(), \"sse\")) {",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": null,
          "new_api": "SetDotProduct",
          "old_text": null,
          "new_text": "SetDotProduct(DotProductSSE, &IntSimdMatrix::intSimdMatrixSSE)",
          "old_line_content": "    dotproduct_method = \"sse\";",
          "new_line_content": "    SetDotProduct(DotProductSSE, &IntSimdMatrix::intSimdMatrixSSE);",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "dotproduct.string()",
          "old_line_content": "    // std::inner_product selected by config variable.",
          "new_line_content": "  } else if (!strcmp(dotproduct.string(), \"std::inner_product\")) {",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": null,
          "new_api": "SetDotProduct",
          "old_text": null,
          "new_text": "SetDotProduct(DotProductStdInnerProduct)",
          "old_line_content": "    dotproduct_method = \"std::inner_product\";",
          "new_line_content": "    SetDotProduct(DotProductStdInnerProduct);",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "dotproduct.string()",
          "old_line_content": "    tprintf(\"Support values for dotproduct: auto generic native\"",
          "new_line_content": "            dotproduct.string());",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": null,
          "new_api": "set_value",
          "old_text": null,
          "new_text": "dotproduct.set_value(dotproduct_method)",
          "old_line_content": "}",
          "new_line_content": "  dotproduct.set_value(dotproduct_method);",
          "content_same": false
        },
        {
          "line": 124,
          "old_api": null,
          "new_api": "__cpuid",
          "old_text": null,
          "new_text": "__cpuid(cpuInfo, 1)",
          "old_line_content": "#if defined(SSE4_1)",
          "new_line_content": "    __cpuid(cpuInfo, 1);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 135,
          "old_api": "__cpuid",
          "new_api": null,
          "old_text": "__cpuid(cpuInfo, 7)",
          "new_text": null,
          "old_line_content": "      __cpuid(cpuInfo, 7);",
          "new_line_content": "    if (max_function_id >= 7 && xmm_ymm_state_enabled) {",
          "content_same": false
        },
        {
          "line": 153,
          "old_api": "SetDotProduct",
          "new_api": null,
          "old_text": "SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixAVX2)",
          "new_text": null,
          "old_line_content": "    SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixAVX2);",
          "new_line_content": "    // AVX2 detected.",
          "content_same": false
        },
        {
          "line": 158,
          "old_api": "SetDotProduct",
          "new_api": null,
          "old_text": "SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixSSE)",
          "new_text": null,
          "old_line_content": "    SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixSSE);",
          "new_line_content": "    // AVX detected.",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": "SetDotProduct",
          "new_api": null,
          "old_text": "SetDotProduct(DotProductSSE, &IntSimdMatrix::intSimdMatrixSSE)",
          "new_text": null,
          "old_line_content": "    SetDotProduct(DotProductSSE, &IntSimdMatrix::intSimdMatrixSSE);",
          "new_line_content": "    // SSE detected.",
          "content_same": false
        },
        {
          "line": 172,
          "old_api": "string",
          "new_api": null,
          "old_text": "dotproduct.string()",
          "new_text": null,
          "old_line_content": "  if (!strcmp(dotproduct.string(), \"auto\")) {",
          "new_line_content": "  const char* dotproduct_method = \"generic\";",
          "content_same": false
        },
        {
          "line": 174,
          "old_api": "string",
          "new_api": null,
          "old_text": "dotproduct.string()",
          "new_text": null,
          "old_line_content": "  } else if (!strcmp(dotproduct.string(), \"generic\")) {",
          "new_line_content": "    // Automatic detection. Nothing to be done.",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": "SetDotProduct",
          "new_api": null,
          "old_text": "SetDotProduct(DotProductGeneric)",
          "new_text": null,
          "old_line_content": "    SetDotProduct(DotProductGeneric);",
          "new_line_content": "    // Generic code selected by config variable.",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": "string",
          "new_api": null,
          "old_text": "dotproduct.string()",
          "new_text": null,
          "old_line_content": "  } else if (!strcmp(dotproduct.string(), \"native\")) {",
          "new_line_content": "    dotproduct_method = \"generic\";",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": "SetDotProduct",
          "new_api": null,
          "old_text": "SetDotProduct(DotProductNative)",
          "new_text": null,
          "old_line_content": "    SetDotProduct(DotProductNative);",
          "new_line_content": "    // Native optimized code selected by config variable.",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": "string",
          "new_api": null,
          "old_text": "dotproduct.string()",
          "new_text": null,
          "old_line_content": "  } else if (!strcmp(dotproduct.string(), \"avx2\")) {",
          "new_line_content": "#if defined(AVX2)",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": "SetDotProduct",
          "new_api": null,
          "old_text": "SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixAVX2)",
          "new_text": null,
          "old_line_content": "    SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixAVX2);",
          "new_line_content": "    // AVX2 selected by config variable.",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": "string",
          "new_api": null,
          "old_text": "dotproduct.string()",
          "new_text": null,
          "old_line_content": "  } else if (!strcmp(dotproduct.string(), \"avx\")) {",
          "new_line_content": "#if defined(AVX)",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "SetDotProduct",
          "new_api": null,
          "old_text": "SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixSSE)",
          "new_text": null,
          "old_line_content": "    SetDotProduct(DotProductAVX, &IntSimdMatrix::intSimdMatrixSSE);",
          "new_line_content": "    // AVX selected by config variable.",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": "string",
          "new_api": null,
          "old_text": "dotproduct.string()",
          "new_text": null,
          "old_line_content": "  } else if (!strcmp(dotproduct.string(), \"fma\")) {",
          "new_line_content": "#if defined(FMA)",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": "SetDotProduct",
          "new_api": null,
          "old_text": "SetDotProduct(DotProductFMA, IntSimdMatrix::intSimdMatrix)",
          "new_text": null,
          "old_line_content": "    SetDotProduct(DotProductFMA, IntSimdMatrix::intSimdMatrix);",
          "new_line_content": "    // FMA selected by config variable.",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "string",
          "new_api": null,
          "old_text": "dotproduct.string()",
          "new_text": null,
          "old_line_content": "  } else if (!strcmp(dotproduct.string(), \"sse\")) {",
          "new_line_content": "#if defined(SSE4_1)",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": "SetDotProduct",
          "new_api": null,
          "old_text": "SetDotProduct(DotProductSSE, &IntSimdMatrix::intSimdMatrixSSE)",
          "new_text": null,
          "old_line_content": "    SetDotProduct(DotProductSSE, &IntSimdMatrix::intSimdMatrixSSE);",
          "new_line_content": "    // SSE selected by config variable.",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "string",
          "new_api": null,
          "old_text": "dotproduct.string()",
          "new_text": null,
          "old_line_content": "  } else if (!strcmp(dotproduct.string(), \"std::inner_product\")) {",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": "SetDotProduct",
          "new_api": null,
          "old_text": "SetDotProduct(DotProductStdInnerProduct)",
          "new_text": null,
          "old_line_content": "    SetDotProduct(DotProductStdInnerProduct);",
          "new_line_content": "    // std::inner_product selected by config variable.",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "string",
          "new_api": null,
          "old_text": "tprintf(\"Warning, ignoring unsupported config variable value: dotproduct=%s\\n\",\n            dotproduct.string())",
          "new_text": null,
          "old_line_content": "    tprintf(\"Warning, ignoring unsupported config variable value: dotproduct=%s\\n\",",
          "new_line_content": "    // Unsupported value of config variable.",
          "content_same": false
        },
        {
          "line": 224,
          "old_api": "set_value",
          "new_api": null,
          "old_text": "dotproduct.set_value(dotproduct_method)",
          "new_text": null,
          "old_line_content": "  dotproduct.set_value(dotproduct_method);",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 1,
      "total_additions": 22,
      "total_deletions": 21,
      "total_api_changes": 44
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 44,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          137,
          139,
          150,
          152,
          126
        ]
      }
    },
    "api_calls_before": 36,
    "api_calls_after": 37,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 3,
      "total_diff_lines": 49
    }
  }
}