{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/taichi/modified_file/623f4e9d8164ef6ca2a3793a6aac3bc95988e341",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/taichi/modified_file/623f4e9d8164ef6ca2a3793a6aac3bc95988e341/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/taichi/modified_file/623f4e9d8164ef6ca2a3793a6aac3bc95988e341/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/taichi/modified_file/623f4e9d8164ef6ca2a3793a6aac3bc95988e341/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 424,
          "old_api": "emit",
          "new_api": "reset_tails",
          "old_text": "emit(\"cudaDeviceSynchronize();\")",
          "new_text": "emit(\"Managers::get_allocator<{}>()->reset_tails();\", leaf->node_type_name)",
          "old_line_content": "    emit(\"cudaDeviceSynchronize();\");",
          "new_line_content": "    emit(\"Managers::get_allocator<{}>()->reset_tails();\", leaf->node_type_name);",
          "content_same": false
        },
        {
          "line": 446,
          "old_api": "get_current_kernel",
          "new_api": "emit",
          "old_text": "current_program->get_current_kernel()",
          "new_text": "emit(\"while(1) {{\")",
          "old_line_content": "      if (current_program->get_current_kernel().benchmarking) {",
          "new_line_content": "        emit(\"while(1) {{\");",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": "start",
          "new_api": "emit",
          "old_text": "emit(R\"(GPUProfiler::get_instance().start(\"{}\");)\", codegen->func_name)",
          "new_text": "emit(\"{}_kernel<<<gridDim, blockDim>>>(context);\", codegen->func_name)",
          "old_line_content": "    emit(R\"(GPUProfiler::get_instance().start(\"{}\");)\", codegen->func_name);",
          "new_line_content": "    emit(\"{}_kernel<<<gridDim, blockDim>>>(context);\", codegen->func_name);",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": "emit",
          "new_api": "stop",
          "old_text": "emit(\"{}_kernel<<<gridDim, blockDim>>>(context);\", codegen->func_name)",
          "new_text": "emit(R\"(GPUProfiler::get_instance().stop();)\")",
          "old_line_content": "    emit(\"{}_kernel<<<gridDim, blockDim>>>(context);\", codegen->func_name);",
          "new_line_content": "    emit(R\"(GPUProfiler::get_instance().stop();)\");",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": "child_id",
          "new_api": "TC_ASSERT",
          "old_text": "path[0]->child_id(path[1])",
          "new_text": "TC_ASSERT(chid != -1)",
          "old_line_content": "    auto chid = path[0]->child_id(path[1]);",
          "new_line_content": "    TC_ASSERT(chid != -1);",
          "content_same": false
        },
        {
          "line": 529,
          "old_api": "TC_ASSERT",
          "new_api": "emit",
          "old_text": "TC_ASSERT(chid != -1)",
          "new_text": "emit(\"auto {}_cache = list_element->get{}();\", path[1]->node_type_name,\n         chid)",
          "old_line_content": "    TC_ASSERT(chid != -1);",
          "new_line_content": "    emit(\"auto {}_cache = list_element->get{}();\", path[1]->node_type_name,",
          "content_same": false
        },
        {
          "line": 581,
          "old_api": "back",
          "new_api": "for_stmt_->is<RangeForStmt>()",
          "old_text": "stmt_list->statements.back()",
          "new_text": "for_stmt_->is<RangeForStmt>()",
          "old_line_content": "    auto &for_stmt_ = stmt_list->statements.back();",
          "new_line_content": "    if (for_stmt_->is<RangeForStmt>()) {",
          "content_same": false
        },
        {
          "line": 582,
          "old_api": "for_stmt_->is<RangeForStmt>()",
          "new_api": "for_stmt_->as<RangeForStmt>()",
          "old_text": "for_stmt_->is<RangeForStmt>()",
          "new_text": "for_stmt_->as<RangeForStmt>()",
          "old_line_content": "    if (for_stmt_->is<RangeForStmt>()) {",
          "new_line_content": "      auto range_for = for_stmt_->as<RangeForStmt>();",
          "content_same": false
        },
        {
          "line": 628,
          "old_api": "TC_WARN",
          "new_api": "get",
          "old_text": "TC_WARN(\"Using activity tracking\")",
          "new_text": "for_stmt_.get()",
          "old_line_content": "        TC_WARN(\"Using activity tracking\");",
          "new_line_content": "        struct_for_new(for_stmt_.get());",
          "content_same": false
        },
        {
          "line": 658,
          "old_api": "size",
          "new_api": "get",
          "old_text": "stmt_list->statements.size()",
          "new_text": "stmt_list->statements[i].get()",
          "old_line_content": "      for (int i = 0; i + 1 < stmt_list->statements.size(); i++) {",
          "new_line_content": "        auto s = stmt_list->statements[i].get();",
          "content_same": false
        },
        {
          "line": 659,
          "old_api": "get",
          "new_api": "s->is<ConstStmt>()",
          "old_text": "stmt_list->statements[i].get()",
          "new_text": "s->is<ConstStmt>()",
          "old_line_content": "        auto s = stmt_list->statements[i].get();",
          "new_line_content": "        if (!(s->is<AllocaStmt>() || s->is<ConstStmt>())) {",
          "content_same": false
        },
        {
          "line": 696,
          "old_api": "TC_ASSERT",
          "new_api": "raw_name",
          "old_text": "TC_ASSERT(stmt->ret_type.data_type == DataType::f32)",
          "new_text": "stmt->raw_name()",
          "old_line_content": "    TC_ASSERT(stmt->ret_type.data_type == DataType::f32);",
          "new_line_content": "    emit(\"const auto {} = randf();\", stmt->raw_name(),",
          "content_same": false
        },
        {
          "line": 697,
          "old_api": "raw_name",
          "new_api": "ret_data_type_name",
          "old_text": "stmt->raw_name()",
          "new_text": "stmt->ret_data_type_name()",
          "old_line_content": "    emit(\"const auto {} = randf();\", stmt->raw_name(),",
          "new_line_content": "         stmt->ret_data_type_name());",
          "content_same": false
        },
        {
          "line": 707,
          "old_api": "ret_data_type_name",
          "new_api": "data_type_name",
          "old_text": "stmt->ret_data_type_name()",
          "new_text": "data_type_name(stmt->cast_type)",
          "old_line_content": "        emit(\"const {} {}(static_cast<{}>({}));\", stmt->ret_data_type_name(),",
          "new_line_content": "             stmt->raw_name(), data_type_name(stmt->cast_type),",
          "content_same": false
        },
        {
          "line": 708,
          "old_api": "data_type_name",
          "new_api": "raw_name",
          "old_text": "data_type_name(stmt->cast_type)",
          "new_text": "stmt->rhs->raw_name()",
          "old_line_content": "             stmt->raw_name(), data_type_name(stmt->cast_type),",
          "new_line_content": "             stmt->rhs->raw_name());",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": "ret_data_type_name",
          "new_api": "data_type_name",
          "old_text": "stmt->ret_data_type_name()",
          "new_text": "data_type_name(stmt->cast_type)",
          "old_line_content": "        emit(\"const {} {}(union_cast<{}>({}));\", stmt->ret_data_type_name(),",
          "new_line_content": "             stmt->raw_name(), data_type_name(stmt->cast_type),",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": "data_type_name",
          "new_api": "raw_name",
          "old_text": "data_type_name(stmt->cast_type)",
          "new_text": "stmt->rhs->raw_name()",
          "old_line_content": "             stmt->raw_name(), data_type_name(stmt->cast_type),",
          "new_line_content": "             stmt->rhs->raw_name());",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": "ret_data_type_name",
          "new_api": "binary_type_name",
          "old_text": "bin->ret_data_type_name()",
          "new_text": "binary_type_name(bin->op_type)",
          "old_line_content": "    emit(\"const {} {}({}{}({}, {}));\", bin->ret_data_type_name(),",
          "new_line_content": "         bin->raw_name(), ns, binary_type_name(bin->op_type),",
          "content_same": false
        },
        {
          "line": 723,
          "old_api": "binary_type_name",
          "new_api": "raw_name",
          "old_text": "binary_type_name(bin->op_type)",
          "new_text": "bin->rhs->raw_name()",
          "old_line_content": "         bin->raw_name(), ns, binary_type_name(bin->op_type),",
          "new_line_content": "         bin->lhs->raw_name(), bin->rhs->raw_name());",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "TC_ASSERT",
          "new_api": "ret_data_type_name",
          "old_text": "TC_ASSERT(tri->op_type == TrinaryType::select)",
          "new_text": "tri->ret_data_type_name()",
          "old_line_content": "    TC_ASSERT(tri->op_type == TrinaryType::select);",
          "new_line_content": "    emit(\"const {} {} = {} ? {} : {};\", tri->ret_data_type_name(),",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": "ret_data_type_name",
          "new_api": "raw_name",
          "old_text": "tri->ret_data_type_name()",
          "new_text": "tri->op2->raw_name()",
          "old_line_content": "    emit(\"const {} {} = {} ? {} : {};\", tri->ret_data_type_name(),",
          "new_line_content": "         tri->raw_name(), tri->op1->raw_name(), tri->op2->raw_name(),",
          "content_same": false
        },
        {
          "line": 739,
          "old_api": "emit",
          "new_api": "accept",
          "old_text": "emit(\"}} else {{\")",
          "new_text": "if_stmt->false_statements->accept(this)",
          "old_line_content": "      emit(\"}} else {{\");",
          "new_line_content": "      if_stmt->false_statements->accept(this);",
          "content_same": false
        },
        {
          "line": 758,
          "old_api": "raw_name",
          "new_api": "serialize",
          "old_text": "const_stmt->raw_name()",
          "new_text": "const_stmt->val.serialize(\n             [&](const TypedConstant &t) { return t.stringify(); }, \"{\")",
          "old_line_content": "    emit(\"const {} {}({});\", const_stmt->ret_type.str(), const_stmt->raw_name(),",
          "new_line_content": "         const_stmt->val.serialize(",
          "content_same": false
        },
        {
          "line": 759,
          "old_api": "serialize",
          "new_api": "stringify",
          "old_text": "const_stmt->val.serialize(\n             [&](const TypedConstant &t) { return t.stringify(); }, \"{\")",
          "new_text": "t.stringify()",
          "old_line_content": "         const_stmt->val.serialize(",
          "new_line_content": "             [&](const TypedConstant &t) { return t.stringify(); }, \"{\"));",
          "content_same": false
        },
        {
          "line": 768,
          "old_api": "emit",
          "new_api": "accept",
          "old_text": "emit(\"while (1) {{\")",
          "new_text": "stmt->body->accept(this)",
          "old_line_content": "    emit(\"while (1) {{\");",
          "new_line_content": "    stmt->body->accept(this);",
          "content_same": false
        },
        {
          "line": 769,
          "old_api": "accept",
          "new_api": "emit",
          "old_text": "stmt->body->accept(this)",
          "new_text": "emit(\"}}\")",
          "old_line_content": "    stmt->body->accept(this);",
          "new_line_content": "    emit(\"}}\");",
          "content_same": false
        },
        {
          "line": 793,
          "old_api": "ret_data_type_name",
          "new_api": "raw_name",
          "old_text": "emit(\"for ({} {} = {}; {} < {}; {} = {} + {}({})) {{\",\n           loop_var->ret_data_type_name(), loop_var->raw_name(),\n           for_stmt->begin->raw_name(), loop_var->raw_name(),\n           for_stmt->end->raw_name(), loop_var->raw_name(),\n           loop_var->raw_name(), loop_var->ret_data_type_name(), 1)",
          "new_text": "loop_var->raw_name()",
          "old_line_content": "      emit(\"for ({} {} = {}; {} < {}; {} = {} + {}({})) {{\",",
          "new_line_content": "           loop_var->ret_data_type_name(), loop_var->raw_name(),",
          "content_same": false
        },
        {
          "line": 796,
          "old_api": "raw_name",
          "new_api": "ret_data_type_name",
          "old_text": "loop_var->raw_name()",
          "new_text": "loop_var->ret_data_type_name()",
          "old_line_content": "           for_stmt->end->raw_name(), loop_var->raw_name(),",
          "new_line_content": "           loop_var->raw_name(), loop_var->ret_data_type_name(), 1);",
          "content_same": false
        },
        {
          "line": 799,
          "old_api": "accept",
          "new_api": "emit",
          "old_text": "for_stmt->body->accept(this)",
          "new_text": "emit(\"}}\")",
          "old_line_content": "    for_stmt->body->accept(this);",
          "new_line_content": "    emit(\"}}\");",
          "content_same": false
        },
        {
          "line": 812,
          "old_api": "same_source",
          "new_api": "width",
          "old_text": "stmt->same_source()",
          "new_text": "stmt->ptr[0].var->width()",
          "old_line_content": "    if (stmt->same_source() && linear_index &&",
          "new_line_content": "        stmt->width() == stmt->ptr[0].var->width()) {",
          "content_same": false
        },
        {
          "line": 819,
          "old_api": "width",
          "new_api": "raw_name",
          "old_text": "stmt->width()",
          "new_text": "stmt->ptr[i].var->raw_name()",
          "old_line_content": "      for (int i = 0; i < stmt->width(); i++) {",
          "new_line_content": "        init_v += fmt::format(\"{}[{}]\", stmt->ptr[i].var->raw_name(),",
          "content_same": false
        },
        {
          "line": 841,
          "old_api": "width",
          "new_api": "data_type_name",
          "old_text": "stmt->width()",
          "new_text": "data_type_name(stmt->ret_type.data_type)",
          "old_line_content": "    TC_ASSERT(stmt->width() == 1);",
          "new_line_content": "    emit(\"{} *{}[{}];\", data_type_name(stmt->ret_type.data_type),",
          "content_same": false
        },
        {
          "line": 842,
          "old_api": "data_type_name",
          "new_api": "raw_name",
          "old_text": "data_type_name(stmt->ret_type.data_type)",
          "new_text": "stmt->raw_name()",
          "old_line_content": "    emit(\"{} *{}[{}];\", data_type_name(stmt->ret_type.data_type),",
          "new_line_content": "         stmt->raw_name(), stmt->ret_type.width);",
          "content_same": false
        },
        {
          "line": 882,
          "old_api": "width",
          "new_api": "append",
          "old_text": "stmt->val->width()",
          "new_text": "emit(\"{}_tmp->append({}({}));\", snode->node_type_name,\n           snode->ch[0]->node_type_name, stmt->val->raw_name())",
          "old_line_content": "      TC_ASSERT(stmt->val->width() == 1);",
          "new_line_content": "      emit(\"{}_tmp->append({}({}));\", snode->node_type_name,",
          "content_same": false
        },
        {
          "line": 883,
          "old_api": "append",
          "new_api": "raw_name",
          "old_text": "emit(\"{}_tmp->append({}({}));\", snode->node_type_name,\n           snode->ch[0]->node_type_name, stmt->val->raw_name())",
          "new_text": "stmt->val->raw_name()",
          "old_line_content": "      emit(\"{}_tmp->append({}({}));\", snode->node_type_name,",
          "new_line_content": "           snode->ch[0]->node_type_name, stmt->val->raw_name());",
          "content_same": false
        },
        {
          "line": 890,
          "old_api": "emit",
          "new_api": "make_list",
          "old_text": "emit(\"activate_{}(root, {});\", snode->node_type_name,\n           make_list(indices, \"\"))",
          "new_text": "make_list(indices, \"\")",
          "old_line_content": "      emit(\"activate_{}(root, {});\", snode->node_type_name,",
          "new_line_content": "           make_list(indices, \"\"));",
          "content_same": false
        },
        {
          "line": 901,
          "old_api": "has",
          "new_api": "get",
          "old_text": "current_scratch_pads->has(snode)",
          "new_text": "current_scratch_pads->get(snode)",
          "old_line_content": "    if (current_scratch_pads && current_scratch_pads->has(snode)) {",
          "new_line_content": "      auto &pad = current_scratch_pads->get(snode);",
          "content_same": false
        },
        {
          "line": 902,
          "old_api": "get",
          "new_api": "name",
          "old_text": "current_scratch_pads->get(snode)",
          "new_text": "pad.name()",
          "old_line_content": "      auto &pad = current_scratch_pads->get(snode);",
          "new_line_content": "      emit(\"{}[{}] = {};\", pad.name(),",
          "content_same": false
        },
        {
          "line": 903,
          "old_api": "name",
          "new_api": "global_to_linearized_local",
          "old_text": "pad.name()",
          "new_text": "pad.global_to_linearized_local(current_struct_for->loop_vars,\n                                          ptr->indices)",
          "old_line_content": "      emit(\"{}[{}] = {};\", pad.name(),",
          "new_line_content": "           pad.global_to_linearized_local(current_struct_for->loop_vars,",
          "content_same": false
        },
        {
          "line": 908,
          "old_api": "raw_name",
          "new_api": "data_type_name",
          "old_text": "emit(\"*({} *){}[{}] = {};\",\n           data_type_name(stmt->data->ret_type.data_type),\n           stmt->ptr->raw_name(), 0, stmt->data->raw_name())",
          "new_text": "data_type_name(stmt->data->ret_type.data_type)",
          "old_line_content": "      emit(\"*({} *){}[{}] = {};\",",
          "new_line_content": "           data_type_name(stmt->data->ret_type.data_type),",
          "content_same": false
        },
        {
          "line": 909,
          "old_api": "data_type_name",
          "new_api": "raw_name",
          "old_text": "data_type_name(stmt->data->ret_type.data_type)",
          "new_text": "stmt->data->raw_name()",
          "old_line_content": "           data_type_name(stmt->data->ret_type.data_type),",
          "new_line_content": "           stmt->ptr->raw_name(), 0, stmt->data->raw_name());",
          "content_same": false
        },
        {
          "line": 915,
          "old_api": "width",
          "new_api": "stmt->ptr->as<GlobalPtrStmt>()",
          "old_text": "stmt->width()",
          "new_text": "stmt->ptr->as<GlobalPtrStmt>()",
          "old_line_content": "    TC_ASSERT(stmt->width() == 1);",
          "new_line_content": "    auto ptr = stmt->ptr->as<GlobalPtrStmt>();",
          "content_same": false
        },
        {
          "line": 918,
          "old_api": "has",
          "new_api": "get",
          "old_text": "current_scratch_pads->has(snode)",
          "new_text": "current_scratch_pads->get(snode)",
          "old_line_content": "    if (current_scratch_pads && current_scratch_pads->has(snode)) {",
          "new_line_content": "      auto &pad = current_scratch_pads->get(snode);",
          "content_same": false
        },
        {
          "line": 919,
          "old_api": "get",
          "new_api": "name",
          "old_text": "current_scratch_pads->get(snode)",
          "new_text": "pad.name()",
          "old_line_content": "      auto &pad = current_scratch_pads->get(snode);",
          "new_line_content": "      emit(\"const auto {} = {}[{}];\", stmt->raw_name(), pad.name(),",
          "content_same": false
        },
        {
          "line": 920,
          "old_api": "name",
          "new_api": "global_to_linearized_local",
          "old_text": "pad.name()",
          "new_text": "pad.global_to_linearized_local(current_struct_for->loop_vars,\n                                          ptr->indices)",
          "old_line_content": "      emit(\"const auto {} = {}[{}];\", stmt->raw_name(), pad.name(),",
          "new_line_content": "           pad.global_to_linearized_local(current_struct_for->loop_vars,",
          "content_same": false
        },
        {
          "line": 932,
          "old_api": "TC_ASSERT",
          "new_api": "stmt->dest->as<GlobalPtrStmt>()",
          "old_text": "TC_ASSERT(stmt->op_type == AtomicType::add)",
          "new_text": "stmt->dest->as<GlobalPtrStmt>()",
          "old_line_content": "    TC_ASSERT(stmt->op_type == AtomicType::add);",
          "new_line_content": "    auto ptr = stmt->dest->as<GlobalPtrStmt>();",
          "content_same": false
        },
        {
          "line": 935,
          "old_api": "has",
          "new_api": "get",
          "old_text": "current_scratch_pads->has(snode)",
          "new_text": "current_scratch_pads->get(snode)",
          "old_line_content": "    if (current_scratch_pads && current_scratch_pads->has(snode)) {",
          "new_line_content": "      auto &pad = current_scratch_pads->get(snode);",
          "content_same": false
        },
        {
          "line": 936,
          "old_api": "get",
          "new_api": "name",
          "old_text": "current_scratch_pads->get(snode)",
          "new_text": "pad.name()",
          "old_line_content": "      auto &pad = current_scratch_pads->get(snode);",
          "new_line_content": "      emit(\"atomicAdd(&{}[{}], {});\", pad.name(),",
          "content_same": false
        },
        {
          "line": 937,
          "old_api": "name",
          "new_api": "global_to_linearized_local",
          "old_text": "pad.name()",
          "new_text": "pad.global_to_linearized_local(current_struct_for->loop_vars,\n                                          ptr->indices)",
          "old_line_content": "      emit(\"atomicAdd(&{}[{}], {});\", pad.name(),",
          "new_line_content": "           pad.global_to_linearized_local(current_struct_for->loop_vars,",
          "content_same": false
        },
        {
          "line": 948,
          "old_api": "raw_name",
          "new_api": "serialize",
          "old_text": "stmt->raw_name()",
          "new_text": "stmt->elements.serialize(\n             [](const VectorElement &elem) {\n               return fmt::format(\"{}[{}]\", elem.stmt->raw_name(), elem.index);\n             },\n             \"{\")",
          "old_line_content": "    emit(\"const {} {}({});\", stmt->ret_data_type_name(), stmt->raw_name(),",
          "new_line_content": "         stmt->elements.serialize(",
          "content_same": false
        },
        {
          "line": 967,
          "old_api": "emit",
          "new_api": "raw_name",
          "old_text": "emit(\"#if defined(TL_DEBUG)\")",
          "new_text": "stmt->val->raw_name()",
          "old_line_content": "    emit(\"#if defined(TL_DEBUG)\");",
          "new_line_content": "    emit(R\"(TC_ASSERT_INFO({}, \"{}\");)\", stmt->val->raw_name(), stmt->text);",
          "content_same": false
        },
        {
          "line": 968,
          "old_api": "raw_name",
          "new_api": "emit",
          "old_text": "stmt->val->raw_name()",
          "new_text": "emit(\"#endif\")",
          "old_line_content": "    emit(R\"(TC_ASSERT_INFO({}, \"{}\");)\", stmt->val->raw_name(), stmt->text);",
          "new_line_content": "    emit(\"#endif\");",
          "content_same": false
        },
        {
          "line": 978,
          "old_api": "irpass::lower(ir)",
          "new_api": "irpass::re_id(ir)",
          "old_text": "irpass::lower(ir)",
          "new_text": "irpass::re_id(ir)",
          "old_line_content": "  irpass::lower(ir);",
          "new_line_content": "  irpass::re_id(ir);",
          "content_same": false
        },
        {
          "line": 983,
          "old_api": "irpass::typecheck(ir)",
          "new_api": "irpass::re_id(ir)",
          "old_text": "irpass::typecheck(ir)",
          "new_text": "irpass::re_id(ir)",
          "old_line_content": "  irpass::typecheck(ir);",
          "new_line_content": "  irpass::re_id(ir);",
          "content_same": false
        },
        {
          "line": 988,
          "old_api": "irpass::eliminate_dup(ir)",
          "new_api": "irpass::re_id(ir)",
          "old_text": "irpass::eliminate_dup(ir)",
          "new_text": "irpass::re_id(ir)",
          "old_line_content": "  irpass::eliminate_dup(ir);",
          "new_line_content": "  irpass::re_id(ir);",
          "content_same": false
        },
        {
          "line": 995,
          "old_api": "emit",
          "new_api": "generate_header",
          "old_text": "emit(\"#define TC_GPU\")",
          "new_text": "generate_header()",
          "old_line_content": "  emit(\"#define TC_GPU\");",
          "new_line_content": "  generate_header();",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 512,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"int leaf_loop = blockIdx.x;\")",
          "old_line_content": "",
          "new_line_content": "    emit(\"int leaf_loop = blockIdx.x;\");",
          "content_same": false
        },
        {
          "line": 515,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "path.end()",
          "old_line_content": "",
          "new_line_content": "    std::reverse(path.begin(), path.end());",
          "content_same": false
        },
        {
          "line": 517,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\n        \"auto leaves = (SNodeMeta \"\n        \"*)(Managers::get_allocator<{}>()->resident_pool);\",\n        path[0]->node_type_name)",
          "old_line_content": "",
          "new_line_content": "    emit(",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\n        \"auto num_leaves = Managers::get_allocator<{}>()->resident_tail_const;\",\n        path[0]->node_type_name)",
          "old_line_content": "        path[0]->node_type_name);",
          "new_line_content": "    emit(",
          "content_same": false
        },
        {
          "line": 525,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"auto list_element = ({}::child_type *)leaves[leaf_loop].ptr;\",\n         path[0]->node_type_name)",
          "old_line_content": "",
          "new_line_content": "    emit(\"auto list_element = ({}::child_type *)leaves[leaf_loop].ptr;\",",
          "content_same": false
        },
        {
          "line": 527,
          "old_api": null,
          "new_api": "child_id",
          "old_text": null,
          "new_text": "path[0]->child_id(path[1])",
          "old_line_content": "         path[0]->node_type_name);",
          "new_line_content": "    auto chid = path[0]->child_id(path[1]);",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": null,
          "new_api": "index_name_global",
          "old_text": null,
          "new_text": "emit(\"auto {} = leaves[leaf_loop].indices[{}];\",\n           loopgen.index_name_global(path[1], i), i)",
          "old_line_content": "    for (int i = 0; i < max_num_indices; i++) {",
          "new_line_content": "      emit(\"auto {} = leaves[leaf_loop].indices[{}];\",",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"int start_idx = subblock_id * {};\", block_size)",
          "old_line_content": "    // check if necessary",
          "new_line_content": "    emit(\"int start_idx = subblock_id * {};\", block_size);",
          "content_same": false
        },
        {
          "line": 556,
          "old_api": null,
          "new_api": "get_n",
          "old_text": null,
          "new_text": "emit(\"if (start_idx >= {}_cache->get_n()) return;\",\n           snode->node_type_name)",
          "old_line_content": "    if (snode->type == SNodeType::dynamic) {",
          "new_line_content": "      emit(\"if (start_idx >= {}_cache->get_n()) return;\",",
          "content_same": false
        },
        {
          "line": 558,
          "old_api": null,
          "new_api": "get_n",
          "old_text": null,
          "new_text": "emit(\"end_idx = min(end_idx, {}_cache->get_n());\", snode->node_type_name)",
          "old_line_content": "           snode->node_type_name);",
          "new_line_content": "      emit(\"end_idx = min(end_idx, {}_cache->get_n());\", snode->node_type_name);",
          "content_same": false
        },
        {
          "line": 561,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\n        \"int meta_id = atomicAdd((unsigned long long *)(&{}->resident_tail), \"\n        \"1ULL);\",\n        leaf_allocator)",
          "old_line_content": "",
          "new_line_content": "    emit(",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"auto &meta = {}->resident_pool[meta_id];\", leaf_allocator)",
          "old_line_content": "        leaf_allocator);",
          "new_line_content": "    emit(\"auto &meta = {}->resident_pool[meta_id];\", leaf_allocator);",
          "content_same": false
        },
        {
          "line": 568,
          "old_api": null,
          "new_api": "index_name_global",
          "old_text": null,
          "new_text": "loopgen.index_name_global(snode, i)",
          "old_line_content": "    for (int i = 0; i < max_num_indices; i++)",
          "new_line_content": "      emit(\"meta.indices[{}] = {};\", i, loopgen.index_name_global(snode, i));",
          "content_same": false
        },
        {
          "line": 570,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"meta.ptr = {}_cache;\", snode->node_type_name)",
          "old_line_content": "",
          "new_line_content": "    emit(\"meta.ptr = {}_cache;\", snode->node_type_name);",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"}}\")",
          "old_line_content": "",
          "new_line_content": "    emit(\"}}\");",
          "content_same": false
        },
        {
          "line": 580,
          "old_api": null,
          "new_api": "back",
          "old_text": null,
          "new_text": "stmt_list->statements.back()",
          "old_line_content": "  void generate_pure_loop(Block *stmt_list) {",
          "new_line_content": "    auto &for_stmt_ = stmt_list->statements.back();",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"__global__ void {}_kernel(Context context) {{\", codegen->func_name)",
          "old_line_content": "      // GPU Kernel",
          "new_line_content": "      emit(\"__global__ void {}_kernel(Context context) {{\", codegen->func_name);",
          "content_same": false
        },
        {
          "line": 588,
          "old_api": null,
          "new_api": "val_int32",
          "old_text": null,
          "new_text": "range_for->begin->as<ConstStmt>()->val[0].val_int32()",
          "old_line_content": "           codegen->prog->snode_root->node_type_name);",
          "new_line_content": "      int begin = range_for->begin->as<ConstStmt>()->val[0].val_int32();",
          "content_same": false
        },
        {
          "line": 591,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "emit(\"auto {} = blockIdx.x * blockDim.x + threadIdx.x + {};\\n\",\n           range_for->loop_var->raw_name(), begin)",
          "old_line_content": "",
          "new_line_content": "      emit(\"auto {} = blockIdx.x * blockDim.x + threadIdx.x + {};\\n\",",
          "content_same": false
        },
        {
          "line": 595,
          "old_api": null,
          "new_api": "accept",
          "old_text": null,
          "new_text": "range_for->body->accept(this)",
          "old_line_content": "",
          "new_line_content": "      range_for->body->accept(this);",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"}}\\n\\n\")",
          "old_line_content": "      // CPU Kernel code",
          "new_line_content": "      emit(\"}}\\n\\n\");",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": null,
          "new_api": "TC_ASSERT",
          "old_text": null,
          "new_text": "TC_ASSERT(begin == 0)",
          "old_line_content": "",
          "new_line_content": "      TC_ASSERT(begin == 0);",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": null,
          "new_api": "TC_WARN",
          "old_text": null,
          "new_text": "TC_WARN(\"Using default block size = 256\")",
          "old_line_content": "      if (block_size == 0) {",
          "new_line_content": "        TC_WARN(\"Using default block size = 256\");",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"gpu_runtime_init();\")",
          "old_line_content": "      }",
          "new_line_content": "      emit(\"gpu_runtime_init();\");",
          "content_same": false
        },
        {
          "line": 610,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"{}_kernel<<<{}, {}>>>(context);\", codegen->func_name, num_blocks,\n           block_size)",
          "old_line_content": "      int num_blocks = (end - begin + block_size - 1) / block_size;",
          "new_line_content": "      emit(\"{}_kernel<<<{}, {}>>>(context);\", codegen->func_name, num_blocks,",
          "content_same": false
        },
        {
          "line": 613,
          "old_api": null,
          "new_api": "for_stmt_->as<StructForStmt>()",
          "old_text": null,
          "new_text": "for_stmt_->as<StructForStmt>()",
          "old_line_content": "    } else {",
          "new_line_content": "      auto struct_for = for_stmt_->as<StructForStmt>();",
          "content_same": false
        },
        {
          "line": 627,
          "old_api": null,
          "new_api": "TC_WARN",
          "old_text": null,
          "new_text": "TC_WARN(\"Using activity tracking\")",
          "old_line_content": "      if (use_activity_tracking) {",
          "new_line_content": "        TC_WARN(\"Using activity tracking\");",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "for_stmt_.get()",
          "old_line_content": "      } else {",
          "new_line_content": "        struct_for_old(for_stmt_.get());",
          "content_same": false
        },
        {
          "line": 635,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"cudaDeviceSynchronize();\\n\")",
          "old_line_content": "    if (debug) {",
          "new_line_content": "      emit(\"cudaDeviceSynchronize();\\n\");",
          "content_same": false
        },
        {
          "line": 638,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"auto err = cudaGetLastError();\")",
          "old_line_content": "          R\"(if (allocator()->gpu_error_code) {{printf(\"GPU Assertion Error\\n\"); exit(-1);}})\");",
          "new_line_content": "      emit(\"auto err = cudaGetLastError();\");",
          "content_same": false
        },
        {
          "line": 643,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"exit(-1);}}\")",
          "old_line_content": "          \"__FILE__, __LINE__, cudaGetErrorString(err));\");",
          "new_line_content": "      emit(\"exit(-1);}}\");",
          "content_same": false
        },
        {
          "line": 645,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"}}\\n\")",
          "old_line_content": "    }",
          "new_line_content": "    emit(\"}}\\n\");",
          "content_same": false
        },
        {
          "line": 657,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "stmt_list->statements.size()",
          "old_line_content": "",
          "new_line_content": "      for (int i = 0; i + 1 < stmt_list->statements.size(); i++) {",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": null,
          "new_api": "generate_pure_loop",
          "old_text": null,
          "new_text": "generate_pure_loop(stmt_list)",
          "old_line_content": "      if (pure_loop) {",
          "new_line_content": "        generate_pure_loop(stmt_list);",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"__global__ void {}_kernel(Context context) {{\",\n             codegen->func_name)",
          "old_line_content": "        // GPU Kernel",
          "new_line_content": "        emit(\"__global__ void {}_kernel(Context context) {{\",",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"auto root = ({} *)context.buffers[0];\",\n             codegen->prog->snode_root->node_type_name)",
          "old_line_content": "             codegen->func_name);",
          "new_line_content": "        emit(\"auto root = ({} *)context.buffers[0];\",",
          "content_same": false
        },
        {
          "line": 673,
          "old_api": null,
          "new_api": "accept",
          "old_text": null,
          "new_text": "stmt_list->accept(this)",
          "old_line_content": "",
          "new_line_content": "        stmt_list->accept(this);",
          "content_same": false
        },
        {
          "line": 675,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"}}\\n\\n\")",
          "old_line_content": "",
          "new_line_content": "        emit(\"}}\\n\\n\");",
          "content_same": false
        },
        {
          "line": 678,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"extern \\\"C\\\" void {} (Context context) {{\\n\", codegen->func_name)",
          "old_line_content": "        // CPU Kernel code",
          "new_line_content": "        emit(\"extern \\\"C\\\" void {} (Context context) {{\\n\", codegen->func_name);",
          "content_same": false
        },
        {
          "line": 685,
          "old_api": null,
          "new_api": "accept",
          "old_text": null,
          "new_text": "stmt->accept(this)",
          "old_line_content": "      for (auto &stmt : stmt_list->statements) {",
          "new_line_content": "        stmt->accept(this);",
          "content_same": false
        },
        {
          "line": 691,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "alloca->raw_name()",
          "old_line_content": "  void visit(AllocaStmt *alloca) {",
          "new_line_content": "    emit(\"{} {}(0);\", alloca->ret_data_type_name(), alloca->raw_name());",
          "content_same": false
        },
        {
          "line": 695,
          "old_api": null,
          "new_api": "TC_ASSERT",
          "old_text": null,
          "new_text": "TC_ASSERT(stmt->ret_type.data_type == DataType::f32)",
          "old_line_content": "  void visit(RandStmt *stmt) {",
          "new_line_content": "    TC_ASSERT(stmt->ret_type.data_type == DataType::f32);",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->raw_name()",
          "old_line_content": "    if (stmt->op_type != UnaryType::cast) {",
          "new_line_content": "      emit(\"const {} {}({}({}));\", stmt->ret_data_type_name(), stmt->raw_name(),",
          "content_same": false
        },
        {
          "line": 706,
          "old_api": null,
          "new_api": "ret_data_type_name",
          "old_text": null,
          "new_text": "stmt->ret_data_type_name()",
          "old_line_content": "      if (stmt->cast_by_value)",
          "new_line_content": "        emit(\"const {} {}(static_cast<{}>({}));\", stmt->ret_data_type_name(),",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": null,
          "new_api": "ret_data_type_name",
          "old_text": null,
          "new_text": "stmt->ret_data_type_name()",
          "old_line_content": "      else",
          "new_line_content": "        emit(\"const {} {}(union_cast<{}>({}));\", stmt->ret_data_type_name(),",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": null,
          "new_api": "ret_data_type_name",
          "old_text": null,
          "new_text": "bin->ret_data_type_name()",
          "old_line_content": "    }",
          "new_line_content": "    emit(\"const {} {}({}{}({}, {}));\", bin->ret_data_type_name(),",
          "content_same": false
        },
        {
          "line": 727,
          "old_api": null,
          "new_api": "TC_ASSERT",
          "old_text": null,
          "new_text": "TC_ASSERT(tri->op_type == TrinaryType::select)",
          "old_line_content": "  void visit(TrinaryOpStmt *tri) {",
          "new_line_content": "    TC_ASSERT(tri->op_type == TrinaryType::select);",
          "content_same": false
        },
        {
          "line": 734,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "if_stmt->cond->raw_name()",
          "old_line_content": "  void visit(IfStmt *if_stmt) {",
          "new_line_content": "    emit(\"if ({}) {{\", if_stmt->cond->raw_name());",
          "content_same": false
        },
        {
          "line": 736,
          "old_api": null,
          "new_api": "accept",
          "old_text": null,
          "new_text": "if_stmt->true_statements->accept(this)",
          "old_line_content": "    if (if_stmt->true_statements)",
          "new_line_content": "      if_stmt->true_statements->accept(this);",
          "content_same": false
        },
        {
          "line": 738,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"}} else {{\")",
          "old_line_content": "    if (if_stmt->false_statements) {",
          "new_line_content": "      emit(\"}} else {{\");",
          "content_same": false
        },
        {
          "line": 741,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"}}\")",
          "old_line_content": "    }",
          "new_line_content": "    emit(\"}}\");",
          "content_same": false
        },
        {
          "line": 746,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "emit(\"printf(\\\"{}\\\" \\\" = %d\\\\n\\\", {});\", print_stmt->str,\n           print_stmt->stmt->raw_name())",
          "old_line_content": "    if (print_stmt->stmt->ret_type.data_type == DataType::i32) {",
          "new_line_content": "      emit(\"printf(\\\"{}\\\" \\\" = %d\\\\n\\\", {});\", print_stmt->str,",
          "content_same": false
        },
        {
          "line": 749,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "emit(\"printf(\\\"{}\\\" \\\" = %f\\\\n\\\", {});\", print_stmt->str,\n           print_stmt->stmt->raw_name())",
          "old_line_content": "    } else if (print_stmt->stmt->ret_type.data_type == DataType::f32) {",
          "new_line_content": "      emit(\"printf(\\\"{}\\\" \\\" = %f\\\\n\\\", {});\", print_stmt->str,",
          "content_same": false
        },
        {
          "line": 757,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "const_stmt->raw_name()",
          "old_line_content": "  void visit(ConstStmt *const_stmt) {",
          "new_line_content": "    emit(\"const {} {}({});\", const_stmt->ret_type.str(), const_stmt->raw_name(),",
          "content_same": false
        },
        {
          "line": 763,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->cond->raw_name()",
          "old_line_content": "  void visit(WhileControlStmt *stmt) {",
          "new_line_content": "    emit(\"if (!{}) break;\", stmt->cond->raw_name());",
          "content_same": false
        },
        {
          "line": 767,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"while (1) {{\")",
          "old_line_content": "  void visit(WhileStmt *stmt) {",
          "new_line_content": "    emit(\"while (1) {{\");",
          "content_same": false
        },
        {
          "line": 774,
          "old_api": null,
          "new_api": "TC_ASSERT_INFO",
          "old_text": null,
          "new_text": "TC_ASSERT_INFO(current_struct_for == nullptr,\n                   \"StructFor cannot be nested.\")",
          "old_line_content": "    // generate_loop_header(for_stmt->snode, for_stmt, true);",
          "new_line_content": "    TC_ASSERT_INFO(current_struct_for == nullptr,",
          "content_same": false
        },
        {
          "line": 777,
          "old_api": null,
          "new_api": "accept",
          "old_text": null,
          "new_text": "for_stmt->body->accept(this)",
          "old_line_content": "    current_struct_for = for_stmt;",
          "new_line_content": "    for_stmt->body->accept(this);",
          "content_same": false
        },
        {
          "line": 786,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "emit(\"for (int {}_ = {}; {}_ < {}; {}_ = {}_ + {}) {{\",\n           loop_var->raw_name(), for_stmt->begin->raw_name(),\n           loop_var->raw_name(), for_stmt->end->raw_name(),\n           loop_var->raw_name(), loop_var->raw_name(), 1)",
          "old_line_content": "        loop_var->ret_type.data_type == DataType::i32) {",
          "new_line_content": "      emit(\"for (int {}_ = {}; {}_ < {}; {}_ = {}_ + {}) {{\",",
          "content_same": false
        },
        {
          "line": 792,
          "old_api": null,
          "new_api": "ret_data_type_name",
          "old_text": null,
          "new_text": "emit(\"for ({} {} = {}; {} < {}; {} = {} + {}({})) {{\",\n           loop_var->ret_data_type_name(), loop_var->raw_name(),\n           for_stmt->begin->raw_name(), loop_var->raw_name(),\n           for_stmt->end->raw_name(), loop_var->raw_name(),\n           loop_var->raw_name(), loop_var->ret_data_type_name(), 1)",
          "old_line_content": "    } else {",
          "new_line_content": "      emit(\"for ({} {} = {}; {} < {}; {} = {} + {}({})) {{\",",
          "content_same": false
        },
        {
          "line": 798,
          "old_api": null,
          "new_api": "accept",
          "old_text": null,
          "new_text": "for_stmt->body->accept(this)",
          "old_line_content": "    }",
          "new_line_content": "    for_stmt->body->accept(this);",
          "content_same": false
        },
        {
          "line": 806,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "stmt->ptr.size()",
          "old_line_content": "    bool linear_index = true;",
          "new_line_content": "    for (int i = 0; i < (int)stmt->ptr.size(); i++) {",
          "content_same": false
        },
        {
          "line": 811,
          "old_api": null,
          "new_api": "same_source",
          "old_text": null,
          "new_text": "stmt->same_source()",
          "old_line_content": "    }",
          "new_line_content": "    if (stmt->same_source() && linear_index &&",
          "content_same": false
        },
        {
          "line": 814,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->raw_name()",
          "old_line_content": "      auto ptr = stmt->ptr[0].var;",
          "new_line_content": "      emit(\"const {} {}({});\", stmt->ret_data_type_name(), stmt->raw_name(),",
          "content_same": false
        },
        {
          "line": 818,
          "old_api": null,
          "new_api": "width",
          "old_text": null,
          "new_text": "stmt->width()",
          "old_line_content": "      std::string init_v;",
          "new_line_content": "      for (int i = 0; i < stmt->width(); i++) {",
          "content_same": false
        },
        {
          "line": 821,
          "old_api": null,
          "new_api": "width",
          "old_text": null,
          "new_text": "stmt->width()",
          "old_line_content": "                              stmt->ptr[i].offset);",
          "new_line_content": "        if (i + 1 < stmt->width()) {",
          "content_same": false
        },
        {
          "line": 825,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->raw_name()",
          "old_line_content": "      }",
          "new_line_content": "      emit(\"const {} {}({{{}}});\", stmt->ret_data_type_name(), stmt->raw_name(),",
          "content_same": false
        },
        {
          "line": 831,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->data->raw_name()",
          "old_line_content": "  void visit(LocalStoreStmt *stmt) {",
          "new_line_content": "    emit(\"{} = {};\", stmt->ptr->raw_name(), stmt->data->raw_name());",
          "content_same": false
        },
        {
          "line": 836,
          "old_api": null,
          "new_api": "has",
          "old_text": null,
          "new_text": "current_scratch_pads->has(snode)",
          "old_line_content": "    auto snode = stmt->snodes[0];",
          "new_line_content": "    if (current_scratch_pads && current_scratch_pads->has(snode)) {",
          "content_same": false
        },
        {
          "line": 840,
          "old_api": null,
          "new_api": "width",
          "old_text": null,
          "new_text": "stmt->width()",
          "old_line_content": "",
          "new_line_content": "    TC_ASSERT(stmt->width() == 1);",
          "content_same": false
        },
        {
          "line": 845,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "stmt->indices.size()",
          "old_line_content": "      // Try to weaken here...",
          "new_line_content": "      std::vector<int> offsets(stmt->indices.size());",
          "content_same": false
        },
        {
          "line": 849,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "stmt->indices.size()",
          "old_line_content": "      std::vector<std::string> indices(max_num_indices, \"0\");  // = \"(root, \";",
          "new_line_content": "      for (int i = 0; i < stmt->indices.size(); i++) {",
          "content_same": false
        },
        {
          "line": 853,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->indices[i]->raw_name()",
          "old_line_content": "          indices[snode->physical_index_position[i]] =",
          "new_line_content": "              stmt->indices[i]->raw_name();",
          "content_same": false
        },
        {
          "line": 857,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->raw_name()",
          "old_line_content": "      std::string strong_access =",
          "new_line_content": "          fmt::format(\"{}[{}] = &access_{}{}->val;\", stmt->raw_name(), l,",
          "content_same": false
        },
        {
          "line": 859,
          "old_api": null,
          "new_api": "make_list",
          "old_text": null,
          "new_text": "make_list(indices, \"\")",
          "old_line_content": "                      stmt->snodes[l]->node_type_name,",
          "new_line_content": "                      \"(root, \" + make_list(indices, \"\") + \")\");",
          "content_same": false
        },
        {
          "line": 861,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"{}\", strong_access)",
          "old_line_content": "",
          "new_line_content": "      emit(\"{}\", strong_access);",
          "content_same": false
        },
        {
          "line": 866,
          "old_api": null,
          "new_api": "width",
          "old_text": null,
          "new_text": "stmt->width()",
          "old_line_content": "  void visit(SNodeOpStmt *stmt) {",
          "new_line_content": "    TC_ASSERT(stmt->width() == 1);",
          "content_same": false
        },
        {
          "line": 868,
          "old_api": null,
          "new_api": "indices_str",
          "old_text": null,
          "new_text": "indices_str(snode, -1, stmt->indices)",
          "old_line_content": "    auto snode = stmt->snodes[0];",
          "new_line_content": "    auto indices = indices_str(snode, -1, stmt->indices);",
          "content_same": false
        },
        {
          "line": 871,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->raw_name()",
          "old_line_content": "    if (stmt->op_type == SNodeOpType::probe) {",
          "new_line_content": "      emit(\"int32x1 {};\", stmt->raw_name());",
          "content_same": false
        },
        {
          "line": 874,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"{{\")",
          "old_line_content": "",
          "new_line_content": "    emit(\"{{\");",
          "content_same": false
        },
        {
          "line": 876,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"{} *{}_tmp = access_{}(root, {});\", snode->node_type_name,\n           snode->node_type_name, snode->node_type_name,\n           make_list(indices, \"\"))",
          "old_line_content": "    if (stmt->op_type != SNodeOpType::activate)",
          "new_line_content": "      emit(\"{} *{}_tmp = access_{}(root, {});\", snode->node_type_name,",
          "content_same": false
        },
        {
          "line": 878,
          "old_api": null,
          "new_api": "make_list",
          "old_text": null,
          "new_text": "make_list(indices, \"\")",
          "old_line_content": "           snode->node_type_name, snode->node_type_name,",
          "new_line_content": "           make_list(indices, \"\"));",
          "content_same": false
        },
        {
          "line": 881,
          "old_api": null,
          "new_api": "width",
          "old_text": null,
          "new_text": "stmt->val->width()",
          "old_line_content": "    if (stmt->op_type == SNodeOpType::append) {",
          "new_line_content": "      TC_ASSERT(stmt->val->width() == 1);",
          "content_same": false
        },
        {
          "line": 885,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "emit(\"{}_tmp->clear();\", snode->node_type_name)",
          "old_line_content": "    } else if (stmt->op_type == SNodeOpType::clear) {",
          "new_line_content": "      emit(\"{}_tmp->clear();\", snode->node_type_name);",
          "content_same": false
        },
        {
          "line": 887,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->raw_name()",
          "old_line_content": "    } else if (stmt->op_type == SNodeOpType::probe) {",
          "new_line_content": "      emit(\"{} = {}_tmp->get_n();\", stmt->raw_name(), snode->node_type_name);",
          "content_same": false
        },
        {
          "line": 889,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"activate_{}(root, {});\", snode->node_type_name,\n           make_list(indices, \"\"))",
          "old_line_content": "    } else if (stmt->op_type == SNodeOpType::activate) {",
          "new_line_content": "      emit(\"activate_{}(root, {});\", snode->node_type_name,",
          "content_same": false
        },
        {
          "line": 894,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"}}\")",
          "old_line_content": "    }",
          "new_line_content": "    emit(\"}}\");",
          "content_same": false
        },
        {
          "line": 898,
          "old_api": null,
          "new_api": "stmt->ptr->as<GlobalPtrStmt>()",
          "old_text": null,
          "new_text": "stmt->ptr->as<GlobalPtrStmt>()",
          "old_line_content": "  void visit(GlobalStoreStmt *stmt) {",
          "new_line_content": "    auto ptr = stmt->ptr->as<GlobalPtrStmt>();",
          "content_same": false
        },
        {
          "line": 900,
          "old_api": null,
          "new_api": "has",
          "old_text": null,
          "new_text": "current_scratch_pads->has(snode)",
          "old_line_content": "    auto snode = ptr->snodes[0];",
          "new_line_content": "    if (current_scratch_pads && current_scratch_pads->has(snode)) {",
          "content_same": false
        },
        {
          "line": 905,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->data->raw_name()",
          "old_line_content": "                                          ptr->indices),",
          "new_line_content": "           stmt->data->raw_name());",
          "content_same": false
        },
        {
          "line": 907,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "emit(\"*({} *){}[{}] = {};\",\n           data_type_name(stmt->data->ret_type.data_type),\n           stmt->ptr->raw_name(), 0, stmt->data->raw_name())",
          "old_line_content": "    } else {",
          "new_line_content": "      emit(\"*({} *){}[{}] = {};\",",
          "content_same": false
        },
        {
          "line": 914,
          "old_api": null,
          "new_api": "width",
          "old_text": null,
          "new_text": "stmt->width()",
          "old_line_content": "  void visit(GlobalLoadStmt *stmt) {",
          "new_line_content": "    TC_ASSERT(stmt->width() == 1);",
          "content_same": false
        },
        {
          "line": 917,
          "old_api": null,
          "new_api": "has",
          "old_text": null,
          "new_text": "current_scratch_pads->has(snode)",
          "old_line_content": "    auto snode = ptr->snodes[0];",
          "new_line_content": "    if (current_scratch_pads && current_scratch_pads->has(snode)) {",
          "content_same": false
        },
        {
          "line": 923,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->raw_name()",
          "old_line_content": "    } else {",
          "new_line_content": "      emit(\"const auto {} = *({}[0]);\", stmt->raw_name(),",
          "content_same": false
        },
        {
          "line": 929,
          "old_api": null,
          "new_api": "TC_ASSERT",
          "old_text": null,
          "new_text": "TC_ASSERT(stmt->val->ret_type.data_type == DataType::f32 ||\n              stmt->val->ret_type.data_type == DataType::i32)",
          "old_line_content": "  void visit(AtomicOpStmt *stmt) {",
          "new_line_content": "    TC_ASSERT(stmt->val->ret_type.data_type == DataType::f32 ||",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": null,
          "new_api": "TC_ASSERT",
          "old_text": null,
          "new_text": "TC_ASSERT(stmt->op_type == AtomicType::add)",
          "old_line_content": "              stmt->val->ret_type.data_type == DataType::i32);",
          "new_line_content": "    TC_ASSERT(stmt->op_type == AtomicType::add);",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": null,
          "new_api": "has",
          "old_text": null,
          "new_text": "current_scratch_pads->has(snode)",
          "old_line_content": "    auto snode = ptr->snodes[0];",
          "new_line_content": "    if (current_scratch_pads && current_scratch_pads->has(snode)) {",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": null,
          "new_api": "start",
          "old_text": null,
          "new_text": "emit(R\"(GPUProfiler::get_instance().start(\"{}_list_gen\");)\",\n         codegen->func_name)",
          "old_line_content": "",
          "new_line_content": "    emit(R\"(GPUProfiler::get_instance().start(\"{}_list_gen\");)\",",
          "content_same": false
        },
        {
          "line": 939,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->val->raw_name()",
          "old_line_content": "                                          ptr->indices),",
          "new_line_content": "           stmt->val->raw_name());",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\n        \"{}_kernel_list_gen<<<Managers::get_allocator<{}>()->resident_tail, \"\n        \"{}>>>(context);\",\n        codegen->func_name, leaf->parent->node_type_name, block_division)",
          "old_line_content": "         codegen->func_name);",
          "new_line_content": "    emit(",
          "content_same": false
        },
        {
          "line": 941,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->dest->raw_name()",
          "old_line_content": "    } else {",
          "new_line_content": "      emit(\"atomicAdd({}[0], {});\", stmt->dest->raw_name(),",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": null,
          "new_api": "stop",
          "old_text": null,
          "new_text": "emit(R\"(GPUProfiler::get_instance().stop();)\")",
          "old_line_content": "        codegen->func_name, leaf->parent->node_type_name, block_division);",
          "new_line_content": "    emit(R\"(GPUProfiler::get_instance().stop();)\");",
          "content_same": false
        },
        {
          "line": 947,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->raw_name()",
          "old_line_content": "  void visit(ElementShuffleStmt *stmt) {",
          "new_line_content": "    emit(\"const {} {}({});\", stmt->ret_data_type_name(), stmt->raw_name(),",
          "content_same": false
        },
        {
          "line": 436,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\n          R\"(printf(\"task list %d\\n\", Managers::get_allocator<{}>()->resident_tail);)\",\n          leaf->node_type_name)",
          "old_line_content": "        R\"(printf(\"task list %d\\n\", Managers::get_allocator<{}>()->resident_tail);)\",",
          "new_line_content": "      emit(",
          "content_same": false
        },
        {
          "line": 950,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "elem.stmt->raw_name()",
          "old_line_content": "             [](const VectorElement &elem) {",
          "new_line_content": "               return fmt::format(\"{}[{}]\", elem.stmt->raw_name(), elem.index);",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\n          R\"(printf(\"kernel {} <<<%d, %d>>> \", gridDim, blockDim);)\",\n          codegen->func_name)",
          "old_line_content": "    if (debug) {",
          "new_line_content": "      emit(",
          "content_same": false
        },
        {
          "line": 443,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"cudaEvent_t start, stop;\")",
          "old_line_content": "",
          "new_line_content": "      emit(\"cudaEvent_t start, stop;\");",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": null,
          "new_api": "get_current_kernel",
          "old_text": null,
          "new_text": "current_program->get_current_kernel()",
          "old_line_content": "",
          "new_line_content": "      if (current_program->get_current_kernel().benchmarking) {",
          "content_same": false
        },
        {
          "line": 449,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"cudaEventCreate(&start);\")",
          "old_line_content": "",
          "new_line_content": "      emit(\"cudaEventCreate(&start);\");",
          "content_same": false
        },
        {
          "line": 962,
          "old_api": null,
          "new_api": "raw_name",
          "old_text": null,
          "new_text": "stmt->input->raw_name()",
          "old_line_content": "    */",
          "new_line_content": "    emit(\"const auto {} = {};\", stmt->raw_name(), stmt->input->raw_name());",
          "content_same": false
        },
        {
          "line": 453,
          "old_api": null,
          "new_api": "start",
          "old_text": null,
          "new_text": "emit(R\"(GPUProfiler::get_instance().start(\"{}\");)\", codegen->func_name)",
          "old_line_content": "    }",
          "new_line_content": "    emit(R\"(GPUProfiler::get_instance().start(\"{}\");)\", codegen->func_name);",
          "content_same": false
        },
        {
          "line": 966,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"#if defined(TL_DEBUG)\")",
          "old_line_content": "  void visit(AssertStmt *stmt) {",
          "new_line_content": "    emit(\"#if defined(TL_DEBUG)\");",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"cudaEventRecord(stop);\")",
          "old_line_content": "    if (debug) {",
          "new_line_content": "      emit(\"cudaEventRecord(stop);\");",
          "content_same": false
        },
        {
          "line": 460,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"float milliseconds = 0;\")",
          "old_line_content": "",
          "new_line_content": "      emit(\"float milliseconds = 0;\");",
          "content_same": false
        },
        {
          "line": 975,
          "old_api": null,
          "new_api": "irpass::print(ir)",
          "old_text": null,
          "new_text": "irpass::print(ir)",
          "old_line_content": "  if (prog->config.print_ir) {",
          "new_line_content": "    irpass::print(ir);",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"cudaDeviceSynchronize();\\n\")",
          "old_line_content": "      if (current_program->current_kernel->benchmarking) {",
          "new_line_content": "        emit(\"cudaDeviceSynchronize();\\n\");",
          "content_same": false
        },
        {
          "line": 977,
          "old_api": null,
          "new_api": "irpass::lower(ir)",
          "old_text": null,
          "new_text": "irpass::lower(ir)",
          "old_line_content": "  }",
          "new_line_content": "  irpass::lower(ir);",
          "content_same": false
        },
        {
          "line": 980,
          "old_api": null,
          "new_api": "irpass::print(ir)",
          "old_text": null,
          "new_text": "irpass::print(ir)",
          "old_line_content": "  if (prog->config.print_ir) {",
          "new_line_content": "    irpass::print(ir);",
          "content_same": false
        },
        {
          "line": 982,
          "old_api": null,
          "new_api": "irpass::typecheck(ir)",
          "old_text": null,
          "new_text": "irpass::typecheck(ir)",
          "old_line_content": "  }",
          "new_line_content": "  irpass::typecheck(ir);",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"exit(-1);}}\")",
          "old_line_content": "            \"__FILE__, __LINE__, cudaGetErrorString(err));\");",
          "new_line_content": "        emit(\"exit(-1);}}\");",
          "content_same": false
        },
        {
          "line": 985,
          "old_api": null,
          "new_api": "irpass::print(ir)",
          "old_text": null,
          "new_text": "irpass::print(ir)",
          "old_line_content": "  if (prog->config.print_ir) {",
          "new_line_content": "    irpass::print(ir);",
          "content_same": false
        },
        {
          "line": 475,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"}}\")",
          "old_line_content": "    }",
          "new_line_content": "    emit(\"}}\");",
          "content_same": false
        },
        {
          "line": 987,
          "old_api": null,
          "new_api": "irpass::eliminate_dup(ir)",
          "old_text": null,
          "new_text": "irpass::eliminate_dup(ir)",
          "old_line_content": "  }",
          "new_line_content": "  irpass::eliminate_dup(ir);",
          "content_same": false
        },
        {
          "line": 990,
          "old_api": null,
          "new_api": "irpass::print(ir)",
          "old_text": null,
          "new_text": "irpass::print(ir)",
          "old_line_content": "  if (prog->config.print_ir)",
          "new_line_content": "    irpass::print(ir);",
          "content_same": false
        },
        {
          "line": 994,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"#define TC_GPU\")",
          "old_line_content": "void GPUCodeGen::codegen() {",
          "new_line_content": "  emit(\"#define TC_GPU\");",
          "content_same": false
        },
        {
          "line": 483,
          "old_api": null,
          "new_api": "bit::log2int(block_size)",
          "old_text": null,
          "new_text": "bit::log2int(block_size)",
          "old_line_content": "    auto block_size = sfor->block_size;",
          "new_line_content": "    auto block_bits = bit::log2int(block_size);",
          "content_same": false
        },
        {
          "line": 998,
          "old_api": null,
          "new_api": "GPUIRCodeGen::run(this, kernel->ir)",
          "old_text": null,
          "new_text": "GPUIRCodeGen::run(this, kernel->ir)",
          "old_line_content": "  // Body",
          "new_line_content": "  GPUIRCodeGen::run(this, kernel->ir);",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "path.push_back(p)",
          "old_line_content": "    for (auto p = snode; p; p = p->parent) {",
          "new_line_content": "      path.push_back(p);",
          "content_same": false
        },
        {
          "line": 1001,
          "old_api": null,
          "new_api": "generate_tail",
          "old_text": null,
          "new_text": "generate_tail()",
          "old_line_content": "  line_suffix = \"\";",
          "new_line_content": "  generate_tail();",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": null,
          "new_api": "TC_ASSERT",
          "old_text": null,
          "new_text": "TC_ASSERT(first_managed_ancestor)",
          "old_line_content": "",
          "new_line_content": "    TC_ASSERT(first_managed_ancestor);",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": null,
          "new_api": "fmt::format(\n        \"Managers::get<{}>()\", first_managed_ancestor->node_type_name)",
          "old_text": null,
          "new_text": "fmt::format(\n        \"Managers::get<{}>()\", first_managed_ancestor->node_type_name)",
          "old_line_content": "",
          "new_line_content": "    auto ancestor_allocator = fmt::format(",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": null,
          "new_api": "fmt::format(\"Managers::get_allocator<{}>()\", snode->node_type_name)",
          "old_text": null,
          "new_text": "fmt::format(\"Managers::get_allocator<{}>()\", snode->node_type_name)",
          "old_line_content": "    auto leaf_allocator =",
          "new_line_content": "        fmt::format(\"Managers::get_allocator<{}>()\", snode->node_type_name);",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"\")",
          "old_line_content": "",
          "new_line_content": "    emit(\"\");",
          "content_same": false
        },
        {
          "line": 507,
          "old_api": null,
          "new_api": "emit",
          "old_text": null,
          "new_text": "emit(\"__global__ void {}_kernel_list_gen(Context context) {{\",\n         codegen->func_name)",
          "old_line_content": "    // kernel body starts",
          "new_line_content": "    emit(\"__global__ void {}_kernel_list_gen(Context context) {{\",",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 514,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"int subblock_id = threadIdx.x;\")",
          "new_text": null,
          "old_line_content": "    emit(\"int subblock_id = threadIdx.x;\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 516,
          "old_api": "end",
          "new_api": null,
          "old_text": "path.end()",
          "new_text": null,
          "old_line_content": "    std::reverse(path.begin(), path.end());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\n        \"auto leaves = (SNodeMeta \"\n        \"*)(Managers::get_allocator<{}>()->resident_pool);\",\n        path[0]->node_type_name)",
          "new_text": null,
          "old_line_content": "    emit(",
          "new_line_content": "        \"auto leaves = (SNodeMeta \"",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\n        \"auto num_leaves = Managers::get_allocator<{}>()->resident_tail_const;\",\n        path[0]->node_type_name)",
          "new_text": null,
          "old_line_content": "    emit(",
          "new_line_content": "        \"auto num_leaves = Managers::get_allocator<{}>()->resident_tail_const;\",",
          "content_same": false
        },
        {
          "line": 526,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"auto list_element = ({}::child_type *)leaves[leaf_loop].ptr;\",\n         path[0]->node_type_name)",
          "new_text": null,
          "old_line_content": "    emit(\"auto list_element = ({}::child_type *)leaves[leaf_loop].ptr;\",",
          "new_line_content": "         path[0]->node_type_name);",
          "content_same": false
        },
        {
          "line": 530,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"auto {}_cache = list_element->get{}();\", path[1]->node_type_name,\n         chid)",
          "new_text": null,
          "old_line_content": "    emit(\"auto {}_cache = list_element->get{}();\", path[1]->node_type_name,",
          "new_line_content": "         chid);",
          "content_same": false
        },
        {
          "line": 535,
          "old_api": "index_name_global",
          "new_api": null,
          "old_text": "loopgen.index_name_global(path[1], i)",
          "new_text": null,
          "old_line_content": "           loopgen.index_name_global(path[1], i), i);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"int end_idx = (subblock_id + 1) * {};\", block_size)",
          "new_text": null,
          "old_line_content": "    emit(\"int end_idx = (subblock_id + 1) * {};\", block_size);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": "get_n",
          "new_api": null,
          "old_text": "emit(\"if (start_idx >= {}_cache->get_n()) return;\",\n           snode->node_type_name)",
          "new_text": null,
          "old_line_content": "      emit(\"if (start_idx >= {}_cache->get_n()) return;\",",
          "new_line_content": "           snode->node_type_name);",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": "get_n",
          "new_api": null,
          "old_text": "emit(\"end_idx = min(end_idx, {}_cache->get_n());\", snode->node_type_name)",
          "new_text": null,
          "old_line_content": "      emit(\"end_idx = min(end_idx, {}_cache->get_n());\", snode->node_type_name);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 562,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\n        \"int meta_id = atomicAdd((unsigned long long *)(&{}->resident_tail), \"\n        \"1ULL);\",\n        leaf_allocator)",
          "new_text": null,
          "old_line_content": "    emit(",
          "new_line_content": "        \"int meta_id = atomicAdd((unsigned long long *)(&{}->resident_tail), \"",
          "content_same": false
        },
        {
          "line": 566,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"auto &meta = {}->resident_pool[meta_id];\", leaf_allocator)",
          "new_text": null,
          "old_line_content": "    emit(\"auto &meta = {}->resident_pool[meta_id];\", leaf_allocator);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "index_name_global",
          "new_api": null,
          "old_text": "loopgen.index_name_global(snode, i)",
          "new_text": null,
          "old_line_content": "      emit(\"meta.indices[{}] = {};\", i, loopgen.index_name_global(snode, i));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 573,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"meta.end_loop = end_idx;\")",
          "new_text": null,
          "old_line_content": "    emit(\"meta.end_loop = end_idx;\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"\")",
          "new_text": null,
          "old_line_content": "    emit(\"\");",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": "for_stmt_->as<RangeForStmt>()",
          "new_api": null,
          "old_text": "for_stmt_->as<RangeForStmt>()",
          "new_text": null,
          "old_line_content": "      auto range_for = for_stmt_->as<RangeForStmt>();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 587,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"auto root = ({} *)context.buffers[0];\",\n           codegen->prog->snode_root->node_type_name)",
          "new_text": null,
          "old_line_content": "      emit(\"auto root = ({} *)context.buffers[0];\",",
          "new_line_content": "           codegen->prog->snode_root->node_type_name);",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": "val_int32",
          "new_api": null,
          "old_text": "range_for->end->as<ConstStmt>()->val[0].val_int32()",
          "new_text": null,
          "old_line_content": "      int end = range_for->end->as<ConstStmt>()->val[0].val_int32();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "range_for->loop_var->raw_name()",
          "new_text": null,
          "old_line_content": "      emit(\"if ({} >= {}) return;\", range_for->loop_var->raw_name(), end);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": "accept",
          "new_api": null,
          "old_text": "range_for->body->accept(this)",
          "new_text": null,
          "old_line_content": "      range_for->body->accept(this);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 600,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"extern \\\"C\\\" void {} (Context context) {{\\n\", codegen->func_name)",
          "new_text": null,
          "old_line_content": "      emit(\"extern \\\"C\\\" void {} (Context context) {{\\n\", codegen->func_name);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 602,
          "old_api": "TC_ASSERT",
          "new_api": null,
          "old_text": "TC_ASSERT(begin == 0)",
          "new_text": null,
          "old_line_content": "      TC_ASSERT(begin == 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": "TC_WARN",
          "new_api": null,
          "old_text": "TC_WARN(\"Using default block size = 256\")",
          "new_text": null,
          "old_line_content": "        TC_WARN(\"Using default block size = 256\");",
          "new_line_content": "        block_size = 256;",
          "content_same": false
        },
        {
          "line": 609,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"gpu_runtime_init();\")",
          "new_text": null,
          "old_line_content": "      emit(\"gpu_runtime_init();\");",
          "new_line_content": "      int num_blocks = (end - begin + block_size - 1) / block_size;",
          "content_same": false
        },
        {
          "line": 611,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"{}_kernel<<<{}, {}>>>(context);\", codegen->func_name, num_blocks,\n           block_size)",
          "new_text": null,
          "old_line_content": "      emit(\"{}_kernel<<<{}, {}>>>(context);\", codegen->func_name, num_blocks,",
          "new_line_content": "           block_size);",
          "content_same": false
        },
        {
          "line": 614,
          "old_api": "for_stmt_->as<StructForStmt>()",
          "new_api": null,
          "old_text": "for_stmt_->as<StructForStmt>()",
          "new_text": null,
          "old_line_content": "      auto struct_for = for_stmt_->as<StructForStmt>();",
          "new_line_content": "      bool use_activity_tracking = false;",
          "content_same": false
        },
        {
          "line": 629,
          "old_api": "get",
          "new_api": null,
          "old_text": "for_stmt_.get()",
          "new_text": null,
          "old_line_content": "        struct_for_new(for_stmt_.get());",
          "new_line_content": "      } else {",
          "content_same": false
        },
        {
          "line": 631,
          "old_api": "get",
          "new_api": null,
          "old_text": "for_stmt_.get()",
          "new_text": null,
          "old_line_content": "        struct_for_old(for_stmt_.get());",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 637,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\n          R\"(if (allocator()->gpu_error_code) {{printf(\"GPU Assertion Error\\n\"); exit(-1);}})\")",
          "new_text": null,
          "old_line_content": "      emit(",
          "new_line_content": "          R\"(if (allocator()->gpu_error_code) {{printf(\"GPU Assertion Error\\n\"); exit(-1);}})\");",
          "content_same": false
        },
        {
          "line": 641,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\n          \"printf(\\\"CUDA Error (File %s Ln %d): %s\\\\n\\\", \"\n          \"__FILE__, __LINE__, cudaGetErrorString(err));\")",
          "new_text": null,
          "old_line_content": "      emit(",
          "new_line_content": "          \"printf(\\\"CUDA Error (File %s Ln %d): %s\\\\n\\\", \"",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"exit(-1);}}\")",
          "new_text": null,
          "old_line_content": "      emit(\"exit(-1);}}\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"}}\\n\")",
          "new_text": null,
          "old_line_content": "    emit(\"}}\\n\");",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 660,
          "old_api": "s->is<ConstStmt>()",
          "new_api": null,
          "old_text": "s->is<ConstStmt>()",
          "new_text": null,
          "old_line_content": "        if (!(s->is<AllocaStmt>() || s->is<ConstStmt>())) {",
          "new_line_content": "          pure_loop = false;",
          "content_same": false
        },
        {
          "line": 666,
          "old_api": "generate_pure_loop",
          "new_api": null,
          "old_text": "generate_pure_loop(stmt_list)",
          "new_text": null,
          "old_line_content": "        generate_pure_loop(stmt_list);",
          "new_line_content": "      } else {",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"__global__ void {}_kernel(Context context) {{\",\n             codegen->func_name)",
          "new_text": null,
          "old_line_content": "        emit(\"__global__ void {}_kernel(Context context) {{\",",
          "new_line_content": "             codegen->func_name);",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"auto root = ({} *)context.buffers[0];\",\n             codegen->prog->snode_root->node_type_name)",
          "new_text": null,
          "old_line_content": "        emit(\"auto root = ({} *)context.buffers[0];\",",
          "new_line_content": "             codegen->prog->snode_root->node_type_name);",
          "content_same": false
        },
        {
          "line": 674,
          "old_api": "accept",
          "new_api": null,
          "old_text": "stmt_list->accept(this)",
          "new_text": null,
          "old_line_content": "        stmt_list->accept(this);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 676,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"}}\\n\\n\")",
          "new_text": null,
          "old_line_content": "        emit(\"}}\\n\\n\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"}}\\n\\n\")",
          "new_text": null,
          "old_line_content": "        emit(\"}}\\n\\n\");",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 686,
          "old_api": "accept",
          "new_api": null,
          "old_text": "stmt->accept(this)",
          "new_text": null,
          "old_line_content": "        stmt->accept(this);",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 692,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "alloca->raw_name()",
          "new_text": null,
          "old_line_content": "    emit(\"{} {}(0);\", alloca->ret_data_type_name(), alloca->raw_name());",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 698,
          "old_api": "ret_data_type_name",
          "new_api": null,
          "old_text": "stmt->ret_data_type_name()",
          "new_text": null,
          "old_line_content": "         stmt->ret_data_type_name());",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->rhs->raw_name()",
          "new_text": null,
          "old_line_content": "           unary_type_name(stmt->op_type), stmt->rhs->raw_name());",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->rhs->raw_name()",
          "new_text": null,
          "old_line_content": "             stmt->rhs->raw_name());",
          "new_line_content": "      else",
          "content_same": false
        },
        {
          "line": 713,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->rhs->raw_name()",
          "new_text": null,
          "old_line_content": "             stmt->rhs->raw_name());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 724,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "bin->rhs->raw_name()",
          "new_text": null,
          "old_line_content": "         bin->lhs->raw_name(), bin->rhs->raw_name());",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 731,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "tri->op3->raw_name()",
          "new_text": null,
          "old_line_content": "         tri->op3->raw_name());",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "if_stmt->cond->raw_name()",
          "new_text": null,
          "old_line_content": "    emit(\"if ({}) {{\", if_stmt->cond->raw_name());",
          "new_line_content": "    if (if_stmt->true_statements)",
          "content_same": false
        },
        {
          "line": 737,
          "old_api": "accept",
          "new_api": null,
          "old_text": "if_stmt->true_statements->accept(this)",
          "new_text": null,
          "old_line_content": "      if_stmt->true_statements->accept(this);",
          "new_line_content": "    if (if_stmt->false_statements) {",
          "content_same": false
        },
        {
          "line": 740,
          "old_api": "accept",
          "new_api": null,
          "old_text": "if_stmt->false_statements->accept(this)",
          "new_text": null,
          "old_line_content": "      if_stmt->false_statements->accept(this);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 742,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"}}\")",
          "new_text": null,
          "old_line_content": "    emit(\"}}\");",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 748,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "print_stmt->stmt->raw_name()",
          "new_text": null,
          "old_line_content": "           print_stmt->stmt->raw_name());",
          "new_line_content": "    } else if (print_stmt->stmt->ret_type.data_type == DataType::f32) {",
          "content_same": false
        },
        {
          "line": 751,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "print_stmt->stmt->raw_name()",
          "new_text": null,
          "old_line_content": "           print_stmt->stmt->raw_name());",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 760,
          "old_api": "stringify",
          "new_api": null,
          "old_text": "t.stringify()",
          "new_text": null,
          "old_line_content": "             [&](const TypedConstant &t) { return t.stringify(); }, \"{\"));",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 764,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->cond->raw_name()",
          "new_text": null,
          "old_line_content": "    emit(\"if (!{}) break;\", stmt->cond->raw_name());",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 770,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"}}\")",
          "new_text": null,
          "old_line_content": "    emit(\"}}\");",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 775,
          "old_api": "TC_ASSERT_INFO",
          "new_api": null,
          "old_text": "TC_ASSERT_INFO(current_struct_for == nullptr,\n                   \"StructFor cannot be nested.\")",
          "new_text": null,
          "old_line_content": "    TC_ASSERT_INFO(current_struct_for == nullptr,",
          "new_line_content": "                   \"StructFor cannot be nested.\");",
          "content_same": false
        },
        {
          "line": 778,
          "old_api": "accept",
          "new_api": null,
          "old_text": "for_stmt->body->accept(this)",
          "new_text": null,
          "old_line_content": "    for_stmt->body->accept(this);",
          "new_line_content": "    current_struct_for = nullptr;",
          "content_same": false
        },
        {
          "line": 791,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "loop_var->raw_name()",
          "new_text": null,
          "old_line_content": "      emit(\"{} = {}_;\", loop_var->raw_name(), loop_var->raw_name());",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 797,
          "old_api": "ret_data_type_name",
          "new_api": null,
          "old_text": "loop_var->ret_data_type_name()",
          "new_text": null,
          "old_line_content": "           loop_var->raw_name(), loop_var->ret_data_type_name(), 1);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 800,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"}}\")",
          "new_text": null,
          "old_line_content": "    emit(\"}}\");",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 807,
          "old_api": "size",
          "new_api": null,
          "old_text": "stmt->ptr.size()",
          "new_text": null,
          "old_line_content": "    for (int i = 0; i < (int)stmt->ptr.size(); i++) {",
          "new_line_content": "      if (stmt->ptr[i].offset != i) {",
          "content_same": false
        },
        {
          "line": 813,
          "old_api": "width",
          "new_api": null,
          "old_text": "stmt->ptr[0].var->width()",
          "new_text": null,
          "old_line_content": "        stmt->width() == stmt->ptr[0].var->width()) {",
          "new_line_content": "      auto ptr = stmt->ptr[0].var;",
          "content_same": false
        },
        {
          "line": 816,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "ptr->raw_name()",
          "new_text": null,
          "old_line_content": "           ptr->raw_name());",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 820,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->ptr[i].var->raw_name()",
          "new_text": null,
          "old_line_content": "        init_v += fmt::format(\"{}[{}]\", stmt->ptr[i].var->raw_name(),",
          "new_line_content": "                              stmt->ptr[i].offset);",
          "content_same": false
        },
        {
          "line": 822,
          "old_api": "width",
          "new_api": null,
          "old_text": "stmt->width()",
          "new_text": null,
          "old_line_content": "        if (i + 1 < stmt->width()) {",
          "new_line_content": "          init_v += \", \";",
          "content_same": false
        },
        {
          "line": 826,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->raw_name()",
          "new_text": null,
          "old_line_content": "      emit(\"const {} {}({{{}}});\", stmt->ret_data_type_name(), stmt->raw_name(),",
          "new_line_content": "           init_v);",
          "content_same": false
        },
        {
          "line": 832,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->data->raw_name()",
          "new_text": null,
          "old_line_content": "    emit(\"{} = {};\", stmt->ptr->raw_name(), stmt->data->raw_name());",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 837,
          "old_api": "has",
          "new_api": null,
          "old_text": "current_scratch_pads->has(snode)",
          "new_text": null,
          "old_line_content": "    if (current_scratch_pads && current_scratch_pads->has(snode)) {",
          "new_line_content": "      return;",
          "content_same": false
        },
        {
          "line": 843,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->raw_name()",
          "new_text": null,
          "old_line_content": "         stmt->raw_name(), stmt->ret_type.width);",
          "new_line_content": "    for (int l = 0; l < stmt->ret_type.width; l++) {",
          "content_same": false
        },
        {
          "line": 846,
          "old_api": "size",
          "new_api": null,
          "old_text": "stmt->indices.size()",
          "new_text": null,
          "old_line_content": "      std::vector<int> offsets(stmt->indices.size());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 850,
          "old_api": "size",
          "new_api": null,
          "old_text": "stmt->indices.size()",
          "new_text": null,
          "old_line_content": "      for (int i = 0; i < stmt->indices.size(); i++) {",
          "new_line_content": "        if (snode->physical_index_position[i] != -1) {",
          "content_same": false
        },
        {
          "line": 854,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->indices[i]->raw_name()",
          "new_text": null,
          "old_line_content": "              stmt->indices[i]->raw_name();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 858,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->raw_name()",
          "new_text": null,
          "old_line_content": "          fmt::format(\"{}[{}] = &access_{}{}->val;\", stmt->raw_name(), l,",
          "new_line_content": "                      stmt->snodes[l]->node_type_name,",
          "content_same": false
        },
        {
          "line": 860,
          "old_api": "make_list",
          "new_api": null,
          "old_text": "make_list(indices, \"\")",
          "new_text": null,
          "old_line_content": "                      \"(root, \" + make_list(indices, \"\") + \")\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 862,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"{}\", strong_access)",
          "new_text": null,
          "old_line_content": "      emit(\"{}\", strong_access);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 867,
          "old_api": "width",
          "new_api": null,
          "old_text": "stmt->width()",
          "new_text": null,
          "old_line_content": "    TC_ASSERT(stmt->width() == 1);",
          "new_line_content": "    auto snode = stmt->snodes[0];",
          "content_same": false
        },
        {
          "line": 869,
          "old_api": "indices_str",
          "new_api": null,
          "old_text": "indices_str(snode, -1, stmt->indices)",
          "new_text": null,
          "old_line_content": "    auto indices = indices_str(snode, -1, stmt->indices);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 872,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->raw_name()",
          "new_text": null,
          "old_line_content": "      emit(\"int32x1 {};\", stmt->raw_name());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 875,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"{{\")",
          "new_text": null,
          "old_line_content": "    emit(\"{{\");",
          "new_line_content": "    if (stmt->op_type != SNodeOpType::activate)",
          "content_same": false
        },
        {
          "line": 877,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"{} *{}_tmp = access_{}(root, {});\", snode->node_type_name,\n           snode->node_type_name, snode->node_type_name,\n           make_list(indices, \"\"))",
          "new_text": null,
          "old_line_content": "      emit(\"{} *{}_tmp = access_{}(root, {});\", snode->node_type_name,",
          "new_line_content": "           snode->node_type_name, snode->node_type_name,",
          "content_same": false
        },
        {
          "line": 879,
          "old_api": "make_list",
          "new_api": null,
          "old_text": "make_list(indices, \"\")",
          "new_text": null,
          "old_line_content": "           make_list(indices, \"\"));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 884,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->val->raw_name()",
          "new_text": null,
          "old_line_content": "           snode->ch[0]->node_type_name, stmt->val->raw_name());",
          "new_line_content": "    } else if (stmt->op_type == SNodeOpType::clear) {",
          "content_same": false
        },
        {
          "line": 886,
          "old_api": "clear",
          "new_api": null,
          "old_text": "emit(\"{}_tmp->clear();\", snode->node_type_name)",
          "new_text": null,
          "old_line_content": "      emit(\"{}_tmp->clear();\", snode->node_type_name);",
          "new_line_content": "    } else if (stmt->op_type == SNodeOpType::probe) {",
          "content_same": false
        },
        {
          "line": 888,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->raw_name()",
          "new_text": null,
          "old_line_content": "      emit(\"{} = {}_tmp->get_n();\", stmt->raw_name(), snode->node_type_name);",
          "new_line_content": "    } else if (stmt->op_type == SNodeOpType::activate) {",
          "content_same": false
        },
        {
          "line": 891,
          "old_api": "make_list",
          "new_api": null,
          "old_text": "make_list(indices, \"\")",
          "new_text": null,
          "old_line_content": "           make_list(indices, \"\"));",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 895,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"}}\")",
          "new_text": null,
          "old_line_content": "    emit(\"}}\");",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 899,
          "old_api": "stmt->ptr->as<GlobalPtrStmt>()",
          "new_api": null,
          "old_text": "stmt->ptr->as<GlobalPtrStmt>()",
          "new_text": null,
          "old_line_content": "    auto ptr = stmt->ptr->as<GlobalPtrStmt>();",
          "new_line_content": "    auto snode = ptr->snodes[0];",
          "content_same": false
        },
        {
          "line": 904,
          "old_api": "global_to_linearized_local",
          "new_api": null,
          "old_text": "pad.global_to_linearized_local(current_struct_for->loop_vars,\n                                          ptr->indices)",
          "new_text": null,
          "old_line_content": "           pad.global_to_linearized_local(current_struct_for->loop_vars,",
          "new_line_content": "                                          ptr->indices),",
          "content_same": false
        },
        {
          "line": 906,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->data->raw_name()",
          "new_text": null,
          "old_line_content": "           stmt->data->raw_name());",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 910,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->data->raw_name()",
          "new_text": null,
          "old_line_content": "           stmt->ptr->raw_name(), 0, stmt->data->raw_name());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 916,
          "old_api": "stmt->ptr->as<GlobalPtrStmt>()",
          "new_api": null,
          "old_text": "stmt->ptr->as<GlobalPtrStmt>()",
          "new_text": null,
          "old_line_content": "    auto ptr = stmt->ptr->as<GlobalPtrStmt>();",
          "new_line_content": "    auto snode = ptr->snodes[0];",
          "content_same": false
        },
        {
          "line": 921,
          "old_api": "global_to_linearized_local",
          "new_api": null,
          "old_text": "pad.global_to_linearized_local(current_struct_for->loop_vars,\n                                          ptr->indices)",
          "new_text": null,
          "old_line_content": "           pad.global_to_linearized_local(current_struct_for->loop_vars,",
          "new_line_content": "                                          ptr->indices));",
          "content_same": false
        },
        {
          "line": 925,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->ptr->raw_name()",
          "new_text": null,
          "old_line_content": "           stmt->ptr->raw_name());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 930,
          "old_api": "TC_ASSERT",
          "new_api": null,
          "old_text": "TC_ASSERT(stmt->val->ret_type.data_type == DataType::f32 ||\n              stmt->val->ret_type.data_type == DataType::i32)",
          "new_text": null,
          "old_line_content": "    TC_ASSERT(stmt->val->ret_type.data_type == DataType::f32 ||",
          "new_line_content": "              stmt->val->ret_type.data_type == DataType::i32);",
          "content_same": false
        },
        {
          "line": 933,
          "old_api": "stmt->dest->as<GlobalPtrStmt>()",
          "new_api": null,
          "old_text": "stmt->dest->as<GlobalPtrStmt>()",
          "new_text": null,
          "old_line_content": "    auto ptr = stmt->dest->as<GlobalPtrStmt>();",
          "new_line_content": "    auto snode = ptr->snodes[0];",
          "content_same": false
        },
        {
          "line": 425,
          "old_api": "reset_tails",
          "new_api": null,
          "old_text": "emit(\"Managers::get_allocator<{}>()->reset_tails();\", leaf->node_type_name)",
          "new_text": null,
          "old_line_content": "    emit(\"Managers::get_allocator<{}>()->reset_tails();\", leaf->node_type_name);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 938,
          "old_api": "global_to_linearized_local",
          "new_api": null,
          "old_text": "pad.global_to_linearized_local(current_struct_for->loop_vars,\n                                          ptr->indices)",
          "new_text": null,
          "old_line_content": "           pad.global_to_linearized_local(current_struct_for->loop_vars,",
          "new_line_content": "                                          ptr->indices),",
          "content_same": false
        },
        {
          "line": 427,
          "old_api": "start",
          "new_api": null,
          "old_text": "emit(R\"(GPUProfiler::get_instance().start(\"{}_list_gen\");)\",\n         codegen->func_name)",
          "new_text": null,
          "old_line_content": "    emit(R\"(GPUProfiler::get_instance().start(\"{}_list_gen\");)\",",
          "new_line_content": "         codegen->func_name);",
          "content_same": false
        },
        {
          "line": 940,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->val->raw_name()",
          "new_text": null,
          "old_line_content": "           stmt->val->raw_name());",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 429,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\n        \"{}_kernel_list_gen<<<Managers::get_allocator<{}>()->resident_tail, \"\n        \"{}>>>(context);\",\n        codegen->func_name, leaf->parent->node_type_name, block_division)",
          "new_text": null,
          "old_line_content": "    emit(",
          "new_line_content": "        \"{}_kernel_list_gen<<<Managers::get_allocator<{}>()->resident_tail, \"",
          "content_same": false
        },
        {
          "line": 943,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->val->raw_name()",
          "new_text": null,
          "old_line_content": "           stmt->val->raw_name());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 433,
          "old_api": "stop",
          "new_api": null,
          "old_text": "emit(R\"(GPUProfiler::get_instance().stop();)\")",
          "new_text": null,
          "old_line_content": "    emit(R\"(GPUProfiler::get_instance().stop();)\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"cudaDeviceSynchronize();\")",
          "new_text": null,
          "old_line_content": "    emit(\"cudaDeviceSynchronize();\");",
          "new_line_content": "    if (debug) {",
          "content_same": false
        },
        {
          "line": 949,
          "old_api": "serialize",
          "new_api": null,
          "old_text": "stmt->elements.serialize(\n             [](const VectorElement &elem) {\n               return fmt::format(\"{}[{}]\", elem.stmt->raw_name(), elem.index);\n             },\n             \"{\")",
          "new_text": null,
          "old_line_content": "         stmt->elements.serialize(",
          "new_line_content": "             [](const VectorElement &elem) {",
          "content_same": false
        },
        {
          "line": 951,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "elem.stmt->raw_name()",
          "new_text": null,
          "old_line_content": "               return fmt::format(\"{}[{}]\", elem.stmt->raw_name(), elem.index);",
          "new_line_content": "             },",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\n          R\"(printf(\"kernel {} <<<%d, %d>>> \", gridDim, blockDim);)\",\n          codegen->func_name)",
          "new_text": null,
          "old_line_content": "      emit(",
          "new_line_content": "          R\"(printf(\"kernel {} <<<%d, %d>>> \", gridDim, blockDim);)\",",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"cudaEvent_t start, stop;\")",
          "new_text": null,
          "old_line_content": "      emit(\"cudaEvent_t start, stop;\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 447,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"while(1) {{\")",
          "new_text": null,
          "old_line_content": "        emit(\"while(1) {{\");",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 963,
          "old_api": "raw_name",
          "new_api": null,
          "old_text": "stmt->input->raw_name()",
          "new_text": null,
          "old_line_content": "    emit(\"const auto {} = {};\", stmt->raw_name(), stmt->input->raw_name());",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 452,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"cudaEventRecord(start);\")",
          "new_text": null,
          "old_line_content": "      emit(\"cudaEventRecord(start);\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": "stop",
          "new_api": null,
          "old_text": "emit(R\"(GPUProfiler::get_instance().stop();)\")",
          "new_text": null,
          "old_line_content": "    emit(R\"(GPUProfiler::get_instance().stop();)\");",
          "new_line_content": "    if (debug) {",
          "content_same": false
        },
        {
          "line": 969,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"#endif\")",
          "new_text": null,
          "old_line_content": "    emit(\"#endif\");",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 459,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"cudaEventSynchronize(stop);\")",
          "new_text": null,
          "old_line_content": "      emit(\"cudaEventSynchronize(stop);\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(R\"(std::cout << \"     device only : \" << milliseconds << \" ms\\n\";)\")",
          "new_text": null,
          "old_line_content": "      emit(R\"(std::cout << \"     device only : \" << milliseconds << \" ms\\n\";)\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 976,
          "old_api": "irpass::print(ir)",
          "new_api": null,
          "old_text": "irpass::print(ir)",
          "new_text": null,
          "old_line_content": "    irpass::print(ir);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 979,
          "old_api": "irpass::re_id(ir)",
          "new_api": null,
          "old_text": "irpass::re_id(ir)",
          "new_text": null,
          "old_line_content": "  irpass::re_id(ir);",
          "new_line_content": "  if (prog->config.print_ir) {",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\n            \"printf(\\\"CUDA Error (File %s Ln %d): %s\\\\n\\\", \"\n            \"__FILE__, __LINE__, cudaGetErrorString(err));\")",
          "new_text": null,
          "old_line_content": "        emit(",
          "new_line_content": "            \"printf(\\\"CUDA Error (File %s Ln %d): %s\\\\n\\\", \"",
          "content_same": false
        },
        {
          "line": 981,
          "old_api": "irpass::print(ir)",
          "new_api": null,
          "old_text": "irpass::print(ir)",
          "new_text": null,
          "old_line_content": "    irpass::print(ir);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 984,
          "old_api": "irpass::re_id(ir)",
          "new_api": null,
          "old_text": "irpass::re_id(ir)",
          "new_text": null,
          "old_line_content": "  irpass::re_id(ir);",
          "new_line_content": "  if (prog->config.print_ir) {",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"}}\")",
          "new_text": null,
          "old_line_content": "        emit(\"}}\");",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 986,
          "old_api": "irpass::print(ir)",
          "new_api": null,
          "old_text": "irpass::print(ir)",
          "new_text": null,
          "old_line_content": "    irpass::print(ir);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"}}\")",
          "new_text": null,
          "old_line_content": "    emit(\"}}\");",
          "new_line_content": "    current_struct_for = nullptr;",
          "content_same": false
        },
        {
          "line": 989,
          "old_api": "irpass::re_id(ir)",
          "new_api": null,
          "old_text": "irpass::re_id(ir)",
          "new_text": null,
          "old_line_content": "  irpass::re_id(ir);",
          "new_line_content": "  if (prog->config.print_ir)",
          "content_same": false
        },
        {
          "line": 991,
          "old_api": "irpass::print(ir)",
          "new_api": null,
          "old_text": "irpass::print(ir)",
          "new_text": null,
          "old_line_content": "    irpass::print(ir);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": "bit::log2int(block_size)",
          "new_api": null,
          "old_text": "bit::log2int(block_size)",
          "new_text": null,
          "old_line_content": "    auto block_bits = bit::log2int(block_size);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 996,
          "old_api": "generate_header",
          "new_api": null,
          "old_text": "generate_header()",
          "new_text": null,
          "old_line_content": "  generate_header();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 999,
          "old_api": "GPUIRCodeGen::run(this, kernel->ir)",
          "new_api": null,
          "old_text": "GPUIRCodeGen::run(this, kernel->ir)",
          "new_text": null,
          "old_line_content": "  GPUIRCodeGen::run(this, kernel->ir);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "path.push_back(p)",
          "new_text": null,
          "old_line_content": "      path.push_back(p);",
          "new_line_content": "      if (p->type == SNodeType::pointer) {",
          "content_same": false
        },
        {
          "line": 1002,
          "old_api": "generate_tail",
          "new_api": null,
          "old_text": "generate_tail()",
          "new_text": null,
          "old_line_content": "  generate_tail();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 497,
          "old_api": "TC_ASSERT",
          "new_api": null,
          "old_text": "TC_ASSERT(first_managed_ancestor)",
          "new_text": null,
          "old_line_content": "    TC_ASSERT(first_managed_ancestor);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 499,
          "old_api": "fmt::format(\n        \"Managers::get<{}>()\", first_managed_ancestor->node_type_name)",
          "new_api": null,
          "old_text": "fmt::format(\n        \"Managers::get<{}>()\", first_managed_ancestor->node_type_name)",
          "new_text": null,
          "old_line_content": "    auto ancestor_allocator = fmt::format(",
          "new_line_content": "        \"Managers::get<{}>()\", first_managed_ancestor->node_type_name);",
          "content_same": false
        },
        {
          "line": 502,
          "old_api": "fmt::format(\"Managers::get_allocator<{}>()\", snode->node_type_name)",
          "new_api": null,
          "old_text": "fmt::format(\"Managers::get_allocator<{}>()\", snode->node_type_name)",
          "new_text": null,
          "old_line_content": "        fmt::format(\"Managers::get_allocator<{}>()\", snode->node_type_name);",
          "new_line_content": "    // emit(\"{}->reset_tails();\", leaf_allocator);",
          "content_same": false
        },
        {
          "line": 505,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"\")",
          "new_text": null,
          "old_line_content": "    emit(\"\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": "emit",
          "new_api": null,
          "old_text": "emit(\"__global__ void {}_kernel_list_gen(Context context) {{\",\n         codegen->func_name)",
          "new_text": null,
          "old_line_content": "    emit(\"__global__ void {}_kernel_list_gen(Context context) {{\",",
          "new_line_content": "         codegen->func_name);",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 56,
      "total_additions": 134,
      "total_deletions": 135,
      "total_api_changes": 325
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 6,
        "api_related_lines": 325,
        "non_api_lines": 3,
        "non_api_line_numbers": [
          435,
          437,
          438
        ]
      }
    },
    "api_calls_before": 479,
    "api_calls_after": 478,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 5,
      "total_diff_lines": 30
    }
  }
}