{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/410bed2ab8c3864d7f34f9694d080adcaf446352",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/410bed2ab8c3864d7f34f9694d080adcaf446352/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/410bed2ab8c3864d7f34f9694d080adcaf446352/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/410bed2ab8c3864d7f34f9694d080adcaf446352/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 436,
          "old_api": "PG_GETARG_POINTER",
          "new_api": "PG_RETURN_BOOL",
          "old_text": "PG_GETARG_POINTER(0)",
          "new_text": "PG_RETURN_BOOL(res)",
          "old_line_content": "\tGISTENTRY  *entry = (GISTENTRY *) PG_GETARG_POINTER(0);",
          "new_line_content": "\tPG_RETURN_BOOL(res);",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": "VARSIZE",
          "new_api": "PG_GETARG_UINT16",
          "old_text": "VARSIZE(query)",
          "new_text": "PG_GETARG_UINT16(2)",
          "old_line_content": "\tSize\t\tquerysize = VARSIZE(query);",
          "new_line_content": "\tStrategyNumber strategy = (StrategyNumber) PG_GETARG_UINT16(2);",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": "MemoryContextAlloc",
          "new_api": "memcmp",
          "old_text": "MemoryContextAlloc(fcinfo->flinfo->fn_mcxt,\n\t\t\t\t\t\t\t\t\t  MAXALIGN(querysize) +\n\t\t\t\t\t\t\t\t\t  VARSIZE(qtrg))",
          "new_text": "memcmp(cache, query, querysize)",
          "old_line_content": "\t\tnewcache = MemoryContextAlloc(fcinfo->flinfo->fn_mcxt,",
          "new_line_content": "\t\tmemcmp(cache, query, querysize) != 0)",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": "memcpy",
          "new_api": "VARDATA",
          "old_text": "memcpy(newcache, query, querysize)",
          "new_text": "VARDATA(query)",
          "old_line_content": "\t\tmemcpy(newcache, query, querysize);",
          "new_line_content": "\t\tqtrg = generate_trgm(VARDATA(query), querysize - VARHDRSZ);",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": "pfree",
          "new_api": "VARSIZE",
          "old_text": "pfree(cache)",
          "new_text": "VARSIZE(qtrg)",
          "old_line_content": "\t\t\tpfree(cache);",
          "new_line_content": "\t\t\t\t\t\t\t\t\t  VARSIZE(qtrg));",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": "GETSIGN",
          "new_api": "ISALLTRUE",
          "old_text": "GETSIGN(key)",
          "new_text": "ISALLTRUE(key)",
          "old_line_content": "\t\t\t\tint32\t\tcount = cnt_sml_sign_common(qtrg, GETSIGN(key));",
          "new_line_content": "\t\t\telse if (ISALLTRUE(key))",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": "elog",
          "new_api": "ARRNELEM",
          "old_text": "elog(ERROR, \"unrecognized strategy number: %d\", strategy)",
          "new_text": "ARRNELEM(qtrg)",
          "old_line_content": "\t\t\telog(ERROR, \"unrecognized strategy number: %d\", strategy);",
          "new_line_content": "\t\t\t\tint32\t\tlen = ARRNELEM(qtrg);",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": "HASH",
          "new_api": "GETARR",
          "old_text": "HASH(sbase, tmp)",
          "new_text": "GETARR(add)",
          "old_line_content": "\t\t\tHASH(sbase, tmp);",
          "new_line_content": "\t\ttrgm\t   *ptr = GETARR(add);",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": "MemSet",
          "new_api": "PG_GETARG_POINTER",
          "old_text": "MemSet((void *) base, 0, sizeof(BITVEC))",
          "new_text": "PG_GETARG_POINTER(1)",
          "old_line_content": "\tMemSet((void *) base, 0, sizeof(BITVEC));",
          "new_line_content": "\tint\t\t   *size = (int *) PG_GETARG_POINTER(1);",
          "content_same": false
        },
        {
          "line": 561,
          "old_api": "PG_RETURN_POINTER",
          "new_api": "SET_VARSIZE",
          "old_text": "PG_RETURN_POINTER(result)",
          "new_text": "SET_VARSIZE(result, len)",
          "old_line_content": "\tPG_RETURN_POINTER(result);",
          "new_line_content": "\tSET_VARSIZE(result, len);",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": "PG_GETARG_POINTER",
          "new_api": "PG_RETURN_POINTER",
          "old_text": "PG_GETARG_POINTER(0)",
          "new_text": "PG_RETURN_POINTER(result)",
          "old_line_content": "\tTRGM\t   *a = (TRGM *) PG_GETARG_POINTER(0);",
          "new_line_content": "\tPG_RETURN_POINTER(result);",
          "content_same": false
        },
        {
          "line": 573,
          "old_api": "ISALLTRUE",
          "new_api": "PG_GETARG_POINTER",
          "old_text": "ISALLTRUE(b)",
          "new_text": "PG_GETARG_POINTER(0)",
          "old_line_content": "\t\tif (ISALLTRUE(a) && ISALLTRUE(b))",
          "new_line_content": "\tTRGM\t   *a = (TRGM *) PG_GETARG_POINTER(0);",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": "ISALLTRUE",
          "new_api": "PG_GETARG_POINTER",
          "old_text": "ISALLTRUE(a)",
          "new_text": "PG_GETARG_POINTER(2)",
          "old_line_content": "\t\telse if (ISALLTRUE(a))",
          "new_line_content": "\tbool\t   *result = (bool *) PG_GETARG_POINTER(2);",
          "content_same": false
        },
        {
          "line": 577,
          "old_api": "ISALLTRUE",
          "new_api": "ISSIGNKEY",
          "old_text": "ISALLTRUE(b)",
          "new_text": "ISSIGNKEY(a)",
          "old_line_content": "\t\telse if (ISALLTRUE(b))",
          "new_line_content": "\tif (ISSIGNKEY(a))",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": "GETSIGN",
          "new_api": "ISALLTRUE",
          "old_text": "GETSIGN(b)",
          "new_text": "ISALLTRUE(b)",
          "old_line_content": "\t\t\t\t\t\tsb = GETSIGN(b);",
          "new_line_content": "\t\telse if (ISALLTRUE(b))",
          "content_same": false
        },
        {
          "line": 588,
          "old_api": "if (sa[i] != sb[i])",
          "new_api": "GETSIGN",
          "old_text": "if (sa[i] != sb[i])",
          "new_text": "GETSIGN(a)",
          "old_line_content": "\t\t\t\tif (sa[i] != sb[i])",
          "new_line_content": "\t\t\tBITVECP\t\tsa = GETSIGN(a),",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": "GETARR",
          "new_api": "ARRNELEM",
          "old_text": "GETARR(a)",
          "new_text": "ARRNELEM(b)",
          "old_line_content": "\t\t\ttrgm\t   *ptra = GETARR(a),",
          "new_line_content": "\t\t\t\t\tlenb = ARRNELEM(b);",
          "content_same": false
        },
        {
          "line": 611,
          "old_api": "CMPTRGM",
          "new_api": "GETARR",
          "old_text": "CMPTRGM(ptra + i, ptrb + i)",
          "new_text": "GETARR(a)",
          "old_line_content": "\t\t\t\tif (CMPTRGM(ptra + i, ptrb + i))",
          "new_line_content": "\t\t\ttrgm\t   *ptra = GETARR(a),",
          "content_same": false
        },
        {
          "line": 659,
          "old_api": "GETSIGN",
          "new_api": "ISALLTRUE",
          "old_text": "GETSIGN(a)",
          "new_text": "ISALLTRUE(b)",
          "old_line_content": "\t\treturn SIGLENBIT - sizebitvec(GETSIGN(a));",
          "new_line_content": "\t\tif (ISALLTRUE(b))",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": "PG_GETARG_POINTER",
          "new_api": "GETSIGN",
          "old_text": "PG_GETARG_POINTER(0)",
          "new_text": "GETSIGN(b)",
          "old_line_content": "\tGISTENTRY  *origentry = (GISTENTRY *) PG_GETARG_POINTER(0); /* always ISSIGNKEY */",
          "new_line_content": "\treturn hemdistsign(GETSIGN(a), GETSIGN(b));",
          "content_same": false
        },
        {
          "line": 676,
          "old_api": "ISARRKEY",
          "new_api": "DatumGetPointer",
          "old_text": "ISARRKEY(newval)",
          "new_text": "DatumGetPointer(origentry->key)",
          "old_line_content": "\tif (ISARRKEY(newval))",
          "new_line_content": "\tTRGM\t   *origval = (TRGM *) DatumGetPointer(origentry->key);",
          "content_same": false
        },
        {
          "line": 693,
          "old_api": "MAXALIGN",
          "new_api": "VARSIZE",
          "old_text": "MAXALIGN(sizeof(BITVEC))",
          "new_text": "VARSIZE(cachedVal)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t  MAXALIGN(sizeof(BITVEC)) +",
          "new_line_content": "\t\t\tVARSIZE(cachedVal) != newvalsize ||",
          "content_same": false
        },
        {
          "line": 698,
          "old_api": "MAXALIGN",
          "new_api": "MemoryContextAlloc",
          "old_text": "MAXALIGN(sizeof(BITVEC))",
          "new_text": "MemoryContextAlloc(fcinfo->flinfo->fn_mcxt,\n\t\t\t\t\t\t\t\t\t\t  MAXALIGN(sizeof(BITVEC)) +\n\t\t\t\t\t\t\t\t\t\t  newvalsize)",
          "old_line_content": "\t\t\tcachedVal = (TRGM *) (newcache + MAXALIGN(sizeof(BITVEC)));",
          "new_line_content": "\t\t\tnewcache = MemoryContextAlloc(fcinfo->flinfo->fn_mcxt,",
          "content_same": false
        },
        {
          "line": 699,
          "old_api": "memcpy",
          "new_api": "MAXALIGN",
          "old_text": "memcpy(cachedVal, newval, newvalsize)",
          "new_text": "MAXALIGN(sizeof(BITVEC))",
          "old_line_content": "\t\t\tmemcpy(cachedVal, newval, newvalsize);",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t  MAXALIGN(sizeof(BITVEC)) +",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": "pfree",
          "new_api": "makesign",
          "old_text": "pfree(cache)",
          "new_text": "makesign((BITVECP) newcache, newval)",
          "old_line_content": "\t\t\t\tpfree(cache);",
          "new_line_content": "\t\t\tmakesign((BITVECP) newcache, newval);",
          "content_same": false
        },
        {
          "line": 715,
          "old_api": "hemdist",
          "new_api": "ISALLTRUE",
          "old_text": "hemdist(origval, newval)",
          "new_text": "ISALLTRUE(origval)",
          "old_line_content": "\t\t*penalty = hemdist(origval, newval);",
          "new_line_content": "\t\tif (ISALLTRUE(origval))",
          "content_same": false
        },
        {
          "line": 716,
          "old_api": "PG_RETURN_POINTER",
          "new_api": "sizebitvec",
          "old_text": "PG_RETURN_POINTER(penalty)",
          "new_text": "sizebitvec(sign)",
          "old_line_content": "\tPG_RETURN_POINTER(penalty);",
          "new_line_content": "\t\t\t*penalty = ((float) (SIGLENBIT - sizebitvec(sign))) / (float) (SIGLENBIT + 1);",
          "content_same": false
        },
        {
          "line": 773,
          "old_api": "PG_GETARG_POINTER",
          "new_api": "hemdistsign",
          "old_text": "PG_GETARG_POINTER(0)",
          "new_text": "hemdistsign(a->sign, b->sign)",
          "old_line_content": "\tGistEntryVector *entryvec = (GistEntryVector *) PG_GETARG_POINTER(0);",
          "new_line_content": "\treturn hemdistsign(a->sign, b->sign);",
          "content_same": false
        },
        {
          "line": 858,
          "old_api": "GETSIGN",
          "new_api": "CALCGTSIZE",
          "old_text": "GETSIGN(datum_l)",
          "new_text": "CALCGTSIZE(SIGNKEY, 0)",
          "old_line_content": "\tunion_l = GETSIGN(datum_l);",
          "new_line_content": "\t\tdatum_r = (TRGM *) palloc(CALCGTSIZE(SIGNKEY, 0));",
          "content_same": false
        },
        {
          "line": 859,
          "old_api": "GETSIGN",
          "new_api": "CALCGTSIZE",
          "old_text": "GETSIGN(datum_r)",
          "new_text": "CALCGTSIZE(SIGNKEY, 0)",
          "old_line_content": "\tunion_r = GETSIGN(datum_r);",
          "new_line_content": "\t\tSET_VARSIZE(datum_r, CALCGTSIZE(SIGNKEY, 0));",
          "content_same": false
        },
        {
          "line": 861,
          "old_api": "GETENTRY",
          "new_api": "GETSIGN",
          "old_text": "GETENTRY(entryvec, maxoff)",
          "new_text": "GETSIGN(datum_r)",
          "old_line_content": "\tfillcache(&cache[maxoff], GETENTRY(entryvec, maxoff));",
          "new_line_content": "\t\tmemcpy((void *) GETSIGN(datum_r), (void *) cache[seed_2].sign, sizeof(BITVEC));",
          "content_same": false
        },
        {
          "line": 864,
          "old_api": "OffsetNumberNext",
          "new_api": "GETSIGN",
          "old_text": "OffsetNumberNext(j)",
          "new_text": "GETSIGN(datum_l)",
          "old_line_content": "\tfor (j = FirstOffsetNumber; j <= maxoff; j = OffsetNumberNext(j))",
          "new_line_content": "\tunion_l = GETSIGN(datum_l);",
          "content_same": false
        },
        {
          "line": 867,
          "old_api": "hemdistcache",
          "new_api": "GETENTRY",
          "old_text": "hemdistcache(&(cache[seed_1]), &(cache[j]))",
          "new_text": "GETENTRY(entryvec, maxoff)",
          "old_line_content": "\t\tsize_alpha = hemdistcache(&(cache[seed_1]), &(cache[j]));",
          "new_line_content": "\tfillcache(&cache[maxoff], GETENTRY(entryvec, maxoff));",
          "content_same": false
        },
        {
          "line": 869,
          "old_api": "abs",
          "new_api": "palloc",
          "old_text": "abs(size_alpha - size_beta)",
          "new_text": "palloc(sizeof(SPLITCOST) * maxoff)",
          "old_line_content": "\t\tcostvector[j - 1].cost = abs(size_alpha - size_beta);",
          "new_line_content": "\tcostvector = (SPLITCOST *) palloc(sizeof(SPLITCOST) * maxoff);",
          "content_same": false
        },
        {
          "line": 895,
          "old_api": "GETSIGN",
          "new_api": "ISALLTRUE",
          "old_text": "GETSIGN(cache[j].sign)",
          "new_text": "ISALLTRUE(datum_l)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t\t(cache[j].allistrue) ? GETSIGN(datum_l) : GETSIGN(cache[j].sign)",
          "new_line_content": "\t\tif (ISALLTRUE(datum_l) || cache[j].allistrue)",
          "content_same": false
        },
        {
          "line": 901,
          "old_api": "ISALLTRUE",
          "new_api": "GETSIGN",
          "old_text": "ISALLTRUE(datum_r)",
          "new_text": "GETSIGN(cache[j].sign)",
          "old_line_content": "\t\tif (ISALLTRUE(datum_r) || cache[j].allistrue)",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t\t(cache[j].allistrue) ? GETSIGN(datum_l) : GETSIGN(cache[j].sign)",
          "content_same": false
        },
        {
          "line": 907,
          "old_api": "GETSIGN",
          "new_api": "ISALLTRUE",
          "old_text": "GETSIGN(cache[j].sign)",
          "new_text": "ISALLTRUE(datum_r)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t   (cache[j].allistrue) ? GETSIGN(datum_r) : GETSIGN(cache[j].sign)",
          "new_line_content": "\t\tif (ISALLTRUE(datum_r) || cache[j].allistrue)",
          "content_same": false
        },
        {
          "line": 913,
          "old_api": "WISH_F",
          "new_api": "GETSIGN",
          "old_text": "WISH_F(v->spl_nleft, v->spl_nright, 0.1)",
          "new_text": "GETSIGN(cache[j].sign)",
          "old_line_content": "\t\tif (size_alpha < size_beta + WISH_F(v->spl_nleft, v->spl_nright, 0.1))",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t   (cache[j].allistrue) ? GETSIGN(datum_r) : GETSIGN(cache[j].sign)",
          "content_same": false
        },
        {
          "line": 917,
          "old_api": "ISALLTRUE",
          "new_api": "GETSIGN",
          "old_text": "ISALLTRUE(datum_l)",
          "new_text": "GETSIGN(datum_r)",
          "old_line_content": "\t\t\t\tif (!ISALLTRUE(datum_l))",
          "new_line_content": "\t\t\tsize_beta = hemdistsign(cache[j].sign, GETSIGN(datum_r));",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 512,
          "old_api": null,
          "new_api": "ISSIGNKEY",
          "old_text": null,
          "new_text": "ISSIGNKEY(add)",
          "old_line_content": "",
          "new_line_content": "\tif (ISSIGNKEY(add))",
          "content_same": false
        },
        {
          "line": 514,
          "old_api": null,
          "new_api": "GETSIGN",
          "old_text": null,
          "new_text": "GETSIGN(add)",
          "old_line_content": "\t\t\tsbase[i] |= sadd[i];",
          "new_line_content": "\t\tBITVECP\t\tsadd = GETSIGN(add);",
          "content_same": false
        },
        {
          "line": 516,
          "old_api": null,
          "new_api": "ISALLTRUE",
          "old_text": null,
          "new_text": "ISALLTRUE(add)",
          "old_line_content": "\telse",
          "new_line_content": "\t\tif (ISALLTRUE(add))",
          "content_same": false
        },
        {
          "line": 527,
          "old_api": null,
          "new_api": "ARRNELEM",
          "old_text": null,
          "new_text": "ARRNELEM(add)",
          "old_line_content": "\treturn 0;",
          "new_line_content": "\t\tfor (i = 0; i < ARRNELEM(add); i++)",
          "content_same": false
        },
        {
          "line": 529,
          "old_api": null,
          "new_api": "CPTRGM",
          "old_text": null,
          "new_text": "CPTRGM(((char *) &tmp), ptr + i)",
          "old_line_content": "",
          "new_line_content": "\t\t\tCPTRGM(((char *) &tmp), ptr + i);",
          "content_same": false
        },
        {
          "line": 530,
          "old_api": null,
          "new_api": "HASH",
          "old_text": null,
          "new_text": "HASH(sbase, tmp)",
          "old_line_content": "",
          "new_line_content": "\t\t\tHASH(sbase, tmp);",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": null,
          "new_api": "PG_GETARG_POINTER",
          "old_text": null,
          "new_text": "PG_GETARG_POINTER(0)",
          "old_line_content": "\tTRGM\t   *result;",
          "new_line_content": "\tGistEntryVector *entryvec = (GistEntryVector *) PG_GETARG_POINTER(0);",
          "content_same": false
        },
        {
          "line": 548,
          "old_api": null,
          "new_api": "MemSet",
          "old_text": null,
          "new_text": "MemSet((void *) base, 0, sizeof(BITVEC))",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\tMemSet((void *) base, 0, sizeof(BITVEC));",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": null,
          "new_api": "GETENTRY",
          "old_text": null,
          "new_text": "GETENTRY(entryvec, i)",
          "old_line_content": "",
          "new_line_content": "\t\tif (unionkey(base, GETENTRY(entryvec, i)))",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": null,
          "new_api": "CALCGTSIZE",
          "old_text": null,
          "new_text": "CALCGTSIZE(flag, 0)",
          "old_line_content": "\t*size = len;",
          "new_line_content": "\tlen = CALCGTSIZE(flag, 0);",
          "content_same": false
        },
        {
          "line": 560,
          "old_api": null,
          "new_api": "palloc",
          "old_text": null,
          "new_text": "palloc(len)",
          "old_line_content": "",
          "new_line_content": "\tresult = (TRGM *) palloc(len);",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": null,
          "new_api": "ISALLTRUE",
          "old_text": null,
          "new_text": "ISALLTRUE(result)",
          "old_line_content": "",
          "new_line_content": "\tif (!ISALLTRUE(result))",
          "content_same": false
        },
        {
          "line": 564,
          "old_api": null,
          "new_api": "GETSIGN",
          "old_text": null,
          "new_text": "GETSIGN(result)",
          "old_line_content": "Datum",
          "new_line_content": "\t\tmemcpy((void *) GETSIGN(result), (void *) base, sizeof(BITVEC));",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": null,
          "new_api": "PG_GETARG_POINTER",
          "old_text": null,
          "new_text": "PG_GETARG_POINTER(1)",
          "old_line_content": "\t\t\t*result = true;",
          "new_line_content": "\tTRGM\t   *b = (TRGM *) PG_GETARG_POINTER(1);",
          "content_same": false
        },
        {
          "line": 579,
          "old_api": null,
          "new_api": "ISALLTRUE",
          "old_text": null,
          "new_text": "ISALLTRUE(b)",
          "old_line_content": "\t\telse",
          "new_line_content": "\t\tif (ISALLTRUE(a) && ISALLTRUE(b))",
          "content_same": false
        },
        {
          "line": 581,
          "old_api": null,
          "new_api": "ISALLTRUE",
          "old_text": null,
          "new_text": "ISALLTRUE(a)",
          "old_line_content": "\t\t\tint32\t\ti;",
          "new_line_content": "\t\telse if (ISALLTRUE(a))",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": null,
          "new_api": "GETSIGN",
          "old_text": null,
          "new_text": "GETSIGN(b)",
          "old_line_content": "\t\t\t\t{",
          "new_line_content": "\t\t\t\t\t\tsb = GETSIGN(b);",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": null,
          "new_api": "if (sa[i] != sb[i])",
          "old_text": null,
          "new_text": "if (sa[i] != sb[i])",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\tif (sa[i] != sb[i])",
          "content_same": false
        },
        {
          "line": 604,
          "old_api": null,
          "new_api": "ARRNELEM",
          "old_text": null,
          "new_text": "ARRNELEM(a)",
          "old_line_content": "\t\t{",
          "new_line_content": "\t\tint32\t\tlena = ARRNELEM(a),",
          "content_same": false
        },
        {
          "line": 612,
          "old_api": null,
          "new_api": "GETARR",
          "old_text": null,
          "new_text": "GETARR(b)",
          "old_line_content": "\t\t\t\t{",
          "new_line_content": "\t\t\t\t\t   *ptrb = GETARR(b);",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": null,
          "new_api": "CMPTRGM",
          "old_text": null,
          "new_text": "CMPTRGM(ptra + i, ptrb + i)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\t\tif (CMPTRGM(ptra + i, ptrb + i))",
          "content_same": false
        },
        {
          "line": 625,
          "old_api": null,
          "new_api": "PG_RETURN_POINTER",
          "old_text": null,
          "new_text": "PG_RETURN_POINTER(result)",
          "old_line_content": "\tint32\t\tsize = 0,",
          "new_line_content": "\tPG_RETURN_POINTER(result);",
          "content_same": false
        },
        {
          "line": 657,
          "old_api": null,
          "new_api": "ISALLTRUE",
          "old_text": null,
          "new_text": "ISALLTRUE(a)",
          "old_line_content": "\t}",
          "new_line_content": "\tif (ISALLTRUE(a))",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": null,
          "new_api": "GETSIGN",
          "old_text": null,
          "new_text": "GETSIGN(b)",
          "old_line_content": "}",
          "new_line_content": "\t\t\treturn SIGLENBIT - sizebitvec(GETSIGN(b));",
          "content_same": false
        },
        {
          "line": 664,
          "old_api": null,
          "new_api": "ISALLTRUE",
          "old_text": null,
          "new_text": "ISALLTRUE(b)",
          "old_line_content": "Datum",
          "new_line_content": "\telse if (ISALLTRUE(b))",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": null,
          "new_api": "GETSIGN",
          "old_text": null,
          "new_text": "GETSIGN(a)",
          "old_line_content": "gtrgm_penalty(PG_FUNCTION_ARGS)",
          "new_line_content": "\t\treturn SIGLENBIT - sizebitvec(GETSIGN(a));",
          "content_same": false
        },
        {
          "line": 673,
          "old_api": null,
          "new_api": "PG_GETARG_POINTER",
          "old_text": null,
          "new_text": "PG_GETARG_POINTER(0)",
          "old_line_content": "",
          "new_line_content": "\tGISTENTRY  *origentry = (GISTENTRY *) PG_GETARG_POINTER(0); /* always ISSIGNKEY */",
          "content_same": false
        },
        {
          "line": 674,
          "old_api": null,
          "new_api": "PG_GETARG_POINTER",
          "old_text": null,
          "new_text": "PG_GETARG_POINTER(1)",
          "old_line_content": "\t*penalty = 0.0;",
          "new_line_content": "\tGISTENTRY  *newentry = (GISTENTRY *) PG_GETARG_POINTER(1);",
          "content_same": false
        },
        {
          "line": 675,
          "old_api": null,
          "new_api": "PG_GETARG_POINTER",
          "old_text": null,
          "new_text": "PG_GETARG_POINTER(2)",
          "old_line_content": "",
          "new_line_content": "\tfloat\t   *penalty = (float *) PG_GETARG_POINTER(2);",
          "content_same": false
        },
        {
          "line": 677,
          "old_api": null,
          "new_api": "DatumGetPointer",
          "old_text": null,
          "new_text": "DatumGetPointer(newentry->key)",
          "old_line_content": "\t{",
          "new_line_content": "\tTRGM\t   *newval = (TRGM *) DatumGetPointer(newentry->key);",
          "content_same": false
        },
        {
          "line": 678,
          "old_api": null,
          "new_api": "GETSIGN",
          "old_text": null,
          "new_text": "GETSIGN(origval)",
          "old_line_content": "\t\tchar\t   *cache = (char *) fcinfo->flinfo->fn_extra;",
          "new_line_content": "\tBITVECP\t\torig = GETSIGN(origval);",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": null,
          "new_api": "ISARRKEY",
          "old_text": null,
          "new_text": "ISARRKEY(newval)",
          "old_line_content": "",
          "new_line_content": "\tif (ISARRKEY(newval))",
          "content_same": false
        },
        {
          "line": 685,
          "old_api": null,
          "new_api": "MAXALIGN",
          "old_text": null,
          "new_text": "MAXALIGN(sizeof(BITVEC))",
          "old_line_content": "\t\t */",
          "new_line_content": "\t\tTRGM\t   *cachedVal = (TRGM *) (cache + MAXALIGN(sizeof(BITVEC)));",
          "content_same": false
        },
        {
          "line": 686,
          "old_api": null,
          "new_api": "VARSIZE",
          "old_text": null,
          "new_text": "VARSIZE(newval)",
          "old_line_content": "\t\tif (cache == NULL ||",
          "new_line_content": "\t\tSize\t\tnewvalsize = VARSIZE(newval);",
          "content_same": false
        },
        {
          "line": 694,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(cachedVal, newval, newvalsize)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t  newvalsize);",
          "new_line_content": "\t\t\tmemcmp(cachedVal, newval, newvalsize) != 0)",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": null,
          "new_api": "MAXALIGN",
          "old_text": null,
          "new_text": "MAXALIGN(sizeof(BITVEC))",
          "old_line_content": "\t\t\tcache = newcache;",
          "new_line_content": "\t\t\tcachedVal = (TRGM *) (newcache + MAXALIGN(sizeof(BITVEC)));",
          "content_same": false
        },
        {
          "line": 705,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(cachedVal, newval, newvalsize)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tmemcpy(cachedVal, newval, newvalsize);",
          "content_same": false
        },
        {
          "line": 708,
          "old_api": null,
          "new_api": "pfree",
          "old_text": null,
          "new_text": "pfree(cache)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tpfree(cache);",
          "content_same": false
        },
        {
          "line": 718,
          "old_api": null,
          "new_api": "hemdistsign",
          "old_text": null,
          "new_text": "hemdistsign(sign, orig)",
          "old_line_content": "",
          "new_line_content": "\t\t\t*penalty = hemdistsign(sign, orig);",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": null,
          "new_api": "hemdist",
          "old_text": null,
          "new_text": "hemdist(origval, newval)",
          "old_line_content": "\tbool\t\tallistrue;",
          "new_line_content": "\t\t*penalty = hemdist(origval, newval);",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": null,
          "new_api": "PG_RETURN_POINTER",
          "old_text": null,
          "new_text": "PG_RETURN_POINTER(penalty)",
          "old_line_content": "\tBITVEC\t\tsign;",
          "new_line_content": "\tPG_RETURN_POINTER(penalty);",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": null,
          "new_api": "ISARRKEY",
          "old_text": null,
          "new_text": "ISARRKEY(key)",
          "old_line_content": "}",
          "new_line_content": "\tif (ISARRKEY(key))",
          "content_same": false
        },
        {
          "line": 736,
          "old_api": null,
          "new_api": "makesign",
          "old_text": null,
          "new_text": "makesign(item->sign, key)",
          "old_line_content": "",
          "new_line_content": "\t\tmakesign(item->sign, key);",
          "content_same": false
        },
        {
          "line": 737,
          "old_api": null,
          "new_api": "ISALLTRUE",
          "old_text": null,
          "new_text": "ISALLTRUE(key)",
          "old_line_content": "#define WISH_F(a,b,c) (double)( -(double)(((a)-(b))*((a)-(b))*((a)-(b)))*(c) )",
          "new_line_content": "\telse if (ISALLTRUE(key))",
          "content_same": false
        },
        {
          "line": 740,
          "old_api": null,
          "new_api": "GETSIGN",
          "old_text": null,
          "new_text": "GETSIGN(key)",
          "old_line_content": "\tOffsetNumber pos;",
          "new_line_content": "\t\tmemcpy((void *) item->sign, (void *) GETSIGN(key), sizeof(BITVEC));",
          "content_same": false
        },
        {
          "line": 768,
          "old_api": null,
          "new_api": "sizebitvec",
          "old_text": null,
          "new_text": "sizebitvec(b->sign)",
          "old_line_content": "}",
          "new_line_content": "\t\t\treturn SIGLENBIT - sizebitvec(b->sign);",
          "content_same": false
        },
        {
          "line": 771,
          "old_api": null,
          "new_api": "sizebitvec",
          "old_text": null,
          "new_text": "sizebitvec(a->sign)",
          "old_line_content": "gtrgm_picksplit(PG_FUNCTION_ARGS)",
          "new_line_content": "\t\treturn SIGLENBIT - sizebitvec(a->sign);",
          "content_same": false
        },
        {
          "line": 779,
          "old_api": null,
          "new_api": "PG_GETARG_POINTER",
          "old_text": null,
          "new_text": "PG_GETARG_POINTER(0)",
          "old_line_content": "\t\t\t   *datum_r;",
          "new_line_content": "\tGistEntryVector *entryvec = (GistEntryVector *) PG_GETARG_POINTER(0);",
          "content_same": false
        },
        {
          "line": 781,
          "old_api": null,
          "new_api": "PG_GETARG_POINTER",
          "old_text": null,
          "new_text": "PG_GETARG_POINTER(1)",
          "old_line_content": "\t\t\t\tunion_r;",
          "new_line_content": "\tGIST_SPLITVEC *v = (GIST_SPLITVEC *) PG_GETARG_POINTER(1);",
          "content_same": false
        },
        {
          "line": 803,
          "old_api": null,
          "new_api": "palloc",
          "old_text": null,
          "new_text": "palloc(sizeof(CACHESIGN) * (maxoff + 2))",
          "old_line_content": "\t{",
          "new_line_content": "\tcache = (CACHESIGN *) palloc(sizeof(CACHESIGN) * (maxoff + 2));",
          "content_same": false
        },
        {
          "line": 805,
          "old_api": null,
          "new_api": "GETENTRY",
          "old_text": null,
          "new_text": "GETENTRY(entryvec, k)",
          "old_line_content": "\t\t{",
          "new_line_content": "\t\tfillcache(&cache[k], GETENTRY(entryvec, k));",
          "content_same": false
        },
        {
          "line": 808,
          "old_api": null,
          "new_api": "OffsetNumberNext",
          "old_text": null,
          "new_text": "OffsetNumberNext(k)",
          "old_line_content": "\t\t\t{",
          "new_line_content": "\tfor (k = FirstOffsetNumber; k < maxoff; k = OffsetNumberNext(k))",
          "content_same": false
        },
        {
          "line": 810,
          "old_api": null,
          "new_api": "OffsetNumberNext",
          "old_text": null,
          "new_text": "OffsetNumberNext(j)",
          "old_line_content": "\t\t\t\tseed_1 = k;",
          "new_line_content": "\t\tfor (j = OffsetNumberNext(k); j <= maxoff; j = OffsetNumberNext(j))",
          "content_same": false
        },
        {
          "line": 812,
          "old_api": null,
          "new_api": "hemdistcache",
          "old_text": null,
          "new_text": "hemdistcache(&(cache[j]), &(cache[k]))",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\tsize_waste = hemdistcache(&(cache[j]), &(cache[k]));",
          "content_same": false
        },
        {
          "line": 831,
          "old_api": null,
          "new_api": "palloc",
          "old_text": null,
          "new_text": "palloc(nbytes)",
          "old_line_content": "\tif (cache[seed_1].allistrue)",
          "new_line_content": "\tv->spl_left = left = (OffsetNumber *) palloc(nbytes);",
          "content_same": false
        },
        {
          "line": 832,
          "old_api": null,
          "new_api": "palloc",
          "old_text": null,
          "new_text": "palloc(nbytes)",
          "old_line_content": "\t{",
          "new_line_content": "\tv->spl_right = right = (OffsetNumber *) palloc(nbytes);",
          "content_same": false
        },
        {
          "line": 845,
          "old_api": null,
          "new_api": "CALCGTSIZE",
          "old_text": null,
          "new_text": "CALCGTSIZE(SIGNKEY, 0)",
          "old_line_content": "\t{",
          "new_line_content": "\t\tdatum_l = (TRGM *) palloc(CALCGTSIZE(SIGNKEY, 0));",
          "content_same": false
        },
        {
          "line": 848,
          "old_api": null,
          "new_api": "GETSIGN",
          "old_text": null,
          "new_text": "GETSIGN(datum_l)",
          "old_line_content": "\t\tdatum_r->flag = SIGNKEY | ALLISTRUE;",
          "new_line_content": "\t\tmemcpy((void *) GETSIGN(datum_l), (void *) cache[seed_1].sign, sizeof(BITVEC));",
          "content_same": false
        },
        {
          "line": 865,
          "old_api": null,
          "new_api": "GETSIGN",
          "old_text": null,
          "new_text": "GETSIGN(datum_r)",
          "old_line_content": "\t{",
          "new_line_content": "\tunion_r = GETSIGN(datum_r);",
          "content_same": false
        },
        {
          "line": 866,
          "old_api": null,
          "new_api": "OffsetNumberNext",
          "old_text": null,
          "new_text": "OffsetNumberNext(maxoff)",
          "old_line_content": "\t\tcostvector[j - 1].pos = j;",
          "new_line_content": "\tmaxoff = OffsetNumberNext(maxoff);",
          "content_same": false
        },
        {
          "line": 870,
          "old_api": null,
          "new_api": "OffsetNumberNext",
          "old_text": null,
          "new_text": "OffsetNumberNext(j)",
          "old_line_content": "\t}",
          "new_line_content": "\tfor (j = FirstOffsetNumber; j <= maxoff; j = OffsetNumberNext(j))",
          "content_same": false
        },
        {
          "line": 873,
          "old_api": null,
          "new_api": "hemdistcache",
          "old_text": null,
          "new_text": "hemdistcache(&(cache[seed_1]), &(cache[j]))",
          "old_line_content": "\tfor (k = 0; k < maxoff; k++)",
          "new_line_content": "\t\tsize_alpha = hemdistcache(&(cache[seed_1]), &(cache[j]));",
          "content_same": false
        },
        {
          "line": 874,
          "old_api": null,
          "new_api": "hemdistcache",
          "old_text": null,
          "new_text": "hemdistcache(&(cache[seed_2]), &(cache[j]))",
          "old_line_content": "\t{",
          "new_line_content": "\t\tsize_beta = hemdistcache(&(cache[seed_2]), &(cache[j]));",
          "content_same": false
        },
        {
          "line": 875,
          "old_api": null,
          "new_api": "abs",
          "old_text": null,
          "new_text": "abs(size_alpha - size_beta)",
          "old_line_content": "\t\tj = costvector[k].pos;",
          "new_line_content": "\t\tcostvector[j - 1].cost = abs(size_alpha - size_beta);",
          "content_same": false
        },
        {
          "line": 877,
          "old_api": null,
          "new_api": "qsort",
          "old_text": null,
          "new_text": "qsort((void *) costvector, maxoff, sizeof(SPLITCOST), comparecost)",
          "old_line_content": "\t\t{",
          "new_line_content": "\tqsort((void *) costvector, maxoff, sizeof(SPLITCOST), comparecost);",
          "content_same": false
        },
        {
          "line": 897,
          "old_api": null,
          "new_api": "ISALLTRUE",
          "old_text": null,
          "new_text": "ISALLTRUE(datum_l)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tif (ISALLTRUE(datum_l) && cache[j].allistrue)",
          "content_same": false
        },
        {
          "line": 900,
          "old_api": null,
          "new_api": "sizebitvec",
          "old_text": null,
          "new_text": "sizebitvec(\n\t\t\t\t\t\t\t\t\t\t\t\t\t(cache[j].allistrue) ? GETSIGN(datum_l) : GETSIGN(cache[j].sign)\n\t\t\t\t\t)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tsize_alpha = SIGLENBIT - sizebitvec(",
          "content_same": false
        },
        {
          "line": 905,
          "old_api": null,
          "new_api": "GETSIGN",
          "old_text": null,
          "new_text": "GETSIGN(datum_l)",
          "old_line_content": "\t\t\telse",
          "new_line_content": "\t\t\tsize_alpha = hemdistsign(cache[j].sign, GETSIGN(datum_l));",
          "content_same": false
        },
        {
          "line": 909,
          "old_api": null,
          "new_api": "ISALLTRUE",
          "old_text": null,
          "new_text": "ISALLTRUE(datum_r)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tif (ISALLTRUE(datum_r) && cache[j].allistrue)",
          "content_same": false
        },
        {
          "line": 912,
          "old_api": null,
          "new_api": "sizebitvec",
          "old_text": null,
          "new_text": "sizebitvec(\n\t\t\t\t\t\t\t\t\t\t\t\t   (cache[j].allistrue) ? GETSIGN(datum_r) : GETSIGN(cache[j].sign)\n\t\t\t\t\t)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tsize_beta = SIGLENBIT - sizebitvec(",
          "content_same": false
        },
        {
          "line": 919,
          "old_api": null,
          "new_api": "WISH_F",
          "old_text": null,
          "new_text": "WISH_F(v->spl_nleft, v->spl_nright, 0.1)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\tif (size_alpha < size_beta + WISH_F(v->spl_nleft, v->spl_nright, 0.1))",
          "content_same": false
        },
        {
          "line": 921,
          "old_api": null,
          "new_api": "ISALLTRUE",
          "old_text": null,
          "new_text": "ISALLTRUE(datum_l)",
          "old_line_content": "\t\t\t{",
          "new_line_content": "\t\t\tif (ISALLTRUE(datum_l) || cache[j].allistrue)",
          "content_same": false
        },
        {
          "line": 923,
          "old_api": null,
          "new_api": "ISALLTRUE",
          "old_text": null,
          "new_text": "ISALLTRUE(datum_l)",
          "old_line_content": "\t\t\t\tLOOPBYTE",
          "new_line_content": "\t\t\t\tif (!ISALLTRUE(datum_l))",
          "content_same": false
        },
        {
          "line": 924,
          "old_api": null,
          "new_api": "GETSIGN",
          "old_text": null,
          "new_text": "GETSIGN(datum_l)",
          "old_line_content": "\t\t\t\t\tunion_l[i] |= ptr[i];",
          "new_line_content": "\t\t\t\t\tMemSet((void *) GETSIGN(datum_l), 0xff, sizeof(BITVEC));",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": null,
          "new_api": "palloc",
          "old_text": null,
          "new_text": "palloc(len * sizeof(bool))",
          "old_line_content": "\t\t\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tcheck = (bool *) palloc(len * sizeof(bool));",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": null,
          "new_api": "CPTRGM",
          "old_text": null,
          "new_text": "CPTRGM(((char *) &tmp), ptr + k)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\t\t\tCPTRGM(((char *) &tmp), ptr + k);",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": null,
          "new_api": "HASHVAL",
          "old_text": null,
          "new_text": "HASHVAL(tmp)",
          "old_line_content": "\t\t\telse",
          "new_line_content": "\t\t\t\t\t\tcheck[k] = GETBIT(sign, HASHVAL(tmp));",
          "content_same": false
        },
        {
          "line": 420,
          "old_api": null,
          "new_api": "trigramsMatchGraph",
          "old_text": null,
          "new_text": "trigramsMatchGraph(cache->graph, check)",
          "old_line_content": "\t\t\t\t/* trigram-free query must be rechecked everywhere */",
          "new_line_content": "\t\t\t\t\tres = trigramsMatchGraph(cache->graph, check);",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": null,
          "new_api": "pfree",
          "old_text": null,
          "new_text": "pfree(check)",
          "old_line_content": "\t\t\t\tres = true;",
          "new_line_content": "\t\t\t\t\tpfree(check);",
          "content_same": false
        },
        {
          "line": 937,
          "old_api": null,
          "new_api": "ISALLTRUE",
          "old_text": null,
          "new_text": "ISALLTRUE(datum_r)",
          "old_line_content": "\t\t\t{",
          "new_line_content": "\t\t\tif (ISALLTRUE(datum_r) || cache[j].allistrue)",
          "content_same": false
        },
        {
          "line": 939,
          "old_api": null,
          "new_api": "ISALLTRUE",
          "old_text": null,
          "new_text": "ISALLTRUE(datum_r)",
          "old_line_content": "\t\t\t\tLOOPBYTE",
          "new_line_content": "\t\t\t\tif (!ISALLTRUE(datum_r))",
          "content_same": false
        },
        {
          "line": 940,
          "old_api": null,
          "new_api": "GETSIGN",
          "old_text": null,
          "new_text": "GETSIGN(datum_r)",
          "old_line_content": "\t\t\t\t\tunion_r[i] |= ptr[i];",
          "new_line_content": "\t\t\t\t\tMemSet((void *) GETSIGN(datum_r), 0xff, sizeof(BITVEC));",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"unrecognized strategy number: %d\", strategy)",
          "old_line_content": "}",
          "new_line_content": "\t\t\telog(ERROR, \"unrecognized strategy number: %d\", strategy);",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": null,
          "new_api": "PG_GETARG_POINTER",
          "old_text": null,
          "new_text": "PG_GETARG_POINTER(0)",
          "old_line_content": "\tTRGM\t   *qtrg;",
          "new_line_content": "\tGISTENTRY  *entry = (GISTENTRY *) PG_GETARG_POINTER(0);",
          "content_same": false
        },
        {
          "line": 443,
          "old_api": null,
          "new_api": "PG_GETARG_TEXT_P",
          "old_text": null,
          "new_text": "PG_GETARG_TEXT_P(1)",
          "old_line_content": "\tfloat8\t\tres;",
          "new_line_content": "\ttext\t   *query = PG_GETARG_TEXT_P(1);",
          "content_same": false
        },
        {
          "line": 954,
          "old_api": null,
          "new_api": "PointerGetDatum",
          "old_text": null,
          "new_text": "PointerGetDatum(datum_l)",
          "old_line_content": "",
          "new_line_content": "\tv->spl_ldatum = PointerGetDatum(datum_l);",
          "content_same": false
        },
        {
          "line": 955,
          "old_api": null,
          "new_api": "PointerGetDatum",
          "old_text": null,
          "new_text": "PointerGetDatum(datum_r)",
          "old_line_content": "",
          "new_line_content": "\tv->spl_rdatum = PointerGetDatum(datum_r);",
          "content_same": false
        },
        {
          "line": 957,
          "old_api": null,
          "new_api": "PG_RETURN_POINTER",
          "old_text": null,
          "new_text": "PG_RETURN_POINTER(v)",
          "old_line_content": "",
          "new_line_content": "\tPG_RETURN_POINTER(v);",
          "content_same": false
        },
        {
          "line": 447,
          "old_api": null,
          "new_api": "DatumGetPointer",
          "old_text": null,
          "new_text": "DatumGetPointer(entry->key)",
          "old_line_content": "\t/*",
          "new_line_content": "\tTRGM\t   *key = (TRGM *) DatumGetPointer(entry->key);",
          "content_same": false
        },
        {
          "line": 450,
          "old_api": null,
          "new_api": "VARSIZE",
          "old_text": null,
          "new_text": "VARSIZE(query)",
          "old_line_content": "\tif (cache == NULL ||",
          "new_line_content": "\tSize\t\tquerysize = VARSIZE(query);",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": null,
          "new_api": "VARSIZE",
          "old_text": null,
          "new_text": "VARSIZE(cache)",
          "old_line_content": "",
          "new_line_content": "\t\tVARSIZE(cache) != querysize ||",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": null,
          "new_api": "MemoryContextAlloc",
          "old_text": null,
          "new_text": "MemoryContextAlloc(fcinfo->flinfo->fn_mcxt,\n\t\t\t\t\t\t\t\t\t  MAXALIGN(querysize) +\n\t\t\t\t\t\t\t\t\t  VARSIZE(qtrg))",
          "old_line_content": "",
          "new_line_content": "\t\tnewcache = MemoryContextAlloc(fcinfo->flinfo->fn_mcxt,",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": null,
          "new_api": "MAXALIGN",
          "old_text": null,
          "new_text": "MAXALIGN(querysize)",
          "old_line_content": "\t\tif (cache)",
          "new_line_content": "\t\t\t\t\t\t\t\t\t  MAXALIGN(querysize) +",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(newcache, query, querysize)",
          "old_line_content": "\t\tcache = newcache;",
          "new_line_content": "\t\tmemcpy(newcache, query, querysize);",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": null,
          "new_api": "VARSIZE",
          "old_text": null,
          "new_text": "VARSIZE(qtrg)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tmemcpy(newcache + MAXALIGN(querysize), qtrg, VARSIZE(qtrg));",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": null,
          "new_api": "pfree",
          "old_text": null,
          "new_text": "pfree(cache)",
          "old_line_content": "",
          "new_line_content": "\t\t\tpfree(cache);",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": null,
          "new_api": "MAXALIGN",
          "old_text": null,
          "new_text": "MAXALIGN(querysize)",
          "old_line_content": "\t\t\t{\t\t\t\t\t/* all leafs contains orig trgm */",
          "new_line_content": "\tqtrg = (TRGM *) (cache + MAXALIGN(querysize));",
          "content_same": false
        },
        {
          "line": 482,
          "old_api": null,
          "new_api": "GIST_LEAF",
          "old_text": null,
          "new_text": "GIST_LEAF(entry)",
          "old_line_content": "\t\t\t\tres = 0.0;",
          "new_line_content": "\t\t\tif (GIST_LEAF(entry))",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": null,
          "new_api": "cnt_sml",
          "old_text": null,
          "new_text": "cnt_sml(key, qtrg)",
          "old_line_content": "\t\t\telse",
          "new_line_content": "\t\t\t\tres = 1.0 - cnt_sml(key, qtrg);",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": null,
          "new_api": "GETSIGN",
          "old_text": null,
          "new_text": "GETSIGN(key)",
          "old_line_content": "\t\tdefault:",
          "new_line_content": "\t\t\t\tint32\t\tcount = cnt_sml_sign_common(qtrg, GETSIGN(key));",
          "content_same": false
        },
        {
          "line": 499,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"unrecognized strategy number: %d\", strategy)",
          "old_line_content": "}",
          "new_line_content": "\t\t\telog(ERROR, \"unrecognized strategy number: %d\", strategy);",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": null,
          "new_api": "PG_RETURN_FLOAT8",
          "old_text": null,
          "new_text": "PG_RETURN_FLOAT8(res)",
          "old_line_content": "\tint32\t\ti;",
          "new_line_content": "\tPG_RETURN_FLOAT8(res);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 518,
          "old_api": "GETARR",
          "new_api": null,
          "old_text": "GETARR(add)",
          "new_text": null,
          "old_line_content": "\t\ttrgm\t   *ptr = GETARR(add);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": "ARRNELEM",
          "new_api": null,
          "old_text": "ARRNELEM(add)",
          "new_text": null,
          "old_line_content": "\t\tfor (i = 0; i < ARRNELEM(add); i++)",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 523,
          "old_api": "CPTRGM",
          "new_api": null,
          "old_text": "CPTRGM(((char *) &tmp), ptr + i)",
          "new_text": null,
          "old_line_content": "\t\t\tCPTRGM(((char *) &tmp), ptr + i);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": "PG_GETARG_POINTER",
          "new_api": null,
          "old_text": "PG_GETARG_POINTER(0)",
          "new_text": null,
          "old_line_content": "\tGistEntryVector *entryvec = (GistEntryVector *) PG_GETARG_POINTER(0);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 536,
          "old_api": "PG_GETARG_POINTER",
          "new_api": null,
          "old_text": "PG_GETARG_POINTER(1)",
          "new_text": null,
          "old_line_content": "\tint\t\t   *size = (int *) PG_GETARG_POINTER(1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 545,
          "old_api": "GETENTRY",
          "new_api": null,
          "old_text": "GETENTRY(entryvec, i)",
          "new_text": null,
          "old_line_content": "\t\tif (unionkey(base, GETENTRY(entryvec, i)))",
          "new_line_content": "\tint32\t\tflag = 0;",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": "CALCGTSIZE",
          "new_api": null,
          "old_text": "CALCGTSIZE(flag, 0)",
          "new_text": null,
          "old_line_content": "\tlen = CALCGTSIZE(flag, 0);",
          "new_line_content": "\t\t\tflag = ALLISTRUE;",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": "palloc",
          "new_api": null,
          "old_text": "palloc(len)",
          "new_text": null,
          "old_line_content": "\tresult = (TRGM *) palloc(len);",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 555,
          "old_api": "SET_VARSIZE",
          "new_api": null,
          "old_text": "SET_VARSIZE(result, len)",
          "new_text": null,
          "old_line_content": "\tSET_VARSIZE(result, len);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(result)",
          "new_text": null,
          "old_line_content": "\tif (!ISALLTRUE(result))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 558,
          "old_api": "GETSIGN",
          "new_api": null,
          "old_text": "GETSIGN(result)",
          "new_text": null,
          "old_line_content": "\t\tmemcpy((void *) GETSIGN(result), (void *) base, sizeof(BITVEC));",
          "new_line_content": "\tflag |= SIGNKEY;",
          "content_same": false
        },
        {
          "line": 568,
          "old_api": "PG_GETARG_POINTER",
          "new_api": null,
          "old_text": "PG_GETARG_POINTER(1)",
          "new_text": null,
          "old_line_content": "\tTRGM\t   *b = (TRGM *) PG_GETARG_POINTER(1);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "PG_GETARG_POINTER",
          "new_api": null,
          "old_text": "PG_GETARG_POINTER(2)",
          "new_text": null,
          "old_line_content": "\tbool\t   *result = (bool *) PG_GETARG_POINTER(2);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": "ISSIGNKEY",
          "new_api": null,
          "old_text": "ISSIGNKEY(a)",
          "new_text": null,
          "old_line_content": "\tif (ISSIGNKEY(a))",
          "new_line_content": "gtrgm_same(PG_FUNCTION_ARGS)",
          "content_same": false
        },
        {
          "line": 582,
          "old_api": "GETSIGN",
          "new_api": null,
          "old_text": "GETSIGN(a)",
          "new_text": null,
          "old_line_content": "\t\t\tBITVECP\t\tsa = GETSIGN(a),",
          "new_line_content": "\t\t\t*result = false;",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": "ARRNELEM",
          "new_api": null,
          "old_text": "ARRNELEM(a)",
          "new_text": null,
          "old_line_content": "\t\tint32\t\tlena = ARRNELEM(a),",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": "ARRNELEM",
          "new_api": null,
          "old_text": "ARRNELEM(b)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tlenb = ARRNELEM(b);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": "GETARR",
          "new_api": null,
          "old_text": "GETARR(b)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t   *ptrb = GETARR(b);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 619,
          "old_api": "PG_RETURN_POINTER",
          "new_api": null,
          "old_text": "PG_RETURN_POINTER(result)",
          "new_text": null,
          "old_line_content": "\tPG_RETURN_POINTER(result);",
          "new_line_content": "\t\t\t\t\t*result = false;",
          "content_same": false
        },
        {
          "line": 651,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(a)",
          "new_text": null,
          "old_line_content": "\tif (ISALLTRUE(a))",
          "new_line_content": "\treturn dist;",
          "content_same": false
        },
        {
          "line": 653,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(b)",
          "new_text": null,
          "old_line_content": "\t\tif (ISALLTRUE(b))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 656,
          "old_api": "GETSIGN",
          "new_api": null,
          "old_text": "GETSIGN(b)",
          "new_text": null,
          "old_line_content": "\t\t\treturn SIGLENBIT - sizebitvec(GETSIGN(b));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 658,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(b)",
          "new_text": null,
          "old_line_content": "\telse if (ISALLTRUE(b))",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": "GETSIGN",
          "new_api": null,
          "old_text": "GETSIGN(b)",
          "new_text": null,
          "old_line_content": "\treturn hemdistsign(GETSIGN(a), GETSIGN(b));",
          "new_line_content": "\t\telse",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": "PG_GETARG_POINTER",
          "new_api": null,
          "old_text": "PG_GETARG_POINTER(1)",
          "new_text": null,
          "old_line_content": "\tGISTENTRY  *newentry = (GISTENTRY *) PG_GETARG_POINTER(1);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": "PG_GETARG_POINTER",
          "new_api": null,
          "old_text": "PG_GETARG_POINTER(2)",
          "new_text": null,
          "old_line_content": "\tfloat\t   *penalty = (float *) PG_GETARG_POINTER(2);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": "DatumGetPointer",
          "new_api": null,
          "old_text": "DatumGetPointer(origentry->key)",
          "new_text": null,
          "old_line_content": "\tTRGM\t   *origval = (TRGM *) DatumGetPointer(origentry->key);",
          "new_line_content": "Datum",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": "DatumGetPointer",
          "new_api": null,
          "old_text": "DatumGetPointer(newentry->key)",
          "new_text": null,
          "old_line_content": "\tTRGM\t   *newval = (TRGM *) DatumGetPointer(newentry->key);",
          "new_line_content": "gtrgm_penalty(PG_FUNCTION_ARGS)",
          "content_same": false
        },
        {
          "line": 672,
          "old_api": "GETSIGN",
          "new_api": null,
          "old_text": "GETSIGN(origval)",
          "new_text": null,
          "old_line_content": "\tBITVECP\t\torig = GETSIGN(origval);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 679,
          "old_api": "MAXALIGN",
          "new_api": null,
          "old_text": "MAXALIGN(sizeof(BITVEC))",
          "new_text": null,
          "old_line_content": "\t\tTRGM\t   *cachedVal = (TRGM *) (cache + MAXALIGN(sizeof(BITVEC)));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 680,
          "old_api": "VARSIZE",
          "new_api": null,
          "old_text": "VARSIZE(newval)",
          "new_text": null,
          "old_line_content": "\t\tSize\t\tnewvalsize = VARSIZE(newval);",
          "new_line_content": "\t*penalty = 0.0;",
          "content_same": false
        },
        {
          "line": 687,
          "old_api": "VARSIZE",
          "new_api": null,
          "old_text": "VARSIZE(cachedVal)",
          "new_text": null,
          "old_line_content": "\t\t\tVARSIZE(cachedVal) != newvalsize ||",
          "new_line_content": "\t\tBITVECP\t\tsign;",
          "content_same": false
        },
        {
          "line": 688,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(cachedVal, newval, newvalsize)",
          "new_text": null,
          "old_line_content": "\t\t\tmemcmp(cachedVal, newval, newvalsize) != 0)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 692,
          "old_api": "MemoryContextAlloc",
          "new_api": null,
          "old_text": "MemoryContextAlloc(fcinfo->flinfo->fn_mcxt,\n\t\t\t\t\t\t\t\t\t\t  MAXALIGN(sizeof(BITVEC)) +\n\t\t\t\t\t\t\t\t\t\t  newvalsize)",
          "new_text": null,
          "old_line_content": "\t\t\tnewcache = MemoryContextAlloc(fcinfo->flinfo->fn_mcxt,",
          "new_line_content": "\t\tif (cache == NULL ||",
          "content_same": false
        },
        {
          "line": 696,
          "old_api": "makesign",
          "new_api": null,
          "old_text": "makesign((BITVECP) newcache, newval)",
          "new_text": null,
          "old_line_content": "\t\t\tmakesign((BITVECP) newcache, newval);",
          "new_line_content": "\t\t\tchar\t   *newcache;",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(origval)",
          "new_text": null,
          "old_line_content": "\t\tif (ISALLTRUE(origval))",
          "new_line_content": "\t\t\tfcinfo->flinfo->fn_extra = newcache;",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": "sizebitvec",
          "new_api": null,
          "old_text": "sizebitvec(sign)",
          "new_text": null,
          "old_line_content": "\t\t\t*penalty = ((float) (SIGLENBIT - sizebitvec(sign))) / (float) (SIGLENBIT + 1);",
          "new_line_content": "\t\t\tcache = newcache;",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": "hemdistsign",
          "new_api": null,
          "old_text": "hemdistsign(sign, orig)",
          "new_text": null,
          "old_line_content": "\t\t\t*penalty = hemdistsign(sign, orig);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": "ISARRKEY",
          "new_api": null,
          "old_text": "ISARRKEY(key)",
          "new_text": null,
          "old_line_content": "\tif (ISARRKEY(key))",
          "new_line_content": "} CACHESIGN;",
          "content_same": false
        },
        {
          "line": 730,
          "old_api": "makesign",
          "new_api": null,
          "old_text": "makesign(item->sign, key)",
          "new_text": null,
          "old_line_content": "\t\tmakesign(item->sign, key);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 731,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(key)",
          "new_text": null,
          "old_line_content": "\telse if (ISALLTRUE(key))",
          "new_line_content": "static void",
          "content_same": false
        },
        {
          "line": 734,
          "old_api": "GETSIGN",
          "new_api": null,
          "old_text": "GETSIGN(key)",
          "new_text": null,
          "old_line_content": "\t\tmemcpy((void *) item->sign, (void *) GETSIGN(key), sizeof(BITVEC));",
          "new_line_content": "\titem->allistrue = false;",
          "content_same": false
        },
        {
          "line": 762,
          "old_api": "sizebitvec",
          "new_api": null,
          "old_text": "sizebitvec(b->sign)",
          "new_text": null,
          "old_line_content": "\t\t\treturn SIGLENBIT - sizebitvec(b->sign);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 765,
          "old_api": "sizebitvec",
          "new_api": null,
          "old_text": "sizebitvec(a->sign)",
          "new_text": null,
          "old_line_content": "\t\treturn SIGLENBIT - sizebitvec(a->sign);",
          "new_line_content": "\t\tif (b->allistrue)",
          "content_same": false
        },
        {
          "line": 767,
          "old_api": "hemdistsign",
          "new_api": null,
          "old_text": "hemdistsign(a->sign, b->sign)",
          "new_text": null,
          "old_line_content": "\treturn hemdistsign(a->sign, b->sign);",
          "new_line_content": "\t\telse",
          "content_same": false
        },
        {
          "line": 775,
          "old_api": "PG_GETARG_POINTER",
          "new_api": null,
          "old_text": "PG_GETARG_POINTER(1)",
          "new_text": null,
          "old_line_content": "\tGIST_SPLITVEC *v = (GIST_SPLITVEC *) PG_GETARG_POINTER(1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 797,
          "old_api": "palloc",
          "new_api": null,
          "old_text": "palloc(sizeof(CACHESIGN) * (maxoff + 2))",
          "new_text": null,
          "old_line_content": "\tcache = (CACHESIGN *) palloc(sizeof(CACHESIGN) * (maxoff + 2));",
          "new_line_content": "\tBITVECP\t\tptr;",
          "content_same": false
        },
        {
          "line": 798,
          "old_api": "OffsetNumberNext",
          "new_api": null,
          "old_text": "OffsetNumberNext(k)",
          "new_text": null,
          "old_line_content": "\tfor (k = FirstOffsetNumber; k <= maxoff; k = OffsetNumberNext(k))",
          "new_line_content": "\tint\t\t\ti;",
          "content_same": false
        },
        {
          "line": 799,
          "old_api": "GETENTRY",
          "new_api": null,
          "old_text": "GETENTRY(entryvec, k)",
          "new_text": null,
          "old_line_content": "\t\tfillcache(&cache[k], GETENTRY(entryvec, k));",
          "new_line_content": "\tCACHESIGN  *cache;",
          "content_same": false
        },
        {
          "line": 802,
          "old_api": "OffsetNumberNext",
          "new_api": null,
          "old_text": "OffsetNumberNext(k)",
          "new_text": null,
          "old_line_content": "\tfor (k = FirstOffsetNumber; k < maxoff; k = OffsetNumberNext(k))",
          "new_line_content": "\t/* cache the sign data for each existing item */",
          "content_same": false
        },
        {
          "line": 806,
          "old_api": "hemdistcache",
          "new_api": null,
          "old_text": "hemdistcache(&(cache[j]), &(cache[k]))",
          "new_text": null,
          "old_line_content": "\t\t\tsize_waste = hemdistcache(&(cache[j]), &(cache[k]));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 825,
          "old_api": "palloc",
          "new_api": null,
          "old_text": "palloc(nbytes)",
          "new_text": null,
          "old_line_content": "\tv->spl_left = left = (OffsetNumber *) palloc(nbytes);",
          "new_line_content": "\t\tseed_1 = 1;",
          "content_same": false
        },
        {
          "line": 826,
          "old_api": "palloc",
          "new_api": null,
          "old_text": "palloc(nbytes)",
          "new_text": null,
          "old_line_content": "\tv->spl_right = right = (OffsetNumber *) palloc(nbytes);",
          "new_line_content": "\t\tseed_2 = 2;",
          "content_same": false
        },
        {
          "line": 833,
          "old_api": "CALCGTSIZE",
          "new_api": null,
          "old_text": "CALCGTSIZE(SIGNKEY | ALLISTRUE, 0)",
          "new_text": null,
          "old_line_content": "\t\tdatum_l = (TRGM *) palloc(CALCGTSIZE(SIGNKEY | ALLISTRUE, 0));",
          "new_line_content": "\tv->spl_nleft = 0;",
          "content_same": false
        },
        {
          "line": 834,
          "old_api": "CALCGTSIZE",
          "new_api": null,
          "old_text": "CALCGTSIZE(SIGNKEY | ALLISTRUE, 0)",
          "new_text": null,
          "old_line_content": "\t\tSET_VARSIZE(datum_l, CALCGTSIZE(SIGNKEY | ALLISTRUE, 0));",
          "new_line_content": "\tv->spl_nright = 0;",
          "content_same": false
        },
        {
          "line": 842,
          "old_api": "GETSIGN",
          "new_api": null,
          "old_text": "GETSIGN(datum_l)",
          "new_text": null,
          "old_line_content": "\t\tmemcpy((void *) GETSIGN(datum_l), (void *) cache[seed_1].sign, sizeof(BITVEC));",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 847,
          "old_api": "CALCGTSIZE",
          "new_api": null,
          "old_text": "CALCGTSIZE(SIGNKEY | ALLISTRUE, 0)",
          "new_text": null,
          "old_line_content": "\t\tSET_VARSIZE(datum_r, CALCGTSIZE(SIGNKEY | ALLISTRUE, 0));",
          "new_line_content": "\t\tdatum_l->flag = SIGNKEY;",
          "content_same": false
        },
        {
          "line": 855,
          "old_api": "GETSIGN",
          "new_api": null,
          "old_text": "GETSIGN(datum_r)",
          "new_text": null,
          "old_line_content": "\t\tmemcpy((void *) GETSIGN(datum_r), (void *) cache[seed_2].sign, sizeof(BITVEC));",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 860,
          "old_api": "OffsetNumberNext",
          "new_api": null,
          "old_text": "OffsetNumberNext(maxoff)",
          "new_text": null,
          "old_line_content": "\tmaxoff = OffsetNumberNext(maxoff);",
          "new_line_content": "\t\tdatum_r->flag = SIGNKEY;",
          "content_same": false
        },
        {
          "line": 863,
          "old_api": "palloc",
          "new_api": null,
          "old_text": "palloc(sizeof(SPLITCOST) * maxoff)",
          "new_text": null,
          "old_line_content": "\tcostvector = (SPLITCOST *) palloc(sizeof(SPLITCOST) * maxoff);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 868,
          "old_api": "hemdistcache",
          "new_api": null,
          "old_text": "hemdistcache(&(cache[seed_2]), &(cache[j]))",
          "new_text": null,
          "old_line_content": "\t\tsize_beta = hemdistcache(&(cache[seed_2]), &(cache[j]));",
          "new_line_content": "\t/* sort before ... */",
          "content_same": false
        },
        {
          "line": 871,
          "old_api": "qsort",
          "new_api": null,
          "old_text": "qsort((void *) costvector, maxoff, sizeof(SPLITCOST), comparecost)",
          "new_text": null,
          "old_line_content": "\tqsort((void *) costvector, maxoff, sizeof(SPLITCOST), comparecost);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 889,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(datum_l)",
          "new_text": null,
          "old_line_content": "\t\tif (ISALLTRUE(datum_l) || cache[j].allistrue)",
          "new_line_content": "\t\t{",
          "content_same": false
        },
        {
          "line": 891,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(datum_l)",
          "new_text": null,
          "old_line_content": "\t\t\tif (ISALLTRUE(datum_l) && cache[j].allistrue)",
          "new_line_content": "\t\t\tv->spl_nright++;",
          "content_same": false
        },
        {
          "line": 894,
          "old_api": "sizebitvec",
          "new_api": null,
          "old_text": "sizebitvec(\n\t\t\t\t\t\t\t\t\t\t\t\t\t(cache[j].allistrue) ? GETSIGN(datum_l) : GETSIGN(cache[j].sign)\n\t\t\t\t\t)",
          "new_text": null,
          "old_line_content": "\t\t\t\tsize_alpha = SIGLENBIT - sizebitvec(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 899,
          "old_api": "GETSIGN",
          "new_api": null,
          "old_text": "GETSIGN(datum_l)",
          "new_text": null,
          "old_line_content": "\t\t\tsize_alpha = hemdistsign(cache[j].sign, GETSIGN(datum_l));",
          "new_line_content": "\t\t\telse",
          "content_same": false
        },
        {
          "line": 903,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(datum_r)",
          "new_text": null,
          "old_line_content": "\t\t\tif (ISALLTRUE(datum_r) && cache[j].allistrue)",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 906,
          "old_api": "sizebitvec",
          "new_api": null,
          "old_text": "sizebitvec(\n\t\t\t\t\t\t\t\t\t\t\t\t   (cache[j].allistrue) ? GETSIGN(datum_r) : GETSIGN(cache[j].sign)\n\t\t\t\t\t)",
          "new_text": null,
          "old_line_content": "\t\t\t\tsize_beta = SIGLENBIT - sizebitvec(",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 911,
          "old_api": "GETSIGN",
          "new_api": null,
          "old_text": "GETSIGN(datum_r)",
          "new_text": null,
          "old_line_content": "\t\t\tsize_beta = hemdistsign(cache[j].sign, GETSIGN(datum_r));",
          "new_line_content": "\t\t\telse",
          "content_same": false
        },
        {
          "line": 915,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(datum_l)",
          "new_text": null,
          "old_line_content": "\t\t\tif (ISALLTRUE(datum_l) || cache[j].allistrue)",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 918,
          "old_api": "GETSIGN",
          "new_api": null,
          "old_text": "GETSIGN(datum_l)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tMemSet((void *) GETSIGN(datum_l), 0xff, sizeof(BITVEC));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": "CPTRGM",
          "new_api": null,
          "old_text": "CPTRGM(((char *) &tmp), ptr + k)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tCPTRGM(((char *) &tmp), ptr + k);",
          "new_line_content": "\t\t\t\t\t * implements a monotone boolean function, false positives",
          "content_same": false
        },
        {
          "line": 410,
          "old_api": "HASHVAL",
          "new_api": null,
          "old_text": "HASHVAL(tmp)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tif (GETBIT(sign, HASHVAL(tmp)))",
          "new_line_content": "\t\t\t\t\t * in the check array can't lead to false negative answer.",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(datum_r)",
          "new_text": null,
          "old_line_content": "\t\t\tif (ISALLTRUE(datum_r) || cache[j].allistrue)",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 933,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(datum_r)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (!ISALLTRUE(datum_r))",
          "new_line_content": "\t\t\tv->spl_nleft++;",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": "GETSIGN",
          "new_api": null,
          "old_text": "GETSIGN(datum_r)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tMemSet((void *) GETSIGN(datum_r), 0xff, sizeof(BITVEC));",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 425,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR, \"unrecognized strategy number: %d\", strategy)",
          "new_text": null,
          "old_line_content": "\t\t\telog(ERROR, \"unrecognized strategy number: %d\", strategy);",
          "new_line_content": "\t\t\t{",
          "content_same": false
        },
        {
          "line": 430,
          "old_api": "PG_RETURN_BOOL",
          "new_api": null,
          "old_text": "PG_RETURN_BOOL(res)",
          "new_text": null,
          "old_line_content": "\tPG_RETURN_BOOL(res);",
          "new_line_content": "\t\tdefault:",
          "content_same": false
        },
        {
          "line": 948,
          "old_api": "PointerGetDatum",
          "new_api": null,
          "old_text": "PointerGetDatum(datum_l)",
          "new_text": null,
          "old_line_content": "\tv->spl_ldatum = PointerGetDatum(datum_l);",
          "new_line_content": "\t\t\t*right++ = j;",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "PG_GETARG_TEXT_P",
          "new_api": null,
          "old_text": "PG_GETARG_TEXT_P(1)",
          "new_text": null,
          "old_line_content": "\ttext\t   *query = PG_GETARG_TEXT_P(1);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": "PG_GETARG_UINT16",
          "new_api": null,
          "old_text": "PG_GETARG_UINT16(2)",
          "new_text": null,
          "old_line_content": "\tStrategyNumber strategy = (StrategyNumber) PG_GETARG_UINT16(2);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 949,
          "old_api": "PointerGetDatum",
          "new_api": null,
          "old_text": "PointerGetDatum(datum_r)",
          "new_text": null,
          "old_line_content": "\tv->spl_rdatum = PointerGetDatum(datum_r);",
          "new_line_content": "\t\t\tv->spl_nright++;",
          "content_same": false
        },
        {
          "line": 951,
          "old_api": "PG_RETURN_POINTER",
          "new_api": null,
          "old_text": "PG_RETURN_POINTER(v)",
          "new_text": null,
          "old_line_content": "\tPG_RETURN_POINTER(v);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": "DatumGetPointer",
          "new_api": null,
          "old_text": "DatumGetPointer(entry->key)",
          "new_text": null,
          "old_line_content": "\tTRGM\t   *key = (TRGM *) DatumGetPointer(entry->key);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 451,
          "old_api": "VARSIZE",
          "new_api": null,
          "old_text": "VARSIZE(cache)",
          "new_text": null,
          "old_line_content": "\t\tVARSIZE(cache) != querysize ||",
          "new_line_content": "\tchar\t   *cache = (char *) fcinfo->flinfo->fn_extra;",
          "content_same": false
        },
        {
          "line": 452,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(cache, query, querysize)",
          "new_text": null,
          "old_line_content": "\t\tmemcmp(cache, query, querysize) != 0)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": "VARDATA",
          "new_api": null,
          "old_text": "VARDATA(query)",
          "new_text": null,
          "old_line_content": "\t\tqtrg = generate_trgm(VARDATA(query), querysize - VARHDRSZ);",
          "new_line_content": "\tif (cache == NULL ||",
          "content_same": false
        },
        {
          "line": 459,
          "old_api": "MAXALIGN",
          "new_api": null,
          "old_text": "MAXALIGN(querysize)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t\t\t  MAXALIGN(querysize) +",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 460,
          "old_api": "VARSIZE",
          "new_api": null,
          "old_text": "VARSIZE(qtrg)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t\t\t  VARSIZE(qtrg));",
          "new_line_content": "\t\tchar\t   *newcache;",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "VARSIZE",
          "new_api": null,
          "old_text": "VARSIZE(qtrg)",
          "new_text": null,
          "old_line_content": "\t\tmemcpy(newcache + MAXALIGN(querysize), qtrg, VARSIZE(qtrg));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": "MAXALIGN",
          "new_api": null,
          "old_text": "MAXALIGN(querysize)",
          "new_text": null,
          "old_line_content": "\tqtrg = (TRGM *) (cache + MAXALIGN(querysize));",
          "new_line_content": "\t\tif (cache)",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": "GIST_LEAF",
          "new_api": null,
          "old_text": "GIST_LEAF(entry)",
          "new_text": null,
          "old_line_content": "\t\t\tif (GIST_LEAF(entry))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": "cnt_sml",
          "new_api": null,
          "old_text": "cnt_sml(key, qtrg)",
          "new_text": null,
          "old_line_content": "\t\t\t\tres = 1.0 - cnt_sml(key, qtrg);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(key)",
          "new_text": null,
          "old_line_content": "\t\t\telse if (ISALLTRUE(key))",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": "ARRNELEM",
          "new_api": null,
          "old_text": "ARRNELEM(qtrg)",
          "new_text": null,
          "old_line_content": "\t\t\t\tint32\t\tlen = ARRNELEM(qtrg);",
          "new_line_content": "\t\t\t{\t\t\t\t\t/* all leafs contains orig trgm */",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": "PG_RETURN_FLOAT8",
          "new_api": null,
          "old_text": "PG_RETURN_FLOAT8(res)",
          "new_text": null,
          "old_line_content": "\tPG_RETURN_FLOAT8(res);",
          "new_line_content": "\t\tdefault:",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": "ISSIGNKEY",
          "new_api": null,
          "old_text": "ISSIGNKEY(add)",
          "new_text": null,
          "old_line_content": "\tif (ISSIGNKEY(add))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": "GETSIGN",
          "new_api": null,
          "old_text": "GETSIGN(add)",
          "new_text": null,
          "old_line_content": "\t\tBITVECP\t\tsadd = GETSIGN(add);",
          "new_line_content": "unionkey(BITVECP sbase, TRGM *add)",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": "ISALLTRUE",
          "new_api": null,
          "old_text": "ISALLTRUE(add)",
          "new_text": null,
          "old_line_content": "\t\tif (ISALLTRUE(add))",
          "new_line_content": "\tint32\t\ti;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 39,
      "total_additions": 102,
      "total_deletions": 99,
      "total_api_changes": 240
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 14,
        "api_related_lines": 240,
        "non_api_lines": 8,
        "non_api_line_numbers": [
          404,
          405,
          406,
          407,
          408,
          411,
          412,
          413
        ]
      }
    },
    "api_calls_before": 285,
    "api_calls_after": 288,
    "diff_info": {
      "added_lines": 13,
      "removed_lines": 7,
      "total_diff_lines": 37
    }
  }
}