{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/6e5d9f278c1209936d973930996857f55e119cd8",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/6e5d9f278c1209936d973930996857f55e119cd8/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/6e5d9f278c1209936d973930996857f55e119cd8/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/6e5d9f278c1209936d973930996857f55e119cd8/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1877,
          "old_api": "pg_analyze_and_rewrite_params",
          "new_api": "Assert",
          "old_text": "pg_analyze_and_rewrite_params(parsetree,\n\t\t\t\t\t\t\t\t\t\t\t\t\t  src,\n\t\t\t\t\t\t\t\t\t\t\t\t\t  plan->parserSetup,\n\t\t\t\t\t\t\t\t\t\t\t\t\t  plan->parserSetupArg)",
          "new_text": "Assert(plan->nargs == 0)",
          "old_line_content": "\t\t\tstmt_list = pg_analyze_and_rewrite_params(parsetree,",
          "new_line_content": "\t\t\tAssert(plan->nargs == 0);",
          "content_same": false
        },
        {
          "line": 2073,
          "old_api": "pg_analyze_and_rewrite_params",
          "new_api": "Assert",
          "old_text": "pg_analyze_and_rewrite_params(parsetree,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  src,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  plan->parserSetup,\n\t\t\t\t\t\t\t\t\t\t\t\t\t   plan->parserSetupArg)",
          "new_text": "Assert(plan->nargs == 0)",
          "old_line_content": "\t\t\t\tstmt_list = pg_analyze_and_rewrite_params(parsetree,",
          "new_line_content": "\t\t\t\tAssert(plan->nargs == 0);",
          "content_same": false
        },
        {
          "line": 2113,
          "old_api": "GetTransactionSnapshot",
          "new_api": "PopActiveSnapshot",
          "old_text": "GetTransactionSnapshot()",
          "new_text": "PopActiveSnapshot()",
          "old_line_content": "\t\t\tPushActiveSnapshot(GetTransactionSnapshot());",
          "new_line_content": "\t\t\t\tPopActiveSnapshot();",
          "content_same": false
        },
        {
          "line": 2154,
          "old_api": "ereport",
          "new_api": "CommandIsReadOnly",
          "old_text": "ereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t/* translator: %s is a SQL statement name */\n\t\t\t\t\t   errmsg(\"%s is not allowed in a non-volatile function\",\n\t\t\t\t\t\t\t  CreateCommandTag(stmt))))",
          "new_text": "CommandIsReadOnly(stmt)",
          "old_line_content": "\t\t\t\tereport(ERROR,",
          "new_line_content": "\t\t\tif (read_only && !CommandIsReadOnly(stmt))",
          "content_same": false
        },
        {
          "line": 2155,
          "old_api": "errcode",
          "new_api": "ereport",
          "old_text": "errcode(ERRCODE_FEATURE_NOT_SUPPORTED)",
          "new_text": "ereport(ERROR,\n\t\t\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t/* translator: %s is a SQL statement name */\n\t\t\t\t\t   errmsg(\"%s is not allowed in a non-volatile function\",\n\t\t\t\t\t\t\t  CreateCommandTag(stmt))))",
          "old_line_content": "\t\t\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),",
          "new_line_content": "\t\t\t\tereport(ERROR,",
          "content_same": false
        },
        {
          "line": 2158,
          "old_api": "CreateCommandTag",
          "new_api": "errmsg",
          "old_text": "CreateCommandTag(stmt)",
          "new_text": "errmsg(\"%s is not allowed in a non-volatile function\",\n\t\t\t\t\t\t\t  CreateCommandTag(stmt))",
          "old_line_content": "\t\t\t\t\t\t\t  CreateCommandTag(stmt))));",
          "new_line_content": "\t\t\t\t\t   errmsg(\"%s is not allowed in a non-volatile function\",",
          "content_same": false
        },
        {
          "line": 2161,
          "old_api": "CreateCommandTag",
          "new_api": "CommandIsReadOnly",
          "old_text": "CreateCommandTag(stmt)",
          "new_text": "CommandIsReadOnly(stmt)",
          "old_line_content": "\t\t\t\tPreventCommandIfParallelMode(CreateCommandTag(stmt));",
          "new_line_content": "\t\t\tif (IsInParallelMode() && !CommandIsReadOnly(stmt))",
          "content_same": false
        },
        {
          "line": 2170,
          "old_api": "UpdateActiveSnapshotCommandId",
          "new_api": "CommandCounterIncrement",
          "old_text": "UpdateActiveSnapshotCommandId()",
          "new_text": "CommandCounterIncrement()",
          "old_line_content": "\t\t\t\tUpdateActiveSnapshotCommandId();",
          "new_line_content": "\t\t\t\tCommandCounterIncrement();",
          "content_same": false
        },
        {
          "line": 2182,
          "old_api": "GetActiveSnapshot",
          "new_api": "ActiveSnapshotSet",
          "old_text": "GetActiveSnapshot()",
          "new_text": "ActiveSnapshotSet()",
          "old_line_content": "\t\t\t\t\tsnap = GetActiveSnapshot();",
          "new_line_content": "\t\t\t\tif (ActiveSnapshotSet())",
          "content_same": false
        },
        {
          "line": 2220,
          "old_api": "strtoul",
          "new_api": "strncmp",
          "old_text": "strtoul(completionTag + 7,\n\t\t\t\t\t\t\t\t\t\t\t\t\t  NULL, 10)",
          "new_text": "strncmp(completionTag, \"SELECT \", 7)",
          "old_line_content": "\t\t\t\t\t_SPI_current->processed = strtoul(completionTag + 7,",
          "new_line_content": "\t\t\t\t\tAssert(strncmp(completionTag, \"SELECT \", 7) == 0);",
          "content_same": false
        },
        {
          "line": 2233,
          "old_api": "strtoul",
          "new_api": "strncmp",
          "old_text": "strtoul(completionTag + 5,\n\t\t\t\t\t\t\t\t\t\t\t\t\t  NULL, 10)",
          "new_text": "strncmp(completionTag, \"COPY \", 5)",
          "old_line_content": "\t\t\t\t\t_SPI_current->processed = strtoul(completionTag + 5,",
          "new_line_content": "\t\t\t\t\tAssert(strncmp(completionTag, \"COPY \", 5) == 0);",
          "content_same": false
        },
        {
          "line": 2411,
          "old_api": "elog",
          "new_api": "_SPI_checktuples",
          "old_text": "elog(ERROR, \"consistency check on SPI tuple count failed\")",
          "new_text": "_SPI_checktuples()",
          "old_line_content": "\t\t\telog(ERROR, \"consistency check on SPI tuple count failed\");",
          "new_line_content": "\t\tif (_SPI_checktuples())",
          "content_same": false
        },
        {
          "line": 2415,
          "old_api": "ExecutorEnd",
          "new_api": "ExecutorFinish",
          "old_text": "ExecutorEnd(queryDesc)",
          "new_text": "ExecutorFinish(queryDesc)",
          "old_line_content": "\tExecutorEnd(queryDesc);",
          "new_line_content": "\tExecutorFinish(queryDesc);",
          "content_same": false
        },
        {
          "line": 2445,
          "old_api": "internalerrposition",
          "new_api": "errposition",
          "old_text": "internalerrposition(syntaxerrposition)",
          "new_text": "errposition(0)",
          "old_line_content": "\t\tinternalerrposition(syntaxerrposition);",
          "new_line_content": "\t\terrposition(0);",
          "content_same": false
        },
        {
          "line": 2446,
          "old_api": "internalerrquery",
          "new_api": "internalerrposition",
          "old_text": "internalerrquery(query)",
          "new_text": "internalerrposition(syntaxerrposition)",
          "old_line_content": "\t\tinternalerrquery(query);",
          "new_line_content": "\t\tinternalerrposition(syntaxerrposition);",
          "content_same": false
        },
        {
          "line": 2465,
          "old_api": "elog",
          "new_api": "PortalIsValid",
          "old_text": "elog(ERROR, \"invalid portal in SPI cursor operation\")",
          "new_text": "PortalIsValid(portal)",
          "old_line_content": "\t\telog(ERROR, \"invalid portal in SPI cursor operation\");",
          "new_line_content": "\tif (!PortalIsValid(portal))",
          "content_same": false
        },
        {
          "line": 2469,
          "old_api": "elog",
          "new_api": "_SPI_begin_call",
          "old_text": "elog(ERROR, \"SPI cursor operation called while not connected\")",
          "new_text": "_SPI_begin_call(true)",
          "old_line_content": "\t\telog(ERROR, \"SPI cursor operation called while not connected\");",
          "new_line_content": "\tif (_SPI_begin_call(true) < 0)",
          "content_same": false
        },
        {
          "line": 2494,
          "old_api": "elog",
          "new_api": "_SPI_checktuples",
          "old_text": "elog(ERROR, \"consistency check on SPI tuple count failed\")",
          "new_text": "_SPI_checktuples()",
          "old_line_content": "\t\telog(ERROR, \"consistency check on SPI tuple count failed\");",
          "new_line_content": "\tif (dest->mydest == DestSPI && _SPI_checktuples())",
          "content_same": false
        },
        {
          "line": 2624,
          "old_api": "memcpy",
          "new_api": "palloc",
          "old_text": "memcpy(newplan->argtypes, plan->argtypes, plan->nargs * sizeof(Oid))",
          "new_text": "palloc(plan->nargs * sizeof(Oid))",
          "old_line_content": "\t\tmemcpy(newplan->argtypes, plan->argtypes, plan->nargs * sizeof(Oid));",
          "new_line_content": "\t\tnewplan->argtypes = (Oid *) palloc(plan->nargs * sizeof(Oid));",
          "content_same": false
        },
        {
          "line": 2693,
          "old_api": "memcpy",
          "new_api": "palloc",
          "old_text": "memcpy(newplan->argtypes, plan->argtypes, plan->nargs * sizeof(Oid))",
          "new_text": "palloc(plan->nargs * sizeof(Oid))",
          "old_line_content": "\t\tmemcpy(newplan->argtypes, plan->argtypes, plan->nargs * sizeof(Oid));",
          "new_line_content": "\t\tnewplan->argtypes = (Oid *) palloc(plan->nargs * sizeof(Oid));",
          "content_same": false
        },
        {
          "line": 2707,
          "old_api": "lappend",
          "new_api": "CopyCachedPlan",
          "old_text": "lappend(newplan->plancache_list, newsource)",
          "new_text": "CopyCachedPlan(plansource)",
          "old_line_content": "\t\tnewplan->plancache_list = lappend(newplan->plancache_list, newsource);",
          "new_line_content": "\t\tnewsource = CopyCachedPlan(plansource);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 2048,
          "old_api": null,
          "new_api": "foreach",
          "old_text": null,
          "new_text": "foreach(lc1, plan->plancache_list)",
          "old_line_content": "\t{",
          "new_line_content": "\tforeach(lc1, plan->plancache_list)",
          "content_same": false
        },
        {
          "line": 2050,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(lc1)",
          "old_line_content": "\t\tList\t   *stmt_list;",
          "new_line_content": "\t\tCachedPlanSource *plansource = (CachedPlanSource *) lfirst(lc1);",
          "content_same": false
        },
        {
          "line": 2074,
          "old_api": null,
          "new_api": "pg_analyze_and_rewrite_params",
          "old_text": null,
          "new_text": "pg_analyze_and_rewrite_params(parsetree,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  src,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  plan->parserSetup,\n\t\t\t\t\t\t\t\t\t\t\t\t\t   plan->parserSetupArg)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t\t\t  src,",
          "new_line_content": "\t\t\t\tstmt_list = pg_analyze_and_rewrite_params(parsetree,",
          "content_same": false
        },
        {
          "line": 2081,
          "old_api": null,
          "new_api": "pg_analyze_and_rewrite",
          "old_text": null,
          "new_text": "pg_analyze_and_rewrite(parsetree,\n\t\t\t\t\t\t\t\t\t\t\t\t   src,\n\t\t\t\t\t\t\t\t\t\t\t\t   plan->argtypes,\n\t\t\t\t\t\t\t\t\t\t\t\t   plan->nargs)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t   src,",
          "new_line_content": "\t\t\t\tstmt_list = pg_analyze_and_rewrite(parsetree,",
          "content_same": false
        },
        {
          "line": 2597,
          "old_api": null,
          "new_api": "Assert",
          "old_text": null,
          "new_text": "Assert(plan->plancxt == NULL)",
          "old_line_content": "\t/* One-shot plans can't be saved */",
          "new_line_content": "\tAssert(plan->plancxt == NULL);",
          "content_same": false
        },
        {
          "line": 2599,
          "old_api": null,
          "new_api": "Assert",
          "old_text": null,
          "new_text": "Assert(!plan->oneshot)",
          "old_line_content": "",
          "new_line_content": "\tAssert(!plan->oneshot);",
          "content_same": false
        },
        {
          "line": 2088,
          "old_api": null,
          "new_api": "CompleteCachedPlan",
          "old_text": null,
          "new_text": "CompleteCachedPlan(plansource,\n\t\t\t\t\t\t\t   stmt_list,\n\t\t\t\t\t\t\t   NULL,\n\t\t\t\t\t\t\t   plan->argtypes,\n\t\t\t\t\t\t\t   plan->nargs,\n\t\t\t\t\t\t\t   plan->parserSetup,\n\t\t\t\t\t\t\t   plan->parserSetupArg,\n\t\t\t\t\t\t\t   plan->cursor_options,\n\t\t\t\t\t\t\t   false)",
          "old_line_content": "\t\t\t\t\t\t\t   stmt_list,",
          "new_line_content": "\t\t\tCompleteCachedPlan(plansource,",
          "content_same": false
        },
        {
          "line": 2606,
          "old_api": null,
          "new_api": "AllocSetContextCreate",
          "old_text": null,
          "new_text": "AllocSetContextCreate(parentcxt,\n\t\t\t\t\t\t\t\t\t\"SPI Plan\",\n\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_MINSIZE,\n\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_INITSIZE,\n\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_MAXSIZE)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\"SPI Plan\",",
          "new_line_content": "\tplancxt = AllocSetContextCreate(parentcxt,",
          "content_same": false
        },
        {
          "line": 2611,
          "old_api": null,
          "new_api": "MemoryContextSwitchTo",
          "old_text": null,
          "new_text": "MemoryContextSwitchTo(plancxt)",
          "old_line_content": "",
          "new_line_content": "\toldcxt = MemoryContextSwitchTo(plancxt);",
          "content_same": false
        },
        {
          "line": 2614,
          "old_api": null,
          "new_api": "palloc",
          "old_text": null,
          "new_text": "palloc(sizeof(_SPI_plan))",
          "old_line_content": "\tnewplan->magic = _SPI_PLAN_MAGIC;",
          "new_line_content": "\tnewplan = (SPIPlanPtr) palloc(sizeof(_SPI_plan));",
          "content_same": false
        },
        {
          "line": 2103,
          "old_api": null,
          "new_api": "GetCachedPlan",
          "old_text": null,
          "new_text": "GetCachedPlan(plansource, paramLI, plan->saved)",
          "old_line_content": "\t\tstmt_list = cplan->stmt_list;",
          "new_line_content": "\t\tcplan = GetCachedPlan(plansource, paramLI, plan->saved);",
          "content_same": false
        },
        {
          "line": 2625,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(newplan->argtypes, plan->argtypes, plan->nargs * sizeof(Oid))",
          "old_line_content": "\t}",
          "new_line_content": "\t\tmemcpy(newplan->argtypes, plan->argtypes, plan->nargs * sizeof(Oid));",
          "content_same": false
        },
        {
          "line": 2114,
          "old_api": null,
          "new_api": "GetTransactionSnapshot",
          "old_text": null,
          "new_text": "GetTransactionSnapshot()",
          "old_line_content": "\t\t\tpushed_active_snap = true;",
          "new_line_content": "\t\t\tPushActiveSnapshot(GetTransactionSnapshot());",
          "content_same": false
        },
        {
          "line": 2120,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(lc2)",
          "old_line_content": "\t\t\tbool\t\tcanSetTag;",
          "new_line_content": "\t\t\tNode\t   *stmt = (Node *) lfirst(lc2);",
          "content_same": false
        },
        {
          "line": 2638,
          "old_api": null,
          "new_api": "foreach",
          "old_text": null,
          "new_text": "foreach(lc, plan->plancache_list)",
          "old_line_content": "\t{",
          "new_line_content": "\tforeach(lc, plan->plancache_list)",
          "content_same": false
        },
        {
          "line": 2128,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(stmt, PlannedStmt)",
          "old_line_content": "\t\t\t{",
          "new_line_content": "\t\t\tif (IsA(stmt, PlannedStmt))",
          "content_same": false
        },
        {
          "line": 2640,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(lc)",
          "old_line_content": "",
          "new_line_content": "\t\tCachedPlanSource *plansource = (CachedPlanSource *) lfirst(lc);",
          "content_same": false
        },
        {
          "line": 2642,
          "old_api": null,
          "new_api": "CachedPlanSetParentContext",
          "old_text": null,
          "new_text": "CachedPlanSetParentContext(plansource, parentcxt)",
          "old_line_content": "",
          "new_line_content": "\t\tCachedPlanSetParentContext(plansource, parentcxt);",
          "content_same": false
        },
        {
          "line": 2645,
          "old_api": null,
          "new_api": "lappend",
          "old_text": null,
          "new_text": "lappend(newplan->plancache_list, plansource)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tnewplan->plancache_list = lappend(newplan->plancache_list, plansource);",
          "content_same": false
        },
        {
          "line": 2135,
          "old_api": null,
          "new_api": "list_length",
          "old_text": null,
          "new_text": "list_length(stmt_list)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tcanSetTag = (list_length(stmt_list) == 1);",
          "content_same": false
        },
        {
          "line": 2648,
          "old_api": null,
          "new_api": "MemoryContextSwitchTo",
          "old_text": null,
          "new_text": "MemoryContextSwitchTo(oldcxt)",
          "old_line_content": "",
          "new_line_content": "\tMemoryContextSwitchTo(oldcxt);",
          "content_same": false
        },
        {
          "line": 2137,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(stmt, CopyStmt)",
          "old_line_content": "\t\t\t\t{",
          "new_line_content": "\t\t\t\tif (IsA(stmt, CopyStmt))",
          "content_same": false
        },
        {
          "line": 2147,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(stmt, TransactionStmt)",
          "old_line_content": "\t\t\t\t{",
          "new_line_content": "\t\t\t\telse if (IsA(stmt, TransactionStmt))",
          "content_same": false
        },
        {
          "line": 2156,
          "old_api": null,
          "new_api": "errcode",
          "old_text": null,
          "new_text": "errcode(ERRCODE_FEATURE_NOT_SUPPORTED)",
          "old_line_content": "\t\t\t\t/* translator: %s is a SQL statement name */",
          "new_line_content": "\t\t\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),",
          "content_same": false
        },
        {
          "line": 2668,
          "old_api": null,
          "new_api": "Assert",
          "old_text": null,
          "new_text": "Assert(!plan->oneshot)",
          "old_line_content": "",
          "new_line_content": "\tAssert(!plan->oneshot);",
          "content_same": false
        },
        {
          "line": 2159,
          "old_api": null,
          "new_api": "CreateCommandTag",
          "old_text": null,
          "new_text": "CreateCommandTag(stmt)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t\t\t\t  CreateCommandTag(stmt))));",
          "content_same": false
        },
        {
          "line": 2162,
          "old_api": null,
          "new_api": "CreateCommandTag",
          "old_text": null,
          "new_text": "CreateCommandTag(stmt)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tPreventCommandIfParallelMode(CreateCommandTag(stmt));",
          "content_same": false
        },
        {
          "line": 2675,
          "old_api": null,
          "new_api": "AllocSetContextCreate",
          "old_text": null,
          "new_text": "AllocSetContextCreate(CurrentMemoryContext,\n\t\t\t\t\t\t\t\t\t\"SPI Plan\",\n\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_MINSIZE,\n\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_INITSIZE,\n\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_MAXSIZE)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\"SPI Plan\",",
          "new_line_content": "\tplancxt = AllocSetContextCreate(CurrentMemoryContext,",
          "content_same": false
        },
        {
          "line": 2680,
          "old_api": null,
          "new_api": "MemoryContextSwitchTo",
          "old_text": null,
          "new_text": "MemoryContextSwitchTo(plancxt)",
          "old_line_content": "",
          "new_line_content": "\toldcxt = MemoryContextSwitchTo(plancxt);",
          "content_same": false
        },
        {
          "line": 2683,
          "old_api": null,
          "new_api": "palloc",
          "old_text": null,
          "new_text": "palloc(sizeof(_SPI_plan))",
          "old_line_content": "\tnewplan->magic = _SPI_PLAN_MAGIC;",
          "new_line_content": "\tnewplan = (SPIPlanPtr) palloc(sizeof(_SPI_plan));",
          "content_same": false
        },
        {
          "line": 2171,
          "old_api": null,
          "new_api": "UpdateActiveSnapshotCommandId",
          "old_text": null,
          "new_text": "UpdateActiveSnapshotCommandId()",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tUpdateActiveSnapshotCommandId();",
          "content_same": false
        },
        {
          "line": 2174,
          "old_api": null,
          "new_api": "CreateDestReceiver",
          "old_text": null,
          "new_text": "CreateDestReceiver(canSetTag ? DestSPI : DestNone)",
          "old_line_content": "",
          "new_line_content": "\t\t\tdest = CreateDestReceiver(canSetTag ? DestSPI : DestNone);",
          "content_same": false
        },
        {
          "line": 2176,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(stmt, PlannedStmt)",
          "old_line_content": "\t\t\t\t((PlannedStmt *) stmt)->utilityStmt == NULL)",
          "new_line_content": "\t\t\tif (IsA(stmt, PlannedStmt) &&",
          "content_same": false
        },
        {
          "line": 2694,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(newplan->argtypes, plan->argtypes, plan->nargs * sizeof(Oid))",
          "old_line_content": "\t}",
          "new_line_content": "\t\tmemcpy(newplan->argtypes, plan->argtypes, plan->nargs * sizeof(Oid));",
          "content_same": false
        },
        {
          "line": 2183,
          "old_api": null,
          "new_api": "GetActiveSnapshot",
          "old_text": null,
          "new_text": "GetActiveSnapshot()",
          "old_line_content": "\t\t\t\telse",
          "new_line_content": "\t\t\t\t\tsnap = GetActiveSnapshot();",
          "content_same": false
        },
        {
          "line": 2187,
          "old_api": null,
          "new_api": "CreateQueryDesc",
          "old_text": null,
          "new_text": "CreateQueryDesc((PlannedStmt *) stmt,\n\t\t\t\t\t\t\t\t\t\tplansource->query_string,\n\t\t\t\t\t\t\t\t\t\tsnap, crosscheck_snapshot,\n\t\t\t\t\t\t\t\t\t\tdest,\n\t\t\t\t\t\t\t\t\t\tparamLI, 0)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\tplansource->query_string,",
          "new_line_content": "\t\t\t\tqdesc = CreateQueryDesc((PlannedStmt *) stmt,",
          "content_same": false
        },
        {
          "line": 2702,
          "old_api": null,
          "new_api": "foreach",
          "old_text": null,
          "new_text": "foreach(lc, plan->plancache_list)",
          "old_line_content": "\t{",
          "new_line_content": "\tforeach(lc, plan->plancache_list)",
          "content_same": false
        },
        {
          "line": 2192,
          "old_api": null,
          "new_api": "_SPI_pquery",
          "old_text": null,
          "new_text": "_SPI_pquery(qdesc, fire_triggers,\n\t\t\t\t\t\t\t\t  canSetTag ? tcount : 0)",
          "old_line_content": "\t\t\t\t\t\t\t\t  canSetTag ? tcount : 0);",
          "new_line_content": "\t\t\t\tres = _SPI_pquery(qdesc, fire_triggers,",
          "content_same": false
        },
        {
          "line": 2704,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(lc)",
          "old_line_content": "\t\tCachedPlanSource *newsource;",
          "new_line_content": "\t\tCachedPlanSource *plansource = (CachedPlanSource *) lfirst(lc);",
          "content_same": false
        },
        {
          "line": 2194,
          "old_api": null,
          "new_api": "FreeQueryDesc",
          "old_text": null,
          "new_text": "FreeQueryDesc(qdesc)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tFreeQueryDesc(qdesc);",
          "content_same": false
        },
        {
          "line": 2708,
          "old_api": null,
          "new_api": "lappend",
          "old_text": null,
          "new_text": "lappend(newplan->plancache_list, newsource)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tnewplan->plancache_list = lappend(newplan->plancache_list, newsource);",
          "content_same": false
        },
        {
          "line": 2711,
          "old_api": null,
          "new_api": "MemoryContextSwitchTo",
          "old_text": null,
          "new_text": "MemoryContextSwitchTo(oldcxt)",
          "old_line_content": "",
          "new_line_content": "\tMemoryContextSwitchTo(oldcxt);",
          "content_same": false
        },
        {
          "line": 2200,
          "old_api": null,
          "new_api": "ProcessUtility",
          "old_text": null,
          "new_text": "ProcessUtility(stmt,\n\t\t\t\t\t\t\t   plansource->query_string,\n\t\t\t\t\t\t\t   PROCESS_UTILITY_QUERY,\n\t\t\t\t\t\t\t   paramLI,\n\t\t\t\t\t\t\t   dest,\n\t\t\t\t\t\t\t   completionTag)",
          "old_line_content": "\t\t\t\t\t\t\t   plansource->query_string,",
          "new_line_content": "\t\t\t\tProcessUtility(stmt,",
          "content_same": false
        },
        {
          "line": 2719,
          "old_api": null,
          "new_api": "MemoryContextSetParent",
          "old_text": null,
          "new_text": "MemoryContextSetParent(newplan->plancxt, CacheMemoryContext)",
          "old_line_content": "",
          "new_line_content": "\tMemoryContextSetParent(newplan->plancxt, CacheMemoryContext);",
          "content_same": false
        },
        {
          "line": 2721,
          "old_api": null,
          "new_api": "foreach",
          "old_text": null,
          "new_text": "foreach(lc, newplan->plancache_list)",
          "old_line_content": "\t{",
          "new_line_content": "\tforeach(lc, newplan->plancache_list)",
          "content_same": false
        },
        {
          "line": 2723,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(lc)",
          "old_line_content": "",
          "new_line_content": "\t\tCachedPlanSource *plansource = (CachedPlanSource *) lfirst(lc);",
          "content_same": false
        },
        {
          "line": 2725,
          "old_api": null,
          "new_api": "SaveCachedPlan",
          "old_text": null,
          "new_text": "SaveCachedPlan(plansource)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tSaveCachedPlan(plansource);",
          "content_same": false
        },
        {
          "line": 2218,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(stmt, CreateTableAsStmt)",
          "old_line_content": "\t\t\t\t{",
          "new_line_content": "\t\t\t\tif (IsA(stmt, CreateTableAsStmt))",
          "content_same": false
        },
        {
          "line": 2221,
          "old_api": null,
          "new_api": "strtoul",
          "old_text": null,
          "new_text": "strtoul(completionTag + 7,\n\t\t\t\t\t\t\t\t\t\t\t\t\t  NULL, 10)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t\t  NULL, 10);",
          "new_line_content": "\t\t\t\t\t_SPI_current->processed = strtoul(completionTag + 7,",
          "content_same": false
        },
        {
          "line": 2231,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(stmt, CopyStmt)",
          "old_line_content": "\t\t\t\t{",
          "new_line_content": "\t\t\t\telse if (IsA(stmt, CopyStmt))",
          "content_same": false
        },
        {
          "line": 2234,
          "old_api": null,
          "new_api": "strtoul",
          "old_text": null,
          "new_text": "strtoul(completionTag + 5,\n\t\t\t\t\t\t\t\t\t\t\t\t\t  NULL, 10)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t\t  NULL, 10);",
          "new_line_content": "\t\t\t\t\t_SPI_current->processed = strtoul(completionTag + 5,",
          "content_same": false
        },
        {
          "line": 2248,
          "old_api": null,
          "new_api": "SPI_freetuptable",
          "old_text": null,
          "new_text": "SPI_freetuptable(my_tuptable)",
          "old_line_content": "\t\t\t\tmy_tuptable = _SPI_current->tuptable;",
          "new_line_content": "\t\t\t\tSPI_freetuptable(my_tuptable);",
          "content_same": false
        },
        {
          "line": 2254,
          "old_api": null,
          "new_api": "SPI_freetuptable",
          "old_text": null,
          "new_text": "SPI_freetuptable(_SPI_current->tuptable)",
          "old_line_content": "\t\t\t\t_SPI_current->tuptable = NULL;",
          "new_line_content": "\t\t\t\tSPI_freetuptable(_SPI_current->tuptable);",
          "content_same": false
        },
        {
          "line": 2266,
          "old_api": null,
          "new_api": "ReleaseCachedPlan",
          "old_text": null,
          "new_text": "ReleaseCachedPlan(cplan, plan->saved)",
          "old_line_content": "\t\tcplan = NULL;",
          "new_line_content": "\t\tReleaseCachedPlan(cplan, plan->saved);",
          "content_same": false
        },
        {
          "line": 2275,
          "old_api": null,
          "new_api": "CommandCounterIncrement",
          "old_text": null,
          "new_text": "CommandCounterIncrement()",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tCommandCounterIncrement();",
          "content_same": false
        },
        {
          "line": 2282,
          "old_api": null,
          "new_api": "PopActiveSnapshot",
          "old_text": null,
          "new_text": "PopActiveSnapshot()",
          "old_line_content": "",
          "new_line_content": "\t\tPopActiveSnapshot();",
          "content_same": false
        },
        {
          "line": 2286,
          "old_api": null,
          "new_api": "ReleaseCachedPlan",
          "old_text": null,
          "new_text": "ReleaseCachedPlan(cplan, plan->saved)",
          "old_line_content": "",
          "new_line_content": "\t\tReleaseCachedPlan(cplan, plan->saved);",
          "content_same": false
        },
        {
          "line": 1803,
          "old_api": null,
          "new_api": "repalloc",
          "old_text": null,
          "new_text": "repalloc(tuptable->vals,\n\t\t\t\t\t\t\t\t\t  tuptable->alloced * sizeof(HeapTuple))",
          "old_line_content": "\t\t\t\t\t\t\t\t\t  tuptable->alloced * sizeof(HeapTuple));",
          "new_line_content": "\t\ttuptable->vals = (HeapTuple *) repalloc(tuptable->vals,",
          "content_same": false
        },
        {
          "line": 1808,
          "old_api": null,
          "new_api": "ExecCopySlotTuple",
          "old_text": null,
          "new_text": "ExecCopySlotTuple(slot)",
          "old_line_content": "\t(tuptable->free)--;",
          "new_line_content": "\t\tExecCopySlotTuple(slot);",
          "content_same": false
        },
        {
          "line": 1811,
          "old_api": null,
          "new_api": "MemoryContextSwitchTo",
          "old_text": null,
          "new_text": "MemoryContextSwitchTo(oldcxt)",
          "old_line_content": "}",
          "new_line_content": "\tMemoryContextSwitchTo(oldcxt);",
          "content_same": false
        },
        {
          "line": 2325,
          "old_api": null,
          "new_api": "offsetof",
          "old_text": null,
          "new_text": "offsetof(ParamListInfoData, params)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t nargs * sizeof(ParamExternData));",
          "new_line_content": "\t\tparamLI = (ParamListInfo) palloc(offsetof(ParamListInfoData, params) +",
          "content_same": false
        },
        {
          "line": 2359,
          "old_api": null,
          "new_api": "Assert",
          "old_text": null,
          "new_text": "Assert(queryDesc->plannedstmt->utilityStmt == NULL)",
          "old_line_content": "\t\t\tif (queryDesc->dest->mydest != DestSPI)",
          "new_line_content": "\t\t\tAssert(queryDesc->plannedstmt->utilityStmt == NULL);",
          "content_same": false
        },
        {
          "line": 1849,
          "old_api": null,
          "new_api": "pg_parse_query",
          "old_text": null,
          "new_text": "pg_parse_query(src)",
          "old_line_content": "",
          "new_line_content": "\traw_parsetree_list = pg_parse_query(src);",
          "content_same": false
        },
        {
          "line": 1859,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(list_item)",
          "old_line_content": "\t\tList\t   *stmt_list;",
          "new_line_content": "\t\tNode\t   *parsetree = (Node *) lfirst(list_item);",
          "content_same": false
        },
        {
          "line": 1867,
          "old_api": null,
          "new_api": "CreateCachedPlan",
          "old_text": null,
          "new_text": "CreateCachedPlan(parsetree,\n\t\t\t\t\t\t\t\t\t  src,\n\t\t\t\t\t\t\t\t\t  CreateCommandTag(parsetree))",
          "old_line_content": "\t\t\t\t\t\t\t\t\t  src,",
          "new_line_content": "\t\tplansource = CreateCachedPlan(parsetree,",
          "content_same": false
        },
        {
          "line": 1869,
          "old_api": null,
          "new_api": "CreateCommandTag",
          "old_text": null,
          "new_text": "CreateCommandTag(parsetree)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t\t\t\t\t\t  CreateCommandTag(parsetree));",
          "content_same": false
        },
        {
          "line": 1878,
          "old_api": null,
          "new_api": "pg_analyze_and_rewrite_params",
          "old_text": null,
          "new_text": "pg_analyze_and_rewrite_params(parsetree,\n\t\t\t\t\t\t\t\t\t\t\t\t\t  src,\n\t\t\t\t\t\t\t\t\t\t\t\t\t  plan->parserSetup,\n\t\t\t\t\t\t\t\t\t\t\t\t\t  plan->parserSetupArg)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t\t  src,",
          "new_line_content": "\t\t\tstmt_list = pg_analyze_and_rewrite_params(parsetree,",
          "content_same": false
        },
        {
          "line": 2392,
          "old_api": null,
          "new_api": "ResetUsage",
          "old_text": null,
          "new_text": "ResetUsage()",
          "old_line_content": "#endif",
          "new_line_content": "\t\tResetUsage();",
          "content_same": false
        },
        {
          "line": 1885,
          "old_api": null,
          "new_api": "pg_analyze_and_rewrite",
          "old_text": null,
          "new_text": "pg_analyze_and_rewrite(parsetree,\n\t\t\t\t\t\t\t\t\t\t\t   src,\n\t\t\t\t\t\t\t\t\t\t\t   plan->argtypes,\n\t\t\t\t\t\t\t\t\t\t\t   plan->nargs)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\t   src,",
          "new_line_content": "\t\t\tstmt_list = pg_analyze_and_rewrite(parsetree,",
          "content_same": false
        },
        {
          "line": 2401,
          "old_api": null,
          "new_api": "ExecutorStart",
          "old_text": null,
          "new_text": "ExecutorStart(queryDesc, eflags)",
          "old_line_content": "",
          "new_line_content": "\tExecutorStart(queryDesc, eflags);",
          "content_same": false
        },
        {
          "line": 2403,
          "old_api": null,
          "new_api": "ExecutorRun",
          "old_text": null,
          "new_text": "ExecutorRun(queryDesc, ForwardScanDirection, tcount)",
          "old_line_content": "",
          "new_line_content": "\tExecutorRun(queryDesc, ForwardScanDirection, tcount);",
          "content_same": false
        },
        {
          "line": 1892,
          "old_api": null,
          "new_api": "CompleteCachedPlan",
          "old_text": null,
          "new_text": "CompleteCachedPlan(plansource,\n\t\t\t\t\t\t   stmt_list,\n\t\t\t\t\t\t   NULL,\n\t\t\t\t\t\t   plan->argtypes,\n\t\t\t\t\t\t   plan->nargs,\n\t\t\t\t\t\t   plan->parserSetup,\n\t\t\t\t\t\t   plan->parserSetupArg,\n\t\t\t\t\t\t   plan->cursor_options,\n\t\t\t\t\t\t   false)",
          "old_line_content": "\t\t\t\t\t\t   stmt_list,",
          "new_line_content": "\t\tCompleteCachedPlan(plansource,",
          "content_same": false
        },
        {
          "line": 2412,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"consistency check on SPI tuple count failed\")",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\telog(ERROR, \"consistency check on SPI tuple count failed\");",
          "content_same": false
        },
        {
          "line": 1902,
          "old_api": null,
          "new_api": "lappend",
          "old_text": null,
          "new_text": "lappend(plancache_list, plansource)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tplancache_list = lappend(plancache_list, plansource);",
          "content_same": false
        },
        {
          "line": 2416,
          "old_api": null,
          "new_api": "ExecutorEnd",
          "old_text": null,
          "new_text": "ExecutorEnd(queryDesc)",
          "old_line_content": "\t/* FreeQueryDesc is done by the caller */",
          "new_line_content": "\tExecutorEnd(queryDesc);",
          "content_same": false
        },
        {
          "line": 2421,
          "old_api": null,
          "new_api": "ShowUsage",
          "old_text": null,
          "new_text": "ShowUsage(\"SPI EXECUTOR STATS\")",
          "old_line_content": "#endif",
          "new_line_content": "\t\tShowUsage(\"SPI EXECUTOR STATS\");",
          "content_same": false
        },
        {
          "line": 2442,
          "old_api": null,
          "new_api": "geterrposition",
          "old_text": null,
          "new_text": "geterrposition()",
          "old_line_content": "\tif (syntaxerrposition > 0)",
          "new_line_content": "\tsyntaxerrposition = geterrposition();",
          "content_same": false
        },
        {
          "line": 2447,
          "old_api": null,
          "new_api": "internalerrquery",
          "old_text": null,
          "new_text": "internalerrquery(query)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tinternalerrquery(query);",
          "content_same": false
        },
        {
          "line": 2450,
          "old_api": null,
          "new_api": "errcontext",
          "old_text": null,
          "new_text": "errcontext(\"SQL statement \\\"%s\\\"\", query)",
          "old_line_content": "}",
          "new_line_content": "\t\terrcontext(\"SQL statement \\\"%s\\\"\", query);",
          "content_same": false
        },
        {
          "line": 1952,
          "old_api": null,
          "new_api": "pg_parse_query",
          "old_text": null,
          "new_text": "pg_parse_query(src)",
          "old_line_content": "",
          "new_line_content": "\traw_parsetree_list = pg_parse_query(src);",
          "content_same": false
        },
        {
          "line": 2466,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"invalid portal in SPI cursor operation\")",
          "old_line_content": "",
          "new_line_content": "\t\telog(ERROR, \"invalid portal in SPI cursor operation\");",
          "content_same": false
        },
        {
          "line": 2470,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"SPI cursor operation called while not connected\")",
          "old_line_content": "",
          "new_line_content": "\t\telog(ERROR, \"SPI cursor operation called while not connected\");",
          "content_same": false
        },
        {
          "line": 1961,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(list_item)",
          "old_line_content": "\t\tCachedPlanSource *plansource;",
          "new_line_content": "\t\tNode\t   *parsetree = (Node *) lfirst(list_item);",
          "content_same": false
        },
        {
          "line": 1964,
          "old_api": null,
          "new_api": "CreateOneShotCachedPlan",
          "old_text": null,
          "new_text": "CreateOneShotCachedPlan(parsetree,\n\t\t\t\t\t\t\t\t\t\t\t src,\n\t\t\t\t\t\t\t\t\t\t\t CreateCommandTag(parsetree))",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\t src,",
          "new_line_content": "\t\tplansource = CreateOneShotCachedPlan(parsetree,",
          "content_same": false
        },
        {
          "line": 1966,
          "old_api": null,
          "new_api": "CreateCommandTag",
          "old_text": null,
          "new_text": "CreateCommandTag(parsetree)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t\t CreateCommandTag(parsetree));",
          "content_same": false
        },
        {
          "line": 2479,
          "old_api": null,
          "new_api": "PortalRunFetch",
          "old_text": null,
          "new_text": "PortalRunFetch(portal,\n\t\t\t\t\t\t\t  direction,\n\t\t\t\t\t\t\t  count,\n\t\t\t\t\t\t\t  dest)",
          "old_line_content": "\t\t\t\t\t\t\t  direction,",
          "new_line_content": "\tnfetched = PortalRunFetch(portal,",
          "content_same": false
        },
        {
          "line": 1968,
          "old_api": null,
          "new_api": "lappend",
          "old_text": null,
          "new_text": "lappend(plancache_list, plansource)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tplancache_list = lappend(plancache_list, plansource);",
          "content_same": false
        },
        {
          "line": 2495,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"consistency check on SPI tuple count failed\")",
          "old_line_content": "",
          "new_line_content": "\t\telog(ERROR, \"consistency check on SPI tuple count failed\");",
          "content_same": false
        },
        {
          "line": 2505,
          "old_api": null,
          "new_api": "_SPI_end_call",
          "old_text": null,
          "new_text": "_SPI_end_call(true)",
          "old_line_content": "}",
          "new_line_content": "\t_SPI_end_call(true);",
          "content_same": false
        },
        {
          "line": 2512,
          "old_api": null,
          "new_api": "MemoryContextSwitchTo",
          "old_text": null,
          "new_text": "MemoryContextSwitchTo(_SPI_current->execCxt)",
          "old_line_content": "}",
          "new_line_content": "\treturn MemoryContextSwitchTo(_SPI_current->execCxt);",
          "content_same": false
        },
        {
          "line": 2518,
          "old_api": null,
          "new_api": "MemoryContextSwitchTo",
          "old_text": null,
          "new_text": "MemoryContextSwitchTo(_SPI_current->procCxt)",
          "old_line_content": "}",
          "new_line_content": "\treturn MemoryContextSwitchTo(_SPI_current->procCxt);",
          "content_same": false
        },
        {
          "line": 2531,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"SPI stack corrupted\")",
          "old_line_content": "",
          "new_line_content": "\t\telog(ERROR, \"SPI stack corrupted\");",
          "content_same": false
        },
        {
          "line": 2534,
          "old_api": null,
          "new_api": "_SPI_execmem",
          "old_text": null,
          "new_text": "_SPI_execmem()",
          "old_line_content": "",
          "new_line_content": "\t\t_SPI_execmem();",
          "content_same": false
        },
        {
          "line": 2037,
          "old_api": null,
          "new_api": "PushActiveSnapshot",
          "old_text": null,
          "new_text": "PushActiveSnapshot(snapshot)",
          "old_line_content": "\t\t\tpushed_active_snap = true;",
          "new_line_content": "\t\t\tPushActiveSnapshot(snapshot);",
          "content_same": false
        },
        {
          "line": 2554,
          "old_api": null,
          "new_api": "_SPI_procmem",
          "old_text": null,
          "new_text": "_SPI_procmem()",
          "old_line_content": "\t\t/* and free Executor memory */",
          "new_line_content": "\t\t_SPI_procmem();",
          "content_same": false
        },
        {
          "line": 2043,
          "old_api": null,
          "new_api": "PushCopiedSnapshot",
          "old_text": null,
          "new_text": "PushCopiedSnapshot(snapshot)",
          "old_line_content": "\t\t\tpushed_active_snap = true;",
          "new_line_content": "\t\t\tPushCopiedSnapshot(snapshot);",
          "content_same": false
        },
        {
          "line": 2556,
          "old_api": null,
          "new_api": "MemoryContextResetAndDeleteChildren",
          "old_text": null,
          "new_text": "MemoryContextResetAndDeleteChildren(_SPI_current->execCxt)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tMemoryContextResetAndDeleteChildren(_SPI_current->execCxt);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 2049,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc1)",
          "new_text": null,
          "old_line_content": "\t\tCachedPlanSource *plansource = (CachedPlanSource *) lfirst(lc1);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 2072,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(plan->nargs == 0)",
          "new_text": null,
          "old_line_content": "\t\t\t\tAssert(plan->nargs == 0);",
          "new_line_content": "\t\t\t{",
          "content_same": false
        },
        {
          "line": 2080,
          "old_api": "pg_analyze_and_rewrite",
          "new_api": null,
          "old_text": "pg_analyze_and_rewrite(parsetree,\n\t\t\t\t\t\t\t\t\t\t\t\t   src,\n\t\t\t\t\t\t\t\t\t\t\t\t   plan->argtypes,\n\t\t\t\t\t\t\t\t\t\t\t\t   plan->nargs)",
          "new_text": null,
          "old_line_content": "\t\t\t\tstmt_list = pg_analyze_and_rewrite(parsetree,",
          "new_line_content": "\t\t\t{",
          "content_same": false
        },
        {
          "line": 2595,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(plan->magic == _SPI_PLAN_MAGIC)",
          "new_text": null,
          "old_line_content": "\tAssert(plan->magic == _SPI_PLAN_MAGIC);",
          "new_line_content": "\t/* Assert the input is a temporary SPIPlan */",
          "content_same": false
        },
        {
          "line": 2598,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(!plan->oneshot)",
          "new_text": null,
          "old_line_content": "\tAssert(!plan->oneshot);",
          "new_line_content": "\t/* One-shot plans can't be saved */",
          "content_same": false
        },
        {
          "line": 2087,
          "old_api": "CompleteCachedPlan",
          "new_api": null,
          "old_text": "CompleteCachedPlan(plansource,\n\t\t\t\t\t\t\t   stmt_list,\n\t\t\t\t\t\t\t   NULL,\n\t\t\t\t\t\t\t   plan->argtypes,\n\t\t\t\t\t\t\t   plan->nargs,\n\t\t\t\t\t\t\t   plan->parserSetup,\n\t\t\t\t\t\t\t   plan->parserSetupArg,\n\t\t\t\t\t\t\t   plan->cursor_options,\n\t\t\t\t\t\t\t   false)",
          "new_text": null,
          "old_line_content": "\t\t\tCompleteCachedPlan(plansource,",
          "new_line_content": "\t\t\t/* Finish filling in the CachedPlanSource */",
          "content_same": false
        },
        {
          "line": 2605,
          "old_api": "AllocSetContextCreate",
          "new_api": null,
          "old_text": "AllocSetContextCreate(parentcxt,\n\t\t\t\t\t\t\t\t\t\"SPI Plan\",\n\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_MINSIZE,\n\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_INITSIZE,\n\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_MAXSIZE)",
          "new_text": null,
          "old_line_content": "\tplancxt = AllocSetContextCreate(parentcxt,",
          "new_line_content": "\t */",
          "content_same": false
        },
        {
          "line": 2610,
          "old_api": "MemoryContextSwitchTo",
          "new_api": null,
          "old_text": "MemoryContextSwitchTo(plancxt)",
          "new_text": null,
          "old_line_content": "\toldcxt = MemoryContextSwitchTo(plancxt);",
          "new_line_content": "\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_MAXSIZE);",
          "content_same": false
        },
        {
          "line": 2613,
          "old_api": "palloc",
          "new_api": null,
          "old_text": "palloc(sizeof(_SPI_plan))",
          "new_text": null,
          "old_line_content": "\tnewplan = (SPIPlanPtr) palloc(sizeof(_SPI_plan));",
          "new_line_content": "\t/* Copy the SPI_plan struct and subsidiary data into the new context */",
          "content_same": false
        },
        {
          "line": 2102,
          "old_api": "GetCachedPlan",
          "new_api": null,
          "old_text": "GetCachedPlan(plansource, paramLI, plan->saved)",
          "new_text": null,
          "old_line_content": "\t\tcplan = GetCachedPlan(plansource, paramLI, plan->saved);",
          "new_line_content": "\t\t */",
          "content_same": false
        },
        {
          "line": 2623,
          "old_api": "palloc",
          "new_api": null,
          "old_text": "palloc(plan->nargs * sizeof(Oid))",
          "new_text": null,
          "old_line_content": "\t\tnewplan->argtypes = (Oid *) palloc(plan->nargs * sizeof(Oid));",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 2112,
          "old_api": "PopActiveSnapshot",
          "new_api": null,
          "old_text": "PopActiveSnapshot()",
          "new_text": null,
          "old_line_content": "\t\t\t\tPopActiveSnapshot();",
          "new_line_content": "\t\t\tif (pushed_active_snap)",
          "content_same": false
        },
        {
          "line": 2119,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc2)",
          "new_text": null,
          "old_line_content": "\t\t\tNode\t   *stmt = (Node *) lfirst(lc2);",
          "new_line_content": "\t\t{",
          "content_same": false
        },
        {
          "line": 2637,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(lc, plan->plancache_list)",
          "new_text": null,
          "old_line_content": "\tforeach(lc, plan->plancache_list)",
          "new_line_content": "\t */",
          "content_same": false
        },
        {
          "line": 2127,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(stmt, PlannedStmt)",
          "new_text": null,
          "old_line_content": "\t\t\tif (IsA(stmt, PlannedStmt))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2639,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc)",
          "new_text": null,
          "old_line_content": "\t\tCachedPlanSource *plansource = (CachedPlanSource *) lfirst(lc);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 2641,
          "old_api": "CachedPlanSetParentContext",
          "new_api": null,
          "old_text": "CachedPlanSetParentContext(plansource, parentcxt)",
          "new_text": null,
          "old_line_content": "\t\tCachedPlanSetParentContext(plansource, parentcxt);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2644,
          "old_api": "lappend",
          "new_api": null,
          "old_text": "lappend(newplan->plancache_list, plansource)",
          "new_text": null,
          "old_line_content": "\t\tnewplan->plancache_list = lappend(newplan->plancache_list, plansource);",
          "new_line_content": "\t\t/* Build new list, with list cells in plancxt */",
          "content_same": false
        },
        {
          "line": 2134,
          "old_api": "list_length",
          "new_api": null,
          "old_text": "list_length(stmt_list)",
          "new_text": null,
          "old_line_content": "\t\t\t\tcanSetTag = (list_length(stmt_list) == 1);",
          "new_line_content": "\t\t\t\t/* utilities are canSetTag if only thing in list */",
          "content_same": false
        },
        {
          "line": 2647,
          "old_api": "MemoryContextSwitchTo",
          "new_api": null,
          "old_text": "MemoryContextSwitchTo(oldcxt)",
          "new_text": null,
          "old_line_content": "\tMemoryContextSwitchTo(oldcxt);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2136,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(stmt, CopyStmt)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (IsA(stmt, CopyStmt))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2146,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(stmt, TransactionStmt)",
          "new_text": null,
          "old_line_content": "\t\t\t\telse if (IsA(stmt, TransactionStmt))",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 2153,
          "old_api": "CommandIsReadOnly",
          "new_api": null,
          "old_text": "CommandIsReadOnly(stmt)",
          "new_text": null,
          "old_line_content": "\t\t\tif (read_only && !CommandIsReadOnly(stmt))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2667,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(!plan->oneshot)",
          "new_text": null,
          "old_line_content": "\tAssert(!plan->oneshot);",
          "new_line_content": "\t/* One-shot plans can't be saved */",
          "content_same": false
        },
        {
          "line": 2157,
          "old_api": "errmsg",
          "new_api": null,
          "old_text": "errmsg(\"%s is not allowed in a non-volatile function\",\n\t\t\t\t\t\t\t  CreateCommandTag(stmt))",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t   errmsg(\"%s is not allowed in a non-volatile function\",",
          "new_line_content": "\t\t\t\t/* translator: %s is a SQL statement name */",
          "content_same": false
        },
        {
          "line": 2160,
          "old_api": "CommandIsReadOnly",
          "new_api": null,
          "old_text": "CommandIsReadOnly(stmt)",
          "new_text": null,
          "old_line_content": "\t\t\tif (IsInParallelMode() && !CommandIsReadOnly(stmt))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2674,
          "old_api": "AllocSetContextCreate",
          "new_api": null,
          "old_text": "AllocSetContextCreate(CurrentMemoryContext,\n\t\t\t\t\t\t\t\t\t\"SPI Plan\",\n\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_MINSIZE,\n\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_INITSIZE,\n\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_MAXSIZE)",
          "new_text": null,
          "old_line_content": "\tplancxt = AllocSetContextCreate(CurrentMemoryContext,",
          "new_line_content": "\t */",
          "content_same": false
        },
        {
          "line": 2679,
          "old_api": "MemoryContextSwitchTo",
          "new_api": null,
          "old_text": "MemoryContextSwitchTo(plancxt)",
          "new_text": null,
          "old_line_content": "\toldcxt = MemoryContextSwitchTo(plancxt);",
          "new_line_content": "\t\t\t\t\t\t\t\t\tALLOCSET_SMALL_MAXSIZE);",
          "content_same": false
        },
        {
          "line": 2169,
          "old_api": "CommandCounterIncrement",
          "new_api": null,
          "old_text": "CommandCounterIncrement()",
          "new_text": null,
          "old_line_content": "\t\t\t\tCommandCounterIncrement();",
          "new_line_content": "\t\t\t{",
          "content_same": false
        },
        {
          "line": 2682,
          "old_api": "palloc",
          "new_api": null,
          "old_text": "palloc(sizeof(_SPI_plan))",
          "new_text": null,
          "old_line_content": "\tnewplan = (SPIPlanPtr) palloc(sizeof(_SPI_plan));",
          "new_line_content": "\t/* Copy the SPI plan into its own context */",
          "content_same": false
        },
        {
          "line": 2173,
          "old_api": "CreateDestReceiver",
          "new_api": null,
          "old_text": "CreateDestReceiver(canSetTag ? DestSPI : DestNone)",
          "new_text": null,
          "old_line_content": "\t\t\tdest = CreateDestReceiver(canSetTag ? DestSPI : DestNone);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2175,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(stmt, PlannedStmt)",
          "new_text": null,
          "old_line_content": "\t\t\tif (IsA(stmt, PlannedStmt) &&",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2692,
          "old_api": "palloc",
          "new_api": null,
          "old_text": "palloc(plan->nargs * sizeof(Oid))",
          "new_text": null,
          "old_line_content": "\t\tnewplan->argtypes = (Oid *) palloc(plan->nargs * sizeof(Oid));",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 2181,
          "old_api": "ActiveSnapshotSet",
          "new_api": null,
          "old_text": "ActiveSnapshotSet()",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (ActiveSnapshotSet())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2186,
          "old_api": "CreateQueryDesc",
          "new_api": null,
          "old_text": "CreateQueryDesc((PlannedStmt *) stmt,\n\t\t\t\t\t\t\t\t\t\tplansource->query_string,\n\t\t\t\t\t\t\t\t\t\tsnap, crosscheck_snapshot,\n\t\t\t\t\t\t\t\t\t\tdest,\n\t\t\t\t\t\t\t\t\t\tparamLI, 0)",
          "new_text": null,
          "old_line_content": "\t\t\t\tqdesc = CreateQueryDesc((PlannedStmt *) stmt,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2701,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(lc, plan->plancache_list)",
          "new_text": null,
          "old_line_content": "\tforeach(lc, plan->plancache_list)",
          "new_line_content": "\t/* Copy all the plancache entries */",
          "content_same": false
        },
        {
          "line": 2191,
          "old_api": "_SPI_pquery",
          "new_api": null,
          "old_text": "_SPI_pquery(qdesc, fire_triggers,\n\t\t\t\t\t\t\t\t  canSetTag ? tcount : 0)",
          "new_text": null,
          "old_line_content": "\t\t\t\tres = _SPI_pquery(qdesc, fire_triggers,",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\tparamLI, 0);",
          "content_same": false
        },
        {
          "line": 2703,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc)",
          "new_text": null,
          "old_line_content": "\t\tCachedPlanSource *plansource = (CachedPlanSource *) lfirst(lc);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 2193,
          "old_api": "FreeQueryDesc",
          "new_api": null,
          "old_text": "FreeQueryDesc(qdesc)",
          "new_text": null,
          "old_line_content": "\t\t\t\tFreeQueryDesc(qdesc);",
          "new_line_content": "\t\t\t\t\t\t\t\t  canSetTag ? tcount : 0);",
          "content_same": false
        },
        {
          "line": 2706,
          "old_api": "CopyCachedPlan",
          "new_api": null,
          "old_text": "CopyCachedPlan(plansource)",
          "new_text": null,
          "old_line_content": "\t\tnewsource = CopyCachedPlan(plansource);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2710,
          "old_api": "MemoryContextSwitchTo",
          "new_api": null,
          "old_text": "MemoryContextSwitchTo(oldcxt)",
          "new_text": null,
          "old_line_content": "\tMemoryContextSwitchTo(oldcxt);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2199,
          "old_api": "ProcessUtility",
          "new_api": null,
          "old_text": "ProcessUtility(stmt,\n\t\t\t\t\t\t\t   plansource->query_string,\n\t\t\t\t\t\t\t   PROCESS_UTILITY_QUERY,\n\t\t\t\t\t\t\t   paramLI,\n\t\t\t\t\t\t\t   dest,\n\t\t\t\t\t\t\t   completionTag)",
          "new_text": null,
          "old_line_content": "\t\t\t\tProcessUtility(stmt,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2718,
          "old_api": "MemoryContextSetParent",
          "new_api": null,
          "old_text": "MemoryContextSetParent(newplan->plancxt, CacheMemoryContext)",
          "new_text": null,
          "old_line_content": "\tMemoryContextSetParent(newplan->plancxt, CacheMemoryContext);",
          "new_line_content": "\tnewplan->saved = true;",
          "content_same": false
        },
        {
          "line": 2720,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(lc, newplan->plancache_list)",
          "new_text": null,
          "old_line_content": "\tforeach(lc, newplan->plancache_list)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2722,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc)",
          "new_text": null,
          "old_line_content": "\t\tCachedPlanSource *plansource = (CachedPlanSource *) lfirst(lc);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 2724,
          "old_api": "SaveCachedPlan",
          "new_api": null,
          "old_text": "SaveCachedPlan(plansource)",
          "new_text": null,
          "old_line_content": "\t\tSaveCachedPlan(plansource);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2217,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(stmt, CreateTableAsStmt)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (IsA(stmt, CreateTableAsStmt))",
          "new_line_content": "\t\t\t\t */",
          "content_same": false
        },
        {
          "line": 2219,
          "old_api": "strncmp",
          "new_api": null,
          "old_text": "strncmp(completionTag, \"SELECT \", 7)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tAssert(strncmp(completionTag, \"SELECT \", 7) == 0);",
          "new_line_content": "\t\t\t\t{",
          "content_same": false
        },
        {
          "line": 2230,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(stmt, CopyStmt)",
          "new_text": null,
          "old_line_content": "\t\t\t\telse if (IsA(stmt, CopyStmt))",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 2232,
          "old_api": "strncmp",
          "new_api": null,
          "old_text": "strncmp(completionTag, \"COPY \", 5)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tAssert(strncmp(completionTag, \"COPY \", 5) == 0);",
          "new_line_content": "\t\t\t\t{",
          "content_same": false
        },
        {
          "line": 2247,
          "old_api": "SPI_freetuptable",
          "new_api": null,
          "old_text": "SPI_freetuptable(my_tuptable)",
          "new_text": null,
          "old_line_content": "\t\t\t\tSPI_freetuptable(my_tuptable);",
          "new_line_content": "\t\t\t\tmy_lastoid = _SPI_current->lastoid;",
          "content_same": false
        },
        {
          "line": 2253,
          "old_api": "SPI_freetuptable",
          "new_api": null,
          "old_text": "SPI_freetuptable(_SPI_current->tuptable)",
          "new_text": null,
          "old_line_content": "\t\t\t\tSPI_freetuptable(_SPI_current->tuptable);",
          "new_line_content": "\t\t\t{",
          "content_same": false
        },
        {
          "line": 2265,
          "old_api": "ReleaseCachedPlan",
          "new_api": null,
          "old_text": "ReleaseCachedPlan(cplan, plan->saved)",
          "new_text": null,
          "old_line_content": "\t\tReleaseCachedPlan(cplan, plan->saved);",
          "new_line_content": "\t\t/* Done with this plan, so release refcount */",
          "content_same": false
        },
        {
          "line": 2274,
          "old_api": "CommandCounterIncrement",
          "new_api": null,
          "old_text": "CommandCounterIncrement()",
          "new_text": null,
          "old_line_content": "\t\t\tCommandCounterIncrement();",
          "new_line_content": "\t\tif (!read_only)",
          "content_same": false
        },
        {
          "line": 2281,
          "old_api": "PopActiveSnapshot",
          "new_api": null,
          "old_text": "PopActiveSnapshot()",
          "new_text": null,
          "old_line_content": "\t\tPopActiveSnapshot();",
          "new_line_content": "\tif (pushed_active_snap)",
          "content_same": false
        },
        {
          "line": 2285,
          "old_api": "ReleaseCachedPlan",
          "new_api": null,
          "old_text": "ReleaseCachedPlan(cplan, plan->saved)",
          "new_text": null,
          "old_line_content": "\t\tReleaseCachedPlan(cplan, plan->saved);",
          "new_line_content": "\tif (cplan)",
          "content_same": false
        },
        {
          "line": 1802,
          "old_api": "repalloc",
          "new_api": null,
          "old_text": "repalloc(tuptable->vals,\n\t\t\t\t\t\t\t\t\t  tuptable->alloced * sizeof(HeapTuple))",
          "new_text": null,
          "old_line_content": "\t\ttuptable->vals = (HeapTuple *) repalloc(tuptable->vals,",
          "new_line_content": "\t\ttuptable->alloced += tuptable->free;",
          "content_same": false
        },
        {
          "line": 1807,
          "old_api": "ExecCopySlotTuple",
          "new_api": null,
          "old_text": "ExecCopySlotTuple(slot)",
          "new_text": null,
          "old_line_content": "\t\tExecCopySlotTuple(slot);",
          "new_line_content": "\ttuptable->vals[tuptable->alloced - tuptable->free] =",
          "content_same": false
        },
        {
          "line": 1810,
          "old_api": "MemoryContextSwitchTo",
          "new_api": null,
          "old_text": "MemoryContextSwitchTo(oldcxt)",
          "new_text": null,
          "old_line_content": "\tMemoryContextSwitchTo(oldcxt);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2324,
          "old_api": "offsetof",
          "new_api": null,
          "old_text": "offsetof(ParamListInfoData, params)",
          "new_text": null,
          "old_line_content": "\t\tparamLI = (ParamListInfo) palloc(offsetof(ParamListInfoData, params) +",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2358,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(queryDesc->plannedstmt->utilityStmt == NULL)",
          "new_text": null,
          "old_line_content": "\t\t\tAssert(queryDesc->plannedstmt->utilityStmt == NULL);",
          "new_line_content": "\t\tcase CMD_SELECT:",
          "content_same": false
        },
        {
          "line": 1848,
          "old_api": "pg_parse_query",
          "new_api": null,
          "old_text": "pg_parse_query(src)",
          "new_text": null,
          "old_line_content": "\traw_parsetree_list = pg_parse_query(src);",
          "new_line_content": "\t */",
          "content_same": false
        },
        {
          "line": 1858,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(list_item)",
          "new_text": null,
          "old_line_content": "\t\tNode\t   *parsetree = (Node *) lfirst(list_item);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1866,
          "old_api": "CreateCachedPlan",
          "new_api": null,
          "old_text": "CreateCachedPlan(parsetree,\n\t\t\t\t\t\t\t\t\t  src,\n\t\t\t\t\t\t\t\t\t  CreateCommandTag(parsetree))",
          "new_text": null,
          "old_line_content": "\t\tplansource = CreateCachedPlan(parsetree,",
          "new_line_content": "\t\t */",
          "content_same": false
        },
        {
          "line": 1868,
          "old_api": "CreateCommandTag",
          "new_api": null,
          "old_text": "CreateCommandTag(parsetree)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t\t\t  CreateCommandTag(parsetree));",
          "new_line_content": "\t\t\t\t\t\t\t\t\t  src,",
          "content_same": false
        },
        {
          "line": 1876,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(plan->nargs == 0)",
          "new_text": null,
          "old_line_content": "\t\t\tAssert(plan->nargs == 0);",
          "new_line_content": "\t\t{",
          "content_same": false
        },
        {
          "line": 2391,
          "old_api": "ResetUsage",
          "new_api": null,
          "old_text": "ResetUsage()",
          "new_text": null,
          "old_line_content": "\t\tResetUsage();",
          "new_line_content": "\tif (ShowExecutorStats)",
          "content_same": false
        },
        {
          "line": 1884,
          "old_api": "pg_analyze_and_rewrite",
          "new_api": null,
          "old_text": "pg_analyze_and_rewrite(parsetree,\n\t\t\t\t\t\t\t\t\t\t\t   src,\n\t\t\t\t\t\t\t\t\t\t\t   plan->argtypes,\n\t\t\t\t\t\t\t\t\t\t\t   plan->nargs)",
          "new_text": null,
          "old_line_content": "\t\t\tstmt_list = pg_analyze_and_rewrite(parsetree,",
          "new_line_content": "\t\t{",
          "content_same": false
        },
        {
          "line": 2400,
          "old_api": "ExecutorStart",
          "new_api": null,
          "old_text": "ExecutorStart(queryDesc, eflags)",
          "new_text": null,
          "old_line_content": "\tExecutorStart(queryDesc, eflags);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2402,
          "old_api": "ExecutorRun",
          "new_api": null,
          "old_text": "ExecutorRun(queryDesc, ForwardScanDirection, tcount)",
          "new_text": null,
          "old_line_content": "\tExecutorRun(queryDesc, ForwardScanDirection, tcount);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1891,
          "old_api": "CompleteCachedPlan",
          "new_api": null,
          "old_text": "CompleteCachedPlan(plansource,\n\t\t\t\t\t\t   stmt_list,\n\t\t\t\t\t\t   NULL,\n\t\t\t\t\t\t   plan->argtypes,\n\t\t\t\t\t\t   plan->nargs,\n\t\t\t\t\t\t   plan->parserSetup,\n\t\t\t\t\t\t   plan->parserSetupArg,\n\t\t\t\t\t\t   plan->cursor_options,\n\t\t\t\t\t\t   false)",
          "new_text": null,
          "old_line_content": "\t\tCompleteCachedPlan(plansource,",
          "new_line_content": "\t\t/* Finish filling in the CachedPlanSource */",
          "content_same": false
        },
        {
          "line": 2410,
          "old_api": "_SPI_checktuples",
          "new_api": null,
          "old_text": "_SPI_checktuples()",
          "new_text": null,
          "old_line_content": "\t\tif (_SPI_checktuples())",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1901,
          "old_api": "lappend",
          "new_api": null,
          "old_text": "lappend(plancache_list, plansource)",
          "new_text": null,
          "old_line_content": "\t\tplancache_list = lappend(plancache_list, plansource);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2414,
          "old_api": "ExecutorFinish",
          "new_api": null,
          "old_text": "ExecutorFinish(queryDesc)",
          "new_text": null,
          "old_line_content": "\tExecutorFinish(queryDesc);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2420,
          "old_api": "ShowUsage",
          "new_api": null,
          "old_text": "ShowUsage(\"SPI EXECUTOR STATS\")",
          "new_text": null,
          "old_line_content": "\t\tShowUsage(\"SPI EXECUTOR STATS\");",
          "new_line_content": "\tif (ShowExecutorStats)",
          "content_same": false
        },
        {
          "line": 2441,
          "old_api": "geterrposition",
          "new_api": null,
          "old_text": "geterrposition()",
          "new_text": null,
          "old_line_content": "\tsyntaxerrposition = geterrposition();",
          "new_line_content": "\t */",
          "content_same": false
        },
        {
          "line": 2444,
          "old_api": "errposition",
          "new_api": null,
          "old_text": "errposition(0)",
          "new_text": null,
          "old_line_content": "\t\terrposition(0);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 2449,
          "old_api": "errcontext",
          "new_api": null,
          "old_text": "errcontext(\"SQL statement \\\"%s\\\"\", query)",
          "new_text": null,
          "old_line_content": "\t\terrcontext(\"SQL statement \\\"%s\\\"\", query);",
          "new_line_content": "\telse",
          "content_same": false
        },
        {
          "line": 1951,
          "old_api": "pg_parse_query",
          "new_api": null,
          "old_text": "pg_parse_query(src)",
          "new_text": null,
          "old_line_content": "\traw_parsetree_list = pg_parse_query(src);",
          "new_line_content": "\t */",
          "content_same": false
        },
        {
          "line": 2464,
          "old_api": "PortalIsValid",
          "new_api": null,
          "old_text": "PortalIsValid(portal)",
          "new_text": null,
          "old_line_content": "\tif (!PortalIsValid(portal))",
          "new_line_content": "\t/* Check that the portal is valid */",
          "content_same": false
        },
        {
          "line": 2468,
          "old_api": "_SPI_begin_call",
          "new_api": null,
          "old_text": "_SPI_begin_call(true)",
          "new_text": null,
          "old_line_content": "\tif (_SPI_begin_call(true) < 0)",
          "new_line_content": "\t/* Push the SPI stack */",
          "content_same": false
        },
        {
          "line": 1960,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(list_item)",
          "new_text": null,
          "old_line_content": "\t\tNode\t   *parsetree = (Node *) lfirst(list_item);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1963,
          "old_api": "CreateOneShotCachedPlan",
          "new_api": null,
          "old_text": "CreateOneShotCachedPlan(parsetree,\n\t\t\t\t\t\t\t\t\t\t\t src,\n\t\t\t\t\t\t\t\t\t\t\t CreateCommandTag(parsetree))",
          "new_text": null,
          "old_line_content": "\t\tplansource = CreateOneShotCachedPlan(parsetree,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1965,
          "old_api": "CreateCommandTag",
          "new_api": null,
          "old_text": "CreateCommandTag(parsetree)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\t CreateCommandTag(parsetree));",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t\t src,",
          "content_same": false
        },
        {
          "line": 2478,
          "old_api": "PortalRunFetch",
          "new_api": null,
          "old_text": "PortalRunFetch(portal,\n\t\t\t\t\t\t\t  direction,\n\t\t\t\t\t\t\t  count,\n\t\t\t\t\t\t\t  dest)",
          "new_text": null,
          "old_line_content": "\tnfetched = PortalRunFetch(portal,",
          "new_line_content": "\t/* Run the cursor */",
          "content_same": false
        },
        {
          "line": 1967,
          "old_api": "lappend",
          "new_api": null,
          "old_text": "lappend(plancache_list, plansource)",
          "new_text": null,
          "old_line_content": "\t\tplancache_list = lappend(plancache_list, plansource);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2493,
          "old_api": "_SPI_checktuples",
          "new_api": null,
          "old_text": "_SPI_checktuples()",
          "new_text": null,
          "old_line_content": "\tif (dest->mydest == DestSPI && _SPI_checktuples())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2504,
          "old_api": "_SPI_end_call",
          "new_api": null,
          "old_text": "_SPI_end_call(true)",
          "new_text": null,
          "old_line_content": "\t_SPI_end_call(true);",
          "new_line_content": "\t/* Pop the SPI stack */",
          "content_same": false
        },
        {
          "line": 2511,
          "old_api": "MemoryContextSwitchTo",
          "new_api": null,
          "old_text": "MemoryContextSwitchTo(_SPI_current->execCxt)",
          "new_text": null,
          "old_line_content": "\treturn MemoryContextSwitchTo(_SPI_current->execCxt);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2517,
          "old_api": "MemoryContextSwitchTo",
          "new_api": null,
          "old_text": "MemoryContextSwitchTo(_SPI_current->procCxt)",
          "new_text": null,
          "old_line_content": "\treturn MemoryContextSwitchTo(_SPI_current->procCxt);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2530,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR, \"SPI stack corrupted\")",
          "new_text": null,
          "old_line_content": "\t\telog(ERROR, \"SPI stack corrupted\");",
          "new_line_content": "\tif (_SPI_current != &(_SPI_stack[_SPI_curid]))",
          "content_same": false
        },
        {
          "line": 2533,
          "old_api": "_SPI_execmem",
          "new_api": null,
          "old_text": "_SPI_execmem()",
          "new_text": null,
          "old_line_content": "\t\t_SPI_execmem();",
          "new_line_content": "\tif (execmem)\t\t\t\t/* switch to the Executor memory context */",
          "content_same": false
        },
        {
          "line": 2036,
          "old_api": "PushActiveSnapshot",
          "new_api": null,
          "old_text": "PushActiveSnapshot(snapshot)",
          "new_text": null,
          "old_line_content": "\t\t\tPushActiveSnapshot(snapshot);",
          "new_line_content": "\t\t{",
          "content_same": false
        },
        {
          "line": 2553,
          "old_api": "_SPI_procmem",
          "new_api": null,
          "old_text": "_SPI_procmem()",
          "new_text": null,
          "old_line_content": "\t\t_SPI_procmem();",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 2042,
          "old_api": "PushCopiedSnapshot",
          "new_api": null,
          "old_text": "PushCopiedSnapshot(snapshot)",
          "new_text": null,
          "old_line_content": "\t\t\tPushCopiedSnapshot(snapshot);",
          "new_line_content": "\t\t\t/* Make sure we have a private copy of the snapshot to modify */",
          "content_same": false
        },
        {
          "line": 2555,
          "old_api": "MemoryContextResetAndDeleteChildren",
          "new_api": null,
          "old_text": "MemoryContextResetAndDeleteChildren(_SPI_current->execCxt)",
          "new_text": null,
          "old_line_content": "\t\tMemoryContextResetAndDeleteChildren(_SPI_current->execCxt);",
          "new_line_content": "\t\t/* and free Executor memory */",
          "content_same": false
        },
        {
          "line": 2047,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(lc1, plan->plancache_list)",
          "new_text": null,
          "old_line_content": "\tforeach(lc1, plan->plancache_list)",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 21,
      "total_additions": 97,
      "total_deletions": 97,
      "total_api_changes": 215
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 215,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          1800,
          1801
        ]
      }
    },
    "api_calls_before": 375,
    "api_calls_after": 375,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 1,
      "total_diff_lines": 15
    }
  }
}