{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/70066eb1a1adb4d1ac608c1127bbb3139fa09942",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/70066eb1a1adb4d1ac608c1127bbb3139fa09942/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/70066eb1a1adb4d1ac608c1127bbb3139fa09942/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/70066eb1a1adb4d1ac608c1127bbb3139fa09942/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1398,
          "old_api": "libpq_gettext",
          "new_api": "pqWait",
          "old_text": "libpq_gettext(\"out of memory\\n\")",
          "new_text": "pqWait(TRUE, FALSE, conn)",
          "old_line_content": "\t\t\t\t\t\t\t\t  libpq_gettext(\"out of memory\\n\"));",
          "new_line_content": "\t\t\tif (pqWait(TRUE, FALSE, conn) ||",
          "content_same": false
        },
        {
          "line": 1503,
          "old_api": "memcpy",
          "new_api": "getCopyDataMessage",
          "old_text": "memcpy(buffer, &conn->inBuffer[conn->inCursor], avail)",
          "new_text": "getCopyDataMessage(conn)",
          "old_line_content": "\t\tmemcpy(buffer, &conn->inBuffer[conn->inCursor], avail);",
          "new_line_content": "\tmsgLength = getCopyDataMessage(conn);",
          "content_same": false
        },
        {
          "line": 1551,
          "old_api": "pqPutMsgStart",
          "new_api": "libpq_gettext",
          "old_text": "pqPutMsgStart('S', false, conn)",
          "new_text": "libpq_gettext(\"no COPY in progress\\n\")",
          "old_line_content": "\t\t\tif (pqPutMsgStart('S', false, conn) < 0 ||",
          "new_line_content": "\t\t\t\t\t\t  libpq_gettext(\"no COPY in progress\\n\"));",
          "content_same": false
        },
        {
          "line": 1679,
          "old_api": "pqHandleSendFailure",
          "new_api": "pqPutnchar",
          "old_text": "pqHandleSendFailure(conn)",
          "new_text": "pqPutnchar((char *) args[i].u.ptr, args[i].len, conn)",
          "old_line_content": "\t\tpqHandleSendFailure(conn);",
          "new_line_content": "\t\t\tif (pqPutnchar((char *) args[i].u.ptr, args[i].len, conn))",
          "content_same": false
        },
        {
          "line": 1689,
          "old_api": "pqReadData",
          "new_api": "pqHandleSendFailure",
          "old_text": "pqReadData(conn)",
          "new_text": "pqHandleSendFailure(conn)",
          "old_line_content": "\t\t\t\tpqReadData(conn) < 0)",
          "new_line_content": "\t\tpqHandleSendFailure(conn);",
          "content_same": false
        },
        {
          "line": 1716,
          "old_api": "handleSyncLoss",
          "new_api": "pqGetc",
          "old_text": "handleSyncLoss(conn, id, msgLength)",
          "new_text": "pqGetc(&id, conn)",
          "old_line_content": "\t\t\thandleSyncLoss(conn, id, msgLength);",
          "new_line_content": "\t\tif (pqGetc(&id, conn))",
          "content_same": false
        },
        {
          "line": 1731,
          "old_api": "pqCheckInBufferSpace",
          "new_api": "VALID_LONG_MESSAGE_TYPE",
          "old_text": "pqCheckInBufferSpace(conn->inCursor + msgLength, conn)",
          "new_text": "VALID_LONG_MESSAGE_TYPE(id)",
          "old_line_content": "\t\t\tif (pqCheckInBufferSpace(conn->inCursor + msgLength, conn))",
          "new_line_content": "\t\tif (msgLength > 30000 && !VALID_LONG_MESSAGE_TYPE(id))",
          "content_same": false
        },
        {
          "line": 1806,
          "old_api": "pqSaveErrorResult",
          "new_api": "getReadyForQuery",
          "old_text": "pqSaveErrorResult(conn)",
          "new_text": "getReadyForQuery(conn)",
          "old_line_content": "\t\t\t\tpqSaveErrorResult(conn);",
          "new_line_content": "\t\t\t\tif (getReadyForQuery(conn))",
          "content_same": false
        },
        {
          "line": 1823,
          "old_api": "pqPrepareAsyncResult",
          "new_api": "pqSaveErrorResult",
          "old_text": "pqPrepareAsyncResult(conn)",
          "new_text": "pqSaveErrorResult(conn)",
          "old_line_content": "\treturn pqPrepareAsyncResult(conn);",
          "new_line_content": "\t\t\t\tpqSaveErrorResult(conn);",
          "content_same": false
        },
        {
          "line": 1839,
          "old_api": "malloc",
          "new_api": "pqSaveErrorResult",
          "old_text": "malloc(*packetlen)",
          "new_text": "pqSaveErrorResult(conn)",
          "old_line_content": "\tstartpacket = (char *) malloc(*packetlen);",
          "new_line_content": "\tpqSaveErrorResult(conn);",
          "content_same": false
        },
        {
          "line": 1884,
          "old_api": "strcpy",
          "new_api": "memcpy",
          "old_text": "strcpy(packet + packet_len, \"database\")",
          "new_text": "memcpy(packet + packet_len, &pv, sizeof(ProtocolVersion))",
          "old_line_content": "\t\t\tstrcpy(packet + packet_len, \"database\");",
          "new_line_content": "\t\tmemcpy(packet + packet_len, &pv, sizeof(ProtocolVersion));",
          "content_same": false
        },
        {
          "line": 1893,
          "old_api": "strcpy",
          "new_api": "strlen",
          "old_text": "strcpy(packet + packet_len, \"options\")",
          "new_text": "strlen(\"user\")",
          "old_line_content": "\t\t\tstrcpy(packet + packet_len, \"options\");",
          "new_line_content": "\t\tpacket_len += strlen(\"user\") + 1;",
          "content_same": false
        },
        {
          "line": 1896,
          "old_api": "strcpy",
          "new_api": "strlen",
          "old_text": "strcpy(packet + packet_len, conn->pgoptions)",
          "new_text": "strlen(conn->pguser)",
          "old_line_content": "\t\t\tstrcpy(packet + packet_len, conn->pgoptions);",
          "new_line_content": "\t\tpacket_len += strlen(conn->pguser) + 1;",
          "content_same": false
        },
        {
          "line": 1905,
          "old_api": "getenv",
          "new_api": "strlen",
          "old_text": "getenv(next_eo->envName)",
          "new_text": "strlen(conn->dbName)",
          "old_line_content": "\t\tif ((val = getenv(next_eo->envName)) != NULL)",
          "new_line_content": "\t\tpacket_len += strlen(conn->dbName) + 1;",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1550,
          "old_api": null,
          "new_api": "printfPQExpBuffer",
          "old_text": null,
          "new_text": "printfPQExpBuffer(&conn->errorMessage,\n\t\t\t\t\t\t  libpq_gettext(\"no COPY in progress\\n\"))",
          "old_line_content": "\t\t{",
          "new_line_content": "\t\tprintfPQExpBuffer(&conn->errorMessage,",
          "content_same": false
        },
        {
          "line": 1558,
          "old_api": null,
          "new_api": "pqPutMsgStart",
          "old_text": null,
          "new_text": "pqPutMsgStart('c', false, conn)",
          "old_line_content": "\t * make sure no data is waiting to be sent, abort if we are non-blocking",
          "new_line_content": "\t\tif (pqPutMsgStart('c', false, conn) < 0 ||",
          "content_same": false
        },
        {
          "line": 1559,
          "old_api": null,
          "new_api": "pqPutMsgEnd",
          "old_text": null,
          "new_text": "pqPutMsgEnd(conn)",
          "old_line_content": "\t * and the flush fails",
          "new_line_content": "\t\t\tpqPutMsgEnd(conn) < 0)",
          "content_same": false
        },
        {
          "line": 1568,
          "old_api": null,
          "new_api": "pqPutMsgStart",
          "old_text": null,
          "new_text": "pqPutMsgStart('S', false, conn)",
          "old_line_content": "\t/*",
          "new_line_content": "\t\t\tif (pqPutMsgStart('S', false, conn) < 0 ||",
          "content_same": false
        },
        {
          "line": 1569,
          "old_api": null,
          "new_api": "pqPutMsgEnd",
          "old_text": null,
          "new_text": "pqPutMsgEnd(conn)",
          "old_line_content": "\t * Non blocking connections may have to abort at this point.  If everyone",
          "new_line_content": "\t\t\t\tpqPutMsgEnd(conn) < 0)",
          "content_same": false
        },
        {
          "line": 1578,
          "old_api": null,
          "new_api": "pqIsnonblocking",
          "old_text": null,
          "new_text": "pqIsnonblocking(conn)",
          "old_line_content": "\t/* Wait for the completion response */",
          "new_line_content": "\tif (pqFlush(conn) && pqIsnonblocking(conn))",
          "content_same": false
        },
        {
          "line": 1583,
          "old_api": null,
          "new_api": "resetPQExpBuffer",
          "old_text": null,
          "new_text": "resetPQExpBuffer(&conn->errorMessage)",
          "old_line_content": "\t{",
          "new_line_content": "\tresetPQExpBuffer(&conn->errorMessage);",
          "content_same": false
        },
        {
          "line": 1592,
          "old_api": null,
          "new_api": "PQisBusy",
          "old_text": null,
          "new_text": "PQisBusy(conn)",
          "old_line_content": "\t * PQendcopy reasonably).  Note that the app can still obtain the error",
          "new_line_content": "\tif (pqIsnonblocking(conn) && PQisBusy(conn))",
          "content_same": false
        },
        {
          "line": 1596,
          "old_api": null,
          "new_api": "PQgetResult",
          "old_text": null,
          "new_text": "PQgetResult(conn)",
          "old_line_content": "\t{",
          "new_line_content": "\tresult = PQgetResult(conn);",
          "content_same": false
        },
        {
          "line": 1601,
          "old_api": null,
          "new_api": "PQclear",
          "old_text": null,
          "new_text": "PQclear(result)",
          "old_line_content": "\t\t\tconn->errorMessage.data[conn->errorMessage.len - 1] = '\\0';",
          "new_line_content": "\t\tPQclear(result);",
          "content_same": false
        },
        {
          "line": 1619,
          "old_api": null,
          "new_api": "pqInternalNotice",
          "old_text": null,
          "new_text": "pqInternalNotice(&conn->noticeHooks, \"%s\", conn->errorMessage.data)",
          "old_line_content": "\t\t\t\tint *result_buf, int *actual_result_len,",
          "new_line_content": "\t\tpqInternalNotice(&conn->noticeHooks, \"%s\", conn->errorMessage.data);",
          "content_same": false
        },
        {
          "line": 1623,
          "old_api": null,
          "new_api": "PQclear",
          "old_text": null,
          "new_text": "PQclear(result)",
          "old_line_content": "\tbool\t\tneedInput = false;",
          "new_line_content": "\tPQclear(result);",
          "content_same": false
        },
        {
          "line": 1649,
          "old_api": null,
          "new_api": "pqPutMsgStart",
          "old_text": null,
          "new_text": "pqPutMsgStart('F', false, conn)",
          "old_line_content": "\t\tif (args[i].len == -1)",
          "new_line_content": "\tif (pqPutMsgStart('F', false, conn) < 0 ||\t/* function call msg */",
          "content_same": false
        },
        {
          "line": 1650,
          "old_api": null,
          "new_api": "pqPutInt",
          "old_text": null,
          "new_text": "pqPutInt(fnid, 4, conn)",
          "old_line_content": "\t\t\tcontinue;\t\t\t/* it's NULL */",
          "new_line_content": "\t\tpqPutInt(fnid, 4, conn) < 0 ||\t/* function id */",
          "content_same": false
        },
        {
          "line": 1651,
          "old_api": null,
          "new_api": "pqPutInt",
          "old_text": null,
          "new_text": "pqPutInt(1, 2, conn)",
          "old_line_content": "",
          "new_line_content": "\t\tpqPutInt(1, 2, conn) < 0 ||\t\t/* # of format codes */",
          "content_same": false
        },
        {
          "line": 1652,
          "old_api": null,
          "new_api": "pqPutInt",
          "old_text": null,
          "new_text": "pqPutInt(1, 2, conn)",
          "old_line_content": "\t\tif (args[i].isint)",
          "new_line_content": "\t\tpqPutInt(1, 2, conn) < 0 ||\t\t/* format code: BINARY */",
          "content_same": false
        },
        {
          "line": 1653,
          "old_api": null,
          "new_api": "pqPutInt",
          "old_text": null,
          "new_text": "pqPutInt(nargs, 2, conn)",
          "old_line_content": "\t\t{",
          "new_line_content": "\t\tpqPutInt(nargs, 2, conn) < 0)\t/* # of args */",
          "content_same": false
        },
        {
          "line": 1655,
          "old_api": null,
          "new_api": "pqHandleSendFailure",
          "old_text": null,
          "new_text": "pqHandleSendFailure(conn)",
          "old_line_content": "\t\t\t{",
          "new_line_content": "\t\tpqHandleSendFailure(conn);",
          "content_same": false
        },
        {
          "line": 1661,
          "old_api": null,
          "new_api": "pqPutInt",
          "old_text": null,
          "new_text": "pqPutInt(args[i].len, 4, conn)",
          "old_line_content": "\t\t{",
          "new_line_content": "\t\tif (pqPutInt(args[i].len, 4, conn))",
          "content_same": false
        },
        {
          "line": 1663,
          "old_api": null,
          "new_api": "pqHandleSendFailure",
          "old_text": null,
          "new_text": "pqHandleSendFailure(conn)",
          "old_line_content": "\t\t\t{",
          "new_line_content": "\t\t\tpqHandleSendFailure(conn);",
          "content_same": false
        },
        {
          "line": 1671,
          "old_api": null,
          "new_api": "pqPutInt",
          "old_text": null,
          "new_text": "pqPutInt(args[i].u.integer, args[i].len, conn)",
          "old_line_content": "\t{",
          "new_line_content": "\t\t\tif (pqPutInt(args[i].u.integer, args[i].len, conn))",
          "content_same": false
        },
        {
          "line": 1673,
          "old_api": null,
          "new_api": "pqHandleSendFailure",
          "old_text": null,
          "new_text": "pqHandleSendFailure(conn)",
          "old_line_content": "\t\treturn NULL;",
          "new_line_content": "\t\t\t\tpqHandleSendFailure(conn);",
          "content_same": false
        },
        {
          "line": 1681,
          "old_api": null,
          "new_api": "pqHandleSendFailure",
          "old_text": null,
          "new_text": "pqHandleSendFailure(conn)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\t\tpqHandleSendFailure(conn);",
          "content_same": false
        },
        {
          "line": 1687,
          "old_api": null,
          "new_api": "pqPutInt",
          "old_text": null,
          "new_text": "pqPutInt(1, 2, conn)",
          "old_line_content": "\t\t\t/* Wait for some data to arrive (or for the channel to close) */",
          "new_line_content": "\tif (pqPutInt(1, 2, conn) < 0)\t\t/* result format code: BINARY */",
          "content_same": false
        },
        {
          "line": 1693,
          "old_api": null,
          "new_api": "pqPutMsgEnd",
          "old_text": null,
          "new_text": "pqPutMsgEnd(conn)",
          "old_line_content": "\t\t/*",
          "new_line_content": "\tif (pqPutMsgEnd(conn) < 0 ||",
          "content_same": false
        },
        {
          "line": 1694,
          "old_api": null,
          "new_api": "pqFlush",
          "old_text": null,
          "new_text": "pqFlush(conn)",
          "old_line_content": "\t\t * Scan the message. If we run out of data, loop around to try again.",
          "new_line_content": "\t\tpqFlush(conn))",
          "content_same": false
        },
        {
          "line": 1696,
          "old_api": null,
          "new_api": "pqHandleSendFailure",
          "old_text": null,
          "new_text": "pqHandleSendFailure(conn)",
          "old_line_content": "\t\tneedInput = true;",
          "new_line_content": "\t\tpqHandleSendFailure(conn);",
          "content_same": false
        },
        {
          "line": 1705,
          "old_api": null,
          "new_api": "pqWait",
          "old_text": null,
          "new_text": "pqWait(TRUE, FALSE, conn)",
          "old_line_content": "\t\t * Try to validate message type/length here.  A length less than 4 is",
          "new_line_content": "\t\t\tif (pqWait(TRUE, FALSE, conn) ||",
          "content_same": false
        },
        {
          "line": 1706,
          "old_api": null,
          "new_api": "pqReadData",
          "old_text": null,
          "new_text": "pqReadData(conn)",
          "old_line_content": "\t\t * definitely broken.  Large lengths should only be believed for a few",
          "new_line_content": "\t\t\t\tpqReadData(conn) < 0)",
          "content_same": false
        },
        {
          "line": 1718,
          "old_api": null,
          "new_api": "pqGetInt",
          "old_text": null,
          "new_text": "pqGetInt(&msgLength, 4, conn)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tif (pqGetInt(&msgLength, 4, conn))",
          "content_same": false
        },
        {
          "line": 1728,
          "old_api": null,
          "new_api": "handleSyncLoss",
          "old_text": null,
          "new_text": "handleSyncLoss(conn, id, msgLength)",
          "old_line_content": "\t\t\t * Before looping, enlarge the input buffer if needed to hold the",
          "new_line_content": "\t\t\thandleSyncLoss(conn, id, msgLength);",
          "content_same": false
        },
        {
          "line": 1733,
          "old_api": null,
          "new_api": "handleSyncLoss",
          "old_text": null,
          "new_text": "handleSyncLoss(conn, id, msgLength)",
          "old_line_content": "\t\t\t\t/*",
          "new_line_content": "\t\t\thandleSyncLoss(conn, id, msgLength);",
          "content_same": false
        },
        {
          "line": 1748,
          "old_api": null,
          "new_api": "pqCheckInBufferSpace",
          "old_text": null,
          "new_text": "pqCheckInBufferSpace(conn->inCursor + msgLength, conn)",
          "old_line_content": "\t\t * returning.",
          "new_line_content": "\t\t\tif (pqCheckInBufferSpace(conn->inCursor + msgLength, conn))",
          "content_same": false
        },
        {
          "line": 1756,
          "old_api": null,
          "new_api": "handleSyncLoss",
          "old_text": null,
          "new_text": "handleSyncLoss(conn, id, msgLength)",
          "old_line_content": "\t\t\t\t{",
          "new_line_content": "\t\t\t\thandleSyncLoss(conn, id, msgLength);",
          "content_same": false
        },
        {
          "line": 1770,
          "old_api": null,
          "new_api": "pqGetInt",
          "old_text": null,
          "new_text": "pqGetInt(actual_result_len, 4, conn)",
          "old_line_content": "\t\t\t\t/* correctly finished function result message */",
          "new_line_content": "\t\t\t\tif (pqGetInt(actual_result_len, 4, conn))",
          "content_same": false
        },
        {
          "line": 1776,
          "old_api": null,
          "new_api": "pqGetInt",
          "old_text": null,
          "new_text": "pqGetInt(result_buf, *actual_result_len, conn)",
          "old_line_content": "\t\t\t\tstatus = PGRES_FATAL_ERROR;",
          "new_line_content": "\t\t\t\t\t\tif (pqGetInt(result_buf, *actual_result_len, conn))",
          "content_same": false
        },
        {
          "line": 1781,
          "old_api": null,
          "new_api": "pqGetnchar",
          "old_text": null,
          "new_text": "pqGetnchar((char *) result_buf,\n\t\t\t\t\t\t\t\t\t   *actual_result_len,\n\t\t\t\t\t\t\t\t\t   conn)",
          "old_line_content": "\t\t\t\t\tcontinue;",
          "new_line_content": "\t\t\t\t\t\tif (pqGetnchar((char *) result_buf,",
          "content_same": false
        },
        {
          "line": 1791,
          "old_api": null,
          "new_api": "pqGetErrorNotice3",
          "old_text": null,
          "new_text": "pqGetErrorNotice3(conn, true)",
          "old_line_content": "\t\t\t\t/* consume the message and exit */",
          "new_line_content": "\t\t\t\tif (pqGetErrorNotice3(conn, true))",
          "content_same": false
        },
        {
          "line": 1797,
          "old_api": null,
          "new_api": "getNotify",
          "old_text": null,
          "new_text": "getNotify(conn)",
          "old_line_content": "\t\t\tcase 'S':\t\t\t/* parameter status */",
          "new_line_content": "\t\t\t\tif (getNotify(conn))",
          "content_same": false
        },
        {
          "line": 1802,
          "old_api": null,
          "new_api": "pqGetErrorNotice3",
          "old_text": null,
          "new_text": "pqGetErrorNotice3(conn, false)",
          "old_line_content": "\t\t\t\t/* The backend violates the protocol. */",
          "new_line_content": "\t\t\t\tif (pqGetErrorNotice3(conn, false))",
          "content_same": false
        },
        {
          "line": 1812,
          "old_api": null,
          "new_api": "pqPrepareAsyncResult",
          "old_text": null,
          "new_text": "pqPrepareAsyncResult(conn)",
          "old_line_content": "\t\t/* trust the specified message length as what to skip */",
          "new_line_content": "\t\t\t\t\treturn pqPrepareAsyncResult(conn);",
          "content_same": false
        },
        {
          "line": 1813,
          "old_api": null,
          "new_api": "PQmakeEmptyPGresult",
          "old_text": null,
          "new_text": "PQmakeEmptyPGresult(conn, status)",
          "old_line_content": "\t\tconn->inStart += 5 + msgLength;",
          "new_line_content": "\t\t\t\treturn PQmakeEmptyPGresult(conn, status);",
          "content_same": false
        },
        {
          "line": 1815,
          "old_api": null,
          "new_api": "getParameterStatus",
          "old_text": null,
          "new_text": "getParameterStatus(conn)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\t\tif (getParameterStatus(conn))",
          "content_same": false
        },
        {
          "line": 1820,
          "old_api": null,
          "new_api": "printfPQExpBuffer",
          "old_text": null,
          "new_text": "printfPQExpBuffer(&conn->errorMessage,\n\t\t\t\t\t\t\t\t  libpq_gettext(\"protocol error: id=0x%x\\n\"),\n\t\t\t\t\t\t\t\t  id)",
          "old_line_content": "\t * append it to any already-received error message.",
          "new_line_content": "\t\t\t\tprintfPQExpBuffer(&conn->errorMessage,",
          "content_same": false
        },
        {
          "line": 1821,
          "old_api": null,
          "new_api": "libpq_gettext",
          "old_text": null,
          "new_text": "libpq_gettext(\"protocol error: id=0x%x\\n\")",
          "old_line_content": "\t */",
          "new_line_content": "\t\t\t\t\t\t\t\t  libpq_gettext(\"protocol error: id=0x%x\\n\"),",
          "content_same": false
        },
        {
          "line": 1313,
          "old_api": null,
          "new_api": "pqCheckInBufferSpace",
          "old_text": null,
          "new_text": "pqCheckInBufferSpace(conn->inCursor + msgLength - 4, conn)",
          "old_line_content": "\t\t * completeness.)  Otherwise, if it's anything except Copy Data,",
          "new_line_content": "\t\t\tif (pqCheckInBufferSpace(conn->inCursor + msgLength - 4, conn))",
          "content_same": false
        },
        {
          "line": 1826,
          "old_api": null,
          "new_api": "pqPrepareAsyncResult",
          "old_text": null,
          "new_text": "pqPrepareAsyncResult(conn)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\treturn pqPrepareAsyncResult(conn);",
          "content_same": false
        },
        {
          "line": 1321,
          "old_api": null,
          "new_api": "handleSyncLoss",
          "old_text": null,
          "new_text": "handleSyncLoss(conn, id, msgLength)",
          "old_line_content": "\t\t\t\tbreak;",
          "new_line_content": "\t\t\t\thandleSyncLoss(conn, id, msgLength);",
          "content_same": false
        },
        {
          "line": 1840,
          "old_api": null,
          "new_api": "pqPrepareAsyncResult",
          "old_text": null,
          "new_text": "pqPrepareAsyncResult(conn)",
          "old_line_content": "\tif (!startpacket)",
          "new_line_content": "\treturn pqPrepareAsyncResult(conn);",
          "content_same": false
        },
        {
          "line": 1336,
          "old_api": null,
          "new_api": "getNotify",
          "old_text": null,
          "new_text": "getNotify(conn)",
          "old_line_content": "\t\t/* Drop the processed message and loop around for another */",
          "new_line_content": "\t\t\t\tif (getNotify(conn))",
          "content_same": false
        },
        {
          "line": 1340,
          "old_api": null,
          "new_api": "pqGetErrorNotice3",
          "old_text": null,
          "new_text": "pqGetErrorNotice3(conn, false)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tif (pqGetErrorNotice3(conn, false))",
          "content_same": false
        },
        {
          "line": 1855,
          "old_api": null,
          "new_api": "build_startup_packet",
          "old_text": null,
          "new_text": "build_startup_packet(conn, NULL, options)",
          "old_line_content": "static int",
          "new_line_content": "\t*packetlen = build_startup_packet(conn, NULL, options);",
          "content_same": false
        },
        {
          "line": 1344,
          "old_api": null,
          "new_api": "getParameterStatus",
          "old_text": null,
          "new_text": "getParameterStatus(conn)",
          "old_line_content": " * If successful, sets *buffer to point to a malloc'd row of data, and",
          "new_line_content": "\t\t\t\tif (getParameterStatus(conn))",
          "content_same": false
        },
        {
          "line": 1856,
          "old_api": null,
          "new_api": "malloc",
          "old_text": null,
          "new_text": "malloc(*packetlen)",
          "old_line_content": "build_startup_packet(const PGconn *conn, char *packet,",
          "new_line_content": "\tstartpacket = (char *) malloc(*packetlen);",
          "content_same": false
        },
        {
          "line": 1859,
          "old_api": null,
          "new_api": "build_startup_packet",
          "old_text": null,
          "new_text": "build_startup_packet(conn, startpacket, options)",
          "old_line_content": "\tint\t\t\tpacket_len = 0;",
          "new_line_content": "\t*packetlen = build_startup_packet(conn, startpacket, options);",
          "content_same": false
        },
        {
          "line": 1882,
          "old_api": null,
          "new_api": "htonl",
          "old_text": null,
          "new_text": "htonl(conn->pversion)",
          "old_line_content": "\t{",
          "new_line_content": "\t\tProtocolVersion pv = htonl(conn->pversion);",
          "content_same": false
        },
        {
          "line": 1379,
          "old_api": null,
          "new_api": "getCopyDataMessage",
          "old_text": null,
          "new_text": "getCopyDataMessage(conn)",
          "old_line_content": "\t\t\t\treturn 0;",
          "new_line_content": "\t\tmsgLength = getCopyDataMessage(conn);",
          "content_same": false
        },
        {
          "line": 1892,
          "old_api": null,
          "new_api": "strcpy",
          "old_text": null,
          "new_text": "strcpy(packet + packet_len, \"user\")",
          "old_line_content": "\t\tif (packet)",
          "new_line_content": "\t\t\tstrcpy(packet + packet_len, \"user\");",
          "content_same": false
        },
        {
          "line": 1895,
          "old_api": null,
          "new_api": "strcpy",
          "old_text": null,
          "new_text": "strcpy(packet + packet_len, conn->pguser)",
          "old_line_content": "\t\tif (packet)",
          "new_line_content": "\t\t\tstrcpy(packet + packet_len, conn->pguser);",
          "content_same": false
        },
        {
          "line": 1901,
          "old_api": null,
          "new_api": "strcpy",
          "old_text": null,
          "new_text": "strcpy(packet + packet_len, \"database\")",
          "old_line_content": "\tfor (next_eo = options; next_eo->envName; next_eo++)",
          "new_line_content": "\t\t\tstrcpy(packet + packet_len, \"database\");",
          "content_same": false
        },
        {
          "line": 1902,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(\"database\")",
          "old_line_content": "\t{",
          "new_line_content": "\t\tpacket_len += strlen(\"database\") + 1;",
          "content_same": false
        },
        {
          "line": 1904,
          "old_api": null,
          "new_api": "strcpy",
          "old_text": null,
          "new_text": "strcpy(packet + packet_len, conn->dbName)",
          "old_line_content": "",
          "new_line_content": "\t\t\tstrcpy(packet + packet_len, conn->dbName);",
          "content_same": false
        },
        {
          "line": 1399,
          "old_api": null,
          "new_api": "pqReadData",
          "old_text": null,
          "new_text": "pqReadData(conn)",
          "old_line_content": "\t\t\t\treturn -2;",
          "new_line_content": "\t\t\t\tpqReadData(conn) < 0)",
          "content_same": false
        },
        {
          "line": 1922,
          "old_api": null,
          "new_api": "getenv",
          "old_text": null,
          "new_text": "getenv(next_eo->envName)",
          "old_line_content": "\tpacket_len++;",
          "new_line_content": "\t\tif ((val = getenv(next_eo->envName)) != NULL)",
          "content_same": false
        },
        {
          "line": 1411,
          "old_api": null,
          "new_api": "malloc",
          "old_text": null,
          "new_text": "malloc(msgLength + 1)",
          "old_line_content": "\t\tconn->inStart = conn->inCursor;",
          "new_line_content": "\t\t\t*buffer = (char *) malloc(msgLength + 1);",
          "content_same": false
        },
        {
          "line": 1924,
          "old_api": null,
          "new_api": "pg_strcasecmp",
          "old_text": null,
          "new_text": "pg_strcasecmp(val, \"default\")",
          "old_line_content": "\treturn packet_len;",
          "new_line_content": "\t\t\tif (pg_strcasecmp(val, \"default\") != 0)",
          "content_same": false
        },
        {
          "line": 1414,
          "old_api": null,
          "new_api": "printfPQExpBuffer",
          "old_text": null,
          "new_text": "printfPQExpBuffer(&conn->errorMessage,\n\t\t\t\t\t\t\t\t  libpq_gettext(\"out of memory\\n\"))",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tprintfPQExpBuffer(&conn->errorMessage,",
          "content_same": false
        },
        {
          "line": 1415,
          "old_api": null,
          "new_api": "libpq_gettext",
          "old_text": null,
          "new_text": "libpq_gettext(\"out of memory\\n\")",
          "old_line_content": "/*",
          "new_line_content": "\t\t\t\t\t\t\t\t  libpq_gettext(\"out of memory\\n\"));",
          "content_same": false
        },
        {
          "line": 1927,
          "old_api": null,
          "new_api": "strcpy",
          "old_text": null,
          "new_text": "strcpy(packet + packet_len, next_eo->pgName)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t\tstrcpy(packet + packet_len, next_eo->pgName);",
          "content_same": false
        },
        {
          "line": 1928,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(next_eo->pgName)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tpacket_len += strlen(next_eo->pgName) + 1;",
          "content_same": false
        },
        {
          "line": 1418,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(*buffer, &conn->inBuffer[conn->inCursor], msgLength)",
          "old_line_content": " * See fe-exec.c for documentation.",
          "new_line_content": "\t\t\tmemcpy(*buffer, &conn->inBuffer[conn->inCursor], msgLength);",
          "content_same": false
        },
        {
          "line": 1930,
          "old_api": null,
          "new_api": "strcpy",
          "old_text": null,
          "new_text": "strcpy(packet + packet_len, val)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t\tstrcpy(packet + packet_len, val);",
          "content_same": false
        },
        {
          "line": 1931,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(val)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tpacket_len += strlen(val) + 1;",
          "content_same": false
        },
        {
          "line": 1446,
          "old_api": null,
          "new_api": "printfPQExpBuffer",
          "old_text": null,
          "new_text": "printfPQExpBuffer(&conn->errorMessage,\n\t\t\t\t\t  libpq_gettext(\"PQgetline: not doing text COPY OUT\\n\"))",
          "old_line_content": "\tif (status < 0)",
          "new_line_content": "\t\tprintfPQExpBuffer(&conn->errorMessage,",
          "content_same": false
        },
        {
          "line": 1447,
          "old_api": null,
          "new_api": "libpq_gettext",
          "old_text": null,
          "new_text": "libpq_gettext(\"PQgetline: not doing text COPY OUT\\n\")",
          "old_line_content": "\t{",
          "new_line_content": "\t\t\t\t\t  libpq_gettext(\"PQgetline: not doing text COPY OUT\\n\"));",
          "content_same": false
        },
        {
          "line": 1452,
          "old_api": null,
          "new_api": "PQgetlineAsync",
          "old_text": null,
          "new_text": "PQgetlineAsync(conn, s, maxlen - 1)",
          "old_line_content": "",
          "new_line_content": "\twhile ((status = PQgetlineAsync(conn, s, maxlen - 1)) == 0)",
          "content_same": false
        },
        {
          "line": 1455,
          "old_api": null,
          "new_api": "pqWait",
          "old_text": null,
          "new_text": "pqWait(TRUE, FALSE, conn)",
          "old_line_content": "\t{",
          "new_line_content": "\t\tif (pqWait(TRUE, FALSE, conn) ||",
          "content_same": false
        },
        {
          "line": 1456,
          "old_api": null,
          "new_api": "pqReadData",
          "old_text": null,
          "new_text": "pqReadData(conn)",
          "old_line_content": "\t\ts[status - 1] = '\\0';",
          "new_line_content": "\t\t\tpqReadData(conn) < 0)",
          "content_same": false
        },
        {
          "line": 1466,
          "old_api": null,
          "new_api": "strcpy",
          "old_text": null,
          "new_text": "strcpy(s, \"\\\\.\")",
          "old_line_content": "/*",
          "new_line_content": "\t\tstrcpy(s, \"\\\\.\");",
          "content_same": false
        },
        {
          "line": 1520,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(buffer, &conn->inBuffer[conn->inCursor], avail)",
          "old_line_content": "/*",
          "new_line_content": "\t\tmemcpy(buffer, &conn->inBuffer[conn->inCursor], avail);",
          "content_same": false
        },
        {
          "line": 1530,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(buffer, &conn->inBuffer[conn->inCursor], bufsize)",
          "old_line_content": "\tif (conn->asyncStatus != PGASYNC_COPY_IN &&",
          "new_line_content": "\t\tmemcpy(buffer, &conn->inBuffer[conn->inCursor], bufsize);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1541,
          "old_api": "pqPutMsgStart",
          "new_api": null,
          "old_text": "pqPutMsgStart('c', false, conn)",
          "new_text": null,
          "old_line_content": "\t\tif (pqPutMsgStart('c', false, conn) < 0 ||",
          "new_line_content": " */",
          "content_same": false
        },
        {
          "line": 1542,
          "old_api": "pqPutMsgEnd",
          "new_api": null,
          "old_text": "pqPutMsgEnd(conn)",
          "new_text": null,
          "old_line_content": "\t\t\tpqPutMsgEnd(conn) < 0)",
          "new_line_content": "int",
          "content_same": false
        },
        {
          "line": 1552,
          "old_api": "pqPutMsgEnd",
          "new_api": null,
          "old_text": "pqPutMsgEnd(conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\tpqPutMsgEnd(conn) < 0)",
          "new_line_content": "\t\treturn 1;",
          "content_same": false
        },
        {
          "line": 1561,
          "old_api": "pqIsnonblocking",
          "new_api": null,
          "old_text": "pqIsnonblocking(conn)",
          "new_text": null,
          "old_line_content": "\tif (pqFlush(conn) && pqIsnonblocking(conn))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1566,
          "old_api": "resetPQExpBuffer",
          "new_api": null,
          "old_text": "resetPQExpBuffer(&conn->errorMessage)",
          "new_text": null,
          "old_line_content": "\tresetPQExpBuffer(&conn->errorMessage);",
          "new_line_content": "\t\tif (conn->queryclass != PGQUERY_SIMPLE)",
          "content_same": false
        },
        {
          "line": 1575,
          "old_api": "PQisBusy",
          "new_api": null,
          "old_text": "PQisBusy(conn)",
          "new_text": null,
          "old_line_content": "\tif (pqIsnonblocking(conn) && PQisBusy(conn))",
          "new_line_content": "\t * make sure no data is waiting to be sent, abort if we are non-blocking",
          "content_same": false
        },
        {
          "line": 1579,
          "old_api": "PQgetResult",
          "new_api": null,
          "old_text": "PQgetResult(conn)",
          "new_text": null,
          "old_line_content": "\tresult = PQgetResult(conn);",
          "new_line_content": "\t\treturn 1;",
          "content_same": false
        },
        {
          "line": 1584,
          "old_api": "PQclear",
          "new_api": null,
          "old_text": "PQclear(result)",
          "new_text": null,
          "old_line_content": "\t\tPQclear(result);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1602,
          "old_api": "pqInternalNotice",
          "new_api": null,
          "old_text": "pqInternalNotice(&conn->noticeHooks, \"%s\", conn->errorMessage.data)",
          "new_text": null,
          "old_line_content": "\t\tpqInternalNotice(&conn->noticeHooks, \"%s\", conn->errorMessage.data);",
          "new_line_content": "\t\treturn 0;",
          "content_same": false
        },
        {
          "line": 1606,
          "old_api": "PQclear",
          "new_api": null,
          "old_text": "PQclear(result)",
          "new_text": null,
          "old_line_content": "\tPQclear(result);",
          "new_line_content": "\t * Trouble. For backwards-compatibility reasons, we issue the error",
          "content_same": false
        },
        {
          "line": 1632,
          "old_api": "pqPutMsgStart",
          "new_api": null,
          "old_text": "pqPutMsgStart('F', false, conn)",
          "new_text": null,
          "old_line_content": "\tif (pqPutMsgStart('F', false, conn) < 0 ||\t/* function call msg */",
          "new_line_content": " * See fe-exec.c for documentation.",
          "content_same": false
        },
        {
          "line": 1633,
          "old_api": "pqPutInt",
          "new_api": null,
          "old_text": "pqPutInt(fnid, 4, conn)",
          "new_text": null,
          "old_line_content": "\t\tpqPutInt(fnid, 4, conn) < 0 ||\t/* function id */",
          "new_line_content": " */",
          "content_same": false
        },
        {
          "line": 1634,
          "old_api": "pqPutInt",
          "new_api": null,
          "old_text": "pqPutInt(1, 2, conn)",
          "new_text": null,
          "old_line_content": "\t\tpqPutInt(1, 2, conn) < 0 ||\t\t/* # of format codes */",
          "new_line_content": "PGresult *",
          "content_same": false
        },
        {
          "line": 1635,
          "old_api": "pqPutInt",
          "new_api": null,
          "old_text": "pqPutInt(1, 2, conn)",
          "new_text": null,
          "old_line_content": "\t\tpqPutInt(1, 2, conn) < 0 ||\t\t/* format code: BINARY */",
          "new_line_content": "pqFunctionCall3(PGconn *conn, Oid fnid,",
          "content_same": false
        },
        {
          "line": 1636,
          "old_api": "pqPutInt",
          "new_api": null,
          "old_text": "pqPutInt(nargs, 2, conn)",
          "new_text": null,
          "old_line_content": "\t\tpqPutInt(nargs, 2, conn) < 0)\t/* # of args */",
          "new_line_content": "\t\t\t\tint *result_buf, int *actual_result_len,",
          "content_same": false
        },
        {
          "line": 1638,
          "old_api": "pqHandleSendFailure",
          "new_api": null,
          "old_text": "pqHandleSendFailure(conn)",
          "new_text": null,
          "old_line_content": "\t\tpqHandleSendFailure(conn);",
          "new_line_content": "\t\t\t\tconst PQArgBlock *args, int nargs)",
          "content_same": false
        },
        {
          "line": 1644,
          "old_api": "pqPutInt",
          "new_api": null,
          "old_text": "pqPutInt(args[i].len, 4, conn)",
          "new_text": null,
          "old_line_content": "\t\tif (pqPutInt(args[i].len, 4, conn))",
          "new_line_content": "\tint\t\t\tavail;",
          "content_same": false
        },
        {
          "line": 1646,
          "old_api": "pqHandleSendFailure",
          "new_api": null,
          "old_text": "pqHandleSendFailure(conn)",
          "new_text": null,
          "old_line_content": "\t\t\tpqHandleSendFailure(conn);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1654,
          "old_api": "pqPutInt",
          "new_api": null,
          "old_text": "pqPutInt(args[i].u.integer, args[i].len, conn)",
          "new_text": null,
          "old_line_content": "\t\t\tif (pqPutInt(args[i].u.integer, args[i].len, conn))",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1656,
          "old_api": "pqHandleSendFailure",
          "new_api": null,
          "old_text": "pqHandleSendFailure(conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\tpqHandleSendFailure(conn);",
          "new_line_content": "\t\treturn NULL;",
          "content_same": false
        },
        {
          "line": 1662,
          "old_api": "pqPutnchar",
          "new_api": null,
          "old_text": "pqPutnchar((char *) args[i].u.ptr, args[i].len, conn)",
          "new_text": null,
          "old_line_content": "\t\t\tif (pqPutnchar((char *) args[i].u.ptr, args[i].len, conn))",
          "new_line_content": "\t\t{",
          "content_same": false
        },
        {
          "line": 1664,
          "old_api": "pqHandleSendFailure",
          "new_api": null,
          "old_text": "pqHandleSendFailure(conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\tpqHandleSendFailure(conn);",
          "new_line_content": "\t\t\treturn NULL;",
          "content_same": false
        },
        {
          "line": 1670,
          "old_api": "pqPutInt",
          "new_api": null,
          "old_text": "pqPutInt(1, 2, conn)",
          "new_text": null,
          "old_line_content": "\tif (pqPutInt(1, 2, conn) < 0)\t\t/* result format code: BINARY */",
          "new_line_content": "\t\t{",
          "content_same": false
        },
        {
          "line": 1672,
          "old_api": "pqHandleSendFailure",
          "new_api": null,
          "old_text": "pqHandleSendFailure(conn)",
          "new_text": null,
          "old_line_content": "\t\tpqHandleSendFailure(conn);",
          "new_line_content": "\t\t\t{",
          "content_same": false
        },
        {
          "line": 1676,
          "old_api": "pqPutMsgEnd",
          "new_api": null,
          "old_text": "pqPutMsgEnd(conn)",
          "new_text": null,
          "old_line_content": "\tif (pqPutMsgEnd(conn) < 0 ||",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 1677,
          "old_api": "pqFlush",
          "new_api": null,
          "old_text": "pqFlush(conn)",
          "new_text": null,
          "old_line_content": "\t\tpqFlush(conn))",
          "new_line_content": "\t\telse",
          "content_same": false
        },
        {
          "line": 1688,
          "old_api": "pqWait",
          "new_api": null,
          "old_text": "pqWait(TRUE, FALSE, conn)",
          "new_text": null,
          "old_line_content": "\t\t\tif (pqWait(TRUE, FALSE, conn) ||",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1699,
          "old_api": "pqGetc",
          "new_api": null,
          "old_text": "pqGetc(&id, conn)",
          "new_text": null,
          "old_line_content": "\t\tif (pqGetc(&id, conn))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1701,
          "old_api": "pqGetInt",
          "new_api": null,
          "old_text": "pqGetInt(&msgLength, 4, conn)",
          "new_text": null,
          "old_line_content": "\t\tif (pqGetInt(&msgLength, 4, conn))",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1711,
          "old_api": "handleSyncLoss",
          "new_api": null,
          "old_text": "handleSyncLoss(conn, id, msgLength)",
          "new_text": null,
          "old_line_content": "\t\t\thandleSyncLoss(conn, id, msgLength);",
          "new_line_content": "\t\t * Scan the message. If we run out of data, loop around to try again.",
          "content_same": false
        },
        {
          "line": 1714,
          "old_api": "VALID_LONG_MESSAGE_TYPE",
          "new_api": null,
          "old_text": "VALID_LONG_MESSAGE_TYPE(id)",
          "new_text": null,
          "old_line_content": "\t\tif (msgLength > 30000 && !VALID_LONG_MESSAGE_TYPE(id))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1739,
          "old_api": "handleSyncLoss",
          "new_api": null,
          "old_text": "handleSyncLoss(conn, id, msgLength)",
          "new_text": null,
          "old_line_content": "\t\t\t\thandleSyncLoss(conn, id, msgLength);",
          "new_line_content": "\t\t */",
          "content_same": false
        },
        {
          "line": 1753,
          "old_api": "pqGetInt",
          "new_api": null,
          "old_text": "pqGetInt(actual_result_len, 4, conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (pqGetInt(actual_result_len, 4, conn))",
          "new_line_content": "\t\t\t\t * moment, just treat this like loss of sync (which indeed it",
          "content_same": false
        },
        {
          "line": 1759,
          "old_api": "pqGetInt",
          "new_api": null,
          "old_text": "pqGetInt(result_buf, *actual_result_len, conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tif (pqGetInt(result_buf, *actual_result_len, conn))",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 1764,
          "old_api": "pqGetnchar",
          "new_api": null,
          "old_text": "pqGetnchar((char *) result_buf,\n\t\t\t\t\t\t\t\t\t   *actual_result_len,\n\t\t\t\t\t\t\t\t\t   conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tif (pqGetnchar((char *) result_buf,",
          "new_line_content": "\t\t * and/or A notices first. We also need to swallow the final Z before",
          "content_same": false
        },
        {
          "line": 1774,
          "old_api": "pqGetErrorNotice3",
          "new_api": null,
          "old_text": "pqGetErrorNotice3(conn, true)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (pqGetErrorNotice3(conn, true))",
          "new_line_content": "\t\t\t\t\tif (result_is_int)",
          "content_same": false
        },
        {
          "line": 1780,
          "old_api": "getNotify",
          "new_api": null,
          "old_text": "getNotify(conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (getNotify(conn))",
          "new_line_content": "\t\t\t\t\t{",
          "content_same": false
        },
        {
          "line": 1785,
          "old_api": "pqGetErrorNotice3",
          "new_api": null,
          "old_text": "pqGetErrorNotice3(conn, false)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (pqGetErrorNotice3(conn, false))",
          "new_line_content": "\t\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 1789,
          "old_api": "getReadyForQuery",
          "new_api": null,
          "old_text": "getReadyForQuery(conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (getReadyForQuery(conn))",
          "new_line_content": "\t\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 1795,
          "old_api": "pqPrepareAsyncResult",
          "new_api": null,
          "old_text": "pqPrepareAsyncResult(conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\treturn pqPrepareAsyncResult(conn);",
          "new_line_content": "\t\t\tcase 'A':\t\t\t/* notify message */",
          "content_same": false
        },
        {
          "line": 1796,
          "old_api": "PQmakeEmptyPGresult",
          "new_api": null,
          "old_text": "PQmakeEmptyPGresult(conn, status)",
          "new_text": null,
          "old_line_content": "\t\t\t\treturn PQmakeEmptyPGresult(conn, status);",
          "new_line_content": "\t\t\t\t/* handle notify and go back to processing return values */",
          "content_same": false
        },
        {
          "line": 1798,
          "old_api": "getParameterStatus",
          "new_api": null,
          "old_text": "getParameterStatus(conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (getParameterStatus(conn))",
          "new_line_content": "\t\t\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 1803,
          "old_api": "printfPQExpBuffer",
          "new_api": null,
          "old_text": "printfPQExpBuffer(&conn->errorMessage,\n\t\t\t\t\t\t\t\t  libpq_gettext(\"protocol error: id=0x%x\\n\"),\n\t\t\t\t\t\t\t\t  id)",
          "new_text": null,
          "old_line_content": "\t\t\t\tprintfPQExpBuffer(&conn->errorMessage,",
          "new_line_content": "\t\t\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 1804,
          "old_api": "libpq_gettext",
          "new_api": null,
          "old_text": "libpq_gettext(\"protocol error: id=0x%x\\n\")",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t\t  libpq_gettext(\"protocol error: id=0x%x\\n\"),",
          "new_line_content": "\t\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 1809,
          "old_api": "pqPrepareAsyncResult",
          "new_api": null,
          "old_text": "pqPrepareAsyncResult(conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\treturn pqPrepareAsyncResult(conn);",
          "new_line_content": "\t\t\t\tconn->inStart += 5 + msgLength;",
          "content_same": false
        },
        {
          "line": 1822,
          "old_api": "pqSaveErrorResult",
          "new_api": null,
          "old_text": "pqSaveErrorResult(conn)",
          "new_text": null,
          "old_line_content": "\tpqSaveErrorResult(conn);",
          "new_line_content": "\t\t\t\t\t\t\t\t  id);",
          "content_same": false
        },
        {
          "line": 1319,
          "old_api": "getNotify",
          "new_api": null,
          "old_text": "getNotify(conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (getNotify(conn))",
          "new_line_content": "\t\t\t\t * might be!)",
          "content_same": false
        },
        {
          "line": 1323,
          "old_api": "pqGetErrorNotice3",
          "new_api": null,
          "old_text": "pqGetErrorNotice3(conn, false)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (pqGetErrorNotice3(conn, false))",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 1838,
          "old_api": "build_startup_packet",
          "new_api": null,
          "old_text": "build_startup_packet(conn, NULL, options)",
          "new_text": null,
          "old_line_content": "\t*packetlen = build_startup_packet(conn, NULL, options);",
          "new_line_content": "\t */",
          "content_same": false
        },
        {
          "line": 1327,
          "old_api": "getParameterStatus",
          "new_api": null,
          "old_text": "getParameterStatus(conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (getParameterStatus(conn))",
          "new_line_content": "\t\t/*",
          "content_same": false
        },
        {
          "line": 1842,
          "old_api": "build_startup_packet",
          "new_api": null,
          "old_text": "build_startup_packet(conn, startpacket, options)",
          "new_text": null,
          "old_line_content": "\t*packetlen = build_startup_packet(conn, startpacket, options);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1865,
          "old_api": "htonl",
          "new_api": null,
          "old_text": "htonl(conn->pversion)",
          "new_text": null,
          "old_line_content": "\t\tProtocolVersion pv = htonl(conn->pversion);",
          "new_line_content": " *",
          "content_same": false
        },
        {
          "line": 1867,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(packet + packet_len, &pv, sizeof(ProtocolVersion))",
          "new_text": null,
          "old_line_content": "\t\tmemcpy(packet + packet_len, &pv, sizeof(ProtocolVersion));",
          "new_line_content": " * To avoid duplicate logic, this routine is called twice: the first time",
          "content_same": false
        },
        {
          "line": 1362,
          "old_api": "getCopyDataMessage",
          "new_api": null,
          "old_text": "getCopyDataMessage(conn)",
          "new_text": null,
          "old_line_content": "\t\tmsgLength = getCopyDataMessage(conn);",
          "new_line_content": " * returns row length (always > 0) as result.",
          "content_same": false
        },
        {
          "line": 1875,
          "old_api": "strcpy",
          "new_api": null,
          "old_text": "strcpy(packet + packet_len, \"user\")",
          "new_text": null,
          "old_line_content": "\t\t\tstrcpy(packet + packet_len, \"user\");",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1876,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(\"user\")",
          "new_text": null,
          "old_line_content": "\t\tpacket_len += strlen(\"user\") + 1;",
          "new_line_content": "\tint\t\t\tpacket_len = 0;",
          "content_same": false
        },
        {
          "line": 1878,
          "old_api": "strcpy",
          "new_api": null,
          "old_text": "strcpy(packet + packet_len, conn->pguser)",
          "new_text": null,
          "old_line_content": "\t\t\tstrcpy(packet + packet_len, conn->pguser);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1879,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(conn->pguser)",
          "new_text": null,
          "old_line_content": "\t\tpacket_len += strlen(conn->pguser) + 1;",
          "new_line_content": "\t/* Protocol version comes first. */",
          "content_same": false
        },
        {
          "line": 1885,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(\"database\")",
          "new_text": null,
          "old_line_content": "\t\tpacket_len += strlen(\"database\") + 1;",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1887,
          "old_api": "strcpy",
          "new_api": null,
          "old_text": "strcpy(packet + packet_len, conn->dbName)",
          "new_text": null,
          "old_line_content": "\t\t\tstrcpy(packet + packet_len, conn->dbName);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1888,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(conn->dbName)",
          "new_text": null,
          "old_line_content": "\t\tpacket_len += strlen(conn->dbName) + 1;",
          "new_line_content": "\t/* Add user name, database name, options */",
          "content_same": false
        },
        {
          "line": 1381,
          "old_api": "pqWait",
          "new_api": null,
          "old_text": "pqWait(TRUE, FALSE, conn)",
          "new_text": null,
          "old_line_content": "\t\t\tif (pqWait(TRUE, FALSE, conn) ||",
          "new_line_content": "\t\t{",
          "content_same": false
        },
        {
          "line": 1382,
          "old_api": "pqReadData",
          "new_api": null,
          "old_text": "pqReadData(conn)",
          "new_text": null,
          "old_line_content": "\t\t\t\tpqReadData(conn) < 0)",
          "new_line_content": "\t\t\t/*",
          "content_same": false
        },
        {
          "line": 1894,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(\"options\")",
          "new_text": null,
          "old_line_content": "\t\tpacket_len += strlen(\"options\") + 1;",
          "new_line_content": "\t\tif (packet)",
          "content_same": false
        },
        {
          "line": 1897,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(conn->pgoptions)",
          "new_text": null,
          "old_line_content": "\t\tpacket_len += strlen(conn->pgoptions) + 1;",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1394,
          "old_api": "malloc",
          "new_api": null,
          "old_text": "malloc(msgLength + 1)",
          "new_text": null,
          "old_line_content": "\t\t\t*buffer = (char *) malloc(msgLength + 1);",
          "new_line_content": "\t\t\t/* Don't block if async read requested */",
          "content_same": false
        },
        {
          "line": 1907,
          "old_api": "pg_strcasecmp",
          "new_api": null,
          "old_text": "pg_strcasecmp(val, \"default\")",
          "new_text": null,
          "old_line_content": "\t\t\tif (pg_strcasecmp(val, \"default\") != 0)",
          "new_line_content": "\tif (conn->pgoptions && conn->pgoptions[0])",
          "content_same": false
        },
        {
          "line": 1397,
          "old_api": "printfPQExpBuffer",
          "new_api": null,
          "old_text": "printfPQExpBuffer(&conn->errorMessage,\n\t\t\t\t\t\t\t\t  libpq_gettext(\"out of memory\\n\"))",
          "new_text": null,
          "old_line_content": "\t\t\t\tprintfPQExpBuffer(&conn->errorMessage,",
          "new_line_content": "\t\t\t/* Need to load more data */",
          "content_same": false
        },
        {
          "line": 1401,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(*buffer, &conn->inBuffer[conn->inCursor], msgLength)",
          "new_text": null,
          "old_line_content": "\t\t\tmemcpy(*buffer, &conn->inBuffer[conn->inCursor], msgLength);",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 1429,
          "old_api": "printfPQExpBuffer",
          "new_api": null,
          "old_text": "printfPQExpBuffer(&conn->errorMessage,\n\t\t\t\t\t  libpq_gettext(\"PQgetline: not doing text COPY OUT\\n\"))",
          "new_text": null,
          "old_line_content": "\t\tprintfPQExpBuffer(&conn->errorMessage,",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1430,
          "old_api": "libpq_gettext",
          "new_api": null,
          "old_text": "libpq_gettext(\"PQgetline: not doing text COPY OUT\\n\")",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t  libpq_gettext(\"PQgetline: not doing text COPY OUT\\n\"));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1435,
          "old_api": "PQgetlineAsync",
          "new_api": null,
          "old_text": "PQgetlineAsync(conn, s, maxlen - 1)",
          "new_text": null,
          "old_line_content": "\twhile ((status = PQgetlineAsync(conn, s, maxlen - 1)) == 0)",
          "new_line_content": " * See fe-exec.c for documentation.",
          "content_same": false
        },
        {
          "line": 1438,
          "old_api": "pqWait",
          "new_api": null,
          "old_text": "pqWait(TRUE, FALSE, conn)",
          "new_text": null,
          "old_line_content": "\t\tif (pqWait(TRUE, FALSE, conn) ||",
          "new_line_content": "pqGetline3(PGconn *conn, char *s, int maxlen)",
          "content_same": false
        },
        {
          "line": 1439,
          "old_api": "pqReadData",
          "new_api": null,
          "old_text": "pqReadData(conn)",
          "new_text": null,
          "old_line_content": "\t\t\tpqReadData(conn) < 0)",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1449,
          "old_api": "strcpy",
          "new_api": null,
          "old_text": "strcpy(s, \"\\\\.\")",
          "new_text": null,
          "old_line_content": "\t\tstrcpy(s, \"\\\\.\");",
          "new_line_content": "\t\treturn EOF;",
          "content_same": false
        },
        {
          "line": 1486,
          "old_api": "getCopyDataMessage",
          "new_api": null,
          "old_text": "getCopyDataMessage(conn)",
          "new_text": null,
          "old_line_content": "\tmsgLength = getCopyDataMessage(conn);",
          "new_line_content": " * See fe-exec.c for documentation.",
          "content_same": false
        },
        {
          "line": 1513,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(buffer, &conn->inBuffer[conn->inCursor], bufsize)",
          "new_text": null,
          "old_line_content": "\t\tmemcpy(buffer, &conn->inBuffer[conn->inCursor], bufsize);",
          "new_line_content": "\t * returned to the caller.",
          "content_same": false
        },
        {
          "line": 1533,
          "old_api": "printfPQExpBuffer",
          "new_api": null,
          "old_text": "printfPQExpBuffer(&conn->errorMessage,\n\t\t\t\t\t\t  libpq_gettext(\"no COPY in progress\\n\"))",
          "new_text": null,
          "old_line_content": "\t\tprintfPQExpBuffer(&conn->errorMessage,",
          "new_line_content": "\t\treturn bufsize;",
          "content_same": false
        },
        {
          "line": 1534,
          "old_api": "libpq_gettext",
          "new_api": null,
          "old_text": "libpq_gettext(\"no COPY in progress\\n\")",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t  libpq_gettext(\"no COPY in progress\\n\"));",
          "new_line_content": "\t}",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 14,
      "total_additions": 81,
      "total_deletions": 79,
      "total_api_changes": 174
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 18,
        "api_related_lines": 174,
        "non_api_lines": 14,
        "non_api_line_numbers": [
          1312,
          1314,
          1315,
          1316,
          1317,
          1318,
          1320,
          1322,
          11,
          1325,
          1308,
          1309,
          1310,
          1311
        ]
      }
    },
    "api_calls_before": 281,
    "api_calls_after": 283,
    "diff_info": {
      "added_lines": 18,
      "removed_lines": 1,
      "total_diff_lines": 39
    }
  }
}