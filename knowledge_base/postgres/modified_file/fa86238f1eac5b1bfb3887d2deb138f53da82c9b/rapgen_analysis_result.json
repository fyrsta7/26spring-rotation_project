{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/fa86238f1eac5b1bfb3887d2deb138f53da82c9b",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/fa86238f1eac5b1bfb3887d2deb138f53da82c9b/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/fa86238f1eac5b1bfb3887d2deb138f53da82c9b/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/fa86238f1eac5b1bfb3887d2deb138f53da82c9b/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 2065,
          "old_api": "IsA",
          "new_api": "lfirst",
          "old_text": "IsA(var, RelabelType)",
          "new_text": "lfirst(lc2)",
          "old_line_content": "\t\t\twhile (var && IsA(var, RelabelType))",
          "new_line_content": "\t\t\tEquivalenceMember *em = (EquivalenceMember *) lfirst(lc2);",
          "content_same": false
        },
        {
          "line": 2145,
          "old_api": "bms_overlap",
          "new_api": "foreach",
          "old_text": "bms_overlap(cur_em->em_relids, parent_rel->relids)",
          "new_text": "foreach(lc2, cur_ec->ec_members)",
          "old_line_content": "\t\t\tif (bms_overlap(cur_em->em_relids, parent_rel->relids))",
          "new_line_content": "\t\tforeach(lc2, cur_ec->ec_members)",
          "content_same": false
        },
        {
          "line": 2153,
          "old_api": "adjust_appendrel_attrs",
          "new_api": "bms_overlap",
          "old_text": "adjust_appendrel_attrs(root,\n\t\t\t\t\t\t\t\t\t\t   (Node *) cur_em->em_expr,\n\t\t\t\t\t\t\t\t\t\t   1, &appinfo)",
          "new_text": "bms_overlap(cur_em->em_relids, parent_rel->relids)",
          "old_line_content": "\t\t\t\t\tadjust_appendrel_attrs(root,",
          "new_line_content": "\t\t\tif (bms_overlap(cur_em->em_relids, parent_rel->relids))",
          "content_same": false
        },
        {
          "line": 2180,
          "old_api": "add_eq_member",
          "new_api": "bms_overlap",
          "old_text": "add_eq_member(cur_ec, child_expr,\n\t\t\t\t\t\t\t\t\t new_relids, new_nullable_relids,\n\t\t\t\t\t\t\t\t\t true, cur_em->em_datatype)",
          "new_text": "bms_overlap(new_nullable_relids, parent_rel->relids)",
          "old_line_content": "\t\t\t\t(void) add_eq_member(cur_ec, child_expr,",
          "new_line_content": "\t\t\t\tif (bms_overlap(new_nullable_relids, parent_rel->relids))",
          "content_same": false
        },
        {
          "line": 2233,
          "old_api": "foreach",
          "new_api": "IS_SIMPLE_REL",
          "old_text": "foreach(lc1, root->eq_classes)",
          "new_text": "IS_SIMPLE_REL(rel)",
          "old_line_content": "\tforeach(lc1, root->eq_classes)",
          "new_line_content": "\tAssert(IS_SIMPLE_REL(rel));",
          "content_same": false
        },
        {
          "line": 2243,
          "old_api": "list_length",
          "new_api": "lfirst",
          "old_text": "list_length(cur_ec->ec_members)",
          "new_text": "lfirst(lc1)",
          "old_line_content": "\t\tif (cur_ec->ec_has_const || list_length(cur_ec->ec_members) <= 1)",
          "new_line_content": "\t\tEquivalenceClass *cur_ec = (EquivalenceClass *) lfirst(lc1);",
          "content_same": false
        },
        {
          "line": 2251,
          "old_api": "bms_is_subset",
          "new_api": "list_length",
          "old_text": "bms_is_subset(rel->relids, cur_ec->ec_relids)",
          "new_text": "list_length(cur_ec->ec_members)",
          "old_line_content": "\t\t\t!bms_is_subset(rel->relids, cur_ec->ec_relids))",
          "new_line_content": "\t\tif (cur_ec->ec_has_const || list_length(cur_ec->ec_members) <= 1)",
          "content_same": false
        },
        {
          "line": 2318,
          "old_api": "lappend",
          "new_api": "OidIsValid",
          "old_text": "lappend(result, rinfo)",
          "new_text": "OidIsValid(eq_op)",
          "old_line_content": "\t\t\tresult = lappend(result, rinfo);",
          "new_line_content": "\t\t\tif (!OidIsValid(eq_op))",
          "content_same": false
        },
        {
          "line": 2357,
          "old_api": "list_length",
          "new_api": "foreach",
          "old_text": "list_length(ec->ec_members)",
          "new_text": "foreach(lc1, root->eq_classes)",
          "old_line_content": "\t\tif (list_length(ec->ec_members) <= 1)",
          "new_line_content": "\tforeach(lc1, root->eq_classes)",
          "content_same": false
        },
        {
          "line": 2410,
          "old_api": "list_length",
          "new_api": "foreach",
          "old_text": "list_length(ec->ec_members)",
          "new_text": "foreach(lc1, root->eq_classes)",
          "old_line_content": "\t\tif (list_length(ec->ec_members) <= 1)",
          "new_line_content": "\tforeach(lc1, root->eq_classes)",
          "content_same": false
        },
        {
          "line": 2418,
          "old_api": "bms_is_subset",
          "new_api": "list_length",
          "old_text": "bms_is_subset(ec->ec_relids, rel1->relids)",
          "new_text": "list_length(ec->ec_members)",
          "old_line_content": "\t\t\t!bms_is_subset(ec->ec_relids, rel1->relids))",
          "new_line_content": "\t\tif (list_length(ec->ec_members) <= 1)",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 2182,
          "old_api": null,
          "new_api": "bms_difference",
          "old_text": null,
          "new_text": "bms_difference(new_nullable_relids,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t parent_rel->relids)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t true, cur_em->em_datatype);",
          "new_line_content": "\t\t\t\t\tnew_nullable_relids = bms_difference(new_nullable_relids,",
          "content_same": false
        },
        {
          "line": 2184,
          "old_api": null,
          "new_api": "bms_add_members",
          "old_text": null,
          "new_text": "bms_add_members(new_nullable_relids,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  child_rel->relids)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\t\tnew_nullable_relids = bms_add_members(new_nullable_relids,",
          "content_same": false
        },
        {
          "line": 2312,
          "old_api": null,
          "new_api": "bms_overlap",
          "old_text": null,
          "new_text": "bms_overlap(parent_relids, other_em->em_relids)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tbms_overlap(parent_relids, other_em->em_relids))",
          "content_same": false
        },
        {
          "line": 2059,
          "old_api": null,
          "new_api": "bms_is_member",
          "old_text": null,
          "new_text": "bms_is_member(var1varno, ec->ec_relids)",
          "old_line_content": "",
          "new_line_content": "\t\tif (!bms_is_member(var1varno, ec->ec_relids) ||",
          "content_same": false
        },
        {
          "line": 2060,
          "old_api": null,
          "new_api": "bms_is_member",
          "old_text": null,
          "new_text": "bms_is_member(var2varno, ec->ec_relids)",
          "old_line_content": "\t\t\tif (em->em_is_child)",
          "new_line_content": "\t\t\t!bms_is_member(var2varno, ec->ec_relids))",
          "content_same": false
        },
        {
          "line": 2188,
          "old_api": null,
          "new_api": "add_eq_member",
          "old_text": null,
          "new_text": "add_eq_member(cur_ec, child_expr,\n\t\t\t\t\t\t\t\t\t new_relids, new_nullable_relids,\n\t\t\t\t\t\t\t\t\t true, cur_em->em_datatype)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t(void) add_eq_member(cur_ec, child_expr,",
          "content_same": false
        },
        {
          "line": 2315,
          "old_api": null,
          "new_api": "select_equality_operator",
          "old_text": null,
          "new_text": "select_equality_operator(cur_ec,\n\t\t\t\t\t\t\t\t\t\t\t cur_em->em_datatype,\n\t\t\t\t\t\t\t\t\t\t\t other_em->em_datatype)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t   cur_em, other_em,",
          "new_line_content": "\t\t\teq_op = select_equality_operator(cur_ec,",
          "content_same": false
        },
        {
          "line": 2063,
          "old_api": null,
          "new_api": "foreach",
          "old_text": null,
          "new_text": "foreach(lc2, ec->ec_members)",
          "old_line_content": "\t\t\t/* EM must be a Var, possibly with RelabelType */",
          "new_line_content": "\t\tforeach(lc2, ec->ec_members)",
          "content_same": false
        },
        {
          "line": 2322,
          "old_api": null,
          "new_api": "create_join_clause",
          "old_text": null,
          "new_text": "create_join_clause(root, cur_ec, eq_op,\n\t\t\t\t\t\t\t\t\t   cur_em, other_em,\n\t\t\t\t\t\t\t\t\t   cur_ec)",
          "old_line_content": "\t\t * If somehow we failed to create any join clauses, we might as well",
          "new_line_content": "\t\t\trinfo = create_join_clause(root, cur_ec, eq_op,",
          "content_same": false
        },
        {
          "line": 2452,
          "old_api": null,
          "new_api": "Assert",
          "old_text": null,
          "new_text": "Assert(!eclass->ec_merged)",
          "old_line_content": "",
          "new_line_content": "\tAssert(!eclass->ec_merged);",
          "content_same": false
        },
        {
          "line": 2326,
          "old_api": null,
          "new_api": "lappend",
          "old_text": null,
          "new_text": "lappend(result, rinfo)",
          "old_line_content": "\t\tif (result)",
          "new_line_content": "\t\t\tresult = lappend(result, rinfo);",
          "content_same": false
        },
        {
          "line": 2073,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(var, RelabelType)",
          "old_line_content": "\t\t\telse if (var->varno == var2varno && var->varattno == var2attno)",
          "new_line_content": "\t\t\twhile (var && IsA(var, RelabelType))",
          "content_same": false
        },
        {
          "line": 2458,
          "old_api": null,
          "new_api": "list_length",
          "old_text": null,
          "new_text": "list_length(eclass->ec_members)",
          "old_line_content": "",
          "new_line_content": "\tif (eclass->ec_has_const || list_length(eclass->ec_members) <= 1)",
          "content_same": false
        },
        {
          "line": 2075,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(var, Var)",
          "old_line_content": "",
          "new_line_content": "\t\t\tif (!(var && IsA(var, Var)))",
          "content_same": false
        },
        {
          "line": 2468,
          "old_api": null,
          "new_api": "IS_OTHER_REL",
          "old_text": null,
          "new_text": "IS_OTHER_REL(rel)",
          "old_line_content": "\t/* If rel already includes all members of eclass, no point in searching */",
          "new_line_content": "\tif (IS_OTHER_REL(rel))",
          "content_same": false
        },
        {
          "line": 2470,
          "old_api": null,
          "new_api": "bms_is_empty",
          "old_text": null,
          "new_text": "bms_is_empty(rel->top_parent_relids)",
          "old_line_content": "\t\treturn false;",
          "new_line_content": "\t\tAssert(!bms_is_empty(rel->top_parent_relids));",
          "content_same": false
        },
        {
          "line": 2093,
          "old_api": null,
          "new_api": "get_mergejoin_opfamilies",
          "old_text": null,
          "new_text": "get_mergejoin_opfamilies(eqop)",
          "old_line_content": "\treturn NULL;",
          "new_line_content": "\t\t\t\t\topfamilies = get_mergejoin_opfamilies(eqop);",
          "content_same": false
        },
        {
          "line": 2094,
          "old_api": null,
          "new_api": "equal",
          "old_text": null,
          "new_text": "equal(opfamilies, ec->ec_opfamilies)",
          "old_line_content": "}",
          "new_line_content": "\t\t\t\tif (equal(opfamilies, ec->ec_opfamilies))",
          "content_same": false
        },
        {
          "line": 2477,
          "old_api": null,
          "new_api": "bms_is_subset",
          "old_text": null,
          "new_text": "bms_is_subset(eclass->ec_relids, relids)",
          "old_line_content": "\t\tif (cur_em->em_is_child)",
          "new_line_content": "\tif (bms_is_subset(eclass->ec_relids, relids))",
          "content_same": false
        },
        {
          "line": 2481,
          "old_api": null,
          "new_api": "foreach",
          "old_text": null,
          "new_text": "foreach(lc, eclass->ec_members)",
          "old_line_content": "\t\t\treturn true;",
          "new_line_content": "\tforeach(lc, eclass->ec_members)",
          "content_same": false
        },
        {
          "line": 2483,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(lc)",
          "old_line_content": "",
          "new_line_content": "\t\tEquivalenceMember *cur_em = (EquivalenceMember *) lfirst(lc);",
          "content_same": false
        },
        {
          "line": 2359,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(lc1)",
          "old_line_content": "",
          "new_line_content": "\t\tEquivalenceClass *ec = (EquivalenceClass *) lfirst(lc1);",
          "content_same": false
        },
        {
          "line": 2488,
          "old_api": null,
          "new_api": "bms_overlap",
          "old_text": null,
          "new_text": "bms_overlap(cur_em->em_relids, relids)",
          "old_line_content": "/*",
          "new_line_content": "\t\tif (!bms_overlap(cur_em->em_relids, relids))",
          "content_same": false
        },
        {
          "line": 2237,
          "old_api": null,
          "new_api": "find_childrel_parents",
          "old_text": null,
          "new_text": "find_childrel_parents(root, rel)",
          "old_line_content": "\t\tListCell   *lc2;",
          "new_line_content": "\t\tparent_relids = find_childrel_parents(root, rel);",
          "content_same": false
        },
        {
          "line": 2365,
          "old_api": null,
          "new_api": "list_length",
          "old_text": null,
          "new_text": "list_length(ec->ec_members)",
          "old_line_content": "\t\t * that the EC be able to form a joinclause relating exactly the two",
          "new_line_content": "\t\tif (list_length(ec->ec_members) <= 1)",
          "content_same": false
        },
        {
          "line": 2241,
          "old_api": null,
          "new_api": "foreach",
          "old_text": null,
          "new_text": "foreach(lc1, root->eq_classes)",
          "old_line_content": "\t\t * test covers the volatile case too)",
          "new_line_content": "\tforeach(lc1, root->eq_classes)",
          "content_same": false
        },
        {
          "line": 2124,
          "old_api": null,
          "new_api": "foreach",
          "old_text": null,
          "new_text": "foreach(lc1, root->eq_classes)",
          "old_line_content": "\t\t * volatile EC having only one EM.",
          "new_line_content": "\tforeach(lc1, root->eq_classes)",
          "content_same": false
        },
        {
          "line": 2126,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(lc1)",
          "old_line_content": "\t\tif (cur_ec->ec_has_volatile)",
          "new_line_content": "\t\tEquivalenceClass *cur_ec = (EquivalenceClass *) lfirst(lc1);",
          "content_same": false
        },
        {
          "line": 2514,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(lc)",
          "old_line_content": "",
          "new_line_content": "\t\tRestrictInfo *otherrinfo = (RestrictInfo *) lfirst(lc);",
          "content_same": false
        },
        {
          "line": 2259,
          "old_api": null,
          "new_api": "bms_is_subset",
          "old_text": null,
          "new_text": "bms_is_subset(rel->relids, cur_ec->ec_relids)",
          "old_line_content": "\t\t * potentially order-dependent which EC a child relation's target",
          "new_line_content": "\t\t\t!bms_is_subset(rel->relids, cur_ec->ec_relids))",
          "content_same": false
        },
        {
          "line": 2388,
          "old_api": null,
          "new_api": "bms_overlap",
          "old_text": null,
          "new_text": "bms_overlap(rel1->relids, ec->ec_relids)",
          "old_line_content": "",
          "new_line_content": "\t\tif (bms_overlap(rel1->relids, ec->ec_relids) &&",
          "content_same": false
        },
        {
          "line": 2389,
          "old_api": null,
          "new_api": "bms_overlap",
          "old_text": null,
          "new_text": "bms_overlap(rel2->relids, ec->ec_relids)",
          "old_line_content": "/*",
          "new_line_content": "\t\t\tbms_overlap(rel2->relids, ec->ec_relids))",
          "content_same": false
        },
        {
          "line": 2142,
          "old_api": null,
          "new_api": "bms_is_subset",
          "old_text": null,
          "new_text": "bms_is_subset(parent_rel->relids, cur_ec->ec_relids)",
          "old_line_content": "\t\t\t\tcontinue;\t\t/* ignore consts here */",
          "new_line_content": "\t\t\t!bms_is_subset(parent_rel->relids, cur_ec->ec_relids))",
          "content_same": false
        },
        {
          "line": 2273,
          "old_api": null,
          "new_api": "foreach",
          "old_text": null,
          "new_text": "foreach(lc2, cur_ec->ec_members)",
          "old_line_content": "",
          "new_line_content": "\t\tforeach(lc2, cur_ec->ec_members)",
          "content_same": false
        },
        {
          "line": 2147,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(lc2)",
          "old_line_content": "\t\t\t\t/* Yes, generate transformed child version */",
          "new_line_content": "\t\t\tEquivalenceMember *cur_em = (EquivalenceMember *) lfirst(lc2);",
          "content_same": false
        },
        {
          "line": 2275,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(lc2)",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\t\tcur_em = (EquivalenceMember *) lfirst(lc2);",
          "content_same": false
        },
        {
          "line": 2276,
          "old_api": null,
          "new_api": "bms_equal",
          "old_text": null,
          "new_text": "bms_equal(cur_em->em_relids, rel->relids)",
          "old_line_content": "",
          "new_line_content": "\t\t\tif (bms_equal(cur_em->em_relids, rel->relids) &&",
          "content_same": false
        },
        {
          "line": 2277,
          "old_api": null,
          "new_api": "callback",
          "old_text": null,
          "new_text": "callback(root, rel, cur_ec, cur_em, callback_arg)",
          "old_line_content": "\t\t/*",
          "new_line_content": "\t\t\t\tcallback(root, rel, cur_ec, cur_em, callback_arg))",
          "content_same": false
        },
        {
          "line": 2537,
          "old_api": null,
          "new_api": "lfirst_node",
          "old_text": null,
          "new_text": "lfirst_node(IndexClause, lc)",
          "old_line_content": "\t\tif (rinfo == otherrinfo)",
          "new_line_content": "\t\tIndexClause *iclause = lfirst_node(IndexClause, lc);",
          "content_same": false
        },
        {
          "line": 2412,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(lc1)",
          "old_line_content": "",
          "new_line_content": "\t\tEquivalenceClass *ec = (EquivalenceClass *) lfirst(lc1);",
          "content_same": false
        },
        {
          "line": 2161,
          "old_api": null,
          "new_api": "adjust_appendrel_attrs",
          "old_text": null,
          "new_text": "adjust_appendrel_attrs(root,\n\t\t\t\t\t\t\t\t\t\t   (Node *) cur_em->em_expr,\n\t\t\t\t\t\t\t\t\t\t   1, &appinfo)",
          "old_line_content": "\t\t\t\t * don't want the child member to be marked as constant.",
          "new_line_content": "\t\t\t\t\tadjust_appendrel_attrs(root,",
          "content_same": false
        },
        {
          "line": 2289,
          "old_api": null,
          "new_api": "foreach",
          "old_text": null,
          "new_text": "foreach(lc2, cur_ec->ec_members)",
          "old_line_content": "",
          "new_line_content": "\t\tforeach(lc2, cur_ec->ec_members)",
          "content_same": false
        },
        {
          "line": 2291,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(lc2)",
          "old_line_content": "\t\t\tif (other_em == cur_em ||",
          "new_line_content": "\t\t\tEquivalenceMember *other_em = (EquivalenceMember *) lfirst(lc2);",
          "content_same": false
        },
        {
          "line": 2425,
          "old_api": null,
          "new_api": "bms_overlap",
          "old_text": null,
          "new_text": "bms_overlap(rel1->relids, ec->ec_relids)",
          "old_line_content": "",
          "new_line_content": "\t\tif (bms_overlap(rel1->relids, ec->ec_relids) &&",
          "content_same": false
        },
        {
          "line": 2426,
          "old_api": null,
          "new_api": "bms_is_subset",
          "old_text": null,
          "new_text": "bms_is_subset(ec->ec_relids, rel1->relids)",
          "old_line_content": "/*",
          "new_line_content": "\t\t\t!bms_is_subset(ec->ec_relids, rel1->relids))",
          "content_same": false
        },
        {
          "line": 2171,
          "old_api": null,
          "new_api": "bms_difference",
          "old_text": null,
          "new_text": "bms_difference(cur_em->em_relids,\n\t\t\t\t\t\t\t\t\t\t\tparent_rel->relids)",
          "old_line_content": "\t\t\t\tnew_nullable_relids = cur_em->em_nullable_relids;",
          "new_line_content": "\t\t\t\tnew_relids = bms_difference(cur_em->em_relids,",
          "content_same": false
        },
        {
          "line": 2300,
          "old_api": null,
          "new_api": "bms_overlap",
          "old_text": null,
          "new_text": "bms_overlap(other_em->em_relids, rel->relids)",
          "old_line_content": "\t\t\t * Also, if this is a child rel, avoid generating a useless join",
          "new_line_content": "\t\t\t\tbms_overlap(other_em->em_relids, rel->relids))",
          "content_same": false
        },
        {
          "line": 2173,
          "old_api": null,
          "new_api": "bms_add_members",
          "old_text": null,
          "new_text": "bms_add_members(new_relids, child_rel->relids)",
          "old_line_content": "\t\t\t\t{",
          "new_line_content": "\t\t\t\tnew_relids = bms_add_members(new_relids, child_rel->relids);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 2176,
          "old_api": "bms_add_members",
          "new_api": null,
          "old_text": "bms_add_members(new_nullable_relids,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t  child_rel->relids)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tnew_nullable_relids = bms_add_members(new_nullable_relids,",
          "new_line_content": "\t\t\t\t * And likewise for nullable_relids.  Note this code assumes",
          "content_same": false
        },
        {
          "line": 2307,
          "old_api": "select_equality_operator",
          "new_api": null,
          "old_text": "select_equality_operator(cur_ec,\n\t\t\t\t\t\t\t\t\t\t\t cur_em->em_datatype,\n\t\t\t\t\t\t\t\t\t\t\t other_em->em_datatype)",
          "new_text": null,
          "old_line_content": "\t\t\teq_op = select_equality_operator(cur_ec,",
          "new_line_content": "\t\t\t/*",
          "content_same": false
        },
        {
          "line": 2310,
          "old_api": "OidIsValid",
          "new_api": null,
          "old_text": "OidIsValid(eq_op)",
          "new_text": null,
          "old_line_content": "\t\t\tif (!OidIsValid(eq_op))",
          "new_line_content": "\t\t\t */",
          "content_same": false
        },
        {
          "line": 2055,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(lc2, ec->ec_members)",
          "new_text": null,
          "old_line_content": "\t\tforeach(lc2, ec->ec_members)",
          "new_line_content": "\t\t/*",
          "content_same": false
        },
        {
          "line": 2057,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc2)",
          "new_text": null,
          "old_line_content": "\t\t\tEquivalenceMember *em = (EquivalenceMember *) lfirst(lc2);",
          "new_line_content": "\t\t * need to grovel through the members.",
          "content_same": false
        },
        {
          "line": 2314,
          "old_api": "create_join_clause",
          "new_api": null,
          "old_text": "create_join_clause(root, cur_ec, eq_op,\n\t\t\t\t\t\t\t\t\t   cur_em, other_em,\n\t\t\t\t\t\t\t\t\t   cur_ec)",
          "new_text": null,
          "old_line_content": "\t\t\trinfo = create_join_clause(root, cur_ec, eq_op,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2444,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(!eclass->ec_merged)",
          "new_text": null,
          "old_line_content": "\tAssert(!eclass->ec_merged);",
          "new_line_content": "bool",
          "content_same": false
        },
        {
          "line": 2450,
          "old_api": "list_length",
          "new_api": null,
          "old_text": "list_length(eclass->ec_members)",
          "new_text": null,
          "old_line_content": "\tif (eclass->ec_has_const || list_length(eclass->ec_members) <= 1)",
          "new_line_content": "\tListCell   *lc;",
          "content_same": false
        },
        {
          "line": 2067,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(var, Var)",
          "new_text": null,
          "old_line_content": "\t\t\tif (!(var && IsA(var, Var)))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2460,
          "old_api": "IS_OTHER_REL",
          "new_api": null,
          "old_text": "IS_OTHER_REL(rel)",
          "new_text": null,
          "old_line_content": "\tif (IS_OTHER_REL(rel))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2462,
          "old_api": "bms_is_empty",
          "new_api": null,
          "old_text": "bms_is_empty(rel->top_parent_relids)",
          "new_text": null,
          "old_line_content": "\t\tAssert(!bms_is_empty(rel->top_parent_relids));",
          "new_line_content": "\t * Note we don't test ec_broken; if we did, we'd need a separate code path",
          "content_same": false
        },
        {
          "line": 2085,
          "old_api": "get_mergejoin_opfamilies",
          "new_api": null,
          "old_text": "get_mergejoin_opfamilies(eqop)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\topfamilies = get_mergejoin_opfamilies(eqop);",
          "new_line_content": "\t\t\tif (item1member && item2member)",
          "content_same": false
        },
        {
          "line": 2086,
          "old_api": "equal",
          "new_api": null,
          "old_text": "equal(opfamilies, ec->ec_opfamilies)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (equal(opfamilies, ec->ec_opfamilies))",
          "new_line_content": "\t\t\t{",
          "content_same": false
        },
        {
          "line": 2469,
          "old_api": "bms_is_subset",
          "new_api": null,
          "old_text": "bms_is_subset(eclass->ec_relids, relids)",
          "new_text": null,
          "old_line_content": "\tif (bms_is_subset(eclass->ec_relids, relids))",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 2473,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(lc, eclass->ec_members)",
          "new_text": null,
          "old_line_content": "\tforeach(lc, eclass->ec_members)",
          "new_line_content": "\telse",
          "content_same": false
        },
        {
          "line": 2475,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc)",
          "new_text": null,
          "old_line_content": "\t\tEquivalenceMember *cur_em = (EquivalenceMember *) lfirst(lc);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2349,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(lc1, root->eq_classes)",
          "new_text": null,
          "old_line_content": "\tforeach(lc1, root->eq_classes)",
          "new_line_content": " * cross-type operator might prevent the clause from actually being generated.",
          "content_same": false
        },
        {
          "line": 2351,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc1)",
          "new_text": null,
          "old_line_content": "\t\tEquivalenceClass *ec = (EquivalenceClass *) lfirst(lc1);",
          "new_line_content": "bool",
          "content_same": false
        },
        {
          "line": 2480,
          "old_api": "bms_overlap",
          "new_api": null,
          "old_text": "bms_overlap(cur_em->em_relids, relids)",
          "new_text": null,
          "old_line_content": "\t\tif (!bms_overlap(cur_em->em_relids, relids))",
          "new_line_content": "\t/* To join, we need a member not in the given rel */",
          "content_same": false
        },
        {
          "line": 2225,
          "old_api": "IS_SIMPLE_REL",
          "new_api": null,
          "old_text": "IS_SIMPLE_REL(rel)",
          "new_text": null,
          "old_line_content": "\tAssert(IS_SIMPLE_REL(rel));",
          "new_line_content": "\t\t\t\t\t\t\t\t\t   Relids prohibited_rels)",
          "content_same": false
        },
        {
          "line": 2229,
          "old_api": "find_childrel_parents",
          "new_api": null,
          "old_text": "find_childrel_parents(root, rel)",
          "new_text": null,
          "old_line_content": "\t\tparent_relids = find_childrel_parents(root, rel);",
          "new_line_content": "\tRelids\t\tparent_relids;",
          "content_same": false
        },
        {
          "line": 2235,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc1)",
          "new_text": null,
          "old_line_content": "\t\tEquivalenceClass *cur_ec = (EquivalenceClass *) lfirst(lc1);",
          "new_line_content": "\t/* If it's a child rel, we'll need to know what its parent(s) are */",
          "content_same": false
        },
        {
          "line": 2116,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(lc1, root->eq_classes)",
          "new_text": null,
          "old_line_content": "\tforeach(lc1, root->eq_classes)",
          "new_line_content": "void",
          "content_same": false
        },
        {
          "line": 2118,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc1)",
          "new_text": null,
          "old_line_content": "\t\tEquivalenceClass *cur_ec = (EquivalenceClass *) lfirst(lc1);",
          "new_line_content": "\t\t\t\t\t\t   AppendRelInfo *appinfo,",
          "content_same": false
        },
        {
          "line": 2506,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc)",
          "new_text": null,
          "old_line_content": "\t\tRestrictInfo *otherrinfo = (RestrictInfo *) lfirst(lc);",
          "new_line_content": "\tListCell   *lc;",
          "content_same": false
        },
        {
          "line": 2380,
          "old_api": "bms_overlap",
          "new_api": null,
          "old_text": "bms_overlap(rel1->relids, ec->ec_relids)",
          "new_text": null,
          "old_line_content": "\t\tif (bms_overlap(rel1->relids, ec->ec_relids) &&",
          "new_line_content": "\t\t * OK as a possibly-overoptimistic heuristic.",
          "content_same": false
        },
        {
          "line": 2381,
          "old_api": "bms_overlap",
          "new_api": null,
          "old_text": "bms_overlap(rel2->relids, ec->ec_relids)",
          "new_text": null,
          "old_line_content": "\t\t\tbms_overlap(rel2->relids, ec->ec_relids))",
          "new_line_content": "\t\t *",
          "content_same": false
        },
        {
          "line": 2134,
          "old_api": "bms_is_subset",
          "new_api": null,
          "old_text": "bms_is_subset(parent_rel->relids, cur_ec->ec_relids)",
          "new_text": null,
          "old_line_content": "\t\t\t!bms_is_subset(parent_rel->relids, cur_ec->ec_relids))",
          "new_line_content": "\t\tif (cur_ec->ec_has_volatile)",
          "content_same": false
        },
        {
          "line": 2265,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(lc2, cur_ec->ec_members)",
          "new_text": null,
          "old_line_content": "\t\tforeach(lc2, cur_ec->ec_members)",
          "new_line_content": "\t\t * target relation.  (Unlike regular members, the same expression",
          "content_same": false
        },
        {
          "line": 2137,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(lc2, cur_ec->ec_members)",
          "new_text": null,
          "old_line_content": "\t\tforeach(lc2, cur_ec->ec_members)",
          "new_line_content": "\t\t/*",
          "content_same": false
        },
        {
          "line": 2139,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc2)",
          "new_text": null,
          "old_line_content": "\t\t\tEquivalenceMember *cur_em = (EquivalenceMember *) lfirst(lc2);",
          "new_line_content": "\t\t * can't tell that for sure if parent rel is itself a child.",
          "content_same": false
        },
        {
          "line": 2267,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc2)",
          "new_text": null,
          "old_line_content": "\t\t\tcur_em = (EquivalenceMember *) lfirst(lc2);",
          "new_line_content": "\t\t * potentially order-dependent which EC a child relation's target",
          "content_same": false
        },
        {
          "line": 2268,
          "old_api": "bms_equal",
          "new_api": null,
          "old_text": "bms_equal(cur_em->em_relids, rel->relids)",
          "new_text": null,
          "old_line_content": "\t\t\tif (bms_equal(cur_em->em_relids, rel->relids) &&",
          "new_line_content": "\t\t * column gets matched to.  This is annoying but it only happens in",
          "content_same": false
        },
        {
          "line": 2269,
          "old_api": "callback",
          "new_api": null,
          "old_text": "callback(root, rel, cur_ec, cur_em, callback_arg)",
          "new_text": null,
          "old_line_content": "\t\t\t\tcallback(root, rel, cur_ec, cur_em, callback_arg))",
          "new_line_content": "\t\t * corner cases, so for now we live with just reporting the first",
          "content_same": false
        },
        {
          "line": 2529,
          "old_api": "lfirst_node",
          "new_api": null,
          "old_text": "lfirst_node(IndexClause, lc)",
          "new_text": null,
          "old_line_content": "\t\tIndexClause *iclause = lfirst_node(IndexClause, lc);",
          "new_line_content": "bool",
          "content_same": false
        },
        {
          "line": 2402,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(lc1, root->eq_classes)",
          "new_text": null,
          "old_line_content": "\tforeach(lc1, root->eq_classes)",
          "new_line_content": " * This is the same as have_relevant_eclass_joinclause with the other rel",
          "content_same": false
        },
        {
          "line": 2404,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc1)",
          "new_text": null,
          "old_line_content": "\t\tEquivalenceClass *ec = (EquivalenceClass *) lfirst(lc1);",
          "new_line_content": " */",
          "content_same": false
        },
        {
          "line": 2281,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(lc2, cur_ec->ec_members)",
          "new_text": null,
          "old_line_content": "\t\tforeach(lc2, cur_ec->ec_members)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2283,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(lc2)",
          "new_text": null,
          "old_line_content": "\t\t\tEquivalenceMember *other_em = (EquivalenceMember *) lfirst(lc2);",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 2417,
          "old_api": "bms_overlap",
          "new_api": null,
          "old_text": "bms_overlap(rel1->relids, ec->ec_relids)",
          "new_text": null,
          "old_line_content": "\t\tif (bms_overlap(rel1->relids, ec->ec_relids) &&",
          "new_line_content": "\t\t */",
          "content_same": false
        },
        {
          "line": 2163,
          "old_api": "bms_difference",
          "new_api": null,
          "old_text": "bms_difference(cur_em->em_relids,\n\t\t\t\t\t\t\t\t\t\t\tparent_rel->relids)",
          "new_text": null,
          "old_line_content": "\t\t\t\tnew_relids = bms_difference(cur_em->em_relids,",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t   1, &appinfo);",
          "content_same": false
        },
        {
          "line": 2292,
          "old_api": "bms_overlap",
          "new_api": null,
          "old_text": "bms_overlap(other_em->em_relids, rel->relids)",
          "new_text": null,
          "old_line_content": "\t\t\t\tbms_overlap(other_em->em_relids, rel->relids))",
          "new_line_content": "\t\t\tOid\t\t\teq_op;",
          "content_same": false
        },
        {
          "line": 2165,
          "old_api": "bms_add_members",
          "new_api": null,
          "old_text": "bms_add_members(new_relids, child_rel->relids)",
          "new_text": null,
          "old_line_content": "\t\t\t\tnew_relids = bms_add_members(new_relids, child_rel->relids);",
          "new_line_content": "\t\t\t\t/*",
          "content_same": false
        },
        {
          "line": 2296,
          "old_api": "bms_overlap",
          "new_api": null,
          "old_text": "bms_overlap(other_em->em_relids, prohibited_rels)",
          "new_text": null,
          "old_line_content": "\t\t\tif (bms_overlap(other_em->em_relids, prohibited_rels))",
          "new_line_content": "\t\t\t\tcontinue;\t\t/* ignore children here */",
          "content_same": false
        },
        {
          "line": 2172,
          "old_api": "bms_overlap",
          "new_api": null,
          "old_text": "bms_overlap(new_nullable_relids, parent_rel->relids)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (bms_overlap(new_nullable_relids, parent_rel->relids))",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t\tparent_rel->relids);",
          "content_same": false
        },
        {
          "line": 2174,
          "old_api": "bms_difference",
          "new_api": null,
          "old_text": "bms_difference(new_nullable_relids,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t parent_rel->relids)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tnew_nullable_relids = bms_difference(new_nullable_relids,",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 11,
      "total_additions": 48,
      "total_deletions": 46,
      "total_api_changes": 105
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 8,
        "api_related_lines": 105,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          2056,
          2058,
          2061,
          2062
        ]
      }
    },
    "api_calls_before": 358,
    "api_calls_after": 360,
    "diff_info": {
      "added_lines": 8,
      "removed_lines": 0,
      "total_diff_lines": 20
    }
  }
}