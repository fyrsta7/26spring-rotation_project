{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/8685c472235b7a5bcc786f66ba9adde44e3d670c",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/8685c472235b7a5bcc786f66ba9adde44e3d670c/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/8685c472235b7a5bcc786f66ba9adde44e3d670c/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/8685c472235b7a5bcc786f66ba9adde44e3d670c/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1672,
          "old_api": "exprType",
          "new_api": "list_head",
          "old_text": "exprType(e)",
          "new_text": "list_head(cexpr->args)",
          "old_line_content": "\t\t\t\t\tif (exprType(e) != coalescetype)",
          "new_line_content": "\t\t\t\tfor_each_cell(arg, lnext(list_head(cexpr->args)))",
          "content_same": false
        },
        {
          "line": 1674,
          "old_api": "exprTypmod",
          "new_api": "lfirst",
          "old_text": "exprTypmod(e)",
          "new_text": "lfirst(arg)",
          "old_line_content": "\t\t\t\t\tif (exprTypmod(e) != typmod)",
          "new_line_content": "\t\t\t\t\tNode\t   *e = (Node *) lfirst(arg);",
          "content_same": false
        },
        {
          "line": 1797,
          "old_api": "coerce_to_target_type",
          "new_api": "exprType",
          "old_text": "coerce_to_target_type(pstate, expr, inputType,\n\t\t\t\t\t\t\t\t targetType, typename->typmod,\n\t\t\t\t\t\t\t\t COERCION_EXPLICIT,\n\t\t\t\t\t\t\t\t COERCE_EXPLICIT_CAST)",
          "new_text": "exprType(expr)",
          "old_line_content": "\texpr = coerce_to_target_type(pstate, expr, inputType,",
          "new_line_content": "\tOid\t\t\tinputType = exprType(expr);",
          "content_same": false
        },
        {
          "line": 1805,
          "old_api": "format_type_be",
          "new_api": "coerce_to_target_type",
          "old_text": "format_type_be(inputType)",
          "new_text": "coerce_to_target_type(pstate, expr, inputType,\n\t\t\t\t\t\t\t\t targetType, typename->typmod,\n\t\t\t\t\t\t\t\t COERCION_EXPLICIT,\n\t\t\t\t\t\t\t\t COERCE_EXPLICIT_CAST)",
          "old_line_content": "\t\t\t\t\t\tformat_type_be(inputType),",
          "new_line_content": "\texpr = coerce_to_target_type(pstate, expr, inputType,",
          "content_same": false
        },
        {
          "line": 1836,
          "old_api": "ereport",
          "new_api": "transformExpr",
          "old_text": "ereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_SYNTAX_ERROR),\n\t\t\t\t errmsg(\"unequal number of entries in row expression\")))",
          "new_text": "transformExpr(pstate, ltree)",
          "old_line_content": "\t\tereport(ERROR,",
          "new_line_content": "\tlrow = (RowExpr *) transformExpr(pstate, ltree);",
          "content_same": false
        },
        {
          "line": 1837,
          "old_api": "errcode",
          "new_api": "transformExpr",
          "old_text": "errcode(ERRCODE_SYNTAX_ERROR)",
          "new_text": "transformExpr(pstate, rtree)",
          "old_line_content": "\t\t\t\t(errcode(ERRCODE_SYNTAX_ERROR),",
          "new_line_content": "\trrow = (RowExpr *) transformExpr(pstate, rtree);",
          "content_same": false
        },
        {
          "line": 1838,
          "old_api": "errmsg",
          "new_api": "IsA",
          "old_text": "errmsg(\"unequal number of entries in row expression\")",
          "new_text": "IsA(lrow, RowExpr)",
          "old_line_content": "\t\t\t\t errmsg(\"unequal number of entries in row expression\")));",
          "new_line_content": "\tAssert(IsA(lrow, RowExpr));",
          "content_same": false
        },
        {
          "line": 1845,
          "old_api": "llast",
          "new_api": "errcode",
          "old_text": "llast(opname)",
          "new_text": "errcode(ERRCODE_SYNTAX_ERROR)",
          "old_line_content": "\toprname = strVal(llast(opname));",
          "new_line_content": "\t\t\t\t(errcode(ERRCODE_SYNTAX_ERROR),",
          "content_same": false
        },
        {
          "line": 1853,
          "old_api": "strcmp",
          "new_api": "llast",
          "old_text": "strcmp(oprname, \"<>\")",
          "new_text": "llast(opname)",
          "old_line_content": "\telse if (strcmp(oprname, \"<>\") == 0)",
          "new_line_content": "\toprname = strVal(llast(opname));",
          "content_same": false
        },
        {
          "line": 1857,
          "old_api": "ereport",
          "new_api": "strcmp",
          "old_text": "ereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"operator %s is not supported for row expressions\",\n\t\t\t\t\t\toprname)))",
          "new_text": "strcmp(oprname, \"<=\")",
          "old_line_content": "\t\tereport(ERROR,",
          "new_line_content": "\t\t(strcmp(oprname, \"<=\") == 0) ||",
          "content_same": false
        },
        {
          "line": 1858,
          "old_api": "errcode",
          "new_api": "strcmp",
          "old_text": "errcode(ERRCODE_FEATURE_NOT_SUPPORTED)",
          "new_text": "strcmp(oprname, \">\")",
          "old_line_content": "\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),",
          "new_line_content": "\t\t(strcmp(oprname, \">\") == 0) ||",
          "content_same": false
        },
        {
          "line": 1859,
          "old_api": "errmsg",
          "new_api": "strcmp",
          "old_text": "errmsg(\"operator %s is not supported for row expressions\",\n\t\t\t\t\t\toprname)",
          "new_text": "strcmp(oprname, \">=\")",
          "old_line_content": "\t\t\t\t errmsg(\"operator %s is not supported for row expressions\",",
          "new_line_content": "\t\t(strcmp(oprname, \">=\") == 0))",
          "content_same": false
        },
        {
          "line": 1866,
          "old_api": "lfirst",
          "new_api": "errcode",
          "old_text": "lfirst(l)",
          "new_text": "errcode(ERRCODE_FEATURE_NOT_SUPPORTED)",
          "old_line_content": "\t\tNode\t   *larg = (Node *) lfirst(l);",
          "new_line_content": "\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),",
          "content_same": false
        },
        {
          "line": 1867,
          "old_api": "lfirst",
          "new_api": "errmsg",
          "old_text": "lfirst(r)",
          "new_text": "errmsg(\"operator %s is not supported for row expressions\",\n\t\t\t\t\t\toprname)",
          "old_line_content": "\t\tNode\t   *rarg = (Node *) lfirst(r);",
          "new_line_content": "\t\t\t\t errmsg(\"operator %s is not supported for row expressions\",",
          "content_same": false
        },
        {
          "line": 1875,
          "old_api": "makeBoolExpr",
          "new_api": "lfirst",
          "old_text": "makeBoolExpr(boolop,\n\t\t\t\t\t\t\t\t\t\t   list_make2(result, cmp))",
          "new_text": "lfirst(r)",
          "old_line_content": "\t\t\tresult = (Node *) makeBoolExpr(boolop,",
          "new_line_content": "\t\tNode\t   *rarg = (Node *) lfirst(r);",
          "content_same": false
        },
        {
          "line": 1883,
          "old_api": "makeBoolConst",
          "new_api": "makeBoolExpr",
          "old_text": "makeBoolConst(true, false)",
          "new_text": "makeBoolExpr(boolop,\n\t\t\t\t\t\t\t\t\t\t   list_make2(result, cmp))",
          "old_line_content": "\t\t\tresult = makeBoolConst(true, false);",
          "new_line_content": "\t\t\tresult = (Node *) makeBoolExpr(boolop,",
          "content_same": false
        },
        {
          "line": 1915,
          "old_api": "ereport",
          "new_api": "transformExpr",
          "old_text": "ereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_SYNTAX_ERROR),\n\t\t\t\t errmsg(\"unequal number of entries in row expression\")))",
          "new_text": "transformExpr(pstate, ltree)",
          "old_line_content": "\t\tereport(ERROR,",
          "new_line_content": "\tlrow = (RowExpr *) transformExpr(pstate, ltree);",
          "content_same": false
        },
        {
          "line": 1916,
          "old_api": "errcode",
          "new_api": "transformExpr",
          "old_text": "errcode(ERRCODE_SYNTAX_ERROR)",
          "new_text": "transformExpr(pstate, rtree)",
          "old_line_content": "\t\t\t\t(errcode(ERRCODE_SYNTAX_ERROR),",
          "new_line_content": "\trrow = (RowExpr *) transformExpr(pstate, rtree);",
          "content_same": false
        },
        {
          "line": 1917,
          "old_api": "errmsg",
          "new_api": "IsA",
          "old_text": "errmsg(\"unequal number of entries in row expression\")",
          "new_text": "IsA(lrow, RowExpr)",
          "old_line_content": "\t\t\t\t errmsg(\"unequal number of entries in row expression\")));",
          "new_line_content": "\tAssert(IsA(lrow, RowExpr));",
          "content_same": false
        },
        {
          "line": 1922,
          "old_api": "lfirst",
          "new_api": "list_length",
          "old_text": "lfirst(r)",
          "new_text": "list_length(rargs)",
          "old_line_content": "\t\tNode\t   *rarg = (Node *) lfirst(r);",
          "new_line_content": "\tif (list_length(largs) != list_length(rargs))",
          "content_same": false
        },
        {
          "line": 1925,
          "old_api": "make_distinct_op",
          "new_api": "errmsg",
          "old_text": "make_distinct_op(pstate, opname, larg, rarg)",
          "new_text": "errmsg(\"unequal number of entries in row expression\")",
          "old_line_content": "\t\tcmp = (Node *) make_distinct_op(pstate, opname, larg, rarg);",
          "new_line_content": "\t\t\t\t errmsg(\"unequal number of entries in row expression\")));",
          "content_same": false
        },
        {
          "line": 1929,
          "old_api": "makeBoolExpr",
          "new_api": "lfirst",
          "old_text": "makeBoolExpr(OR_EXPR,\n\t\t\t\t\t\t\t\t\t\t   list_make2(result, cmp))",
          "new_text": "lfirst(l)",
          "old_line_content": "\t\t\tresult = (Node *) makeBoolExpr(OR_EXPR,",
          "new_line_content": "\t\tNode\t   *larg = (Node *) lfirst(l);",
          "content_same": false
        },
        {
          "line": 1930,
          "old_api": "list_make2",
          "new_api": "lfirst",
          "old_text": "list_make2(result, cmp)",
          "new_text": "lfirst(r)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t   list_make2(result, cmp));",
          "new_line_content": "\t\tNode\t   *rarg = (Node *) lfirst(r);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1923,
          "old_api": null,
          "new_api": "ereport",
          "old_text": null,
          "new_text": "ereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_SYNTAX_ERROR),\n\t\t\t\t errmsg(\"unequal number of entries in row expression\")))",
          "old_line_content": "\t\tNode\t   *cmp;",
          "new_line_content": "\t\tereport(ERROR,",
          "content_same": false
        },
        {
          "line": 1924,
          "old_api": null,
          "new_api": "errcode",
          "old_text": null,
          "new_text": "errcode(ERRCODE_SYNTAX_ERROR)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t(errcode(ERRCODE_SYNTAX_ERROR),",
          "content_same": false
        },
        {
          "line": 1669,
          "old_api": null,
          "new_api": "linitial",
          "old_text": null,
          "new_text": "linitial(cexpr->args)",
          "old_line_content": "\t\t\t\t{",
          "new_line_content": "\t\t\t\ttypmod = exprTypmod((Node *) linitial(cexpr->args));",
          "content_same": false
        },
        {
          "line": 1800,
          "old_api": null,
          "new_api": "typenameTypeId",
          "old_text": null,
          "new_text": "typenameTypeId(typename)",
          "old_line_content": "\t\t\t\t\t\t\t\t COERCE_EXPLICIT_CAST);",
          "new_line_content": "\ttargetType = typenameTypeId(typename);",
          "content_same": false
        },
        {
          "line": 1676,
          "old_api": null,
          "new_api": "exprType",
          "old_text": null,
          "new_text": "exprType(e)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tif (exprType(e) != coalescetype)",
          "content_same": false
        },
        {
          "line": 1933,
          "old_api": null,
          "new_api": "make_distinct_op",
          "old_text": null,
          "new_text": "make_distinct_op(pstate, opname, larg, rarg)",
          "old_line_content": "\tif (result == NULL)",
          "new_line_content": "\t\tcmp = (Node *) make_distinct_op(pstate, opname, larg, rarg);",
          "content_same": false
        },
        {
          "line": 1678,
          "old_api": null,
          "new_api": "exprTypmod",
          "old_text": null,
          "new_text": "exprTypmod(e)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\t\tif (exprTypmod(e) != typmod)",
          "content_same": false
        },
        {
          "line": 1937,
          "old_api": null,
          "new_api": "makeBoolExpr",
          "old_text": null,
          "new_text": "makeBoolExpr(OR_EXPR,\n\t\t\t\t\t\t\t\t\t\t   list_make2(result, cmp))",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tresult = (Node *) makeBoolExpr(OR_EXPR,",
          "content_same": false
        },
        {
          "line": 1810,
          "old_api": null,
          "new_api": "ereport",
          "old_text": null,
          "new_text": "ereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_CANNOT_COERCE),\n\t\t\t\t errmsg(\"cannot cast type %s to %s\",\n\t\t\t\t\t\tformat_type_be(inputType),\n\t\t\t\t\t\tformat_type_be(targetType))))",
          "old_line_content": "",
          "new_line_content": "\t\tereport(ERROR,",
          "content_same": false
        },
        {
          "line": 1811,
          "old_api": null,
          "new_api": "errcode",
          "old_text": null,
          "new_text": "errcode(ERRCODE_CANNOT_COERCE)",
          "old_line_content": "/*",
          "new_line_content": "\t\t\t\t(errcode(ERRCODE_CANNOT_COERCE),",
          "content_same": false
        },
        {
          "line": 1812,
          "old_api": null,
          "new_api": "errmsg",
          "old_text": null,
          "new_text": "errmsg(\"cannot cast type %s to %s\",\n\t\t\t\t\t\tformat_type_be(inputType),\n\t\t\t\t\t\tformat_type_be(targetType))",
          "old_line_content": " * Transform a \"row op row\" construct",
          "new_line_content": "\t\t\t\t errmsg(\"cannot cast type %s to %s\",",
          "content_same": false
        },
        {
          "line": 1813,
          "old_api": null,
          "new_api": "format_type_be",
          "old_text": null,
          "new_text": "format_type_be(inputType)",
          "old_line_content": " */",
          "new_line_content": "\t\t\t\t\t\tformat_type_be(inputType),",
          "content_same": false
        },
        {
          "line": 1814,
          "old_api": null,
          "new_api": "format_type_be",
          "old_text": null,
          "new_text": "format_type_be(targetType)",
          "old_line_content": "static Node *",
          "new_line_content": "\t\t\t\t\t\tformat_type_be(targetType))));",
          "content_same": false
        },
        {
          "line": 1938,
          "old_api": null,
          "new_api": "list_make2",
          "old_text": null,
          "new_text": "list_make2(result, cmp)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t   list_make2(result, cmp));",
          "content_same": false
        },
        {
          "line": 1944,
          "old_api": null,
          "new_api": "makeBoolConst",
          "old_text": null,
          "new_text": "makeBoolConst(false, false)",
          "old_line_content": " */",
          "new_line_content": "\t\tresult = makeBoolConst(false, false);",
          "content_same": false
        },
        {
          "line": 1695,
          "old_api": null,
          "new_api": "linitial",
          "old_text": null,
          "new_text": "linitial(mexpr->args)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tif (exprType((Node *) linitial(mexpr->args)) != minmaxtype)",
          "content_same": false
        },
        {
          "line": 1697,
          "old_api": null,
          "new_api": "linitial",
          "old_text": null,
          "new_text": "linitial(mexpr->args)",
          "old_line_content": "\t\t\t\t\t\treturn -1;",
          "new_line_content": "\t\t\t\ttypmod = exprTypmod((Node *) linitial(mexpr->args));",
          "content_same": false
        },
        {
          "line": 1700,
          "old_api": null,
          "new_api": "list_head",
          "old_text": null,
          "new_text": "list_head(mexpr->args)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\tfor_each_cell(arg, lnext(list_head(mexpr->args)))",
          "content_same": false
        },
        {
          "line": 1702,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(arg)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\t\tNode\t   *e = (Node *) lfirst(arg);",
          "content_same": false
        },
        {
          "line": 1958,
          "old_api": null,
          "new_api": "make_op",
          "old_text": null,
          "new_text": "make_op(pstate, opname, ltree, rtree)",
          "old_line_content": "\t */",
          "new_line_content": "\tresult = make_op(pstate, opname, ltree, rtree);",
          "content_same": false
        },
        {
          "line": 1704,
          "old_api": null,
          "new_api": "exprType",
          "old_text": null,
          "new_text": "exprType(e)",
          "old_line_content": "\t\tcase T_NullIfExpr:",
          "new_line_content": "\t\t\t\t\tif (exprType(e) != minmaxtype)",
          "content_same": false
        },
        {
          "line": 1960,
          "old_api": null,
          "new_api": "ereport",
          "old_text": null,
          "new_text": "ereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_DATATYPE_MISMATCH),\n\t\t   errmsg(\"IS DISTINCT FROM requires = operator to yield boolean\")))",
          "old_line_content": "",
          "new_line_content": "\t\tereport(ERROR,",
          "content_same": false
        },
        {
          "line": 1706,
          "old_api": null,
          "new_api": "exprTypmod",
          "old_text": null,
          "new_text": "exprTypmod(e)",
          "old_line_content": "\t\t\t\tNullIfExpr *nexpr = (NullIfExpr *) expr;",
          "new_line_content": "\t\t\t\t\tif (exprTypmod(e) != typmod)",
          "content_same": false
        },
        {
          "line": 1961,
          "old_api": null,
          "new_api": "errcode",
          "old_text": null,
          "new_text": "errcode(ERRCODE_DATATYPE_MISMATCH)",
          "old_line_content": "\treturn result;",
          "new_line_content": "\t\t\t\t(errcode(ERRCODE_DATATYPE_MISMATCH),",
          "content_same": false
        },
        {
          "line": 1962,
          "old_api": null,
          "new_api": "errmsg",
          "old_text": null,
          "new_text": "errmsg(\"IS DISTINCT FROM requires = operator to yield boolean\")",
          "old_line_content": "}",
          "new_line_content": "\t\t   errmsg(\"IS DISTINCT FROM requires = operator to yield boolean\")));",
          "content_same": false
        },
        {
          "line": 1839,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(rrow, RowExpr)",
          "old_line_content": "",
          "new_line_content": "\tAssert(IsA(rrow, RowExpr));",
          "content_same": false
        },
        {
          "line": 1967,
          "old_api": null,
          "new_api": "NodeSetTag",
          "old_text": null,
          "new_text": "NodeSetTag(result, T_DistinctExpr)",
          "old_line_content": "",
          "new_line_content": "\tNodeSetTag(result, T_DistinctExpr);",
          "content_same": false
        },
        {
          "line": 1843,
          "old_api": null,
          "new_api": "list_length",
          "old_text": null,
          "new_text": "list_length(rargs)",
          "old_line_content": "\t * correctly.  For the moment, though, keep on doing this ...",
          "new_line_content": "\tif (list_length(largs) != list_length(rargs))",
          "content_same": false
        },
        {
          "line": 1716,
          "old_api": null,
          "new_api": "linitial",
          "old_text": null,
          "new_text": "linitial(nexpr->args)",
          "old_line_content": "\t\t\treturn ((SetToDefault *) expr)->typeMod;",
          "new_line_content": "\t\t\t\treturn exprTypmod((Node *) linitial(nexpr->args));",
          "content_same": false
        },
        {
          "line": 1844,
          "old_api": null,
          "new_api": "ereport",
          "old_text": null,
          "new_text": "ereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_SYNTAX_ERROR),\n\t\t\t\t errmsg(\"unequal number of entries in row expression\")))",
          "old_line_content": "\t */",
          "new_line_content": "\t\tereport(ERROR,",
          "content_same": false
        },
        {
          "line": 1846,
          "old_api": null,
          "new_api": "errmsg",
          "old_text": null,
          "new_text": "errmsg(\"unequal number of entries in row expression\")",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t errmsg(\"unequal number of entries in row expression\")));",
          "content_same": false
        },
        {
          "line": 1855,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(oprname, \"=\")",
          "old_line_content": "\telse",
          "new_line_content": "\tif ((strcmp(oprname, \"=\") == 0) ||",
          "content_same": false
        },
        {
          "line": 1856,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(oprname, \"<\")",
          "old_line_content": "\t{",
          "new_line_content": "\t\t(strcmp(oprname, \"<\") == 0) ||",
          "content_same": false
        },
        {
          "line": 1861,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(oprname, \"<>\")",
          "old_line_content": "\t\tboolop = 0;\t\t\t\t/* keep compiler quiet */",
          "new_line_content": "\telse if (strcmp(oprname, \"<>\") == 0)",
          "content_same": false
        },
        {
          "line": 1865,
          "old_api": null,
          "new_api": "ereport",
          "old_text": null,
          "new_text": "ereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_FEATURE_NOT_SUPPORTED),\n\t\t\t\t errmsg(\"operator %s is not supported for row expressions\",\n\t\t\t\t\t\toprname)))",
          "old_line_content": "\t{",
          "new_line_content": "\t\tereport(ERROR,",
          "content_same": false
        },
        {
          "line": 1874,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(l)",
          "old_line_content": "\t\telse",
          "new_line_content": "\t\tNode\t   *larg = (Node *) lfirst(l);",
          "content_same": false
        },
        {
          "line": 1878,
          "old_api": null,
          "new_api": "make_op",
          "old_text": null,
          "new_text": "make_op(pstate, opname, larg, rarg)",
          "old_line_content": "",
          "new_line_content": "\t\tcmp = (Node *) make_op(pstate, opname, larg, rarg);",
          "content_same": false
        },
        {
          "line": 1879,
          "old_api": null,
          "new_api": "coerce_to_boolean",
          "old_text": null,
          "new_text": "coerce_to_boolean(pstate, cmp, \"row comparison\")",
          "old_line_content": "\tif (result == NULL)",
          "new_line_content": "\t\tcmp = coerce_to_boolean(pstate, cmp, \"row comparison\");",
          "content_same": false
        },
        {
          "line": 1753,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(expr, FuncExpr)",
          "old_line_content": "\t\tfunc->funcformat != COERCE_IMPLICIT_CAST)",
          "new_line_content": "\tif (expr == NULL || !IsA(expr, FuncExpr))",
          "content_same": false
        },
        {
          "line": 1884,
          "old_api": null,
          "new_api": "list_make2",
          "old_text": null,
          "new_text": "list_make2(result, cmp)",
          "old_line_content": "\t\telse",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t   list_make2(result, cmp));",
          "content_same": false
        },
        {
          "line": 1891,
          "old_api": null,
          "new_api": "makeBoolConst",
          "old_text": null,
          "new_text": "makeBoolConst(true, false)",
          "old_line_content": "/*",
          "new_line_content": "\t\t\tresult = makeBoolConst(true, false);",
          "content_same": false
        },
        {
          "line": 1893,
          "old_api": null,
          "new_api": "makeBoolConst",
          "old_text": null,
          "new_text": "makeBoolConst(false, false)",
          "old_line_content": " */",
          "new_line_content": "\t\t\tresult = makeBoolConst(false, false);",
          "content_same": false
        },
        {
          "line": 1769,
          "old_api": null,
          "new_api": "list_length",
          "old_text": null,
          "new_text": "list_length(func->args)",
          "old_line_content": "\t\treturn false;",
          "new_line_content": "\tnargs = list_length(func->args);",
          "content_same": false
        },
        {
          "line": 1773,
          "old_api": null,
          "new_api": "lsecond",
          "old_text": null,
          "new_text": "lsecond(func->args)",
          "old_line_content": "\t */",
          "new_line_content": "\tsecond_arg = (Const *) lsecond(func->args);",
          "content_same": false
        },
        {
          "line": 1774,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(second_arg, Const)",
          "old_line_content": "\tif (coercedTypmod != NULL)",
          "new_line_content": "\tif (!IsA(second_arg, Const) ||",
          "content_same": false
        },
        {
          "line": 1783,
          "old_api": null,
          "new_api": "DatumGetInt32",
          "old_text": null,
          "new_text": "DatumGetInt32(second_arg->constvalue)",
          "old_line_content": " * The given expr has already been transformed, but we need to lookup",
          "new_line_content": "\t\t*coercedTypmod = DatumGetInt32(second_arg->constvalue);",
          "content_same": false
        },
        {
          "line": 1918,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(rrow, RowExpr)",
          "old_line_content": "",
          "new_line_content": "\tAssert(IsA(rrow, RowExpr));",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1792,
          "old_api": "typenameTypeId",
          "new_api": null,
          "old_text": "typenameTypeId(typename)",
          "new_text": null,
          "old_line_content": "\ttargetType = typenameTypeId(typename);",
          "new_line_content": " * the type name and then apply any necessary coercion function(s).",
          "content_same": false
        },
        {
          "line": 1921,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(l)",
          "new_text": null,
          "old_line_content": "\t\tNode\t   *larg = (Node *) lfirst(l);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1668,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(arg, cexpr->args)",
          "new_text": null,
          "old_line_content": "\t\t\t\tforeach(arg, cexpr->args)",
          "new_line_content": "\t\t\t\t\treturn -1;",
          "content_same": false
        },
        {
          "line": 1670,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(arg)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tNode\t   *e = (Node *) lfirst(arg);",
          "new_line_content": "\t\t\t\tif (typmod < 0)",
          "content_same": false
        },
        {
          "line": 1802,
          "old_api": "ereport",
          "new_api": null,
          "old_text": "ereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_CANNOT_COERCE),\n\t\t\t\t errmsg(\"cannot cast type %s to %s\",\n\t\t\t\t\t\tformat_type_be(inputType),\n\t\t\t\t\t\tformat_type_be(targetType))))",
          "new_text": null,
          "old_line_content": "\t\tereport(ERROR,",
          "new_line_content": "\tif (inputType == InvalidOid)",
          "content_same": false
        },
        {
          "line": 1803,
          "old_api": "errcode",
          "new_api": null,
          "old_text": "errcode(ERRCODE_CANNOT_COERCE)",
          "new_text": null,
          "old_line_content": "\t\t\t\t(errcode(ERRCODE_CANNOT_COERCE),",
          "new_line_content": "\t\treturn expr;\t\t\t/* do nothing if NULL input */",
          "content_same": false
        },
        {
          "line": 1804,
          "old_api": "errmsg",
          "new_api": null,
          "old_text": "errmsg(\"cannot cast type %s to %s\",\n\t\t\t\t\t\tformat_type_be(inputType),\n\t\t\t\t\t\tformat_type_be(targetType))",
          "new_text": null,
          "old_line_content": "\t\t\t\t errmsg(\"cannot cast type %s to %s\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1806,
          "old_api": "format_type_be",
          "new_api": null,
          "old_text": "format_type_be(targetType)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tformat_type_be(targetType))));",
          "new_line_content": "\t\t\t\t\t\t\t\t targetType, typename->typmod,",
          "content_same": false
        },
        {
          "line": 1936,
          "old_api": "makeBoolConst",
          "new_api": null,
          "old_text": "makeBoolConst(false, false)",
          "new_text": null,
          "old_line_content": "\t\tresult = makeBoolConst(false, false);",
          "new_line_content": "\t\telse",
          "content_same": false
        },
        {
          "line": 1691,
          "old_api": "linitial",
          "new_api": null,
          "old_text": "linitial(mexpr->args)",
          "new_text": null,
          "old_line_content": "\t\t\t\ttypmod = exprTypmod((Node *) linitial(mexpr->args));",
          "new_line_content": "\t\t\t\tOid\t\t\tminmaxtype = mexpr->minmaxtype;",
          "content_same": false
        },
        {
          "line": 1692,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(arg, mexpr->args)",
          "new_text": null,
          "old_line_content": "\t\t\t\tforeach(arg, mexpr->args)",
          "new_line_content": "\t\t\t\tint32\t\ttypmod;",
          "content_same": false
        },
        {
          "line": 1694,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(arg)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tNode\t   *e = (Node *) lfirst(arg);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1950,
          "old_api": "make_op",
          "new_api": null,
          "old_text": "make_op(pstate, opname, ltree, rtree)",
          "new_text": null,
          "old_line_content": "\tresult = make_op(pstate, opname, ltree, rtree);",
          "new_line_content": "/*",
          "content_same": false
        },
        {
          "line": 1696,
          "old_api": "exprType",
          "new_api": null,
          "old_text": "exprType(e)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tif (exprType(e) != minmaxtype)",
          "new_line_content": "\t\t\t\t\treturn -1;",
          "content_same": false
        },
        {
          "line": 1952,
          "old_api": "ereport",
          "new_api": null,
          "old_text": "ereport(ERROR,\n\t\t\t\t(errcode(ERRCODE_DATATYPE_MISMATCH),\n\t\t   errmsg(\"IS DISTINCT FROM requires = operator to yield boolean\")))",
          "new_text": null,
          "old_line_content": "\t\tereport(ERROR,",
          "new_line_content": " */",
          "content_same": false
        },
        {
          "line": 1698,
          "old_api": "exprTypmod",
          "new_api": null,
          "old_text": "exprTypmod(e)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tif (exprTypmod(e) != typmod)",
          "new_line_content": "\t\t\t\tif (typmod < 0)",
          "content_same": false
        },
        {
          "line": 1953,
          "old_api": "errcode",
          "new_api": null,
          "old_text": "errcode(ERRCODE_DATATYPE_MISMATCH)",
          "new_text": null,
          "old_line_content": "\t\t\t\t(errcode(ERRCODE_DATATYPE_MISMATCH),",
          "new_line_content": "static Expr *",
          "content_same": false
        },
        {
          "line": 1828,
          "old_api": "transformExpr",
          "new_api": null,
          "old_text": "transformExpr(pstate, ltree)",
          "new_text": null,
          "old_line_content": "\tlrow = (RowExpr *) transformExpr(pstate, ltree);",
          "new_line_content": "\tList\t   *largs,",
          "content_same": false
        },
        {
          "line": 1829,
          "old_api": "transformExpr",
          "new_api": null,
          "old_text": "transformExpr(pstate, rtree)",
          "new_text": null,
          "old_line_content": "\trrow = (RowExpr *) transformExpr(pstate, rtree);",
          "new_line_content": "\t\t\t   *rargs;",
          "content_same": false
        },
        {
          "line": 1830,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(lrow, RowExpr)",
          "new_text": null,
          "old_line_content": "\tAssert(IsA(lrow, RowExpr));",
          "new_line_content": "\tListCell   *l,",
          "content_same": false
        },
        {
          "line": 1831,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(rrow, RowExpr)",
          "new_text": null,
          "old_line_content": "\tAssert(IsA(rrow, RowExpr));",
          "new_line_content": "\t\t\t   *r;",
          "content_same": false
        },
        {
          "line": 1954,
          "old_api": "errmsg",
          "new_api": null,
          "old_text": "errmsg(\"IS DISTINCT FROM requires = operator to yield boolean\")",
          "new_text": null,
          "old_line_content": "\t\t   errmsg(\"IS DISTINCT FROM requires = operator to yield boolean\")));",
          "new_line_content": "make_distinct_op(ParseState *pstate, List *opname, Node *ltree, Node *rtree)",
          "content_same": false
        },
        {
          "line": 1959,
          "old_api": "NodeSetTag",
          "new_api": null,
          "old_text": "NodeSetTag(result, T_DistinctExpr)",
          "new_text": null,
          "old_line_content": "\tNodeSetTag(result, T_DistinctExpr);",
          "new_line_content": "\tif (((OpExpr *) result)->opresulttype != BOOLOID)",
          "content_same": false
        },
        {
          "line": 1835,
          "old_api": "list_length",
          "new_api": null,
          "old_text": "list_length(rargs)",
          "new_text": null,
          "old_line_content": "\tif (list_length(largs) != list_length(rargs))",
          "new_line_content": "\t/* Inputs are untransformed RowExprs */",
          "content_same": false
        },
        {
          "line": 1708,
          "old_api": "linitial",
          "new_api": null,
          "old_text": "linitial(nexpr->args)",
          "new_text": null,
          "old_line_content": "\t\t\t\treturn exprTypmod((Node *) linitial(nexpr->args));",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 1847,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(oprname, \"=\")",
          "new_text": null,
          "old_line_content": "\tif ((strcmp(oprname, \"=\") == 0) ||",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1848,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(oprname, \"<\")",
          "new_text": null,
          "old_line_content": "\t\t(strcmp(oprname, \"<\") == 0) ||",
          "new_line_content": "\t/*",
          "content_same": false
        },
        {
          "line": 1849,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(oprname, \"<=\")",
          "new_text": null,
          "old_line_content": "\t\t(strcmp(oprname, \"<=\") == 0) ||",
          "new_line_content": "\t * XXX it's really wrong to generate a simple AND combination for < <= >",
          "content_same": false
        },
        {
          "line": 1850,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(oprname, \">\")",
          "new_text": null,
          "old_line_content": "\t\t(strcmp(oprname, \">\") == 0) ||",
          "new_line_content": "\t * >=.\tWe probably need to invent a new runtime node type to handle those",
          "content_same": false
        },
        {
          "line": 1851,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(oprname, \">=\")",
          "new_text": null,
          "old_line_content": "\t\t(strcmp(oprname, \">=\") == 0))",
          "new_line_content": "\t * correctly.  For the moment, though, keep on doing this ...",
          "content_same": false
        },
        {
          "line": 1870,
          "old_api": "make_op",
          "new_api": null,
          "old_text": "make_op(pstate, opname, larg, rarg)",
          "new_text": null,
          "old_line_content": "\t\tcmp = (Node *) make_op(pstate, opname, larg, rarg);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1871,
          "old_api": "coerce_to_boolean",
          "new_api": null,
          "old_text": "coerce_to_boolean(pstate, cmp, \"row comparison\")",
          "new_text": null,
          "old_line_content": "\t\tcmp = coerce_to_boolean(pstate, cmp, \"row comparison\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1745,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(expr, FuncExpr)",
          "new_text": null,
          "old_line_content": "\tif (expr == NULL || !IsA(expr, FuncExpr))",
          "new_line_content": "\tFuncExpr   *func;",
          "content_same": false
        },
        {
          "line": 1876,
          "old_api": "list_make2",
          "new_api": null,
          "old_text": "list_make2(result, cmp)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t   list_make2(result, cmp));",
          "new_line_content": "\t\tNode\t   *cmp;",
          "content_same": false
        },
        {
          "line": 1885,
          "old_api": "makeBoolConst",
          "new_api": null,
          "old_text": "makeBoolConst(false, false)",
          "new_text": null,
          "old_line_content": "\t\t\tresult = makeBoolConst(false, false);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1761,
          "old_api": "list_length",
          "new_api": null,
          "old_text": "list_length(func->args)",
          "new_text": null,
          "old_line_content": "\tnargs = list_length(func->args);",
          "new_line_content": "\t\tfunc->funcformat != COERCE_IMPLICIT_CAST)",
          "content_same": false
        },
        {
          "line": 1765,
          "old_api": "lsecond",
          "new_api": null,
          "old_text": "lsecond(func->args)",
          "new_text": null,
          "old_line_content": "\tsecond_arg = (Const *) lsecond(func->args);",
          "new_line_content": "\t * If it's not a two-argument or three-argument function with the second",
          "content_same": false
        },
        {
          "line": 1766,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(second_arg, Const)",
          "new_text": null,
          "old_line_content": "\tif (!IsA(second_arg, Const) ||",
          "new_line_content": "\t * argument being an int4 constant, it can't have been created from a",
          "content_same": false
        },
        {
          "line": 1775,
          "old_api": "DatumGetInt32",
          "new_api": null,
          "old_text": "DatumGetInt32(second_arg->constvalue)",
          "new_text": null,
          "old_line_content": "\t\t*coercedTypmod = DatumGetInt32(second_arg->constvalue);",
          "new_line_content": "\t\tsecond_arg->consttype != INT4OID ||",
          "content_same": false
        },
        {
          "line": 1907,
          "old_api": "transformExpr",
          "new_api": null,
          "old_text": "transformExpr(pstate, ltree)",
          "new_text": null,
          "old_line_content": "\tlrow = (RowExpr *) transformExpr(pstate, ltree);",
          "new_line_content": "\tRowExpr    *lrow,",
          "content_same": false
        },
        {
          "line": 1908,
          "old_api": "transformExpr",
          "new_api": null,
          "old_text": "transformExpr(pstate, rtree)",
          "new_text": null,
          "old_line_content": "\trrow = (RowExpr *) transformExpr(pstate, rtree);",
          "new_line_content": "\t\t\t   *rrow;",
          "content_same": false
        },
        {
          "line": 1909,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(lrow, RowExpr)",
          "new_text": null,
          "old_line_content": "\tAssert(IsA(lrow, RowExpr));",
          "new_line_content": "\tList\t   *largs,",
          "content_same": false
        },
        {
          "line": 1910,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(rrow, RowExpr)",
          "new_text": null,
          "old_line_content": "\tAssert(IsA(rrow, RowExpr));",
          "new_line_content": "\t\t\t   *rargs;",
          "content_same": false
        },
        {
          "line": 1914,
          "old_api": "list_length",
          "new_api": null,
          "old_text": "list_length(rargs)",
          "new_text": null,
          "old_line_content": "\tif (list_length(largs) != list_length(rargs))",
          "new_line_content": "\t/* Inputs are untransformed RowExprs */",
          "content_same": false
        },
        {
          "line": 1789,
          "old_api": "exprType",
          "new_api": null,
          "old_text": "exprType(expr)",
          "new_text": null,
          "old_line_content": "\tOid\t\t\tinputType = exprType(expr);",
          "new_line_content": " * Handle an explicit CAST construct.",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 23,
      "total_additions": 47,
      "total_deletions": 45,
      "total_api_changes": 115
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 12,
        "api_related_lines": 115,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          11,
          1667,
          1699,
          1671
        ]
      }
    },
    "api_calls_before": 468,
    "api_calls_after": 476,
    "diff_info": {
      "added_lines": 11,
      "removed_lines": 3,
      "total_diff_lines": 42
    }
  }
}