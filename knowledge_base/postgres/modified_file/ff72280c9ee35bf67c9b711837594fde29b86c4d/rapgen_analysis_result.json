{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/ff72280c9ee35bf67c9b711837594fde29b86c4d",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/ff72280c9ee35bf67c9b711837594fde29b86c4d/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/ff72280c9ee35bf67c9b711837594fde29b86c4d/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/ff72280c9ee35bf67c9b711837594fde29b86c4d/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1208,
          "old_api": "list_make1_int",
          "new_api": "set_returning_clause_references",
          "old_text": "list_make1_int(parse->resultRelation)",
          "new_text": "set_returning_clause_references(root->glob,\n\t\t\t\t\t\t\t\t\t\t\t\tparse->returningList,\n\t\t\t\t\t\t\t\t\t\t\t\tresult_plan,\n\t\t\t\t\t\t\t\t\t\t\t\tparse->resultRelation)",
          "old_line_content": "\t\troot->resultRelations = list_make1_int(parse->resultRelation);",
          "new_line_content": "\t\trlist = set_returning_clause_references(root->glob,",
          "content_same": false
        },
        {
          "line": 1242,
          "old_api": "DatumGetBool",
          "new_api": "IsA",
          "old_text": "DatumGetBool(constqual->constvalue)",
          "new_text": "IsA(plan, Result)",
          "old_line_content": "\t\t\t\t\t!DatumGetBool(constqual->constvalue))",
          "new_line_content": "\tif (IsA(plan, Result))",
          "content_same": false
        },
        {
          "line": 1456,
          "old_api": "get_equality_op_for_ordering_op",
          "new_api": "list_length",
          "old_text": "get_equality_op_for_ordering_op(groupcl->sortop)",
          "new_text": "list_length(groupClause)",
          "old_line_content": "\t\tgroupOperators[colno] = get_equality_op_for_ordering_op(groupcl->sortop);",
          "new_line_content": "\tint\t\t\tnumCols = list_length(groupClause);",
          "content_same": false
        },
        {
          "line": 1583,
          "old_api": "cost_group",
          "new_api": "cost_sort",
          "old_text": "cost_group(&sorted_p, root, numGroupCols, dNumGroups,\n\t\t\t\t   sorted_p.startup_cost, sorted_p.total_cost,\n\t\t\t\t   cheapest_path_rows)",
          "new_text": "cost_sort(&sorted_p, root, root->group_pathkeys, sorted_p.total_cost,\n\t\t\t\t  cheapest_path_rows, cheapest_path_width, -1.0)",
          "old_line_content": "\t\tcost_group(&sorted_p, root, numGroupCols, dNumGroups,",
          "new_line_content": "\t\tcost_sort(&sorted_p, root, root->group_pathkeys, sorted_p.total_cost,",
          "content_same": false
        },
        {
          "line": 1589,
          "old_api": "cost_sort",
          "new_api": "cost_agg",
          "old_text": "cost_sort(&sorted_p, root, root->sort_pathkeys, sorted_p.total_cost,\n\t\t\t\t  dNumGroups, cheapest_path_width, limit_tuples)",
          "new_text": "cost_agg(&sorted_p, root, AGG_SORTED, agg_counts->numAggs,\n\t\t\t\t numGroupCols, dNumGroups,\n\t\t\t\t sorted_p.startup_cost, sorted_p.total_cost,\n\t\t\t\t cheapest_path_rows)",
          "old_line_content": "\t\tcost_sort(&sorted_p, root, root->sort_pathkeys, sorted_p.total_cost,",
          "new_line_content": "\t\tcost_agg(&sorted_p, root, AGG_SORTED, agg_counts->numAggs,",
          "content_same": false
        },
        {
          "line": 1599,
          "old_api": "compare_fractional_path_costs",
          "new_api": "pathkeys_contained_in",
          "old_text": "compare_fractional_path_costs(&hashed_p, &sorted_p,\n\t\t\t\t\t\t\t\t\t  tuple_fraction)",
          "new_text": "pathkeys_contained_in(root->sort_pathkeys, current_pathkeys)",
          "old_line_content": "\tif (compare_fractional_path_costs(&hashed_p, &sorted_p,",
          "new_line_content": "\t\t!pathkeys_contained_in(root->sort_pathkeys, current_pathkeys))",
          "content_same": false
        },
        {
          "line": 1688,
          "old_api": "list_length",
          "new_api": "flatten_tlist",
          "old_text": "list_length(parse->groupClause)",
          "new_text": "flatten_tlist(tlist)",
          "old_line_content": "\tnumCols = list_length(parse->groupClause);",
          "new_line_content": "\tsub_tlist = flatten_tlist(tlist);",
          "content_same": false
        },
        {
          "line": 1709,
          "old_api": "equal",
          "new_api": "foreach",
          "old_text": "equal(groupexpr, te->expr)",
          "new_text": "foreach(gl, parse->groupClause)",
          "old_line_content": "\t\t\t\tif (equal(groupexpr, te->expr))",
          "new_line_content": "\t\tforeach(gl, parse->groupClause)",
          "content_same": false
        },
        {
          "line": 1766,
          "old_api": "lfirst",
          "new_api": "Assert",
          "old_text": "lfirst(sl)",
          "new_text": "Assert(groupColIdx != NULL)",
          "old_line_content": "\t\t\tte = (TargetEntry *) lfirst(sl);",
          "new_line_content": "\tAssert(groupColIdx != NULL);",
          "content_same": false
        },
        {
          "line": 1771,
          "old_api": "elog",
          "new_api": "get_sortgroupclause_expr",
          "old_text": "elog(ERROR, \"failed to locate grouping columns\")",
          "new_text": "get_sortgroupclause_expr(grpcl, tlist)",
          "old_line_content": "\t\t\telog(ERROR, \"failed to locate grouping columns\");",
          "new_line_content": "\t\tNode\t   *groupexpr = get_sortgroupclause_expr(grpcl, tlist);",
          "content_same": false
        },
        {
          "line": 1802,
          "old_api": "Assert",
          "new_api": "list_head",
          "old_text": "Assert(orig_tlist_item != NULL)",
          "new_text": "list_head(orig_tlist)",
          "old_line_content": "\t\tAssert(orig_tlist_item != NULL);",
          "new_line_content": "\tListCell   *orig_tlist_item = list_head(orig_tlist);",
          "content_same": false
        },
        {
          "line": 1806,
          "old_api": "elog",
          "new_api": "lfirst",
          "old_text": "elog(ERROR, \"resjunk output columns are not implemented\")",
          "new_text": "lfirst(l)",
          "old_line_content": "\t\t\telog(ERROR, \"resjunk output columns are not implemented\");",
          "new_line_content": "\t\tTargetEntry *new_tle = (TargetEntry *) lfirst(l);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1539,
          "old_api": null,
          "new_api": "hash_agg_entry_size",
          "old_text": null,
          "new_text": "hash_agg_entry_size(agg_counts->numAggs)",
          "old_line_content": "\t * We need to consider cheapest_path + hashagg [+ final sort] versus",
          "new_line_content": "\thashentrysize += hash_agg_entry_size(agg_counts->numAggs);",
          "content_same": false
        },
        {
          "line": 1287,
          "old_api": null,
          "new_api": "Assert",
          "old_text": null,
          "new_text": "Assert(parse->limitCount || parse->limitOffset)",
          "old_line_content": "\t\t\tif (((Const *) est)->constisnull)",
          "new_line_content": "\tAssert(parse->limitCount || parse->limitOffset);",
          "content_same": false
        },
        {
          "line": 1160,
          "old_api": null,
          "new_api": "pathkeys_contained_in",
          "old_text": null,
          "new_text": "pathkeys_contained_in(sort_pathkeys, current_pathkeys)",
          "old_line_content": "\t * If there is a DISTINCT clause, add the UNIQUE node.",
          "new_line_content": "\t\tif (!pathkeys_contained_in(sort_pathkeys, current_pathkeys))",
          "content_same": false
        },
        {
          "line": 1162,
          "old_api": null,
          "new_api": "make_sort_from_pathkeys",
          "old_text": null,
          "new_text": "make_sort_from_pathkeys(root,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   result_plan,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   sort_pathkeys,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   limit_tuples)",
          "old_line_content": "\tif (parse->distinctClause)",
          "new_line_content": "\t\t\tresult_plan = (Plan *) make_sort_from_pathkeys(root,",
          "content_same": false
        },
        {
          "line": 1035,
          "old_api": null,
          "new_api": "locate_grouping_columns",
          "old_text": null,
          "new_text": "locate_grouping_columns(root, tlist, result_plan->targetlist,\n\t\t\t\t\t\t\t\t\t\tgroupColIdx)",
          "old_line_content": "\t\t\t{",
          "new_line_content": "\t\t\t\tlocate_grouping_columns(root, tlist, result_plan->targetlist,",
          "content_same": false
        },
        {
          "line": 1295,
          "old_api": null,
          "new_api": "estimate_expression_value",
          "old_text": null,
          "new_text": "estimate_expression_value(root, parse->limitCount)",
          "old_line_content": "\t\t\t\tif (*count_est <= 0)",
          "new_line_content": "\t\test = estimate_expression_value(root, parse->limitCount);",
          "content_same": false
        },
        {
          "line": 1296,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(est, Const)",
          "old_line_content": "\t\t\t\t\t*count_est = 1;\t\t/* force to at least 1 */",
          "new_line_content": "\t\tif (est && IsA(est, Const))",
          "content_same": false
        },
        {
          "line": 1813,
          "old_api": null,
          "new_api": "Assert",
          "old_text": null,
          "new_text": "Assert(orig_tlist_item != NULL)",
          "old_line_content": "}",
          "new_line_content": "\t\tAssert(orig_tlist_item != NULL);",
          "content_same": false
        },
        {
          "line": 1814,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(orig_tlist_item)",
          "old_line_content": "",
          "new_line_content": "\t\torig_tle = (TargetEntry *) lfirst(orig_tlist_item);",
          "content_same": false
        },
        {
          "line": 1175,
          "old_api": null,
          "new_api": "make_unique",
          "old_text": null,
          "new_text": "make_unique(result_plan, parse->distinctClause)",
          "old_line_content": "\t/*",
          "new_line_content": "\t\tresult_plan = (Plan *) make_unique(result_plan, parse->distinctClause);",
          "content_same": false
        },
        {
          "line": 1560,
          "old_api": null,
          "new_api": "cost_agg",
          "old_text": null,
          "new_text": "cost_agg(&hashed_p, root, AGG_HASHED, agg_counts->numAggs,\n\t\t\t numGroupCols, dNumGroups,\n\t\t\t cheapest_path->startup_cost, cheapest_path->total_cost,\n\t\t\t cheapest_path_rows)",
          "old_line_content": "\t\tsorted_p.startup_cost = sorted_path->startup_cost;",
          "new_line_content": "\tcost_agg(&hashed_p, root, AGG_HASHED, agg_counts->numAggs,",
          "content_same": false
        },
        {
          "line": 1048,
          "old_api": null,
          "new_api": "make_agg",
          "old_text": null,
          "new_text": "make_agg(root,\n\t\t\t\t\t\t\t\t\t\t\t\ttlist,\n\t\t\t\t\t\t\t\t\t\t\t\t(List *) parse->havingQual,\n\t\t\t\t\t\t\t\t\t\t\t\tAGG_HASHED,\n\t\t\t\t\t\t\t\t\t\t\t\tnumGroupCols,\n\t\t\t\t\t\t\t\t\t\t\t\tgroupColIdx,\n\t\t\t\t\t\t\t\t\t\t\t\tgroupOperators,\n\t\t\t\t\t\t\t\t\t\t\t\tnumGroups,\n\t\t\t\t\t\t\t\t\t\t\t\tagg_counts.numAggs,\n\t\t\t\t\t\t\t\t\t\t\t\tresult_plan)",
          "old_line_content": "\t\t\t\tcurrent_pathkeys = NIL;",
          "new_line_content": "\t\t\t\tresult_plan = (Plan *) make_agg(root,",
          "content_same": false
        },
        {
          "line": 1689,
          "old_api": null,
          "new_api": "pull_var_clause",
          "old_text": null,
          "new_text": "pull_var_clause(parse->havingQual, false)",
          "old_line_content": "\tif (numCols > 0)",
          "new_line_content": "\textravars = pull_var_clause(parse->havingQual, false);",
          "content_same": false
        },
        {
          "line": 1690,
          "old_api": null,
          "new_api": "add_to_flat_tlist",
          "old_text": null,
          "new_text": "add_to_flat_tlist(sub_tlist, extravars)",
          "old_line_content": "\t{",
          "new_line_content": "\tsub_tlist = add_to_flat_tlist(sub_tlist, extravars);",
          "content_same": false
        },
        {
          "line": 1691,
          "old_api": null,
          "new_api": "list_free",
          "old_text": null,
          "new_text": "list_free(extravars)",
          "old_line_content": "\t\tint\t\t\tkeyno = 0;",
          "new_line_content": "\tlist_free(extravars);",
          "content_same": false
        },
        {
          "line": 1815,
          "old_api": null,
          "new_api": "lnext",
          "old_text": null,
          "new_text": "lnext(orig_tlist_item)",
          "old_line_content": "",
          "new_line_content": "\t\torig_tlist_item = lnext(orig_tlist_item);",
          "content_same": false
        },
        {
          "line": 1566,
          "old_api": null,
          "new_api": "cost_sort",
          "old_text": null,
          "new_text": "cost_sort(&hashed_p, root, root->sort_pathkeys, hashed_p.total_cost,\n\t\t\t\t  dNumGroups, cheapest_path_width, limit_tuples)",
          "old_line_content": "\t\tsorted_p.startup_cost = cheapest_path->startup_cost;",
          "new_line_content": "\t\tcost_sort(&hashed_p, root, root->sort_pathkeys, hashed_p.total_cost,",
          "content_same": false
        },
        {
          "line": 1305,
          "old_api": null,
          "new_api": "DatumGetInt64",
          "old_text": null,
          "new_text": "DatumGetInt64(((Const *) est)->constvalue)",
          "old_line_content": "\tif (parse->limitOffset)",
          "new_line_content": "\t\t\t\t*count_est = DatumGetInt64(((Const *) est)->constvalue);",
          "content_same": false
        },
        {
          "line": 1817,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"resjunk output columns are not implemented\")",
          "old_line_content": "",
          "new_line_content": "\t\t\telog(ERROR, \"resjunk output columns are not implemented\");",
          "content_same": false
        },
        {
          "line": 1818,
          "old_api": null,
          "new_api": "Assert",
          "old_text": null,
          "new_text": "Assert(new_tle->resno == orig_tle->resno)",
          "old_line_content": "",
          "new_line_content": "\t\tAssert(new_tle->resno == orig_tle->resno);",
          "content_same": false
        },
        {
          "line": 1822,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"resjunk output columns are not implemented\")",
          "old_line_content": "",
          "new_line_content": "\t\telog(ERROR, \"resjunk output columns are not implemented\");",
          "content_same": false
        },
        {
          "line": 1699,
          "old_api": null,
          "new_api": "list_length",
          "old_text": null,
          "new_text": "list_length(parse->groupClause)",
          "old_line_content": "\t\t{",
          "new_line_content": "\tnumCols = list_length(parse->groupClause);",
          "content_same": false
        },
        {
          "line": 1023,
          "old_api": null,
          "new_api": "cost_qual_eval",
          "old_text": null,
          "new_text": "cost_qual_eval(&tlist_cost, sub_tlist, root)",
          "old_line_content": "\t\t\t\t */",
          "new_line_content": "\t\t\t\tcost_qual_eval(&tlist_cost, sub_tlist, root);",
          "content_same": false
        },
        {
          "line": 1318,
          "old_api": null,
          "new_api": "estimate_expression_value",
          "old_text": null,
          "new_text": "estimate_expression_value(root, parse->limitOffset)",
          "old_line_content": "\t\t\t\tif (*offset_est < 0)",
          "new_line_content": "\t\test = estimate_expression_value(root, parse->limitOffset);",
          "content_same": false
        },
        {
          "line": 1191,
          "old_api": null,
          "new_api": "make_limit",
          "old_text": null,
          "new_text": "make_limit(result_plan,\n\t\t\t\t\t\t\t\t\t\t  parse->limitOffset,\n\t\t\t\t\t\t\t\t\t\t  parse->limitCount,\n\t\t\t\t\t\t\t\t\t\t  offset_est,\n\t\t\t\t\t\t\t\t\t\t  count_est)",
          "old_line_content": "\t */",
          "new_line_content": "\t\tresult_plan = (Plan *) make_limit(result_plan,",
          "content_same": false
        },
        {
          "line": 1319,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(est, Const)",
          "old_line_content": "\t\t\t\t\t*offset_est = 0;\t/* less than 0 is same as 0 */",
          "new_line_content": "\t\tif (est && IsA(est, Const))",
          "content_same": false
        },
        {
          "line": 1706,
          "old_api": null,
          "new_api": "palloc",
          "old_text": null,
          "new_text": "palloc(sizeof(AttrNumber) * numCols)",
          "old_line_content": "\t\t\tforeach(sl, sub_tlist)",
          "new_line_content": "\t\tgrpColIdx = (AttrNumber *) palloc(sizeof(AttrNumber) * numCols);",
          "content_same": false
        },
        {
          "line": 1068,
          "old_api": null,
          "new_api": "pathkeys_contained_in",
          "old_text": null,
          "new_text": "pathkeys_contained_in(group_pathkeys,\n\t\t\t\t\t\t\t\t\t\t\t   current_pathkeys)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t\tif (!pathkeys_contained_in(group_pathkeys,",
          "content_same": false
        },
        {
          "line": 1581,
          "old_api": null,
          "new_api": "pathkeys_contained_in",
          "old_text": null,
          "new_text": "pathkeys_contained_in(root->group_pathkeys, current_pathkeys)",
          "old_line_content": "\t\t\t\t cheapest_path_rows);",
          "new_line_content": "\tif (!pathkeys_contained_in(root->group_pathkeys, current_pathkeys))",
          "content_same": false
        },
        {
          "line": 1711,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(gl)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\tGroupClause *grpcl = (GroupClause *) lfirst(gl);",
          "content_same": false
        },
        {
          "line": 1072,
          "old_api": null,
          "new_api": "make_sort_from_groupcols",
          "old_text": null,
          "new_text": "make_sort_from_groupcols(root,\n\t\t\t\t\t\t\t\t\t\t\t\t\t parse->groupClause,\n\t\t\t\t\t\t\t\t\t\t\t\t\t groupColIdx,\n\t\t\t\t\t\t\t\t\t\t\t\t\t result_plan)",
          "old_line_content": "\t\t\t\t\t */",
          "new_line_content": "\t\t\t\t\t\t\tmake_sort_from_groupcols(root,",
          "content_same": false
        },
        {
          "line": 1328,
          "old_api": null,
          "new_api": "DatumGetInt64",
          "old_text": null,
          "new_text": "DatumGetInt64(((Const *) est)->constvalue)",
          "old_line_content": "\tif (*count_est != 0)",
          "new_line_content": "\t\t\t\t*offset_est = DatumGetInt64(((Const *) est)->constvalue);",
          "content_same": false
        },
        {
          "line": 1712,
          "old_api": null,
          "new_api": "get_sortgroupclause_expr",
          "old_text": null,
          "new_text": "get_sortgroupclause_expr(grpcl, tlist)",
          "old_line_content": "\t\t\tif (!sl)",
          "new_line_content": "\t\t\tNode\t   *groupexpr = get_sortgroupclause_expr(grpcl, tlist);",
          "content_same": false
        },
        {
          "line": 1461,
          "old_api": null,
          "new_api": "palloc",
          "old_text": null,
          "new_text": "palloc(sizeof(Oid) * numCols)",
          "old_line_content": "\t}",
          "new_line_content": "\tgroupOperators = (Oid *) palloc(sizeof(Oid) * numCols);",
          "content_same": false
        },
        {
          "line": 1207,
          "old_api": null,
          "new_api": "Assert",
          "old_text": null,
          "new_text": "Assert(parse->resultRelation)",
          "old_line_content": "\tif (parse->resultRelation)",
          "new_line_content": "\t\tAssert(parse->resultRelation);",
          "content_same": false
        },
        {
          "line": 1719,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(sl)",
          "old_line_content": "\t\t\t\t*need_tlist_eval = true;\t\t/* it's not flat anymore */",
          "new_line_content": "\t\t\t\tte = (TargetEntry *) lfirst(sl);",
          "content_same": false
        },
        {
          "line": 1720,
          "old_api": null,
          "new_api": "equal",
          "old_text": null,
          "new_text": "equal(groupexpr, te->expr)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tif (equal(groupexpr, te->expr))",
          "content_same": false
        },
        {
          "line": 1594,
          "old_api": null,
          "new_api": "cost_group",
          "old_text": null,
          "new_text": "cost_group(&sorted_p, root, numGroupCols, dNumGroups,\n\t\t\t\t   sorted_p.startup_cost, sorted_p.total_cost,\n\t\t\t\t   cheapest_path_rows)",
          "old_line_content": "\t * have to convert an absolute count (LIMIT) into fractional form.",
          "new_line_content": "\t\tcost_group(&sorted_p, root, numGroupCols, dNumGroups,",
          "content_same": false
        },
        {
          "line": 1465,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(glitem)",
          "old_line_content": "",
          "new_line_content": "\t\tGroupClause *groupcl = (GroupClause *) lfirst(glitem);",
          "content_same": false
        },
        {
          "line": 1212,
          "old_api": null,
          "new_api": "list_make1",
          "old_text": null,
          "new_text": "list_make1(rlist)",
          "old_line_content": "\t/*",
          "new_line_content": "\t\troot->returningLists = list_make1(rlist);",
          "content_same": false
        },
        {
          "line": 1725,
          "old_api": null,
          "new_api": "makeTargetEntry",
          "old_text": null,
          "new_text": "makeTargetEntry((Expr *) groupexpr,\n\t\t\t\t\t\t\t\t\t list_length(sub_tlist) + 1,\n\t\t\t\t\t\t\t\t\t NULL,\n\t\t\t\t\t\t\t\t\t false)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\t\tte = makeTargetEntry((Expr *) groupexpr,",
          "content_same": false
        },
        {
          "line": 1726,
          "old_api": null,
          "new_api": "list_length",
          "old_text": null,
          "new_text": "list_length(sub_tlist)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t\t\t\t\t\t list_length(sub_tlist) + 1,",
          "content_same": false
        },
        {
          "line": 1467,
          "old_api": null,
          "new_api": "get_equality_op_for_ordering_op",
          "old_text": null,
          "new_text": "get_equality_op_for_ordering_op(groupcl->sortop)",
          "old_line_content": " * choose_hashed_grouping - should we use hashed grouping?",
          "new_line_content": "\t\tgroupOperators[colno] = get_equality_op_for_ordering_op(groupcl->sortop);",
          "content_same": false
        },
        {
          "line": 1600,
          "old_api": null,
          "new_api": "cost_sort",
          "old_text": null,
          "new_text": "cost_sort(&sorted_p, root, root->sort_pathkeys, sorted_p.total_cost,\n\t\t\t\t  dNumGroups, cheapest_path_width, limit_tuples)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t  tuple_fraction) < 0)",
          "new_line_content": "\t\tcost_sort(&sorted_p, root, root->sort_pathkeys, sorted_p.total_cost,",
          "content_same": false
        },
        {
          "line": 1729,
          "old_api": null,
          "new_api": "lappend",
          "old_text": null,
          "new_text": "lappend(sub_tlist, te)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tsub_tlist = lappend(sub_tlist, te);",
          "content_same": false
        },
        {
          "line": 1468,
          "old_api": null,
          "new_api": "OidIsValid",
          "old_text": null,
          "new_text": "OidIsValid(groupOperators[colno])",
          "old_line_content": " */",
          "new_line_content": "\t\tif (!OidIsValid(groupOperators[colno])) /* shouldn't happen */",
          "content_same": false
        },
        {
          "line": 1219,
          "old_api": null,
          "new_api": "list_make1_int",
          "old_text": null,
          "new_text": "list_make1_int(parse->resultRelation)",
          "old_line_content": "}",
          "new_line_content": "\t\troot->resultRelations = list_make1_int(parse->resultRelation);",
          "content_same": false
        },
        {
          "line": 1092,
          "old_api": null,
          "new_api": "make_agg",
          "old_text": null,
          "new_text": "make_agg(root,\n\t\t\t\t\t\t\t\t\t\t\t\ttlist,\n\t\t\t\t\t\t\t\t\t\t\t\t(List *) parse->havingQual,\n\t\t\t\t\t\t\t\t\t\t\t\taggstrategy,\n\t\t\t\t\t\t\t\t\t\t\t\tnumGroupCols,\n\t\t\t\t\t\t\t\t\t\t\t\tgroupColIdx,\n\t\t\t\t\t\t\t\t\t\t\t\tgroupOperators,\n\t\t\t\t\t\t\t\t\t\t\t\tnumGroups,\n\t\t\t\t\t\t\t\t\t\t\t\tagg_counts.numAggs,\n\t\t\t\t\t\t\t\t\t\t\t\tresult_plan)",
          "old_line_content": "\t\t\telse if (parse->groupClause)",
          "new_line_content": "\t\t\t\tresult_plan = (Plan *) make_agg(root,",
          "content_same": false
        },
        {
          "line": 1469,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"could not find equality operator for ordering operator %u\",\n\t\t\t\t groupcl->sortop)",
          "old_line_content": "static bool",
          "new_line_content": "\t\t\telog(ERROR, \"could not find equality operator for ordering operator %u\",",
          "content_same": false
        },
        {
          "line": 961,
          "old_api": null,
          "new_api": "Assert",
          "old_text": null,
          "new_text": "Assert(!parse->groupClause)",
          "old_line_content": "\t\t\tcurrent_pathkeys = best_path->pathkeys;",
          "new_line_content": "\t\t\tAssert(!parse->groupClause);",
          "content_same": false
        },
        {
          "line": 1610,
          "old_api": null,
          "new_api": "compare_fractional_path_costs",
          "old_text": null,
          "new_text": "compare_fractional_path_costs(&hashed_p, &sorted_p,\n\t\t\t\t\t\t\t\t\t  tuple_fraction)",
          "old_line_content": " *\t  Generate appropriate target list when grouping is required.",
          "new_line_content": "\tif (compare_fractional_path_costs(&hashed_p, &sorted_p,",
          "content_same": false
        },
        {
          "line": 971,
          "old_api": null,
          "new_api": "create_plan",
          "old_text": null,
          "new_text": "create_plan(root, best_path)",
          "old_line_content": "\t\t\t{",
          "new_line_content": "\t\t\tresult_plan = create_plan(root, best_path);",
          "content_same": false
        },
        {
          "line": 1487,
          "old_api": null,
          "new_api": "list_length",
          "old_text": null,
          "new_text": "list_length(root->parse->groupClause)",
          "old_line_content": "\t * are hashjoinable.  (We assume hashing is OK if they are marked",
          "new_line_content": "\tint\t\t\tnumGroupCols = list_length(root->parse->groupClause);",
          "content_same": false
        },
        {
          "line": 1112,
          "old_api": null,
          "new_api": "pathkeys_contained_in",
          "old_text": null,
          "new_text": "pathkeys_contained_in(group_pathkeys, current_pathkeys)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t  tlist,",
          "new_line_content": "\t\t\t\tif (!pathkeys_contained_in(group_pathkeys, current_pathkeys))",
          "content_same": false
        },
        {
          "line": 1369,
          "old_api": null,
          "new_api": "Min",
          "old_text": null,
          "new_text": "Min(tuple_fraction, limit_fraction)",
          "old_line_content": "\t\t\t\t/* caller fractional, limit absolute; use limit */",
          "new_line_content": "\t\t\t\ttuple_fraction = Min(tuple_fraction, limit_fraction);",
          "content_same": false
        },
        {
          "line": 1115,
          "old_api": null,
          "new_api": "make_sort_from_groupcols",
          "old_text": null,
          "new_text": "make_sort_from_groupcols(root,\n\t\t\t\t\t\t\t\t\t\t\t\t parse->groupClause,\n\t\t\t\t\t\t\t\t\t\t\t\t groupColIdx,\n\t\t\t\t\t\t\t\t\t\t\t\t result_plan)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t  groupColIdx,",
          "new_line_content": "\t\t\t\t\t\tmake_sort_from_groupcols(root,",
          "content_same": false
        },
        {
          "line": 988,
          "old_api": null,
          "new_api": "is_projection_capable_plan",
          "old_text": null,
          "new_text": "is_projection_capable_plan(result_plan)",
          "old_line_content": "\t\t\t\t\t * the desired tlist.",
          "new_line_content": "\t\t\t\tif (!is_projection_capable_plan(result_plan))",
          "content_same": false
        },
        {
          "line": 1246,
          "old_api": null,
          "new_api": "list_length",
          "old_text": null,
          "new_text": "list_length(rcqual)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tif (list_length(rcqual) == 1)",
          "content_same": false
        },
        {
          "line": 990,
          "old_api": null,
          "new_api": "make_result",
          "old_text": null,
          "new_text": "make_result(root,\n\t\t\t\t\t\t\t\t\t\t\t\t\t   sub_tlist,\n\t\t\t\t\t\t\t\t\t\t\t\t\t   NULL,\n\t\t\t\t\t\t\t\t\t\t\t\t\t   result_plan)",
          "old_line_content": "\t\t\t\t\tresult_plan->targetlist = sub_tlist;",
          "new_line_content": "\t\t\t\t\tresult_plan = (Plan *) make_result(root,",
          "content_same": false
        },
        {
          "line": 1248,
          "old_api": null,
          "new_api": "linitial",
          "old_text": null,
          "new_text": "linitial(rcqual)",
          "old_line_content": "}",
          "new_line_content": "\t\t\tConst\t   *constqual = (Const *) linitial(rcqual);",
          "content_same": false
        },
        {
          "line": 1122,
          "old_api": null,
          "new_api": "make_group",
          "old_text": null,
          "new_text": "make_group(root,\n\t\t\t\t\t\t\t\t\t\t\t\t  tlist,\n\t\t\t\t\t\t\t\t\t\t\t\t  (List *) parse->havingQual,\n\t\t\t\t\t\t\t\t\t\t\t\t  numGroupCols,\n\t\t\t\t\t\t\t\t\t\t\t\t  groupColIdx,\n\t\t\t\t\t\t\t\t\t\t\t\t  groupOperators,\n\t\t\t\t\t\t\t\t\t\t\t\t  dNumGroups,\n\t\t\t\t\t\t\t\t\t\t\t\t  result_plan)",
          "old_line_content": "\t\t\t{",
          "new_line_content": "\t\t\t\tresult_plan = (Plan *) make_group(root,",
          "content_same": false
        },
        {
          "line": 1250,
          "old_api": null,
          "new_api": "IsA",
          "old_text": null,
          "new_text": "IsA(constqual, Const)",
          "old_line_content": "/*",
          "new_line_content": "\t\t\tif (constqual && IsA(constqual, Const))",
          "content_same": false
        },
        {
          "line": 1763,
          "old_api": null,
          "new_api": "Assert",
          "old_text": null,
          "new_text": "Assert(groupColIdx == NULL)",
          "old_line_content": "",
          "new_line_content": "\t\tAssert(groupColIdx == NULL);",
          "content_same": false
        },
        {
          "line": 1253,
          "old_api": null,
          "new_api": "DatumGetBool",
          "old_text": null,
          "new_text": "DatumGetBool(constqual->constvalue)",
          "old_line_content": " * We try to estimate the values of the LIMIT/OFFSET clauses, and pass the",
          "new_line_content": "\t\t\t\t\t!DatumGetBool(constqual->constvalue))",
          "content_same": false
        },
        {
          "line": 1768,
          "old_api": null,
          "new_api": "foreach",
          "old_text": null,
          "new_text": "foreach(gl, root->parse->groupClause)",
          "old_line_content": "\t\t\t\tbreak;",
          "new_line_content": "\tforeach(gl, root->parse->groupClause)",
          "content_same": false
        },
        {
          "line": 1512,
          "old_api": null,
          "new_api": "op_hashjoinable",
          "old_text": null,
          "new_text": "op_hashjoinable(groupOperators[i])",
          "old_line_content": "\tif (cheapest_path->parent)",
          "new_line_content": "\t\tif (!op_hashjoinable(groupOperators[i]))",
          "content_same": false
        },
        {
          "line": 1770,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(gl)",
          "old_line_content": "\t\tif (!sl)",
          "new_line_content": "\t\tGroupClause *grpcl = (GroupClause *) lfirst(gl);",
          "content_same": false
        },
        {
          "line": 1386,
          "old_api": null,
          "new_api": "Min",
          "old_text": null,
          "new_text": "Min(tuple_fraction, limit_fraction)",
          "old_line_content": "\t\t/*",
          "new_line_content": "\t\t\t\ttuple_fraction = Min(tuple_fraction, limit_fraction);",
          "content_same": false
        },
        {
          "line": 1777,
          "old_api": null,
          "new_api": "lfirst",
          "old_text": null,
          "new_text": "lfirst(sl)",
          "old_line_content": "/*",
          "new_line_content": "\t\t\tte = (TargetEntry *) lfirst(sl);",
          "content_same": false
        },
        {
          "line": 1778,
          "old_api": null,
          "new_api": "equal",
          "old_text": null,
          "new_text": "equal(groupexpr, te->expr)",
          "old_line_content": " * postprocess_setop_tlist",
          "new_line_content": "\t\t\tif (equal(groupexpr, te->expr))",
          "content_same": false
        },
        {
          "line": 1782,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"failed to locate grouping columns\")",
          "old_line_content": " * NOTE: this would not be good enough if we supported resjunk sort keys",
          "new_line_content": "\t\t\telog(ERROR, \"failed to locate grouping columns\");",
          "content_same": false
        },
        {
          "line": 1146,
          "old_api": null,
          "new_api": "make_result",
          "old_text": null,
          "new_text": "make_result(root,\n\t\t\t\t\t\t\t\t\t\t\t\t   tlist,\n\t\t\t\t\t\t\t\t\t\t\t\t   parse->havingQual,\n\t\t\t\t\t\t\t\t\t\t\t\t   NULL)",
          "old_line_content": "\t */",
          "new_line_content": "\t\t\t\tresult_plan = (Plan *) make_result(root,",
          "content_same": false
        },
        {
          "line": 1535,
          "old_api": null,
          "new_api": "MAXALIGN",
          "old_text": null,
          "new_text": "MAXALIGN(sizeof(MinimalTupleData))",
          "old_line_content": "\t * avoiding the need for sorted input is usually a win, the fact that the",
          "new_line_content": "\thashentrysize = MAXALIGN(cheapest_path_width) + MAXALIGN(sizeof(MinimalTupleData));",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1024,
          "old_api": "locate_grouping_columns",
          "new_api": null,
          "old_text": "locate_grouping_columns(root, tlist, result_plan->targetlist,\n\t\t\t\t\t\t\t\t\t\tgroupColIdx)",
          "new_text": null,
          "old_line_content": "\t\t\t\tlocate_grouping_columns(root, tlist, result_plan->targetlist,",
          "new_line_content": "\t\t\t\tresult_plan->startup_cost += tlist_cost.startup;",
          "content_same": false
        },
        {
          "line": 1795,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(l)",
          "new_text": null,
          "old_line_content": "\t\tTargetEntry *new_tle = (TargetEntry *) lfirst(l);",
          "new_line_content": " * new tlist to evaluate the resjunk columns.  For now, just ereport if we",
          "content_same": false
        },
        {
          "line": 1284,
          "old_api": "estimate_expression_value",
          "new_api": null,
          "old_text": "estimate_expression_value(root, parse->limitCount)",
          "new_text": null,
          "old_line_content": "\t\test = estimate_expression_value(root, parse->limitCount);",
          "new_line_content": "\tdouble\t\tlimit_fraction;",
          "content_same": false
        },
        {
          "line": 1285,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(est, Const)",
          "new_text": null,
          "old_line_content": "\t\tif (est && IsA(est, Const))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1803,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(orig_tlist_item)",
          "new_text": null,
          "old_line_content": "\t\torig_tle = (TargetEntry *) lfirst(orig_tlist_item);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1164,
          "old_api": "make_unique",
          "new_api": null,
          "old_text": "make_unique(result_plan, parse->distinctClause)",
          "new_text": null,
          "old_line_content": "\t\tresult_plan = (Plan *) make_unique(result_plan, parse->distinctClause);",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t\t\t   sort_pathkeys,",
          "content_same": false
        },
        {
          "line": 1549,
          "old_api": "cost_agg",
          "new_api": null,
          "old_text": "cost_agg(&hashed_p, root, AGG_HASHED, agg_counts->numAggs,\n\t\t\t numGroupCols, dNumGroups,\n\t\t\t cheapest_path->startup_cost, cheapest_path->total_cost,\n\t\t\t cheapest_path_rows)",
          "new_text": null,
          "old_line_content": "\tcost_agg(&hashed_p, root, AGG_HASHED, agg_counts->numAggs,",
          "new_line_content": "\t *",
          "content_same": false
        },
        {
          "line": 1037,
          "old_api": "make_agg",
          "new_api": null,
          "old_text": "make_agg(root,\n\t\t\t\t\t\t\t\t\t\t\t\ttlist,\n\t\t\t\t\t\t\t\t\t\t\t\t(List *) parse->havingQual,\n\t\t\t\t\t\t\t\t\t\t\t\tAGG_HASHED,\n\t\t\t\t\t\t\t\t\t\t\t\tnumGroupCols,\n\t\t\t\t\t\t\t\t\t\t\t\tgroupColIdx,\n\t\t\t\t\t\t\t\t\t\t\t\tgroupOperators,\n\t\t\t\t\t\t\t\t\t\t\t\tnumGroups,\n\t\t\t\t\t\t\t\t\t\t\t\tagg_counts.numAggs,\n\t\t\t\t\t\t\t\t\t\t\t\tresult_plan)",
          "new_text": null,
          "old_line_content": "\t\t\t\tresult_plan = (Plan *) make_agg(root,",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 1677,
          "old_api": "flatten_tlist",
          "new_api": null,
          "old_text": "flatten_tlist(tlist)",
          "new_text": null,
          "old_line_content": "\tsub_tlist = flatten_tlist(tlist);",
          "new_line_content": "\tif (!parse->hasAggs && !parse->groupClause && !root->hasHavingQual)",
          "content_same": false
        },
        {
          "line": 1678,
          "old_api": "pull_var_clause",
          "new_api": null,
          "old_text": "pull_var_clause(parse->havingQual, false)",
          "new_text": null,
          "old_line_content": "\textravars = pull_var_clause(parse->havingQual, false);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1679,
          "old_api": "add_to_flat_tlist",
          "new_api": null,
          "old_text": "add_to_flat_tlist(sub_tlist, extravars)",
          "new_text": null,
          "old_line_content": "\tsub_tlist = add_to_flat_tlist(sub_tlist, extravars);",
          "new_line_content": "\t\t*need_tlist_eval = true;",
          "content_same": false
        },
        {
          "line": 1680,
          "old_api": "list_free",
          "new_api": null,
          "old_text": "list_free(extravars)",
          "new_text": null,
          "old_line_content": "\tlist_free(extravars);",
          "new_line_content": "\t\treturn tlist;",
          "content_same": false
        },
        {
          "line": 1555,
          "old_api": "cost_sort",
          "new_api": null,
          "old_text": "cost_sort(&hashed_p, root, root->sort_pathkeys, hashed_p.total_cost,\n\t\t\t\t  dNumGroups, cheapest_path_width, limit_tuples)",
          "new_text": null,
          "old_line_content": "\t\tcost_sort(&hashed_p, root, root->sort_pathkeys, hashed_p.total_cost,",
          "new_line_content": "\t * cheapest_path for this purpose.",
          "content_same": false
        },
        {
          "line": 1294,
          "old_api": "DatumGetInt64",
          "new_api": null,
          "old_text": "DatumGetInt64(((Const *) est)->constvalue)",
          "new_text": null,
          "old_line_content": "\t\t\t\t*count_est = DatumGetInt64(((Const *) est)->constvalue);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1804,
          "old_api": "lnext",
          "new_api": null,
          "old_text": "lnext(orig_tlist_item)",
          "new_text": null,
          "old_line_content": "\t\torig_tlist_item = lnext(orig_tlist_item);",
          "new_line_content": "\tforeach(l, new_tlist)",
          "content_same": false
        },
        {
          "line": 1807,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(new_tle->resno == orig_tle->resno)",
          "new_text": null,
          "old_line_content": "\t\tAssert(new_tle->resno == orig_tle->resno);",
          "new_line_content": "\t\tTargetEntry *orig_tle;",
          "content_same": false
        },
        {
          "line": 1811,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR, \"resjunk output columns are not implemented\")",
          "new_text": null,
          "old_line_content": "\t\telog(ERROR, \"resjunk output columns are not implemented\");",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 1307,
          "old_api": "estimate_expression_value",
          "new_api": null,
          "old_text": "estimate_expression_value(root, parse->limitOffset)",
          "new_text": null,
          "old_line_content": "\t\test = estimate_expression_value(root, parse->limitOffset);",
          "new_line_content": "\t\t\t\t\t*count_est = 1;\t\t/* force to at least 1 */",
          "content_same": false
        },
        {
          "line": 1180,
          "old_api": "make_limit",
          "new_api": null,
          "old_text": "make_limit(result_plan,\n\t\t\t\t\t\t\t\t\t\t  parse->limitOffset,\n\t\t\t\t\t\t\t\t\t\t  parse->limitCount,\n\t\t\t\t\t\t\t\t\t\t  offset_est,\n\t\t\t\t\t\t\t\t\t\t  count_est)",
          "new_text": null,
          "old_line_content": "\t\tresult_plan = (Plan *) make_limit(result_plan,",
          "new_line_content": "\t\t * number of distinct-groups calculated by query_planner.",
          "content_same": false
        },
        {
          "line": 1308,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(est, Const)",
          "new_text": null,
          "old_line_content": "\t\tif (est && IsA(est, Const))",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 1695,
          "old_api": "palloc",
          "new_api": null,
          "old_text": "palloc(sizeof(AttrNumber) * numCols)",
          "new_text": null,
          "old_line_content": "\t\tgrpColIdx = (AttrNumber *) palloc(sizeof(AttrNumber) * numCols);",
          "new_line_content": "\t * If grouping, create sub_tlist entries for all GROUP BY expressions",
          "content_same": false
        },
        {
          "line": 1057,
          "old_api": "pathkeys_contained_in",
          "new_api": null,
          "old_text": "pathkeys_contained_in(group_pathkeys,\n\t\t\t\t\t\t\t\t\t\t\t   current_pathkeys)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tif (!pathkeys_contained_in(group_pathkeys,",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t\t\tresult_plan);",
          "content_same": false
        },
        {
          "line": 1570,
          "old_api": "pathkeys_contained_in",
          "new_api": null,
          "old_text": "pathkeys_contained_in(root->group_pathkeys, current_pathkeys)",
          "new_text": null,
          "old_line_content": "\tif (!pathkeys_contained_in(root->group_pathkeys, current_pathkeys))",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1698,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(gl, parse->groupClause)",
          "new_text": null,
          "old_line_content": "\t\tforeach(gl, parse->groupClause)",
          "new_line_content": "\t */",
          "content_same": false
        },
        {
          "line": 1572,
          "old_api": "cost_sort",
          "new_api": null,
          "old_text": "cost_sort(&sorted_p, root, root->group_pathkeys, sorted_p.total_cost,\n\t\t\t\t  cheapest_path_rows, cheapest_path_width, -1.0)",
          "new_text": null,
          "old_line_content": "\t\tcost_sort(&sorted_p, root, root->group_pathkeys, sorted_p.total_cost,",
          "new_line_content": "\t\tsorted_p.total_cost = sorted_path->total_cost;",
          "content_same": false
        },
        {
          "line": 1061,
          "old_api": "make_sort_from_groupcols",
          "new_api": null,
          "old_text": "make_sort_from_groupcols(root,\n\t\t\t\t\t\t\t\t\t\t\t\t\t parse->groupClause,\n\t\t\t\t\t\t\t\t\t\t\t\t\t groupColIdx,\n\t\t\t\t\t\t\t\t\t\t\t\t\t result_plan)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\tmake_sort_from_groupcols(root,",
          "new_line_content": "\t\t\telse if (parse->hasAggs)",
          "content_same": false
        },
        {
          "line": 1700,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(gl)",
          "new_text": null,
          "old_line_content": "\t\t\tGroupClause *grpcl = (GroupClause *) lfirst(gl);",
          "new_line_content": "\tif (numCols > 0)",
          "content_same": false
        },
        {
          "line": 1701,
          "old_api": "get_sortgroupclause_expr",
          "new_api": null,
          "old_text": "get_sortgroupclause_expr(grpcl, tlist)",
          "new_text": null,
          "old_line_content": "\t\t\tNode\t   *groupexpr = get_sortgroupclause_expr(grpcl, tlist);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1317,
          "old_api": "DatumGetInt64",
          "new_api": null,
          "old_text": "DatumGetInt64(((Const *) est)->constvalue)",
          "new_text": null,
          "old_line_content": "\t\t\t\t*offset_est = DatumGetInt64(((Const *) est)->constvalue);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1445,
          "old_api": "list_length",
          "new_api": null,
          "old_text": "list_length(groupClause)",
          "new_text": null,
          "old_line_content": "\tint\t\t\tnumCols = list_length(groupClause);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1578,
          "old_api": "cost_agg",
          "new_api": null,
          "old_text": "cost_agg(&sorted_p, root, AGG_SORTED, agg_counts->numAggs,\n\t\t\t\t numGroupCols, dNumGroups,\n\t\t\t\t sorted_p.startup_cost, sorted_p.total_cost,\n\t\t\t\t cheapest_path_rows)",
          "new_text": null,
          "old_line_content": "\t\tcost_agg(&sorted_p, root, AGG_SORTED, agg_counts->numAggs,",
          "new_line_content": "\t\tsorted_p.total_cost = cheapest_path->total_cost;",
          "content_same": false
        },
        {
          "line": 1450,
          "old_api": "palloc",
          "new_api": null,
          "old_text": "palloc(sizeof(Oid) * numCols)",
          "new_text": null,
          "old_line_content": "\tgroupOperators = (Oid *) palloc(sizeof(Oid) * numCols);",
          "new_line_content": " * extract_grouping_ops - make an array of the equality operator OIDs",
          "content_same": false
        },
        {
          "line": 1196,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(parse->resultRelation)",
          "new_text": null,
          "old_line_content": "\t\tAssert(parse->resultRelation);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1197,
          "old_api": "set_returning_clause_references",
          "new_api": null,
          "old_text": "set_returning_clause_references(root->glob,\n\t\t\t\t\t\t\t\t\t\t\t\tparse->returningList,\n\t\t\t\t\t\t\t\t\t\t\t\tresult_plan,\n\t\t\t\t\t\t\t\t\t\t\t\tparse->resultRelation)",
          "new_text": null,
          "old_line_content": "\t\trlist = set_returning_clause_references(root->glob,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1708,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(sl)",
          "new_text": null,
          "old_line_content": "\t\t\t\tte = (TargetEntry *) lfirst(sl);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1454,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(glitem)",
          "new_text": null,
          "old_line_content": "\t\tGroupClause *groupcl = (GroupClause *) lfirst(glitem);",
          "new_line_content": "extract_grouping_ops(List *groupClause)",
          "content_same": false
        },
        {
          "line": 1201,
          "old_api": "list_make1",
          "new_api": null,
          "old_text": "list_make1(rlist)",
          "new_text": null,
          "old_line_content": "\t\troot->returningLists = list_make1(rlist);",
          "new_line_content": "\t * waited, handling inherited UPDATE/DELETE would be much harder).",
          "content_same": false
        },
        {
          "line": 1714,
          "old_api": "makeTargetEntry",
          "new_api": null,
          "old_text": "makeTargetEntry((Expr *) groupexpr,\n\t\t\t\t\t\t\t\t\t list_length(sub_tlist) + 1,\n\t\t\t\t\t\t\t\t\t NULL,\n\t\t\t\t\t\t\t\t\t false)",
          "new_text": null,
          "old_line_content": "\t\t\t\tte = makeTargetEntry((Expr *) groupexpr,",
          "new_line_content": "\t\t\tListCell   *sl;",
          "content_same": false
        },
        {
          "line": 1715,
          "old_api": "list_length",
          "new_api": null,
          "old_text": "list_length(sub_tlist)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\t\t\t\t list_length(sub_tlist) + 1,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1588,
          "old_api": "pathkeys_contained_in",
          "new_api": null,
          "old_text": "pathkeys_contained_in(root->sort_pathkeys, current_pathkeys)",
          "new_text": null,
          "old_line_content": "\t\t!pathkeys_contained_in(root->sort_pathkeys, current_pathkeys))",
          "new_line_content": "\tif (root->parse->hasAggs)",
          "content_same": false
        },
        {
          "line": 1791,
          "old_api": "list_head",
          "new_api": null,
          "old_text": "list_head(orig_tlist)",
          "new_text": null,
          "old_line_content": "\tListCell   *orig_tlist_item = list_head(orig_tlist);",
          "new_line_content": " *",
          "content_same": false
        },
        {
          "line": 1718,
          "old_api": "lappend",
          "new_api": null,
          "old_text": "lappend(sub_tlist, te)",
          "new_text": null,
          "old_line_content": "\t\t\t\tsub_tlist = lappend(sub_tlist, te);",
          "new_line_content": "\t\t\t{",
          "content_same": false
        },
        {
          "line": 1457,
          "old_api": "OidIsValid",
          "new_api": null,
          "old_text": "OidIsValid(groupOperators[colno])",
          "new_text": null,
          "old_line_content": "\t\tif (!OidIsValid(groupOperators[colno])) /* shouldn't happen */",
          "new_line_content": "\tint\t\t\tcolno = 0;",
          "content_same": false
        },
        {
          "line": 1458,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR, \"could not find equality operator for ordering operator %u\",\n\t\t\t\t groupcl->sortop)",
          "new_text": null,
          "old_line_content": "\t\t\telog(ERROR, \"could not find equality operator for ordering operator %u\",",
          "new_line_content": "\tOid\t\t   *groupOperators;",
          "content_same": false
        },
        {
          "line": 1081,
          "old_api": "make_agg",
          "new_api": null,
          "old_text": "make_agg(root,\n\t\t\t\t\t\t\t\t\t\t\t\ttlist,\n\t\t\t\t\t\t\t\t\t\t\t\t(List *) parse->havingQual,\n\t\t\t\t\t\t\t\t\t\t\t\taggstrategy,\n\t\t\t\t\t\t\t\t\t\t\t\tnumGroupCols,\n\t\t\t\t\t\t\t\t\t\t\t\tgroupColIdx,\n\t\t\t\t\t\t\t\t\t\t\t\tgroupOperators,\n\t\t\t\t\t\t\t\t\t\t\t\tnumGroups,\n\t\t\t\t\t\t\t\t\t\t\t\tagg_counts.numAggs,\n\t\t\t\t\t\t\t\t\t\t\t\tresult_plan)",
          "new_text": null,
          "old_line_content": "\t\t\t\tresult_plan = (Plan *) make_agg(root,",
          "new_line_content": "\t\t\t\t\t * The AGG node will not change the sort ordering of its",
          "content_same": false
        },
        {
          "line": 960,
          "old_api": "create_plan",
          "new_api": null,
          "old_text": "create_plan(root, best_path)",
          "new_text": null,
          "old_line_content": "\t\t\tresult_plan = create_plan(root, best_path);",
          "new_line_content": "\t\t\t */",
          "content_same": false
        },
        {
          "line": 1476,
          "old_api": "list_length",
          "new_api": null,
          "old_text": "list_length(root->parse->groupClause)",
          "new_text": null,
          "old_line_content": "\tint\t\t\tnumGroupCols = list_length(root->parse->groupClause);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1101,
          "old_api": "pathkeys_contained_in",
          "new_api": null,
          "old_text": "pathkeys_contained_in(group_pathkeys, current_pathkeys)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (!pathkeys_contained_in(group_pathkeys, current_pathkeys))",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t\t\tresult_plan);",
          "content_same": false
        },
        {
          "line": 1358,
          "old_api": "Min",
          "new_api": null,
          "old_text": "Min(tuple_fraction, limit_fraction)",
          "new_text": null,
          "old_line_content": "\t\t\t\ttuple_fraction = Min(tuple_fraction, limit_fraction);",
          "new_line_content": "\t\t * If we have absolute limits from both caller and LIMIT, use the",
          "content_same": false
        },
        {
          "line": 1231,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(plan, Result)",
          "new_text": null,
          "old_line_content": "\tif (IsA(plan, Result))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1104,
          "old_api": "make_sort_from_groupcols",
          "new_api": null,
          "old_text": "make_sort_from_groupcols(root,\n\t\t\t\t\t\t\t\t\t\t\t\t parse->groupClause,\n\t\t\t\t\t\t\t\t\t\t\t\t groupColIdx,\n\t\t\t\t\t\t\t\t\t\t\t\t result_plan)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tmake_sort_from_groupcols(root,",
          "new_line_content": "\t\t\t{",
          "content_same": false
        },
        {
          "line": 977,
          "old_api": "is_projection_capable_plan",
          "new_api": null,
          "old_text": "is_projection_capable_plan(result_plan)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (!is_projection_capable_plan(result_plan))",
          "new_line_content": "\t\t\t * tlist of the top plan node.\tHowever, we can skip that if we",
          "content_same": false
        },
        {
          "line": 1235,
          "old_api": "list_length",
          "new_api": null,
          "old_text": "list_length(rcqual)",
          "new_text": null,
          "old_line_content": "\t\tif (list_length(rcqual) == 1)",
          "new_line_content": " *",
          "content_same": false
        },
        {
          "line": 979,
          "old_api": "make_result",
          "new_api": null,
          "old_text": "make_result(root,\n\t\t\t\t\t\t\t\t\t\t\t\t\t   sub_tlist,\n\t\t\t\t\t\t\t\t\t\t\t\t\t   NULL,\n\t\t\t\t\t\t\t\t\t\t\t\t\t   result_plan)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tresult_plan = (Plan *) make_result(root,",
          "new_line_content": "\t\t\t * good enough.",
          "content_same": false
        },
        {
          "line": 1237,
          "old_api": "linitial",
          "new_api": null,
          "old_text": "linitial(rcqual)",
          "new_text": null,
          "old_line_content": "\t\t\tConst\t   *constqual = (Const *) linitial(rcqual);",
          "new_line_content": " * filter quals.",
          "content_same": false
        },
        {
          "line": 1111,
          "old_api": "make_group",
          "new_api": null,
          "old_text": "make_group(root,\n\t\t\t\t\t\t\t\t\t\t\t\t  tlist,\n\t\t\t\t\t\t\t\t\t\t\t\t  (List *) parse->havingQual,\n\t\t\t\t\t\t\t\t\t\t\t\t  numGroupCols,\n\t\t\t\t\t\t\t\t\t\t\t\t  groupColIdx,\n\t\t\t\t\t\t\t\t\t\t\t\t  groupOperators,\n\t\t\t\t\t\t\t\t\t\t\t\t  dNumGroups,\n\t\t\t\t\t\t\t\t\t\t\t\t  result_plan)",
          "new_text": null,
          "old_line_content": "\t\t\t\tresult_plan = (Plan *) make_group(root,",
          "new_line_content": "\t\t\t\t */",
          "content_same": false
        },
        {
          "line": 1239,
          "old_api": "IsA",
          "new_api": null,
          "old_text": "IsA(constqual, Const)",
          "new_text": null,
          "old_line_content": "\t\t\tif (constqual && IsA(constqual, Const))",
          "new_line_content": "static bool",
          "content_same": false
        },
        {
          "line": 1752,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(groupColIdx == NULL)",
          "new_text": null,
          "old_line_content": "\t\tAssert(groupColIdx == NULL);",
          "new_line_content": "\t\t\t\t\t\tList *sub_tlist,",
          "content_same": false
        },
        {
          "line": 1755,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(groupColIdx != NULL)",
          "new_text": null,
          "old_line_content": "\tAssert(groupColIdx != NULL);",
          "new_line_content": "\tint\t\t\tkeyno = 0;",
          "content_same": false
        },
        {
          "line": 1757,
          "old_api": "foreach",
          "new_api": null,
          "old_text": "foreach(gl, root->parse->groupClause)",
          "new_text": null,
          "old_line_content": "\tforeach(gl, root->parse->groupClause)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1501,
          "old_api": "op_hashjoinable",
          "new_api": null,
          "old_text": "op_hashjoinable(groupOperators[i])",
          "new_text": null,
          "old_line_content": "\t\tif (!op_hashjoinable(groupOperators[i]))",
          "new_line_content": "\t *",
          "content_same": false
        },
        {
          "line": 1759,
          "old_api": "lfirst",
          "new_api": null,
          "old_text": "lfirst(gl)",
          "new_text": null,
          "old_line_content": "\t\tGroupClause *grpcl = (GroupClause *) lfirst(gl);",
          "new_line_content": "\t * No work unless grouping.",
          "content_same": false
        },
        {
          "line": 1760,
          "old_api": "get_sortgroupclause_expr",
          "new_api": null,
          "old_text": "get_sortgroupclause_expr(grpcl, tlist)",
          "new_text": null,
          "old_line_content": "\t\tNode\t   *groupexpr = get_sortgroupclause_expr(grpcl, tlist);",
          "new_line_content": "\t */",
          "content_same": false
        },
        {
          "line": 1375,
          "old_api": "Min",
          "new_api": null,
          "old_text": "Min(tuple_fraction, limit_fraction)",
          "new_text": null,
          "old_line_content": "\t\t\t\ttuple_fraction = Min(tuple_fraction, limit_fraction);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 1767,
          "old_api": "equal",
          "new_api": null,
          "old_text": "equal(groupexpr, te->expr)",
          "new_text": null,
          "old_line_content": "\t\t\tif (equal(groupexpr, te->expr))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1135,
          "old_api": "make_result",
          "new_api": null,
          "old_text": "make_result(root,\n\t\t\t\t\t\t\t\t\t\t\t\t   tlist,\n\t\t\t\t\t\t\t\t\t\t\t\t   parse->havingQual,\n\t\t\t\t\t\t\t\t\t\t\t\t   NULL)",
          "new_text": null,
          "old_line_content": "\t\t\t\tresult_plan = (Plan *) make_result(root,",
          "new_line_content": "\t\t\t\t * No aggregates, and no GROUP BY, but we have a HAVING qual.",
          "content_same": false
        },
        {
          "line": 1012,
          "old_api": "cost_qual_eval",
          "new_api": null,
          "old_text": "cost_qual_eval(&tlist_cost, sub_tlist, root)",
          "new_text": null,
          "old_line_content": "\t\t\t\tcost_qual_eval(&tlist_cost, sub_tlist, root);",
          "new_line_content": "\t\t\t\t * query_planner() and subroutines.  But now we've inserted a",
          "content_same": false
        },
        {
          "line": 1524,
          "old_api": "MAXALIGN",
          "new_api": null,
          "old_text": "MAXALIGN(sizeof(MinimalTupleData))",
          "new_text": null,
          "old_line_content": "\thashentrysize = MAXALIGN(cheapest_path_width) + MAXALIGN(sizeof(MinimalTupleData));",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1528,
          "old_api": "hash_agg_entry_size",
          "new_api": null,
          "old_text": "hash_agg_entry_size(agg_counts->numAggs)",
          "new_text": null,
          "old_line_content": "\thashentrysize += hash_agg_entry_size(agg_counts->numAggs);",
          "new_line_content": "\telse",
          "content_same": false
        },
        {
          "line": 1276,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(parse->limitCount || parse->limitOffset)",
          "new_text": null,
          "old_line_content": "\tAssert(parse->limitCount || parse->limitOffset);",
          "new_line_content": " * about context.",
          "content_same": false
        },
        {
          "line": 1149,
          "old_api": "pathkeys_contained_in",
          "new_api": null,
          "old_text": "pathkeys_contained_in(sort_pathkeys, current_pathkeys)",
          "new_text": null,
          "old_line_content": "\t\tif (!pathkeys_contained_in(sort_pathkeys, current_pathkeys))",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t   NULL);",
          "content_same": false
        },
        {
          "line": 1151,
          "old_api": "make_sort_from_pathkeys",
          "new_api": null,
          "old_text": "make_sort_from_pathkeys(root,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   result_plan,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   sort_pathkeys,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   limit_tuples)",
          "new_text": null,
          "old_line_content": "\t\t\tresult_plan = (Plan *) make_sort_from_pathkeys(root,",
          "new_line_content": "\t\t}\t\t\t\t\t\t/* end of non-minmax-aggregate case */",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 12,
      "total_additions": 73,
      "total_deletions": 72,
      "total_api_changes": 157
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 12,
        "api_related_lines": 157,
        "non_api_lines": 10,
        "non_api_line_numbers": [
          962,
          963,
          11,
          953,
          954,
          955,
          956,
          957,
          958,
          959
        ]
      }
    },
    "api_calls_before": 205,
    "api_calls_after": 206,
    "diff_info": {
      "added_lines": 12,
      "removed_lines": 1,
      "total_diff_lines": 32
    }
  }
}