{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/8a59f336bbb8d6829e88c89896472b497d809606",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/8a59f336bbb8d6829e88c89896472b497d809606/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/8a59f336bbb8d6829e88c89896472b497d809606/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/postgres/modified_file/8a59f336bbb8d6829e88c89896472b497d809606/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [],
      "additions": [
        {
          "line": 891,
          "old_api": null,
          "new_api": "lookup_fsm_page_entry",
          "old_text": null,
          "new_text": "lookup_fsm_page_entry(fsmrel, page, &newChunk, &newChunkRelIndex)",
          "old_line_content": "/*",
          "new_line_content": "\tif (lookup_fsm_page_entry(fsmrel, page, &newChunk, &newChunkRelIndex))",
          "content_same": false
        },
        {
          "line": 1029,
          "old_api": null,
          "new_api": "free_chunk_chain",
          "old_text": null,
          "new_text": "free_chunk_chain(dstChunk->next)",
          "old_line_content": "\tFSMRelation *fsmrel;",
          "new_line_content": "\t\tfree_chunk_chain(dstChunk->next);",
          "content_same": false
        },
        {
          "line": 774,
          "old_api": null,
          "new_api": "lookup_fsm_page_entry",
          "old_text": null,
          "new_text": "lookup_fsm_page_entry(fsmrel, page,\n\t\t\t\t\t\t\t\t\t  &chunk, &chunkRelIndex)",
          "old_line_content": " * need to be added to a new chunk.",
          "new_line_content": "\t\t\tif (lookup_fsm_page_entry(fsmrel, page,",
          "content_same": false
        },
        {
          "line": 901,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"insert_fsm_page_entry: failed to insert entry!\")",
          "old_line_content": "",
          "new_line_content": "\telog(ERROR, \"insert_fsm_page_entry: failed to insert entry!\");",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"fsm_record_free_space: unexpected match\")",
          "old_line_content": "static bool",
          "new_line_content": "\t\t\t\telog(ERROR, \"fsm_record_free_space: unexpected match\");",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": null,
          "new_api": "hash_search",
          "old_text": null,
          "new_text": "hash_search(FreeSpaceMap->relHash,\n\t\t\t\t\t\t\t\t\t\t (Pointer) rel,\n\t\t\t\t\t\t\t\t\t\t HASH_ENTER,\n\t\t\t\t\t\t\t\t\t\t &found)",
          "old_line_content": "\t\tfsmrel->numChunks = 0;",
          "new_line_content": "\tfsmrel = (FSMRelation *) hash_search(FreeSpaceMap->relHash,",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"FreeSpaceMap hashtable corrupted\")",
          "old_line_content": "\t\t/*",
          "new_line_content": "\t\telog(ERROR, \"FreeSpaceMap hashtable corrupted\");",
          "content_same": false
        },
        {
          "line": 921,
          "old_api": null,
          "new_api": "push_fsm_page_entry",
          "old_text": null,
          "new_text": "push_fsm_page_entry(chunk->pages[CHUNKPAGES-1],\n\t\t\t\t\t\t\t\t  chunk->bytes[CHUNKPAGES-1],\n\t\t\t\t\t\t\t\t  chunk->next, 0)",
          "old_line_content": "\tchunk->bytes[chunkRelIndex] = (ItemLength) spaceAvail;",
          "new_line_content": "\t\tif (! push_fsm_page_entry(chunk->pages[CHUNKPAGES-1],",
          "content_same": false
        },
        {
          "line": 1052,
          "old_api": null,
          "new_api": "compact_fsm_page_list",
          "old_text": null,
          "new_text": "compact_fsm_page_list(fsmrel)",
          "old_line_content": "{",
          "new_line_content": "\t\tcompact_fsm_page_list(fsmrel);",
          "content_same": false
        },
        {
          "line": 546,
          "old_api": null,
          "new_api": "delete_fsm_rel",
          "old_text": null,
          "new_text": "delete_fsm_rel(FreeSpaceMap->relListTail)",
          "old_line_content": "",
          "new_line_content": "\t\t\tdelete_fsm_rel(FreeSpaceMap->relListTail);",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": null,
          "new_api": "link_fsm_rel_after",
          "old_text": null,
          "new_text": "link_fsm_rel_after(fsmrel, oldrel)",
          "old_line_content": "\t\t\t{",
          "new_line_content": "\t\tlink_fsm_rel_after(fsmrel, oldrel);",
          "content_same": false
        },
        {
          "line": 814,
          "old_api": null,
          "new_api": "Assert",
          "old_text": null,
          "new_text": "Assert(false)",
          "old_line_content": "\t * Adding the page would require a new chunk (or, perhaps, compaction",
          "new_line_content": "\t\t\tAssert(false);",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": null,
          "new_api": "fsm_record_free_space",
          "old_text": null,
          "new_text": "fsm_record_free_space(fsmrel, page, avail)",
          "old_line_content": "FreeSpaceMapForgetRel(RelFileNode *rel)",
          "new_line_content": "\t\t\t\tfsm_record_free_space(fsmrel, page, avail);",
          "content_same": false
        },
        {
          "line": 1078,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr, \"Map %d: rel %u/%u useCount %d threshold %u nextPage %d\\nMap= \",\n\t\t\t\trelNum, fsmrel->key.tblNode, fsmrel->key.relNode,\n\t\t\t\tfsmrel->useCount, fsmrel->threshold, fsmrel->nextPage)",
          "old_line_content": "\t\t\t\t\t\tchunk->bytes[chunkRelIndex]);",
          "new_line_content": "\t\tfprintf(stderr, \"Map %d: rel %u/%u useCount %d threshold %u nextPage %d\\nMap= \",",
          "content_same": false
        },
        {
          "line": 949,
          "old_api": null,
          "new_api": "Assert",
          "old_text": null,
          "new_text": "Assert(chunk && chunkRelIndex >= 0 && chunkRelIndex < chunk->numPages)",
          "old_line_content": "/*",
          "new_line_content": "\tAssert(chunk && chunkRelIndex >= 0 && chunkRelIndex < chunk->numPages);",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": null,
          "new_api": "SpinRelease",
          "old_text": null,
          "new_text": "SpinRelease(FreeSpaceLock)",
          "old_line_content": "",
          "new_line_content": "\tSpinRelease(FreeSpaceLock);",
          "content_same": false
        },
        {
          "line": 960,
          "old_api": null,
          "new_api": "compact_fsm_page_list",
          "old_text": null,
          "new_text": "compact_fsm_page_list(fsmrel)",
          "old_line_content": "\tint\t\t\tsrcIndex,",
          "new_line_content": "\t\tcompact_fsm_page_list(fsmrel);",
          "content_same": false
        },
        {
          "line": 577,
          "old_api": null,
          "new_api": "unlink_fsm_rel",
          "old_text": null,
          "new_text": "unlink_fsm_rel(fsmrel)",
          "old_line_content": "delete_fsm_rel(FSMRelation *fsmrel)",
          "new_line_content": "\t\t\tunlink_fsm_rel(fsmrel);",
          "content_same": false
        },
        {
          "line": 580,
          "old_api": null,
          "new_api": "link_fsm_rel_after",
          "old_text": null,
          "new_text": "link_fsm_rel_after(fsmrel, oldrel)",
          "old_line_content": "\tbool\t\tfound;",
          "new_line_content": "\t\t\tlink_fsm_rel_after(fsmrel, oldrel);",
          "content_same": false
        },
        {
          "line": 1095,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr, \"\\n\")",
          "old_line_content": "\t/* Cross-check global counters */",
          "new_line_content": "\t\tfprintf(stderr, \"\\n\");",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": null,
          "new_api": "SpinAcquire",
          "old_text": null,
          "new_text": "SpinAcquire(FreeSpaceLock)",
          "old_line_content": " * ID not database ID.",
          "new_line_content": "\tSpinAcquire(FreeSpaceLock);",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": null,
          "new_api": "lookup_fsm_rel",
          "old_text": null,
          "new_text": "lookup_fsm_rel(rel)",
          "old_line_content": " */",
          "new_line_content": "\tfsmrel = lookup_fsm_rel(rel);",
          "content_same": false
        },
        {
          "line": 1098,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr, \"DumpFreeSpace: %d pages in rel, but numPages = %d\\n\",\n\t\t\t\t\tnPages, fsmrel->numPages)",
          "old_line_content": "\t\t\t\trelNum, FreeSpaceMap->numRels);",
          "new_line_content": "\t\t\tfprintf(stderr, \"DumpFreeSpace: %d pages in rel, but numPages = %d\\n\",",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": null,
          "new_api": "delete_fsm_rel",
          "old_text": null,
          "new_text": "delete_fsm_rel(fsmrel)",
          "old_line_content": "FreeSpaceMapForgetDatabase(Oid dbid)",
          "new_line_content": "\t\tdelete_fsm_rel(fsmrel);",
          "content_same": false
        },
        {
          "line": 459,
          "old_api": null,
          "new_api": "SpinRelease",
          "old_text": null,
          "new_text": "SpinRelease(FreeSpaceLock)",
          "old_line_content": "{",
          "new_line_content": "\tSpinRelease(FreeSpaceLock);",
          "content_same": false
        },
        {
          "line": 1101,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr, \"DumpFreeSpace: %d chunks in rel, but numChunks = %d\\n\",\n\t\t\t\t\tnChunks, fsmrel->numChunks)",
          "old_line_content": "\t\tnChunks++;",
          "new_line_content": "\t\t\tfprintf(stderr, \"DumpFreeSpace: %d chunks in rel, but numChunks = %d\\n\",",
          "content_same": false
        },
        {
          "line": 1104,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr, \"DumpFreeSpace: broken list links\\n\")",
          "old_line_content": "\t\t\t\tnChunks, FreeSpaceMap->numFreeChunks);",
          "new_line_content": "\t\t\tfprintf(stderr, \"DumpFreeSpace: broken list links\\n\");",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": null,
          "new_api": "free_chunk_chain",
          "old_text": null,
          "new_text": "free_chunk_chain(fsmrel->relChunks)",
          "old_line_content": " */",
          "new_line_content": "\tfree_chunk_chain(fsmrel->relChunks);",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": null,
          "new_api": "unlink_fsm_rel",
          "old_text": null,
          "new_text": "unlink_fsm_rel(fsmrel)",
          "old_line_content": "static void",
          "new_line_content": "\tunlink_fsm_rel(fsmrel);",
          "content_same": false
        },
        {
          "line": 1108,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr, \"DumpFreeSpace: broken list links\\n\")",
          "old_line_content": "",
          "new_line_content": "\t\tfprintf(stderr, \"DumpFreeSpace: broken list links\\n\");",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": null,
          "new_api": "hash_search",
          "old_text": null,
          "new_text": "hash_search(FreeSpaceMap->relHash,\n\t\t\t\t\t\t\t\t\t\t (Pointer) &(fsmrel->key),\n\t\t\t\t\t\t\t\t\t\t HASH_REMOVE,\n\t\t\t\t\t\t\t\t\t\t &found)",
          "old_line_content": "{",
          "new_line_content": "\tresult = (FSMRelation *) hash_search(FreeSpaceMap->relHash,",
          "content_same": false
        },
        {
          "line": 1111,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr, \"DumpFreeSpace: %d rels in list, but numRels = %d\\n\",\n\t\t\t\trelNum, FreeSpaceMap->numRels)",
          "old_line_content": "",
          "new_line_content": "\t\tfprintf(stderr, \"DumpFreeSpace: %d rels in list, but numRels = %d\\n\",",
          "content_same": false
        },
        {
          "line": 604,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"FreeSpaceMap hashtable corrupted\")",
          "old_line_content": "\t\tfsmrel->nextRel = FreeSpaceMap->relList;",
          "new_line_content": "\t\telog(ERROR, \"FreeSpaceMap hashtable corrupted\");",
          "content_same": false
        },
        {
          "line": 1117,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr, \"DumpFreeSpace: %d chunks in list, but numFreeChunks = %d\\n\",\n\t\t\t\tnChunks, FreeSpaceMap->numFreeChunks)",
          "old_line_content": "",
          "new_line_content": "\t\tfprintf(stderr, \"DumpFreeSpace: %d chunks in list, but numFreeChunks = %d\\n\",",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": null,
          "new_api": "SpinAcquire",
          "old_text": null,
          "new_text": "SpinAcquire(FreeSpaceLock)",
          "old_line_content": "",
          "new_line_content": "\tSpinAcquire(FreeSpaceLock);",
          "content_same": false
        },
        {
          "line": 482,
          "old_api": null,
          "new_api": "delete_fsm_rel",
          "old_text": null,
          "new_text": "delete_fsm_rel(fsmrel)",
          "old_line_content": "static FSMRelation *",
          "new_line_content": "\t\t\tdelete_fsm_rel(fsmrel);",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": null,
          "new_api": "SpinRelease",
          "old_text": null,
          "new_text": "SpinRelease(FreeSpaceLock)",
          "old_line_content": "{",
          "new_line_content": "\tSpinRelease(FreeSpaceLock);",
          "content_same": false
        },
        {
          "line": 741,
          "old_api": null,
          "new_api": "lookup_fsm_page_entry",
          "old_text": null,
          "new_text": "lookup_fsm_page_entry(fsmrel, page, &chunk, &chunkRelIndex)",
          "old_line_content": "\t\t * our own threshold will increase, possibly meaning that we",
          "new_line_content": "\tif (lookup_fsm_page_entry(fsmrel, page, &chunk, &chunkRelIndex))",
          "content_same": false
        },
        {
          "line": 747,
          "old_api": null,
          "new_api": "delete_fsm_page_entry",
          "old_text": null,
          "new_text": "delete_fsm_page_entry(fsmrel, chunk, chunkRelIndex)",
          "old_line_content": "\t\twhile (spaceAvail >= fsmrel->threshold)",
          "new_line_content": "\t\t\tdelete_fsm_page_entry(fsmrel, chunk, chunkRelIndex);",
          "content_same": false
        },
        {
          "line": 879,
          "old_api": null,
          "new_api": "push_fsm_page_entry",
          "old_text": null,
          "new_text": "push_fsm_page_entry(page, spaceAvail, chunk, chunkRelIndex)",
          "old_line_content": "\tif (newChunk &&",
          "new_line_content": "\t\tpush_fsm_page_entry(page, spaceAvail, chunk, chunkRelIndex))",
          "content_same": false
        },
        {
          "line": 502,
          "old_api": null,
          "new_api": "hash_search",
          "old_text": null,
          "new_text": "hash_search(FreeSpaceMap->relHash,\n\t\t\t\t\t\t\t\t\t\t (Pointer) rel,\n\t\t\t\t\t\t\t\t\t\t HASH_FIND,\n\t\t\t\t\t\t\t\t\t\t &found)",
          "old_line_content": " * Lookup a relation in the hash table, creating an entry if not present.",
          "new_line_content": "\tfsmrel = (FSMRelation *) hash_search(FreeSpaceMap->relHash,",
          "content_same": false
        },
        {
          "line": 507,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"FreeSpaceMap hashtable corrupted\")",
          "old_line_content": "static FSMRelation *",
          "new_line_content": "\t\telog(ERROR, \"FreeSpaceMap hashtable corrupted\");",
          "content_same": false
        },
        {
          "line": 890,
          "old_api": null,
          "new_api": "compact_fsm_page_list",
          "old_text": null,
          "new_text": "compact_fsm_page_list(fsmrel)",
          "old_line_content": "",
          "new_line_content": "\tcompact_fsm_page_list(fsmrel);",
          "content_same": false
        },
        {
          "line": 763,
          "old_api": null,
          "new_api": "insert_fsm_page_entry",
          "old_text": null,
          "new_text": "insert_fsm_page_entry(fsmrel, page, spaceAvail,\n\t\t\t\t\t\t\t\t\t  chunk, chunkRelIndex)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tif (insert_fsm_page_entry(fsmrel, page, spaceAvail,",
          "content_same": false
        },
        {
          "line": 892,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"insert_fsm_page_entry: entry already exists!\")",
          "old_line_content": " * Auxiliary routine for insert_fsm_page_entry: try to push entries to the",
          "new_line_content": "\t\telog(ERROR, \"insert_fsm_page_entry: entry already exists!\");",
          "content_same": false
        },
        {
          "line": 1021,
          "old_api": null,
          "new_api": "free_chunk_chain",
          "old_text": null,
          "new_text": "free_chunk_chain(dstChunk)",
          "old_line_content": " * Acquire some free space by raising the thresholds of all FSMRelations.",
          "new_line_content": "\t\tfree_chunk_chain(dstChunk);",
          "content_same": false
        },
        {
          "line": 894,
          "old_api": null,
          "new_api": "push_fsm_page_entry",
          "old_text": null,
          "new_text": "push_fsm_page_entry(page, spaceAvail, newChunk, newChunkRelIndex)",
          "old_line_content": " * Note that the FSMRelation's own fields are not updated.",
          "new_line_content": "\t\tpush_fsm_page_entry(page, spaceAvail, newChunk, newChunkRelIndex))",
          "content_same": false
        },
        {
          "line": 767,
          "old_api": null,
          "new_api": "acquire_fsm_free_space",
          "old_text": null,
          "new_text": "acquire_fsm_free_space()",
          "old_line_content": "/*",
          "new_line_content": "\t\t\tacquire_fsm_free_space();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 514,
          "old_api": "hash_search",
          "new_api": null,
          "old_text": "hash_search(FreeSpaceMap->relHash,\n\t\t\t\t\t\t\t\t\t\t (Pointer) rel,\n\t\t\t\t\t\t\t\t\t\t HASH_ENTER,\n\t\t\t\t\t\t\t\t\t\t &found)",
          "new_text": null,
          "old_line_content": "\tfsmrel = (FSMRelation *) hash_search(FreeSpaceMap->relHash,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 519,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR, \"FreeSpaceMap hashtable corrupted\")",
          "new_text": null,
          "old_line_content": "\t\telog(ERROR, \"FreeSpaceMap hashtable corrupted\");",
          "new_line_content": " * causing it to move up in the priority list.",
          "content_same": false
        },
        {
          "line": 907,
          "old_api": "push_fsm_page_entry",
          "new_api": null,
          "old_text": "push_fsm_page_entry(chunk->pages[CHUNKPAGES-1],\n\t\t\t\t\t\t\t\t  chunk->bytes[CHUNKPAGES-1],\n\t\t\t\t\t\t\t\t  chunk->next, 0)",
          "new_text": null,
          "old_line_content": "\t\tif (! push_fsm_page_entry(chunk->pages[CHUNKPAGES-1],",
          "new_line_content": " * right to insert at chunk/chunkRelIndex.  Return TRUE if successful.",
          "content_same": false
        },
        {
          "line": 1038,
          "old_api": "compact_fsm_page_list",
          "new_api": null,
          "old_text": "compact_fsm_page_list(fsmrel)",
          "new_text": null,
          "old_line_content": "\t\tcompact_fsm_page_list(fsmrel);",
          "new_line_content": " * invocation; caller may repeat if necessary.",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": "delete_fsm_rel",
          "new_api": null,
          "old_text": "delete_fsm_rel(FreeSpaceMap->relListTail)",
          "new_text": null,
          "old_line_content": "\t\t\tdelete_fsm_rel(FreeSpaceMap->relListTail);",
          "new_line_content": "\tif (!fsmrel)",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": "link_fsm_rel_after",
          "new_api": null,
          "old_text": "link_fsm_rel_after(fsmrel, oldrel)",
          "new_text": null,
          "old_line_content": "\t\tlink_fsm_rel_after(fsmrel, oldrel);",
          "new_line_content": "\t\tfsmrel->nextPage = 0;",
          "content_same": false
        },
        {
          "line": 800,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(false)",
          "new_text": null,
          "old_line_content": "\t\t\tAssert(false);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 935,
          "old_api": "Assert",
          "new_api": null,
          "old_text": "Assert(chunk && chunkRelIndex >= 0 && chunkRelIndex < chunk->numPages)",
          "new_text": null,
          "old_line_content": "\tAssert(chunk && chunkRelIndex >= 0 && chunkRelIndex < chunk->numPages);",
          "new_line_content": "\tchunk->bytes[chunkRelIndex] = (ItemLength) spaceAvail;",
          "content_same": false
        },
        {
          "line": 1064,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr, \"Map %d: rel %u/%u useCount %d threshold %u nextPage %d\\nMap= \",\n\t\t\t\trelNum, fsmrel->key.tblNode, fsmrel->key.relNode,\n\t\t\t\tfsmrel->useCount, fsmrel->threshold, fsmrel->nextPage)",
          "new_text": null,
          "old_line_content": "\t\tfprintf(stderr, \"Map %d: rel %u/%u useCount %d threshold %u nextPage %d\\nMap= \",",
          "new_line_content": "void",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": "fsm_record_free_space",
          "new_api": null,
          "old_text": "fsm_record_free_space(fsmrel, pages[i], spaceAvail[i])",
          "new_text": null,
          "old_line_content": "\t\t\tfsm_record_free_space(fsmrel, pages[i], spaceAvail[i]);",
          "new_line_content": "\t\t * a page (a) has too little free space to be recorded, and (b)",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": "SpinRelease",
          "new_api": null,
          "old_text": "SpinRelease(FreeSpaceLock)",
          "new_text": null,
          "old_line_content": "\tSpinRelease(FreeSpaceLock);",
          "new_line_content": "\t\t * old entry above, and we aren't going to make a new one.",
          "content_same": false
        },
        {
          "line": 946,
          "old_api": "compact_fsm_page_list",
          "new_api": null,
          "old_text": "compact_fsm_page_list(fsmrel)",
          "new_text": null,
          "old_line_content": "\t\tcompact_fsm_page_list(fsmrel);",
          "new_line_content": "\tint\t\t\ti,",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": "unlink_fsm_rel",
          "new_api": null,
          "old_text": "unlink_fsm_rel(fsmrel)",
          "new_text": null,
          "old_line_content": "\t\t\tunlink_fsm_rel(fsmrel);",
          "new_line_content": "\t\t{",
          "content_same": false
        },
        {
          "line": 1076,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr, \" %u:%u\",\n\t\t\t\t\t\tchunk->pages[chunkRelIndex],\n\t\t\t\t\t\tchunk->bytes[chunkRelIndex])",
          "new_text": null,
          "old_line_content": "\t\t\t\tfprintf(stderr, \" %u:%u\",",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 566,
          "old_api": "link_fsm_rel_after",
          "new_api": null,
          "old_text": "link_fsm_rel_after(fsmrel, oldrel)",
          "new_text": null,
          "old_line_content": "\t\t\tlink_fsm_rel_after(fsmrel, oldrel);",
          "new_line_content": "\t\t\t\t oldrel != NULL;",
          "content_same": false
        },
        {
          "line": 1081,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr, \"\\n\")",
          "new_text": null,
          "old_line_content": "\t\tfprintf(stderr, \"\\n\");",
          "new_line_content": "\t\tnChunks = nPages = 0;",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": "SpinAcquire",
          "new_api": null,
          "old_text": "SpinAcquire(FreeSpaceLock)",
          "new_text": null,
          "old_line_content": "\tSpinAcquire(FreeSpaceLock);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": "lookup_fsm_rel",
          "new_api": null,
          "old_text": "lookup_fsm_rel(rel)",
          "new_text": null,
          "old_line_content": "\tfsmrel = lookup_fsm_rel(rel);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1084,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr, \"DumpFreeSpace: %d pages in rel, but numPages = %d\\n\",\n\t\t\t\t\tnPages, fsmrel->numPages)",
          "new_text": null,
          "old_line_content": "\t\t\tfprintf(stderr, \"DumpFreeSpace: %d pages in rel, but numPages = %d\\n\",",
          "new_line_content": "\t\t\tint\t\tnumPages = chunk->numPages;",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": "delete_fsm_rel",
          "new_api": null,
          "old_text": "delete_fsm_rel(fsmrel)",
          "new_text": null,
          "old_line_content": "\t\tdelete_fsm_rel(fsmrel);",
          "new_line_content": " * FreeSpaceMapForgetRel - forget all about a relation.",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": "SpinRelease",
          "new_api": null,
          "old_text": "SpinRelease(FreeSpaceLock)",
          "new_text": null,
          "old_line_content": "\tSpinRelease(FreeSpaceLock);",
          "new_line_content": " *",
          "content_same": false
        },
        {
          "line": 1087,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr, \"DumpFreeSpace: %d chunks in rel, but numChunks = %d\\n\",\n\t\t\t\t\tnChunks, fsmrel->numChunks)",
          "new_text": null,
          "old_line_content": "\t\t\tfprintf(stderr, \"DumpFreeSpace: %d chunks in rel, but numChunks = %d\\n\",",
          "new_line_content": "\t\t\tfor (chunkRelIndex = 0; chunkRelIndex < numPages; chunkRelIndex++)",
          "content_same": false
        },
        {
          "line": 582,
          "old_api": "free_chunk_chain",
          "new_api": null,
          "old_text": "free_chunk_chain(fsmrel->relChunks)",
          "new_text": null,
          "old_line_content": "\tfree_chunk_chain(fsmrel->relChunks);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": "unlink_fsm_rel",
          "new_api": null,
          "old_text": "unlink_fsm_rel(fsmrel)",
          "new_text": null,
          "old_line_content": "\tunlink_fsm_rel(fsmrel);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1094,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr, \"DumpFreeSpace: broken list links\\n\")",
          "new_text": null,
          "old_line_content": "\t\tfprintf(stderr, \"DumpFreeSpace: broken list links\\n\");",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": "hash_search",
          "new_api": null,
          "old_text": "hash_search(FreeSpaceMap->relHash,\n\t\t\t\t\t\t\t\t\t\t (Pointer) &(fsmrel->key),\n\t\t\t\t\t\t\t\t\t\t HASH_REMOVE,\n\t\t\t\t\t\t\t\t\t\t &found)",
          "new_text": null,
          "old_line_content": "\tresult = (FSMRelation *) hash_search(FreeSpaceMap->relHash,",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1097,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr, \"DumpFreeSpace: %d rels in list, but numRels = %d\\n\",\n\t\t\t\trelNum, FreeSpaceMap->numRels)",
          "new_text": null,
          "old_line_content": "\t\tfprintf(stderr, \"DumpFreeSpace: %d rels in list, but numRels = %d\\n\",",
          "new_line_content": "\t\tif (nPages != fsmrel->numPages)",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR, \"FreeSpaceMap hashtable corrupted\")",
          "new_text": null,
          "old_line_content": "\t\telog(ERROR, \"FreeSpaceMap hashtable corrupted\");",
          "new_line_content": "static void",
          "content_same": false
        },
        {
          "line": 1103,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr, \"DumpFreeSpace: %d chunks in list, but numFreeChunks = %d\\n\",\n\t\t\t\tnChunks, FreeSpaceMap->numFreeChunks)",
          "new_text": null,
          "old_line_content": "\t\tfprintf(stderr, \"DumpFreeSpace: %d chunks in list, but numFreeChunks = %d\\n\",",
          "new_line_content": "\t\tif (prevrel != fsmrel->priorRel)",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "SpinAcquire",
          "new_api": null,
          "old_text": "SpinAcquire(FreeSpaceLock)",
          "new_text": null,
          "old_line_content": "\tSpinAcquire(FreeSpaceLock);",
          "new_line_content": " * FreeSpaceMapForgetDatabase - forget all relations of a database.",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": "delete_fsm_rel",
          "new_api": null,
          "old_text": "delete_fsm_rel(fsmrel)",
          "new_text": null,
          "old_line_content": "\t\t\tdelete_fsm_rel(fsmrel);",
          "new_line_content": " * XXX when we implement tablespaces, target Oid will need to be tablespace",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": "SpinRelease",
          "new_api": null,
          "old_text": "SpinRelease(FreeSpaceLock)",
          "new_text": null,
          "old_line_content": "\tSpinRelease(FreeSpaceLock);",
          "new_line_content": " */",
          "content_same": false
        },
        {
          "line": 727,
          "old_api": "lookup_fsm_page_entry",
          "new_api": null,
          "old_text": "lookup_fsm_page_entry(fsmrel, page, &chunk, &chunkRelIndex)",
          "new_text": null,
          "old_line_content": "\tif (lookup_fsm_page_entry(fsmrel, page, &chunk, &chunkRelIndex))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 733,
          "old_api": "delete_fsm_page_entry",
          "new_api": null,
          "old_text": "delete_fsm_page_entry(fsmrel, chunk, chunkRelIndex)",
          "new_text": null,
          "old_line_content": "\t\t\tdelete_fsm_page_entry(fsmrel, chunk, chunkRelIndex);",
          "new_line_content": " * RecordAndGetPageWithFreeSpace.",
          "content_same": false
        },
        {
          "line": 865,
          "old_api": "push_fsm_page_entry",
          "new_api": null,
          "old_text": "push_fsm_page_entry(page, spaceAvail, chunk, chunkRelIndex)",
          "new_text": null,
          "old_line_content": "\t\tpush_fsm_page_entry(page, spaceAvail, chunk, chunkRelIndex))",
          "new_line_content": "\t\t\t\tpriorChunk = priorChunk->next;",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": "hash_search",
          "new_api": null,
          "old_text": "hash_search(FreeSpaceMap->relHash,\n\t\t\t\t\t\t\t\t\t\t (Pointer) rel,\n\t\t\t\t\t\t\t\t\t\t HASH_FIND,\n\t\t\t\t\t\t\t\t\t\t &found)",
          "new_text": null,
          "old_line_content": "\tfsmrel = (FSMRelation *) hash_search(FreeSpaceMap->relHash,",
          "new_line_content": "/*",
          "content_same": false
        },
        {
          "line": 876,
          "old_api": "compact_fsm_page_list",
          "new_api": null,
          "old_text": "compact_fsm_page_list(fsmrel)",
          "new_text": null,
          "old_line_content": "\tcompact_fsm_page_list(fsmrel);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 749,
          "old_api": "insert_fsm_page_entry",
          "new_api": null,
          "old_text": "insert_fsm_page_entry(fsmrel, page, spaceAvail,\n\t\t\t\t\t\t\t\t\t  chunk, chunkRelIndex)",
          "new_text": null,
          "old_line_content": "\t\t\tif (insert_fsm_page_entry(fsmrel, page, spaceAvail,",
          "new_line_content": "\telse",
          "content_same": false
        },
        {
          "line": 877,
          "old_api": "lookup_fsm_page_entry",
          "new_api": null,
          "old_text": "lookup_fsm_page_entry(fsmrel, page, &newChunk, &newChunkRelIndex)",
          "new_text": null,
          "old_line_content": "\tif (lookup_fsm_page_entry(fsmrel, page, &newChunk, &newChunkRelIndex))",
          "new_line_content": "\t/* Try to insert it the easy way, ie, just move down subsequent data */",
          "content_same": false
        },
        {
          "line": 878,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR, \"insert_fsm_page_entry: entry already exists!\")",
          "new_text": null,
          "old_line_content": "\t\telog(ERROR, \"insert_fsm_page_entry: entry already exists!\");",
          "new_line_content": "\tif (chunk &&",
          "content_same": false
        },
        {
          "line": 880,
          "old_api": "push_fsm_page_entry",
          "new_api": null,
          "old_text": "push_fsm_page_entry(page, spaceAvail, newChunk, newChunkRelIndex)",
          "new_text": null,
          "old_line_content": "\t\tpush_fsm_page_entry(page, spaceAvail, newChunk, newChunkRelIndex))",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 753,
          "old_api": "acquire_fsm_free_space",
          "new_api": null,
          "old_text": "acquire_fsm_free_space()",
          "new_text": null,
          "old_line_content": "\t\t\tacquire_fsm_free_space();",
          "new_line_content": "\t\t *",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR, \"FreeSpaceMap hashtable corrupted\")",
          "new_text": null,
          "old_line_content": "\t\telog(ERROR, \"FreeSpaceMap hashtable corrupted\");",
          "new_line_content": " * Lookup a relation in the hash table.  If not present, return NULL.",
          "content_same": false
        },
        {
          "line": 1007,
          "old_api": "free_chunk_chain",
          "new_api": null,
          "old_text": "free_chunk_chain(dstChunk)",
          "new_text": null,
          "old_line_content": "\t\tfree_chunk_chain(dstChunk);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 1015,
          "old_api": "free_chunk_chain",
          "new_api": null,
          "old_text": "free_chunk_chain(dstChunk->next)",
          "new_text": null,
          "old_line_content": "\t\tfree_chunk_chain(dstChunk->next);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 887,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR, \"insert_fsm_page_entry: failed to insert entry!\")",
          "new_text": null,
          "old_line_content": "\telog(ERROR, \"insert_fsm_page_entry: failed to insert entry!\");",
          "new_line_content": "\t * where the page entry needs to go.  Compact the list and try again.",
          "content_same": false
        },
        {
          "line": 760,
          "old_api": "lookup_fsm_page_entry",
          "new_api": null,
          "old_text": "lookup_fsm_page_entry(fsmrel, page,\n\t\t\t\t\t\t\t\t\t  &chunk, &chunkRelIndex)",
          "new_text": null,
          "old_line_content": "\t\t\tif (lookup_fsm_page_entry(fsmrel, page,",
          "new_line_content": "\t\t */",
          "content_same": false
        },
        {
          "line": 762,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR, \"fsm_record_free_space: unexpected match\")",
          "new_text": null,
          "old_line_content": "\t\t\t\telog(ERROR, \"fsm_record_free_space: unexpected match\");",
          "new_line_content": "\t\t{",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 0,
      "total_additions": 48,
      "total_deletions": 48,
      "total_api_changes": 96
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 16,
        "api_related_lines": 96,
        "non_api_lines": 13,
        "non_api_line_numbers": [
          422,
          423,
          425,
          11,
          427,
          428,
          431,
          432,
          433,
          434,
          435,
          436,
          438
        ]
      }
    },
    "api_calls_before": 78,
    "api_calls_after": 78,
    "diff_info": {
      "added_lines": 16,
      "removed_lines": 2,
      "total_diff_lines": 39
    }
  }
}