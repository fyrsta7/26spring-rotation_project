{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/7b15c0622e82c880917a5f3603ae3932f0d9a894",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/7b15c0622e82c880917a5f3603ae3932f0d9a894/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/7b15c0622e82c880917a5f3603ae3932f0d9a894/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/7b15c0622e82c880917a5f3603ae3932f0d9a894/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [],
      "additions": [
        {
          "line": 73,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "appended_strings.size()",
          "old_line_content": "",
          "new_line_content": "\tfor (uint32_t i = 0; i < appended_strings.size(); i++) {",
          "content_same": false
        },
        {
          "line": 65,
          "old_api": null,
          "new_api": "resize",
          "old_text": null,
          "new_text": "string.resize(string_length + 1)",
          "old_line_content": "",
          "new_line_content": "\tstring.resize(string_length + 1);",
          "content_same": false
        },
        {
          "line": 66,
          "old_api": null,
          "new_api": "ptrw",
          "old_text": null,
          "new_text": "string.ptrw()",
          "old_line_content": "\tint current_position = 0;",
          "new_line_content": "\tchar32_t *buffer = string.ptrw();",
          "content_same": false
        },
        {
          "line": 82,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "s.length()",
          "old_line_content": "\t\t\tgodot_string_elem++;",
          "new_line_content": "\t\t\tcurrent_position += s.length();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 64,
          "old_api": "memnew_arr",
          "new_api": null,
          "old_text": "memnew_arr(char32_t, string_length)",
          "new_text": null,
          "old_line_content": "\tchar32_t *buffer = memnew_arr(char32_t, string_length);",
          "new_line_content": "\tString string;",
          "content_same": false
        },
        {
          "line": 96,
          "old_api": "String",
          "new_api": null,
          "old_text": "String(buffer, string_length)",
          "new_text": null,
          "old_line_content": "\tString final_string = String(buffer, string_length);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 98,
          "old_api": "memdelete_arr",
          "new_api": null,
          "old_text": "memdelete_arr(buffer)",
          "new_text": null,
          "old_line_content": "\tmemdelete_arr(buffer);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 71,
          "old_api": "size",
          "new_api": null,
          "old_text": "appended_strings.size()",
          "new_text": null,
          "old_line_content": "\tfor (uint32_t i = 0; i < appended_strings.size(); i++) {",
          "new_line_content": "\tint c_string_elem = 0;",
          "content_same": false
        },
        {
          "line": 78,
          "old_api": "length",
          "new_api": null,
          "old_text": "s.length()",
          "new_text": null,
          "old_line_content": "\t\t\tmemcpy(buffer + current_position, s.ptr(), s.length() * sizeof(char32_t));",
          "new_line_content": "\t\t\tconst String &s = strings[godot_string_elem];",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 0,
      "total_additions": 4,
      "total_deletions": 5,
      "total_api_changes": 9
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 10,
        "api_related_lines": 9,
        "non_api_lines": 10,
        "non_api_line_numbers": [
          67,
          100,
          101,
          70,
          68,
          72,
          103,
          105,
          107,
          109
        ]
      }
    },
    "api_calls_before": 15,
    "api_calls_after": 14,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 7,
      "total_diff_lines": 52
    }
  }
}