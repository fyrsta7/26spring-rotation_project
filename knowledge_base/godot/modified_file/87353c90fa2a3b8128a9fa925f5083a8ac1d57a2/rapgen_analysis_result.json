{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/87353c90fa2a3b8128a9fa925f5083a8ac1d57a2",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/87353c90fa2a3b8128a9fa925f5083a8ac1d57a2/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/87353c90fa2a3b8128a9fa925f5083a8ac1d57a2/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/87353c90fa2a3b8128a9fa925f5083a8ac1d57a2/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 195,
          "old_api": "_poll",
          "new_api": "is_peer_connected",
          "old_text": "peer->_poll()",
          "new_text": "peer->is_peer_connected()",
          "old_line_content": "\t\tpeer->_poll();",
          "new_line_content": "\twhile (peer->running && peer->is_peer_connected()) {",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": "is_peer_connected",
          "new_api": "get_ticks_usec",
          "old_text": "peer->is_peer_connected()",
          "new_text": "OS::get_singleton()->get_ticks_usec()",
          "old_line_content": "\t\tif (!peer->is_peer_connected()) {",
          "new_line_content": "\t\tuint64_t ticks_usec = OS::get_singleton()->get_ticks_usec();",
          "content_same": false
        },
        {
          "line": 218,
          "old_api": "begins_with",
          "new_api": "get_status",
          "old_text": "p_uri.begins_with(\"tcp://\")",
          "new_text": "tcp_client->get_status()",
          "old_line_content": "\tERR_FAIL_COND_V(!p_uri.begins_with(\"tcp://\"), nullptr);",
          "new_line_content": "\t\tconnected = tcp_client->get_status() == StreamPeerTCP::STATUS_CONNECTED;",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": "find",
          "new_api": "begins_with",
          "old_text": "debug_host.find(\":\")",
          "new_text": "p_uri.begins_with(\"tcp://\")",
          "old_line_content": "\tif (debug_host.find(\":\") != -1) {",
          "new_line_content": "\tERR_FAIL_COND_V(!p_uri.begins_with(\"tcp://\"), nullptr);",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "substr",
          "new_api": "replace",
          "old_text": "debug_host.substr(sep_pos + 1).to_int()",
          "new_text": "p_uri.replace(\"tcp://\", \"\")",
          "old_line_content": "\t\tdebug_port = debug_host.substr(sep_pos + 1).to_int();",
          "new_line_content": "\tString debug_host = p_uri.replace(\"tcp://\", \"\");",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": "memnew",
          "new_api": "rfind",
          "old_text": "memnew(RemoteDebuggerPeerTCP)",
          "new_text": "debug_host.rfind(\":\")",
          "old_line_content": "\tRemoteDebuggerPeerTCP *peer = memnew(RemoteDebuggerPeerTCP);",
          "new_line_content": "\t\tint sep_pos = debug_host.rfind(\":\");",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": "connect_to_host",
          "new_api": "substr",
          "old_text": "peer->connect_to_host(debug_host, debug_port)",
          "new_text": "debug_host.substr(sep_pos + 1).to_int()",
          "old_line_content": "\tError err = peer->connect_to_host(debug_host, debug_port);",
          "new_line_content": "\t\tdebug_port = debug_host.substr(sep_pos + 1).to_int();",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 228,
          "old_api": null,
          "new_api": "find",
          "old_text": null,
          "new_text": "debug_host.find(\":\")",
          "old_line_content": "",
          "new_line_content": "\tif (debug_host.find(\":\") != -1) {",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": null,
          "new_api": "_poll",
          "old_text": null,
          "new_text": "peer->_poll()",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\tpeer->_poll();",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": null,
          "new_api": "is_peer_connected",
          "old_text": null,
          "new_text": "peer->is_peer_connected()",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tif (!peer->is_peer_connected()) {",
          "content_same": false
        },
        {
          "line": 231,
          "old_api": null,
          "new_api": "substr",
          "old_text": null,
          "new_text": "debug_host.substr(0, sep_pos)",
          "old_line_content": "\tif (err != OK) {",
          "new_line_content": "\t\tdebug_host = debug_host.substr(0, sep_pos);",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": null,
          "new_api": "get_ticks_usec",
          "old_text": null,
          "new_text": "OS::get_singleton()->get_ticks_usec()",
          "old_line_content": "}",
          "new_line_content": "\t\tticks_usec = OS::get_singleton()->get_ticks_usec() - ticks_usec;",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": null,
          "new_api": "memnew",
          "old_text": null,
          "new_text": "memnew(RemoteDebuggerPeerTCP)",
          "old_line_content": "\t}",
          "new_line_content": "\tRemoteDebuggerPeerTCP *peer = memnew(RemoteDebuggerPeerTCP);",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": null,
          "new_api": "delay_usec",
          "old_text": null,
          "new_text": "OS::get_singleton()->delay_usec(min_tick - ticks_usec)",
          "old_line_content": "void RemoteDebuggerPeerTCP::poll() {",
          "new_line_content": "\t\t\tOS::get_singleton()->delay_usec(min_tick - ticks_usec);",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": null,
          "new_api": "connect_to_host",
          "old_text": null,
          "new_text": "peer->connect_to_host(debug_host, debug_port)",
          "old_line_content": "\treturn peer;",
          "new_line_content": "\tError err = peer->connect_to_host(debug_host, debug_port);",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": null,
          "new_api": "memdelete",
          "old_text": null,
          "new_text": "memdelete(peer)",
          "old_line_content": "",
          "new_line_content": "\t\tmemdelete(peer);",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": null,
          "new_api": "_poll",
          "old_text": null,
          "new_text": "_poll()",
          "old_line_content": "\tif (connected) {",
          "new_line_content": "\t_poll();",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": null,
          "new_api": "GLOBAL_GET",
          "old_text": null,
          "new_text": "GLOBAL_GET(\"network/limits/debugger/max_queued_messages\")",
          "old_line_content": "",
          "new_line_content": "\tmax_queued_messages = (int)GLOBAL_GET(\"network/limits/debugger/max_queued_messages\");",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": null,
          "new_api": "_write_out",
          "old_text": null,
          "new_text": "_write_out()",
          "old_line_content": "",
          "new_line_content": "\t\t_write_out();",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": null,
          "new_api": "_read_in",
          "old_text": null,
          "new_text": "_read_in()",
          "old_line_content": "RemoteDebuggerPeer *RemoteDebuggerPeerTCP::create(const String &p_uri) {",
          "new_line_content": "\t\t_read_in();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 224,
          "old_api": "rfind",
          "new_api": null,
          "old_text": "debug_host.rfind(\":\")",
          "new_text": null,
          "old_line_content": "\t\tint sep_pos = debug_host.rfind(\":\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": "is_peer_connected",
          "new_api": null,
          "old_text": "peer->is_peer_connected()",
          "new_text": null,
          "old_line_content": "\twhile (peer->running && peer->is_peer_connected()) {",
          "new_line_content": "\tRemoteDebuggerPeerTCP *peer = (RemoteDebuggerPeerTCP *)p_ud;",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": "substr",
          "new_api": null,
          "old_text": "debug_host.substr(0, sep_pos)",
          "new_text": null,
          "old_line_content": "\t\tdebug_host = debug_host.substr(0, sep_pos);",
          "new_line_content": "\tuint16_t debug_port = 6007;",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": "poll",
          "new_api": null,
          "old_text": "peer->tcp_client->poll(NetSocket::POLL_TYPE_IN_OUT, 1)",
          "new_text": null,
          "old_line_content": "\t\tpeer->tcp_client->poll(NetSocket::POLL_TYPE_IN_OUT, 1);",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "memdelete",
          "new_api": null,
          "old_text": "memdelete(peer)",
          "new_text": null,
          "old_line_content": "\t\tmemdelete(peer);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "_poll",
          "new_api": null,
          "old_text": "_poll()",
          "new_text": null,
          "old_line_content": "\t_poll();",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": "GLOBAL_GET",
          "new_api": null,
          "old_text": "GLOBAL_GET(\"network/limits/debugger/max_queued_messages\")",
          "new_text": null,
          "old_line_content": "\tmax_queued_messages = (int)GLOBAL_GET(\"network/limits/debugger/max_queued_messages\");",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "_write_out",
          "new_api": null,
          "old_text": "_write_out()",
          "new_text": null,
          "old_line_content": "\t\t_write_out();",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "_read_in",
          "new_api": null,
          "old_text": "_read_in()",
          "new_text": null,
          "old_line_content": "\t\t_read_in();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": "get_status",
          "new_api": null,
          "old_text": "tcp_client->get_status()",
          "new_text": null,
          "old_line_content": "\t\tconnected = tcp_client->get_status() == StreamPeerTCP::STATUS_CONNECTED;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": "replace",
          "new_api": null,
          "old_text": "p_uri.replace(\"tcp://\", \"\")",
          "new_text": null,
          "old_line_content": "\tString debug_host = p_uri.replace(\"tcp://\", \"\");",
          "new_line_content": "}",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 7,
      "total_additions": 13,
      "total_deletions": 11,
      "total_api_changes": 31
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 31,
        "non_api_lines": 3,
        "non_api_line_numbers": [
          193,
          202,
          204
        ]
      }
    },
    "api_calls_before": 81,
    "api_calls_after": 86,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 1,
      "total_diff_lines": 25
    }
  }
}