{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/0dfbf4a5df27f5529a9d7a9b13976107bfdcd2b2",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/0dfbf4a5df27f5529a9d7a9b13976107bfdcd2b2/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/0dfbf4a5df27f5529a9d7a9b13976107bfdcd2b2/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/0dfbf4a5df27f5529a9d7a9b13976107bfdcd2b2/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 2914,
          "old_api": "RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 0, p_batch->tex_info->diffuse)",
          "new_api": "ptrw",
          "old_text": "RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 0, p_batch->tex_info->diffuse)",
          "new_text": "state.batch_texture_uniforms.ptrw()",
          "old_line_content": "\t\t\tstate.batch_texture_uniforms.write[0] = RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 0, p_batch->tex_info->diffuse);",
          "new_line_content": "\t\t\tRD::Uniform *uniform_ptrw = state.batch_texture_uniforms.ptrw();",
          "content_same": false
        },
        {
          "line": 2915,
          "old_api": "RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 1, p_batch->tex_info->normal)",
          "new_api": "RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 0, p_batch->tex_info->diffuse)",
          "old_text": "RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 1, p_batch->tex_info->normal)",
          "new_text": "RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 0, p_batch->tex_info->diffuse)",
          "old_line_content": "\t\t\tstate.batch_texture_uniforms.write[1] = RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 1, p_batch->tex_info->normal);",
          "new_line_content": "\t\t\tuniform_ptrw[0] = RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 0, p_batch->tex_info->diffuse);",
          "content_same": false
        },
        {
          "line": 2916,
          "old_api": "RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 2, p_batch->tex_info->specular)",
          "new_api": "RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 1, p_batch->tex_info->normal)",
          "old_text": "RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 2, p_batch->tex_info->specular)",
          "new_text": "RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 1, p_batch->tex_info->normal)",
          "old_line_content": "\t\t\tstate.batch_texture_uniforms.write[2] = RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 2, p_batch->tex_info->specular);",
          "new_line_content": "\t\t\tuniform_ptrw[1] = RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 1, p_batch->tex_info->normal);",
          "content_same": false
        },
        {
          "line": 2917,
          "old_api": "RD::Uniform(RD::UNIFORM_TYPE_SAMPLER, 3, p_batch->tex_info->sampler)",
          "new_api": "RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 2, p_batch->tex_info->specular)",
          "old_text": "RD::Uniform(RD::UNIFORM_TYPE_SAMPLER, 3, p_batch->tex_info->sampler)",
          "new_text": "RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 2, p_batch->tex_info->specular)",
          "old_line_content": "\t\t\tstate.batch_texture_uniforms.write[3] = RD::Uniform(RD::UNIFORM_TYPE_SAMPLER, 3, p_batch->tex_info->sampler);",
          "new_line_content": "\t\t\tuniform_ptrw[2] = RD::Uniform(RD::UNIFORM_TYPE_TEXTURE, 2, p_batch->tex_info->specular);",
          "content_same": false
        },
        {
          "line": 2918,
          "old_api": "RD::Uniform(RD::UNIFORM_TYPE_STORAGE_BUFFER, 4, state.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers[p_batch->instance_buffer_index])",
          "new_api": "RD::Uniform(RD::UNIFORM_TYPE_SAMPLER, 3, p_batch->tex_info->sampler)",
          "old_text": "RD::Uniform(RD::UNIFORM_TYPE_STORAGE_BUFFER, 4, state.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers[p_batch->instance_buffer_index])",
          "new_text": "RD::Uniform(RD::UNIFORM_TYPE_SAMPLER, 3, p_batch->tex_info->sampler)",
          "old_line_content": "\t\t\tstate.batch_texture_uniforms.write[4] = RD::Uniform(RD::UNIFORM_TYPE_STORAGE_BUFFER, 4, state.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers[p_batch->instance_buffer_index]);",
          "new_line_content": "\t\t\tuniform_ptrw[3] = RD::Uniform(RD::UNIFORM_TYPE_SAMPLER, 3, p_batch->tex_info->sampler);",
          "content_same": false
        },
        {
          "line": 2921,
          "old_api": "is_null",
          "new_api": "uniform_set_create",
          "old_text": "rid.is_null()",
          "new_text": "RD::get_singleton()->uniform_set_create(state.batch_texture_uniforms, shader.default_version_rd_shader, BATCH_UNIFORM_SET)",
          "old_line_content": "\t\t\tERR_FAIL_COND_MSG(rid.is_null(), \"Failed to create uniform set for batch.\");",
          "new_line_content": "\t\t\tRID rid = RD::get_singleton()->uniform_set_create(state.batch_texture_uniforms, shader.default_version_rd_shader, BATCH_UNIFORM_SET);",
          "content_same": false
        },
        {
          "line": 2950,
          "old_api": "draw_list_bind_render_pipeline",
          "new_api": "_get_pipeline_specialization_or_ubershader",
          "old_text": "RD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline)",
          "new_text": "_get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant)",
          "old_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline);",
          "new_line_content": "\t\t\tpipeline = _get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant);",
          "content_same": false
        },
        {
          "line": 2956,
          "old_api": "draw_list_bind_index_array",
          "new_api": "draw_list_set_push_constant",
          "old_text": "RD::get_singleton()->draw_list_bind_index_array(p_draw_list, shader.quad_index_array)",
          "new_text": "RD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant))",
          "old_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_index_array(p_draw_list, shader.quad_index_array);",
          "new_line_content": "\t\t\tRD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant));",
          "content_same": false
        },
        {
          "line": 2957,
          "old_api": "draw_list_draw",
          "new_api": "draw_list_bind_index_array",
          "old_text": "RD::get_singleton()->draw_list_draw(p_draw_list, true, p_batch->instance_count)",
          "new_text": "RD::get_singleton()->draw_list_bind_index_array(p_draw_list, shader.quad_index_array)",
          "old_line_content": "\t\t\tRD::get_singleton()->draw_list_draw(p_draw_list, true, p_batch->instance_count);",
          "new_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_index_array(p_draw_list, shader.quad_index_array);",
          "content_same": false
        },
        {
          "line": 2972,
          "old_api": "ERR_FAIL_NULL",
          "new_api": "getptr",
          "old_text": "ERR_FAIL_NULL(pb)",
          "new_text": "polygon_buffers.polygons.getptr(polygon->polygon.polygon_id)",
          "old_line_content": "\t\t\tERR_FAIL_NULL(pb);",
          "new_line_content": "\t\t\tPolygonBuffers *pb = polygon_buffers.polygons.getptr(polygon->polygon.polygon_id);",
          "content_same": false
        },
        {
          "line": 2976,
          "old_api": "draw_list_bind_render_pipeline",
          "new_api": "_get_pipeline_specialization_or_ubershader",
          "old_text": "RD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline)",
          "new_text": "_get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant)",
          "old_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline);",
          "new_line_content": "\t\t\tpipeline = _get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant);",
          "content_same": false
        },
        {
          "line": 2979,
          "old_api": "draw_list_bind_vertex_array",
          "new_api": "draw_list_set_push_constant",
          "old_text": "RD::get_singleton()->draw_list_bind_vertex_array(p_draw_list, pb->vertex_array)",
          "new_text": "RD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant))",
          "old_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_vertex_array(p_draw_list, pb->vertex_array);",
          "new_line_content": "\t\t\tRD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant));",
          "content_same": false
        },
        {
          "line": 2980,
          "old_api": "is_valid",
          "new_api": "draw_list_bind_vertex_array",
          "old_text": "pb->indices.is_valid()",
          "new_text": "RD::get_singleton()->draw_list_bind_vertex_array(p_draw_list, pb->vertex_array)",
          "old_line_content": "\t\t\tif (pb->indices.is_valid()) {",
          "new_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_vertex_array(p_draw_list, pb->vertex_array);",
          "content_same": false
        },
        {
          "line": 2981,
          "old_api": "draw_list_bind_index_array",
          "new_api": "is_valid",
          "old_text": "RD::get_singleton()->draw_list_bind_index_array(p_draw_list, pb->indices)",
          "new_text": "pb->indices.is_valid()",
          "old_line_content": "\t\t\t\tRD::get_singleton()->draw_list_bind_index_array(p_draw_list, pb->indices);",
          "new_line_content": "\t\t\tif (pb->indices.is_valid()) {",
          "content_same": false
        },
        {
          "line": 2998,
          "old_api": "draw_list_bind_render_pipeline",
          "new_api": "_get_pipeline_specialization_or_ubershader",
          "old_text": "RD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline)",
          "new_text": "_get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant)",
          "old_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline);",
          "new_line_content": "\t\t\tpipeline = _get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant);",
          "content_same": false
        },
        {
          "line": 3001,
          "old_api": "MIN",
          "new_api": "draw_list_set_push_constant",
          "old_text": "MIN(3u, primitive->point_count)",
          "new_text": "RD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant))",
          "old_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_index_array(p_draw_list, primitive_arrays.index_array[MIN(3u, primitive->point_count) - 1]);",
          "new_line_content": "\t\t\tRD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant));",
          "content_same": false
        },
        {
          "line": 3019,
          "old_api": "RendererRD::ParticlesStorage::get_singleton()",
          "new_api": "RendererRD::MeshStorage::get_singleton()",
          "old_text": "RendererRD::ParticlesStorage::get_singleton()",
          "new_text": "RendererRD::MeshStorage::get_singleton()",
          "old_line_content": "\t\t\tRendererRD::ParticlesStorage *particles_storage = RendererRD::ParticlesStorage::get_singleton();",
          "new_line_content": "\t\t\tRendererRD::MeshStorage *mesh_storage = RendererRD::MeshStorage::get_singleton();",
          "content_same": false
        },
        {
          "line": 3034,
          "old_api": "draw_list_bind_uniform_set",
          "new_api": "multimesh_get_2d_uniform_set",
          "old_text": "RD::get_singleton()->draw_list_bind_uniform_set(p_draw_list, uniform_set, TRANSFORMS_UNIFORM_SET)",
          "new_text": "mesh_storage->multimesh_get_2d_uniform_set(multimesh, shader.default_version_rd_shader, TRANSFORMS_UNIFORM_SET)",
          "old_line_content": "\t\t\t\tRD::get_singleton()->draw_list_bind_uniform_set(p_draw_list, uniform_set, TRANSFORMS_UNIFORM_SET);",
          "new_line_content": "\t\t\t\tRID uniform_set = mesh_storage->multimesh_get_2d_uniform_set(multimesh, shader.default_version_rd_shader, TRANSFORMS_UNIFORM_SET);",
          "content_same": false
        },
        {
          "line": 3041,
          "old_api": "particles_request_process",
          "new_api": "particles_get_mode",
          "old_text": "particles_storage->particles_request_process(particles)",
          "new_text": "particles_storage->particles_get_mode(particles)",
          "old_line_content": "\t\t\t\tparticles_storage->particles_request_process(particles);",
          "new_line_content": "\t\t\t\tERR_BREAK(particles_storage->particles_get_mode(particles) != RS::PARTICLES_MODE_2D);",
          "content_same": false
        },
        {
          "line": 3055,
          "old_api": "draw_list_bind_uniform_set",
          "new_api": "particles_get_instance_buffer_uniform_set",
          "old_text": "RD::get_singleton()->draw_list_bind_uniform_set(p_draw_list, uniform_set, TRANSFORMS_UNIFORM_SET)",
          "new_text": "particles_storage->particles_get_instance_buffer_uniform_set(pt->particles, shader.default_version_rd_shader, TRANSFORMS_UNIFORM_SET)",
          "old_line_content": "\t\t\t\tRD::get_singleton()->draw_list_bind_uniform_set(p_draw_list, uniform_set, TRANSFORMS_UNIFORM_SET);",
          "new_line_content": "\t\t\t\tRID uniform_set = particles_storage->particles_get_instance_buffer_uniform_set(pt->particles, shader.default_version_rd_shader, TRANSFORMS_UNIFORM_SET);",
          "content_same": false
        },
        {
          "line": 3068,
          "old_api": "ERR_CONTINUE",
          "new_api": "mesh_surface_get_primitive",
          "old_text": "ERR_CONTINUE(primitive < 0 || primitive >= RS::PRIMITIVE_MAX)",
          "new_text": "mesh_storage->mesh_surface_get_primitive(surface)",
          "old_line_content": "\t\t\t\tERR_CONTINUE(primitive < 0 || primitive >= RS::PRIMITIVE_MAX);",
          "new_line_content": "\t\t\t\tRS::PrimitiveType primitive = mesh_storage->mesh_surface_get_primitive(surface);",
          "content_same": false
        },
        {
          "line": 3076,
          "old_api": "draw_list_bind_render_pipeline",
          "new_api": "_get_pipeline_specialization_or_ubershader",
          "old_text": "RD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline)",
          "new_text": "_get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant, mesh_instance, surface, j, &vertex_array)",
          "old_line_content": "\t\t\t\tRD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline);",
          "new_line_content": "\t\t\t\tpipeline = _get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant, mesh_instance, surface, j, &vertex_array);",
          "content_same": false
        },
        {
          "line": 3083,
          "old_api": "draw_list_bind_index_array",
          "new_api": "is_valid",
          "old_text": "RD::get_singleton()->draw_list_bind_index_array(p_draw_list, index_array)",
          "new_text": "index_array.is_valid()",
          "old_line_content": "\t\t\t\t\tRD::get_singleton()->draw_list_bind_index_array(p_draw_list, index_array);",
          "new_line_content": "\t\t\t\tif (index_array.is_valid()) {",
          "content_same": false
        },
        {
          "line": 3087,
          "old_api": "is_valid",
          "new_api": "draw_list_bind_vertex_array",
          "old_text": "index_array.is_valid()",
          "new_text": "RD::get_singleton()->draw_list_bind_vertex_array(p_draw_list, vertex_array)",
          "old_line_content": "\t\t\t\tRD::get_singleton()->draw_list_draw(p_draw_list, index_array.is_valid(), p_batch->mesh_instance_count);",
          "new_line_content": "\t\t\t\tRD::get_singleton()->draw_list_bind_vertex_array(p_draw_list, vertex_array);",
          "content_same": false
        },
        {
          "line": 3106,
          "old_api": "Batch",
          "new_api": "size",
          "old_text": "Batch()",
          "new_text": "state.canvas_instance_batches.size()",
          "old_line_content": "\t\tstate.canvas_instance_batches.push_back(Batch());",
          "new_line_content": "\tif (state.canvas_instance_batches.size() == 0) {",
          "content_same": false
        },
        {
          "line": 3107,
          "old_api": "ptr",
          "new_api": "Batch",
          "old_text": "state.canvas_instance_batches.ptr()",
          "new_text": "Batch()",
          "old_line_content": "\t\treturn state.canvas_instance_batches.ptr();",
          "new_line_content": "\t\tstate.canvas_instance_batches.push_back(Batch());",
          "content_same": false
        },
        {
          "line": 3156,
          "old_api": "push_back",
          "new_api": "storage_buffer_create",
          "old_text": "state.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers.push_back(buf)",
          "new_text": "RD::get_singleton()->storage_buffer_create(state.max_instance_buffer_size)",
          "old_line_content": "\tstate.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers.push_back(buf);",
          "new_line_content": "\tRID buf = RD::get_singleton()->storage_buffer_create(state.max_instance_buffer_size);",
          "content_same": false
        },
        {
          "line": 3168,
          "old_api": "texture_repeat",
          "new_api": "texture_filter",
          "old_text": "p_state.texture_repeat()",
          "new_text": "p_state.texture_filter()",
          "old_line_content": "\t\t\t\t\tp_state.texture_repeat(),",
          "new_line_content": "\t\t\t\t\tp_state.texture_filter(),",
          "content_same": false
        },
        {
          "line": 3169,
          "old_api": "linear_colors",
          "new_api": "texture_repeat",
          "old_text": "p_state.linear_colors()",
          "new_text": "p_state.texture_repeat()",
          "old_line_content": "\t\t\t\t\tp_state.linear_colors(),",
          "new_line_content": "\t\t\t\t\tp_state.texture_repeat(),",
          "content_same": false
        },
        {
          "line": 3170,
          "old_api": "texture_is_data",
          "new_api": "linear_colors",
          "old_text": "p_state.texture_is_data()",
          "new_text": "p_state.linear_colors()",
          "old_line_content": "\t\t\t\t\tp_state.texture_is_data());",
          "new_line_content": "\t\t\t\t\tp_state.linear_colors(),",
          "content_same": false
        },
        {
          "line": 3173,
          "old_api": "_prepare_batch_texture_info",
          "new_api": "is_null",
          "old_text": "_prepare_batch_texture_info(default_canvas_texture, p_state, p_info)",
          "new_text": "info.is_null()",
          "old_line_content": "\t\t_prepare_batch_texture_info(default_canvas_texture, p_state, p_info);",
          "new_line_content": "\tif (info.is_null()) {",
          "content_same": false
        },
        {
          "line": 3206,
          "old_api": "shader_free",
          "new_api": "material_free",
          "old_text": "material_storage->shader_free(default_canvas_group_shader)",
          "new_text": "material_storage->material_free(default_canvas_group_material)",
          "old_line_content": "\tmaterial_storage->shader_free(default_canvas_group_shader);",
          "new_line_content": "\tmaterial_storage->material_free(default_canvas_group_material);",
          "content_same": false
        },
        {
          "line": 3209,
          "old_api": "shader_free",
          "new_api": "material_free",
          "old_text": "material_storage->shader_free(default_clip_children_shader)",
          "new_text": "material_storage->material_free(default_clip_children_material)",
          "old_line_content": "\tmaterial_storage->shader_free(default_clip_children_shader);",
          "new_line_content": "\tmaterial_storage->material_free(default_clip_children_material);",
          "content_same": false
        },
        {
          "line": 3213,
          "old_api": "free",
          "new_api": "is_valid",
          "old_text": "RD::get_singleton()->free(state.canvas_state_buffer)",
          "new_text": "state.canvas_state_buffer.is_valid()",
          "old_line_content": "\t\t\tRD::get_singleton()->free(state.canvas_state_buffer);",
          "new_line_content": "\t\tif (state.canvas_state_buffer.is_valid()) {",
          "content_same": false
        },
        {
          "line": 3217,
          "old_api": "free",
          "new_api": "memdelete_arr",
          "old_text": "RD::get_singleton()->free(state.lights_uniform_buffer)",
          "new_text": "memdelete_arr(state.light_uniforms)",
          "old_line_content": "\t\tRD::get_singleton()->free(state.lights_uniform_buffer);",
          "new_line_content": "\t\tmemdelete_arr(state.light_uniforms);",
          "content_same": false
        },
        {
          "line": 3235,
          "old_api": "free",
          "new_api": "is_valid",
          "old_text": "RD::get_singleton()->free(state.shadow_depth_texture)",
          "new_text": "state.shadow_fb.is_valid()",
          "old_line_content": "\t\tRD::get_singleton()->free(state.shadow_depth_texture);",
          "new_line_content": "\tif (state.shadow_fb.is_valid()) {",
          "content_same": false
        },
        {
          "line": 3242,
          "old_api": "free",
          "new_api": "size",
          "old_text": "RD::get_singleton()->free(state.canvas_instance_data_buffers[i].instance_buffers[j])",
          "new_text": "state.canvas_instance_data_buffers[i].instance_buffers.size()",
          "old_line_content": "\t\t\tRD::get_singleton()->free(state.canvas_instance_data_buffers[i].instance_buffers[j]);",
          "new_line_content": "\t\tfor (uint32_t j = 0; j < state.canvas_instance_data_buffers[i].instance_buffers.size(); j++) {",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 3073,
          "old_api": null,
          "new_api": "_primitive_type_to_render_primitive",
          "old_text": null,
          "new_text": "_primitive_type_to_render_primitive(primitive)",
          "old_line_content": "\t\t\t\tpipeline_key.vertex_format_id = RD::INVALID_FORMAT_ID;",
          "new_line_content": "\t\t\t\tpipeline_key.render_primitive = _primitive_type_to_render_primitive(primitive);",
          "content_same": false
        },
        {
          "line": 3203,
          "old_api": null,
          "new_api": "RendererRD::MaterialStorage::get_singleton()",
          "old_text": null,
          "new_text": "RendererRD::MaterialStorage::get_singleton()",
          "old_line_content": "\t//canvas state",
          "new_line_content": "\tRendererRD::MaterialStorage *material_storage = RendererRD::MaterialStorage::get_singleton();",
          "content_same": false
        },
        {
          "line": 3077,
          "old_api": null,
          "new_api": "draw_list_bind_render_pipeline",
          "old_text": null,
          "new_text": "RD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tRD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline);",
          "content_same": false
        },
        {
          "line": 2951,
          "old_api": null,
          "new_api": "draw_list_bind_render_pipeline",
          "old_text": null,
          "new_text": "RD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline)",
          "old_line_content": "\t\t\tif (p_batch->has_blend) {",
          "new_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline);",
          "content_same": false
        },
        {
          "line": 3079,
          "old_api": null,
          "new_api": "draw_list_set_push_constant",
          "old_text": null,
          "new_text": "RD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant))",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tRD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant));",
          "content_same": false
        },
        {
          "line": 2953,
          "old_api": null,
          "new_api": "draw_list_set_blend_constants",
          "old_text": null,
          "new_text": "RD::get_singleton()->draw_list_set_blend_constants(p_draw_list, p_batch->modulate)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tRD::get_singleton()->draw_list_set_blend_constants(p_draw_list, p_batch->modulate);",
          "content_same": false
        },
        {
          "line": 3081,
          "old_api": null,
          "new_api": "mesh_surface_get_index_array",
          "old_text": null,
          "new_text": "mesh_storage->mesh_surface_get_index_array(surface, 0)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tRID index_array = mesh_storage->mesh_surface_get_index_array(surface, 0);",
          "content_same": false
        },
        {
          "line": 3207,
          "old_api": null,
          "new_api": "shader_free",
          "old_text": null,
          "new_text": "material_storage->shader_free(default_canvas_group_shader)",
          "old_line_content": "",
          "new_line_content": "\tmaterial_storage->shader_free(default_canvas_group_shader);",
          "content_same": false
        },
        {
          "line": 3084,
          "old_api": null,
          "new_api": "draw_list_bind_index_array",
          "old_text": null,
          "new_text": "RD::get_singleton()->draw_list_bind_index_array(p_draw_list, index_array)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tRD::get_singleton()->draw_list_bind_index_array(p_draw_list, index_array);",
          "content_same": false
        },
        {
          "line": 3210,
          "old_api": null,
          "new_api": "shader_free",
          "old_text": null,
          "new_text": "material_storage->shader_free(default_clip_children_shader)",
          "old_line_content": "",
          "new_line_content": "\tmaterial_storage->shader_free(default_clip_children_shader);",
          "content_same": false
        },
        {
          "line": 2958,
          "old_api": null,
          "new_api": "draw_list_draw",
          "old_text": null,
          "new_text": "RD::get_singleton()->draw_list_draw(p_draw_list, true, p_batch->instance_count)",
          "old_line_content": "",
          "new_line_content": "\t\t\tRD::get_singleton()->draw_list_draw(p_draw_list, true, p_batch->instance_count);",
          "content_same": false
        },
        {
          "line": 3214,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "RD::get_singleton()->free(state.canvas_state_buffer)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tRD::get_singleton()->free(state.canvas_state_buffer);",
          "content_same": false
        },
        {
          "line": 3088,
          "old_api": null,
          "new_api": "is_valid",
          "old_text": null,
          "new_text": "index_array.is_valid()",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tRD::get_singleton()->draw_list_draw(p_draw_list, index_array.is_valid(), p_batch->mesh_instance_count);",
          "content_same": false
        },
        {
          "line": 3218,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "RD::get_singleton()->free(state.lights_uniform_buffer)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tRD::get_singleton()->free(state.lights_uniform_buffer);",
          "content_same": false
        },
        {
          "line": 3092,
          "old_api": null,
          "new_api": "mesh_surface_get_vertices_drawn_count",
          "old_text": null,
          "new_text": "mesh_storage->mesh_surface_get_vertices_drawn_count(surface)",
          "old_line_content": "\t\t\t\t\tr_render_info->info[RS::VIEWPORT_RENDER_INFO_TYPE_CANVAS][RS::VIEWPORT_RENDER_INFO_DRAW_CALLS_IN_FRAME]++;",
          "new_line_content": "\t\t\t\t\tr_render_info->info[RS::VIEWPORT_RENDER_INFO_TYPE_CANVAS][RS::VIEWPORT_RENDER_INFO_PRIMITIVES_IN_FRAME] += _indices_to_primitives(primitive, mesh_storage->mesh_surface_get_vertices_drawn_count(surface)) * p_batch->mesh_instance_count;",
          "content_same": false
        },
        {
          "line": 3223,
          "old_api": null,
          "new_api": "version_free",
          "old_text": null,
          "new_text": "shadow_render.shader.version_free(shadow_render.shader_version)",
          "old_line_content": "\t\t//this will also automatically clear all pipelines",
          "new_line_content": "\t\tshadow_render.shader.version_free(shadow_render.shader_version);",
          "content_same": false
        },
        {
          "line": 2968,
          "old_api": null,
          "new_api": "ERR_FAIL_NULL",
          "old_text": null,
          "new_text": "ERR_FAIL_NULL(p_batch->command)",
          "old_line_content": "",
          "new_line_content": "\t\t\tERR_FAIL_NULL(p_batch->command);",
          "content_same": false
        },
        {
          "line": 3225,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "RD::get_singleton()->free(state.shadow_sampler)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tRD::get_singleton()->free(state.shadow_sampler);",
          "content_same": false
        },
        {
          "line": 2970,
          "old_api": null,
          "new_api": "static_cast<const Item::CommandPolygon *>(p_batch->command)",
          "old_text": null,
          "new_text": "static_cast<const Item::CommandPolygon *>(p_batch->command)",
          "old_line_content": "",
          "new_line_content": "\t\t\tconst Item::CommandPolygon *polygon = static_cast<const Item::CommandPolygon *>(p_batch->command);",
          "content_same": false
        },
        {
          "line": 2973,
          "old_api": null,
          "new_api": "ERR_FAIL_NULL",
          "old_text": null,
          "new_text": "ERR_FAIL_NULL(pb)",
          "old_line_content": "",
          "new_line_content": "\t\t\tERR_FAIL_NULL(pb);",
          "content_same": false
        },
        {
          "line": 3231,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "RD::get_singleton()->free(shader.quad_index_buffer)",
          "old_line_content": "\t\t//primitives are erase by dependency",
          "new_line_content": "\t\tRD::get_singleton()->free(shader.quad_index_buffer);",
          "content_same": false
        },
        {
          "line": 2977,
          "old_api": null,
          "new_api": "draw_list_bind_render_pipeline",
          "old_text": null,
          "new_text": "RD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline)",
          "old_line_content": "",
          "new_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline);",
          "content_same": false
        },
        {
          "line": 3108,
          "old_api": null,
          "new_api": "ptr",
          "old_text": null,
          "new_text": "state.canvas_instance_batches.ptr()",
          "old_line_content": "\t}",
          "new_line_content": "\t\treturn state.canvas_instance_batches.ptr();",
          "content_same": false
        },
        {
          "line": 3236,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "RD::get_singleton()->free(state.shadow_depth_texture)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tRD::get_singleton()->free(state.shadow_depth_texture);",
          "content_same": false
        },
        {
          "line": 2982,
          "old_api": null,
          "new_api": "draw_list_bind_index_array",
          "old_text": null,
          "new_text": "RD::get_singleton()->draw_list_bind_index_array(p_draw_list, pb->indices)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tRD::get_singleton()->draw_list_bind_index_array(p_draw_list, pb->indices);",
          "content_same": false
        },
        {
          "line": 3238,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "RD::get_singleton()->free(state.shadow_texture)",
          "old_line_content": "",
          "new_line_content": "\tRD::get_singleton()->free(state.shadow_texture);",
          "content_same": false
        },
        {
          "line": 3240,
          "old_api": null,
          "new_api": "memdelete_arr",
          "old_text": null,
          "new_text": "memdelete_arr(state.instance_data_array)",
          "old_line_content": "\tfor (uint32_t i = 0; i < BATCH_DATA_BUFFER_COUNT; i++) {",
          "new_line_content": "\tmemdelete_arr(state.instance_data_array);",
          "content_same": false
        },
        {
          "line": 2985,
          "old_api": null,
          "new_api": "is_valid",
          "old_text": null,
          "new_text": "pb->indices.is_valid()",
          "old_line_content": "\t\t\tif (r_render_info) {",
          "new_line_content": "\t\t\tRD::get_singleton()->draw_list_draw(p_draw_list, pb->indices.is_valid());",
          "content_same": false
        },
        {
          "line": 3243,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "RD::get_singleton()->free(state.canvas_instance_data_buffers[i].instance_buffers[j])",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tRD::get_singleton()->free(state.canvas_instance_data_buffers[i].instance_buffers[j]);",
          "content_same": false
        },
        {
          "line": 2988,
          "old_api": null,
          "new_api": "_indices_to_primitives",
          "old_text": null,
          "new_text": "_indices_to_primitives(polygon->primitive, pb->primitive_count)",
          "old_line_content": "\t\t\t\tr_render_info->info[RS::VIEWPORT_RENDER_INFO_TYPE_CANVAS][RS::VIEWPORT_RENDER_INFO_DRAW_CALLS_IN_FRAME]++;",
          "new_line_content": "\t\t\t\tr_render_info->info[RS::VIEWPORT_RENDER_INFO_TYPE_CANVAS][RS::VIEWPORT_RENDER_INFO_PRIMITIVES_IN_FRAME] += _indices_to_primitives(polygon->primitive, pb->primitive_count);",
          "content_same": false
        },
        {
          "line": 3247,
          "old_api": null,
          "new_api": "canvas_texture_free",
          "old_text": null,
          "new_text": "RendererRD::TextureStorage::get_singleton()->canvas_texture_free(default_canvas_texture)",
          "old_line_content": "\t//pipelines don't need freeing, they are all gone after shaders are gone",
          "new_line_content": "\tRendererRD::TextureStorage::get_singleton()->canvas_texture_free(default_canvas_texture);",
          "content_same": false
        },
        {
          "line": 2994,
          "old_api": null,
          "new_api": "ERR_FAIL_NULL",
          "old_text": null,
          "new_text": "ERR_FAIL_NULL(p_batch->command)",
          "old_line_content": "",
          "new_line_content": "\t\t\tERR_FAIL_NULL(p_batch->command);",
          "content_same": false
        },
        {
          "line": 3123,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "state.canvas_instance_batches.push_back(new_batch)",
          "old_line_content": "\treturn &state.canvas_instance_batches[state.current_batch_index];",
          "new_line_content": "\tstate.canvas_instance_batches.push_back(new_batch);",
          "content_same": false
        },
        {
          "line": 2996,
          "old_api": null,
          "new_api": "static_cast<const Item::CommandPrimitive *>(p_batch->command)",
          "old_text": null,
          "new_text": "static_cast<const Item::CommandPrimitive *>(p_batch->command)",
          "old_line_content": "",
          "new_line_content": "\t\t\tconst Item::CommandPrimitive *primitive = static_cast<const Item::CommandPrimitive *>(p_batch->command);",
          "content_same": false
        },
        {
          "line": 3250,
          "old_api": null,
          "new_api": "memdelete",
          "old_text": null,
          "new_text": "memdelete(shader.default_version_data)",
          "old_line_content": "}",
          "new_line_content": "\tmemdelete(shader.default_version_data);",
          "content_same": false
        },
        {
          "line": 2999,
          "old_api": null,
          "new_api": "draw_list_bind_render_pipeline",
          "old_text": null,
          "new_text": "RD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline)",
          "old_line_content": "",
          "new_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_render_pipeline(p_draw_list, pipeline);",
          "content_same": false
        },
        {
          "line": 3002,
          "old_api": null,
          "new_api": "MIN",
          "old_text": null,
          "new_text": "MIN(3u, primitive->point_count)",
          "old_line_content": "\t\t\tuint32_t instance_count = p_batch->instance_count;",
          "new_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_index_array(p_draw_list, primitive_arrays.index_array[MIN(3u, primitive->point_count) - 1]);",
          "content_same": false
        },
        {
          "line": 3004,
          "old_api": null,
          "new_api": "draw_list_draw",
          "old_text": null,
          "new_text": "RD::get_singleton()->draw_list_draw(p_draw_list, true, instance_count)",
          "old_line_content": "",
          "new_line_content": "\t\t\tRD::get_singleton()->draw_list_draw(p_draw_list, true, instance_count);",
          "content_same": false
        },
        {
          "line": 3133,
          "old_api": null,
          "new_api": "buffer_update",
          "old_text": null,
          "new_text": "RD::get_singleton()->buffer_update(\n\t\t\t\tstate.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers[state.current_instance_buffer_index],\n\t\t\t\tstate.last_instance_index * sizeof(InstanceData),\n\t\t\t\tr_index * sizeof(InstanceData),\n\t\t\t\tstate.instance_data_array)",
          "old_line_content": "\t\t\t\tstate.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers[state.current_instance_buffer_index],",
          "new_line_content": "\t\tRD::get_singleton()->buffer_update(",
          "content_same": false
        },
        {
          "line": 3009,
          "old_api": null,
          "new_api": "_indices_to_primitives",
          "old_text": null,
          "new_text": "_indices_to_primitives(rs_primitive[p_batch->primitive_points], p_batch->primitive_points)",
          "old_line_content": "\t\t\t\tr_render_info->info[RS::VIEWPORT_RENDER_INFO_TYPE_CANVAS][RS::VIEWPORT_RENDER_INFO_DRAW_CALLS_IN_FRAME]++;",
          "new_line_content": "\t\t\t\tr_render_info->info[RS::VIEWPORT_RENDER_INFO_TYPE_CANVAS][RS::VIEWPORT_RENDER_INFO_PRIMITIVES_IN_FRAME] += _indices_to_primitives(rs_primitive[p_batch->primitive_points], p_batch->primitive_points) * instance_count;",
          "content_same": false
        },
        {
          "line": 3138,
          "old_api": null,
          "new_api": "_allocate_instance_buffer",
          "old_text": null,
          "new_text": "_allocate_instance_buffer()",
          "old_line_content": "\t\tr_index = 0;",
          "new_line_content": "\t\t_allocate_instance_buffer();",
          "content_same": false
        },
        {
          "line": 3142,
          "old_api": null,
          "new_api": "_new_batch",
          "old_text": null,
          "new_text": "_new_batch(r_batch_broken)",
          "old_line_content": "\t\tr_current_batch->start = 0;",
          "new_line_content": "\t\tr_current_batch = _new_batch(r_batch_broken);",
          "content_same": false
        },
        {
          "line": 3017,
          "old_api": null,
          "new_api": "ERR_FAIL_NULL",
          "old_text": null,
          "new_text": "ERR_FAIL_NULL(p_batch->command)",
          "old_line_content": "",
          "new_line_content": "\t\t\tERR_FAIL_NULL(p_batch->command);",
          "content_same": false
        },
        {
          "line": 3020,
          "old_api": null,
          "new_api": "RendererRD::ParticlesStorage::get_singleton()",
          "old_text": null,
          "new_text": "RendererRD::ParticlesStorage::get_singleton()",
          "old_line_content": "",
          "new_line_content": "\t\t\tRendererRD::ParticlesStorage *particles_storage = RendererRD::ParticlesStorage::get_singleton();",
          "content_same": false
        },
        {
          "line": 3150,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "state.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers.size()",
          "old_line_content": "\t\t// We already allocated another buffer in a previous frame, so we can just use it.",
          "new_line_content": "\tif (state.current_instance_buffer_index < state.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers.size()) {",
          "content_same": false
        },
        {
          "line": 3026,
          "old_api": null,
          "new_api": "static_cast<const Item::CommandMesh *>(p_batch->command)",
          "old_text": null,
          "new_text": "static_cast<const Item::CommandMesh *>(p_batch->command)",
          "old_line_content": "\t\t\t\tmesh = m->mesh;",
          "new_line_content": "\t\t\t\tconst Item::CommandMesh *m = static_cast<const Item::CommandMesh *>(p_batch->command);",
          "content_same": false
        },
        {
          "line": 3157,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "state.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers.push_back(buf)",
          "old_line_content": "}",
          "new_line_content": "\tstate.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers.push_back(buf);",
          "content_same": false
        },
        {
          "line": 3030,
          "old_api": null,
          "new_api": "static_cast<const Item::CommandMultiMesh *>(p_batch->command)",
          "old_text": null,
          "new_text": "static_cast<const Item::CommandMultiMesh *>(p_batch->command)",
          "old_line_content": "\t\t\t\tRID multimesh = mm->multimesh;",
          "new_line_content": "\t\t\t\tconst Item::CommandMultiMesh *mm = static_cast<const Item::CommandMultiMesh *>(p_batch->command);",
          "content_same": false
        },
        {
          "line": 3032,
          "old_api": null,
          "new_api": "multimesh_get_mesh",
          "old_text": null,
          "new_text": "mesh_storage->multimesh_get_mesh(multimesh)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tmesh = mesh_storage->multimesh_get_mesh(multimesh);",
          "content_same": false
        },
        {
          "line": 3161,
          "old_api": null,
          "new_api": "is_null",
          "old_text": null,
          "new_text": "p_texture.is_null()",
          "old_line_content": "\t\tp_texture = default_canvas_texture;",
          "new_line_content": "\tif (p_texture.is_null()) {",
          "content_same": false
        },
        {
          "line": 3035,
          "old_api": null,
          "new_api": "draw_list_bind_uniform_set",
          "old_text": null,
          "new_text": "RD::get_singleton()->draw_list_bind_uniform_set(p_draw_list, uniform_set, TRANSFORMS_UNIFORM_SET)",
          "old_line_content": "\t\t\t} else if (p_batch->command_type == Item::Command::TYPE_PARTICLES) {",
          "new_line_content": "\t\t\t\tRD::get_singleton()->draw_list_bind_uniform_set(p_draw_list, uniform_set, TRANSFORMS_UNIFORM_SET);",
          "content_same": false
        },
        {
          "line": 3037,
          "old_api": null,
          "new_api": "static_cast<const Item::CommandParticles *>(p_batch->command)",
          "old_text": null,
          "new_text": "static_cast<const Item::CommandParticles *>(p_batch->command)",
          "old_line_content": "\t\t\t\tRID particles = pt->particles;",
          "new_line_content": "\t\t\t\tconst Item::CommandParticles *pt = static_cast<const Item::CommandParticles *>(p_batch->command);",
          "content_same": false
        },
        {
          "line": 3166,
          "old_api": null,
          "new_api": "texture_filter",
          "old_text": null,
          "new_text": "RendererRD::TextureStorage::get_singleton()->canvas_texture_get_info(\n\t\t\t\t\tp_texture,\n\t\t\t\t\tp_state.texture_filter(),\n\t\t\t\t\tp_state.texture_repeat(),\n\t\t\t\t\tp_state.linear_colors(),\n\t\t\t\t\tp_state.texture_is_data())",
          "old_line_content": "\t\t\t\t\tp_texture,",
          "new_line_content": "\t\t\tRendererRD::TextureStorage::get_singleton()->canvas_texture_get_info(",
          "content_same": false
        },
        {
          "line": 3039,
          "old_api": null,
          "new_api": "particles_get_draw_pass_mesh",
          "old_text": null,
          "new_text": "particles_storage->particles_get_draw_pass_mesh(particles, 0)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tmesh = particles_storage->particles_get_draw_pass_mesh(particles, 0);",
          "content_same": false
        },
        {
          "line": 3042,
          "old_api": null,
          "new_api": "particles_request_process",
          "old_text": null,
          "new_text": "particles_storage->particles_request_process(particles)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tparticles_storage->particles_request_process(particles);",
          "content_same": false
        },
        {
          "line": 3171,
          "old_api": null,
          "new_api": "texture_is_data",
          "old_text": null,
          "new_text": "p_state.texture_is_data()",
          "old_line_content": "\t// something odd happened",
          "new_line_content": "\t\t\t\t\tp_state.texture_is_data());",
          "content_same": false
        },
        {
          "line": 3044,
          "old_api": null,
          "new_api": "particles_is_inactive",
          "old_text": null,
          "new_text": "particles_storage->particles_is_inactive(particles)",
          "old_line_content": "\t\t\t\t\tbreak;",
          "new_line_content": "\t\t\t\tif (particles_storage->particles_is_inactive(particles)) {",
          "content_same": false
        },
        {
          "line": 3174,
          "old_api": null,
          "new_api": "_prepare_batch_texture_info",
          "old_text": null,
          "new_text": "_prepare_batch_texture_info(default_canvas_texture, p_state, p_info)",
          "old_line_content": "\t\treturn;",
          "new_line_content": "\t\t_prepare_batch_texture_info(default_canvas_texture, p_state, p_info);",
          "content_same": false
        },
        {
          "line": 2919,
          "old_api": null,
          "new_api": "RD::Uniform(RD::UNIFORM_TYPE_STORAGE_BUFFER, 4, state.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers[p_batch->instance_buffer_index])",
          "old_text": null,
          "new_text": "RD::Uniform(RD::UNIFORM_TYPE_STORAGE_BUFFER, 4, state.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers[p_batch->instance_buffer_index])",
          "old_line_content": "",
          "new_line_content": "\t\t\tuniform_ptrw[4] = RD::Uniform(RD::UNIFORM_TYPE_STORAGE_BUFFER, 4, state.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers[p_batch->instance_buffer_index]);",
          "content_same": false
        },
        {
          "line": 3048,
          "old_api": null,
          "new_api": "RenderingServerDefault::redraw_request()",
          "old_text": null,
          "new_text": "RenderingServerDefault::redraw_request()",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tRenderingServerDefault::redraw_request(); // Active particles means redraw request.",
          "content_same": false
        },
        {
          "line": 2922,
          "old_api": null,
          "new_api": "is_null",
          "old_text": null,
          "new_text": "rid.is_null()",
          "old_line_content": "",
          "new_line_content": "\t\t\tERR_FAIL_COND_MSG(rid.is_null(), \"Failed to create uniform set for batch.\");",
          "content_same": false
        },
        {
          "line": 3050,
          "old_api": null,
          "new_api": "particles_get_draw_passes",
          "old_text": null,
          "new_text": "particles_storage->particles_get_draw_passes(particles)",
          "old_line_content": "\t\t\t\tif (dpc == 0) {",
          "new_line_content": "\t\t\t\tint dpc = particles_storage->particles_get_draw_passes(particles);",
          "content_same": false
        },
        {
          "line": 2924,
          "old_api": null,
          "new_api": "insert",
          "old_text": null,
          "new_text": "rid_set_to_uniform_set.insert(key, rid)",
          "old_line_content": "\t\t\tuniform_set = &iter->data;",
          "new_line_content": "\t\t\tconst RIDCache::Pair *iter = rid_set_to_uniform_set.insert(key, rid);",
          "content_same": false
        },
        {
          "line": 2926,
          "old_api": null,
          "new_api": "uniform_set_set_invalidation_callback",
          "old_text": null,
          "new_text": "RD::get_singleton()->uniform_set_set_invalidation_callback(rid, RendererCanvasRenderRD::_uniform_set_invalidation_callback, (void *)&iter->key)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tRD::get_singleton()->uniform_set_set_invalidation_callback(rid, RendererCanvasRenderRD::_uniform_set_invalidation_callback, (void *)&iter->key);",
          "content_same": false
        },
        {
          "line": 3056,
          "old_api": null,
          "new_api": "draw_list_bind_uniform_set",
          "old_text": null,
          "new_text": "RD::get_singleton()->draw_list_bind_uniform_set(p_draw_list, uniform_set, TRANSFORMS_UNIFORM_SET)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tRD::get_singleton()->draw_list_bind_uniform_set(p_draw_list, uniform_set, TRANSFORMS_UNIFORM_SET);",
          "content_same": false
        },
        {
          "line": 2931,
          "old_api": null,
          "new_api": "draw_list_bind_uniform_set",
          "old_text": null,
          "new_text": "RD::get_singleton()->draw_list_bind_uniform_set(p_draw_list, *uniform_set, BATCH_UNIFORM_SET)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_uniform_set(p_draw_list, *uniform_set, BATCH_UNIFORM_SET);",
          "content_same": false
        },
        {
          "line": 3059,
          "old_api": null,
          "new_api": "is_null",
          "old_text": null,
          "new_text": "mesh.is_null()",
          "old_line_content": "\t\t\t\tbreak;",
          "new_line_content": "\t\t\tif (mesh.is_null()) {",
          "content_same": false
        },
        {
          "line": 3063,
          "old_api": null,
          "new_api": "mesh_get_surface_count",
          "old_text": null,
          "new_text": "mesh_storage->mesh_get_surface_count(mesh)",
          "old_line_content": "",
          "new_line_content": "\t\t\tuint32_t surf_count = mesh_storage->mesh_get_surface_count(mesh);",
          "content_same": false
        },
        {
          "line": 3066,
          "old_api": null,
          "new_api": "mesh_get_surface",
          "old_text": null,
          "new_text": "mesh_storage->mesh_get_surface(mesh, j)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tvoid *surface = mesh_storage->mesh_get_surface(mesh, j);",
          "content_same": false
        },
        {
          "line": 3196,
          "old_api": null,
          "new_api": "CLAMP",
          "old_text": null,
          "new_text": "CLAMP(info.specular_color.r * 255.0, 0.0, 255.0)",
          "old_line_content": "\tp_info->specular_shininess = uint32_t(a) << 24 | uint32_t(b) << 16 | uint32_t(g) << 8 | uint32_t(r);",
          "new_line_content": "\tuint8_t r = uint8_t(CLAMP(info.specular_color.r * 255.0, 0.0, 255.0));",
          "content_same": false
        },
        {
          "line": 3069,
          "old_api": null,
          "new_api": "ERR_CONTINUE",
          "old_text": null,
          "new_text": "ERR_CONTINUE(primitive < 0 || primitive >= RS::PRIMITIVE_MAX)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tERR_CONTINUE(primitive < 0 || primitive >= RS::PRIMITIVE_MAX);",
          "content_same": false
        },
        {
          "line": 3199,
          "old_api": null,
          "new_api": "Vector2",
          "old_text": null,
          "new_text": "Vector2(1.0 / float(info.size.width), 1.0 / float(info.size.height))",
          "old_line_content": "}",
          "new_line_content": "\tp_info->texpixel_size = Vector2(1.0 / float(info.size.width), 1.0 / float(info.size.height));",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 3072,
          "old_api": "_primitive_type_to_render_primitive",
          "new_api": null,
          "old_text": "_primitive_type_to_render_primitive(primitive)",
          "new_text": null,
          "old_line_content": "\t\t\t\tpipeline_key.render_primitive = _primitive_type_to_render_primitive(primitive);",
          "new_line_content": "\t\t\t\tpipeline_key.variant = primitive == RS::PRIMITIVE_POINTS ? SHADER_VARIANT_ATTRIBUTES_POINTS : SHADER_VARIANT_ATTRIBUTES;",
          "content_same": false
        },
        {
          "line": 3202,
          "old_api": "RendererRD::MaterialStorage::get_singleton()",
          "new_api": null,
          "old_text": "RendererRD::MaterialStorage::get_singleton()",
          "new_text": null,
          "old_line_content": "\tRendererRD::MaterialStorage *material_storage = RendererRD::MaterialStorage::get_singleton();",
          "new_line_content": "RendererCanvasRenderRD::~RendererCanvasRenderRD() {",
          "content_same": false
        },
        {
          "line": 3075,
          "old_api": "_get_pipeline_specialization_or_ubershader",
          "new_api": null,
          "old_text": "_get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant, mesh_instance, surface, j, &vertex_array)",
          "new_text": null,
          "old_line_content": "\t\t\t\tpipeline = _get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant, mesh_instance, surface, j, &vertex_array);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2949,
          "old_api": "_get_pipeline_specialization_or_ubershader",
          "new_api": null,
          "old_text": "_get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant)",
          "new_text": null,
          "old_line_content": "\t\t\tpipeline = _get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant);",
          "new_line_content": "\t\tcase Item::Command::TYPE_NINEPATCH: {",
          "content_same": false
        },
        {
          "line": 3078,
          "old_api": "draw_list_set_push_constant",
          "new_api": null,
          "old_text": "RD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant))",
          "new_text": null,
          "old_line_content": "\t\t\t\tRD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3205,
          "old_api": "material_free",
          "new_api": null,
          "old_text": "material_storage->material_free(default_canvas_group_material)",
          "new_text": null,
          "old_line_content": "\tmaterial_storage->material_free(default_canvas_group_material);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2952,
          "old_api": "draw_list_set_blend_constants",
          "new_api": null,
          "old_text": "RD::get_singleton()->draw_list_set_blend_constants(p_draw_list, p_batch->modulate)",
          "new_text": null,
          "old_line_content": "\t\t\t\tRD::get_singleton()->draw_list_set_blend_constants(p_draw_list, p_batch->modulate);",
          "new_line_content": "\t\t\tif (p_batch->has_blend) {",
          "content_same": false
        },
        {
          "line": 3080,
          "old_api": "mesh_surface_get_index_array",
          "new_api": null,
          "old_text": "mesh_storage->mesh_surface_get_index_array(surface, 0)",
          "new_text": null,
          "old_line_content": "\t\t\t\tRID index_array = mesh_storage->mesh_surface_get_index_array(surface, 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3082,
          "old_api": "is_valid",
          "new_api": null,
          "old_text": "index_array.is_valid()",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (index_array.is_valid()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2955,
          "old_api": "draw_list_set_push_constant",
          "new_api": null,
          "old_text": "RD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant))",
          "new_text": null,
          "old_line_content": "\t\t\tRD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3208,
          "old_api": "material_free",
          "new_api": null,
          "old_text": "material_storage->material_free(default_clip_children_material)",
          "new_text": null,
          "old_line_content": "\tmaterial_storage->material_free(default_clip_children_material);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3212,
          "old_api": "is_valid",
          "new_api": null,
          "old_text": "state.canvas_state_buffer.is_valid()",
          "new_text": null,
          "old_line_content": "\t\tif (state.canvas_state_buffer.is_valid()) {",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 3086,
          "old_api": "draw_list_bind_vertex_array",
          "new_api": null,
          "old_text": "RD::get_singleton()->draw_list_bind_vertex_array(p_draw_list, vertex_array)",
          "new_text": null,
          "old_line_content": "\t\t\t\tRD::get_singleton()->draw_list_bind_vertex_array(p_draw_list, vertex_array);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3216,
          "old_api": "memdelete_arr",
          "new_api": null,
          "old_text": "memdelete_arr(state.light_uniforms)",
          "new_text": null,
          "old_line_content": "\t\tmemdelete_arr(state.light_uniforms);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3091,
          "old_api": "mesh_surface_get_vertices_drawn_count",
          "new_api": null,
          "old_text": "mesh_storage->mesh_surface_get_vertices_drawn_count(surface)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tr_render_info->info[RS::VIEWPORT_RENDER_INFO_TYPE_CANVAS][RS::VIEWPORT_RENDER_INFO_PRIMITIVES_IN_FRAME] += _indices_to_primitives(primitive, mesh_storage->mesh_surface_get_vertices_drawn_count(surface)) * p_batch->mesh_instance_count;",
          "new_line_content": "\t\t\t\t\tr_render_info->info[RS::VIEWPORT_RENDER_INFO_TYPE_CANVAS][RS::VIEWPORT_RENDER_INFO_OBJECTS_IN_FRAME]++;",
          "content_same": false
        },
        {
          "line": 3222,
          "old_api": "version_free",
          "new_api": null,
          "old_text": "shadow_render.shader.version_free(shadow_render.shader_version)",
          "new_text": null,
          "old_line_content": "\t\tshadow_render.shader.version_free(shadow_render.shader_version);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 2967,
          "old_api": "ERR_FAIL_NULL",
          "new_api": null,
          "old_text": "ERR_FAIL_NULL(p_batch->command)",
          "new_text": null,
          "old_line_content": "\t\t\tERR_FAIL_NULL(p_batch->command);",
          "new_line_content": "\t\tcase Item::Command::TYPE_POLYGON: {",
          "content_same": false
        },
        {
          "line": 3224,
          "old_api": "free",
          "new_api": null,
          "old_text": "RD::get_singleton()->free(state.shadow_sampler)",
          "new_text": null,
          "old_line_content": "\t\tRD::get_singleton()->free(state.shadow_sampler);",
          "new_line_content": "\t\t//this will also automatically clear all pipelines",
          "content_same": false
        },
        {
          "line": 2969,
          "old_api": "static_cast<const Item::CommandPolygon *>(p_batch->command)",
          "new_api": null,
          "old_text": "static_cast<const Item::CommandPolygon *>(p_batch->command)",
          "new_text": null,
          "old_line_content": "\t\t\tconst Item::CommandPolygon *polygon = static_cast<const Item::CommandPolygon *>(p_batch->command);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2971,
          "old_api": "getptr",
          "new_api": null,
          "old_text": "polygon_buffers.polygons.getptr(polygon->polygon.polygon_id)",
          "new_text": null,
          "old_line_content": "\t\t\tPolygonBuffers *pb = polygon_buffers.polygons.getptr(polygon->polygon.polygon_id);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3229,
          "old_api": "free",
          "new_api": null,
          "old_text": "RD::get_singleton()->free(shader.quad_index_array)",
          "new_text": null,
          "old_line_content": "\t\tRD::get_singleton()->free(shader.quad_index_array);",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 2975,
          "old_api": "_get_pipeline_specialization_or_ubershader",
          "new_api": null,
          "old_text": "_get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant)",
          "new_text": null,
          "old_line_content": "\t\t\tpipeline = _get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant);",
          "new_line_content": "\t\t\tpipeline_key.vertex_format_id = pb->vertex_format_id;",
          "content_same": false
        },
        {
          "line": 3105,
          "old_api": "size",
          "new_api": null,
          "old_text": "state.canvas_instance_batches.size()",
          "new_text": null,
          "old_line_content": "\tif (state.canvas_instance_batches.size() == 0) {",
          "new_line_content": "RendererCanvasRenderRD::Batch *RendererCanvasRenderRD::_new_batch(bool &r_batch_broken) {",
          "content_same": false
        },
        {
          "line": 2978,
          "old_api": "draw_list_set_push_constant",
          "new_api": null,
          "old_text": "RD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant))",
          "new_text": null,
          "old_line_content": "\t\t\tRD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3234,
          "old_api": "is_valid",
          "new_api": null,
          "old_text": "state.shadow_fb.is_valid()",
          "new_text": null,
          "old_line_content": "\tif (state.shadow_fb.is_valid()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3237,
          "old_api": "free",
          "new_api": null,
          "old_text": "RD::get_singleton()->free(state.shadow_texture)",
          "new_text": null,
          "old_line_content": "\tRD::get_singleton()->free(state.shadow_texture);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 3239,
          "old_api": "memdelete_arr",
          "new_api": null,
          "old_text": "memdelete_arr(state.instance_data_array)",
          "new_text": null,
          "old_line_content": "\tmemdelete_arr(state.instance_data_array);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2984,
          "old_api": "is_valid",
          "new_api": null,
          "old_text": "pb->indices.is_valid()",
          "new_text": null,
          "old_line_content": "\t\t\tRD::get_singleton()->draw_list_draw(p_draw_list, pb->indices.is_valid());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3241,
          "old_api": "size",
          "new_api": null,
          "old_text": "state.canvas_instance_data_buffers[i].instance_buffers.size()",
          "new_text": null,
          "old_line_content": "\t\tfor (uint32_t j = 0; j < state.canvas_instance_data_buffers[i].instance_buffers.size(); j++) {",
          "new_line_content": "\tfor (uint32_t i = 0; i < BATCH_DATA_BUFFER_COUNT; i++) {",
          "content_same": false
        },
        {
          "line": 2987,
          "old_api": "_indices_to_primitives",
          "new_api": null,
          "old_text": "_indices_to_primitives(polygon->primitive, pb->primitive_count)",
          "new_text": null,
          "old_line_content": "\t\t\t\tr_render_info->info[RS::VIEWPORT_RENDER_INFO_TYPE_CANVAS][RS::VIEWPORT_RENDER_INFO_PRIMITIVES_IN_FRAME] += _indices_to_primitives(polygon->primitive, pb->primitive_count);",
          "new_line_content": "\t\t\t\tr_render_info->info[RS::VIEWPORT_RENDER_INFO_TYPE_CANVAS][RS::VIEWPORT_RENDER_INFO_OBJECTS_IN_FRAME]++;",
          "content_same": false
        },
        {
          "line": 3246,
          "old_api": "canvas_texture_free",
          "new_api": null,
          "old_text": "RendererRD::TextureStorage::get_singleton()->canvas_texture_free(default_canvas_texture)",
          "new_text": null,
          "old_line_content": "\tRendererRD::TextureStorage::get_singleton()->canvas_texture_free(default_canvas_texture);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2993,
          "old_api": "ERR_FAIL_NULL",
          "new_api": null,
          "old_text": "ERR_FAIL_NULL(p_batch->command)",
          "new_text": null,
          "old_line_content": "\t\t\tERR_FAIL_NULL(p_batch->command);",
          "new_line_content": "\t\tcase Item::Command::TYPE_PRIMITIVE: {",
          "content_same": false
        },
        {
          "line": 3122,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "state.canvas_instance_batches.push_back(new_batch)",
          "new_text": null,
          "old_line_content": "\tstate.canvas_instance_batches.push_back(new_batch);",
          "new_line_content": "\tstate.current_batch_index++;",
          "content_same": false
        },
        {
          "line": 2995,
          "old_api": "static_cast<const Item::CommandPrimitive *>(p_batch->command)",
          "new_api": null,
          "old_text": "static_cast<const Item::CommandPrimitive *>(p_batch->command)",
          "new_text": null,
          "old_line_content": "\t\t\tconst Item::CommandPrimitive *primitive = static_cast<const Item::CommandPrimitive *>(p_batch->command);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3249,
          "old_api": "memdelete",
          "new_api": null,
          "old_text": "memdelete(shader.default_version_data)",
          "new_text": null,
          "old_line_content": "\tmemdelete(shader.default_version_data);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2997,
          "old_api": "_get_pipeline_specialization_or_ubershader",
          "new_api": null,
          "old_text": "_get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant)",
          "new_text": null,
          "old_line_content": "\t\t\tpipeline = _get_pipeline_specialization_or_ubershader(p_shader_data, pipeline_key, push_constant);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3000,
          "old_api": "draw_list_set_push_constant",
          "new_api": null,
          "old_text": "RD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant))",
          "new_text": null,
          "old_line_content": "\t\t\tRD::get_singleton()->draw_list_set_push_constant(p_draw_list, &push_constant, sizeof(PushConstant));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3003,
          "old_api": "draw_list_draw",
          "new_api": null,
          "old_text": "RD::get_singleton()->draw_list_draw(p_draw_list, true, instance_count)",
          "new_text": null,
          "old_line_content": "\t\t\tRD::get_singleton()->draw_list_draw(p_draw_list, true, instance_count);",
          "new_line_content": "\t\t\tuint32_t instance_count = p_batch->instance_count;",
          "content_same": false
        },
        {
          "line": 3132,
          "old_api": "buffer_update",
          "new_api": null,
          "old_text": "RD::get_singleton()->buffer_update(\n\t\t\t\tstate.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers[state.current_instance_buffer_index],\n\t\t\t\tstate.last_instance_index * sizeof(InstanceData),\n\t\t\t\tr_index * sizeof(InstanceData),\n\t\t\t\tstate.instance_data_array)",
          "new_text": null,
          "old_line_content": "\t\tRD::get_singleton()->buffer_update(",
          "new_line_content": "\t\t// then go back to recording item commands.",
          "content_same": false
        },
        {
          "line": 3008,
          "old_api": "_indices_to_primitives",
          "new_api": null,
          "old_text": "_indices_to_primitives(rs_primitive[p_batch->primitive_points], p_batch->primitive_points)",
          "new_text": null,
          "old_line_content": "\t\t\t\tr_render_info->info[RS::VIEWPORT_RENDER_INFO_TYPE_CANVAS][RS::VIEWPORT_RENDER_INFO_PRIMITIVES_IN_FRAME] += _indices_to_primitives(rs_primitive[p_batch->primitive_points], p_batch->primitive_points) * instance_count;",
          "new_line_content": "\t\t\t\tr_render_info->info[RS::VIEWPORT_RENDER_INFO_TYPE_CANVAS][RS::VIEWPORT_RENDER_INFO_OBJECTS_IN_FRAME] += instance_count;",
          "content_same": false
        },
        {
          "line": 3137,
          "old_api": "_allocate_instance_buffer",
          "new_api": null,
          "old_text": "_allocate_instance_buffer()",
          "new_text": null,
          "old_line_content": "\t\t_allocate_instance_buffer();",
          "new_line_content": "\t\t\t\tstate.instance_data_array);",
          "content_same": false
        },
        {
          "line": 3141,
          "old_api": "_new_batch",
          "new_api": null,
          "old_text": "_new_batch(r_batch_broken)",
          "new_text": null,
          "old_line_content": "\t\tr_current_batch = _new_batch(r_batch_broken);",
          "new_line_content": "\t\tr_batch_broken = false; // Force a new batch to be created",
          "content_same": false
        },
        {
          "line": 3016,
          "old_api": "ERR_FAIL_NULL",
          "new_api": null,
          "old_text": "ERR_FAIL_NULL(p_batch->command)",
          "new_text": null,
          "old_line_content": "\t\t\tERR_FAIL_NULL(p_batch->command);",
          "new_line_content": "\t\tcase Item::Command::TYPE_PARTICLES: {",
          "content_same": false
        },
        {
          "line": 3018,
          "old_api": "RendererRD::MeshStorage::get_singleton()",
          "new_api": null,
          "old_text": "RendererRD::MeshStorage::get_singleton()",
          "new_text": null,
          "old_line_content": "\t\t\tRendererRD::MeshStorage *mesh_storage = RendererRD::MeshStorage::get_singleton();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3149,
          "old_api": "size",
          "new_api": null,
          "old_text": "state.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers.size()",
          "new_text": null,
          "old_line_content": "\tif (state.current_instance_buffer_index < state.canvas_instance_data_buffers[state.current_data_buffer_index].instance_buffers.size()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3025,
          "old_api": "static_cast<const Item::CommandMesh *>(p_batch->command)",
          "new_api": null,
          "old_text": "static_cast<const Item::CommandMesh *>(p_batch->command)",
          "new_text": null,
          "old_line_content": "\t\t\t\tconst Item::CommandMesh *m = static_cast<const Item::CommandMesh *>(p_batch->command);",
          "new_line_content": "\t\t\tif (p_batch->command_type == Item::Command::TYPE_MESH) {",
          "content_same": false
        },
        {
          "line": 3155,
          "old_api": "storage_buffer_create",
          "new_api": null,
          "old_text": "RD::get_singleton()->storage_buffer_create(state.max_instance_buffer_size)",
          "new_text": null,
          "old_line_content": "\tRID buf = RD::get_singleton()->storage_buffer_create(state.max_instance_buffer_size);",
          "new_line_content": "\t// Allocate a new buffer.",
          "content_same": false
        },
        {
          "line": 3029,
          "old_api": "static_cast<const Item::CommandMultiMesh *>(p_batch->command)",
          "new_api": null,
          "old_text": "static_cast<const Item::CommandMultiMesh *>(p_batch->command)",
          "new_text": null,
          "old_line_content": "\t\t\t\tconst Item::CommandMultiMesh *mm = static_cast<const Item::CommandMultiMesh *>(p_batch->command);",
          "new_line_content": "\t\t\t} else if (p_batch->command_type == Item::Command::TYPE_MULTIMESH) {",
          "content_same": false
        },
        {
          "line": 3031,
          "old_api": "multimesh_get_mesh",
          "new_api": null,
          "old_text": "mesh_storage->multimesh_get_mesh(multimesh)",
          "new_text": null,
          "old_line_content": "\t\t\t\tmesh = mesh_storage->multimesh_get_mesh(multimesh);",
          "new_line_content": "\t\t\t\tRID multimesh = mm->multimesh;",
          "content_same": false
        },
        {
          "line": 3160,
          "old_api": "is_null",
          "new_api": null,
          "old_text": "p_texture.is_null()",
          "new_text": null,
          "old_line_content": "\tif (p_texture.is_null()) {",
          "new_line_content": "void RendererCanvasRenderRD::_prepare_batch_texture_info(RID p_texture, TextureState &p_state, TextureInfo *p_info) {",
          "content_same": false
        },
        {
          "line": 3033,
          "old_api": "multimesh_get_2d_uniform_set",
          "new_api": null,
          "old_text": "mesh_storage->multimesh_get_2d_uniform_set(multimesh, shader.default_version_rd_shader, TRANSFORMS_UNIFORM_SET)",
          "new_text": null,
          "old_line_content": "\t\t\t\tRID uniform_set = mesh_storage->multimesh_get_2d_uniform_set(multimesh, shader.default_version_rd_shader, TRANSFORMS_UNIFORM_SET);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3036,
          "old_api": "static_cast<const Item::CommandParticles *>(p_batch->command)",
          "new_api": null,
          "old_text": "static_cast<const Item::CommandParticles *>(p_batch->command)",
          "new_text": null,
          "old_line_content": "\t\t\t\tconst Item::CommandParticles *pt = static_cast<const Item::CommandParticles *>(p_batch->command);",
          "new_line_content": "\t\t\t} else if (p_batch->command_type == Item::Command::TYPE_PARTICLES) {",
          "content_same": false
        },
        {
          "line": 3165,
          "old_api": "texture_filter",
          "new_api": null,
          "old_text": "RendererRD::TextureStorage::get_singleton()->canvas_texture_get_info(\n\t\t\t\t\tp_texture,\n\t\t\t\t\tp_state.texture_filter(),\n\t\t\t\t\tp_state.texture_repeat(),\n\t\t\t\t\tp_state.linear_colors(),\n\t\t\t\t\tp_state.texture_is_data())",
          "new_text": null,
          "old_line_content": "\t\t\tRendererRD::TextureStorage::get_singleton()->canvas_texture_get_info(",
          "new_line_content": "\tRendererRD::TextureStorage::CanvasTextureInfo info =",
          "content_same": false
        },
        {
          "line": 3038,
          "old_api": "particles_get_draw_pass_mesh",
          "new_api": null,
          "old_text": "particles_storage->particles_get_draw_pass_mesh(particles, 0)",
          "new_text": null,
          "old_line_content": "\t\t\t\tmesh = particles_storage->particles_get_draw_pass_mesh(particles, 0);",
          "new_line_content": "\t\t\t\tRID particles = pt->particles;",
          "content_same": false
        },
        {
          "line": 3167,
          "old_api": "texture_filter",
          "new_api": null,
          "old_text": "p_state.texture_filter()",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tp_state.texture_filter(),",
          "new_line_content": "\t\t\t\t\tp_texture,",
          "content_same": false
        },
        {
          "line": 3040,
          "old_api": "particles_get_mode",
          "new_api": null,
          "old_text": "particles_storage->particles_get_mode(particles)",
          "new_text": null,
          "old_line_content": "\t\t\t\tERR_BREAK(particles_storage->particles_get_mode(particles) != RS::PARTICLES_MODE_2D);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3043,
          "old_api": "particles_is_inactive",
          "new_api": null,
          "old_text": "particles_storage->particles_is_inactive(particles)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (particles_storage->particles_is_inactive(particles)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3172,
          "old_api": "is_null",
          "new_api": null,
          "old_text": "info.is_null()",
          "new_text": null,
          "old_line_content": "\tif (info.is_null()) {",
          "new_line_content": "\t// something odd happened",
          "content_same": false
        },
        {
          "line": 3047,
          "old_api": "RenderingServerDefault::redraw_request()",
          "new_api": null,
          "old_text": "RenderingServerDefault::redraw_request()",
          "new_text": null,
          "old_line_content": "\t\t\t\tRenderingServerDefault::redraw_request(); // Active particles means redraw request.",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2920,
          "old_api": "uniform_set_create",
          "new_api": null,
          "old_text": "RD::get_singleton()->uniform_set_create(state.batch_texture_uniforms, shader.default_version_rd_shader, BATCH_UNIFORM_SET)",
          "new_text": null,
          "old_line_content": "\t\t\tRID rid = RD::get_singleton()->uniform_set_create(state.batch_texture_uniforms, shader.default_version_rd_shader, BATCH_UNIFORM_SET);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3049,
          "old_api": "particles_get_draw_passes",
          "new_api": null,
          "old_text": "particles_storage->particles_get_draw_passes(particles)",
          "new_text": null,
          "old_line_content": "\t\t\t\tint dpc = particles_storage->particles_get_draw_passes(particles);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2923,
          "old_api": "insert",
          "new_api": null,
          "old_text": "rid_set_to_uniform_set.insert(key, rid)",
          "new_text": null,
          "old_line_content": "\t\t\tconst RIDCache::Pair *iter = rid_set_to_uniform_set.insert(key, rid);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2925,
          "old_api": "uniform_set_set_invalidation_callback",
          "new_api": null,
          "old_text": "RD::get_singleton()->uniform_set_set_invalidation_callback(rid, RendererCanvasRenderRD::_uniform_set_invalidation_callback, (void *)&iter->key)",
          "new_text": null,
          "old_line_content": "\t\t\tRD::get_singleton()->uniform_set_set_invalidation_callback(rid, RendererCanvasRenderRD::_uniform_set_invalidation_callback, (void *)&iter->key);",
          "new_line_content": "\t\t\tuniform_set = &iter->data;",
          "content_same": false
        },
        {
          "line": 3054,
          "old_api": "particles_get_instance_buffer_uniform_set",
          "new_api": null,
          "old_text": "particles_storage->particles_get_instance_buffer_uniform_set(pt->particles, shader.default_version_rd_shader, TRANSFORMS_UNIFORM_SET)",
          "new_text": null,
          "old_line_content": "\t\t\t\tRID uniform_set = particles_storage->particles_get_instance_buffer_uniform_set(pt->particles, shader.default_version_rd_shader, TRANSFORMS_UNIFORM_SET);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2930,
          "old_api": "draw_list_bind_uniform_set",
          "new_api": null,
          "old_text": "RD::get_singleton()->draw_list_bind_uniform_set(p_draw_list, *uniform_set, BATCH_UNIFORM_SET)",
          "new_text": null,
          "old_line_content": "\t\t\tRD::get_singleton()->draw_list_bind_uniform_set(p_draw_list, *uniform_set, BATCH_UNIFORM_SET);",
          "new_line_content": "\t\t\tstate.current_batch_uniform_set = *uniform_set;",
          "content_same": false
        },
        {
          "line": 3058,
          "old_api": "is_null",
          "new_api": null,
          "old_text": "mesh.is_null()",
          "new_text": null,
          "old_line_content": "\t\t\tif (mesh.is_null()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3062,
          "old_api": "mesh_get_surface_count",
          "new_api": null,
          "old_text": "mesh_storage->mesh_get_surface_count(mesh)",
          "new_text": null,
          "old_line_content": "\t\t\tuint32_t surf_count = mesh_storage->mesh_get_surface_count(mesh);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3192,
          "old_api": "CLAMP",
          "new_api": null,
          "old_text": "CLAMP(info.specular_color.a * 255.0, 0.0, 255.0)",
          "new_text": null,
          "old_line_content": "\tuint8_t a = uint8_t(CLAMP(info.specular_color.a * 255.0, 0.0, 255.0));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3065,
          "old_api": "mesh_get_surface",
          "new_api": null,
          "old_text": "mesh_storage->mesh_get_surface(mesh, j)",
          "new_text": null,
          "old_line_content": "\t\t\t\tvoid *surface = mesh_storage->mesh_get_surface(mesh, j);",
          "new_line_content": "\t\t\tfor (uint32_t j = 0; j < surf_count; j++) {",
          "content_same": false
        },
        {
          "line": 3067,
          "old_api": "mesh_surface_get_primitive",
          "new_api": null,
          "old_text": "mesh_storage->mesh_surface_get_primitive(surface)",
          "new_text": null,
          "old_line_content": "\t\t\t\tRS::PrimitiveType primitive = mesh_storage->mesh_surface_get_primitive(surface);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 3198,
          "old_api": "Vector2",
          "new_api": null,
          "old_text": "Vector2(1.0 / float(info.size.width), 1.0 / float(info.size.height))",
          "new_text": null,
          "old_line_content": "\tp_info->texpixel_size = Vector2(1.0 / float(info.size.width), 1.0 / float(info.size.height));",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 37,
      "total_additions": 72,
      "total_deletions": 71,
      "total_api_changes": 180
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 6,
        "api_related_lines": 180,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 1004,
    "api_calls_after": 1005,
    "diff_info": {
      "added_lines": 6,
      "removed_lines": 5,
      "total_diff_lines": 23
    }
  }
}