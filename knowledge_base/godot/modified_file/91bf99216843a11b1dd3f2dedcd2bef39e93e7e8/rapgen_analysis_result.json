{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/91bf99216843a11b1dd3f2dedcd2bef39e93e7e8",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/91bf99216843a11b1dd3f2dedcd2bef39e93e7e8/before.h",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/91bf99216843a11b1dd3f2dedcd2bef39e93e7e8/after.h",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/godot/modified_file/91bf99216843a11b1dd3f2dedcd2bef39e93e7e8/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 214,
          "old_api": ") + 1)",
          "new_api": "D_PARA",
          "old_text": ") + 1)",
          "new_text": "D_PARA",
          "old_line_content": null,
          "new_line_content": "\t\tERR_FAIL_INDEX(p_index, size());",
          "content_same": true
        },
        {
          "line": 215,
          "old_api": "e i =",
          "new_api": "ror er",
          "old_text": "e i = ",
          "new_text": "ror er",
          "old_line_content": null,
          "new_line_content": "\t\tT *p = ptrw();",
          "content_same": true
        },
        {
          "line": 216,
          "old_api": "> p_p",
          "new_api": "size);",
          "old_text": " > p_p",
          "new_text": "size);",
          "old_line_content": null,
          "new_line_content": "\t\tSize len = size();",
          "content_same": true
        },
        {
          "line": 221,
          "old_api": "}\n\n\tSize find(c",
          "new_api": "1; i > p_pos; i",
          "old_text": "}\n\n\tSize find(c",
          "new_text": "1; i > p_pos; i",
          "old_line_content": null,
          "new_line_content": "\t\tresize(len - 1);",
          "content_same": true
        },
        {
          "line": 225,
          "old_api": "om = -",
          "new_api": "Size",
          "old_text": "om = -",
          "new_text": "\tSize ",
          "old_line_content": "\t\tERR_FAIL_INDEX_V(p_pos, size() + 1, ERR_INVALID_PARAMETER);",
          "new_line_content": "\t\tSize new_size = size() + 1;",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": "onst;",
          "new_api": "st T &p_val, Size p_from = 0) const;\n\tSize rfind(const T",
          "old_text": "onst;\n",
          "new_text": "st T &p_val, Size p_from = 0) const;\n\tSize rfind(const T",
          "old_line_content": "\t\tresize(size() + 1);",
          "new_line_content": "\t\tERR_FAIL_INDEX_V(p_pos, new_size, ERR_INVALID_PARAMETER);",
          "content_same": false
        },
        {
          "line": 227,
          "old_api": "() {}",
          "new_api": "from = -1) const",
          "old_text": "() {}\n",
          "new_text": "from = -1) const",
          "old_line_content": "\t\tfor (Size i = (size() - 1); i > p_pos; i--) {",
          "new_line_content": "\t\tError err = resize(new_size);",
          "content_same": false
        },
        {
          "line": 228,
          "old_api": "_INLINE_ C",
          "new_api": "ize count(const T &p_val)",
          "old_text": "_INLINE_ C",
          "new_text": "ize count(const T &p_val)",
          "old_line_content": "\t\t\tset(i, get(i - 1));",
          "new_line_content": "\t\tERR_FAIL_COND_V(err, err);",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": "_get_refcount_p",
          "new_api": "(mem_new, 0);",
          "old_text": " _get_refcount_p",
          "new_text": "(mem_new, 0);\n\n",
          "old_line_content": "\tif (unlikely(rc > 1)) {",
          "new_line_content": "\tSafeNumeric<USize> *refc = _get_refcount();",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": "T *_data_p",
          "new_api": "Size> *_ref",
          "old_text": "\tT *_data_p",
          "new_text": "Size> *_ref",
          "old_line_content": "\t\tUSize current_size = *_get_size();",
          "new_line_content": "\tUSize rc = refc->get();",
          "content_same": false
        },
        {
          "line": 285,
          "old_api": "; //size\n\n\t\t// initialize n",
          "new_api": "T *_data_p",
          "old_text": "; //size\n\n\t\t// initialize n",
          "new_text": "\tT *_data_p",
          "old_line_content": "\t\tERR_FAIL_NULL_V(mem_new, 0);",
          "new_line_content": "\t\tUSize current_size = *_get_size();",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": "rivially_copyable_v<T>) {",
          "new_api": "ric<USize>(1); //refcount\n\t\t*",
          "old_text": "rivially_copyable_v<T>) {\n",
          "new_text": "ric<USize>(1); //refcount\n\t\t*",
          "old_line_content": "\t\tSafeNumeric<USize> *_refc_ptr = _get_refcount_ptr(mem_new);",
          "new_line_content": "\t\tuint8_t *mem_new = (uint8_t *)Memory::alloc_static(_get_alloc_size(current_size) + DATA_OFFSET, false);",
          "content_same": false
        },
        {
          "line": 288,
          "old_api": "ata_ptr, _ptr, current",
          "new_api": "; //size\n\n\t\t// initialize n",
          "old_text": "ata_ptr, _ptr, current",
          "new_text": "; //size\n\n\t\t// initialize n",
          "old_line_content": "\t\tUSize *_size_ptr = _get_size_ptr(mem_new);",
          "new_line_content": "\t\tERR_FAIL_NULL_V(mem_new, 0);",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": ");\n\n\tif (p",
          "new_api": "e T>\ntemplate <bool p_ensure_zero>\nError CowData<T>::resize(",
          "old_text": ");\n\n\tif (p",
          "new_text": "e T>\ntemplate <bool p_ensure_zero>\nError CowData<T>::resize(",
          "old_line_content": "\t\t\t\tmemnew_placement(&_data_ptr[i], T(_ptr[i]));",
          "new_line_content": "\t\t\tmemcpy((uint8_t *)_data_ptr, _ptr, current_size * sizeof(T));",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": "nt8_t *mem_new = (uint8_t",
          "new_api": "new (_refc_ptr) SafeNumeric<USize>(1); //refcount",
          "old_text": "nt8_t *mem_new = (uint8_t ",
          "new_text": "\t\t\t\tnew (_refc_ptr) SafeNumeric<USize>(1); //refcount",
          "old_line_content": "\t\t\t\tSafeNumeric<USize> *_refc_ptr = _get_refcount_ptr(mem_new);",
          "new_line_content": "\t\t\t\tuint8_t *mem_new = (uint8_t *)Memory::alloc_static(alloc_size + DATA_OFFSET, false);",
          "content_same": false
        },
        {
          "line": 344,
          "old_api": "((uint8_t *)_ptr) - DA",
          "new_api": "(_size_ptr) = 0; //size, currently none",
          "old_text": "((uint8_t *)_ptr) - DA",
          "new_text": "(_size_ptr) = 0; //size, currently none\n\n\t\t",
          "old_line_content": "\t\t\t\tUSize *_size_ptr = _get_size_ptr(mem_new);",
          "new_line_content": "\t\t\t\tERR_FAIL_NULL_V(mem_new, ERR_OUT_OF_MEMORY);",
          "content_same": false
        },
        {
          "line": 356,
          "old_api": "for (Size i = *_get_siz",
          "new_api": "fc_ptr) SafeNumeric<USize>(rc); //refcount\n\n\t\t\t\t_ptr = _data_ptr;\n\t\t\t}\n\t\t}\n\n\t\t// constru",
          "old_text": "\t\t\tfor (Size i = *_get_siz",
          "new_text": "fc_ptr) SafeNumeric<USize>(rc); //refcount\n\n\t\t\t\t_ptr = _data_ptr;\n\t\t\t}\n\t\t}\n\n\t\t// constru",
          "old_line_content": "\t\t\t\tSafeNumeric<USize> *_refc_ptr = _get_refcount_ptr(mem_new);",
          "new_line_content": "\t\t\t\tuint8_t *mem_new = (uint8_t *)Memory::realloc_static(((uint8_t *)_ptr) - DATA_OFFSET, alloc_size + DATA_OFFSET, false);",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": "{\n\t\t\t\tmemnew_placemen",
          "new_api": "newly created elements\n\n\t\tif constexpr (!s",
          "old_text": " {\n\t\t\t\tmemnew_placemen",
          "new_text": " newly created elements\n\n\t\tif constexpr (!s",
          "old_line_content": "\t\t\t\tT *_data_ptr = _get_data_ptr(mem_new);",
          "new_line_content": "\t\t\t\tERR_FAIL_NULL_V(mem_new, ERR_OUT_OF_MEMORY);",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": "e i = p_size; i < *_get_size(); i++) {\n\t\t\t\tT *t = &_ptr[i];\n\t\t\t\tt->~T();\n\t\t\t}",
          "new_api": "ble_v<T>) {\n\t\t\t// deinitializ",
          "old_text": "e i = p_size; i < *_get_size(); i++) {\n\t\t\t\tT *t = &_ptr[i];\n\t\t\t\tt->~T();\n\t\t\t}",
          "new_text": "ble_v<T>) {\n\t\t\t// deinitializ",
          "old_line_content": "\t\t\tmemset((void *)(_ptr + current_size), 0, (p_size - current_size) * sizeof(T));",
          "new_line_content": "\t\t\t\tmemnew_placement(&_ptr[i], T);",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": "(alloc_siz",
          "new_api": "e i = p_size; i < *_get_size(); i++) {\n\t\t\t\tT *t = &_ptr[i];\n\t\t\t\tt->~T();\n\t\t\t}",
          "old_text": " (alloc_siz",
          "new_text": "e i = p_size; i < *_get_size(); i++) {\n\t\t\t\tT *t = &_ptr[i];\n\t\t\t\tt->~T();\n\t\t\t}",
          "old_line_content": "\t\t*_get_size() = p_size;",
          "new_line_content": "\t\t\tmemset((void *)(_ptr + current_size), 0, (p_size - current_size) * sizeof(T));",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": "(const T &p_val, Size p_fr",
          "new_api": "tr) SafeNumeric<USize>(rc); //refcount\n\n\t\t\t_ptr = _data_ptr;\n\t\t}\n\n\t\t*_get_size() = p_siz",
          "old_text": "(const T &p_val, Size p_fr",
          "new_text": "tr) SafeNumeric<USize>(rc); //refcount\n\n\t\t\t_ptr = _data_ptr;\n\t\t}\n\n\t\t*_get_size() = p_siz",
          "old_line_content": "\t\t\tSafeNumeric<USize> *_refc_ptr = _get_refcount_ptr(mem_new);",
          "new_line_content": "\t\t\tuint8_t *mem_new = (uint8_t *)Memory::realloc_static(((uint8_t *)_ptr) - DATA_OFFSET, alloc_size + DATA_OFFSET, false);",
          "content_same": false
        },
        {
          "line": 391,
          "old_api": "t = -1;\n\n\tif (p_from <",
          "new_api": "return OK;\n}\n\ntemplate <typename T>\ntype",
          "old_text": "t = -1;\n\n\tif (p_from <",
          "new_text": "\n\n\treturn OK;\n}\n\ntemplate <typename T>\ntype",
          "old_line_content": "\t\t\tT *_data_ptr = _get_data_ptr(mem_new);",
          "new_line_content": "\t\t\tERR_FAIL_NULL_V(mem_new, ERR_OUT_OF_MEMORY);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 385,
          "old_api": null,
          "new_api": "c_ptr =",
          "old_text": null,
          "new_text": "c_ptr =",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tt->~T();",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": null,
          "new_api": "CowData<T>:",
          "old_text": null,
          "new_text": "CowData<T>:",
          "old_line_content": "\t\tfor (USize i = 0; i < *count; ++i) {",
          "new_line_content": "\t\tUSize *count = _get_size();",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": null,
          "new_api": "_OUT_OF_MEM",
          "old_text": null,
          "new_text": "_OUT_OF_MEM",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\tfor (USize i = p_size; i < *_get_size(); i++) {",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": null,
          "new_api": "(const T &p_val, Size p_fr",
          "old_text": null,
          "new_text": "(const T &p_val, Size p_fr",
          "old_line_content": "\t\t\tnew (_refc_ptr) SafeNumeric<USize>(rc); //refcount",
          "new_line_content": "\t\t\tSafeNumeric<USize> *_refc_ptr = _get_refcount_ptr(mem_new);",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": null,
          "new_api": "Size rc = re",
          "old_text": null,
          "new_text": "Size rc = re",
          "old_line_content": "",
          "new_line_content": "\t\t\tdata[i].~T();",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": null,
          "new_api": "t = -1;\n\n\tif (p_from <",
          "old_text": null,
          "new_text": "t = -1;\n\n\tif (p_from <",
          "old_line_content": "",
          "new_line_content": "\t\t\tT *_data_ptr = _get_data_ptr(mem_new);",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": null,
          "new_api": "(rc > 1)) {\n\t\t/* in use by more than me */\n\t\tUSize current_si",
          "old_text": null,
          "new_text": "(rc > 1)) {\n\t\t/* in use by more than me */\n\t\tUSize current_si",
          "old_line_content": "template <typename T>",
          "new_line_content": "\tMemory::free_static(((uint8_t *)p_data) - DATA_OFFSET, false);",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "get(i) == p",
          "old_line_content": "\treturn OK;",
          "new_line_content": "\t\t*_get_size() = p_size;",
          "content_same": false
        },
        {
          "line": 283,
          "old_api": null,
          "new_api": "_get_refcount_p",
          "old_text": null,
          "new_text": " _get_refcount_p",
          "old_line_content": "",
          "new_line_content": "\tif (unlikely(rc > 1)) {",
          "content_same": false
        },
        {
          "line": 411,
          "old_api": null,
          "new_api": "s = s",
          "old_text": null,
          "new_text": " s = s",
          "old_line_content": "",
          "new_line_content": "\tif (p_from < 0 || size() == 0) {",
          "content_same": false
        },
        {
          "line": 415,
          "old_api": null,
          "new_api": "if (p_",
          "old_text": null,
          "new_text": "if (p_",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\tfor (Size i = p_from; i < size(); i++) {",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": null,
          "new_api": "rom >=",
          "old_text": null,
          "new_text": "rom >=",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tif (get(i) == p_val) {",
          "content_same": false
        },
        {
          "line": 290,
          "old_api": null,
          "new_api": "rivially_copyable_v<T>) {",
          "old_text": null,
          "new_text": "rivially_copyable_v<T>) {\n",
          "old_line_content": "",
          "new_line_content": "\t\tSafeNumeric<USize> *_refc_ptr = _get_refcount_ptr(mem_new);",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": null,
          "new_api": "ata_ptr, _ptr, current",
          "old_text": null,
          "new_text": "ata_ptr, _ptr, current",
          "old_line_content": "\t\tnew (_refc_ptr) SafeNumeric<USize>(1); //refcount",
          "new_line_content": "\t\tUSize *_size_ptr = _get_size_ptr(mem_new);",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": null,
          "new_api": "} else {\n\t\t\tfor (US",
          "old_text": null,
          "new_text": "\n\t\t} else {\n\t\t\tfor (US",
          "old_line_content": "\t\t*(_size_ptr) = current_size; //size",
          "new_line_content": "\t\tT *_data_ptr = _get_data_ptr(mem_new);",
          "content_same": false
        },
        {
          "line": 427,
          "old_api": null,
          "new_api": "ata<T>",
          "old_text": null,
          "new_text": "ata<T>",
          "old_line_content": "\t\tp_from = s + p_from;",
          "new_line_content": "\tconst Size s = size();",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": null,
          "new_api": ");\n\n\tif (p",
          "old_text": null,
          "new_text": ");\n\n\tif (p",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tmemnew_placement(&_data_ptr[i], T(_ptr[i]));",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": null,
          "new_api": "t_size) {",
          "old_text": null,
          "new_text": "t_size) {\n\t\t",
          "old_line_content": "\t\trc = 1;",
          "new_line_content": "\t\t_unref(_ptr);",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": null,
          "new_api": "}\n\ntem",
          "old_text": null,
          "new_text": "}\n\ntem",
          "old_line_content": "\t}",
          "new_line_content": "\t\tif (get(i) == p_val) {",
          "content_same": false
        },
        {
          "line": 317,
          "old_api": null,
          "new_api": "write\n\tUSize rc = _copy_on_write();\n\n\tUSize curre",
          "old_text": null,
          "new_text": " write\n\tUSize rc = _copy_on_write();\n\n\tUSize curre",
          "old_line_content": "",
          "new_line_content": "\tERR_FAIL_COND_V(p_size < 0, ERR_INVALID_PARAMETER);",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": null,
          "new_api": "oc_siz",
          "old_text": null,
          "new_text": "oc_siz",
          "old_line_content": "\t\treturn OK;",
          "new_line_content": "\tSize current_size = size();",
          "content_same": false
        },
        {
          "line": 447,
          "old_api": null,
          "new_api": ") {",
          "old_text": null,
          "new_text": ") {\n\t\t",
          "old_line_content": "\t\t}",
          "new_line_content": "\tfor (Size i = 0; i < size(); i++) {",
          "content_same": false
        },
        {
          "line": 448,
          "old_api": null,
          "new_api": "assig",
          "old_text": null,
          "new_text": " assig",
          "old_line_content": "\t}",
          "new_line_content": "\t\tif (get(i) == p_val) {",
          "content_same": false
        },
        {
          "line": 327,
          "old_api": null,
          "new_api": "e), ERR_OUT_",
          "old_text": null,
          "new_text": "e), ERR_OUT_",
          "old_line_content": "\t}",
          "new_line_content": "\t\t_unref(_ptr);",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": null,
          "new_api": "fcount",
          "old_text": null,
          "new_text": "fcount()->con",
          "old_line_content": "template <typename T>",
          "new_line_content": "\t_ref(*p_from);",
          "content_same": false
        },
        {
          "line": 333,
          "old_api": null,
          "new_api": "(current_size ==",
          "old_text": null,
          "new_text": "(current_size ==",
          "old_line_content": "\tUSize alloc_size;",
          "new_line_content": "\tUSize rc = _copy_on_write();",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": null,
          "new_api": "uint8_t *mem_new = (uint",
          "old_text": null,
          "new_text": "\n\t\t\t\tuint8_t *mem_new = (uint",
          "old_line_content": "",
          "new_line_content": "\tUSize current_alloc_size = _get_alloc_size(current_size);",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": null,
          "new_api": "DATA_OFFSET, false);\n\t\t\t\tERR_FAIL_NULL_V(me",
          "old_text": null,
          "new_text": " DATA_OFFSET, false);\n\t\t\t\tERR_FAIL_NULL_V(me",
          "old_line_content": "\t\tif (alloc_size != current_alloc_size) {",
          "new_line_content": "\tERR_FAIL_COND_V(!_get_alloc_size_checked(p_size, &alloc_size), ERR_OUT_OF_MEMORY);",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": null,
          "new_api": "efined",
          "old_text": null,
          "new_text": "efined(__GNU",
          "old_line_content": "\tif (!p_from._ptr) {",
          "new_line_content": "\t_unref(_ptr);",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": null,
          "new_api": "DATA_H",
          "old_text": null,
          "new_text": "DATA_H\n",
          "old_line_content": "}",
          "new_line_content": "\tif (p_from._get_refcount()->conditional_increment() > 0) { // could reference",
          "content_same": false
        },
        {
          "line": 346,
          "old_api": null,
          "new_api": "nt8_t *mem_new = (uint8_t",
          "old_text": null,
          "new_text": "nt8_t *mem_new = (uint8_t ",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tSafeNumeric<USize> *_refc_ptr = _get_refcount_ptr(mem_new);",
          "content_same": false
        },
        {
          "line": 347,
          "old_api": null,
          "new_api": "((uint8_t *)_ptr) - DA",
          "old_text": null,
          "new_text": "((uint8_t *)_ptr) - DA",
          "old_line_content": "\t\t\t\tnew (_refc_ptr) SafeNumeric<USize>(1); //refcount",
          "new_line_content": "\t\t\t\tUSize *_size_ptr = _get_size_ptr(mem_new);",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": null,
          "new_api": "+ DATA_OFFSET, false)",
          "old_text": null,
          "new_text": " + DATA_OFFSET, false)",
          "old_line_content": "\t\t\t\t*(_size_ptr) = 0; //size, currently none",
          "new_line_content": "\t\t\t\tT *_data_ptr = _get_data_ptr(mem_new);",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": null,
          "new_api": "",
          "old_text": null,
          "new_text": "",
          "old_line_content": "#if defined(__GNUC__) && !defined(__clang__)",
          "new_line_content": "\t_unref(_ptr);",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": null,
          "new_api": "FORCE_",
          "old_text": null,
          "new_text": "FORCE_",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tT *p = ptrw();",
          "content_same": false
        },
        {
          "line": 359,
          "old_api": null,
          "new_api": "for (Size i = *_get_siz",
          "old_text": null,
          "new_text": "\t\t\tfor (Size i = *_get_siz",
          "old_line_content": "\t\t\t\tnew (_refc_ptr) SafeNumeric<USize>(rc); //refcount",
          "new_line_content": "\t\t\t\tSafeNumeric<USize> *_refc_ptr = _get_refcount_ptr(mem_new);",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": null,
          "new_api": "{\n\t\t\t\tmemnew_placemen",
          "old_text": null,
          "new_text": " {\n\t\t\t\tmemnew_placemen",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tT *_data_ptr = _get_data_ptr(mem_new);",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": null,
          "new_api": "stexpr (!st",
          "old_text": null,
          "new_text": "stexpr (!st",
          "old_line_content": "\t\t} else if (p_ensure_zero) {",
          "new_line_content": "\t\t\tfor (Size i = *_get_size(); i < p_size; i++) {",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": null,
          "new_api": "ially_destru",
          "old_text": null,
          "new_text": "ially_destru",
          "old_line_content": "template <typename T>",
          "new_line_content": "\t_FORCE_INLINE_ CowData(CowData<T> &p_from) { _ref(p_from); };",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": null,
          "new_api": "(alloc_siz",
          "old_text": null,
          "new_text": " (alloc_siz",
          "old_line_content": "\t\tif constexpr (!std::is_trivially_destructible_v<T>) {",
          "new_line_content": "\t\t*_get_size() = p_size;",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": null,
          "new_api": "tructors\n\t\t\tdat",
          "old_text": null,
          "new_text": "tructors\n\t\t\tdat",
          "old_line_content": "\t\treturn; // still in use",
          "new_line_content": "\tSafeNumeric<USize> *refc = _get_refcount();",
          "content_same": false
        },
        {
          "line": 255,
          "old_api": null,
          "new_api": ");\n\t\t}\n\t}\n\n\t// fr",
          "old_text": null,
          "new_text": ");\n\t\t}\n\t}\n\n\t// fr",
          "old_line_content": "\t// clean up",
          "new_line_content": "\tif (refc->decrement() > 0) {",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 258,
          "old_api": "CowData<T>:",
          "new_api": null,
          "old_text": "CowData<T>:",
          "new_text": null,
          "old_line_content": "\t\tUSize *count = _get_size();",
          "new_line_content": "\t// clean up",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": "tr) SafeNumeric<USize>(rc); //refcount\n\n\t\t\t_ptr = _data_ptr;\n\t\t}\n\n\t\t*_get_size() = p_siz",
          "new_api": null,
          "old_text": "tr) SafeNumeric<USize>(rc); //refcount\n\n\t\t\t_ptr = _data_ptr;\n\t\t}\n\n\t\t*_get_size() = p_siz",
          "new_text": null,
          "old_line_content": "\t\t\tuint8_t *mem_new = (uint8_t *)Memory::realloc_static(((uint8_t *)_ptr) - DATA_OFFSET, alloc_size + DATA_OFFSET, false);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "return OK;\n}\n\ntemplate <typename T>\ntype",
          "new_api": null,
          "old_text": "\n\n\treturn OK;\n}\n\ntemplate <typename T>\ntype",
          "new_text": null,
          "old_line_content": "\t\t\tERR_FAIL_NULL_V(mem_new, ERR_OUT_OF_MEMORY);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 263,
          "old_api": "Size rc = re",
          "new_api": null,
          "old_text": "Size rc = re",
          "new_text": null,
          "old_line_content": "\t\t\tdata[i].~T();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 268,
          "old_api": "(rc > 1)) {\n\t\t/* in use by more than me */\n\t\tUSize current_si",
          "new_api": null,
          "old_text": "(rc > 1)) {\n\t\t/* in use by more than me */\n\t\tUSize current_si",
          "new_text": null,
          "old_line_content": "\tMemory::free_static(((uint8_t *)p_data) - DATA_OFFSET, false);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": "get",
          "new_api": null,
          "old_text": "get(i) == p",
          "new_text": null,
          "old_line_content": "\t\t*_get_size() = p_size;",
          "new_line_content": "\t\t\t_ptr = _data_ptr;",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": "(mem_new, 0);",
          "new_api": null,
          "old_text": "(mem_new, 0);\n\n",
          "new_text": null,
          "old_line_content": "\tSafeNumeric<USize> *refc = _get_refcount();",
          "new_line_content": "\t\treturn 0;",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": "Size> *_ref",
          "new_api": null,
          "old_text": "Size> *_ref",
          "new_text": null,
          "old_line_content": "\tUSize rc = refc->get();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": "s = s",
          "new_api": null,
          "old_text": " s = s",
          "new_text": null,
          "old_line_content": "\tif (p_from < 0 || size() == 0) {",
          "new_line_content": "typename CowData<T>::Size CowData<T>::find(const T &p_val, Size p_from) const {",
          "content_same": false
        },
        {
          "line": 284,
          "old_api": "ric<USize>(1); //refcount\n\t\t*",
          "new_api": null,
          "old_text": "ric<USize>(1); //refcount\n\t\t*",
          "new_text": null,
          "old_line_content": "\t\tuint8_t *mem_new = (uint8_t *)Memory::alloc_static(_get_alloc_size(current_size) + DATA_OFFSET, false);",
          "new_line_content": "\t\t/* in use by more than me */",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": "if (p_",
          "new_api": null,
          "old_text": "if (p_",
          "new_text": null,
          "old_line_content": "\tfor (Size i = p_from; i < size(); i++) {",
          "new_line_content": "\t\treturn ret;",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": "rom >=",
          "new_api": null,
          "old_text": "rom >=",
          "new_text": null,
          "old_line_content": "\t\tif (get(i) == p_val) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 289,
          "old_api": "} else {\n\t\t\tfor (US",
          "new_api": null,
          "old_text": "\n\t\t} else {\n\t\t\tfor (US",
          "new_text": null,
          "old_line_content": "\t\tT *_data_ptr = _get_data_ptr(mem_new);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": "e T>\ntemplate <bool p_ensure_zero>\nError CowData<T>::resize(",
          "new_api": null,
          "old_text": "e T>\ntemplate <bool p_ensure_zero>\nError CowData<T>::resize(",
          "new_text": null,
          "old_line_content": "\t\t\tmemcpy((uint8_t *)_data_ptr, _ptr, current_size * sizeof(T));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": "ata<T>",
          "new_api": null,
          "old_text": "ata<T>",
          "new_text": null,
          "old_line_content": "\tconst Size s = size();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": "t_size) {",
          "new_api": null,
          "old_text": "t_size) {\n\t\t",
          "new_text": null,
          "old_line_content": "\t\t_unref(_ptr);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": "}\n\ntem",
          "new_api": null,
          "old_text": "}\n\ntem",
          "new_text": null,
          "old_line_content": "\t\tif (get(i) == p_val) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": "write\n\tUSize rc = _copy_on_write();\n\n\tUSize curre",
          "new_api": null,
          "old_text": " write\n\tUSize rc = _copy_on_write();\n\n\tUSize curre",
          "new_text": null,
          "old_line_content": "\tERR_FAIL_COND_V(p_size < 0, ERR_INVALID_PARAMETER);",
          "new_line_content": "template <typename T>",
          "content_same": false
        },
        {
          "line": 316,
          "old_api": "oc_siz",
          "new_api": null,
          "old_text": "oc_siz",
          "new_text": null,
          "old_line_content": "\tSize current_size = size();",
          "new_line_content": "Error CowData<T>::resize(Size p_size) {",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": ") {",
          "new_api": null,
          "old_text": ") {\n\t\t",
          "new_text": null,
          "old_line_content": "\tfor (Size i = 0; i < size(); i++) {",
          "new_line_content": "template <typename T>",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": "assig",
          "new_api": null,
          "old_text": " assig",
          "new_text": null,
          "old_line_content": "\t\tif (get(i) == p_val) {",
          "new_line_content": "typename CowData<T>::Size CowData<T>::count(const T &p_val) const {",
          "content_same": false
        },
        {
          "line": 324,
          "old_api": "e), ERR_OUT_",
          "new_api": null,
          "old_text": "e), ERR_OUT_",
          "new_text": null,
          "old_line_content": "\t\t_unref(_ptr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": "fcount",
          "new_api": null,
          "old_text": "fcount()->con",
          "new_text": null,
          "old_line_content": "\t_ref(*p_from);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": "(current_size ==",
          "new_api": null,
          "old_text": "(current_size ==",
          "new_text": null,
          "old_line_content": "\tUSize rc = _copy_on_write();",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": "uint8_t *mem_new = (uint",
          "new_api": null,
          "old_text": "\n\t\t\t\tuint8_t *mem_new = (uint",
          "new_text": null,
          "old_line_content": "\tUSize current_alloc_size = _get_alloc_size(current_size);",
          "new_line_content": "\t// possibly changing size, copy on write",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": "DATA_OFFSET, false);\n\t\t\t\tERR_FAIL_NULL_V(me",
          "new_api": null,
          "old_text": " DATA_OFFSET, false);\n\t\t\t\tERR_FAIL_NULL_V(me",
          "new_text": null,
          "old_line_content": "\tERR_FAIL_COND_V(!_get_alloc_size_checked(p_size, &alloc_size), ERR_OUT_OF_MEMORY);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "efined",
          "new_api": null,
          "old_text": "efined(__GNU",
          "new_text": null,
          "old_line_content": "\t_unref(_ptr);",
          "new_line_content": "\t\treturn; // self assign, do nothing.",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": "new (_refc_ptr) SafeNumeric<USize>(1); //refcount",
          "new_api": null,
          "old_text": "\t\t\t\tnew (_refc_ptr) SafeNumeric<USize>(1); //refcount",
          "new_text": null,
          "old_line_content": "\t\t\t\tuint8_t *mem_new = (uint8_t *)Memory::alloc_static(alloc_size + DATA_OFFSET, false);",
          "new_line_content": "\t\tif (alloc_size != current_alloc_size) {",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": "(_size_ptr) = 0; //size, currently none",
          "new_api": null,
          "old_text": "(_size_ptr) = 0; //size, currently none\n\n\t\t",
          "new_text": null,
          "old_line_content": "\t\t\t\tERR_FAIL_NULL_V(mem_new, ERR_OUT_OF_MEMORY);",
          "new_line_content": "\t\t\tif (current_size == 0) {",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": "DATA_H",
          "new_api": null,
          "old_text": "DATA_H\n",
          "new_text": null,
          "old_line_content": "\tif (p_from._get_refcount()->conditional_increment() > 0) { // could reference",
          "new_line_content": "\t\treturn; //nothing to do",
          "content_same": false
        },
        {
          "line": 345,
          "old_api": "+ DATA_OFFSET, false)",
          "new_api": null,
          "old_text": " + DATA_OFFSET, false)",
          "new_text": null,
          "old_line_content": "\t\t\t\tT *_data_ptr = _get_data_ptr(mem_new);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": "",
          "new_api": null,
          "old_text": "",
          "new_text": null,
          "old_line_content": "\t_unref(_ptr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 353,
          "old_api": "fc_ptr) SafeNumeric<USize>(rc); //refcount\n\n\t\t\t\t_ptr = _data_ptr;\n\t\t\t}\n\t\t}\n\n\t\t// constru",
          "new_api": null,
          "old_text": "fc_ptr) SafeNumeric<USize>(rc); //refcount\n\n\t\t\t\t_ptr = _data_ptr;\n\t\t\t}\n\t\t}\n\n\t\t// constru",
          "new_text": null,
          "old_line_content": "\t\t\t\tuint8_t *mem_new = (uint8_t *)Memory::realloc_static(((uint8_t *)_ptr) - DATA_OFFSET, alloc_size + DATA_OFFSET, false);",
          "new_line_content": "\t\t\t\t_ptr = _data_ptr;",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": "newly created elements\n\n\t\tif constexpr (!s",
          "new_api": null,
          "old_text": " newly created elements\n\n\t\tif constexpr (!s",
          "new_text": null,
          "old_line_content": "\t\t\t\tERR_FAIL_NULL_V(mem_new, ERR_OUT_OF_MEMORY);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": "wData<T> &p_from)",
          "new_api": null,
          "old_text": "wData<T> &p_from)",
          "new_text": null,
          "old_line_content": "\t\tset(p_pos, p_val);",
          "new_line_content": "\t\tfor (Size i = new_size - 1; i > p_pos; i--) {",
          "content_same": false
        },
        {
          "line": 368,
          "old_api": "stexpr (!st",
          "new_api": null,
          "old_text": "stexpr (!st",
          "new_text": null,
          "old_line_content": "\t\t\tfor (Size i = *_get_size(); i < p_size; i++) {",
          "new_line_content": "\t\t// construct the newly created elements",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": "ially_destru",
          "new_api": null,
          "old_text": "ially_destru",
          "new_text": null,
          "old_line_content": "\t_FORCE_INLINE_ CowData(CowData<T> &p_from) { _ref(p_from); };",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": "ble_v<T>) {\n\t\t\t// deinitializ",
          "new_api": null,
          "old_text": "ble_v<T>) {\n\t\t\t// deinitializ",
          "new_text": null,
          "old_line_content": "\t\t\t\tmemnew_placement(&_ptr[i], T);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": "_OUT_OF_MEM",
          "new_api": null,
          "old_text": "_OUT_OF_MEM",
          "new_text": null,
          "old_line_content": "\t\t\tfor (USize i = p_size; i < *_get_size(); i++) {",
          "new_line_content": "\t} else if (p_size < current_size) {",
          "content_same": false
        },
        {
          "line": 250,
          "old_api": "tructors\n\t\t\tdat",
          "new_api": null,
          "old_text": "tructors\n\t\t\tdat",
          "new_text": null,
          "old_line_content": "\tSafeNumeric<USize> *refc = _get_refcount();",
          "new_line_content": "\t\treturn;",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": ");\n\t\t}\n\t}\n\n\t// fr",
          "new_api": null,
          "old_text": ");\n\t\t}\n\t}\n\n\t// fr",
          "new_text": null,
          "old_line_content": "\tif (refc->decrement() > 0) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": "c_ptr =",
          "new_api": null,
          "old_text": "c_ptr =",
          "new_text": null,
          "old_line_content": "\t\t\t\tt->~T();",
          "new_line_content": "\t\t\t// deinitialize no longer needed elements",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 22,
      "total_additions": 42,
      "total_deletions": 42,
      "total_api_changes": 106
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 12,
        "api_related_lines": 106,
        "non_api_lines": 8,
        "non_api_line_numbers": [
          232,
          234,
          236,
          238,
          240,
          242,
          246,
          248
        ]
      }
    },
    "api_calls_before": 101,
    "api_calls_after": 98,
    "diff_info": {
      "added_lines": 10,
      "removed_lines": 7,
      "total_diff_lines": 49
    }
  }
}