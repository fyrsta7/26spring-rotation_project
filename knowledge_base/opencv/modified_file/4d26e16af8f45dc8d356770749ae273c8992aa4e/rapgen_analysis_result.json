{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/opencv/modified_file/4d26e16af8f45dc8d356770749ae273c8992aa4e",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/opencv/modified_file/4d26e16af8f45dc8d356770749ae273c8992aa4e/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/opencv/modified_file/4d26e16af8f45dc8d356770749ae273c8992aa4e/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/opencv/modified_file/4d26e16af8f45dc8d356770749ae273c8992aa4e/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 374,
          "old_api": "reserve",
          "new_api": "isSimple",
          "old_text": "res.body.pts.reserve(200)",
          "new_text": "isSimple()",
          "old_line_content": "        res.body.pts.reserve(200);",
          "new_line_content": "    if (isSimple())",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": "isInt",
          "new_api": "icvFetchContourEx<int>(this->image, start_pt, 0, res.body, isDirect)",
          "old_text": "isInt()",
          "new_text": "icvFetchContourEx<int>(this->image, start_pt, 0, res.body, isDirect)",
          "old_line_content": "        if (isInt())",
          "new_line_content": "            icvFetchContourEx<int>(this->image, start_pt, 0, res.body, isDirect);",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": "this->image.at<int>(last_pos.y, last_pos.x)",
          "new_api": "findFirstBoundingContour",
          "old_text": "this->image.at<int>(last_pos.y, last_pos.x)",
          "new_text": "findFirstBoundingContour(last_pos, y, lval, main_parent)",
          "old_line_content": "            lval = this->image.at<int>(last_pos.y, last_pos.x) & MASK8_LVAL;",
          "new_line_content": "        main_parent = findFirstBoundingContour(last_pos, y, lval, main_parent);",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": "size",
          "new_api": "this->image.at<int>(y, x)",
          "old_text": "this->image.size()",
          "new_text": "this->image.at<int>(y, x)",
          "old_line_content": "    const int width = this->image.size().width - 1;",
          "new_line_content": "               ((p = this->image.at<int>(y, x)) == prev || (p & MASK_VAL) == (prev & MASK_VAL));",
          "content_same": false
        },
        {
          "line": 568,
          "old_api": "vx_setall_u8",
          "new_api": "v_check_any",
          "old_text": "vx_setall_u8((uchar)prev)",
          "new_text": "v_check_any(vmask)",
          "old_line_content": "            v_uint8 v_prev = vx_setall_u8((uchar)prev);",
          "new_line_content": "                if (v_check_any(vmask))",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": "this->image.ptr<uchar>(y, x)",
          "new_api": "this->image.at<schar>(y, x)",
          "old_text": "this->image.ptr<uchar>(y, x)",
          "new_text": "this->image.at<schar>(y, x)",
          "old_line_content": "                v_uint8 vmask = (v_ne(vx_load(this->image.ptr<uchar>(y, x)), v_prev));",
          "new_line_content": "                    p = this->image.at<schar>(y, x);",
          "content_same": false
        },
        {
          "line": 640,
          "old_api": "CV_LOG_ONCE_WARNING",
          "new_api": "needed",
          "old_text": "CV_LOG_ONCE_WARNING(NULL,\n                            \"LINK_RUNS mode has been extracted to separate function: \"\n                            \"cv::findContoursLinkRuns. \"\n                            \"Calling through cv::findContours will be removed in future.\")",
          "new_text": "_hierarchy.needed()",
          "old_line_content": "        CV_LOG_ONCE_WARNING(NULL,",
          "new_line_content": "        CV_CheckTrue(!_hierarchy.needed() || mode == RETR_CCOMP,",
          "content_same": false
        },
        {
          "line": 660,
          "old_api": "kind",
          "new_api": "empty",
          "old_text": "_contours.kind()",
          "new_text": "_contours.empty()",
          "old_line_content": "              (_contours.kind() == _InputArray::STD_VECTOR_MAT) ||",
          "new_line_content": "    if (!_contours.empty())",
          "content_same": false
        },
        {
          "line": 672,
          "old_api": "clear",
          "new_api": "Scalar",
          "old_text": "_hierarchy.clear()",
          "new_text": "Scalar(0)",
          "old_line_content": "        _hierarchy.clear();",
          "new_line_content": "    copyMakeBorder(_image, image, 1, 1, 1, 1, BORDER_CONSTANT | BORDER_ISOLATED, Scalar(0));",
          "content_same": false
        },
        {
          "line": 677,
          "old_api": "type",
          "new_api": "Point",
          "old_text": "image.type()",
          "new_text": "Point(-1, -1)",
          "old_line_content": "    if (image.type() != CV_32SC1)",
          "new_line_content": "    ContourScanner scanner = ContourScanner_::create(image, mode, method, offset + Point(-1, -1));",
          "content_same": false
        },
        {
          "line": 678,
          "old_api": "threshold",
          "new_api": "findNext",
          "old_text": "threshold(image, image, 0, 1, THRESH_BINARY)",
          "new_text": "scanner->findNext()",
          "old_line_content": "        threshold(image, image, 0, 1, THRESH_BINARY);",
          "new_line_content": "    while (scanner->findNext())",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": "findNext",
          "new_api": "contourTreeToResults",
          "old_text": "scanner->findNext()",
          "new_text": "contourTreeToResults(scanner->tree, res_type, _contours, _hierarchy)",
          "old_line_content": "    while (scanner->findNext())",
          "new_line_content": "    contourTreeToResults(scanner->tree, res_type, _contours, _hierarchy);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 642,
          "old_api": null,
          "new_api": "findContoursLinkRuns",
          "old_text": null,
          "new_text": "findContoursLinkRuns(_image, _contours, _hierarchy)",
          "old_line_content": "                            \"cv::findContoursLinkRuns. \"",
          "new_line_content": "        findContoursLinkRuns(_image, _contours, _hierarchy);",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": null,
          "new_api": "elem",
          "old_text": null,
          "new_text": "tree.elem(cur)",
          "old_line_content": "    int res = par;",
          "new_line_content": "        CNode& cur_elem = tree.elem(cur);",
          "content_same": false
        },
        {
          "line": 649,
          "old_api": null,
          "new_api": "CV_LOG_ONCE_WARNING",
          "old_text": null,
          "new_text": "CV_LOG_ONCE_WARNING(NULL,\n                            \"Chain code output is an experimental feature and might change in \"\n                            \"future!\")",
          "old_line_content": "",
          "new_line_content": "        CV_LOG_ONCE_WARNING(NULL,",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": null,
          "new_api": "icvFetchContourEx<schar>(this->image, start_pt, lval, res.body, isDirect)",
          "old_text": null,
          "new_text": "icvFetchContourEx<schar>(this->image, start_pt, lval, res.body, isDirect)",
          "old_line_content": "            // change nbd",
          "new_line_content": "            icvFetchContourEx<schar>(this->image, start_pt, lval, res.body, isDirect);",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": null,
          "new_api": "elem",
          "old_text": null,
          "new_text": "tree.elem(res)",
          "old_line_content": "            ((last_pos.y - cur_elem.body.brect.y) < cur_elem.body.brect.height))",
          "new_line_content": "                CNode& res_elem = tree.elem(res);",
          "content_same": false
        },
        {
          "line": 527,
          "old_api": null,
          "new_api": "isInt",
          "old_text": null,
          "new_text": "isInt()",
          "old_line_content": "            {",
          "new_line_content": "                if (isInt())",
          "content_same": false
        },
        {
          "line": 655,
          "old_api": null,
          "new_api": "kind",
          "old_text": null,
          "new_text": "_contours.kind()",
          "old_line_content": "                            \"future!\");",
          "new_line_content": "    CV_Assert((_contours.kind() == _InputArray::STD_VECTOR_VECTOR) ||",
          "content_same": false
        },
        {
          "line": 529,
          "old_api": null,
          "new_api": "icvTraceContour<int>(this->image, origin, end_point, isHole)",
          "old_text": null,
          "new_text": "icvTraceContour<int>(this->image, origin, end_point, isHole)",
          "old_line_content": "                const Point origin = res_elem.body.origin;",
          "new_line_content": "                    if (icvTraceContour<int>(this->image, origin, end_point, isHole))",
          "content_same": false
        },
        {
          "line": 656,
          "old_api": null,
          "new_api": "kind",
          "old_text": null,
          "new_text": "_contours.kind()",
          "old_line_content": "    }",
          "new_line_content": "              (_contours.kind() == _InputArray::STD_VECTOR_MAT) ||",
          "content_same": false
        },
        {
          "line": 657,
          "old_api": null,
          "new_api": "kind",
          "old_text": null,
          "new_text": "_contours.kind()",
          "old_line_content": "",
          "new_line_content": "              (_contours.kind() == _InputArray::STD_VECTOR_UMAT));",
          "content_same": false
        },
        {
          "line": 399,
          "old_api": null,
          "new_api": "self",
          "old_text": null,
          "new_text": "res.self()",
          "old_line_content": "        }",
          "new_line_content": "        this->ctable[lval] = res.self();",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": null,
          "new_api": "CV_Assert",
          "old_text": null,
          "new_text": "CV_Assert(res.body.isChain)",
          "old_line_content": "    const Point prev_origin = res.body.origin;",
          "new_line_content": "        CV_Assert(res.body.isChain);",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": null,
          "new_api": "icvTraceContour<schar>(this->image, origin, end_point, isHole)",
          "old_text": null,
          "new_text": "icvTraceContour<schar>(this->image, origin, end_point, isHole)",
          "old_line_content": "                        break;",
          "new_line_content": "                    if (icvTraceContour<schar>(this->image, origin, end_point, isHole))",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": null,
          "new_api": "type",
          "old_text": null,
          "new_text": "_contours.type()",
          "old_line_content": "",
          "new_line_content": "        CV_CheckTypeEQ(_contours.type(),",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": null,
          "new_api": "approximateChainTC89",
          "old_text": null,
          "new_text": "approximateChainTC89(res.body.codes, prev_origin, this->approx_method2)",
          "old_line_content": "    res.body.origin = start_pt;",
          "new_line_content": "        res.body.pts = approximateChainTC89(res.body.codes, prev_origin, this->approx_method2);",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": null,
          "new_api": "needed",
          "old_text": null,
          "new_text": "_hierarchy.needed()",
          "old_line_content": "                       res_type,",
          "new_line_content": "    if (_hierarchy.needed())",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "_hierarchy.clear()",
          "old_line_content": "                       \"Contours must have type CV_8SC1 (chain code) or CV_32SC2 (other methods)\");",
          "new_line_content": "        _hierarchy.clear();",
          "content_same": false
        },
        {
          "line": 673,
          "old_api": null,
          "new_api": "type",
          "old_text": null,
          "new_text": "image.type()",
          "old_line_content": "",
          "new_line_content": "    if (image.type() != CV_32SC1)",
          "content_same": false
        },
        {
          "line": 674,
          "old_api": null,
          "new_api": "threshold",
          "old_text": null,
          "new_text": "threshold(image, image, 0, 1, THRESH_BINARY)",
          "old_line_content": "    // preprocess",
          "new_line_content": "        threshold(image, image, 0, 1, THRESH_BINARY);",
          "content_same": false
        },
        {
          "line": 547,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "this->image.size()",
          "old_line_content": "}",
          "new_line_content": "    const int width = this->image.size().width - 1;",
          "content_same": false
        },
        {
          "line": 548,
          "old_api": null,
          "new_api": "isInt",
          "old_text": null,
          "new_text": "isInt()",
          "old_line_content": "",
          "new_line_content": "    if (isInt())",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": null,
          "new_api": "isInt",
          "old_text": null,
          "new_text": "isInt()",
          "old_line_content": "{",
          "new_line_content": "    if (isInt())",
          "content_same": false
        },
        {
          "line": 558,
          "old_api": null,
          "new_api": "this->image.at<schar>(y, x)",
          "old_text": null,
          "new_text": "this->image.at<schar>(y, x)",
          "old_line_content": "    }",
          "new_line_content": "        if ((p = this->image.at<schar>(y, x)) != prev)",
          "content_same": false
        },
        {
          "line": 691,
          "old_api": null,
          "new_api": "CV_INSTRUMENT_REGION",
          "old_text": null,
          "new_text": "CV_INSTRUMENT_REGION()",
          "old_line_content": "                      int mode,",
          "new_line_content": "    CV_INSTRUMENT_REGION();",
          "content_same": false
        },
        {
          "line": 564,
          "old_api": null,
          "new_api": "vx_setall_u8",
          "old_text": null,
          "new_text": "vx_setall_u8((uchar)prev)",
          "old_line_content": "            return x;",
          "new_line_content": "            v_uint8 v_prev = vx_setall_u8((uchar)prev);",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": null,
          "new_api": "VTraits<v_uint8>::vlanes()",
          "old_text": null,
          "new_text": "VTraits<v_uint8>::vlanes()",
          "old_line_content": "        }",
          "new_line_content": "            for (; x <= width - VTraits<v_uint8>::vlanes(); x += VTraits<v_uint8>::vlanes())",
          "content_same": false
        },
        {
          "line": 692,
          "old_api": null,
          "new_api": "noArray",
          "old_text": null,
          "new_text": "noArray()",
          "old_line_content": "                      int method,",
          "new_line_content": "    findContours(_image, _contours, noArray(), mode, method, offset);",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": null,
          "new_api": "this->image.ptr<uchar>(y, x)",
          "old_text": null,
          "new_text": "this->image.ptr<uchar>(y, x)",
          "old_line_content": "        {",
          "new_line_content": "                v_uint8 vmask = (v_ne(vx_load(this->image.ptr<uchar>(y, x)), v_prev));",
          "content_same": false
        },
        {
          "line": 570,
          "old_api": null,
          "new_api": "v_scan_forward",
          "old_text": null,
          "new_text": "v_scan_forward(vmask)",
          "old_line_content": "            {",
          "new_line_content": "                    x += v_scan_forward(vmask);",
          "content_same": false
        },
        {
          "line": 446,
          "old_api": null,
          "new_api": "this->image.at<schar>(last_pos)",
          "old_text": null,
          "new_text": "this->image.at<schar>(last_pos)",
          "old_line_content": "            is_hole = true;",
          "new_line_content": "    if (mode == RETR_EXTERNAL && (is_hole || this->image.at<schar>(last_pos) > 0))",
          "content_same": false
        },
        {
          "line": 577,
          "old_api": null,
          "new_api": "this->image.at<schar>(y, x)",
          "old_text": null,
          "new_text": "this->image.at<schar>(y, x)",
          "old_line_content": "                }",
          "new_line_content": "        for (; x < width && (p = this->image.at<schar>(y, x)) == prev; x++)",
          "content_same": false
        },
        {
          "line": 453,
          "old_api": null,
          "new_api": "isSimple",
          "old_text": null,
          "new_text": "isSimple()",
          "old_line_content": "    }",
          "new_line_content": "    if (isSimple() || (!is_hole && (mode == RETR_CCOMP || mode == RETR_FLOODFILL)) ||",
          "content_same": false
        },
        {
          "line": 587,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "this->image.size()",
          "old_line_content": "bool ContourScanner_::findNext()",
          "new_line_content": "    int width = this->image.size().width - 1;",
          "content_same": false
        },
        {
          "line": 588,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "this->image.size()",
          "old_line_content": "{",
          "new_line_content": "    int height = this->image.size().height - 1;",
          "content_same": false
        },
        {
          "line": 461,
          "old_api": null,
          "new_api": "isInt",
          "old_text": null,
          "new_text": "isInt()",
          "old_line_content": "    }",
          "new_line_content": "        if (isInt())",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": null,
          "new_api": "this->image.at<schar>(y, x - 1)",
          "old_text": null,
          "new_text": "this->image.at<schar>(y, x - 1)",
          "old_line_content": "    int y = this->pt.y;",
          "new_line_content": "    int prev = isInt() ? this->image.at<int>(y, x - 1) : this->image.at<schar>(y, x - 1);",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": null,
          "new_api": "this->image.at<int>(last_pos.y, last_pos.x)",
          "old_text": null,
          "new_text": "this->image.at<int>(last_pos.y, last_pos.x)",
          "old_line_content": "    else",
          "new_line_content": "            lval = this->image.at<int>(last_pos.y, last_pos.x) & MASK8_LVAL;",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": null,
          "new_api": "this->image.at<schar>(last_pos.y, last_pos.x)",
          "old_text": null,
          "new_text": "this->image.at<schar>(last_pos.y, last_pos.x)",
          "old_line_content": "        int lval;",
          "new_line_content": "            lval = this->image.at<schar>(last_pos.y, last_pos.x) & MASK8_LVAL;",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": null,
          "new_api": "findNextX",
          "old_text": null,
          "new_text": "findNextX(x, y, prev, p)",
          "old_line_content": "    {",
          "new_line_content": "            x = findNextX(x, y, prev, p);",
          "content_same": false
        },
        {
          "line": 600,
          "old_api": null,
          "new_api": "contourScan",
          "old_text": null,
          "new_text": "contourScan(prev, p, last_pos, x, y)",
          "old_line_content": "        {",
          "new_line_content": "            if (contourScan(prev, p, last_pos, x, y))",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": null,
          "new_api": "elem",
          "old_text": null,
          "new_text": "tree.elem(main_parent)",
          "old_line_content": "        // current contour is external and previous contour is external then",
          "new_line_content": "            CNode& main_parent_elem = tree.elem(main_parent);",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "isInt",
          "old_text": null,
          "new_text": "isInt()",
          "old_line_content": "            }",
          "new_line_content": "                if ((isInt() && (prev & MASK_FLAGS)) || (!isInt() && (prev & MASK8_FLAGS)))",
          "content_same": false
        },
        {
          "line": 614,
          "old_api": null,
          "new_api": "Point",
          "old_text": null,
          "new_text": "Point(0, y + 1)",
          "old_line_content": "                    last_pos.x = x;",
          "new_line_content": "        last_pos = Point(0, y + 1);",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": null,
          "new_api": "elem",
          "old_text": null,
          "new_text": "tree.elem(main_parent)",
          "old_line_content": "        }",
          "new_line_content": "            CNode& main_parent_elem = tree.elem(main_parent);",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": null,
          "new_api": "CV_Assert",
          "old_text": null,
          "new_text": "CV_Assert(main_parent_elem.body.isHole != is_hole)",
          "old_line_content": "",
          "new_line_content": "            CV_Assert(main_parent_elem.body.isHole != is_hole);",
          "content_same": false
        },
        {
          "line": 497,
          "old_api": null,
          "new_api": "makeContour",
          "old_text": null,
          "new_text": "makeContour(nbd_, is_hole, x, y)",
          "old_line_content": "",
          "new_line_content": "    CNode& new_contour = makeContour(nbd_, is_hole, x, y);",
          "content_same": false
        },
        {
          "line": 500,
          "old_api": null,
          "new_api": "self",
          "old_text": null,
          "new_text": "new_contour.self()",
          "old_line_content": "    schar nbd_ = this->nbd;",
          "new_line_content": "        tree.addChild(main_parent, new_contour.self());",
          "content_same": false
        },
        {
          "line": 502,
          "old_api": null,
          "new_api": "isInt",
          "old_text": null,
          "new_text": "isInt()",
          "old_line_content": "    if (new_contour.parent == -1)",
          "new_line_content": "    this->pt.x = !isInt() ? (x + 1) : (x + 1 - (is_hole ? 1 : 0));",
          "content_same": false
        },
        {
          "line": 631,
          "old_api": null,
          "new_api": "CV_INSTRUMENT_REGION",
          "old_text": null,
          "new_text": "CV_INSTRUMENT_REGION()",
          "old_line_content": "                      int mode,",
          "new_line_content": "    CV_INSTRUMENT_REGION();",
          "content_same": false
        },
        {
          "line": 376,
          "old_api": null,
          "new_api": "icvFetchContourEx<schar>(this->image, start_pt, MASK8_NEW, res.body, isDirect)",
          "old_text": null,
          "new_text": "icvFetchContourEx<schar>(this->image, start_pt, MASK8_NEW, res.body, isDirect)",
          "old_line_content": "    res.body.isChain = isChain;",
          "new_line_content": "        icvFetchContourEx<schar>(this->image, start_pt, MASK8_NEW, res.body, isDirect);",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": null,
          "new_api": "CV_LOG_ONCE_WARNING",
          "old_text": null,
          "new_text": "CV_LOG_ONCE_WARNING(NULL,\n                            \"LINK_RUNS mode has been extracted to separate function: \"\n                            \"cv::findContoursLinkRuns. \"\n                            \"Calling through cv::findContours will be removed in future.\")",
          "old_line_content": "",
          "new_line_content": "        CV_LOG_ONCE_WARNING(NULL,",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": null,
          "new_api": "isInt",
          "old_text": null,
          "new_text": "isInt()",
          "old_line_content": "    }",
          "new_line_content": "        if (isInt())",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": null,
          "new_api": "this->image.at<int>(start_pt)",
          "old_text": null,
          "new_text": "this->image.at<int>(start_pt)",
          "old_line_content": "    {",
          "new_line_content": "            const int start_val = this->image.at<int>(start_pt);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 387,
          "old_api": "this->image.at<int>(start_pt)",
          "new_api": null,
          "old_text": "this->image.at<int>(start_pt)",
          "new_text": null,
          "old_line_content": "            const int start_val = this->image.at<int>(start_pt);",
          "new_line_content": "        else",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": "needed",
          "new_api": null,
          "old_text": "_hierarchy.needed()",
          "new_text": null,
          "old_line_content": "        CV_CheckTrue(!_hierarchy.needed() || mode == RETR_CCOMP,",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": "icvFetchContourEx<int>(this->image, start_pt, 0, res.body, isDirect)",
          "new_api": null,
          "old_text": "icvFetchContourEx<int>(this->image, start_pt, 0, res.body, isDirect)",
          "new_text": null,
          "old_line_content": "            icvFetchContourEx<int>(this->image, start_pt, 0, res.body, isDirect);",
          "new_line_content": "            lval = nbd_;",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": "findContoursLinkRuns",
          "new_api": null,
          "old_text": "findContoursLinkRuns(_image, _contours, _hierarchy)",
          "new_text": null,
          "old_line_content": "        findContoursLinkRuns(_image, _contours, _hierarchy);",
          "new_line_content": "    // TODO: need enum value, need way to return contour starting points with chain codes",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": "elem",
          "new_api": null,
          "old_text": "tree.elem(cur)",
          "new_text": null,
          "old_line_content": "        CNode& cur_elem = tree.elem(cur);",
          "new_line_content": "            if (res != -1)",
          "content_same": false
        },
        {
          "line": 653,
          "old_api": "CV_LOG_ONCE_WARNING",
          "new_api": null,
          "old_text": "CV_LOG_ONCE_WARNING(NULL,\n                            \"Chain code output is an experimental feature and might change in \"\n                            \"future!\")",
          "new_text": null,
          "old_line_content": "        CV_LOG_ONCE_WARNING(NULL,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": "icvFetchContourEx<schar>(this->image, start_pt, lval, res.body, isDirect)",
          "new_api": null,
          "old_text": "icvFetchContourEx<schar>(this->image, start_pt, lval, res.body, isDirect)",
          "new_text": null,
          "old_line_content": "            icvFetchContourEx<schar>(this->image, start_pt, lval, res.body, isDirect);",
          "new_line_content": "        res.ctable_next = this->ctable[lval];",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": "elem",
          "new_api": null,
          "old_text": "tree.elem(res)",
          "new_text": null,
          "old_line_content": "                CNode& res_elem = tree.elem(res);",
          "new_line_content": "                {",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": "isInt",
          "new_api": null,
          "old_text": "isInt()",
          "new_text": null,
          "old_line_content": "                if (isInt())",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 659,
          "old_api": "kind",
          "new_api": null,
          "old_text": "_contours.kind()",
          "new_text": null,
          "old_line_content": "    CV_Assert((_contours.kind() == _InputArray::STD_VECTOR_VECTOR) ||",
          "new_line_content": "    const int res_type = (method == 0 /*CV_CHAIN_CODE*/) ? CV_8SC1 : CV_32SC2;",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": "icvTraceContour<int>(this->image, origin, end_point, isHole)",
          "new_api": null,
          "old_text": "icvTraceContour<int>(this->image, origin, end_point, isHole)",
          "new_text": null,
          "old_line_content": "                    if (icvTraceContour<int>(this->image, origin, end_point, isHole))",
          "new_line_content": "                {",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": "kind",
          "new_api": null,
          "old_text": "_contours.kind()",
          "new_text": null,
          "old_line_content": "              (_contours.kind() == _InputArray::STD_VECTOR_UMAT));",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": "self",
          "new_api": null,
          "old_text": "res.self()",
          "new_text": null,
          "old_line_content": "        this->ctable[lval] = res.self();",
          "new_line_content": "    if (this->approx_method1 != this->approx_method2)",
          "content_same": false
        },
        {
          "line": 664,
          "old_api": "empty",
          "new_api": null,
          "old_text": "_contours.empty()",
          "new_text": null,
          "old_line_content": "    if (!_contours.empty())",
          "new_line_content": "                       \"Contours must have type CV_8SC1 (chain code) or CV_32SC2 (other methods)\");",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": "CV_Assert",
          "new_api": null,
          "old_text": "CV_Assert(res.body.isChain)",
          "new_text": null,
          "old_line_content": "        CV_Assert(res.body.isChain);",
          "new_line_content": "    return res;",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": "icvTraceContour<schar>(this->image, origin, end_point, isHole)",
          "new_api": null,
          "old_text": "icvTraceContour<schar>(this->image, origin, end_point, isHole)",
          "new_text": null,
          "old_line_content": "                    if (icvTraceContour<schar>(this->image, origin, end_point, isHole))",
          "new_line_content": "            res = cur;",
          "content_same": false
        },
        {
          "line": 666,
          "old_api": "type",
          "new_api": null,
          "old_text": "_contours.type()",
          "new_text": null,
          "old_line_content": "        CV_CheckTypeEQ(_contours.type(),",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 410,
          "old_api": "approximateChainTC89",
          "new_api": null,
          "old_text": "approximateChainTC89(res.body.codes, prev_origin, this->approx_method2)",
          "new_text": null,
          "old_line_content": "        res.body.pts = approximateChainTC89(res.body.codes, prev_origin, this->approx_method2);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": "needed",
          "new_api": null,
          "old_text": "_hierarchy.needed()",
          "new_text": null,
          "old_line_content": "    if (_hierarchy.needed())",
          "new_line_content": "    Mat image;",
          "content_same": false
        },
        {
          "line": 676,
          "old_api": "Scalar",
          "new_api": null,
          "old_text": "Scalar(0)",
          "new_text": null,
          "old_line_content": "    copyMakeBorder(_image, image, 1, 1, 1, 1, BORDER_CONSTANT | BORDER_ISOLATED, Scalar(0));",
          "new_line_content": "    // find contours",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": "isInt",
          "new_api": null,
          "old_text": "isInt()",
          "new_text": null,
          "old_line_content": "    if (isInt())",
          "new_line_content": "            if ((prev & MASK_FLAGS) != 0 || ((p & MASK_FLAGS) != 0))",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": "isInt",
          "new_api": null,
          "old_text": "isInt()",
          "new_text": null,
          "old_line_content": "    if (isInt())",
          "new_line_content": "             x++)",
          "content_same": false
        },
        {
          "line": 681,
          "old_api": "Point",
          "new_api": null,
          "old_text": "Point(-1, -1)",
          "new_text": null,
          "old_line_content": "    ContourScanner scanner = ContourScanner_::create(image, mode, method, offset + Point(-1, -1));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 555,
          "old_api": "this->image.at<int>(y, x)",
          "new_api": null,
          "old_text": "this->image.at<int>(y, x)",
          "new_text": null,
          "old_line_content": "               ((p = this->image.at<int>(y, x)) == prev || (p & MASK_VAL) == (prev & MASK_VAL));",
          "new_line_content": "    else",
          "content_same": false
        },
        {
          "line": 686,
          "old_api": "contourTreeToResults",
          "new_api": null,
          "old_text": "contourTreeToResults(scanner->tree, res_type, _contours, _hierarchy)",
          "new_text": null,
          "old_line_content": "    contourTreeToResults(scanner->tree, res_type, _contours, _hierarchy);",
          "new_line_content": "                      OutputArrayOfArrays _contours,",
          "content_same": false
        },
        {
          "line": 562,
          "old_api": "this->image.at<schar>(y, x)",
          "new_api": null,
          "old_text": "this->image.at<schar>(y, x)",
          "new_text": null,
          "old_line_content": "        if ((p = this->image.at<schar>(y, x)) != prev)",
          "new_line_content": "        else",
          "content_same": false
        },
        {
          "line": 695,
          "old_api": "CV_INSTRUMENT_REGION",
          "new_api": null,
          "old_text": "CV_INSTRUMENT_REGION()",
          "new_text": null,
          "old_line_content": "    CV_INSTRUMENT_REGION();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 696,
          "old_api": "noArray",
          "new_api": null,
          "old_text": "noArray()",
          "new_text": null,
          "old_line_content": "    findContours(_image, _contours, noArray(), mode, method, offset);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "VTraits<v_uint8>::vlanes()",
          "new_api": null,
          "old_text": "VTraits<v_uint8>::vlanes()",
          "new_text": null,
          "old_line_content": "            for (; x <= width - VTraits<v_uint8>::vlanes(); x += VTraits<v_uint8>::vlanes())",
          "new_line_content": "                {",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": "v_check_any",
          "new_api": null,
          "old_text": "v_check_any(vmask)",
          "new_text": null,
          "old_line_content": "                if (v_check_any(vmask))",
          "new_line_content": "                    return x;",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": "v_scan_forward",
          "new_api": null,
          "old_text": "v_scan_forward(vmask)",
          "new_text": null,
          "old_line_content": "                    x += v_scan_forward(vmask);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": "this->image.at<schar>(y, x)",
          "new_api": null,
          "old_text": "this->image.at<schar>(y, x)",
          "new_text": null,
          "old_line_content": "                    p = this->image.at<schar>(y, x);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 450,
          "old_api": "this->image.at<schar>(last_pos)",
          "new_api": null,
          "old_text": "this->image.at<schar>(last_pos)",
          "new_text": null,
          "old_line_content": "    if (mode == RETR_EXTERNAL && (is_hole || this->image.at<schar>(last_pos) > 0))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 581,
          "old_api": "this->image.at<schar>(y, x)",
          "new_api": null,
          "old_text": "this->image.at<schar>(y, x)",
          "new_text": null,
          "old_line_content": "        for (; x < width && (p = this->image.at<schar>(y, x)) == prev; x++)",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": "isSimple",
          "new_api": null,
          "old_text": "isSimple()",
          "new_text": null,
          "old_line_content": "    if (isSimple() || (!is_hole && (mode == RETR_CCOMP || mode == RETR_FLOODFILL)) ||",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 591,
          "old_api": "size",
          "new_api": null,
          "old_text": "this->image.size()",
          "new_text": null,
          "old_line_content": "    int width = this->image.size().width - 1;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": "size",
          "new_api": null,
          "old_text": "this->image.size()",
          "new_text": null,
          "old_line_content": "    int height = this->image.size().height - 1;",
          "new_line_content": "    for (; y < height; y++)",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": "isInt",
          "new_api": null,
          "old_text": "isInt()",
          "new_text": null,
          "old_line_content": "        if (isInt())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": "this->image.at<schar>(y, x - 1)",
          "new_api": null,
          "old_text": "this->image.at<schar>(y, x - 1)",
          "new_text": null,
          "old_line_content": "    int prev = isInt() ? this->image.at<int>(y, x - 1) : this->image.at<schar>(y, x - 1);",
          "new_line_content": "        int p = 0;",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": "this->image.at<schar>(last_pos.y, last_pos.x)",
          "new_api": null,
          "old_text": "this->image.at<schar>(last_pos.y, last_pos.x)",
          "new_text": null,
          "old_line_content": "            lval = this->image.at<schar>(last_pos.y, last_pos.x) & MASK8_LVAL;",
          "new_line_content": "        // if current contour is a hole and previous contour is a hole or",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": "findFirstBoundingContour",
          "new_api": null,
          "old_text": "findFirstBoundingContour(last_pos, y, lval, main_parent)",
          "new_text": null,
          "old_line_content": "        main_parent = findFirstBoundingContour(last_pos, y, lval, main_parent);",
          "new_line_content": "        // the parent of the contour is the parent of the previous contour else",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": "findNextX",
          "new_api": null,
          "old_text": "findNextX(x, y, prev, p)",
          "new_text": null,
          "old_line_content": "            x = findNextX(x, y, prev, p);",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 604,
          "old_api": "contourScan",
          "new_api": null,
          "old_text": "contourScan(prev, p, last_pos, x, y)",
          "new_text": null,
          "old_line_content": "            if (contourScan(prev, p, last_pos, x, y))",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": "elem",
          "new_api": null,
          "old_text": "tree.elem(main_parent)",
          "new_text": null,
          "old_line_content": "            CNode& main_parent_elem = tree.elem(main_parent);",
          "new_line_content": "                {",
          "content_same": false
        },
        {
          "line": 612,
          "old_api": "isInt",
          "new_api": null,
          "old_text": "isInt()",
          "new_text": null,
          "old_line_content": "                if ((isInt() && (prev & MASK_FLAGS)) || (!isInt() && (prev & MASK8_FLAGS)))",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": "Point",
          "new_api": null,
          "old_text": "Point(0, y + 1)",
          "new_text": null,
          "old_line_content": "        last_pos = Point(0, y + 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": "elem",
          "new_api": null,
          "old_text": "tree.elem(main_parent)",
          "new_text": null,
          "old_line_content": "            CNode& main_parent_elem = tree.elem(main_parent);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": "CV_Assert",
          "new_api": null,
          "old_text": "CV_Assert(main_parent_elem.body.isHole != is_hole)",
          "new_text": null,
          "old_line_content": "            CV_Assert(main_parent_elem.body.isHole != is_hole);",
          "new_line_content": "    last_pos.x = x - (is_hole ? 1 : 0);",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": "isInt",
          "new_api": null,
          "old_text": "isInt()",
          "new_text": null,
          "old_line_content": "    this->pt.x = !isInt() ? (x + 1) : (x + 1 - (is_hole ? 1 : 0));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": "reserve",
          "new_api": null,
          "old_text": "res.body.codes.reserve(200)",
          "new_text": null,
          "old_line_content": "        res.body.codes.reserve(200);",
          "new_line_content": "    res.body.isChain = isChain;",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": "makeContour",
          "new_api": null,
          "old_text": "makeContour(nbd_, is_hole, x, y)",
          "new_text": null,
          "old_line_content": "    CNode& new_contour = makeContour(nbd_, is_hole, x, y);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": "self",
          "new_api": null,
          "old_text": "new_contour.self()",
          "new_text": null,
          "old_line_content": "        tree.addChild(main_parent, new_contour.self());",
          "new_line_content": "    this->nbd = nbd_;",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": "isSimple",
          "new_api": null,
          "old_text": "isSimple()",
          "new_text": null,
          "old_line_content": "    if (isSimple())",
          "new_line_content": "    else",
          "content_same": false
        },
        {
          "line": 635,
          "old_api": "CV_INSTRUMENT_REGION",
          "new_api": null,
          "old_text": "CV_INSTRUMENT_REGION()",
          "new_text": null,
          "old_line_content": "    CV_INSTRUMENT_REGION();",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": "icvFetchContourEx<schar>(this->image, start_pt, MASK8_NEW, res.body, isDirect)",
          "new_api": null,
          "old_text": "icvFetchContourEx<schar>(this->image, start_pt, MASK8_NEW, res.body, isDirect)",
          "new_text": null,
          "old_line_content": "        icvFetchContourEx<schar>(this->image, start_pt, MASK8_NEW, res.body, isDirect);",
          "new_line_content": "        schar lval;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 12,
      "total_additions": 53,
      "total_deletions": 55,
      "total_api_changes": 120
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 4,
        "api_related_lines": 120,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 126,
    "api_calls_after": 124,
    "diff_info": {
      "added_lines": 1,
      "removed_lines": 5,
      "total_diff_lines": 27
    }
  }
}