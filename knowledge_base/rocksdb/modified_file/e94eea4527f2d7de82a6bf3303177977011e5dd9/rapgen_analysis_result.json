{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/rocksdb/modified_file/e94eea4527f2d7de82a6bf3303177977011e5dd9",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/rocksdb/modified_file/e94eea4527f2d7de82a6bf3303177977011e5dd9/before.cc",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/rocksdb/modified_file/e94eea4527f2d7de82a6bf3303177977011e5dd9/after.cc",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/rocksdb/modified_file/e94eea4527f2d7de82a6bf3303177977011e5dd9/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 70,
          "old_api": "size",
          "new_api": "Status::Corruption(\"malformed WriteBatch (too small)\")",
          "old_text": "input.size()",
          "new_text": "Status::Corruption(\"malformed WriteBatch (too small)\")",
          "old_line_content": "  if (input.size() < kHeader) {",
          "new_line_content": "    return Status::Corruption(\"malformed WriteBatch (too small)\");",
          "content_same": false
        },
        {
          "line": 83,
          "old_api": "GetLengthPrefixedSlice",
          "new_api": "Put",
          "old_text": "GetLengthPrefixedSlice(&input, &value)",
          "new_text": "handler->Put(key, value)",
          "old_line_content": "            GetLengthPrefixedSlice(&input, &value)) {",
          "new_line_content": "          handler->Put(key, value);",
          "content_same": false
        },
        {
          "line": 91,
          "old_api": "GetLengthPrefixedSlice",
          "new_api": "Delete",
          "old_text": "GetLengthPrefixedSlice(&input, &key)",
          "new_text": "handler->Delete(key)",
          "old_line_content": "        if (GetLengthPrefixedSlice(&input, &key)) {",
          "new_line_content": "          handler->Delete(key);",
          "content_same": false
        },
        {
          "line": 100,
          "old_api": "GetLengthPrefixedSlice",
          "new_api": "Merge",
          "old_text": "GetLengthPrefixedSlice(&input, &value)",
          "new_text": "handler->Merge(key, value)",
          "old_line_content": "            GetLengthPrefixedSlice(&input, &value)) {",
          "new_line_content": "          handler->Merge(key, value);",
          "content_same": false
        },
        {
          "line": 108,
          "old_api": "GetLengthPrefixedSlice",
          "new_api": "LogData",
          "old_text": "GetLengthPrefixedSlice(&input, &blob)",
          "new_text": "handler->LogData(blob)",
          "old_line_content": "        if (GetLengthPrefixedSlice(&input, &blob)) {",
          "new_line_content": "          handler->LogData(blob);",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": "WriteBatchInternal::Count(this)",
          "new_api": "Status::Corruption(\"WriteBatch has wrong count\")",
          "old_text": "WriteBatchInternal::Count(this)",
          "new_text": "Status::Corruption(\"WriteBatch has wrong count\")",
          "old_line_content": "  if (found != WriteBatchInternal::Count(this)) {",
          "new_line_content": "    return Status::Corruption(\"WriteBatch has wrong count\");",
          "content_same": false
        },
        {
          "line": 142,
          "old_api": "WriteBatchInternal::Count(this)",
          "new_api": "static_cast<char>(kTypeValue)",
          "old_text": "WriteBatchInternal::Count(this)",
          "new_text": "static_cast<char>(kTypeValue)",
          "old_line_content": "  WriteBatchInternal::SetCount(this, WriteBatchInternal::Count(this) + 1);",
          "new_line_content": "  rep_.push_back(static_cast<char>(kTypeValue));",
          "content_same": false
        },
        {
          "line": 143,
          "old_api": "static_cast<char>(kTypeValue)",
          "new_api": "PutLengthPrefixedSlice",
          "old_text": "static_cast<char>(kTypeValue)",
          "new_text": "PutLengthPrefixedSlice(&rep_, key)",
          "old_line_content": "  rep_.push_back(static_cast<char>(kTypeValue));",
          "new_line_content": "  PutLengthPrefixedSlice(&rep_, key);",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": "WriteBatchInternal::Count(this)",
          "new_api": "static_cast<char>(kTypeValue)",
          "old_text": "WriteBatchInternal::Count(this)",
          "new_text": "static_cast<char>(kTypeValue)",
          "old_line_content": "  WriteBatchInternal::SetCount(this, WriteBatchInternal::Count(this) + 1);",
          "new_line_content": "  rep_.push_back(static_cast<char>(kTypeValue));",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": "static_cast<char>(kTypeValue)",
          "new_api": "PutLengthPrefixedSliceParts",
          "old_text": "static_cast<char>(kTypeValue)",
          "new_text": "PutLengthPrefixedSliceParts(&rep_, key)",
          "old_line_content": "  rep_.push_back(static_cast<char>(kTypeValue));",
          "new_line_content": "  PutLengthPrefixedSliceParts(&rep_, key);",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": "WriteBatchInternal::Count(this)",
          "new_api": "static_cast<char>(kTypeDeletion)",
          "old_text": "WriteBatchInternal::Count(this)",
          "new_text": "static_cast<char>(kTypeDeletion)",
          "old_line_content": "  WriteBatchInternal::SetCount(this, WriteBatchInternal::Count(this) + 1);",
          "new_line_content": "  rep_.push_back(static_cast<char>(kTypeDeletion));",
          "content_same": false
        },
        {
          "line": 157,
          "old_api": "static_cast<char>(kTypeDeletion)",
          "new_api": "PutLengthPrefixedSlice",
          "old_text": "static_cast<char>(kTypeDeletion)",
          "new_text": "PutLengthPrefixedSlice(&rep_, key)",
          "old_line_content": "  rep_.push_back(static_cast<char>(kTypeDeletion));",
          "new_line_content": "  PutLengthPrefixedSlice(&rep_, key);",
          "content_same": false
        },
        {
          "line": 162,
          "old_api": "WriteBatchInternal::Count(this)",
          "new_api": "static_cast<char>(kTypeMerge)",
          "old_text": "WriteBatchInternal::Count(this)",
          "new_text": "static_cast<char>(kTypeMerge)",
          "old_line_content": "  WriteBatchInternal::SetCount(this, WriteBatchInternal::Count(this) + 1);",
          "new_line_content": "  rep_.push_back(static_cast<char>(kTypeMerge));",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": "static_cast<char>(kTypeMerge)",
          "new_api": "PutLengthPrefixedSlice",
          "old_text": "static_cast<char>(kTypeMerge)",
          "new_text": "PutLengthPrefixedSlice(&rep_, key)",
          "old_line_content": "  rep_.push_back(static_cast<char>(kTypeMerge));",
          "new_line_content": "  PutLengthPrefixedSlice(&rep_, key);",
          "content_same": false
        },
        {
          "line": 169,
          "old_api": "static_cast<char>(kTypeLogData)",
          "new_api": "PutLengthPrefixedSlice",
          "old_text": "static_cast<char>(kTypeLogData)",
          "new_text": "PutLengthPrefixedSlice(&rep_, blob)",
          "old_line_content": "  rep_.push_back(static_cast<char>(kTypeLogData));",
          "new_line_content": "  PutLengthPrefixedSlice(&rep_, blob);",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": "Update",
          "new_api": "get",
          "old_text": "mem_->Update(sequence_, kTypeValue, key, value)",
          "new_text": "options_->statistics.get()",
          "old_line_content": "        && mem_->Update(sequence_, kTypeValue, key, value)) {",
          "new_line_content": "      RecordTick(options_->statistics.get(), NUMBER_KEYS_UPDATED);",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": "KeyMayExist",
          "new_api": "get",
          "old_text": "db_->KeyMayExist(ropts, key, &value)",
          "new_text": "options_->statistics.get()",
          "old_line_content": "      if (!db_->KeyMayExist(ropts, key, &value)) {",
          "new_line_content": "        RecordTick(options_->statistics.get(), NUMBER_FILTERED_DELETES);",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": "Count",
          "new_api": "size",
          "old_text": "Count(src)",
          "new_text": "src->rep_.size()",
          "old_line_content": "  SetCount(dst, Count(dst) + Count(src));",
          "new_line_content": "  assert(src->rep_.size() >= kHeader);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 129,
          "old_api": null,
          "new_api": "EncodeFixed32",
          "old_text": null,
          "new_text": "EncodeFixed32(&b->rep_[8], n)",
          "old_line_content": "void WriteBatchInternal::SetCount(WriteBatch* b, int n) {",
          "new_line_content": "  EncodeFixed32(&b->rep_[8], n);",
          "content_same": false
        },
        {
          "line": 133,
          "old_api": null,
          "new_api": "data",
          "old_text": null,
          "new_text": "b->rep_.data()",
          "old_line_content": "SequenceNumber WriteBatchInternal::Sequence(const WriteBatch* b) {",
          "new_line_content": "  return SequenceNumber(DecodeFixed64(b->rep_.data()));",
          "content_same": false
        },
        {
          "line": 137,
          "old_api": null,
          "new_api": "EncodeFixed64",
          "old_text": null,
          "new_text": "EncodeFixed64(&b->rep_[0], seq)",
          "old_line_content": "void WriteBatchInternal::SetSequence(WriteBatch* b, SequenceNumber seq) {",
          "new_line_content": "  EncodeFixed64(&b->rep_[0], seq);",
          "content_same": false
        },
        {
          "line": 141,
          "old_api": null,
          "new_api": "WriteBatchInternal::Count(this)",
          "old_text": null,
          "new_text": "WriteBatchInternal::Count(this)",
          "old_line_content": "void WriteBatch::Put(const Slice& key, const Slice& value) {",
          "new_line_content": "  WriteBatchInternal::SetCount(this, WriteBatchInternal::Count(this) + 1);",
          "content_same": false
        },
        {
          "line": 148,
          "old_api": null,
          "new_api": "WriteBatchInternal::Count(this)",
          "old_text": null,
          "new_text": "WriteBatchInternal::Count(this)",
          "old_line_content": "void WriteBatch::Put(const SliceParts& key, const SliceParts& value) {",
          "new_line_content": "  WriteBatchInternal::SetCount(this, WriteBatchInternal::Count(this) + 1);",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": null,
          "new_api": "WriteBatchInternal::Count(this)",
          "old_text": null,
          "new_text": "WriteBatchInternal::Count(this)",
          "old_line_content": "void WriteBatch::Delete(const Slice& key) {",
          "new_line_content": "  WriteBatchInternal::SetCount(this, WriteBatchInternal::Count(this) + 1);",
          "content_same": false
        },
        {
          "line": 161,
          "old_api": null,
          "new_api": "WriteBatchInternal::Count(this)",
          "old_text": null,
          "new_text": "WriteBatchInternal::Count(this)",
          "old_line_content": "void WriteBatch::Merge(const Slice& key, const Slice& value) {",
          "new_line_content": "  WriteBatchInternal::SetCount(this, WriteBatchInternal::Count(this) + 1);",
          "content_same": false
        },
        {
          "line": 168,
          "old_api": null,
          "new_api": "static_cast<char>(kTypeLogData)",
          "old_text": null,
          "new_text": "static_cast<char>(kTypeLogData)",
          "old_line_content": "void WriteBatch::PutLogData(const Slice& blob) {",
          "new_line_content": "  rep_.push_back(static_cast<char>(kTypeLogData));",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": null,
          "new_api": "reinterpret_cast<DBImpl*>(db)",
          "old_text": null,
          "new_text": "reinterpret_cast<DBImpl*>(db)",
          "old_line_content": "      options_(opts),",
          "new_line_content": "      db_(reinterpret_cast<DBImpl*>(db)),",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(mem_)",
          "old_line_content": "      filter_deletes_(filter_deletes) {",
          "new_line_content": "    assert(mem_);",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(options_)",
          "old_line_content": "    if (filter_deletes_) {",
          "new_line_content": "      assert(options_);",
          "content_same": false
        },
        {
          "line": 64,
          "old_api": null,
          "new_api": "WriteBatchInternal::Count(this)",
          "old_text": null,
          "new_text": "WriteBatchInternal::Count(this)",
          "old_line_content": "int WriteBatch::Count() const {",
          "new_line_content": "  return WriteBatchInternal::Count(this);",
          "content_same": false
        },
        {
          "line": 69,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "input.size()",
          "old_line_content": "  Slice input(rep_);",
          "new_line_content": "  if (input.size() < kHeader) {",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": null,
          "new_api": "Update",
          "old_text": null,
          "new_text": "mem_->Update(sequence_, kTypeValue, key, value)",
          "old_line_content": "    if (options_->inplace_update_support",
          "new_line_content": "        && mem_->Update(sequence_, kTypeValue, key, value)) {",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": null,
          "new_api": "Add",
          "old_text": null,
          "new_text": "mem_->Add(sequence_, kTypeValue, key, value)",
          "old_line_content": "    } else {",
          "new_line_content": "      mem_->Add(sequence_, kTypeValue, key, value);",
          "content_same": false
        },
        {
          "line": 73,
          "old_api": null,
          "new_api": "remove_prefix",
          "old_text": null,
          "new_text": "input.remove_prefix(kHeader)",
          "old_line_content": "",
          "new_line_content": "  input.remove_prefix(kHeader);",
          "content_same": false
        },
        {
          "line": 76,
          "old_api": null,
          "new_api": "Continue",
          "old_text": null,
          "new_text": "handler->Continue()",
          "old_line_content": "  int found = 0;",
          "new_line_content": "  while (!input.empty() && handler->Continue()) {",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": null,
          "new_api": "Add",
          "old_text": null,
          "new_text": "mem_->Add(sequence_, kTypeMerge, key, value)",
          "old_line_content": "  virtual void Merge(const Slice& key, const Slice& value) {",
          "new_line_content": "    mem_->Add(sequence_, kTypeMerge, key, value);",
          "content_same": false
        },
        {
          "line": 78,
          "old_api": null,
          "new_api": "remove_prefix",
          "old_text": null,
          "new_text": "input.remove_prefix(1)",
          "old_line_content": "    char tag = input[0];",
          "new_line_content": "    input.remove_prefix(1);",
          "content_same": false
        },
        {
          "line": 81,
          "old_api": null,
          "new_api": "GetLengthPrefixedSlice",
          "old_text": null,
          "new_text": "GetLengthPrefixedSlice(&input, &key)",
          "old_line_content": "      case kTypeValue:",
          "new_line_content": "        if (GetLengthPrefixedSlice(&input, &key) &&",
          "content_same": false
        },
        {
          "line": 86,
          "old_api": null,
          "new_api": "Status::Corruption(\"bad WriteBatch Put\")",
          "old_text": null,
          "new_text": "Status::Corruption(\"bad WriteBatch Put\")",
          "old_line_content": "        } else {",
          "new_line_content": "          return Status::Corruption(\"bad WriteBatch Put\");",
          "content_same": false
        },
        {
          "line": 215,
          "old_api": null,
          "new_api": "KeyMayExist",
          "old_text": null,
          "new_text": "db_->KeyMayExist(ropts, key, &value)",
          "old_line_content": "      std::string value;",
          "new_line_content": "      if (!db_->KeyMayExist(ropts, key, &value)) {",
          "content_same": false
        },
        {
          "line": 90,
          "old_api": null,
          "new_api": "GetLengthPrefixedSlice",
          "old_text": null,
          "new_text": "GetLengthPrefixedSlice(&input, &key)",
          "old_line_content": "      case kTypeDeletion:",
          "new_line_content": "        if (GetLengthPrefixedSlice(&input, &key)) {",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": null,
          "new_api": "Slice",
          "old_text": null,
          "new_text": "Slice()",
          "old_line_content": "    }",
          "new_line_content": "    mem_->Add(sequence_, kTypeDeletion, key, Slice());",
          "content_same": false
        },
        {
          "line": 94,
          "old_api": null,
          "new_api": "Status::Corruption(\"bad WriteBatch Delete\")",
          "old_text": null,
          "new_text": "Status::Corruption(\"bad WriteBatch Delete\")",
          "old_line_content": "        } else {",
          "new_line_content": "          return Status::Corruption(\"bad WriteBatch Delete\");",
          "content_same": false
        },
        {
          "line": 98,
          "old_api": null,
          "new_api": "GetLengthPrefixedSlice",
          "old_text": null,
          "new_text": "GetLengthPrefixedSlice(&input, &key)",
          "old_line_content": "      case kTypeMerge:",
          "new_line_content": "        if (GetLengthPrefixedSlice(&input, &key) &&",
          "content_same": false
        },
        {
          "line": 103,
          "old_api": null,
          "new_api": "Status::Corruption(\"bad WriteBatch Merge\")",
          "old_text": null,
          "new_text": "Status::Corruption(\"bad WriteBatch Merge\")",
          "old_line_content": "        } else {",
          "new_line_content": "          return Status::Corruption(\"bad WriteBatch Merge\");",
          "content_same": false
        },
        {
          "line": 231,
          "old_api": null,
          "new_api": "Iterate",
          "old_text": null,
          "new_text": "b->Iterate(&inserter)",
          "old_line_content": "                            filter_deletes);",
          "new_line_content": "  return b->Iterate(&inserter);",
          "content_same": false
        },
        {
          "line": 107,
          "old_api": null,
          "new_api": "GetLengthPrefixedSlice",
          "old_text": null,
          "new_text": "GetLengthPrefixedSlice(&input, &blob)",
          "old_line_content": "      case kTypeLogData:",
          "new_line_content": "        if (GetLengthPrefixedSlice(&input, &blob)) {",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "contents.size()",
          "old_line_content": "void WriteBatchInternal::SetContents(WriteBatch* b, const Slice& contents) {",
          "new_line_content": "  assert(contents.size() >= kHeader);",
          "content_same": false
        },
        {
          "line": 110,
          "old_api": null,
          "new_api": "Status::Corruption(\"bad WriteBatch Blob\")",
          "old_text": null,
          "new_text": "Status::Corruption(\"bad WriteBatch Blob\")",
          "old_line_content": "        } else {",
          "new_line_content": "          return Status::Corruption(\"bad WriteBatch Blob\");",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "Count(src)",
          "old_line_content": "void WriteBatchInternal::Append(WriteBatch* dst, const WriteBatch* src) {",
          "new_line_content": "  SetCount(dst, Count(dst) + Count(src));",
          "content_same": false
        },
        {
          "line": 114,
          "old_api": null,
          "new_api": "Status::Corruption(\"unknown WriteBatch tag\")",
          "old_text": null,
          "new_text": "Status::Corruption(\"unknown WriteBatch tag\")",
          "old_line_content": "      default:",
          "new_line_content": "        return Status::Corruption(\"unknown WriteBatch tag\");",
          "content_same": false
        },
        {
          "line": 117,
          "old_api": null,
          "new_api": "WriteBatchInternal::Count(this)",
          "old_text": null,
          "new_text": "WriteBatchInternal::Count(this)",
          "old_line_content": "  }",
          "new_line_content": "  if (found != WriteBatchInternal::Count(this)) {",
          "content_same": false
        },
        {
          "line": 120,
          "old_api": null,
          "new_api": "Status::OK()",
          "old_text": null,
          "new_text": "Status::OK()",
          "old_line_content": "  } else {",
          "new_line_content": "    return Status::OK();",
          "content_same": false
        },
        {
          "line": 125,
          "old_api": null,
          "new_api": "data",
          "old_text": null,
          "new_text": "b->rep_.data()",
          "old_line_content": "int WriteBatchInternal::Count(const WriteBatch* b) {",
          "new_line_content": "  return DecodeFixed32(b->rep_.data() + 8);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 130,
          "old_api": "EncodeFixed32",
          "new_api": null,
          "old_text": "EncodeFixed32(&b->rep_[8], n)",
          "new_text": null,
          "old_line_content": "  EncodeFixed32(&b->rep_[8], n);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 134,
          "old_api": "data",
          "new_api": null,
          "old_text": "b->rep_.data()",
          "new_text": null,
          "old_line_content": "  return SequenceNumber(DecodeFixed64(b->rep_.data()));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 138,
          "old_api": "EncodeFixed64",
          "new_api": null,
          "old_text": "EncodeFixed64(&b->rep_[0], seq)",
          "new_text": null,
          "old_line_content": "  EncodeFixed64(&b->rep_[0], seq);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": "PutLengthPrefixedSlice",
          "new_api": null,
          "old_text": "PutLengthPrefixedSlice(&rep_, value)",
          "new_text": null,
          "old_line_content": "  PutLengthPrefixedSlice(&rep_, value);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": "PutLengthPrefixedSliceParts",
          "new_api": null,
          "old_text": "PutLengthPrefixedSliceParts(&rep_, value)",
          "new_text": null,
          "old_line_content": "  PutLengthPrefixedSliceParts(&rep_, value);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 158,
          "old_api": "PutLengthPrefixedSlice",
          "new_api": null,
          "old_text": "PutLengthPrefixedSlice(&rep_, key)",
          "new_text": null,
          "old_line_content": "  PutLengthPrefixedSlice(&rep_, key);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": "PutLengthPrefixedSlice",
          "new_api": null,
          "old_text": "PutLengthPrefixedSlice(&rep_, value)",
          "new_text": null,
          "old_line_content": "  PutLengthPrefixedSlice(&rep_, value);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 170,
          "old_api": "PutLengthPrefixedSlice",
          "new_api": null,
          "old_text": "PutLengthPrefixedSlice(&rep_, blob)",
          "new_text": null,
          "old_line_content": "  PutLengthPrefixedSlice(&rep_, blob);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": "reinterpret_cast<DBImpl*>(db)",
          "new_api": null,
          "old_text": "reinterpret_cast<DBImpl*>(db)",
          "new_text": null,
          "old_line_content": "      db_(reinterpret_cast<DBImpl*>(db)),",
          "new_line_content": "      filter_deletes_(filter_deletes) {",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(mem_)",
          "new_text": null,
          "old_line_content": "    assert(mem_);",
          "new_line_content": "    if (filter_deletes_) {",
          "content_same": false
        },
        {
          "line": 61,
          "old_api": "resize",
          "new_api": null,
          "old_text": "rep_.resize(kHeader)",
          "new_text": null,
          "old_line_content": "  rep_.resize(kHeader);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(db_)",
          "new_text": null,
          "old_line_content": "      assert(db_);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 65,
          "old_api": "WriteBatchInternal::Count(this)",
          "new_api": null,
          "old_text": "WriteBatchInternal::Count(this)",
          "new_text": null,
          "old_line_content": "  return WriteBatchInternal::Count(this);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 71,
          "old_api": "Status::Corruption(\"malformed WriteBatch (too small)\")",
          "new_api": null,
          "old_text": "Status::Corruption(\"malformed WriteBatch (too small)\")",
          "new_text": null,
          "old_line_content": "    return Status::Corruption(\"malformed WriteBatch (too small)\");",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": "get",
          "new_api": null,
          "old_text": "options_->statistics.get()",
          "new_text": null,
          "old_line_content": "      RecordTick(options_->statistics.get(), NUMBER_KEYS_UPDATED);",
          "new_line_content": "    } else {",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "Add",
          "new_api": null,
          "old_text": "mem_->Add(sequence_, kTypeValue, key, value)",
          "new_text": null,
          "old_line_content": "      mem_->Add(sequence_, kTypeValue, key, value);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 74,
          "old_api": "remove_prefix",
          "new_api": null,
          "old_text": "input.remove_prefix(kHeader)",
          "new_text": null,
          "old_line_content": "  input.remove_prefix(kHeader);",
          "new_line_content": "  Slice key, value, blob;",
          "content_same": false
        },
        {
          "line": 77,
          "old_api": "Continue",
          "new_api": null,
          "old_text": "handler->Continue()",
          "new_text": null,
          "old_line_content": "  while (!input.empty() && handler->Continue()) {",
          "new_line_content": "    char tag = input[0];",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "Add",
          "new_api": null,
          "old_text": "mem_->Add(sequence_, kTypeMerge, key, value)",
          "new_text": null,
          "old_line_content": "    mem_->Add(sequence_, kTypeMerge, key, value);",
          "new_line_content": "    sequence_++;",
          "content_same": false
        },
        {
          "line": 79,
          "old_api": "remove_prefix",
          "new_api": null,
          "old_text": "input.remove_prefix(1)",
          "new_text": null,
          "old_line_content": "    input.remove_prefix(1);",
          "new_line_content": "    switch (tag) {",
          "content_same": false
        },
        {
          "line": 84,
          "old_api": "Put",
          "new_api": null,
          "old_text": "handler->Put(key, value)",
          "new_text": null,
          "old_line_content": "          handler->Put(key, value);",
          "new_line_content": "          found++;",
          "content_same": false
        },
        {
          "line": 87,
          "old_api": "Status::Corruption(\"bad WriteBatch Put\")",
          "new_api": null,
          "old_text": "Status::Corruption(\"bad WriteBatch Put\")",
          "new_text": null,
          "old_line_content": "          return Status::Corruption(\"bad WriteBatch Put\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": "get",
          "new_api": null,
          "old_text": "options_->statistics.get()",
          "new_text": null,
          "old_line_content": "        RecordTick(options_->statistics.get(), NUMBER_FILTERED_DELETES);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": "Delete",
          "new_api": null,
          "old_text": "handler->Delete(key)",
          "new_text": null,
          "old_line_content": "          handler->Delete(key);",
          "new_line_content": "          found++;",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": "Slice",
          "new_api": null,
          "old_text": "Slice()",
          "new_text": null,
          "old_line_content": "    mem_->Add(sequence_, kTypeDeletion, key, Slice());",
          "new_line_content": "    sequence_++;",
          "content_same": false
        },
        {
          "line": 95,
          "old_api": "Status::Corruption(\"bad WriteBatch Delete\")",
          "new_api": null,
          "old_text": "Status::Corruption(\"bad WriteBatch Delete\")",
          "new_text": null,
          "old_line_content": "          return Status::Corruption(\"bad WriteBatch Delete\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 101,
          "old_api": "Merge",
          "new_api": null,
          "old_text": "handler->Merge(key, value)",
          "new_text": null,
          "old_line_content": "          handler->Merge(key, value);",
          "new_line_content": "          found++;",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": "Status::Corruption(\"bad WriteBatch Merge\")",
          "new_api": null,
          "old_text": "Status::Corruption(\"bad WriteBatch Merge\")",
          "new_text": null,
          "old_line_content": "          return Status::Corruption(\"bad WriteBatch Merge\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "Iterate",
          "new_api": null,
          "old_text": "b->Iterate(&inserter)",
          "new_text": null,
          "old_line_content": "  return b->Iterate(&inserter);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 109,
          "old_api": "LogData",
          "new_api": null,
          "old_text": "handler->LogData(blob)",
          "new_text": null,
          "old_line_content": "          handler->LogData(blob);",
          "new_line_content": "        } else {",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": "size",
          "new_api": null,
          "old_text": "contents.size()",
          "new_text": null,
          "old_line_content": "  b->rep_.assign(contents.data(), contents.size());",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 111,
          "old_api": "Status::Corruption(\"bad WriteBatch Blob\")",
          "new_api": null,
          "old_text": "Status::Corruption(\"bad WriteBatch Blob\")",
          "new_text": null,
          "old_line_content": "          return Status::Corruption(\"bad WriteBatch Blob\");",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 115,
          "old_api": "Status::Corruption(\"unknown WriteBatch tag\")",
          "new_api": null,
          "old_text": "Status::Corruption(\"unknown WriteBatch tag\")",
          "new_text": null,
          "old_line_content": "        return Status::Corruption(\"unknown WriteBatch tag\");",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": "size",
          "new_api": null,
          "old_text": "src->rep_.size()",
          "new_text": null,
          "old_line_content": "  dst->rep_.append(src->rep_.data() + kHeader, src->rep_.size() - kHeader);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 119,
          "old_api": "Status::Corruption(\"WriteBatch has wrong count\")",
          "new_api": null,
          "old_text": "Status::Corruption(\"WriteBatch has wrong count\")",
          "new_text": null,
          "old_line_content": "    return Status::Corruption(\"WriteBatch has wrong count\");",
          "new_line_content": "  } else {",
          "content_same": false
        },
        {
          "line": 121,
          "old_api": "Status::OK()",
          "new_api": null,
          "old_text": "Status::OK()",
          "new_text": null,
          "old_line_content": "    return Status::OK();",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 126,
          "old_api": "data",
          "new_api": null,
          "old_text": "b->rep_.data()",
          "new_text": null,
          "old_line_content": "  return DecodeFixed32(b->rep_.data() + 8);",
          "new_line_content": "}",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 18,
      "total_additions": 36,
      "total_deletions": 37,
      "total_api_changes": 91
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 1,
        "api_related_lines": 91,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 90,
    "api_calls_after": 89,
    "diff_info": {
      "added_lines": 0,
      "removed_lines": 1,
      "total_diff_lines": 13
    }
  }
}