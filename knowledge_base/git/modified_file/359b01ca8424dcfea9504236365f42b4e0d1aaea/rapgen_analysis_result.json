{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/359b01ca8424dcfea9504236365f42b4e0d1aaea",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/359b01ca8424dcfea9504236365f42b4e0d1aaea/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/359b01ca8424dcfea9504236365f42b4e0d1aaea/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/359b01ca8424dcfea9504236365f42b4e0d1aaea/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 2420,
          "old_api": "die",
          "new_api": "init_contains_cache",
          "old_text": "die(\"filter_refs: invalid type\")",
          "new_text": "init_contains_cache(&ref_cbdata.no_contains_cache)",
          "old_line_content": "\t\tdie(\"filter_refs: invalid type\");",
          "new_line_content": "\tinit_contains_cache(&ref_cbdata.no_contains_cache);",
          "content_same": false
        },
        {
          "line": 2435,
          "old_api": "for_each_fullref_in_pattern",
          "new_api": "for_each_fullref_in",
          "old_text": "for_each_fullref_in_pattern(filter, ref_filter_handler, &ref_cbdata)",
          "new_text": "for_each_fullref_in(\"refs/remotes/\", ref_filter_handler, &ref_cbdata)",
          "old_line_content": "\t\t\tret = for_each_fullref_in_pattern(filter, ref_filter_handler, &ref_cbdata);",
          "new_line_content": "\t\t\tret = for_each_fullref_in(\"refs/remotes/\", ref_filter_handler, &ref_cbdata);",
          "content_same": false
        },
        {
          "line": 2437,
          "old_api": "head_ref",
          "new_api": "for_each_fullref_in",
          "old_text": "head_ref(ref_filter_handler, &ref_cbdata)",
          "new_text": "for_each_fullref_in(\"refs/tags/\", ref_filter_handler, &ref_cbdata)",
          "old_line_content": "\t\t\thead_ref(ref_filter_handler, &ref_cbdata);",
          "new_line_content": "\t\t\tret = for_each_fullref_in(\"refs/tags/\", ref_filter_handler, &ref_cbdata);",
          "content_same": false
        },
        {
          "line": 2441,
          "old_api": "clear_contains_cache",
          "new_api": "head_ref",
          "old_text": "clear_contains_cache(&ref_cbdata.no_contains_cache)",
          "new_text": "head_ref(ref_filter_handler, &ref_cbdata)",
          "old_line_content": "\tclear_contains_cache(&ref_cbdata.no_contains_cache);",
          "new_line_content": "\t\t\thead_ref(ref_filter_handler, &ref_cbdata);",
          "content_same": false
        },
        {
          "line": 2444,
          "old_api": "reach_filter",
          "new_api": "clear_contains_cache",
          "old_text": "reach_filter(array, filter->reachable_from, INCLUDE_REACHED)",
          "new_text": "clear_contains_cache(&ref_cbdata.contains_cache)",
          "old_line_content": "\treach_filter(array, filter->reachable_from, INCLUDE_REACHED);",
          "new_line_content": "\tclear_contains_cache(&ref_cbdata.contains_cache);",
          "content_same": false
        },
        {
          "line": 2445,
          "old_api": "reach_filter",
          "new_api": "clear_contains_cache",
          "old_text": "reach_filter(array, filter->unreachable_from, EXCLUDE_REACHED)",
          "new_text": "clear_contains_cache(&ref_cbdata.no_contains_cache)",
          "old_line_content": "\treach_filter(array, filter->unreachable_from, EXCLUDE_REACHED);",
          "new_line_content": "\tclear_contains_cache(&ref_cbdata.no_contains_cache);",
          "content_same": false
        },
        {
          "line": 2496,
          "old_api": "compare_detached_head",
          "new_api": "get_ref_atom_value",
          "old_text": "compare_detached_head(a, b)",
          "new_text": "get_ref_atom_value(b, s->atom, &vb, &err)",
          "old_line_content": "\t\tcmp = compare_detached_head(a, b);",
          "new_line_content": "\tif (get_ref_atom_value(b, s->atom, &vb, &err))",
          "content_same": false
        },
        {
          "line": 2510,
          "old_api": "strlen",
          "new_api": "cmp_fn",
          "old_text": "strlen(vb->s)",
          "new_text": "cmp_fn(va->s, vb->s)",
          "old_line_content": "\t\t\t\t\tstrlen(vb->s) : vb->s_size;",
          "new_line_content": "\t\t\tcmp = cmp_fn(va->s, vb->s);",
          "content_same": false
        },
        {
          "line": 2515,
          "old_api": "cmp_fn",
          "new_api": "strlen",
          "old_text": "cmp_fn(va->s, vb->s, b_size > a_size ?\n\t\t\t\t     a_size : b_size)",
          "new_text": "strlen(vb->s)",
          "old_line_content": "\t\t\tcmp = cmp_fn(va->s, vb->s, b_size > a_size ?",
          "new_line_content": "\t\t\t\t\tstrlen(vb->s) : vb->s_size;",
          "content_same": false
        },
        {
          "line": 2612,
          "old_api": "handler",
          "new_api": "strchr",
          "old_text": "atomv->handler(atomv, &state, error_buf)",
          "new_text": "strchr(sp, ')')",
          "old_line_content": "\t\t    atomv->handler(atomv, &state, error_buf)) {",
          "new_line_content": "\t\tep = strchr(sp, ')');",
          "content_same": false
        },
        {
          "line": 2618,
          "old_api": "strlen",
          "new_api": "pop_stack_element",
          "old_text": "strlen(cp)",
          "new_text": "pop_stack_element(&state.stack)",
          "old_line_content": "\t\tsp = cp + strlen(cp);",
          "new_line_content": "\t\t\tpop_stack_element(&state.stack);",
          "content_same": false
        },
        {
          "line": 2624,
          "old_api": "append_atom",
          "new_api": "append_literal",
          "old_text": "append_atom(&resetv, &state, error_buf)",
          "new_text": "append_literal(cp, sp, &state)",
          "old_line_content": "\t\tif (append_atom(&resetv, &state, error_buf)) {",
          "new_line_content": "\t\tappend_literal(cp, sp, &state);",
          "content_same": false
        },
        {
          "line": 2650,
          "old_api": "putchar",
          "new_api": "new_ref_array_item",
          "old_text": "putchar('\\n')",
          "new_text": "new_ref_array_item(name, oid)",
          "old_line_content": "\tputchar('\\n');",
          "new_line_content": "\tref_item = new_ref_array_item(name, oid);",
          "content_same": false
        },
        {
          "line": 2652,
          "old_api": "strbuf_release",
          "new_api": "format_ref_array_item",
          "old_text": "strbuf_release(&err)",
          "new_text": "format_ref_array_item(ref_item, format, &output, &err)",
          "old_line_content": "\tstrbuf_release(&err);",
          "new_line_content": "\tif (format_ref_array_item(ref_item, format, &output, &err))",
          "content_same": false
        },
        {
          "line": 2653,
          "old_api": "strbuf_release",
          "new_api": "die",
          "old_text": "strbuf_release(&output)",
          "new_text": "die(\"%s\", err.buf)",
          "old_line_content": "\tstrbuf_release(&output);",
          "new_line_content": "\t\tdie(\"%s\", err.buf);",
          "content_same": false
        },
        {
          "line": 2654,
          "old_api": "free_array_item",
          "new_api": "fwrite",
          "old_text": "free_array_item(ref_item)",
          "new_text": "fwrite(output.buf, 1, output.len, stdout)",
          "old_line_content": "\tfree_array_item(ref_item);",
          "new_line_content": "\tfwrite(output.buf, 1, output.len, stdout);",
          "content_same": false
        },
        {
          "line": 2669,
          "old_api": "strbuf_release",
          "new_api": "strlen",
          "old_text": "strbuf_release(&err)",
          "new_text": "strlen(atom)",
          "old_line_content": "\tstrbuf_release(&err);",
          "new_line_content": "\tconst char *end = atom + strlen(atom);",
          "content_same": false
        },
        {
          "line": 2744,
          "old_api": "lookup_commit_reference_gently",
          "new_api": "BUG_ON_OPT_NEG",
          "old_text": "lookup_commit_reference_gently(the_repository, &oid, 0)",
          "new_text": "BUG_ON_OPT_NEG(unset)",
          "old_line_content": "\tmerge_commit = lookup_commit_reference_gently(the_repository, &oid, 0);",
          "new_line_content": "\tBUG_ON_OPT_NEG(unset);",
          "content_same": false
        },
        {
          "line": 2749,
          "old_api": "starts_with",
          "new_api": "lookup_commit_reference_gently",
          "old_text": "starts_with(opt->long_name, \"no\")",
          "new_text": "lookup_commit_reference_gently(the_repository, &oid, 0)",
          "old_line_content": "\tif (starts_with(opt->long_name, \"no\"))",
          "new_line_content": "\tmerge_commit = lookup_commit_reference_gently(the_repository, &oid, 0);",
          "content_same": false
        },
        {
          "line": 2752,
          "old_api": "commit_list_insert",
          "new_api": "_",
          "old_text": "commit_list_insert(merge_commit, &rf->reachable_from)",
          "new_text": "_(\"option `%s' must point to a commit\")",
          "old_line_content": "\t\tcommit_list_insert(merge_commit, &rf->reachable_from);",
          "new_line_content": "\t\treturn error(_(\"option `%s' must point to a commit\"), opt->long_name);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 2694,
          "old_api": null,
          "new_api": "CALLOC_ARRAY",
          "old_text": null,
          "new_text": "CALLOC_ARRAY(s, 1)",
          "old_line_content": "\t\ts->sort_flags |= REF_SORTING_REVERSE;",
          "new_line_content": "\tCALLOC_ARRAY(s, 1);",
          "content_same": false
        },
        {
          "line": 2439,
          "old_api": null,
          "new_api": "for_each_fullref_in_pattern",
          "old_text": null,
          "new_text": "for_each_fullref_in_pattern(filter, ref_filter_handler, &ref_cbdata)",
          "old_line_content": "",
          "new_line_content": "\t\t\tret = for_each_fullref_in_pattern(filter, ref_filter_handler, &ref_cbdata);",
          "content_same": false
        },
        {
          "line": 2572,
          "old_api": null,
          "new_api": "QSORT_S",
          "old_text": null,
          "new_text": "QSORT_S(array->items, array->nr, compare_refs, sorting)",
          "old_line_content": "\tstruct strbuf *s = &state->stack->output;",
          "new_line_content": "\tQSORT_S(array->items, array->nr, compare_refs, sorting);",
          "content_same": false
        },
        {
          "line": 2702,
          "old_api": null,
          "new_api": "skip_prefix",
          "old_text": null,
          "new_text": "skip_prefix(arg, \"version:\", &arg)",
          "old_line_content": "",
          "new_line_content": "\tif (skip_prefix(arg, \"version:\", &arg) ||",
          "content_same": false
        },
        {
          "line": 2703,
          "old_api": null,
          "new_api": "skip_prefix",
          "old_text": null,
          "new_text": "skip_prefix(arg, \"v:\", &arg)",
          "old_line_content": "struct ref_sorting *ref_sorting_options(struct string_list *options)",
          "new_line_content": "\t    skip_prefix(arg, \"v:\", &arg))",
          "content_same": false
        },
        {
          "line": 2448,
          "old_api": null,
          "new_api": "reach_filter",
          "old_text": null,
          "new_text": "reach_filter(array, filter->reachable_from, INCLUDE_REACHED)",
          "old_line_content": "}",
          "new_line_content": "\treach_filter(array, filter->reachable_from, INCLUDE_REACHED);",
          "content_same": false
        },
        {
          "line": 2449,
          "old_api": null,
          "new_api": "reach_filter",
          "old_text": null,
          "new_text": "reach_filter(array, filter->unreachable_from, EXCLUDE_REACHED)",
          "old_line_content": "",
          "new_line_content": "\treach_filter(array, filter->unreachable_from, EXCLUDE_REACHED);",
          "content_same": false
        },
        {
          "line": 2705,
          "old_api": null,
          "new_api": "parse_sorting_atom",
          "old_text": null,
          "new_text": "parse_sorting_atom(arg)",
          "old_line_content": "\tstruct string_list_item *item;",
          "new_line_content": "\ts->atom = parse_sorting_atom(arg);",
          "content_same": false
        },
        {
          "line": 2584,
          "old_api": null,
          "new_api": "hex2chr",
          "old_text": null,
          "new_text": "hex2chr(cp + 1)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\tint ch = hex2chr(cp + 1);",
          "content_same": false
        },
        {
          "line": 2586,
          "old_api": null,
          "new_api": "strbuf_addch",
          "old_text": null,
          "new_text": "strbuf_addch(s, ch)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\t\tstrbuf_addch(s, ch);",
          "content_same": false
        },
        {
          "line": 2714,
          "old_api": null,
          "new_api": "ref_default_sorting",
          "old_text": null,
          "new_text": "ref_default_sorting()",
          "old_line_content": "",
          "new_line_content": "\t\tsorting = ref_default_sorting();",
          "content_same": false
        },
        {
          "line": 2716,
          "old_api": null,
          "new_api": "for_each_string_list_item",
          "old_text": null,
          "new_text": "for_each_string_list_item(item, options)",
          "old_line_content": "\t * From here on, the ref_sorting list should be used to talk",
          "new_line_content": "\t\tfor_each_string_list_item(item, options)",
          "content_same": false
        },
        {
          "line": 2717,
          "old_api": null,
          "new_api": "parse_ref_sorting",
          "old_text": null,
          "new_text": "parse_ref_sorting(tail, item->string)",
          "old_line_content": "\t * about the sort order used for the output.  The caller",
          "new_line_content": "\t\t\tparse_ref_sorting(tail, item->string);",
          "content_same": false
        },
        {
          "line": 2463,
          "old_api": null,
          "new_api": "BUG",
          "old_text": null,
          "new_text": "BUG(\"should have died in the xor check above\")",
          "old_line_content": "{",
          "new_line_content": "\tBUG(\"should have died in the xor check above\");",
          "content_same": false
        },
        {
          "line": 2592,
          "old_api": null,
          "new_api": "strbuf_addch",
          "old_text": null,
          "new_text": "strbuf_addch(s, *cp)",
          "old_line_content": "int format_ref_array_item(struct ref_array_item *info,",
          "new_line_content": "\t\tstrbuf_addch(s, *cp);",
          "content_same": false
        },
        {
          "line": 2725,
          "old_api": null,
          "new_api": "string_list_clear",
          "old_text": null,
          "new_text": "string_list_clear(options, 0)",
          "old_line_content": "{",
          "new_line_content": "\tstring_list_clear(options, 0);",
          "content_same": false
        },
        {
          "line": 2473,
          "old_api": null,
          "new_api": "tolower",
          "old_text": null,
          "new_text": "tolower(*s2)",
          "old_line_content": "}",
          "new_line_content": "\t\tint diff = tolower(*s1) - tolower(*s2);",
          "content_same": false
        },
        {
          "line": 2733,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(sorting)",
          "old_line_content": "int parse_opt_merge_filter(const struct option *opt, const char *arg, int unset)",
          "new_line_content": "\t\tfree(sorting);",
          "content_same": false
        },
        {
          "line": 2606,
          "old_api": null,
          "new_api": "push_stack_element",
          "old_text": null,
          "new_text": "push_stack_element(&state.stack)",
          "old_line_content": "",
          "new_line_content": "\tpush_stack_element(&state.stack);",
          "content_same": false
        },
        {
          "line": 2608,
          "old_api": null,
          "new_api": "find_next",
          "old_text": null,
          "new_text": "find_next(cp)",
          "old_line_content": "\t\tif (cp < sp)",
          "new_line_content": "\tfor (cp = format->format; *cp && (sp = find_next(cp)); cp = ep + 1) {",
          "content_same": false
        },
        {
          "line": 2614,
          "old_api": null,
          "new_api": "append_literal",
          "old_text": null,
          "new_text": "append_literal(cp, sp, &state)",
          "old_line_content": "\t\t\treturn -1;",
          "new_line_content": "\t\t\tappend_literal(cp, sp, &state);",
          "content_same": false
        },
        {
          "line": 2615,
          "old_api": null,
          "new_api": "parse_ref_filter_atom",
          "old_text": null,
          "new_text": "parse_ref_filter_atom(format, sp + 2, ep, error_buf)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tpos = parse_ref_filter_atom(format, sp + 2, ep, error_buf);",
          "content_same": false
        },
        {
          "line": 2616,
          "old_api": null,
          "new_api": "get_ref_atom_value",
          "old_text": null,
          "new_text": "get_ref_atom_value(info, pos, &atomv, error_buf)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tif (pos < 0 || get_ref_atom_value(info, pos, &atomv, error_buf) ||",
          "content_same": false
        },
        {
          "line": 2617,
          "old_api": null,
          "new_api": "handler",
          "old_text": null,
          "new_text": "atomv->handler(atomv, &state, error_buf)",
          "old_line_content": "\tif (*cp) {",
          "new_line_content": "\t\t    atomv->handler(atomv, &state, error_buf)) {",
          "content_same": false
        },
        {
          "line": 2746,
          "old_api": null,
          "new_api": "get_oid",
          "old_text": null,
          "new_text": "get_oid(arg, &oid)",
          "old_line_content": "\tif (!merge_commit)",
          "new_line_content": "\tif (get_oid(arg, &oid))",
          "content_same": false
        },
        {
          "line": 2683,
          "old_api": null,
          "new_api": "xcalloc",
          "old_text": null,
          "new_text": "xcalloc(1, sizeof(*sorting))",
          "old_line_content": "}",
          "new_line_content": "\tstruct ref_sorting *sorting = xcalloc(1, sizeof(*sorting));",
          "content_same": false
        },
        {
          "line": 2494,
          "old_api": null,
          "new_api": "get_ref_atom_value",
          "old_text": null,
          "new_text": "get_ref_atom_value(a, s->atom, &va, &err)",
          "old_line_content": "\tif (s->sort_flags & REF_SORTING_DETACHED_HEAD_FIRST &&",
          "new_line_content": "\tif (get_ref_atom_value(a, s->atom, &va, &err))",
          "content_same": false
        },
        {
          "line": 2495,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"%s\", err.buf)",
          "old_line_content": "\t    ((a->kind | b->kind) & FILTER_REFS_DETACHED_HEAD)) {",
          "new_line_content": "\t\tdie(\"%s\", err.buf);",
          "content_same": false
        },
        {
          "line": 2623,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(cp)",
          "old_line_content": "\t\tresetv.s = GIT_COLOR_RESET;",
          "new_line_content": "\t\tsp = cp + strlen(cp);",
          "content_same": false
        },
        {
          "line": 2497,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"%s\", err.buf)",
          "old_line_content": "\t\tcmp_detached_head = 1;",
          "new_line_content": "\t\tdie(\"%s\", err.buf);",
          "content_same": false
        },
        {
          "line": 2498,
          "old_api": null,
          "new_api": "strbuf_release",
          "old_text": null,
          "new_text": "strbuf_release(&err)",
          "old_line_content": "\t} else if (s->sort_flags & REF_SORTING_VERSION) {",
          "new_line_content": "\tstrbuf_release(&err);",
          "content_same": false
        },
        {
          "line": 2754,
          "old_api": null,
          "new_api": "starts_with",
          "old_text": null,
          "new_text": "starts_with(opt->long_name, \"no\")",
          "old_line_content": "\treturn 0;",
          "new_line_content": "\tif (starts_with(opt->long_name, \"no\"))",
          "content_same": false
        },
        {
          "line": 2755,
          "old_api": null,
          "new_api": "commit_list_insert",
          "old_text": null,
          "new_text": "commit_list_insert(merge_commit, &rf->unreachable_from)",
          "old_line_content": "}",
          "new_line_content": "\t\tcommit_list_insert(merge_commit, &rf->unreachable_from);",
          "content_same": false
        },
        {
          "line": 2501,
          "old_api": null,
          "new_api": "compare_detached_head",
          "old_text": null,
          "new_text": "compare_detached_head(a, b)",
          "old_line_content": "\t\tif (va->s_size < 0 && vb->s_size < 0) {",
          "new_line_content": "\t\tcmp = compare_detached_head(a, b);",
          "content_same": false
        },
        {
          "line": 2629,
          "old_api": null,
          "new_api": "append_atom",
          "old_text": null,
          "new_text": "append_atom(&resetv, &state, error_buf)",
          "old_line_content": "\tif (state.stack->prev) {",
          "new_line_content": "\t\tif (append_atom(&resetv, &state, error_buf)) {",
          "content_same": false
        },
        {
          "line": 2757,
          "old_api": null,
          "new_api": "commit_list_insert",
          "old_text": null,
          "new_text": "commit_list_insert(merge_commit, &rf->reachable_from)",
          "old_line_content": "",
          "new_line_content": "\t\tcommit_list_insert(merge_commit, &rf->reachable_from);",
          "content_same": false
        },
        {
          "line": 2504,
          "old_api": null,
          "new_api": "versioncmp",
          "old_text": null,
          "new_text": "versioncmp(va->s, vb->s)",
          "old_line_content": "\t\t\t\t? strcasecmp : strcmp;",
          "new_line_content": "\t\tcmp = versioncmp(va->s, vb->s);",
          "content_same": false
        },
        {
          "line": 2635,
          "old_api": null,
          "new_api": "pop_stack_element",
          "old_text": null,
          "new_text": "pop_stack_element(&state.stack)",
          "old_line_content": "\treturn 0;",
          "new_line_content": "\t\tpop_stack_element(&state.stack);",
          "content_same": false
        },
        {
          "line": 2636,
          "old_api": null,
          "new_api": "_",
          "old_text": null,
          "new_text": "_(\"format: %%(end) atom missing\")",
          "old_line_content": "}",
          "new_line_content": "\t\treturn strbuf_addf_ret(error_buf, -1, _(\"format: %%(end) atom missing\"));",
          "content_same": false
        },
        {
          "line": 2638,
          "old_api": null,
          "new_api": "strbuf_addbuf",
          "old_text": null,
          "new_text": "strbuf_addbuf(final_buf, &state.stack->output)",
          "old_line_content": "void pretty_print_ref(const char *name, const struct object_id *oid,",
          "new_line_content": "\tstrbuf_addbuf(final_buf, &state.stack->output);",
          "content_same": false
        },
        {
          "line": 2639,
          "old_api": null,
          "new_api": "pop_stack_element",
          "old_text": null,
          "new_text": "pop_stack_element(&state.stack)",
          "old_line_content": "\t\t      struct ref_format *format)",
          "new_line_content": "\tpop_stack_element(&state.stack);",
          "content_same": false
        },
        {
          "line": 2513,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(va->s)",
          "old_line_content": "\t\t\t\t? memcasecmp : memcmp;",
          "new_line_content": "\t\t\t\t\tstrlen(va->s) : va->s_size;",
          "content_same": false
        },
        {
          "line": 2520,
          "old_api": null,
          "new_api": "cmp_fn",
          "old_text": null,
          "new_text": "cmp_fn(va->s, vb->s, b_size > a_size ?\n\t\t\t\t     a_size : b_size)",
          "old_line_content": "\t\t\t\telse if (a_size < b_size)",
          "new_line_content": "\t\t\tcmp = cmp_fn(va->s, vb->s, b_size > a_size ?",
          "content_same": false
        },
        {
          "line": 2651,
          "old_api": null,
          "new_api": "ref_kind_from_refname",
          "old_text": null,
          "new_text": "ref_kind_from_refname(name)",
          "old_line_content": "",
          "new_line_content": "\tref_item->kind = ref_kind_from_refname(name);",
          "content_same": false
        },
        {
          "line": 2655,
          "old_api": null,
          "new_api": "putchar",
          "old_text": null,
          "new_text": "putchar('\\n')",
          "old_line_content": "}",
          "new_line_content": "\tputchar('\\n');",
          "content_same": false
        },
        {
          "line": 2657,
          "old_api": null,
          "new_api": "strbuf_release",
          "old_text": null,
          "new_text": "strbuf_release(&err)",
          "old_line_content": "static int parse_sorting_atom(const char *atom)",
          "new_line_content": "\tstrbuf_release(&err);",
          "content_same": false
        },
        {
          "line": 2658,
          "old_api": null,
          "new_api": "strbuf_release",
          "old_text": null,
          "new_text": "strbuf_release(&output)",
          "old_line_content": "{",
          "new_line_content": "\tstrbuf_release(&output);",
          "content_same": false
        },
        {
          "line": 2659,
          "old_api": null,
          "new_api": "free_array_item",
          "old_text": null,
          "new_text": "free_array_item(ref_item)",
          "old_line_content": "\t/*",
          "new_line_content": "\tfree_array_item(ref_item);",
          "content_same": false
        },
        {
          "line": 2671,
          "old_api": null,
          "new_api": "parse_ref_filter_atom",
          "old_text": null,
          "new_text": "parse_ref_filter_atom(&dummy, atom, end, &err)",
          "old_line_content": "}",
          "new_line_content": "\tint res = parse_ref_filter_atom(&dummy, atom, end, &err);",
          "content_same": false
        },
        {
          "line": 2673,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"%s\", err.buf)",
          "old_line_content": "/*  If no sorting option is given, use refname to sort as default */",
          "new_line_content": "\t\tdie(\"%s\", err.buf);",
          "content_same": false
        },
        {
          "line": 2674,
          "old_api": null,
          "new_api": "strbuf_release",
          "old_text": null,
          "new_text": "strbuf_release(&err)",
          "old_line_content": "static struct ref_sorting *ref_default_sorting(void)",
          "new_line_content": "\tstrbuf_release(&err);",
          "content_same": false
        },
        {
          "line": 2419,
          "old_api": null,
          "new_api": "init_contains_cache",
          "old_text": null,
          "new_text": "init_contains_cache(&ref_cbdata.contains_cache)",
          "old_line_content": "\tif (!filter->kind)",
          "new_line_content": "\tinit_contains_cache(&ref_cbdata.contains_cache);",
          "content_same": false
        },
        {
          "line": 2549,
          "old_api": null,
          "new_api": "cmp_ref_sorting",
          "old_text": null,
          "new_text": "cmp_ref_sorting(s, a, b)",
          "old_line_content": "\treturn s && s->sort_flags & REF_SORTING_ICASE ?",
          "new_line_content": "\t\tint cmp = cmp_ref_sorting(s, a, b);",
          "content_same": false
        },
        {
          "line": 2424,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"filter_refs: invalid type\")",
          "old_line_content": "\t\t * we only iterate through those refs. If a mix of refs is needed,",
          "new_line_content": "\t\tdie(\"filter_refs: invalid type\");",
          "content_same": false
        },
        {
          "line": 2555,
          "old_api": null,
          "new_api": "strcasecmp",
          "old_text": null,
          "new_text": "strcasecmp(a->refname, b->refname)",
          "old_line_content": "\t\t\t\t    unsigned int mask, int on)",
          "new_line_content": "\t\tstrcasecmp(a->refname, b->refname) :",
          "content_same": false
        },
        {
          "line": 2556,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(a->refname, b->refname)",
          "old_line_content": "{",
          "new_line_content": "\t\tstrcmp(a->refname, b->refname);",
          "content_same": false
        },
        {
          "line": 2686,
          "old_api": null,
          "new_api": "parse_sorting_atom",
          "old_text": null,
          "new_text": "parse_sorting_atom(cstr_name)",
          "old_line_content": "{",
          "new_line_content": "\tsorting->atom = parse_sorting_atom(cstr_name);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 2689,
          "old_api": "CALLOC_ARRAY",
          "new_api": null,
          "old_text": "CALLOC_ARRAY(s, 1)",
          "new_text": null,
          "old_line_content": "\tCALLOC_ARRAY(s, 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2567,
          "old_api": "QSORT_S",
          "new_api": null,
          "old_text": "QSORT_S(array->items, array->nr, compare_refs, sorting)",
          "new_text": null,
          "old_line_content": "\tQSORT_S(array->items, array->nr, compare_refs, sorting);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 2440,
          "old_api": "clear_contains_cache",
          "new_api": null,
          "old_text": "clear_contains_cache(&ref_cbdata.contains_cache)",
          "new_text": null,
          "old_line_content": "\tclear_contains_cache(&ref_cbdata.contains_cache);",
          "new_line_content": "\t\tif (!ret && (filter->kind & FILTER_REFS_DETACHED_HEAD))",
          "content_same": false
        },
        {
          "line": 2697,
          "old_api": "skip_prefix",
          "new_api": null,
          "old_text": "skip_prefix(arg, \"version:\", &arg)",
          "new_text": null,
          "old_line_content": "\tif (skip_prefix(arg, \"version:\", &arg) ||",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2698,
          "old_api": "skip_prefix",
          "new_api": null,
          "old_text": "skip_prefix(arg, \"v:\", &arg)",
          "new_text": null,
          "old_line_content": "\t    skip_prefix(arg, \"v:\", &arg))",
          "new_line_content": "\tif (*arg == '-') {",
          "content_same": false
        },
        {
          "line": 2700,
          "old_api": "parse_sorting_atom",
          "new_api": null,
          "old_text": "parse_sorting_atom(arg)",
          "new_text": null,
          "old_line_content": "\ts->atom = parse_sorting_atom(arg);",
          "new_line_content": "\t\targ++;",
          "content_same": false
        },
        {
          "line": 2579,
          "old_api": "hex2chr",
          "new_api": null,
          "old_text": "hex2chr(cp + 1)",
          "new_text": null,
          "old_line_content": "\t\t\t\tint ch = hex2chr(cp + 1);",
          "new_line_content": "\twhile (*cp && (!ep || cp < ep)) {",
          "content_same": false
        },
        {
          "line": 2453,
          "old_api": "BUG",
          "new_api": null,
          "old_text": "BUG(\"ref_kind_from_refname() should only mark one ref as HEAD\")",
          "new_text": null,
          "old_line_content": "\t\tBUG(\"ref_kind_from_refname() should only mark one ref as HEAD\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 2581,
          "old_api": "strbuf_addch",
          "new_api": null,
          "old_text": "strbuf_addch(s, ch)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tstrbuf_addch(s, ch);",
          "new_line_content": "\t\t\tif (cp[1] == '%')",
          "content_same": false
        },
        {
          "line": 2709,
          "old_api": "ref_default_sorting",
          "new_api": null,
          "old_text": "ref_default_sorting()",
          "new_text": null,
          "old_line_content": "\t\tsorting = ref_default_sorting();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2711,
          "old_api": "for_each_string_list_item",
          "new_api": null,
          "old_text": "for_each_string_list_item(item, options)",
          "new_text": null,
          "old_line_content": "\t\tfor_each_string_list_item(item, options)",
          "new_line_content": "\tstruct ref_sorting *sorting = NULL, **tail = &sorting;",
          "content_same": false
        },
        {
          "line": 2712,
          "old_api": "parse_ref_sorting",
          "new_api": null,
          "old_text": "parse_ref_sorting(tail, item->string)",
          "new_text": null,
          "old_line_content": "\t\t\tparse_ref_sorting(tail, item->string);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2587,
          "old_api": "strbuf_addch",
          "new_api": null,
          "old_text": "strbuf_addch(s, *cp)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_addch(s, *cp);",
          "new_line_content": "\t\t\t\t\tcp += 3;",
          "content_same": false
        },
        {
          "line": 2720,
          "old_api": "string_list_clear",
          "new_api": null,
          "old_text": "string_list_clear(options, 0)",
          "new_text": null,
          "old_line_content": "\tstring_list_clear(options, 0);",
          "new_line_content": "\t/*",
          "content_same": false
        },
        {
          "line": 2468,
          "old_api": "tolower",
          "new_api": null,
          "old_text": "tolower(*s2)",
          "new_text": null,
          "old_line_content": "\t\tint diff = tolower(*s1) - tolower(*s2);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2728,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(sorting)",
          "new_text": null,
          "old_line_content": "\t\tfree(sorting);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2601,
          "old_api": "push_stack_element",
          "new_api": null,
          "old_text": "push_stack_element(&state.stack)",
          "new_text": null,
          "old_line_content": "\tpush_stack_element(&state.stack);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2603,
          "old_api": "find_next",
          "new_api": null,
          "old_text": "find_next(cp)",
          "new_text": null,
          "old_line_content": "\tfor (cp = format->format; *cp && (sp = find_next(cp)); cp = ep + 1) {",
          "new_line_content": "\tstruct ref_formatting_state state = REF_FORMATTING_STATE_INIT;",
          "content_same": false
        },
        {
          "line": 2607,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(sp, ')')",
          "new_text": null,
          "old_line_content": "\t\tep = strchr(sp, ')');",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2609,
          "old_api": "append_literal",
          "new_api": null,
          "old_text": "append_literal(cp, sp, &state)",
          "new_text": null,
          "old_line_content": "\t\t\tappend_literal(cp, sp, &state);",
          "new_line_content": "\t\tstruct atom_value *atomv;",
          "content_same": false
        },
        {
          "line": 2610,
          "old_api": "parse_ref_filter_atom",
          "new_api": null,
          "old_text": "parse_ref_filter_atom(format, sp + 2, ep, error_buf)",
          "new_text": null,
          "old_line_content": "\t\tpos = parse_ref_filter_atom(format, sp + 2, ep, error_buf);",
          "new_line_content": "\t\tint pos;",
          "content_same": false
        },
        {
          "line": 2611,
          "old_api": "get_ref_atom_value",
          "new_api": null,
          "old_text": "get_ref_atom_value(info, pos, &atomv, error_buf)",
          "new_text": null,
          "old_line_content": "\t\tif (pos < 0 || get_ref_atom_value(info, pos, &atomv, error_buf) ||",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2739,
          "old_api": "BUG_ON_OPT_NEG",
          "new_api": null,
          "old_text": "BUG_ON_OPT_NEG(unset)",
          "new_text": null,
          "old_line_content": "\tBUG_ON_OPT_NEG(unset);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2613,
          "old_api": "pop_stack_element",
          "new_api": null,
          "old_text": "pop_stack_element(&state.stack)",
          "new_text": null,
          "old_line_content": "\t\t\tpop_stack_element(&state.stack);",
          "new_line_content": "\t\tif (cp < sp)",
          "content_same": false
        },
        {
          "line": 2741,
          "old_api": "get_oid",
          "new_api": null,
          "old_text": "get_oid(arg, &oid)",
          "new_text": null,
          "old_line_content": "\tif (get_oid(arg, &oid))",
          "new_line_content": "\tstruct object_id oid;",
          "content_same": false
        },
        {
          "line": 2742,
          "old_api": "_",
          "new_api": null,
          "old_text": "_(\"malformed object name %s\")",
          "new_text": null,
          "old_line_content": "\t\tdie(_(\"malformed object name %s\"), arg);",
          "new_line_content": "\tstruct commit *merge_commit;",
          "content_same": false
        },
        {
          "line": 2489,
          "old_api": "get_ref_atom_value",
          "new_api": null,
          "old_text": "get_ref_atom_value(a, s->atom, &va, &err)",
          "new_text": null,
          "old_line_content": "\tif (get_ref_atom_value(a, s->atom, &va, &err))",
          "new_line_content": "\tint cmp;",
          "content_same": false
        },
        {
          "line": 2490,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"%s\", err.buf)",
          "new_text": null,
          "old_line_content": "\t\tdie(\"%s\", err.buf);",
          "new_line_content": "\tint cmp_detached_head = 0;",
          "content_same": false
        },
        {
          "line": 2491,
          "old_api": "get_ref_atom_value",
          "new_api": null,
          "old_text": "get_ref_atom_value(b, s->atom, &vb, &err)",
          "new_text": null,
          "old_line_content": "\tif (get_ref_atom_value(b, s->atom, &vb, &err))",
          "new_line_content": "\tcmp_type cmp_type = used_atom[s->atom].type;",
          "content_same": false
        },
        {
          "line": 2492,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"%s\", err.buf)",
          "new_text": null,
          "old_line_content": "\t\tdie(\"%s\", err.buf);",
          "new_line_content": "\tstruct strbuf err = STRBUF_INIT;",
          "content_same": false
        },
        {
          "line": 2493,
          "old_api": "strbuf_release",
          "new_api": null,
          "old_text": "strbuf_release(&err)",
          "new_text": null,
          "old_line_content": "\tstrbuf_release(&err);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2619,
          "old_api": "append_literal",
          "new_api": null,
          "old_text": "append_literal(cp, sp, &state)",
          "new_text": null,
          "old_line_content": "\t\tappend_literal(cp, sp, &state);",
          "new_line_content": "\t\t\treturn -1;",
          "content_same": false
        },
        {
          "line": 2750,
          "old_api": "commit_list_insert",
          "new_api": null,
          "old_text": "commit_list_insert(merge_commit, &rf->unreachable_from)",
          "new_text": null,
          "old_line_content": "\t\tcommit_list_insert(merge_commit, &rf->unreachable_from);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2625,
          "old_api": "pop_stack_element",
          "new_api": null,
          "old_text": "pop_stack_element(&state.stack)",
          "new_text": null,
          "old_line_content": "\t\t\tpop_stack_element(&state.stack);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 2499,
          "old_api": "versioncmp",
          "new_api": null,
          "old_text": "versioncmp(va->s, vb->s)",
          "new_text": null,
          "old_line_content": "\t\tcmp = versioncmp(va->s, vb->s);",
          "new_line_content": "\tif (s->sort_flags & REF_SORTING_DETACHED_HEAD_FIRST &&",
          "content_same": false
        },
        {
          "line": 2631,
          "old_api": "_",
          "new_api": null,
          "old_text": "_(\"format: %%(end) atom missing\")",
          "new_text": null,
          "old_line_content": "\t\treturn strbuf_addf_ret(error_buf, -1, _(\"format: %%(end) atom missing\"));",
          "new_line_content": "\t\t\treturn -1;",
          "content_same": false
        },
        {
          "line": 2505,
          "old_api": "cmp_fn",
          "new_api": null,
          "old_text": "cmp_fn(va->s, vb->s)",
          "new_text": null,
          "old_line_content": "\t\t\tcmp = cmp_fn(va->s, vb->s);",
          "new_line_content": "\t} else if (cmp_type == FIELD_STR) {",
          "content_same": false
        },
        {
          "line": 2633,
          "old_api": "strbuf_addbuf",
          "new_api": null,
          "old_text": "strbuf_addbuf(final_buf, &state.stack->output)",
          "new_text": null,
          "old_line_content": "\tstrbuf_addbuf(final_buf, &state.stack->output);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 2634,
          "old_api": "pop_stack_element",
          "new_api": null,
          "old_text": "pop_stack_element(&state.stack)",
          "new_text": null,
          "old_line_content": "\tpop_stack_element(&state.stack);",
          "new_line_content": "\tif (state.stack->prev) {",
          "content_same": false
        },
        {
          "line": 2508,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(va->s)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tstrlen(va->s) : va->s_size;",
          "new_line_content": "\t\t\tcmp_fn = s->sort_flags & REF_SORTING_ICASE",
          "content_same": false
        },
        {
          "line": 2645,
          "old_api": "new_ref_array_item",
          "new_api": null,
          "old_text": "new_ref_array_item(name, oid)",
          "new_text": null,
          "old_line_content": "\tref_item = new_ref_array_item(name, oid);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2646,
          "old_api": "ref_kind_from_refname",
          "new_api": null,
          "old_text": "ref_kind_from_refname(name)",
          "new_text": null,
          "old_line_content": "\tref_item->kind = ref_kind_from_refname(name);",
          "new_line_content": "\tstruct ref_array_item *ref_item;",
          "content_same": false
        },
        {
          "line": 2647,
          "old_api": "format_ref_array_item",
          "new_api": null,
          "old_text": "format_ref_array_item(ref_item, format, &output, &err)",
          "new_text": null,
          "old_line_content": "\tif (format_ref_array_item(ref_item, format, &output, &err))",
          "new_line_content": "\tstruct strbuf output = STRBUF_INIT;",
          "content_same": false
        },
        {
          "line": 2648,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"%s\", err.buf)",
          "new_text": null,
          "old_line_content": "\t\tdie(\"%s\", err.buf);",
          "new_line_content": "\tstruct strbuf err = STRBUF_INIT;",
          "content_same": false
        },
        {
          "line": 2649,
          "old_api": "fwrite",
          "new_api": null,
          "old_text": "fwrite(output.buf, 1, output.len, stdout)",
          "new_text": null,
          "old_line_content": "\tfwrite(output.buf, 1, output.len, stdout);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2664,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(atom)",
          "new_text": null,
          "old_line_content": "\tconst char *end = atom + strlen(atom);",
          "new_line_content": "\t/*",
          "content_same": false
        },
        {
          "line": 2666,
          "old_api": "parse_ref_filter_atom",
          "new_api": null,
          "old_text": "parse_ref_filter_atom(&dummy, atom, end, &err)",
          "new_text": null,
          "old_line_content": "\tint res = parse_ref_filter_atom(&dummy, atom, end, &err);",
          "new_line_content": "\t * actually care about the formatting details.",
          "content_same": false
        },
        {
          "line": 2668,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"%s\", err.buf)",
          "new_text": null,
          "old_line_content": "\t\tdie(\"%s\", err.buf);",
          "new_line_content": "\tstruct ref_format dummy = REF_FORMAT_INIT;",
          "content_same": false
        },
        {
          "line": 2415,
          "old_api": "init_contains_cache",
          "new_api": null,
          "old_text": "init_contains_cache(&ref_cbdata.contains_cache)",
          "new_text": null,
          "old_line_content": "\tinit_contains_cache(&ref_cbdata.contains_cache);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2416,
          "old_api": "init_contains_cache",
          "new_api": null,
          "old_text": "init_contains_cache(&ref_cbdata.no_contains_cache)",
          "new_text": null,
          "old_line_content": "\tinit_contains_cache(&ref_cbdata.no_contains_cache);",
          "new_line_content": "\tsave_commit_buffer_orig = save_commit_buffer;",
          "content_same": false
        },
        {
          "line": 2544,
          "old_api": "cmp_ref_sorting",
          "new_api": null,
          "old_text": "cmp_ref_sorting(s, a, b)",
          "new_text": null,
          "old_line_content": "\t\tint cmp = cmp_ref_sorting(s, a, b);",
          "new_line_content": "\tstruct ref_array_item *a = *((struct ref_array_item **)a_);",
          "content_same": false
        },
        {
          "line": 2550,
          "old_api": "strcasecmp",
          "new_api": null,
          "old_text": "strcasecmp(a->refname, b->refname)",
          "new_text": null,
          "old_line_content": "\t\tstrcasecmp(a->refname, b->refname) :",
          "new_line_content": "\t\tif (cmp)",
          "content_same": false
        },
        {
          "line": 2551,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(a->refname, b->refname)",
          "new_text": null,
          "old_line_content": "\t\tstrcmp(a->refname, b->refname);",
          "new_line_content": "\t\t\treturn cmp;",
          "content_same": false
        },
        {
          "line": 2678,
          "old_api": "xcalloc",
          "new_api": null,
          "old_text": "xcalloc(1, sizeof(*sorting))",
          "new_text": null,
          "old_line_content": "\tstruct ref_sorting *sorting = xcalloc(1, sizeof(*sorting));",
          "new_line_content": "/*  If no sorting option is given, use refname to sort as default */",
          "content_same": false
        },
        {
          "line": 2681,
          "old_api": "parse_sorting_atom",
          "new_api": null,
          "old_text": "parse_sorting_atom(cstr_name)",
          "new_text": null,
          "old_line_content": "\tsorting->atom = parse_sorting_atom(cstr_name);",
          "new_line_content": "\tstatic const char cstr_name[] = \"refname\";",
          "content_same": false
        },
        {
          "line": 2429,
          "old_api": "for_each_fullref_in",
          "new_api": null,
          "old_text": "for_each_fullref_in(\"refs/heads/\", ref_filter_handler, &ref_cbdata)",
          "new_text": null,
          "old_line_content": "\t\t\tret = for_each_fullref_in(\"refs/heads/\", ref_filter_handler, &ref_cbdata);",
          "new_line_content": "\t\t * we iterate over all refs and filter out required refs with the help",
          "content_same": false
        },
        {
          "line": 2431,
          "old_api": "for_each_fullref_in",
          "new_api": null,
          "old_text": "for_each_fullref_in(\"refs/remotes/\", ref_filter_handler, &ref_cbdata)",
          "new_text": null,
          "old_line_content": "\t\t\tret = for_each_fullref_in(\"refs/remotes/\", ref_filter_handler, &ref_cbdata);",
          "new_line_content": "\t\t */",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 20,
      "total_additions": 57,
      "total_deletions": 57,
      "total_api_changes": 134
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 134,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          2408,
          2417,
          2418,
          2451
        ]
      }
    },
    "api_calls_before": 609,
    "api_calls_after": 609,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 0,
      "total_diff_lines": 31
    }
  }
}