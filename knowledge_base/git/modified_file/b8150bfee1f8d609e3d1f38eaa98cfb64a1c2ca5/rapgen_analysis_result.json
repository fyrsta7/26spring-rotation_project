{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/b8150bfee1f8d609e3d1f38eaa98cfb64a1c2ca5",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/b8150bfee1f8d609e3d1f38eaa98cfb64a1c2ca5/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/b8150bfee1f8d609e3d1f38eaa98cfb64a1c2ca5/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/b8150bfee1f8d609e3d1f38eaa98cfb64a1c2ca5/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 681,
          "old_api": "child_process_init",
          "new_api": "run_command",
          "old_text": "child_process_init(&cp)",
          "new_text": "run_command(&cp)",
          "old_line_content": "\t\t\tchild_process_init(&cp);",
          "new_line_content": "\t\t\trun_command(&cp);",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": "repo_read_index",
          "new_api": "prepare_repo_settings",
          "old_text": "repo_read_index(the_repository)",
          "new_text": "prepare_repo_settings(the_repository)",
          "old_line_content": "\t\t\trepo_read_index(the_repository);",
          "new_line_content": "\t\t\tprepare_repo_settings(the_repository);",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": "repo_hold_locked_index",
          "new_api": "refresh_index",
          "old_text": "repo_hold_locked_index(the_repository,\n\t\t\t\t\t\t    &index_lock, 0)",
          "new_text": "refresh_index(the_repository->index, REFRESH_QUIET|REFRESH_UNMERGED,\n\t\t\t\t      NULL, NULL, NULL)",
          "old_line_content": "\t\t\tfd = repo_hold_locked_index(the_repository,",
          "new_line_content": "\t\t\trefresh_index(the_repository->index, REFRESH_QUIET|REFRESH_UNMERGED,",
          "content_same": false
        },
        {
          "line": 717,
          "old_api": "repo_init_revisions",
          "new_api": "repo_update_index_if_able",
          "old_text": "repo_init_revisions(the_repository, &revs, prefix)",
          "new_text": "repo_update_index_if_able(the_repository, &index_lock)",
          "old_line_content": "\t\t\trepo_init_revisions(the_repository, &revs, prefix);",
          "new_line_content": "\t\t\t\trepo_update_index_if_able(the_repository, &index_lock);",
          "content_same": false
        },
        {
          "line": 719,
          "old_api": "ARRAY_SIZE",
          "new_api": "repo_init_revisions",
          "old_text": "ARRAY_SIZE(diff_index_args)",
          "new_text": "repo_init_revisions(the_repository, &revs, prefix)",
          "old_line_content": "\t\t\tif (setup_revisions(ARRAY_SIZE(diff_index_args) - 1,",
          "new_line_content": "\t\t\trepo_init_revisions(the_repository, &revs, prefix);",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": "BUG",
          "new_api": "ARRAY_SIZE",
          "old_text": "BUG(\"malformed internal diff-index command line\")",
          "new_text": "ARRAY_SIZE(diff_index_args)",
          "old_line_content": "\t\t\t\tBUG(\"malformed internal diff-index command line\");",
          "new_line_content": "\t\t\tif (setup_revisions(ARRAY_SIZE(diff_index_args) - 1,",
          "content_same": false
        },
        {
          "line": 724,
          "old_api": "diff_result_code",
          "new_api": "run_diff_index",
          "old_text": "diff_result_code(&revs)",
          "new_text": "run_diff_index(&revs, 0)",
          "old_line_content": "\t\t\tif (!diff_result_code(&revs))",
          "new_line_content": "\t\t\trun_diff_index(&revs, 0);",
          "content_same": false
        },
        {
          "line": 730,
          "old_api": "describe",
          "new_api": "release_revisions",
          "old_text": "describe(\"HEAD\", 1)",
          "new_text": "release_revisions(&revs)",
          "old_line_content": "\t\tdescribe(\"HEAD\", 1);",
          "new_line_content": "\t\t\trelease_revisions(&revs);",
          "content_same": false
        },
        {
          "line": 732,
          "old_api": "_",
          "new_api": "describe",
          "old_text": "_(\"option '%s' and commit-ishes cannot be used together\")",
          "new_text": "describe(\"HEAD\", 1)",
          "old_line_content": "\t\tdie(_(\"option '%s' and commit-ishes cannot be used together\"), \"--dirty\");",
          "new_line_content": "\t\tdescribe(\"HEAD\", 1);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 736,
          "old_api": null,
          "new_api": "_",
          "old_text": null,
          "new_text": "_(\"option '%s' and commit-ishes cannot be used together\")",
          "old_line_content": "\t\twhile (argc-- > 0)",
          "new_line_content": "\t\tdie(_(\"option '%s' and commit-ishes cannot be used together\"), \"--broken\");",
          "content_same": false
        },
        {
          "line": 739,
          "old_api": null,
          "new_api": "describe",
          "old_text": null,
          "new_text": "describe(*argv++, argc == 0)",
          "old_line_content": "\treturn 0;",
          "new_line_content": "\t\t\tdescribe(*argv++, argc == 0);",
          "content_same": false
        },
        {
          "line": 708,
          "old_api": null,
          "new_api": "setup_work_tree",
          "old_text": null,
          "new_text": "setup_work_tree()",
          "old_line_content": "\t\t\tthe_repository->settings.command_requires_full_index = 0;",
          "new_line_content": "\t\t\tsetup_work_tree();",
          "content_same": false
        },
        {
          "line": 677,
          "old_api": null,
          "new_api": "strvec_pushv",
          "old_text": null,
          "new_text": "strvec_pushv(&cp.args, update_index_args)",
          "old_line_content": "\t\t\tcp.no_stdin = 1;",
          "new_line_content": "\t\t\tstrvec_pushv(&cp.args, update_index_args);",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": null,
          "new_api": "repo_read_index",
          "old_text": null,
          "new_text": "repo_read_index(the_repository)",
          "old_line_content": "\t\t\t\t      NULL, NULL, NULL);",
          "new_line_content": "\t\t\trepo_read_index(the_repository);",
          "content_same": false
        },
        {
          "line": 714,
          "old_api": null,
          "new_api": "repo_hold_locked_index",
          "old_text": null,
          "new_text": "repo_hold_locked_index(the_repository,\n\t\t\t\t\t\t    &index_lock, 0)",
          "old_line_content": "\t\t\tif (0 <= fd)",
          "new_line_content": "\t\t\tfd = repo_hold_locked_index(the_repository,",
          "content_same": false
        },
        {
          "line": 683,
          "old_api": null,
          "new_api": "child_process_init",
          "old_text": null,
          "new_text": "child_process_init(&cp)",
          "old_line_content": "\t\t\tcp.git_cmd = 1;",
          "new_line_content": "\t\t\tchild_process_init(&cp);",
          "content_same": false
        },
        {
          "line": 684,
          "old_api": null,
          "new_api": "strvec_pushv",
          "old_text": null,
          "new_text": "strvec_pushv(&cp.args, diff_index_args)",
          "old_line_content": "\t\t\tcp.no_stdin = 1;",
          "new_line_content": "\t\t\tstrvec_pushv(&cp.args, diff_index_args);",
          "content_same": false
        },
        {
          "line": 723,
          "old_api": null,
          "new_api": "BUG",
          "old_text": null,
          "new_text": "BUG(\"malformed internal diff-index command line\")",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tBUG(\"malformed internal diff-index command line\");",
          "content_same": false
        },
        {
          "line": 692,
          "old_api": null,
          "new_api": "run_command",
          "old_text": null,
          "new_text": "run_command(&cp)",
          "old_line_content": "\t\t\t\tsuffix = NULL;",
          "new_line_content": "\t\t\tswitch (run_command(&cp)) {",
          "content_same": false
        },
        {
          "line": 726,
          "old_api": null,
          "new_api": "diff_result_code",
          "old_text": null,
          "new_text": "diff_result_code(&revs)",
          "old_line_content": "\t\t\telse",
          "new_line_content": "\t\t\tif (!diff_result_code(&revs))",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": null,
          "new_api": "hashmap_get_size",
          "old_text": null,
          "new_text": "hashmap_get_size(&names)",
          "old_line_content": "",
          "new_line_content": "\tif (hashmap_get_size(&names) < max_candidates)",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": null,
          "new_api": "hashmap_get_size",
          "old_text": null,
          "new_text": "hashmap_get_size(&names)",
          "old_line_content": "\tif (argc == 0) {",
          "new_line_content": "\t\tmax_candidates = hashmap_get_size(&names);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 737,
          "old_api": "describe",
          "new_api": null,
          "old_text": "describe(*argv++, argc == 0)",
          "new_text": null,
          "old_line_content": "\t\t\tdescribe(*argv++, argc == 0);",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 706,
          "old_api": "setup_work_tree",
          "new_api": null,
          "old_text": "setup_work_tree()",
          "new_text": null,
          "old_line_content": "\t\t\tsetup_work_tree();",
          "new_line_content": "\t\t\tint fd;",
          "content_same": false
        },
        {
          "line": 675,
          "old_api": "strvec_pushv",
          "new_api": null,
          "old_text": "strvec_pushv(&cp.args, update_index_args)",
          "new_text": null,
          "old_line_content": "\t\t\tstrvec_pushv(&cp.args, update_index_args);",
          "new_line_content": "\t\t\tstruct child_process cp = CHILD_PROCESS_INIT;",
          "content_same": false
        },
        {
          "line": 707,
          "old_api": "prepare_repo_settings",
          "new_api": null,
          "old_text": "prepare_repo_settings(the_repository)",
          "new_text": null,
          "old_line_content": "\t\t\tprepare_repo_settings(the_repository);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": "refresh_index",
          "new_api": null,
          "old_text": "refresh_index(the_repository->index, REFRESH_QUIET|REFRESH_UNMERGED,\n\t\t\t\t      NULL, NULL, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\trefresh_index(the_repository->index, REFRESH_QUIET|REFRESH_UNMERGED,",
          "new_line_content": "\t\t\tthe_repository->settings.command_requires_full_index = 0;",
          "content_same": false
        },
        {
          "line": 679,
          "old_api": "run_command",
          "new_api": null,
          "old_text": "run_command(&cp)",
          "new_text": null,
          "old_line_content": "\t\t\trun_command(&cp);",
          "new_line_content": "\t\t\tcp.no_stdin = 1;",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": "strvec_pushv",
          "new_api": null,
          "old_text": "strvec_pushv(&cp.args, diff_index_args)",
          "new_text": null,
          "old_line_content": "\t\t\tstrvec_pushv(&cp.args, diff_index_args);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 715,
          "old_api": "repo_update_index_if_able",
          "new_api": null,
          "old_text": "repo_update_index_if_able(the_repository, &index_lock)",
          "new_text": null,
          "old_line_content": "\t\t\t\trepo_update_index_if_able(the_repository, &index_lock);",
          "new_line_content": "\t\t\t\t\t\t    &index_lock, 0);",
          "content_same": false
        },
        {
          "line": 690,
          "old_api": "run_command",
          "new_api": null,
          "old_text": "run_command(&cp)",
          "new_text": null,
          "old_line_content": "\t\t\tswitch (run_command(&cp)) {",
          "new_line_content": "\t\t\t\tdirty = \"-dirty\";",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": "run_diff_index",
          "new_api": null,
          "old_text": "run_diff_index(&revs, 0)",
          "new_text": null,
          "old_line_content": "\t\t\trun_diff_index(&revs, 0);",
          "new_line_content": "\t\t\t\t\t    diff_index_args, &revs, NULL) != 1)",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "release_revisions",
          "new_api": null,
          "old_text": "release_revisions(&revs)",
          "new_text": null,
          "old_line_content": "\t\t\trelease_revisions(&revs);",
          "new_line_content": "\t\t\telse",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 9,
      "total_additions": 13,
      "total_deletions": 11,
      "total_api_changes": 33
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 33,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 208,
    "api_calls_after": 210,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 0,
      "total_diff_lines": 14
    }
  }
}