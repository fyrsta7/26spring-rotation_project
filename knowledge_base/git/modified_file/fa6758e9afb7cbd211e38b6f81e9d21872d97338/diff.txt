diff --git a/modified_file.c b/modified_file.c
index 0000000..1111111 100644
--- a/modified_file.c
+++ b/modified_file.c
--- a/modified_file.c
+++ b/modified_file.c
@@ -1076,7 +1076,7 @@
 		return 1;

 	}

 

-	if (last && last->data.buf && last->depth < max_depth

+	if (last && last->data.len && last->data.buf && last->depth < max_depth

 		&& dat->len > the_hash_algo->rawsz) {

 

 		delta_count_attempts_by_type[type]++;
