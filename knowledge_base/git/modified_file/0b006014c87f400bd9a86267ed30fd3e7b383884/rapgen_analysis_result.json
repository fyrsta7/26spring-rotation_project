{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/0b006014c87f400bd9a86267ed30fd3e7b383884",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/0b006014c87f400bd9a86267ed30fd3e7b383884/before.h",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/0b006014c87f400bd9a86267ed30fd3e7b383884/after.h",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/0b006014c87f400bd9a86267ed30fd3e7b383884/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1153,
          "old_api": "do_lookup_replace_object",
          "new_api": "lookup_replace_object",
          "old_text": "do_lookup_replace_object(sha1)",
          "new_text": "lookup_replace_object(sha1)",
          "old_line_content": "\treturn do_lookup_replace_object(sha1);",
          "new_line_content": "\treturn lookup_replace_object(sha1);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1028,
          "old_api": null,
          "new_api": "hashcmp",
          "old_text": null,
          "new_text": "hashcmp(oid->hash, EMPTY_BLOB_SHA1_BIN)",
          "old_line_content": "static inline int is_empty_blob_sha1(const unsigned char *sha1)",
          "new_line_content": "\treturn !hashcmp(oid->hash, EMPTY_BLOB_SHA1_BIN);",
          "content_same": false
        },
        {
          "line": 1033,
          "old_api": null,
          "new_api": "hashcmp",
          "old_text": null,
          "new_text": "hashcmp(sha1, EMPTY_TREE_SHA1_BIN)",
          "old_line_content": "static inline int is_empty_blob_oid(const struct object_id *oid)",
          "new_line_content": "\treturn !hashcmp(sha1, EMPTY_TREE_SHA1_BIN);",
          "content_same": false
        },
        {
          "line": 1038,
          "old_api": null,
          "new_api": "hashcmp",
          "old_text": null,
          "new_text": "hashcmp(oid->hash, EMPTY_TREE_SHA1_BIN)",
          "old_line_content": "static inline int is_empty_tree_sha1(const unsigned char *sha1)",
          "new_line_content": "\treturn !hashcmp(oid->hash, EMPTY_TREE_SHA1_BIN);",
          "content_same": false
        },
        {
          "line": 1957,
          "old_api": null,
          "new_api": "format (printf, 2, 3)",
          "old_text": null,
          "new_text": "format (printf, 2, 3)",
          "old_line_content": "extern const char *git_commit_encoding;",
          "new_line_content": "__attribute__((format (printf, 2, 3)))",
          "content_same": false
        },
        {
          "line": 1204,
          "old_api": null,
          "new_api": "has_sha1_file_with_flags",
          "old_text": null,
          "new_text": "has_sha1_file_with_flags(sha1, 0)",
          "old_line_content": " * when we cannot find the object (this means we may give a false",
          "new_line_content": "\treturn has_sha1_file_with_flags(sha1, 0);",
          "content_same": false
        },
        {
          "line": 1975,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(str)",
          "old_line_content": "",
          "new_line_content": "\treturn write_in_full(fd, str, strlen(str));",
          "content_same": false
        },
        {
          "line": 1467,
          "old_api": null,
          "new_api": "strbuf_release",
          "old_text": null,
          "new_text": "strbuf_release(&cache->path)",
          "old_line_content": "\tint flags;",
          "new_line_content": "\tstrbuf_release(&cache->path);",
          "content_same": false
        },
        {
          "line": 965,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(sha1, sha2, GIT_SHA1_RAWSZ)",
          "old_line_content": "\tint i;",
          "new_line_content": "\treturn memcmp(sha1, sha2, GIT_SHA1_RAWSZ);",
          "content_same": false
        },
        {
          "line": 1095,
          "old_api": null,
          "new_api": "has_dos_drive_prefix",
          "old_text": null,
          "new_text": "has_dos_drive_prefix(path)",
          "old_line_content": "enum scld_error safe_create_leading_directories_const(const char *path);",
          "new_line_content": "\treturn is_dir_sep(path[0]) || has_dos_drive_prefix(path);",
          "content_same": false
        },
        {
          "line": 1991,
          "old_api": null,
          "new_api": "format (printf, 2, 3)",
          "old_text": null,
          "new_text": "format (printf, 2, 3)",
          "old_line_content": "/**",
          "new_line_content": "__attribute__((format (printf, 2, 3)))",
          "content_same": false
        },
        {
          "line": 970,
          "old_api": null,
          "new_api": "hashcmp",
          "old_text": null,
          "new_text": "hashcmp(oid1->hash, oid2->hash)",
          "old_line_content": "\t}",
          "new_line_content": "\treturn hashcmp(oid1->hash, oid2->hash);",
          "content_same": false
        },
        {
          "line": 975,
          "old_api": null,
          "new_api": "hashcmp",
          "old_text": null,
          "new_text": "hashcmp(sha1, null_sha1)",
          "old_line_content": "static inline int oidcmp(const struct object_id *oid1, const struct object_id *oid2)",
          "new_line_content": "\treturn !hashcmp(sha1, null_sha1);",
          "content_same": false
        },
        {
          "line": 1234,
          "old_api": null,
          "new_api": "hexval",
          "old_text": null,
          "new_text": "hexval(s[0])",
          "old_line_content": "",
          "new_line_content": "\tint val = hexval(s[0]);",
          "content_same": false
        },
        {
          "line": 1235,
          "old_api": null,
          "new_api": "hexval",
          "old_text": null,
          "new_text": "hexval(s[1])",
          "old_line_content": "/*",
          "new_line_content": "\treturn (val < 0) ? val : (val << 4) | hexval(s[1]);",
          "content_same": false
        },
        {
          "line": 980,
          "old_api": null,
          "new_api": "hashcmp",
          "old_text": null,
          "new_text": "hashcmp(oid->hash, null_sha1)",
          "old_line_content": "static inline int is_null_sha1(const unsigned char *sha1)",
          "new_line_content": "\treturn !hashcmp(oid->hash, null_sha1);",
          "content_same": false
        },
        {
          "line": 985,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(sha_dst, sha_src, GIT_SHA1_RAWSZ)",
          "old_line_content": "static inline int is_null_oid(const struct object_id *oid)",
          "new_line_content": "\tmemcpy(sha_dst, sha_src, GIT_SHA1_RAWSZ);",
          "content_same": false
        },
        {
          "line": 990,
          "old_api": null,
          "new_api": "hashcpy",
          "old_text": null,
          "new_text": "hashcpy(dst->hash, src->hash)",
          "old_line_content": "static inline void hashcpy(unsigned char *sha_dst, const unsigned char *sha_src)",
          "new_line_content": "\thashcpy(dst->hash, src->hash);",
          "content_same": false
        },
        {
          "line": 995,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(hash, 0, GIT_SHA1_RAWSZ)",
          "old_line_content": "static inline void oidcpy(struct object_id *dst, const struct object_id *src)",
          "new_line_content": "\tmemset(hash, 0, GIT_SHA1_RAWSZ);",
          "content_same": false
        },
        {
          "line": 1127,
          "old_api": null,
          "new_api": "read_sha1_file_extended",
          "old_text": null,
          "new_text": "read_sha1_file_extended(sha1, type, size, LOOKUP_REPLACE_OBJECT)",
          "old_line_content": "",
          "new_line_content": "\treturn read_sha1_file_extended(sha1, type, size, LOOKUP_REPLACE_OBJECT);",
          "content_same": false
        },
        {
          "line": 1000,
          "old_api": null,
          "new_api": "hashclr",
          "old_text": null,
          "new_text": "hashclr(oid->hash)",
          "old_line_content": "static inline void hashclr(unsigned char *hash)",
          "new_line_content": "\thashclr(oid->hash);",
          "content_same": false
        },
        {
          "line": 1146,
          "old_api": null,
          "new_api": "do_lookup_replace_object",
          "old_text": null,
          "new_text": "do_lookup_replace_object(sha1)",
          "old_line_content": " * either sha1 or a pointer to a permanently-allocated value.  When",
          "new_line_content": "\treturn do_lookup_replace_object(sha1);",
          "content_same": false
        },
        {
          "line": 1023,
          "old_api": null,
          "new_api": "hashcmp",
          "old_text": null,
          "new_text": "hashcmp(sha1, EMPTY_BLOB_SHA1_BIN)",
          "old_line_content": "\t\"\\x29\\xae\\x77\\x5a\\xd8\\xc2\\xe4\\x8c\\x53\\x91\"",
          "new_line_content": "\treturn !hashcmp(sha1, EMPTY_BLOB_SHA1_BIN);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1030,
          "old_api": "hashcmp",
          "new_api": null,
          "old_text": "hashcmp(sha1, EMPTY_BLOB_SHA1_BIN)",
          "new_text": null,
          "old_line_content": "\treturn !hashcmp(sha1, EMPTY_BLOB_SHA1_BIN);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1160,
          "old_api": "lookup_replace_object",
          "new_api": null,
          "old_text": "lookup_replace_object(sha1)",
          "new_text": null,
          "old_line_content": "\treturn lookup_replace_object(sha1);",
          "new_line_content": "extern int hash_sha1_file_literally(const void *buf, unsigned long len, const char *type, unsigned char *sha1, unsigned flags);",
          "content_same": false
        },
        {
          "line": 1035,
          "old_api": "hashcmp",
          "new_api": null,
          "old_text": "hashcmp(oid->hash, EMPTY_BLOB_SHA1_BIN)",
          "new_text": null,
          "old_line_content": "\treturn !hashcmp(oid->hash, EMPTY_BLOB_SHA1_BIN);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1040,
          "old_api": "hashcmp",
          "new_api": null,
          "old_text": "hashcmp(sha1, EMPTY_TREE_SHA1_BIN)",
          "new_text": null,
          "old_line_content": "\treturn !hashcmp(sha1, EMPTY_TREE_SHA1_BIN);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1045,
          "old_api": "hashcmp",
          "new_api": null,
          "old_text": "hashcmp(oid->hash, EMPTY_TREE_SHA1_BIN)",
          "new_text": null,
          "old_line_content": "\treturn !hashcmp(oid->hash, EMPTY_TREE_SHA1_BIN);",
          "new_line_content": "/*",
          "content_same": false
        },
        {
          "line": 1964,
          "old_api": "format (printf, 2, 3)",
          "new_api": null,
          "old_text": "format (printf, 2, 3)",
          "new_text": null,
          "old_line_content": "__attribute__((format (printf, 2, 3)))",
          "new_line_content": "extern int copy_file_with_time(const char *dst, const char *src, int mode);",
          "content_same": false
        },
        {
          "line": 1211,
          "old_api": "has_sha1_file_with_flags",
          "new_api": null,
          "old_text": "has_sha1_file_with_flags(sha1, 0)",
          "new_text": null,
          "old_line_content": "\treturn has_sha1_file_with_flags(sha1, 0);",
          "new_line_content": "/*",
          "content_same": false
        },
        {
          "line": 1982,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(str)",
          "new_text": null,
          "old_line_content": "\treturn write_in_full(fd, str, strlen(str));",
          "new_line_content": "extern void write_file_buf(const char *path, const char *buf, size_t len);",
          "content_same": false
        },
        {
          "line": 1474,
          "old_api": "strbuf_release",
          "new_api": null,
          "old_text": "strbuf_release(&cache->path)",
          "new_text": null,
          "old_line_content": "\tstrbuf_release(&cache->path);",
          "new_line_content": "extern void schedule_dir_for_removal(const char *name, int len);",
          "content_same": false
        },
        {
          "line": 1102,
          "old_api": "has_dos_drive_prefix",
          "new_api": null,
          "old_text": "has_dos_drive_prefix(path)",
          "new_text": null,
          "old_line_content": "\treturn is_dir_sep(path[0]) || has_dos_drive_prefix(path);",
          "new_line_content": "char *real_pathdup(const char *path, int die_on_error);",
          "content_same": false
        },
        {
          "line": 1998,
          "old_api": "format (printf, 2, 3)",
          "new_api": null,
          "old_text": "format (printf, 2, 3)",
          "new_text": null,
          "old_line_content": "__attribute__((format (printf, 2, 3)))",
          "new_line_content": "extern int term_columns(void);",
          "content_same": false
        },
        {
          "line": 977,
          "old_api": "hashcmp",
          "new_api": null,
          "old_text": "hashcmp(oid1->hash, oid2->hash)",
          "new_text": null,
          "old_line_content": "\treturn hashcmp(oid1->hash, oid2->hash);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 982,
          "old_api": "hashcmp",
          "new_api": null,
          "old_text": "hashcmp(sha1, null_sha1)",
          "new_text": null,
          "old_line_content": "\treturn !hashcmp(sha1, null_sha1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1241,
          "old_api": "hexval",
          "new_api": null,
          "old_text": "hexval(s[0])",
          "new_text": null,
          "old_line_content": "\tint val = hexval(s[0]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1242,
          "old_api": "hexval",
          "new_api": null,
          "old_text": "hexval(s[1])",
          "new_text": null,
          "old_line_content": "\treturn (val < 0) ? val : (val << 4) | hexval(s[1]);",
          "new_line_content": "/* used when the code does not know or care what the default abbrev is */",
          "content_same": false
        },
        {
          "line": 987,
          "old_api": "hashcmp",
          "new_api": null,
          "old_text": "hashcmp(oid->hash, null_sha1)",
          "new_text": null,
          "old_line_content": "\treturn !hashcmp(oid->hash, null_sha1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 992,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(sha_dst, sha_src, GIT_SHA1_RAWSZ)",
          "new_text": null,
          "old_line_content": "\tmemcpy(sha_dst, sha_src, GIT_SHA1_RAWSZ);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 997,
          "old_api": "hashcpy",
          "new_api": null,
          "old_text": "hashcpy(dst->hash, src->hash)",
          "new_text": null,
          "old_line_content": "\thashcpy(dst->hash, src->hash);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1002,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(hash, 0, GIT_SHA1_RAWSZ)",
          "new_text": null,
          "old_line_content": "\tmemset(hash, 0, GIT_SHA1_RAWSZ);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1134,
          "old_api": "read_sha1_file_extended",
          "new_api": null,
          "old_text": "read_sha1_file_extended(sha1, type, size, LOOKUP_REPLACE_OBJECT)",
          "new_text": null,
          "old_line_content": "\treturn read_sha1_file_extended(sha1, type, size, LOOKUP_REPLACE_OBJECT);",
          "new_line_content": "extern const unsigned char *do_lookup_replace_object(const unsigned char *sha1);",
          "content_same": false
        },
        {
          "line": 1007,
          "old_api": "hashclr",
          "new_api": null,
          "old_text": "hashclr(oid->hash)",
          "new_text": null,
          "old_line_content": "\thashclr(oid->hash);",
          "new_line_content": "\t \"\\x4b\\x82\\x5d\\xc6\\x42\\xcb\\x6e\\xb9\\xa0\\x60\" \\",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 1,
      "total_additions": 22,
      "total_deletions": 21,
      "total_api_changes": 44
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 8,
        "api_related_lines": 44,
        "non_api_lines": 6,
        "non_api_line_numbers": [
          966,
          967,
          968,
          969,
          971,
          972
        ]
      }
    },
    "api_calls_before": 50,
    "api_calls_after": 51,
    "diff_info": {
      "added_lines": 1,
      "removed_lines": 8,
      "total_diff_lines": 21
    }
  }
}