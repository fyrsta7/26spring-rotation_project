{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/e6812cfa9aba69a8c9d83b0710291b27bff0f7a3",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/e6812cfa9aba69a8c9d83b0710291b27bff0f7a3/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/e6812cfa9aba69a8c9d83b0710291b27bff0f7a3/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/e6812cfa9aba69a8c9d83b0710291b27bff0f7a3/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 625,
          "old_api": "die",
          "new_api": "get_sha1",
          "old_text": "die(\"corrupt mark line: %s\", line)",
          "new_text": "get_sha1(mark_end + 1, sha1)",
          "old_line_content": "\t\t\tdie(\"corrupt mark line: %s\", line);",
          "new_line_content": "\t\t\t|| *mark_end != ' ' || get_sha1(mark_end + 1, sha1))",
          "content_same": false
        },
        {
          "line": 660,
          "old_api": "N_",
          "new_api": "OPT_INTEGER",
          "old_text": "N_(\"select handling of signed tags\")",
          "new_text": "OPT_INTEGER(0, \"progress\", &progress,\n\t\t\t    N_(\"show progress after <n> objects\"))",
          "old_line_content": "\t\t\t     N_(\"select handling of signed tags\"),",
          "new_line_content": "\t\tOPT_INTEGER(0, \"progress\", &progress,",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": "OPT_BOOLEAN",
          "new_api": "N_",
          "old_text": "OPT_BOOLEAN(0, \"fake-missing-tagger\", &fake_missing_tagger,\n\t\t\t     N_(\"Fake a tagger when tags lack one\"))",
          "new_text": "N_(\"Dump marks to this file\")",
          "old_line_content": "\t\tOPT_BOOLEAN(0, \"fake-missing-tagger\", &fake_missing_tagger,",
          "new_line_content": "\t\t\t     N_(\"Dump marks to this file\")),",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": "OPT_BOOLEAN",
          "new_api": "N_",
          "old_text": "OPT_BOOLEAN(0, \"full-tree\", &full_tree,\n\t\t\t     N_(\"Output full tree for each commit\"))",
          "new_text": "N_(\"Import marks from this file\")",
          "old_line_content": "\t\tOPT_BOOLEAN(0, \"full-tree\", &full_tree,",
          "new_line_content": "\t\t\t     N_(\"Import marks from this file\")),",
          "content_same": false
        },
        {
          "line": 672,
          "old_api": "N_",
          "new_api": "OPT_BOOLEAN",
          "old_text": "N_(\"Output full tree for each commit\")",
          "new_text": "OPT_BOOLEAN(0, \"fake-missing-tagger\", &fake_missing_tagger,\n\t\t\t     N_(\"Fake a tagger when tags lack one\"))",
          "old_line_content": "\t\t\t     N_(\"Output full tree for each commit\")),",
          "new_line_content": "\t\tOPT_BOOLEAN(0, \"fake-missing-tagger\", &fake_missing_tagger,",
          "content_same": false
        },
        {
          "line": 673,
          "old_api": "OPT_BOOLEAN",
          "new_api": "N_",
          "old_text": "OPT_BOOLEAN(0, \"use-done-feature\", &use_done_feature,\n\t\t\t     N_(\"Use the done feature to terminate the stream\"))",
          "new_text": "N_(\"Fake a tagger when tags lack one\")",
          "old_line_content": "\t\tOPT_BOOLEAN(0, \"use-done-feature\", &use_done_feature,",
          "new_line_content": "\t\t\t     N_(\"Fake a tagger when tags lack one\")),",
          "content_same": false
        },
        {
          "line": 674,
          "old_api": "N_",
          "new_api": "OPT_BOOLEAN",
          "old_text": "N_(\"Use the done feature to terminate the stream\")",
          "new_text": "OPT_BOOLEAN(0, \"full-tree\", &full_tree,\n\t\t\t     N_(\"Output full tree for each commit\"))",
          "old_line_content": "\t\t\t     N_(\"Use the done feature to terminate the stream\")),",
          "new_line_content": "\t\tOPT_BOOLEAN(0, \"full-tree\", &full_tree,",
          "content_same": false
        },
        {
          "line": 676,
          "old_api": "OPT_END",
          "new_api": "OPT_BOOLEAN",
          "old_text": "OPT_END()",
          "new_text": "OPT_BOOLEAN(0, \"use-done-feature\", &use_done_feature,\n\t\t\t     N_(\"Use the done feature to terminate the stream\"))",
          "old_line_content": "\t\tOPT_END()",
          "new_line_content": "\t\tOPT_BOOLEAN(0, \"use-done-feature\", &use_done_feature,",
          "content_same": false
        },
        {
          "line": 683,
          "old_api": "git_config",
          "new_api": "usage_with_options (fast_export_usage, options)",
          "old_text": "git_config(git_default_config, NULL)",
          "new_text": "usage_with_options (fast_export_usage, options)",
          "old_line_content": "\tgit_config(git_default_config, NULL);",
          "new_line_content": "\t\tusage_with_options (fast_export_usage, options);",
          "content_same": false
        },
        {
          "line": 692,
          "old_api": "usage_with_options (fast_export_usage, options)",
          "new_api": "setup_revisions",
          "old_text": "usage_with_options (fast_export_usage, options)",
          "new_text": "setup_revisions(argc, argv, &revs, NULL)",
          "old_line_content": "\t\tusage_with_options (fast_export_usage, options);",
          "new_line_content": "\targc = setup_revisions(argc, argv, &revs, NULL);",
          "content_same": false
        },
        {
          "line": 695,
          "old_api": "printf",
          "new_api": "usage_with_options (fast_export_usage, options)",
          "old_text": "printf(\"feature done\\n\")",
          "new_text": "usage_with_options (fast_export_usage, options)",
          "old_line_content": "\t\tprintf(\"feature done\\n\");",
          "new_line_content": "\t\tusage_with_options (fast_export_usage, options);",
          "content_same": false
        },
        {
          "line": 698,
          "old_api": "import_marks",
          "new_api": "printf",
          "old_text": "import_marks(import_filename)",
          "new_text": "printf(\"feature done\\n\")",
          "old_line_content": "\t\timport_marks(import_filename);",
          "new_line_content": "\t\tprintf(\"feature done\\n\");",
          "content_same": false
        },
        {
          "line": 707,
          "old_api": "die",
          "new_api": "get_tags_and_duplicates",
          "old_text": "die(\"revision walk setup failed\")",
          "new_text": "get_tags_and_duplicates(&revs.cmdline, &extra_refs)",
          "old_line_content": "\t\tdie(\"revision walk setup failed\");",
          "new_line_content": "\tget_tags_and_duplicates(&revs.cmdline, &extra_refs);",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": "DIFF_OPT_SET",
          "new_api": "prepare_revision_walk",
          "old_text": "DIFF_OPT_SET(&revs.diffopt, RECURSIVE)",
          "new_text": "prepare_revision_walk(&revs)",
          "old_line_content": "\tDIFF_OPT_SET(&revs.diffopt, RECURSIVE);",
          "new_line_content": "\tif (prepare_revision_walk(&revs))",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": "get_revision",
          "new_api": "die",
          "old_text": "get_revision(&revs)",
          "new_text": "die(\"revision walk setup failed\")",
          "old_line_content": "\twhile ((commit = get_revision(&revs))) {",
          "new_line_content": "\t\tdie(\"revision walk setup failed\");",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": "add_object_array",
          "new_api": "DIFF_OPT_SET",
          "old_text": "add_object_array(&commit->object, NULL, &commits)",
          "new_text": "DIFF_OPT_SET(&revs.diffopt, RECURSIVE)",
          "old_line_content": "\t\t\tadd_object_array(&commit->object, NULL, &commits);",
          "new_line_content": "\tDIFF_OPT_SET(&revs.diffopt, RECURSIVE);",
          "content_same": false
        },
        {
          "line": 715,
          "old_api": "handle_commit",
          "new_api": "add_object_array",
          "old_text": "handle_commit(commit, &revs)",
          "new_text": "add_object_array(&commit->object, NULL, &commits)",
          "old_line_content": "\t\t\thandle_commit(commit, &revs);",
          "new_line_content": "\t\t\tadd_object_array(&commit->object, NULL, &commits);",
          "content_same": false
        },
        {
          "line": 723,
          "old_api": "export_marks",
          "new_api": "handle_tags_and_duplicates",
          "old_text": "export_marks(export_filename)",
          "new_text": "handle_tags_and_duplicates(&extra_refs)",
          "old_line_content": "\t\texport_marks(export_filename);",
          "new_line_content": "\thandle_tags_and_duplicates(&extra_refs);",
          "content_same": false
        },
        {
          "line": 726,
          "old_api": "printf",
          "new_api": "export_marks",
          "old_text": "printf(\"done\\n\")",
          "new_text": "export_marks(export_filename)",
          "old_line_content": "\t\tprintf(\"done\\n\");",
          "new_line_content": "\t\texport_marks(export_filename);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 642,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(sha1)",
          "old_line_content": "",
          "new_line_content": "\t\t\terror(\"Object %s already has a mark\", sha1_to_hex(sha1));",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": null,
          "new_api": "mark_object",
          "old_text": null,
          "new_text": "mark_object(object, mark)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tmark_object(object, mark);",
          "content_same": false
        },
        {
          "line": 648,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(f)",
          "old_line_content": "int cmd_fast_export(int argc, const char **argv, const char *prefix)",
          "new_line_content": "\tfclose(f);",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": null,
          "new_api": "N_",
          "old_text": null,
          "new_text": "N_(\"show progress after <n> objects\")",
          "old_line_content": "\t\t\t     parse_opt_signed_tag_mode),",
          "new_line_content": "\t\t\t    N_(\"show progress after <n> objects\")),",
          "content_same": false
        },
        {
          "line": 677,
          "old_api": null,
          "new_api": "N_",
          "old_text": null,
          "new_text": "N_(\"Use the done feature to terminate the stream\")",
          "old_line_content": "\t};",
          "new_line_content": "\t\t\t     N_(\"Use the done feature to terminate the stream\")),",
          "content_same": false
        },
        {
          "line": 678,
          "old_api": null,
          "new_api": "N_",
          "old_text": null,
          "new_text": "N_(\"Skip output of blob data\")",
          "old_line_content": "",
          "new_line_content": "\t\tOPT_BOOL(0, \"no-data\", &no_data, N_(\"Skip output of blob data\")),",
          "content_same": false
        },
        {
          "line": 679,
          "old_api": null,
          "new_api": "OPT_END",
          "old_text": null,
          "new_text": "OPT_END()",
          "old_line_content": "\tif (argc == 1)",
          "new_line_content": "\t\tOPT_END()",
          "content_same": false
        },
        {
          "line": 686,
          "old_api": null,
          "new_api": "git_config",
          "old_text": null,
          "new_text": "git_config(git_default_config, NULL)",
          "old_line_content": "\trevs.topo_order = 1;",
          "new_line_content": "\tgit_config(git_default_config, NULL);",
          "content_same": false
        },
        {
          "line": 688,
          "old_api": null,
          "new_api": "init_revisions",
          "old_text": null,
          "new_text": "init_revisions(&revs, prefix)",
          "old_line_content": "\trevs.rewrite_parents = 1;",
          "new_line_content": "\tinit_revisions(&revs, prefix);",
          "content_same": false
        },
        {
          "line": 693,
          "old_api": null,
          "new_api": "parse_options",
          "old_text": null,
          "new_text": "parse_options(argc, argv, prefix, options, fast_export_usage, 0)",
          "old_line_content": "",
          "new_line_content": "\targc = parse_options(argc, argv, prefix, options, fast_export_usage, 0);",
          "content_same": false
        },
        {
          "line": 701,
          "old_api": null,
          "new_api": "import_marks",
          "old_text": null,
          "new_text": "import_marks(import_filename)",
          "old_line_content": "\tif (import_filename && revs.prune_data.nr)",
          "new_line_content": "\t\timport_marks(import_filename);",
          "content_same": false
        },
        {
          "line": 713,
          "old_api": null,
          "new_api": "get_revision",
          "old_text": null,
          "new_text": "get_revision(&revs)",
          "old_line_content": "\t\t}",
          "new_line_content": "\twhile ((commit = get_revision(&revs))) {",
          "content_same": false
        },
        {
          "line": 714,
          "old_api": null,
          "new_api": "has_unshown_parent",
          "old_text": null,
          "new_text": "has_unshown_parent(commit)",
          "old_line_content": "\t\telse {",
          "new_line_content": "\t\tif (has_unshown_parent(commit)) {",
          "content_same": false
        },
        {
          "line": 718,
          "old_api": null,
          "new_api": "handle_commit",
          "old_text": null,
          "new_text": "handle_commit(commit, &revs)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\thandle_commit(commit, &revs);",
          "content_same": false
        },
        {
          "line": 719,
          "old_api": null,
          "new_api": "handle_tail",
          "old_text": null,
          "new_text": "handle_tail(&commits, &revs)",
          "old_line_content": "",
          "new_line_content": "\t\t\thandle_tail(&commits, &revs);",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": null,
          "new_api": "printf",
          "old_text": null,
          "new_text": "printf(\"done\\n\")",
          "old_line_content": "}",
          "new_line_content": "\t\tprintf(\"done\\n\");",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(line, '\\n')",
          "old_line_content": "\t\tif (line[0] != ':' || !line_end)",
          "new_line_content": "\t\tline_end = strchr(line, '\\n');",
          "content_same": false
        },
        {
          "line": 620,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"corrupt mark line: %s\", line)",
          "old_line_content": "\t\t*line_end = '\\0';",
          "new_line_content": "\t\t\tdie(\"corrupt mark line: %s\", line);",
          "content_same": false
        },
        {
          "line": 623,
          "old_api": null,
          "new_api": "strtoumax",
          "old_text": null,
          "new_text": "strtoumax(line + 1, &mark_end, 10)",
          "old_line_content": "\t\tif (!mark || mark_end == line + 1",
          "new_line_content": "\t\tmark = strtoumax(line + 1, &mark_end, 10);",
          "content_same": false
        },
        {
          "line": 626,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"corrupt mark line: %s\", line)",
          "old_line_content": "",
          "new_line_content": "\t\t\tdie(\"corrupt mark line: %s\", line);",
          "content_same": false
        },
        {
          "line": 631,
          "old_api": null,
          "new_api": "sha1_object_info",
          "old_text": null,
          "new_text": "sha1_object_info(sha1, NULL)",
          "old_line_content": "\t\tif (!object)",
          "new_line_content": "\t\ttype = sha1_object_info(sha1, NULL);",
          "content_same": false
        },
        {
          "line": 633,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(sha1)",
          "old_line_content": "",
          "new_line_content": "\t\t\tdie(\"object not found: %s\", sha1_to_hex(sha1));",
          "content_same": false
        },
        {
          "line": 639,
          "old_api": null,
          "new_api": "parse_object",
          "old_text": null,
          "new_text": "parse_object(sha1)",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\tobject = parse_object(sha1);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 641,
          "old_api": "mark_object",
          "new_api": null,
          "old_text": "mark_object(object, mark)",
          "new_text": null,
          "old_line_content": "\t\tmark_object(object, mark);",
          "new_line_content": "\t\tif (object->flags & SHOWN)",
          "content_same": false
        },
        {
          "line": 645,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(f)",
          "new_text": null,
          "old_line_content": "\tfclose(f);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 657,
          "old_api": "OPT_INTEGER",
          "new_api": null,
          "old_text": "OPT_INTEGER(0, \"progress\", &progress,\n\t\t\t    N_(\"show progress after <n> objects\"))",
          "new_text": null,
          "old_line_content": "\t\tOPT_INTEGER(0, \"progress\", &progress,",
          "new_line_content": "\tchar *export_filename = NULL, *import_filename = NULL;",
          "content_same": false
        },
        {
          "line": 658,
          "old_api": "N_",
          "new_api": null,
          "old_text": "N_(\"show progress after <n> objects\")",
          "new_text": null,
          "old_line_content": "\t\t\t    N_(\"show progress after <n> objects\")),",
          "new_line_content": "\tuint32_t lastimportid;",
          "content_same": false
        },
        {
          "line": 659,
          "old_api": "N_",
          "new_api": null,
          "old_text": "N_(\"mode\")",
          "new_text": null,
          "old_line_content": "\t\tOPT_CALLBACK(0, \"signed-tags\", &signed_tag_mode, N_(\"mode\"),",
          "new_line_content": "\tstruct option options[] = {",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": "N_",
          "new_api": null,
          "old_text": "N_(\"file\")",
          "new_text": null,
          "old_line_content": "\t\tOPT_STRING(0, \"import-marks\", &import_filename, N_(\"file\"),",
          "new_line_content": "\t\t\t     parse_opt_tag_of_filtered_mode),",
          "content_same": false
        },
        {
          "line": 680,
          "old_api": "usage_with_options (fast_export_usage, options)",
          "new_api": null,
          "old_text": "usage_with_options (fast_export_usage, options)",
          "new_text": null,
          "old_line_content": "\t\tusage_with_options (fast_export_usage, options);",
          "new_line_content": "\t};",
          "content_same": false
        },
        {
          "line": 685,
          "old_api": "init_revisions",
          "new_api": null,
          "old_text": "init_revisions(&revs, prefix)",
          "new_text": null,
          "old_line_content": "\tinit_revisions(&revs, prefix);",
          "new_line_content": "\t/* we handle encodings */",
          "content_same": false
        },
        {
          "line": 689,
          "old_api": "setup_revisions",
          "new_api": null,
          "old_text": "setup_revisions(argc, argv, &revs, NULL)",
          "new_text": null,
          "old_line_content": "\targc = setup_revisions(argc, argv, &revs, NULL);",
          "new_line_content": "\trevs.topo_order = 1;",
          "content_same": false
        },
        {
          "line": 690,
          "old_api": "parse_options",
          "new_api": null,
          "old_text": "parse_options(argc, argv, prefix, options, fast_export_usage, 0)",
          "new_text": null,
          "old_line_content": "\targc = parse_options(argc, argv, prefix, options, fast_export_usage, 0);",
          "new_line_content": "\trevs.show_source = 1;",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": "get_tags_and_duplicates",
          "new_api": null,
          "old_text": "get_tags_and_duplicates(&revs.cmdline, &extra_refs)",
          "new_text": null,
          "old_line_content": "\tget_tags_and_duplicates(&revs.cmdline, &extra_refs);",
          "new_line_content": "\tif (import_filename && revs.prune_data.nr)",
          "content_same": false
        },
        {
          "line": 706,
          "old_api": "prepare_revision_walk",
          "new_api": null,
          "old_text": "prepare_revision_walk(&revs)",
          "new_text": null,
          "old_line_content": "\tif (prepare_revision_walk(&revs))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": "has_unshown_parent",
          "new_api": null,
          "old_text": "has_unshown_parent(commit)",
          "new_text": null,
          "old_line_content": "\t\tif (has_unshown_parent(commit)) {",
          "new_line_content": "\trevs.diffopt.format_callback = show_filemodify;",
          "content_same": false
        },
        {
          "line": 716,
          "old_api": "handle_tail",
          "new_api": null,
          "old_text": "handle_tail(&commits, &revs)",
          "new_text": null,
          "old_line_content": "\t\t\thandle_tail(&commits, &revs);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 720,
          "old_api": "handle_tags_and_duplicates",
          "new_api": null,
          "old_text": "handle_tags_and_duplicates(&extra_refs)",
          "new_text": null,
          "old_line_content": "\thandle_tags_and_duplicates(&extra_refs);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(line, '\\n')",
          "new_text": null,
          "old_line_content": "\t\tline_end = strchr(line, '\\n');",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 619,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"corrupt mark line: %s\", line)",
          "new_text": null,
          "old_line_content": "\t\t\tdie(\"corrupt mark line: %s\", line);",
          "new_line_content": "\t\tif (line[0] != ':' || !line_end)",
          "content_same": false
        },
        {
          "line": 622,
          "old_api": "strtoumax",
          "new_api": null,
          "old_text": "strtoumax(line + 1, &mark_end, 10)",
          "new_text": null,
          "old_line_content": "\t\tmark = strtoumax(line + 1, &mark_end, 10);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 624,
          "old_api": "get_sha1",
          "new_api": null,
          "old_text": "get_sha1(mark_end + 1, sha1)",
          "new_text": null,
          "old_line_content": "\t\t\t|| *mark_end != ' ' || get_sha1(mark_end + 1, sha1))",
          "new_line_content": "\t\tif (!mark || mark_end == line + 1",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": "parse_object",
          "new_api": null,
          "old_text": "parse_object(sha1)",
          "new_text": null,
          "old_line_content": "\t\tobject = parse_object(sha1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 635,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(sha1)",
          "new_text": null,
          "old_line_content": "\t\t\terror(\"Object %s already has a mark\", sha1_to_hex(sha1));",
          "new_line_content": "\t\tif (type != OBJ_COMMIT)",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 19,
      "total_additions": 23,
      "total_deletions": 21,
      "total_api_changes": 63
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 12,
        "api_related_lines": 63,
        "non_api_lines": 7,
        "non_api_line_numbers": [
          640,
          616,
          632,
          634,
          636,
          637,
          638
        ]
      }
    },
    "api_calls_before": 211,
    "api_calls_after": 214,
    "diff_info": {
      "added_lines": 9,
      "removed_lines": 6,
      "total_diff_lines": 39
    }
  }
}