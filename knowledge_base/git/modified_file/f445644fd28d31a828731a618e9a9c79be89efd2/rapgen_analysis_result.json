{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/f445644fd28d31a828731a618e9a9c79be89efd2",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/f445644fd28d31a828731a618e9a9c79be89efd2/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/f445644fd28d31a828731a618e9a9c79be89efd2/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/f445644fd28d31a828731a618e9a9c79be89efd2/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 39,
          "old_api": "strbuf_detach",
          "new_api": "strbuf_addf",
          "old_text": "strbuf_detach(&arg0, NULL)",
          "new_text": "strbuf_addf(&arg0, \"%s \\\"$@\\\"\", argv[0])",
          "old_line_content": "\t\tnargv[nargc++] = strbuf_detach(&arg0, NULL);",
          "new_line_content": "\t\t\tstrbuf_addf(&arg0, \"%s \\\"$@\\\"\", argv[0]);",
          "content_same": false
        },
        {
          "line": 54,
          "old_api": "execvp",
          "new_api": "prepare_shell_cmd",
          "old_text": "execvp(nargv[0], (char **)nargv)",
          "new_text": "prepare_shell_cmd(argv)",
          "old_line_content": "\texecvp(nargv[0], (char **)nargv);",
          "new_line_content": "\tconst char **nargv = prepare_shell_cmd(argv);",
          "content_same": false
        },
        {
          "line": 55,
          "old_api": "free",
          "new_api": "trace_argv_printf",
          "old_text": "free(nargv)",
          "new_text": "trace_argv_printf(nargv, \"trace: exec:\")",
          "old_line_content": "\tfree(nargv);",
          "new_line_content": "\ttrace_argv_printf(nargv, \"trace: exec:\");",
          "content_same": false
        },
        {
          "line": 91,
          "old_api": "close",
          "new_api": "close_pair",
          "old_text": "close(cmd->in)",
          "new_text": "close_pair(fdin)",
          "old_line_content": "\t\t\t\tclose(cmd->in);",
          "new_line_content": "\t\t\t\tclose_pair(fdin);",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": "close",
          "new_api": "close_pair",
          "old_text": "close(cmd->in)",
          "new_text": "close_pair(fdin)",
          "old_line_content": "\t\t\t\tclose(cmd->in);",
          "new_line_content": "\t\t\t\tclose_pair(fdin);",
          "content_same": false
        },
        {
          "line": 106,
          "old_api": "close_pair",
          "new_api": "close",
          "old_text": "close_pair(fdout)",
          "new_text": "close(cmd->in)",
          "old_line_content": "\t\t\t\tclose_pair(fdout);",
          "new_line_content": "\t\t\t\tclose(cmd->in);",
          "content_same": false
        },
        {
          "line": 108,
          "old_api": "close",
          "new_api": "close_pair",
          "old_text": "close(cmd->out)",
          "new_text": "close_pair(fdout)",
          "old_line_content": "\t\t\t\tclose(cmd->out);",
          "new_line_content": "\t\t\t\tclose_pair(fdout);",
          "content_same": false
        },
        {
          "line": 110,
          "old_api": "error",
          "new_api": "close",
          "old_text": "error(\"cannot create pipe for %s: %s\",\n\t\t\t\tcmd->argv[0], strerror(failed_errno))",
          "new_text": "close(cmd->out)",
          "old_line_content": "\t\t\terror(\"cannot create pipe for %s: %s\",",
          "new_line_content": "\t\t\t\tclose(cmd->out);",
          "content_same": false
        },
        {
          "line": 127,
          "old_api": "dup2",
          "new_api": "dup_devnull",
          "old_text": "dup2(fdin[0], 0)",
          "new_text": "dup_devnull(0)",
          "old_line_content": "\t\t\tdup2(fdin[0], 0);",
          "new_line_content": "\t\t\tdup_devnull(0);",
          "content_same": false
        },
        {
          "line": 130,
          "old_api": "dup2",
          "new_api": "close_pair",
          "old_text": "dup2(cmd->in, 0)",
          "new_text": "close_pair(fdin)",
          "old_line_content": "\t\t\tdup2(cmd->in, 0);",
          "new_line_content": "\t\t\tclose_pair(fdin);",
          "content_same": false
        },
        {
          "line": 137,
          "old_api": "dup2",
          "new_api": "dup_devnull",
          "old_text": "dup2(fderr[1], 2)",
          "new_text": "dup_devnull(2)",
          "old_line_content": "\t\t\tdup2(fderr[1], 2);",
          "new_line_content": "\t\t\tdup_devnull(2);",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": "dup2",
          "new_api": "dup_devnull",
          "old_text": "dup2(2, 1)",
          "new_text": "dup_devnull(1)",
          "old_line_content": "\t\t\tdup2(2, 1);",
          "new_line_content": "\t\t\tdup_devnull(1);",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": "dup2",
          "new_api": "close_pair",
          "old_text": "dup2(cmd->out, 1)",
          "new_text": "close_pair(fdout)",
          "old_line_content": "\t\t\tdup2(cmd->out, 1);",
          "new_line_content": "\t\t\tclose_pair(fdout);",
          "content_same": false
        },
        {
          "line": 161,
          "old_api": "unsetenv",
          "new_api": "putenv",
          "old_text": "unsetenv(*cmd->env)",
          "new_text": "putenv((char *)*cmd->env)",
          "old_line_content": "\t\t\t\t\tunsetenv(*cmd->env);",
          "new_line_content": "\t\t\t\t\tputenv((char *)*cmd->env);",
          "content_same": false
        },
        {
          "line": 167,
          "old_api": "execv_git_cmd",
          "new_api": "preexec_cb",
          "old_text": "execv_git_cmd(cmd->argv)",
          "new_text": "cmd->preexec_cb()",
          "old_line_content": "\t\t\texecv_git_cmd(cmd->argv);",
          "new_line_content": "\t\t\tcmd->preexec_cb();",
          "content_same": false
        },
        {
          "line": 169,
          "old_api": "execv_shell_cmd",
          "new_api": "execv_git_cmd",
          "old_text": "execv_shell_cmd(cmd->argv)",
          "new_text": "execv_git_cmd(cmd->argv)",
          "old_line_content": "\t\t\texecv_shell_cmd(cmd->argv);",
          "new_line_content": "\t\t\texecv_git_cmd(cmd->argv);",
          "content_same": false
        },
        {
          "line": 171,
          "old_api": "execvp",
          "new_api": "execv_shell_cmd",
          "old_text": "execvp(cmd->argv[0], (char *const*) cmd->argv)",
          "new_text": "execv_shell_cmd(cmd->argv)",
          "old_line_content": "\t\t\texecvp(cmd->argv[0], (char *const*) cmd->argv);",
          "new_line_content": "\t\t\texecv_shell_cmd(cmd->argv);",
          "content_same": false
        },
        {
          "line": 173,
          "old_api": "trace_printf",
          "new_api": "execvp",
          "old_text": "trace_printf(\"trace: exec '%s' failed: %s\\n\", cmd->argv[0],\n\t\t\t\tstrerror(errno))",
          "new_text": "execvp(cmd->argv[0], (char *const*) cmd->argv)",
          "old_line_content": "\t\ttrace_printf(\"trace: exec '%s' failed: %s\\n\", cmd->argv[0],",
          "new_line_content": "\t\t\texecvp(cmd->argv[0], (char *const*) cmd->argv);",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": "exit",
          "new_api": "trace_printf",
          "old_text": "exit(127)",
          "new_text": "trace_printf(\"trace: exec '%s' failed: %s\\n\", cmd->argv[0],\n\t\t\t\tstrerror(errno))",
          "old_line_content": "\t\texit(127);",
          "new_line_content": "\t\ttrace_printf(\"trace: exec '%s' failed: %s\\n\", cmd->argv[0],",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": "dup",
          "new_api": "dup_devnull",
          "old_text": "dup(0)",
          "new_text": "dup_devnull(0)",
          "old_line_content": "\t\ts0 = dup(0);",
          "new_line_content": "\t\tdup_devnull(0);",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": "dup",
          "new_api": "dup2",
          "old_text": "dup(0)",
          "new_text": "dup2(fdin[0], 0)",
          "old_line_content": "\t\ts0 = dup(0);",
          "new_line_content": "\t\tdup2(fdin[0], 0);",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "dup",
          "new_api": "dup_devnull",
          "old_text": "dup(2)",
          "new_text": "dup_devnull(2)",
          "old_line_content": "\t\ts2 = dup(2);",
          "new_line_content": "\t\tdup_devnull(2);",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": "dup",
          "new_api": "dup_devnull",
          "old_text": "dup(1)",
          "new_text": "dup_devnull(1)",
          "old_line_content": "\t\ts1 = dup(1);",
          "new_line_content": "\t\tdup_devnull(1);",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "dup",
          "new_api": "dup2",
          "old_text": "dup(1)",
          "new_text": "dup2(2, 1)",
          "old_line_content": "\t\ts1 = dup(1);",
          "new_line_content": "\t\tdup2(2, 1);",
          "content_same": false
        },
        {
          "line": 215,
          "old_api": "dup",
          "new_api": "dup2",
          "old_text": "dup(1)",
          "new_text": "dup2(fdout[1], 1)",
          "old_line_content": "\t\ts1 = dup(1);",
          "new_line_content": "\t\tdup2(fdout[1], 1);",
          "content_same": false
        },
        {
          "line": 222,
          "old_api": "make_augmented_environ",
          "new_api": "die",
          "old_text": "make_augmented_environ(cmd->env)",
          "new_text": "die(\"chdir in start_command() not implemented\")",
          "old_line_content": "\t\tenv = make_augmented_environ(cmd->env);",
          "new_line_content": "\t\tdie(\"chdir in start_command() not implemented\");",
          "content_same": false
        },
        {
          "line": 227,
          "old_api": "prepare_shell_cmd",
          "new_api": "prepare_git_cmd",
          "old_text": "prepare_shell_cmd(cmd->argv)",
          "new_text": "prepare_git_cmd(cmd->argv)",
          "old_line_content": "\t\tcmd->argv = prepare_shell_cmd(cmd->argv);",
          "new_line_content": "\t\tcmd->argv = prepare_git_cmd(cmd->argv);",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": "free",
          "new_api": "free_environ",
          "old_text": "free(cmd->argv)",
          "new_text": "free_environ(env)",
          "old_line_content": "\t\tfree(cmd->argv);",
          "new_line_content": "\t\tfree_environ(env);",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": "close",
          "new_api": "close_pair",
          "old_text": "close(cmd->in)",
          "new_text": "close_pair(fdin)",
          "old_line_content": "\t\t\tclose(cmd->in);",
          "new_line_content": "\t\t\tclose_pair(fdin);",
          "content_same": false
        },
        {
          "line": 256,
          "old_api": "close_pair",
          "new_api": "close",
          "old_text": "close_pair(fdout)",
          "new_text": "close(cmd->in)",
          "old_line_content": "\t\t\tclose_pair(fdout);",
          "new_line_content": "\t\t\tclose(cmd->in);",
          "content_same": false
        },
        {
          "line": 258,
          "old_api": "close",
          "new_api": "close_pair",
          "old_text": "close(cmd->out)",
          "new_text": "close_pair(fdout)",
          "old_line_content": "\t\t\tclose(cmd->out);",
          "new_line_content": "\t\t\tclose_pair(fdout);",
          "content_same": false
        },
        {
          "line": 260,
          "old_api": "close_pair",
          "new_api": "close",
          "old_text": "close_pair(fderr)",
          "new_text": "close(cmd->out)",
          "old_line_content": "\t\t\tclose_pair(fderr);",
          "new_line_content": "\t\t\tclose(cmd->out);",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": "error",
          "new_api": "strerror",
          "old_text": "error(\"waitpid is confused (%s)\", argv0)",
          "new_text": "strerror(errno)",
          "old_line_content": "\t\terror(\"waitpid is confused (%s)\", argv0);",
          "new_line_content": "\t\terror(\"waitpid for %s failed: %s\", argv0, strerror(errno));",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": "WTERMSIG",
          "new_api": "error",
          "old_text": "WTERMSIG(status)",
          "new_text": "error(\"waitpid is confused (%s)\", argv0)",
          "old_line_content": "\t\tcode = WTERMSIG(status);",
          "new_line_content": "\t\terror(\"waitpid is confused (%s)\", argv0);",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": "error",
          "new_api": "WIFSIGNALED",
          "old_text": "error(\"%s died of signal %d\", argv0, code)",
          "new_text": "WIFSIGNALED(status)",
          "old_line_content": "\t\terror(\"%s died of signal %d\", argv0, code);",
          "new_line_content": "\t} else if (WIFSIGNALED(status)) {",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": "fork",
          "new_api": "fflush",
          "old_text": "fork()",
          "new_text": "fflush(NULL)",
          "old_line_content": "\tasync->pid = fork();",
          "new_line_content": "\tfflush(NULL);",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": "strerror",
          "new_api": "fork",
          "old_text": "strerror(errno)",
          "new_text": "fork()",
          "old_line_content": "\t\terror(\"fork (async) failed: %s\", strerror(errno));",
          "new_line_content": "\tasync->pid = fork();",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": "close",
          "new_api": "proc",
          "old_text": "close(pipe_out[1])",
          "new_text": "async->proc(pipe_out[1], async->data)",
          "old_line_content": "\tclose(pipe_out[1]);",
          "new_line_content": "\t\texit(!!async->proc(pipe_out[1], async->data));",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": "strerror",
          "new_api": "_beginthreadex",
          "old_text": "strerror(errno)",
          "new_text": "_beginthreadex(NULL, 0, run_thread, async, 0, NULL)",
          "old_line_content": "\t\terror(\"cannot create thread: %s\", strerror(errno));",
          "new_line_content": "\tasync->tid = (HANDLE) _beginthreadex(NULL, 0, run_thread, async, 0, NULL);",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": "GetExitCodeThread",
          "new_api": "WaitForSingleObject",
          "old_text": "GetExitCodeThread(async->tid, &ret)",
          "new_text": "WaitForSingleObject(async->tid, INFINITE)",
          "old_line_content": "\telse if (!GetExitCodeThread(async->tid, &ret))",
          "new_line_content": "\tif (WaitForSingleObject(async->tid, INFINITE) != WAIT_OBJECT_0)",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": "CloseHandle",
          "new_api": "GetExitCodeThread",
          "old_text": "CloseHandle(async->tid)",
          "new_text": "GetExitCodeThread(async->tid, &ret)",
          "old_line_content": "\tCloseHandle(async->tid);",
          "new_line_content": "\telse if (!GetExitCodeThread(async->tid, &ret))",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "git_path",
          "new_api": "va_start",
          "old_text": "git_path(\"hooks/%s\", name)",
          "new_text": "va_start(args, name)",
          "old_line_content": "\targv[i++] = git_path(\"hooks/%s\", name);",
          "new_line_content": "\tva_start(args, name);",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": "ALLOC_GROW",
          "new_api": "git_path",
          "old_text": "ALLOC_GROW(argv, i + 1, alloc)",
          "new_text": "git_path(\"hooks/%s\", name)",
          "old_line_content": "\t\tALLOC_GROW(argv, i + 1, alloc);",
          "new_line_content": "\targv[i++] = git_path(\"hooks/%s\", name);",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": "va_end",
          "new_api": "va_arg",
          "old_text": "va_end(args)",
          "new_text": "va_arg(args, const char *)",
          "old_line_content": "\tva_end(args);",
          "new_line_content": "\t\targv[i++] = va_arg(args, const char *);",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": "memset",
          "new_api": "va_end",
          "old_text": "memset(&hook, 0, sizeof(hook))",
          "new_text": "va_end(args)",
          "old_line_content": "\tmemset(&hook, 0, sizeof(hook));",
          "new_line_content": "\tva_end(args);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 31,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(argv[0])",
          "old_line_content": "\tnargv[nargc++] = \"sh\";",
          "new_line_content": "\tif (strcspn(argv[0], \"|&;<>()$`\\\\\\\"' \\t\\n*?[#~=%\") != strlen(argv[0])) {",
          "content_same": false
        },
        {
          "line": 40,
          "old_api": null,
          "new_api": "strbuf_detach",
          "old_text": null,
          "new_text": "strbuf_detach(&arg0, NULL)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tnargv[nargc++] = strbuf_detach(&arg0, NULL);",
          "content_same": false
        },
        {
          "line": 56,
          "old_api": null,
          "new_api": "execvp",
          "old_text": null,
          "new_text": "execvp(nargv[0], (char **)nargv)",
          "old_line_content": "\treturn -1;",
          "new_line_content": "\texecvp(nargv[0], (char **)nargv);",
          "content_same": false
        },
        {
          "line": 57,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(nargv)",
          "old_line_content": "}",
          "new_line_content": "\tfree(nargv);",
          "content_same": false
        },
        {
          "line": 75,
          "old_api": null,
          "new_api": "pipe",
          "old_text": null,
          "new_text": "pipe(fdin)",
          "old_line_content": "\t\t\tif (cmd->out > 0)",
          "new_line_content": "\t\tif (pipe(fdin) < 0) {",
          "content_same": false
        },
        {
          "line": 78,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(cmd->out)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\tclose(cmd->out);",
          "content_same": false
        },
        {
          "line": 88,
          "old_api": null,
          "new_api": "pipe",
          "old_text": null,
          "new_text": "pipe(fdout)",
          "old_line_content": "\t\t\tif (need_in)",
          "new_line_content": "\t\tif (pipe(fdout) < 0) {",
          "content_same": false
        },
        {
          "line": 93,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(cmd->in)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\tclose(cmd->in);",
          "content_same": false
        },
        {
          "line": 101,
          "old_api": null,
          "new_api": "pipe",
          "old_text": null,
          "new_text": "pipe(fderr)",
          "old_line_content": "\t\t\tif (need_in)",
          "new_line_content": "\t\tif (pipe(fderr) < 0) {",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"cannot create pipe for %s: %s\",\n\t\t\t\tcmd->argv[0], strerror(failed_errno))",
          "old_line_content": "\t\t\terrno = failed_errno;",
          "new_line_content": "\t\t\terror(\"cannot create pipe for %s: %s\",",
          "content_same": false
        },
        {
          "line": 113,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(failed_errno)",
          "old_line_content": "\t\t\treturn -1;",
          "new_line_content": "\t\t\t\tcmd->argv[0], strerror(failed_errno));",
          "content_same": false
        },
        {
          "line": 120,
          "old_api": null,
          "new_api": "trace_argv_printf",
          "old_text": null,
          "new_text": "trace_argv_printf(cmd->argv, \"trace: run_command:\")",
          "old_line_content": "#ifndef WIN32",
          "new_line_content": "\ttrace_argv_printf(cmd->argv, \"trace: run_command:\");",
          "content_same": false
        },
        {
          "line": 123,
          "old_api": null,
          "new_api": "fflush",
          "old_text": null,
          "new_text": "fflush(NULL)",
          "old_line_content": "\tif (!cmd->pid) {",
          "new_line_content": "\tfflush(NULL);",
          "content_same": false
        },
        {
          "line": 124,
          "old_api": null,
          "new_api": "fork",
          "old_text": null,
          "new_text": "fork()",
          "old_line_content": "\t\tif (cmd->no_stdin)",
          "new_line_content": "\tcmd->pid = fork();",
          "content_same": false
        },
        {
          "line": 129,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(fdin[0], 0)",
          "old_line_content": "\t\t} else if (cmd->in) {",
          "new_line_content": "\t\t\tdup2(fdin[0], 0);",
          "content_same": false
        },
        {
          "line": 132,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(cmd->in, 0)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tdup2(cmd->in, 0);",
          "content_same": false
        },
        {
          "line": 133,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(cmd->in)",
          "old_line_content": "",
          "new_line_content": "\t\t\tclose(cmd->in);",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(fderr[1], 2)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tdup2(fderr[1], 2);",
          "content_same": false
        },
        {
          "line": 140,
          "old_api": null,
          "new_api": "close_pair",
          "old_text": null,
          "new_text": "close_pair(fderr)",
          "old_line_content": "",
          "new_line_content": "\t\t\tclose_pair(fderr);",
          "content_same": false
        },
        {
          "line": 148,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(fdout[1], 1)",
          "old_line_content": "\t\t} else if (cmd->out > 1) {",
          "new_line_content": "\t\t\tdup2(fdout[1], 1);",
          "content_same": false
        },
        {
          "line": 151,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(cmd->out, 1)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tdup2(cmd->out, 1);",
          "content_same": false
        },
        {
          "line": 152,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(cmd->out)",
          "old_line_content": "",
          "new_line_content": "\t\t\tclose(cmd->out);",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": null,
          "new_api": "chdir",
          "old_text": null,
          "new_text": "chdir(cmd->dir)",
          "old_line_content": "\t\t\t    cmd->dir);",
          "new_line_content": "\t\tif (cmd->dir && chdir(cmd->dir))",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": null,
          "new_api": "die_errno",
          "old_text": null,
          "new_text": "die_errno(\"exec '%s': cd to '%s' failed\", cmd->argv[0],\n\t\t\t    cmd->dir)",
          "old_line_content": "\t\tif (cmd->env) {",
          "new_line_content": "\t\t\tdie_errno(\"exec '%s': cd to '%s' failed\", cmd->argv[0],",
          "content_same": false
        },
        {
          "line": 160,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(*cmd->env, '=')",
          "old_line_content": "\t\t\t\telse",
          "new_line_content": "\t\t\t\tif (strchr(*cmd->env, '='))",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": null,
          "new_api": "unsetenv",
          "old_text": null,
          "new_text": "unsetenv(*cmd->env)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\t\tunsetenv(*cmd->env);",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\t\tstrerror(errno));",
          "content_same": false
        },
        {
          "line": 177,
          "old_api": null,
          "new_api": "exit",
          "old_text": null,
          "new_text": "exit(127)",
          "old_line_content": "\tif (cmd->pid < 0)",
          "new_line_content": "\t\texit(127);",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"cannot fork() for %s: %s\", cmd->argv[0],\n\t\t\tstrerror(failed_errno = errno))",
          "old_line_content": "#else",
          "new_line_content": "\t\terror(\"cannot fork() for %s: %s\", cmd->argv[0],",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(failed_errno = errno)",
          "old_line_content": "{",
          "new_line_content": "\t\t\tstrerror(failed_errno = errno));",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": null,
          "new_api": "dup",
          "old_text": null,
          "new_text": "dup(0)",
          "old_line_content": "\t} else if (need_in) {",
          "new_line_content": "\t\ts0 = dup(0);",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": null,
          "new_api": "dup",
          "old_text": null,
          "new_text": "dup(0)",
          "old_line_content": "\t} else if (cmd->in) {",
          "new_line_content": "\t\ts0 = dup(0);",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": null,
          "new_api": "dup",
          "old_text": null,
          "new_text": "dup(0)",
          "old_line_content": "\t}",
          "new_line_content": "\t\ts0 = dup(0);",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(cmd->in, 0)",
          "old_line_content": "",
          "new_line_content": "\t\tdup2(cmd->in, 0);",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": null,
          "new_api": "dup",
          "old_text": null,
          "new_text": "dup(2)",
          "old_line_content": "\t} else if (need_err) {",
          "new_line_content": "\t\ts2 = dup(2);",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": null,
          "new_api": "dup",
          "old_text": null,
          "new_text": "dup(2)",
          "old_line_content": "\t}",
          "new_line_content": "\t\ts2 = dup(2);",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(fderr[1], 2)",
          "old_line_content": "",
          "new_line_content": "\t\tdup2(fderr[1], 2);",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": null,
          "new_api": "dup",
          "old_text": null,
          "new_text": "dup(1)",
          "old_line_content": "\t} else if (cmd->stdout_to_stderr) {",
          "new_line_content": "\t\ts1 = dup(1);",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": null,
          "new_api": "dup",
          "old_text": null,
          "new_text": "dup(1)",
          "old_line_content": "\t} else if (need_out) {",
          "new_line_content": "\t\ts1 = dup(1);",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": null,
          "new_api": "dup",
          "old_text": null,
          "new_text": "dup(1)",
          "old_line_content": "\t} else if (cmd->out > 1) {",
          "new_line_content": "\t\ts1 = dup(1);",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": null,
          "new_api": "dup",
          "old_text": null,
          "new_text": "dup(1)",
          "old_line_content": "\t}",
          "new_line_content": "\t\ts1 = dup(1);",
          "content_same": false
        },
        {
          "line": 218,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(cmd->out, 1)",
          "old_line_content": "",
          "new_line_content": "\t\tdup2(cmd->out, 1);",
          "content_same": false
        },
        {
          "line": 224,
          "old_api": null,
          "new_api": "make_augmented_environ",
          "old_text": null,
          "new_text": "make_augmented_environ(cmd->env)",
          "old_line_content": "\tif (cmd->git_cmd) {",
          "new_line_content": "\t\tenv = make_augmented_environ(cmd->env);",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": null,
          "new_api": "prepare_shell_cmd",
          "old_text": null,
          "new_text": "prepare_shell_cmd(cmd->argv)",
          "old_line_content": "",
          "new_line_content": "\t\tcmd->argv = prepare_shell_cmd(cmd->argv);",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": null,
          "new_api": "mingw_spawnvpe",
          "old_text": null,
          "new_text": "mingw_spawnvpe(cmd->argv[0], cmd->argv, env)",
          "old_line_content": "\tif (cmd->pid < 0 && (!cmd->silent_exec_failure || errno != ENOENT))",
          "new_line_content": "\tcmd->pid = mingw_spawnvpe(cmd->argv[0], cmd->argv, env);",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "\tif (cmd->env)",
          "new_line_content": "\t\terror(\"cannot spawn %s: %s\", cmd->argv[0], strerror(errno));",
          "content_same": false
        },
        {
          "line": 240,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(cmd->argv)",
          "old_line_content": "\tcmd->argv = sargv;",
          "new_line_content": "\t\tfree(cmd->argv);",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(s2)",
          "old_line_content": "#endif",
          "new_line_content": "\t\tdup2(s2, 2), close(s2);",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": null,
          "new_api": "close_pair",
          "old_text": null,
          "new_text": "close_pair(fderr)",
          "old_line_content": "\t\treturn -1;",
          "new_line_content": "\t\t\tclose_pair(fderr);",
          "content_same": false
        },
        {
          "line": 270,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(cmd->in)",
          "old_line_content": "\tif (need_out)",
          "new_line_content": "\t\tclose(cmd->in);",
          "content_same": false
        },
        {
          "line": 275,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(cmd->out)",
          "old_line_content": "\tif (need_err)",
          "new_line_content": "\t\tclose(cmd->out);",
          "content_same": false
        },
        {
          "line": 278,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fderr[1])",
          "old_line_content": "\treturn 0;",
          "new_line_content": "\t\tclose(fderr[1]);",
          "content_same": false
        },
        {
          "line": 289,
          "old_api": null,
          "new_api": "waitpid",
          "old_text": null,
          "new_text": "waitpid(pid, &status, 0)",
          "old_line_content": "",
          "new_line_content": "\twhile ((waiting = waitpid(pid, &status, 0)) < 0 && errno == EINTR)",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": null,
          "new_api": "WTERMSIG",
          "old_text": null,
          "new_text": "WTERMSIG(status)",
          "old_line_content": "\t\t/*",
          "new_line_content": "\t\tcode = WTERMSIG(status);",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"%s died of signal %d\", argv0, code)",
          "old_line_content": "\t\t * This return value is chosen so that code & 0xff",
          "new_line_content": "\t\terror(\"%s died of signal %d\", argv0, code);",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": null,
          "new_api": "WIFEXITED",
          "old_text": null,
          "new_text": "WIFEXITED(status)",
          "old_line_content": "\t\t/*",
          "new_line_content": "\t} else if (WIFEXITED(status)) {",
          "content_same": false
        },
        {
          "line": 307,
          "old_api": null,
          "new_api": "WEXITSTATUS",
          "old_text": null,
          "new_text": "WEXITSTATUS(status)",
          "old_line_content": "\t\t * Convert special exit code when execvp failed.",
          "new_line_content": "\t\tcode = WEXITSTATUS(status);",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"cannot run %s: %s\", argv0,\n\t\t\t\t\tstrerror(ENOENT))",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\terror(\"cannot run %s: %s\", argv0,",
          "content_same": false
        },
        {
          "line": 316,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(ENOENT)",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\t\t\t\tstrerror(ENOENT));",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"waitpid is confused (%s)\", argv0)",
          "old_line_content": "\terrno = failed_errno;",
          "new_line_content": "\t\terror(\"waitpid is confused (%s)\", argv0);",
          "content_same": false
        },
        {
          "line": 327,
          "old_api": null,
          "new_api": "wait_or_whine",
          "old_text": null,
          "new_text": "wait_or_whine(cmd->pid, cmd->argv[0], cmd->silent_exec_failure)",
          "old_line_content": "",
          "new_line_content": "\treturn wait_or_whine(cmd->pid, cmd->argv[0], cmd->silent_exec_failure);",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": null,
          "new_api": "start_command",
          "old_text": null,
          "new_text": "start_command(cmd)",
          "old_line_content": "\t\treturn code;",
          "new_line_content": "\tint code = start_command(cmd);",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": null,
          "new_api": "finish_command",
          "old_text": null,
          "new_text": "finish_command(cmd)",
          "old_line_content": "",
          "new_line_content": "\treturn finish_command(cmd);",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(cmd, 0, sizeof(*cmd))",
          "old_line_content": "\tcmd->no_stdin = opt & RUN_COMMAND_NO_STDIN ? 1 : 0;",
          "new_line_content": "\tmemset(cmd, 0, sizeof(*cmd));",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": null,
          "new_api": "prepare_run_command_v_opt",
          "old_text": null,
          "new_text": "prepare_run_command_v_opt(&cmd, argv, opt)",
          "old_line_content": "}",
          "new_line_content": "\tprepare_run_command_v_opt(&cmd, argv, opt);",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": null,
          "new_api": "run_command",
          "old_text": null,
          "new_text": "run_command(&cmd)",
          "old_line_content": "",
          "new_line_content": "\treturn run_command(&cmd);",
          "content_same": false
        },
        {
          "line": 361,
          "old_api": null,
          "new_api": "prepare_run_command_v_opt",
          "old_text": null,
          "new_text": "prepare_run_command_v_opt(&cmd, argv, opt)",
          "old_line_content": "\tcmd.env = env;",
          "new_line_content": "\tprepare_run_command_v_opt(&cmd, argv, opt);",
          "content_same": false
        },
        {
          "line": 364,
          "old_api": null,
          "new_api": "run_command",
          "old_text": null,
          "new_text": "run_command(&cmd)",
          "old_line_content": "",
          "new_line_content": "\treturn run_command(&cmd);",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": null,
          "new_api": "proc",
          "old_text": null,
          "new_text": "async->proc(async->fd_for_proc, async->data)",
          "old_line_content": "#endif",
          "new_line_content": "\treturn async->proc(async->fd_for_proc, async->data);",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": null,
          "new_api": "pipe",
          "old_text": null,
          "new_text": "pipe(pipe_out)",
          "old_line_content": "\tasync->out = pipe_out[0];",
          "new_line_content": "\tif (pipe(pipe_out) < 0)",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "",
          "new_line_content": "\t\treturn error(\"cannot create pipe: %s\", strerror(errno));",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "\t\treturn -1;",
          "new_line_content": "\t\terror(\"fork (async) failed: %s\", strerror(errno));",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": null,
          "new_api": "close_pair",
          "old_text": null,
          "new_text": "close_pair(pipe_out)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tclose_pair(pipe_out);",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(pipe_out[0])",
          "old_line_content": "\t}",
          "new_line_content": "\t\tclose(pipe_out[0]);",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(pipe_out[1])",
          "old_line_content": "\tasync->fd_for_proc = pipe_out[1];",
          "new_line_content": "\tclose(pipe_out[1]);",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "\t\treturn -1;",
          "new_line_content": "\t\terror(\"cannot create thread: %s\", strerror(errno));",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": null,
          "new_api": "close_pair",
          "old_text": null,
          "new_text": "close_pair(pipe_out)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tclose_pair(pipe_out);",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": null,
          "new_api": "wait_or_whine",
          "old_text": null,
          "new_text": "wait_or_whine(async->pid, \"child process\", 0)",
          "old_line_content": "\tDWORD ret = 0;",
          "new_line_content": "\tint ret = wait_or_whine(async->pid, \"child process\", 0);",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": null,
          "new_api": "GetLastError",
          "old_text": null,
          "new_text": "GetLastError()",
          "old_line_content": "#endif",
          "new_line_content": "\t\tret = error(\"cannot get thread exit code: %lu\", GetLastError());",
          "content_same": false
        },
        {
          "line": 420,
          "old_api": null,
          "new_api": "CloseHandle",
          "old_text": null,
          "new_text": "CloseHandle(async->tid)",
          "old_line_content": "\treturn ret;",
          "new_line_content": "\tCloseHandle(async->tid);",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": null,
          "new_api": "git_path",
          "old_text": null,
          "new_text": "git_path(\"hooks/%s\", name)",
          "old_line_content": "",
          "new_line_content": "\tif (access(git_path(\"hooks/%s\", name), X_OK) < 0)",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": null,
          "new_api": "ALLOC_GROW",
          "old_text": null,
          "new_text": "ALLOC_GROW(argv, i + 1, alloc)",
          "old_line_content": "\twhile (argv[i-1]) {",
          "new_line_content": "\tALLOC_GROW(argv, i + 1, alloc);",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": null,
          "new_api": "ALLOC_GROW",
          "old_text": null,
          "new_text": "ALLOC_GROW(argv, i + 1, alloc)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tALLOC_GROW(argv, i + 1, alloc);",
          "content_same": false
        },
        {
          "line": 446,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(&hook, 0, sizeof(hook))",
          "old_line_content": "\thook.no_stdin = 1;",
          "new_line_content": "\tmemset(&hook, 0, sizeof(hook));",
          "content_same": false
        },
        {
          "line": 451,
          "old_api": null,
          "new_api": "snprintf",
          "old_text": null,
          "new_text": "snprintf(index, sizeof(index), \"GIT_INDEX_FILE=%s\", index_file)",
          "old_line_content": "\t\tenv[1] = NULL;",
          "new_line_content": "\t\tsnprintf(index, sizeof(index), \"GIT_INDEX_FILE=%s\", index_file);",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": null,
          "new_api": "run_command",
          "old_text": null,
          "new_text": "run_command(&hook)",
          "old_line_content": "\treturn ret;",
          "new_line_content": "\tret = run_command(&hook);",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(argv)",
          "old_line_content": "}",
          "new_line_content": "\tfree(argv);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 38,
          "old_api": "strbuf_addf",
          "new_api": null,
          "old_text": "strbuf_addf(&arg0, \"%s \\\"$@\\\"\", argv[0])",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_addf(&arg0, \"%s \\\"$@\\\"\", argv[0]);",
          "new_line_content": "\t\t\tstruct strbuf arg0 = STRBUF_INIT;",
          "content_same": false
        },
        {
          "line": 52,
          "old_api": "prepare_shell_cmd",
          "new_api": null,
          "old_text": "prepare_shell_cmd(argv)",
          "new_text": null,
          "old_line_content": "\tconst char **nargv = prepare_shell_cmd(argv);",
          "new_line_content": "static int execv_shell_cmd(const char **argv)",
          "content_same": false
        },
        {
          "line": 53,
          "old_api": "trace_argv_printf",
          "new_api": null,
          "old_text": "trace_argv_printf(nargv, \"trace: exec:\")",
          "new_text": null,
          "old_line_content": "\ttrace_argv_printf(nargv, \"trace: exec:\");",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 73,
          "old_api": "pipe",
          "new_api": null,
          "old_text": "pipe(fdin)",
          "new_text": null,
          "old_line_content": "\t\tif (pipe(fdin) < 0) {",
          "new_line_content": "\tneed_in = !cmd->no_stdin && cmd->in < 0;",
          "content_same": false
        },
        {
          "line": 76,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(cmd->out)",
          "new_text": null,
          "old_line_content": "\t\t\t\tclose(cmd->out);",
          "new_line_content": "\t\t\tfailed_errno = errno;",
          "content_same": false
        },
        {
          "line": 86,
          "old_api": "pipe",
          "new_api": null,
          "old_text": "pipe(fdout)",
          "new_text": null,
          "old_line_content": "\t\tif (pipe(fdout) < 0) {",
          "new_line_content": "\t\t&& cmd->out < 0;",
          "content_same": false
        },
        {
          "line": 89,
          "old_api": "close_pair",
          "new_api": null,
          "old_text": "close_pair(fdin)",
          "new_text": null,
          "old_line_content": "\t\t\t\tclose_pair(fdin);",
          "new_line_content": "\t\t\tfailed_errno = errno;",
          "content_same": false
        },
        {
          "line": 99,
          "old_api": "pipe",
          "new_api": null,
          "old_text": "pipe(fderr)",
          "new_text": null,
          "old_line_content": "\t\tif (pipe(fderr) < 0) {",
          "new_line_content": "\tneed_err = !cmd->no_stderr && cmd->err < 0;",
          "content_same": false
        },
        {
          "line": 102,
          "old_api": "close_pair",
          "new_api": null,
          "old_text": "close_pair(fdin)",
          "new_text": null,
          "old_line_content": "\t\t\t\tclose_pair(fdin);",
          "new_line_content": "\t\t\tfailed_errno = errno;",
          "content_same": false
        },
        {
          "line": 111,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(failed_errno)",
          "new_text": null,
          "old_line_content": "\t\t\t\tcmd->argv[0], strerror(failed_errno));",
          "new_line_content": "fail_pipe:",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": "trace_argv_printf",
          "new_api": null,
          "old_text": "trace_argv_printf(cmd->argv, \"trace: run_command:\")",
          "new_text": null,
          "old_line_content": "\ttrace_argv_printf(cmd->argv, \"trace: run_command:\");",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 121,
          "old_api": "fflush",
          "new_api": null,
          "old_text": "fflush(NULL)",
          "new_text": null,
          "old_line_content": "\tfflush(NULL);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 122,
          "old_api": "fork",
          "new_api": null,
          "old_text": "fork()",
          "new_text": null,
          "old_line_content": "\tcmd->pid = fork();",
          "new_line_content": "#ifndef WIN32",
          "content_same": false
        },
        {
          "line": 125,
          "old_api": "dup_devnull",
          "new_api": null,
          "old_text": "dup_devnull(0)",
          "new_text": null,
          "old_line_content": "\t\t\tdup_devnull(0);",
          "new_line_content": "\tif (!cmd->pid) {",
          "content_same": false
        },
        {
          "line": 128,
          "old_api": "close_pair",
          "new_api": null,
          "old_text": "close_pair(fdin)",
          "new_text": null,
          "old_line_content": "\t\t\tclose_pair(fdin);",
          "new_line_content": "\t\telse if (need_in) {",
          "content_same": false
        },
        {
          "line": 131,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(cmd->in)",
          "new_text": null,
          "old_line_content": "\t\t\tclose(cmd->in);",
          "new_line_content": "\t\t} else if (cmd->in) {",
          "content_same": false
        },
        {
          "line": 135,
          "old_api": "dup_devnull",
          "new_api": null,
          "old_text": "dup_devnull(2)",
          "new_text": null,
          "old_line_content": "\t\t\tdup_devnull(2);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 138,
          "old_api": "close_pair",
          "new_api": null,
          "old_text": "close_pair(fderr)",
          "new_text": null,
          "old_line_content": "\t\t\tclose_pair(fderr);",
          "new_line_content": "\t\telse if (need_err) {",
          "content_same": false
        },
        {
          "line": 142,
          "old_api": "dup_devnull",
          "new_api": null,
          "old_text": "dup_devnull(1)",
          "new_text": null,
          "old_line_content": "\t\t\tdup_devnull(1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "close_pair",
          "new_api": null,
          "old_text": "close_pair(fdout)",
          "new_text": null,
          "old_line_content": "\t\t\tclose_pair(fdout);",
          "new_line_content": "\t\telse if (need_out) {",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(cmd->out)",
          "new_text": null,
          "old_line_content": "\t\t\tclose(cmd->out);",
          "new_line_content": "\t\t} else if (cmd->out > 1) {",
          "content_same": false
        },
        {
          "line": 153,
          "old_api": "chdir",
          "new_api": null,
          "old_text": "chdir(cmd->dir)",
          "new_text": null,
          "old_line_content": "\t\tif (cmd->dir && chdir(cmd->dir))",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 154,
          "old_api": "die_errno",
          "new_api": null,
          "old_text": "die_errno(\"exec '%s': cd to '%s' failed\", cmd->argv[0],\n\t\t\t    cmd->dir)",
          "new_text": null,
          "old_line_content": "\t\t\tdie_errno(\"exec '%s': cd to '%s' failed\", cmd->argv[0],",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 158,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(*cmd->env, '=')",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (strchr(*cmd->env, '='))",
          "new_line_content": "\t\tif (cmd->env) {",
          "content_same": false
        },
        {
          "line": 159,
          "old_api": "putenv",
          "new_api": null,
          "old_text": "putenv((char *)*cmd->env)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tputenv((char *)*cmd->env);",
          "new_line_content": "\t\t\tfor (; *cmd->env; cmd->env++) {",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": "preexec_cb",
          "new_api": null,
          "old_text": "cmd->preexec_cb()",
          "new_text": null,
          "old_line_content": "\t\t\tcmd->preexec_cb();",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 174,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "\t\t\t\tstrerror(errno));",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"cannot fork() for %s: %s\", cmd->argv[0],\n\t\t\tstrerror(failed_errno = errno))",
          "new_text": null,
          "old_line_content": "\t\terror(\"cannot fork() for %s: %s\", cmd->argv[0],",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(failed_errno = errno)",
          "new_text": null,
          "old_line_content": "\t\t\tstrerror(failed_errno = errno));",
          "new_line_content": "\tif (cmd->pid < 0)",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": "dup",
          "new_api": null,
          "old_text": "dup(0)",
          "new_text": null,
          "old_line_content": "\t\ts0 = dup(0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "dup_devnull",
          "new_api": null,
          "old_text": "dup_devnull(0)",
          "new_text": null,
          "old_line_content": "\t\tdup_devnull(0);",
          "new_line_content": "\tif (cmd->no_stdin) {",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(fdin[0], 0)",
          "new_text": null,
          "old_line_content": "\t\tdup2(fdin[0], 0);",
          "new_line_content": "\t} else if (need_in) {",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(cmd->in, 0)",
          "new_text": null,
          "old_line_content": "\t\tdup2(cmd->in, 0);",
          "new_line_content": "\t} else if (cmd->in) {",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": "dup",
          "new_api": null,
          "old_text": "dup(2)",
          "new_text": null,
          "old_line_content": "\t\ts2 = dup(2);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": "dup_devnull",
          "new_api": null,
          "old_text": "dup_devnull(2)",
          "new_text": null,
          "old_line_content": "\t\tdup_devnull(2);",
          "new_line_content": "\tif (cmd->no_stderr) {",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(fderr[1], 2)",
          "new_text": null,
          "old_line_content": "\t\tdup2(fderr[1], 2);",
          "new_line_content": "\t} else if (need_err) {",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "dup",
          "new_api": null,
          "old_text": "dup(1)",
          "new_text": null,
          "old_line_content": "\t\ts1 = dup(1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": "dup_devnull",
          "new_api": null,
          "old_text": "dup_devnull(1)",
          "new_text": null,
          "old_line_content": "\t\tdup_devnull(1);",
          "new_line_content": "\tif (cmd->no_stdout) {",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(2, 1)",
          "new_text": null,
          "old_line_content": "\t\tdup2(2, 1);",
          "new_line_content": "\t} else if (cmd->stdout_to_stderr) {",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(fdout[1], 1)",
          "new_text": null,
          "old_line_content": "\t\tdup2(fdout[1], 1);",
          "new_line_content": "\t} else if (need_out) {",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(cmd->out, 1)",
          "new_text": null,
          "old_line_content": "\t\tdup2(cmd->out, 1);",
          "new_line_content": "\t} else if (cmd->out > 1) {",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"chdir in start_command() not implemented\")",
          "new_text": null,
          "old_line_content": "\t\tdie(\"chdir in start_command() not implemented\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "prepare_git_cmd",
          "new_api": null,
          "old_text": "prepare_git_cmd(cmd->argv)",
          "new_text": null,
          "old_line_content": "\t\tcmd->argv = prepare_git_cmd(cmd->argv);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": "mingw_spawnvpe",
          "new_api": null,
          "old_text": "mingw_spawnvpe(cmd->argv[0], cmd->argv, env)",
          "new_text": null,
          "old_line_content": "\tcmd->pid = mingw_spawnvpe(cmd->argv[0], cmd->argv, env);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "\t\terror(\"cannot spawn %s: %s\", cmd->argv[0], strerror(errno));",
          "new_line_content": "\tfailed_errno = errno;",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": "free_environ",
          "new_api": null,
          "old_text": "free_environ(env)",
          "new_text": null,
          "old_line_content": "\t\tfree_environ(env);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 242,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(s0)",
          "new_text": null,
          "old_line_content": "\t\tdup2(s0, 0), close(s0);",
          "new_line_content": "\tcmd->argv = sargv;",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": "close_pair",
          "new_api": null,
          "old_text": "close_pair(fdin)",
          "new_text": null,
          "old_line_content": "\t\t\tclose_pair(fdin);",
          "new_line_content": "\tif (cmd->pid < 0) {",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fdin[0])",
          "new_text": null,
          "old_line_content": "\t\tclose(fdin[0]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fdout[1])",
          "new_text": null,
          "old_line_content": "\t\tclose(fdout[1]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fderr[1])",
          "new_text": null,
          "old_line_content": "\t\tclose(fderr[1]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": "waitpid",
          "new_api": null,
          "old_text": "waitpid(pid, &status, 0)",
          "new_text": null,
          "old_line_content": "\twhile ((waiting = waitpid(pid, &status, 0)) < 0 && errno == EINTR)",
          "new_line_content": "\tint failed_errno = 0;",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "\t\terror(\"waitpid for %s failed: %s\", argv0, strerror(errno));",
          "new_line_content": "\tif (waiting < 0) {",
          "content_same": false
        },
        {
          "line": 295,
          "old_api": "WIFSIGNALED",
          "new_api": null,
          "old_text": "WIFSIGNALED(status)",
          "new_text": null,
          "old_line_content": "\t} else if (WIFSIGNALED(status)) {",
          "new_line_content": "\t} else if (waiting != pid) {",
          "content_same": false
        },
        {
          "line": 304,
          "old_api": "WIFEXITED",
          "new_api": null,
          "old_text": "WIFEXITED(status)",
          "new_text": null,
          "old_line_content": "\t} else if (WIFEXITED(status)) {",
          "new_line_content": "\t\t */",
          "content_same": false
        },
        {
          "line": 305,
          "old_api": "WEXITSTATUS",
          "new_api": null,
          "old_text": "WEXITSTATUS(status)",
          "new_text": null,
          "old_line_content": "\t\tcode = WEXITSTATUS(status);",
          "new_line_content": "\t\tcode -= 128;",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"cannot run %s: %s\", argv0,\n\t\t\t\t\tstrerror(ENOENT))",
          "new_text": null,
          "old_line_content": "\t\t\t\terror(\"cannot run %s: %s\", argv0,",
          "new_line_content": "\t\t\tfailed_errno = ENOENT;",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(ENOENT)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tstrerror(ENOENT));",
          "new_line_content": "\t\t\tif (!silent_exec_failure)",
          "content_same": false
        },
        {
          "line": 317,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"waitpid is confused (%s)\", argv0)",
          "new_text": null,
          "old_line_content": "\t\terror(\"waitpid is confused (%s)\", argv0);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 325,
          "old_api": "wait_or_whine",
          "new_api": null,
          "old_text": "wait_or_whine(cmd->pid, cmd->argv[0], cmd->silent_exec_failure)",
          "new_text": null,
          "old_line_content": "\treturn wait_or_whine(cmd->pid, cmd->argv[0], cmd->silent_exec_failure);",
          "new_line_content": "int finish_command(struct child_process *cmd)",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": "start_command",
          "new_api": null,
          "old_text": "start_command(cmd)",
          "new_text": null,
          "old_line_content": "\tint code = start_command(cmd);",
          "new_line_content": "int run_command(struct child_process *cmd)",
          "content_same": false
        },
        {
          "line": 333,
          "old_api": "finish_command",
          "new_api": null,
          "old_text": "finish_command(cmd)",
          "new_text": null,
          "old_line_content": "\treturn finish_command(cmd);",
          "new_line_content": "\tif (code)",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(cmd, 0, sizeof(*cmd))",
          "new_text": null,
          "old_line_content": "\tmemset(cmd, 0, sizeof(*cmd));",
          "new_line_content": "\t\t\t\t      int opt)",
          "content_same": false
        },
        {
          "line": 352,
          "old_api": "prepare_run_command_v_opt",
          "new_api": null,
          "old_text": "prepare_run_command_v_opt(&cmd, argv, opt)",
          "new_text": null,
          "old_line_content": "\tprepare_run_command_v_opt(&cmd, argv, opt);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 353,
          "old_api": "run_command",
          "new_api": null,
          "old_text": "run_command(&cmd)",
          "new_text": null,
          "old_line_content": "\treturn run_command(&cmd);",
          "new_line_content": "\tstruct child_process cmd;",
          "content_same": false
        },
        {
          "line": 359,
          "old_api": "prepare_run_command_v_opt",
          "new_api": null,
          "old_text": "prepare_run_command_v_opt(&cmd, argv, opt)",
          "new_text": null,
          "old_line_content": "\tprepare_run_command_v_opt(&cmd, argv, opt);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 362,
          "old_api": "run_command",
          "new_api": null,
          "old_text": "run_command(&cmd)",
          "new_text": null,
          "old_line_content": "\treturn run_command(&cmd);",
          "new_line_content": "\tcmd.dir = dir;",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": "proc",
          "new_api": null,
          "old_text": "async->proc(async->fd_for_proc, async->data)",
          "new_text": null,
          "old_line_content": "\treturn async->proc(async->fd_for_proc, async->data);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 377,
          "old_api": "pipe",
          "new_api": null,
          "old_text": "pipe(pipe_out)",
          "new_text": null,
          "old_line_content": "\tif (pipe(pipe_out) < 0)",
          "new_line_content": "\tint pipe_out[2];",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": "strerror",
          "new_api": null,
          "old_text": "strerror(errno)",
          "new_text": null,
          "old_line_content": "\t\treturn error(\"cannot create pipe: %s\", strerror(errno));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": "fflush",
          "new_api": null,
          "old_text": "fflush(NULL)",
          "new_text": null,
          "old_line_content": "\tfflush(NULL);",
          "new_line_content": "#ifndef WIN32",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "close_pair",
          "new_api": null,
          "old_text": "close_pair(pipe_out)",
          "new_text": null,
          "old_line_content": "\t\tclose_pair(pipe_out);",
          "new_line_content": "\tif (async->pid < 0) {",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(pipe_out[0])",
          "new_text": null,
          "old_line_content": "\t\tclose(pipe_out[0]);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": "proc",
          "new_api": null,
          "old_text": "async->proc(pipe_out[1], async->data)",
          "new_text": null,
          "old_line_content": "\t\texit(!!async->proc(pipe_out[1], async->data));",
          "new_line_content": "\tif (!async->pid) {",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": "_beginthreadex",
          "new_api": null,
          "old_text": "_beginthreadex(NULL, 0, run_thread, async, 0, NULL)",
          "new_text": null,
          "old_line_content": "\tasync->tid = (HANDLE) _beginthreadex(NULL, 0, run_thread, async, 0, NULL);",
          "new_line_content": "#else",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": "close_pair",
          "new_api": null,
          "old_text": "close_pair(pipe_out)",
          "new_text": null,
          "old_line_content": "\t\tclose_pair(pipe_out);",
          "new_line_content": "\tif (!async->tid) {",
          "content_same": false
        },
        {
          "line": 411,
          "old_api": "wait_or_whine",
          "new_api": null,
          "old_text": "wait_or_whine(async->pid, \"child process\", 0)",
          "new_text": null,
          "old_line_content": "\tint ret = wait_or_whine(async->pid, \"child process\", 0);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": "WaitForSingleObject",
          "new_api": null,
          "old_text": "WaitForSingleObject(async->tid, INFINITE)",
          "new_text": null,
          "old_line_content": "\tif (WaitForSingleObject(async->tid, INFINITE) != WAIT_OBJECT_0)",
          "new_line_content": "#else",
          "content_same": false
        },
        {
          "line": 415,
          "old_api": "GetLastError",
          "new_api": null,
          "old_text": "GetLastError()",
          "new_text": null,
          "old_line_content": "\t\tret = error(\"waiting for thread failed: %lu\", GetLastError());",
          "new_line_content": "\tDWORD ret = 0;",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": "git_path",
          "new_api": null,
          "old_text": "git_path(\"hooks/%s\", name)",
          "new_text": null,
          "old_line_content": "\tif (access(git_path(\"hooks/%s\", name), X_OK) < 0)",
          "new_line_content": "\tsize_t i = 0, alloc = 0;",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": "va_start",
          "new_api": null,
          "old_text": "va_start(args, name)",
          "new_text": null,
          "old_line_content": "\tva_start(args, name);",
          "new_line_content": "\t\treturn 0;",
          "content_same": false
        },
        {
          "line": 436,
          "old_api": "ALLOC_GROW",
          "new_api": null,
          "old_text": "ALLOC_GROW(argv, i + 1, alloc)",
          "new_text": null,
          "old_line_content": "\tALLOC_GROW(argv, i + 1, alloc);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": "va_arg",
          "new_api": null,
          "old_text": "va_arg(args, const char *)",
          "new_text": null,
          "old_line_content": "\t\targv[i++] = va_arg(args, const char *);",
          "new_line_content": "\twhile (argv[i-1]) {",
          "content_same": false
        },
        {
          "line": 449,
          "old_api": "snprintf",
          "new_api": null,
          "old_text": "snprintf(index, sizeof(index), \"GIT_INDEX_FILE=%s\", index_file)",
          "new_text": null,
          "old_line_content": "\t\tsnprintf(index, sizeof(index), \"GIT_INDEX_FILE=%s\", index_file);",
          "new_line_content": "\thook.stdout_to_stderr = 1;",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": "run_command",
          "new_api": null,
          "old_text": "run_command(&hook)",
          "new_text": null,
          "old_line_content": "\tret = run_command(&hook);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(argv)",
          "new_text": null,
          "old_line_content": "\tfree(argv);",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 45,
      "total_additions": 87,
      "total_deletions": 86,
      "total_api_changes": 218
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 11,
        "api_related_lines": 218,
        "non_api_lines": 7,
        "non_api_line_numbers": [
          32,
          33,
          34,
          35,
          36,
          37,
          41
        ]
      }
    },
    "api_calls_before": 156,
    "api_calls_after": 158,
    "diff_info": {
      "added_lines": 11,
      "removed_lines": 9,
      "total_diff_lines": 32
    }
  }
}