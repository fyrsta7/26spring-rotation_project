{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/59b8d38f6e4f19b93c5dc4493ab11706acd101b5",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/59b8d38f6e4f19b93c5dc4493ab11706acd101b5/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/59b8d38f6e4f19b93c5dc4493ab11706acd101b5/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/59b8d38f6e4f19b93c5dc4493ab11706acd101b5/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 878,
          "old_api": "error",
          "new_api": "fprintf",
          "old_text": "error(\"Unable to verify pack %s is available\",\n\t\t\t    hex)",
          "new_text": "fprintf(stderr, \"Getting index for pack %s\\n\", hex)",
          "old_line_content": "\t\tret = error(\"Unable to verify pack %s is available\",",
          "new_line_content": "\t\tfprintf(stderr, \"Getting index for pack %s\\n\", hex);",
          "content_same": false
        },
        {
          "line": 889,
          "old_api": "fprintf",
          "new_api": "free",
          "old_text": "fprintf(stderr, \"Getting index for pack %s\\n\", hex)",
          "new_text": "free(hex)",
          "old_line_content": "\t\tfprintf(stderr, \"Getting index for pack %s\\n\", hex);",
          "new_line_content": "\tfree(hex);",
          "content_same": false
        },
        {
          "line": 932,
          "old_api": "http_get_strbuf",
          "new_api": "prefixcmp",
          "old_text": "http_get_strbuf(url, &buf, HTTP_NO_CACHE)",
          "new_text": "prefixcmp(data + i + 46, \".pack\\n\")",
          "old_line_content": "\tret = http_get_strbuf(url, &buf, HTTP_NO_CACHE);",
          "new_line_content": "\t\t\t    !prefixcmp(data + i + 46, \".pack\\n\")) {",
          "content_same": false
        },
        {
          "line": 974,
          "old_api": "free",
          "new_api": "fclose",
          "old_text": "free(preq->url)",
          "new_text": "fclose(preq->packfile)",
          "old_line_content": "\tfree(preq->url);",
          "new_line_content": "\t\tfclose(preq->packfile);",
          "content_same": false
        },
        {
          "line": 990,
          "old_api": "move_temp_to_file",
          "new_api": "install_packed_git",
          "old_text": "move_temp_to_file(preq->tmpfile, preq->filename)",
          "new_text": "install_packed_git(preq->target)",
          "old_line_content": "\tret = move_temp_to_file(preq->tmpfile, preq->filename);",
          "new_line_content": "\tinstall_packed_git(preq->target);",
          "content_same": false
        },
        {
          "line": 1016,
          "old_api": "xmalloc",
          "new_api": "snprintf",
          "old_text": "xmalloc(sizeof(*preq))",
          "new_text": "snprintf(preq->filename, sizeof(preq->filename), \"%s\", filename)",
          "old_line_content": "\tpreq = xmalloc(sizeof(*preq));",
          "new_line_content": "\tsnprintf(preq->filename, sizeof(preq->filename), \"%s\", filename);",
          "content_same": false
        },
        {
          "line": 1020,
          "old_api": "end_url_with_slash",
          "new_api": "error",
          "old_text": "end_url_with_slash(&buf, base_url)",
          "new_text": "error(\"Unable to open local file %s for pack\",\n\t\t      preq->tmpfile)",
          "old_line_content": "\tend_url_with_slash(&buf, base_url);",
          "new_line_content": "\t\terror(\"Unable to open local file %s for pack\",",
          "content_same": false
        },
        {
          "line": 1027,
          "old_api": "snprintf",
          "new_api": "curl_easy_setopt",
          "old_text": "snprintf(preq->filename, sizeof(preq->filename), \"%s\", filename)",
          "new_text": "curl_easy_setopt(preq->slot->curl, CURLOPT_FILE, preq->packfile)",
          "old_line_content": "\tsnprintf(preq->filename, sizeof(preq->filename), \"%s\", filename);",
          "new_line_content": "\tcurl_easy_setopt(preq->slot->curl, CURLOPT_FILE, preq->packfile);",
          "content_same": false
        },
        {
          "line": 1028,
          "old_api": "snprintf",
          "new_api": "curl_easy_setopt",
          "old_text": "snprintf(preq->tmpfile, sizeof(preq->tmpfile), \"%s.temp\", filename)",
          "new_text": "curl_easy_setopt(preq->slot->curl, CURLOPT_WRITEFUNCTION, fwrite)",
          "old_line_content": "\tsnprintf(preq->tmpfile, sizeof(preq->tmpfile), \"%s.temp\", filename);",
          "new_line_content": "\tcurl_easy_setopt(preq->slot->curl, CURLOPT_WRITEFUNCTION, fwrite);",
          "content_same": false
        },
        {
          "line": 1029,
          "old_api": "fopen",
          "new_api": "curl_easy_setopt",
          "old_text": "fopen(preq->tmpfile, \"a\")",
          "new_text": "curl_easy_setopt(preq->slot->curl, CURLOPT_URL, url)",
          "old_line_content": "\tpreq->packfile = fopen(preq->tmpfile, \"a\");",
          "new_line_content": "\tcurl_easy_setopt(preq->slot->curl, CURLOPT_URL, url);",
          "content_same": false
        },
        {
          "line": 1040,
          "old_api": "curl_easy_setopt",
          "new_api": "fprintf",
          "old_text": "curl_easy_setopt(preq->slot->curl, CURLOPT_URL, url)",
          "new_text": "fprintf(stderr,\n\t\t\t\t\"Resuming fetch of pack %s at byte %ld\\n\",\n\t\t\t\tsha1_to_hex(target->sha1), prev_posn)",
          "old_line_content": "\tcurl_easy_setopt(preq->slot->curl, CURLOPT_URL, url);",
          "new_line_content": "\t\t\tfprintf(stderr,",
          "content_same": false
        },
        {
          "line": 1089,
          "old_api": "git_inflate",
          "new_api": "sha1_to_hex",
          "old_text": "git_inflate(&freq->stream, Z_SYNC_FLUSH)",
          "new_text": "sha1_to_hex(sha1)",
          "old_line_content": "\t\tfreq->zret = git_inflate(&freq->stream, Z_SYNC_FLUSH);",
          "new_line_content": "\tchar *hex = sha1_to_hex(sha1);",
          "content_same": false
        },
        {
          "line": 1112,
          "old_api": "xmalloc",
          "new_api": "rename",
          "old_text": "xmalloc(sizeof(*freq))",
          "new_text": "rename(freq->tmpfile, prevfile)",
          "old_line_content": "\tfreq = xmalloc(sizeof(*freq));",
          "new_line_content": "\trename(freq->tmpfile, prevfile);",
          "content_same": false
        },
        {
          "line": 1113,
          "old_api": "hashcpy",
          "new_api": "unlink_or_warn",
          "old_text": "hashcpy(freq->sha1, sha1)",
          "new_text": "unlink_or_warn(freq->tmpfile)",
          "old_line_content": "\thashcpy(freq->sha1, sha1);",
          "new_line_content": "\tunlink_or_warn(freq->tmpfile);",
          "content_same": false
        },
        {
          "line": 1116,
          "old_api": "sha1_file_name",
          "new_api": "error",
          "old_text": "sha1_file_name(sha1)",
          "new_text": "error(\"fd leakage in start: %d\", freq->localfile)",
          "old_line_content": "\tfilename = sha1_file_name(sha1);",
          "new_line_content": "\t\terror(\"fd leakage in start: %d\", freq->localfile);",
          "content_same": false
        },
        {
          "line": 1117,
          "old_api": "snprintf",
          "new_api": "open",
          "old_text": "snprintf(freq->filename, sizeof(freq->filename), \"%s\", filename)",
          "new_text": "open(freq->tmpfile,\n\t\t\t       O_WRONLY | O_CREAT | O_EXCL, 0666)",
          "old_line_content": "\tsnprintf(freq->filename, sizeof(freq->filename), \"%s\", filename);",
          "new_line_content": "\tfreq->localfile = open(freq->tmpfile,",
          "content_same": false
        },
        {
          "line": 1124,
          "old_api": "unlink_or_warn",
          "new_api": "strrchr",
          "old_text": "unlink_or_warn(freq->tmpfile)",
          "new_text": "strrchr(freq->tmpfile, '/')",
          "old_line_content": "\tunlink_or_warn(freq->tmpfile);",
          "new_line_content": "\t\tchar *dir = strrchr(freq->tmpfile, '/');",
          "content_same": false
        },
        {
          "line": 1127,
          "old_api": "error",
          "new_api": "mkdir",
          "old_text": "error(\"fd leakage in start: %d\", freq->localfile)",
          "new_text": "mkdir(freq->tmpfile, 0777)",
          "old_line_content": "\t\terror(\"fd leakage in start: %d\", freq->localfile);",
          "new_line_content": "\t\t\tmkdir(freq->tmpfile, 0777);",
          "content_same": false
        },
        {
          "line": 1135,
          "old_api": "strrchr",
          "new_api": "error",
          "old_text": "strrchr(freq->tmpfile, '/')",
          "new_text": "error(\"Couldn't create temporary file %s for %s: %s\",\n\t\t      freq->tmpfile, freq->filename, strerror(errno))",
          "old_line_content": "\t\tchar *dir = strrchr(freq->tmpfile, '/');",
          "new_line_content": "\t\terror(\"Couldn't create temporary file %s for %s: %s\",",
          "content_same": false
        },
        {
          "line": 1146,
          "old_api": "error",
          "new_api": "get_remote_object_url",
          "old_text": "error(\"Couldn't create temporary file %s for %s: %s\",\n\t\t      freq->tmpfile, freq->filename, strerror(errno))",
          "new_text": "get_remote_object_url(base_url, hex, 0)",
          "old_line_content": "\t\terror(\"Couldn't create temporary file %s for %s: %s\",",
          "new_line_content": "\turl = get_remote_object_url(base_url, hex, 0);",
          "content_same": false
        },
        {
          "line": 1147,
          "old_api": "strerror",
          "new_api": "xstrdup",
          "old_text": "strerror(errno)",
          "new_text": "xstrdup(url)",
          "old_line_content": "\t\t      freq->tmpfile, freq->filename, strerror(errno));",
          "new_line_content": "\tfreq->url = xstrdup(url);",
          "content_same": false
        },
        {
          "line": 1153,
          "old_api": "git_inflate_init",
          "new_api": "open",
          "old_text": "git_inflate_init(&freq->stream)",
          "new_text": "open(prevfile, O_RDONLY)",
          "old_line_content": "\tgit_inflate_init(&freq->stream);",
          "new_line_content": "\tprevlocal = open(prevfile, O_RDONLY);",
          "content_same": false
        },
        {
          "line": 1158,
          "old_api": "xstrdup",
          "new_api": "fwrite_sha1_file",
          "old_text": "xstrdup(url)",
          "new_text": "fwrite_sha1_file(prev_buf,\n\t\t\t\t\t\t     1,\n\t\t\t\t\t\t     prev_read,\n\t\t\t\t\t\t     freq)",
          "old_line_content": "\tfreq->url = xstrdup(url);",
          "new_line_content": "\t\t\t\tif (fwrite_sha1_file(prev_buf,",
          "content_same": false
        },
        {
          "line": 1179,
          "old_api": "close",
          "new_api": "git_SHA1_Init",
          "old_text": "close(prevlocal)",
          "new_text": "git_SHA1_Init(&freq->c)",
          "old_line_content": "\t\tclose(prevlocal);",
          "new_line_content": "\t\tgit_SHA1_Init(&freq->c);",
          "content_same": false
        },
        {
          "line": 1189,
          "old_api": "git_inflate_init",
          "new_api": "curl_easy_setopt",
          "old_text": "git_inflate_init(&freq->stream)",
          "new_text": "curl_easy_setopt(freq->slot->curl, CURLOPT_FILE, freq)",
          "old_line_content": "\t\tgit_inflate_init(&freq->stream);",
          "new_line_content": "\tcurl_easy_setopt(freq->slot->curl, CURLOPT_FILE, freq);",
          "content_same": false
        },
        {
          "line": 1190,
          "old_api": "git_SHA1_Init",
          "new_api": "curl_easy_setopt",
          "old_text": "git_SHA1_Init(&freq->c)",
          "new_text": "curl_easy_setopt(freq->slot->curl, CURLOPT_WRITEFUNCTION, fwrite_sha1_file)",
          "old_line_content": "\t\tgit_SHA1_Init(&freq->c);",
          "new_line_content": "\tcurl_easy_setopt(freq->slot->curl, CURLOPT_WRITEFUNCTION, fwrite_sha1_file);",
          "content_same": false
        },
        {
          "line": 1193,
          "old_api": "lseek",
          "new_api": "curl_easy_setopt",
          "old_text": "lseek(freq->localfile, 0, SEEK_SET)",
          "new_text": "curl_easy_setopt(freq->slot->curl, CURLOPT_HTTPHEADER, no_pragma_header)",
          "old_line_content": "\t\t\tlseek(freq->localfile, 0, SEEK_SET);",
          "new_line_content": "\tcurl_easy_setopt(freq->slot->curl, CURLOPT_HTTPHEADER, no_pragma_header);",
          "content_same": false
        },
        {
          "line": 1201,
          "old_api": "curl_easy_setopt",
          "new_api": "fprintf",
          "old_text": "curl_easy_setopt(freq->slot->curl, CURLOPT_WRITEFUNCTION, fwrite_sha1_file)",
          "new_text": "fprintf(stderr,\n\t\t\t\t\"Resuming fetch of object %s at byte %ld\\n\",\n\t\t\t\thex, prev_posn)",
          "old_line_content": "\tcurl_easy_setopt(freq->slot->curl, CURLOPT_WRITEFUNCTION, fwrite_sha1_file);",
          "new_line_content": "\t\t\tfprintf(stderr,",
          "content_same": false
        },
        {
          "line": 1204,
          "old_api": "curl_easy_setopt",
          "new_api": "sprintf",
          "old_text": "curl_easy_setopt(freq->slot->curl, CURLOPT_HTTPHEADER, no_pragma_header)",
          "new_text": "sprintf(range, \"Range: bytes=%ld-\", prev_posn)",
          "old_line_content": "\tcurl_easy_setopt(freq->slot->curl, CURLOPT_HTTPHEADER, no_pragma_header);",
          "new_line_content": "\t\tsprintf(range, \"Range: bytes=%ld-\", prev_posn);",
          "content_same": false
        },
        {
          "line": 1212,
          "old_api": "fprintf",
          "new_api": "free",
          "old_text": "fprintf(stderr,\n\t\t\t\t\"Resuming fetch of object %s at byte %ld\\n\",\n\t\t\t\thex, prev_posn)",
          "new_text": "free(url)",
          "old_line_content": "\t\t\tfprintf(stderr,",
          "new_line_content": "\tfree(url);",
          "content_same": false
        },
        {
          "line": 1215,
          "old_api": "sprintf",
          "new_api": "free",
          "old_text": "sprintf(range, \"Range: bytes=%ld-\", prev_posn)",
          "new_text": "free(freq)",
          "old_line_content": "\t\tsprintf(range, \"Range: bytes=%ld-\", prev_posn);",
          "new_line_content": "\tfree(freq);",
          "content_same": false
        },
        {
          "line": 1246,
          "old_api": "process_http_object_request",
          "new_api": "git_inflate_end",
          "old_text": "process_http_object_request(freq)",
          "new_text": "git_inflate_end(&freq->stream)",
          "old_line_content": "\tprocess_http_object_request(freq);",
          "new_line_content": "\tgit_inflate_end(&freq->stream);",
          "content_same": false
        },
        {
          "line": 1249,
          "old_api": "fprintf",
          "new_api": "unlink_or_warn",
          "old_text": "fprintf(stderr, \"Warning: requested range invalid; we may already have all the data.\\n\")",
          "new_text": "unlink_or_warn(freq->tmpfile)",
          "old_line_content": "\t\tfprintf(stderr, \"Warning: requested range invalid; we may already have all the data.\\n\");",
          "new_line_content": "\t\tunlink_or_warn(freq->tmpfile);",
          "content_same": false
        },
        {
          "line": 1257,
          "old_api": "git_inflate_end",
          "new_api": "move_temp_to_file",
          "old_text": "git_inflate_end(&freq->stream)",
          "new_text": "move_temp_to_file(freq->tmpfile, freq->filename)",
          "old_line_content": "\tgit_inflate_end(&freq->stream);",
          "new_line_content": "\t\tmove_temp_to_file(freq->tmpfile, freq->filename);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1025,
          "old_api": null,
          "new_api": "get_active_slot",
          "old_text": null,
          "new_text": "get_active_slot()",
          "old_line_content": "",
          "new_line_content": "\tpreq->slot = get_active_slot();",
          "content_same": false
        },
        {
          "line": 1030,
          "old_api": null,
          "new_api": "curl_easy_setopt",
          "old_text": null,
          "new_text": "curl_easy_setopt(preq->slot->curl, CURLOPT_HTTPHEADER,\n\t\tno_pragma_header)",
          "old_line_content": "\tif (!preq->packfile) {",
          "new_line_content": "\tcurl_easy_setopt(preq->slot->curl, CURLOPT_HTTPHEADER,",
          "content_same": false
        },
        {
          "line": 1037,
          "old_api": null,
          "new_api": "ftell",
          "old_text": null,
          "new_text": "ftell(preq->packfile)",
          "old_line_content": "\tpreq->slot->local = preq->packfile;",
          "new_line_content": "\tprev_posn = ftell(preq->packfile);",
          "content_same": false
        },
        {
          "line": 1042,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(target->sha1)",
          "old_line_content": "\t\tno_pragma_header);",
          "new_line_content": "\t\t\t\tsha1_to_hex(target->sha1), prev_posn);",
          "content_same": false
        },
        {
          "line": 1043,
          "old_api": null,
          "new_api": "sprintf",
          "old_text": null,
          "new_text": "sprintf(range, \"Range: bytes=%ld-\", prev_posn)",
          "old_line_content": "",
          "new_line_content": "\t\tsprintf(range, \"Range: bytes=%ld-\", prev_posn);",
          "content_same": false
        },
        {
          "line": 1044,
          "old_api": null,
          "new_api": "curl_slist_append",
          "old_text": null,
          "new_text": "curl_slist_append(NULL, range)",
          "old_line_content": "\t/*",
          "new_line_content": "\t\tpreq->range_header = curl_slist_append(NULL, range);",
          "content_same": false
        },
        {
          "line": 1045,
          "old_api": null,
          "new_api": "curl_easy_setopt",
          "old_text": null,
          "new_text": "curl_easy_setopt(preq->slot->curl, CURLOPT_HTTPHEADER,\n\t\t\tpreq->range_header)",
          "old_line_content": "\t * If there is data present from a previous transfer attempt,",
          "new_line_content": "\t\tcurl_easy_setopt(preq->slot->curl, CURLOPT_HTTPHEADER,",
          "content_same": false
        },
        {
          "line": 1052,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(filename)",
          "old_line_content": "\t\t\t\t\"Resuming fetch of pack %s at byte %ld\\n\",",
          "new_line_content": "\tfree(filename);",
          "content_same": false
        },
        {
          "line": 1066,
          "old_api": null,
          "new_api": "xwrite",
          "old_text": null,
          "new_text": "xwrite(freq->localfile,\n\t\t\t\t\t(char *) ptr + posn, size - posn)",
          "old_line_content": "",
          "new_line_content": "\t\tssize_t retval = xwrite(freq->localfile,",
          "content_same": false
        },
        {
          "line": 1078,
          "old_api": null,
          "new_api": "git_inflate",
          "old_text": null,
          "new_text": "git_inflate(&freq->stream, Z_SYNC_FLUSH)",
          "old_line_content": "\t\t\t\t\t(char *) ptr + posn, size - posn);",
          "new_line_content": "\t\tfreq->zret = git_inflate(&freq->stream, Z_SYNC_FLUSH);",
          "content_same": false
        },
        {
          "line": 1079,
          "old_api": null,
          "new_api": "git_SHA1_Update",
          "old_text": null,
          "new_text": "git_SHA1_Update(&freq->c, expn,\n\t\t\t\tsizeof(expn) - freq->stream.avail_out)",
          "old_line_content": "\t\tif (retval < 0)",
          "new_line_content": "\t\tgit_SHA1_Update(&freq->c, expn,",
          "content_same": false
        },
        {
          "line": 1101,
          "old_api": null,
          "new_api": "xmalloc",
          "old_text": null,
          "new_text": "xmalloc(sizeof(*freq))",
          "old_line_content": "\tchar *filename;",
          "new_line_content": "\tfreq = xmalloc(sizeof(*freq));",
          "content_same": false
        },
        {
          "line": 1102,
          "old_api": null,
          "new_api": "hashcpy",
          "old_text": null,
          "new_text": "hashcpy(freq->sha1, sha1)",
          "old_line_content": "\tchar prevfile[PATH_MAX];",
          "new_line_content": "\thashcpy(freq->sha1, sha1);",
          "content_same": false
        },
        {
          "line": 1105,
          "old_api": null,
          "new_api": "sha1_file_name",
          "old_text": null,
          "new_text": "sha1_file_name(sha1)",
          "old_line_content": "\tunsigned char prev_buf[PREV_BUF_SIZE];",
          "new_line_content": "\tfilename = sha1_file_name(sha1);",
          "content_same": false
        },
        {
          "line": 1106,
          "old_api": null,
          "new_api": "snprintf",
          "old_text": null,
          "new_text": "snprintf(freq->filename, sizeof(freq->filename), \"%s\", filename)",
          "old_line_content": "\tssize_t prev_read = 0;",
          "new_line_content": "\tsnprintf(freq->filename, sizeof(freq->filename), \"%s\", filename);",
          "content_same": false
        },
        {
          "line": 1107,
          "old_api": null,
          "new_api": "snprintf",
          "old_text": null,
          "new_text": "snprintf(freq->tmpfile, sizeof(freq->tmpfile),\n\t\t \"%s.temp\", filename)",
          "old_line_content": "\tlong prev_posn = 0;",
          "new_line_content": "\tsnprintf(freq->tmpfile, sizeof(freq->tmpfile),",
          "content_same": false
        },
        {
          "line": 1110,
          "old_api": null,
          "new_api": "snprintf",
          "old_text": null,
          "new_text": "snprintf(prevfile, sizeof(prevfile), \"%s.prev\", filename)",
          "old_line_content": "\tstruct http_object_request *freq;",
          "new_line_content": "\tsnprintf(prevfile, sizeof(prevfile), \"%s.prev\", filename);",
          "content_same": false
        },
        {
          "line": 1111,
          "old_api": null,
          "new_api": "unlink_or_warn",
          "old_text": null,
          "new_text": "unlink_or_warn(prevfile)",
          "old_line_content": "",
          "new_line_content": "\tunlink_or_warn(prevfile);",
          "content_same": false
        },
        {
          "line": 1130,
          "old_api": null,
          "new_api": "open",
          "old_text": null,
          "new_text": "open(freq->tmpfile,\n\t\t\t\t       O_WRONLY | O_CREAT | O_EXCL, 0666)",
          "old_line_content": "\t/*",
          "new_line_content": "\t\tfreq->localfile = open(freq->tmpfile,",
          "content_same": false
        },
        {
          "line": 1136,
          "old_api": null,
          "new_api": "strerror",
          "old_text": null,
          "new_text": "strerror(errno)",
          "old_line_content": "\t\tif (dir) {",
          "new_line_content": "\t\t      freq->tmpfile, freq->filename, strerror(errno));",
          "content_same": false
        },
        {
          "line": 1140,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(&freq->stream, 0, sizeof(freq->stream))",
          "old_line_content": "\t\t}",
          "new_line_content": "\tmemset(&freq->stream, 0, sizeof(freq->stream));",
          "content_same": false
        },
        {
          "line": 1142,
          "old_api": null,
          "new_api": "git_inflate_init",
          "old_text": null,
          "new_text": "git_inflate_init(&freq->stream)",
          "old_line_content": "\t\t\t\t       O_WRONLY | O_CREAT | O_EXCL, 0666);",
          "new_line_content": "\tgit_inflate_init(&freq->stream);",
          "content_same": false
        },
        {
          "line": 1144,
          "old_api": null,
          "new_api": "git_SHA1_Init",
          "old_text": null,
          "new_text": "git_SHA1_Init(&freq->c)",
          "old_line_content": "",
          "new_line_content": "\tgit_SHA1_Init(&freq->c);",
          "content_same": false
        },
        {
          "line": 1156,
          "old_api": null,
          "new_api": "xread",
          "old_text": null,
          "new_text": "xread(prevlocal, prev_buf, PREV_BUF_SIZE)",
          "old_line_content": "",
          "new_line_content": "\t\t\tprev_read = xread(prevlocal, prev_buf, PREV_BUF_SIZE);",
          "content_same": false
        },
        {
          "line": 1168,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(prevlocal)",
          "old_line_content": "\t\t\tif (prev_read>0) {",
          "new_line_content": "\t\tclose(prevlocal);",
          "content_same": false
        },
        {
          "line": 1170,
          "old_api": null,
          "new_api": "unlink_or_warn",
          "old_text": null,
          "new_text": "unlink_or_warn(prevfile)",
          "old_line_content": "\t\t\t\t\t\t     1,",
          "new_line_content": "\tunlink_or_warn(prevfile);",
          "content_same": false
        },
        {
          "line": 1177,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(&freq->stream, 0, sizeof(freq->stream))",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\tmemset(&freq->stream, 0, sizeof(freq->stream));",
          "content_same": false
        },
        {
          "line": 1178,
          "old_api": null,
          "new_api": "git_inflate_init",
          "old_text": null,
          "new_text": "git_inflate_init(&freq->stream)",
          "old_line_content": "\t\t} while (prev_read > 0);",
          "new_line_content": "\t\tgit_inflate_init(&freq->stream);",
          "content_same": false
        },
        {
          "line": 1182,
          "old_api": null,
          "new_api": "lseek",
          "old_text": null,
          "new_text": "lseek(freq->localfile, 0, SEEK_SET)",
          "old_line_content": "",
          "new_line_content": "\t\t\tlseek(freq->localfile, 0, SEEK_SET);",
          "content_same": false
        },
        {
          "line": 1183,
          "old_api": null,
          "new_api": "ftruncate",
          "old_text": null,
          "new_text": "ftruncate(freq->localfile, 0)",
          "old_line_content": "\t/*",
          "new_line_content": "\t\t\tftruncate(freq->localfile, 0);",
          "content_same": false
        },
        {
          "line": 1187,
          "old_api": null,
          "new_api": "get_active_slot",
          "old_text": null,
          "new_text": "get_active_slot()",
          "old_line_content": "\tif (prev_read == -1) {",
          "new_line_content": "\tfreq->slot = get_active_slot();",
          "content_same": false
        },
        {
          "line": 1191,
          "old_api": null,
          "new_api": "curl_easy_setopt",
          "old_text": null,
          "new_text": "curl_easy_setopt(freq->slot->curl, CURLOPT_ERRORBUFFER, freq->errorstr)",
          "old_line_content": "\t\tif (prev_posn>0) {",
          "new_line_content": "\tcurl_easy_setopt(freq->slot->curl, CURLOPT_ERRORBUFFER, freq->errorstr);",
          "content_same": false
        },
        {
          "line": 1192,
          "old_api": null,
          "new_api": "curl_easy_setopt",
          "old_text": null,
          "new_text": "curl_easy_setopt(freq->slot->curl, CURLOPT_URL, url)",
          "old_line_content": "\t\t\tprev_posn = 0;",
          "new_line_content": "\tcurl_easy_setopt(freq->slot->curl, CURLOPT_URL, url);",
          "content_same": false
        },
        {
          "line": 1205,
          "old_api": null,
          "new_api": "curl_slist_append",
          "old_text": null,
          "new_text": "curl_slist_append(range_header, range)",
          "old_line_content": "",
          "new_line_content": "\t\trange_header = curl_slist_append(range_header, range);",
          "content_same": false
        },
        {
          "line": 1206,
          "old_api": null,
          "new_api": "curl_easy_setopt",
          "old_text": null,
          "new_text": "curl_easy_setopt(freq->slot->curl,\n\t\t\t\t CURLOPT_HTTPHEADER, range_header)",
          "old_line_content": "\t/*",
          "new_line_content": "\t\tcurl_easy_setopt(freq->slot->curl,",
          "content_same": false
        },
        {
          "line": 1214,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(filename)",
          "old_line_content": "\t\t\t\thex, prev_posn);",
          "new_line_content": "\tfree(filename);",
          "content_same": false
        },
        {
          "line": 1232,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(freq->localfile)",
          "old_line_content": "\tif (freq->slot == NULL)",
          "new_line_content": "\tclose(freq->localfile);",
          "content_same": false
        },
        {
          "line": 1235,
          "old_api": null,
          "new_api": "process_http_object_request",
          "old_text": null,
          "new_text": "process_http_object_request(freq)",
          "old_line_content": "\tfreq->http_code = freq->slot->http_code;",
          "new_line_content": "\tprocess_http_object_request(freq);",
          "content_same": false
        },
        {
          "line": 1238,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr, \"Warning: requested range invalid; we may already have all the data.\\n\")",
          "old_line_content": "",
          "new_line_content": "\t\tfprintf(stderr, \"Warning: requested range invalid; we may already have all the data.\\n\");",
          "content_same": false
        },
        {
          "line": 1240,
          "old_api": null,
          "new_api": "stat",
          "old_text": null,
          "new_text": "stat(freq->tmpfile, &st)",
          "old_line_content": "{",
          "new_line_content": "\t\tif (stat(freq->tmpfile, &st) == 0)",
          "content_same": false
        },
        {
          "line": 1242,
          "old_api": null,
          "new_api": "unlink_or_warn",
          "old_text": null,
          "new_text": "unlink_or_warn(freq->tmpfile)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tunlink_or_warn(freq->tmpfile);",
          "content_same": false
        },
        {
          "line": 1247,
          "old_api": null,
          "new_api": "git_SHA1_Final",
          "old_text": null,
          "new_text": "git_SHA1_Final(freq->real_sha1, &freq->c)",
          "old_line_content": "",
          "new_line_content": "\tgit_SHA1_Final(freq->real_sha1, &freq->c);",
          "content_same": false
        },
        {
          "line": 1252,
          "old_api": null,
          "new_api": "hashcmp",
          "old_text": null,
          "new_text": "hashcmp(freq->sha1, freq->real_sha1)",
          "old_line_content": "\t\t\tif (st.st_size == 0)",
          "new_line_content": "\tif (hashcmp(freq->sha1, freq->real_sha1)) {",
          "content_same": false
        },
        {
          "line": 1266,
          "old_api": null,
          "new_api": "release_http_object_request",
          "old_text": null,
          "new_text": "release_http_object_request(freq)",
          "old_line_content": "\t}",
          "new_line_content": "\trelease_http_object_request(freq);",
          "content_same": false
        },
        {
          "line": 1272,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(freq->localfile)",
          "old_line_content": "",
          "new_line_content": "\t\tclose(freq->localfile);",
          "content_same": false
        },
        {
          "line": 1276,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(freq->url)",
          "old_line_content": "",
          "new_line_content": "\t\tfree(freq->url);",
          "content_same": false
        },
        {
          "line": 1282,
          "old_api": null,
          "new_api": "release_active_slot",
          "old_text": null,
          "new_text": "release_active_slot(freq->slot)",
          "old_line_content": "\tif (freq->localfile != -1) {",
          "new_line_content": "\t\trelease_active_slot(freq->slot);",
          "content_same": false
        },
        {
          "line": 872,
          "old_api": null,
          "new_api": "has_pack_index",
          "old_text": null,
          "new_text": "has_pack_index(sha1)",
          "old_line_content": "\t/* Don't use the index if the pack isn't there */",
          "new_line_content": "\tif (has_pack_index(sha1)) {",
          "content_same": false
        },
        {
          "line": 880,
          "old_api": null,
          "new_api": "end_url_with_slash",
          "old_text": null,
          "new_text": "end_url_with_slash(&buf, base_url)",
          "old_line_content": "\t\tgoto cleanup;",
          "new_line_content": "\tend_url_with_slash(&buf, base_url);",
          "content_same": false
        },
        {
          "line": 881,
          "old_api": null,
          "new_api": "strbuf_addf",
          "old_text": null,
          "new_text": "strbuf_addf(&buf, \"objects/pack/pack-%s.idx\", hex)",
          "old_line_content": "\t}",
          "new_line_content": "\tstrbuf_addf(&buf, \"objects/pack/pack-%s.idx\", hex);",
          "content_same": false
        },
        {
          "line": 882,
          "old_api": null,
          "new_api": "strbuf_detach",
          "old_text": null,
          "new_text": "strbuf_detach(&buf, NULL)",
          "old_line_content": "",
          "new_line_content": "\turl = strbuf_detach(&buf, NULL);",
          "content_same": false
        },
        {
          "line": 884,
          "old_api": null,
          "new_api": "sha1_pack_index_name",
          "old_text": null,
          "new_text": "sha1_pack_index_name(sha1)",
          "old_line_content": "\t\tret = 0;",
          "new_line_content": "\tfilename = sha1_pack_index_name(sha1);",
          "content_same": false
        },
        {
          "line": 885,
          "old_api": null,
          "new_api": "http_get_file",
          "old_text": null,
          "new_text": "http_get_file(url, filename, 0)",
          "old_line_content": "\t\tgoto cleanup;",
          "new_line_content": "\tif (http_get_file(url, filename, 0) != HTTP_OK)",
          "content_same": false
        },
        {
          "line": 886,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"Unable to get pack index %s\\n\", url)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tret = error(\"Unable to get pack index %s\\n\", url);",
          "content_same": false
        },
        {
          "line": 890,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(url)",
          "old_line_content": "",
          "new_line_content": "\tfree(url);",
          "content_same": false
        },
        {
          "line": 899,
          "old_api": null,
          "new_api": "fetch_pack_index",
          "old_text": null,
          "new_text": "fetch_pack_index(sha1, base_url)",
          "old_line_content": "cleanup:",
          "new_line_content": "\tif (fetch_pack_index(sha1, base_url))",
          "content_same": false
        },
        {
          "line": 902,
          "old_api": null,
          "new_api": "parse_pack_index",
          "old_text": null,
          "new_text": "parse_pack_index(sha1)",
          "old_line_content": "\treturn ret;",
          "new_line_content": "\tnew_pack = parse_pack_index(sha1);",
          "content_same": false
        },
        {
          "line": 917,
          "old_api": null,
          "new_api": "end_url_with_slash",
          "old_text": null,
          "new_text": "end_url_with_slash(&buf, base_url)",
          "old_line_content": "\t*packs_head = new_pack;",
          "new_line_content": "\tend_url_with_slash(&buf, base_url);",
          "content_same": false
        },
        {
          "line": 918,
          "old_api": null,
          "new_api": "strbuf_addstr",
          "old_text": null,
          "new_text": "strbuf_addstr(&buf, \"objects/info/packs\")",
          "old_line_content": "\treturn 0;",
          "new_line_content": "\tstrbuf_addstr(&buf, \"objects/info/packs\");",
          "content_same": false
        },
        {
          "line": 919,
          "old_api": null,
          "new_api": "strbuf_detach",
          "old_text": null,
          "new_text": "strbuf_detach(&buf, NULL)",
          "old_line_content": "}",
          "new_line_content": "\turl = strbuf_detach(&buf, NULL);",
          "content_same": false
        },
        {
          "line": 921,
          "old_api": null,
          "new_api": "http_get_strbuf",
          "old_text": null,
          "new_text": "http_get_strbuf(url, &buf, HTTP_NO_CACHE)",
          "old_line_content": "int http_get_info_packs(const char *base_url, struct packed_git **packs_head)",
          "new_line_content": "\tret = http_get_strbuf(url, &buf, HTTP_NO_CACHE);",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": null,
          "new_api": "prefixcmp",
          "old_text": null,
          "new_text": "prefixcmp(data + i, \" pack-\")",
          "old_line_content": "",
          "new_line_content": "\t\t\t    !prefixcmp(data + i, \" pack-\") &&",
          "content_same": false
        },
        {
          "line": 933,
          "old_api": null,
          "new_api": "get_sha1_hex",
          "old_text": null,
          "new_text": "get_sha1_hex(data + i + 6, sha1)",
          "old_line_content": "\tif (ret != HTTP_OK)",
          "new_line_content": "\t\t\t\tget_sha1_hex(data + i + 6, sha1);",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": null,
          "new_api": "fetch_and_setup_pack_index",
          "old_text": null,
          "new_text": "fetch_and_setup_pack_index(packs_head, sha1,\n\t\t\t\t\t\t      base_url)",
          "old_line_content": "\t\tgoto cleanup;",
          "new_line_content": "\t\t\t\tfetch_and_setup_pack_index(packs_head, sha1,",
          "content_same": false
        },
        {
          "line": 947,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(url)",
          "old_line_content": "\t\t\t\ti += 51;",
          "new_line_content": "\tfree(url);",
          "content_same": false
        },
        {
          "line": 954,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(preq->packfile)",
          "old_line_content": "\t\ti++;",
          "new_line_content": "\t\tfclose(preq->packfile);",
          "content_same": false
        },
        {
          "line": 959,
          "old_api": null,
          "new_api": "curl_slist_free_all",
          "old_text": null,
          "new_text": "curl_slist_free_all(preq->range_header)",
          "old_line_content": "\treturn ret;",
          "new_line_content": "\t\tcurl_slist_free_all(preq->range_header);",
          "content_same": false
        },
        {
          "line": 963,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(preq->url)",
          "old_line_content": "{",
          "new_line_content": "\tfree(preq->url);",
          "content_same": false
        },
        {
          "line": 971,
          "old_api": null,
          "new_api": "ftell",
          "old_text": null,
          "new_text": "ftell(preq->packfile)",
          "old_line_content": "\t\tpreq->range_header = NULL;",
          "new_line_content": "\tpreq->target->pack_size = ftell(preq->packfile);",
          "content_same": false
        },
        {
          "line": 979,
          "old_api": null,
          "new_api": "move_temp_to_file",
          "old_text": null,
          "new_text": "move_temp_to_file(preq->tmpfile, preq->filename)",
          "old_line_content": "\tint ret;",
          "new_line_content": "\tret = move_temp_to_file(preq->tmpfile, preq->filename);",
          "content_same": false
        },
        {
          "line": 988,
          "old_api": null,
          "new_api": "verify_pack",
          "old_text": null,
          "new_text": "verify_pack(preq->target)",
          "old_line_content": "\t}",
          "new_line_content": "\tif (verify_pack(preq->target))",
          "content_same": false
        },
        {
          "line": 1005,
          "old_api": null,
          "new_api": "xmalloc",
          "old_text": null,
          "new_text": "xmalloc(sizeof(*preq))",
          "old_line_content": "",
          "new_line_content": "\tpreq = xmalloc(sizeof(*preq));",
          "content_same": false
        },
        {
          "line": 1009,
          "old_api": null,
          "new_api": "end_url_with_slash",
          "old_text": null,
          "new_text": "end_url_with_slash(&buf, base_url)",
          "old_line_content": "\tchar *url;",
          "new_line_content": "\tend_url_with_slash(&buf, base_url);",
          "content_same": false
        },
        {
          "line": 1010,
          "old_api": null,
          "new_api": "strbuf_addf",
          "old_text": null,
          "new_text": "strbuf_addf(&buf, \"objects/pack/pack-%s.pack\",\n\t\tsha1_to_hex(target->sha1))",
          "old_line_content": "\tchar *filename;",
          "new_line_content": "\tstrbuf_addf(&buf, \"objects/pack/pack-%s.pack\",",
          "content_same": false
        },
        {
          "line": 1011,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(target->sha1)",
          "old_line_content": "\tlong prev_posn = 0;",
          "new_line_content": "\t\tsha1_to_hex(target->sha1));",
          "content_same": false
        },
        {
          "line": 1012,
          "old_api": null,
          "new_api": "strbuf_detach",
          "old_text": null,
          "new_text": "strbuf_detach(&buf, NULL)",
          "old_line_content": "\tchar range[RANGE_HEADER_SIZE];",
          "new_line_content": "\turl = strbuf_detach(&buf, NULL);",
          "content_same": false
        },
        {
          "line": 1013,
          "old_api": null,
          "new_api": "xstrdup",
          "old_text": null,
          "new_text": "xstrdup(url)",
          "old_line_content": "\tstruct strbuf buf = STRBUF_INIT;",
          "new_line_content": "\tpreq->url = xstrdup(url);",
          "content_same": false
        },
        {
          "line": 1015,
          "old_api": null,
          "new_api": "sha1_pack_name",
          "old_text": null,
          "new_text": "sha1_pack_name(target->sha1)",
          "old_line_content": "",
          "new_line_content": "\tfilename = sha1_pack_name(target->sha1);",
          "content_same": false
        },
        {
          "line": 1017,
          "old_api": null,
          "new_api": "snprintf",
          "old_text": null,
          "new_text": "snprintf(preq->tmpfile, sizeof(preq->tmpfile), \"%s.temp\", filename)",
          "old_line_content": "\tpreq->target = target;",
          "new_line_content": "\tsnprintf(preq->tmpfile, sizeof(preq->tmpfile), \"%s.temp\", filename);",
          "content_same": false
        },
        {
          "line": 1018,
          "old_api": null,
          "new_api": "fopen",
          "old_text": null,
          "new_text": "fopen(preq->tmpfile, \"a\")",
          "old_line_content": "\tpreq->range_header = NULL;",
          "new_line_content": "\tpreq->packfile = fopen(preq->tmpfile, \"a\");",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1024,
          "old_api": "xstrdup",
          "new_api": null,
          "old_text": "xstrdup(url)",
          "new_text": null,
          "old_line_content": "\tpreq->url = xstrdup(url);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1026,
          "old_api": "sha1_pack_name",
          "new_api": null,
          "old_text": "sha1_pack_name(target->sha1)",
          "new_text": null,
          "old_line_content": "\tfilename = sha1_pack_name(target->sha1);",
          "new_line_content": "\tpreq->slot->local = preq->packfile;",
          "content_same": false
        },
        {
          "line": 1031,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"Unable to open local file %s for pack\",\n\t\t      preq->tmpfile)",
          "new_text": null,
          "old_line_content": "\t\terror(\"Unable to open local file %s for pack\",",
          "new_line_content": "\t\tno_pragma_header);",
          "content_same": false
        },
        {
          "line": 1036,
          "old_api": "get_active_slot",
          "new_api": null,
          "old_text": "get_active_slot()",
          "new_text": null,
          "old_line_content": "\tpreq->slot = get_active_slot();",
          "new_line_content": "\t */",
          "content_same": false
        },
        {
          "line": 1038,
          "old_api": "curl_easy_setopt",
          "new_api": null,
          "old_text": "curl_easy_setopt(preq->slot->curl, CURLOPT_FILE, preq->packfile)",
          "new_text": null,
          "old_line_content": "\tcurl_easy_setopt(preq->slot->curl, CURLOPT_FILE, preq->packfile);",
          "new_line_content": "\tif (prev_posn>0) {",
          "content_same": false
        },
        {
          "line": 1039,
          "old_api": "curl_easy_setopt",
          "new_api": null,
          "old_text": "curl_easy_setopt(preq->slot->curl, CURLOPT_WRITEFUNCTION, fwrite)",
          "new_text": null,
          "old_line_content": "\tcurl_easy_setopt(preq->slot->curl, CURLOPT_WRITEFUNCTION, fwrite);",
          "new_line_content": "\t\tif (http_is_verbose)",
          "content_same": false
        },
        {
          "line": 1041,
          "old_api": "curl_easy_setopt",
          "new_api": null,
          "old_text": "curl_easy_setopt(preq->slot->curl, CURLOPT_HTTPHEADER,\n\t\tno_pragma_header)",
          "new_text": null,
          "old_line_content": "\tcurl_easy_setopt(preq->slot->curl, CURLOPT_HTTPHEADER,",
          "new_line_content": "\t\t\t\t\"Resuming fetch of pack %s at byte %ld\\n\",",
          "content_same": false
        },
        {
          "line": 1048,
          "old_api": "ftell",
          "new_api": null,
          "old_text": "ftell(preq->packfile)",
          "new_text": null,
          "old_line_content": "\tprev_posn = ftell(preq->packfile);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1051,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr,\n\t\t\t\t\"Resuming fetch of pack %s at byte %ld\\n\",\n\t\t\t\tsha1_to_hex(target->sha1), prev_posn)",
          "new_text": null,
          "old_line_content": "\t\t\tfprintf(stderr,",
          "new_line_content": "abort:",
          "content_same": false
        },
        {
          "line": 1053,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(target->sha1)",
          "new_text": null,
          "old_line_content": "\t\t\t\tsha1_to_hex(target->sha1), prev_posn);",
          "new_line_content": "\treturn NULL;",
          "content_same": false
        },
        {
          "line": 1054,
          "old_api": "sprintf",
          "new_api": null,
          "old_text": "sprintf(range, \"Range: bytes=%ld-\", prev_posn)",
          "new_text": null,
          "old_line_content": "\t\tsprintf(range, \"Range: bytes=%ld-\", prev_posn);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1055,
          "old_api": "curl_slist_append",
          "new_api": null,
          "old_text": "curl_slist_append(NULL, range)",
          "new_text": null,
          "old_line_content": "\t\tpreq->range_header = curl_slist_append(NULL, range);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1056,
          "old_api": "curl_easy_setopt",
          "new_api": null,
          "old_text": "curl_easy_setopt(preq->slot->curl, CURLOPT_HTTPHEADER,\n\t\t\tpreq->range_header)",
          "new_text": null,
          "old_line_content": "\t\tcurl_easy_setopt(preq->slot->curl, CURLOPT_HTTPHEADER,",
          "new_line_content": "/* Helpers for fetching objects (loose) */",
          "content_same": false
        },
        {
          "line": 1063,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(filename)",
          "new_text": null,
          "old_line_content": "\tfree(filename);",
          "new_line_content": "\tstruct http_object_request *freq =",
          "content_same": false
        },
        {
          "line": 1077,
          "old_api": "xwrite",
          "new_api": null,
          "old_text": "xwrite(freq->localfile,\n\t\t\t\t\t(char *) ptr + posn, size - posn)",
          "new_text": null,
          "old_line_content": "\t\tssize_t retval = xwrite(freq->localfile,",
          "new_line_content": "\t\tfreq->stream.avail_out = sizeof(expn);",
          "content_same": false
        },
        {
          "line": 1090,
          "old_api": "git_SHA1_Update",
          "new_api": null,
          "old_text": "git_SHA1_Update(&freq->c, expn,\n\t\t\t\tsizeof(expn) - freq->stream.avail_out)",
          "new_text": null,
          "old_line_content": "\t\tgit_SHA1_Update(&freq->c, expn,",
          "new_line_content": "\tchar *filename;",
          "content_same": false
        },
        {
          "line": 1100,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(sha1)",
          "new_text": null,
          "old_line_content": "\tchar *hex = sha1_to_hex(sha1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1118,
          "old_api": "snprintf",
          "new_api": null,
          "old_text": "snprintf(freq->tmpfile, sizeof(freq->tmpfile),\n\t\t \"%s.temp\", filename)",
          "new_text": null,
          "old_line_content": "\tsnprintf(freq->tmpfile, sizeof(freq->tmpfile),",
          "new_line_content": "\t\t\t       O_WRONLY | O_CREAT | O_EXCL, 0666);",
          "content_same": false
        },
        {
          "line": 1121,
          "old_api": "snprintf",
          "new_api": null,
          "old_text": "snprintf(prevfile, sizeof(prevfile), \"%s.prev\", filename)",
          "new_text": null,
          "old_line_content": "\tsnprintf(prevfile, sizeof(prevfile), \"%s.prev\", filename);",
          "new_line_content": "\t * try to mkdir the last path component.",
          "content_same": false
        },
        {
          "line": 1122,
          "old_api": "unlink_or_warn",
          "new_api": null,
          "old_text": "unlink_or_warn(prevfile)",
          "new_text": null,
          "old_line_content": "\tunlink_or_warn(prevfile);",
          "new_line_content": "\t */",
          "content_same": false
        },
        {
          "line": 1123,
          "old_api": "rename",
          "new_api": null,
          "old_text": "rename(freq->tmpfile, prevfile)",
          "new_text": null,
          "old_line_content": "\trename(freq->tmpfile, prevfile);",
          "new_line_content": "\tif (freq->localfile < 0 && errno == ENOENT) {",
          "content_same": false
        },
        {
          "line": 1128,
          "old_api": "open",
          "new_api": null,
          "old_text": "open(freq->tmpfile,\n\t\t\t       O_WRONLY | O_CREAT | O_EXCL, 0666)",
          "new_text": null,
          "old_line_content": "\tfreq->localfile = open(freq->tmpfile,",
          "new_line_content": "\t\t\t*dir = '/';",
          "content_same": false
        },
        {
          "line": 1138,
          "old_api": "mkdir",
          "new_api": null,
          "old_text": "mkdir(freq->tmpfile, 0777)",
          "new_text": null,
          "old_line_content": "\t\t\tmkdir(freq->tmpfile, 0777);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1141,
          "old_api": "open",
          "new_api": null,
          "old_text": "open(freq->tmpfile,\n\t\t\t\t       O_WRONLY | O_CREAT | O_EXCL, 0666)",
          "new_text": null,
          "old_line_content": "\t\tfreq->localfile = open(freq->tmpfile,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1151,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(&freq->stream, 0, sizeof(freq->stream))",
          "new_text": null,
          "old_line_content": "\tmemset(&freq->stream, 0, sizeof(freq->stream));",
          "new_line_content": "\t * fetched.",
          "content_same": false
        },
        {
          "line": 1155,
          "old_api": "git_SHA1_Init",
          "new_api": null,
          "old_text": "git_SHA1_Init(&freq->c)",
          "new_text": null,
          "old_line_content": "\tgit_SHA1_Init(&freq->c);",
          "new_line_content": "\t\tdo {",
          "content_same": false
        },
        {
          "line": 1157,
          "old_api": "get_remote_object_url",
          "new_api": null,
          "old_text": "get_remote_object_url(base_url, hex, 0)",
          "new_text": null,
          "old_line_content": "\turl = get_remote_object_url(base_url, hex, 0);",
          "new_line_content": "\t\t\tif (prev_read>0) {",
          "content_same": false
        },
        {
          "line": 1164,
          "old_api": "open",
          "new_api": null,
          "old_text": "open(prevfile, O_RDONLY)",
          "new_text": null,
          "old_line_content": "\tprevlocal = open(prevfile, O_RDONLY);",
          "new_line_content": "\t\t\t\t\tprev_read = -1;",
          "content_same": false
        },
        {
          "line": 1167,
          "old_api": "xread",
          "new_api": null,
          "old_text": "xread(prevlocal, prev_buf, PREV_BUF_SIZE)",
          "new_text": null,
          "old_line_content": "\t\t\tprev_read = xread(prevlocal, prev_buf, PREV_BUF_SIZE);",
          "new_line_content": "\t\t} while (prev_read > 0);",
          "content_same": false
        },
        {
          "line": 1169,
          "old_api": "fwrite_sha1_file",
          "new_api": null,
          "old_text": "fwrite_sha1_file(prev_buf,\n\t\t\t\t\t\t     1,\n\t\t\t\t\t\t     prev_read,\n\t\t\t\t\t\t     freq)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (fwrite_sha1_file(prev_buf,",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1181,
          "old_api": "unlink_or_warn",
          "new_api": null,
          "old_text": "unlink_or_warn(prevfile)",
          "new_text": null,
          "old_line_content": "\tunlink_or_warn(prevfile);",
          "new_line_content": "\t\t\tprev_posn = 0;",
          "content_same": false
        },
        {
          "line": 1188,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(&freq->stream, 0, sizeof(freq->stream))",
          "new_text": null,
          "old_line_content": "\t\tmemset(&freq->stream, 0, sizeof(freq->stream));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1194,
          "old_api": "ftruncate",
          "new_api": null,
          "old_text": "ftruncate(freq->localfile, 0)",
          "new_text": null,
          "old_line_content": "\t\t\tftruncate(freq->localfile, 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1198,
          "old_api": "get_active_slot",
          "new_api": null,
          "old_text": "get_active_slot()",
          "new_text": null,
          "old_line_content": "\tfreq->slot = get_active_slot();",
          "new_line_content": "\t */",
          "content_same": false
        },
        {
          "line": 1200,
          "old_api": "curl_easy_setopt",
          "new_api": null,
          "old_text": "curl_easy_setopt(freq->slot->curl, CURLOPT_FILE, freq)",
          "new_text": null,
          "old_line_content": "\tcurl_easy_setopt(freq->slot->curl, CURLOPT_FILE, freq);",
          "new_line_content": "\t\tif (http_is_verbose)",
          "content_same": false
        },
        {
          "line": 1202,
          "old_api": "curl_easy_setopt",
          "new_api": null,
          "old_text": "curl_easy_setopt(freq->slot->curl, CURLOPT_ERRORBUFFER, freq->errorstr)",
          "new_text": null,
          "old_line_content": "\tcurl_easy_setopt(freq->slot->curl, CURLOPT_ERRORBUFFER, freq->errorstr);",
          "new_line_content": "\t\t\t\t\"Resuming fetch of object %s at byte %ld\\n\",",
          "content_same": false
        },
        {
          "line": 1203,
          "old_api": "curl_easy_setopt",
          "new_api": null,
          "old_text": "curl_easy_setopt(freq->slot->curl, CURLOPT_URL, url)",
          "new_text": null,
          "old_line_content": "\tcurl_easy_setopt(freq->slot->curl, CURLOPT_URL, url);",
          "new_line_content": "\t\t\t\thex, prev_posn);",
          "content_same": false
        },
        {
          "line": 1216,
          "old_api": "curl_slist_append",
          "new_api": null,
          "old_text": "curl_slist_append(range_header, range)",
          "new_text": null,
          "old_line_content": "\t\trange_header = curl_slist_append(range_header, range);",
          "new_line_content": "\treturn NULL;",
          "content_same": false
        },
        {
          "line": 1217,
          "old_api": "curl_easy_setopt",
          "new_api": null,
          "old_text": "curl_easy_setopt(freq->slot->curl,\n\t\t\t\t CURLOPT_HTTPHEADER, range_header)",
          "new_text": null,
          "old_line_content": "\t\tcurl_easy_setopt(freq->slot->curl,",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1223,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(url)",
          "new_text": null,
          "old_line_content": "\tfree(url);",
          "new_line_content": "\tfreq->curl_result = freq->slot->curl_result;",
          "content_same": false
        },
        {
          "line": 1225,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(filename)",
          "new_text": null,
          "old_line_content": "\tfree(filename);",
          "new_line_content": "\tfreq->slot = NULL;",
          "content_same": false
        },
        {
          "line": 1226,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(freq)",
          "new_text": null,
          "old_line_content": "\tfree(freq);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1243,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(freq->localfile)",
          "new_text": null,
          "old_line_content": "\tclose(freq->localfile);",
          "new_line_content": "\t\treturn -1;",
          "content_same": false
        },
        {
          "line": 1251,
          "old_api": "stat",
          "new_api": null,
          "old_text": "stat(freq->tmpfile, &st)",
          "new_text": null,
          "old_line_content": "\t\tif (stat(freq->tmpfile, &st) == 0)",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1258,
          "old_api": "git_SHA1_Final",
          "new_api": null,
          "old_text": "git_SHA1_Final(freq->real_sha1, &freq->c)",
          "new_text": null,
          "old_line_content": "\tgit_SHA1_Final(freq->real_sha1, &freq->c);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1260,
          "old_api": "unlink_or_warn",
          "new_api": null,
          "old_text": "unlink_or_warn(freq->tmpfile)",
          "new_text": null,
          "old_line_content": "\t\tunlink_or_warn(freq->tmpfile);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1263,
          "old_api": "hashcmp",
          "new_api": null,
          "old_text": "hashcmp(freq->sha1, freq->real_sha1)",
          "new_text": null,
          "old_line_content": "\tif (hashcmp(freq->sha1, freq->real_sha1)) {",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1268,
          "old_api": "move_temp_to_file",
          "new_api": null,
          "old_text": "move_temp_to_file(freq->tmpfile, freq->filename)",
          "new_text": null,
          "old_line_content": "\t\tmove_temp_to_file(freq->tmpfile, freq->filename);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1275,
          "old_api": "unlink_or_warn",
          "new_api": null,
          "old_text": "unlink_or_warn(freq->tmpfile)",
          "new_text": null,
          "old_line_content": "\tunlink_or_warn(freq->tmpfile);",
          "new_line_content": "\tif (freq->url != NULL) {",
          "content_same": false
        },
        {
          "line": 1277,
          "old_api": "release_http_object_request",
          "new_api": null,
          "old_text": "release_http_object_request(freq)",
          "new_text": null,
          "old_line_content": "\trelease_http_object_request(freq);",
          "new_line_content": "\t\tfreq->url = NULL;",
          "content_same": false
        },
        {
          "line": 1283,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(freq->localfile)",
          "new_text": null,
          "old_line_content": "\t\tclose(freq->localfile);",
          "new_line_content": "\t\tfreq->slot = NULL;",
          "content_same": false
        },
        {
          "line": 1287,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(freq->url)",
          "new_text": null,
          "old_line_content": "\t\tfree(freq->url);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1293,
          "old_api": "release_active_slot",
          "new_api": null,
          "old_text": "release_active_slot(freq->slot)",
          "new_text": null,
          "old_line_content": "\t\trelease_active_slot(freq->slot);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 873,
          "old_api": "end_url_with_slash",
          "new_api": null,
          "old_text": "end_url_with_slash(&buf, base_url)",
          "new_text": null,
          "old_line_content": "\tend_url_with_slash(&buf, base_url);",
          "new_line_content": "\t\tret = 0;",
          "content_same": false
        },
        {
          "line": 874,
          "old_api": "strbuf_addf",
          "new_api": null,
          "old_text": "strbuf_addf(&buf, \"objects/pack/pack-%s.pack\", hex)",
          "new_text": null,
          "old_line_content": "\tstrbuf_addf(&buf, \"objects/pack/pack-%s.pack\", hex);",
          "new_line_content": "\t\tgoto cleanup;",
          "content_same": false
        },
        {
          "line": 875,
          "old_api": "strbuf_detach",
          "new_api": null,
          "old_text": "strbuf_detach(&buf, 0)",
          "new_text": null,
          "old_line_content": "\turl = strbuf_detach(&buf, 0);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 877,
          "old_api": "http_get_strbuf",
          "new_api": null,
          "old_text": "http_get_strbuf(url, NULL, 0)",
          "new_text": null,
          "old_line_content": "\tif (http_get_strbuf(url, NULL, 0)) {",
          "new_line_content": "\tif (http_is_verbose)",
          "content_same": false
        },
        {
          "line": 883,
          "old_api": "has_pack_index",
          "new_api": null,
          "old_text": "has_pack_index(sha1)",
          "new_text": null,
          "old_line_content": "\tif (has_pack_index(sha1)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 891,
          "old_api": "end_url_with_slash",
          "new_api": null,
          "old_text": "end_url_with_slash(&buf, base_url)",
          "new_text": null,
          "old_line_content": "\tend_url_with_slash(&buf, base_url);",
          "new_line_content": "\treturn ret;",
          "content_same": false
        },
        {
          "line": 892,
          "old_api": "strbuf_addf",
          "new_api": null,
          "old_text": "strbuf_addf(&buf, \"objects/pack/pack-%s.idx\", hex)",
          "new_text": null,
          "old_line_content": "\tstrbuf_addf(&buf, \"objects/pack/pack-%s.idx\", hex);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 893,
          "old_api": "strbuf_detach",
          "new_api": null,
          "old_text": "strbuf_detach(&buf, NULL)",
          "new_text": null,
          "old_line_content": "\turl = strbuf_detach(&buf, NULL);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 895,
          "old_api": "sha1_pack_index_name",
          "new_api": null,
          "old_text": "sha1_pack_index_name(sha1)",
          "new_text": null,
          "old_line_content": "\tfilename = sha1_pack_index_name(sha1);",
          "new_line_content": "\tunsigned char *sha1, const char *base_url)",
          "content_same": false
        },
        {
          "line": 896,
          "old_api": "http_get_file",
          "new_api": null,
          "old_text": "http_get_file(url, filename, 0)",
          "new_text": null,
          "old_line_content": "\tif (http_get_file(url, filename, 0) != HTTP_OK)",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 897,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"Unable to get pack index %s\\n\", url)",
          "new_text": null,
          "old_line_content": "\t\tret = error(\"Unable to get pack index %s\\n\", url);",
          "new_line_content": "\tstruct packed_git *new_pack;",
          "content_same": false
        },
        {
          "line": 900,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(hex)",
          "new_text": null,
          "old_line_content": "\tfree(hex);",
          "new_line_content": "\t\treturn -1;",
          "content_same": false
        },
        {
          "line": 901,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(url)",
          "new_text": null,
          "old_line_content": "\tfree(url);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 910,
          "old_api": "fetch_pack_index",
          "new_api": null,
          "old_text": "fetch_pack_index(sha1, base_url)",
          "new_text": null,
          "old_line_content": "\tif (fetch_pack_index(sha1, base_url))",
          "new_line_content": "int http_get_info_packs(const char *base_url, struct packed_git **packs_head)",
          "content_same": false
        },
        {
          "line": 913,
          "old_api": "parse_pack_index",
          "new_api": null,
          "old_text": "parse_pack_index(sha1)",
          "new_text": null,
          "old_line_content": "\tnew_pack = parse_pack_index(sha1);",
          "new_line_content": "\tchar *url, *data;",
          "content_same": false
        },
        {
          "line": 928,
          "old_api": "end_url_with_slash",
          "new_api": null,
          "old_text": "end_url_with_slash(&buf, base_url)",
          "new_text": null,
          "old_line_content": "\tend_url_with_slash(&buf, base_url);",
          "new_line_content": "\t\tcase 'P':",
          "content_same": false
        },
        {
          "line": 929,
          "old_api": "strbuf_addstr",
          "new_api": null,
          "old_text": "strbuf_addstr(&buf, \"objects/info/packs\")",
          "new_text": null,
          "old_line_content": "\tstrbuf_addstr(&buf, \"objects/info/packs\");",
          "new_line_content": "\t\t\ti++;",
          "content_same": false
        },
        {
          "line": 930,
          "old_api": "strbuf_detach",
          "new_api": null,
          "old_text": "strbuf_detach(&buf, NULL)",
          "new_text": null,
          "old_line_content": "\turl = strbuf_detach(&buf, NULL);",
          "new_line_content": "\t\t\tif (i + 52 <= buf.len &&",
          "content_same": false
        },
        {
          "line": 942,
          "old_api": "prefixcmp",
          "new_api": null,
          "old_text": "prefixcmp(data + i, \" pack-\")",
          "new_text": null,
          "old_line_content": "\t\t\t    !prefixcmp(data + i, \" pack-\") &&",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 943,
          "old_api": "prefixcmp",
          "new_api": null,
          "old_text": "prefixcmp(data + i + 46, \".pack\\n\")",
          "new_text": null,
          "old_line_content": "\t\t\t    !prefixcmp(data + i + 46, \".pack\\n\")) {",
          "new_line_content": "\t\ti++;",
          "content_same": false
        },
        {
          "line": 944,
          "old_api": "get_sha1_hex",
          "new_api": null,
          "old_text": "get_sha1_hex(data + i + 6, sha1)",
          "new_text": null,
          "old_line_content": "\t\t\t\tget_sha1_hex(data + i + 6, sha1);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 945,
          "old_api": "fetch_and_setup_pack_index",
          "new_api": null,
          "old_text": "fetch_and_setup_pack_index(packs_head, sha1,\n\t\t\t\t\t\t      base_url)",
          "new_text": null,
          "old_line_content": "\t\t\t\tfetch_and_setup_pack_index(packs_head, sha1,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 958,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(url)",
          "new_text": null,
          "old_line_content": "\tfree(url);",
          "new_line_content": "\tif (preq->range_header != NULL) {",
          "content_same": false
        },
        {
          "line": 965,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(preq->packfile)",
          "new_text": null,
          "old_line_content": "\t\tfclose(preq->packfile);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 970,
          "old_api": "curl_slist_free_all",
          "new_api": null,
          "old_text": "curl_slist_free_all(preq->range_header)",
          "new_text": null,
          "old_line_content": "\t\tcurl_slist_free_all(preq->range_header);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 982,
          "old_api": "ftell",
          "new_api": null,
          "old_text": "ftell(preq->packfile)",
          "new_text": null,
          "old_line_content": "\tpreq->target->pack_size = ftell(preq->packfile);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 985,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(preq->packfile)",
          "new_text": null,
          "old_line_content": "\t\tfclose(preq->packfile);",
          "new_line_content": "\t\tlst = &((*lst)->next);",
          "content_same": false
        },
        {
          "line": 999,
          "old_api": "verify_pack",
          "new_api": null,
          "old_text": "verify_pack(preq->target)",
          "new_text": null,
          "old_line_content": "\tif (verify_pack(preq->target))",
          "new_line_content": "\tchar *filename;",
          "content_same": false
        },
        {
          "line": 1001,
          "old_api": "install_packed_git",
          "new_api": null,
          "old_text": "install_packed_git(preq->target)",
          "new_text": null,
          "old_line_content": "\tinstall_packed_git(preq->target);",
          "new_line_content": "\tchar range[RANGE_HEADER_SIZE];",
          "content_same": false
        },
        {
          "line": 1021,
          "old_api": "strbuf_addf",
          "new_api": null,
          "old_text": "strbuf_addf(&buf, \"objects/pack/pack-%s.pack\",\n\t\tsha1_to_hex(target->sha1))",
          "new_text": null,
          "old_line_content": "\tstrbuf_addf(&buf, \"objects/pack/pack-%s.pack\",",
          "new_line_content": "\t\t      preq->tmpfile);",
          "content_same": false
        },
        {
          "line": 1022,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(target->sha1)",
          "new_text": null,
          "old_line_content": "\t\tsha1_to_hex(target->sha1));",
          "new_line_content": "\t\tgoto abort;",
          "content_same": false
        },
        {
          "line": 1023,
          "old_api": "strbuf_detach",
          "new_api": null,
          "old_text": "strbuf_detach(&buf, NULL)",
          "new_text": null,
          "old_line_content": "\turl = strbuf_detach(&buf, NULL);",
          "new_line_content": "\t}",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 34,
      "total_additions": 80,
      "total_deletions": 85,
      "total_api_changes": 199
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 11,
        "api_related_lines": 199,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          876,
          879
        ]
      }
    },
    "api_calls_before": 317,
    "api_calls_after": 312,
    "diff_info": {
      "added_lines": 0,
      "removed_lines": 11,
      "total_diff_lines": 23
    }
  }
}