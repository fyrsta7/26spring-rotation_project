{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/a6eec1263883ce9787a354e1635b7b732e72c3c9",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/a6eec1263883ce9787a354e1635b7b732e72c3c9/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/a6eec1263883ce9787a354e1635b7b732e72c3c9/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/a6eec1263883ce9787a354e1635b7b732e72c3c9/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 330,
          "old_api": "lookup_object",
          "new_api": "parse_object",
          "old_text": "lookup_object(sha1)",
          "new_text": "parse_object(sha1)",
          "old_line_content": "\to = lookup_object(sha1);",
          "new_line_content": "\to = parse_object(sha1);",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": "parse_object",
          "new_api": "sha1_to_hex",
          "old_text": "parse_object(sha1)",
          "new_text": "sha1_to_hex(sha1)",
          "old_line_content": "\t\to = parse_object(sha1);",
          "new_line_content": "\t\tdie(\"oops (%s)\", sha1_to_hex(sha1));",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": "ok_to_give_up",
          "new_api": "packet_write",
          "old_text": "ok_to_give_up()",
          "new_text": "packet_write(1, \"ACK %s ready\\n\", last_hex)",
          "old_line_content": "\t\t\t    && !got_other && ok_to_give_up()) {",
          "new_line_content": "\t\t\t\tpacket_write(1, \"ACK %s ready\\n\", last_hex);",
          "content_same": false
        },
        {
          "line": 452,
          "old_api": "strip",
          "new_api": "got_sha1",
          "old_text": "strip(line, len)",
          "new_text": "got_sha1(line+5, sha1)",
          "old_line_content": "\t\tstrip(line, len);",
          "new_line_content": "\t\t\tswitch (got_sha1(line+5, sha1)) {",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": "sha1_to_hex",
          "new_api": "packet_write",
          "old_text": "sha1_to_hex(sha1)",
          "new_text": "packet_write(1, \"ACK %s common\\n\", last_hex)",
          "old_line_content": "\t\t\t\tmemcpy(last_hex, sha1_to_hex(sha1), 41);",
          "new_line_content": "\t\t\t\t\tpacket_write(1, \"ACK %s common\\n\", last_hex);",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": "close",
          "new_api": "sigchain_pop",
          "old_text": "close(cmd.in)",
          "new_text": "sigchain_pop(SIGPIPE)",
          "old_line_content": "\tclose(cmd.in);",
          "new_line_content": "\tsigchain_pop(SIGPIPE);",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": "write_in_full",
          "new_api": "prefixcmp",
          "old_text": "write_in_full(debug_fd, line, len)",
          "new_text": "prefixcmp(line, \"shallow \")",
          "old_line_content": "\t\t\twrite_in_full(debug_fd, line, len);",
          "new_line_content": "\t\tif (!prefixcmp(line, \"shallow \")) {",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": "get_sha1",
          "new_api": "parse_object",
          "old_text": "get_sha1(line + 8, sha1)",
          "new_text": "parse_object(sha1)",
          "old_line_content": "\t\t\tif (get_sha1(line + 8, sha1))",
          "new_line_content": "\t\t\tobject = parse_object(sha1);",
          "content_same": false
        },
        {
          "line": 603,
          "old_api": "parse_object",
          "new_api": "die",
          "old_text": "parse_object(sha1)",
          "new_text": "die(\"did not find object for %s\", line)",
          "old_line_content": "\t\t\tobject = parse_object(sha1);",
          "new_line_content": "\t\t\t\tdie(\"did not find object for %s\", line);",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": "die",
          "new_api": "add_object_array",
          "old_text": "die(\"did not find object for %s\", line)",
          "new_text": "add_object_array(object, NULL, &shallows)",
          "old_line_content": "\t\t\t\tdie(\"did not find object for %s\", line);",
          "new_line_content": "\t\t\tadd_object_array(object, NULL, &shallows);",
          "content_same": false
        },
        {
          "line": 610,
          "old_api": "prefixcmp",
          "new_api": "strtol",
          "old_text": "prefixcmp(line, \"deepen \")",
          "new_text": "strtol(line + 7, &end, 0)",
          "old_line_content": "\t\tif (!prefixcmp(line, \"deepen \")) {",
          "new_line_content": "\t\t\tdepth = strtol(line + 7, &end, 0);",
          "content_same": false
        },
        {
          "line": 612,
          "old_api": "strtol",
          "new_api": "die",
          "old_text": "strtol(line + 7, &end, 0)",
          "new_text": "die(\"Invalid deepen: %s\", line)",
          "old_line_content": "\t\t\tdepth = strtol(line + 7, &end, 0);",
          "new_line_content": "\t\t\t\tdie(\"Invalid deepen: %s\", line);",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": "prefixcmp",
          "new_api": "die",
          "old_text": "prefixcmp(line, \"want \")",
          "new_text": "die(\"git upload-pack: protocol error, \"\n\t\t\t    \"expected to get sha, not '%s'\", line)",
          "old_line_content": "\t\tif (prefixcmp(line, \"want \") ||",
          "new_line_content": "\t\t\tdie(\"git upload-pack: protocol error, \"",
          "content_same": false
        },
        {
          "line": 643,
          "old_api": "lookup_object",
          "new_api": "die",
          "old_text": "lookup_object(sha1_buf)",
          "new_text": "die(\"git upload-pack: not our ref %s\",\n\t\t\t    sha1_to_hex(sha1_buf))",
          "old_line_content": "\t\to = lookup_object(sha1_buf);",
          "new_line_content": "\t\t\tdie(\"git upload-pack: not our ref %s\",",
          "content_same": false
        },
        {
          "line": 680,
          "old_api": "packet_write",
          "new_api": "register_shallow",
          "old_text": "packet_write(1, \"shallow %s\",\n\t\t\t\t\t\tsha1_to_hex(object->sha1))",
          "new_text": "register_shallow(object->sha1)",
          "old_line_content": "\t\t\t\tpacket_write(1, \"shallow %s\",",
          "new_line_content": "\t\t\t\tregister_shallow(object->sha1);",
          "content_same": false
        },
        {
          "line": 696,
          "old_api": "unregister_shallow",
          "new_api": "parse_commit",
          "old_text": "unregister_shallow(object->sha1)",
          "new_text": "parse_commit((struct commit *)object)",
          "old_line_content": "\t\t\t\tunregister_shallow(object->sha1);",
          "new_line_content": "\t\t\t\tif (parse_commit((struct commit *)object))",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": "register_shallow",
          "new_api": "packet_flush",
          "old_text": "register_shallow(object->sha1)",
          "new_text": "packet_flush(1)",
          "old_line_content": "\t\t\tregister_shallow(object->sha1);",
          "new_line_content": "\t\tpacket_flush(1);",
          "content_same": false
        },
        {
          "line": 737,
          "old_api": "git_user_agent_sanitized",
          "new_api": "sha1_to_hex",
          "old_text": "git_user_agent_sanitized()",
          "new_text": "sha1_to_hex(sha1)",
          "old_line_content": "\t\t\t     git_user_agent_sanitized());",
          "new_line_content": "\t\tpacket_write(1, \"%s %s\\n\", sha1_to_hex(sha1), refname_nons);",
          "content_same": false
        },
        {
          "line": 752,
          "old_api": "parse_object",
          "new_api": "sha1_to_hex",
          "old_text": "parse_object(sha1)",
          "new_text": "sha1_to_hex(sha1)",
          "old_line_content": "\tstruct object *o = parse_object(sha1);",
          "new_line_content": "\t\tdie(\"git upload-pack: cannot find object %s:\", sha1_to_hex(sha1));",
          "content_same": false
        },
        {
          "line": 765,
          "old_api": "reset_timeout",
          "new_api": "for_each_namespaced_ref",
          "old_text": "reset_timeout()",
          "new_text": "for_each_namespaced_ref(send_ref, NULL)",
          "old_line_content": "\t\treset_timeout();",
          "new_line_content": "\t\tfor_each_namespaced_ref(send_ref, NULL);",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": "head_ref_namespaced",
          "new_api": "packet_flush",
          "old_text": "head_ref_namespaced(send_ref, NULL)",
          "new_text": "packet_flush(1)",
          "old_line_content": "\t\thead_ref_namespaced(send_ref, NULL);",
          "new_line_content": "\t\tpacket_flush(1);",
          "content_same": false
        },
        {
          "line": 768,
          "old_api": "packet_flush",
          "new_api": "head_ref_namespaced",
          "old_text": "packet_flush(1)",
          "new_text": "head_ref_namespaced(mark_our_ref, NULL)",
          "old_line_content": "\t\tpacket_flush(1);",
          "new_line_content": "\t\thead_ref_namespaced(mark_our_ref, NULL);",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": "receive_needs",
          "new_api": "get_common_commits",
          "old_text": "receive_needs()",
          "new_text": "get_common_commits()",
          "old_line_content": "\treceive_needs();",
          "new_line_content": "\t\tget_common_commits();",
          "content_same": false
        },
        {
          "line": 789,
          "old_api": "git_setup_gettext",
          "new_api": "packet_trace_identity",
          "old_text": "git_setup_gettext()",
          "new_text": "packet_trace_identity(\"upload-pack\")",
          "old_line_content": "\tgit_setup_gettext();",
          "new_line_content": "\tpacket_trace_identity(\"upload-pack\");",
          "content_same": false
        },
        {
          "line": 824,
          "old_api": "usage",
          "new_api": "setup_path",
          "old_text": "usage(upload_pack_usage)",
          "new_text": "setup_path()",
          "old_line_content": "\t\tusage(upload_pack_usage);",
          "new_line_content": "\tsetup_path();",
          "content_same": false
        },
        {
          "line": 830,
          "old_api": "enter_repo",
          "new_api": "is_repository_shallow",
          "old_text": "enter_repo(dir, strict)",
          "new_text": "is_repository_shallow()",
          "old_line_content": "\tif (!enter_repo(dir, strict))",
          "new_line_content": "\tif (is_repository_shallow())",
          "content_same": false
        },
        {
          "line": 832,
          "old_api": "is_repository_shallow",
          "new_api": "getenv",
          "old_text": "is_repository_shallow()",
          "new_text": "getenv(\"GIT_DEBUG_SEND_PACK\")",
          "old_line_content": "\tif (is_repository_shallow())",
          "new_line_content": "\tif (getenv(\"GIT_DEBUG_SEND_PACK\"))",
          "content_same": false
        },
        {
          "line": 833,
          "old_api": "die",
          "new_api": "getenv",
          "old_text": "die(\"attempt to fetch/clone from a shallow repository\")",
          "new_text": "getenv(\"GIT_DEBUG_SEND_PACK\")",
          "old_line_content": "\t\tdie(\"attempt to fetch/clone from a shallow repository\");",
          "new_line_content": "\t\tdebug_fd = atoi(getenv(\"GIT_DEBUG_SEND_PACK\"));",
          "content_same": false
        },
        {
          "line": 834,
          "old_api": "getenv",
          "new_api": "upload_pack",
          "old_text": "getenv(\"GIT_DEBUG_SEND_PACK\")",
          "new_text": "upload_pack()",
          "old_line_content": "\tif (getenv(\"GIT_DEBUG_SEND_PACK\"))",
          "new_line_content": "\tupload_pack();",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 518,
          "old_api": null,
          "new_api": "sigchain_push",
          "old_text": null,
          "new_text": "sigchain_push(SIGPIPE, SIG_IGN)",
          "old_line_content": "\t * below.",
          "new_line_content": "\tsigchain_push(SIGPIPE, SIG_IGN);",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": null,
          "new_api": "get_max_object_index",
          "old_text": null,
          "new_text": "get_max_object_index()",
          "old_line_content": "\tnamebuf[0] = '^';",
          "new_line_content": "\tfor (i = get_max_object_index(); 0 < i; ) {",
          "content_same": false
        },
        {
          "line": 523,
          "old_api": null,
          "new_api": "get_indexed_object",
          "old_text": null,
          "new_text": "get_indexed_object(--i)",
          "old_line_content": "\tnamebuf[41] = '\\n';",
          "new_line_content": "\t\to = get_indexed_object(--i);",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(o->sha1)",
          "old_line_content": "\t\tif (!(o->flags & OUR_REF))",
          "new_line_content": "\t\tmemcpy(namebuf + 1, sha1_to_hex(o->sha1), 40);",
          "content_same": false
        },
        {
          "line": 529,
          "old_api": null,
          "new_api": "write_in_full",
          "old_text": null,
          "new_text": "write_in_full(cmd.in, namebuf, 42)",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\tif (write_in_full(cmd.in, namebuf, 42) < 0)",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(o->sha1)",
          "old_line_content": "\t\tif (o->flags & OUR_REF)",
          "new_line_content": "\t\tmemcpy(namebuf, sha1_to_hex(o->sha1), 40);",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": null,
          "new_api": "write_in_full",
          "old_text": null,
          "new_text": "write_in_full(cmd.in, namebuf, 41)",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\tif (write_in_full(cmd.in, namebuf, 41) < 0)",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(cmd.in)",
          "old_line_content": "\t\t\tgoto error;",
          "new_line_content": "\tclose(cmd.in);",
          "content_same": false
        },
        {
          "line": 549,
          "old_api": null,
          "new_api": "read_in_full",
          "old_text": null,
          "new_text": "read_in_full(cmd.out, namebuf, 1)",
          "old_line_content": "\t * our ref.",
          "new_line_content": "\ti = read_in_full(cmd.out, namebuf, 1);",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(cmd.out)",
          "old_line_content": "\tif (i)",
          "new_line_content": "\tclose(cmd.out);",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": null,
          "new_api": "finish_command",
          "old_text": null,
          "new_text": "finish_command(&cmd)",
          "old_line_content": "\t * even when it showed no commit.",
          "new_line_content": "\tif (finish_command(&cmd))",
          "content_same": false
        },
        {
          "line": 570,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"git upload-pack: not our ref %s\",\n\t\t\t    sha1_to_hex(o->sha1))",
          "old_line_content": "\t\to = want_obj.objects[i].item;",
          "new_line_content": "\t\t\tdie(\"git upload-pack: not our ref %s\",",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(o->sha1)",
          "old_line_content": "\t\tif (!(o->flags & OUR_REF))",
          "new_line_content": "\t\t\t    sha1_to_hex(o->sha1));",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": null,
          "new_api": "write_str_in_full",
          "old_text": null,
          "new_text": "write_str_in_full(debug_fd, \"#S\\n\")",
          "old_line_content": "\tshallow_nr = 0;",
          "new_line_content": "\t\twrite_str_in_full(debug_fd, \"#S\\n\");",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": null,
          "new_api": "packet_read_line",
          "old_text": null,
          "new_text": "packet_read_line(0, line, sizeof(line))",
          "old_line_content": "\t\tconst char *features;",
          "new_line_content": "\t\tlen = packet_read_line(0, line, sizeof(line));",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": null,
          "new_api": "reset_timeout",
          "old_text": null,
          "new_text": "reset_timeout()",
          "old_line_content": "\t\tunsigned char sha1_buf[20];",
          "new_line_content": "\t\treset_timeout();",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": null,
          "new_api": "write_in_full",
          "old_text": null,
          "new_text": "write_in_full(debug_fd, line, len)",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\t\twrite_in_full(debug_fd, line, len);",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": null,
          "new_api": "get_sha1",
          "old_text": null,
          "new_text": "get_sha1(line + 8, sha1)",
          "old_line_content": "\t\t\tunsigned char sha1[20];",
          "new_line_content": "\t\t\tif (get_sha1(line + 8, sha1))",
          "content_same": false
        },
        {
          "line": 600,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"invalid shallow line: %s\", line)",
          "old_line_content": "\t\t\tstruct object *object;",
          "new_line_content": "\t\t\t\tdie(\"invalid shallow line: %s\", line);",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "prefixcmp",
          "old_text": null,
          "new_text": "prefixcmp(line, \"deepen \")",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\tif (!prefixcmp(line, \"deepen \")) {",
          "content_same": false
        },
        {
          "line": 615,
          "old_api": null,
          "new_api": "prefixcmp",
          "old_text": null,
          "new_text": "prefixcmp(line, \"want \")",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\tif (prefixcmp(line, \"want \") ||",
          "content_same": false
        },
        {
          "line": 616,
          "old_api": null,
          "new_api": "get_sha1_hex",
          "old_text": null,
          "new_text": "get_sha1_hex(line+5, sha1_buf)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t    get_sha1_hex(line+5, sha1_buf))",
          "content_same": false
        },
        {
          "line": 622,
          "old_api": null,
          "new_api": "parse_feature_request",
          "old_text": null,
          "new_text": "parse_feature_request(features, \"multi_ack_detailed\")",
          "old_line_content": "\t\tfeatures = line + 45;",
          "new_line_content": "\t\tif (parse_feature_request(features, \"multi_ack_detailed\"))",
          "content_same": false
        },
        {
          "line": 641,
          "old_api": null,
          "new_api": "lookup_object",
          "old_text": null,
          "new_text": "lookup_object(sha1_buf)",
          "old_line_content": "\t\t\tuse_include_tag = 1;",
          "new_line_content": "\t\to = lookup_object(sha1_buf);",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(sha1_buf)",
          "old_line_content": "\t\tif (!o)",
          "new_line_content": "\t\t\t    sha1_to_hex(sha1_buf));",
          "content_same": false
        },
        {
          "line": 649,
          "old_api": null,
          "new_api": "add_object_array",
          "old_text": null,
          "new_text": "add_object_array(o, NULL, &want_obj)",
          "old_line_content": "\t\t\tif (!(o->flags & OUR_REF))",
          "new_line_content": "\t\t\tadd_object_array(o, NULL, &want_obj);",
          "content_same": false
        },
        {
          "line": 653,
          "old_api": null,
          "new_api": "write_str_in_full",
          "old_text": null,
          "new_text": "write_str_in_full(debug_fd, \"#E\\n\")",
          "old_line_content": "\t}",
          "new_line_content": "\t\twrite_str_in_full(debug_fd, \"#E\\n\");",
          "content_same": false
        },
        {
          "line": 663,
          "old_api": null,
          "new_api": "check_non_tip",
          "old_text": null,
          "new_text": "check_non_tip()",
          "old_line_content": "\t */",
          "new_line_content": "\t\tcheck_non_tip();",
          "content_same": false
        },
        {
          "line": 673,
          "old_api": null,
          "new_api": "get_shallow_commits",
          "old_text": null,
          "new_text": "get_shallow_commits(&want_obj, depth,\n\t\t\tSHALLOW, NOT_SHALLOW)",
          "old_line_content": "\t\tstruct commit_list *result, *backup;",
          "new_line_content": "\t\tbackup = result = get_shallow_commits(&want_obj, depth,",
          "content_same": false
        },
        {
          "line": 678,
          "old_api": null,
          "new_api": "packet_write",
          "old_text": null,
          "new_text": "packet_write(1, \"shallow %s\",\n\t\t\t\t\t\tsha1_to_hex(object->sha1))",
          "old_line_content": "\t\t\tstruct object *object = &result->item->object;",
          "new_line_content": "\t\t\t\tpacket_write(1, \"shallow %s\",",
          "content_same": false
        },
        {
          "line": 679,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(object->sha1)",
          "old_line_content": "\t\t\tif (!(object->flags & (CLIENT_SHALLOW|NOT_SHALLOW))) {",
          "new_line_content": "\t\t\t\t\t\tsha1_to_hex(object->sha1));",
          "content_same": false
        },
        {
          "line": 685,
          "old_api": null,
          "new_api": "free_commit_list",
          "old_text": null,
          "new_text": "free_commit_list(backup)",
          "old_line_content": "\t\t\tresult = result->next;",
          "new_line_content": "\t\tfree_commit_list(backup);",
          "content_same": false
        },
        {
          "line": 690,
          "old_api": null,
          "new_api": "packet_write",
          "old_text": null,
          "new_text": "packet_write(1, \"unshallow %s\",\n\t\t\t\t\tsha1_to_hex(object->sha1))",
          "old_line_content": "\t\t\tif (object->flags & NOT_SHALLOW) {",
          "new_line_content": "\t\t\t\tpacket_write(1, \"unshallow %s\",",
          "content_same": false
        },
        {
          "line": 691,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(object->sha1)",
          "old_line_content": "\t\t\t\tstruct commit_list *parents;",
          "new_line_content": "\t\t\t\t\tsha1_to_hex(object->sha1));",
          "content_same": false
        },
        {
          "line": 694,
          "old_api": null,
          "new_api": "unregister_shallow",
          "old_text": null,
          "new_text": "unregister_shallow(object->sha1)",
          "old_line_content": "\t\t\t\tobject->flags &= ~CLIENT_SHALLOW;",
          "new_line_content": "\t\t\t\tunregister_shallow(object->sha1);",
          "content_same": false
        },
        {
          "line": 697,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"invalid commit\")",
          "old_line_content": "\t\t\t\tobject->parsed = 0;",
          "new_line_content": "\t\t\t\t\tdie(\"invalid commit\");",
          "content_same": false
        },
        {
          "line": 700,
          "old_api": null,
          "new_api": "add_object_array",
          "old_text": null,
          "new_text": "add_object_array(&parents->item->object,\n\t\t\t\t\t\t\tNULL, &want_obj)",
          "old_line_content": "\t\t\t\tparents = ((struct commit *)object)->parents;",
          "new_line_content": "\t\t\t\t\tadd_object_array(&parents->item->object,",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": null,
          "new_api": "add_object_array",
          "old_text": null,
          "new_text": "add_object_array(object, NULL, &extra_edge_obj)",
          "old_line_content": "\t\t\t\t\tparents = parents->next;",
          "new_line_content": "\t\t\t\tadd_object_array(object, NULL, &extra_edge_obj);",
          "content_same": false
        },
        {
          "line": 707,
          "old_api": null,
          "new_api": "register_shallow",
          "old_text": null,
          "new_text": "register_shallow(object->sha1)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\tregister_shallow(object->sha1);",
          "content_same": false
        },
        {
          "line": 714,
          "old_api": null,
          "new_api": "register_shallow",
          "old_text": null,
          "new_text": "register_shallow(shallows.objects[i].item->sha1)",
          "old_line_content": "\t\t\tint i;",
          "new_line_content": "\t\t\t\tregister_shallow(shallows.objects[i].item->sha1);",
          "content_same": false
        },
        {
          "line": 718,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(shallows.objects)",
          "old_line_content": "",
          "new_line_content": "\tfree(shallows.objects);",
          "content_same": false
        },
        {
          "line": 726,
          "old_api": null,
          "new_api": "lookup_unknown_object",
          "old_text": null,
          "new_text": "lookup_unknown_object(sha1)",
          "old_line_content": "\t\t\" side-band-64k ofs-delta shallow no-progress\"",
          "new_line_content": "\tstruct object *o = lookup_unknown_object(sha1);",
          "content_same": false
        },
        {
          "line": 727,
          "old_api": null,
          "new_api": "strip_namespace",
          "old_text": null,
          "new_text": "strip_namespace(refname)",
          "old_line_content": "\t\t\" include-tag multi_ack_detailed\";",
          "new_line_content": "\tconst char *refname_nons = strip_namespace(refname);",
          "content_same": false
        },
        {
          "line": 731,
          "old_api": null,
          "new_api": "packet_write",
          "old_text": null,
          "new_text": "packet_write(1, \"%s %s%c%s%s agent=%s\\n\",\n\t\t\t     sha1_to_hex(sha1), refname_nons,\n\t\t\t     0, capabilities,\n\t\t\t     stateless_rpc ? \" no-done\" : \"\",\n\t\t\t     git_user_agent_sanitized())",
          "old_line_content": "",
          "new_line_content": "\t\tpacket_write(1, \"%s %s%c%s%s agent=%s\\n\",",
          "content_same": false
        },
        {
          "line": 732,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(sha1)",
          "old_line_content": "\tif (capabilities)",
          "new_line_content": "\t\t\t     sha1_to_hex(sha1), refname_nons,",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": null,
          "new_api": "git_user_agent_sanitized",
          "old_text": null,
          "new_text": "git_user_agent_sanitized()",
          "old_line_content": "\t\t\t     0, capabilities,",
          "new_line_content": "\t\t\t     git_user_agent_sanitized());",
          "content_same": false
        },
        {
          "line": 743,
          "old_api": null,
          "new_api": "peel_ref",
          "old_text": null,
          "new_text": "peel_ref(refname, peeled)",
          "old_line_content": "\t\tnr_our_refs++;",
          "new_line_content": "\tif (!peel_ref(refname, peeled))",
          "content_same": false
        },
        {
          "line": 744,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(peeled)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tpacket_write(1, \"%s %s^{}\\n\", sha1_to_hex(peeled), refname_nons);",
          "content_same": false
        },
        {
          "line": 750,
          "old_api": null,
          "new_api": "parse_object",
          "old_text": null,
          "new_text": "parse_object(sha1)",
          "old_line_content": "static int mark_our_ref(const char *refname, const unsigned char *sha1, int flag, void *cb_data)",
          "new_line_content": "\tstruct object *o = parse_object(sha1);",
          "content_same": false
        },
        {
          "line": 763,
          "old_api": null,
          "new_api": "reset_timeout",
          "old_text": null,
          "new_text": "reset_timeout()",
          "old_line_content": "{",
          "new_line_content": "\t\treset_timeout();",
          "content_same": false
        },
        {
          "line": 764,
          "old_api": null,
          "new_api": "head_ref_namespaced",
          "old_text": null,
          "new_text": "head_ref_namespaced(send_ref, NULL)",
          "old_line_content": "\tif (advertise_refs || !stateless_rpc) {",
          "new_line_content": "\t\thead_ref_namespaced(send_ref, NULL);",
          "content_same": false
        },
        {
          "line": 769,
          "old_api": null,
          "new_api": "for_each_namespaced_ref",
          "old_text": null,
          "new_text": "for_each_namespaced_ref(mark_our_ref, NULL)",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\tfor_each_namespaced_ref(mark_our_ref, NULL);",
          "content_same": false
        },
        {
          "line": 774,
          "old_api": null,
          "new_api": "receive_needs",
          "old_text": null,
          "new_text": "receive_needs()",
          "old_line_content": "\t\treturn;",
          "new_line_content": "\treceive_needs();",
          "content_same": false
        },
        {
          "line": 777,
          "old_api": null,
          "new_api": "create_pack_file",
          "old_text": null,
          "new_text": "create_pack_file()",
          "old_line_content": "\tif (want_obj.nr) {",
          "new_line_content": "\t\tcreate_pack_file();",
          "content_same": false
        },
        {
          "line": 787,
          "old_api": null,
          "new_api": "git_setup_gettext",
          "old_text": null,
          "new_text": "git_setup_gettext()",
          "old_line_content": "\tint strict = 0;",
          "new_line_content": "\tgit_setup_gettext();",
          "content_same": false
        },
        {
          "line": 790,
          "old_api": null,
          "new_api": "git_extract_argv0_path",
          "old_text": null,
          "new_text": "git_extract_argv0_path(argv[0])",
          "old_line_content": "",
          "new_line_content": "\tgit_extract_argv0_path(argv[0]);",
          "content_same": false
        },
        {
          "line": 798,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(arg, \"--advertise-refs\")",
          "old_line_content": "\t\tif (arg[0] != '-')",
          "new_line_content": "\t\tif (!strcmp(arg, \"--advertise-refs\")) {",
          "content_same": false
        },
        {
          "line": 802,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(arg, \"--stateless-rpc\")",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\tif (!strcmp(arg, \"--stateless-rpc\")) {",
          "content_same": false
        },
        {
          "line": 806,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(arg, \"--strict\")",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\tif (!strcmp(arg, \"--strict\")) {",
          "content_same": false
        },
        {
          "line": 810,
          "old_api": null,
          "new_api": "prefixcmp",
          "old_text": null,
          "new_text": "prefixcmp(arg, \"--timeout=\")",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\tif (!prefixcmp(arg, \"--timeout=\")) {",
          "content_same": false
        },
        {
          "line": 811,
          "old_api": null,
          "new_api": "atoi",
          "old_text": null,
          "new_text": "atoi(arg+10)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\ttimeout = atoi(arg+10);",
          "content_same": false
        },
        {
          "line": 815,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(arg, \"--\")",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\tif (!strcmp(arg, \"--\")) {",
          "content_same": false
        },
        {
          "line": 822,
          "old_api": null,
          "new_api": "usage",
          "old_text": null,
          "new_text": "usage(upload_pack_usage)",
          "old_line_content": "",
          "new_line_content": "\t\tusage(upload_pack_usage);",
          "content_same": false
        },
        {
          "line": 828,
          "old_api": null,
          "new_api": "enter_repo",
          "old_text": null,
          "new_text": "enter_repo(dir, strict)",
          "old_line_content": "\tdir = argv[i];",
          "new_line_content": "\tif (!enter_repo(dir, strict))",
          "content_same": false
        },
        {
          "line": 829,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"'%s' does not appear to be a git repository\", dir)",
          "old_line_content": "",
          "new_line_content": "\t\tdie(\"'%s' does not appear to be a git repository\", dir);",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": null,
          "new_api": "add_object_array",
          "old_text": null,
          "new_text": "add_object_array(o, NULL, &have_obj)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tadd_object_array(o, NULL, &have_obj);",
          "content_same": false
        },
        {
          "line": 358,
          "old_api": null,
          "new_api": "commit_list_insert_by_date",
          "old_text": null,
          "new_text": "commit_list_insert_by_date(want, &work)",
          "old_line_content": "\tstruct commit_list *work = NULL;",
          "new_line_content": "\tcommit_list_insert_by_date(want, &work);",
          "content_same": false
        },
        {
          "line": 362,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(work)",
          "old_line_content": "\t\tstruct commit_list *list = work->next;",
          "new_line_content": "\t\tfree(work);",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": null,
          "new_api": "parse_object",
          "old_text": null,
          "new_text": "parse_object(commit->object.sha1)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tparse_object(commit->object.sha1);",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": null,
          "new_api": "commit_list_insert_by_date",
          "old_text": null,
          "new_text": "commit_list_insert_by_date(parent, &work)",
          "old_line_content": "\t\t\tstruct commit *parent = list->item;",
          "new_line_content": "\t\t\t\tcommit_list_insert_by_date(parent, &work);",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": null,
          "new_api": "clear_commit_marks",
          "old_text": null,
          "new_text": "clear_commit_marks(want, REACHABLE)",
          "old_line_content": "\t}",
          "new_line_content": "\tclear_commit_marks(want, REACHABLE);",
          "content_same": false
        },
        {
          "line": 384,
          "old_api": null,
          "new_api": "free_commit_list",
          "old_text": null,
          "new_text": "free_commit_list(work)",
          "old_line_content": "\twant->object.flags |= REACHABLE;",
          "new_line_content": "\tfree_commit_list(work);",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": null,
          "new_api": "deref_tag",
          "old_text": null,
          "new_text": "deref_tag(want, \"a want line\", 0)",
          "old_line_content": "\t\tif (want->flags & COMMON_KNOWN)",
          "new_line_content": "\t\twant = deref_tag(want, \"a want line\", 0);",
          "content_same": false
        },
        {
          "line": 410,
          "old_api": null,
          "new_api": "reachable",
          "old_text": null,
          "new_text": "reachable((struct commit *)want)",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\tif (!reachable((struct commit *)want))",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": null,
          "new_api": "packet_read_line",
          "old_text": null,
          "new_text": "packet_read_line(0, line, sizeof(line))",
          "old_line_content": "",
          "new_line_content": "\t\tint len = packet_read_line(0, line, sizeof(line));",
          "content_same": false
        },
        {
          "line": 429,
          "old_api": null,
          "new_api": "reset_timeout",
          "old_text": null,
          "new_text": "reset_timeout()",
          "old_line_content": "\tfor (;;) {",
          "new_line_content": "\t\treset_timeout();",
          "content_same": false
        },
        {
          "line": 433,
          "old_api": null,
          "new_api": "ok_to_give_up",
          "old_text": null,
          "new_text": "ok_to_give_up()",
          "old_line_content": "\t\tif (!len) {",
          "new_line_content": "\t\t\t    && !got_other && ok_to_give_up()) {",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": null,
          "new_api": "packet_write",
          "old_text": null,
          "new_text": "packet_write(1, \"NAK\\n\")",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tpacket_write(1, \"NAK\\n\");",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": null,
          "new_api": "packet_write",
          "old_text": null,
          "new_text": "packet_write(1, \"ACK %s\\n\", last_hex)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tpacket_write(1, \"ACK %s\\n\", last_hex);",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": null,
          "new_api": "exit",
          "old_text": null,
          "new_text": "exit(0)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\texit(0);",
          "content_same": false
        },
        {
          "line": 450,
          "old_api": null,
          "new_api": "strip",
          "old_text": null,
          "new_text": "strip(line, len)",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\tstrip(line, len);",
          "content_same": false
        },
        {
          "line": 451,
          "old_api": null,
          "new_api": "prefixcmp",
          "old_text": null,
          "new_text": "prefixcmp(line, \"have \")",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tif (!prefixcmp(line, \"have \")) {",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": null,
          "new_api": "ok_to_give_up",
          "old_text": null,
          "new_text": "ok_to_give_up()",
          "old_line_content": "\t\t\tcase -1: /* they have what we do not */",
          "new_line_content": "\t\t\t\tif (multi_ack && ok_to_give_up()) {",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(sha1)",
          "old_line_content": "\t\t\t\tgot_other = 1;",
          "new_line_content": "\t\t\t\t\tconst char *hex = sha1_to_hex(sha1);",
          "content_same": false
        },
        {
          "line": 459,
          "old_api": null,
          "new_api": "packet_write",
          "old_text": null,
          "new_text": "packet_write(1, \"ACK %s ready\\n\", hex)",
          "old_line_content": "\t\t\t\t\tif (multi_ack == 2) {",
          "new_line_content": "\t\t\t\t\t\tpacket_write(1, \"ACK %s ready\\n\", hex);",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": null,
          "new_api": "sha1_to_hex",
          "old_text": null,
          "new_text": "sha1_to_hex(sha1)",
          "old_line_content": "\t\t\tdefault:",
          "new_line_content": "\t\t\t\tmemcpy(last_hex, sha1_to_hex(sha1), 41);",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(line, \"done\")",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\tif (!strcmp(line, \"done\")) {",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": null,
          "new_api": "packet_write",
          "old_text": null,
          "new_text": "packet_write(1, \"ACK %s\\n\", last_hex)",
          "old_line_content": "\t\t\tif (have_obj.nr > 0) {",
          "new_line_content": "\t\t\t\t\tpacket_write(1, \"ACK %s\\n\", last_hex);",
          "content_same": false
        },
        {
          "line": 483,
          "old_api": null,
          "new_api": "packet_write",
          "old_text": null,
          "new_text": "packet_write(1, \"NAK\\n\")",
          "old_line_content": "\t\t\t\treturn 0;",
          "new_line_content": "\t\t\tpacket_write(1, \"NAK\\n\");",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"git upload-pack: expected SHA1 list, got '%s'\", line)",
          "old_line_content": "\t\t\treturn -1;",
          "new_line_content": "\t\tdie(\"git upload-pack: expected SHA1 list, got '%s'\", line);",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": null,
          "new_api": "start_command",
          "old_text": null,
          "new_text": "start_command(&cmd)",
          "old_line_content": "\tcmd.out = -1;",
          "new_line_content": "\tif (start_command(&cmd))",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 512,
          "old_api": "start_command",
          "new_api": null,
          "old_text": "start_command(&cmd)",
          "new_text": null,
          "old_line_content": "\tif (start_command(&cmd))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 520,
          "old_api": "sigchain_push",
          "new_api": null,
          "old_text": "sigchain_push(SIGPIPE, SIG_IGN)",
          "new_text": null,
          "old_line_content": "\tsigchain_push(SIGPIPE, SIG_IGN);",
          "new_line_content": "\tnamebuf[0] = '^';",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": "get_max_object_index",
          "new_api": null,
          "old_text": "get_max_object_index()",
          "new_text": null,
          "old_line_content": "\tfor (i = get_max_object_index(); 0 < i; ) {",
          "new_line_content": "\t\tif (!o)",
          "content_same": false
        },
        {
          "line": 525,
          "old_api": "get_indexed_object",
          "new_api": null,
          "old_text": "get_indexed_object(--i)",
          "new_text": null,
          "old_line_content": "\t\to = get_indexed_object(--i);",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 530,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(o->sha1)",
          "new_text": null,
          "old_line_content": "\t\tmemcpy(namebuf + 1, sha1_to_hex(o->sha1), 40);",
          "new_line_content": "\t\t\tgoto error;",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": "write_in_full",
          "new_api": null,
          "old_text": "write_in_full(cmd.in, namebuf, 42)",
          "new_text": null,
          "old_line_content": "\t\tif (write_in_full(cmd.in, namebuf, 42) < 0)",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(o->sha1)",
          "new_text": null,
          "old_line_content": "\t\tmemcpy(namebuf, sha1_to_hex(o->sha1), 40);",
          "new_line_content": "\t\t\tgoto error;",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": "write_in_full",
          "new_api": null,
          "old_text": "write_in_full(cmd.in, namebuf, 41)",
          "new_text": null,
          "old_line_content": "\t\tif (write_in_full(cmd.in, namebuf, 41) < 0)",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 545,
          "old_api": "sigchain_pop",
          "new_api": null,
          "old_text": "sigchain_pop(SIGPIPE)",
          "new_text": null,
          "old_line_content": "\tsigchain_pop(SIGPIPE);",
          "new_line_content": "\t/*",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": "read_in_full",
          "new_api": null,
          "old_text": "read_in_full(cmd.out, namebuf, 1)",
          "new_text": null,
          "old_line_content": "\ti = read_in_full(cmd.out, namebuf, 1);",
          "new_line_content": "\t\tgoto error;",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(cmd.out)",
          "new_text": null,
          "old_line_content": "\tclose(cmd.out);",
          "new_line_content": "\t/*",
          "content_same": false
        },
        {
          "line": 561,
          "old_api": "finish_command",
          "new_api": null,
          "old_text": "finish_command(&cmd)",
          "new_text": null,
          "old_line_content": "\tif (finish_command(&cmd))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"git upload-pack: not our ref %s\",\n\t\t\t    sha1_to_hex(o->sha1))",
          "new_text": null,
          "old_line_content": "\t\t\tdie(\"git upload-pack: not our ref %s\",",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 573,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(o->sha1)",
          "new_text": null,
          "old_line_content": "\t\t\t    sha1_to_hex(o->sha1));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 586,
          "old_api": "write_str_in_full",
          "new_api": null,
          "old_text": "write_str_in_full(debug_fd, \"#S\\n\")",
          "new_text": null,
          "old_line_content": "\t\twrite_str_in_full(debug_fd, \"#S\\n\");",
          "new_line_content": "\t\tstruct object *o;",
          "content_same": false
        },
        {
          "line": 591,
          "old_api": "packet_read_line",
          "new_api": null,
          "old_text": "packet_read_line(0, line, sizeof(line))",
          "new_text": null,
          "old_line_content": "\t\tlen = packet_read_line(0, line, sizeof(line));",
          "new_line_content": "\t\tif (!len)",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": "reset_timeout",
          "new_api": null,
          "old_text": "reset_timeout()",
          "new_text": null,
          "old_line_content": "\t\treset_timeout();",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": "prefixcmp",
          "new_api": null,
          "old_text": "prefixcmp(line, \"shallow \")",
          "new_text": null,
          "old_line_content": "\t\tif (!prefixcmp(line, \"shallow \")) {",
          "new_line_content": "\t\t\tstruct object *object;",
          "content_same": false
        },
        {
          "line": 602,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"invalid shallow line: %s\", line)",
          "new_text": null,
          "old_line_content": "\t\t\t\tdie(\"invalid shallow line: %s\", line);",
          "new_line_content": "\t\t\tif (!object)",
          "content_same": false
        },
        {
          "line": 607,
          "old_api": "add_object_array",
          "new_api": null,
          "old_text": "add_object_array(object, NULL, &shallows)",
          "new_text": null,
          "old_line_content": "\t\t\tadd_object_array(object, NULL, &shallows);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 614,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"Invalid deepen: %s\", line)",
          "new_text": null,
          "old_line_content": "\t\t\t\tdie(\"Invalid deepen: %s\", line);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": "get_sha1_hex",
          "new_api": null,
          "old_text": "get_sha1_hex(line+5, sha1_buf)",
          "new_text": null,
          "old_line_content": "\t\t    get_sha1_hex(line+5, sha1_buf))",
          "new_line_content": "\t\t\t    \"expected to get sha, not '%s'\", line);",
          "content_same": false
        },
        {
          "line": 619,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"git upload-pack: protocol error, \"\n\t\t\t    \"expected to get sha, not '%s'\", line)",
          "new_text": null,
          "old_line_content": "\t\t\tdie(\"git upload-pack: protocol error, \"",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 640,
          "old_api": "parse_feature_request",
          "new_api": null,
          "old_text": "parse_feature_request(features, \"include-tag\")",
          "new_text": null,
          "old_line_content": "\t\tif (parse_feature_request(features, \"include-tag\"))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 645,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"git upload-pack: not our ref %s\",\n\t\t\t    sha1_to_hex(sha1_buf))",
          "new_text": null,
          "old_line_content": "\t\t\tdie(\"git upload-pack: not our ref %s\",",
          "new_line_content": "\t\tif (!(o->flags & WANTED)) {",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(sha1_buf)",
          "new_text": null,
          "old_line_content": "\t\t\t    sha1_to_hex(sha1_buf));",
          "new_line_content": "\t\t\to->flags |= WANTED;",
          "content_same": false
        },
        {
          "line": 651,
          "old_api": "add_object_array",
          "new_api": null,
          "old_text": "add_object_array(o, NULL, &want_obj)",
          "new_text": null,
          "old_line_content": "\t\t\tadd_object_array(o, NULL, &want_obj);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 655,
          "old_api": "write_str_in_full",
          "new_api": null,
          "old_text": "write_str_in_full(debug_fd, \"#E\\n\")",
          "new_text": null,
          "old_line_content": "\t\twrite_str_in_full(debug_fd, \"#E\\n\");",
          "new_line_content": "\t/*",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": "check_non_tip",
          "new_api": null,
          "old_text": "check_non_tip()",
          "new_text": null,
          "old_line_content": "\t\tcheck_non_tip();",
          "new_line_content": "\tif (!use_sideband && daemon_mode)",
          "content_same": false
        },
        {
          "line": 675,
          "old_api": "get_shallow_commits",
          "new_api": null,
          "old_text": "get_shallow_commits(&want_obj, depth,\n\t\t\tSHALLOW, NOT_SHALLOW)",
          "new_text": null,
          "old_line_content": "\t\tbackup = result = get_shallow_commits(&want_obj, depth,",
          "new_line_content": "\t\twhile (result) {",
          "content_same": false
        },
        {
          "line": 681,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(object->sha1)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tsha1_to_hex(object->sha1));",
          "new_line_content": "\t\t\t\tshallow_nr++;",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": "register_shallow",
          "new_api": null,
          "old_text": "register_shallow(object->sha1)",
          "new_text": null,
          "old_line_content": "\t\t\t\tregister_shallow(object->sha1);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 687,
          "old_api": "free_commit_list",
          "new_api": null,
          "old_text": "free_commit_list(backup)",
          "new_text": null,
          "old_line_content": "\t\tfree_commit_list(backup);",
          "new_line_content": "\t\t\tstruct object *object = shallows.objects[i].item;",
          "content_same": false
        },
        {
          "line": 692,
          "old_api": "packet_write",
          "new_api": null,
          "old_text": "packet_write(1, \"unshallow %s\",\n\t\t\t\t\tsha1_to_hex(object->sha1))",
          "new_text": null,
          "old_line_content": "\t\t\t\tpacket_write(1, \"unshallow %s\",",
          "new_line_content": "\t\t\t\tobject->flags &= ~CLIENT_SHALLOW;",
          "content_same": false
        },
        {
          "line": 693,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(object->sha1)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tsha1_to_hex(object->sha1));",
          "new_line_content": "\t\t\t\t/* make sure the real parents are parsed */",
          "content_same": false
        },
        {
          "line": 698,
          "old_api": "parse_commit",
          "new_api": null,
          "old_text": "parse_commit((struct commit *)object)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (parse_commit((struct commit *)object))",
          "new_line_content": "\t\t\t\tparents = ((struct commit *)object)->parents;",
          "content_same": false
        },
        {
          "line": 699,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"invalid commit\")",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tdie(\"invalid commit\");",
          "new_line_content": "\t\t\t\twhile (parents) {",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": "add_object_array",
          "new_api": null,
          "old_text": "add_object_array(&parents->item->object,\n\t\t\t\t\t\t\tNULL, &want_obj)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tadd_object_array(&parents->item->object,",
          "new_line_content": "\t\t\t\t\tparents = parents->next;",
          "content_same": false
        },
        {
          "line": 706,
          "old_api": "add_object_array",
          "new_api": null,
          "old_text": "add_object_array(object, NULL, &extra_edge_obj)",
          "new_text": null,
          "old_line_content": "\t\t\t\tadd_object_array(object, NULL, &extra_edge_obj);",
          "new_line_content": "\t\t\t/* make sure commit traversal conforms to client */",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": "packet_flush",
          "new_api": null,
          "old_text": "packet_flush(1)",
          "new_text": null,
          "old_line_content": "\t\tpacket_flush(1);",
          "new_line_content": "\t\tif (shallows.nr > 0) {",
          "content_same": false
        },
        {
          "line": 716,
          "old_api": "register_shallow",
          "new_api": null,
          "old_text": "register_shallow(shallows.objects[i].item->sha1)",
          "new_text": null,
          "old_line_content": "\t\t\t\tregister_shallow(shallows.objects[i].item->sha1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 720,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(shallows.objects)",
          "new_text": null,
          "old_line_content": "\tfree(shallows.objects);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "lookup_unknown_object",
          "new_api": null,
          "old_text": "lookup_unknown_object(sha1)",
          "new_text": null,
          "old_line_content": "\tstruct object *o = lookup_unknown_object(sha1);",
          "new_line_content": "\tunsigned char peeled[20];",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": "strip_namespace",
          "new_api": null,
          "old_text": "strip_namespace(refname)",
          "new_text": null,
          "old_line_content": "\tconst char *refname_nons = strip_namespace(refname);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 733,
          "old_api": "packet_write",
          "new_api": null,
          "old_text": "packet_write(1, \"%s %s%c%s%s agent=%s\\n\",\n\t\t\t     sha1_to_hex(sha1), refname_nons,\n\t\t\t     0, capabilities,\n\t\t\t     stateless_rpc ? \" no-done\" : \"\",\n\t\t\t     git_user_agent_sanitized())",
          "new_text": null,
          "old_line_content": "\t\tpacket_write(1, \"%s %s%c%s%s agent=%s\\n\",",
          "new_line_content": "\t\t\t     0, capabilities,",
          "content_same": false
        },
        {
          "line": 734,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(sha1)",
          "new_text": null,
          "old_line_content": "\t\t\t     sha1_to_hex(sha1), refname_nons,",
          "new_line_content": "\t\t\t     stateless_rpc ? \" no-done\" : \"\",",
          "content_same": false
        },
        {
          "line": 739,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(sha1)",
          "new_text": null,
          "old_line_content": "\t\tpacket_write(1, \"%s %s\\n\", sha1_to_hex(sha1), refname_nons);",
          "new_line_content": "\tif (!(o->flags & OUR_REF)) {",
          "content_same": false
        },
        {
          "line": 745,
          "old_api": "peel_ref",
          "new_api": null,
          "old_text": "peel_ref(refname, peeled)",
          "new_text": null,
          "old_line_content": "\tif (!peel_ref(refname, peeled))",
          "new_line_content": "\treturn 0;",
          "content_same": false
        },
        {
          "line": 746,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(peeled)",
          "new_text": null,
          "old_line_content": "\t\tpacket_write(1, \"%s %s^{}\\n\", sha1_to_hex(peeled), refname_nons);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 754,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(sha1)",
          "new_text": null,
          "old_line_content": "\t\tdie(\"git upload-pack: cannot find object %s:\", sha1_to_hex(sha1));",
          "new_line_content": "\t\to->flags |= OUR_REF;",
          "content_same": false
        },
        {
          "line": 767,
          "old_api": "for_each_namespaced_ref",
          "new_api": null,
          "old_text": "for_each_namespaced_ref(send_ref, NULL)",
          "new_text": null,
          "old_line_content": "\t\tfor_each_namespaced_ref(send_ref, NULL);",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 770,
          "old_api": "head_ref_namespaced",
          "new_api": null,
          "old_text": "head_ref_namespaced(mark_our_ref, NULL)",
          "new_text": null,
          "old_line_content": "\t\thead_ref_namespaced(mark_our_ref, NULL);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 771,
          "old_api": "for_each_namespaced_ref",
          "new_api": null,
          "old_text": "for_each_namespaced_ref(mark_our_ref, NULL)",
          "new_text": null,
          "old_line_content": "\t\tfor_each_namespaced_ref(mark_our_ref, NULL);",
          "new_line_content": "\tif (advertise_refs)",
          "content_same": false
        },
        {
          "line": 778,
          "old_api": "get_common_commits",
          "new_api": null,
          "old_text": "get_common_commits()",
          "new_text": null,
          "old_line_content": "\t\tget_common_commits();",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 779,
          "old_api": "create_pack_file",
          "new_api": null,
          "old_text": "create_pack_file()",
          "new_text": null,
          "old_line_content": "\t\tcreate_pack_file();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 791,
          "old_api": "packet_trace_identity",
          "new_api": null,
          "old_text": "packet_trace_identity(\"upload-pack\")",
          "new_text": null,
          "old_line_content": "\tpacket_trace_identity(\"upload-pack\");",
          "new_line_content": "\tread_replace_refs = 0;",
          "content_same": false
        },
        {
          "line": 792,
          "old_api": "git_extract_argv0_path",
          "new_api": null,
          "old_text": "git_extract_argv0_path(argv[0])",
          "new_text": null,
          "old_line_content": "\tgit_extract_argv0_path(argv[0]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 800,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(arg, \"--advertise-refs\")",
          "new_text": null,
          "old_line_content": "\t\tif (!strcmp(arg, \"--advertise-refs\")) {",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 804,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(arg, \"--stateless-rpc\")",
          "new_text": null,
          "old_line_content": "\t\tif (!strcmp(arg, \"--stateless-rpc\")) {",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 808,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(arg, \"--strict\")",
          "new_text": null,
          "old_line_content": "\t\tif (!strcmp(arg, \"--strict\")) {",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 812,
          "old_api": "prefixcmp",
          "new_api": null,
          "old_text": "prefixcmp(arg, \"--timeout=\")",
          "new_text": null,
          "old_line_content": "\t\tif (!prefixcmp(arg, \"--timeout=\")) {",
          "new_line_content": "\t\t\tdaemon_mode = 1;",
          "content_same": false
        },
        {
          "line": 813,
          "old_api": "atoi",
          "new_api": null,
          "old_text": "atoi(arg+10)",
          "new_text": null,
          "old_line_content": "\t\t\ttimeout = atoi(arg+10);",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 817,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(arg, \"--\")",
          "new_text": null,
          "old_line_content": "\t\tif (!strcmp(arg, \"--\")) {",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 826,
          "old_api": "setup_path",
          "new_api": null,
          "old_text": "setup_path()",
          "new_text": null,
          "old_line_content": "\tsetup_path();",
          "new_line_content": "\tdir = argv[i];",
          "content_same": false
        },
        {
          "line": 835,
          "old_api": "getenv",
          "new_api": null,
          "old_text": "getenv(\"GIT_DEBUG_SEND_PACK\")",
          "new_text": null,
          "old_line_content": "\t\tdebug_fd = atoi(getenv(\"GIT_DEBUG_SEND_PACK\"));",
          "new_line_content": "\treturn 0;",
          "content_same": false
        },
        {
          "line": 836,
          "old_api": "upload_pack",
          "new_api": null,
          "old_text": "upload_pack()",
          "new_text": null,
          "old_line_content": "\tupload_pack();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(sha1)",
          "new_text": null,
          "old_line_content": "\t\tdie(\"oops (%s)\", sha1_to_hex(sha1));",
          "new_line_content": "\t\tstruct commit_list *parents;",
          "content_same": false
        },
        {
          "line": 350,
          "old_api": "add_object_array",
          "new_api": null,
          "old_text": "add_object_array(o, NULL, &have_obj)",
          "new_text": null,
          "old_line_content": "\t\tadd_object_array(o, NULL, &have_obj);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": "commit_list_insert_by_date",
          "new_api": null,
          "old_text": "commit_list_insert_by_date(want, &work)",
          "new_text": null,
          "old_line_content": "\tcommit_list_insert_by_date(want, &work);",
          "new_line_content": "\t\tstruct commit_list *list = work->next;",
          "content_same": false
        },
        {
          "line": 364,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(work)",
          "new_text": null,
          "old_line_content": "\t\tfree(work);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": "parse_object",
          "new_api": null,
          "old_text": "parse_object(commit->object.sha1)",
          "new_text": null,
          "old_line_content": "\t\t\tparse_object(commit->object.sha1);",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": "commit_list_insert_by_date",
          "new_api": null,
          "old_text": "commit_list_insert_by_date(parent, &work)",
          "new_text": null,
          "old_line_content": "\t\t\t\tcommit_list_insert_by_date(parent, &work);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": "clear_commit_marks",
          "new_api": null,
          "old_text": "clear_commit_marks(want, REACHABLE)",
          "new_text": null,
          "old_line_content": "\tclear_commit_marks(want, REACHABLE);",
          "new_line_content": "\treturn (want->object.flags & COMMON_KNOWN);",
          "content_same": false
        },
        {
          "line": 386,
          "old_api": "free_commit_list",
          "new_api": null,
          "old_text": "free_commit_list(work)",
          "new_text": null,
          "old_line_content": "\tfree_commit_list(work);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": "deref_tag",
          "new_api": null,
          "old_text": "deref_tag(want, \"a want line\", 0)",
          "new_text": null,
          "old_line_content": "\t\twant = deref_tag(want, \"a want line\", 0);",
          "new_line_content": "\t\t\t/* no way to tell if this is reachable by",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": "reachable",
          "new_api": null,
          "old_text": "reachable((struct commit *)want)",
          "new_text": null,
          "old_line_content": "\t\tif (!reachable((struct commit *)want))",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 430,
          "old_api": "packet_read_line",
          "new_api": null,
          "old_text": "packet_read_line(0, line, sizeof(line))",
          "new_text": null,
          "old_line_content": "\t\tint len = packet_read_line(0, line, sizeof(line));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": "reset_timeout",
          "new_api": null,
          "old_text": "reset_timeout()",
          "new_text": null,
          "old_line_content": "\t\treset_timeout();",
          "new_line_content": "\t\tif (!len) {",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "packet_write",
          "new_api": null,
          "old_text": "packet_write(1, \"ACK %s ready\\n\", last_hex)",
          "new_text": null,
          "old_line_content": "\t\t\t\tpacket_write(1, \"ACK %s ready\\n\", last_hex);",
          "new_line_content": "\t\t\tif (have_obj.nr == 0 || multi_ack)",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": "packet_write",
          "new_api": null,
          "old_text": "packet_write(1, \"NAK\\n\")",
          "new_text": null,
          "old_line_content": "\t\t\t\tpacket_write(1, \"NAK\\n\");",
          "new_line_content": "\t\t\tif (no_done && sent_ready) {",
          "content_same": false
        },
        {
          "line": 443,
          "old_api": "packet_write",
          "new_api": null,
          "old_text": "packet_write(1, \"ACK %s\\n\", last_hex)",
          "new_text": null,
          "old_line_content": "\t\t\t\tpacket_write(1, \"ACK %s\\n\", last_hex);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 447,
          "old_api": "exit",
          "new_api": null,
          "old_text": "exit(0)",
          "new_text": null,
          "old_line_content": "\t\t\t\texit(0);",
          "new_line_content": "\t\t\tgot_other = 0;",
          "content_same": false
        },
        {
          "line": 453,
          "old_api": "prefixcmp",
          "new_api": null,
          "old_text": "prefixcmp(line, \"have \")",
          "new_text": null,
          "old_line_content": "\t\tif (!prefixcmp(line, \"have \")) {",
          "new_line_content": "\t\t\tcase -1: /* they have what we do not */",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": "got_sha1",
          "new_api": null,
          "old_text": "got_sha1(line+5, sha1)",
          "new_text": null,
          "old_line_content": "\t\t\tswitch (got_sha1(line+5, sha1)) {",
          "new_line_content": "\t\t\t\tgot_other = 1;",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": "ok_to_give_up",
          "new_api": null,
          "old_text": "ok_to_give_up()",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (multi_ack && ok_to_give_up()) {",
          "new_line_content": "\t\t\t\t\tif (multi_ack == 2) {",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": "sha1_to_hex",
          "new_api": null,
          "old_text": "sha1_to_hex(sha1)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tconst char *hex = sha1_to_hex(sha1);",
          "new_line_content": "\t\t\t\t\t\tsent_ready = 1;",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "packet_write",
          "new_api": null,
          "old_text": "packet_write(1, \"ACK %s continue\\n\", hex)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\t\tpacket_write(1, \"ACK %s continue\\n\", hex);",
          "new_line_content": "\t\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": "packet_write",
          "new_api": null,
          "old_text": "packet_write(1, \"ACK %s\\n\", last_hex)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tpacket_write(1, \"ACK %s\\n\", last_hex);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(line, \"done\")",
          "new_text": null,
          "old_line_content": "\t\tif (!strcmp(line, \"done\")) {",
          "new_line_content": "\t\t\t\tif (multi_ack)",
          "content_same": false
        },
        {
          "line": 482,
          "old_api": "packet_write",
          "new_api": null,
          "old_text": "packet_write(1, \"ACK %s\\n\", last_hex)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tpacket_write(1, \"ACK %s\\n\", last_hex);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": "packet_write",
          "new_api": null,
          "old_text": "packet_write(1, \"NAK\\n\")",
          "new_text": null,
          "old_line_content": "\t\t\tpacket_write(1, \"NAK\\n\");",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"git upload-pack: expected SHA1 list, got '%s'\", line)",
          "new_text": null,
          "old_line_content": "\t\tdie(\"git upload-pack: expected SHA1 list, got '%s'\", line);",
          "new_line_content": "}",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 29,
      "total_additions": 91,
      "total_deletions": 92,
      "total_api_changes": 212
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 212,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          331
        ]
      }
    },
    "api_calls_before": 205,
    "api_calls_after": 204,
    "diff_info": {
      "added_lines": 1,
      "removed_lines": 3,
      "total_diff_lines": 16
    }
  }
}