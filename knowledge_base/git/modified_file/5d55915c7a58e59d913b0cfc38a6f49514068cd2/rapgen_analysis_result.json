{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/5d55915c7a58e59d913b0cfc38a6f49514068cd2",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/5d55915c7a58e59d913b0cfc38a6f49514068cd2/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/5d55915c7a58e59d913b0cfc38a6f49514068cd2/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/5d55915c7a58e59d913b0cfc38a6f49514068cd2/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 494,
          "old_api": "get_merge_bases",
          "new_api": "rp_error",
          "old_text": "get_merge_bases(old_commit, new_commit, 1)",
          "new_text": "rp_error(\"denying non-fast-forward %s\"\n\t\t\t\t \" (you should pull first)\", name)",
          "old_line_content": "\t\tbases = get_merge_bases(old_commit, new_commit, 1);",
          "new_line_content": "\t\t\trp_error(\"denying non-fast-forward %s\"",
          "content_same": false
        },
        {
          "line": 505,
          "old_api": "run_update_hook",
          "new_api": "parse_object",
          "old_text": "run_update_hook(cmd)",
          "new_text": "parse_object(old_sha1)",
          "old_line_content": "\tif (run_update_hook(cmd)) {",
          "new_line_content": "\t\tif (!parse_object(old_sha1)) {",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": "is_null_sha1",
          "new_api": "rp_warning",
          "old_text": "is_null_sha1(new_sha1)",
          "new_text": "rp_warning(\"Deleting a non-existent ref.\")",
          "old_line_content": "\tif (is_null_sha1(new_sha1)) {",
          "new_line_content": "\t\t\t\trp_warning(\"Deleting a non-existent ref.\");",
          "content_same": false
        },
        {
          "line": 514,
          "old_api": "rp_warning",
          "new_api": "delete_ref",
          "old_text": "rp_warning(\"Allowing deletion of corrupt ref.\")",
          "new_text": "delete_ref(namespaced_name, old_sha1, 0)",
          "old_line_content": "\t\t\t\trp_warning(\"Allowing deletion of corrupt ref.\");",
          "new_line_content": "\t\tif (delete_ref(namespaced_name, old_sha1, 0)) {",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": "rp_error",
          "new_api": "lock_any_ref_for_update",
          "old_text": "rp_error(\"failed to delete %s\", name)",
          "new_text": "lock_any_ref_for_update(namespaced_name, old_sha1, 0)",
          "old_line_content": "\t\t\trp_error(\"failed to delete %s\", name);",
          "new_line_content": "\t\tlock = lock_any_ref_for_update(namespaced_name, old_sha1, 0);",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": "strcpy",
          "new_api": "memset",
          "old_text": "strcpy(p, cmd->ref_name)",
          "new_text": "memset(&proc, 0, sizeof(proc))",
          "old_line_content": "\t\tstrcpy(p, cmd->ref_name);",
          "new_line_content": "\tmemset(&proc, 0, sizeof(proc));",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "memset",
          "new_api": "start_command",
          "old_text": "memset(&proc, 0, sizeof(proc))",
          "new_text": "start_command(&proc)",
          "old_line_content": "\tmemset(&proc, 0, sizeof(proc));",
          "new_line_content": "\tif (!start_command(&proc)) {",
          "content_same": false
        },
        {
          "line": 593,
          "old_api": "resolve_ref_unsafe",
          "new_api": "strip_namespace",
          "old_text": "resolve_ref_unsafe(buf.buf, sha1, 0, &flag)",
          "new_text": "strip_namespace(dst_name)",
          "old_line_content": "\tdst_name = resolve_ref_unsafe(buf.buf, sha1, 0, &flag);",
          "new_line_content": "\tdst_name = strip_namespace(dst_name);",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": "rp_error",
          "new_api": "string_list_lookup",
          "old_text": "rp_error(\"refusing update to broken symref '%s'\", cmd->ref_name)",
          "new_text": "string_list_lookup(list, dst_name)",
          "old_line_content": "\t\trp_error(\"refusing update to broken symref '%s'\", cmd->ref_name);",
          "new_line_content": "\tif ((item = string_list_lookup(list, dst_name)) == NULL)",
          "content_same": false
        },
        {
          "line": 614,
          "old_api": "hashcmp",
          "new_api": "find_unique_abbrev",
          "old_text": "hashcmp(cmd->old_sha1, dst_cmd->old_sha1)",
          "new_text": "find_unique_abbrev(cmd->old_sha1, DEFAULT_ABBREV)",
          "old_line_content": "\tif (!hashcmp(cmd->old_sha1, dst_cmd->old_sha1) &&",
          "new_line_content": "\tstrcpy(cmd_oldh, find_unique_abbrev(cmd->old_sha1, DEFAULT_ABBREV));",
          "content_same": false
        },
        {
          "line": 615,
          "old_api": "hashcmp",
          "new_api": "find_unique_abbrev",
          "old_text": "hashcmp(cmd->new_sha1, dst_cmd->new_sha1)",
          "new_text": "find_unique_abbrev(cmd->new_sha1, DEFAULT_ABBREV)",
          "old_line_content": "\t    !hashcmp(cmd->new_sha1, dst_cmd->new_sha1))",
          "new_line_content": "\tstrcpy(cmd_newh, find_unique_abbrev(cmd->new_sha1, DEFAULT_ABBREV));",
          "content_same": false
        },
        {
          "line": 754,
          "old_api": "get_sha1_hex",
          "new_api": "strlen",
          "old_text": "get_sha1_hex(line, old_sha1)",
          "new_text": "strlen(refname)",
          "old_line_content": "\t\t    get_sha1_hex(line, old_sha1) ||",
          "new_line_content": "\t\treflen = strlen(refname);",
          "content_same": false
        },
        {
          "line": 765,
          "old_api": "parse_feature_request",
          "new_api": "hashcpy",
          "old_text": "parse_feature_request(feature_list, \"side-band-64k\")",
          "new_text": "hashcpy(cmd->old_sha1, old_sha1)",
          "old_line_content": "\t\t\tif (parse_feature_request(feature_list, \"side-band-64k\"))",
          "new_line_content": "\t\thashcpy(cmd->old_sha1, old_sha1);",
          "content_same": false
        },
        {
          "line": 767,
          "old_api": "parse_feature_request",
          "new_api": "memcpy",
          "old_text": "parse_feature_request(feature_list, \"quiet\")",
          "new_text": "memcpy(cmd->ref_name, line + 82, len - 81)",
          "old_line_content": "\t\t\tif (parse_feature_request(feature_list, \"quiet\"))",
          "new_line_content": "\t\tmemcpy(cmd->ref_name, line + 82, len - 81);",
          "content_same": false
        },
        {
          "line": 856,
          "old_api": "start_command",
          "new_api": "finish_command",
          "old_text": "start_command(&ip)",
          "new_text": "finish_command(&ip)",
          "old_line_content": "\t\tstatus = start_command(&ip);",
          "new_line_content": "\t\tstatus = finish_command(&ip);",
          "content_same": false
        },
        {
          "line": 880,
          "old_api": "packet_buf_write",
          "new_api": "packet_buf_flush",
          "old_text": "packet_buf_write(&buf, \"ok %s\\n\",\n\t\t\t\t\t cmd->ref_name)",
          "new_text": "packet_buf_flush(&buf)",
          "old_line_content": "\t\t\tpacket_buf_write(&buf, \"ok %s\\n\",",
          "new_line_content": "\tpacket_buf_flush(&buf);",
          "content_same": false
        },
        {
          "line": 883,
          "old_api": "packet_buf_write",
          "new_api": "send_sideband",
          "old_text": "packet_buf_write(&buf, \"ng %s %s\\n\",\n\t\t\t\t\t cmd->ref_name, cmd->error_string)",
          "new_text": "send_sideband(1, 1, buf.buf, buf.len, use_sideband)",
          "old_line_content": "\t\t\tpacket_buf_write(&buf, \"ng %s %s\\n\",",
          "new_line_content": "\t\tsend_sideband(1, 1, buf.buf, buf.len, use_sideband);",
          "content_same": false
        },
        {
          "line": 886,
          "old_api": "packet_buf_flush",
          "new_api": "strbuf_release",
          "old_text": "packet_buf_flush(&buf)",
          "new_text": "strbuf_release(&buf)",
          "old_line_content": "\tpacket_buf_flush(&buf);",
          "new_line_content": "\tstrbuf_release(&buf);",
          "content_same": false
        },
        {
          "line": 937,
          "old_api": "usage",
          "new_api": "setup_path",
          "old_text": "usage(receive_pack_usage)",
          "new_text": "setup_path()",
          "old_line_content": "\t\t\tusage(receive_pack_usage);",
          "new_line_content": "\tsetup_path();",
          "content_same": false
        },
        {
          "line": 943,
          "old_api": "setup_path",
          "new_api": "die",
          "old_text": "setup_path()",
          "new_text": "die(\"attempt to push into a shallow repository\")",
          "old_line_content": "\tsetup_path();",
          "new_line_content": "\t\tdie(\"attempt to push into a shallow repository\");",
          "content_same": false
        },
        {
          "line": 945,
          "old_api": "enter_repo",
          "new_api": "git_config",
          "old_text": "enter_repo(dir, 0)",
          "new_text": "git_config(receive_pack_config, NULL)",
          "old_line_content": "\tif (!enter_repo(dir, 0))",
          "new_line_content": "\tgit_config(receive_pack_config, NULL);",
          "content_same": false
        },
        {
          "line": 967,
          "old_api": "delete_only",
          "new_api": "report",
          "old_text": "delete_only(commands)",
          "new_text": "report(commands, unpack_status)",
          "old_line_content": "\t\tif (!delete_only(commands))",
          "new_line_content": "\t\t\treport(commands, unpack_status);",
          "content_same": false
        },
        {
          "line": 968,
          "old_api": "unpack",
          "new_api": "run_receive_hook",
          "old_text": "unpack()",
          "new_text": "run_receive_hook(commands, post_receive_hook, 1)",
          "old_line_content": "\t\t\tunpack_status = unpack();",
          "new_line_content": "\t\trun_receive_hook(commands, post_receive_hook, 1);",
          "content_same": false
        },
        {
          "line": 969,
          "old_api": "execute_commands",
          "new_api": "run_update_post_hook",
          "old_text": "execute_commands(commands, unpack_status)",
          "new_text": "run_update_post_hook(commands)",
          "old_line_content": "\t\texecute_commands(commands, unpack_status);",
          "new_line_content": "\t\trun_update_post_hook(commands);",
          "content_same": false
        },
        {
          "line": 974,
          "old_api": "run_receive_hook",
          "new_api": "run_command_v_opt",
          "old_text": "run_receive_hook(commands, post_receive_hook, 1)",
          "new_text": "run_command_v_opt(argv_gc_auto, RUN_GIT_CMD)",
          "old_line_content": "\t\trun_receive_hook(commands, post_receive_hook, 1);",
          "new_line_content": "\t\t\trun_command_v_opt(argv_gc_auto, RUN_GIT_CMD);",
          "content_same": false
        },
        {
          "line": 980,
          "old_api": "run_command_v_opt",
          "new_api": "packet_flush",
          "old_text": "run_command_v_opt(argv_gc_auto, RUN_GIT_CMD)",
          "new_text": "packet_flush(1)",
          "old_line_content": "\t\t\trun_command_v_opt(argv_gc_auto, RUN_GIT_CMD);",
          "new_line_content": "\t\tpacket_flush(1);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 515,
          "old_api": null,
          "new_api": "rp_error",
          "old_text": null,
          "new_text": "rp_error(\"failed to delete %s\", name)",
          "old_line_content": "\t\t\t} else {",
          "new_line_content": "\t\t\trp_error(\"failed to delete %s\", name);",
          "content_same": false
        },
        {
          "line": 523,
          "old_api": null,
          "new_api": "rp_error",
          "old_text": null,
          "new_text": "rp_error(\"failed to lock %s\", name)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\trp_error(\"failed to lock %s\", name);",
          "content_same": false
        },
        {
          "line": 526,
          "old_api": null,
          "new_api": "write_ref_sha1",
          "old_text": null,
          "new_text": "write_ref_sha1(lock, new_sha1, \"push\")",
          "old_line_content": "\telse {",
          "new_line_content": "\t\tif (write_ref_sha1(lock, new_sha1, \"push\")) {",
          "content_same": false
        },
        {
          "line": 547,
          "old_api": null,
          "new_api": "access",
          "old_text": null,
          "new_text": "access(update_post_hook, X_OK)",
          "old_line_content": "",
          "new_line_content": "\tif (!argc || access(update_post_hook, X_OK) < 0)",
          "content_same": false
        },
        {
          "line": 549,
          "old_api": null,
          "new_api": "xmalloc",
          "old_text": null,
          "new_text": "xmalloc(sizeof(*argv) * (2 + argc))",
          "old_line_content": "\t\tif (cmd->error_string || cmd->did_not_exist)",
          "new_line_content": "\targv = xmalloc(sizeof(*argv) * (2 + argc));",
          "content_same": false
        },
        {
          "line": 556,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(cmd->ref_name)",
          "old_line_content": "\targv[0] = update_post_hook;",
          "new_line_content": "\t\tp = xmalloc(strlen(cmd->ref_name) + 1);",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": null,
          "new_api": "strcpy",
          "old_text": null,
          "new_text": "strcpy(p, cmd->ref_name)",
          "old_line_content": "",
          "new_line_content": "\t\tstrcpy(p, cmd->ref_name);",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": null,
          "new_api": "copy_to_sideband",
          "old_text": null,
          "new_text": "copy_to_sideband(proc.err, -1, NULL)",
          "old_line_content": "\tproc.stdout_to_stderr = 1;",
          "new_line_content": "\t\t\tcopy_to_sideband(proc.err, -1, NULL);",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": null,
          "new_api": "finish_command",
          "old_text": null,
          "new_text": "finish_command(&proc)",
          "old_line_content": "\tproc.err = use_sideband ? -1 : 0;",
          "new_line_content": "\t\tfinish_command(&proc);",
          "content_same": false
        },
        {
          "line": 586,
          "old_api": null,
          "new_api": "get_git_namespace",
          "old_text": null,
          "new_text": "get_git_namespace()",
          "old_line_content": "\tstruct string_list_item *item;",
          "new_line_content": "\tstrbuf_addf(&buf, \"%s%s\", get_git_namespace(), cmd->ref_name);",
          "content_same": false
        },
        {
          "line": 587,
          "old_api": null,
          "new_api": "resolve_ref_unsafe",
          "old_text": null,
          "new_text": "resolve_ref_unsafe(buf.buf, sha1, 0, &flag)",
          "old_line_content": "\tstruct command *dst_cmd;",
          "new_line_content": "\tdst_name = resolve_ref_unsafe(buf.buf, sha1, 0, &flag);",
          "content_same": false
        },
        {
          "line": 588,
          "old_api": null,
          "new_api": "strbuf_release",
          "old_text": null,
          "new_text": "strbuf_release(&buf)",
          "old_line_content": "\tunsigned char sha1[20];",
          "new_line_content": "\tstrbuf_release(&buf);",
          "content_same": false
        },
        {
          "line": 595,
          "old_api": null,
          "new_api": "rp_error",
          "old_text": null,
          "new_text": "rp_error(\"refusing update to broken symref '%s'\", cmd->ref_name)",
          "old_line_content": "",
          "new_line_content": "\t\trp_error(\"refusing update to broken symref '%s'\", cmd->ref_name);",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "hashcmp",
          "old_text": null,
          "new_text": "hashcmp(cmd->old_sha1, dst_cmd->old_sha1)",
          "old_line_content": "\t\treturn;",
          "new_line_content": "\tif (!hashcmp(cmd->old_sha1, dst_cmd->old_sha1) &&",
          "content_same": false
        },
        {
          "line": 609,
          "old_api": null,
          "new_api": "hashcmp",
          "old_text": null,
          "new_text": "hashcmp(cmd->new_sha1, dst_cmd->new_sha1)",
          "old_line_content": "",
          "new_line_content": "\t    !hashcmp(cmd->new_sha1, dst_cmd->new_sha1))",
          "content_same": false
        },
        {
          "line": 616,
          "old_api": null,
          "new_api": "find_unique_abbrev",
          "old_text": null,
          "new_text": "find_unique_abbrev(dst_cmd->old_sha1, DEFAULT_ABBREV)",
          "old_line_content": "\t\treturn;",
          "new_line_content": "\tstrcpy(dst_oldh, find_unique_abbrev(dst_cmd->old_sha1, DEFAULT_ABBREV));",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": null,
          "new_api": "find_unique_abbrev",
          "old_text": null,
          "new_text": "find_unique_abbrev(dst_cmd->new_sha1, DEFAULT_ABBREV)",
          "old_line_content": "",
          "new_line_content": "\tstrcpy(dst_newh, find_unique_abbrev(dst_cmd->new_sha1, DEFAULT_ABBREV));",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": null,
          "new_api": "rp_error",
          "old_text": null,
          "new_text": "rp_error(\"refusing inconsistent update between symref '%s' (%s..%s) and\"\n\t\t \" its target '%s' (%s..%s)\",\n\t\t cmd->ref_name, cmd_oldh, cmd_newh,\n\t\t dst_cmd->ref_name, dst_oldh, dst_newh)",
          "old_line_content": "\tdst_cmd->skip_update = 1;",
          "new_line_content": "\trp_error(\"refusing inconsistent update between symref '%s' (%s..%s) and\"",
          "content_same": false
        },
        {
          "line": 634,
          "old_api": null,
          "new_api": "string_list_append",
          "old_text": null,
          "new_text": "string_list_append(&ref_list, cmd->ref_name)",
          "old_line_content": "{",
          "new_line_content": "\t\t\tstring_list_append(&ref_list, cmd->ref_name);",
          "content_same": false
        },
        {
          "line": 637,
          "old_api": null,
          "new_api": "sort_string_list",
          "old_text": null,
          "new_text": "sort_string_list(&ref_list)",
          "old_line_content": "",
          "new_line_content": "\tsort_string_list(&ref_list);",
          "content_same": false
        },
        {
          "line": 641,
          "old_api": null,
          "new_api": "check_aliased_update",
          "old_text": null,
          "new_text": "check_aliased_update(cmd, &ref_list)",
          "old_line_content": "\t\titem->util = (void *)cmd;",
          "new_line_content": "\t\t\tcheck_aliased_update(cmd, &ref_list);",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": null,
          "new_api": "string_list_clear",
          "old_text": null,
          "new_text": "string_list_clear(&ref_list, 0)",
          "old_line_content": "",
          "new_line_content": "\tstring_list_clear(&ref_list, 0);",
          "content_same": false
        },
        {
          "line": 652,
          "old_api": null,
          "new_api": "is_null_sha1",
          "old_text": null,
          "new_text": "is_null_sha1(cmd->new_sha1)",
          "old_line_content": "",
          "new_line_content": "\tif (!cmd || is_null_sha1(cmd->new_sha1))",
          "content_same": false
        },
        {
          "line": 655,
          "old_api": null,
          "new_api": "hashcpy",
          "old_text": null,
          "new_text": "hashcpy(sha1, cmd->new_sha1)",
          "old_line_content": "\tstruct command **cmd_list = cb_data;",
          "new_line_content": "\thashcpy(sha1, cmd->new_sha1);",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": null,
          "new_api": "check_everything_connected",
          "old_text": null,
          "new_text": "check_everything_connected(command_singleton_iterator,\n\t\t\t\t\t\t0, &singleton)",
          "old_line_content": "static void set_connectivity_errors(struct command *commands)",
          "new_line_content": "\t\tif (!check_everything_connected(command_singleton_iterator,",
          "content_same": false
        },
        {
          "line": 678,
          "old_api": null,
          "new_api": "is_null_sha1",
          "old_text": null,
          "new_text": "is_null_sha1(cmd->new_sha1)",
          "old_line_content": "static int iterate_receive_command_list(void *cb_data, unsigned char sha1[20])",
          "new_line_content": "\t\tif (!is_null_sha1(cmd->new_sha1)) {",
          "content_same": false
        },
        {
          "line": 679,
          "old_api": null,
          "new_api": "hashcpy",
          "old_text": null,
          "new_text": "hashcpy(sha1, cmd->new_sha1)",
          "old_line_content": "{",
          "new_line_content": "\t\t\thashcpy(sha1, cmd->new_sha1);",
          "content_same": false
        },
        {
          "line": 701,
          "old_api": null,
          "new_api": "check_everything_connected",
          "old_text": null,
          "new_text": "check_everything_connected(iterate_receive_command_list,\n\t\t\t\t       0, &cmd)",
          "old_line_content": "\t\tfor (cmd = commands; cmd; cmd = cmd->next)",
          "new_line_content": "\tif (check_everything_connected(iterate_receive_command_list,",
          "content_same": false
        },
        {
          "line": 703,
          "old_api": null,
          "new_api": "set_connectivity_errors",
          "old_text": null,
          "new_text": "set_connectivity_errors(commands)",
          "old_line_content": "\t\treturn;",
          "new_line_content": "\t\tset_connectivity_errors(commands);",
          "content_same": false
        },
        {
          "line": 705,
          "old_api": null,
          "new_api": "run_receive_hook",
          "old_text": null,
          "new_text": "run_receive_hook(commands, pre_receive_hook, 0)",
          "old_line_content": "",
          "new_line_content": "\tif (run_receive_hook(commands, pre_receive_hook, 0)) {",
          "content_same": false
        },
        {
          "line": 713,
          "old_api": null,
          "new_api": "check_aliased_updates",
          "old_text": null,
          "new_text": "check_aliased_updates(commands)",
          "old_line_content": "\t\t\tif (!cmd->error_string)",
          "new_line_content": "\tcheck_aliased_updates(commands);",
          "content_same": false
        },
        {
          "line": 715,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(head_name_to_free)",
          "old_line_content": "\t\t}",
          "new_line_content": "\tfree(head_name_to_free);",
          "content_same": false
        },
        {
          "line": 716,
          "old_api": null,
          "new_api": "resolve_refdup",
          "old_text": null,
          "new_text": "resolve_refdup(\"HEAD\", sha1, 0, NULL)",
          "old_line_content": "\t\treturn;",
          "new_line_content": "\thead_name = head_name_to_free = resolve_refdup(\"HEAD\", sha1, 0, NULL);",
          "content_same": false
        },
        {
          "line": 725,
          "old_api": null,
          "new_api": "update",
          "old_text": null,
          "new_text": "update(cmd)",
          "old_line_content": "\t\tif (cmd->error_string)",
          "new_line_content": "\t\tcmd->error_string = update(cmd);",
          "content_same": false
        },
        {
          "line": 740,
          "old_api": null,
          "new_api": "packet_read_line",
          "old_text": null,
          "new_text": "packet_read_line(0, line, sizeof(line))",
          "old_line_content": "\t\tstatic char line[1000];",
          "new_line_content": "\t\tlen = packet_read_line(0, line, sizeof(line));",
          "content_same": false
        },
        {
          "line": 748,
          "old_api": null,
          "new_api": "get_sha1_hex",
          "old_text": null,
          "new_text": "get_sha1_hex(line, old_sha1)",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\t    get_sha1_hex(line, old_sha1) ||",
          "content_same": false
        },
        {
          "line": 749,
          "old_api": null,
          "new_api": "get_sha1_hex",
          "old_text": null,
          "new_text": "get_sha1_hex(line + 41, new_sha1)",
          "old_line_content": "\t\tif (line[len-1] == '\\n')",
          "new_line_content": "\t\t    get_sha1_hex(line + 41, new_sha1))",
          "content_same": false
        },
        {
          "line": 750,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"protocol error: expected old/new/ref, got '%s'\",\n\t\t\t    line)",
          "old_line_content": "\t\t\tline[--len] = 0;",
          "new_line_content": "\t\t\tdie(\"protocol error: expected old/new/ref, got '%s'\",",
          "content_same": false
        },
        {
          "line": 757,
          "old_api": null,
          "new_api": "parse_feature_request",
          "old_text": null,
          "new_text": "parse_feature_request(feature_list, \"report-status\")",
          "old_line_content": "\t\t\t    line);",
          "new_line_content": "\t\t\tif (parse_feature_request(feature_list, \"report-status\"))",
          "content_same": false
        },
        {
          "line": 759,
          "old_api": null,
          "new_api": "parse_feature_request",
          "old_text": null,
          "new_text": "parse_feature_request(feature_list, \"side-band-64k\")",
          "old_line_content": "\t\trefname = line + 82;",
          "new_line_content": "\t\t\tif (parse_feature_request(feature_list, \"side-band-64k\"))",
          "content_same": false
        },
        {
          "line": 761,
          "old_api": null,
          "new_api": "parse_feature_request",
          "old_text": null,
          "new_text": "parse_feature_request(feature_list, \"quiet\")",
          "old_line_content": "\t\tif (reflen + 82 < len) {",
          "new_line_content": "\t\t\tif (parse_feature_request(feature_list, \"quiet\"))",
          "content_same": false
        },
        {
          "line": 764,
          "old_api": null,
          "new_api": "xcalloc",
          "old_text": null,
          "new_text": "xcalloc(1, sizeof(struct command) + len - 80)",
          "old_line_content": "\t\t\t\treport_status = 1;",
          "new_line_content": "\t\tcmd = xcalloc(1, sizeof(struct command) + len - 80);",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": null,
          "new_api": "hashcpy",
          "old_text": null,
          "new_text": "hashcpy(cmd->new_sha1, new_sha1)",
          "old_line_content": "\t\t\t\tuse_sideband = LARGE_PACKET_MAX;",
          "new_line_content": "\t\thashcpy(cmd->new_sha1, new_sha1);",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": null,
          "new_api": "read_pack_header",
          "old_text": null,
          "new_text": "read_pack_header(0, hdr)",
          "old_line_content": "\t}",
          "new_line_content": "\tswitch (read_pack_header(0, hdr)) {",
          "content_same": false
        },
        {
          "line": 807,
          "old_api": null,
          "new_api": "parse_pack_header",
          "old_text": null,
          "new_text": "parse_pack_header(&hdr)",
          "old_line_content": "\tint fsck_objects = (receive_fsck_objects >= 0",
          "new_line_content": "\thdr_err = parse_pack_header(&hdr);",
          "content_same": false
        },
        {
          "line": 810,
          "old_api": null,
          "new_api": "snprintf",
          "old_text": null,
          "new_text": "snprintf(hdr_arg, sizeof(hdr_arg),\n\t\t\t\"--pack_header=%\"PRIu32\",%\"PRIu32,\n\t\t\tntohl(hdr.hdr_version), ntohl(hdr.hdr_entries))",
          "old_line_content": "\t\t\t    ? transfer_fsck_objects",
          "new_line_content": "\tsnprintf(hdr_arg, sizeof(hdr_arg),",
          "content_same": false
        },
        {
          "line": 812,
          "old_api": null,
          "new_api": "ntohl",
          "old_text": null,
          "new_text": "ntohl(hdr.hdr_entries)",
          "old_line_content": "",
          "new_line_content": "\t\t\tntohl(hdr.hdr_version), ntohl(hdr.hdr_entries));",
          "content_same": false
        },
        {
          "line": 814,
          "old_api": null,
          "new_api": "ntohl",
          "old_text": null,
          "new_text": "ntohl(hdr.hdr_entries)",
          "old_line_content": "\tif (hdr_err)",
          "new_line_content": "\tif (ntohl(hdr.hdr_entries) < unpack_limit) {",
          "content_same": false
        },
        {
          "line": 824,
          "old_api": null,
          "new_api": "run_command_v_opt",
          "old_text": null,
          "new_text": "run_command_v_opt(unpacker, RUN_GIT_CMD)",
          "old_line_content": "\t\tif (quiet)",
          "new_line_content": "\t\tcode = run_command_v_opt(unpacker, RUN_GIT_CMD);",
          "content_same": false
        },
        {
          "line": 834,
          "old_api": null,
          "new_api": "getpid",
          "old_text": null,
          "new_text": "getpid()",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\ts = sprintf(keep_arg, \"--keep=receive-pack %\"PRIuMAX\" on \", (uintmax_t) getpid());",
          "content_same": false
        },
        {
          "line": 835,
          "old_api": null,
          "new_api": "gethostname",
          "old_text": null,
          "new_text": "gethostname(keep_arg + s, sizeof(keep_arg) - s)",
          "old_line_content": "\t\tconst char *keeper[7];",
          "new_line_content": "\t\tif (gethostname(keep_arg + s, sizeof(keep_arg) - s))",
          "content_same": false
        },
        {
          "line": 836,
          "old_api": null,
          "new_api": "strcpy",
          "old_text": null,
          "new_text": "strcpy(keep_arg + s, \"localhost\")",
          "old_line_content": "\t\tint s, status, i = 0;",
          "new_line_content": "\t\t\tstrcpy(keep_arg + s, \"localhost\");",
          "content_same": false
        },
        {
          "line": 846,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(&ip, 0, sizeof(ip))",
          "old_line_content": "\t\tif (fsck_objects)",
          "new_line_content": "\t\tmemset(&ip, 0, sizeof(ip));",
          "content_same": false
        },
        {
          "line": 850,
          "old_api": null,
          "new_api": "start_command",
          "old_text": null,
          "new_text": "start_command(&ip)",
          "old_line_content": "\t\tkeeper[i++] = keep_arg;",
          "new_line_content": "\t\tstatus = start_command(&ip);",
          "content_same": false
        },
        {
          "line": 854,
          "old_api": null,
          "new_api": "index_pack_lockfile",
          "old_text": null,
          "new_text": "index_pack_lockfile(ip.out)",
          "old_line_content": "\t\tip.out = -1;",
          "new_line_content": "\t\tpack_lockfile = index_pack_lockfile(ip.out);",
          "content_same": false
        },
        {
          "line": 855,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(ip.out)",
          "old_line_content": "\t\tip.git_cmd = 1;",
          "new_line_content": "\t\tclose(ip.out);",
          "content_same": false
        },
        {
          "line": 858,
          "old_api": null,
          "new_api": "reprepare_packed_git",
          "old_text": null,
          "new_text": "reprepare_packed_git()",
          "old_line_content": "\t\t\treturn \"index-pack fork failed\";",
          "new_line_content": "\t\t\treprepare_packed_git();",
          "content_same": false
        },
        {
          "line": 870,
          "old_api": null,
          "new_api": "packet_buf_write",
          "old_text": null,
          "new_text": "packet_buf_write(&buf, \"unpack %s\\n\",\n\t\t\t unpack_status ? unpack_status : \"ok\")",
          "old_line_content": "",
          "new_line_content": "\tpacket_buf_write(&buf, \"unpack %s\\n\",",
          "content_same": false
        },
        {
          "line": 874,
          "old_api": null,
          "new_api": "packet_buf_write",
          "old_text": null,
          "new_text": "packet_buf_write(&buf, \"ok %s\\n\",\n\t\t\t\t\t cmd->ref_name)",
          "old_line_content": "\tstruct strbuf buf = STRBUF_INIT;",
          "new_line_content": "\t\t\tpacket_buf_write(&buf, \"ok %s\\n\",",
          "content_same": false
        },
        {
          "line": 877,
          "old_api": null,
          "new_api": "packet_buf_write",
          "old_text": null,
          "new_text": "packet_buf_write(&buf, \"ng %s %s\\n\",\n\t\t\t\t\t cmd->ref_name, cmd->error_string)",
          "old_line_content": "\t\t\t unpack_status ? unpack_status : \"ok\");",
          "new_line_content": "\t\t\tpacket_buf_write(&buf, \"ng %s %s\\n\",",
          "content_same": false
        },
        {
          "line": 885,
          "old_api": null,
          "new_api": "safe_write",
          "old_text": null,
          "new_text": "safe_write(1, buf.buf, buf.len)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tsafe_write(1, buf.buf, buf.len);",
          "content_same": false
        },
        {
          "line": 893,
          "old_api": null,
          "new_api": "is_null_sha1",
          "old_text": null,
          "new_text": "is_null_sha1(cmd->new_sha1)",
          "old_line_content": "}",
          "new_line_content": "\t\tif (!is_null_sha1(cmd->new_sha1))",
          "content_same": false
        },
        {
          "line": 907,
          "old_api": null,
          "new_api": "packet_trace_identity",
          "old_text": null,
          "new_text": "packet_trace_identity(\"receive-pack\")",
          "old_line_content": "\tint advertise_refs = 0;",
          "new_line_content": "\tpacket_trace_identity(\"receive-pack\");",
          "content_same": false
        },
        {
          "line": 914,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(arg, \"--quiet\")",
          "old_line_content": "",
          "new_line_content": "\t\t\tif (!strcmp(arg, \"--quiet\")) {",
          "content_same": false
        },
        {
          "line": 919,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(arg, \"--advertise-refs\")",
          "old_line_content": "\t\tif (*arg == '-') {",
          "new_line_content": "\t\t\tif (!strcmp(arg, \"--advertise-refs\")) {",
          "content_same": false
        },
        {
          "line": 923,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(arg, \"--stateless-rpc\")",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\tif (!strcmp(arg, \"--stateless-rpc\")) {",
          "content_same": false
        },
        {
          "line": 928,
          "old_api": null,
          "new_api": "usage",
          "old_text": null,
          "new_text": "usage(receive_pack_usage)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\tusage(receive_pack_usage);",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": null,
          "new_api": "usage",
          "old_text": null,
          "new_text": "usage(receive_pack_usage)",
          "old_line_content": "\t\t\t\tcontinue;",
          "new_line_content": "\t\t\tusage(receive_pack_usage);",
          "content_same": false
        },
        {
          "line": 932,
          "old_api": null,
          "new_api": "xstrdup",
          "old_text": null,
          "new_text": "xstrdup(arg)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\tdir = xstrdup(arg);",
          "content_same": false
        },
        {
          "line": 935,
          "old_api": null,
          "new_api": "usage",
          "old_text": null,
          "new_text": "usage(receive_pack_usage)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tusage(receive_pack_usage);",
          "content_same": false
        },
        {
          "line": 939,
          "old_api": null,
          "new_api": "enter_repo",
          "old_text": null,
          "new_text": "enter_repo(dir, 0)",
          "old_line_content": "\t}",
          "new_line_content": "\tif (!enter_repo(dir, 0))",
          "content_same": false
        },
        {
          "line": 940,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"'%s' does not appear to be a git repository\", dir)",
          "old_line_content": "\tif (!dir)",
          "new_line_content": "\t\tdie(\"'%s' does not appear to be a git repository\", dir);",
          "content_same": false
        },
        {
          "line": 942,
          "old_api": null,
          "new_api": "is_repository_shallow",
          "old_text": null,
          "new_text": "is_repository_shallow()",
          "old_line_content": "",
          "new_line_content": "\tif (is_repository_shallow())",
          "content_same": false
        },
        {
          "line": 953,
          "old_api": null,
          "new_api": "write_head_info",
          "old_text": null,
          "new_text": "write_head_info()",
          "old_line_content": "\tif (0 <= transfer_unpack_limit)",
          "new_line_content": "\t\twrite_head_info();",
          "content_same": false
        },
        {
          "line": 958,
          "old_api": null,
          "new_api": "read_head_info",
          "old_text": null,
          "new_text": "read_head_info()",
          "old_line_content": "\tif (advertise_refs || !stateless_rpc) {",
          "new_line_content": "\tif ((commands = read_head_info()) != NULL) {",
          "content_same": false
        },
        {
          "line": 961,
          "old_api": null,
          "new_api": "delete_only",
          "old_text": null,
          "new_text": "delete_only(commands)",
          "old_line_content": "\tif (advertise_refs)",
          "new_line_content": "\t\tif (!delete_only(commands))",
          "content_same": false
        },
        {
          "line": 962,
          "old_api": null,
          "new_api": "unpack",
          "old_text": null,
          "new_text": "unpack()",
          "old_line_content": "\t\treturn 0;",
          "new_line_content": "\t\t\tunpack_status = unpack();",
          "content_same": false
        },
        {
          "line": 963,
          "old_api": null,
          "new_api": "execute_commands",
          "old_text": null,
          "new_text": "execute_commands(commands, unpack_status)",
          "old_line_content": "",
          "new_line_content": "\t\texecute_commands(commands, unpack_status);",
          "content_same": false
        },
        {
          "line": 965,
          "old_api": null,
          "new_api": "unlink_or_warn",
          "old_text": null,
          "new_text": "unlink_or_warn(pack_lockfile)",
          "old_line_content": "\t\tconst char *unpack_status = NULL;",
          "new_line_content": "\t\t\tunlink_or_warn(pack_lockfile);",
          "content_same": false
        },
        {
          "line": 977,
          "old_api": null,
          "new_api": "update_server_info",
          "old_text": null,
          "new_text": "update_server_info(0)",
          "old_line_content": "\t\t\tconst char *argv_gc_auto[] = {",
          "new_line_content": "\t\t\tupdate_server_info(0);",
          "content_same": false
        },
        {
          "line": 482,
          "old_api": null,
          "new_api": "parse_object",
          "old_text": null,
          "new_text": "parse_object(old_sha1)",
          "old_line_content": "",
          "new_line_content": "\t\told_object = parse_object(old_sha1);",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"bad sha1 objects for %s\", name)",
          "old_line_content": "\t\t    new_object->type != OBJ_COMMIT) {",
          "new_line_content": "\t\t\terror(\"bad sha1 objects for %s\", name);",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": null,
          "new_api": "in_merge_bases",
          "old_text": null,
          "new_text": "in_merge_bases(old_commit, new_commit)",
          "old_line_content": "\t\tnew_commit = (struct commit *)new_object;",
          "new_line_content": "\t\tif (!in_merge_bases(old_commit, new_commit)) {",
          "content_same": false
        },
        {
          "line": 499,
          "old_api": null,
          "new_api": "run_update_hook",
          "old_text": null,
          "new_text": "run_update_hook(cmd)",
          "old_line_content": "\t\tif (!ent) {",
          "new_line_content": "\tif (run_update_hook(cmd)) {",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": null,
          "new_api": "is_null_sha1",
          "old_text": null,
          "new_text": "is_null_sha1(new_sha1)",
          "old_line_content": "\t}",
          "new_line_content": "\tif (is_null_sha1(new_sha1)) {",
          "content_same": false
        },
        {
          "line": 507,
          "old_api": null,
          "new_api": "ref_exists",
          "old_text": null,
          "new_text": "ref_exists(name)",
          "old_line_content": "\t\treturn \"hook declined\";",
          "new_line_content": "\t\t\tif (ref_exists(name)) {",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": null,
          "new_api": "rp_warning",
          "old_text": null,
          "new_text": "rp_warning(\"Allowing deletion of corrupt ref.\")",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\t\trp_warning(\"Allowing deletion of corrupt ref.\");",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 513,
          "old_api": "ref_exists",
          "new_api": null,
          "old_text": "ref_exists(name)",
          "new_text": null,
          "old_line_content": "\t\t\tif (ref_exists(name)) {",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 516,
          "old_api": "rp_warning",
          "new_api": null,
          "old_text": "rp_warning(\"Deleting a non-existent ref.\")",
          "new_text": null,
          "old_line_content": "\t\t\t\trp_warning(\"Deleting a non-existent ref.\");",
          "new_line_content": "\t\t\treturn \"failed to delete\";",
          "content_same": false
        },
        {
          "line": 520,
          "old_api": "delete_ref",
          "new_api": null,
          "old_text": "delete_ref(namespaced_name, old_sha1, 0)",
          "new_text": null,
          "old_line_content": "\t\tif (delete_ref(namespaced_name, old_sha1, 0)) {",
          "new_line_content": "\telse {",
          "content_same": false
        },
        {
          "line": 527,
          "old_api": "lock_any_ref_for_update",
          "new_api": null,
          "old_text": "lock_any_ref_for_update(namespaced_name, old_sha1, 0)",
          "new_text": null,
          "old_line_content": "\t\tlock = lock_any_ref_for_update(namespaced_name, old_sha1, 0);",
          "new_line_content": "\t\t\treturn \"failed to write\"; /* error() already called */",
          "content_same": false
        },
        {
          "line": 529,
          "old_api": "rp_error",
          "new_api": null,
          "old_text": "rp_error(\"failed to lock %s\", name)",
          "new_text": null,
          "old_line_content": "\t\t\trp_error(\"failed to lock %s\", name);",
          "new_line_content": "\t\treturn NULL; /* good */",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": "write_ref_sha1",
          "new_api": null,
          "old_text": "write_ref_sha1(lock, new_sha1, \"push\")",
          "new_text": null,
          "old_line_content": "\t\tif (write_ref_sha1(lock, new_sha1, \"push\")) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": "access",
          "new_api": null,
          "old_text": "access(update_post_hook, X_OK)",
          "new_text": null,
          "old_line_content": "\tif (!argc || access(update_post_hook, X_OK) < 0)",
          "new_line_content": "\t\tchar *p;",
          "content_same": false
        },
        {
          "line": 555,
          "old_api": "xmalloc",
          "new_api": null,
          "old_text": "xmalloc(sizeof(*argv) * (2 + argc))",
          "new_text": null,
          "old_line_content": "\targv = xmalloc(sizeof(*argv) * (2 + argc));",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 562,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(cmd->ref_name)",
          "new_text": null,
          "old_line_content": "\t\tp = xmalloc(strlen(cmd->ref_name) + 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": "start_command",
          "new_api": null,
          "old_text": "start_command(&proc)",
          "new_text": null,
          "old_line_content": "\tif (!start_command(&proc)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 577,
          "old_api": "copy_to_sideband",
          "new_api": null,
          "old_text": "copy_to_sideband(proc.err, -1, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\tcopy_to_sideband(proc.err, -1, NULL);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 578,
          "old_api": "finish_command",
          "new_api": null,
          "old_text": "finish_command(&proc)",
          "new_text": null,
          "old_line_content": "\t\tfinish_command(&proc);",
          "new_line_content": "\tstruct strbuf buf = STRBUF_INIT;",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": "get_git_namespace",
          "new_api": null,
          "old_text": "get_git_namespace()",
          "new_text": null,
          "old_line_content": "\tstrbuf_addf(&buf, \"%s%s\", get_git_namespace(), cmd->ref_name);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": "strbuf_release",
          "new_api": null,
          "old_text": "strbuf_release(&buf)",
          "new_text": null,
          "old_line_content": "\tstrbuf_release(&buf);",
          "new_line_content": "\tif (!dst_name) {",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": "strip_namespace",
          "new_api": null,
          "old_text": "strip_namespace(dst_name)",
          "new_text": null,
          "old_line_content": "\tdst_name = strip_namespace(dst_name);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 607,
          "old_api": "string_list_lookup",
          "new_api": null,
          "old_text": "string_list_lookup(list, dst_name)",
          "new_text": null,
          "old_line_content": "\tif ((item = string_list_lookup(list, dst_name)) == NULL)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 620,
          "old_api": "find_unique_abbrev",
          "new_api": null,
          "old_text": "find_unique_abbrev(cmd->old_sha1, DEFAULT_ABBREV)",
          "new_text": null,
          "old_line_content": "\tstrcpy(cmd_oldh, find_unique_abbrev(cmd->old_sha1, DEFAULT_ABBREV));",
          "new_line_content": "\t\t cmd->ref_name, cmd_oldh, cmd_newh,",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": "find_unique_abbrev",
          "new_api": null,
          "old_text": "find_unique_abbrev(cmd->new_sha1, DEFAULT_ABBREV)",
          "new_text": null,
          "old_line_content": "\tstrcpy(cmd_newh, find_unique_abbrev(cmd->new_sha1, DEFAULT_ABBREV));",
          "new_line_content": "\t\t dst_cmd->ref_name, dst_oldh, dst_newh);",
          "content_same": false
        },
        {
          "line": 622,
          "old_api": "find_unique_abbrev",
          "new_api": null,
          "old_text": "find_unique_abbrev(dst_cmd->old_sha1, DEFAULT_ABBREV)",
          "new_text": null,
          "old_line_content": "\tstrcpy(dst_oldh, find_unique_abbrev(dst_cmd->old_sha1, DEFAULT_ABBREV));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 623,
          "old_api": "find_unique_abbrev",
          "new_api": null,
          "old_text": "find_unique_abbrev(dst_cmd->new_sha1, DEFAULT_ABBREV)",
          "new_text": null,
          "old_line_content": "\tstrcpy(dst_newh, find_unique_abbrev(dst_cmd->new_sha1, DEFAULT_ABBREV));",
          "new_line_content": "\tcmd->error_string = dst_cmd->error_string =",
          "content_same": false
        },
        {
          "line": 624,
          "old_api": "rp_error",
          "new_api": null,
          "old_text": "rp_error(\"refusing inconsistent update between symref '%s' (%s..%s) and\"\n\t\t \" its target '%s' (%s..%s)\",\n\t\t cmd->ref_name, cmd_oldh, cmd_newh,\n\t\t dst_cmd->ref_name, dst_oldh, dst_newh)",
          "new_text": null,
          "old_line_content": "\trp_error(\"refusing inconsistent update between symref '%s' (%s..%s) and\"",
          "new_line_content": "\t\t\"inconsistent aliased update\";",
          "content_same": false
        },
        {
          "line": 640,
          "old_api": "string_list_append",
          "new_api": null,
          "old_text": "string_list_append(&ref_list, cmd->ref_name)",
          "new_text": null,
          "old_line_content": "\t\t\tstring_list_append(&ref_list, cmd->ref_name);",
          "new_line_content": "\t\tif (!cmd->error_string)",
          "content_same": false
        },
        {
          "line": 643,
          "old_api": "sort_string_list",
          "new_api": null,
          "old_text": "sort_string_list(&ref_list)",
          "new_text": null,
          "old_line_content": "\tsort_string_list(&ref_list);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 647,
          "old_api": "check_aliased_update",
          "new_api": null,
          "old_text": "check_aliased_update(cmd, &ref_list)",
          "new_text": null,
          "old_line_content": "\t\t\tcheck_aliased_update(cmd, &ref_list);",
          "new_line_content": "static int command_singleton_iterator(void *cb_data, unsigned char sha1[20])",
          "content_same": false
        },
        {
          "line": 650,
          "old_api": "string_list_clear",
          "new_api": null,
          "old_text": "string_list_clear(&ref_list, 0)",
          "new_text": null,
          "old_line_content": "\tstring_list_clear(&ref_list, 0);",
          "new_line_content": "\tstruct command *cmd = *cmd_list;",
          "content_same": false
        },
        {
          "line": 658,
          "old_api": "is_null_sha1",
          "new_api": null,
          "old_text": "is_null_sha1(cmd->new_sha1)",
          "new_text": null,
          "old_line_content": "\tif (!cmd || is_null_sha1(cmd->new_sha1))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": "hashcpy",
          "new_api": null,
          "old_text": "hashcpy(sha1, cmd->new_sha1)",
          "new_text": null,
          "old_line_content": "\thashcpy(sha1, cmd->new_sha1);",
          "new_line_content": "\tstruct command *cmd;",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": "check_everything_connected",
          "new_api": null,
          "old_text": "check_everything_connected(command_singleton_iterator,\n\t\t\t\t\t\t0, &singleton)",
          "new_text": null,
          "old_line_content": "\t\tif (!check_everything_connected(command_singleton_iterator,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 684,
          "old_api": "is_null_sha1",
          "new_api": null,
          "old_text": "is_null_sha1(cmd->new_sha1)",
          "new_text": null,
          "old_line_content": "\t\tif (!is_null_sha1(cmd->new_sha1)) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 685,
          "old_api": "hashcpy",
          "new_api": null,
          "old_text": "hashcpy(sha1, cmd->new_sha1)",
          "new_text": null,
          "old_line_content": "\t\t\thashcpy(sha1, cmd->new_sha1);",
          "new_line_content": "\t*cmd_list = NULL;",
          "content_same": false
        },
        {
          "line": 707,
          "old_api": "check_everything_connected",
          "new_api": null,
          "old_text": "check_everything_connected(iterate_receive_command_list,\n\t\t\t\t       0, &cmd)",
          "new_text": null,
          "old_line_content": "\tif (check_everything_connected(iterate_receive_command_list,",
          "new_line_content": "\t\t\tif (!cmd->error_string)",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": "set_connectivity_errors",
          "new_api": null,
          "old_text": "set_connectivity_errors(commands)",
          "new_text": null,
          "old_line_content": "\t\tset_connectivity_errors(commands);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": "run_receive_hook",
          "new_api": null,
          "old_text": "run_receive_hook(commands, pre_receive_hook, 0)",
          "new_text": null,
          "old_line_content": "\tif (run_receive_hook(commands, pre_receive_hook, 0)) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 719,
          "old_api": "check_aliased_updates",
          "new_api": null,
          "old_text": "check_aliased_updates(commands)",
          "new_text": null,
          "old_line_content": "\tcheck_aliased_updates(commands);",
          "new_line_content": "\t\tif (cmd->error_string)",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(head_name_to_free)",
          "new_text": null,
          "old_line_content": "\tfree(head_name_to_free);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": "resolve_refdup",
          "new_api": null,
          "old_text": "resolve_refdup(\"HEAD\", sha1, 0, NULL)",
          "new_text": null,
          "old_line_content": "\thead_name = head_name_to_free = resolve_refdup(\"HEAD\", sha1, 0, NULL);",
          "new_line_content": "\t\tif (cmd->skip_update)",
          "content_same": false
        },
        {
          "line": 731,
          "old_api": "update",
          "new_api": null,
          "old_text": "update(cmd)",
          "new_text": null,
          "old_line_content": "\t\tcmd->error_string = update(cmd);",
          "new_line_content": "\tstruct command *commands = NULL;",
          "content_same": false
        },
        {
          "line": 746,
          "old_api": "packet_read_line",
          "new_api": null,
          "old_text": "packet_read_line(0, line, sizeof(line))",
          "new_text": null,
          "old_line_content": "\t\tlen = packet_read_line(0, line, sizeof(line));",
          "new_line_content": "\t\t    line[40] != ' ' ||",
          "content_same": false
        },
        {
          "line": 755,
          "old_api": "get_sha1_hex",
          "new_api": null,
          "old_text": "get_sha1_hex(line + 41, new_sha1)",
          "new_text": null,
          "old_line_content": "\t\t    get_sha1_hex(line + 41, new_sha1))",
          "new_line_content": "\t\tif (reflen + 82 < len) {",
          "content_same": false
        },
        {
          "line": 756,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"protocol error: expected old/new/ref, got '%s'\",\n\t\t\t    line)",
          "new_text": null,
          "old_line_content": "\t\t\tdie(\"protocol error: expected old/new/ref, got '%s'\",",
          "new_line_content": "\t\t\tconst char *feature_list = refname + reflen + 1;",
          "content_same": false
        },
        {
          "line": 760,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(refname)",
          "new_text": null,
          "old_line_content": "\t\treflen = strlen(refname);",
          "new_line_content": "\t\t\t\tuse_sideband = LARGE_PACKET_MAX;",
          "content_same": false
        },
        {
          "line": 763,
          "old_api": "parse_feature_request",
          "new_api": null,
          "old_text": "parse_feature_request(feature_list, \"report-status\")",
          "new_text": null,
          "old_line_content": "\t\t\tif (parse_feature_request(feature_list, \"report-status\"))",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 770,
          "old_api": "xcalloc",
          "new_api": null,
          "old_text": "xcalloc(1, sizeof(struct command) + len - 80)",
          "new_text": null,
          "old_line_content": "\t\tcmd = xcalloc(1, sizeof(struct command) + len - 80);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 771,
          "old_api": "hashcpy",
          "new_api": null,
          "old_text": "hashcpy(cmd->old_sha1, old_sha1)",
          "new_text": null,
          "old_line_content": "\t\thashcpy(cmd->old_sha1, old_sha1);",
          "new_line_content": "\treturn commands;",
          "content_same": false
        },
        {
          "line": 772,
          "old_api": "hashcpy",
          "new_api": null,
          "old_text": "hashcpy(cmd->new_sha1, new_sha1)",
          "new_text": null,
          "old_line_content": "\t\thashcpy(cmd->new_sha1, new_sha1);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 773,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(cmd->ref_name, line + 82, len - 81)",
          "new_text": null,
          "old_line_content": "\t\tmemcpy(cmd->ref_name, line + 82, len - 81);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 782,
          "old_api": "read_pack_header",
          "new_api": null,
          "old_text": "read_pack_header(0, hdr)",
          "new_text": null,
          "old_line_content": "\tswitch (read_pack_header(0, hdr)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 813,
          "old_api": "parse_pack_header",
          "new_api": null,
          "old_text": "parse_pack_header(&hdr)",
          "new_text": null,
          "old_line_content": "\thdr_err = parse_pack_header(&hdr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 816,
          "old_api": "snprintf",
          "new_api": null,
          "old_text": "snprintf(hdr_arg, sizeof(hdr_arg),\n\t\t\t\"--pack_header=%\"PRIu32\",%\"PRIu32,\n\t\t\tntohl(hdr.hdr_version), ntohl(hdr.hdr_entries))",
          "new_text": null,
          "old_line_content": "\tsnprintf(hdr_arg, sizeof(hdr_arg),",
          "new_line_content": "\t\tconst char *unpacker[5];",
          "content_same": false
        },
        {
          "line": 818,
          "old_api": "ntohl",
          "new_api": null,
          "old_text": "ntohl(hdr.hdr_entries)",
          "new_text": null,
          "old_line_content": "\t\t\tntohl(hdr.hdr_version), ntohl(hdr.hdr_entries));",
          "new_line_content": "\t\tif (quiet)",
          "content_same": false
        },
        {
          "line": 820,
          "old_api": "ntohl",
          "new_api": null,
          "old_text": "ntohl(hdr.hdr_entries)",
          "new_text": null,
          "old_line_content": "\tif (ntohl(hdr.hdr_entries) < unpack_limit) {",
          "new_line_content": "\t\tif (fsck_objects)",
          "content_same": false
        },
        {
          "line": 830,
          "old_api": "run_command_v_opt",
          "new_api": null,
          "old_text": "run_command_v_opt(unpacker, RUN_GIT_CMD)",
          "new_text": null,
          "old_line_content": "\t\tcode = run_command_v_opt(unpacker, RUN_GIT_CMD);",
          "new_line_content": "\t\tint s, status, i = 0;",
          "content_same": false
        },
        {
          "line": 840,
          "old_api": "getpid",
          "new_api": null,
          "old_text": "getpid()",
          "new_text": null,
          "old_line_content": "\t\ts = sprintf(keep_arg, \"--keep=receive-pack %\"PRIuMAX\" on \", (uintmax_t) getpid());",
          "new_line_content": "\t\tif (fsck_objects)",
          "content_same": false
        },
        {
          "line": 841,
          "old_api": "gethostname",
          "new_api": null,
          "old_text": "gethostname(keep_arg + s, sizeof(keep_arg) - s)",
          "new_text": null,
          "old_line_content": "\t\tif (gethostname(keep_arg + s, sizeof(keep_arg) - s))",
          "new_line_content": "\t\t\tkeeper[i++] = \"--strict\";",
          "content_same": false
        },
        {
          "line": 842,
          "old_api": "strcpy",
          "new_api": null,
          "old_text": "strcpy(keep_arg + s, \"localhost\")",
          "new_text": null,
          "old_line_content": "\t\t\tstrcpy(keep_arg + s, \"localhost\");",
          "new_line_content": "\t\tkeeper[i++] = \"--fix-thin\";",
          "content_same": false
        },
        {
          "line": 852,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(&ip, 0, sizeof(ip))",
          "new_text": null,
          "old_line_content": "\t\tmemset(&ip, 0, sizeof(ip));",
          "new_line_content": "\t\t\treturn \"index-pack fork failed\";",
          "content_same": false
        },
        {
          "line": 860,
          "old_api": "index_pack_lockfile",
          "new_api": null,
          "old_text": "index_pack_lockfile(ip.out)",
          "new_text": null,
          "old_line_content": "\t\tpack_lockfile = index_pack_lockfile(ip.out);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 861,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(ip.out)",
          "new_text": null,
          "old_line_content": "\t\tclose(ip.out);",
          "new_line_content": "\t\treturn \"index-pack abnormal exit\";",
          "content_same": false
        },
        {
          "line": 862,
          "old_api": "finish_command",
          "new_api": null,
          "old_text": "finish_command(&ip)",
          "new_text": null,
          "old_line_content": "\t\tstatus = finish_command(&ip);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 864,
          "old_api": "reprepare_packed_git",
          "new_api": null,
          "old_text": "reprepare_packed_git()",
          "new_text": null,
          "old_line_content": "\t\t\treprepare_packed_git();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 876,
          "old_api": "packet_buf_write",
          "new_api": null,
          "old_text": "packet_buf_write(&buf, \"unpack %s\\n\",\n\t\t\t unpack_status ? unpack_status : \"ok\")",
          "new_text": null,
          "old_line_content": "\tpacket_buf_write(&buf, \"unpack %s\\n\",",
          "new_line_content": "\t\telse",
          "content_same": false
        },
        {
          "line": 889,
          "old_api": "send_sideband",
          "new_api": null,
          "old_text": "send_sideband(1, 1, buf.buf, buf.len, use_sideband)",
          "new_text": null,
          "old_line_content": "\t\tsend_sideband(1, 1, buf.buf, buf.len, use_sideband);",
          "new_line_content": "static int delete_only(struct command *commands)",
          "content_same": false
        },
        {
          "line": 891,
          "old_api": "safe_write",
          "new_api": null,
          "old_text": "safe_write(1, buf.buf, buf.len)",
          "new_text": null,
          "old_line_content": "\t\tsafe_write(1, buf.buf, buf.len);",
          "new_line_content": "\tstruct command *cmd;",
          "content_same": false
        },
        {
          "line": 892,
          "old_api": "strbuf_release",
          "new_api": null,
          "old_text": "strbuf_release(&buf)",
          "new_text": null,
          "old_line_content": "\tstrbuf_release(&buf);",
          "new_line_content": "\tfor (cmd = commands; cmd; cmd = cmd->next) {",
          "content_same": false
        },
        {
          "line": 899,
          "old_api": "is_null_sha1",
          "new_api": null,
          "old_text": "is_null_sha1(cmd->new_sha1)",
          "new_text": null,
          "old_line_content": "\t\tif (!is_null_sha1(cmd->new_sha1))",
          "new_line_content": "int cmd_receive_pack(int argc, const char **argv, const char *prefix)",
          "content_same": false
        },
        {
          "line": 913,
          "old_api": "packet_trace_identity",
          "new_api": null,
          "old_text": "packet_trace_identity(\"receive-pack\")",
          "new_text": null,
          "old_line_content": "\tpacket_trace_identity(\"receive-pack\");",
          "new_line_content": "\t\tif (*arg == '-') {",
          "content_same": false
        },
        {
          "line": 920,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(arg, \"--quiet\")",
          "new_text": null,
          "old_line_content": "\t\t\tif (!strcmp(arg, \"--quiet\")) {",
          "new_line_content": "\t\t\t\tadvertise_refs = 1;",
          "content_same": false
        },
        {
          "line": 925,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(arg, \"--advertise-refs\")",
          "new_text": null,
          "old_line_content": "\t\t\tif (!strcmp(arg, \"--advertise-refs\")) {",
          "new_line_content": "\t\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 929,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(arg, \"--stateless-rpc\")",
          "new_text": null,
          "old_line_content": "\t\t\tif (!strcmp(arg, \"--stateless-rpc\")) {",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": "usage",
          "new_api": null,
          "old_text": "usage(receive_pack_usage)",
          "new_text": null,
          "old_line_content": "\t\t\tusage(receive_pack_usage);",
          "new_line_content": "\tif (!dir)",
          "content_same": false
        },
        {
          "line": 938,
          "old_api": "xstrdup",
          "new_api": null,
          "old_text": "xstrdup(arg)",
          "new_text": null,
          "old_line_content": "\t\tdir = xstrdup(arg);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 941,
          "old_api": "usage",
          "new_api": null,
          "old_text": "usage(receive_pack_usage)",
          "new_text": null,
          "old_line_content": "\t\tusage(receive_pack_usage);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 946,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"'%s' does not appear to be a git repository\", dir)",
          "new_text": null,
          "old_line_content": "\t\tdie(\"'%s' does not appear to be a git repository\", dir);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 948,
          "old_api": "is_repository_shallow",
          "new_api": null,
          "old_text": "is_repository_shallow()",
          "new_text": null,
          "old_line_content": "\tif (is_repository_shallow())",
          "new_line_content": "\t\tunpack_limit = transfer_unpack_limit;",
          "content_same": false
        },
        {
          "line": 949,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"attempt to push into a shallow repository\")",
          "new_text": null,
          "old_line_content": "\t\tdie(\"attempt to push into a shallow repository\");",
          "new_line_content": "\telse if (0 <= receive_unpack_limit)",
          "content_same": false
        },
        {
          "line": 951,
          "old_api": "git_config",
          "new_api": null,
          "old_text": "git_config(receive_pack_config, NULL)",
          "new_text": null,
          "old_line_content": "\tgit_config(receive_pack_config, NULL);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 959,
          "old_api": "write_head_info",
          "new_api": null,
          "old_text": "write_head_info()",
          "new_text": null,
          "old_line_content": "\t\twrite_head_info();",
          "new_line_content": "\t\tconst char *unpack_status = NULL;",
          "content_same": false
        },
        {
          "line": 964,
          "old_api": "read_head_info",
          "new_api": null,
          "old_text": "read_head_info()",
          "new_text": null,
          "old_line_content": "\tif ((commands = read_head_info()) != NULL) {",
          "new_line_content": "\t\tif (pack_lockfile)",
          "content_same": false
        },
        {
          "line": 971,
          "old_api": "unlink_or_warn",
          "new_api": null,
          "old_text": "unlink_or_warn(pack_lockfile)",
          "new_text": null,
          "old_line_content": "\t\t\tunlink_or_warn(pack_lockfile);",
          "new_line_content": "\t\t\tconst char *argv_gc_auto[] = {",
          "content_same": false
        },
        {
          "line": 973,
          "old_api": "report",
          "new_api": null,
          "old_text": "report(commands, unpack_status)",
          "new_text": null,
          "old_line_content": "\t\t\treport(commands, unpack_status);",
          "new_line_content": "\t\t\t};",
          "content_same": false
        },
        {
          "line": 975,
          "old_api": "run_update_post_hook",
          "new_api": null,
          "old_text": "run_update_post_hook(commands)",
          "new_text": null,
          "old_line_content": "\t\trun_update_post_hook(commands);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 983,
          "old_api": "update_server_info",
          "new_api": null,
          "old_text": "update_server_info(0)",
          "new_text": null,
          "old_line_content": "\t\t\tupdate_server_info(0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 986,
          "old_api": "packet_flush",
          "new_api": null,
          "old_text": "packet_flush(1)",
          "new_text": null,
          "old_line_content": "\t\tpacket_flush(1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": "parse_object",
          "new_api": null,
          "old_text": "parse_object(new_sha1)",
          "new_text": null,
          "old_line_content": "\t\tnew_object = parse_object(new_sha1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"bad sha1 objects for %s\", name)",
          "new_text": null,
          "old_line_content": "\t\t\terror(\"bad sha1 objects for %s\", name);",
          "new_line_content": "\t\t\treturn \"bad ref\";",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": "hashcmp",
          "new_api": null,
          "old_text": "hashcmp(old_sha1, ent->item->object.sha1)",
          "new_text": null,
          "old_line_content": "\t\t\tif (!hashcmp(old_sha1, ent->item->object.sha1))",
          "new_line_content": "\t\t\treturn \"non-fast-forward\";",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": "free_commit_list",
          "new_api": null,
          "old_text": "free_commit_list(bases)",
          "new_text": null,
          "old_line_content": "\t\tfree_commit_list(bases);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": "rp_error",
          "new_api": null,
          "old_text": "rp_error(\"hook declined to update %s\", name)",
          "new_text": null,
          "old_line_content": "\t\trp_error(\"hook declined to update %s\", name);",
          "new_line_content": "\t\t\told_sha1 = NULL;",
          "content_same": false
        },
        {
          "line": 511,
          "old_api": "parse_object",
          "new_api": null,
          "old_text": "parse_object(old_sha1)",
          "new_text": null,
          "old_line_content": "\t\tif (!parse_object(old_sha1)) {",
          "new_line_content": "\t\t\t\tcmd->did_not_exist = 1;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 26,
      "total_additions": 87,
      "total_deletions": 89,
      "total_api_changes": 202
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 8,
        "api_related_lines": 202,
        "non_api_lines": 3,
        "non_api_line_numbers": [
          481,
          497,
          495
        ]
      }
    },
    "api_calls_before": 237,
    "api_calls_after": 235,
    "diff_info": {
      "added_lines": 1,
      "removed_lines": 7,
      "total_diff_lines": 27
    }
  }
}