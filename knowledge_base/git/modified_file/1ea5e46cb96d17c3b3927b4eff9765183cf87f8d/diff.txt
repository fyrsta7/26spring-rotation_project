diff --git a/modified_file.c b/modified_file.c
index 0000000..1111111 100644
--- a/modified_file.c
+++ b/modified_file.c
--- a/modified_file.c
+++ b/modified_file.c
@@ -221,6 +221,9 @@
 	uint32_t *pack_order;

 	uint32_t i;

 	const char *ret;

+

+	if (!(flags & WRITE_REV) && !(flags & WRITE_REV_VERIFY))

+		return NULL;

 

 	ALLOC_ARRAY(pack_order, nr_objects);

 	for (i = 0; i < nr_objects; i++)
