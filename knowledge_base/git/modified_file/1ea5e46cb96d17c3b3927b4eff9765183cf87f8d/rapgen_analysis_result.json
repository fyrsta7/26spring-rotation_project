{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/1ea5e46cb96d17c3b3927b4eff9765183cf87f8d",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/1ea5e46cb96d17c3b3927b4eff9765183cf87f8d/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/1ea5e46cb96d17c3b3927b4eff9765183cf87f8d/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/1ea5e46cb96d17c3b3927b4eff9765183cf87f8d/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 228,
          "old_api": "QSORT_S",
          "new_api": "ALLOC_ARRAY",
          "old_text": "QSORT_S(pack_order, nr_objects, pack_order_cmp, objects)",
          "new_text": "ALLOC_ARRAY(pack_order, nr_objects)",
          "old_line_content": "\tQSORT_S(pack_order, nr_objects, pack_order_cmp, objects);",
          "new_line_content": "\tALLOC_ARRAY(pack_order, nr_objects);",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": "free",
          "new_api": "write_rev_file_order",
          "old_text": "free(pack_order)",
          "new_text": "write_rev_file_order(rev_name, pack_order, nr_objects, hash,\n\t\t\t\t   flags)",
          "old_line_content": "\tfree(pack_order);",
          "new_line_content": "\tret = write_rev_file_order(rev_name, pack_order, nr_objects, hash,",
          "content_same": false
        },
        {
          "line": 256,
          "old_api": "unlink",
          "new_api": "odb_mkstemp",
          "old_text": "unlink(rev_name)",
          "new_text": "odb_mkstemp(&tmp_file, \"pack/tmp_rev_XXXXXX\")",
          "old_line_content": "\t\t\tunlink(rev_name);",
          "new_line_content": "\t\t\tfd = odb_mkstemp(&tmp_file, \"pack/tmp_rev_XXXXXX\");",
          "content_same": false
        },
        {
          "line": 257,
          "old_api": "xopen",
          "new_api": "strbuf_detach",
          "old_text": "xopen(rev_name, O_CREAT|O_EXCL|O_WRONLY, 0600)",
          "new_text": "strbuf_detach(&tmp_file, NULL)",
          "old_line_content": "\t\t\tfd = xopen(rev_name, O_CREAT|O_EXCL|O_WRONLY, 0600);",
          "new_line_content": "\t\t\trev_name = strbuf_detach(&tmp_file, NULL);",
          "content_same": false
        },
        {
          "line": 259,
          "old_api": "hashfd",
          "new_api": "unlink",
          "old_text": "hashfd(fd, rev_name)",
          "new_text": "unlink(rev_name)",
          "old_line_content": "\t\tf = hashfd(fd, rev_name);",
          "new_line_content": "\t\t\tunlink(rev_name);",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": "stat",
          "new_api": "hashfd",
          "old_text": "stat(rev_name, &statbuf)",
          "new_text": "hashfd(fd, rev_name)",
          "old_line_content": "\t\tif (stat(rev_name, &statbuf)) {",
          "new_line_content": "\t\tf = hashfd(fd, rev_name);",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": "write_rev_trailer",
          "new_api": "write_rev_header",
          "old_text": "write_rev_trailer(f, hash)",
          "new_text": "write_rev_header(f)",
          "old_line_content": "\twrite_rev_trailer(f, hash);",
          "new_line_content": "\twrite_rev_header(f);",
          "content_same": false
        },
        {
          "line": 278,
          "old_api": "adjust_shared_perm",
          "new_api": "write_rev_index_positions",
          "old_text": "adjust_shared_perm(rev_name)",
          "new_text": "write_rev_index_positions(f, pack_order, nr_objects)",
          "old_line_content": "\tif (rev_name && adjust_shared_perm(rev_name) < 0)",
          "new_line_content": "\twrite_rev_index_positions(f, pack_order, nr_objects);",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": "_",
          "new_api": "write_rev_trailer",
          "old_text": "_(\"failed to make %s readable\")",
          "new_text": "write_rev_trailer(f, hash)",
          "old_line_content": "\t\tdie(_(\"failed to make %s readable\"), rev_name);",
          "new_line_content": "\twrite_rev_trailer(f, hash);",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": "finalize_hashfile",
          "new_api": "adjust_shared_perm",
          "old_text": "finalize_hashfile(f, NULL, CSUM_HASH_IN_STREAM | CSUM_CLOSE |\n\t\t\t\t    ((flags & WRITE_IDX_VERIFY) ? 0 : CSUM_FSYNC))",
          "new_text": "adjust_shared_perm(rev_name)",
          "old_line_content": "\tfinalize_hashfile(f, NULL, CSUM_HASH_IN_STREAM | CSUM_CLOSE |",
          "new_line_content": "\tif (rev_name && adjust_shared_perm(rev_name) < 0)",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": "hashwrite",
          "new_api": "htonl",
          "old_text": "hashwrite(f, &hdr, sizeof(hdr))",
          "new_text": "htonl(PACK_SIGNATURE)",
          "old_line_content": "\thashwrite(f, &hdr, sizeof(hdr));",
          "new_line_content": "\thdr.hdr_signature = htonl(PACK_SIGNATURE);",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": "lseek",
          "new_api": "init_fn",
          "old_text": "lseek(pack_fd, 0, SEEK_SET)",
          "new_text": "the_hash_algo->init_fn(&old_hash_ctx)",
          "old_line_content": "\tif (lseek(pack_fd, 0, SEEK_SET) != 0)",
          "new_line_content": "\tthe_hash_algo->init_fn(&old_hash_ctx);",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": "die_errno",
          "new_api": "init_fn",
          "old_text": "die_errno(\"Failed seeking to start of '%s'\", pack_name)",
          "new_text": "the_hash_algo->init_fn(&new_hash_ctx)",
          "old_line_content": "\t\tdie_errno(\"Failed seeking to start of '%s'\", pack_name);",
          "new_line_content": "\tthe_hash_algo->init_fn(&new_hash_ctx);",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": "htonl",
          "new_api": "lseek",
          "old_text": "htonl(object_count)",
          "new_text": "lseek(pack_fd, 0, SEEK_SET)",
          "old_line_content": "\thdr.hdr_entries = htonl(object_count);",
          "new_line_content": "\tif (lseek(pack_fd, 0, SEEK_SET) != 0)",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": "update_fn",
          "new_api": "die_errno",
          "old_text": "the_hash_algo->update_fn(&new_hash_ctx, &hdr, sizeof(hdr))",
          "new_text": "die_errno(\"Failed seeking to start of '%s'\", pack_name)",
          "old_line_content": "\tthe_hash_algo->update_fn(&new_hash_ctx, &hdr, sizeof(hdr));",
          "new_line_content": "\t\tdie_errno(\"Failed seeking to start of '%s'\", pack_name);",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": "write_or_die",
          "new_api": "update_fn",
          "old_text": "write_or_die(pack_fd, &hdr, sizeof(hdr))",
          "new_text": "the_hash_algo->update_fn(&old_hash_ctx, &hdr, sizeof(hdr))",
          "old_line_content": "\twrite_or_die(pack_fd, &hdr, sizeof(hdr));",
          "new_line_content": "\tthe_hash_algo->update_fn(&old_hash_ctx, &hdr, sizeof(hdr));",
          "content_same": false
        },
        {
          "line": 346,
          "old_api": "xmalloc",
          "new_api": "write_or_die",
          "old_text": "xmalloc(buf_sz)",
          "new_text": "write_or_die(pack_fd, &hdr, sizeof(hdr))",
          "old_line_content": "\tbuf = xmalloc(buf_sz);",
          "new_line_content": "\twrite_or_die(pack_fd, &hdr, sizeof(hdr));",
          "content_same": false
        },
        {
          "line": 384,
          "old_api": "free",
          "new_api": "MSB",
          "old_text": "free(buf)",
          "new_text": "MSB(partial_pack_offset, 1)",
          "old_line_content": "\tfree(buf);",
          "new_line_content": "\t\t\tpartial_pack_offset -= MSB(partial_pack_offset, 1);",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": "final_fn",
          "new_api": "free",
          "old_text": "the_hash_algo->final_fn(partial_pack_hash, &old_hash_ctx)",
          "new_text": "free(buf)",
          "old_line_content": "\t\tthe_hash_algo->final_fn(partial_pack_hash, &old_hash_ctx);",
          "new_line_content": "\tfree(buf);",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": "fsync_or_die",
          "new_api": "final_fn",
          "old_text": "fsync_or_die(pack_fd, pack_name)",
          "new_text": "the_hash_algo->final_fn(partial_pack_hash, &old_hash_ctx)",
          "old_line_content": "\tfsync_or_die(pack_fd, pack_name);",
          "new_line_content": "\t\tthe_hash_algo->final_fn(partial_pack_hash, &old_hash_ctx);",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": "write_idx_file",
          "new_api": "adjust_shared_perm",
          "old_text": "write_idx_file(NULL, written_list, nr_written,\n\t\t\t\t      pack_idx_opts, hash)",
          "new_text": "adjust_shared_perm(pack_tmp_name)",
          "old_line_content": "\tidx_tmp_name = write_idx_file(NULL, written_list, nr_written,",
          "new_line_content": "\tif (adjust_shared_perm(pack_tmp_name))",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": "die_errno",
          "new_api": "write_idx_file",
          "old_text": "die_errno(\"unable to make temporary index file readable\")",
          "new_text": "write_idx_file(NULL, written_list, nr_written,\n\t\t\t\t      pack_idx_opts, hash)",
          "old_line_content": "\t\tdie_errno(\"unable to make temporary index file readable\");",
          "new_line_content": "\tidx_tmp_name = write_idx_file(NULL, written_list, nr_written,",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": "write_rev_file",
          "new_api": "adjust_shared_perm",
          "old_text": "write_rev_file(NULL, written_list, nr_written, hash,\n\t\t\t\t      pack_idx_opts->flags)",
          "new_text": "adjust_shared_perm(idx_tmp_name)",
          "old_line_content": "\trev_tmp_name = write_rev_file(NULL, written_list, nr_written, hash,",
          "new_line_content": "\tif (adjust_shared_perm(idx_tmp_name))",
          "content_same": false
        },
        {
          "line": 482,
          "old_api": "hash_to_hex",
          "new_api": "write_rev_file",
          "old_text": "hash_to_hex(hash)",
          "new_text": "write_rev_file(NULL, written_list, nr_written, hash,\n\t\t\t\t      pack_idx_opts->flags)",
          "old_line_content": "\tstrbuf_addf(name_buffer, \"%s.pack\", hash_to_hex(hash));",
          "new_line_content": "\trev_tmp_name = write_rev_file(NULL, written_list, nr_written, hash,",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": "die_errno",
          "new_api": "hash_to_hex",
          "old_text": "die_errno(\"unable to rename temporary pack file\")",
          "new_text": "hash_to_hex(hash)",
          "old_line_content": "\t\tdie_errno(\"unable to rename temporary pack file\");",
          "new_line_content": "\tstrbuf_addf(name_buffer, \"%s.pack\", hash_to_hex(hash));",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": "strbuf_setlen",
          "new_api": "rename",
          "old_text": "strbuf_setlen(name_buffer, basename_len)",
          "new_text": "rename(pack_tmp_name, name_buffer->buf)",
          "old_line_content": "\tstrbuf_setlen(name_buffer, basename_len);",
          "new_line_content": "\tif (rename(pack_tmp_name, name_buffer->buf))",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": "rename",
          "new_api": "strbuf_setlen",
          "old_text": "rename(idx_tmp_name, name_buffer->buf)",
          "new_text": "strbuf_setlen(name_buffer, basename_len)",
          "old_line_content": "\tif (rename(idx_tmp_name, name_buffer->buf))",
          "new_line_content": "\tstrbuf_setlen(name_buffer, basename_len);",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": "strbuf_setlen",
          "new_api": "rename",
          "old_text": "strbuf_setlen(name_buffer, basename_len)",
          "new_text": "rename(idx_tmp_name, name_buffer->buf)",
          "old_line_content": "\tstrbuf_setlen(name_buffer, basename_len);",
          "new_line_content": "\tif (rename(idx_tmp_name, name_buffer->buf))",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": "hash_to_hex",
          "new_api": "strbuf_setlen",
          "old_text": "hash_to_hex(hash)",
          "new_text": "strbuf_setlen(name_buffer, basename_len)",
          "old_line_content": "\t\tstrbuf_addf(name_buffer, \"%s.rev\", hash_to_hex(hash));",
          "new_line_content": "\tstrbuf_setlen(name_buffer, basename_len);",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": "strbuf_setlen",
          "new_api": "die_errno",
          "old_text": "strbuf_setlen(name_buffer, basename_len)",
          "new_text": "die_errno(\"unable to rename temporary reverse-index file\")",
          "old_line_content": "\tstrbuf_setlen(name_buffer, basename_len);",
          "new_line_content": "\t\t\tdie_errno(\"unable to rename temporary reverse-index file\");",
          "content_same": false
        },
        {
          "line": 512,
          "old_api": "oid_to_hex",
          "new_api": "xfopen",
          "old_text": "oid_to_hex(&sought[i]->old_oid)",
          "new_text": "xfopen(promisor_name, \"w\")",
          "old_line_content": "\t\tfprintf(output, \"%s %s\\n\", oid_to_hex(&sought[i]->old_oid),",
          "new_line_content": "\tFILE *output = xfopen(promisor_name, \"w\");",
          "content_same": false
        },
        {
          "line": 515,
          "old_api": "ferror",
          "new_api": "oid_to_hex",
          "old_text": "ferror(output)",
          "new_text": "oid_to_hex(&sought[i]->old_oid)",
          "old_line_content": "\terr = ferror(output);",
          "new_line_content": "\t\tfprintf(output, \"%s %s\\n\", oid_to_hex(&sought[i]->old_oid),",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": "_",
          "new_api": "ferror",
          "old_text": "_(\"could not write '%s' promisor file\")",
          "new_text": "ferror(output)",
          "old_line_content": "\t\tdie(_(\"could not write '%s' promisor file\"), promisor_name);",
          "new_line_content": "\terr = ferror(output);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 260,
          "old_api": null,
          "new_api": "xopen",
          "old_text": null,
          "new_text": "xopen(rev_name, O_CREAT|O_EXCL|O_WRONLY, 0600)",
          "old_line_content": "\t} else if (flags & WRITE_REV_VERIFY) {",
          "new_line_content": "\t\t\tfd = xopen(rev_name, O_CREAT|O_EXCL|O_WRONLY, 0600);",
          "content_same": false
        },
        {
          "line": 519,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(output)",
          "old_line_content": "}",
          "new_line_content": "\terr |= fclose(output);",
          "content_same": false
        },
        {
          "line": 391,
          "old_api": null,
          "new_api": "final_fn",
          "old_text": null,
          "new_text": "the_hash_algo->final_fn(new_pack_hash, &new_hash_ctx)",
          "old_line_content": "}",
          "new_line_content": "\tthe_hash_algo->final_fn(new_pack_hash, &new_hash_ctx);",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": null,
          "new_api": "_",
          "old_text": null,
          "new_text": "_(\"could not write '%s' promisor file\")",
          "old_line_content": "",
          "new_line_content": "\t\tdie(_(\"could not write '%s' promisor file\"), promisor_name);",
          "content_same": false
        },
        {
          "line": 265,
          "old_api": null,
          "new_api": "stat",
          "old_text": null,
          "new_text": "stat(rev_name, &statbuf)",
          "old_line_content": "\t\t\t\treturn NULL;",
          "new_line_content": "\t\tif (stat(rev_name, &statbuf)) {",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": null,
          "new_api": "write_or_die",
          "old_text": null,
          "new_text": "write_or_die(pack_fd, new_pack_hash, the_hash_algo->rawsz)",
          "old_line_content": "",
          "new_line_content": "\twrite_or_die(pack_fd, new_pack_hash, the_hash_algo->rawsz);",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": null,
          "new_api": "fsync_or_die",
          "old_text": null,
          "new_text": "fsync_or_die(pack_fd, pack_name)",
          "old_line_content": "char *index_pack_lockfile(int ip_out, int *is_well_formed)",
          "new_line_content": "\tfsync_or_die(pack_fd, pack_name);",
          "content_same": false
        },
        {
          "line": 270,
          "old_api": null,
          "new_api": "_",
          "old_text": null,
          "new_text": "_(\"could not stat: %s\")",
          "old_line_content": "\t} else",
          "new_line_content": "\t\t\t\tdie_errno(_(\"could not stat: %s\"), rev_name);",
          "content_same": false
        },
        {
          "line": 272,
          "old_api": null,
          "new_api": "hashfd_check",
          "old_text": null,
          "new_text": "hashfd_check(rev_name)",
          "old_line_content": "",
          "new_line_content": "\t\tf = hashfd_check(rev_name);",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": null,
          "new_api": "read_in_full",
          "old_text": null,
          "new_text": "read_in_full(ip_out, packname, len)",
          "old_line_content": "\t\tif (is_well_formed)",
          "new_line_content": "\tif (read_in_full(ip_out, packname, len) == len && packname[len-1] == '\\n') {",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": null,
          "new_api": "_",
          "old_text": null,
          "new_text": "_(\"failed to make %s readable\")",
          "old_line_content": "\t\t\t\t    ((flags & WRITE_IDX_VERIFY) ? 0 : CSUM_FSYNC));",
          "new_line_content": "\t\tdie(_(\"failed to make %s readable\"), rev_name);",
          "content_same": false
        },
        {
          "line": 284,
          "old_api": null,
          "new_api": "finalize_hashfile",
          "old_text": null,
          "new_text": "finalize_hashfile(f, NULL, CSUM_HASH_IN_STREAM | CSUM_CLOSE |\n\t\t\t\t    ((flags & WRITE_IDX_VERIFY) ? 0 : CSUM_FSYNC))",
          "old_line_content": "\treturn rev_name;",
          "new_line_content": "\tfinalize_hashfile(f, NULL, CSUM_HASH_IN_STREAM | CSUM_CLOSE |",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": null,
          "new_api": "skip_prefix",
          "old_text": null,
          "new_text": "skip_prefix(packname, \"keep\\t\", &name)",
          "old_line_content": "\t\treturn NULL;",
          "new_line_content": "\t\tif (skip_prefix(packname, \"keep\\t\", &name))",
          "content_same": false
        },
        {
          "line": 415,
          "old_api": null,
          "new_api": "xstrfmt",
          "old_text": null,
          "new_text": "xstrfmt(\"%s/pack/pack-%s.keep\",\n\t\t\t\t       get_object_directory(), name)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\treturn xstrfmt(\"%s/pack/pack-%s.keep\",",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": null,
          "new_api": "get_object_directory",
          "old_text": null,
          "new_text": "get_object_directory()",
          "old_line_content": "\tif (is_well_formed)",
          "new_line_content": "\t\t\t\t       get_object_directory(), name);",
          "content_same": false
        },
        {
          "line": 295,
          "old_api": null,
          "new_api": "htonl",
          "old_text": null,
          "new_text": "htonl(PACK_VERSION)",
          "old_line_content": "\treturn sizeof(hdr);",
          "new_line_content": "\thdr.hdr_version = htonl(PACK_VERSION);",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": null,
          "new_api": "htonl",
          "old_text": null,
          "new_text": "htonl(nr_entries)",
          "old_line_content": "}",
          "new_line_content": "\thdr.hdr_entries = htonl(nr_entries);",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": null,
          "new_api": "hashwrite",
          "old_text": null,
          "new_text": "hashwrite(f, &hdr, sizeof(hdr))",
          "old_line_content": "",
          "new_line_content": "\thashwrite(f, &hdr, sizeof(hdr));",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"bad type %d\", type)",
          "old_line_content": "\tsize >>= 4;",
          "new_line_content": "\t\tdie(\"bad type %d\", type);",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"object size is too enormous to format\")",
          "old_line_content": "\t\tsize >>= 7;",
          "new_line_content": "\t\t\tdie(\"object size is too enormous to format\");",
          "content_same": false
        },
        {
          "line": 459,
          "old_api": null,
          "new_api": "odb_mkstemp",
          "old_text": null,
          "new_text": "odb_mkstemp(&tmpname, \"pack/tmp_pack_XXXXXX\")",
          "old_line_content": "}",
          "new_line_content": "\tfd = odb_mkstemp(&tmpname, \"pack/tmp_pack_XXXXXX\");",
          "content_same": false
        },
        {
          "line": 460,
          "old_api": null,
          "new_api": "strbuf_detach",
          "old_text": null,
          "new_text": "strbuf_detach(&tmpname, NULL)",
          "old_line_content": "",
          "new_line_content": "\t*pack_tmp_name = strbuf_detach(&tmpname, NULL);",
          "content_same": false
        },
        {
          "line": 333,
          "old_api": null,
          "new_api": "lseek",
          "old_text": null,
          "new_text": "lseek(pack_fd, 0, SEEK_SET)",
          "old_line_content": "\tif (read_result < 0)",
          "new_line_content": "\tif (lseek(pack_fd, 0, SEEK_SET) != 0)",
          "content_same": false
        },
        {
          "line": 461,
          "old_api": null,
          "new_api": "hashfd",
          "old_text": null,
          "new_text": "hashfd(fd, *pack_tmp_name)",
          "old_line_content": "void finish_tmp_packfile(struct strbuf *name_buffer,",
          "new_line_content": "\treturn hashfd(fd, *pack_tmp_name);",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": null,
          "new_api": "read_in_full",
          "old_text": null,
          "new_text": "read_in_full(pack_fd, &hdr, sizeof(hdr))",
          "old_line_content": "\telse if (read_result != sizeof(hdr))",
          "new_line_content": "\tread_result = read_in_full(pack_fd, &hdr, sizeof(hdr));",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": null,
          "new_api": "die_errno",
          "old_text": null,
          "new_text": "die_errno(\"Unable to reread header of '%s'\", pack_name)",
          "old_line_content": "\t\t\t  pack_name);",
          "new_line_content": "\t\tdie_errno(\"Unable to reread header of '%s'\", pack_name);",
          "content_same": false
        },
        {
          "line": 344,
          "old_api": null,
          "new_api": "htonl",
          "old_text": null,
          "new_text": "htonl(object_count)",
          "old_line_content": "\tpartial_pack_offset -= sizeof(hdr);",
          "new_line_content": "\thdr.hdr_entries = htonl(object_count);",
          "content_same": false
        },
        {
          "line": 345,
          "old_api": null,
          "new_api": "update_fn",
          "old_text": null,
          "new_text": "the_hash_algo->update_fn(&new_hash_ctx, &hdr, sizeof(hdr))",
          "old_line_content": "",
          "new_line_content": "\tthe_hash_algo->update_fn(&new_hash_ctx, &hdr, sizeof(hdr));",
          "content_same": false
        },
        {
          "line": 475,
          "old_api": null,
          "new_api": "die_errno",
          "old_text": null,
          "new_text": "die_errno(\"unable to make temporary pack file readable\")",
          "old_line_content": "\t\t\t\t      pack_idx_opts, hash);",
          "new_line_content": "\t\tdie_errno(\"unable to make temporary pack file readable\");",
          "content_same": false
        },
        {
          "line": 349,
          "old_api": null,
          "new_api": "xmalloc",
          "old_text": null,
          "new_text": "xmalloc(buf_sz)",
          "old_line_content": "\t\tssize_t m, n;",
          "new_line_content": "\tbuf = xmalloc(buf_sz);",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": null,
          "new_api": "die_errno",
          "old_text": null,
          "new_text": "die_errno(\"unable to make temporary index file readable\")",
          "old_line_content": "\t\t\t\t      pack_idx_opts->flags);",
          "new_line_content": "\t\tdie_errno(\"unable to make temporary index file readable\");",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": null,
          "new_api": "xread",
          "old_text": null,
          "new_text": "xread(pack_fd, buf, m)",
          "old_line_content": "\t\tif (n < 0)",
          "new_line_content": "\t\tn = xread(pack_fd, buf, m);",
          "content_same": false
        },
        {
          "line": 231,
          "old_api": null,
          "new_api": "QSORT_S",
          "old_text": null,
          "new_text": "QSORT_S(pack_order, nr_objects, pack_order_cmp, objects)",
          "old_line_content": "\t\t\t\t   flags);",
          "new_line_content": "\tQSORT_S(pack_order, nr_objects, pack_order_cmp, objects);",
          "content_same": false
        },
        {
          "line": 359,
          "old_api": null,
          "new_api": "die_errno",
          "old_text": null,
          "new_text": "die_errno(\"Failed to checksum '%s'\", pack_name)",
          "old_line_content": "\t\taligned_sz -= n;",
          "new_line_content": "\t\t\tdie_errno(\"Failed to checksum '%s'\", pack_name);",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": null,
          "new_api": "update_fn",
          "old_text": null,
          "new_text": "the_hash_algo->update_fn(&new_hash_ctx, buf, n)",
          "old_line_content": "\t\tif (!aligned_sz)",
          "new_line_content": "\t\tthe_hash_algo->update_fn(&new_hash_ctx, buf, n);",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": null,
          "new_api": "die_errno",
          "old_text": null,
          "new_text": "die_errno(\"unable to rename temporary pack file\")",
          "old_line_content": "",
          "new_line_content": "\t\tdie_errno(\"unable to rename temporary pack file\");",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(pack_order)",
          "old_line_content": "}",
          "new_line_content": "\tfree(pack_order);",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": null,
          "new_api": "hash_to_hex",
          "old_text": null,
          "new_text": "hash_to_hex(hash)",
          "old_line_content": "",
          "new_line_content": "\tstrbuf_addf(name_buffer, \"%s.idx\", hash_to_hex(hash));",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": null,
          "new_api": "die_errno",
          "old_text": null,
          "new_text": "die_errno(\"unable to rename temporary index file\")",
          "old_line_content": "",
          "new_line_content": "\t\tdie_errno(\"unable to rename temporary index file\");",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": null,
          "new_api": "update_fn",
          "old_text": null,
          "new_text": "the_hash_algo->update_fn(&old_hash_ctx, buf, n)",
          "old_line_content": "\t\t\tunsigned char hash[GIT_MAX_RAWSZ];",
          "new_line_content": "\t\tthe_hash_algo->update_fn(&old_hash_ctx, buf, n);",
          "content_same": false
        },
        {
          "line": 499,
          "old_api": null,
          "new_api": "hash_to_hex",
          "old_text": null,
          "new_text": "hash_to_hex(hash)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tstrbuf_addf(name_buffer, \"%s.rev\", hash_to_hex(hash));",
          "content_same": false
        },
        {
          "line": 500,
          "old_api": null,
          "new_api": "rename",
          "old_text": null,
          "new_text": "rename(rev_tmp_name, name_buffer->buf)",
          "old_line_content": "",
          "new_line_content": "\t\tif (rename(rev_tmp_name, name_buffer->buf))",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": null,
          "new_api": "final_fn",
          "old_text": null,
          "new_text": "the_hash_algo->final_fn(hash, &old_hash_ctx)",
          "old_line_content": "\t\t\t\t    \"(disk corruption?)\", pack_name);",
          "new_line_content": "\t\t\tthe_hash_algo->final_fn(hash, &old_hash_ctx);",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": null,
          "new_api": "hasheq",
          "old_text": null,
          "new_text": "hasheq(hash, partial_pack_hash)",
          "old_line_content": "\t\t\t/*",
          "new_line_content": "\t\t\tif (!hasheq(hash, partial_pack_hash))",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"Unexpected checksum for %s \"\n\t\t\t\t    \"(disk corruption?)\", pack_name)",
          "old_line_content": "\t\t\t * Now let's compute the SHA1 of the remainder of the",
          "new_line_content": "\t\t\t\tdie(\"Unexpected checksum for %s \"",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": null,
          "new_api": "strbuf_setlen",
          "old_text": null,
          "new_text": "strbuf_setlen(name_buffer, basename_len)",
          "old_line_content": "}",
          "new_line_content": "\tstrbuf_setlen(name_buffer, basename_len);",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free((void *)idx_tmp_name)",
          "old_line_content": "void write_promisor_file(const char *promisor_name, struct ref **sought, int nr_sought)",
          "new_line_content": "\tfree((void *)idx_tmp_name);",
          "content_same": false
        },
        {
          "line": 251,
          "old_api": null,
          "new_api": "_",
          "old_text": null,
          "new_text": "_(\"cannot both write and verify reverse index\")",
          "old_line_content": "\t\tif (!rev_name) {",
          "new_line_content": "\t\tdie(_(\"cannot both write and verify reverse index\"));",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": null,
          "new_api": "init_fn",
          "old_text": null,
          "new_text": "the_hash_algo->init_fn(&old_hash_ctx)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tthe_hash_algo->init_fn(&old_hash_ctx);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 509,
          "old_api": "xfopen",
          "new_api": null,
          "old_text": "xfopen(promisor_name, \"w\")",
          "new_text": null,
          "old_line_content": "\tFILE *output = xfopen(promisor_name, \"w\");",
          "new_line_content": "void write_promisor_file(const char *promisor_name, struct ref **sought, int nr_sought)",
          "content_same": false
        },
        {
          "line": 516,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(output)",
          "new_text": null,
          "old_line_content": "\terr |= fclose(output);",
          "new_line_content": "\t\t\tsought[i]->name);",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "final_fn",
          "new_api": null,
          "old_text": "the_hash_algo->final_fn(new_pack_hash, &new_hash_ctx)",
          "new_text": null,
          "old_line_content": "\tthe_hash_algo->final_fn(new_pack_hash, &new_hash_ctx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": "write_or_die",
          "new_api": null,
          "old_text": "write_or_die(pack_fd, new_pack_hash, the_hash_algo->rawsz)",
          "new_text": null,
          "old_line_content": "\twrite_or_die(pack_fd, new_pack_hash, the_hash_algo->rawsz);",
          "new_line_content": "\tif (partial_pack_hash)",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": "_",
          "new_api": null,
          "old_text": "_(\"could not stat: %s\")",
          "new_text": null,
          "old_line_content": "\t\t\t\tdie_errno(_(\"could not stat: %s\"), rev_name);",
          "new_line_content": "\t\t\t\t/* .rev files are optional */",
          "content_same": false
        },
        {
          "line": 269,
          "old_api": "hashfd_check",
          "new_api": null,
          "old_text": "hashfd_check(rev_name)",
          "new_text": null,
          "old_line_content": "\t\tf = hashfd_check(rev_name);",
          "new_line_content": "\t\t\t} else",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": "write_rev_header",
          "new_api": null,
          "old_text": "write_rev_header(f)",
          "new_text": null,
          "old_line_content": "\twrite_rev_header(f);",
          "new_line_content": "\t} else",
          "content_same": false
        },
        {
          "line": 275,
          "old_api": "write_rev_index_positions",
          "new_api": null,
          "old_text": "write_rev_index_positions(f, pack_order, nr_objects)",
          "new_text": null,
          "old_line_content": "\twrite_rev_index_positions(f, pack_order, nr_objects);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": "read_in_full",
          "new_api": null,
          "old_text": "read_in_full(ip_out, packname, len)",
          "new_text": null,
          "old_line_content": "\tif (read_in_full(ip_out, packname, len) == len && packname[len-1] == '\\n') {",
          "new_line_content": "\t * case, we need it to remove the corresponding .keep file",
          "content_same": false
        },
        {
          "line": 411,
          "old_api": "skip_prefix",
          "new_api": null,
          "old_text": "skip_prefix(packname, \"keep\\t\", &name)",
          "new_text": null,
          "old_line_content": "\t\tif (skip_prefix(packname, \"keep\\t\", &name))",
          "new_line_content": "\t\tif (is_well_formed)",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": "xstrfmt",
          "new_api": null,
          "old_text": "xstrfmt(\"%s/pack/pack-%s.keep\",\n\t\t\t\t       get_object_directory(), name)",
          "new_text": null,
          "old_line_content": "\t\t\treturn xstrfmt(\"%s/pack/pack-%s.keep\",",
          "new_line_content": "\t\t\t*is_well_formed = 1;",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": "get_object_directory",
          "new_api": null,
          "old_text": "get_object_directory()",
          "new_text": null,
          "old_line_content": "\t\t\t\t       get_object_directory(), name);",
          "new_line_content": "\t\tpackname[len-1] = 0;",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": "htonl",
          "new_api": null,
          "old_text": "htonl(PACK_SIGNATURE)",
          "new_text": null,
          "old_line_content": "\thdr.hdr_signature = htonl(PACK_SIGNATURE);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": "htonl",
          "new_api": null,
          "old_text": "htonl(PACK_VERSION)",
          "new_text": null,
          "old_line_content": "\thdr.hdr_version = htonl(PACK_VERSION);",
          "new_line_content": "\tstruct pack_header hdr;",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": "htonl",
          "new_api": null,
          "old_text": "htonl(nr_entries)",
          "new_text": null,
          "old_line_content": "\thdr.hdr_entries = htonl(nr_entries);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"bad type %d\", type)",
          "new_text": null,
          "old_line_content": "\t\tdie(\"bad type %d\", type);",
          "new_line_content": "\tunsigned char c;",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"object size is too enormous to format\")",
          "new_text": null,
          "old_line_content": "\t\t\tdie(\"object size is too enormous to format\");",
          "new_line_content": "\tsize >>= 4;",
          "content_same": false
        },
        {
          "line": 327,
          "old_api": "init_fn",
          "new_api": null,
          "old_text": "the_hash_algo->init_fn(&old_hash_ctx)",
          "new_text": null,
          "old_line_content": "\tthe_hash_algo->init_fn(&old_hash_ctx);",
          "new_line_content": "\tchar *buf;",
          "content_same": false
        },
        {
          "line": 328,
          "old_api": "init_fn",
          "new_api": null,
          "old_text": "the_hash_algo->init_fn(&new_hash_ctx)",
          "new_text": null,
          "old_line_content": "\tthe_hash_algo->init_fn(&new_hash_ctx);",
          "new_line_content": "\tssize_t read_result;",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": "odb_mkstemp",
          "new_api": null,
          "old_text": "odb_mkstemp(&tmpname, \"pack/tmp_pack_XXXXXX\")",
          "new_text": null,
          "old_line_content": "\tfd = odb_mkstemp(&tmpname, \"pack/tmp_pack_XXXXXX\");",
          "new_line_content": "\tstruct strbuf tmpname = STRBUF_INIT;",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": "strbuf_detach",
          "new_api": null,
          "old_text": "strbuf_detach(&tmpname, NULL)",
          "new_text": null,
          "old_line_content": "\t*pack_tmp_name = strbuf_detach(&tmpname, NULL);",
          "new_line_content": "\tint fd;",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": "hashfd",
          "new_api": null,
          "old_text": "hashfd(fd, *pack_tmp_name)",
          "new_text": null,
          "old_line_content": "\treturn hashfd(fd, *pack_tmp_name);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": "read_in_full",
          "new_api": null,
          "old_text": "read_in_full(pack_fd, &hdr, sizeof(hdr))",
          "new_text": null,
          "old_line_content": "\tread_result = read_in_full(pack_fd, &hdr, sizeof(hdr));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": "die_errno",
          "new_api": null,
          "old_text": "die_errno(\"Unexpected short read for header of '%s'\",\n\t\t\t  pack_name)",
          "new_text": null,
          "old_line_content": "\t\tdie_errno(\"Unexpected short read for header of '%s'\",",
          "new_line_content": "\tif (read_result < 0)",
          "content_same": false
        },
        {
          "line": 338,
          "old_api": "lseek",
          "new_api": null,
          "old_text": "lseek(pack_fd, 0, SEEK_SET)",
          "new_text": null,
          "old_line_content": "\tif (lseek(pack_fd, 0, SEEK_SET) != 0)",
          "new_line_content": "\telse if (read_result != sizeof(hdr))",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": "update_fn",
          "new_api": null,
          "old_text": "the_hash_algo->update_fn(&old_hash_ctx, &hdr, sizeof(hdr))",
          "new_text": null,
          "old_line_content": "\tthe_hash_algo->update_fn(&old_hash_ctx, &hdr, sizeof(hdr));",
          "new_line_content": "\t\t\t  pack_name);",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": "adjust_shared_perm",
          "new_api": null,
          "old_text": "adjust_shared_perm(pack_tmp_name)",
          "new_text": null,
          "old_line_content": "\tif (adjust_shared_perm(pack_tmp_name))",
          "new_line_content": "\tconst char *idx_tmp_name, *rev_tmp_name = NULL;",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": "die_errno",
          "new_api": null,
          "old_text": "die_errno(\"unable to make temporary pack file readable\")",
          "new_text": null,
          "old_line_content": "\t\tdie_errno(\"unable to make temporary pack file readable\");",
          "new_line_content": "\tint basename_len = name_buffer->len;",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": "adjust_shared_perm",
          "new_api": null,
          "old_text": "adjust_shared_perm(idx_tmp_name)",
          "new_text": null,
          "old_line_content": "\tif (adjust_shared_perm(idx_tmp_name))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 352,
          "old_api": "xread",
          "new_api": null,
          "old_text": "xread(pack_fd, buf, m)",
          "new_text": null,
          "old_line_content": "\t\tn = xread(pack_fd, buf, m);",
          "new_line_content": "\t\tssize_t m, n;",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "ALLOC_ARRAY",
          "new_api": null,
          "old_text": "ALLOC_ARRAY(pack_order, nr_objects)",
          "new_text": null,
          "old_line_content": "\tALLOC_ARRAY(pack_order, nr_objects);",
          "new_line_content": "\tif (!(flags & WRITE_REV) && !(flags & WRITE_REV_VERIFY))",
          "content_same": false
        },
        {
          "line": 356,
          "old_api": "die_errno",
          "new_api": null,
          "old_text": "die_errno(\"Failed to checksum '%s'\", pack_name)",
          "new_text": null,
          "old_line_content": "\t\t\tdie_errno(\"Failed to checksum '%s'\", pack_name);",
          "new_line_content": "\t\tif (!n)",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": "update_fn",
          "new_api": null,
          "old_text": "the_hash_algo->update_fn(&new_hash_ctx, buf, n)",
          "new_text": null,
          "old_line_content": "\t\tthe_hash_algo->update_fn(&new_hash_ctx, buf, n);",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": "write_rev_file_order",
          "new_api": null,
          "old_text": "write_rev_file_order(rev_name, pack_order, nr_objects, hash,\n\t\t\t\t   flags)",
          "new_text": null,
          "old_line_content": "\tret = write_rev_file_order(rev_name, pack_order, nr_objects, hash,",
          "new_line_content": "\t\tpack_order[i] = i;",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": "rename",
          "new_api": null,
          "old_text": "rename(pack_tmp_name, name_buffer->buf)",
          "new_text": null,
          "old_line_content": "\tif (rename(pack_tmp_name, name_buffer->buf))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": "hash_to_hex",
          "new_api": null,
          "old_text": "hash_to_hex(hash)",
          "new_text": null,
          "old_line_content": "\tstrbuf_addf(name_buffer, \"%s.idx\", hash_to_hex(hash));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": "die_errno",
          "new_api": null,
          "old_text": "die_errno(\"unable to rename temporary index file\")",
          "new_text": null,
          "old_line_content": "\t\tdie_errno(\"unable to rename temporary index file\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 366,
          "old_api": "update_fn",
          "new_api": null,
          "old_text": "the_hash_algo->update_fn(&old_hash_ctx, buf, n)",
          "new_text": null,
          "old_line_content": "\t\tthe_hash_algo->update_fn(&old_hash_ctx, buf, n);",
          "new_line_content": "\t\tif (!partial_pack_hash)",
          "content_same": false
        },
        {
          "line": 497,
          "old_api": "rename",
          "new_api": null,
          "old_text": "rename(rev_tmp_name, name_buffer->buf)",
          "new_text": null,
          "old_line_content": "\t\tif (rename(rev_tmp_name, name_buffer->buf))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": "final_fn",
          "new_api": null,
          "old_text": "the_hash_algo->final_fn(hash, &old_hash_ctx)",
          "new_text": null,
          "old_line_content": "\t\t\tthe_hash_algo->final_fn(hash, &old_hash_ctx);",
          "new_line_content": "\t\tpartial_pack_offset -= n;",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": "hasheq",
          "new_api": null,
          "old_text": "hasheq(hash, partial_pack_hash)",
          "new_text": null,
          "old_line_content": "\t\t\tif (!hasheq(hash, partial_pack_hash))",
          "new_line_content": "\t\tif (partial_pack_offset == 0) {",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"Unexpected checksum for %s \"\n\t\t\t\t    \"(disk corruption?)\", pack_name)",
          "new_text": null,
          "old_line_content": "\t\t\t\tdie(\"Unexpected checksum for %s \"",
          "new_line_content": "\t\t\tunsigned char hash[GIT_MAX_RAWSZ];",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": "MSB",
          "new_api": null,
          "old_text": "MSB(partial_pack_offset, 1)",
          "new_text": null,
          "old_line_content": "\t\t\tpartial_pack_offset -= MSB(partial_pack_offset, 1);",
          "new_line_content": "\t\t\t */",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": "die_errno",
          "new_api": null,
          "old_text": "die_errno(\"unable to rename temporary reverse-index file\")",
          "new_text": null,
          "old_line_content": "\t\t\tdie_errno(\"unable to rename temporary reverse-index file\");",
          "new_line_content": "\tif (rev_tmp_name) {",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": "free",
          "new_api": null,
          "old_text": "free((void *)idx_tmp_name)",
          "new_text": null,
          "old_line_content": "\tfree((void *)idx_tmp_name);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": "_",
          "new_api": null,
          "old_text": "_(\"cannot both write and verify reverse index\")",
          "new_text": null,
          "old_line_content": "\t\tdie(_(\"cannot both write and verify reverse index\"));",
          "new_line_content": "\tint fd;",
          "content_same": false
        },
        {
          "line": 379,
          "old_api": "init_fn",
          "new_api": null,
          "old_text": "the_hash_algo->init_fn(&old_hash_ctx)",
          "new_text": null,
          "old_line_content": "\t\t\tthe_hash_algo->init_fn(&old_hash_ctx);",
          "new_line_content": "\t\t\t * pack, which also means making partial_pack_offset",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": "odb_mkstemp",
          "new_api": null,
          "old_text": "odb_mkstemp(&tmp_file, \"pack/tmp_rev_XXXXXX\")",
          "new_text": null,
          "old_line_content": "\t\t\tfd = odb_mkstemp(&tmp_file, \"pack/tmp_rev_XXXXXX\");",
          "new_line_content": "\tif (flags & WRITE_REV) {",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": "strbuf_detach",
          "new_api": null,
          "old_text": "strbuf_detach(&tmp_file, NULL)",
          "new_text": null,
          "old_line_content": "\t\t\trev_name = strbuf_detach(&tmp_file, NULL);",
          "new_line_content": "\t\tif (!rev_name) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 33,
      "total_additions": 49,
      "total_deletions": 49,
      "total_api_changes": 131
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 131,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          227,
          229
        ]
      }
    },
    "api_calls_before": 127,
    "api_calls_after": 127,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 1,
      "total_diff_lines": 25
    }
  }
}