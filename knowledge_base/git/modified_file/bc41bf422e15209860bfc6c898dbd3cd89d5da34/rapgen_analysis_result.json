{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/bc41bf422e15209860bfc6c898dbd3cd89d5da34",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/bc41bf422e15209860bfc6c898dbd3cd89d5da34/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/bc41bf422e15209860bfc6c898dbd3cd89d5da34/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/bc41bf422e15209860bfc6c898dbd3cd89d5da34/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 341,
          "old_api": "_",
          "new_api": "update_index_refresh",
          "old_text": "_(\"Could not write new index file.\")",
          "new_text": "update_index_refresh(\n\t\t\t\tquiet ? REFRESH_QUIET : REFRESH_IN_PORCELAIN)",
          "old_line_content": "\t\t\tdie(_(\"Could not write new index file.\"));",
          "new_line_content": "\t\t\tupdate_index_refresh(",
          "content_same": false
        },
        {
          "line": 346,
          "old_api": "update_refs",
          "new_api": "_",
          "old_text": "update_refs(rev, sha1)",
          "new_text": "_(\"Could not write new index file.\")",
          "old_line_content": "\tupdate_ref_status = update_refs(rev, sha1);",
          "new_line_content": "\t\t\tdie(_(\"Could not write new index file.\"));",
          "content_same": false
        },
        {
          "line": 351,
          "old_api": "xcalloc",
          "new_api": "update_refs",
          "old_text": "xcalloc(1, sizeof(struct lock_file))",
          "new_text": "update_refs(rev, sha1)",
          "old_line_content": "\t\tstruct lock_file *index_lock = xcalloc(1, sizeof(struct lock_file));",
          "new_line_content": "\tupdate_ref_status = update_refs(rev, sha1);",
          "content_same": false
        },
        {
          "line": 356,
          "old_api": "commit_locked_index",
          "new_api": "remove_branch_state",
          "old_text": "commit_locked_index(index_lock)",
          "new_text": "remove_branch_state()",
          "old_line_content": "\t\t    commit_locked_index(index_lock))",
          "new_line_content": "\tremove_branch_state();",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 344,
          "old_api": null,
          "new_api": "write_cache",
          "old_text": null,
          "new_text": "write_cache(newfd, active_cache, active_nr)",
          "old_line_content": "\t/* Any resets update HEAD to the head being switched to,",
          "new_line_content": "\t\tif (write_cache(newfd, active_cache, active_nr) ||",
          "content_same": false
        },
        {
          "line": 345,
          "old_api": null,
          "new_api": "commit_locked_index",
          "old_text": null,
          "new_text": "commit_locked_index(lock)",
          "old_line_content": "\t * saving the previous head in ORIG_HEAD before. */",
          "new_line_content": "\t\t    commit_locked_index(lock))",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": null,
          "new_api": "print_new_head_line",
          "old_text": null,
          "new_text": "print_new_head_line(commit)",
          "old_line_content": "\t\t\tquiet ? REFRESH_QUIET : REFRESH_IN_PORCELAIN);",
          "new_line_content": "\t\tprint_new_head_line(commit);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 352,
          "old_api": "hold_locked_index",
          "new_api": null,
          "old_text": "hold_locked_index(index_lock, 1)",
          "new_text": null,
          "old_line_content": "\t\tint fd = hold_locked_index(index_lock, 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 353,
          "old_api": "update_index_refresh",
          "new_api": null,
          "old_text": "update_index_refresh(\n\t\t\tquiet ? REFRESH_QUIET : REFRESH_IN_PORCELAIN)",
          "new_text": null,
          "old_line_content": "\t\tupdate_index_refresh(",
          "new_line_content": "\tif (reset_type == HARD && !update_ref_status && !quiet)",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": "write_cache",
          "new_api": null,
          "old_text": "write_cache(fd, active_cache, active_nr)",
          "new_text": null,
          "old_line_content": "\t\tif (write_cache(fd, active_cache, active_nr) ||",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"Could not refresh index\")",
          "new_text": null,
          "old_line_content": "\t\t\terror(\"Could not refresh index\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": "remove_branch_state",
          "new_api": null,
          "old_text": "remove_branch_state()",
          "new_text": null,
          "old_line_content": "\tremove_branch_state();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 339,
          "old_api": "write_cache",
          "new_api": null,
          "old_text": "write_cache(newfd, active_cache, active_nr)",
          "new_text": null,
          "old_line_content": "\t\tif (write_cache(newfd, active_cache, active_nr) ||",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": "commit_locked_index",
          "new_api": null,
          "old_text": "commit_locked_index(lock)",
          "new_text": null,
          "old_line_content": "\t\t    commit_locked_index(lock))",
          "new_line_content": "\t\tif (reset_type == MIXED) /* Report what has not been updated. */",
          "content_same": false
        },
        {
          "line": 349,
          "old_api": "print_new_head_line",
          "new_api": null,
          "old_text": "print_new_head_line(commit)",
          "new_text": null,
          "old_line_content": "\t\tprint_new_head_line(commit);",
          "new_line_content": "\t/* Any resets update HEAD to the head being switched to,",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 4,
      "total_additions": 3,
      "total_deletions": 8,
      "total_api_changes": 15
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 14,
        "api_related_lines": 15,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          342,
          350,
          358,
          343
        ]
      }
    },
    "api_calls_before": 138,
    "api_calls_after": 133,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 9,
      "total_diff_lines": 33
    }
  }
}