{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/8f0246551c3964eeb16d9c9f39845bd53af8bda8",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/8f0246551c3964eeb16d9c9f39845bd53af8bda8/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/8f0246551c3964eeb16d9c9f39845bd53af8bda8/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/8f0246551c3964eeb16d9c9f39845bd53af8bda8/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 160,
          "old_api": "die",
          "new_api": "strbuf_grow",
          "old_text": "die(\"`pos + len' is too far after the end of the buffer\")",
          "new_text": "strbuf_grow(sb, dlen - len)",
          "old_line_content": "\t\tdie(\"`pos + len' is too far after the end of the buffer\");",
          "new_line_content": "\t\tstrbuf_grow(sb, dlen - len);",
          "content_same": false
        },
        {
          "line": 164,
          "old_api": "memmove",
          "new_api": "memcpy",
          "old_text": "memmove(sb->buf + pos + dlen,\n\t\t\tsb->buf + pos + len,\n\t\t\tsb->len - pos - len)",
          "new_text": "memcpy(sb->buf + pos, data, dlen)",
          "old_line_content": "\tmemmove(sb->buf + pos + dlen,",
          "new_line_content": "\tmemcpy(sb->buf + pos, data, dlen);",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": "strbuf_avail",
          "new_api": "vsnprintf",
          "old_text": "strbuf_avail(sb)",
          "new_text": "vsnprintf(sb->buf + sb->len, sb->alloc - sb->len, fmt, ap)",
          "old_line_content": "\tif (!strbuf_avail(sb))",
          "new_line_content": "\tlen = vsnprintf(sb->buf + sb->len, sb->alloc - sb->len, fmt, ap);",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "strbuf_grow",
          "new_api": "va_end",
          "old_text": "strbuf_grow(sb, 64)",
          "new_text": "va_end(ap)",
          "old_line_content": "\t\tstrbuf_grow(sb, 64);",
          "new_line_content": "\tva_end(ap);",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": "vsnprintf",
          "new_api": "die",
          "old_text": "vsnprintf(sb->buf + sb->len, sb->alloc - sb->len, fmt, ap)",
          "new_text": "die(\"your vsnprintf is broken\")",
          "old_line_content": "\tlen = vsnprintf(sb->buf + sb->len, sb->alloc - sb->len, fmt, ap);",
          "new_line_content": "\t\tdie(\"your vsnprintf is broken\");",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": "va_end",
          "new_api": "strbuf_avail",
          "old_text": "va_end(ap)",
          "new_text": "strbuf_avail(sb)",
          "old_line_content": "\tva_end(ap);",
          "new_line_content": "\tif (len > strbuf_avail(sb)) {",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "die",
          "new_api": "va_start",
          "old_text": "die(\"your vsnprintf is broken\")",
          "new_text": "va_start(ap, fmt)",
          "old_line_content": "\t\tdie(\"your vsnprintf is broken\");",
          "new_line_content": "\t\tva_start(ap, fmt);",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": "strbuf_avail",
          "new_api": "vsnprintf",
          "old_text": "strbuf_avail(sb)",
          "new_text": "vsnprintf(sb->buf + sb->len, sb->alloc - sb->len, fmt, ap)",
          "old_line_content": "\tif (len > strbuf_avail(sb)) {",
          "new_line_content": "\t\tlen = vsnprintf(sb->buf + sb->len, sb->alloc - sb->len, fmt, ap);",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": "strbuf_grow",
          "new_api": "va_end",
          "old_text": "strbuf_grow(sb, len)",
          "new_text": "va_end(ap)",
          "old_line_content": "\t\tstrbuf_grow(sb, len);",
          "new_line_content": "\t\tva_end(ap);",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": "va_start",
          "new_api": "strbuf_avail",
          "old_text": "va_start(ap, fmt)",
          "new_text": "strbuf_avail(sb)",
          "old_line_content": "\t\tva_start(ap, fmt);",
          "new_line_content": "\t\tif (len > strbuf_avail(sb)) {",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": "vsnprintf",
          "new_api": "die",
          "old_text": "vsnprintf(sb->buf + sb->len, sb->alloc - sb->len, fmt, ap)",
          "new_text": "die(\"this should not happen, your snprintf is broken\")",
          "old_line_content": "\t\tlen = vsnprintf(sb->buf + sb->len, sb->alloc - sb->len, fmt, ap);",
          "new_line_content": "\t\t\tdie(\"this should not happen, your snprintf is broken\");",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": "die",
          "new_api": "strbuf_setlen",
          "old_text": "die(\"this should not happen, your snprintf is broken\")",
          "new_text": "strbuf_setlen(sb, sb->len + len)",
          "old_line_content": "\t\t\tdie(\"this should not happen, your snprintf is broken\");",
          "new_line_content": "\tstrbuf_setlen(sb, sb->len + len);",
          "content_same": false
        },
        {
          "line": 246,
          "old_api": "strlen",
          "new_api": "strbuf_addstr",
          "old_text": "strlen(e->placeholder)",
          "new_text": "strbuf_addstr(sb, e->value)",
          "old_line_content": "\tfor (; e->placeholder && (len = strlen(e->placeholder)); e++) {",
          "new_line_content": "\t\t\t\tstrbuf_addstr(sb, e->value);",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": "strbuf_grow",
          "new_api": "strbuf_setlen",
          "old_text": "strbuf_grow(sb, size)",
          "new_text": "strbuf_setlen(sb, sb->len + res)",
          "old_line_content": "\tstrbuf_grow(sb, size);",
          "new_line_content": "\t\tstrbuf_setlen(sb, sb->len + res);",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": "xread",
          "new_api": "strbuf_release",
          "old_text": "xread(fd, sb->buf + sb->len, sb->alloc - sb->len - 1)",
          "new_text": "strbuf_release(sb)",
          "old_line_content": "\t\tcnt = xread(fd, sb->buf + sb->len, sb->alloc - sb->len - 1);",
          "new_line_content": "\t\t\t\tstrbuf_release(sb);",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": "feof",
          "new_api": "strbuf_reset",
          "old_text": "feof(fp)",
          "new_text": "strbuf_reset(sb)",
          "old_line_content": "\tif (feof(fp))",
          "new_line_content": "\tstrbuf_reset(sb);",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": "fgetc",
          "new_api": "strbuf_grow",
          "old_text": "fgetc(fp)",
          "new_text": "strbuf_grow(sb, 1)",
          "old_line_content": "\twhile ((ch = fgetc(fp)) != EOF) {",
          "new_line_content": "\t\tstrbuf_grow(sb, 1);",
          "content_same": false
        },
        {
          "line": 353,
          "old_api": "open",
          "new_api": "strbuf_read",
          "old_text": "open(path, O_RDONLY)",
          "new_text": "strbuf_read(sb, fd, hint)",
          "old_line_content": "\tfd = open(path, O_RDONLY);",
          "new_line_content": "\tlen = strbuf_read(sb, fd, hint);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 258,
          "old_api": null,
          "new_api": "strbuf_grow",
          "old_text": null,
          "new_text": "strbuf_grow(sb, size)",
          "old_line_content": "\tsize_t res;",
          "new_line_content": "\tstrbuf_grow(sb, size);",
          "content_same": false
        },
        {
          "line": 259,
          "old_api": null,
          "new_api": "fread",
          "old_text": null,
          "new_text": "fread(sb->buf + sb->len, 1, size, f)",
          "old_line_content": "\tsize_t oldalloc = sb->alloc;",
          "new_line_content": "\tres = fread(sb->buf + sb->len, 1, size, f);",
          "content_same": false
        },
        {
          "line": 263,
          "old_api": null,
          "new_api": "strbuf_release",
          "old_text": null,
          "new_text": "strbuf_release(sb)",
          "old_line_content": "\tif (res > 0)",
          "new_line_content": "\t\tstrbuf_release(sb);",
          "content_same": false
        },
        {
          "line": 143,
          "old_api": null,
          "new_api": "memcmp",
          "old_text": null,
          "new_text": "memcmp(a->buf, b->buf, len)",
          "old_line_content": "\tif (a->len < b->len) {",
          "new_line_content": "\tint cmp = memcmp(a->buf, b->buf, len);",
          "content_same": false
        },
        {
          "line": 272,
          "old_api": null,
          "new_api": "strbuf_grow",
          "old_text": null,
          "new_text": "strbuf_grow(sb, hint ? hint : 8192)",
          "old_line_content": "\tsize_t oldlen = sb->len;",
          "new_line_content": "\tstrbuf_grow(sb, hint ? hint : 8192);",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": null,
          "new_api": "xread",
          "old_text": null,
          "new_text": "xread(fd, sb->buf + sb->len, sb->alloc - sb->len - 1)",
          "old_line_content": "\tfor (;;) {",
          "new_line_content": "\t\tcnt = xread(fd, sb->buf + sb->len, sb->alloc - sb->len - 1);",
          "content_same": false
        },
        {
          "line": 153,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"you want to use way too much memory\")",
          "old_line_content": "\t\t\t\t   const void *data, size_t dlen)",
          "new_line_content": "\t\tdie(\"you want to use way too much memory\");",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": null,
          "new_api": "strbuf_setlen",
          "old_text": null,
          "new_text": "strbuf_setlen(sb, oldlen)",
          "old_line_content": "\t\t\tif (oldalloc == 0)",
          "new_line_content": "\t\t\t\tstrbuf_setlen(sb, oldlen);",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"`pos' is too far after the end of the buffer\")",
          "old_line_content": "\tif (pos + len < pos)",
          "new_line_content": "\t\tdie(\"`pos' is too far after the end of the buffer\");",
          "content_same": false
        },
        {
          "line": 157,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"`pos + len' is too far after the end of the buffer\")",
          "old_line_content": "\tif (pos > sb->len)",
          "new_line_content": "\t\tdie(\"`pos + len' is too far after the end of the buffer\");",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": null,
          "new_api": "strbuf_grow",
          "old_text": null,
          "new_text": "strbuf_grow(sb, 8192)",
          "old_line_content": "\t\tif (!cnt)",
          "new_line_content": "\t\tstrbuf_grow(sb, 8192);",
          "content_same": false
        },
        {
          "line": 161,
          "old_api": null,
          "new_api": "memmove",
          "old_text": null,
          "new_text": "memmove(sb->buf + pos + dlen,\n\t\t\tsb->buf + pos + len,\n\t\t\tsb->len - pos - len)",
          "old_line_content": "",
          "new_line_content": "\tmemmove(sb->buf + pos + dlen,",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": null,
          "new_api": "strbuf_setlen",
          "old_text": null,
          "new_text": "strbuf_setlen(sb, sb->len + dlen - len)",
          "old_line_content": "\t\t\tsb->buf + pos + len,",
          "new_line_content": "\tstrbuf_setlen(sb, sb->len + dlen - len);",
          "content_same": false
        },
        {
          "line": 170,
          "old_api": null,
          "new_api": "strbuf_splice",
          "old_text": null,
          "new_text": "strbuf_splice(sb, pos, 0, data, len)",
          "old_line_content": "",
          "new_line_content": "\tstrbuf_splice(sb, pos, 0, data, len);",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": null,
          "new_api": "strbuf_splice",
          "old_text": null,
          "new_text": "strbuf_splice(sb, pos, len, NULL, 0)",
          "old_line_content": "",
          "new_line_content": "\tstrbuf_splice(sb, pos, len, NULL, 0);",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": null,
          "new_api": "strbuf_grow",
          "old_text": null,
          "new_text": "strbuf_grow(sb, hint)",
          "old_line_content": "\twhile (hint < STRBUF_MAXLINK) {",
          "new_line_content": "\t\tstrbuf_grow(sb, hint);",
          "content_same": false
        },
        {
          "line": 307,
          "old_api": null,
          "new_api": "readlink",
          "old_text": null,
          "new_text": "readlink(path, sb->buf, hint)",
          "old_line_content": "\t\tint len;",
          "new_line_content": "\t\tlen = readlink(path, sb->buf, hint);",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": null,
          "new_api": "strbuf_grow",
          "old_text": null,
          "new_text": "strbuf_grow(sb, len)",
          "old_line_content": "",
          "new_line_content": "\tstrbuf_grow(sb, len);",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(sb->buf + sb->len, data, len)",
          "old_line_content": "void strbuf_add(struct strbuf *sb, const void *data, size_t len)",
          "new_line_content": "\tmemcpy(sb->buf + sb->len, data, len);",
          "content_same": false
        },
        {
          "line": 182,
          "old_api": null,
          "new_api": "strbuf_setlen",
          "old_text": null,
          "new_text": "strbuf_setlen(sb, sb->len + len)",
          "old_line_content": "{",
          "new_line_content": "\tstrbuf_setlen(sb, sb->len + len);",
          "content_same": false
        },
        {
          "line": 312,
          "old_api": null,
          "new_api": "strbuf_setlen",
          "old_text": null,
          "new_text": "strbuf_setlen(sb, len)",
          "old_line_content": "\t\t\tif (errno != ERANGE)",
          "new_line_content": "\t\t\tstrbuf_setlen(sb, len);",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": null,
          "new_api": "strbuf_grow",
          "old_text": null,
          "new_text": "strbuf_grow(sb, len)",
          "old_line_content": "",
          "new_line_content": "\tstrbuf_grow(sb, len);",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(sb->buf + sb->len, sb->buf + pos, len)",
          "old_line_content": "void strbuf_adddup(struct strbuf *sb, size_t pos, size_t len)",
          "new_line_content": "\tmemcpy(sb->buf + sb->len, sb->buf + pos, len);",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": null,
          "new_api": "strbuf_setlen",
          "old_text": null,
          "new_text": "strbuf_setlen(sb, sb->len + len)",
          "old_line_content": "{",
          "new_line_content": "\tstrbuf_setlen(sb, sb->len + len);",
          "content_same": false
        },
        {
          "line": 320,
          "old_api": null,
          "new_api": "strbuf_release",
          "old_text": null,
          "new_text": "strbuf_release(sb)",
          "old_line_content": "\t\thint *= 2;",
          "new_line_content": "\t\tstrbuf_release(sb);",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": null,
          "new_api": "strbuf_avail",
          "old_text": null,
          "new_text": "strbuf_avail(sb)",
          "old_line_content": "\tint len;",
          "new_line_content": "\tif (!strbuf_avail(sb))",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": null,
          "new_api": "strbuf_grow",
          "old_text": null,
          "new_text": "strbuf_grow(sb, 64)",
          "old_line_content": "\tva_list ap;",
          "new_line_content": "\t\tstrbuf_grow(sb, 64);",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": null,
          "new_api": "va_start",
          "old_text": null,
          "new_text": "va_start(ap, fmt)",
          "old_line_content": "",
          "new_line_content": "\tva_start(ap, fmt);",
          "content_same": false
        },
        {
          "line": 328,
          "old_api": null,
          "new_api": "strbuf_grow",
          "old_text": null,
          "new_text": "strbuf_grow(sb, 0)",
          "old_line_content": "{",
          "new_line_content": "\tstrbuf_grow(sb, 0);",
          "content_same": false
        },
        {
          "line": 329,
          "old_api": null,
          "new_api": "feof",
          "old_text": null,
          "new_text": "feof(fp)",
          "old_line_content": "\tint ch;",
          "new_line_content": "\tif (feof(fp))",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": null,
          "new_api": "strbuf_grow",
          "old_text": null,
          "new_text": "strbuf_grow(sb, len)",
          "old_line_content": "\tif (len < 0)",
          "new_line_content": "\t\tstrbuf_grow(sb, len);",
          "content_same": false
        },
        {
          "line": 333,
          "old_api": null,
          "new_api": "fgetc",
          "old_text": null,
          "new_text": "fgetc(fp)",
          "old_line_content": "\t\treturn EOF;",
          "new_line_content": "\twhile ((ch = fgetc(fp)) != EOF) {",
          "content_same": false
        },
        {
          "line": 350,
          "old_api": null,
          "new_api": "open",
          "old_text": null,
          "new_text": "open(path, O_RDONLY)",
          "old_line_content": "{",
          "new_line_content": "\tfd = open(path, O_RDONLY);",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": null,
          "new_api": "strchrnul",
          "old_text": null,
          "new_text": "strchrnul(format, '%')",
          "old_line_content": "\t\tconst char *percent;",
          "new_line_content": "\t\tpercent = strchrnul(format, '%');",
          "content_same": false
        },
        {
          "line": 224,
          "old_api": null,
          "new_api": "strbuf_add",
          "old_text": null,
          "new_text": "strbuf_add(sb, format, percent - format)",
          "old_line_content": "\t\tsize_t consumed;",
          "new_line_content": "\t\tstrbuf_add(sb, format, percent - format);",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "\tif (fd < 0)",
          "new_line_content": "\tclose(fd);",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": null,
          "new_api": "fn",
          "old_text": null,
          "new_text": "fn(sb, format, context)",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\tconsumed = fn(sb, format, context);",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": null,
          "new_api": "strbuf_addch",
          "old_text": null,
          "new_text": "strbuf_addch(sb, '%')",
          "old_line_content": "\t\tif (consumed)",
          "new_line_content": "\t\t\tstrbuf_addch(sb, '%');",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(e->placeholder)",
          "old_line_content": "\tstruct strbuf_expand_dict_entry *e = context;",
          "new_line_content": "\tfor (; e->placeholder && (len = strlen(e->placeholder)); e++) {",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": null,
          "new_api": "strncmp",
          "old_text": null,
          "new_text": "strncmp(placeholder, e->placeholder, len)",
          "old_line_content": "\tsize_t len;",
          "new_line_content": "\t\tif (!strncmp(placeholder, e->placeholder, len)) {",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 262,
          "old_api": "fread",
          "new_api": null,
          "old_text": "fread(sb->buf + sb->len, 1, size, f)",
          "new_text": null,
          "old_line_content": "\tres = fread(sb->buf + sb->len, 1, size, f);",
          "new_line_content": "\telse if (res < 0 && oldalloc == 0)",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": "strbuf_setlen",
          "new_api": null,
          "old_text": "strbuf_setlen(sb, sb->len + res)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_setlen(sb, sb->len + res);",
          "new_line_content": "\treturn res;",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": "strbuf_release",
          "new_api": null,
          "old_text": "strbuf_release(sb)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_release(sb);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(a->buf, b->buf, a->len)",
          "new_text": null,
          "old_line_content": "\t\tcmp = memcmp(a->buf, b->buf, a->len);",
          "new_line_content": "\tif (cmp)",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "memcmp",
          "new_api": null,
          "old_text": "memcmp(a->buf, b->buf, b->len)",
          "new_text": null,
          "old_line_content": "\t\tcmp = memcmp(a->buf, b->buf, b->len);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 275,
          "old_api": "strbuf_grow",
          "new_api": null,
          "old_text": "strbuf_grow(sb, hint ? hint : 8192)",
          "new_text": null,
          "old_line_content": "\tstrbuf_grow(sb, hint ? hint : 8192);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": "strbuf_release",
          "new_api": null,
          "old_text": "strbuf_release(sb)",
          "new_text": null,
          "old_line_content": "\t\t\t\tstrbuf_release(sb);",
          "new_line_content": "\t\t\treturn -1;",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"you want to use way too much memory\")",
          "new_text": null,
          "old_line_content": "\t\tdie(\"you want to use way too much memory\");",
          "new_line_content": "\tif (pos + len > sb->len)",
          "content_same": false
        },
        {
          "line": 284,
          "old_api": "strbuf_setlen",
          "new_api": null,
          "old_text": "strbuf_setlen(sb, oldlen)",
          "new_text": null,
          "old_line_content": "\t\t\t\tstrbuf_setlen(sb, oldlen);",
          "new_line_content": "\t\tif (!cnt)",
          "content_same": false
        },
        {
          "line": 158,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"`pos' is too far after the end of the buffer\")",
          "new_text": null,
          "old_line_content": "\t\tdie(\"`pos' is too far after the end of the buffer\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 290,
          "old_api": "strbuf_grow",
          "new_api": null,
          "old_text": "strbuf_grow(sb, 8192)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_grow(sb, 8192);",
          "new_line_content": "\tsb->buf[sb->len] = '\\0';",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": "strbuf_grow",
          "new_api": null,
          "old_text": "strbuf_grow(sb, dlen - len)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_grow(sb, dlen - len);",
          "new_line_content": "\t\t\tsb->len - pos - len);",
          "content_same": false
        },
        {
          "line": 167,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(sb->buf + pos, data, dlen)",
          "new_text": null,
          "old_line_content": "\tmemcpy(sb->buf + pos, data, dlen);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 168,
          "old_api": "strbuf_setlen",
          "new_api": null,
          "old_text": "strbuf_setlen(sb, sb->len + dlen - len)",
          "new_text": null,
          "old_line_content": "\tstrbuf_setlen(sb, sb->len + dlen - len);",
          "new_line_content": "void strbuf_insert(struct strbuf *sb, size_t pos, const void *data, size_t len)",
          "content_same": false
        },
        {
          "line": 173,
          "old_api": "strbuf_splice",
          "new_api": null,
          "old_text": "strbuf_splice(sb, pos, 0, data, len)",
          "new_text": null,
          "old_line_content": "\tstrbuf_splice(sb, pos, 0, data, len);",
          "new_line_content": "void strbuf_remove(struct strbuf *sb, size_t pos, size_t len)",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": "strbuf_splice",
          "new_api": null,
          "old_text": "strbuf_splice(sb, pos, len, NULL, 0)",
          "new_text": null,
          "old_line_content": "\tstrbuf_splice(sb, pos, len, NULL, 0);",
          "new_line_content": "void strbuf_add(struct strbuf *sb, const void *data, size_t len)",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": "strbuf_grow",
          "new_api": null,
          "old_text": "strbuf_grow(sb, hint)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_grow(sb, hint);",
          "new_line_content": "\t\t\tif (errno != ERANGE)",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": "readlink",
          "new_api": null,
          "old_text": "readlink(path, sb->buf, hint)",
          "new_text": null,
          "old_line_content": "\t\tlen = readlink(path, sb->buf, hint);",
          "new_line_content": "\t\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": "strbuf_grow",
          "new_api": null,
          "old_text": "strbuf_grow(sb, len)",
          "new_text": null,
          "old_line_content": "\tstrbuf_grow(sb, len);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 184,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(sb->buf + sb->len, data, len)",
          "new_text": null,
          "old_line_content": "\tmemcpy(sb->buf + sb->len, data, len);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": "strbuf_setlen",
          "new_api": null,
          "old_text": "strbuf_setlen(sb, sb->len + len)",
          "new_text": null,
          "old_line_content": "\tstrbuf_setlen(sb, sb->len + len);",
          "new_line_content": "void strbuf_adddup(struct strbuf *sb, size_t pos, size_t len)",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": "strbuf_setlen",
          "new_api": null,
          "old_text": "strbuf_setlen(sb, len)",
          "new_text": null,
          "old_line_content": "\t\t\tstrbuf_setlen(sb, len);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": "strbuf_grow",
          "new_api": null,
          "old_text": "strbuf_grow(sb, len)",
          "new_text": null,
          "old_line_content": "\tstrbuf_grow(sb, len);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(sb->buf + sb->len, sb->buf + pos, len)",
          "new_text": null,
          "old_line_content": "\tmemcpy(sb->buf + sb->len, sb->buf + pos, len);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": "strbuf_setlen",
          "new_api": null,
          "old_text": "strbuf_setlen(sb, sb->len + len)",
          "new_text": null,
          "old_line_content": "\tstrbuf_setlen(sb, sb->len + len);",
          "new_line_content": "void strbuf_addf(struct strbuf *sb, const char *fmt, ...)",
          "content_same": false
        },
        {
          "line": 323,
          "old_api": "strbuf_release",
          "new_api": null,
          "old_text": "strbuf_release(sb)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_release(sb);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": "va_start",
          "new_api": null,
          "old_text": "va_start(ap, fmt)",
          "new_text": null,
          "old_line_content": "\tva_start(ap, fmt);",
          "new_line_content": "\tif (len < 0)",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": "strbuf_grow",
          "new_api": null,
          "old_text": "strbuf_grow(sb, 0)",
          "new_text": null,
          "old_line_content": "\tstrbuf_grow(sb, 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": "strbuf_reset",
          "new_api": null,
          "old_text": "strbuf_reset(sb)",
          "new_text": null,
          "old_line_content": "\tstrbuf_reset(sb);",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "va_end",
          "new_api": null,
          "old_text": "va_end(ap)",
          "new_text": null,
          "old_line_content": "\t\tva_end(ap);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "strbuf_avail",
          "new_api": null,
          "old_text": "strbuf_avail(sb)",
          "new_text": null,
          "old_line_content": "\t\tif (len > strbuf_avail(sb)) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 339,
          "old_api": "strbuf_grow",
          "new_api": null,
          "old_text": "strbuf_grow(sb, 1)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_grow(sb, 1);",
          "new_line_content": "\tif (ch == EOF && sb->len == 0)",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": "strbuf_setlen",
          "new_api": null,
          "old_text": "strbuf_setlen(sb, sb->len + len)",
          "new_text": null,
          "old_line_content": "\tstrbuf_setlen(sb, sb->len + len);",
          "new_line_content": "void strbuf_expand(struct strbuf *sb, const char *format, expand_fn_t fn,",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": "strchrnul",
          "new_api": null,
          "old_text": "strchrnul(format, '%')",
          "new_text": null,
          "old_line_content": "\t\tpercent = strchrnul(format, '%');",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 227,
          "old_api": "strbuf_add",
          "new_api": null,
          "old_text": "strbuf_add(sb, format, percent - format)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_add(sb, format, percent - format);",
          "new_line_content": "\t\tformat = percent + 1;",
          "content_same": false
        },
        {
          "line": 356,
          "old_api": "strbuf_read",
          "new_api": null,
          "old_text": "strbuf_read(sb, fd, hint)",
          "new_text": null,
          "old_line_content": "\tlen = strbuf_read(sb, fd, hint);",
          "new_line_content": "\t\treturn -1;",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fd)",
          "new_text": null,
          "old_line_content": "\tclose(fd);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "fn",
          "new_api": null,
          "old_text": "fn(sb, format, context)",
          "new_text": null,
          "old_line_content": "\t\tconsumed = fn(sb, format, context);",
          "new_line_content": "\t\telse",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": "strbuf_addch",
          "new_api": null,
          "old_text": "strbuf_addch(sb, '%')",
          "new_text": null,
          "old_line_content": "\t\t\tstrbuf_addch(sb, '%');",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 247,
          "old_api": "strncmp",
          "new_api": null,
          "old_text": "strncmp(placeholder, e->placeholder, len)",
          "new_text": null,
          "old_line_content": "\t\tif (!strncmp(placeholder, e->placeholder, len)) {",
          "new_line_content": "\t\t\treturn len;",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": "strbuf_addstr",
          "new_api": null,
          "old_text": "strbuf_addstr(sb, e->value)",
          "new_text": null,
          "old_line_content": "\t\t\t\tstrbuf_addstr(sb, e->value);",
          "new_line_content": "\t}",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 18,
      "total_additions": 40,
      "total_deletions": 41,
      "total_api_changes": 99
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 8,
        "api_related_lines": 99,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          142,
          145,
          146,
          148,
          149
        ]
      }
    },
    "api_calls_before": 83,
    "api_calls_after": 82,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 8,
      "total_diff_lines": 25
    }
  }
}