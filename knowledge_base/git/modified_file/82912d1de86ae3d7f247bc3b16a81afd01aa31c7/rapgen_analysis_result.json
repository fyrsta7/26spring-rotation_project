{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/82912d1de86ae3d7f247bc3b16a81afd01aa31c7",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/82912d1de86ae3d7f247bc3b16a81afd01aa31c7/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/82912d1de86ae3d7f247bc3b16a81afd01aa31c7/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/82912d1de86ae3d7f247bc3b16a81afd01aa31c7/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 446,
          "old_api": "getc",
          "new_api": "flockfile",
          "old_text": "getc(fp)",
          "new_text": "flockfile(fp)",
          "old_line_content": "\twhile ((ch = getc(fp)) != EOF) {",
          "new_line_content": "\tflockfile(fp);",
          "content_same": false
        },
        {
          "line": 447,
          "old_api": "strbuf_grow",
          "new_api": "getc_unlocked",
          "old_text": "strbuf_grow(sb, 1)",
          "new_text": "getc_unlocked(fp)",
          "old_line_content": "\t\tstrbuf_grow(sb, 1);",
          "new_line_content": "\twhile ((ch = getc_unlocked(fp)) != EOF) {",
          "content_same": false
        },
        {
          "line": 556,
          "old_api": "strbuf_addch",
          "new_api": "is_rfc3986_unreserved",
          "old_text": "strbuf_addch(sb, ch)",
          "new_text": "is_rfc3986_unreserved(ch)",
          "old_line_content": "\t\t\tstrbuf_addch(sb, ch);",
          "new_line_content": "\t\tif (is_rfc3986_unreserved(ch) ||",
          "content_same": false
        },
        {
          "line": 558,
          "old_api": "strbuf_addf",
          "new_api": "strbuf_addch",
          "old_text": "strbuf_addf(sb, \"%%%02x\", ch)",
          "new_text": "strbuf_addch(sb, ch)",
          "old_line_content": "\t\t\tstrbuf_addf(sb, \"%%%02x\", ch);",
          "new_line_content": "\t\t\tstrbuf_addch(sb, ch);",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": "strcmp",
          "new_api": "xgetcwd",
          "old_text": "strcmp(pwd, cwd)",
          "new_text": "xgetcwd()",
          "old_line_content": "\t\tif (pwd && strcmp(pwd, cwd) &&",
          "new_line_content": "\t\tchar *cwd = xgetcwd();",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "stat",
          "new_api": "getenv",
          "old_text": "stat(cwd, &cwd_stat)",
          "new_text": "getenv(\"PWD\")",
          "old_line_content": "\t\t    !stat(cwd, &cwd_stat) &&",
          "new_line_content": "\t\tchar *pwd = getenv(\"PWD\");",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": "strbuf_addch",
          "new_api": "strbuf_addstr",
          "old_text": "strbuf_addch(sb, '/')",
          "new_text": "strbuf_addstr(sb, cwd)",
          "old_line_content": "\t\t\tstrbuf_addch(sb, '/');",
          "new_line_content": "\t\t\tstrbuf_addstr(sb, cwd);",
          "content_same": false
        },
        {
          "line": 607,
          "old_api": "free",
          "new_api": "is_dir_sep",
          "old_text": "free(cwd)",
          "new_text": "is_dir_sep(sb->buf[sb->len - 1])",
          "old_line_content": "\t\tfree(cwd);",
          "new_line_content": "\t\tif (sb->len > orig_len && !is_dir_sep(sb->buf[sb->len - 1]))",
          "content_same": false
        },
        {
          "line": 609,
          "old_api": "strbuf_addstr",
          "new_api": "free",
          "old_text": "strbuf_addstr(sb, path)",
          "new_text": "free(cwd)",
          "old_line_content": "\tstrbuf_addstr(sb, path);",
          "new_line_content": "\t\tfree(cwd);",
          "content_same": false
        },
        {
          "line": 618,
          "old_api": "va_end",
          "new_api": "va_start",
          "old_text": "va_end(ap)",
          "new_text": "va_start(ap, fmt)",
          "old_line_content": "\tva_end(ap);",
          "new_line_content": "\tva_start(ap, fmt);",
          "content_same": false
        },
        {
          "line": 619,
          "old_api": "putchar",
          "new_api": "vprintf",
          "old_text": "putchar('\\n')",
          "new_text": "vprintf(fmt, ap)",
          "old_line_content": "\tif (ret < 0 || putchar('\\n') == EOF)",
          "new_line_content": "\tret = vprintf(fmt, ap);",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": "va_end",
          "new_api": "va_start",
          "old_text": "va_end(ap)",
          "new_text": "va_start(ap, fmt)",
          "old_line_content": "\tva_end(ap);",
          "new_line_content": "\tva_start(ap, fmt);",
          "content_same": false
        },
        {
          "line": 631,
          "old_api": "putc",
          "new_api": "vfprintf",
          "old_text": "putc('\\n', fp)",
          "new_text": "vfprintf(fp, fmt, ap)",
          "old_line_content": "\tif (ret < 0 || putc('\\n', fp) == EOF)",
          "new_line_content": "\tret = vfprintf(fp, fmt, ap);",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": "tolower",
          "new_api": "xmalloc",
          "old_text": "tolower(string[i])",
          "new_text": "xmalloc(len + 1)",
          "old_line_content": "\t\tresult[i] = tolower(string[i]);",
          "new_line_content": "\tresult = xmalloc(len + 1);",
          "content_same": false
        },
        {
          "line": 663,
          "old_api": "va_end",
          "new_api": "va_start",
          "old_text": "va_end(ap)",
          "new_text": "va_start(ap, fmt)",
          "old_line_content": "\tva_end(ap);",
          "new_line_content": "\tva_start(ap, fmt);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 515,
          "old_api": null,
          "new_api": "strbuf_addstr",
          "old_text": null,
          "new_text": "strbuf_addstr(buf, \"&quot;\")",
          "old_line_content": "\t\tcase '<':",
          "new_line_content": "\t\t\tstrbuf_addstr(buf, \"&quot;\");",
          "content_same": false
        },
        {
          "line": 643,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(string)",
          "old_line_content": "\tfor (i = 0; i < len; i++)",
          "new_line_content": "\tlen = strlen(string);",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": null,
          "new_api": "strbuf_addstr",
          "old_text": null,
          "new_text": "strbuf_addstr(buf, \"&lt;\")",
          "old_line_content": "\t\tcase '>':",
          "new_line_content": "\t\t\tstrbuf_addstr(buf, \"&lt;\");",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": null,
          "new_api": "tolower",
          "old_text": null,
          "new_text": "tolower(string[i])",
          "old_line_content": "\treturn result;",
          "new_line_content": "\t\tresult[i] = tolower(string[i]);",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": null,
          "new_api": "strbuf_addstr",
          "old_text": null,
          "new_text": "strbuf_addstr(buf, \"&gt;\")",
          "old_line_content": "\t\tcase '&':",
          "new_line_content": "\t\t\tstrbuf_addstr(buf, \"&gt;\");",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": null,
          "new_api": "strbuf_addstr",
          "old_text": null,
          "new_text": "strbuf_addstr(buf, \"&amp;\")",
          "old_line_content": "\t\tcase 0:",
          "new_line_content": "\t\t\tstrbuf_addstr(buf, \"&amp;\");",
          "content_same": false
        },
        {
          "line": 654,
          "old_api": null,
          "new_api": "strbuf_vaddf",
          "old_text": null,
          "new_text": "strbuf_vaddf(&buf, fmt, ap)",
          "old_line_content": "}",
          "new_line_content": "\tstrbuf_vaddf(&buf, fmt, ap);",
          "content_same": false
        },
        {
          "line": 655,
          "old_api": null,
          "new_api": "strbuf_detach",
          "old_text": null,
          "new_text": "strbuf_detach(&buf, NULL)",
          "old_line_content": "",
          "new_line_content": "\treturn strbuf_detach(&buf, NULL);",
          "content_same": false
        },
        {
          "line": 664,
          "old_api": null,
          "new_api": "xstrvfmt",
          "old_text": null,
          "new_text": "xstrvfmt(fmt, ap)",
          "old_line_content": "",
          "new_line_content": "\tret = xstrvfmt(fmt, ap);",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": null,
          "new_api": "va_end",
          "old_text": null,
          "new_text": "va_end(ap)",
          "old_line_content": "\treturn ret;",
          "new_line_content": "\tva_end(ap);",
          "content_same": false
        },
        {
          "line": 546,
          "old_api": null,
          "new_api": "isalnum",
          "old_text": null,
          "new_text": "isalnum(ch)",
          "old_line_content": "}",
          "new_line_content": "\treturn isalnum(ch) ||",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": null,
          "new_api": "strbuf_grow",
          "old_text": null,
          "new_text": "strbuf_grow(sb, len)",
          "old_line_content": "\t\tchar ch = *s++;",
          "new_line_content": "\tstrbuf_grow(sb, len);",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": null,
          "new_api": "is_rfc3986_reserved",
          "old_text": null,
          "new_text": "is_rfc3986_reserved(ch)",
          "old_line_content": "\t\telse",
          "new_line_content": "\t\t    (!reserved && is_rfc3986_reserved(ch)))",
          "content_same": false
        },
        {
          "line": 560,
          "old_api": null,
          "new_api": "strbuf_addf",
          "old_text": null,
          "new_text": "strbuf_addf(sb, \"%%%02x\", ch)",
          "old_line_content": "}",
          "new_line_content": "\t\t\tstrbuf_addf(sb, \"%%%02x\", ch);",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(s)",
          "old_line_content": "",
          "new_line_content": "\tstrbuf_add_urlencode(sb, s, strlen(s), reserved);",
          "content_same": false
        },
        {
          "line": 573,
          "old_api": null,
          "new_api": "strbuf_addf",
          "old_text": null,
          "new_text": "strbuf_addf(buf, \"%u.%2.2u GiB\",\n\t\t\t    (int)(bytes >> 30),\n\t\t\t    (int)(bytes & ((1 << 30) - 1)) / 10737419)",
          "old_line_content": "\t\t\t    (int)(bytes & ((1 << 30) - 1)) / 10737419);",
          "new_line_content": "\t\tstrbuf_addf(buf, \"%u.%2.2u GiB\",",
          "content_same": false
        },
        {
          "line": 448,
          "old_api": null,
          "new_api": "strbuf_grow",
          "old_text": null,
          "new_text": "strbuf_grow(sb, 1)",
          "old_line_content": "\t\tsb->buf[sb->len++] = ch;",
          "new_line_content": "\t\tstrbuf_grow(sb, 1);",
          "content_same": false
        },
        {
          "line": 578,
          "old_api": null,
          "new_api": "strbuf_addf",
          "old_text": null,
          "new_text": "strbuf_addf(buf, \"%u.%2.2u MiB\",\n\t\t\t    x >> 20, ((x & ((1 << 20) - 1)) * 100) >> 20)",
          "old_line_content": "\t} else if (bytes > 1 << 10) {",
          "new_line_content": "\t\tstrbuf_addf(buf, \"%u.%2.2u MiB\",",
          "content_same": false
        },
        {
          "line": 453,
          "old_api": null,
          "new_api": "funlockfile",
          "old_text": null,
          "new_text": "funlockfile(fp)",
          "old_line_content": "\t\treturn EOF;",
          "new_line_content": "\tfunlockfile(fp);",
          "content_same": false
        },
        {
          "line": 582,
          "old_api": null,
          "new_api": "strbuf_addf",
          "old_text": null,
          "new_text": "strbuf_addf(buf, \"%u.%2.2u KiB\",\n\t\t\t    x >> 10, ((x & ((1 << 10) - 1)) * 100) >> 10)",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\tstrbuf_addf(buf, \"%u.%2.2u KiB\",",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": null,
          "new_api": "strbuf_addf",
          "old_text": null,
          "new_text": "strbuf_addf(buf, \"%u bytes\", (int)bytes)",
          "old_line_content": "}",
          "new_line_content": "\t\tstrbuf_addf(buf, \"%u bytes\", (int)bytes);",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": null,
          "new_api": "strbuf_getwholeline",
          "old_text": null,
          "new_text": "strbuf_getwholeline(sb, fp, term)",
          "old_line_content": "\tif (sb->buf[sb->len-1] == term)",
          "new_line_content": "\tif (strbuf_getwholeline(sb, fp, term))",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"The empty string is not a valid path\")",
          "old_line_content": "\t\tstruct stat cwd_stat, pwd_stat;",
          "new_line_content": "\t\tdie(\"The empty string is not a valid path\");",
          "content_same": false
        },
        {
          "line": 593,
          "old_api": null,
          "new_api": "is_absolute_path",
          "old_text": null,
          "new_text": "is_absolute_path(path)",
          "old_line_content": "\t\tsize_t orig_len = sb->len;",
          "new_line_content": "\tif (!is_absolute_path(path)) {",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": null,
          "new_api": "strbuf_setlen",
          "old_text": null,
          "new_text": "strbuf_setlen(sb, sb->len-1)",
          "old_line_content": "}",
          "new_line_content": "\t\tstrbuf_setlen(sb, sb->len-1);",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(pwd, cwd)",
          "old_line_content": "\t\t    (cwd_stat.st_dev || cwd_stat.st_ino) &&",
          "new_line_content": "\t\tif (pwd && strcmp(pwd, cwd) &&",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": null,
          "new_api": "strbuf_reset",
          "old_text": null,
          "new_text": "strbuf_reset(sb)",
          "old_line_content": "\twhile (1) {",
          "new_line_content": "\tstrbuf_reset(sb);",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": null,
          "new_api": "stat",
          "old_text": null,
          "new_text": "stat(pwd, &pwd_stat)",
          "old_line_content": "\t\t    pwd_stat.st_ino == cwd_stat.st_ino)",
          "new_line_content": "\t\t    !stat(pwd, &pwd_stat) &&",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": null,
          "new_api": "xread",
          "old_text": null,
          "new_text": "xread(fd, &ch, 1)",
          "old_line_content": "\t\t\treturn EOF;",
          "new_line_content": "\t\tssize_t len = xread(fd, &ch, 1);",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": null,
          "new_api": "strbuf_addch",
          "old_text": null,
          "new_text": "strbuf_addch(sb, ch)",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\tstrbuf_addch(sb, ch);",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "strbuf_addch",
          "old_text": null,
          "new_text": "strbuf_addch(sb, '/')",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tstrbuf_addch(sb, '/');",
          "content_same": false
        },
        {
          "line": 611,
          "old_api": null,
          "new_api": "strbuf_addstr",
          "old_text": null,
          "new_text": "strbuf_addstr(sb, path)",
          "old_line_content": "",
          "new_line_content": "\tstrbuf_addstr(sb, path);",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": null,
          "new_api": "add_lines",
          "old_text": null,
          "new_text": "add_lines(out, prefix, NULL, buf, size)",
          "old_line_content": "",
          "new_line_content": "\tadd_lines(out, prefix, NULL, buf, size);",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": null,
          "new_api": "open",
          "old_text": null,
          "new_text": "open(path, O_RDONLY)",
          "old_line_content": "\t\treturn -1;",
          "new_line_content": "\tfd = open(path, O_RDONLY);",
          "content_same": false
        },
        {
          "line": 620,
          "old_api": null,
          "new_api": "va_end",
          "old_text": null,
          "new_text": "va_end(ap)",
          "old_line_content": "\t\treturn -1;",
          "new_line_content": "\tva_end(ap);",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": null,
          "new_api": "putchar",
          "old_text": null,
          "new_text": "putchar('\\n')",
          "old_line_content": "\treturn ret + 1;",
          "new_line_content": "\tif (ret < 0 || putchar('\\n') == EOF)",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": null,
          "new_api": "strbuf_read",
          "old_text": null,
          "new_text": "strbuf_read(sb, fd, hint)",
          "old_line_content": "\tif (len < 0)",
          "new_line_content": "\tlen = strbuf_read(sb, fd, hint);",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "\t\treturn -1;",
          "new_line_content": "\tclose(fd);",
          "content_same": false
        },
        {
          "line": 632,
          "old_api": null,
          "new_api": "va_end",
          "old_text": null,
          "new_text": "va_end(ap)",
          "old_line_content": "\t\treturn -1;",
          "new_line_content": "\tva_end(ap);",
          "content_same": false
        },
        {
          "line": 633,
          "old_api": null,
          "new_api": "putc",
          "old_text": null,
          "new_text": "putc('\\n', fp)",
          "old_line_content": "\treturn ret + 1;",
          "new_line_content": "\tif (ret < 0 || putc('\\n', fp) == EOF)",
          "content_same": false
        },
        {
          "line": 510,
          "old_api": null,
          "new_api": "strcspn",
          "old_text": null,
          "new_text": "strcspn(s, \"\\\"<>&\")",
          "old_line_content": "\t\ts += len;",
          "new_line_content": "\t\tsize_t len = strcspn(s, \"\\\"<>&\");",
          "content_same": false
        },
        {
          "line": 511,
          "old_api": null,
          "new_api": "strbuf_add",
          "old_text": null,
          "new_text": "strbuf_add(buf, s, len)",
          "old_line_content": "\t\tswitch (*s) {",
          "new_line_content": "\t\tstrbuf_add(buf, s, len);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 513,
          "old_api": "strbuf_addstr",
          "new_api": null,
          "old_text": "strbuf_addstr(buf, \"&quot;\")",
          "new_text": null,
          "old_line_content": "\t\t\tstrbuf_addstr(buf, \"&quot;\");",
          "new_line_content": "\t\tswitch (*s) {",
          "content_same": false
        },
        {
          "line": 641,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(string)",
          "new_text": null,
          "old_line_content": "\tlen = strlen(string);",
          "new_line_content": "\tsize_t len, i;",
          "content_same": false
        },
        {
          "line": 642,
          "old_api": "xmalloc",
          "new_api": null,
          "old_text": "xmalloc(len + 1)",
          "new_text": null,
          "old_line_content": "\tresult = xmalloc(len + 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 516,
          "old_api": "strbuf_addstr",
          "new_api": null,
          "old_text": "strbuf_addstr(buf, \"&lt;\")",
          "new_text": null,
          "old_line_content": "\t\t\tstrbuf_addstr(buf, \"&lt;\");",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 519,
          "old_api": "strbuf_addstr",
          "new_api": null,
          "old_text": "strbuf_addstr(buf, \"&gt;\")",
          "new_text": null,
          "old_line_content": "\t\t\tstrbuf_addstr(buf, \"&gt;\");",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": "strbuf_addstr",
          "new_api": null,
          "old_text": "strbuf_addstr(buf, \"&amp;\")",
          "new_text": null,
          "old_line_content": "\t\t\tstrbuf_addstr(buf, \"&amp;\");",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 652,
          "old_api": "strbuf_vaddf",
          "new_api": null,
          "old_text": "strbuf_vaddf(&buf, fmt, ap)",
          "new_text": null,
          "old_line_content": "\tstrbuf_vaddf(&buf, fmt, ap);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 653,
          "old_api": "strbuf_detach",
          "new_api": null,
          "old_text": "strbuf_detach(&buf, NULL)",
          "new_text": null,
          "old_line_content": "\treturn strbuf_detach(&buf, NULL);",
          "new_line_content": "\tstruct strbuf buf = STRBUF_INIT;",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": "va_start",
          "new_api": null,
          "old_text": "va_start(ap, fmt)",
          "new_text": null,
          "old_line_content": "\tva_start(ap, fmt);",
          "new_line_content": "\tchar *ret;",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": "xstrvfmt",
          "new_api": null,
          "old_text": "xstrvfmt(fmt, ap)",
          "new_text": null,
          "old_line_content": "\tret = xstrvfmt(fmt, ap);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 544,
          "old_api": "isalnum",
          "new_api": null,
          "old_text": "isalnum(ch)",
          "new_text": null,
          "old_line_content": "\treturn isalnum(ch) ||",
          "new_line_content": "static int is_rfc3986_unreserved(char ch)",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": "strbuf_grow",
          "new_api": null,
          "old_text": "strbuf_grow(sb, len)",
          "new_text": null,
          "old_line_content": "\tstrbuf_grow(sb, len);",
          "new_line_content": "\t\t\t\t int reserved)",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": "is_rfc3986_unreserved",
          "new_api": null,
          "old_text": "is_rfc3986_unreserved(ch)",
          "new_text": null,
          "old_line_content": "\t\tif (is_rfc3986_unreserved(ch) ||",
          "new_line_content": "\twhile (len--) {",
          "content_same": false
        },
        {
          "line": 555,
          "old_api": "is_rfc3986_reserved",
          "new_api": null,
          "old_text": "is_rfc3986_reserved(ch)",
          "new_text": null,
          "old_line_content": "\t\t    (!reserved && is_rfc3986_reserved(ch)))",
          "new_line_content": "\t\tchar ch = *s++;",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(s)",
          "new_text": null,
          "old_line_content": "\tstrbuf_add_urlencode(sb, s, strlen(s), reserved);",
          "new_line_content": "\t\t\t     int reserved)",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": "strbuf_addf",
          "new_api": null,
          "old_text": "strbuf_addf(buf, \"%u.%2.2u GiB\",\n\t\t\t    (int)(bytes >> 30),\n\t\t\t    (int)(bytes & ((1 << 30) - 1)) / 10737419)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_addf(buf, \"%u.%2.2u GiB\",",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": "strbuf_addf",
          "new_api": null,
          "old_text": "strbuf_addf(buf, \"%u.%2.2u MiB\",\n\t\t\t    x >> 20, ((x & ((1 << 20) - 1)) * 100) >> 20)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_addf(buf, \"%u.%2.2u MiB\",",
          "new_line_content": "\t} else if (bytes > 1 << 20) {",
          "content_same": false
        },
        {
          "line": 580,
          "old_api": "strbuf_addf",
          "new_api": null,
          "old_text": "strbuf_addf(buf, \"%u.%2.2u KiB\",\n\t\t\t    x >> 10, ((x & ((1 << 10) - 1)) * 100) >> 10)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_addf(buf, \"%u.%2.2u KiB\",",
          "new_line_content": "\t} else if (bytes > 1 << 10) {",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": "strbuf_addf",
          "new_api": null,
          "old_text": "strbuf_addf(buf, \"%u bytes\", (int)bytes)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_addf(buf, \"%u bytes\", (int)bytes);",
          "new_line_content": "\t\t\t    x >> 10, ((x & ((1 << 10) - 1)) * 100) >> 10);",
          "content_same": false
        },
        {
          "line": 461,
          "old_api": "strbuf_getwholeline",
          "new_api": null,
          "old_text": "strbuf_getwholeline(sb, fp, term)",
          "new_text": null,
          "old_line_content": "\tif (strbuf_getwholeline(sb, fp, term))",
          "new_line_content": "int strbuf_getline(struct strbuf *sb, FILE *fp, int term)",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"The empty string is not a valid path\")",
          "new_text": null,
          "old_line_content": "\t\tdie(\"The empty string is not a valid path\");",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 591,
          "old_api": "is_absolute_path",
          "new_api": null,
          "old_text": "is_absolute_path(path)",
          "new_text": null,
          "old_line_content": "\tif (!is_absolute_path(path)) {",
          "new_line_content": "\tif (!*path)",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": "strbuf_setlen",
          "new_api": null,
          "old_text": "strbuf_setlen(sb, sb->len-1)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_setlen(sb, sb->len-1);",
          "new_line_content": "\t\treturn EOF;",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": "xgetcwd",
          "new_api": null,
          "old_text": "xgetcwd()",
          "new_text": null,
          "old_line_content": "\t\tchar *cwd = xgetcwd();",
          "new_line_content": "\t\tstruct stat cwd_stat, pwd_stat;",
          "content_same": false
        },
        {
          "line": 595,
          "old_api": "getenv",
          "new_api": null,
          "old_text": "getenv(\"PWD\")",
          "new_text": null,
          "old_line_content": "\t\tchar *pwd = getenv(\"PWD\");",
          "new_line_content": "\t\tsize_t orig_len = sb->len;",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": "strbuf_reset",
          "new_api": null,
          "old_text": "strbuf_reset(sb)",
          "new_text": null,
          "old_line_content": "\tstrbuf_reset(sb);",
          "new_line_content": "int strbuf_getwholeline_fd(struct strbuf *sb, int fd, int term)",
          "content_same": false
        },
        {
          "line": 602,
          "old_api": "strbuf_addstr",
          "new_api": null,
          "old_text": "strbuf_addstr(sb, pwd)",
          "new_text": null,
          "old_line_content": "\t\t\tstrbuf_addstr(sb, pwd);",
          "new_line_content": "\t\t    pwd_stat.st_dev == cwd_stat.st_dev &&",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": "xread",
          "new_api": null,
          "old_text": "xread(fd, &ch, 1)",
          "new_text": null,
          "old_line_content": "\t\tssize_t len = xread(fd, &ch, 1);",
          "new_line_content": "\twhile (1) {",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": "is_dir_sep",
          "new_api": null,
          "old_text": "is_dir_sep(sb->buf[sb->len - 1])",
          "new_text": null,
          "old_line_content": "\t\tif (sb->len > orig_len && !is_dir_sep(sb->buf[sb->len - 1]))",
          "new_line_content": "\t\telse",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": "strbuf_addch",
          "new_api": null,
          "old_text": "strbuf_addch(sb, ch)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_addch(sb, ch);",
          "new_line_content": "\t\tif (len <= 0)",
          "content_same": false
        },
        {
          "line": 616,
          "old_api": "va_start",
          "new_api": null,
          "old_text": "va_start(ap, fmt)",
          "new_text": null,
          "old_line_content": "\tva_start(ap, fmt);",
          "new_line_content": "\tint ret;",
          "content_same": false
        },
        {
          "line": 617,
          "old_api": "vprintf",
          "new_api": null,
          "old_text": "vprintf(fmt, ap)",
          "new_text": null,
          "old_line_content": "\tret = vprintf(fmt, ap);",
          "new_line_content": "\tva_list ap;",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": "open",
          "new_api": null,
          "old_text": "open(path, O_RDONLY)",
          "new_text": null,
          "old_line_content": "\tfd = open(path, O_RDONLY);",
          "new_line_content": "\tint fd, len;",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": "strbuf_read",
          "new_api": null,
          "old_text": "strbuf_read(sb, fd, hint)",
          "new_text": null,
          "old_line_content": "\tlen = strbuf_read(sb, fd, hint);",
          "new_line_content": "\tif (fd < 0)",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fd)",
          "new_text": null,
          "old_line_content": "\tclose(fd);",
          "new_line_content": "\t\treturn -1;",
          "content_same": false
        },
        {
          "line": 628,
          "old_api": "va_start",
          "new_api": null,
          "old_text": "va_start(ap, fmt)",
          "new_text": null,
          "old_line_content": "\tva_start(ap, fmt);",
          "new_line_content": "\tint ret;",
          "content_same": false
        },
        {
          "line": 629,
          "old_api": "vfprintf",
          "new_api": null,
          "old_text": "vfprintf(fp, fmt, ap)",
          "new_text": null,
          "old_line_content": "\tret = vfprintf(fp, fmt, ap);",
          "new_line_content": "\tva_list ap;",
          "content_same": false
        },
        {
          "line": 502,
          "old_api": "add_lines",
          "new_api": null,
          "old_text": "add_lines(out, prefix, NULL, buf, size)",
          "new_text": null,
          "old_line_content": "\tadd_lines(out, prefix, NULL, buf, size);",
          "new_line_content": "\t\t      const char *buf, size_t size)",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": "strcspn",
          "new_api": null,
          "old_text": "strcspn(s, \"\\\"<>&\")",
          "new_text": null,
          "old_line_content": "\t\tsize_t len = strcspn(s, \"\\\"<>&\");",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 509,
          "old_api": "strbuf_add",
          "new_api": null,
          "old_text": "strbuf_add(buf, s, len)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_add(buf, s, len);",
          "new_line_content": "\twhile (*s) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 15,
      "total_additions": 42,
      "total_deletions": 40,
      "total_api_changes": 97
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 97,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 165,
    "api_calls_after": 167,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 1,
      "total_diff_lines": 21
    }
  }
}