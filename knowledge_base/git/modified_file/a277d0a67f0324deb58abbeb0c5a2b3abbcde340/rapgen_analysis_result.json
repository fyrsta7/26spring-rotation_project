{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/a277d0a67f0324deb58abbeb0c5a2b3abbcde340",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/a277d0a67f0324deb58abbeb0c5a2b3abbcde340/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/a277d0a67f0324deb58abbeb0c5a2b3abbcde340/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/a277d0a67f0324deb58abbeb0c5a2b3abbcde340/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 242,
          "old_api": "strbuf_reset",
          "new_api": "strbuf_addstr",
          "old_text": "strbuf_reset(sb)",
          "new_text": "strbuf_addstr(sb, unset ? \"--no-\" : \"--\")",
          "old_line_content": "\tstrbuf_reset(sb);",
          "new_line_content": "\t\tstrbuf_addstr(sb, unset ? \"--no-\" : \"--\");",
          "content_same": false
        },
        {
          "line": 245,
          "old_api": "strbuf_addstr",
          "new_api": "strbuf_addch",
          "old_text": "strbuf_addstr(sb, unset ? \"--no-\" : \"--\")",
          "new_text": "strbuf_addch(sb, '=')",
          "old_line_content": "\t\tstrbuf_addstr(sb, unset ? \"--no-\" : \"--\");",
          "new_line_content": "\t\t\tstrbuf_addch(sb, '=');",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": "strbuf_addstr",
          "new_api": "strbuf_addch",
          "old_text": "strbuf_addstr(sb, arg)",
          "new_text": "strbuf_addch(sb, '-')",
          "old_line_content": "\t\t\tstrbuf_addstr(sb, arg);",
          "new_line_content": "\t\tstrbuf_addch(sb, '-');",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": "strbuf_addch",
          "new_api": "strbuf_addstr",
          "old_text": "strbuf_addch(sb, '-')",
          "new_text": "strbuf_addstr(sb, arg)",
          "old_line_content": "\t\tstrbuf_addch(sb, '-');",
          "new_line_content": "\t\t\tstrbuf_addstr(sb, arg);",
          "content_same": false
        },
        {
          "line": 274,
          "old_api": "recreate_opt",
          "new_api": "free",
          "old_text": "recreate_opt(&sb, opt, arg, unset)",
          "new_text": "free(*opt_value)",
          "old_line_content": "\tif (recreate_opt(&sb, opt, arg, unset) < 0)",
          "new_line_content": "\tfree(*opt_value);",
          "content_same": false
        },
        {
          "line": 295,
          "old_api": "recreate_opt",
          "new_api": "argv_array_push",
          "old_text": "recreate_opt(&sb, opt, arg, unset)",
          "new_text": "argv_array_push(opt_value, sb.buf)",
          "old_line_content": "\tif (recreate_opt(&sb, opt, arg, unset) < 0)",
          "new_line_content": "\targv_array_push(opt_value, sb.buf);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 192,
          "old_api": null,
          "new_api": "COPY_ARRAY",
          "old_text": null,
          "new_text": "COPY_ARRAY(ret + a_len, b, b_len + 1)",
          "old_line_content": "\t\tret[i] = a[i];",
          "new_line_content": "\tCOPY_ARRAY(ret + a_len, b, b_len + 1); /* + 1 for final OPTION_END */",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": null,
          "new_api": "recreate_opt",
          "old_text": null,
          "new_text": "recreate_opt(&sb, opt, arg, unset)",
          "old_line_content": "\tstatic struct strbuf sb = STRBUF_INIT;",
          "new_line_content": "\tif (recreate_opt(&sb, opt, arg, unset) < 0)",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": null,
          "new_api": "BUG_ON_OPT_ARG",
          "old_text": null,
          "new_text": "BUG_ON_OPT_ARG(arg)",
          "old_line_content": "\t\t\t\t\t   const struct option *opt,",
          "new_line_content": "\tBUG_ON_OPT_ARG(arg);",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": null,
          "new_api": "string_list_clear",
          "old_text": null,
          "new_text": "string_list_clear(v, 0)",
          "old_line_content": "\tstruct string_list *v = opt->value;",
          "new_line_content": "\t\tstring_list_clear(v, 0);",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": null,
          "new_api": "recreate_opt",
          "old_text": null,
          "new_text": "recreate_opt(&sb, opt, arg, unset)",
          "old_line_content": "\tstatic struct strbuf sb = STRBUF_INIT;",
          "new_line_content": "\tif (recreate_opt(&sb, opt, arg, unset) < 0)",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": null,
          "new_api": "strbuf_reset",
          "old_text": null,
          "new_text": "strbuf_reset(sb)",
          "old_line_content": "static int recreate_opt(struct strbuf *sb, const struct option *opt,",
          "new_line_content": "\tstrbuf_reset(sb);",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": null,
          "new_api": "string_list_append",
          "old_text": null,
          "new_text": "string_list_append(v, arg)",
          "old_line_content": "\tif (!arg)",
          "new_line_content": "\tstring_list_append(v, arg);",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": null,
          "new_api": "strbuf_addstr",
          "old_text": null,
          "new_text": "strbuf_addstr(sb, opt->long_name)",
          "old_line_content": "",
          "new_line_content": "\t\tstrbuf_addstr(sb, opt->long_name);",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": null,
          "new_api": "strbuf_detach",
          "old_text": null,
          "new_text": "strbuf_detach(&sb, NULL)",
          "old_line_content": "",
          "new_line_content": "\t*opt_value = strbuf_detach(&sb, NULL);",
          "content_same": false
        },
        {
          "line": 250,
          "old_api": null,
          "new_api": "strbuf_addch",
          "old_text": null,
          "new_text": "strbuf_addch(sb, opt->short_name)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tstrbuf_addch(sb, opt->short_name);",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": null,
          "new_api": "COPY_ARRAY",
          "old_text": null,
          "new_text": "COPY_ARRAY(ret, a, a_len)",
          "old_line_content": "\tfor (i = 0; i < a_len; i++)",
          "new_line_content": "\tCOPY_ARRAY(ret, a, a_len);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 232,
          "old_api": "BUG_ON_OPT_ARG",
          "new_api": null,
          "old_text": "BUG_ON_OPT_ARG(arg)",
          "new_text": null,
          "old_line_content": "\tBUG_ON_OPT_ARG(arg);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": "argv_array_push",
          "new_api": null,
          "old_text": "argv_array_push(opt_value, sb.buf)",
          "new_text": null,
          "old_line_content": "\targv_array_push(opt_value, sb.buf);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "string_list_clear",
          "new_api": null,
          "old_text": "string_list_clear(v, 0)",
          "new_text": null,
          "old_line_content": "\t\tstring_list_clear(v, 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "string_list_append",
          "new_api": null,
          "old_text": "string_list_append(v, arg)",
          "new_text": null,
          "old_line_content": "\tstring_list_append(v, arg);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(*opt_value)",
          "new_text": null,
          "old_line_content": "\tfree(*opt_value);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": "strbuf_detach",
          "new_api": null,
          "old_text": "strbuf_detach(&sb, NULL)",
          "new_text": null,
          "old_line_content": "\t*opt_value = strbuf_detach(&sb, NULL);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": "strbuf_addch",
          "new_api": null,
          "old_text": "strbuf_addch(sb, '=')",
          "new_text": null,
          "old_line_content": "\t\t\tstrbuf_addch(sb, '=');",
          "new_line_content": "\t} else if (opt->short_name && !unset) {",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": "strbuf_addch",
          "new_api": null,
          "old_text": "strbuf_addch(sb, opt->short_name)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_addch(sb, opt->short_name);",
          "new_line_content": "\t} else",
          "content_same": false
        },
        {
          "line": 255,
          "old_api": "strbuf_addstr",
          "new_api": null,
          "old_text": "strbuf_addstr(sb, arg)",
          "new_text": null,
          "old_line_content": "\t\t\tstrbuf_addstr(sb, arg);",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 6,
      "total_additions": 11,
      "total_deletions": 9,
      "total_api_changes": 26
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 26,
        "non_api_lines": 3,
        "non_api_line_numbers": [
          193,
          194,
          195
        ]
      }
    },
    "api_calls_before": 52,
    "api_calls_after": 54,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 5,
      "total_diff_lines": 19
    }
  }
}