{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/5cf7a17dfbe60ea3cfb32ace7264edc3ad97611b",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/5cf7a17dfbe60ea3cfb32ace7264edc3ad97611b/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/5cf7a17dfbe60ea3cfb32ace7264edc3ad97611b/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/git/modified_file/5cf7a17dfbe60ea3cfb32ace7264edc3ad97611b/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 94,
          "old_api": "feed_object",
          "new_api": "xfdopen",
          "old_text": "feed_object(&extra->oid[i], po_in, 1)",
          "new_text": "xfdopen(po.in, \"w\")",
          "old_line_content": "\t\tfeed_object(&extra->oid[i], po_in, 1);",
          "new_line_content": "\tpo_in = xfdopen(po.in, \"w\");",
          "content_same": false
        },
        {
          "line": 106,
          "old_api": "die_errno",
          "new_api": "fflush",
          "old_text": "die_errno(\"error writing to pack-objects\")",
          "new_text": "fflush(po_in)",
          "old_line_content": "\t\tdie_errno(\"error writing to pack-objects\");",
          "new_line_content": "\tfflush(po_in);",
          "content_same": false
        },
        {
          "line": 107,
          "old_api": "fclose",
          "new_api": "ferror",
          "old_text": "fclose(po_in)",
          "new_text": "ferror(po_in)",
          "old_line_content": "\tfclose(po_in);",
          "new_line_content": "\tif (ferror(po_in))",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": "xread",
          "new_api": "xmalloc",
          "old_text": "xread(po.out, buf, LARGE_PACKET_MAX)",
          "new_text": "xmalloc(LARGE_PACKET_MAX)",
          "old_line_content": "\t\t\tssize_t n = xread(po.out, buf, LARGE_PACKET_MAX);",
          "new_line_content": "\t\tchar *buf = xmalloc(LARGE_PACKET_MAX);",
          "content_same": false
        },
        {
          "line": 117,
          "old_api": "free",
          "new_api": "send_sideband",
          "old_text": "free(buf)",
          "new_text": "send_sideband(fd, -1, buf, n, LARGE_PACKET_MAX)",
          "old_line_content": "\t\tfree(buf);",
          "new_line_content": "\t\t\tsend_sideband(fd, -1, buf, n, LARGE_PACKET_MAX);",
          "content_same": false
        },
        {
          "line": 143,
          "old_api": "skip_prefix",
          "new_api": "packet_reader_read",
          "old_text": "skip_prefix(reader->line, \"unpack \", &reader->line)",
          "new_text": "packet_reader_read(reader)",
          "old_line_content": "\tif (!skip_prefix(reader->line, \"unpack \", &reader->line))",
          "new_line_content": "\tif (packet_reader_read(reader) != PACKET_READ_NORMAL)",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": "strcmp",
          "new_api": "skip_prefix",
          "old_text": "strcmp(reader->line, \"ok\")",
          "new_text": "skip_prefix(reader->line, \"unpack \", &reader->line)",
          "old_line_content": "\tif (strcmp(reader->line, \"ok\"))",
          "new_line_content": "\tif (!skip_prefix(reader->line, \"unpack \", &reader->line))",
          "content_same": false
        },
        {
          "line": 162,
          "old_api": "starts_with",
          "new_api": "packet_reader_read",
          "old_text": "starts_with(reader->line, \"ng \")",
          "new_text": "packet_reader_read(reader)",
          "old_line_content": "\t\tif (!starts_with(reader->line, \"ok \") && !starts_with(reader->line, \"ng \")) {",
          "new_line_content": "\t\tif (packet_reader_read(reader) != PACKET_READ_NORMAL)",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": "warning",
          "new_api": "find_ref_by_name",
          "old_text": "warning(\"remote reported status on unknown ref: %s\",\n\t\t\t\t\trefname)",
          "new_text": "find_ref_by_name(refs, refname)",
          "old_line_content": "\t\t\twarning(\"remote reported status on unknown ref: %s\",",
          "new_line_content": "\t\t\thint = find_ref_by_name(refs, refname);",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": "recv_sideband",
          "new_api": "async_with_fork",
          "old_text": "recv_sideband(\"send-pack\", fd[0], out)",
          "new_text": "async_with_fork()",
          "old_line_content": "\tret = recv_sideband(\"send-pack\", fd[0], out);",
          "new_line_content": "\tif (async_with_fork())",
          "content_same": false
        },
        {
          "line": 224,
          "old_api": "for_each_commit_graft",
          "new_api": "is_repository_shallow",
          "old_text": "for_each_commit_graft(advertise_shallow_grafts_cb, sb)",
          "new_text": "is_repository_shallow(the_repository)",
          "old_line_content": "\tfor_each_commit_graft(advertise_shallow_grafts_cb, sb);",
          "new_line_content": "\tif (!is_repository_shallow(the_repository))",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": "datestamp",
          "new_api": "strbuf_addstr",
          "old_text": "datestamp(&cert)",
          "new_text": "strbuf_addstr(&cert, \"certificate version 0.1\\n\")",
          "old_line_content": "\tdatestamp(&cert);",
          "new_line_content": "\tstrbuf_addstr(&cert, \"certificate version 0.1\\n\");",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": "strbuf_addch",
          "new_api": "strbuf_addf",
          "old_text": "strbuf_addch(&cert, '\\n')",
          "new_text": "strbuf_addf(&cert, \"pusher %s \", signing_key)",
          "old_line_content": "\tstrbuf_addch(&cert, '\\n');",
          "new_line_content": "\tstrbuf_addf(&cert, \"pusher %s \", signing_key);",
          "content_same": false
        },
        {
          "line": 283,
          "old_api": "transport_anonymize_url",
          "new_api": "strbuf_addch",
          "old_text": "transport_anonymize_url(args->url)",
          "new_text": "strbuf_addch(&cert, '\\n')",
          "old_line_content": "\t\tchar *anon_url = transport_anonymize_url(args->url);",
          "new_line_content": "\tstrbuf_addch(&cert, '\\n');",
          "content_same": false
        },
        {
          "line": 285,
          "old_api": "free",
          "new_api": "transport_anonymize_url",
          "old_text": "free(anon_url)",
          "new_text": "transport_anonymize_url(args->url)",
          "old_line_content": "\t\tfree(anon_url);",
          "new_line_content": "\t\tchar *anon_url = transport_anonymize_url(args->url);",
          "content_same": false
        },
        {
          "line": 290,
          "old_api": "for_each_string_list_item",
          "new_api": "strbuf_addf",
          "old_text": "for_each_string_list_item(item, args->push_options)",
          "new_text": "strbuf_addf(&cert, \"nonce %s\\n\", push_cert_nonce)",
          "old_line_content": "\t\tfor_each_string_list_item(item, args->push_options)",
          "new_line_content": "\t\tstrbuf_addf(&cert, \"nonce %s\\n\", push_cert_nonce);",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": "strbuf_addstr",
          "new_api": "for_each_string_list_item",
          "old_text": "strbuf_addstr(&cert, \"\\n\")",
          "new_text": "for_each_string_list_item(item, args->push_options)",
          "old_line_content": "\tstrbuf_addstr(&cert, \"\\n\");",
          "new_line_content": "\t\tfor_each_string_list_item(item, args->push_options)",
          "content_same": false
        },
        {
          "line": 300,
          "old_api": "oid_to_hex",
          "new_api": "strbuf_addf",
          "old_text": "oid_to_hex(&ref->new_oid)",
          "new_text": "strbuf_addf(&cert, \"%s %s %s\\n\",\n\t\t\t    oid_to_hex(&ref->old_oid),\n\t\t\t    oid_to_hex(&ref->new_oid),\n\t\t\t    ref->name)",
          "old_line_content": "\t\t\t    oid_to_hex(&ref->new_oid),",
          "new_line_content": "\t\tstrbuf_addf(&cert, \"%s %s %s\\n\",",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": "packet_buf_write",
          "new_api": "_",
          "old_text": "packet_buf_write(req_buf, \"push-cert%c%s\", 0, cap_string)",
          "new_text": "_(\"failed to sign the push certificate\")",
          "old_line_content": "\tpacket_buf_write(req_buf, \"push-cert%c%s\", 0, cap_string);",
          "new_line_content": "\t\tdie(_(\"failed to sign the push certificate\"));",
          "content_same": false
        },
        {
          "line": 311,
          "old_api": "next_line",
          "new_api": "packet_buf_write",
          "old_text": "next_line(cp, cert.buf + cert.len - cp)",
          "new_text": "packet_buf_write(req_buf, \"push-cert%c%s\", 0, cap_string)",
          "old_line_content": "\t\tnp = next_line(cp, cert.buf + cert.len - cp);",
          "new_line_content": "\tpacket_buf_write(req_buf, \"push-cert%c%s\", 0, cap_string);",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": "reject_invalid_nonce",
          "new_api": "server_feature_value",
          "old_text": "reject_invalid_nonce(push_cert_nonce, len)",
          "new_text": "server_feature_value(\"push-cert\", &len)",
          "old_line_content": "\t\t\treject_invalid_nonce(push_cert_nonce, len);",
          "new_line_content": "\t\tpush_cert_nonce = server_feature_value(\"push-cert\", &len);",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": "_",
          "new_api": "xmemdupz",
          "old_text": "_(\"the receiving end does not support --signed push\")",
          "new_text": "xmemdupz(push_cert_nonce, len)",
          "old_line_content": "\t\t\tdie(_(\"the receiving end does not support --signed push\"));",
          "new_line_content": "\t\t\tpush_cert_nonce = xmemdupz(push_cert_nonce, len);",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": "git_user_agent_sanitized",
          "new_api": "strbuf_addstr",
          "old_text": "git_user_agent_sanitized()",
          "new_text": "strbuf_addstr(&cap_buf, \" push-options\")",
          "old_line_content": "\t\tstrbuf_addf(&cap_buf, \" agent=%s\", git_user_agent_sanitized());",
          "new_line_content": "\t\tstrbuf_addstr(&cap_buf, \" push-options\");",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": "atomic_push_failure",
          "new_api": "strbuf_release",
          "old_text": "atomic_push_failure(args, remote_refs, ref)",
          "new_text": "strbuf_release(&req_buf)",
          "old_line_content": "\t\t\t\treturn atomic_push_failure(args, remote_refs, ref);",
          "new_line_content": "\t\t\t\tstrbuf_release(&req_buf);",
          "content_same": false
        },
        {
          "line": 520,
          "old_api": "packet_buf_write",
          "new_api": "oid_to_hex",
          "old_text": "packet_buf_write(&req_buf,\n\t\t\t\t\t \"%s %s %s%c%s\",\n\t\t\t\t\t old_hex, new_hex, ref->name, 0,\n\t\t\t\t\t cap_buf.buf)",
          "new_text": "oid_to_hex(&ref->new_oid)",
          "old_line_content": "\t\t\tpacket_buf_write(&req_buf,",
          "new_line_content": "\t\tnew_hex = oid_to_hex(&ref->new_oid);",
          "content_same": false
        },
        {
          "line": 536,
          "old_api": "packet_buf_write",
          "new_api": "packet_buf_flush",
          "old_text": "packet_buf_write(&req_buf, \"%s\", item->string)",
          "new_text": "packet_buf_flush(&req_buf)",
          "old_line_content": "\t\t\tpacket_buf_write(&req_buf, \"%s\", item->string);",
          "new_line_content": "\t\tpacket_buf_flush(&req_buf);",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": "send_sideband",
          "new_api": "is_repository_shallow",
          "old_text": "send_sideband(out, -1, req_buf.buf, req_buf.len, LARGE_PACKET_MAX)",
          "new_text": "is_repository_shallow(the_repository)",
          "old_line_content": "\t\t\tsend_sideband(out, -1, req_buf.buf, req_buf.len, LARGE_PACKET_MAX);",
          "new_line_content": "\t\tif (!args->dry_run && (cmds_sent || is_repository_shallow(the_repository))) {",
          "content_same": false
        },
        {
          "line": 548,
          "old_api": "strbuf_release",
          "new_api": "packet_flush",
          "old_text": "strbuf_release(&req_buf)",
          "new_text": "packet_flush(out)",
          "old_line_content": "\tstrbuf_release(&req_buf);",
          "new_line_content": "\t\tpacket_flush(out);",
          "content_same": false
        },
        {
          "line": 573,
          "old_api": "shutdown",
          "new_api": "close",
          "old_text": "shutdown(fd[0], SHUT_WR)",
          "new_text": "close(out)",
          "old_line_content": "\t\t\t\tshutdown(fd[0], SHUT_WR);",
          "new_line_content": "\t\t\t\tclose(out);",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": "error",
          "new_api": "close",
          "old_text": "error(\"error in sideband demultiplexer\")",
          "new_text": "close(demux.out)",
          "old_line_content": "\t\t\terror(\"error in sideband demultiplexer\");",
          "new_line_content": "\t\tclose(demux.out);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 516,
          "old_api": null,
          "new_api": "check_to_send_update",
          "old_text": null,
          "new_text": "check_to_send_update(ref, args)",
          "old_line_content": "",
          "new_line_content": "\t\tif (check_to_send_update(ref, args) < 0)",
          "content_same": false
        },
        {
          "line": 519,
          "old_api": null,
          "new_api": "oid_to_hex",
          "old_text": null,
          "new_text": "oid_to_hex(&ref->old_oid)",
          "old_line_content": "\t\tif (!cmds_sent) {",
          "new_line_content": "\t\told_hex = oid_to_hex(&ref->old_oid);",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": null,
          "new_api": "packet_buf_write",
          "old_text": null,
          "new_text": "packet_buf_write(&req_buf,\n\t\t\t\t\t \"%s %s %s%c%s\",\n\t\t\t\t\t old_hex, new_hex, ref->name, 0,\n\t\t\t\t\t cap_buf.buf)",
          "old_line_content": "\t\t\t\t\t old_hex, new_hex, ref->name, 0,",
          "new_line_content": "\t\t\tpacket_buf_write(&req_buf,",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": null,
          "new_api": "packet_buf_write",
          "old_text": null,
          "new_text": "packet_buf_write(&req_buf, \"%s %s %s\",\n\t\t\t\t\t old_hex, new_hex, ref->name)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tpacket_buf_write(&req_buf, \"%s %s %s\",",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": null,
          "new_api": "for_each_string_list_item",
          "old_text": null,
          "new_text": "for_each_string_list_item(item, args->push_options)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tfor_each_string_list_item(item, args->push_options)",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": null,
          "new_api": "packet_buf_write",
          "old_text": null,
          "new_text": "packet_buf_write(&req_buf, \"%s\", item->string)",
          "old_line_content": "",
          "new_line_content": "\t\t\tpacket_buf_write(&req_buf, \"%s\", item->string);",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": null,
          "new_api": "packet_buf_flush",
          "old_text": null,
          "new_text": "packet_buf_flush(&req_buf)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tpacket_buf_flush(&req_buf);",
          "content_same": false
        },
        {
          "line": 544,
          "old_api": null,
          "new_api": "send_sideband",
          "old_text": null,
          "new_text": "send_sideband(out, -1, req_buf.buf, req_buf.len, LARGE_PACKET_MAX)",
          "old_line_content": "\t} else {",
          "new_line_content": "\t\t\tsend_sideband(out, -1, req_buf.buf, req_buf.len, LARGE_PACKET_MAX);",
          "content_same": false
        },
        {
          "line": 547,
          "old_api": null,
          "new_api": "write_or_die",
          "old_text": null,
          "new_text": "write_or_die(out, req_buf.buf, req_buf.len)",
          "old_line_content": "\t}",
          "new_line_content": "\t\twrite_or_die(out, req_buf.buf, req_buf.len);",
          "content_same": false
        },
        {
          "line": 550,
          "old_api": null,
          "new_api": "strbuf_release",
          "old_text": null,
          "new_text": "strbuf_release(&req_buf)",
          "old_line_content": "",
          "new_line_content": "\tstrbuf_release(&req_buf);",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": null,
          "new_api": "strbuf_release",
          "old_text": null,
          "new_text": "strbuf_release(&cap_buf)",
          "old_line_content": "\tif (use_sideband && cmds_sent) {",
          "new_line_content": "\tstrbuf_release(&cap_buf);",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": null,
          "new_api": "memset",
          "old_text": null,
          "new_text": "memset(&demux, 0, sizeof(demux))",
          "old_line_content": "\t\tdemux.data = fd;",
          "new_line_content": "\t\tmemset(&demux, 0, sizeof(demux));",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": null,
          "new_api": "start_async",
          "old_text": null,
          "new_text": "start_async(&demux)",
          "old_line_content": "\t\tin = demux.out;",
          "new_line_content": "\t\tif (start_async(&demux))",
          "content_same": false
        },
        {
          "line": 560,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"send-pack: unable to fork off sideband demultiplexer\")",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tdie(\"send-pack: unable to fork off sideband demultiplexer\");",
          "content_same": false
        },
        {
          "line": 51,
          "old_api": null,
          "new_api": "oid_to_hex",
          "old_text": null,
          "new_text": "oid_to_hex(oid)",
          "old_line_content": "}",
          "new_line_content": "\tfputs(oid_to_hex(oid), fh);",
          "content_same": false
        },
        {
          "line": 52,
          "old_api": null,
          "new_api": "putc",
          "old_text": null,
          "new_text": "putc('\\n', fh)",
          "old_line_content": "",
          "new_line_content": "\tputc('\\n', fh);",
          "content_same": false
        },
        {
          "line": 564,
          "old_api": null,
          "new_api": "packet_reader_init",
          "old_text": null,
          "new_text": "packet_reader_init(&reader, in, NULL, 0,\n\t\t\t   PACKET_READ_CHOMP_NEWLINE |\n\t\t\t   PACKET_READ_DIE_ON_ERR_PACKET)",
          "old_line_content": "\t\t\t   PACKET_READ_DIE_ON_ERR_PACKET);",
          "new_line_content": "\tpacket_reader_init(&reader, in, NULL, 0,",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": null,
          "new_api": "pack_objects",
          "old_text": null,
          "new_text": "pack_objects(out, remote_refs, extra_have, args)",
          "old_line_content": "\t\t\t\tref->status = REF_STATUS_NONE;",
          "new_line_content": "\t\tif (pack_objects(out, remote_refs, extra_have, args) < 0) {",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": null,
          "new_api": "git_connection_is_socket",
          "old_text": null,
          "new_text": "git_connection_is_socket(conn)",
          "old_line_content": "",
          "new_line_content": "\t\t\tif (git_connection_is_socket(conn))",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": null,
          "new_api": "shutdown",
          "old_text": null,
          "new_text": "shutdown(fd[0], SHUT_WR)",
          "old_line_content": "\t\t\t/*",
          "new_line_content": "\t\t\t\tshutdown(fd[0], SHUT_WR);",
          "content_same": false
        },
        {
          "line": 582,
          "old_api": null,
          "new_api": "receive_unpack_status",
          "old_text": null,
          "new_text": "receive_unpack_status(&reader)",
          "old_line_content": "\t\t\tif (use_sideband) {",
          "new_line_content": "\t\t\t\treceive_unpack_status(&reader);",
          "content_same": false
        },
        {
          "line": 72,
          "old_api": null,
          "new_api": "argv_array_push",
          "old_text": null,
          "new_text": "argv_array_push(&po.args, \"--revs\")",
          "old_line_content": "\tif (args->use_thin_pack)",
          "new_line_content": "\targv_array_push(&po.args, \"--revs\");",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(demux.out)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tclose(demux.out);",
          "content_same": false
        },
        {
          "line": 586,
          "old_api": null,
          "new_api": "finish_async",
          "old_text": null,
          "new_text": "finish_async(&demux)",
          "old_line_content": "\t\t\tfd[1] = -1;",
          "new_line_content": "\t\t\t\tfinish_async(&demux);",
          "content_same": false
        },
        {
          "line": 82,
          "old_api": null,
          "new_api": "is_repository_shallow",
          "old_text": null,
          "new_text": "is_repository_shallow(the_repository)",
          "old_line_content": "\tpo.in = -1;",
          "new_line_content": "\tif (is_repository_shallow(the_repository))",
          "content_same": false
        },
        {
          "line": 83,
          "old_api": null,
          "new_api": "argv_array_push",
          "old_text": null,
          "new_text": "argv_array_push(&po.args, \"--shallow\")",
          "old_line_content": "\tpo.out = args->stateless_rpc ? -1 : fd;",
          "new_line_content": "\t\targv_array_push(&po.args, \"--shallow\");",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": null,
          "new_api": "packet_flush",
          "old_text": null,
          "new_text": "packet_flush(out)",
          "old_line_content": "\tif (status_report && cmds_sent)",
          "new_line_content": "\t\tpacket_flush(out);",
          "content_same": false
        },
        {
          "line": 87,
          "old_api": null,
          "new_api": "start_command",
          "old_text": null,
          "new_text": "start_command(&po)",
          "old_line_content": "",
          "new_line_content": "\tif (start_command(&po))",
          "content_same": false
        },
        {
          "line": 88,
          "old_api": null,
          "new_api": "die_errno",
          "old_text": null,
          "new_text": "die_errno(\"git pack-objects failed\")",
          "old_line_content": "\t/*",
          "new_line_content": "\t\tdie_errno(\"git pack-objects failed\");",
          "content_same": false
        },
        {
          "line": 599,
          "old_api": null,
          "new_api": "receive_status",
          "old_text": null,
          "new_text": "receive_status(&reader, remote_refs)",
          "old_line_content": "\t\tret = 0;",
          "new_line_content": "\t\tret = receive_status(&reader, remote_refs);",
          "content_same": false
        },
        {
          "line": 603,
          "old_api": null,
          "new_api": "packet_flush",
          "old_text": null,
          "new_text": "packet_flush(out)",
          "old_line_content": "\tif (use_sideband && cmds_sent) {",
          "new_line_content": "\t\tpacket_flush(out);",
          "content_same": false
        },
        {
          "line": 607,
          "old_api": null,
          "new_api": "finish_async",
          "old_text": null,
          "new_text": "finish_async(&demux)",
          "old_line_content": "\t\t\tret = -1;",
          "new_line_content": "\t\tif (finish_async(&demux)) {",
          "content_same": false
        },
        {
          "line": 96,
          "old_api": null,
          "new_api": "feed_object",
          "old_text": null,
          "new_text": "feed_object(&extra->oid[i], po_in, 1)",
          "old_line_content": "\twhile (refs) {",
          "new_line_content": "\t\tfeed_object(&extra->oid[i], po_in, 1);",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"error in sideband demultiplexer\")",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\terror(\"error in sideband demultiplexer\");",
          "content_same": false
        },
        {
          "line": 101,
          "old_api": null,
          "new_api": "is_null_oid",
          "old_text": null,
          "new_text": "is_null_oid(&refs->new_oid)",
          "old_line_content": "\t\trefs = refs->next;",
          "new_line_content": "\t\tif (!is_null_oid(&refs->new_oid))",
          "content_same": false
        },
        {
          "line": 102,
          "old_api": null,
          "new_api": "feed_object",
          "old_text": null,
          "new_text": "feed_object(&refs->new_oid, po_in, 0)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tfeed_object(&refs->new_oid, po_in, 0);",
          "content_same": false
        },
        {
          "line": 108,
          "old_api": null,
          "new_api": "die_errno",
          "old_text": null,
          "new_text": "die_errno(\"error writing to pack-objects\")",
          "old_line_content": "",
          "new_line_content": "\t\tdie_errno(\"error writing to pack-objects\");",
          "content_same": false
        },
        {
          "line": 109,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(po_in)",
          "old_line_content": "\tif (args->stateless_rpc) {",
          "new_line_content": "\tfclose(po_in);",
          "content_same": false
        },
        {
          "line": 114,
          "old_api": null,
          "new_api": "xread",
          "old_text": null,
          "new_text": "xread(po.out, buf, LARGE_PACKET_MAX)",
          "old_line_content": "\t\t\t\tbreak;",
          "new_line_content": "\t\t\tssize_t n = xread(po.out, buf, LARGE_PACKET_MAX);",
          "content_same": false
        },
        {
          "line": 119,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(buf)",
          "old_line_content": "\t\tpo.out = -1;",
          "new_line_content": "\t\tfree(buf);",
          "content_same": false
        },
        {
          "line": 120,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(po.out)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tclose(po.out);",
          "content_same": false
        },
        {
          "line": 124,
          "old_api": null,
          "new_api": "finish_command",
          "old_text": null,
          "new_text": "finish_command(&po)",
          "old_line_content": "\t\t/*",
          "new_line_content": "\trc = finish_command(&po);",
          "content_same": false
        },
        {
          "line": 135,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"pack-objects died of signal %d\", rc - 128)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\terror(\"pack-objects died of signal %d\", rc - 128);",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(reader->line, \"ok\")",
          "old_line_content": "\treturn 0;",
          "new_line_content": "\tif (strcmp(reader->line, \"ok\"))",
          "content_same": false
        },
        {
          "line": 148,
          "old_api": null,
          "new_api": "_",
          "old_text": null,
          "new_text": "_(\"remote unpack failed: %s\")",
          "old_line_content": "}",
          "new_line_content": "\t\treturn error(_(\"remote unpack failed: %s\"), reader->line);",
          "content_same": false
        },
        {
          "line": 158,
          "old_api": null,
          "new_api": "receive_unpack_status",
          "old_text": null,
          "new_text": "receive_unpack_status(reader)",
          "old_line_content": "\t\tconst char *refname;",
          "new_line_content": "\tret = receive_unpack_status(reader);",
          "content_same": false
        },
        {
          "line": 164,
          "old_api": null,
          "new_api": "starts_with",
          "old_text": null,
          "new_text": "starts_with(reader->line, \"ng \")",
          "old_line_content": "\t\t\tret = -1;",
          "new_line_content": "\t\tif (!starts_with(reader->line, \"ok \") && !starts_with(reader->line, \"ng \")) {",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"invalid ref status from remote: %s\", reader->line)",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\t\terror(\"invalid ref status from remote: %s\", reader->line);",
          "content_same": false
        },
        {
          "line": 171,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(refname, ' ')",
          "old_line_content": "\t\t\t*msg++ = '\\0';",
          "new_line_content": "\t\tmsg = strchr(refname, ' ');",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": null,
          "new_api": "warning",
          "old_text": null,
          "new_text": "warning(\"remote reported status on unknown ref: %s\",\n\t\t\t\t\trefname)",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\t\twarning(\"remote reported status on unknown ref: %s\",",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": null,
          "new_api": "warning",
          "old_text": null,
          "new_text": "warning(\"remote reported status on unexpected ref: %s\",\n\t\t\t\t\trefname)",
          "old_line_content": "\t\t\tcontinue;",
          "new_line_content": "\t\t\twarning(\"remote reported status on unexpected ref: %s\",",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": null,
          "new_api": "xstrdup_or_null",
          "old_text": null,
          "new_text": "xstrdup_or_null(msg)",
          "old_line_content": "\t\thint = hint->next;",
          "new_line_content": "\t\thint->remote_status = xstrdup_or_null(msg);",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": null,
          "new_api": "recv_sideband",
          "old_text": null,
          "new_text": "recv_sideband(\"send-pack\", fd[0], out)",
          "old_line_content": "\treturn ret;",
          "new_line_content": "\tret = recv_sideband(\"send-pack\", fd[0], out);",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(out)",
          "old_line_content": "}",
          "new_line_content": "\tclose(out);",
          "content_same": false
        },
        {
          "line": 218,
          "old_api": null,
          "new_api": "oid_to_hex",
          "old_text": null,
          "new_text": "oid_to_hex(&graft->oid)",
          "old_line_content": "}",
          "new_line_content": "\t\tpacket_buf_write(sb, \"shallow %s\\n\", oid_to_hex(&graft->oid));",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": null,
          "new_api": "for_each_commit_graft",
          "old_text": null,
          "new_text": "for_each_commit_graft(advertise_shallow_grafts_cb, sb)",
          "old_line_content": "",
          "new_line_content": "\tfor_each_commit_graft(advertise_shallow_grafts_cb, sb);",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": null,
          "new_api": "memchr",
          "old_text": null,
          "new_text": "memchr(line, '\\n', len)",
          "old_line_content": "\t\treturn line + len; /* incomplete line */",
          "new_line_content": "\tconst char *nl = memchr(line, '\\n', len);",
          "content_same": false
        },
        {
          "line": 275,
          "old_api": null,
          "new_api": "get_signing_key",
          "old_text": null,
          "new_text": "get_signing_key()",
          "old_line_content": "\tstruct strbuf cert = STRBUF_INIT;",
          "new_line_content": "\tchar *signing_key = xstrdup(get_signing_key());",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": null,
          "new_api": "datestamp",
          "old_text": null,
          "new_text": "datestamp(&cert)",
          "old_line_content": "\tif (args->url && *args->url) {",
          "new_line_content": "\tdatestamp(&cert);",
          "content_same": false
        },
        {
          "line": 286,
          "old_api": null,
          "new_api": "strbuf_addf",
          "old_text": null,
          "new_text": "strbuf_addf(&cert, \"pushee %s\\n\", anon_url)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tstrbuf_addf(&cert, \"pushee %s\\n\", anon_url);",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(anon_url)",
          "old_line_content": "\tif (push_cert_nonce[0])",
          "new_line_content": "\t\tfree(anon_url);",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": null,
          "new_api": "strbuf_addf",
          "old_text": null,
          "new_text": "strbuf_addf(&cert, \"push-option %s\\n\", item->string)",
          "old_line_content": "",
          "new_line_content": "\t\t\tstrbuf_addf(&cert, \"push-option %s\\n\", item->string);",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": null,
          "new_api": "strbuf_addstr",
          "old_text": null,
          "new_text": "strbuf_addstr(&cert, \"\\n\")",
          "old_line_content": "\tfor (ref = remote_refs; ref; ref = ref->next) {",
          "new_line_content": "\tstrbuf_addstr(&cert, \"\\n\");",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": null,
          "new_api": "check_to_send_update",
          "old_text": null,
          "new_text": "check_to_send_update(ref, args)",
          "old_line_content": "\t\tupdate_seen = 1;",
          "new_line_content": "\t\tif (check_to_send_update(ref, args) < 0)",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": null,
          "new_api": "oid_to_hex",
          "old_text": null,
          "new_text": "oid_to_hex(&ref->old_oid)",
          "old_line_content": "\t\t\t    ref->name);",
          "new_line_content": "\t\t\t    oid_to_hex(&ref->old_oid),",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": null,
          "new_api": "oid_to_hex",
          "old_text": null,
          "new_text": "oid_to_hex(&ref->new_oid)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\t    oid_to_hex(&ref->new_oid),",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": null,
          "new_api": "sign_buffer",
          "old_text": null,
          "new_text": "sign_buffer(&cert, &cert, signing_key)",
          "old_line_content": "",
          "new_line_content": "\tif (sign_buffer(&cert, &cert, signing_key))",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": null,
          "new_api": "next_line",
          "old_text": null,
          "new_text": "next_line(cp, cert.buf + cert.len - cp)",
          "old_line_content": "\t\t\t\t \"%.*s\", (int)(np - cp), cp);",
          "new_line_content": "\t\tnp = next_line(cp, cert.buf + cert.len - cp);",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": null,
          "new_api": "packet_buf_write",
          "old_text": null,
          "new_text": "packet_buf_write(req_buf,\n\t\t\t\t \"%.*s\", (int)(np - cp), cp)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tpacket_buf_write(req_buf,",
          "content_same": false
        },
        {
          "line": 317,
          "old_api": null,
          "new_api": "packet_buf_write",
          "old_text": null,
          "new_text": "packet_buf_write(req_buf, \"push-cert-end\\n\")",
          "old_line_content": "free_return:",
          "new_line_content": "\tpacket_buf_write(req_buf, \"push-cert-end\\n\");",
          "content_same": false
        },
        {
          "line": 320,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(signing_key)",
          "old_line_content": "\treturn update_seen;",
          "new_line_content": "\tfree(signing_key);",
          "content_same": false
        },
        {
          "line": 321,
          "old_api": null,
          "new_api": "strbuf_release",
          "old_text": null,
          "new_text": "strbuf_release(&cert)",
          "old_line_content": "}",
          "new_line_content": "\tstrbuf_release(&cert);",
          "content_same": false
        },
        {
          "line": 344,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error(\"atomic push failed for ref %s. status: %d\\n\",\n\t\t     failing_ref->name, failing_ref->status)",
          "old_line_content": "}",
          "new_line_content": "\treturn error(\"atomic push failed for ref %s. status: %d\\n\",",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"the receiving end asked to sign an invalid nonce <%.*s>\",\n\t\t    len, nonce)",
          "old_line_content": "",
          "new_line_content": "\t\tdie(\"the receiving end asked to sign an invalid nonce <%.*s>\",",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": null,
          "new_api": "isalnum",
          "old_text": null,
          "new_text": "isalnum(ch)",
          "old_line_content": "\t\t    ch == '/' || ch == '+' ||",
          "new_line_content": "\t\tif (isalnum(ch) ||",
          "content_same": false
        },
        {
          "line": 365,
          "old_api": null,
          "new_api": "die",
          "old_text": null,
          "new_text": "die(\"the receiving end asked to sign an invalid nonce <%.*s>\",\n\t\t    len, nonce)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tdie(\"the receiving end asked to sign an invalid nonce <%.*s>\",",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": null,
          "new_api": "server_supports",
          "old_text": null,
          "new_text": "server_supports(\"push-options\")",
          "old_line_content": "",
          "new_line_content": "\tif (server_supports(\"push-options\"))",
          "content_same": false
        },
        {
          "line": 420,
          "old_api": null,
          "new_api": "reject_invalid_nonce",
          "old_text": null,
          "new_text": "reject_invalid_nonce(push_cert_nonce, len)",
          "old_line_content": "\t\t} else if (args->push_cert == SEND_PACK_PUSH_CERT_ALWAYS) {",
          "new_line_content": "\t\t\treject_invalid_nonce(push_cert_nonce, len);",
          "content_same": false
        },
        {
          "line": 425,
          "old_api": null,
          "new_api": "_",
          "old_text": null,
          "new_text": "_(\"not sending a push certificate since the\"\n\t\t\t\t  \" receiving end does not support --signed\"\n\t\t\t\t  \" push\")",
          "old_line_content": "\t\t\t\t  \" push\"));",
          "new_line_content": "\t\t\twarning(_(\"not sending a push certificate since the\"",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(stderr, \"No refs in common and none specified; doing nothing.\\n\"\n\t\t\t\"Perhaps you should specify a branch such as 'master'.\\n\")",
          "old_line_content": "\t\treturn 0;",
          "new_line_content": "\t\tfprintf(stderr, \"No refs in common and none specified; doing nothing.\\n\"",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": null,
          "new_api": "_",
          "old_text": null,
          "new_text": "_(\"the receiving end does not support --atomic push\")",
          "old_line_content": "\tuse_atomic = atomic_supported && args->atomic;",
          "new_line_content": "\t\tdie(_(\"the receiving end does not support --atomic push\"));",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": null,
          "new_api": "_",
          "old_text": null,
          "new_text": "_(\"the receiving end does not support push options\")",
          "old_line_content": "\tuse_push_options = push_options_supported && args->push_options;",
          "new_line_content": "\t\tdie(_(\"the receiving end does not support push options\"));",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": null,
          "new_api": "git_user_agent_sanitized",
          "old_text": null,
          "new_text": "git_user_agent_sanitized()",
          "old_line_content": "\t/*",
          "new_line_content": "\t\tstrbuf_addf(&cap_buf, \" agent=%s\", git_user_agent_sanitized());",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": null,
          "new_api": "advertise_shallow_grafts_buf",
          "old_text": null,
          "new_text": "advertise_shallow_grafts_buf(&req_buf)",
          "old_line_content": "\tif (!args->dry_run && push_cert_nonce)",
          "new_line_content": "\t\tadvertise_shallow_grafts_buf(&req_buf);",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": null,
          "new_api": "generate_push_cert",
          "old_text": null,
          "new_text": "generate_push_cert(&req_buf, remote_refs, args,\n\t\t\t\t\t       cap_buf.buf, push_cert_nonce)",
          "old_line_content": "",
          "new_line_content": "\t\tcmds_sent = generate_push_cert(&req_buf, remote_refs, args,",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": null,
          "new_api": "check_to_send_update",
          "old_text": null,
          "new_text": "check_to_send_update(ref, args)",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\tswitch (check_to_send_update(ref, args)) {",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": null,
          "new_api": "strbuf_release",
          "old_text": null,
          "new_text": "strbuf_release(&cap_buf)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tstrbuf_release(&cap_buf);",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": null,
          "new_api": "atomic_push_failure",
          "old_text": null,
          "new_text": "atomic_push_failure(args, remote_refs, ref)",
          "old_line_content": "\t\t\t/* else fallthrough */",
          "new_line_content": "\t\t\t\treturn atomic_push_failure(args, remote_refs, ref);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 514,
          "old_api": "check_to_send_update",
          "new_api": null,
          "old_text": "check_to_send_update(ref, args)",
          "new_text": null,
          "old_line_content": "\t\tif (check_to_send_update(ref, args) < 0)",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 517,
          "old_api": "oid_to_hex",
          "new_api": null,
          "old_text": "oid_to_hex(&ref->old_oid)",
          "new_text": null,
          "old_line_content": "\t\told_hex = oid_to_hex(&ref->old_oid);",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": "oid_to_hex",
          "new_api": null,
          "old_text": "oid_to_hex(&ref->new_oid)",
          "new_text": null,
          "old_line_content": "\t\tnew_hex = oid_to_hex(&ref->new_oid);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 526,
          "old_api": "packet_buf_write",
          "new_api": null,
          "old_text": "packet_buf_write(&req_buf, \"%s %s %s\",\n\t\t\t\t\t old_hex, new_hex, ref->name)",
          "new_text": null,
          "old_line_content": "\t\t\tpacket_buf_write(&req_buf, \"%s %s %s\",",
          "new_line_content": "\t\t\tcmds_sent = 1;",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": "packet_buf_flush",
          "new_api": null,
          "old_text": "packet_buf_flush(&req_buf)",
          "new_text": null,
          "old_line_content": "\t\tpacket_buf_flush(&req_buf);",
          "new_line_content": "\t\tstruct string_list_item *item;",
          "content_same": false
        },
        {
          "line": 535,
          "old_api": "for_each_string_list_item",
          "new_api": null,
          "old_text": "for_each_string_list_item(item, args->push_options)",
          "new_text": null,
          "old_line_content": "\t\tfor_each_string_list_item(item, args->push_options)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": "is_repository_shallow",
          "new_api": null,
          "old_text": "is_repository_shallow(the_repository)",
          "new_text": null,
          "old_line_content": "\t\tif (!args->dry_run && (cmds_sent || is_repository_shallow(the_repository))) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": "packet_buf_flush",
          "new_api": null,
          "old_text": "packet_buf_flush(&req_buf)",
          "new_text": null,
          "old_line_content": "\t\t\tpacket_buf_flush(&req_buf);",
          "new_line_content": "\tif (args->stateless_rpc) {",
          "content_same": false
        },
        {
          "line": 545,
          "old_api": "write_or_die",
          "new_api": null,
          "old_text": "write_or_die(out, req_buf.buf, req_buf.len)",
          "new_text": null,
          "old_line_content": "\t\twrite_or_die(out, req_buf.buf, req_buf.len);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 546,
          "old_api": "packet_flush",
          "new_api": null,
          "old_text": "packet_flush(out)",
          "new_text": null,
          "old_line_content": "\t\tpacket_flush(out);",
          "new_line_content": "\t} else {",
          "content_same": false
        },
        {
          "line": 549,
          "old_api": "strbuf_release",
          "new_api": null,
          "old_text": "strbuf_release(&cap_buf)",
          "new_text": null,
          "old_line_content": "\tstrbuf_release(&cap_buf);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 552,
          "old_api": "memset",
          "new_api": null,
          "old_text": "memset(&demux, 0, sizeof(demux))",
          "new_text": null,
          "old_line_content": "\t\tmemset(&demux, 0, sizeof(demux));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 557,
          "old_api": "start_async",
          "new_api": null,
          "old_text": "start_async(&demux)",
          "new_text": null,
          "old_line_content": "\t\tif (start_async(&demux))",
          "new_line_content": "\t\tdemux.out = -1;",
          "content_same": false
        },
        {
          "line": 558,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"send-pack: unable to fork off sideband demultiplexer\")",
          "new_text": null,
          "old_line_content": "\t\t\tdie(\"send-pack: unable to fork off sideband demultiplexer\");",
          "new_line_content": "\t\tdemux.isolate_sigpipe = 1;",
          "content_same": false
        },
        {
          "line": 48,
          "old_api": "putc",
          "new_api": null,
          "old_text": "putc('^', fh)",
          "new_text": null,
          "old_line_content": "\t\tputc('^', fh);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 49,
          "old_api": "oid_to_hex",
          "new_api": null,
          "old_text": "oid_to_hex(oid)",
          "new_text": null,
          "old_line_content": "\tfputs(oid_to_hex(oid), fh);",
          "new_line_content": "\tif (negative)",
          "content_same": false
        },
        {
          "line": 562,
          "old_api": "packet_reader_init",
          "new_api": null,
          "old_text": "packet_reader_init(&reader, in, NULL, 0,\n\t\t\t   PACKET_READ_CHOMP_NEWLINE |\n\t\t\t   PACKET_READ_DIE_ON_ERR_PACKET)",
          "new_text": null,
          "old_line_content": "\tpacket_reader_init(&reader, in, NULL, 0,",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": "pack_objects",
          "new_api": null,
          "old_text": "pack_objects(out, remote_refs, extra_have, args)",
          "new_text": null,
          "old_line_content": "\t\tif (pack_objects(out, remote_refs, extra_have, args) < 0) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(out)",
          "new_text": null,
          "old_line_content": "\t\t\t\tclose(out);",
          "new_line_content": "\t\t\t\tref->status = REF_STATUS_NONE;",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": "git_connection_is_socket",
          "new_api": null,
          "old_text": "git_connection_is_socket(conn)",
          "new_text": null,
          "old_line_content": "\t\t\tif (git_connection_is_socket(conn))",
          "new_line_content": "\t\t\tif (args->stateless_rpc)",
          "content_same": false
        },
        {
          "line": 68,
          "old_api": "argv_array_push",
          "new_api": null,
          "old_text": "argv_array_push(&po.args, \"pack-objects\")",
          "new_text": null,
          "old_line_content": "\targv_array_push(&po.args, \"pack-objects\");",
          "new_line_content": "\tint rc;",
          "content_same": false
        },
        {
          "line": 69,
          "old_api": "argv_array_push",
          "new_api": null,
          "old_text": "argv_array_push(&po.args, \"--all-progress-implied\")",
          "new_text": null,
          "old_line_content": "\targv_array_push(&po.args, \"--all-progress-implied\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 580,
          "old_api": "receive_unpack_status",
          "new_api": null,
          "old_text": "receive_unpack_status(&reader)",
          "new_text": null,
          "old_line_content": "\t\t\t\treceive_unpack_status(&reader);",
          "new_line_content": "\t\t\t */",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(demux.out)",
          "new_text": null,
          "old_line_content": "\t\t\t\tclose(demux.out);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": "finish_async",
          "new_api": null,
          "old_text": "finish_async(&demux)",
          "new_text": null,
          "old_line_content": "\t\t\t\tfinish_async(&demux);",
          "new_line_content": "\t\t\tif (use_sideband) {",
          "content_same": false
        },
        {
          "line": 80,
          "old_api": "is_repository_shallow",
          "new_api": null,
          "old_text": "is_repository_shallow(the_repository)",
          "new_text": null,
          "old_line_content": "\tif (is_repository_shallow(the_repository))",
          "new_line_content": "\tif (args->progress)",
          "content_same": false
        },
        {
          "line": 594,
          "old_api": "packet_flush",
          "new_api": null,
          "old_text": "packet_flush(out)",
          "new_text": null,
          "old_line_content": "\t\tpacket_flush(out);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 85,
          "old_api": "start_command",
          "new_api": null,
          "old_text": "start_command(&po)",
          "new_text": null,
          "old_line_content": "\tif (start_command(&po))",
          "new_line_content": "\tpo.out = args->stateless_rpc ? -1 : fd;",
          "content_same": false
        },
        {
          "line": 86,
          "old_api": "die_errno",
          "new_api": null,
          "old_text": "die_errno(\"git pack-objects failed\")",
          "new_text": null,
          "old_line_content": "\t\tdie_errno(\"git pack-objects failed\");",
          "new_line_content": "\tpo.git_cmd = 1;",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "receive_status",
          "new_api": null,
          "old_text": "receive_status(&reader, remote_refs)",
          "new_text": null,
          "old_line_content": "\t\tret = receive_status(&reader, remote_refs);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": "packet_flush",
          "new_api": null,
          "old_text": "packet_flush(out)",
          "new_text": null,
          "old_line_content": "\t\tpacket_flush(out);",
          "new_line_content": "\t\tret = 0;",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": "xfdopen",
          "new_api": null,
          "old_text": "xfdopen(po.in, \"w\")",
          "new_text": null,
          "old_line_content": "\tpo_in = xfdopen(po.in, \"w\");",
          "new_line_content": "\t * parameters by writing to the pipe.",
          "content_same": false
        },
        {
          "line": 604,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(demux.out)",
          "new_text": null,
          "old_line_content": "\t\tclose(demux.out);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 605,
          "old_api": "finish_async",
          "new_api": null,
          "old_text": "finish_async(&demux)",
          "new_text": null,
          "old_line_content": "\t\tif (finish_async(&demux)) {",
          "new_line_content": "\tif (use_sideband && cmds_sent) {",
          "content_same": false
        },
        {
          "line": 97,
          "old_api": "is_null_oid",
          "new_api": null,
          "old_text": "is_null_oid(&refs->old_oid)",
          "new_text": null,
          "old_line_content": "\t\tif (!is_null_oid(&refs->old_oid))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 98,
          "old_api": "feed_object",
          "new_api": null,
          "old_text": "feed_object(&refs->old_oid, po_in, 1)",
          "new_text": null,
          "old_line_content": "\t\t\tfeed_object(&refs->old_oid, po_in, 1);",
          "new_line_content": "\twhile (refs) {",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": "fflush",
          "new_api": null,
          "old_text": "fflush(po_in)",
          "new_text": null,
          "old_line_content": "\tfflush(po_in);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 105,
          "old_api": "ferror",
          "new_api": null,
          "old_text": "ferror(po_in)",
          "new_text": null,
          "old_line_content": "\tif (ferror(po_in))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 110,
          "old_api": "xmalloc",
          "new_api": null,
          "old_text": "xmalloc(LARGE_PACKET_MAX)",
          "new_text": null,
          "old_line_content": "\t\tchar *buf = xmalloc(LARGE_PACKET_MAX);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 115,
          "old_api": "send_sideband",
          "new_api": null,
          "old_text": "send_sideband(fd, -1, buf, n, LARGE_PACKET_MAX)",
          "new_text": null,
          "old_line_content": "\t\t\tsend_sideband(fd, -1, buf, n, LARGE_PACKET_MAX);",
          "new_line_content": "\t\t\tif (n <= 0)",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(po.out)",
          "new_text": null,
          "old_line_content": "\t\tclose(po.out);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 122,
          "old_api": "finish_command",
          "new_api": null,
          "old_text": "finish_command(&po)",
          "new_text": null,
          "old_line_content": "\trc = finish_command(&po);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 133,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"pack-objects died of signal %d\", rc - 128)",
          "new_text": null,
          "old_line_content": "\t\t\terror(\"pack-objects died of signal %d\", rc - 128);",
          "new_line_content": "\t\t */",
          "content_same": false
        },
        {
          "line": 141,
          "old_api": "packet_reader_read",
          "new_api": null,
          "old_text": "packet_reader_read(reader)",
          "new_text": null,
          "old_line_content": "\tif (packet_reader_read(reader) != PACKET_READ_NORMAL)",
          "new_line_content": "static int receive_unpack_status(struct packet_reader *reader)",
          "content_same": false
        },
        {
          "line": 142,
          "old_api": "_",
          "new_api": null,
          "old_text": "_(\"unexpected flush packet while reading remote unpack status\")",
          "new_text": null,
          "old_line_content": "\t\treturn error(_(\"unexpected flush packet while reading remote unpack status\"));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": "receive_unpack_status",
          "new_api": null,
          "old_text": "receive_unpack_status(reader)",
          "new_text": null,
          "old_line_content": "\tret = receive_unpack_status(reader);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 160,
          "old_api": "packet_reader_read",
          "new_api": null,
          "old_text": "packet_reader_read(reader)",
          "new_text": null,
          "old_line_content": "\t\tif (packet_reader_read(reader) != PACKET_READ_NORMAL)",
          "new_line_content": "\t\tconst char *refname;",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"invalid ref status from remote: %s\", reader->line)",
          "new_text": null,
          "old_line_content": "\t\t\terror(\"invalid ref status from remote: %s\", reader->line);",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 169,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(refname, ' ')",
          "new_text": null,
          "old_line_content": "\t\tmsg = strchr(refname, ' ');",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": "find_ref_by_name",
          "new_api": null,
          "old_text": "find_ref_by_name(hint, refname)",
          "new_text": null,
          "old_line_content": "\t\t\thint = find_ref_by_name(hint, refname);",
          "new_line_content": "\t\t/* first try searching at our hint, falling back to all refs */",
          "content_same": false
        },
        {
          "line": 184,
          "old_api": "warning",
          "new_api": null,
          "old_text": "warning(\"remote reported status on unexpected ref: %s\",\n\t\t\t\t\trefname)",
          "new_text": null,
          "old_line_content": "\t\t\twarning(\"remote reported status on unexpected ref: %s\",",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": "xstrdup_or_null",
          "new_api": null,
          "old_text": "xstrdup_or_null(msg)",
          "new_text": null,
          "old_line_content": "\t\thint->remote_status = xstrdup_or_null(msg);",
          "new_line_content": "\t\t\tret = -1;",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "async_with_fork",
          "new_api": null,
          "old_text": "async_with_fork()",
          "new_text": null,
          "old_line_content": "\tif (async_with_fork())",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fd[1])",
          "new_text": null,
          "old_line_content": "\t\tclose(fd[1]);",
          "new_line_content": "\tint *fd = data, ret;",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": "oid_to_hex",
          "new_api": null,
          "old_text": "oid_to_hex(&graft->oid)",
          "new_text": null,
          "old_line_content": "\t\tpacket_buf_write(sb, \"shallow %s\\n\", oid_to_hex(&graft->oid));",
          "new_line_content": "\tstruct strbuf *sb = cb;",
          "content_same": false
        },
        {
          "line": 222,
          "old_api": "is_repository_shallow",
          "new_api": null,
          "old_text": "is_repository_shallow(the_repository)",
          "new_text": null,
          "old_line_content": "\tif (!is_repository_shallow(the_repository))",
          "new_line_content": "static void advertise_shallow_grafts_buf(struct strbuf *sb)",
          "content_same": false
        },
        {
          "line": 259,
          "old_api": "memchr",
          "new_api": null,
          "old_text": "memchr(line, '\\n', len)",
          "new_text": null,
          "old_line_content": "\tconst char *nl = memchr(line, '\\n', len);",
          "new_line_content": "static const char *next_line(const char *line, size_t len)",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": "get_signing_key",
          "new_api": null,
          "old_text": "get_signing_key()",
          "new_text": null,
          "old_line_content": "\tchar *signing_key = xstrdup(get_signing_key());",
          "new_line_content": "\tconst struct ref *ref;",
          "content_same": false
        },
        {
          "line": 278,
          "old_api": "strbuf_addstr",
          "new_api": null,
          "old_text": "strbuf_addstr(&cert, \"certificate version 0.1\\n\")",
          "new_text": null,
          "old_line_content": "\tstrbuf_addstr(&cert, \"certificate version 0.1\\n\");",
          "new_line_content": "\tint update_seen = 0;",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": "strbuf_addf",
          "new_api": null,
          "old_text": "strbuf_addf(&cert, \"pusher %s \", signing_key)",
          "new_text": null,
          "old_line_content": "\tstrbuf_addf(&cert, \"pusher %s \", signing_key);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 284,
          "old_api": "strbuf_addf",
          "new_api": null,
          "old_text": "strbuf_addf(&cert, \"pushee %s\\n\", anon_url)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_addf(&cert, \"pushee %s\\n\", anon_url);",
          "new_line_content": "\tif (args->url && *args->url) {",
          "content_same": false
        },
        {
          "line": 288,
          "old_api": "strbuf_addf",
          "new_api": null,
          "old_text": "strbuf_addf(&cert, \"nonce %s\\n\", push_cert_nonce)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_addf(&cert, \"nonce %s\\n\", push_cert_nonce);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": "strbuf_addf",
          "new_api": null,
          "old_text": "strbuf_addf(&cert, \"push-option %s\\n\", item->string)",
          "new_text": null,
          "old_line_content": "\t\t\tstrbuf_addf(&cert, \"push-option %s\\n\", item->string);",
          "new_line_content": "\tif (args->push_options)",
          "content_same": false
        },
        {
          "line": 295,
          "old_api": "check_to_send_update",
          "new_api": null,
          "old_text": "check_to_send_update(ref, args)",
          "new_text": null,
          "old_line_content": "\t\tif (check_to_send_update(ref, args) < 0)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": "strbuf_addf",
          "new_api": null,
          "old_text": "strbuf_addf(&cert, \"%s %s %s\\n\",\n\t\t\t    oid_to_hex(&ref->old_oid),\n\t\t\t    oid_to_hex(&ref->new_oid),\n\t\t\t    ref->name)",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_addf(&cert, \"%s %s %s\\n\",",
          "new_line_content": "\t\t\tcontinue;",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": "oid_to_hex",
          "new_api": null,
          "old_text": "oid_to_hex(&ref->old_oid)",
          "new_text": null,
          "old_line_content": "\t\t\t    oid_to_hex(&ref->old_oid),",
          "new_line_content": "\t\tupdate_seen = 1;",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": "sign_buffer",
          "new_api": null,
          "old_text": "sign_buffer(&cert, &cert, signing_key)",
          "new_text": null,
          "old_line_content": "\tif (sign_buffer(&cert, &cert, signing_key))",
          "new_line_content": "\t\tgoto free_return;",
          "content_same": false
        },
        {
          "line": 307,
          "old_api": "_",
          "new_api": null,
          "old_text": "_(\"failed to sign the push certificate\")",
          "new_text": null,
          "old_line_content": "\t\tdie(_(\"failed to sign the push certificate\"));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 312,
          "old_api": "packet_buf_write",
          "new_api": null,
          "old_text": "packet_buf_write(req_buf,\n\t\t\t\t \"%.*s\", (int)(np - cp), cp)",
          "new_text": null,
          "old_line_content": "\t\tpacket_buf_write(req_buf,",
          "new_line_content": "\tfor (cp = cert.buf; cp < cert.buf + cert.len; cp = np) {",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": "packet_buf_write",
          "new_api": null,
          "old_text": "packet_buf_write(req_buf, \"push-cert-end\\n\")",
          "new_text": null,
          "old_line_content": "\tpacket_buf_write(req_buf, \"push-cert-end\\n\");",
          "new_line_content": "\t\t\t\t \"%.*s\", (int)(np - cp), cp);",
          "content_same": false
        },
        {
          "line": 318,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(signing_key)",
          "new_text": null,
          "old_line_content": "\tfree(signing_key);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": "strbuf_release",
          "new_api": null,
          "old_text": "strbuf_release(&cert)",
          "new_text": null,
          "old_line_content": "\tstrbuf_release(&cert);",
          "new_line_content": "free_return:",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"atomic push failed for ref %s. status: %d\\n\",\n\t\t     failing_ref->name, failing_ref->status)",
          "new_text": null,
          "old_line_content": "\treturn error(\"atomic push failed for ref %s. status: %d\\n\",",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 353,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"the receiving end asked to sign an invalid nonce <%.*s>\",\n\t\t    len, nonce)",
          "new_text": null,
          "old_line_content": "\t\tdie(\"the receiving end asked to sign an invalid nonce <%.*s>\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 358,
          "old_api": "isalnum",
          "new_api": null,
          "old_text": "isalnum(ch)",
          "new_text": null,
          "old_line_content": "\t\tif (isalnum(ch) ||",
          "new_line_content": "\tfor (i = 0; i < len; i++) {",
          "content_same": false
        },
        {
          "line": 363,
          "old_api": "die",
          "new_api": null,
          "old_text": "die(\"the receiving end asked to sign an invalid nonce <%.*s>\",\n\t\t    len, nonce)",
          "new_text": null,
          "old_line_content": "\t\tdie(\"the receiving end asked to sign an invalid nonce <%.*s>\",",
          "new_line_content": "\t\t    ch == '=' || ch == '_')",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": "server_supports",
          "new_api": null,
          "old_text": "server_supports(\"report-status\")",
          "new_text": null,
          "old_line_content": "\tif (server_supports(\"report-status\"))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": "server_feature_value",
          "new_api": null,
          "old_text": "server_feature_value(\"push-cert\", &len)",
          "new_text": null,
          "old_line_content": "\t\tpush_cert_nonce = server_feature_value(\"push-cert\", &len);",
          "new_line_content": "\tif (args->push_cert != SEND_PACK_PUSH_CERT_NEVER) {",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": "xmemdupz",
          "new_api": null,
          "old_text": "xmemdupz(push_cert_nonce, len)",
          "new_text": null,
          "old_line_content": "\t\t\tpush_cert_nonce = xmemdupz(push_cert_nonce, len);",
          "new_line_content": "\t\tif (push_cert_nonce) {",
          "content_same": false
        },
        {
          "line": 430,
          "old_api": "fprintf",
          "new_api": null,
          "old_text": "fprintf(stderr, \"No refs in common and none specified; doing nothing.\\n\"\n\t\t\t\"Perhaps you should specify a branch such as 'master'.\\n\")",
          "new_text": null,
          "old_line_content": "\t\tfprintf(stderr, \"No refs in common and none specified; doing nothing.\\n\"",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": "_",
          "new_api": null,
          "old_text": "_(\"the receiving end does not support --atomic push\")",
          "new_text": null,
          "old_line_content": "\t\tdie(_(\"the receiving end does not support --atomic push\"));",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": "_",
          "new_api": null,
          "old_text": "_(\"the receiving end does not support push options\")",
          "new_text": null,
          "old_line_content": "\t\tdie(_(\"the receiving end does not support push options\"));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": "strbuf_addstr",
          "new_api": null,
          "old_text": "strbuf_addstr(&cap_buf, \" report-status\")",
          "new_text": null,
          "old_line_content": "\t\tstrbuf_addstr(&cap_buf, \" report-status\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 467,
          "old_api": "advertise_shallow_grafts_buf",
          "new_api": null,
          "old_text": "advertise_shallow_grafts_buf(&req_buf)",
          "new_text": null,
          "old_line_content": "\t\tadvertise_shallow_grafts_buf(&req_buf);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": "generate_push_cert",
          "new_api": null,
          "old_text": "generate_push_cert(&req_buf, remote_refs, args,\n\t\t\t\t\t       cap_buf.buf, push_cert_nonce)",
          "new_text": null,
          "old_line_content": "\t\tcmds_sent = generate_push_cert(&req_buf, remote_refs, args,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": "check_to_send_update",
          "new_api": null,
          "old_text": "check_to_send_update(ref, args)",
          "new_text": null,
          "old_line_content": "\t\tswitch (check_to_send_update(ref, args)) {",
          "new_line_content": "\t */",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": "strbuf_release",
          "new_api": null,
          "old_text": "strbuf_release(&req_buf)",
          "new_text": null,
          "old_line_content": "\t\t\t\tstrbuf_release(&req_buf);",
          "new_line_content": "\t\t\t */",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": "strbuf_release",
          "new_api": null,
          "old_text": "strbuf_release(&cap_buf)",
          "new_text": null,
          "old_line_content": "\t\t\t\tstrbuf_release(&cap_buf);",
          "new_line_content": "\t\t\tif (use_atomic) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 30,
      "total_additions": 88,
      "total_deletions": 88,
      "total_api_changes": 206
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 206,
        "non_api_lines": 3,
        "non_api_line_numbers": [
          44,
          45,
          46
        ]
      }
    },
    "api_calls_before": 162,
    "api_calls_after": 162,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 1,
      "total_diff_lines": 16
    }
  }
}