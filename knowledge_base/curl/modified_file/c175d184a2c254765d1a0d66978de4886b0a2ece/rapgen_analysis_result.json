{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/curl/modified_file/c175d184a2c254765d1a0d66978de4886b0a2ece",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/curl/modified_file/c175d184a2c254765d1a0d66978de4886b0a2ece/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/curl/modified_file/c175d184a2c254765d1a0d66978de4886b0a2ece/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/curl/modified_file/c175d184a2c254765d1a0d66978de4886b0a2ece/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1073,
          "old_api": "strlen",
          "new_api": "strchr",
          "old_text": "strlen((char *)nva[2].value)",
          "new_text": "strchr(hdbuf, ' ')",
          "old_line_content": "  nva[2].valuelen = (uint16_t)strlen((char *)nva[2].value);",
          "new_line_content": "  end = strchr(hdbuf, ' ');",
          "content_same": false
        },
        {
          "line": 1156,
          "old_api": "Curl_hash_add",
          "new_api": "free",
          "old_text": "Curl_hash_add(&httpc->streamsh, &stream->stream_id, sizeof(stream_id),\n                    conn->data)",
          "new_text": "free(nva)",
          "old_line_content": "  if(!Curl_hash_add(&httpc->streamsh, &stream->stream_id, sizeof(stream_id),",
          "new_line_content": "  free(nva);",
          "content_same": false
        },
        {
          "line": 1251,
          "old_api": "nghttp2_session_upgrade",
          "new_api": "Curl_http2_setup",
          "old_text": "nghttp2_session_upgrade(httpc->h2, httpc->binsettings,\n                                 httpc->binlen, NULL)",
          "new_text": "Curl_http2_setup(conn)",
          "old_line_content": "    rv = nghttp2_session_upgrade(httpc->h2, httpc->binsettings,",
          "new_line_content": "  result = Curl_http2_setup(conn);",
          "content_same": false
        },
        {
          "line": 1264,
          "old_api": "failf",
          "new_api": "nghttp2_session_upgrade",
          "old_text": "failf(data, \"nghttp2_submit_settings() failed: %s(%d)\",\n            nghttp2_strerror(rv), rv)",
          "new_text": "nghttp2_session_upgrade(httpc->h2, httpc->binsettings,\n                                 httpc->binlen, NULL)",
          "old_line_content": "      failf(data, \"nghttp2_submit_settings() failed: %s(%d)\",",
          "new_line_content": "    rv = nghttp2_session_upgrade(httpc->h2, httpc->binsettings,",
          "content_same": false
        },
        {
          "line": 1283,
          "old_api": "nghttp2_strerror",
          "new_api": "nghttp2_session_mem_recv",
          "old_text": "nghttp2_strerror(rv)",
          "new_text": "nghttp2_session_mem_recv(httpc->h2, (const uint8_t*)mem, nread)",
          "old_line_content": "          nghttp2_strerror(rv), rv);",
          "new_line_content": "  rv = (int)nghttp2_session_mem_recv(httpc->h2, (const uint8_t*)mem, nread);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1152,
          "old_api": null,
          "new_api": "nghttp2_submit_request",
          "old_text": null,
          "new_text": "nghttp2_submit_request(h2, NULL, nva, nheader,\n                                       NULL, NULL)",
          "old_line_content": "        stream_id, conn->data);",
          "new_line_content": "    stream_id = nghttp2_submit_request(h2, NULL, nva, nheader,",
          "content_same": false
        },
        {
          "line": 1286,
          "old_api": null,
          "new_api": "failf",
          "old_text": null,
          "new_text": "failf(data, \"nghttp2_session_mem_recv() failed: %s(%d)\",\n          nghttp2_strerror(rv), rv)",
          "old_line_content": "",
          "new_line_content": "    failf(data, \"nghttp2_session_mem_recv() failed: %s(%d)\",",
          "content_same": false
        },
        {
          "line": 1159,
          "old_api": null,
          "new_api": "infof",
          "old_text": null,
          "new_text": "infof(conn->data, \"http2_send() send error\\n\")",
          "old_line_content": "    *err = CURLE_OUT_OF_MEMORY;",
          "new_line_content": "    DEBUGF(infof(conn->data, \"http2_send() send error\\n\"));",
          "content_same": false
        },
        {
          "line": 1287,
          "old_api": null,
          "new_api": "nghttp2_strerror",
          "old_text": null,
          "new_text": "nghttp2_strerror(rv)",
          "old_line_content": "  return CURLE_OK;",
          "new_line_content": "          nghttp2_strerror(rv), rv);",
          "content_same": false
        },
        {
          "line": 1164,
          "old_api": null,
          "new_api": "infof",
          "old_text": null,
          "new_text": "infof(conn->data, \"Using Stream ID: %x (easy handle %p)\\n\",\n        stream_id, conn->data)",
          "old_line_content": "",
          "new_line_content": "  infof(conn->data, \"Using Stream ID: %x (easy handle %p)\\n\",",
          "content_same": false
        },
        {
          "line": 1037,
          "old_api": null,
          "new_api": "nghttp2_session_resume_data",
          "old_text": null,
          "new_text": "nghttp2_session_resume_data(h2, stream->stream_id)",
          "old_line_content": "    if(hdbuf[i] == 0x0a) {",
          "new_line_content": "      nghttp2_session_resume_data(h2, stream->stream_id);",
          "content_same": false
        },
        {
          "line": 1292,
          "old_api": null,
          "new_api": "nghttp2_session_send",
          "old_text": null,
          "new_text": "nghttp2_session_send(httpc->h2)",
          "old_line_content": "",
          "new_line_content": "  rv = nghttp2_session_send(httpc->h2);",
          "content_same": false
        },
        {
          "line": 1295,
          "old_api": null,
          "new_api": "failf",
          "old_text": null,
          "new_text": "failf(data, \"nghttp2_session_send() failed: %s(%d)\",\n          nghttp2_strerror(rv), rv)",
          "old_line_content": "",
          "new_line_content": "    failf(data, \"nghttp2_session_send() failed: %s(%d)\",",
          "content_same": false
        },
        {
          "line": 1040,
          "old_api": null,
          "new_api": "infof",
          "old_text": null,
          "new_text": "infof(conn->data, \"http2_send returns %zu for stream %x\\n\", len,\n                 stream->stream_id)",
          "old_line_content": "  }",
          "new_line_content": "    DEBUGF(infof(conn->data, \"http2_send returns %zu for stream %x\\n\", len,",
          "content_same": false
        },
        {
          "line": 1169,
          "old_api": null,
          "new_api": "Curl_hash_add",
          "old_text": null,
          "new_text": "Curl_hash_add(&httpc->streamsh, &stream->stream_id, sizeof(stream_id),\n                    conn->data)",
          "old_line_content": "",
          "new_line_content": "  if(!Curl_hash_add(&httpc->streamsh, &stream->stream_id, sizeof(stream_id),",
          "content_same": false
        },
        {
          "line": 1296,
          "old_api": null,
          "new_api": "nghttp2_strerror",
          "old_text": null,
          "new_text": "nghttp2_strerror(rv)",
          "old_line_content": "",
          "new_line_content": "          nghttp2_strerror(rv), rv);",
          "content_same": false
        },
        {
          "line": 1171,
          "old_api": null,
          "new_api": "failf",
          "old_text": null,
          "new_text": "failf(conn->data, \"Couldn't add stream to hash!\")",
          "old_line_content": "    /* If whole HEADERS frame was sent off to the underlying socket,",
          "new_line_content": "    failf(conn->data, \"Couldn't add stream to hash!\");",
          "content_same": false
        },
        {
          "line": 1176,
          "old_api": null,
          "new_api": "nghttp2_session_send",
          "old_text": null,
          "new_text": "nghttp2_session_send(h2)",
          "old_line_content": "       writable socket check is performed. To workaround this, we",
          "new_line_content": "  rv = nghttp2_session_send(h2);",
          "content_same": false
        },
        {
          "line": 1058,
          "old_api": null,
          "new_api": "malloc",
          "old_text": null,
          "new_text": "malloc(sizeof(nghttp2_nv) * nheader)",
          "old_line_content": "  hdbuf = end + 1;",
          "new_line_content": "  nva = malloc(sizeof(nghttp2_nv) * nheader);",
          "content_same": false
        },
        {
          "line": 1064,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(hdbuf, ' ')",
          "old_line_content": "  nva[1].valuelen = (uint16_t)(end - hdbuf);",
          "new_line_content": "  end = strchr(hdbuf, ' ');",
          "content_same": false
        },
        {
          "line": 1192,
          "old_api": null,
          "new_api": "nghttp2_session_resume_data",
          "old_text": null,
          "new_text": "nghttp2_session_resume_data(h2, stream->stream_id)",
          "old_line_content": "",
          "new_line_content": "    nghttp2_session_resume_data(h2, stream->stream_id);",
          "content_same": false
        },
        {
          "line": 1066,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen((char *)nva[0].name)",
          "old_line_content": "",
          "new_line_content": "  nva[0].namelen = (uint16_t)strlen((char *)nva[0].name);",
          "content_same": false
        },
        {
          "line": 1075,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen((char *)nva[1].name)",
          "old_line_content": "",
          "new_line_content": "  nva[1].namelen = (uint16_t)strlen((char *)nva[1].name);",
          "content_same": false
        },
        {
          "line": 1207,
          "old_api": null,
          "new_api": "Curl_add_buffer_init",
          "old_text": null,
          "new_text": "Curl_add_buffer_init()",
          "old_line_content": "    return result;",
          "new_line_content": "    stream->header_recvbuf = Curl_add_buffer_init();",
          "content_same": false
        },
        {
          "line": 1081,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen((char *)nva[2].name)",
          "old_line_content": "  for(i = 3; i < nheader; ++i) {",
          "new_line_content": "  nva[2].namelen = (uint16_t)strlen((char *)nva[2].name);",
          "content_same": false
        },
        {
          "line": 1086,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen((char *)nva[2].value)",
          "old_line_content": "      nva[i].name = (unsigned char *)\":authority\";",
          "new_line_content": "  nva[2].valuelen = (uint16_t)strlen((char *)nva[2].value);",
          "content_same": false
        },
        {
          "line": 1089,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(hdbuf, 0x0a)",
          "old_line_content": "    else {",
          "new_line_content": "  hdbuf = strchr(hdbuf, 0x0a);",
          "content_same": false
        },
        {
          "line": 1218,
          "old_api": null,
          "new_api": "Curl_http2_init",
          "old_text": null,
          "new_text": "Curl_http2_init(conn)",
          "old_line_content": "",
          "new_line_content": "  result = Curl_http2_init(conn);",
          "content_same": false
        },
        {
          "line": 1222,
          "old_api": null,
          "new_api": "infof",
          "old_text": null,
          "new_text": "infof(conn->data, \"Using HTTP2, server supports multi-use\\n\")",
          "old_line_content": "",
          "new_line_content": "  infof(conn->data, \"Using HTTP2, server supports multi-use\\n\");",
          "content_same": false
        },
        {
          "line": 1097,
          "old_api": null,
          "new_api": "Curl_raw_nequal",
          "old_text": null,
          "new_text": "Curl_raw_nequal(\"host\", hdbuf, 4)",
          "old_line_content": "    nva[i].value = (unsigned char *)hdbuf;",
          "new_line_content": "    if(end - hdbuf == 4 && Curl_raw_nequal(\"host\", hdbuf, 4)) {",
          "content_same": false
        },
        {
          "line": 1100,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen((char *)nva[i].name)",
          "old_line_content": "",
          "new_line_content": "      nva[i].namelen = (uint16_t)strlen((char *)nva[i].name);",
          "content_same": false
        },
        {
          "line": 1108,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(hdbuf, 0x0d)",
          "old_line_content": "      stream->upload_left = 0;",
          "new_line_content": "    end = strchr(hdbuf, 0x0d);",
          "content_same": false
        },
        {
          "line": 1109,
          "old_api": null,
          "new_api": "assert",
          "old_text": null,
          "new_text": "assert(end)",
          "old_line_content": "      for(j = 0; j < nva[i].valuelen; ++j) {",
          "new_line_content": "    assert(end);",
          "content_same": false
        },
        {
          "line": 1236,
          "old_api": null,
          "new_api": "infof",
          "old_text": null,
          "new_text": "infof(conn->data, \"Connection state changed (HTTP/2 confirmed)\\n\")",
          "old_line_content": "  struct HTTP *stream = conn->data->req.protop;",
          "new_line_content": "  infof(conn->data, \"Connection state changed (HTTP/2 confirmed)\\n\");",
          "content_same": false
        },
        {
          "line": 1237,
          "old_api": null,
          "new_api": "Curl_multi_connchanged",
          "old_text": null,
          "new_text": "Curl_multi_connchanged(conn->data->multi)",
          "old_line_content": "",
          "new_line_content": "  Curl_multi_connchanged(conn->data->multi);",
          "content_same": false
        },
        {
          "line": 1119,
          "old_api": null,
          "new_api": "Curl_raw_nequal",
          "old_text": null,
          "new_text": "Curl_raw_nequal(\"content-length\", (char*)nva[i].name, 14)",
          "old_line_content": "",
          "new_line_content": "       Curl_raw_nequal(\"content-length\", (char*)nva[i].name, 14)) {",
          "content_same": false
        },
        {
          "line": 1126,
          "old_api": null,
          "new_api": "infof",
          "old_text": null,
          "new_text": "infof(conn->data,\n                   \"request content-length=%\"\n                   CURL_FORMAT_CURL_OFF_T\n                   \"\\n\", stream->upload_left)",
          "old_line_content": "    nva[i] = authority;",
          "new_line_content": "      DEBUGF(infof(conn->data,",
          "content_same": false
        },
        {
          "line": 1267,
          "old_api": null,
          "new_api": "failf",
          "old_text": null,
          "new_text": "failf(data, \"nghttp2_session_upgrade() failed: %s(%d)\",\n            nghttp2_strerror(rv), rv)",
          "old_line_content": "    }",
          "new_line_content": "      failf(data, \"nghttp2_session_upgrade() failed: %s(%d)\",",
          "content_same": false
        },
        {
          "line": 1268,
          "old_api": null,
          "new_api": "nghttp2_strerror",
          "old_text": null,
          "new_text": "nghttp2_strerror(rv)",
          "old_line_content": "  }",
          "new_line_content": "            nghttp2_strerror(rv), rv);",
          "content_same": false
        },
        {
          "line": 1275,
          "old_api": null,
          "new_api": "nghttp2_submit_settings",
          "old_text": null,
          "new_text": "nghttp2_submit_settings(httpc->h2, NGHTTP2_FLAG_NONE, NULL, 0)",
          "old_line_content": "    return CURLE_HTTP2;",
          "new_line_content": "    rv = nghttp2_submit_settings(httpc->h2, NGHTTP2_FLAG_NONE, NULL, 0);",
          "content_same": false
        },
        {
          "line": 1148,
          "old_api": null,
          "new_api": "nghttp2_submit_request",
          "old_text": null,
          "new_text": "nghttp2_submit_request(h2, NULL, nva, nheader,\n                                       &data_prd, NULL)",
          "old_line_content": "    return -1;",
          "new_line_content": "    stream_id = nghttp2_submit_request(h2, NULL, nva, nheader,",
          "content_same": false
        },
        {
          "line": 1277,
          "old_api": null,
          "new_api": "failf",
          "old_text": null,
          "new_text": "failf(data, \"nghttp2_submit_settings() failed: %s(%d)\",\n            nghttp2_strerror(rv), rv)",
          "old_line_content": "",
          "new_line_content": "      failf(data, \"nghttp2_submit_settings() failed: %s(%d)\",",
          "content_same": false
        },
        {
          "line": 1278,
          "old_api": null,
          "new_api": "nghttp2_strerror",
          "old_text": null,
          "new_text": "nghttp2_strerror(rv)",
          "old_line_content": "  /* Try to send some frames since we may read SETTINGS already. */",
          "new_line_content": "            nghttp2_strerror(rv), rv);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1282,
          "old_api": "failf",
          "new_api": null,
          "old_text": "failf(data, \"nghttp2_session_send() failed: %s(%d)\",\n          nghttp2_strerror(rv), rv)",
          "new_text": null,
          "old_line_content": "    failf(data, \"nghttp2_session_send() failed: %s(%d)\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1027,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(conn->data, \"http2_send returns %zu for stream %x\\n\", len,\n                 stream->stream_id)",
          "new_text": null,
          "old_line_content": "    DEBUGF(infof(conn->data, \"http2_send returns %zu for stream %x\\n\", len,",
          "new_line_content": "    /* Nullify here because we call nghttp2_session_send() and they",
          "content_same": false
        },
        {
          "line": 1158,
          "old_api": "failf",
          "new_api": null,
          "old_text": "failf(conn->data, \"Couldn't add stream to hash!\")",
          "new_text": null,
          "old_line_content": "    failf(conn->data, \"Couldn't add stream to hash!\");",
          "new_line_content": "  if(stream_id < 0) {",
          "content_same": false
        },
        {
          "line": 1274,
          "old_api": "nghttp2_strerror",
          "new_api": null,
          "old_text": "nghttp2_strerror(rv)",
          "new_text": null,
          "old_line_content": "          nghttp2_strerror(rv), rv);",
          "new_line_content": "    stream->stream_id = -1;",
          "content_same": false
        },
        {
          "line": 1163,
          "old_api": "nghttp2_session_send",
          "new_api": null,
          "old_text": "nghttp2_session_send(h2)",
          "new_text": null,
          "old_line_content": "  rv = nghttp2_session_send(h2);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1045,
          "old_api": "malloc",
          "new_api": null,
          "old_text": "malloc(sizeof(nghttp2_nv) * nheader)",
          "new_text": null,
          "old_line_content": "  nva = malloc(sizeof(nghttp2_nv) * nheader);",
          "new_line_content": "  /* Calculate number of headers contained in [mem, mem + len) */",
          "content_same": false
        },
        {
          "line": 1051,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(hdbuf, ' ')",
          "new_text": null,
          "old_line_content": "  end = strchr(hdbuf, ' ');",
          "new_line_content": "      ++nheader;",
          "content_same": false
        },
        {
          "line": 1179,
          "old_api": "nghttp2_session_resume_data",
          "new_api": null,
          "old_text": "nghttp2_session_resume_data(h2, stream->stream_id)",
          "new_text": null,
          "old_line_content": "    nghttp2_session_resume_data(h2, stream->stream_id);",
          "new_line_content": "    *err = CURLE_SEND_ERROR;",
          "content_same": false
        },
        {
          "line": 1053,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen((char *)nva[0].name)",
          "new_text": null,
          "old_line_content": "  nva[0].namelen = (uint16_t)strlen((char *)nva[0].name);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 1279,
          "old_api": "nghttp2_session_send",
          "new_api": null,
          "old_text": "nghttp2_session_send(httpc->h2)",
          "new_text": null,
          "old_line_content": "  rv = nghttp2_session_send(httpc->h2);",
          "new_line_content": "      return CURLE_HTTP2;",
          "content_same": false
        },
        {
          "line": 1060,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(hdbuf, ' ')",
          "new_text": null,
          "old_line_content": "  end = strchr(hdbuf, ' ');",
          "new_line_content": "    *err = CURLE_OUT_OF_MEMORY;",
          "content_same": false
        },
        {
          "line": 1062,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen((char *)nva[1].name)",
          "new_text": null,
          "old_line_content": "  nva[1].namelen = (uint16_t)strlen((char *)nva[1].name);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 1194,
          "old_api": "Curl_add_buffer_init",
          "new_api": null,
          "old_text": "Curl_add_buffer_init()",
          "new_text": null,
          "old_line_content": "    stream->header_recvbuf = Curl_add_buffer_init();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1068,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen((char *)nva[2].name)",
          "new_text": null,
          "old_line_content": "  nva[2].namelen = (uint16_t)strlen((char *)nva[2].name);",
          "new_line_content": "  nva[0].valuelen = (uint16_t)(end - hdbuf);",
          "content_same": false
        },
        {
          "line": 1076,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(hdbuf, 0x0a)",
          "new_text": null,
          "old_line_content": "  hdbuf = strchr(hdbuf, 0x0a);",
          "new_line_content": "  nva[1].value = (unsigned char *)hdbuf;",
          "content_same": false
        },
        {
          "line": 1205,
          "old_api": "Curl_http2_init",
          "new_api": null,
          "old_text": "Curl_http2_init(conn)",
          "new_text": null,
          "old_line_content": "  result = Curl_http2_init(conn);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1209,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(conn->data, \"Using HTTP2, server supports multi-use\\n\")",
          "new_text": null,
          "old_line_content": "  infof(conn->data, \"Using HTTP2, server supports multi-use\\n\");",
          "new_line_content": "  if((conn->handler == &Curl_handler_http2_ssl) ||",
          "content_same": false
        },
        {
          "line": 1082,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(hdbuf, ':')",
          "new_text": null,
          "old_line_content": "    end = strchr(hdbuf, ':');",
          "new_line_content": "  if(conn->handler->flags & PROTOPT_SSL)",
          "content_same": false
        },
        {
          "line": 1083,
          "old_api": "assert",
          "new_api": null,
          "old_text": "assert(end)",
          "new_text": null,
          "old_line_content": "    assert(end);",
          "new_line_content": "    nva[2].value = (unsigned char *)\"https\";",
          "content_same": false
        },
        {
          "line": 1084,
          "old_api": "Curl_raw_nequal",
          "new_api": null,
          "old_text": "Curl_raw_nequal(\"host\", hdbuf, 4)",
          "new_text": null,
          "old_line_content": "    if(end - hdbuf == 4 && Curl_raw_nequal(\"host\", hdbuf, 4)) {",
          "new_line_content": "  else",
          "content_same": false
        },
        {
          "line": 1087,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen((char *)nva[i].name)",
          "new_text": null,
          "old_line_content": "      nva[i].namelen = (uint16_t)strlen((char *)nva[i].name);",
          "new_line_content": "  nva[2].flags = NGHTTP2_NV_FLAG_NONE;",
          "content_same": false
        },
        {
          "line": 1223,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(conn->data, \"Connection state changed (HTTP/2 confirmed)\\n\")",
          "new_text": null,
          "old_line_content": "  infof(conn->data, \"Connection state changed (HTTP/2 confirmed)\\n\");",
          "new_line_content": "  stream->upload_left = 0;",
          "content_same": false
        },
        {
          "line": 1224,
          "old_api": "Curl_multi_connchanged",
          "new_api": null,
          "old_text": "Curl_multi_connchanged(conn->data->multi)",
          "new_text": null,
          "old_line_content": "  Curl_multi_connchanged(conn->data->multi);",
          "new_line_content": "  stream->upload_mem = NULL;",
          "content_same": false
        },
        {
          "line": 1106,
          "old_api": "Curl_raw_nequal",
          "new_api": null,
          "old_text": "Curl_raw_nequal(\"content-length\", (char*)nva[i].name, 14)",
          "new_text": null,
          "old_line_content": "       Curl_raw_nequal(\"content-length\", (char*)nva[i].name, 14)) {",
          "new_line_content": "    hdbuf = end + 1;",
          "content_same": false
        },
        {
          "line": 1238,
          "old_api": "Curl_http2_setup",
          "new_api": null,
          "old_text": "Curl_http2_setup(conn)",
          "new_text": null,
          "old_line_content": "  result = Curl_http2_setup(conn);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1113,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(conn->data,\n                   \"request content-length=%\"\n                   CURL_FORMAT_CURL_OFF_T\n                   \"\\n\", stream->upload_left)",
          "new_text": null,
          "old_line_content": "      DEBUGF(infof(conn->data,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1254,
          "old_api": "failf",
          "new_api": null,
          "old_text": "failf(data, \"nghttp2_session_upgrade() failed: %s(%d)\",\n            nghttp2_strerror(rv), rv)",
          "new_text": null,
          "old_line_content": "      failf(data, \"nghttp2_session_upgrade() failed: %s(%d)\",",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1255,
          "old_api": "nghttp2_strerror",
          "new_api": null,
          "old_text": "nghttp2_strerror(rv)",
          "new_text": null,
          "old_line_content": "            nghttp2_strerror(rv), rv);",
          "new_line_content": "  httpc->recv_underlying = (recving)conn->recv[FIRSTSOCKET];",
          "content_same": false
        },
        {
          "line": 1262,
          "old_api": "nghttp2_submit_settings",
          "new_api": null,
          "old_text": "nghttp2_submit_settings(httpc->h2, NGHTTP2_FLAG_NONE, NULL, 0)",
          "new_text": null,
          "old_line_content": "    rv = nghttp2_submit_settings(httpc->h2, NGHTTP2_FLAG_NONE, NULL, 0);",
          "new_line_content": "    stream->stream_id = 1;",
          "content_same": false
        },
        {
          "line": 1135,
          "old_api": "nghttp2_submit_request",
          "new_api": null,
          "old_text": "nghttp2_submit_request(h2, NULL, nva, nheader,\n                                       &data_prd, NULL)",
          "new_text": null,
          "old_line_content": "    stream_id = nghttp2_submit_request(h2, NULL, nva, nheader,",
          "new_line_content": "    nghttp2_nv authority = nva[authority_idx];",
          "content_same": false
        },
        {
          "line": 1265,
          "old_api": "nghttp2_strerror",
          "new_api": null,
          "old_text": "nghttp2_strerror(rv)",
          "new_text": null,
          "old_line_content": "            nghttp2_strerror(rv), rv);",
          "new_line_content": "                                 httpc->binlen, NULL);",
          "content_same": false
        },
        {
          "line": 1139,
          "old_api": "nghttp2_submit_request",
          "new_api": null,
          "old_text": "nghttp2_submit_request(h2, NULL, nva, nheader,\n                                       NULL, NULL)",
          "new_text": null,
          "old_line_content": "    stream_id = nghttp2_submit_request(h2, NULL, nva, nheader,",
          "new_line_content": "    nva[i] = authority;",
          "content_same": false
        },
        {
          "line": 1270,
          "old_api": "nghttp2_session_mem_recv",
          "new_api": null,
          "old_text": "nghttp2_session_mem_recv(httpc->h2, (const uint8_t*)mem, nread)",
          "new_text": null,
          "old_line_content": "  rv = (int)nghttp2_session_mem_recv(httpc->h2, (const uint8_t*)mem, nread);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1143,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(nva)",
          "new_text": null,
          "old_line_content": "  free(nva);",
          "new_line_content": "  case HTTPREQ_POST:",
          "content_same": false
        },
        {
          "line": 1273,
          "old_api": "failf",
          "new_api": null,
          "old_text": "failf(data, \"nghttp2_session_mem_recv() failed: %s(%d)\",\n          nghttp2_strerror(rv), rv)",
          "new_text": null,
          "old_line_content": "    failf(data, \"nghttp2_session_mem_recv() failed: %s(%d)\",",
          "new_line_content": "    /* stream ID is unknown at this point */",
          "content_same": false
        },
        {
          "line": 1146,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(conn->data, \"http2_send() send error\\n\")",
          "new_text": null,
          "old_line_content": "    DEBUGF(infof(conn->data, \"http2_send() send error\\n\"));",
          "new_line_content": "    data_prd.read_callback = data_source_read_callback;",
          "content_same": false
        },
        {
          "line": 1151,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(conn->data, \"Using Stream ID: %x (easy handle %p)\\n\",\n        stream_id, conn->data)",
          "new_text": null,
          "old_line_content": "  infof(conn->data, \"Using Stream ID: %x (easy handle %p)\\n\",",
          "new_line_content": "  default:",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 5,
      "total_additions": 38,
      "total_deletions": 37,
      "total_api_changes": 80
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 13,
        "api_related_lines": 80,
        "non_api_lines": 11,
        "non_api_line_numbers": [
          1028,
          1029,
          1030,
          1031,
          1032,
          1033,
          1034,
          1035,
          1036,
          1038,
          1039
        ]
      }
    },
    "api_calls_before": 218,
    "api_calls_after": 219,
    "diff_info": {
      "added_lines": 13,
      "removed_lines": 0,
      "total_diff_lines": 25
    }
  }
}