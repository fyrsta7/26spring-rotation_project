{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/curl/modified_file/8f384577b8398d3b0d32792150a98afd3721c74e",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/curl/modified_file/8f384577b8398d3b0d32792150a98afd3721c74e/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/curl/modified_file/8f384577b8398d3b0d32792150a98afd3721c74e/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/curl/modified_file/8f384577b8398d3b0d32792150a98afd3721c74e/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 563,
          "old_api": "freecookie",
          "new_api": "infof",
          "old_text": "freecookie(co)",
          "new_text": "infof(data, \"oversized cookie dropped, name/val %zu + %zu bytes\",\n                nlen, len)",
          "old_line_content": "          freecookie(co);",
          "new_line_content": "          infof(data, \"oversized cookie dropped, name/val %zu + %zu bytes\",",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": "strchr",
          "new_api": "freecookie",
          "old_text": "strchr(whatptr, '\\t')",
          "new_text": "freecookie(co)",
          "old_line_content": "        if(strchr(whatptr, '\\t')) {",
          "new_line_content": "          freecookie(co);",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "freecookie",
          "new_api": "infof",
          "old_text": "freecookie(co)",
          "new_text": "infof(data, \"cookie contains TAB, dropping\")",
          "old_line_content": "          freecookie(co);",
          "new_line_content": "          infof(data, \"cookie contains TAB, dropping\");",
          "content_same": false
        },
        {
          "line": 629,
          "old_api": "invalid_octets",
          "new_api": "infof",
          "old_text": "invalid_octets(name)",
          "new_text": "infof(data, \"invalid octets in name/value, cookie dropped\")",
          "old_line_content": "          if(invalid_octets(whatptr) || invalid_octets(name)) {",
          "new_line_content": "            infof(data, \"invalid octets in name/value, cookie dropped\");",
          "content_same": false
        },
        {
          "line": 663,
          "old_api": "strcasecompare",
          "new_api": "strstore",
          "old_text": "strcasecompare(\"path\", name)",
          "new_text": "strstore(&co->path, whatptr)",
          "old_line_content": "        else if(strcasecompare(\"path\", name)) {",
          "new_line_content": "          strstore(&co->path, whatptr);",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": "free",
          "new_api": "sanitize_cookie_path",
          "old_text": "free(co->spath)",
          "new_text": "sanitize_cookie_path(co->path)",
          "old_line_content": "          free(co->spath); /* if this is set again */",
          "new_line_content": "          co->spath = sanitize_cookie_path(co->path);",
          "content_same": false
        },
        {
          "line": 700,
          "old_api": "strcmp",
          "new_api": "tailmatch",
          "old_text": "strcmp(whatptr, domain)",
          "new_text": "tailmatch(whatptr, domain)",
          "old_line_content": "             || (is_ip && !strcmp(whatptr, domain))",
          "new_line_content": "             || (!is_ip && tailmatch(whatptr, domain))) {",
          "content_same": false
        },
        {
          "line": 701,
          "old_api": "tailmatch",
          "new_api": "strstore",
          "old_text": "tailmatch(whatptr, domain)",
          "new_text": "strstore(&co->domain, whatptr)",
          "old_line_content": "             || (!is_ip && tailmatch(whatptr, domain))) {",
          "new_line_content": "            strstore(&co->domain, whatptr);",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": "strcasecompare",
          "new_api": "strstore",
          "old_text": "strcasecompare(\"version\", name)",
          "new_text": "strstore(&co->version, whatptr)",
          "old_line_content": "        else if(strcasecompare(\"version\", name)) {",
          "new_line_content": "          strstore(&co->version, whatptr);",
          "content_same": false
        },
        {
          "line": 744,
          "old_api": "strcasecompare",
          "new_api": "strstore",
          "old_text": "strcasecompare(\"expires\", name)",
          "new_text": "strstore(&co->expirestr, whatptr)",
          "old_line_content": "        else if(strcasecompare(\"expires\", name)) {",
          "new_line_content": "          strstore(&co->expirestr, whatptr);",
          "content_same": false
        },
        {
          "line": 1048,
          "old_api": "Curl_host_is_ipnum",
          "new_api": "Curl_psl_use",
          "old_text": "Curl_host_is_ipnum(co->domain)",
          "new_text": "Curl_psl_use(data)",
          "old_line_content": "  if(data && (domain && co->domain && !Curl_host_is_ipnum(co->domain))) {",
          "new_line_content": "    const psl_ctx_t *psl = Curl_psl_use(data);",
          "content_same": false
        },
        {
          "line": 1053,
          "old_api": "psl_is_cookie_domain_acceptable",
          "new_api": "Curl_psl_release",
          "old_text": "psl_is_cookie_domain_acceptable(psl, domain, co->domain)",
          "new_text": "Curl_psl_release(data)",
          "old_line_content": "      acceptable = psl_is_cookie_domain_acceptable(psl, domain, co->domain);",
          "new_line_content": "      Curl_psl_release(data);",
          "content_same": false
        },
        {
          "line": 1104,
          "old_api": "strncasecompare",
          "new_api": "infof",
          "old_text": "strncasecompare(clist->spath, co->spath, cllen)",
          "new_text": "infof(data, \"cookie '%s' for domain '%s' dropped, would \"\n                \"overlay an existing cookie\", co->name, co->domain)",
          "old_line_content": "        if(strncasecompare(clist->spath, co->spath, cllen)) {",
          "new_line_content": "          infof(data, \"cookie '%s' for domain '%s' dropped, would \"",
          "content_same": false
        },
        {
          "line": 1276,
          "old_api": "Curl_get_line",
          "new_api": "checkprefix",
          "old_text": "Curl_get_line(line, MAX_COOKIE_LINE, fp)",
          "new_text": "checkprefix(\"Set-Cookie:\", line)",
          "old_line_content": "    while(Curl_get_line(line, MAX_COOKIE_LINE, fp)) {",
          "new_line_content": "      if(checkprefix(\"Set-Cookie:\", line)) {",
          "content_same": false
        },
        {
          "line": 1447,
          "old_api": "tailmatch",
          "new_api": "strcasecompare",
          "old_text": "tailmatch(co->domain, host)",
          "new_text": "strcasecompare(host, co->domain)",
          "old_line_content": "         (co->tailmatch && !is_ip && tailmatch(co->domain, host)) ||",
          "new_line_content": "         ((!co->tailmatch || is_ip) && strcasecompare(host, co->domain)) ) {",
          "content_same": false
        },
        {
          "line": 1612,
          "old_api": "Curl_cookie_freelist",
          "new_api": "free",
          "old_text": "Curl_cookie_freelist(c->cookies[i])",
          "new_text": "free(c)",
          "old_line_content": "      Curl_cookie_freelist(c->cookies[i]);",
          "new_line_content": "    free(c); /* free the base struct as well */",
          "content_same": false
        },
        {
          "line": 1719,
          "old_api": "fprintf",
          "new_api": "free",
          "old_text": "fprintf(out, \"%s\\n\", format_ptr)",
          "new_text": "free(format_ptr)",
          "old_line_content": "      fprintf(out, \"%s\\n\", format_ptr);",
          "new_line_content": "      free(format_ptr);",
          "content_same": false
        },
        {
          "line": 1729,
          "old_api": "Curl_rename",
          "new_api": "unlink",
          "old_text": "Curl_rename(tempstore, filename)",
          "new_text": "unlink(tempstore)",
          "old_line_content": "    if(tempstore && Curl_rename(tempstore, filename)) {",
          "new_line_content": "      unlink(tempstore);",
          "content_same": false
        },
        {
          "line": 1746,
          "old_api": "fclose",
          "new_api": "free",
          "old_text": "fclose(out)",
          "new_text": "free(tempstore)",
          "old_line_content": "    fclose(out);",
          "new_line_content": "  free(tempstore);",
          "content_same": false
        },
        {
          "line": 1773,
          "old_api": "free",
          "new_api": "curl_slist_free_all",
          "old_text": "free(line)",
          "new_text": "curl_slist_free_all(list)",
          "old_line_content": "        free(line);",
          "new_line_content": "        curl_slist_free_all(list);",
          "content_same": false
        },
        {
          "line": 1787,
          "old_api": "Curl_share_lock",
          "new_api": "cookie_list",
          "old_text": "Curl_share_lock(data, CURL_LOCK_DATA_COOKIE, CURL_LOCK_ACCESS_SINGLE)",
          "new_text": "cookie_list(data)",
          "old_line_content": "  Curl_share_lock(data, CURL_LOCK_DATA_COOKIE, CURL_LOCK_ACCESS_SINGLE);",
          "new_line_content": "  list = cookie_list(data);",
          "content_same": false
        },
        {
          "line": 1788,
          "old_api": "cookie_list",
          "new_api": "Curl_share_unlock",
          "old_text": "cookie_list(data)",
          "new_text": "Curl_share_unlock(data, CURL_LOCK_DATA_COOKIE)",
          "old_line_content": "  list = cookie_list(data);",
          "new_line_content": "  Curl_share_unlock(data, CURL_LOCK_DATA_COOKIE);",
          "content_same": false
        },
        {
          "line": 1810,
          "old_api": "infof",
          "new_api": "curl_easy_strerror",
          "old_text": "infof(data, \"WARNING: failed to save cookies in %s: %s\",\n            data->set.str[STRING_COOKIEJAR], curl_easy_strerror(res))",
          "new_text": "curl_easy_strerror(res)",
          "old_line_content": "      infof(data, \"WARNING: failed to save cookies in %s: %s\",",
          "new_line_content": "            data->set.str[STRING_COOKIEJAR], curl_easy_strerror(res));",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1024,
          "old_api": null,
          "new_api": "freecookie",
          "old_text": null,
          "new_text": "freecookie(co)",
          "old_line_content": "     !co->expires) {   /* this is a session cookie since it doesn't expire! */",
          "new_line_content": "    freecookie(co);",
          "content_same": false
        },
        {
          "line": 513,
          "old_api": null,
          "new_api": "calloc",
          "old_text": null,
          "new_text": "calloc(1, sizeof(struct Cookie))",
          "old_line_content": "  /* First, alloc and init a new struct for it */",
          "new_line_content": "  co = calloc(1, sizeof(struct Cookie));",
          "content_same": false
        },
        {
          "line": 1537,
          "old_api": null,
          "new_api": "Curl_cookie_freelist",
          "old_text": null,
          "new_text": "Curl_cookie_freelist(cookies->cookies[i])",
          "old_line_content": "    for(i = 0; i < COOKIE_HASH_SIZE; i++) {",
          "new_line_content": "      Curl_cookie_freelist(cookies->cookies[i]);",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(lineptr)",
          "old_line_content": "",
          "new_line_content": "    size_t linelength = strlen(lineptr);",
          "content_same": false
        },
        {
          "line": 527,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(co)",
          "old_line_content": "      /* discard overly long lines at once */",
          "new_line_content": "      free(co);",
          "content_same": false
        },
        {
          "line": 1039,
          "old_api": null,
          "new_api": "remove_expired",
          "old_text": null,
          "new_text": "remove_expired(c)",
          "old_line_content": "  if(!noexpire)",
          "new_line_content": "    remove_expired(c);",
          "content_same": false
        },
        {
          "line": 1554,
          "old_api": null,
          "new_api": "freecookie",
          "old_text": null,
          "new_text": "freecookie(co)",
          "old_line_content": "    next = co->next;",
          "new_line_content": "    freecookie(co);",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(lineptr, ';')",
          "old_line_content": "",
          "new_line_content": "    semiptr = strchr(lineptr, ';'); /* first, find a semicolon */",
          "content_same": false
        },
        {
          "line": 533,
          "old_api": null,
          "new_api": "ISBLANK",
          "old_text": null,
          "new_text": "ISBLANK(*lineptr)",
          "old_line_content": "",
          "new_line_content": "    while(*lineptr && ISBLANK(*lineptr))",
          "content_same": false
        },
        {
          "line": 1047,
          "old_api": null,
          "new_api": "Curl_host_is_ipnum",
          "old_text": null,
          "new_text": "Curl_host_is_ipnum(co->domain)",
          "old_line_content": "   */",
          "new_line_content": "  if(data && (domain && co->domain && !Curl_host_is_ipnum(co->domain))) {",
          "content_same": false
        },
        {
          "line": 1052,
          "old_api": null,
          "new_api": "psl_is_cookie_domain_acceptable",
          "old_text": null,
          "new_text": "psl_is_cookie_domain_acceptable(psl, domain, co->domain)",
          "old_line_content": "    if(psl) {",
          "new_line_content": "      acceptable = psl_is_cookie_domain_acceptable(psl, domain, co->domain);",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": null,
          "new_api": "sscanf",
          "old_text": null,
          "new_text": "sscanf(ptr, \"%\" MAX_NAME_TXT \"[^;\\t\\r\\n=] =%\"\n                     MAX_NAME_TXT \"[^;\\r\\n]\",\n                     name, what)",
          "old_line_content": "      name[0] = what[0] = 0; /* init the buffers */",
          "new_line_content": "      if(1 <= sscanf(ptr, \"%\" MAX_NAME_TXT \"[^;\\t\\r\\n=] =%\"",
          "content_same": false
        },
        {
          "line": 1056,
          "old_api": null,
          "new_api": "bad_domain",
          "old_text": null,
          "new_text": "bad_domain(domain)",
          "old_line_content": "    else",
          "new_line_content": "      acceptable = !bad_domain(domain);",
          "content_same": false
        },
        {
          "line": 1059,
          "old_api": null,
          "new_api": "infof",
          "old_text": null,
          "new_text": "infof(data, \"cookie '%s' dropped, domain '%s' must not \"\n                  \"set cookies for '%s'\", co->name, domain, co->domain)",
          "old_line_content": "    if(!acceptable) {",
          "new_line_content": "      infof(data, \"cookie '%s' dropped, domain '%s' must not \"",
          "content_same": false
        },
        {
          "line": 1061,
          "old_api": null,
          "new_api": "freecookie",
          "old_text": null,
          "new_text": "freecookie(co)",
          "old_line_content": "                  \"set cookies for '%s'\", co->name, domain, co->domain);",
          "new_line_content": "      freecookie(co);",
          "content_same": false
        },
        {
          "line": 551,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(what)",
          "old_line_content": "        bool sep;",
          "new_line_content": "        size_t len = strlen(what);",
          "content_same": false
        },
        {
          "line": 1068,
          "old_api": null,
          "new_api": "cookiehash",
          "old_text": null,
          "new_text": "cookiehash(co->domain)",
          "old_line_content": "  /* A non-secure cookie may not overlay an existing secure cookie. */",
          "new_line_content": "  myhash = cookiehash(co->domain);",
          "content_same": false
        },
        {
          "line": 1071,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(clist->name, co->name)",
          "old_line_content": "  while(clist) {",
          "new_line_content": "    if(strcasecompare(clist->name, co->name)) {",
          "content_same": false
        },
        {
          "line": 562,
          "old_api": null,
          "new_api": "freecookie",
          "old_text": null,
          "new_text": "freecookie(co)",
          "old_line_content": "           ((nlen + len) > MAX_NAME)) {",
          "new_line_content": "          freecookie(co);",
          "content_same": false
        },
        {
          "line": 1076,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(clist->domain, co->domain)",
          "old_line_content": "      if(clist->domain && co->domain) {",
          "new_line_content": "        if(strcasecompare(clist->domain, co->domain))",
          "content_same": false
        },
        {
          "line": 1589,
          "old_api": null,
          "new_api": "freecookie",
          "old_text": null,
          "new_text": "freecookie(curr)",
          "old_line_content": "",
          "new_line_content": "        freecookie(curr);",
          "content_same": false
        },
        {
          "line": 573,
          "old_api": null,
          "new_api": "ISBLANK",
          "old_text": null,
          "new_text": "ISBLANK(*endofn)",
          "old_line_content": "          endofn--; /* move to the last character */",
          "new_line_content": "          if(ISBLANK(*endofn)) {",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": null,
          "new_api": "ISBLANK",
          "old_text": null,
          "new_text": "ISBLANK(*endofn)",
          "old_line_content": "            /* skip trailing spaces in name */",
          "new_line_content": "            while(*endofn && ISBLANK(*endofn) && nlen) {",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": null,
          "new_api": "ISBLANK",
          "old_text": null,
          "new_text": "ISBLANK(what[len-1])",
          "old_line_content": "        /* Strip off trailing whitespace from the 'what' */",
          "new_line_content": "        while(len && ISBLANK(what[len-1])) {",
          "content_same": false
        },
        {
          "line": 1096,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(clist->spath + 1, '/')",
          "old_line_content": "",
          "new_line_content": "        sep = strchr(clist->spath + 1, '/');",
          "content_same": false
        },
        {
          "line": 1609,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(c->filename)",
          "old_line_content": "    unsigned int i;",
          "new_line_content": "    free(c->filename);",
          "content_same": false
        },
        {
          "line": 1611,
          "old_api": null,
          "new_api": "Curl_cookie_freelist",
          "old_text": null,
          "new_text": "Curl_cookie_freelist(c->cookies[i])",
          "old_line_content": "    for(i = 0; i < COOKIE_HASH_SIZE; i++)",
          "new_line_content": "      Curl_cookie_freelist(c->cookies[i]);",
          "content_same": false
        },
        {
          "line": 1101,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(clist->spath)",
          "old_line_content": "        else",
          "new_line_content": "          cllen = strlen(clist->spath);",
          "content_same": false
        },
        {
          "line": 591,
          "old_api": null,
          "new_api": "ISBLANK",
          "old_text": null,
          "new_text": "ISBLANK(*whatptr)",
          "old_line_content": "        whatptr = what;",
          "new_line_content": "        while(*whatptr && ISBLANK(*whatptr))",
          "content_same": false
        },
        {
          "line": 1103,
          "old_api": null,
          "new_api": "strncasecompare",
          "old_text": null,
          "new_text": "strncasecompare(clist->spath, co->spath, cllen)",
          "old_line_content": "",
          "new_line_content": "        if(strncasecompare(clist->spath, co->spath, cllen)) {",
          "content_same": false
        },
        {
          "line": 1106,
          "old_api": null,
          "new_api": "freecookie",
          "old_text": null,
          "new_text": "freecookie(co)",
          "old_line_content": "                \"overlay an existing cookie\", co->name, co->domain);",
          "new_line_content": "          freecookie(co);",
          "content_same": false
        },
        {
          "line": 595,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(whatptr, '\\t')",
          "old_line_content": "        /* Reject cookies with a TAB inside the content */",
          "new_line_content": "        if(strchr(whatptr, '\\t')) {",
          "content_same": false
        },
        {
          "line": 1112,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(clist->name, co->name)",
          "old_line_content": "",
          "new_line_content": "    if(!replace_co && strcasecompare(clist->name, co->name)) {",
          "content_same": false
        },
        {
          "line": 1625,
          "old_api": null,
          "new_api": "aprintf",
          "old_text": null,
          "new_text": "aprintf(\n    \"%s\"     /* httponly preamble */\n    \"%s%s\\t\" /* domain */\n    \"%s\\t\"   /* tailmatch */\n    \"%s\\t\"   /* path */\n    \"%s\\t\"   /* secure */\n    \"%\" CURL_FORMAT_CURL_OFF_T \"\\t\"   /* expires */\n    \"%s\\t\"   /* name */\n    \"%s\",    /* value */\n    co->httponly?\"#HttpOnly_\":\"\",\n    /*\n     * Make sure all domains are prefixed with a dot if they allow\n     * tailmatching. This is Mozilla-style.\n     */\n    (co->tailmatch && co->domain && co->domain[0] != '.')? \".\":\"\",\n    co->domain?co->domain:\"unknown\",\n    co->tailmatch?\"TRUE\":\"FALSE\",\n    co->path?co->path:\"/\",\n    co->secure?\"TRUE\":\"FALSE\",\n    co->expires,\n    co->name,\n    co->value?co->value:\"\")",
          "old_line_content": "{",
          "new_line_content": "  return aprintf(",
          "content_same": false
        },
        {
          "line": 1116,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(clist->domain, co->domain)",
          "old_line_content": "      if(clist->domain && co->domain) {",
          "new_line_content": "        if(strcasecompare(clist->domain, co->domain) &&",
          "content_same": false
        },
        {
          "line": 608,
          "old_api": null,
          "new_api": "strncmp",
          "old_text": null,
          "new_text": "strncmp(\"__Secure-\", name, 9)",
          "old_line_content": "        if(nlen > 3 && name[0] == '_' && name[1] == '_') {",
          "new_line_content": "          if(!strncmp(\"__Secure-\", name, 9))",
          "content_same": false
        },
        {
          "line": 610,
          "old_api": null,
          "new_api": "strncmp",
          "old_text": null,
          "new_text": "strncmp(\"__Host-\", name, 7)",
          "old_line_content": "            co->prefix |= COOKIE_PREFIX__SECURE;",
          "new_line_content": "          else if(!strncmp(\"__Host-\", name, 7))",
          "content_same": false
        },
        {
          "line": 1128,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(clist->spath, co->spath)",
          "old_line_content": "        if(clist->spath && co->spath) {",
          "new_line_content": "          if(strcasecompare(clist->spath, co->spath))",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": null,
          "new_api": "strdup",
          "old_text": null,
          "new_text": "strdup(name)",
          "old_line_content": "          }",
          "new_line_content": "          co->name = strdup(name);",
          "content_same": false
        },
        {
          "line": 628,
          "old_api": null,
          "new_api": "invalid_octets",
          "old_text": null,
          "new_text": "invalid_octets(name)",
          "old_line_content": "          }",
          "new_line_content": "          if(invalid_octets(whatptr) || invalid_octets(name)) {",
          "content_same": false
        },
        {
          "line": 1147,
          "old_api": null,
          "new_api": "freecookie",
          "old_text": null,
          "new_text": "freecookie(co)",
          "old_line_content": "         */",
          "new_line_content": "        freecookie(co);",
          "content_same": false
        },
        {
          "line": 645,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(\"secure\", name)",
          "old_line_content": "           */",
          "new_line_content": "          if(strcasecompare(\"secure\", name)) {",
          "content_same": false
        },
        {
          "line": 1671,
          "old_api": null,
          "new_api": "remove_expired",
          "old_text": null,
          "new_text": "remove_expired(c)",
          "old_line_content": "  /* at first, remove expired cookies */",
          "new_line_content": "  remove_expired(c);",
          "content_same": false
        },
        {
          "line": 1673,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(\"-\", filename)",
          "old_line_content": "",
          "new_line_content": "  if(!strcmp(\"-\", filename)) {",
          "content_same": false
        },
        {
          "line": 654,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(\"httponly\", name)",
          "old_line_content": "          }",
          "new_line_content": "          else if(strcasecompare(\"httponly\", name))",
          "content_same": false
        },
        {
          "line": 1167,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(clist->name)",
          "old_line_content": "    /* then free all the old pointers */",
          "new_line_content": "    free(clist->name);",
          "content_same": false
        },
        {
          "line": 1679,
          "old_api": null,
          "new_api": "Curl_fopen",
          "old_text": null,
          "new_text": "Curl_fopen(data, filename, &out, &tempstore)",
          "old_line_content": "  else {",
          "new_line_content": "    error = Curl_fopen(data, filename, &out, &tempstore);",
          "content_same": false
        },
        {
          "line": 1684,
          "old_api": null,
          "new_api": "fputs",
          "old_text": null,
          "new_text": "fputs(\"# Netscape HTTP Cookie File\\n\"\n        \"# https://curl.se/docs/http-cookies.html\\n\"\n        \"# This file was generated by libcurl! Edit at your own risk.\\n\\n\",\n        out)",
          "old_line_content": "",
          "new_line_content": "  fputs(\"# Netscape HTTP Cookie File\\n\"",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(\"path\", name)",
          "old_line_content": "          ;",
          "new_line_content": "        else if(strcasecompare(\"path\", name)) {",
          "content_same": false
        },
        {
          "line": 1178,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(co)",
          "old_line_content": "",
          "new_line_content": "    free(co);   /* free the newly allocated memory */",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(co->spath)",
          "old_line_content": "          }",
          "new_line_content": "          free(co->spath); /* if this is set again */",
          "content_same": false
        },
        {
          "line": 1694,
          "old_api": null,
          "new_api": "calloc",
          "old_text": null,
          "new_text": "calloc(1, sizeof(struct Cookie *) * c->numcookies)",
          "old_line_content": "",
          "new_line_content": "    array = calloc(1, sizeof(struct Cookie *) * c->numcookies);",
          "content_same": false
        },
        {
          "line": 1184,
          "old_api": null,
          "new_api": "infof",
          "old_text": null,
          "new_text": "infof(data, \"%s cookie %s=\\\"%s\\\" for domain %s, path %s, \"\n          \"expire %\" CURL_FORMAT_CURL_OFF_T,\n          replace_old?\"Replaced\":\"Added\", co->name, co->value,\n          co->domain, co->path, co->expires)",
          "old_line_content": "    /* Only show this when NOT reading the cookies from a file */",
          "new_line_content": "    infof(data, \"%s cookie %s=\\\"%s\\\" for domain %s, path %s, \"",
          "content_same": false
        },
        {
          "line": 675,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(\"domain\", name)",
          "old_line_content": "        }",
          "new_line_content": "        else if(strcasecompare(\"domain\", name) && whatptr[0]) {",
          "content_same": false
        },
        {
          "line": 1709,
          "old_api": null,
          "new_api": "qsort",
          "old_text": null,
          "new_text": "qsort(array, nvalid, sizeof(struct Cookie *), cookie_sort_ct)",
          "old_line_content": "",
          "new_line_content": "    qsort(array, nvalid, sizeof(struct Cookie *), cookie_sort_ct);",
          "content_same": false
        },
        {
          "line": 1712,
          "old_api": null,
          "new_api": "get_netscape_format",
          "old_text": null,
          "new_text": "get_netscape_format(array[i])",
          "old_line_content": "    for(i = 0; i < nvalid; i++) {",
          "new_line_content": "      char *format_ptr = get_netscape_format(array[i]);",
          "content_same": false
        },
        {
          "line": 1714,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(array)",
          "old_line_content": "      if(!format_ptr) {",
          "new_line_content": "        free(array);",
          "content_same": false
        },
        {
          "line": 692,
          "old_api": null,
          "new_api": "bad_domain",
          "old_text": null,
          "new_text": "bad_domain(whatptr)",
          "old_line_content": "           */",
          "new_line_content": "          if(bad_domain(whatptr))",
          "content_same": false
        },
        {
          "line": 1718,
          "old_api": null,
          "new_api": "fprintf",
          "old_text": null,
          "new_text": "fprintf(out, \"%s\\n\", format_ptr)",
          "old_line_content": "      }",
          "new_line_content": "      fprintf(out, \"%s\\n\", format_ptr);",
          "content_same": false
        },
        {
          "line": 696,
          "old_api": null,
          "new_api": "Curl_host_is_ipnum",
          "old_text": null,
          "new_text": "Curl_host_is_ipnum(domain ? domain : whatptr)",
          "old_line_content": "",
          "new_line_content": "          is_ip = Curl_host_is_ipnum(domain ? domain : whatptr);",
          "content_same": false
        },
        {
          "line": 1722,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(array)",
          "old_line_content": "",
          "new_line_content": "    free(array);",
          "content_same": false
        },
        {
          "line": 699,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(whatptr, domain)",
          "old_line_content": "          if(!domain",
          "new_line_content": "             || (is_ip && !strcmp(whatptr, domain))",
          "content_same": false
        },
        {
          "line": 1726,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(out)",
          "old_line_content": "  if(!use_stdout) {",
          "new_line_content": "    fclose(out);",
          "content_same": false
        },
        {
          "line": 1728,
          "old_api": null,
          "new_api": "Curl_rename",
          "old_text": null,
          "new_text": "Curl_rename(tempstore, filename)",
          "old_line_content": "    out = NULL;",
          "new_line_content": "    if(tempstore && Curl_rename(tempstore, filename)) {",
          "content_same": false
        },
        {
          "line": 716,
          "old_api": null,
          "new_api": "infof",
          "old_text": null,
          "new_text": "infof(data, \"skipped cookie with bad tailmatch domain: %s\",\n                  whatptr)",
          "old_line_content": "            badcookie = TRUE;",
          "new_line_content": "            infof(data, \"skipped cookie with bad tailmatch domain: %s\",",
          "content_same": false
        },
        {
          "line": 1740,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(tempstore)",
          "old_line_content": "   */",
          "new_line_content": "  free(tempstore);",
          "content_same": false
        },
        {
          "line": 720,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(\"version\", name)",
          "old_line_content": "        }",
          "new_line_content": "        else if(strcasecompare(\"version\", name)) {",
          "content_same": false
        },
        {
          "line": 1745,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(out)",
          "old_line_content": "  if(out && !use_stdout)",
          "new_line_content": "    fclose(out);",
          "content_same": false
        },
        {
          "line": 1234,
          "old_api": null,
          "new_api": "calloc",
          "old_text": null,
          "new_text": "calloc(1, sizeof(struct CookieInfo))",
          "old_line_content": "    /* we didn't get a struct, create one */",
          "new_line_content": "    c = calloc(1, sizeof(struct CookieInfo));",
          "content_same": false
        },
        {
          "line": 1237,
          "old_api": null,
          "new_api": "strdup",
          "old_text": null,
          "new_text": "strdup(file?file:\"none\")",
          "old_line_content": "      return NULL; /* failed to get memory */",
          "new_line_content": "    c->filename = strdup(file?file:\"none\"); /* copy the name just in case */",
          "content_same": false
        },
        {
          "line": 727,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(\"max-age\", name)",
          "old_line_content": "        }",
          "new_line_content": "        else if(strcasecompare(\"max-age\", name)) {",
          "content_same": false
        },
        {
          "line": 737,
          "old_api": null,
          "new_api": "strstore",
          "old_text": null,
          "new_text": "strstore(&co->maxage, whatptr)",
          "old_line_content": "           */",
          "new_line_content": "          strstore(&co->maxage, whatptr);",
          "content_same": false
        },
        {
          "line": 1252,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(file, \"-\")",
          "old_line_content": "",
          "new_line_content": "  if(file && !strcmp(file, \"-\")) {",
          "content_same": false
        },
        {
          "line": 1765,
          "old_api": null,
          "new_api": "get_netscape_format",
          "old_text": null,
          "new_text": "get_netscape_format(c)",
          "old_line_content": "        continue;",
          "new_line_content": "      line = get_netscape_format(c);",
          "content_same": false
        },
        {
          "line": 743,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(\"expires\", name)",
          "old_line_content": "        }",
          "new_line_content": "        else if(strcasecompare(\"expires\", name)) {",
          "content_same": false
        },
        {
          "line": 1767,
          "old_api": null,
          "new_api": "curl_slist_free_all",
          "old_text": null,
          "new_text": "curl_slist_free_all(list)",
          "old_line_content": "      if(!line) {",
          "new_line_content": "        curl_slist_free_all(list);",
          "content_same": false
        },
        {
          "line": 1770,
          "old_api": null,
          "new_api": "Curl_slist_append_nodup",
          "old_text": null,
          "new_text": "Curl_slist_append_nodup(list, line)",
          "old_line_content": "      }",
          "new_line_content": "      beg = Curl_slist_append_nodup(list, line);",
          "content_same": false
        },
        {
          "line": 1772,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(line)",
          "old_line_content": "      if(!beg) {",
          "new_line_content": "        free(line);",
          "content_same": false
        },
        {
          "line": 1261,
          "old_api": null,
          "new_api": "fopen",
          "old_text": null,
          "new_text": "fopen(file, FOPEN_READTEXT)",
          "old_line_content": "  else {",
          "new_line_content": "    fp = fopen(file, FOPEN_READTEXT);",
          "content_same": false
        },
        {
          "line": 1263,
          "old_api": null,
          "new_api": "infof",
          "old_text": null,
          "new_text": "infof(data, \"WARNING: failed to open cookie file \\\"%s\\\"\", file)",
          "old_line_content": "    if(!fp)",
          "new_line_content": "      infof(data, \"WARNING: failed to open cookie file \\\"%s\\\"\", file);",
          "content_same": false
        },
        {
          "line": 1272,
          "old_api": null,
          "new_api": "malloc",
          "old_text": null,
          "new_text": "malloc(MAX_COOKIE_LINE)",
          "old_line_content": "",
          "new_line_content": "    line = malloc(MAX_COOKIE_LINE);",
          "content_same": false
        },
        {
          "line": 1786,
          "old_api": null,
          "new_api": "Curl_share_lock",
          "old_text": null,
          "new_text": "Curl_share_lock(data, CURL_LOCK_DATA_COOKIE, CURL_LOCK_ACCESS_SINGLE)",
          "old_line_content": "  struct curl_slist *list;",
          "new_line_content": "  Curl_share_lock(data, CURL_LOCK_DATA_COOKIE, CURL_LOCK_ACCESS_SINGLE);",
          "content_same": false
        },
        {
          "line": 1275,
          "old_api": null,
          "new_api": "Curl_get_line",
          "old_text": null,
          "new_text": "Curl_get_line(line, MAX_COOKIE_LINE, fp)",
          "old_line_content": "      goto fail;",
          "new_line_content": "    while(Curl_get_line(line, MAX_COOKIE_LINE, fp)) {",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": null,
          "new_api": "ISBLANK",
          "old_text": null,
          "new_text": "ISBLANK(*ptr)",
          "old_line_content": "      ptr = semiptr + 1;",
          "new_line_content": "      while(*ptr && ISBLANK(*ptr))",
          "content_same": false
        },
        {
          "line": 768,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(ptr, ';')",
          "old_line_content": "        ptr++;",
          "new_line_content": "      semiptr = strchr(ptr, ';'); /* now, find the next semicolon */",
          "content_same": false
        },
        {
          "line": 1285,
          "old_api": null,
          "new_api": "ISBLANK",
          "old_text": null,
          "new_text": "ISBLANK(*lineptr)",
          "old_line_content": "      }",
          "new_line_content": "      while(*lineptr && ISBLANK(*lineptr))",
          "content_same": false
        },
        {
          "line": 775,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(ptr, '\\0')",
          "old_line_content": "         */",
          "new_line_content": "        semiptr = strchr(ptr, '\\0');",
          "content_same": false
        },
        {
          "line": 1288,
          "old_api": null,
          "new_api": "Curl_cookie_add",
          "old_text": null,
          "new_text": "Curl_cookie_add(data, c, headerline, TRUE, lineptr, NULL, NULL, TRUE)",
          "old_line_content": "",
          "new_line_content": "      Curl_cookie_add(data, c, headerline, TRUE, lineptr, NULL, NULL, TRUE);",
          "content_same": false
        },
        {
          "line": 1801,
          "old_api": null,
          "new_api": "Curl_cookie_loadfiles",
          "old_text": null,
          "new_text": "Curl_cookie_loadfiles(data)",
          "old_line_content": "         Curl_cookie_loadfiles() LOCKS and UNLOCKS the share itself! */",
          "new_line_content": "      Curl_cookie_loadfiles(data);",
          "content_same": false
        },
        {
          "line": 1290,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(line)",
          "old_line_content": "    }",
          "new_line_content": "    free(line); /* free the line buffer */",
          "content_same": false
        },
        {
          "line": 780,
          "old_api": null,
          "new_api": "curlx_strtoofft",
          "old_text": null,
          "new_text": "curlx_strtoofft((*co->maxage == '\\\"')?\n                             &co->maxage[1]:&co->maxage[0], NULL, 10,\n                             &co->expires)",
          "old_line_content": "      CURLofft offt;",
          "new_line_content": "      offt = curlx_strtoofft((*co->maxage == '\\\"')?",
          "content_same": false
        },
        {
          "line": 1804,
          "old_api": null,
          "new_api": "Curl_share_lock",
          "old_text": null,
          "new_text": "Curl_share_lock(data, CURL_LOCK_DATA_COOKIE, CURL_LOCK_ACCESS_SINGLE)",
          "old_line_content": "",
          "new_line_content": "    Curl_share_lock(data, CURL_LOCK_DATA_COOKIE, CURL_LOCK_ACCESS_SINGLE);",
          "content_same": false
        },
        {
          "line": 1807,
          "old_api": null,
          "new_api": "cookie_output",
          "old_text": null,
          "new_text": "cookie_output(data, data->cookies, data->set.str[STRING_COOKIEJAR])",
          "old_line_content": "    /* if we have a destination file for all the cookies to get dumped to */",
          "new_line_content": "    res = cookie_output(data, data->cookies, data->set.str[STRING_COOKIEJAR]);",
          "content_same": false
        },
        {
          "line": 1296,
          "old_api": null,
          "new_api": "remove_expired",
          "old_text": null,
          "new_text": "remove_expired(c)",
          "old_line_content": "     */",
          "new_line_content": "    remove_expired(c);",
          "content_same": false
        },
        {
          "line": 1809,
          "old_api": null,
          "new_api": "infof",
          "old_text": null,
          "new_text": "infof(data, \"WARNING: failed to save cookies in %s: %s\",\n            data->set.str[STRING_COOKIEJAR], curl_easy_strerror(res))",
          "old_line_content": "    if(res)",
          "new_line_content": "      infof(data, \"WARNING: failed to save cookies in %s: %s\",",
          "content_same": false
        },
        {
          "line": 1299,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(fp)",
          "old_line_content": "    if(fromfile && fp)",
          "new_line_content": "      fclose(fp);",
          "content_same": false
        },
        {
          "line": 1816,
          "old_api": null,
          "new_api": "curl_slist_free_all",
          "old_text": null,
          "new_text": "curl_slist_free_all(data->state.cookielist)",
          "old_line_content": "         names */",
          "new_line_content": "      curl_slist_free_all(data->state.cookielist); /* clean up list */",
          "content_same": false
        },
        {
          "line": 1819,
          "old_api": null,
          "new_api": "Curl_share_lock",
          "old_text": null,
          "new_text": "Curl_share_lock(data, CURL_LOCK_DATA_COOKIE, CURL_LOCK_ACCESS_SINGLE)",
          "old_line_content": "    }",
          "new_line_content": "    Curl_share_lock(data, CURL_LOCK_DATA_COOKIE, CURL_LOCK_ACCESS_SINGLE);",
          "content_same": false
        },
        {
          "line": 1309,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(line)",
          "old_line_content": "fail:",
          "new_line_content": "  free(line);",
          "content_same": false
        },
        {
          "line": 1823,
          "old_api": null,
          "new_api": "Curl_cookie_cleanup",
          "old_text": null,
          "new_text": "Curl_cookie_cleanup(data->cookies)",
          "old_line_content": "  if(cleanup && (!data->share || (data->cookies != data->share->cookies))) {",
          "new_line_content": "    Curl_cookie_cleanup(data->cookies);",
          "content_same": false
        },
        {
          "line": 802,
          "old_api": null,
          "new_api": "Curl_getdate_capped",
          "old_text": null,
          "new_text": "Curl_getdate_capped(co->expirestr)",
          "old_line_content": "       */",
          "new_line_content": "      co->expires = Curl_getdate_capped(co->expirestr);",
          "content_same": false
        },
        {
          "line": 1315,
          "old_api": null,
          "new_api": "Curl_cookie_cleanup",
          "old_text": null,
          "new_text": "Curl_cookie_cleanup(c)",
          "old_line_content": "  if(!inc)",
          "new_line_content": "    Curl_cookie_cleanup(c);",
          "content_same": false
        },
        {
          "line": 1826,
          "old_api": null,
          "new_api": "Curl_share_unlock",
          "old_text": null,
          "new_text": "Curl_share_unlock(data, CURL_LOCK_DATA_COOKIE)",
          "old_line_content": "  }",
          "new_line_content": "  Curl_share_unlock(data, CURL_LOCK_DATA_COOKIE);",
          "content_same": false
        },
        {
          "line": 1317,
          "old_api": null,
          "new_api": "fclose",
          "old_text": null,
          "new_text": "fclose(fp)",
          "old_line_content": "  if(fromfile && fp)",
          "new_line_content": "    fclose(fp);",
          "content_same": false
        },
        {
          "line": 817,
          "old_api": null,
          "new_api": "strdup",
          "old_text": null,
          "new_text": "strdup(domain)",
          "old_line_content": "        /* no domain was given in the header line, set the default */",
          "new_line_content": "        co->domain = strdup(domain);",
          "content_same": false
        },
        {
          "line": 1336,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(c1->path)",
          "old_line_content": "  /* 1 - compare cookie path lengths */",
          "new_line_content": "  l1 = c1->path ? strlen(c1->path) : 0;",
          "content_same": false
        },
        {
          "line": 829,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(path, '?')",
          "old_line_content": "       */",
          "new_line_content": "      char *queryp = strchr(path, '?');",
          "content_same": false
        },
        {
          "line": 1343,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(c1->domain)",
          "old_line_content": "  /* 2 - compare cookie domain lengths */",
          "new_line_content": "  l1 = c1->domain ? strlen(c1->domain) : 0;",
          "content_same": false
        },
        {
          "line": 837,
          "old_api": null,
          "new_api": "strrchr",
          "old_text": null,
          "new_text": "strrchr(path, '/')",
          "old_line_content": "      if(!queryp)",
          "new_line_content": "        endslash = strrchr(path, '/');",
          "content_same": false
        },
        {
          "line": 1350,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(c1->name)",
          "old_line_content": "  /* 3 - compare cookie name lengths */",
          "new_line_content": "  l1 = c1->name ? strlen(c1->name) : 0;",
          "content_same": false
        },
        {
          "line": 839,
          "old_api": null,
          "new_api": "memrchr",
          "old_text": null,
          "new_text": "memrchr(path, '/', (queryp - path))",
          "old_line_content": "      else",
          "new_line_content": "        endslash = memrchr(path, '/', (queryp - path));",
          "content_same": false
        },
        {
          "line": 842,
          "old_api": null,
          "new_api": "malloc",
          "old_text": null,
          "new_text": "malloc(pathlen + 1)",
          "old_line_content": "        size_t pathlen = (endslash-path + 1); /* include end slash */",
          "new_line_content": "        co->path = malloc(pathlen + 1); /* one extra for the zero byte */",
          "content_same": false
        },
        {
          "line": 844,
          "old_api": null,
          "new_api": "memcpy",
          "old_text": null,
          "new_text": "memcpy(co->path, path, pathlen)",
          "old_line_content": "        if(co->path) {",
          "new_line_content": "          memcpy(co->path, path, pathlen);",
          "content_same": false
        },
        {
          "line": 846,
          "old_api": null,
          "new_api": "sanitize_cookie_path",
          "old_text": null,
          "new_text": "sanitize_cookie_path(co->path)",
          "old_line_content": "          co->path[pathlen] = 0; /* null-terminate */",
          "new_line_content": "          co->spath = sanitize_cookie_path(co->path);",
          "content_same": false
        },
        {
          "line": 860,
          "old_api": null,
          "new_api": "freecookie",
          "old_text": null,
          "new_text": "freecookie(co)",
          "old_line_content": "    if(badcookie || !co->name) {",
          "new_line_content": "      freecookie(co);",
          "content_same": false
        },
        {
          "line": 1384,
          "old_api": null,
          "new_api": "calloc",
          "old_text": null,
          "new_text": "calloc(sizeof(struct Cookie), 1)",
          "old_line_content": "{",
          "new_line_content": "  struct Cookie *d = calloc(sizeof(struct Cookie), 1);",
          "content_same": false
        },
        {
          "line": 1386,
          "old_api": null,
          "new_api": "CLONE",
          "old_text": null,
          "new_text": "CLONE(expirestr)",
          "old_line_content": "  if(d) {",
          "new_line_content": "    CLONE(expirestr);",
          "content_same": false
        },
        {
          "line": 883,
          "old_api": null,
          "new_api": "strncmp",
          "old_text": null,
          "new_text": "strncmp(lineptr, \"#HttpOnly_\", 10)",
          "old_line_content": "     */",
          "new_line_content": "    if(strncmp(lineptr, \"#HttpOnly_\", 10) == 0) {",
          "content_same": false
        },
        {
          "line": 890,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(co)",
          "old_line_content": "      /* don't even try the comments */",
          "new_line_content": "      free(co);",
          "content_same": false
        },
        {
          "line": 1404,
          "old_api": null,
          "new_api": "freecookie",
          "old_text": null,
          "new_text": "freecookie(d)",
          "old_line_content": "  fail:",
          "new_line_content": "  freecookie(d);",
          "content_same": false
        },
        {
          "line": 894,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(lineptr, '\\r')",
          "old_line_content": "    /* strip off the possible end-of-line characters */",
          "new_line_content": "    ptr = strchr(lineptr, '\\r');",
          "content_same": false
        },
        {
          "line": 897,
          "old_api": null,
          "new_api": "strchr",
          "old_text": null,
          "new_text": "strchr(lineptr, '\\n')",
          "old_line_content": "      *ptr = 0; /* clear it */",
          "new_line_content": "    ptr = strchr(lineptr, '\\n');",
          "content_same": false
        },
        {
          "line": 901,
          "old_api": null,
          "new_api": "strtok_r",
          "old_text": null,
          "new_text": "strtok_r(lineptr, \"\\t\", &tok_buf)",
          "old_line_content": "",
          "new_line_content": "    firstptr = strtok_r(lineptr, \"\\t\", &tok_buf); /* tokenize it on the TAB */",
          "content_same": false
        },
        {
          "line": 908,
          "old_api": null,
          "new_api": "strtok_r",
          "old_text": null,
          "new_text": "strtok_r(NULL, \"\\t\", &tok_buf)",
          "old_line_content": "    for(ptr = firstptr, fields = 0; ptr && !badcookie;",
          "new_line_content": "        ptr = strtok_r(NULL, \"\\t\", &tok_buf), fields++) {",
          "content_same": false
        },
        {
          "line": 913,
          "old_api": null,
          "new_api": "strdup",
          "old_text": null,
          "new_text": "strdup(ptr)",
          "old_line_content": "          ptr++;",
          "new_line_content": "        co->domain = strdup(ptr);",
          "content_same": false
        },
        {
          "line": 1427,
          "old_api": null,
          "new_api": "cookiehash",
          "old_text": null,
          "new_text": "cookiehash(host)",
          "old_line_content": "  bool is_ip;",
          "new_line_content": "  const size_t myhash = cookiehash(host);",
          "content_same": false
        },
        {
          "line": 1433,
          "old_api": null,
          "new_api": "remove_expired",
          "old_text": null,
          "new_text": "remove_expired(c)",
          "old_line_content": "  /* at first, remove expired cookies */",
          "new_line_content": "  remove_expired(c);",
          "content_same": false
        },
        {
          "line": 923,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(ptr, \"TRUE\")",
          "old_line_content": "         */",
          "new_line_content": "        co->tailmatch = strcasecompare(ptr, \"TRUE\")?TRUE:FALSE;",
          "content_same": false
        },
        {
          "line": 1436,
          "old_api": null,
          "new_api": "Curl_host_is_ipnum",
          "old_text": null,
          "new_text": "Curl_host_is_ipnum(host)",
          "old_line_content": "  /* check if host is an IP(v4|v6) address */",
          "new_line_content": "  is_ip = Curl_host_is_ipnum(host);",
          "content_same": false
        },
        {
          "line": 927,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(\"FALSE\", ptr)",
          "old_line_content": "        /* The file format allows the path field to remain not filled in */",
          "new_line_content": "        if(strcmp(\"TRUE\", ptr) && strcmp(\"FALSE\", ptr)) {",
          "content_same": false
        },
        {
          "line": 929,
          "old_api": null,
          "new_api": "strdup",
          "old_text": null,
          "new_text": "strdup(ptr)",
          "old_line_content": "          /* only if the path doesn't look like a boolean option! */",
          "new_line_content": "          co->path = strdup(ptr);",
          "content_same": false
        },
        {
          "line": 933,
          "old_api": null,
          "new_api": "sanitize_cookie_path",
          "old_text": null,
          "new_text": "sanitize_cookie_path(co->path)",
          "old_line_content": "          else {",
          "new_line_content": "            co->spath = sanitize_cookie_path(co->path);",
          "content_same": false
        },
        {
          "line": 1446,
          "old_api": null,
          "new_api": "tailmatch",
          "old_text": null,
          "new_text": "tailmatch(co->domain, host)",
          "old_line_content": "      if(!co->domain ||",
          "new_line_content": "         (co->tailmatch && !is_ip && tailmatch(co->domain, host)) ||",
          "content_same": false
        },
        {
          "line": 941,
          "old_api": null,
          "new_api": "strdup",
          "old_text": null,
          "new_text": "strdup(\"/\")",
          "old_line_content": "        /* this doesn't look like a path, make one up! */",
          "new_line_content": "        co->path = strdup(\"/\");",
          "content_same": false
        },
        {
          "line": 944,
          "old_api": null,
          "new_api": "strdup",
          "old_text": null,
          "new_text": "strdup(\"/\")",
          "old_line_content": "          badcookie = TRUE;",
          "new_line_content": "        co->spath = strdup(\"/\");",
          "content_same": false
        },
        {
          "line": 1457,
          "old_api": null,
          "new_api": "pathmatch",
          "old_text": null,
          "new_text": "pathmatch(co->spath, path)",
          "old_line_content": "         */",
          "new_line_content": "        if(!co->spath || pathmatch(co->spath, path) ) {",
          "content_same": false
        },
        {
          "line": 951,
          "old_api": null,
          "new_api": "strcasecompare",
          "old_text": null,
          "new_text": "strcasecompare(ptr, \"TRUE\")",
          "old_line_content": "        co->secure = FALSE;",
          "new_line_content": "        if(strcasecompare(ptr, \"TRUE\")) {",
          "content_same": false
        },
        {
          "line": 1464,
          "old_api": null,
          "new_api": "dup_cookie",
          "old_text": null,
          "new_text": "dup_cookie(co)",
          "old_line_content": "",
          "new_line_content": "          newco = dup_cookie(co);",
          "content_same": false
        },
        {
          "line": 959,
          "old_api": null,
          "new_api": "curlx_strtoofft",
          "old_text": null,
          "new_text": "curlx_strtoofft(ptr, NULL, 10, &co->expires)",
          "old_line_content": "      case 4:",
          "new_line_content": "        if(curlx_strtoofft(ptr, NULL, 10, &co->expires))",
          "content_same": false
        },
        {
          "line": 1474,
          "old_api": null,
          "new_api": "infof",
          "old_text": null,
          "new_text": "infof(data, \"Included max number of cookies (%zu) in request!\",\n                    matches)",
          "old_line_content": "            if(matches >= MAX_COOKIE_SEND_AMOUNT) {",
          "new_line_content": "              infof(data, \"Included max number of cookies (%zu) in request!\",",
          "content_same": false
        },
        {
          "line": 963,
          "old_api": null,
          "new_api": "strdup",
          "old_text": null,
          "new_text": "strdup(ptr)",
          "old_line_content": "      case 5:",
          "new_line_content": "        co->name = strdup(ptr);",
          "content_same": false
        },
        {
          "line": 968,
          "old_api": null,
          "new_api": "strncasecompare",
          "old_text": null,
          "new_text": "strncasecompare(\"__Secure-\", co->name, 9)",
          "old_line_content": "          /* For Netscape file format cookies we check prefix on the name */",
          "new_line_content": "          if(strncasecompare(\"__Secure-\", co->name, 9))",
          "content_same": false
        },
        {
          "line": 970,
          "old_api": null,
          "new_api": "strncasecompare",
          "old_text": null,
          "new_text": "strncasecompare(\"__Host-\", co->name, 7)",
          "old_line_content": "            co->prefix |= COOKIE_PREFIX__SECURE;",
          "new_line_content": "          else if(strncasecompare(\"__Host-\", co->name, 7))",
          "content_same": false
        },
        {
          "line": 975,
          "old_api": null,
          "new_api": "strdup",
          "old_text": null,
          "new_text": "strdup(ptr)",
          "old_line_content": "      case 6:",
          "new_line_content": "        co->value = strdup(ptr);",
          "content_same": false
        },
        {
          "line": 983,
          "old_api": null,
          "new_api": "strdup",
          "old_text": null,
          "new_text": "strdup(\"\")",
          "old_line_content": "      /* we got a cookie with blank contents, fix it */",
          "new_line_content": "      co->value = strdup(\"\");",
          "content_same": false
        },
        {
          "line": 1497,
          "old_api": null,
          "new_api": "malloc",
          "old_text": null,
          "new_text": "malloc(sizeof(struct Cookie *) * matches)",
          "old_line_content": "    /* alloc an array and store all cookie pointers */",
          "new_line_content": "    array = malloc(sizeof(struct Cookie *) * matches);",
          "content_same": false
        },
        {
          "line": 995,
          "old_api": null,
          "new_api": "freecookie",
          "old_text": null,
          "new_text": "freecookie(co)",
          "old_line_content": "    if(badcookie) {",
          "new_line_content": "      freecookie(co);",
          "content_same": false
        },
        {
          "line": 1507,
          "old_api": null,
          "new_api": "qsort",
          "old_text": null,
          "new_text": "qsort(array, matches, sizeof(struct Cookie *), cookie_sort)",
          "old_line_content": "    /* now sort the cookie pointers in path length order */",
          "new_line_content": "    qsort(array, matches, sizeof(struct Cookie *), cookie_sort);",
          "content_same": false
        },
        {
          "line": 1004,
          "old_api": null,
          "new_api": "freecookie",
          "old_text": null,
          "new_text": "freecookie(co)",
          "old_line_content": "    if(!co->secure) {",
          "new_line_content": "      freecookie(co);",
          "content_same": false
        },
        {
          "line": 1516,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(array)",
          "old_line_content": "",
          "new_line_content": "    free(array); /* remove the temporary data again */",
          "content_same": false
        },
        {
          "line": 499,
          "old_api": null,
          "new_api": "time",
          "old_text": null,
          "new_text": "time(NULL)",
          "old_line_content": "  struct Cookie *replace_clist = NULL;",
          "new_line_content": "  time_t now = time(NULL);",
          "content_same": false
        },
        {
          "line": 1523,
          "old_api": null,
          "new_api": "Curl_cookie_freelist",
          "old_text": null,
          "new_text": "Curl_cookie_freelist(mainco)",
          "old_line_content": "  /* failure, clear up the allocated chain and return NULL */",
          "new_line_content": "  Curl_cookie_freelist(mainco);",
          "content_same": false
        },
        {
          "line": 1013,
          "old_api": null,
          "new_api": "strcmp",
          "old_text": null,
          "new_text": "strcmp(co->path, \"/\")",
          "old_line_content": "     */",
          "new_line_content": "    if(co->secure && co->path && strcmp(co->path, \"/\") == 0 && !co->tailmatch)",
          "content_same": false
        },
        {
          "line": 1016,
          "old_api": null,
          "new_api": "freecookie",
          "old_text": null,
          "new_text": "freecookie(co)",
          "old_line_content": "    else {",
          "new_line_content": "      freecookie(co);",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": null,
          "new_api": "DEBUGASSERT",
          "old_text": null,
          "new_text": "DEBUGASSERT(MAX_SET_COOKIE_AMOUNT <= 255)",
          "old_line_content": "",
          "new_line_content": "  DEBUGASSERT(MAX_SET_COOKIE_AMOUNT <= 255); /* counter is an unsigned char */",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1025,
          "old_api": "freecookie",
          "new_api": null,
          "old_text": "freecookie(co)",
          "new_text": null,
          "old_line_content": "    freecookie(co);",
          "new_line_content": "    return NULL;",
          "content_same": false
        },
        {
          "line": 514,
          "old_api": "calloc",
          "new_api": null,
          "old_text": "calloc(1, sizeof(struct Cookie))",
          "new_text": null,
          "old_line_content": "  co = calloc(1, sizeof(struct Cookie));",
          "new_line_content": "  if(!co)",
          "content_same": false
        },
        {
          "line": 1538,
          "old_api": "Curl_cookie_freelist",
          "new_api": null,
          "old_text": "Curl_cookie_freelist(cookies->cookies[i])",
          "new_text": null,
          "old_line_content": "      Curl_cookie_freelist(cookies->cookies[i]);",
          "new_line_content": "      cookies->cookies[i] = NULL;",
          "content_same": false
        },
        {
          "line": 525,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(lineptr)",
          "new_text": null,
          "old_line_content": "    size_t linelength = strlen(lineptr);",
          "new_line_content": "    if(linelength > MAX_COOKIE_LINE) {",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(co)",
          "new_text": null,
          "old_line_content": "      free(co);",
          "new_line_content": "      return NULL;",
          "content_same": false
        },
        {
          "line": 1040,
          "old_api": "remove_expired",
          "new_api": null,
          "old_text": "remove_expired(c)",
          "new_text": null,
          "old_line_content": "    remove_expired(c);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1555,
          "old_api": "freecookie",
          "new_api": null,
          "old_text": "freecookie(co)",
          "new_text": null,
          "old_line_content": "    freecookie(co);",
          "new_line_content": "    co = next;",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(lineptr, ';')",
          "new_text": null,
          "old_line_content": "    semiptr = strchr(lineptr, ';'); /* first, find a semicolon */",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": "ISBLANK",
          "new_api": null,
          "old_text": "ISBLANK(*lineptr)",
          "new_text": null,
          "old_line_content": "    while(*lineptr && ISBLANK(*lineptr))",
          "new_line_content": "      lineptr++;",
          "content_same": false
        },
        {
          "line": 1049,
          "old_api": "Curl_psl_use",
          "new_api": null,
          "old_text": "Curl_psl_use(data)",
          "new_text": null,
          "old_line_content": "    const psl_ctx_t *psl = Curl_psl_use(data);",
          "new_line_content": "    int acceptable;",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": "sscanf",
          "new_api": null,
          "old_text": "sscanf(ptr, \"%\" MAX_NAME_TXT \"[^;\\t\\r\\n=] =%\"\n                     MAX_NAME_TXT \"[^;\\r\\n]\",\n                     name, what)",
          "new_text": null,
          "old_line_content": "      if(1 <= sscanf(ptr, \"%\" MAX_NAME_TXT \"[^;\\t\\r\\n=] =%\"",
          "new_line_content": "                     MAX_NAME_TXT \"[^;\\r\\n]\",",
          "content_same": false
        },
        {
          "line": 1054,
          "old_api": "Curl_psl_release",
          "new_api": null,
          "old_text": "Curl_psl_release(data)",
          "new_text": null,
          "old_line_content": "      Curl_psl_release(data);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1057,
          "old_api": "bad_domain",
          "new_api": null,
          "old_text": "bad_domain(domain)",
          "new_text": null,
          "old_line_content": "      acceptable = !bad_domain(domain);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1060,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(data, \"cookie '%s' dropped, domain '%s' must not \"\n                  \"set cookies for '%s'\", co->name, domain, co->domain)",
          "new_text": null,
          "old_line_content": "      infof(data, \"cookie '%s' dropped, domain '%s' must not \"",
          "new_line_content": "                  \"set cookies for '%s'\", co->name, domain, co->domain);",
          "content_same": false
        },
        {
          "line": 1062,
          "old_api": "freecookie",
          "new_api": null,
          "old_text": "freecookie(co)",
          "new_text": null,
          "old_line_content": "      freecookie(co);",
          "new_line_content": "      return NULL;",
          "content_same": false
        },
        {
          "line": 553,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(name)",
          "new_text": null,
          "old_line_content": "        size_t nlen = strlen(name);",
          "new_line_content": "        const char *endofn = &ptr[ nlen ];",
          "content_same": false
        },
        {
          "line": 1069,
          "old_api": "cookiehash",
          "new_api": null,
          "old_text": "cookiehash(co->domain)",
          "new_text": null,
          "old_line_content": "  myhash = cookiehash(co->domain);",
          "new_line_content": "  clist = c->cookies[myhash];",
          "content_same": false
        },
        {
          "line": 1072,
          "old_api": "strcasecompare",
          "new_api": null,
          "old_text": "strcasecompare(clist->name, co->name)",
          "new_text": null,
          "old_line_content": "    if(strcasecompare(clist->name, co->name)) {",
          "new_line_content": "      /* the names are identical */",
          "content_same": false
        },
        {
          "line": 564,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(data, \"oversized cookie dropped, name/val %zu + %zu bytes\",\n                nlen, len)",
          "new_text": null,
          "old_line_content": "          infof(data, \"oversized cookie dropped, name/val %zu + %zu bytes\",",
          "new_line_content": "                nlen, len);",
          "content_same": false
        },
        {
          "line": 1077,
          "old_api": "strcasecompare",
          "new_api": null,
          "old_text": "strcasecompare(clist->domain, co->domain)",
          "new_text": null,
          "old_line_content": "        if(strcasecompare(clist->domain, co->domain))",
          "new_line_content": "          /* The domains are identical */",
          "content_same": false
        },
        {
          "line": 1590,
          "old_api": "freecookie",
          "new_api": null,
          "old_text": "freecookie(curr)",
          "new_text": null,
          "old_line_content": "        freecookie(curr);",
          "new_line_content": "        cookies->numcookies--;",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": "ISBLANK",
          "new_api": null,
          "old_text": "ISBLANK(*endofn)",
          "new_text": null,
          "old_line_content": "          if(ISBLANK(*endofn)) {",
          "new_line_content": "            /* skip trailing spaces in name */",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": "ISBLANK",
          "new_api": null,
          "old_text": "ISBLANK(*endofn)",
          "new_text": null,
          "old_line_content": "            while(*endofn && ISBLANK(*endofn) && nlen) {",
          "new_line_content": "              endofn--;",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": "ISBLANK",
          "new_api": null,
          "old_text": "ISBLANK(what[len-1])",
          "new_text": null,
          "old_line_content": "        while(len && ISBLANK(what[len-1])) {",
          "new_line_content": "          what[len-1] = 0;",
          "content_same": false
        },
        {
          "line": 1097,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(clist->spath + 1, '/')",
          "new_text": null,
          "old_line_content": "        sep = strchr(clist->spath + 1, '/');",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1610,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(c->filename)",
          "new_text": null,
          "old_line_content": "    free(c->filename);",
          "new_line_content": "    for(i = 0; i < COOKIE_HASH_SIZE; i++)",
          "content_same": false
        },
        {
          "line": 1613,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(c)",
          "new_text": null,
          "old_line_content": "    free(c); /* free the base struct as well */",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 1102,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(clist->spath)",
          "new_text": null,
          "old_line_content": "          cllen = strlen(clist->spath);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": "ISBLANK",
          "new_api": null,
          "old_text": "ISBLANK(*whatptr)",
          "new_text": null,
          "old_line_content": "        while(*whatptr && ISBLANK(*whatptr))",
          "new_line_content": "          whatptr++;",
          "content_same": false
        },
        {
          "line": 1105,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(data, \"cookie '%s' for domain '%s' dropped, would \"\n                \"overlay an existing cookie\", co->name, co->domain)",
          "new_text": null,
          "old_line_content": "          infof(data, \"cookie '%s' for domain '%s' dropped, would \"",
          "new_line_content": "                \"overlay an existing cookie\", co->name, co->domain);",
          "content_same": false
        },
        {
          "line": 1107,
          "old_api": "freecookie",
          "new_api": null,
          "old_text": "freecookie(co)",
          "new_text": null,
          "old_line_content": "          freecookie(co);",
          "new_line_content": "          return NULL;",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(data, \"cookie contains TAB, dropping\")",
          "new_text": null,
          "old_line_content": "          infof(data, \"cookie contains TAB, dropping\");",
          "new_line_content": "          return NULL;",
          "content_same": false
        },
        {
          "line": 1113,
          "old_api": "strcasecompare",
          "new_api": null,
          "old_text": "strcasecompare(clist->name, co->name)",
          "new_text": null,
          "old_line_content": "    if(!replace_co && strcasecompare(clist->name, co->name)) {",
          "new_line_content": "      /* the names are identical */",
          "content_same": false
        },
        {
          "line": 1626,
          "old_api": "aprintf",
          "new_api": null,
          "old_text": "aprintf(\n    \"%s\"     /* httponly preamble */\n    \"%s%s\\t\" /* domain */\n    \"%s\\t\"   /* tailmatch */\n    \"%s\\t\"   /* path */\n    \"%s\\t\"   /* secure */\n    \"%\" CURL_FORMAT_CURL_OFF_T \"\\t\"   /* expires */\n    \"%s\\t\"   /* name */\n    \"%s\",    /* value */\n    co->httponly?\"#HttpOnly_\":\"\",\n    /*\n     * Make sure all domains are prefixed with a dot if they allow\n     * tailmatching. This is Mozilla-style.\n     */\n    (co->tailmatch && co->domain && co->domain[0] != '.')? \".\":\"\",\n    co->domain?co->domain:\"unknown\",\n    co->tailmatch?\"TRUE\":\"FALSE\",\n    co->path?co->path:\"/\",\n    co->secure?\"TRUE\":\"FALSE\",\n    co->expires,\n    co->name,\n    co->value?co->value:\"\")",
          "new_text": null,
          "old_line_content": "  return aprintf(",
          "new_line_content": "    \"%s\"     /* httponly preamble */",
          "content_same": false
        },
        {
          "line": 1117,
          "old_api": "strcasecompare",
          "new_api": null,
          "old_text": "strcasecompare(clist->domain, co->domain)",
          "new_text": null,
          "old_line_content": "        if(strcasecompare(clist->domain, co->domain) &&",
          "new_line_content": "          (clist->tailmatch == co->tailmatch))",
          "content_same": false
        },
        {
          "line": 609,
          "old_api": "strncmp",
          "new_api": null,
          "old_text": "strncmp(\"__Secure-\", name, 9)",
          "new_text": null,
          "old_line_content": "          if(!strncmp(\"__Secure-\", name, 9))",
          "new_line_content": "            co->prefix |= COOKIE_PREFIX__SECURE;",
          "content_same": false
        },
        {
          "line": 611,
          "old_api": "strncmp",
          "new_api": null,
          "old_text": "strncmp(\"__Host-\", name, 7)",
          "new_text": null,
          "old_line_content": "          else if(!strncmp(\"__Host-\", name, 7))",
          "new_line_content": "            co->prefix |= COOKIE_PREFIX__HOST;",
          "content_same": false
        },
        {
          "line": 1129,
          "old_api": "strcasecompare",
          "new_api": null,
          "old_text": "strcasecompare(clist->spath, co->spath)",
          "new_text": null,
          "old_line_content": "          if(strcasecompare(clist->spath, co->spath))",
          "new_line_content": "            replace_old = TRUE;",
          "content_same": false
        },
        {
          "line": 623,
          "old_api": "strdup",
          "new_api": null,
          "old_text": "strdup(whatptr)",
          "new_text": null,
          "old_line_content": "          co->value = strdup(whatptr);",
          "new_line_content": "          done = TRUE;",
          "content_same": false
        },
        {
          "line": 630,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(data, \"invalid octets in name/value, cookie dropped\")",
          "new_text": null,
          "old_line_content": "            infof(data, \"invalid octets in name/value, cookie dropped\");",
          "new_line_content": "            badcookie = TRUE;",
          "content_same": false
        },
        {
          "line": 1148,
          "old_api": "freecookie",
          "new_api": null,
          "old_text": "freecookie(co)",
          "new_text": null,
          "old_line_content": "        freecookie(co);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": "strcasecompare",
          "new_api": null,
          "old_text": "strcasecompare(\"secure\", name)",
          "new_text": null,
          "old_line_content": "          if(strcasecompare(\"secure\", name)) {",
          "new_line_content": "            if(secure || !c->running) {",
          "content_same": false
        },
        {
          "line": 1672,
          "old_api": "remove_expired",
          "new_api": null,
          "old_text": "remove_expired(c)",
          "new_text": null,
          "old_line_content": "  remove_expired(c);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1674,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(\"-\", filename)",
          "new_text": null,
          "old_line_content": "  if(!strcmp(\"-\", filename)) {",
          "new_line_content": "    /* use stdout */",
          "content_same": false
        },
        {
          "line": 655,
          "old_api": "strcasecompare",
          "new_api": null,
          "old_text": "strcasecompare(\"httponly\", name)",
          "new_text": null,
          "old_line_content": "          else if(strcasecompare(\"httponly\", name))",
          "new_line_content": "            co->httponly = TRUE;",
          "content_same": false
        },
        {
          "line": 1680,
          "old_api": "Curl_fopen",
          "new_api": null,
          "old_text": "Curl_fopen(data, filename, &out, &tempstore)",
          "new_text": null,
          "old_line_content": "    error = Curl_fopen(data, filename, &out, &tempstore);",
          "new_line_content": "    if(error)",
          "content_same": false
        },
        {
          "line": 1685,
          "old_api": "fputs",
          "new_api": null,
          "old_text": "fputs(\"# Netscape HTTP Cookie File\\n\"\n        \"# https://curl.se/docs/http-cookies.html\\n\"\n        \"# This file was generated by libcurl! Edit at your own risk.\\n\\n\",\n        out)",
          "new_text": null,
          "old_line_content": "  fputs(\"# Netscape HTTP Cookie File\\n\"",
          "new_line_content": "        \"# https://curl.se/docs/http-cookies.html\\n\"",
          "content_same": false
        },
        {
          "line": 1175,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(clist->maxage)",
          "new_text": null,
          "old_line_content": "    free(clist->maxage);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 664,
          "old_api": "strstore",
          "new_api": null,
          "old_text": "strstore(&co->path, whatptr)",
          "new_text": null,
          "old_line_content": "          strstore(&co->path, whatptr);",
          "new_line_content": "          if(!co->path) {",
          "content_same": false
        },
        {
          "line": 1179,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(co)",
          "new_text": null,
          "old_line_content": "    free(co);   /* free the newly allocated memory */",
          "new_line_content": "    co = clist;",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": "sanitize_cookie_path",
          "new_api": null,
          "old_text": "sanitize_cookie_path(co->path)",
          "new_text": null,
          "old_line_content": "          co->spath = sanitize_cookie_path(co->path);",
          "new_line_content": "          if(!co->spath) {",
          "content_same": false
        },
        {
          "line": 1695,
          "old_api": "calloc",
          "new_api": null,
          "old_text": "calloc(1, sizeof(struct Cookie *) * c->numcookies)",
          "new_text": null,
          "old_line_content": "    array = calloc(1, sizeof(struct Cookie *) * c->numcookies);",
          "new_line_content": "    if(!array) {",
          "content_same": false
        },
        {
          "line": 1185,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(data, \"%s cookie %s=\\\"%s\\\" for domain %s, path %s, \"\n          \"expire %\" CURL_FORMAT_CURL_OFF_T,\n          replace_old?\"Replaced\":\"Added\", co->name, co->value,\n          co->domain, co->path, co->expires)",
          "new_text": null,
          "old_line_content": "    infof(data, \"%s cookie %s=\\\"%s\\\" for domain %s, path %s, \"",
          "new_line_content": "          \"expire %\" CURL_FORMAT_CURL_OFF_T,",
          "content_same": false
        },
        {
          "line": 676,
          "old_api": "strcasecompare",
          "new_api": null,
          "old_text": "strcasecompare(\"domain\", name)",
          "new_text": null,
          "old_line_content": "        else if(strcasecompare(\"domain\", name) && whatptr[0]) {",
          "new_line_content": "          bool is_ip;",
          "content_same": false
        },
        {
          "line": 1710,
          "old_api": "qsort",
          "new_api": null,
          "old_text": "qsort(array, nvalid, sizeof(struct Cookie *), cookie_sort_ct)",
          "new_text": null,
          "old_line_content": "    qsort(array, nvalid, sizeof(struct Cookie *), cookie_sort_ct);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1713,
          "old_api": "get_netscape_format",
          "new_api": null,
          "old_text": "get_netscape_format(array[i])",
          "new_text": null,
          "old_line_content": "      char *format_ptr = get_netscape_format(array[i]);",
          "new_line_content": "      if(!format_ptr) {",
          "content_same": false
        },
        {
          "line": 1715,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(array)",
          "new_text": null,
          "old_line_content": "        free(array);",
          "new_line_content": "        error = CURLE_OUT_OF_MEMORY;",
          "content_same": false
        },
        {
          "line": 693,
          "old_api": "bad_domain",
          "new_api": null,
          "old_text": "bad_domain(whatptr)",
          "new_text": null,
          "old_line_content": "          if(bad_domain(whatptr))",
          "new_line_content": "            domain = \":\";",
          "content_same": false
        },
        {
          "line": 1720,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(format_ptr)",
          "new_text": null,
          "old_line_content": "      free(format_ptr);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 697,
          "old_api": "Curl_host_is_ipnum",
          "new_api": null,
          "old_text": "Curl_host_is_ipnum(domain ? domain : whatptr)",
          "new_text": null,
          "old_line_content": "          is_ip = Curl_host_is_ipnum(domain ? domain : whatptr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1723,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(array)",
          "new_text": null,
          "old_line_content": "    free(array);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 702,
          "old_api": "strstore",
          "new_api": null,
          "old_text": "strstore(&co->domain, whatptr)",
          "new_text": null,
          "old_line_content": "            strstore(&co->domain, whatptr);",
          "new_line_content": "            if(!co->domain) {",
          "content_same": false
        },
        {
          "line": 1727,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(out)",
          "new_text": null,
          "old_line_content": "    fclose(out);",
          "new_line_content": "    out = NULL;",
          "content_same": false
        },
        {
          "line": 1730,
          "old_api": "unlink",
          "new_api": null,
          "old_text": "unlink(tempstore)",
          "new_text": null,
          "old_line_content": "      unlink(tempstore);",
          "new_line_content": "      error = CURLE_WRITE_ERROR;",
          "content_same": false
        },
        {
          "line": 717,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(data, \"skipped cookie with bad tailmatch domain: %s\",\n                  whatptr)",
          "new_text": null,
          "old_line_content": "            infof(data, \"skipped cookie with bad tailmatch domain: %s\",",
          "new_line_content": "                  whatptr);",
          "content_same": false
        },
        {
          "line": 1741,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(tempstore)",
          "new_text": null,
          "old_line_content": "  free(tempstore);",
          "new_line_content": "  return CURLE_OK;",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": "strstore",
          "new_api": null,
          "old_text": "strstore(&co->version, whatptr)",
          "new_text": null,
          "old_line_content": "          strstore(&co->version, whatptr);",
          "new_line_content": "          if(!co->version) {",
          "content_same": false
        },
        {
          "line": 1235,
          "old_api": "calloc",
          "new_api": null,
          "old_text": "calloc(1, sizeof(struct CookieInfo))",
          "new_text": null,
          "old_line_content": "    c = calloc(1, sizeof(struct CookieInfo));",
          "new_line_content": "    if(!c)",
          "content_same": false
        },
        {
          "line": 1747,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(tempstore)",
          "new_text": null,
          "old_line_content": "  free(tempstore);",
          "new_line_content": "  return error;",
          "content_same": false
        },
        {
          "line": 1238,
          "old_api": "strdup",
          "new_api": null,
          "old_text": "strdup(file?file:\"none\")",
          "new_text": null,
          "old_line_content": "    c->filename = strdup(file?file:\"none\"); /* copy the name just in case */",
          "new_line_content": "    if(!c->filename)",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "strcasecompare",
          "new_api": null,
          "old_text": "strcasecompare(\"max-age\", name)",
          "new_text": null,
          "old_line_content": "        else if(strcasecompare(\"max-age\", name)) {",
          "new_line_content": "          /*",
          "content_same": false
        },
        {
          "line": 738,
          "old_api": "strstore",
          "new_api": null,
          "old_text": "strstore(&co->maxage, whatptr)",
          "new_text": null,
          "old_line_content": "          strstore(&co->maxage, whatptr);",
          "new_line_content": "          if(!co->maxage) {",
          "content_same": false
        },
        {
          "line": 1253,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(file, \"-\")",
          "new_text": null,
          "old_line_content": "  if(file && !strcmp(file, \"-\")) {",
          "new_line_content": "    fp = stdin;",
          "content_same": false
        },
        {
          "line": 1766,
          "old_api": "get_netscape_format",
          "new_api": null,
          "old_text": "get_netscape_format(c)",
          "new_text": null,
          "old_line_content": "      line = get_netscape_format(c);",
          "new_line_content": "      if(!line) {",
          "content_same": false
        },
        {
          "line": 1768,
          "old_api": "curl_slist_free_all",
          "new_api": null,
          "old_text": "curl_slist_free_all(list)",
          "new_text": null,
          "old_line_content": "        curl_slist_free_all(list);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 745,
          "old_api": "strstore",
          "new_api": null,
          "old_text": "strstore(&co->expirestr, whatptr)",
          "new_text": null,
          "old_line_content": "          strstore(&co->expirestr, whatptr);",
          "new_line_content": "          if(!co->expirestr) {",
          "content_same": false
        },
        {
          "line": 1771,
          "old_api": "Curl_slist_append_nodup",
          "new_api": null,
          "old_text": "Curl_slist_append_nodup(list, line)",
          "new_text": null,
          "old_line_content": "      beg = Curl_slist_append_nodup(list, line);",
          "new_line_content": "      if(!beg) {",
          "content_same": false
        },
        {
          "line": 1262,
          "old_api": "fopen",
          "new_api": null,
          "old_text": "fopen(file, FOPEN_READTEXT)",
          "new_text": null,
          "old_line_content": "    fp = fopen(file, FOPEN_READTEXT);",
          "new_line_content": "    if(!fp)",
          "content_same": false
        },
        {
          "line": 1774,
          "old_api": "curl_slist_free_all",
          "new_api": null,
          "old_text": "curl_slist_free_all(list)",
          "new_text": null,
          "old_line_content": "        curl_slist_free_all(list);",
          "new_line_content": "        return NULL;",
          "content_same": false
        },
        {
          "line": 1264,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(data, \"WARNING: failed to open cookie file \\\"%s\\\"\", file)",
          "new_text": null,
          "old_line_content": "      infof(data, \"WARNING: failed to open cookie file \\\"%s\\\"\", file);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 1273,
          "old_api": "malloc",
          "new_api": null,
          "old_text": "malloc(MAX_COOKIE_LINE)",
          "new_text": null,
          "old_line_content": "    line = malloc(MAX_COOKIE_LINE);",
          "new_line_content": "    if(!line)",
          "content_same": false
        },
        {
          "line": 1277,
          "old_api": "checkprefix",
          "new_api": null,
          "old_text": "checkprefix(\"Set-Cookie:\", line)",
          "new_text": null,
          "old_line_content": "      if(checkprefix(\"Set-Cookie:\", line)) {",
          "new_line_content": "        /* This is a cookie line, get it! */",
          "content_same": false
        },
        {
          "line": 1789,
          "old_api": "Curl_share_unlock",
          "new_api": null,
          "old_text": "Curl_share_unlock(data, CURL_LOCK_DATA_COOKIE)",
          "new_text": null,
          "old_line_content": "  Curl_share_unlock(data, CURL_LOCK_DATA_COOKIE);",
          "new_line_content": "  return list;",
          "content_same": false
        },
        {
          "line": 767,
          "old_api": "ISBLANK",
          "new_api": null,
          "old_text": "ISBLANK(*ptr)",
          "new_text": null,
          "old_line_content": "      while(*ptr && ISBLANK(*ptr))",
          "new_line_content": "        ptr++;",
          "content_same": false
        },
        {
          "line": 769,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(ptr, ';')",
          "new_text": null,
          "old_line_content": "      semiptr = strchr(ptr, ';'); /* now, find the next semicolon */",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1286,
          "old_api": "ISBLANK",
          "new_api": null,
          "old_text": "ISBLANK(*lineptr)",
          "new_text": null,
          "old_line_content": "      while(*lineptr && ISBLANK(*lineptr))",
          "new_line_content": "        lineptr++;",
          "content_same": false
        },
        {
          "line": 776,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(ptr, '\\0')",
          "new_text": null,
          "old_line_content": "        semiptr = strchr(ptr, '\\0');",
          "new_line_content": "    } while(semiptr);",
          "content_same": false
        },
        {
          "line": 1289,
          "old_api": "Curl_cookie_add",
          "new_api": null,
          "old_text": "Curl_cookie_add(data, c, headerline, TRUE, lineptr, NULL, NULL, TRUE)",
          "new_text": null,
          "old_line_content": "      Curl_cookie_add(data, c, headerline, TRUE, lineptr, NULL, NULL, TRUE);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1802,
          "old_api": "Curl_cookie_loadfiles",
          "new_api": null,
          "old_text": "Curl_cookie_loadfiles(data)",
          "new_text": null,
          "old_line_content": "      Curl_cookie_loadfiles(data);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1291,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(line)",
          "new_text": null,
          "old_line_content": "    free(line); /* free the line buffer */",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 781,
          "old_api": "curlx_strtoofft",
          "new_api": null,
          "old_text": "curlx_strtoofft((*co->maxage == '\\\"')?\n                             &co->maxage[1]:&co->maxage[0], NULL, 10,\n                             &co->expires)",
          "new_text": null,
          "old_line_content": "      offt = curlx_strtoofft((*co->maxage == '\\\"')?",
          "new_line_content": "                             &co->maxage[1]:&co->maxage[0], NULL, 10,",
          "content_same": false
        },
        {
          "line": 1805,
          "old_api": "Curl_share_lock",
          "new_api": null,
          "old_text": "Curl_share_lock(data, CURL_LOCK_DATA_COOKIE, CURL_LOCK_ACCESS_SINGLE)",
          "new_text": null,
          "old_line_content": "    Curl_share_lock(data, CURL_LOCK_DATA_COOKIE, CURL_LOCK_ACCESS_SINGLE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1808,
          "old_api": "cookie_output",
          "new_api": null,
          "old_text": "cookie_output(data, data->cookies, data->set.str[STRING_COOKIEJAR])",
          "new_text": null,
          "old_line_content": "    res = cookie_output(data, data->cookies, data->set.str[STRING_COOKIEJAR]);",
          "new_line_content": "    if(res)",
          "content_same": false
        },
        {
          "line": 1297,
          "old_api": "remove_expired",
          "new_api": null,
          "old_text": "remove_expired(c)",
          "new_text": null,
          "old_line_content": "    remove_expired(c);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1811,
          "old_api": "curl_easy_strerror",
          "new_api": null,
          "old_text": "curl_easy_strerror(res)",
          "new_text": null,
          "old_line_content": "            data->set.str[STRING_COOKIEJAR], curl_easy_strerror(res));",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 1300,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(fp)",
          "new_text": null,
          "old_line_content": "      fclose(fp);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 1817,
          "old_api": "curl_slist_free_all",
          "new_api": null,
          "old_text": "curl_slist_free_all(data->state.cookielist)",
          "new_text": null,
          "old_line_content": "      curl_slist_free_all(data->state.cookielist); /* clean up list */",
          "new_line_content": "      data->state.cookielist = NULL;",
          "content_same": false
        },
        {
          "line": 1820,
          "old_api": "Curl_share_lock",
          "new_api": null,
          "old_text": "Curl_share_lock(data, CURL_LOCK_DATA_COOKIE, CURL_LOCK_ACCESS_SINGLE)",
          "new_text": null,
          "old_line_content": "    Curl_share_lock(data, CURL_LOCK_DATA_COOKIE, CURL_LOCK_ACCESS_SINGLE);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 1310,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(line)",
          "new_text": null,
          "old_line_content": "  free(line);",
          "new_line_content": "  /*",
          "content_same": false
        },
        {
          "line": 1824,
          "old_api": "Curl_cookie_cleanup",
          "new_api": null,
          "old_text": "Curl_cookie_cleanup(data->cookies)",
          "new_text": null,
          "old_line_content": "    Curl_cookie_cleanup(data->cookies);",
          "new_line_content": "    data->cookies = NULL;",
          "content_same": false
        },
        {
          "line": 803,
          "old_api": "Curl_getdate_capped",
          "new_api": null,
          "old_text": "Curl_getdate_capped(co->expirestr)",
          "new_text": null,
          "old_line_content": "      co->expires = Curl_getdate_capped(co->expirestr);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1316,
          "old_api": "Curl_cookie_cleanup",
          "new_api": null,
          "old_text": "Curl_cookie_cleanup(c)",
          "new_text": null,
          "old_line_content": "    Curl_cookie_cleanup(c);",
          "new_line_content": "  if(fromfile && fp)",
          "content_same": false
        },
        {
          "line": 1827,
          "old_api": "Curl_share_unlock",
          "new_api": null,
          "old_text": "Curl_share_unlock(data, CURL_LOCK_DATA_COOKIE)",
          "new_text": null,
          "old_line_content": "  Curl_share_unlock(data, CURL_LOCK_DATA_COOKIE);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1318,
          "old_api": "fclose",
          "new_api": null,
          "old_text": "fclose(fp)",
          "new_text": null,
          "old_line_content": "    fclose(fp);",
          "new_line_content": "  return NULL; /* out of memory */",
          "content_same": false
        },
        {
          "line": 818,
          "old_api": "strdup",
          "new_api": null,
          "old_text": "strdup(domain)",
          "new_text": null,
          "old_line_content": "        co->domain = strdup(domain);",
          "new_line_content": "        if(!co->domain)",
          "content_same": false
        },
        {
          "line": 1338,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(c2->path)",
          "new_text": null,
          "old_line_content": "  l2 = c2->path ? strlen(c2->path) : 0;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 830,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(path, '?')",
          "new_text": null,
          "old_line_content": "      char *queryp = strchr(path, '?');",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1345,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(c2->domain)",
          "new_text": null,
          "old_line_content": "  l2 = c2->domain ? strlen(c2->domain) : 0;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 838,
          "old_api": "strrchr",
          "new_api": null,
          "old_text": "strrchr(path, '/')",
          "new_text": null,
          "old_line_content": "        endslash = strrchr(path, '/');",
          "new_line_content": "      else",
          "content_same": false
        },
        {
          "line": 840,
          "old_api": "memrchr",
          "new_api": null,
          "old_text": "memrchr(path, '/', (queryp - path))",
          "new_text": null,
          "old_line_content": "        endslash = memrchr(path, '/', (queryp - path));",
          "new_line_content": "      if(endslash) {",
          "content_same": false
        },
        {
          "line": 1352,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(c2->name)",
          "new_text": null,
          "old_line_content": "  l2 = c2->name ? strlen(c2->name) : 0;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 843,
          "old_api": "malloc",
          "new_api": null,
          "old_text": "malloc(pathlen + 1)",
          "new_text": null,
          "old_line_content": "        co->path = malloc(pathlen + 1); /* one extra for the zero byte */",
          "new_line_content": "        if(co->path) {",
          "content_same": false
        },
        {
          "line": 845,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(co->path, path, pathlen)",
          "new_text": null,
          "old_line_content": "          memcpy(co->path, path, pathlen);",
          "new_line_content": "          co->path[pathlen] = 0; /* null-terminate */",
          "content_same": false
        },
        {
          "line": 847,
          "old_api": "sanitize_cookie_path",
          "new_api": null,
          "old_text": "sanitize_cookie_path(co->path)",
          "new_text": null,
          "old_line_content": "          co->spath = sanitize_cookie_path(co->path);",
          "new_line_content": "          if(!co->spath)",
          "content_same": false
        },
        {
          "line": 861,
          "old_api": "freecookie",
          "new_api": null,
          "old_text": "freecookie(co)",
          "new_text": null,
          "old_line_content": "      freecookie(co);",
          "new_line_content": "      return NULL;",
          "content_same": false
        },
        {
          "line": 1385,
          "old_api": "calloc",
          "new_api": null,
          "old_text": "calloc(sizeof(struct Cookie), 1)",
          "new_text": null,
          "old_line_content": "  struct Cookie *d = calloc(sizeof(struct Cookie), 1);",
          "new_line_content": "  if(d) {",
          "content_same": false
        },
        {
          "line": 1394,
          "old_api": "CLONE",
          "new_api": null,
          "old_text": "CLONE(version)",
          "new_text": null,
          "old_line_content": "    CLONE(version);",
          "new_line_content": "    d->expires = src->expires;",
          "content_same": false
        },
        {
          "line": 884,
          "old_api": "strncmp",
          "new_api": null,
          "old_text": "strncmp(lineptr, \"#HttpOnly_\", 10)",
          "new_text": null,
          "old_line_content": "    if(strncmp(lineptr, \"#HttpOnly_\", 10) == 0) {",
          "new_line_content": "      lineptr += 10;",
          "content_same": false
        },
        {
          "line": 891,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(co)",
          "new_text": null,
          "old_line_content": "      free(co);",
          "new_line_content": "      return NULL;",
          "content_same": false
        },
        {
          "line": 1405,
          "old_api": "freecookie",
          "new_api": null,
          "old_text": "freecookie(d)",
          "new_text": null,
          "old_line_content": "  freecookie(d);",
          "new_line_content": "  return NULL;",
          "content_same": false
        },
        {
          "line": 895,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(lineptr, '\\r')",
          "new_text": null,
          "old_line_content": "    ptr = strchr(lineptr, '\\r');",
          "new_line_content": "    if(ptr)",
          "content_same": false
        },
        {
          "line": 898,
          "old_api": "strchr",
          "new_api": null,
          "old_text": "strchr(lineptr, '\\n')",
          "new_text": null,
          "old_line_content": "    ptr = strchr(lineptr, '\\n');",
          "new_line_content": "    if(ptr)",
          "content_same": false
        },
        {
          "line": 902,
          "old_api": "strtok_r",
          "new_api": null,
          "old_text": "strtok_r(lineptr, \"\\t\", &tok_buf)",
          "new_text": null,
          "old_line_content": "    firstptr = strtok_r(lineptr, \"\\t\", &tok_buf); /* tokenize it on the TAB */",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 909,
          "old_api": "strtok_r",
          "new_api": null,
          "old_text": "strtok_r(NULL, \"\\t\", &tok_buf)",
          "new_text": null,
          "old_line_content": "        ptr = strtok_r(NULL, \"\\t\", &tok_buf), fields++) {",
          "new_line_content": "      switch(fields) {",
          "content_same": false
        },
        {
          "line": 914,
          "old_api": "strdup",
          "new_api": null,
          "old_text": "strdup(ptr)",
          "new_text": null,
          "old_line_content": "        co->domain = strdup(ptr);",
          "new_line_content": "        if(!co->domain)",
          "content_same": false
        },
        {
          "line": 1428,
          "old_api": "cookiehash",
          "new_api": null,
          "old_text": "cookiehash(host)",
          "new_text": null,
          "old_line_content": "  const size_t myhash = cookiehash(host);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1434,
          "old_api": "remove_expired",
          "new_api": null,
          "old_text": "remove_expired(c)",
          "new_text": null,
          "old_line_content": "  remove_expired(c);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 924,
          "old_api": "strcasecompare",
          "new_api": null,
          "old_text": "strcasecompare(ptr, \"TRUE\")",
          "new_text": null,
          "old_line_content": "        co->tailmatch = strcasecompare(ptr, \"TRUE\")?TRUE:FALSE;",
          "new_line_content": "        break;",
          "content_same": false
        },
        {
          "line": 1437,
          "old_api": "Curl_host_is_ipnum",
          "new_api": null,
          "old_text": "Curl_host_is_ipnum(host)",
          "new_text": null,
          "old_line_content": "  is_ip = Curl_host_is_ipnum(host);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 928,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(\"FALSE\", ptr)",
          "new_text": null,
          "old_line_content": "        if(strcmp(\"TRUE\", ptr) && strcmp(\"FALSE\", ptr)) {",
          "new_line_content": "          /* only if the path doesn't look like a boolean option! */",
          "content_same": false
        },
        {
          "line": 930,
          "old_api": "strdup",
          "new_api": null,
          "old_text": "strdup(ptr)",
          "new_text": null,
          "old_line_content": "          co->path = strdup(ptr);",
          "new_line_content": "          if(!co->path)",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": "sanitize_cookie_path",
          "new_api": null,
          "old_text": "sanitize_cookie_path(co->path)",
          "new_text": null,
          "old_line_content": "            co->spath = sanitize_cookie_path(co->path);",
          "new_line_content": "            if(!co->spath) {",
          "content_same": false
        },
        {
          "line": 1448,
          "old_api": "strcasecompare",
          "new_api": null,
          "old_text": "strcasecompare(host, co->domain)",
          "new_text": null,
          "old_line_content": "         ((!co->tailmatch || is_ip) && strcasecompare(host, co->domain)) ) {",
          "new_line_content": "        /*",
          "content_same": false
        },
        {
          "line": 942,
          "old_api": "strdup",
          "new_api": null,
          "old_text": "strdup(\"/\")",
          "new_text": null,
          "old_line_content": "        co->path = strdup(\"/\");",
          "new_line_content": "        if(!co->path)",
          "content_same": false
        },
        {
          "line": 945,
          "old_api": "strdup",
          "new_api": null,
          "old_text": "strdup(\"/\")",
          "new_text": null,
          "old_line_content": "        co->spath = strdup(\"/\");",
          "new_line_content": "        if(!co->spath)",
          "content_same": false
        },
        {
          "line": 1458,
          "old_api": "pathmatch",
          "new_api": null,
          "old_text": "pathmatch(co->spath, path)",
          "new_text": null,
          "old_line_content": "        if(!co->spath || pathmatch(co->spath, path) ) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 952,
          "old_api": "strcasecompare",
          "new_api": null,
          "old_text": "strcasecompare(ptr, \"TRUE\")",
          "new_text": null,
          "old_line_content": "        if(strcasecompare(ptr, \"TRUE\")) {",
          "new_line_content": "          if(secure || c->running)",
          "content_same": false
        },
        {
          "line": 1465,
          "old_api": "dup_cookie",
          "new_api": null,
          "old_text": "dup_cookie(co)",
          "new_text": null,
          "old_line_content": "          newco = dup_cookie(co);",
          "new_line_content": "          if(newco) {",
          "content_same": false
        },
        {
          "line": 960,
          "old_api": "curlx_strtoofft",
          "new_api": null,
          "old_text": "curlx_strtoofft(ptr, NULL, 10, &co->expires)",
          "new_text": null,
          "old_line_content": "        if(curlx_strtoofft(ptr, NULL, 10, &co->expires))",
          "new_line_content": "          badcookie = TRUE;",
          "content_same": false
        },
        {
          "line": 1475,
          "old_api": "infof",
          "new_api": null,
          "old_text": "infof(data, \"Included max number of cookies (%zu) in request!\",\n                    matches)",
          "new_text": null,
          "old_line_content": "              infof(data, \"Included max number of cookies (%zu) in request!\",",
          "new_line_content": "                    matches);",
          "content_same": false
        },
        {
          "line": 964,
          "old_api": "strdup",
          "new_api": null,
          "old_text": "strdup(ptr)",
          "new_text": null,
          "old_line_content": "        co->name = strdup(ptr);",
          "new_line_content": "        if(!co->name)",
          "content_same": false
        },
        {
          "line": 969,
          "old_api": "strncasecompare",
          "new_api": null,
          "old_text": "strncasecompare(\"__Secure-\", co->name, 9)",
          "new_text": null,
          "old_line_content": "          if(strncasecompare(\"__Secure-\", co->name, 9))",
          "new_line_content": "            co->prefix |= COOKIE_PREFIX__SECURE;",
          "content_same": false
        },
        {
          "line": 971,
          "old_api": "strncasecompare",
          "new_api": null,
          "old_text": "strncasecompare(\"__Host-\", co->name, 7)",
          "new_text": null,
          "old_line_content": "          else if(strncasecompare(\"__Host-\", co->name, 7))",
          "new_line_content": "            co->prefix |= COOKIE_PREFIX__HOST;",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": "strlen",
          "new_api": null,
          "old_text": "strlen(p)",
          "new_text": null,
          "old_line_content": "  vlen = strlen(p);",
          "new_line_content": "  return (p[len] != '\\0');",
          "content_same": false
        },
        {
          "line": 976,
          "old_api": "strdup",
          "new_api": null,
          "old_text": "strdup(ptr)",
          "new_text": null,
          "old_line_content": "        co->value = strdup(ptr);",
          "new_line_content": "        if(!co->value)",
          "content_same": false
        },
        {
          "line": 984,
          "old_api": "strdup",
          "new_api": null,
          "old_text": "strdup(\"\")",
          "new_text": null,
          "old_line_content": "      co->value = strdup(\"\");",
          "new_line_content": "      if(!co->value)",
          "content_same": false
        },
        {
          "line": 1498,
          "old_api": "malloc",
          "new_api": null,
          "old_text": "malloc(sizeof(struct Cookie *) * matches)",
          "new_text": null,
          "old_line_content": "    array = malloc(sizeof(struct Cookie *) * matches);",
          "new_line_content": "    if(!array)",
          "content_same": false
        },
        {
          "line": 996,
          "old_api": "freecookie",
          "new_api": null,
          "old_text": "freecookie(co)",
          "new_text": null,
          "old_line_content": "      freecookie(co);",
          "new_line_content": "      return NULL;",
          "content_same": false
        },
        {
          "line": 1508,
          "old_api": "qsort",
          "new_api": null,
          "old_text": "qsort(array, matches, sizeof(struct Cookie *), cookie_sort)",
          "new_text": null,
          "old_line_content": "    qsort(array, matches, sizeof(struct Cookie *), cookie_sort);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1005,
          "old_api": "freecookie",
          "new_api": null,
          "old_text": "freecookie(co)",
          "new_text": null,
          "old_line_content": "      freecookie(co);",
          "new_line_content": "      return NULL;",
          "content_same": false
        },
        {
          "line": 1517,
          "old_api": "free",
          "new_api": null,
          "old_text": "free(array)",
          "new_text": null,
          "old_line_content": "    free(array); /* remove the temporary data again */",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 500,
          "old_api": "time",
          "new_api": null,
          "old_text": "time(NULL)",
          "new_text": null,
          "old_line_content": "  time_t now = time(NULL);",
          "new_line_content": "  bool replace_old = FALSE;",
          "content_same": false
        },
        {
          "line": 1524,
          "old_api": "Curl_cookie_freelist",
          "new_api": null,
          "old_text": "Curl_cookie_freelist(mainco)",
          "new_text": null,
          "old_line_content": "  Curl_cookie_freelist(mainco);",
          "new_line_content": "  return NULL;",
          "content_same": false
        },
        {
          "line": 1014,
          "old_api": "strcmp",
          "new_api": null,
          "old_text": "strcmp(co->path, \"/\")",
          "new_text": null,
          "old_line_content": "    if(co->secure && co->path && strcmp(co->path, \"/\") == 0 && !co->tailmatch)",
          "new_line_content": "      ;",
          "content_same": false
        },
        {
          "line": 1017,
          "old_api": "freecookie",
          "new_api": null,
          "old_text": "freecookie(co)",
          "new_text": null,
          "old_line_content": "      freecookie(co);",
          "new_line_content": "      return NULL;",
          "content_same": false
        },
        {
          "line": 509,
          "old_api": "DEBUGASSERT",
          "new_api": null,
          "old_text": "DEBUGASSERT(MAX_SET_COOKIE_AMOUNT <= 255)",
          "new_text": null,
          "old_line_content": "  DEBUGASSERT(MAX_SET_COOKIE_AMOUNT <= 255); /* counter is an unsigned char */",
          "new_line_content": "  if(data->req.setcookies >= MAX_SET_COOKIE_AMOUNT)",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 23,
      "total_additions": 155,
      "total_deletions": 156,
      "total_api_changes": 334
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 334,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          465,
          461
        ]
      }
    },
    "api_calls_before": 243,
    "api_calls_after": 242,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 3,
      "total_diff_lines": 19
    }
  }
}