{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/netdata/modified_file/88037bf63132dd5d5b15b80647d65a75fcb82055",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/netdata/modified_file/88037bf63132dd5d5b15b80647d65a75fcb82055/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/netdata/modified_file/88037bf63132dd5d5b15b80647d65a75fcb82055/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/netdata/modified_file/88037bf63132dd5d5b15b80647d65a75fcb82055/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 2184,
          "old_api": "GETSYSCTL",
          "new_api": "clock_gettime",
          "old_text": "GETSYSCTL(\"kern.boottime\", boot_time)",
          "new_text": "clock_gettime(CLOCK_UPTIME, &up_time)",
          "old_line_content": "        if (unlikely(GETSYSCTL(\"kern.boottime\", boot_time))) {",
          "new_line_content": "            clock_gettime(CLOCK_UPTIME, &up_time);",
          "content_same": false
        },
        {
          "line": 2188,
          "old_api": "clock_gettime",
          "new_api": "rrdset_create_localhost",
          "old_text": "clock_gettime(CLOCK_REALTIME, &cur_time)",
          "new_text": "rrdset_create_localhost(\"system\", \"uptime\", NULL, \"uptime\", NULL, \"System Uptime\", \"seconds\", 1000, update_every, RRDSET_TYPE_LINE)",
          "old_line_content": "            clock_gettime(CLOCK_REALTIME, &cur_time);",
          "new_line_content": "                st = rrdset_create_localhost(\"system\", \"uptime\", NULL, \"uptime\", NULL, \"System Uptime\", \"seconds\", 1000, update_every, RRDSET_TYPE_LINE);",
          "content_same": false
        },
        {
          "line": 2189,
          "old_api": "rrdset_find_localhost",
          "new_api": "rrddim_add",
          "old_text": "rrdset_find_localhost(\"system.uptime\")",
          "new_text": "rrddim_add(st, \"uptime\", NULL, 1, 1, RRD_ALGORITHM_ABSOLUTE)",
          "old_line_content": "            st = rrdset_find_localhost(\"system.uptime\");",
          "new_line_content": "                rrddim_add(st, \"uptime\", NULL, 1, 1, RRD_ALGORITHM_ABSOLUTE);",
          "content_same": false
        },
        {
          "line": 2191,
          "old_api": "unlikely",
          "new_api": "rrdset_next",
          "old_text": "unlikely(!st)",
          "new_text": "rrdset_next(st)",
          "old_line_content": "            if(unlikely(!st)) {",
          "new_line_content": "            else rrdset_next(st);",
          "content_same": false
        },
        {
          "line": 2193,
          "old_api": "rrddim_add",
          "new_api": "rrddim_set",
          "old_text": "rrddim_add(st, \"uptime\", NULL, 1, 1, RRD_ALGORITHM_ABSOLUTE)",
          "new_text": "rrddim_set(st, \"uptime\", up_time.tv_sec)",
          "old_line_content": "                rrddim_add(st, \"uptime\", NULL, 1, 1, RRD_ALGORITHM_ABSOLUTE);",
          "new_line_content": "            rrddim_set(st, \"uptime\", up_time.tv_sec);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 2185,
          "old_api": null,
          "new_api": "rrdset_find_localhost",
          "old_text": null,
          "new_text": "rrdset_find_localhost(\"system.uptime\")",
          "old_line_content": "            do_uptime = 0;",
          "new_line_content": "            st = rrdset_find_localhost(\"system.uptime\");",
          "content_same": false
        },
        {
          "line": 2194,
          "old_api": null,
          "new_api": "rrdset_done",
          "old_text": null,
          "new_text": "rrdset_done(st)",
          "old_line_content": "            }",
          "new_line_content": "            rrdset_done(st);",
          "content_same": false
        },
        {
          "line": 2187,
          "old_api": null,
          "new_api": "unlikely",
          "old_text": null,
          "new_text": "unlikely(!st)",
          "old_line_content": "        } else {",
          "new_line_content": "            if(unlikely(!st)) {",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 2186,
          "old_api": "error",
          "new_api": null,
          "old_text": "error(\"DISABLED: system.uptime\")",
          "new_text": null,
          "old_line_content": "            error(\"DISABLED: system.uptime\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2192,
          "old_api": "rrdset_create_localhost",
          "new_api": null,
          "old_text": "rrdset_create_localhost(\"system\", \"uptime\", NULL, \"uptime\", NULL, \"System Uptime\", \"seconds\", 1000, update_every, RRDSET_TYPE_LINE)",
          "new_text": null,
          "old_line_content": "                st = rrdset_create_localhost(\"system\", \"uptime\", NULL, \"uptime\", NULL, \"System Uptime\", \"seconds\", 1000, update_every, RRDSET_TYPE_LINE);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2195,
          "old_api": "rrdset_next",
          "new_api": null,
          "old_text": "rrdset_next(st)",
          "new_text": null,
          "old_line_content": "            else rrdset_next(st);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2197,
          "old_api": "rrddim_set",
          "new_api": null,
          "old_text": "rrddim_set(st, \"uptime\", cur_time.tv_sec - boot_time.tv_sec)",
          "new_text": null,
          "old_line_content": "            rrddim_set(st, \"uptime\", cur_time.tv_sec - boot_time.tv_sec);",
          "new_line_content": "    return 0;",
          "content_same": false
        },
        {
          "line": 2198,
          "old_api": "rrdset_done",
          "new_api": null,
          "old_text": "rrdset_done(st)",
          "new_text": null,
          "old_line_content": "            rrdset_done(st);",
          "new_line_content": "}",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 5,
      "total_additions": 3,
      "total_deletions": 5,
      "total_api_changes": 13
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 9,
        "api_related_lines": 13,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          277,
          2199
        ]
      }
    },
    "api_calls_before": 1119,
    "api_calls_after": 1116,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 8,
      "total_diff_lines": 38
    }
  }
}