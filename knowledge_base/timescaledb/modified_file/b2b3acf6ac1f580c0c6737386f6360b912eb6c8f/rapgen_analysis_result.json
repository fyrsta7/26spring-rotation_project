{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/timescaledb/modified_file/b2b3acf6ac1f580c0c6737386f6360b912eb6c8f",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/timescaledb/modified_file/b2b3acf6ac1f580c0c6737386f6360b912eb6c8f/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/timescaledb/modified_file/b2b3acf6ac1f580c0c6737386f6360b912eb6c8f/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/timescaledb/modified_file/b2b3acf6ac1f580c0c6737386f6360b912eb6c8f/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 979,
          "old_api": "find_placeholder_info",
          "new_api": "bms_overlap",
          "old_text": "find_placeholder_info(root, phv, false)",
          "new_text": "bms_overlap(phv->phrels, root->curOuterRels)",
          "old_line_content": "\t\t\t!bms_is_subset(find_placeholder_info(root, phv, false)->ph_eval_at, root->curOuterRels))",
          "new_line_content": "\t\tif (!bms_overlap(phv->phrels, root->curOuterRels) ||",
          "content_same": false
        },
        {
          "line": 1003,
          "old_api": "replace_nestloop_param_placeholdervar",
          "new_api": "memcpy",
          "old_text": "replace_nestloop_param_placeholdervar(root, phv)",
          "new_text": "memcpy(newphv, phv, sizeof(PlaceHolderVar))",
          "old_line_content": "\t\treturn (Node *) replace_nestloop_param_placeholdervar(root, phv);",
          "new_line_content": "\t\t\tmemcpy(newphv, phv, sizeof(PlaceHolderVar));",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1065,
          "old_api": null,
          "new_api": "make_result",
          "old_text": null,
          "new_text": "make_result(tlist, NULL, subplan)",
          "old_line_content": "\t * already and the latter was not accounted for during Path construction,",
          "new_line_content": "\tplan = (Plan *) make_result(tlist, NULL, subplan);",
          "content_same": false
        },
        {
          "line": 1001,
          "old_api": null,
          "new_api": "makeNode",
          "old_text": null,
          "new_text": "makeNode(PlaceHolderVar)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tPlaceHolderVar *newphv = makeNode(PlaceHolderVar);",
          "content_same": false
        },
        {
          "line": 1004,
          "old_api": null,
          "new_api": "replace_nestloop_params_mutator",
          "old_text": null,
          "new_text": "replace_nestloop_params_mutator((Node *) phv->phexpr, root)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tnewphv->phexpr = (Expr *) replace_nestloop_params_mutator((Node *) phv->phexpr, root);",
          "content_same": false
        },
        {
          "line": 1008,
          "old_api": null,
          "new_api": "replace_nestloop_param_placeholdervar",
          "old_text": null,
          "new_text": "replace_nestloop_param_placeholdervar(root, phv)",
          "old_line_content": "/*",
          "new_line_content": "\t\treturn (Node *) replace_nestloop_param_placeholdervar(root, phv);",
          "content_same": false
        },
        {
          "line": 1074,
          "old_api": null,
          "new_api": "copy_plan_costsize",
          "old_text": null,
          "new_text": "copy_plan_costsize(plan, subplan)",
          "old_line_content": "",
          "new_line_content": "\tcopy_plan_costsize(plan, subplan);",
          "content_same": false
        },
        {
          "line": 1010,
          "old_api": null,
          "new_api": "expression_tree_mutator",
          "old_text": null,
          "new_text": "expression_tree_mutator(node, replace_nestloop_params_mutator, (void *) root)",
          "old_line_content": " *\t  Build a Result plan node",
          "new_line_content": "\treturn expression_tree_mutator(node, replace_nestloop_params_mutator, (void *) root);",
          "content_same": false
        },
        {
          "line": 980,
          "old_api": null,
          "new_api": "find_placeholder_info",
          "old_text": null,
          "new_text": "find_placeholder_info(root, phv, false)",
          "old_line_content": "\t\t{",
          "new_line_content": "\t\t\t!bms_is_subset(find_placeholder_info(root, phv, false)->ph_eval_at, root->curOuterRels))",
          "content_same": false
        },
        {
          "line": 983,
          "old_api": null,
          "new_api": "find_placeholder_info",
          "old_text": null,
          "new_text": "find_placeholder_info(root, phv)",
          "old_line_content": "\t\t\t * replace Vars or PHVs within its expression, in case it ends up",
          "new_line_content": "\t\tif (!bms_is_subset(find_placeholder_info(root, phv)->ph_eval_at, root->curOuterRels))",
          "content_same": false
        },
        {
          "line": 1020,
          "old_api": null,
          "new_api": "makeNode",
          "old_text": null,
          "new_text": "makeNode(Result)",
          "old_line_content": "\tplan->lefttree = subplan;",
          "new_line_content": "\tResult *node = makeNode(Result);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 996,
          "old_api": "makeNode",
          "new_api": null,
          "old_text": "makeNode(PlaceHolderVar)",
          "new_text": null,
          "old_line_content": "\t\t\tPlaceHolderVar *newphv = makeNode(PlaceHolderVar);",
          "new_line_content": "\t\t\t * representations of the contents of the same PHV in different",
          "content_same": false
        },
        {
          "line": 1060,
          "old_api": "make_result",
          "new_api": null,
          "old_text": "make_result(tlist, NULL, subplan)",
          "new_text": null,
          "old_line_content": "\tplan = (Plan *) make_result(tlist, NULL, subplan);",
          "new_line_content": "static Plan *",
          "content_same": false
        },
        {
          "line": 998,
          "old_api": "memcpy",
          "new_api": null,
          "old_text": "memcpy(newphv, phv, sizeof(PlaceHolderVar))",
          "new_text": null,
          "old_line_content": "\t\t\tmemcpy(newphv, phv, sizeof(PlaceHolderVar));",
          "new_line_content": "\t\t\t * match on phid/phlevelsup, so setrefs.c will still recognize an",
          "content_same": false
        },
        {
          "line": 999,
          "old_api": "replace_nestloop_params_mutator",
          "new_api": null,
          "old_text": "replace_nestloop_params_mutator((Node *) phv->phexpr, root)",
          "new_text": null,
          "old_line_content": "\t\t\tnewphv->phexpr = (Expr *) replace_nestloop_params_mutator((Node *) phv->phexpr, root);",
          "new_line_content": "\t\t\t * upper-level reference to a lower-level copy of the same PHV.",
          "content_same": false
        },
        {
          "line": 1069,
          "old_api": "copy_plan_costsize",
          "new_api": null,
          "old_text": "copy_plan_costsize(plan, subplan)",
          "new_text": null,
          "old_line_content": "\tcopy_plan_costsize(plan, subplan);",
          "new_line_content": "\t * row for the Result node.  But the former has probably been factored in",
          "content_same": false
        },
        {
          "line": 1005,
          "old_api": "expression_tree_mutator",
          "new_api": null,
          "old_text": "expression_tree_mutator(node, replace_nestloop_params_mutator, (void *) root)",
          "new_text": null,
          "old_line_content": "\treturn expression_tree_mutator(node, replace_nestloop_params_mutator, (void *) root);",
          "new_line_content": "\t\t\treturn (Node *) newphv;",
          "content_same": false
        },
        {
          "line": 978,
          "old_api": "bms_overlap",
          "new_api": null,
          "old_text": "bms_overlap(phv->phrels, root->curOuterRels)",
          "new_text": null,
          "old_line_content": "\t\tif (!bms_overlap(phv->phrels, root->curOuterRels) ||",
          "new_line_content": "\t\t */",
          "content_same": false
        },
        {
          "line": 1015,
          "old_api": "makeNode",
          "new_api": null,
          "old_text": "makeNode(Result)",
          "new_text": null,
          "old_line_content": "\tResult *node = makeNode(Result);",
          "new_line_content": " *\t  Build a Result plan node",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 2,
      "total_additions": 9,
      "total_deletions": 8,
      "total_api_changes": 19
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 19,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          981,
          973,
          982,
          984
        ]
      }
    },
    "api_calls_before": 145,
    "api_calls_after": 147,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 0,
      "total_diff_lines": 24
    }
  }
}