{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/timescaledb/modified_file/6687189a6c9c6b4b1b57dfe1e2e7c958a259af49",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/timescaledb/modified_file/6687189a6c9c6b4b1b57dfe1e2e7c958a259af49/before.c",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/timescaledb/modified_file/6687189a6c9c6b4b1b57dfe1e2e7c958a259af49/after.c",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/timescaledb/modified_file/6687189a6c9c6b4b1b57dfe1e2e7c958a259af49/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 996,
          "old_api": "FreeBulkInsertState",
          "new_api": "heap_endscan",
          "old_text": "FreeBulkInsertState(decompressor.bistate)",
          "new_text": "heap_endscan(heapScan)",
          "old_line_content": "\t\tFreeBulkInsertState(decompressor.bistate);",
          "new_line_content": "\t\theap_endscan(heapScan);",
          "content_same": false
        },
        {
          "line": 1023,
          "old_api": "NameStr",
          "new_api": "TupleDescAttr",
          "old_text": "NameStr(compressed_attr->attname)",
          "new_text": "TupleDescAttr(in_desc, col)",
          "old_line_content": "\t\tchar *col_name = NameStr(compressed_attr->attname);",
          "new_line_content": "\t\tForm_pg_attribute compressed_attr = TupleDescAttr(in_desc, col);",
          "content_same": false
        },
        {
          "line": 1030,
          "old_api": "AttributeNumberIsValid",
          "new_api": "get_attnum",
          "old_text": "AttributeNumberIsValid(decompressed_colnum)",
          "new_text": "get_attnum(out_relid, col_name)",
          "old_line_content": "\t\tif (!AttributeNumberIsValid(decompressed_colnum))",
          "new_line_content": "\t\tAttrNumber decompressed_colnum = get_attnum(out_relid, col_name);",
          "content_same": false
        },
        {
          "line": 1090,
          "old_api": "PointerGetDatum",
          "new_api": "iterator_init_forward",
          "old_text": "PointerGetDatum(data)",
          "new_text": "definitions[header->compression_algorithm]\n\t\t\t\t\t.iterator_init_forward(PointerGetDatum(data), per_col->decompressed_type)",
          "old_line_content": "\t\t\t\t\t.iterator_init_forward(PointerGetDatum(data), per_col->decompressed_type);",
          "new_line_content": "\t\t\t\tdefinitions[header->compression_algorithm]",
          "content_same": false
        },
        {
          "line": 1205,
          "old_api": "PG_RETURN_NULL",
          "new_api": "PG_ARGISNULL",
          "old_text": "PG_RETURN_NULL()",
          "new_text": "PG_ARGISNULL(0)",
          "old_line_content": "\t\tPG_RETURN_NULL();",
          "new_line_content": "\tif (PG_ARGISNULL(0))",
          "content_same": false
        },
        {
          "line": 1208,
          "old_api": "PG_DETOAST_DATUM",
          "new_api": "PG_GETARG_DATUM",
          "old_text": "PG_DETOAST_DATUM(compressed)",
          "new_text": "PG_GETARG_DATUM(0)",
          "old_line_content": "\theader = (CompressedDataHeader *) PG_DETOAST_DATUM(compressed);",
          "new_line_content": "\tcompressed = PG_GETARG_DATUM(0);",
          "content_same": false
        },
        {
          "line": 1213,
          "old_api": "MemoryContextSwitchTo",
          "new_api": "SRF_FIRSTCALL_INIT",
          "old_text": "MemoryContextSwitchTo(funcctx->multi_call_memory_ctx)",
          "new_text": "SRF_FIRSTCALL_INIT()",
          "old_line_content": "\t\toldcontext = MemoryContextSwitchTo(funcctx->multi_call_memory_ctx);",
          "new_line_content": "\t\tfuncctx = SRF_FIRSTCALL_INIT();",
          "content_same": false
        },
        {
          "line": 1217,
          "old_api": "get_fn_expr_argtype",
          "new_api": "iterator_init_forward",
          "old_text": "get_fn_expr_argtype(fcinfo->flinfo, 1)",
          "new_text": "definitions[header->compression_algorithm]\n\t\t\t\t.iterator_init_forward(PG_GETARG_DATUM(0), get_fn_expr_argtype(fcinfo->flinfo, 1))",
          "old_line_content": "\t\t\t\t.iterator_init_forward(PG_GETARG_DATUM(0), get_fn_expr_argtype(fcinfo->flinfo, 1));",
          "new_line_content": "\t\t\tdefinitions[header->compression_algorithm]",
          "content_same": false
        },
        {
          "line": 1248,
          "old_api": "PG_RETURN_NULL",
          "new_api": "PG_ARGISNULL",
          "old_text": "PG_RETURN_NULL()",
          "new_text": "PG_ARGISNULL(0)",
          "old_line_content": "\t\tPG_RETURN_NULL();",
          "new_line_content": "\tif (PG_ARGISNULL(0))",
          "content_same": false
        },
        {
          "line": 1251,
          "old_api": "PG_DETOAST_DATUM",
          "new_api": "PG_GETARG_DATUM",
          "old_text": "PG_DETOAST_DATUM(compressed)",
          "new_text": "PG_GETARG_DATUM(0)",
          "old_line_content": "\theader = (CompressedDataHeader *) PG_DETOAST_DATUM(compressed);",
          "new_line_content": "\tcompressed = PG_GETARG_DATUM(0);",
          "content_same": false
        },
        {
          "line": 1252,
          "old_api": "SRF_IS_FIRSTCALL",
          "new_api": "PG_DETOAST_DATUM",
          "old_text": "SRF_IS_FIRSTCALL()",
          "new_text": "PG_DETOAST_DATUM(compressed)",
          "old_line_content": "\tif (SRF_IS_FIRSTCALL())",
          "new_line_content": "\theader = (CompressedDataHeader *) PG_DETOAST_DATUM(compressed);",
          "content_same": false
        },
        {
          "line": 1255,
          "old_api": "MemoryContextSwitchTo",
          "new_api": "SRF_FIRSTCALL_INIT",
          "old_text": "MemoryContextSwitchTo(funcctx->multi_call_memory_ctx)",
          "new_text": "SRF_FIRSTCALL_INIT()",
          "old_line_content": "\t\toldcontext = MemoryContextSwitchTo(funcctx->multi_call_memory_ctx);",
          "new_line_content": "\t\tfuncctx = SRF_FIRSTCALL_INIT();",
          "content_same": false
        },
        {
          "line": 1259,
          "old_api": "get_fn_expr_argtype",
          "new_api": "iterator_init_reverse",
          "old_text": "get_fn_expr_argtype(fcinfo->flinfo, 1)",
          "new_text": "definitions[header->compression_algorithm]\n\t\t\t\t.iterator_init_reverse(PG_GETARG_DATUM(0), get_fn_expr_argtype(fcinfo->flinfo, 1))",
          "old_line_content": "\t\t\t\t.iterator_init_reverse(PG_GETARG_DATUM(0), get_fn_expr_argtype(fcinfo->flinfo, 1));",
          "new_line_content": "\t\t\tdefinitions[header->compression_algorithm]",
          "content_same": false
        },
        {
          "line": 1286,
          "old_api": "pq_sendbyte",
          "new_api": "pq_begintypsend",
          "old_text": "pq_sendbyte(&buf, header->compression_algorithm)",
          "new_text": "pq_begintypsend(&buf)",
          "old_line_content": "\tpq_sendbyte(&buf, header->compression_algorithm);",
          "new_line_content": "\tpq_begintypsend(&buf);",
          "content_same": false
        },
        {
          "line": 1308,
          "old_api": "strlen",
          "new_api": "PG_GETARG_CSTRING",
          "old_text": "strlen(input)",
          "new_text": "PG_GETARG_CSTRING(0)",
          "old_line_content": "\tsize_t input_len = strlen(input);",
          "new_line_content": "\tconst char *input = PG_GETARG_CSTRING(0);",
          "content_same": false
        },
        {
          "line": 1318,
          "old_api": "palloc",
          "new_api": "pg_b64_dec_len",
          "old_text": "palloc(decoded_len + 1)",
          "new_text": "pg_b64_dec_len(input_len)",
          "old_line_content": "\tdecoded = palloc(decoded_len + 1);",
          "new_line_content": "\tdecoded_len = pg_b64_dec_len(input_len);",
          "content_same": false
        },
        {
          "line": 1319,
          "old_api": "pg_b64_decode",
          "new_api": "palloc",
          "old_text": "pg_b64_decode(input, input_len, decoded)",
          "new_text": "palloc(decoded_len + 1)",
          "old_line_content": "\tdecoded_len = pg_b64_decode(input, input_len, decoded);",
          "new_line_content": "\tdecoded = palloc(decoded_len + 1);",
          "content_same": false
        },
        {
          "line": 1336,
          "old_api": "DatumGetByteaP",
          "new_api": "PG_GETARG_DATUM",
          "old_text": "DatumGetByteaP(bytes_data)",
          "new_text": "PG_GETARG_DATUM(0)",
          "old_line_content": "\tbytea *bytes = DatumGetByteaP(bytes_data);",
          "new_line_content": "\tDatum bytes_data = DirectFunctionCall1(tsl_compressed_data_send, PG_GETARG_DATUM(0));",
          "content_same": false
        },
        {
          "line": 1337,
          "old_api": "VARSIZE_ANY_EXHDR",
          "new_api": "DatumGetByteaP",
          "old_text": "VARSIZE_ANY_EXHDR(bytes)",
          "new_text": "DatumGetByteaP(bytes_data)",
          "old_line_content": "\tint raw_len = VARSIZE_ANY_EXHDR(bytes);",
          "new_line_content": "\tbytea *bytes = DatumGetByteaP(bytes_data);",
          "content_same": false
        },
        {
          "line": 1338,
          "old_api": "VARDATA",
          "new_api": "VARSIZE_ANY_EXHDR",
          "old_text": "VARDATA(bytes)",
          "new_text": "VARSIZE_ANY_EXHDR(bytes)",
          "old_line_content": "\tconst char *raw_data = VARDATA(bytes);",
          "new_line_content": "\tint raw_len = VARSIZE_ANY_EXHDR(bytes);",
          "content_same": false
        },
        {
          "line": 1339,
          "old_api": "pg_b64_enc_len",
          "new_api": "VARDATA",
          "old_text": "pg_b64_enc_len(raw_len)",
          "new_text": "VARDATA(bytes)",
          "old_line_content": "\tint encoded_len = pg_b64_enc_len(raw_len);",
          "new_line_content": "\tconst char *raw_data = VARDATA(bytes);",
          "content_same": false
        },
        {
          "line": 1340,
          "old_api": "palloc",
          "new_api": "pg_b64_enc_len",
          "old_text": "palloc(encoded_len + 1)",
          "new_text": "pg_b64_enc_len(raw_len)",
          "old_line_content": "\tchar *encoded = palloc(encoded_len + 1);",
          "new_line_content": "\tint encoded_len = pg_b64_enc_len(raw_len);",
          "content_same": false
        },
        {
          "line": 1341,
          "old_api": "pg_b64_encode",
          "new_api": "palloc",
          "old_text": "pg_b64_encode(raw_data, raw_len, encoded)",
          "new_text": "palloc(encoded_len + 1)",
          "old_line_content": "\tencoded_len = pg_b64_encode(raw_data, raw_len, encoded);",
          "new_line_content": "\tchar *encoded = palloc(encoded_len + 1);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1024,
          "old_api": null,
          "new_api": "NameStr",
          "old_text": null,
          "new_text": "NameStr(compressed_attr->attname)",
          "old_line_content": "",
          "new_line_content": "\t\tchar *col_name = NameStr(compressed_attr->attname);",
          "content_same": false
        },
        {
          "line": 1284,
          "old_api": null,
          "new_api": "PG_GETARG_DATUM",
          "old_text": null,
          "new_text": "PG_GETARG_DATUM(0)",
          "old_line_content": "\tStringInfoData buf;",
          "new_line_content": "\tCompressedDataHeader *header = (CompressedDataHeader *) PG_DETOAST_DATUM(PG_GETARG_DATUM(0));",
          "content_same": false
        },
        {
          "line": 1031,
          "old_api": null,
          "new_api": "AttributeNumberIsValid",
          "old_text": null,
          "new_text": "AttributeNumberIsValid(decompressed_colnum)",
          "old_line_content": "\t\t{",
          "new_line_content": "\t\tif (!AttributeNumberIsValid(decompressed_colnum))",
          "content_same": false
        },
        {
          "line": 1287,
          "old_api": null,
          "new_api": "pq_sendbyte",
          "old_text": null,
          "new_text": "pq_sendbyte(&buf, header->compression_algorithm)",
          "old_line_content": "",
          "new_line_content": "\tpq_sendbyte(&buf, header->compression_algorithm);",
          "content_same": false
        },
        {
          "line": 1289,
          "old_api": null,
          "new_api": "compressed_data_send",
          "old_text": null,
          "new_text": "definitions[header->compression_algorithm].compressed_data_send(header, &buf)",
          "old_line_content": "",
          "new_line_content": "\tdefinitions[header->compression_algorithm].compressed_data_send(header, &buf);",
          "content_same": false
        },
        {
          "line": 1291,
          "old_api": null,
          "new_api": "pq_endtypsend",
          "old_text": null,
          "new_text": "pq_endtypsend(&buf)",
          "old_line_content": "}",
          "new_line_content": "\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));",
          "content_same": false
        },
        {
          "line": 1040,
          "old_api": null,
          "new_api": "AttrNumberGetAttrOffset",
          "old_text": null,
          "new_text": "AttrNumberGetAttrOffset(decompressed_colnum)",
          "old_line_content": "",
          "new_line_content": "\t\tdecompressed_column_offset = AttrNumberGetAttrOffset(decompressed_colnum);",
          "content_same": false
        },
        {
          "line": 1297,
          "old_api": null,
          "new_api": "PG_GETARG_POINTER",
          "old_text": null,
          "new_text": "PG_GETARG_POINTER(0)",
          "old_line_content": "\tCompressedDataHeader header = { { 0 } };",
          "new_line_content": "\tStringInfo buf = (StringInfo) PG_GETARG_POINTER(0);",
          "content_same": false
        },
        {
          "line": 1042,
          "old_api": null,
          "new_api": "TupleDescAttr",
          "old_text": null,
          "new_text": "TupleDescAttr(out_desc, decompressed_column_offset)",
          "old_line_content": "",
          "new_line_content": "\t\tdecompressed_type = TupleDescAttr(out_desc, decompressed_column_offset)->atttypid;",
          "content_same": false
        },
        {
          "line": 1171,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"tried to decompress more data than was compressed in column\")",
          "old_line_content": "",
          "new_line_content": "\t\telog(ERROR, \"tried to decompress more data than was compressed in column\");",
          "content_same": false
        },
        {
          "line": 1300,
          "old_api": null,
          "new_api": "pq_getmsgbyte",
          "old_text": null,
          "new_text": "pq_getmsgbyte(buf)",
          "old_line_content": "",
          "new_line_content": "\theader.compression_algorithm = pq_getmsgbyte(buf);",
          "content_same": false
        },
        {
          "line": 1173,
          "old_api": null,
          "new_api": "try_next",
          "old_text": null,
          "new_text": "per_compressed_col->iterator->try_next(per_compressed_col->iterator)",
          "old_line_content": "\tif (decompressed.is_done)",
          "new_line_content": "\tdecompressed = per_compressed_col->iterator->try_next(per_compressed_col->iterator);",
          "content_same": false
        },
        {
          "line": 1302,
          "old_api": null,
          "new_api": "compressed_data_recv",
          "old_text": null,
          "new_text": "definitions[header.compression_algorithm].compressed_data_recv(buf)",
          "old_line_content": "}",
          "new_line_content": "\treturn definitions[header.compression_algorithm].compressed_data_recv(buf);",
          "content_same": false
        },
        {
          "line": 1047,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR,\n\t\t\t\t \"compressed table type '%s' does not match decompressed table type '%s' for \"\n\t\t\t\t \"segment-by column \\\"%s\\\"\",\n\t\t\t\t format_type_be(compressed_attr->atttypid),\n\t\t\t\t format_type_be(decompressed_type),\n\t\t\t\t col_name)",
          "old_line_content": "\t\t\t\t \"compressed table type '%s' does not match decompressed table type '%s' for \"",
          "new_line_content": "\t\t\telog(ERROR,",
          "content_same": false
        },
        {
          "line": 1051,
          "old_api": null,
          "new_api": "format_type_be",
          "old_text": null,
          "new_text": "format_type_be(decompressed_type)",
          "old_line_content": "\t\t\t\t col_name);",
          "new_line_content": "\t\t\t\t format_type_be(decompressed_type),",
          "content_same": false
        },
        {
          "line": 1309,
          "old_api": null,
          "new_api": "strlen",
          "old_text": null,
          "new_text": "strlen(input)",
          "old_line_content": "\tint decoded_len;",
          "new_line_content": "\tsize_t input_len = strlen(input);",
          "content_same": false
        },
        {
          "line": 1316,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"input too long\")",
          "old_line_content": "",
          "new_line_content": "\t\telog(ERROR, \"input too long\");",
          "content_same": false
        },
        {
          "line": 1320,
          "old_api": null,
          "new_api": "pg_b64_decode",
          "old_text": null,
          "new_text": "pg_b64_decode(input, input_len, decoded)",
          "old_line_content": "\tdecoded[decoded_len] = '\\0';",
          "new_line_content": "\tdecoded_len = pg_b64_decode(input, input_len, decoded);",
          "content_same": false
        },
        {
          "line": 1328,
          "old_api": null,
          "new_api": "PointerGetDatum",
          "old_text": null,
          "new_text": "PointerGetDatum(&data)",
          "old_line_content": "",
          "new_line_content": "\tresult = DirectFunctionCall1(tsl_compressed_data_recv, PointerGetDatum(&data));",
          "content_same": false
        },
        {
          "line": 1330,
          "old_api": null,
          "new_api": "PG_RETURN_DATUM",
          "old_text": null,
          "new_text": "PG_RETURN_DATUM(result)",
          "old_line_content": "}",
          "new_line_content": "\tPG_RETURN_DATUM(result);",
          "content_same": false
        },
        {
          "line": 1206,
          "old_api": null,
          "new_api": "PG_RETURN_NULL",
          "old_text": null,
          "new_text": "PG_RETURN_NULL()",
          "old_line_content": "",
          "new_line_content": "\t\tPG_RETURN_NULL();",
          "content_same": false
        },
        {
          "line": 1209,
          "old_api": null,
          "new_api": "PG_DETOAST_DATUM",
          "old_text": null,
          "new_text": "PG_DETOAST_DATUM(compressed)",
          "old_line_content": "",
          "new_line_content": "\theader = (CompressedDataHeader *) PG_DETOAST_DATUM(compressed);",
          "content_same": false
        },
        {
          "line": 1211,
          "old_api": null,
          "new_api": "SRF_IS_FIRSTCALL",
          "old_text": null,
          "new_text": "SRF_IS_FIRSTCALL()",
          "old_line_content": "\t{",
          "new_line_content": "\tif (SRF_IS_FIRSTCALL())",
          "content_same": false
        },
        {
          "line": 1214,
          "old_api": null,
          "new_api": "MemoryContextSwitchTo",
          "old_text": null,
          "new_text": "MemoryContextSwitchTo(funcctx->multi_call_memory_ctx)",
          "old_line_content": "",
          "new_line_content": "\t\toldcontext = MemoryContextSwitchTo(funcctx->multi_call_memory_ctx);",
          "content_same": false
        },
        {
          "line": 1086,
          "old_api": null,
          "new_api": "PG_DETOAST_DATUM",
          "old_text": null,
          "new_text": "PG_DETOAST_DATUM(compressed_datums[col])",
          "old_line_content": "\t\t\tCompressedDataHeader *header = (CompressedDataHeader *) data;",
          "new_line_content": "\t\t\tchar *data = (char *) PG_DETOAST_DATUM(compressed_datums[col]);",
          "content_same": false
        },
        {
          "line": 1342,
          "old_api": null,
          "new_api": "pg_b64_encode",
          "old_text": null,
          "new_text": "pg_b64_encode(raw_data, raw_len, encoded)",
          "old_line_content": "\tencoded[encoded_len] = '\\0';",
          "new_line_content": "\tencoded_len = pg_b64_encode(raw_data, raw_len, encoded);",
          "content_same": false
        },
        {
          "line": 1345,
          "old_api": null,
          "new_api": "PG_RETURN_CSTRING",
          "old_text": null,
          "new_text": "PG_RETURN_CSTRING(encoded)",
          "old_line_content": "}",
          "new_line_content": "\tPG_RETURN_CSTRING(encoded);",
          "content_same": false
        },
        {
          "line": 1218,
          "old_api": null,
          "new_api": "get_fn_expr_argtype",
          "old_text": null,
          "new_text": "get_fn_expr_argtype(fcinfo->flinfo, 1)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t.iterator_init_forward(PG_GETARG_DATUM(0), get_fn_expr_argtype(fcinfo->flinfo, 1));",
          "content_same": false
        },
        {
          "line": 1091,
          "old_api": null,
          "new_api": "PointerGetDatum",
          "old_text": null,
          "new_text": "PointerGetDatum(data)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\t\t.iterator_init_forward(PointerGetDatum(data), per_col->decompressed_type);",
          "content_same": false
        },
        {
          "line": 1221,
          "old_api": null,
          "new_api": "MemoryContextSwitchTo",
          "old_text": null,
          "new_text": "MemoryContextSwitchTo(oldcontext)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tMemoryContextSwitchTo(oldcontext);",
          "content_same": false
        },
        {
          "line": 1224,
          "old_api": null,
          "new_api": "SRF_PERCALL_SETUP",
          "old_text": null,
          "new_text": "SRF_PERCALL_SETUP()",
          "old_line_content": "",
          "new_line_content": "\tfuncctx = SRF_PERCALL_SETUP();",
          "content_same": false
        },
        {
          "line": 1352,
          "old_api": null,
          "new_api": "elog",
          "old_text": null,
          "new_text": "elog(ERROR, \"invalid compression algorithm %d\", algorithm)",
          "old_line_content": "\treturn definitions[algorithm].compressed_data_storage;",
          "new_line_content": "\t\telog(ERROR, \"invalid compression algorithm %d\", algorithm);",
          "content_same": false
        },
        {
          "line": 1227,
          "old_api": null,
          "new_api": "try_next",
          "old_text": null,
          "new_text": "iter->try_next(iter)",
          "old_line_content": "",
          "new_line_content": "\tres = iter->try_next(iter);",
          "content_same": false
        },
        {
          "line": 1230,
          "old_api": null,
          "new_api": "SRF_RETURN_DONE",
          "old_text": null,
          "new_text": "SRF_RETURN_DONE(funcctx)",
          "old_line_content": "",
          "new_line_content": "\t\tSRF_RETURN_DONE(funcctx);",
          "content_same": false
        },
        {
          "line": 1233,
          "old_api": null,
          "new_api": "SRF_RETURN_NEXT_NULL",
          "old_text": null,
          "new_text": "SRF_RETURN_NEXT_NULL(funcctx)",
          "old_line_content": "",
          "new_line_content": "\t\tSRF_RETURN_NEXT_NULL(funcctx);",
          "content_same": false
        },
        {
          "line": 1235,
          "old_api": null,
          "new_api": "SRF_RETURN_NEXT",
          "old_text": null,
          "new_text": "SRF_RETURN_NEXT(funcctx, res.val)",
          "old_line_content": "}",
          "new_line_content": "\tSRF_RETURN_NEXT(funcctx, res.val);",
          "content_same": false
        },
        {
          "line": 1113,
          "old_api": null,
          "new_api": "per_compressed_col_get_data",
          "old_text": null,
          "new_text": "per_compressed_col_get_data(&row_decompressor->per_compressed_cols[col],\n\t\t\t\t\t\t\t\t\t\t\trow_decompressor->decompressed_datums,\n\t\t\t\t\t\t\t\t\t\t\trow_decompressor->decompressed_is_nulls)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\trow_decompressor->decompressed_datums,",
          "new_line_content": "\t\t\t\tper_compressed_col_get_data(&row_decompressor->per_compressed_cols[col],",
          "content_same": false
        },
        {
          "line": 1249,
          "old_api": null,
          "new_api": "PG_RETURN_NULL",
          "old_text": null,
          "new_text": "PG_RETURN_NULL()",
          "old_line_content": "",
          "new_line_content": "\t\tPG_RETURN_NULL();",
          "content_same": false
        },
        {
          "line": 993,
          "old_api": null,
          "new_api": "MemoryContextReset",
          "old_text": null,
          "new_text": "MemoryContextReset(per_compressed_row_ctx)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tMemoryContextReset(per_compressed_row_ctx);",
          "content_same": false
        },
        {
          "line": 1125,
          "old_api": null,
          "new_api": "heap_form_tuple",
          "old_text": null,
          "new_text": "heap_form_tuple(row_decompressor->out_desc,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   row_decompressor->decompressed_datums,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   row_decompressor->decompressed_is_nulls)",
          "old_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t\t\t   row_decompressor->decompressed_datums,",
          "new_line_content": "\t\t\tHeapTuple decompressed_tuple = heap_form_tuple(row_decompressor->out_desc,",
          "content_same": false
        },
        {
          "line": 1253,
          "old_api": null,
          "new_api": "SRF_IS_FIRSTCALL",
          "old_text": null,
          "new_text": "SRF_IS_FIRSTCALL()",
          "old_line_content": "\t{",
          "new_line_content": "\tif (SRF_IS_FIRSTCALL())",
          "content_same": false
        },
        {
          "line": 997,
          "old_api": null,
          "new_api": "FreeBulkInsertState",
          "old_text": null,
          "new_text": "FreeBulkInsertState(decompressor.bistate)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tFreeBulkInsertState(decompressor.bistate);",
          "content_same": false
        },
        {
          "line": 1128,
          "old_api": null,
          "new_api": "heap_insert",
          "old_text": null,
          "new_text": "heap_insert(row_decompressor->out_rel,\n\t\t\t\t\t\tdecompressed_tuple,\n\t\t\t\t\t\trow_decompressor->mycid,\n\t\t\t\t\t\t0 /*=options*/,\n\t\t\t\t\t\trow_decompressor->bistate)",
          "old_line_content": "\t\t\t\t\t\tdecompressed_tuple,",
          "new_line_content": "\t\t\theap_insert(row_decompressor->out_rel,",
          "content_same": false
        },
        {
          "line": 1256,
          "old_api": null,
          "new_api": "MemoryContextSwitchTo",
          "old_text": null,
          "new_text": "MemoryContextSwitchTo(funcctx->multi_call_memory_ctx)",
          "old_line_content": "",
          "new_line_content": "\t\toldcontext = MemoryContextSwitchTo(funcctx->multi_call_memory_ctx);",
          "content_same": false
        },
        {
          "line": 1002,
          "old_api": null,
          "new_api": "reindex_relation",
          "old_text": null,
          "new_text": "reindex_relation(out_table, 0, 0)",
          "old_line_content": "",
          "new_line_content": "\treindex_relation(out_table, 0, 0);",
          "content_same": false
        },
        {
          "line": 1260,
          "old_api": null,
          "new_api": "get_fn_expr_argtype",
          "old_text": null,
          "new_text": "get_fn_expr_argtype(fcinfo->flinfo, 1)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t.iterator_init_reverse(PG_GETARG_DATUM(0), get_fn_expr_argtype(fcinfo->flinfo, 1));",
          "content_same": false
        },
        {
          "line": 1005,
          "old_api": null,
          "new_api": "RelationClose",
          "old_text": null,
          "new_text": "RelationClose(in_rel)",
          "old_line_content": "}",
          "new_line_content": "\tRelationClose(in_rel);",
          "content_same": false
        },
        {
          "line": 1134,
          "old_api": null,
          "new_api": "heap_freetuple",
          "old_text": null,
          "new_text": "heap_freetuple(decompressed_tuple)",
          "old_line_content": "\t\t\twrote_data = true;",
          "new_line_content": "\t\t\theap_freetuple(decompressed_tuple);",
          "content_same": false
        },
        {
          "line": 1263,
          "old_api": null,
          "new_api": "MemoryContextSwitchTo",
          "old_text": null,
          "new_text": "MemoryContextSwitchTo(oldcontext)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tMemoryContextSwitchTo(oldcontext);",
          "content_same": false
        },
        {
          "line": 1266,
          "old_api": null,
          "new_api": "SRF_PERCALL_SETUP",
          "old_text": null,
          "new_text": "SRF_PERCALL_SETUP()",
          "old_line_content": "",
          "new_line_content": "\tfuncctx = SRF_PERCALL_SETUP();",
          "content_same": false
        },
        {
          "line": 1269,
          "old_api": null,
          "new_api": "try_next",
          "old_text": null,
          "new_text": "iter->try_next(iter)",
          "old_line_content": "",
          "new_line_content": "\tres = iter->try_next(iter);",
          "content_same": false
        },
        {
          "line": 1013,
          "old_api": null,
          "new_api": "palloc",
          "old_text": null,
          "new_text": "palloc(sizeof(*per_compressed_cols) * in_desc->natts)",
          "old_line_content": "",
          "new_line_content": "\t\tpalloc(sizeof(*per_compressed_cols) * in_desc->natts);",
          "content_same": false
        },
        {
          "line": 1015,
          "old_api": null,
          "new_api": "OidIsValid",
          "old_text": null,
          "new_text": "OidIsValid(compressed_data_type_oid)",
          "old_line_content": "",
          "new_line_content": "\tAssert(OidIsValid(compressed_data_type_oid));",
          "content_same": false
        },
        {
          "line": 1272,
          "old_api": null,
          "new_api": "SRF_RETURN_DONE",
          "old_text": null,
          "new_text": "SRF_RETURN_DONE(funcctx)",
          "old_line_content": "",
          "new_line_content": "\t\tSRF_RETURN_DONE(funcctx);",
          "content_same": false
        },
        {
          "line": 1275,
          "old_api": null,
          "new_api": "SRF_RETURN_NEXT_NULL",
          "old_text": null,
          "new_text": "SRF_RETURN_NEXT_NULL(funcctx)",
          "old_line_content": "",
          "new_line_content": "\t\tSRF_RETURN_NEXT_NULL(funcctx);",
          "content_same": false
        },
        {
          "line": 1277,
          "old_api": null,
          "new_api": "SRF_RETURN_NEXT",
          "old_text": null,
          "new_text": "SRF_RETURN_NEXT(funcctx, res.val)",
          "old_line_content": "\t;",
          "new_line_content": "\tSRF_RETURN_NEXT(funcctx, res.val);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1283,
          "old_api": "PG_GETARG_DATUM",
          "new_api": null,
          "old_text": "PG_GETARG_DATUM(0)",
          "new_text": null,
          "old_line_content": "\tCompressedDataHeader *header = (CompressedDataHeader *) PG_DETOAST_DATUM(PG_GETARG_DATUM(0));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1029,
          "old_api": "get_attnum",
          "new_api": null,
          "old_text": "get_attnum(out_relid, col_name)",
          "new_text": null,
          "old_line_content": "\t\tAttrNumber decompressed_colnum = get_attnum(out_relid, col_name);",
          "new_line_content": "\t\t */",
          "content_same": false
        },
        {
          "line": 1285,
          "old_api": "pq_begintypsend",
          "new_api": null,
          "old_text": "pq_begintypsend(&buf)",
          "new_text": null,
          "old_line_content": "\tpq_begintypsend(&buf);",
          "new_line_content": "\tStringInfoData buf;",
          "content_same": false
        },
        {
          "line": 1288,
          "old_api": "compressed_data_send",
          "new_api": null,
          "old_text": "definitions[header->compression_algorithm].compressed_data_send(header, &buf)",
          "new_text": null,
          "old_line_content": "\tdefinitions[header->compression_algorithm].compressed_data_send(header, &buf);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1290,
          "old_api": "pq_endtypsend",
          "new_api": null,
          "old_text": "pq_endtypsend(&buf)",
          "new_text": null,
          "old_line_content": "\tPG_RETURN_BYTEA_P(pq_endtypsend(&buf));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1039,
          "old_api": "AttrNumberGetAttrOffset",
          "new_api": null,
          "old_text": "AttrNumberGetAttrOffset(decompressed_colnum)",
          "new_text": null,
          "old_line_content": "\t\tdecompressed_column_offset = AttrNumberGetAttrOffset(decompressed_colnum);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1296,
          "old_api": "PG_GETARG_POINTER",
          "new_api": null,
          "old_text": "PG_GETARG_POINTER(0)",
          "new_text": null,
          "old_line_content": "\tStringInfo buf = (StringInfo) PG_GETARG_POINTER(0);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1041,
          "old_api": "TupleDescAttr",
          "new_api": null,
          "old_text": "TupleDescAttr(out_desc, decompressed_column_offset)",
          "new_text": null,
          "old_line_content": "\t\tdecompressed_type = TupleDescAttr(out_desc, decompressed_column_offset)->atttypid;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1170,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR, \"tried to decompress more data than was compressed in column\")",
          "new_text": null,
          "old_line_content": "\t\telog(ERROR, \"tried to decompress more data than was compressed in column\");",
          "new_line_content": "\tif (per_compressed_col->iterator == NULL)",
          "content_same": false
        },
        {
          "line": 1299,
          "old_api": "pq_getmsgbyte",
          "new_api": null,
          "old_text": "pq_getmsgbyte(buf)",
          "new_text": null,
          "old_line_content": "\theader.compression_algorithm = pq_getmsgbyte(buf);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1172,
          "old_api": "try_next",
          "new_api": null,
          "old_text": "per_compressed_col->iterator->try_next(per_compressed_col->iterator)",
          "new_text": null,
          "old_line_content": "\tdecompressed = per_compressed_col->iterator->try_next(per_compressed_col->iterator);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1301,
          "old_api": "compressed_data_recv",
          "new_api": null,
          "old_text": "definitions[header.compression_algorithm].compressed_data_recv(buf)",
          "new_text": null,
          "old_line_content": "\treturn definitions[header.compression_algorithm].compressed_data_recv(buf);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1046,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR,\n\t\t\t\t \"compressed table type '%s' does not match decompressed table type '%s' for \"\n\t\t\t\t \"segment-by column \\\"%s\\\"\",\n\t\t\t\t format_type_be(compressed_attr->atttypid),\n\t\t\t\t format_type_be(decompressed_type),\n\t\t\t\t col_name)",
          "new_text": null,
          "old_line_content": "\t\t\telog(ERROR,",
          "new_line_content": "\t\tif (!is_compressed && compressed_attr->atttypid != decompressed_type)",
          "content_same": false
        },
        {
          "line": 1049,
          "old_api": "format_type_be",
          "new_api": null,
          "old_text": "format_type_be(compressed_attr->atttypid)",
          "new_text": null,
          "old_line_content": "\t\t\t\t format_type_be(compressed_attr->atttypid),",
          "new_line_content": "\t\t\t\t \"segment-by column \\\"%s\\\"\",",
          "content_same": false
        },
        {
          "line": 1307,
          "old_api": "PG_GETARG_CSTRING",
          "new_api": null,
          "old_text": "PG_GETARG_CSTRING(0)",
          "new_text": null,
          "old_line_content": "\tconst char *input = PG_GETARG_CSTRING(0);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1315,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR, \"input too long\")",
          "new_text": null,
          "old_line_content": "\t\telog(ERROR, \"input too long\");",
          "new_line_content": "\tif (input_len > PG_INT32_MAX)",
          "content_same": false
        },
        {
          "line": 1317,
          "old_api": "pg_b64_dec_len",
          "new_api": null,
          "old_text": "pg_b64_dec_len(input_len)",
          "new_text": null,
          "old_line_content": "\tdecoded_len = pg_b64_dec_len(input_len);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1327,
          "old_api": "PointerGetDatum",
          "new_api": null,
          "old_text": "PointerGetDatum(&data)",
          "new_text": null,
          "old_line_content": "\tresult = DirectFunctionCall1(tsl_compressed_data_recv, PointerGetDatum(&data));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1329,
          "old_api": "PG_RETURN_DATUM",
          "new_api": null,
          "old_text": "PG_RETURN_DATUM(result)",
          "new_text": null,
          "old_line_content": "\tPG_RETURN_DATUM(result);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1204,
          "old_api": "PG_ARGISNULL",
          "new_api": null,
          "old_text": "PG_ARGISNULL(0)",
          "new_text": null,
          "old_line_content": "\tif (PG_ARGISNULL(0))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1207,
          "old_api": "PG_GETARG_DATUM",
          "new_api": null,
          "old_text": "PG_GETARG_DATUM(0)",
          "new_text": null,
          "old_line_content": "\tcompressed = PG_GETARG_DATUM(0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1335,
          "old_api": "PG_GETARG_DATUM",
          "new_api": null,
          "old_text": "PG_GETARG_DATUM(0)",
          "new_text": null,
          "old_line_content": "\tDatum bytes_data = DirectFunctionCall1(tsl_compressed_data_send, PG_GETARG_DATUM(0));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1210,
          "old_api": "SRF_IS_FIRSTCALL",
          "new_api": null,
          "old_text": "SRF_IS_FIRSTCALL()",
          "new_text": null,
          "old_line_content": "\tif (SRF_IS_FIRSTCALL())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1212,
          "old_api": "SRF_FIRSTCALL_INIT",
          "new_api": null,
          "old_text": "SRF_FIRSTCALL_INIT()",
          "new_text": null,
          "old_line_content": "\t\tfuncctx = SRF_FIRSTCALL_INIT();",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1085,
          "old_api": "PG_DETOAST_DATUM",
          "new_api": null,
          "old_text": "PG_DETOAST_DATUM(compressed_datums[col])",
          "new_text": null,
          "old_line_content": "\t\t\tchar *data = (char *) PG_DETOAST_DATUM(compressed_datums[col]);",
          "new_line_content": "\t\t{",
          "content_same": false
        },
        {
          "line": 1216,
          "old_api": "iterator_init_forward",
          "new_api": null,
          "old_text": "definitions[header->compression_algorithm]\n\t\t\t\t.iterator_init_forward(PG_GETARG_DATUM(0), get_fn_expr_argtype(fcinfo->flinfo, 1))",
          "new_text": null,
          "old_line_content": "\t\t\tdefinitions[header->compression_algorithm]",
          "new_line_content": "\t\titer =",
          "content_same": false
        },
        {
          "line": 1089,
          "old_api": "iterator_init_forward",
          "new_api": null,
          "old_text": "definitions[header->compression_algorithm]\n\t\t\t\t\t.iterator_init_forward(PointerGetDatum(data), per_col->decompressed_type)",
          "new_text": null,
          "old_line_content": "\t\t\t\tdefinitions[header->compression_algorithm]",
          "new_line_content": "\t\t\tper_col->iterator =",
          "content_same": false
        },
        {
          "line": 1344,
          "old_api": "PG_RETURN_CSTRING",
          "new_api": null,
          "old_text": "PG_RETURN_CSTRING(encoded)",
          "new_text": null,
          "old_line_content": "\tPG_RETURN_CSTRING(encoded);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1220,
          "old_api": "MemoryContextSwitchTo",
          "new_api": null,
          "old_text": "MemoryContextSwitchTo(oldcontext)",
          "new_text": null,
          "old_line_content": "\t\tMemoryContextSwitchTo(oldcontext);",
          "new_line_content": "\t\tfuncctx->user_fctx = iter;",
          "content_same": false
        },
        {
          "line": 1223,
          "old_api": "SRF_PERCALL_SETUP",
          "new_api": null,
          "old_text": "SRF_PERCALL_SETUP()",
          "new_text": null,
          "old_line_content": "\tfuncctx = SRF_PERCALL_SETUP();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1351,
          "old_api": "elog",
          "new_api": null,
          "old_text": "elog(ERROR, \"invalid compression algorithm %d\", algorithm)",
          "new_text": null,
          "old_line_content": "\t\telog(ERROR, \"invalid compression algorithm %d\", algorithm);",
          "new_line_content": "\tif (algorithm == _INVALID_COMPRESSION_ALGORITHM || algorithm >= _END_COMPRESSION_ALGORITHMS)",
          "content_same": false
        },
        {
          "line": 1226,
          "old_api": "try_next",
          "new_api": null,
          "old_text": "iter->try_next(iter)",
          "new_text": null,
          "old_line_content": "\tres = iter->try_next(iter);",
          "new_line_content": "\titer = funcctx->user_fctx;",
          "content_same": false
        },
        {
          "line": 1229,
          "old_api": "SRF_RETURN_DONE",
          "new_api": null,
          "old_text": "SRF_RETURN_DONE(funcctx)",
          "new_text": null,
          "old_line_content": "\t\tSRF_RETURN_DONE(funcctx);",
          "new_line_content": "\tif (res.is_done)",
          "content_same": false
        },
        {
          "line": 1232,
          "old_api": "SRF_RETURN_NEXT_NULL",
          "new_api": null,
          "old_text": "SRF_RETURN_NEXT_NULL(funcctx)",
          "new_text": null,
          "old_line_content": "\t\tSRF_RETURN_NEXT_NULL(funcctx);",
          "new_line_content": "\tif (res.is_null)",
          "content_same": false
        },
        {
          "line": 1234,
          "old_api": "SRF_RETURN_NEXT",
          "new_api": null,
          "old_text": "SRF_RETURN_NEXT(funcctx, res.val)",
          "new_text": null,
          "old_line_content": "\tSRF_RETURN_NEXT(funcctx, res.val);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1112,
          "old_api": "per_compressed_col_get_data",
          "new_api": null,
          "old_text": "per_compressed_col_get_data(&row_decompressor->per_compressed_cols[col],\n\t\t\t\t\t\t\t\t\t\t\trow_decompressor->decompressed_datums,\n\t\t\t\t\t\t\t\t\t\t\trow_decompressor->decompressed_is_nulls)",
          "new_text": null,
          "old_line_content": "\t\t\t\tper_compressed_col_get_data(&row_decompressor->per_compressed_cols[col],",
          "new_line_content": "\t\t\tbool col_is_done =",
          "content_same": false
        },
        {
          "line": 1247,
          "old_api": "PG_ARGISNULL",
          "new_api": null,
          "old_text": "PG_ARGISNULL(0)",
          "new_text": null,
          "old_line_content": "\tif (PG_ARGISNULL(0))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1250,
          "old_api": "PG_GETARG_DATUM",
          "new_api": null,
          "old_text": "PG_GETARG_DATUM(0)",
          "new_text": null,
          "old_line_content": "\tcompressed = PG_GETARG_DATUM(0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 995,
          "old_api": "heap_endscan",
          "new_api": null,
          "old_text": "heap_endscan(heapScan)",
          "new_text": null,
          "old_line_content": "\t\theap_endscan(heapScan);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1124,
          "old_api": "heap_form_tuple",
          "new_api": null,
          "old_text": "heap_form_tuple(row_decompressor->out_desc,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   row_decompressor->decompressed_datums,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t   row_decompressor->decompressed_is_nulls)",
          "new_text": null,
          "old_line_content": "\t\t\tHeapTuple decompressed_tuple = heap_form_tuple(row_decompressor->out_desc,",
          "new_line_content": "\t\t\t// FIXME getting invalid bool here",
          "content_same": false
        },
        {
          "line": 1254,
          "old_api": "SRF_FIRSTCALL_INIT",
          "new_api": null,
          "old_text": "SRF_FIRSTCALL_INIT()",
          "new_text": null,
          "old_line_content": "\t\tfuncctx = SRF_FIRSTCALL_INIT();",
          "new_line_content": "\t{",
          "content_same": false
        },
        {
          "line": 1127,
          "old_api": "heap_insert",
          "new_api": null,
          "old_text": "heap_insert(row_decompressor->out_rel,\n\t\t\t\t\t\tdecompressed_tuple,\n\t\t\t\t\t\trow_decompressor->mycid,\n\t\t\t\t\t\t0 /*=options*/,\n\t\t\t\t\t\trow_decompressor->bistate)",
          "new_text": null,
          "old_line_content": "\t\t\theap_insert(row_decompressor->out_rel,",
          "new_line_content": "\t\t\t\t\t\t\t\t\t\t\t\t\t\t   row_decompressor->decompressed_is_nulls);",
          "content_same": false
        },
        {
          "line": 1001,
          "old_api": "reindex_relation",
          "new_api": null,
          "old_text": "reindex_relation(out_table, 0, 0)",
          "new_text": null,
          "old_line_content": "\treindex_relation(out_table, 0, 0);",
          "new_line_content": "\t * so the strong locks taken by reindex_relation shouldn't matter. */",
          "content_same": false
        },
        {
          "line": 1258,
          "old_api": "iterator_init_reverse",
          "new_api": null,
          "old_text": "definitions[header->compression_algorithm]\n\t\t\t\t.iterator_init_reverse(PG_GETARG_DATUM(0), get_fn_expr_argtype(fcinfo->flinfo, 1))",
          "new_text": null,
          "old_line_content": "\t\t\tdefinitions[header->compression_algorithm]",
          "new_line_content": "\t\titer =",
          "content_same": false
        },
        {
          "line": 1003,
          "old_api": "RelationClose",
          "new_api": null,
          "old_text": "RelationClose(out_rel)",
          "new_text": null,
          "old_line_content": "\tRelationClose(out_rel);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1133,
          "old_api": "heap_freetuple",
          "new_api": null,
          "old_text": "heap_freetuple(decompressed_tuple)",
          "new_text": null,
          "old_line_content": "\t\t\theap_freetuple(decompressed_tuple);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1262,
          "old_api": "MemoryContextSwitchTo",
          "new_api": null,
          "old_text": "MemoryContextSwitchTo(oldcontext)",
          "new_text": null,
          "old_line_content": "\t\tMemoryContextSwitchTo(oldcontext);",
          "new_line_content": "\t\tfuncctx->user_fctx = iter;",
          "content_same": false
        },
        {
          "line": 1265,
          "old_api": "SRF_PERCALL_SETUP",
          "new_api": null,
          "old_text": "SRF_PERCALL_SETUP()",
          "new_text": null,
          "old_line_content": "\tfuncctx = SRF_PERCALL_SETUP();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1268,
          "old_api": "try_next",
          "new_api": null,
          "old_text": "iter->try_next(iter)",
          "new_text": null,
          "old_line_content": "\tres = iter->try_next(iter);",
          "new_line_content": "\titer = funcctx->user_fctx;",
          "content_same": false
        },
        {
          "line": 1012,
          "old_api": "palloc",
          "new_api": null,
          "old_text": "palloc(sizeof(*per_compressed_cols) * in_desc->natts)",
          "new_text": null,
          "old_line_content": "\t\tpalloc(sizeof(*per_compressed_cols) * in_desc->natts);",
          "new_line_content": "\tPerCompressedColumn *per_compressed_cols =",
          "content_same": false
        },
        {
          "line": 1014,
          "old_api": "OidIsValid",
          "new_api": null,
          "old_text": "OidIsValid(compressed_data_type_oid)",
          "new_text": null,
          "old_line_content": "\tAssert(OidIsValid(compressed_data_type_oid));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1271,
          "old_api": "SRF_RETURN_DONE",
          "new_api": null,
          "old_text": "SRF_RETURN_DONE(funcctx)",
          "new_text": null,
          "old_line_content": "\t\tSRF_RETURN_DONE(funcctx);",
          "new_line_content": "\tif (res.is_done)",
          "content_same": false
        },
        {
          "line": 1274,
          "old_api": "SRF_RETURN_NEXT_NULL",
          "new_api": null,
          "old_text": "SRF_RETURN_NEXT_NULL(funcctx)",
          "new_text": null,
          "old_line_content": "\t\tSRF_RETURN_NEXT_NULL(funcctx);",
          "new_line_content": "\tif (res.is_null)",
          "content_same": false
        },
        {
          "line": 1276,
          "old_api": "SRF_RETURN_NEXT",
          "new_api": null,
          "old_text": "SRF_RETURN_NEXT(funcctx, res.val)",
          "new_text": null,
          "old_line_content": "\tSRF_RETURN_NEXT(funcctx, res.val);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1022,
          "old_api": "TupleDescAttr",
          "new_api": null,
          "old_text": "TupleDescAttr(in_desc, col)",
          "new_text": null,
          "old_line_content": "\t\tForm_pg_attribute compressed_attr = TupleDescAttr(in_desc, col);",
          "new_line_content": "\t\tPerCompressedColumn *per_compressed_col = &per_compressed_cols[col];",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 23,
      "total_additions": 56,
      "total_deletions": 55,
      "total_api_changes": 134
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 1,
        "api_related_lines": 134,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 299,
    "api_calls_after": 300,
    "diff_info": {
      "added_lines": 1,
      "removed_lines": 0,
      "total_diff_lines": 13
    }
  }
}