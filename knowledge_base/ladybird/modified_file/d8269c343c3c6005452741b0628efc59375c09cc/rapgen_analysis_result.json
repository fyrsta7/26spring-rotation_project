{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/d8269c343c3c6005452741b0628efc59375c09cc",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/d8269c343c3c6005452741b0628efc59375c09cc/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/d8269c343c3c6005452741b0628efc59375c09cc/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/d8269c343c3c6005452741b0628efc59375c09cc/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 350,
          "old_api": "find",
          "new_api": "hash",
          "old_text": "s_keywords.find(value)",
          "new_text": "value.hash()",
          "old_line_content": "        auto it = s_keywords.find(value);",
          "new_line_content": "        auto it = s_keywords.find(value.hash(), [&](auto& entry) { return entry.key == value; });",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": "end",
          "new_api": "hash",
          "old_text": "s_three_char_tokens.end()",
          "new_text": "three_chars_view.hash()",
          "old_line_content": "            if (it != s_three_char_tokens.end()) {",
          "new_line_content": "            auto it = s_three_char_tokens.find(three_chars_view.hash(), [&](auto& entry) { return entry.key == three_chars_view; });",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": "consume",
          "new_api": "end",
          "old_text": "consume()",
          "new_text": "s_two_char_tokens.end()",
          "old_line_content": "                consume();",
          "new_line_content": "            if (it != s_two_char_tokens.end()) {",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": "consume",
          "new_api": "end",
          "old_text": "consume()",
          "new_text": "s_single_char_tokens.end()",
          "old_line_content": "                consume();",
          "new_line_content": "            if (it != s_single_char_tokens.end()) {",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 480,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "m_source.length()",
          "old_line_content": "            char second_char = m_source[m_position];",
          "new_line_content": "        if (!found_four_char_token && !found_three_char_token && m_position < m_source.length()) {",
          "content_same": false
        },
        {
          "line": 513,
          "old_api": null,
          "new_api": "last",
          "old_text": null,
          "new_text": "m_template_states.last()",
          "old_line_content": "    }",
          "new_line_content": "            m_template_states.last().open_bracket_count--;",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": null,
          "new_api": "hash",
          "old_text": null,
          "new_text": "two_chars_view.hash()",
          "old_line_content": "                found_two_char_token = true;",
          "new_line_content": "            auto it = s_two_char_tokens.find(two_chars_view.hash(), [&](auto& entry) { return entry.key == two_chars_view; });",
          "content_same": false
        },
        {
          "line": 519,
          "old_api": null,
          "new_api": "substring_view",
          "old_text": null,
          "new_text": "m_source.substring_view(trivia_start - 1, value_start - trivia_start)",
          "old_line_content": "        value_start_line_number,",
          "new_line_content": "        m_source.substring_view(trivia_start - 1, value_start - trivia_start),",
          "content_same": false
        },
        {
          "line": 520,
          "old_api": null,
          "new_api": "substring_view",
          "old_text": null,
          "new_text": "m_source.substring_view(value_start - 1, m_position - value_start)",
          "old_line_content": "        value_start_column_number);",
          "new_line_content": "        m_source.substring_view(value_start - 1, m_position - value_start),",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": null,
          "new_api": "consume",
          "old_text": null,
          "new_text": "consume()",
          "old_line_content": "                token_type = it->value;",
          "new_line_content": "                consume();",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": null,
          "new_api": "consume",
          "old_text": null,
          "new_text": "consume()",
          "old_line_content": "            }",
          "new_line_content": "                consume();",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": null,
          "new_api": "find",
          "old_text": null,
          "new_text": "s_single_char_tokens.find(m_current_char)",
          "old_line_content": "                found_one_char_token = true;",
          "new_line_content": "            auto it = s_single_char_tokens.find(m_current_char);",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": null,
          "new_api": "consume",
          "old_text": null,
          "new_text": "consume()",
          "old_line_content": "            }",
          "new_line_content": "                consume();",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "s_three_char_tokens.end()",
          "old_line_content": "                found_three_char_token = true;",
          "new_line_content": "            if (it != s_three_char_tokens.end()) {",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": null,
          "new_api": "consume",
          "old_text": null,
          "new_text": "consume()",
          "old_line_content": "        }",
          "new_line_content": "            consume();",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": null,
          "new_api": "consume",
          "old_text": null,
          "new_text": "consume()",
          "old_line_content": "                token_type = it->value;",
          "new_line_content": "                consume();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 482,
          "old_api": "find",
          "new_api": null,
          "old_text": "s_two_char_tokens.find(two_chars)",
          "new_text": null,
          "old_line_content": "            auto it = s_two_char_tokens.find(two_chars);",
          "new_line_content": "            char two_chars[] { (char)m_current_char, second_char, 0 };",
          "content_same": false
        },
        {
          "line": 515,
          "old_api": "substring_view",
          "new_api": null,
          "old_text": "Token(\n        token_type,\n        m_source.substring_view(trivia_start - 1, value_start - trivia_start),\n        m_source.substring_view(value_start - 1, m_position - value_start),\n        value_start_line_number,\n        value_start_column_number)",
          "new_text": null,
          "old_line_content": "    m_current_token = Token(",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 483,
          "old_api": "end",
          "new_api": null,
          "old_text": "s_two_char_tokens.end()",
          "new_text": null,
          "old_line_content": "            if (it != s_two_char_tokens.end()) {",
          "new_line_content": "            StringView two_chars_view = { two_chars };",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": "substring_view",
          "new_api": null,
          "old_text": "m_source.substring_view(value_start - 1, m_position - value_start)",
          "new_text": null,
          "old_line_content": "        m_source.substring_view(value_start - 1, m_position - value_start),",
          "new_line_content": "        token_type,",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": "consume",
          "new_api": null,
          "old_text": "consume()",
          "new_text": null,
          "old_line_content": "                consume();",
          "new_line_content": "                found_two_char_token = true;",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": "find",
          "new_api": null,
          "old_text": "s_single_char_tokens.find(m_current_char)",
          "new_text": null,
          "old_line_content": "            auto it = s_single_char_tokens.find(m_current_char);",
          "new_line_content": "        bool found_one_char_token = false;",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": "end",
          "new_api": null,
          "old_text": "s_single_char_tokens.end()",
          "new_text": null,
          "old_line_content": "            if (it != s_single_char_tokens.end()) {",
          "new_line_content": "        if (!found_four_char_token && !found_three_char_token && !found_two_char_token) {",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": "find",
          "new_api": null,
          "old_text": "s_three_char_tokens.find(three_chars)",
          "new_text": null,
          "old_line_content": "            auto it = s_three_char_tokens.find(three_chars);",
          "new_line_content": "            StringView three_chars_view { three_chars };",
          "content_same": false
        },
        {
          "line": 502,
          "old_api": "consume",
          "new_api": null,
          "old_text": "consume()",
          "new_text": null,
          "old_line_content": "            consume();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": "consume",
          "new_api": null,
          "old_text": "consume()",
          "new_text": null,
          "old_line_content": "                consume();",
          "new_line_content": "                found_three_char_token = true;",
          "content_same": false
        },
        {
          "line": 507,
          "old_api": "last",
          "new_api": null,
          "old_text": "m_template_states.last()",
          "new_text": null,
          "old_line_content": "    if (!m_template_states.is_empty() && m_template_states.last().in_expr) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": "length",
          "new_api": null,
          "old_text": "m_source.length()",
          "new_text": null,
          "old_line_content": "        if (!found_four_char_token && !found_three_char_token && m_position < m_source.length()) {",
          "new_line_content": "        bool found_two_char_token = false;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 4,
      "total_additions": 12,
      "total_deletions": 12,
      "total_api_changes": 28
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 6,
        "api_related_lines": 28,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 241,
    "api_calls_after": 244,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 3,
      "total_diff_lines": 34
    }
  }
}