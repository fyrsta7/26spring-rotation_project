{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/c69b266e43ca85ed33ae3958823b7c35d7b7ef26",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/c69b266e43ca85ed33ae3958823b7c35d7b7ef26/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/c69b266e43ca85ed33ae3958823b7c35d7b7ef26/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/c69b266e43ca85ed33ae3958823b7c35d7b7ef26/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 116,
          "old_api": "e",
          "new_api": "c",
          "old_text": "e()",
          "new_text": "c()",
          "old_line_content": "    result.m_values[4] = other.e() * a() + other.f() * c() + e();",
          "new_line_content": "    result.m_values[2] = other.c() * a() + other.d() * c();",
          "content_same": false
        },
        {
          "line": 117,
          "old_api": "f",
          "new_api": "d",
          "old_text": "f()",
          "new_text": "d()",
          "old_line_content": "    result.m_values[5] = other.e() * b() + other.f() * d() + f();",
          "new_line_content": "    result.m_values[3] = other.c() * b() + other.d() * d();",
          "content_same": false
        },
        {
          "line": 128,
          "old_api": "multiply",
          "new_api": "AK::sincos(radians, sin_angle, cos_angle)",
          "old_text": "multiply(rotation)",
          "new_text": "AK::sincos(radians, sin_angle, cos_angle)",
          "old_line_content": "    multiply(rotation);",
          "new_line_content": "    AK::sincos(radians, sin_angle, cos_angle);",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": "c",
          "new_api": "d",
          "old_text": "c()",
          "new_text": "d()",
          "old_line_content": "        -c() / det,",
          "new_line_content": "        d() / det,",
          "content_same": false
        },
        {
          "line": 146,
          "old_api": "a",
          "new_api": "b",
          "old_text": "a()",
          "new_text": "b()",
          "old_line_content": "        a() / det,",
          "new_line_content": "        -b() / det,",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "e",
          "new_api": "c",
          "old_text": "e()",
          "new_text": "c()",
          "old_line_content": "        (c() * f() - d() * e()) / det,",
          "new_line_content": "        -c() / det,",
          "content_same": false
        },
        {
          "line": 148,
          "old_api": "f",
          "new_api": "a",
          "old_text": "f()",
          "new_text": "a()",
          "old_line_content": "        (b() * e() - a() * f()) / det,",
          "new_line_content": "        a() / det,",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "top_left",
          "new_api": "f",
          "old_text": "rect.top_left()",
          "new_text": "f()",
          "old_line_content": "    FloatPoint p1 = map(rect.top_left());",
          "new_line_content": "        return rect.translated(e(), f());",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": "bottom_right",
          "new_api": "top_left",
          "old_text": "rect.bottom_right()",
          "new_text": "rect.top_left()",
          "old_line_content": "    FloatPoint p3 = map(rect.bottom_right());",
          "new_line_content": "    FloatPoint p1 = map(rect.top_left());",
          "content_same": false
        },
        {
          "line": 215,
          "old_api": "bottom_left",
          "new_api": "top_right",
          "old_text": "rect.bottom_left()",
          "new_text": "rect.top_right()",
          "old_line_content": "    FloatPoint p4 = map(rect.bottom_left());",
          "new_line_content": "    FloatPoint p2 = map(rect.top_right());",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": "x",
          "new_api": "bottom_right",
          "old_text": "p4.x()",
          "new_text": "rect.bottom_right()",
          "old_line_content": "    float left = smallest_of(p1.x(), p2.x(), p3.x(), p4.x());",
          "new_line_content": "    FloatPoint p3 = map(rect.bottom_right());",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": "y",
          "new_api": "bottom_left",
          "old_text": "p4.y()",
          "new_text": "rect.bottom_left()",
          "old_line_content": "    float top = smallest_of(p1.y(), p2.y(), p3.y(), p4.y());",
          "new_line_content": "    FloatPoint p4 = map(rect.bottom_left());",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": "bottom_right",
          "new_api": "top_left",
          "old_text": "rect.bottom_right()",
          "new_text": "rect.top_left()",
          "old_line_content": "        map(rect.bottom_right()),",
          "new_line_content": "        map(rect.top_left()),",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": "bottom_left",
          "new_api": "top_right",
          "old_text": "rect.bottom_left()",
          "new_text": "rect.top_right()",
          "old_line_content": "        map(rect.bottom_left()),",
          "new_line_content": "        map(rect.top_right()),",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 130,
          "old_api": null,
          "new_api": "multiply",
          "old_text": null,
          "new_text": "multiply(rotation)",
          "old_line_content": "}",
          "new_line_content": "    multiply(rotation);",
          "content_same": false
        },
        {
          "line": 136,
          "old_api": null,
          "new_api": "c",
          "old_text": null,
          "new_text": "c()",
          "old_line_content": "",
          "new_line_content": "    return a() * d() - b() * c();",
          "content_same": false
        },
        {
          "line": 141,
          "old_api": null,
          "new_api": "determinant",
          "old_text": null,
          "new_text": "determinant()",
          "old_line_content": "        return {};",
          "new_line_content": "    auto det = determinant();",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": null,
          "new_api": "e",
          "old_text": null,
          "new_text": "e()",
          "old_line_content": "    };",
          "new_line_content": "        (c() * f() - d() * e()) / det,",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": null,
          "new_api": "f",
          "old_text": null,
          "new_text": "f()",
          "old_line_content": "}",
          "new_line_content": "        (b() * e() - a() * f()) / det,",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": null,
          "new_api": "e",
          "old_text": null,
          "new_text": "e()",
          "old_line_content": "}",
          "new_line_content": "    mapped_x = a() * unmapped_x + c() * unmapped_y + e();",
          "content_same": false
        },
        {
          "line": 157,
          "old_api": null,
          "new_api": "f",
          "old_text": null,
          "new_text": "f()",
          "old_line_content": "",
          "new_line_content": "    mapped_y = b() * unmapped_x + d() * unmapped_y + f();",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": null,
          "new_api": "y",
          "old_text": null,
          "new_text": "point.y()",
          "old_line_content": "}",
          "new_line_content": "    map(static_cast<float>(point.x()), static_cast<float>(point.y()), mapped_x, mapped_y);",
          "content_same": false
        },
        {
          "line": 166,
          "old_api": null,
          "new_api": "round_to<int>(mapped_y)",
          "old_text": null,
          "new_text": "round_to<int>(mapped_y)",
          "old_line_content": "",
          "new_line_content": "    return { round_to<int>(mapped_x), round_to<int>(mapped_y) };",
          "content_same": false
        },
        {
          "line": 174,
          "old_api": null,
          "new_api": "y",
          "old_text": null,
          "new_text": "point.y()",
          "old_line_content": "}",
          "new_line_content": "    map(point.x(), point.y(), mapped_x, mapped_y);",
          "content_same": false
        },
        {
          "line": 182,
          "old_api": null,
          "new_api": "x_scale",
          "old_text": null,
          "new_text": "x_scale()",
          "old_line_content": "    };",
          "new_line_content": "        round_to<int>(static_cast<float>(size.width()) * x_scale()),",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": null,
          "new_api": "y_scale",
          "old_text": null,
          "new_text": "y_scale()",
          "old_line_content": "}",
          "new_line_content": "        round_to<int>(static_cast<float>(size.height()) * y_scale()),",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": null,
          "new_api": "y_scale",
          "old_text": null,
          "new_text": "y_scale()",
          "old_line_content": "",
          "new_line_content": "    return { size.width() * x_scale(), size.height() * y_scale() };",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": null,
          "new_api": "min",
          "old_text": null,
          "new_text": "min(p3, p4)",
          "old_line_content": "",
          "new_line_content": "    return min(min(p1, p2), min(p3, p4));",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": null,
          "new_api": "max",
          "old_text": null,
          "new_text": "max(p3, p4)",
          "old_line_content": "",
          "new_line_content": "    return max(max(p1, p2), max(p3, p4));",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": null,
          "new_api": "is_identity",
          "old_text": null,
          "new_text": "is_identity()",
          "old_line_content": "    }",
          "new_line_content": "    if (is_identity()) {",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": null,
          "new_api": "is_identity_or_translation",
          "old_text": null,
          "new_text": "is_identity_or_translation()",
          "old_line_content": "    }",
          "new_line_content": "    if (is_identity_or_translation()) {",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": null,
          "new_api": "x",
          "old_text": null,
          "new_text": "p4.x()",
          "old_line_content": "    return { left, top, right - left, bottom - top };",
          "new_line_content": "    float right = largest_of(p1.x(), p2.x(), p3.x(), p4.x());",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": null,
          "new_api": "y",
          "old_text": null,
          "new_text": "p4.y()",
          "old_line_content": "}",
          "new_line_content": "    float bottom = largest_of(p1.y(), p2.y(), p3.y(), p4.y());",
          "content_same": false
        },
        {
          "line": 228,
          "old_api": null,
          "new_api": "FloatRect",
          "old_text": null,
          "new_text": "FloatRect(rect)",
          "old_line_content": "",
          "new_line_content": "    return enclosing_int_rect(map(FloatRect(rect)));",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": null,
          "new_api": "bottom_right",
          "old_text": null,
          "new_text": "rect.bottom_right()",
          "old_line_content": "    };",
          "new_line_content": "        map(rect.bottom_right()),",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": null,
          "new_api": "bottom_left",
          "old_text": null,
          "new_text": "rect.bottom_left()",
          "old_line_content": "}",
          "new_line_content": "        map(rect.bottom_left()),",
          "content_same": false
        },
        {
          "line": 111,
          "old_api": null,
          "new_api": "is_identity",
          "old_text": null,
          "new_text": "other.is_identity()",
          "old_line_content": "    AffineTransform result;",
          "new_line_content": "    if (other.is_identity())",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": null,
          "new_api": "a",
          "old_text": null,
          "new_text": "a()",
          "old_line_content": "        rotation += 2.0f * AK::Pi<float>;",
          "new_line_content": "    auto rotation = AK::atan2(b(), a());",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": null,
          "new_api": "e",
          "old_text": null,
          "new_text": "e()",
          "old_line_content": "    *this = result;",
          "new_line_content": "    result.m_values[4] = other.e() * a() + other.f() * c() + e();",
          "content_same": false
        },
        {
          "line": 119,
          "old_api": null,
          "new_api": "f",
          "old_text": null,
          "new_text": "f()",
          "old_line_content": "    return *this;",
          "new_line_content": "    result.m_values[5] = other.e() * b() + other.f() * d() + f();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 134,
          "old_api": "c",
          "new_api": null,
          "old_text": "c()",
          "new_text": null,
          "old_line_content": "    return a() * d() - b() * c();",
          "new_line_content": "float AffineTransform::determinant() const",
          "content_same": false
        },
        {
          "line": 139,
          "old_api": "determinant",
          "new_api": null,
          "old_text": "determinant()",
          "new_text": null,
          "old_line_content": "    auto det = determinant();",
          "new_line_content": "Optional<AffineTransform> AffineTransform::inverse() const",
          "content_same": false
        },
        {
          "line": 143,
          "old_api": "d",
          "new_api": null,
          "old_text": "d()",
          "new_text": null,
          "old_line_content": "        d() / det,",
          "new_line_content": "        return {};",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": "b",
          "new_api": null,
          "old_text": "b()",
          "new_text": null,
          "old_line_content": "        -b() / det,",
          "new_line_content": "    return AffineTransform {",
          "content_same": false
        },
        {
          "line": 154,
          "old_api": "e",
          "new_api": null,
          "old_text": "e()",
          "new_text": null,
          "old_line_content": "    mapped_x = a() * unmapped_x + c() * unmapped_y + e();",
          "new_line_content": "void AffineTransform::map(float unmapped_x, float unmapped_y, float& mapped_x, float& mapped_y) const",
          "content_same": false
        },
        {
          "line": 155,
          "old_api": "f",
          "new_api": null,
          "old_text": "f()",
          "new_text": null,
          "old_line_content": "    mapped_y = b() * unmapped_x + d() * unmapped_y + f();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": "y",
          "new_api": null,
          "old_text": "point.y()",
          "new_text": null,
          "old_line_content": "    map(static_cast<float>(point.x()), static_cast<float>(point.y()), mapped_x, mapped_y);",
          "new_line_content": "    float mapped_x;",
          "content_same": false
        },
        {
          "line": 164,
          "old_api": "round_to<int>(mapped_y)",
          "new_api": null,
          "old_text": "round_to<int>(mapped_y)",
          "new_text": null,
          "old_line_content": "    return { round_to<int>(mapped_x), round_to<int>(mapped_y) };",
          "new_line_content": "    float mapped_y;",
          "content_same": false
        },
        {
          "line": 172,
          "old_api": "y",
          "new_api": null,
          "old_text": "point.y()",
          "new_text": null,
          "old_line_content": "    map(point.x(), point.y(), mapped_x, mapped_y);",
          "new_line_content": "    float mapped_x;",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": "x_scale",
          "new_api": null,
          "old_text": "x_scale()",
          "new_text": null,
          "old_line_content": "        round_to<int>(static_cast<float>(size.width()) * x_scale()),",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": "y_scale",
          "new_api": null,
          "old_text": "y_scale()",
          "new_text": null,
          "old_line_content": "        round_to<int>(static_cast<float>(size.height()) * y_scale()),",
          "new_line_content": "    return {",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "y_scale",
          "new_api": null,
          "old_text": "y_scale()",
          "new_text": null,
          "old_line_content": "    return { size.width() * x_scale(), size.height() * y_scale() };",
          "new_line_content": "FloatSize AffineTransform::map(FloatSize size) const",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": "min",
          "new_api": null,
          "old_text": "min(p3, p4)",
          "new_text": null,
          "old_line_content": "    return min(min(p1, p2), min(p3, p4));",
          "new_line_content": "static T smallest_of(T p1, T p2, T p3, T p4)",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": "max",
          "new_api": null,
          "old_text": "max(p3, p4)",
          "new_text": null,
          "old_line_content": "    return max(max(p1, p2), max(p3, p4));",
          "new_line_content": "static T largest_of(T p1, T p2, T p3, T p4)",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": "is_identity",
          "new_api": null,
          "old_text": "is_identity()",
          "new_text": null,
          "old_line_content": "    if (is_identity()) {",
          "new_line_content": "FloatRect AffineTransform::map(FloatRect const& rect) const",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": "is_identity_or_translation",
          "new_api": null,
          "old_text": "is_identity_or_translation()",
          "new_text": null,
          "old_line_content": "    if (is_identity_or_translation()) {",
          "new_line_content": "        return rect;",
          "content_same": false
        },
        {
          "line": 210,
          "old_api": "f",
          "new_api": null,
          "old_text": "f()",
          "new_text": null,
          "old_line_content": "        return rect.translated(e(), f());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": "top_right",
          "new_api": null,
          "old_text": "rect.top_right()",
          "new_text": null,
          "old_line_content": "    FloatPoint p2 = map(rect.top_right());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": "FloatRect",
          "new_api": null,
          "old_text": "FloatRect(rect)",
          "new_text": null,
          "old_line_content": "    return enclosing_int_rect(map(FloatRect(rect)));",
          "new_line_content": "IntRect AffineTransform::map(IntRect const& rect) const",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "top_left",
          "new_api": null,
          "old_text": "rect.top_left()",
          "new_text": null,
          "old_line_content": "        map(rect.top_left()),",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": "top_right",
          "new_api": null,
          "old_text": "rect.top_right()",
          "new_text": null,
          "old_line_content": "        map(rect.top_right()),",
          "new_line_content": "    return {",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": "c",
          "new_api": null,
          "old_text": "c()",
          "new_text": null,
          "old_line_content": "    result.m_values[0] = other.a() * a() + other.b() * c();",
          "new_line_content": "        return *this;",
          "content_same": false
        },
        {
          "line": 113,
          "old_api": "d",
          "new_api": null,
          "old_text": "d()",
          "new_text": null,
          "old_line_content": "    result.m_values[1] = other.a() * b() + other.b() * d();",
          "new_line_content": "    AffineTransform result;",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": "a",
          "new_api": null,
          "old_text": "a()",
          "new_text": null,
          "old_line_content": "    auto rotation = AK::atan2(b(), a());",
          "new_line_content": "float AffineTransform::rotation() const",
          "content_same": false
        },
        {
          "line": 126,
          "old_api": "AK::sincos(radians, sin_angle, cos_angle)",
          "new_api": null,
          "old_text": "AK::sincos(radians, sin_angle, cos_angle)",
          "new_text": null,
          "old_line_content": "    AK::sincos(radians, sin_angle, cos_angle);",
          "new_line_content": "    float sin_angle;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 14,
      "total_additions": 26,
      "total_deletions": 25,
      "total_api_changes": 65
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 65,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 150,
    "api_calls_after": 151,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 0,
      "total_diff_lines": 14
    }
  }
}