{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/88aca4c99634d3a2948ed5130961ee7b8f942d43",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/88aca4c99634d3a2948ed5130961ee7b8f942d43/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/88aca4c99634d3a2948ed5130961ee7b8f942d43/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/88aca4c99634d3a2948ed5130961ee7b8f942d43/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 100,
          "old_api": "document",
          "new_api": "is_absolute",
          "old_text": "layout_node.document().browsing_context()",
          "new_text": "is_absolute()",
          "old_line_content": "    if (!layout_node.document().browsing_context())",
          "new_line_content": "    if (is_absolute())",
          "content_same": false
        },
        {
          "line": 106,
          "old_api": "font_size",
          "new_api": "document",
          "old_text": "root_element->layout_node()->computed_values().font_size()",
          "new_text": "layout_node.document().document_element()",
          "old_line_content": "    return to_px(viewport_rect, layout_node.font().metrics('M'), layout_node.computed_values().font_size(), root_element->layout_node()->computed_values().font_size());",
          "new_line_content": "    auto* root_element = layout_node.document().document_element();",
          "content_same": false
        },
        {
          "line": 115,
          "old_api": "unit_name",
          "new_api": "to_string",
          "old_text": "unit_name()",
          "new_text": "m_calculated_style->to_string()",
          "old_line_content": "    return String::formatted(\"{}{}\", m_value, unit_name());",
          "new_line_content": "        return m_calculated_style->to_string();",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 159,
          "old_api": null,
          "new_api": "VERIFY_NOT_REACHED",
          "old_text": null,
          "new_text": "VERIFY_NOT_REACHED()",
          "old_line_content": "Optional<Length::Type> Length::unit_from_name(StringView name)",
          "new_line_content": "    VERIFY_NOT_REACHED();",
          "content_same": false
        },
        {
          "line": 164,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"px\"sv)",
          "old_line_content": "        return Length::Type::Pt;",
          "new_line_content": "    if (name.equals_ignoring_case(\"px\"sv)) {",
          "content_same": false
        },
        {
          "line": 166,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"pt\"sv)",
          "old_line_content": "        return Length::Type::Pc;",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"pt\"sv)) {",
          "content_same": false
        },
        {
          "line": 168,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"pc\"sv)",
          "old_line_content": "        return Length::Type::Mm;",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"pc\"sv)) {",
          "content_same": false
        },
        {
          "line": 170,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"mm\"sv)",
          "old_line_content": "        return Length::Type::Rem;",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"mm\"sv)) {",
          "content_same": false
        },
        {
          "line": 172,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"rem\"sv)",
          "old_line_content": "        return Length::Type::Em;",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"rem\"sv)) {",
          "content_same": false
        },
        {
          "line": 174,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"em\"sv)",
          "old_line_content": "        return Length::Type::Ex;",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"em\"sv)) {",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"ex\"sv)",
          "old_line_content": "        return Length::Type::Ch;",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"ex\"sv)) {",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"ch\"sv)",
          "old_line_content": "        return Length::Type::Vw;",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"ch\"sv)) {",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"vw\"sv)",
          "old_line_content": "        return Length::Type::Vh;",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"vw\"sv)) {",
          "content_same": false
        },
        {
          "line": 182,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"vh\"sv)",
          "old_line_content": "        return Length::Type::Vmax;",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"vh\"sv)) {",
          "content_same": false
        },
        {
          "line": 184,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"vmax\"sv)",
          "old_line_content": "        return Length::Type::Vmin;",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"vmax\"sv)) {",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"vmin\"sv)",
          "old_line_content": "        return Length::Type::Cm;",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"vmin\"sv)) {",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"cm\"sv)",
          "old_line_content": "        return Length::Type::In;",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"cm\"sv)) {",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"in\"sv)",
          "old_line_content": "        return Length::Type::Q;",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"in\"sv)) {",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": null,
          "new_api": "equals_ignoring_case",
          "old_text": null,
          "new_text": "name.equals_ignoring_case(\"Q\"sv)",
          "old_line_content": "",
          "new_line_content": "    } else if (name.equals_ignoring_case(\"Q\"sv)) {",
          "content_same": false
        },
        {
          "line": 101,
          "old_api": null,
          "new_api": "absolute_length_to_px",
          "old_text": null,
          "new_text": "absolute_length_to_px()",
          "old_line_content": "        return 0;",
          "new_line_content": "        return absolute_length_to_px();",
          "content_same": false
        },
        {
          "line": 105,
          "old_api": null,
          "new_api": "document",
          "old_text": null,
          "new_text": "layout_node.document().browsing_context()->viewport_rect()",
          "old_line_content": "        return 0;",
          "new_line_content": "    auto viewport_rect = layout_node.document().browsing_context()->viewport_rect();",
          "content_same": false
        },
        {
          "line": 107,
          "old_api": null,
          "new_api": "layout_node",
          "old_text": null,
          "new_text": "root_element->layout_node()",
          "old_line_content": "}",
          "new_line_content": "    if (!root_element || !root_element->layout_node())",
          "content_same": false
        },
        {
          "line": 109,
          "old_api": null,
          "new_api": "font_size",
          "old_text": null,
          "new_text": "root_element->layout_node()->computed_values().font_size()",
          "old_line_content": "String Length::to_string() const",
          "new_line_content": "    return to_px(viewport_rect, layout_node.font().metrics('M'), layout_node.computed_values().font_size(), root_element->layout_node()->computed_values().font_size());",
          "content_same": false
        },
        {
          "line": 114,
          "old_api": null,
          "new_api": "is_calculated",
          "old_text": null,
          "new_text": "is_calculated()",
          "old_line_content": "        return \"auto\";",
          "new_line_content": "    if (is_calculated())",
          "content_same": false
        },
        {
          "line": 116,
          "old_api": null,
          "new_api": "is_auto",
          "old_text": null,
          "new_text": "is_auto()",
          "old_line_content": "}",
          "new_line_content": "    if (is_auto())",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": null,
          "new_api": "unit_name",
          "old_text": null,
          "new_text": "unit_name()",
          "old_line_content": "const char* Length::unit_name() const",
          "new_line_content": "    return String::formatted(\"{}{}\", m_value, unit_name());",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 156,
          "old_api": "VERIFY_NOT_REACHED",
          "new_api": null,
          "old_text": "VERIFY_NOT_REACHED()",
          "new_text": null,
          "old_line_content": "    VERIFY_NOT_REACHED();",
          "new_line_content": "    case Type::Calculated:",
          "content_same": false
        },
        {
          "line": 161,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"px\"sv)",
          "new_text": null,
          "old_line_content": "    if (name.equals_ignoring_case(\"px\"sv)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"pt\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"pt\"sv)) {",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"pc\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"pc\"sv)) {",
          "new_line_content": "        return Length::Type::Px;",
          "content_same": false
        },
        {
          "line": 167,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"mm\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"mm\"sv)) {",
          "new_line_content": "        return Length::Type::Pt;",
          "content_same": false
        },
        {
          "line": 169,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"rem\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"rem\"sv)) {",
          "new_line_content": "        return Length::Type::Pc;",
          "content_same": false
        },
        {
          "line": 171,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"em\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"em\"sv)) {",
          "new_line_content": "        return Length::Type::Mm;",
          "content_same": false
        },
        {
          "line": 173,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"ex\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"ex\"sv)) {",
          "new_line_content": "        return Length::Type::Rem;",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"ch\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"ch\"sv)) {",
          "new_line_content": "        return Length::Type::Em;",
          "content_same": false
        },
        {
          "line": 177,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"vw\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"vw\"sv)) {",
          "new_line_content": "        return Length::Type::Ex;",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"vh\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"vh\"sv)) {",
          "new_line_content": "        return Length::Type::Ch;",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"vmax\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"vmax\"sv)) {",
          "new_line_content": "        return Length::Type::Vw;",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"vmin\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"vmin\"sv)) {",
          "new_line_content": "        return Length::Type::Vh;",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"cm\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"cm\"sv)) {",
          "new_line_content": "        return Length::Type::Vmax;",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"in\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"in\"sv)) {",
          "new_line_content": "        return Length::Type::Vmin;",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": "equals_ignoring_case",
          "new_api": null,
          "old_text": "name.equals_ignoring_case(\"Q\"sv)",
          "new_text": null,
          "old_line_content": "    } else if (name.equals_ignoring_case(\"Q\"sv)) {",
          "new_line_content": "        return Length::Type::Cm;",
          "content_same": false
        },
        {
          "line": 102,
          "old_api": "document",
          "new_api": null,
          "old_text": "layout_node.document().browsing_context()->viewport_rect()",
          "new_text": null,
          "old_line_content": "    auto viewport_rect = layout_node.document().browsing_context()->viewport_rect();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": "layout_node",
          "new_api": null,
          "old_text": "root_element->layout_node()",
          "new_text": null,
          "old_line_content": "    if (!root_element || !root_element->layout_node())",
          "new_line_content": "        return 0;",
          "content_same": false
        },
        {
          "line": 111,
          "old_api": "is_calculated",
          "new_api": null,
          "old_text": "is_calculated()",
          "new_text": null,
          "old_line_content": "    if (is_calculated())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": "to_string",
          "new_api": null,
          "old_text": "m_calculated_style->to_string()",
          "new_text": null,
          "old_line_content": "        return m_calculated_style->to_string();",
          "new_line_content": "String Length::to_string() const",
          "content_same": false
        },
        {
          "line": 113,
          "old_api": "is_auto",
          "new_api": null,
          "old_text": "is_auto()",
          "new_text": null,
          "old_line_content": "    if (is_auto())",
          "new_line_content": "{",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 3,
      "total_additions": 23,
      "total_deletions": 21,
      "total_api_changes": 47
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 47,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 64,
    "api_calls_after": 66,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 0,
      "total_diff_lines": 15
    }
  }
}