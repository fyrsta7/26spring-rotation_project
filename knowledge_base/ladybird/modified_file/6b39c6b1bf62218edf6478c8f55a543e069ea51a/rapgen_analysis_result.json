{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/6b39c6b1bf62218edf6478c8f55a543e069ea51a",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/6b39c6b1bf62218edf6478c8f55a543e069ea51a/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/6b39c6b1bf62218edf6478c8f55a543e069ea51a/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/6b39c6b1bf62218edf6478c8f55a543e069ea51a/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1666,
          "old_api": "putc",
          "new_api": "String::repeated(' ', fill_count)",
          "old_text": "putc('\\r', stderr)",
          "new_text": "String::repeated(' ', fill_count)",
          "old_line_content": "    putc('\\r', stderr);",
          "new_line_content": "    auto fill_buffer = String::repeated(' ', fill_count);",
          "content_same": false
        },
        {
          "line": 1695,
          "old_api": "is_error",
          "new_api": "bring_cursor_to_beginning_of_a_line",
          "old_text": "line_result.is_error()",
          "new_text": "bring_cursor_to_beginning_of_a_line()",
          "old_line_content": "    if (line_result.is_error()) {",
          "new_line_content": "    bring_cursor_to_beginning_of_a_line();",
          "content_same": false
        },
        {
          "line": 1696,
          "old_api": "error",
          "new_api": "prompt",
          "old_text": "line_result.error()",
          "new_text": "prompt()",
          "old_line_content": "        if (line_result.error() == Line::Editor::Error::Eof || line_result.error() == Line::Editor::Error::Empty) {",
          "new_line_content": "    auto line_result = m_editor->get_line(prompt());",
          "content_same": false
        },
        {
          "line": 1698,
          "old_api": "run_command",
          "new_api": "is_error",
          "old_text": "run_command(\"exit\")",
          "new_text": "line_result.is_error()",
          "old_line_content": "            run_command(\"exit\");",
          "new_line_content": "    if (line_result.is_error()) {",
          "content_same": false
        },
        {
          "line": 1699,
          "old_api": "read_single_line",
          "new_api": "error",
          "old_text": "read_single_line()",
          "new_text": "line_result.error()",
          "old_line_content": "            return read_single_line();",
          "new_line_content": "        if (line_result.error() == Line::Editor::Error::Eof || line_result.error() == Line::Editor::Error::Empty) {",
          "content_same": false
        },
        {
          "line": 1701,
          "old_api": "quit",
          "new_api": "run_command",
          "old_text": "Core::EventLoop::current().quit(1)",
          "new_text": "run_command(\"exit\")",
          "old_line_content": "            Core::EventLoop::current().quit(1);",
          "new_line_content": "            run_command(\"exit\");",
          "content_same": false
        },
        {
          "line": 1711,
          "old_api": "run_command",
          "new_api": "is_empty",
          "old_text": "run_command(line)",
          "new_text": "line.is_empty()",
          "old_line_content": "    run_command(line);",
          "new_line_content": "    if (line.is_empty())",
          "content_same": false
        },
        {
          "line": 1714,
          "old_api": "add_to_history",
          "new_api": "run_command",
          "old_text": "m_editor->add_to_history(line)",
          "new_text": "run_command(line)",
          "old_line_content": "        m_editor->add_to_history(line);",
          "new_line_content": "    run_command(line);",
          "content_same": false
        },
        {
          "line": 1774,
          "old_api": "WIFEXITED",
          "new_api": "pid",
          "old_text": "WIFEXITED(wstatus)",
          "new_text": "job.pid()",
          "old_line_content": "                } else if (WIFEXITED(wstatus)) {",
          "new_line_content": "            if (child_pid == job.pid()) {",
          "content_same": false
        },
        {
          "line": 1775,
          "old_api": "WEXITSTATUS",
          "new_api": "WIFSTOPPED",
          "old_text": "WEXITSTATUS(wstatus)",
          "new_text": "WIFSTOPPED(wstatus)",
          "old_line_content": "                    job.set_has_exit(WEXITSTATUS(wstatus));",
          "new_line_content": "                if (WIFSIGNALED(wstatus) && !WIFSTOPPED(wstatus)) {",
          "content_same": false
        },
        {
          "line": 1776,
          "old_api": "WIFSTOPPED",
          "new_api": "WTERMSIG",
          "old_text": "WIFSTOPPED(wstatus)",
          "new_text": "WTERMSIG(wstatus)",
          "old_line_content": "                } else if (WIFSTOPPED(wstatus)) {",
          "new_line_content": "                    job.set_signalled(WTERMSIG(wstatus));",
          "content_same": false
        },
        {
          "line": 1777,
          "old_api": "unblock",
          "new_api": "WIFEXITED",
          "old_text": "job.unblock()",
          "new_text": "WIFEXITED(wstatus)",
          "old_line_content": "                    job.unblock();",
          "new_line_content": "                } else if (WIFEXITED(wstatus)) {",
          "content_same": false
        },
        {
          "line": 1778,
          "old_api": "set_is_suspended",
          "new_api": "WEXITSTATUS",
          "old_text": "job.set_is_suspended(true)",
          "new_text": "WEXITSTATUS(wstatus)",
          "old_line_content": "                    job.set_is_suspended(true);",
          "new_line_content": "                    job.set_has_exit(WEXITSTATUS(wstatus));",
          "content_same": false
        },
        {
          "line": 1802,
          "old_api": "getuid",
          "new_api": "perror",
          "old_text": "getuid()",
          "new_text": "perror(\"gethostname\")",
          "old_line_content": "        auto* pw = getpwuid(getuid());",
          "new_line_content": "        perror(\"gethostname\");",
          "content_same": false
        },
        {
          "line": 1821,
          "old_api": "append",
          "new_api": "getenv",
          "old_text": "path.append(\"/usr/local/bin:/usr/bin:/bin\")",
          "new_text": "getenv(\"PATH\")",
          "old_line_content": "        path.append(\"/usr/local/bin:/usr/bin:/bin\");",
          "new_line_content": "        path.append(getenv(\"PATH\"));",
          "content_same": false
        },
        {
          "line": 1822,
          "old_api": "to_string",
          "new_api": "length",
          "old_text": "path.to_string().characters()",
          "new_text": "path.length()",
          "old_line_content": "        setenv(\"PATH\", path.to_string().characters(), true);",
          "new_line_content": "        if (path.length())",
          "content_same": false
        },
        {
          "line": 1825,
          "old_api": "cache_path",
          "new_api": "to_string",
          "old_text": "cache_path()",
          "new_text": "path.to_string().characters()",
          "old_line_content": "    cache_path();",
          "new_line_content": "        setenv(\"PATH\", path.to_string().characters(), true);",
          "content_same": false
        },
        {
          "line": 1835,
          "old_api": "leak_frame",
          "new_api": "getpgrp",
          "old_text": "push_frame(\"main\").leak_frame()",
          "new_text": "getpgrp()",
          "old_line_content": "    push_frame(\"main\").leak_frame();",
          "new_line_content": "    tcsetpgrp(0, getpgrp());",
          "content_same": false
        },
        {
          "line": 1856,
          "old_api": "free",
          "new_api": "getcwd",
          "old_text": "free(cwd)",
          "new_text": "getcwd(nullptr, 0)",
          "old_line_content": "        free(cwd);",
          "new_line_content": "        auto* cwd = getcwd(nullptr, 0);",
          "content_same": false
        },
        {
          "line": 1869,
          "old_api": "append",
          "new_api": "endpwent",
          "old_text": "directory_stack.append(cwd)",
          "new_text": "endpwent()",
          "old_line_content": "    directory_stack.append(cwd);",
          "new_line_content": "        endpwent();",
          "content_same": false
        },
        {
          "line": 1872,
          "old_api": "cache_path",
          "new_api": "append",
          "old_text": "cache_path()",
          "new_text": "directory_stack.append(cwd)",
          "old_line_content": "        cache_path();",
          "new_line_content": "    directory_stack.append(cwd);",
          "content_same": false
        },
        {
          "line": 1875,
          "old_api": "line",
          "new_api": "cache_path",
          "old_text": "m_editor->register_key_input_callback('\\n', [](Line::Editor& editor) {\n        auto ast = Parser(editor.line()).parse();\n        if (ast && ast->is_syntax_error() && ast->syntax_error_node().is_continuable())\n            return true;\n\n        return EDITOR_INTERNAL_FUNCTION(finish)(editor);\n    })",
          "new_text": "cache_path()",
          "old_line_content": "    m_editor->register_key_input_callback('\\n', [](Line::Editor& editor) {",
          "new_line_content": "        cache_path();",
          "content_same": false
        },
        {
          "line": 1880,
          "old_api": "EDITOR_INTERNAL_FUNCTION",
          "new_api": "is_continuable",
          "old_text": "EDITOR_INTERNAL_FUNCTION(finish)(editor)",
          "new_text": "ast->syntax_error_node().is_continuable()",
          "old_line_content": "        return EDITOR_INTERNAL_FUNCTION(finish)(editor);",
          "new_line_content": "        if (ast && ast->is_syntax_error() && ast->syntax_error_node().is_continuable())",
          "content_same": false
        },
        {
          "line": 1883,
          "old_api": "start_timer",
          "new_api": "EDITOR_INTERNAL_FUNCTION",
          "old_text": "start_timer(3000)",
          "new_text": "EDITOR_INTERNAL_FUNCTION(finish)(editor)",
          "old_line_content": "    start_timer(3000);",
          "new_line_content": "        return EDITOR_INTERNAL_FUNCTION(finish)(editor);",
          "content_same": false
        },
        {
          "line": 1905,
          "old_api": "pid",
          "new_api": "printf",
          "old_text": "entry.value->pid()",
          "new_text": "printf(\"Killing active jobs\\n\")",
          "old_line_content": "                dbgln_if(SH_DEBUG, \"Job {} is suspended\", entry.value->pid());",
          "new_line_content": "            printf(\"Killing active jobs\\n\");",
          "content_same": false
        },
        {
          "line": 1912,
          "old_api": "usleep",
          "new_api": "kill_job",
          "old_text": "usleep(10000)",
          "new_text": "kill_job(entry.value, SIGHUP)",
          "old_line_content": "        usleep(10000); // Wait for a bit before killing the job",
          "new_line_content": "            kill_job(entry.value, SIGHUP);",
          "content_same": false
        },
        {
          "line": 1915,
          "old_api": "cmd",
          "new_api": "usleep",
          "old_text": "entry.value->cmd()",
          "new_text": "usleep(10000)",
          "old_line_content": "            dbgln_if(SH_DEBUG, \"Actively killing {} ({})\", entry.value->pid(), entry.value->cmd());",
          "new_line_content": "        usleep(10000); // Wait for a bit before killing the job",
          "content_same": false
        },
        {
          "line": 1919,
          "old_api": "clear",
          "new_api": "kill_job",
          "old_text": "jobs.clear()",
          "new_text": "kill_job(entry.value, SIGKILL)",
          "old_line_content": "        jobs.clear();",
          "new_line_content": "            kill_job(entry.value, SIGKILL);",
          "content_same": false
        },
        {
          "line": 1940,
          "old_api": "job_id",
          "new_api": "static_cast<int>(id)",
          "old_text": "entry.value->job_id()",
          "new_text": "static_cast<int>(id)",
          "old_line_content": "            if (entry.value->job_id() == id)",
          "new_line_content": "            if (entry.value->pid() == static_cast<int>(id))",
          "content_same": false
        },
        {
          "line": 1955,
          "old_api": "perror",
          "new_api": "pgid",
          "old_text": "perror(\"kill\")",
          "new_text": "job->pgid()",
          "old_line_content": "                perror(\"kill\");",
          "new_line_content": "    if (killpg(job->pgid(), sig) < 0) {",
          "content_same": false
        },
        {
          "line": 1965,
          "old_api": "set",
          "new_api": "Core::Object::save_to(object)",
          "old_text": "object.set(\"user_home_path\", home)",
          "new_text": "Core::Object::save_to(object)",
          "old_line_content": "    object.set(\"user_home_path\", home);",
          "new_line_content": "    Core::Object::save_to(object);",
          "content_same": false
        },
        {
          "line": 1967,
          "old_api": "size",
          "new_api": "set",
          "old_text": "directory_stack.size()",
          "new_text": "object.set(\"username\", username)",
          "old_line_content": "    object.set(\"directory_stack_size\", directory_stack.size());",
          "new_line_content": "    object.set(\"username\", username);",
          "content_same": false
        },
        {
          "line": 1968,
          "old_api": "size",
          "new_api": "set",
          "old_text": "cd_history.size()",
          "new_text": "object.set(\"user_home_path\", home)",
          "old_line_content": "    object.set(\"cd_history_size\", cd_history.size());",
          "new_line_content": "    object.set(\"user_home_path\", home);",
          "content_same": false
        },
        {
          "line": 1977,
          "old_api": "cmd",
          "new_api": "pid",
          "old_text": "job_entry.value->cmd()",
          "new_text": "job_entry.value->pid()",
          "old_line_content": "        job_object.set(\"command\", job_entry.value->cmd());",
          "new_line_content": "        job_object.set(\"pid\", job_entry.value->pid());",
          "content_same": false
        },
        {
          "line": 1978,
          "old_api": "is_running_in_background",
          "new_api": "pgid",
          "old_text": "job_entry.value->is_running_in_background()",
          "new_text": "job_entry.value->pgid()",
          "old_line_content": "        job_object.set(\"is_running_in_background\", job_entry.value->is_running_in_background());",
          "new_line_content": "        job_object.set(\"pgid\", job_entry.value->pgid());",
          "content_same": false
        },
        {
          "line": 1979,
          "old_api": "move",
          "new_api": "elapsed",
          "old_text": "move(job_object)",
          "new_text": "job_entry.value->timer().elapsed()",
          "old_line_content": "        job_objects.append(move(job_object));",
          "new_line_content": "        job_object.set(\"running_time\", job_entry.value->timer().elapsed());",
          "content_same": false
        },
        {
          "line": 1981,
          "old_api": "move",
          "new_api": "is_running_in_background",
          "old_text": "move(job_objects)",
          "new_text": "job_entry.value->is_running_in_background()",
          "old_line_content": "    object.set(\"jobs\", move(job_objects));",
          "new_line_content": "        job_object.set(\"is_running_in_background\", job_entry.value->is_running_in_background());",
          "content_same": false
        },
        {
          "line": 2012,
          "old_api": "warnln",
          "new_api": "value",
          "old_text": "warnln(\"{:>3}| {}\", line, current_line)",
          "new_text": "m_source_position.value()",
          "old_line_content": "            warnln(\"{:>3}| {}\", line, current_line);",
          "new_line_content": "        auto& source_position = m_source_position.value();",
          "content_same": false
        },
        {
          "line": 2026,
          "old_api": "length",
          "new_api": "warn",
          "old_text": "current_line.length()",
          "new_text": "warn(\"{:^>{}}\", \"\", source_position.position->end_line.line_column - length_written_so_far)",
          "old_line_content": "                    warn(\"{:^>{}}\", \"\", current_line.length() - length_written_so_far);",
          "new_line_content": "                    warn(\"{:^>{}}\", \"\", source_position.position->end_line.line_column - length_written_so_far);",
          "content_same": false
        },
        {
          "line": 2036,
          "old_api": "Core::File::open(source_position.source_file, Core::OpenMode::ReadOnly)",
          "new_api": "max",
          "old_text": "Core::File::open(source_position.source_file, Core::OpenMode::ReadOnly)",
          "new_text": "max(source_position.position->start_line.line_number, 2ul)",
          "old_line_content": "            auto file = Core::File::open(source_position.source_file, Core::OpenMode::ReadOnly);",
          "new_line_content": "        i64 line_to_skip_to = max(source_position.position->start_line.line_number, 2ul) - 2;",
          "content_same": false
        },
        {
          "line": 2038,
          "old_api": "error",
          "new_api": "is_null",
          "old_text": "file.error()",
          "new_text": "source_position.source_file.is_null()",
          "old_line_content": "                warnln(\"Shell: Internal error while trying to display source information: {} (while reading '{}')\", file.error(), source_position.source_file);",
          "new_line_content": "        if (!source_position.source_file.is_null()) {",
          "content_same": false
        },
        {
          "line": 2058,
          "old_api": "is_eof",
          "new_api": "is_empty",
          "old_text": "lexer.is_eof()",
          "new_text": "source_position.literal_source_text.is_empty()",
          "old_line_content": "                if (lexer.is_eof())",
          "new_line_content": "        } else if (!source_position.literal_source_text.is_empty()) {",
          "content_same": false
        },
        {
          "line": 2069,
          "old_api": "consume_line",
          "new_api": "is_eof",
          "old_text": "lexer.consume_line()",
          "new_text": "lexer.is_eof()",
          "old_line_content": "                    current_line = lexer.consume_line();",
          "new_line_content": "                if (lexer.is_eof())",
          "content_same": false
        },
        {
          "line": 2090,
          "old_api": "remaining",
          "new_api": "substring_view",
          "old_text": "lexer.remaining()",
          "new_text": "str.substring_view(1)",
          "old_line_content": "    auto search_term = lexer.remaining();",
          "new_line_content": "    GenericLexer lexer { str.substring_view(1) };",
          "content_same": false
        },
        {
          "line": 2109,
          "old_api": "value",
          "new_api": "getenv",
          "old_text": "time.value()",
          "new_text": "getenv(\"HISTORY_AUTOSAVE_TIME_MS\")",
          "old_line_content": "    if (!time.has_value() || time.value() == 0) {",
          "new_line_content": "    StringView option = getenv(\"HISTORY_AUTOSAVE_TIME_MS\");",
          "content_same": false
        },
        {
          "line": 2111,
          "old_api": "stop_timer",
          "new_api": "to_uint",
          "old_text": "stop_timer()",
          "new_text": "option.to_uint()",
          "old_line_content": "        stop_timer();",
          "new_line_content": "    auto time = option.to_uint();",
          "content_same": false
        },
        {
          "line": 2112,
          "old_api": "start_timer",
          "new_api": "value",
          "old_text": "start_timer(3000)",
          "new_text": "time.value()",
          "old_line_content": "        start_timer(3000);",
          "new_line_content": "    if (!time.has_value() || time.value() == 0) {",
          "content_same": false
        },
        {
          "line": 2122,
          "old_api": "has_value",
          "new_api": "value",
          "old_text": "m_history_autosave_time.has_value()",
          "new_text": "m_history_autosave_time.value()",
          "old_line_content": "    if (!m_history_autosave_time.has_value())",
          "new_line_content": "        start_timer(m_history_autosave_time.value());",
          "content_same": false
        },
        {
          "line": 2125,
          "old_api": "is_history_dirty",
          "new_api": "has_value",
          "old_text": "m_editor->is_history_dirty()",
          "new_text": "m_history_autosave_time.has_value()",
          "old_line_content": "    if (m_editor && m_editor->is_history_dirty())",
          "new_line_content": "    if (!m_history_autosave_time.has_value())",
          "content_same": false
        },
        {
          "line": 2152,
          "old_api": "perror",
          "new_api": "dup",
          "old_text": "perror(\"dup\")",
          "new_text": "dup(rewiring.new_fd)",
          "old_line_content": "                perror(\"dup\");",
          "new_line_content": "        int new_fd = dup(rewiring.new_fd);",
          "content_same": false
        },
        {
          "line": 2163,
          "old_api": "append",
          "new_api": "fcntl",
          "old_text": "m_saves.append({ rewiring.new_fd, new_fd })",
          "new_text": "fcntl(new_fd, F_SETFD, flags | FD_CLOEXEC)",
          "old_line_content": "        m_saves.append({ rewiring.new_fd, new_fd });",
          "new_line_content": "        auto rc = fcntl(new_fd, F_SETFD, flags | FD_CLOEXEC);",
          "content_same": false
        },
        {
          "line": 2164,
          "old_api": "add",
          "new_api": "VERIFY",
          "old_text": "m_collector.add(new_fd)",
          "new_text": "VERIFY(rc == 0)",
          "old_line_content": "        m_collector.add(new_fd);",
          "new_line_content": "        VERIFY(rc == 0);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 2052,
          "old_api": null,
          "new_api": "do_line",
          "old_text": null,
          "new_text": "do_line(line, current_line)",
          "old_line_content": "                else",
          "new_line_content": "                do_line(line, current_line);",
          "content_same": false
        },
        {
          "line": 2056,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "file.value()->read_line()",
          "old_line_content": "            GenericLexer lexer { source_position.literal_source_text };",
          "new_line_content": "                    current_line = file.value()->read_line();",
          "content_same": false
        },
        {
          "line": 2061,
          "old_api": null,
          "new_api": "is_eof",
          "old_text": null,
          "new_text": "lexer.is_eof()",
          "old_line_content": "                ++line;",
          "new_line_content": "                if (lexer.is_eof())",
          "content_same": false
        },
        {
          "line": 2063,
          "old_api": null,
          "new_api": "consume_line",
          "old_text": null,
          "new_text": "lexer.consume_line()",
          "old_line_content": "",
          "new_line_content": "                current_line = lexer.consume_line();",
          "content_same": false
        },
        {
          "line": 2068,
          "old_api": null,
          "new_api": "do_line",
          "old_text": null,
          "new_text": "do_line(line, current_line)",
          "old_line_content": "                else",
          "new_line_content": "                do_line(line, current_line);",
          "content_same": false
        },
        {
          "line": 2072,
          "old_api": null,
          "new_api": "consume_line",
          "old_text": null,
          "new_text": "lexer.consume_line()",
          "old_line_content": "    }",
          "new_line_content": "                    current_line = lexer.consume_line();",
          "content_same": false
        },
        {
          "line": 2076,
          "old_api": null,
          "new_api": "warnln",
          "old_text": null,
          "new_text": "warnln()",
          "old_line_content": "Optional<int> Shell::resolve_job_spec(const String& str)",
          "new_line_content": "    warnln();",
          "content_same": false
        },
        {
          "line": 2081,
          "old_api": null,
          "new_api": "starts_with",
          "old_text": null,
          "new_text": "str.starts_with('%')",
          "old_line_content": "    // %number -> job id <number>",
          "new_line_content": "    if (!str.starts_with('%'))",
          "content_same": false
        },
        {
          "line": 2085,
          "old_api": null,
          "new_api": "has_value",
          "old_text": null,
          "new_text": "number.has_value()",
          "old_line_content": "    // '%?str' -> iterate jobs and pick one with `str' in its command",
          "new_line_content": "    if (auto number = str.substring_view(1).to_uint(); number.has_value())",
          "content_same": false
        },
        {
          "line": 2086,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "number.value()",
          "old_line_content": "    // Note: must be quoted, since '?' will turn it into a glob - pretty ugly...",
          "new_line_content": "        return number.value();",
          "content_same": false
        },
        {
          "line": 2091,
          "old_api": null,
          "new_api": "consume_specific",
          "old_text": null,
          "new_text": "lexer.consume_specific('?')",
          "old_line_content": "    for (auto& it : jobs) {",
          "new_line_content": "    if (!lexer.consume_specific('?'))",
          "content_same": false
        },
        {
          "line": 2093,
          "old_api": null,
          "new_api": "remaining",
          "old_text": null,
          "new_text": "lexer.remaining()",
          "old_line_content": "            return it.key;",
          "new_line_content": "    auto search_term = lexer.remaining();",
          "content_same": false
        },
        {
          "line": 2095,
          "old_api": null,
          "new_api": "contains",
          "old_text": null,
          "new_text": "it.value->cmd().contains(search_term)",
          "old_line_content": "",
          "new_line_content": "        if (it.value->cmd().contains(search_term))",
          "content_same": false
        },
        {
          "line": 2104,
          "old_api": null,
          "new_api": "accept",
          "old_text": null,
          "new_text": "event.accept()",
          "old_line_content": "        return;",
          "new_line_content": "    event.accept();",
          "content_same": false
        },
        {
          "line": 2113,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "m_history_autosave_time.clear()",
          "old_line_content": "        return;",
          "new_line_content": "        m_history_autosave_time.clear();",
          "content_same": false
        },
        {
          "line": 2114,
          "old_api": null,
          "new_api": "stop_timer",
          "old_text": null,
          "new_text": "stop_timer()",
          "old_line_content": "    }",
          "new_line_content": "        stop_timer();",
          "content_same": false
        },
        {
          "line": 2115,
          "old_api": null,
          "new_api": "start_timer",
          "old_text": null,
          "new_text": "start_timer(3000)",
          "old_line_content": "",
          "new_line_content": "        start_timer(3000);",
          "content_same": false
        },
        {
          "line": 2120,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "time.value()",
          "old_line_content": "    }",
          "new_line_content": "        m_history_autosave_time = time.value();",
          "content_same": false
        },
        {
          "line": 2121,
          "old_api": null,
          "new_api": "stop_timer",
          "old_text": null,
          "new_text": "stop_timer()",
          "old_line_content": "",
          "new_line_content": "        stop_timer();",
          "content_same": false
        },
        {
          "line": 2128,
          "old_api": null,
          "new_api": "is_history_dirty",
          "old_text": null,
          "new_text": "m_editor->is_history_dirty()",
          "old_line_content": "",
          "new_line_content": "    if (m_editor && m_editor->is_history_dirty())",
          "content_same": false
        },
        {
          "line": 2129,
          "old_api": null,
          "new_api": "get_history_path",
          "old_text": null,
          "new_text": "get_history_path()",
          "old_line_content": "void FileDescriptionCollector::collect()",
          "new_line_content": "        m_editor->save_history(get_history_path());",
          "content_same": false
        },
        {
          "line": 2135,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close(fd)",
          "old_line_content": "",
          "new_line_content": "        close(fd);",
          "content_same": false
        },
        {
          "line": 2136,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "m_fds.clear()",
          "old_line_content": "FileDescriptionCollector::~FileDescriptionCollector()",
          "new_line_content": "    m_fds.clear();",
          "content_same": false
        },
        {
          "line": 2141,
          "old_api": null,
          "new_api": "collect",
          "old_text": null,
          "new_text": "collect()",
          "old_line_content": "void FileDescriptionCollector::add(int fd)",
          "new_line_content": "    collect();",
          "content_same": false
        },
        {
          "line": 2146,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "m_fds.append(fd)",
          "old_line_content": "SavedFileDescriptors::SavedFileDescriptors(const NonnullRefPtrVector<AST::Rewiring>& intended_rewirings)",
          "new_line_content": "    m_fds.append(fd);",
          "content_same": false
        },
        {
          "line": 2155,
          "old_api": null,
          "new_api": "perror",
          "old_text": null,
          "new_text": "perror(\"dup\")",
          "old_line_content": "            // and we have nothing to do here, so just ignore this error.",
          "new_line_content": "                perror(\"dup\");",
          "content_same": false
        },
        {
          "line": 2162,
          "old_api": null,
          "new_api": "fcntl",
          "old_text": null,
          "new_text": "fcntl(new_fd, F_GETFD)",
          "old_line_content": "",
          "new_line_content": "        auto flags = fcntl(new_fd, F_GETFD);",
          "content_same": false
        },
        {
          "line": 2166,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "m_saves.append({ rewiring.new_fd, new_fd })",
          "old_line_content": "}",
          "new_line_content": "        m_saves.append({ rewiring.new_fd, new_fd });",
          "content_same": false
        },
        {
          "line": 2167,
          "old_api": null,
          "new_api": "add",
          "old_text": null,
          "new_text": "m_collector.add(new_fd)",
          "old_line_content": "",
          "new_line_content": "        m_collector.add(new_fd);",
          "content_same": false
        },
        {
          "line": 2174,
          "old_api": null,
          "new_api": "dup2",
          "old_text": null,
          "new_text": "dup2(save.saved, save.original)",
          "old_line_content": "        }",
          "new_line_content": "        if (dup2(save.saved, save.original) < 0) {",
          "content_same": false
        },
        {
          "line": 2175,
          "old_api": null,
          "new_api": "perror",
          "old_text": null,
          "new_text": "perror(\"dup2(~SavedFileDescriptors)\")",
          "old_line_content": "    }",
          "new_line_content": "            perror(\"dup2(~SavedFileDescriptors)\");",
          "content_same": false
        },
        {
          "line": 1667,
          "old_api": null,
          "new_api": "characters",
          "old_text": null,
          "new_text": "fill_buffer.characters()",
          "old_line_content": "}",
          "new_line_content": "    fwrite(fill_buffer.characters(), 1, fill_count, stderr);",
          "content_same": false
        },
        {
          "line": 1669,
          "old_api": null,
          "new_api": "putc",
          "old_text": null,
          "new_text": "putc('\\r', stderr)",
          "old_line_content": "bool Shell::has_history_event(StringView source)",
          "new_line_content": "    putc('\\r', stderr);",
          "content_same": false
        },
        {
          "line": 1678,
          "old_api": null,
          "new_api": "AST::NodeVisitor::visit(node)",
          "old_text": null,
          "new_text": "AST::NodeVisitor::visit(node)",
          "old_line_content": "        bool has_history_event { false };",
          "new_line_content": "            AST::NodeVisitor::visit(node);",
          "content_same": false
        },
        {
          "line": 1684,
          "old_api": null,
          "new_api": "parse",
          "old_text": null,
          "new_text": "Parser { source, true }.parse()",
          "old_line_content": "",
          "new_line_content": "    auto ast = Parser { source, true }.parse();",
          "content_same": false
        },
        {
          "line": 1688,
          "old_api": null,
          "new_api": "visit",
          "old_text": null,
          "new_text": "ast->visit(visitor)",
          "old_line_content": "",
          "new_line_content": "    ast->visit(visitor);",
          "content_same": false
        },
        {
          "line": 1694,
          "old_api": null,
          "new_api": "restore_ios",
          "old_text": null,
          "new_text": "restore_ios()",
          "old_line_content": "",
          "new_line_content": "    restore_ios();",
          "content_same": false
        },
        {
          "line": 1702,
          "old_api": null,
          "new_api": "read_single_line",
          "old_text": null,
          "new_text": "read_single_line()",
          "old_line_content": "            return false;",
          "new_line_content": "            return read_single_line();",
          "content_same": false
        },
        {
          "line": 1704,
          "old_api": null,
          "new_api": "quit",
          "old_text": null,
          "new_text": "Core::EventLoop::current().quit(1)",
          "old_line_content": "    }",
          "new_line_content": "            Core::EventLoop::current().quit(1);",
          "content_same": false
        },
        {
          "line": 1709,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "line_result.value()",
          "old_line_content": "        return true;",
          "new_line_content": "    auto& line = line_result.value();",
          "content_same": false
        },
        {
          "line": 1716,
          "old_api": null,
          "new_api": "has_history_event",
          "old_text": null,
          "new_text": "has_history_event(line)",
          "old_line_content": "    return true;",
          "new_line_content": "    if (!has_history_event(line))",
          "content_same": false
        },
        {
          "line": 1717,
          "old_api": null,
          "new_api": "add_to_history",
          "old_text": null,
          "new_text": "m_editor->add_to_history(line)",
          "old_line_content": "}",
          "new_line_content": "        m_editor->add_to_history(line);",
          "content_same": false
        },
        {
          "line": 1724,
          "old_api": null,
          "new_api": "custom_type",
          "old_text": null,
          "new_text": "event.custom_type()",
          "old_line_content": "        return;",
          "new_line_content": "    if (event.custom_type() == ReadLine) {",
          "content_same": false
        },
        {
          "line": 1725,
          "old_api": null,
          "new_api": "read_single_line",
          "old_text": null,
          "new_text": "read_single_line()",
          "old_line_content": "    }",
          "new_line_content": "        if (read_single_line())",
          "content_same": false
        },
        {
          "line": 1726,
          "old_api": null,
          "new_api": "make<Core::CustomEvent>(ShellEventType::ReadLine)",
          "old_text": null,
          "new_text": "make<Core::CustomEvent>(ShellEventType::ReadLine)",
          "old_line_content": "}",
          "new_line_content": "            Core::EventLoop::current().post_event(*this, make<Core::CustomEvent>(ShellEventType::ReadLine));",
          "content_same": false
        },
        {
          "line": 1742,
          "old_api": null,
          "new_api": "is_empty",
          "old_text": null,
          "new_text": "jobs.is_empty()",
          "old_line_content": "        for (auto& it : jobs) {",
          "new_line_content": "        if (jobs.is_empty())",
          "content_same": false
        },
        {
          "line": 1750,
          "old_api": null,
          "new_api": "cmd",
          "old_text": null,
          "new_text": "job.cmd()",
          "old_line_content": "",
          "new_line_content": "            dbgln_if(SH_DEBUG, \"waitpid({} = {}) = ...\", job.pid(), job.cmd());",
          "content_same": false
        },
        {
          "line": 1751,
          "old_api": null,
          "new_api": "pid",
          "old_text": null,
          "new_text": "job.pid()",
          "old_line_content": "            if (child_pid < 0) {",
          "new_line_content": "            auto child_pid = waitpid(job.pid(), &wstatus, WNOHANG | WUNTRACED);",
          "content_same": false
        },
        {
          "line": 1752,
          "old_api": null,
          "new_api": "WIFSTOPPED",
          "old_text": null,
          "new_text": "WIFSTOPPED(wstatus)",
          "old_line_content": "                if (errno == ECHILD) {",
          "new_line_content": "            dbgln_if(SH_DEBUG, \"... = {} - exited: {}, suspended: {}\", child_pid, WIFEXITED(wstatus), WIFSTOPPED(wstatus));",
          "content_same": false
        },
        {
          "line": 1758,
          "old_api": null,
          "new_api": "pid",
          "old_text": null,
          "new_text": "job.pid()",
          "old_line_content": "                }",
          "new_line_content": "                    child_pid = job.pid();",
          "content_same": false
        },
        {
          "line": 1760,
          "old_api": null,
          "new_api": "VERIFY_NOT_REACHED",
          "old_text": null,
          "new_text": "VERIFY_NOT_REACHED()",
          "old_line_content": "            if (child_pid == 0) {",
          "new_line_content": "                    VERIFY_NOT_REACHED();",
          "content_same": false
        },
        {
          "line": 1767,
          "old_api": null,
          "new_api": "set_is_suspended",
          "old_text": null,
          "new_text": "job.set_is_suspended(false)",
          "old_line_content": "                    found_child = true;",
          "new_line_content": "                    job.set_is_suspended(false);",
          "content_same": false
        },
        {
          "line": 1768,
          "old_api": null,
          "new_api": "shell_did_continue",
          "old_text": null,
          "new_text": "job.shell_did_continue()",
          "old_line_content": "                }",
          "new_line_content": "                    if (job.shell_did_continue())",
          "content_same": false
        },
        {
          "line": 1769,
          "old_api": null,
          "new_api": "set_shell_did_continue",
          "old_text": null,
          "new_text": "job.set_shell_did_continue(false)",
          "old_line_content": "                continue;",
          "new_line_content": "                        job.set_shell_did_continue(false);",
          "content_same": false
        },
        {
          "line": 1779,
          "old_api": null,
          "new_api": "WIFSTOPPED",
          "old_text": null,
          "new_text": "WIFSTOPPED(wstatus)",
          "old_line_content": "                }",
          "new_line_content": "                } else if (WIFSTOPPED(wstatus)) {",
          "content_same": false
        },
        {
          "line": 1780,
          "old_api": null,
          "new_api": "unblock",
          "old_text": null,
          "new_text": "job.unblock()",
          "old_line_content": "                found_child = true;",
          "new_line_content": "                    job.unblock();",
          "content_same": false
        },
        {
          "line": 1781,
          "old_api": null,
          "new_api": "set_is_suspended",
          "old_text": null,
          "new_text": "job.set_is_suspended(true)",
          "old_line_content": "            }",
          "new_line_content": "                    job.set_is_suspended(true);",
          "content_same": false
        },
        {
          "line": 1785,
          "old_api": null,
          "new_api": "should_be_disowned",
          "old_text": null,
          "new_text": "job.should_be_disowned()",
          "old_line_content": "",
          "new_line_content": "            if (job.should_be_disowned())",
          "content_same": false
        },
        {
          "line": 1786,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "disowned_jobs.append(job_id)",
          "old_line_content": "        for (auto job_id : disowned_jobs) {",
          "new_line_content": "                disowned_jobs.append(job_id);",
          "content_same": false
        },
        {
          "line": 1790,
          "old_api": null,
          "new_api": "remove",
          "old_text": null,
          "new_text": "jobs.remove(job_id)",
          "old_line_content": "}",
          "new_line_content": "            jobs.remove(job_id);",
          "content_same": false
        },
        {
          "line": 1798,
          "old_api": null,
          "new_api": "leak_frame",
          "old_text": null,
          "new_text": "push_frame(\"main\").leak_frame()",
          "old_line_content": "    if (rc < 0)",
          "new_line_content": "    push_frame(\"main\").leak_frame();",
          "content_same": false
        },
        {
          "line": 1800,
          "old_api": null,
          "new_api": "gethostname",
          "old_text": null,
          "new_text": "gethostname(hostname, Shell::HostNameSize)",
          "old_line_content": "",
          "new_line_content": "    int rc = gethostname(hostname, Shell::HostNameSize);",
          "content_same": false
        },
        {
          "line": 1805,
          "old_api": null,
          "new_api": "getuid",
          "old_text": null,
          "new_text": "getuid()",
          "old_line_content": "            home = pw->pw_dir;",
          "new_line_content": "        auto* pw = getpwuid(getuid());",
          "content_same": false
        },
        {
          "line": 1809,
          "old_api": null,
          "new_api": "setenv",
          "old_text": null,
          "new_text": "setenv(\"HOME\", pw->pw_dir, 1)",
          "old_line_content": "    }",
          "new_line_content": "            setenv(\"HOME\", pw->pw_dir, 1);",
          "content_same": false
        },
        {
          "line": 1811,
          "old_api": null,
          "new_api": "endpwent",
          "old_text": null,
          "new_text": "endpwent()",
          "old_line_content": "    // For simplicity, start at the user's home directory.",
          "new_line_content": "        endpwent();",
          "content_same": false
        },
        {
          "line": 1816,
          "old_api": null,
          "new_api": "characters",
          "old_text": null,
          "new_text": "home.characters()",
          "old_line_content": "    {",
          "new_line_content": "    setenv(\"PWD\", home.characters(), 1);",
          "content_same": false
        },
        {
          "line": 1823,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "path.append(\":\")",
          "old_line_content": "    }",
          "new_line_content": "            path.append(\":\");",
          "content_same": false
        },
        {
          "line": 1824,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "path.append(\"/usr/local/bin:/usr/bin:/bin\")",
          "old_line_content": "",
          "new_line_content": "        path.append(\"/usr/local/bin:/usr/bin:/bin\");",
          "content_same": false
        },
        {
          "line": 1828,
          "old_api": null,
          "new_api": "cache_path",
          "old_text": null,
          "new_text": "cache_path()",
          "old_line_content": "Shell::Shell(Line::Editor& editor, bool attempt_interactive)",
          "new_line_content": "    cache_path();",
          "content_same": false
        },
        {
          "line": 1834,
          "old_api": null,
          "new_api": "getuid",
          "old_text": null,
          "new_text": "getuid()",
          "old_line_content": "",
          "new_line_content": "    uid = getuid();",
          "content_same": false
        },
        {
          "line": 1836,
          "old_api": null,
          "new_api": "getpid",
          "old_text": null,
          "new_text": "getpid()",
          "old_line_content": "",
          "new_line_content": "    m_pid = getpid();",
          "content_same": false
        },
        {
          "line": 1838,
          "old_api": null,
          "new_api": "leak_frame",
          "old_text": null,
          "new_text": "push_frame(\"main\").leak_frame()",
          "old_line_content": "    if (rc < 0)",
          "new_line_content": "    push_frame(\"main\").leak_frame();",
          "content_same": false
        },
        {
          "line": 1840,
          "old_api": null,
          "new_api": "gethostname",
          "old_text": null,
          "new_text": "gethostname(hostname, Shell::HostNameSize)",
          "old_line_content": "",
          "new_line_content": "    int rc = gethostname(hostname, Shell::HostNameSize);",
          "content_same": false
        },
        {
          "line": 1842,
          "old_api": null,
          "new_api": "perror",
          "old_text": null,
          "new_text": "perror(\"gethostname\")",
          "old_line_content": "    m_is_interactive = attempt_interactive && istty;",
          "new_line_content": "        perror(\"gethostname\");",
          "content_same": false
        },
        {
          "line": 1844,
          "old_api": null,
          "new_api": "isatty",
          "old_text": null,
          "new_text": "isatty(STDIN_FILENO)",
          "old_line_content": "    if (istty) {",
          "new_line_content": "    auto istty = isatty(STDIN_FILENO);",
          "content_same": false
        },
        {
          "line": 1848,
          "old_api": null,
          "new_api": "ttyname_r",
          "old_text": null,
          "new_text": "ttyname_r(0, ttyname, Shell::TTYNameSize)",
          "old_line_content": "    } else {",
          "new_line_content": "        rc = ttyname_r(0, ttyname, Shell::TTYNameSize);",
          "content_same": false
        },
        {
          "line": 1850,
          "old_api": null,
          "new_api": "perror",
          "old_text": null,
          "new_text": "perror(\"ttyname_r\")",
          "old_line_content": "    }",
          "new_line_content": "            perror(\"ttyname_r\");",
          "content_same": false
        },
        {
          "line": 1858,
          "old_api": null,
          "new_api": "setenv",
          "old_text": null,
          "new_text": "setenv(\"PWD\", cwd, 1)",
          "old_line_content": "",
          "new_line_content": "        setenv(\"PWD\", cwd, 1);",
          "content_same": false
        },
        {
          "line": 1859,
          "old_api": null,
          "new_api": "free",
          "old_text": null,
          "new_text": "free(cwd)",
          "old_line_content": "    {",
          "new_line_content": "        free(cwd);",
          "content_same": false
        },
        {
          "line": 1863,
          "old_api": null,
          "new_api": "getuid",
          "old_text": null,
          "new_text": "getuid()",
          "old_line_content": "            home = pw->pw_dir;",
          "new_line_content": "        auto* pw = getpwuid(getuid());",
          "content_same": false
        },
        {
          "line": 1867,
          "old_api": null,
          "new_api": "setenv",
          "old_text": null,
          "new_text": "setenv(\"HOME\", pw->pw_dir, 1)",
          "old_line_content": "    }",
          "new_line_content": "            setenv(\"HOME\", pw->pw_dir, 1);",
          "content_same": false
        },
        {
          "line": 1874,
          "old_api": null,
          "new_api": "get_history_path",
          "old_text": null,
          "new_text": "get_history_path()",
          "old_line_content": "",
          "new_line_content": "        m_editor->load_history(get_history_path());",
          "content_same": false
        },
        {
          "line": 1878,
          "old_api": null,
          "new_api": "line",
          "old_text": null,
          "new_text": "m_editor->register_key_input_callback('\\n', [](Line::Editor& editor) {\n        auto ast = Parser(editor.line()).parse();\n        if (ast && ast->is_syntax_error() && ast->syntax_error_node().is_continuable())\n            return true;\n\n        return EDITOR_INTERNAL_FUNCTION(finish)(editor);\n    })",
          "old_line_content": "            return true;",
          "new_line_content": "    m_editor->register_key_input_callback('\\n', [](Line::Editor& editor) {",
          "content_same": false
        },
        {
          "line": 1879,
          "old_api": null,
          "new_api": "line",
          "old_text": null,
          "new_text": "editor.line()",
          "old_line_content": "",
          "new_line_content": "        auto ast = Parser(editor.line()).parse();",
          "content_same": false
        },
        {
          "line": 1886,
          "old_api": null,
          "new_api": "start_timer",
          "old_text": null,
          "new_text": "start_timer(3000)",
          "old_line_content": "Shell::~Shell()",
          "new_line_content": "    start_timer(3000);",
          "content_same": false
        },
        {
          "line": 1894,
          "old_api": null,
          "new_api": "stop_all_jobs",
          "old_text": null,
          "new_text": "stop_all_jobs()",
          "old_line_content": "",
          "new_line_content": "    stop_all_jobs();",
          "content_same": false
        },
        {
          "line": 1898,
          "old_api": null,
          "new_api": "get_history_path",
          "old_text": null,
          "new_text": "get_history_path()",
          "old_line_content": "void Shell::stop_all_jobs()",
          "new_line_content": "    m_editor->save_history(get_history_path());",
          "content_same": false
        },
        {
          "line": 1903,
          "old_api": null,
          "new_api": "is_empty",
          "old_text": null,
          "new_text": "jobs.is_empty()",
          "old_line_content": "        for (auto& entry : jobs) {",
          "new_line_content": "    if (!jobs.is_empty()) {",
          "content_same": false
        },
        {
          "line": 1907,
          "old_api": null,
          "new_api": "is_suspended",
          "old_text": null,
          "new_text": "entry.value->is_suspended()",
          "old_line_content": "            }",
          "new_line_content": "            if (entry.value->is_suspended()) {",
          "content_same": false
        },
        {
          "line": 1908,
          "old_api": null,
          "new_api": "pid",
          "old_text": null,
          "new_text": "entry.value->pid()",
          "old_line_content": "",
          "new_line_content": "                dbgln_if(SH_DEBUG, \"Job {} is suspended\", entry.value->pid());",
          "content_same": false
        },
        {
          "line": 1918,
          "old_api": null,
          "new_api": "cmd",
          "old_text": null,
          "new_text": "entry.value->cmd()",
          "old_line_content": "",
          "new_line_content": "            dbgln_if(SH_DEBUG, \"Actively killing {} ({})\", entry.value->pid(), entry.value->cmd());",
          "content_same": false
        },
        {
          "line": 1922,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "jobs.clear()",
          "old_line_content": "",
          "new_line_content": "        jobs.clear();",
          "content_same": false
        },
        {
          "line": 1930,
          "old_api": null,
          "new_api": "job_id",
          "old_text": null,
          "new_text": "entry.value->job_id()",
          "old_line_content": "    return job_id;",
          "new_line_content": "        if (entry.value->job_id() > job_id)",
          "content_same": false
        },
        {
          "line": 1931,
          "old_api": null,
          "new_api": "job_id",
          "old_text": null,
          "new_text": "entry.value->job_id()",
          "old_line_content": "}",
          "new_line_content": "            job_id = entry.value->job_id();",
          "content_same": false
        },
        {
          "line": 1943,
          "old_api": null,
          "new_api": "job_id",
          "old_text": null,
          "new_text": "entry.value->job_id()",
          "old_line_content": "    }",
          "new_line_content": "            if (entry.value->job_id() == id)",
          "content_same": false
        },
        {
          "line": 1956,
          "old_api": null,
          "new_api": "pid",
          "old_text": null,
          "new_text": "job->pid()",
          "old_line_content": "        }",
          "new_line_content": "        if (kill(job->pid(), sig) < 0) {",
          "content_same": false
        },
        {
          "line": 1958,
          "old_api": null,
          "new_api": "perror",
          "old_text": null,
          "new_text": "perror(\"kill\")",
          "old_line_content": "}",
          "new_line_content": "                perror(\"kill\");",
          "content_same": false
        },
        {
          "line": 1969,
          "old_api": null,
          "new_api": "set",
          "old_text": null,
          "new_text": "object.set(\"user_id\", uid)",
          "old_line_content": "",
          "new_line_content": "    object.set(\"user_id\", uid);",
          "content_same": false
        },
        {
          "line": 1970,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "directory_stack.size()",
          "old_line_content": "    // Jobs.",
          "new_line_content": "    object.set(\"directory_stack_size\", directory_stack.size());",
          "content_same": false
        },
        {
          "line": 1971,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "cd_history.size()",
          "old_line_content": "    JsonArray job_objects;",
          "new_line_content": "    object.set(\"cd_history_size\", cd_history.size());",
          "content_same": false
        },
        {
          "line": 1980,
          "old_api": null,
          "new_api": "cmd",
          "old_text": null,
          "new_text": "job_entry.value->cmd()",
          "old_line_content": "    }",
          "new_line_content": "        job_object.set(\"command\", job_entry.value->cmd());",
          "content_same": false
        },
        {
          "line": 1982,
          "old_api": null,
          "new_api": "move",
          "old_text": null,
          "new_text": "move(job_object)",
          "old_line_content": "}",
          "new_line_content": "        job_objects.append(move(job_object));",
          "content_same": false
        },
        {
          "line": 1984,
          "old_api": null,
          "new_api": "move",
          "old_text": null,
          "new_text": "move(job_objects)",
          "old_line_content": "void Shell::possibly_print_error() const",
          "new_line_content": "    object.set(\"jobs\", move(job_objects));",
          "content_same": false
        },
        {
          "line": 1991,
          "old_api": null,
          "new_api": "warnln",
          "old_text": null,
          "new_text": "warnln(\"Shell Syntax Error: {}\", m_error_description)",
          "old_line_content": "    case ShellError::InvalidGlobError:",
          "new_line_content": "        warnln(\"Shell Syntax Error: {}\", m_error_description);",
          "content_same": false
        },
        {
          "line": 2002,
          "old_api": null,
          "new_api": "warnln",
          "old_text": null,
          "new_text": "warnln(\"Shell: Hit an OOM situation\")",
          "old_line_content": "    case ShellError::InternalControlFlowContinue:",
          "new_line_content": "        warnln(\"Shell: Hit an OOM situation\");",
          "content_same": false
        },
        {
          "line": 2011,
          "old_api": null,
          "new_api": "has_value",
          "old_text": null,
          "new_text": "m_source_position->position.has_value()",
          "old_line_content": "            auto is_in_range = line >= (i64)source_position.position->start_line.line_number && line <= (i64)source_position.position->end_line.line_number;",
          "new_line_content": "    if (m_source_position.has_value() && m_source_position->position.has_value()) {",
          "content_same": false
        },
        {
          "line": 2015,
          "old_api": null,
          "new_api": "warnln",
          "old_text": null,
          "new_text": "warnln(\"{:>3}| {}\", line, current_line)",
          "old_line_content": "                size_t length_written_so_far = 0;",
          "new_line_content": "            warnln(\"{:>3}| {}\", line, current_line);",
          "content_same": false
        },
        {
          "line": 2029,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "current_line.length()",
          "old_line_content": "            }",
          "new_line_content": "                    warn(\"{:^>{}}\", \"\", current_line.length() - length_written_so_far);",
          "content_same": false
        },
        {
          "line": 2031,
          "old_api": null,
          "new_api": "warnln",
          "old_text": null,
          "new_text": "warnln(\"\\x1b[0m\")",
          "old_line_content": "        int line = -1;",
          "new_line_content": "                warnln(\"\\x1b[0m\");",
          "content_same": false
        },
        {
          "line": 2039,
          "old_api": null,
          "new_api": "Core::File::open(source_position.source_file, Core::OpenMode::ReadOnly)",
          "old_text": null,
          "new_text": "Core::File::open(source_position.source_file, Core::OpenMode::ReadOnly)",
          "old_line_content": "                return;",
          "new_line_content": "            auto file = Core::File::open(source_position.source_file, Core::OpenMode::ReadOnly);",
          "content_same": false
        },
        {
          "line": 2040,
          "old_api": null,
          "new_api": "is_error",
          "old_text": null,
          "new_text": "file.is_error()",
          "old_line_content": "            }",
          "new_line_content": "            if (file.is_error()) {",
          "content_same": false
        },
        {
          "line": 2041,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "file.error()",
          "old_line_content": "            while (line < line_to_skip_to) {",
          "new_line_content": "                warnln(\"Shell: Internal error while trying to display source information: {} (while reading '{}')\", file.error(), source_position.source_file);",
          "content_same": false
        },
        {
          "line": 2045,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "file.value()->eof()",
          "old_line_content": "                ++line;",
          "new_line_content": "                if (file.value()->eof())",
          "content_same": false
        },
        {
          "line": 2047,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "file.value()->read_line()",
          "old_line_content": "",
          "new_line_content": "                current_line = file.value()->read_line();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 2049,
          "old_api": "do_line",
          "new_api": null,
          "old_text": "do_line(line, current_line)",
          "new_text": null,
          "old_line_content": "                do_line(line, current_line);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2050,
          "old_api": "value",
          "new_api": null,
          "old_text": "file.value()->eof()",
          "new_text": null,
          "old_line_content": "                if (file.value()->eof())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2055,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "source_position.literal_source_text.is_empty()",
          "new_text": null,
          "old_line_content": "        } else if (!source_position.literal_source_text.is_empty()) {",
          "new_line_content": "                else",
          "content_same": false
        },
        {
          "line": 2060,
          "old_api": "consume_line",
          "new_api": null,
          "old_text": "lexer.consume_line()",
          "new_text": null,
          "old_line_content": "                current_line = lexer.consume_line();",
          "new_line_content": "            while (line < line_to_skip_to) {",
          "content_same": false
        },
        {
          "line": 2065,
          "old_api": "do_line",
          "new_api": null,
          "old_text": "do_line(line, current_line)",
          "new_text": null,
          "old_line_content": "                do_line(line, current_line);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2066,
          "old_api": "is_eof",
          "new_api": null,
          "old_text": "lexer.is_eof()",
          "new_text": null,
          "old_line_content": "                if (lexer.is_eof())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2073,
          "old_api": "warnln",
          "new_api": null,
          "old_text": "warnln()",
          "new_text": null,
          "old_line_content": "    warnln();",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 2078,
          "old_api": "starts_with",
          "new_api": null,
          "old_text": "str.starts_with('%')",
          "new_text": null,
          "old_line_content": "    if (!str.starts_with('%'))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2082,
          "old_api": "has_value",
          "new_api": null,
          "old_text": "number.has_value()",
          "new_text": null,
          "old_line_content": "    if (auto number = str.substring_view(1).to_uint(); number.has_value())",
          "new_line_content": "        return {};",
          "content_same": false
        },
        {
          "line": 2083,
          "old_api": "value",
          "new_api": null,
          "old_text": "number.value()",
          "new_text": null,
          "old_line_content": "        return number.value();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2087,
          "old_api": "substring_view",
          "new_api": null,
          "old_text": "str.substring_view(1)",
          "new_text": null,
          "old_line_content": "    GenericLexer lexer { str.substring_view(1) };",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2088,
          "old_api": "consume_specific",
          "new_api": null,
          "old_text": "lexer.consume_specific('?')",
          "new_text": null,
          "old_line_content": "    if (!lexer.consume_specific('?'))",
          "new_line_content": "    // '%?str' -> iterate jobs and pick one with `str' in its command",
          "content_same": false
        },
        {
          "line": 2092,
          "old_api": "contains",
          "new_api": null,
          "old_text": "it.value->cmd().contains(search_term)",
          "new_text": null,
          "old_line_content": "        if (it.value->cmd().contains(search_term))",
          "new_line_content": "        return {};",
          "content_same": false
        },
        {
          "line": 2101,
          "old_api": "accept",
          "new_api": null,
          "old_text": "event.accept()",
          "new_text": null,
          "old_line_content": "    event.accept();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2106,
          "old_api": "getenv",
          "new_api": null,
          "old_text": "getenv(\"HISTORY_AUTOSAVE_TIME_MS\")",
          "new_text": null,
          "old_line_content": "    StringView option = getenv(\"HISTORY_AUTOSAVE_TIME_MS\");",
          "new_line_content": "    if (m_is_subshell)",
          "content_same": false
        },
        {
          "line": 2108,
          "old_api": "to_uint",
          "new_api": null,
          "old_text": "option.to_uint()",
          "new_text": null,
          "old_line_content": "    auto time = option.to_uint();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2110,
          "old_api": "clear",
          "new_api": null,
          "old_text": "m_history_autosave_time.clear()",
          "new_text": null,
          "old_line_content": "        m_history_autosave_time.clear();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2117,
          "old_api": "value",
          "new_api": null,
          "old_text": "time.value()",
          "new_text": null,
          "old_line_content": "        m_history_autosave_time = time.value();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2118,
          "old_api": "stop_timer",
          "new_api": null,
          "old_text": "stop_timer()",
          "new_text": null,
          "old_line_content": "        stop_timer();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2119,
          "old_api": "value",
          "new_api": null,
          "old_text": "m_history_autosave_time.value()",
          "new_text": null,
          "old_line_content": "        start_timer(m_history_autosave_time.value());",
          "new_line_content": "    if (m_history_autosave_time != time) {",
          "content_same": false
        },
        {
          "line": 2126,
          "old_api": "get_history_path",
          "new_api": null,
          "old_text": "get_history_path()",
          "new_text": null,
          "old_line_content": "        m_editor->save_history(get_history_path());",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 2132,
          "old_api": "close",
          "new_api": null,
          "old_text": "close(fd)",
          "new_text": null,
          "old_line_content": "        close(fd);",
          "new_line_content": "void FileDescriptionCollector::collect()",
          "content_same": false
        },
        {
          "line": 2133,
          "old_api": "clear",
          "new_api": null,
          "old_text": "m_fds.clear()",
          "new_text": null,
          "old_line_content": "    m_fds.clear();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 2138,
          "old_api": "collect",
          "new_api": null,
          "old_text": "collect()",
          "new_text": null,
          "old_line_content": "    collect();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2143,
          "old_api": "append",
          "new_api": null,
          "old_text": "m_fds.append(fd)",
          "new_text": null,
          "old_line_content": "    m_fds.append(fd);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2149,
          "old_api": "dup",
          "new_api": null,
          "old_text": "dup(rewiring.new_fd)",
          "new_text": null,
          "old_line_content": "        int new_fd = dup(rewiring.new_fd);",
          "new_line_content": "SavedFileDescriptors::SavedFileDescriptors(const NonnullRefPtrVector<AST::Rewiring>& intended_rewirings)",
          "content_same": false
        },
        {
          "line": 2159,
          "old_api": "fcntl",
          "new_api": null,
          "old_text": "fcntl(new_fd, F_GETFD)",
          "new_text": null,
          "old_line_content": "        auto flags = fcntl(new_fd, F_GETFD);",
          "new_line_content": "            continue;",
          "content_same": false
        },
        {
          "line": 2160,
          "old_api": "fcntl",
          "new_api": null,
          "old_text": "fcntl(new_fd, F_SETFD, flags | FD_CLOEXEC)",
          "new_text": null,
          "old_line_content": "        auto rc = fcntl(new_fd, F_SETFD, flags | FD_CLOEXEC);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 2161,
          "old_api": "VERIFY",
          "new_api": null,
          "old_text": "VERIFY(rc == 0)",
          "new_text": null,
          "old_line_content": "        VERIFY(rc == 0);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2171,
          "old_api": "dup2",
          "new_api": null,
          "old_text": "dup2(save.saved, save.original)",
          "new_text": null,
          "old_line_content": "        if (dup2(save.saved, save.original) < 0) {",
          "new_line_content": "SavedFileDescriptors::~SavedFileDescriptors()",
          "content_same": false
        },
        {
          "line": 2172,
          "old_api": "perror",
          "new_api": null,
          "old_text": "perror(\"dup2(~SavedFileDescriptors)\")",
          "new_text": null,
          "old_line_content": "            perror(\"dup2(~SavedFileDescriptors)\");",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1664,
          "old_api": "putc",
          "new_api": null,
          "old_text": "putc(' ', stderr)",
          "new_text": null,
          "old_line_content": "        putc(' ', stderr);",
          "new_line_content": "    // the prompt ends up on a new line even if there is dangling output on the current line.",
          "content_same": false
        },
        {
          "line": 1675,
          "old_api": "AST::NodeVisitor::visit(node)",
          "new_api": null,
          "old_text": "AST::NodeVisitor::visit(node)",
          "new_text": null,
          "old_line_content": "            AST::NodeVisitor::visit(node);",
          "new_line_content": "        virtual void visit(const AST::HistoryEvent* node) override",
          "content_same": false
        },
        {
          "line": 1681,
          "old_api": "parse",
          "new_api": null,
          "old_text": "Parser { source, true }.parse()",
          "new_text": null,
          "old_line_content": "    auto ast = Parser { source, true }.parse();",
          "new_line_content": "        bool has_history_event { false };",
          "content_same": false
        },
        {
          "line": 1685,
          "old_api": "visit",
          "new_api": null,
          "old_text": "ast->visit(visitor)",
          "new_text": null,
          "old_line_content": "    ast->visit(visitor);",
          "new_line_content": "    if (!ast)",
          "content_same": false
        },
        {
          "line": 1691,
          "old_api": "restore_ios",
          "new_api": null,
          "old_text": "restore_ios()",
          "new_text": null,
          "old_line_content": "    restore_ios();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1692,
          "old_api": "bring_cursor_to_beginning_of_a_line",
          "new_api": null,
          "old_text": "bring_cursor_to_beginning_of_a_line()",
          "new_text": null,
          "old_line_content": "    bring_cursor_to_beginning_of_a_line();",
          "new_line_content": "bool Shell::read_single_line()",
          "content_same": false
        },
        {
          "line": 1693,
          "old_api": "prompt",
          "new_api": null,
          "old_text": "prompt()",
          "new_text": null,
          "old_line_content": "    auto line_result = m_editor->get_line(prompt());",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1706,
          "old_api": "value",
          "new_api": null,
          "old_text": "line_result.value()",
          "new_text": null,
          "old_line_content": "    auto& line = line_result.value();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1708,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "line.is_empty()",
          "new_text": null,
          "old_line_content": "    if (line.is_empty())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1713,
          "old_api": "has_history_event",
          "new_api": null,
          "old_text": "has_history_event(line)",
          "new_text": null,
          "old_line_content": "    if (!has_history_event(line))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1721,
          "old_api": "custom_type",
          "new_api": null,
          "old_text": "event.custom_type()",
          "new_text": null,
          "old_line_content": "    if (event.custom_type() == ReadLine) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1722,
          "old_api": "read_single_line",
          "new_api": null,
          "old_text": "read_single_line()",
          "new_text": null,
          "old_line_content": "        if (read_single_line())",
          "new_line_content": "void Shell::custom_event(Core::CustomEvent& event)",
          "content_same": false
        },
        {
          "line": 1723,
          "old_api": "make<Core::CustomEvent>(ShellEventType::ReadLine)",
          "new_api": null,
          "old_text": "make<Core::CustomEvent>(ShellEventType::ReadLine)",
          "new_text": null,
          "old_line_content": "            Core::EventLoop::current().post_event(*this, make<Core::CustomEvent>(ShellEventType::ReadLine));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1739,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "jobs.is_empty()",
          "new_text": null,
          "old_line_content": "        if (jobs.is_empty())",
          "new_line_content": "    bool found_child = false;",
          "content_same": false
        },
        {
          "line": 1747,
          "old_api": "cmd",
          "new_api": null,
          "old_text": "job.cmd()",
          "new_text": null,
          "old_line_content": "            dbgln_if(SH_DEBUG, \"waitpid({} = {}) = ...\", job.pid(), job.cmd());",
          "new_line_content": "            auto& job = *it.value;",
          "content_same": false
        },
        {
          "line": 1748,
          "old_api": "pid",
          "new_api": null,
          "old_text": "job.pid()",
          "new_text": null,
          "old_line_content": "            auto child_pid = waitpid(job.pid(), &wstatus, WNOHANG | WUNTRACED);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1749,
          "old_api": "WIFSTOPPED",
          "new_api": null,
          "old_text": "WIFSTOPPED(wstatus)",
          "new_text": null,
          "old_line_content": "            dbgln_if(SH_DEBUG, \"... = {} - exited: {}, suspended: {}\", child_pid, WIFEXITED(wstatus), WIFSTOPPED(wstatus));",
          "new_line_content": "            int wstatus = 0;",
          "content_same": false
        },
        {
          "line": 1755,
          "old_api": "pid",
          "new_api": null,
          "old_text": "job.pid()",
          "new_text": null,
          "old_line_content": "                    child_pid = job.pid();",
          "new_line_content": "                if (errno == ECHILD) {",
          "content_same": false
        },
        {
          "line": 1757,
          "old_api": "VERIFY_NOT_REACHED",
          "new_api": null,
          "old_text": "VERIFY_NOT_REACHED()",
          "new_text": null,
          "old_line_content": "                    VERIFY_NOT_REACHED();",
          "new_line_content": "                    // FIXME: This should never happen, the child should stay around until we do the waitpid above.",
          "content_same": false
        },
        {
          "line": 1762,
          "old_api": "shell_did_continue",
          "new_api": null,
          "old_text": "job.shell_did_continue()",
          "new_text": null,
          "old_line_content": "                if (job.is_suspended() || job.shell_did_continue()) {",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1764,
          "old_api": "set_is_suspended",
          "new_api": null,
          "old_text": "job.set_is_suspended(false)",
          "new_text": null,
          "old_line_content": "                    job.set_is_suspended(false);",
          "new_line_content": "                // If the child existed, but wasn't dead.",
          "content_same": false
        },
        {
          "line": 1766,
          "old_api": "set_shell_did_continue",
          "new_api": null,
          "old_text": "job.set_shell_did_continue(false)",
          "new_text": null,
          "old_line_content": "                        job.set_shell_did_continue(false);",
          "new_line_content": "                    // The job was suspended, and someone sent it a SIGCONT.",
          "content_same": false
        },
        {
          "line": 1771,
          "old_api": "pid",
          "new_api": null,
          "old_text": "job.pid()",
          "new_text": null,
          "old_line_content": "            if (child_pid == job.pid()) {",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1772,
          "old_api": "WIFSTOPPED",
          "new_api": null,
          "old_text": "WIFSTOPPED(wstatus)",
          "new_text": null,
          "old_line_content": "                if (WIFSIGNALED(wstatus) && !WIFSTOPPED(wstatus)) {",
          "new_line_content": "                continue;",
          "content_same": false
        },
        {
          "line": 1773,
          "old_api": "WTERMSIG",
          "new_api": null,
          "old_text": "WTERMSIG(wstatus)",
          "new_text": null,
          "old_line_content": "                    job.set_signalled(WTERMSIG(wstatus));",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1782,
          "old_api": "should_be_disowned",
          "new_api": null,
          "old_text": "job.should_be_disowned()",
          "new_text": null,
          "old_line_content": "            if (job.should_be_disowned())",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1783,
          "old_api": "append",
          "new_api": null,
          "old_text": "disowned_jobs.append(job_id)",
          "new_text": null,
          "old_line_content": "                disowned_jobs.append(job_id);",
          "new_line_content": "                found_child = true;",
          "content_same": false
        },
        {
          "line": 1787,
          "old_api": "remove",
          "new_api": null,
          "old_text": "jobs.remove(job_id)",
          "new_text": null,
          "old_line_content": "            jobs.remove(job_id);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1795,
          "old_api": "leak_frame",
          "new_api": null,
          "old_text": "push_frame(\"main\").leak_frame()",
          "new_text": null,
          "old_line_content": "    push_frame(\"main\").leak_frame();",
          "new_line_content": "Shell::Shell()",
          "content_same": false
        },
        {
          "line": 1797,
          "old_api": "gethostname",
          "new_api": null,
          "old_text": "gethostname(hostname, Shell::HostNameSize)",
          "new_text": null,
          "old_line_content": "    int rc = gethostname(hostname, Shell::HostNameSize);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1799,
          "old_api": "perror",
          "new_api": null,
          "old_text": "perror(\"gethostname\")",
          "new_text": null,
          "old_line_content": "        perror(\"gethostname\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1806,
          "old_api": "setenv",
          "new_api": null,
          "old_text": "setenv(\"HOME\", pw->pw_dir, 1)",
          "new_text": null,
          "old_line_content": "            setenv(\"HOME\", pw->pw_dir, 1);",
          "new_line_content": "        if (pw) {",
          "content_same": false
        },
        {
          "line": 1808,
          "old_api": "endpwent",
          "new_api": null,
          "old_text": "endpwent()",
          "new_text": null,
          "old_line_content": "        endpwent();",
          "new_line_content": "            home = pw->pw_dir;",
          "content_same": false
        },
        {
          "line": 1813,
          "old_api": "characters",
          "new_api": null,
          "old_text": "home.characters()",
          "new_text": null,
          "old_line_content": "    setenv(\"PWD\", home.characters(), 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1818,
          "old_api": "getenv",
          "new_api": null,
          "old_text": "getenv(\"PATH\")",
          "new_text": null,
          "old_line_content": "        path.append(getenv(\"PATH\"));",
          "new_line_content": "    // Add the default PATH vars.",
          "content_same": false
        },
        {
          "line": 1819,
          "old_api": "length",
          "new_api": null,
          "old_text": "path.length()",
          "new_text": null,
          "old_line_content": "        if (path.length())",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 1820,
          "old_api": "append",
          "new_api": null,
          "old_text": "path.append(\":\")",
          "new_text": null,
          "old_line_content": "            path.append(\":\");",
          "new_line_content": "        StringBuilder path;",
          "content_same": false
        },
        {
          "line": 1831,
          "old_api": "getuid",
          "new_api": null,
          "old_text": "getuid()",
          "new_text": null,
          "old_line_content": "    uid = getuid();",
          "new_line_content": "Shell::Shell(Line::Editor& editor, bool attempt_interactive)",
          "content_same": false
        },
        {
          "line": 1832,
          "old_api": "getpgrp",
          "new_api": null,
          "old_text": "getpgrp()",
          "new_text": null,
          "old_line_content": "    tcsetpgrp(0, getpgrp());",
          "new_line_content": "    : m_editor(editor)",
          "content_same": false
        },
        {
          "line": 1833,
          "old_api": "getpid",
          "new_api": null,
          "old_text": "getpid()",
          "new_text": null,
          "old_line_content": "    m_pid = getpid();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1837,
          "old_api": "gethostname",
          "new_api": null,
          "old_text": "gethostname(hostname, Shell::HostNameSize)",
          "new_text": null,
          "old_line_content": "    int rc = gethostname(hostname, Shell::HostNameSize);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1839,
          "old_api": "perror",
          "new_api": null,
          "old_text": "perror(\"gethostname\")",
          "new_text": null,
          "old_line_content": "        perror(\"gethostname\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1841,
          "old_api": "isatty",
          "new_api": null,
          "old_text": "isatty(STDIN_FILENO)",
          "new_text": null,
          "old_line_content": "    auto istty = isatty(STDIN_FILENO);",
          "new_line_content": "    if (rc < 0)",
          "content_same": false
        },
        {
          "line": 1845,
          "old_api": "ttyname_r",
          "new_api": null,
          "old_text": "ttyname_r(0, ttyname, Shell::TTYNameSize)",
          "new_text": null,
          "old_line_content": "        rc = ttyname_r(0, ttyname, Shell::TTYNameSize);",
          "new_line_content": "    m_is_interactive = attempt_interactive && istty;",
          "content_same": false
        },
        {
          "line": 1847,
          "old_api": "perror",
          "new_api": null,
          "old_text": "perror(\"ttyname_r\")",
          "new_text": null,
          "old_line_content": "            perror(\"ttyname_r\");",
          "new_line_content": "    if (istty) {",
          "content_same": false
        },
        {
          "line": 1853,
          "old_api": "getcwd",
          "new_api": null,
          "old_text": "getcwd(nullptr, 0)",
          "new_text": null,
          "old_line_content": "        auto* cwd = getcwd(nullptr, 0);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1855,
          "old_api": "setenv",
          "new_api": null,
          "old_text": "setenv(\"PWD\", cwd, 1)",
          "new_text": null,
          "old_line_content": "        setenv(\"PWD\", cwd, 1);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 1860,
          "old_api": "getuid",
          "new_api": null,
          "old_text": "getuid()",
          "new_text": null,
          "old_line_content": "        auto* pw = getpwuid(getuid());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1864,
          "old_api": "setenv",
          "new_api": null,
          "old_text": "setenv(\"HOME\", pw->pw_dir, 1)",
          "new_text": null,
          "old_line_content": "            setenv(\"HOME\", pw->pw_dir, 1);",
          "new_line_content": "        if (pw) {",
          "content_same": false
        },
        {
          "line": 1866,
          "old_api": "endpwent",
          "new_api": null,
          "old_text": "endpwent()",
          "new_text": null,
          "old_line_content": "        endpwent();",
          "new_line_content": "            home = pw->pw_dir;",
          "content_same": false
        },
        {
          "line": 1871,
          "old_api": "get_history_path",
          "new_api": null,
          "old_text": "get_history_path()",
          "new_text": null,
          "old_line_content": "        m_editor->load_history(get_history_path());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1876,
          "old_api": "line",
          "new_api": null,
          "old_text": "editor.line()",
          "new_text": null,
          "old_line_content": "        auto ast = Parser(editor.line()).parse();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 1877,
          "old_api": "is_continuable",
          "new_api": null,
          "old_text": "ast->syntax_error_node().is_continuable()",
          "new_text": null,
          "old_line_content": "        if (ast && ast->is_syntax_error() && ast->syntax_error_node().is_continuable())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1891,
          "old_api": "stop_all_jobs",
          "new_api": null,
          "old_text": "stop_all_jobs()",
          "new_text": null,
          "old_line_content": "    stop_all_jobs();",
          "new_line_content": "    if (m_default_constructed)",
          "content_same": false
        },
        {
          "line": 1895,
          "old_api": "get_history_path",
          "new_api": null,
          "old_text": "get_history_path()",
          "new_text": null,
          "old_line_content": "    m_editor->save_history(get_history_path());",
          "new_line_content": "    if (!m_is_interactive)",
          "content_same": false
        },
        {
          "line": 1900,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "jobs.is_empty()",
          "new_text": null,
          "old_line_content": "    if (!jobs.is_empty()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1902,
          "old_api": "printf",
          "new_api": null,
          "old_text": "printf(\"Killing active jobs\\n\")",
          "new_text": null,
          "old_line_content": "            printf(\"Killing active jobs\\n\");",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1904,
          "old_api": "is_suspended",
          "new_api": null,
          "old_text": "entry.value->is_suspended()",
          "new_text": null,
          "old_line_content": "            if (entry.value->is_suspended()) {",
          "new_line_content": "        if (m_is_interactive && !m_is_subshell)",
          "content_same": false
        },
        {
          "line": 1906,
          "old_api": "kill_job",
          "new_api": null,
          "old_text": "kill_job(entry.value, SIGCONT)",
          "new_text": null,
          "old_line_content": "                kill_job(entry.value, SIGCONT);",
          "new_line_content": "        for (auto& entry : jobs) {",
          "content_same": false
        },
        {
          "line": 1916,
          "old_api": "kill_job",
          "new_api": null,
          "old_text": "kill_job(entry.value, SIGKILL)",
          "new_text": null,
          "old_line_content": "            kill_job(entry.value, SIGKILL);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1927,
          "old_api": "job_id",
          "new_api": null,
          "old_text": "entry.value->job_id()",
          "new_text": null,
          "old_line_content": "        if (entry.value->job_id() > job_id)",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1928,
          "old_api": "job_id",
          "new_api": null,
          "old_text": "entry.value->job_id()",
          "new_text": null,
          "old_line_content": "            job_id = entry.value->job_id();",
          "new_line_content": "    u64 job_id = 0;",
          "content_same": false
        },
        {
          "line": 1937,
          "old_api": "static_cast<int>(id)",
          "new_api": null,
          "old_text": "static_cast<int>(id)",
          "new_text": null,
          "old_line_content": "            if (entry.value->pid() == static_cast<int>(id))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1952,
          "old_api": "pgid",
          "new_api": null,
          "old_text": "job->pgid()",
          "new_text": null,
          "old_line_content": "    if (killpg(job->pgid(), sig) < 0) {",
          "new_line_content": "    if (!job)",
          "content_same": false
        },
        {
          "line": 1953,
          "old_api": "pid",
          "new_api": null,
          "old_text": "job->pid()",
          "new_text": null,
          "old_line_content": "        if (kill(job->pid(), sig) < 0) {",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 1962,
          "old_api": "Core::Object::save_to(object)",
          "new_api": null,
          "old_text": "Core::Object::save_to(object)",
          "new_text": null,
          "old_line_content": "    Core::Object::save_to(object);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1963,
          "old_api": "set",
          "new_api": null,
          "old_text": "object.set(\"working_directory\", cwd)",
          "new_text": null,
          "old_line_content": "    object.set(\"working_directory\", cwd);",
          "new_line_content": "void Shell::save_to(JsonObject& object)",
          "content_same": false
        },
        {
          "line": 1964,
          "old_api": "set",
          "new_api": null,
          "old_text": "object.set(\"username\", username)",
          "new_text": null,
          "old_line_content": "    object.set(\"username\", username);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1974,
          "old_api": "pid",
          "new_api": null,
          "old_text": "job_entry.value->pid()",
          "new_text": null,
          "old_line_content": "        job_object.set(\"pid\", job_entry.value->pid());",
          "new_line_content": "    JsonArray job_objects;",
          "content_same": false
        },
        {
          "line": 1975,
          "old_api": "pgid",
          "new_api": null,
          "old_text": "job_entry.value->pgid()",
          "new_text": null,
          "old_line_content": "        job_object.set(\"pgid\", job_entry.value->pgid());",
          "new_line_content": "    for (auto& job_entry : jobs) {",
          "content_same": false
        },
        {
          "line": 1976,
          "old_api": "elapsed",
          "new_api": null,
          "old_text": "job_entry.value->timer().elapsed()",
          "new_text": null,
          "old_line_content": "        job_object.set(\"running_time\", job_entry.value->timer().elapsed());",
          "new_line_content": "        JsonObject job_object;",
          "content_same": false
        },
        {
          "line": 1988,
          "old_api": "warnln",
          "new_api": null,
          "old_text": "warnln(\"Shell Syntax Error: {}\", m_error_description)",
          "new_text": null,
          "old_line_content": "        warnln(\"Shell Syntax Error: {}\", m_error_description);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 1993,
          "old_api": "warnln",
          "new_api": null,
          "old_text": "warnln(\"Shell: {}\", m_error_description)",
          "new_text": null,
          "old_line_content": "        warnln(\"Shell: {}\", m_error_description);",
          "new_line_content": "    case ShellError::InvalidSliceContentsError:",
          "content_same": false
        },
        {
          "line": 2008,
          "old_api": "has_value",
          "new_api": null,
          "old_text": "m_source_position->position.has_value()",
          "new_text": null,
          "old_line_content": "    if (m_source_position.has_value() && m_source_position->position.has_value()) {",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 2009,
          "old_api": "value",
          "new_api": null,
          "old_text": "m_source_position.value()",
          "new_text": null,
          "old_line_content": "        auto& source_position = m_source_position.value();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 2014,
          "old_api": "warn",
          "new_api": null,
          "old_text": "warn(\"\\x1b[31m\")",
          "new_text": null,
          "old_line_content": "                warn(\"\\x1b[31m\");",
          "new_line_content": "            auto is_in_range = line >= (i64)source_position.position->start_line.line_number && line <= (i64)source_position.position->end_line.line_number;",
          "content_same": false
        },
        {
          "line": 2028,
          "old_api": "warnln",
          "new_api": null,
          "old_text": "warnln(\"\\x1b[0m\")",
          "new_text": null,
          "old_line_content": "                warnln(\"\\x1b[0m\");",
          "new_line_content": "                } else {",
          "content_same": false
        },
        {
          "line": 2033,
          "old_api": "max",
          "new_api": null,
          "old_text": "max(source_position.position->start_line.line_number, 2ul)",
          "new_text": null,
          "old_line_content": "        i64 line_to_skip_to = max(source_position.position->start_line.line_number, 2ul) - 2;",
          "new_line_content": "        };",
          "content_same": false
        },
        {
          "line": 2035,
          "old_api": "is_null",
          "new_api": null,
          "old_text": "source_position.source_file.is_null()",
          "new_text": null,
          "old_line_content": "        if (!source_position.source_file.is_null()) {",
          "new_line_content": "        String current_line;",
          "content_same": false
        },
        {
          "line": 2037,
          "old_api": "is_error",
          "new_api": null,
          "old_text": "file.is_error()",
          "new_text": null,
          "old_line_content": "            if (file.is_error()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 2042,
          "old_api": "value",
          "new_api": null,
          "old_text": "file.value()->eof()",
          "new_text": null,
          "old_line_content": "                if (file.value()->eof())",
          "new_line_content": "                return;",
          "content_same": false
        },
        {
          "line": 2044,
          "old_api": "value",
          "new_api": null,
          "old_text": "file.value()->read_line()",
          "new_text": null,
          "old_line_content": "                current_line = file.value()->read_line();",
          "new_line_content": "            while (line < line_to_skip_to) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 52,
      "total_additions": 114,
      "total_deletions": 113,
      "total_api_changes": 279
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 279,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          1665,
          1663
        ]
      }
    },
    "api_calls_before": 910,
    "api_calls_after": 912,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 2,
      "total_diff_lines": 19
    }
  }
}