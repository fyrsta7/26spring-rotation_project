{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/e9b9527440f008f653ac2a2b7bc04a6abcb2bd74",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/e9b9527440f008f653ac2a2b7bc04a6abcb2bd74/before.h",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/e9b9527440f008f653ac2a2b7bc04a6abcb2bd74/after.h",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/e9b9527440f008f653ac2a2b7bc04a6abcb2bd74/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 326,
          "old_api": "ize",
          "new_api": "ove",
          "old_text": "ize())",
          "new_text": "ove(spans) ",
          "old_line_content": "        if (other.size() != size())",
          "new_line_content": "        return DisjointSpans<T, Vector<Span<T>, InlineSize>> { move(spans) };",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": "nd",
          "new_api": "ize",
          "old_text": "nd();",
          "new_text": "ize())",
          "old_line_content": "        for (; it != end(); ++it, ++other_it) {",
          "new_line_content": "        if (other.size() != size())",
          "content_same": false
        },
        {
          "line": 358,
          "old_api": "etail::shatter_chunk<T>(chunk, start, sliced_length);",
          "new_api": "size",
          "old_text": "etail::shatter_chunk<T>(chunk, start, sliced_length);",
          "new_text": "hunk.size())",
          "old_line_content": "                auto new_chunk = Detail::shatter_chunk<T>(chunk, start, sliced_length);",
          "new_line_content": "            if (start == 0 && sliced_length == chunk.size()) {",
          "content_same": false
        },
        {
          "line": 377,
          "old_api": "is_empty",
          "new_api": "ize",
          "old_text": "_chunks.is_empty())",
          "new_text": "ize() ",
          "old_line_content": "        if (m_chunks.is_empty())",
          "new_line_content": "    DisjointChunks slice(size_t start) && { return move(*this).slice(start, size() - start); }",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": "ensure_capacity",
          "new_api": "is_empty",
          "old_text": "irst_chunk.ensure_capacity(size);",
          "new_text": "_chunks.is_empty())",
          "old_line_content": "        first_chunk.ensure_capacity(size);",
          "new_line_content": "        if (m_chunks.is_empty())",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 385,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "his->size();",
          "old_line_content": "            if (first) {",
          "new_line_content": "        auto size = this->size();",
          "content_same": false
        },
        {
          "line": 386,
          "old_api": null,
          "new_api": "first",
          "old_text": null,
          "new_text": "_chunks.first();",
          "old_line_content": "                first = false;",
          "new_line_content": "        auto& first_chunk = m_chunks.first();",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": null,
          "new_api": "ensure_capacity",
          "old_text": null,
          "new_text": "irst_chunk.ensure_capacity(size);",
          "old_line_content": "                continue;",
          "new_line_content": "        first_chunk.ensure_capacity(size);",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": null,
          "new_api": "ove",
          "old_text": null,
          "new_text": "ove(chunk))",
          "old_line_content": "    DisjointIterator<ChunkType, false> begin() { return { m_chunks }; }",
          "new_line_content": "            first_chunk.extend(move(chunk));",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "_chunks.size() ",
          "old_line_content": "    DisjointIterator<ChunkType, true> begin() const { return { m_chunks }; }",
          "new_line_content": "        m_chunks.remove(1, m_chunks.size() - 1);",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": null,
          "new_api": "is_empty",
          "old_text": null,
          "new_text": "hunk.is_empty())",
          "old_line_content": "                continue;",
          "new_line_content": "            if (chunk.is_empty())",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "hunk.size() ",
          "old_line_content": "",
          "new_line_content": "            auto next_offset = chunk.size() + offset;",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": null,
          "new_api": "last",
          "old_text": null,
          "new_text": "_chunks.last().size())",
          "old_line_content": "",
          "new_line_content": "        return { &m_chunks.last(), index - (offset - m_chunks.last().size()) };",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "_chunks.size() ",
          "old_line_content": "        for (auto& chunk : m_chunks)",
          "new_line_content": "        if (m_chunks.size() == 1) {",
          "content_same": false
        },
        {
          "line": 325,
          "old_api": null,
          "new_api": "span",
          "old_text": null,
          "new_text": "onst_cast<ChunkType&>(chunk).span())",
          "old_line_content": "    {",
          "new_line_content": "            spans.unchecked_append(const_cast<ChunkType&>(chunk).span());",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": null,
          "new_api": "egin",
          "old_text": null,
          "new_text": "egin();",
          "old_line_content": "        }",
          "new_line_content": "        auto it = begin();",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": null,
          "new_api": "begin",
          "old_text": null,
          "new_text": "ther.begin();",
          "old_line_content": "        return true;",
          "new_line_content": "        auto other_it = other.begin();",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": null,
          "new_api": "nd",
          "old_text": null,
          "new_text": "nd();",
          "old_line_content": "    }",
          "new_line_content": "        for (; it != end(); ++it, ++other_it) {",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": null,
          "new_api": "slice",
          "old_text": null,
          "new_text": "ove(*this).slice(start, length);",
          "old_line_content": "        DisjointChunks result;",
          "new_line_content": "    DisjointChunks release_slice(size_t start, size_t length) & { return move(*this).slice(start, length); }",
          "content_same": false
        },
        {
          "line": 344,
          "old_api": null,
          "new_api": "slice",
          "old_text": null,
          "new_text": "ove(*this).slice(start);",
          "old_line_content": "        for (auto& chunk : m_chunks) {",
          "new_line_content": "    DisjointChunks release_slice(size_t start) & { return move(*this).slice(start); }",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "hunk.size() ",
          "old_line_content": "                // Shatter the chunk, we were asked for only a part of it :(",
          "new_line_content": "            auto sliced_length = min(length, chunk.size() - start);",
          "content_same": false
        },
        {
          "line": 363,
          "old_api": null,
          "new_api": "etail::shatter_chunk<T>(chunk, start, sliced_length);",
          "old_text": null,
          "new_text": "etail::shatter_chunk<T>(chunk, start, sliced_length);",
          "old_line_content": "            length -= sliced_length;",
          "new_line_content": "                auto new_chunk = Detail::shatter_chunk<T>(chunk, start, sliced_length);",
          "content_same": false
        },
        {
          "line": 365,
          "old_api": null,
          "new_api": "ove",
          "old_text": null,
          "new_text": "ove(new_chunk))",
          "old_line_content": "",
          "new_line_content": "                result.m_chunks.append(move(new_chunk));",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": null,
          "new_api": "is_empty",
          "old_text": null,
          "new_text": "hunk.is_empty();",
          "old_line_content": "    }",
          "new_line_content": "        m_chunks.remove_all_matching([](auto& chunk) { return chunk.is_empty(); });",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": null,
          "new_api": "ERIFY",
          "old_text": null,
          "new_text": "ERIFY(length == 0);",
          "old_line_content": "",
          "new_line_content": "        VERIFY(length == 0);",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": null,
          "new_api": "ize",
          "old_text": null,
          "new_text": "ize() ",
          "old_line_content": "            return;",
          "new_line_content": "    DisjointChunks slice_from_end(size_t length) && { return move(*this).slice(size() - length, length); }",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 355,
          "old_api": "ove",
          "new_api": null,
          "old_text": "ove(chunk))",
          "new_text": null,
          "old_line_content": "                result.m_chunks.append(move(chunk));",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": "ove",
          "new_api": null,
          "old_text": "ove(chunk))",
          "new_text": null,
          "old_line_content": "            first_chunk.extend(move(chunk));",
          "new_line_content": "            if (first) {",
          "content_same": false
        },
        {
          "line": 423,
          "old_api": "last",
          "new_api": null,
          "old_text": "_chunks.last().size())",
          "new_text": null,
          "old_line_content": "        return { &m_chunks.last(), index - (offset - m_chunks.last().size()) };",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": "size",
          "new_api": null,
          "old_text": "_chunks.size() ",
          "new_text": null,
          "old_line_content": "        m_chunks.remove(1, m_chunks.size() - 1);",
          "new_line_content": "                continue;",
          "content_same": false
        },
        {
          "line": 329,
          "old_api": "egin",
          "new_api": null,
          "old_text": "egin();",
          "new_text": null,
          "old_line_content": "        auto it = begin();",
          "new_line_content": "    bool operator==(DisjointChunks const& other) const",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": "begin",
          "new_api": null,
          "old_text": "ther.begin();",
          "new_text": null,
          "old_line_content": "        auto other_it = other.begin();",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 366,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "hunk.is_empty();",
          "new_text": null,
          "old_line_content": "        m_chunks.remove_all_matching([](auto& chunk) { return chunk.is_empty(); });",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": "ERIFY",
          "new_api": null,
          "old_text": "ERIFY(length == 0);",
          "new_text": null,
          "old_line_content": "        VERIFY(length == 0);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 338,
          "old_api": "slice",
          "new_api": null,
          "old_text": "ove(*this).slice(start, length);",
          "new_text": null,
          "old_line_content": "    DisjointChunks release_slice(size_t start, size_t length) & { return move(*this).slice(start, length); }",
          "new_line_content": "                return false;",
          "content_same": false
        },
        {
          "line": 339,
          "old_api": "slice",
          "new_api": null,
          "old_text": "ove(*this).slice(start);",
          "new_text": null,
          "old_line_content": "    DisjointChunks release_slice(size_t start) & { return move(*this).slice(start); }",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": "ize",
          "new_api": null,
          "old_text": "ize() ",
          "new_text": null,
          "old_line_content": "    DisjointChunks slice(size_t start) && { return move(*this).slice(start, size() - start); }",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": "ize",
          "new_api": null,
          "old_text": "ize() ",
          "new_text": null,
          "old_line_content": "    DisjointChunks slice_from_end(size_t length) && { return move(*this).slice(size() - length, length); }",
          "new_line_content": "        // Make sure that we weren't asked to make a slice larger than possible.",
          "content_same": false
        },
        {
          "line": 407,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "_chunks.is_empty())",
          "new_text": null,
          "old_line_content": "        if (m_chunks.is_empty())",
          "new_line_content": "        ChunkType* chunk;",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": "size",
          "new_api": null,
          "old_text": "his->size();",
          "new_text": null,
          "old_line_content": "        auto size = this->size();",
          "new_line_content": "    void flatten()",
          "content_same": false
        },
        {
          "line": 347,
          "old_api": "size",
          "new_api": null,
          "old_text": "hunk.size())",
          "new_text": null,
          "old_line_content": "            if (start >= chunk.size()) {",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": "size",
          "new_api": null,
          "old_text": "hunk.size();",
          "new_text": null,
          "old_line_content": "                start -= chunk.size();",
          "new_line_content": "        DisjointChunks result;",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": "first",
          "new_api": null,
          "old_text": "_chunks.first();",
          "new_text": null,
          "old_line_content": "        auto& first_chunk = m_chunks.first();",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": "size",
          "new_api": null,
          "old_text": "hunk.size() ",
          "new_text": null,
          "old_line_content": "            auto next_offset = chunk.size() + offset;",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 5,
      "total_additions": 21,
      "total_deletions": 18,
      "total_api_changes": 44
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 5,
        "api_related_lines": 44,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          320,
          321,
          322,
          323
        ]
      }
    },
    "api_calls_before": 159,
    "api_calls_after": 164,
    "diff_info": {
      "added_lines": 5,
      "removed_lines": 0,
      "total_diff_lines": 17
    }
  }
}