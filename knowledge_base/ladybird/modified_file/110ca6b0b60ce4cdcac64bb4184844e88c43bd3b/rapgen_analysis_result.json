{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/110ca6b0b60ce4cdcac64bb4184844e88c43bd3b",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/110ca6b0b60ce4cdcac64bb4184844e88c43bd3b/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/110ca6b0b60ce4cdcac64bb4184844e88c43bd3b/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/110ca6b0b60ce4cdcac64bb4184844e88c43bd3b/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 165,
          "old_api": "at",
          "new_api": "size",
          "old_text": "m_scope_stack.at(i)",
          "new_text": "m_scope_stack.size()",
          "old_line_content": "        auto& scope = m_scope_stack.at(i);",
          "new_line_content": "    for (ssize_t i = m_scope_stack.size() - 1; i >= 0; --i) {",
          "content_same": false
        },
        {
          "line": 166,
          "old_api": "get",
          "new_api": "at",
          "old_text": "scope.variables.get(name)",
          "new_text": "m_scope_stack.at(i)",
          "old_line_content": "        auto value = scope.variables.get(name);",
          "new_line_content": "        auto& scope = m_scope_stack.at(i);",
          "content_same": false
        },
        {
          "line": 167,
          "old_api": "has_value",
          "new_api": "get",
          "old_text": "value.has_value()",
          "new_text": "scope.variables.get(name)",
          "old_line_content": "        if (value.has_value())",
          "new_line_content": "        auto value = scope.variables.get(name);",
          "content_same": false
        },
        {
          "line": 168,
          "old_api": "value",
          "new_api": "has_value",
          "old_text": "value.value()",
          "new_text": "value.has_value()",
          "old_line_content": "            return value.value().value;",
          "new_line_content": "        if (value.has_value())",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": "as_cell",
          "new_api": "is_cell",
          "old_text": "m_last_value.as_cell()",
          "new_text": "m_last_value.is_cell()",
          "old_line_content": "        roots.set(m_last_value.as_cell());",
          "new_line_content": "    if (m_last_value.is_cell())",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "as_cell",
          "new_api": "is_cell",
          "old_text": "it.value.value.as_cell()",
          "new_text": "it.value.value.is_cell()",
          "old_line_content": "                roots.set(it.value.value.as_cell());",
          "new_line_content": "            if (it.value.value.is_cell())",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": "as_cell",
          "new_api": "is_cell",
          "old_text": "call_frame.this_value.as_cell()",
          "new_text": "call_frame.this_value.is_cell()",
          "old_line_content": "            roots.set(call_frame.this_value.as_cell());",
          "new_line_content": "        if (call_frame.this_value.is_cell())",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": "as_cell",
          "new_api": "is_cell",
          "old_text": "argument.as_cell()",
          "new_text": "argument.is_cell()",
          "old_line_content": "                roots.set(argument.as_cell());",
          "new_line_content": "            if (argument.is_cell())",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": "name",
          "new_api": "push_call_frame",
          "old_text": "function->name()",
          "new_text": "push_call_frame()",
          "old_line_content": "    call_frame.function_name = function->name();",
          "new_line_content": "    auto& call_frame = push_call_frame();",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "pop_call_frame",
          "new_api": "call",
          "old_text": "pop_call_frame()",
          "new_text": "function->call(*this)",
          "old_line_content": "    pop_call_frame();",
          "new_line_content": "    auto result = function->call(*this);",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": "message",
          "new_api": "as_object",
          "old_text": "error.message()",
          "new_text": "exception->value().as_object()",
          "old_line_content": "        dbg() << \"Throwing JavaScript Error: \" << error.name() << \", \" << error.message();",
          "new_line_content": "        auto& error = static_cast<Error&>(exception->value().as_object());",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 192,
          "old_api": null,
          "new_api": "as_cell",
          "old_text": null,
          "new_text": "it.value.value.as_cell()",
          "old_line_content": "        }",
          "new_line_content": "                roots.set(it.value.value.as_cell());",
          "content_same": false
        },
        {
          "line": 224,
          "old_api": null,
          "new_api": "unwind",
          "old_text": null,
          "new_text": "unwind(ScopeType::Try)",
          "old_line_content": "    return {};",
          "new_line_content": "    unwind(ScopeType::Try);",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": null,
          "new_api": "this_value",
          "old_text": null,
          "new_text": "this_value()",
          "old_line_content": "",
          "new_line_content": "        return this_value();",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": null,
          "new_api": "as_cell",
          "old_text": null,
          "new_text": "call_frame.this_value.as_cell()",
          "old_line_content": "        for (auto& argument : call_frame.arguments) {",
          "new_line_content": "            roots.set(call_frame.this_value.as_cell());",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": null,
          "new_api": "static_cast<GlobalObject&>(*m_global_object)",
          "old_text": null,
          "new_text": "static_cast<GlobalObject&>(*m_global_object)",
          "old_line_content": "}",
          "new_line_content": "    return static_cast<GlobalObject&>(*m_global_object);",
          "content_same": false
        },
        {
          "line": 169,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "value.value()",
          "old_line_content": "    }",
          "new_line_content": "            return value.value().value;",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": null,
          "new_api": "as_cell",
          "old_text": null,
          "new_text": "argument.as_cell()",
          "old_line_content": "        }",
          "new_line_content": "                roots.set(argument.as_cell());",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": null,
          "new_api": "static_cast<const GlobalObject&>(*m_global_object)",
          "old_text": null,
          "new_text": "static_cast<const GlobalObject&>(*m_global_object)",
          "old_line_content": "}",
          "new_line_content": "    return static_cast<const GlobalObject&>(*m_global_object);",
          "content_same": false
        },
        {
          "line": 172,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "global_object().get(name)",
          "old_line_content": "}",
          "new_line_content": "    return global_object().get(name);",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": null,
          "new_api": "name",
          "old_text": null,
          "new_text": "function->name()",
          "old_line_content": "    call_frame.this_value = this_value;",
          "new_line_content": "    call_frame.function_name = function->name();",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": null,
          "new_api": "set",
          "old_text": null,
          "new_text": "roots.set(m_exception)",
          "old_line_content": "",
          "new_line_content": "    roots.set(m_exception);",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": null,
          "new_api": "pop_call_frame",
          "old_text": null,
          "new_text": "pop_call_frame()",
          "old_line_content": "    return result;",
          "new_line_content": "    pop_call_frame();",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": null,
          "new_api": "as_cell",
          "old_text": null,
          "new_text": "m_last_value.as_cell()",
          "old_line_content": "",
          "new_line_content": "        roots.set(m_last_value.as_cell());",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": null,
          "new_api": "message",
          "old_text": null,
          "new_text": "error.message()",
          "old_line_content": "    }",
          "new_line_content": "        dbg() << \"Throwing JavaScript Error: \" << error.name() << \", \" << error.message();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 162,
          "old_api": "this_value",
          "new_api": null,
          "old_text": "this_value()",
          "new_text": null,
          "old_line_content": "        return this_value();",
          "new_line_content": "    if (name == this_name)",
          "content_same": false
        },
        {
          "line": 164,
          "old_api": "size",
          "new_api": null,
          "old_text": "m_scope_stack.size()",
          "new_text": null,
          "old_line_content": "    for (ssize_t i = m_scope_stack.size() - 1; i >= 0; --i) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": "is_cell",
          "new_api": null,
          "old_text": "call_frame.this_value.is_cell()",
          "new_text": null,
          "old_line_content": "        if (call_frame.this_value.is_cell())",
          "new_line_content": "    for (auto& call_frame : m_call_stack) {",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": "static_cast<GlobalObject&>(*m_global_object)",
          "new_api": null,
          "old_text": "static_cast<GlobalObject&>(*m_global_object)",
          "new_text": null,
          "old_line_content": "    return static_cast<GlobalObject&>(*m_global_object);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": "is_cell",
          "new_api": null,
          "old_text": "argument.is_cell()",
          "new_text": null,
          "old_line_content": "            if (argument.is_cell())",
          "new_line_content": "        for (auto& argument : call_frame.arguments) {",
          "content_same": false
        },
        {
          "line": 234,
          "old_api": "static_cast<const GlobalObject&>(*m_global_object)",
          "new_api": null,
          "old_text": "static_cast<const GlobalObject&>(*m_global_object)",
          "new_text": null,
          "old_line_content": "    return static_cast<const GlobalObject&>(*m_global_object);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 171,
          "old_api": "get",
          "new_api": null,
          "old_text": "global_object().get(name)",
          "new_text": null,
          "old_line_content": "    return global_object().get(name);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": "push_call_frame",
          "new_api": null,
          "old_text": "push_call_frame()",
          "new_text": null,
          "old_line_content": "    auto& call_frame = push_call_frame();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": "set",
          "new_api": null,
          "old_text": "roots.set(m_empty_object_shape)",
          "new_text": null,
          "old_line_content": "    roots.set(m_empty_object_shape);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "call",
          "new_api": null,
          "old_text": "function->call(*this)",
          "new_text": null,
          "old_line_content": "    auto result = function->call(*this);",
          "new_line_content": "    call_frame.arguments = arguments;",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": "is_cell",
          "new_api": null,
          "old_text": "m_last_value.is_cell()",
          "new_text": null,
          "old_line_content": "    if (m_last_value.is_cell())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 218,
          "old_api": "as_object",
          "new_api": null,
          "old_text": "exception->value().as_object().is_error()",
          "new_text": null,
          "old_line_content": "    if (exception->value().is_object() && exception->value().as_object().is_error()) {",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": "is_cell",
          "new_api": null,
          "old_text": "it.value.value.is_cell()",
          "new_text": null,
          "old_line_content": "            if (it.value.value.is_cell())",
          "new_line_content": "        for (auto& it : scope.variables) {",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": "unwind",
          "new_api": null,
          "old_text": "unwind(ScopeType::Try)",
          "new_text": null,
          "old_line_content": "    unwind(ScopeType::Try);",
          "new_line_content": "    m_exception = exception;",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 11,
      "total_additions": 14,
      "total_deletions": 14,
      "total_api_changes": 39
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 39,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          161
        ]
      }
    },
    "api_calls_before": 100,
    "api_calls_after": 100,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 1,
      "total_diff_lines": 15
    }
  }
}