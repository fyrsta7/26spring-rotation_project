{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/3d78f86a2f738f2e4dd8d6bc98bb368a357e7d06",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/3d78f86a2f738f2e4dd8d6bc98bb368a357e7d06/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/3d78f86a2f738f2e4dd8d6bc98bb368a357e7d06/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/3d78f86a2f738f2e4dd8d6bc98bb368a357e7d06/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 71,
          "old_api": "is_filtered",
          "new_api": "scheme",
          "old_text": "ntentFilter::the().is_filtered(url)) ",
          "new_text": "l.scheme().is_one_of(\"file\"sv, \"data\"sv))\n",
          "old_line_content": "    if (ContentFilter::the().is_filtered(url)) {",
          "new_line_content": "    if (url.scheme().is_one_of(\"file\"sv, \"data\"sv))",
          "content_same": false
        },
        {
          "line": 84,
          "old_api": "is_filtered",
          "new_api": "scheme",
          "old_text": "ntentFilter::the().is_filtered(url)) ",
          "new_text": "l.scheme().is_one_of(\"file\"sv, \"data\"sv))\n",
          "old_line_content": "    if (ContentFilter::the().is_filtered(url)) {",
          "new_line_content": "    if (url.scheme().is_one_of(\"file\"sv, \"data\"sv))",
          "content_same": false
        },
        {
          "line": 99,
          "old_api": "url",
          "new_api": "is_valid",
          "old_text": "quest.url().scheme() !",
          "new_text": "quest.is_valid())\n",
          "old_line_content": "    bool use_cache = request.url().scheme() != \"file\";",
          "new_line_content": "    if (!request.is_valid())",
          "content_same": false
        },
        {
          "line": 102,
          "old_api": "find",
          "new_api": "url",
          "old_text": "resource_cache.find(request);\n",
          "new_text": "quest.url().scheme() !",
          "old_line_content": "        auto it = s_resource_cache.find(request);",
          "new_line_content": "    bool use_cache = request.url().scheme() != \"file\";",
          "content_same": false
        },
        {
          "line": 105,
          "old_api": "url",
          "new_api": "find",
          "old_text": "quest.url());",
          "new_text": "resource_cache.find(request);\n",
          "old_line_content": "                dbgln(\"FIXME: Not using cached resource for {} since there's a type mismatch.\", request.url());",
          "new_line_content": "        auto it = s_resource_cache.find(request);",
          "content_same": false
        },
        {
          "line": 107,
          "old_api": "url",
          "new_api": "type",
          "old_text": "quest.url());",
          "new_text": "->value->type() !",
          "old_line_content": "                dbgln_if(CACHE_DEBUG, \"Reusing cached resource for: {}\", request.url());",
          "new_line_content": "            if (it->value->type() != type) {",
          "content_same": false
        },
        {
          "line": 116,
          "old_api": "set",
          "new_api": "source::create({}, type, request);",
          "old_text": "resource_cache.set(request, resource);\n",
          "new_text": "source::create({}, type, request);\n",
          "old_line_content": "        s_resource_cache.set(request, resource);",
          "new_line_content": "    auto resource = Resource::create({}, type, request);",
          "content_same": false
        },
        {
          "line": 124,
          "old_api": "did_fail",
          "new_api": "did_load",
          "old_text": "nst_cast<Resource&>(*resource).did_fail({}, error, status_code);\n",
          "new_text": "nst_cast<Resource&>(*resource).did_load({}, data, headers, status_code);\n",
          "old_line_content": "            const_cast<Resource&>(*resource).did_fail({}, error, status_code);",
          "new_line_content": "            const_cast<Resource&>(*resource).did_load({}, data, headers, status_code);",
          "content_same": false
        },
        {
          "line": 153,
          "old_api": "as_array",
          "new_api": "onValue::from_string(cookies));",
          "old_text": "t_cookie_json_value.as_array().values()) ",
          "new_text": "onValue::from_string(cookies));",
          "old_line_content": "    for (auto const& set_cookie_entry : set_cookie_json_value.as_array().values()) {",
          "new_line_content": "    auto set_cookie_json_value = MUST(JsonValue::from_string(cookies));",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": "as_string",
          "new_api": "as_array",
          "old_text": "t_cookie_entry.as_string());",
          "new_text": "t_cookie_json_value.as_array().values()) ",
          "old_line_content": "        auto cookie = Cookie::parse_cookie(set_cookie_entry.as_string());",
          "new_line_content": "    for (auto const& set_cookie_entry : set_cookie_json_value.as_array().values()) {",
          "content_same": false
        },
        {
          "line": 157,
          "old_api": "has_value",
          "new_api": "type",
          "old_text": "okie.has_value())\n",
          "new_text": "t_cookie_entry.type() =",
          "old_line_content": "        if (!cookie.has_value())",
          "new_line_content": "        VERIFY(set_cookie_entry.type() == JsonValue::Type::String);",
          "content_same": false
        },
        {
          "line": 160,
          "old_api": "value",
          "new_api": "has_value",
          "old_text": "okie.value(), ",
          "new_text": "okie.has_value())\n",
          "old_line_content": "        page.client().page_did_set_cookie(url, cookie.value(), Cookie::Source::Http); // FIXME: Determine cookie source correctly",
          "new_line_content": "        if (!cookie.has_value())",
          "content_same": false
        },
        {
          "line": 173,
          "old_api": "set",
          "new_api": "re::guess_mime_type_based_on_filename(path);",
          "old_text": "sponse_headers.set(\"Content-Type\"sv, mime_type);\n",
          "new_text": "re::guess_mime_type_based_on_filename(path);\n",
          "old_line_content": "    response_headers.set(\"Content-Type\"sv, mime_type);",
          "new_line_content": "    auto mime_type = Core::guess_mime_type_based_on_filename(path);",
          "content_same": false
        },
        {
          "line": 184,
          "old_api": "nitized_url_for_logging",
          "new_api": "start_timer",
          "old_text": "nitized_url_for_logging(url);\n",
          "new_text": "quest.start_timer();\n",
          "old_line_content": "    auto url_for_logging = sanitized_url_for_logging(url);",
          "new_line_content": "    request.start_timer();",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": "load_time",
          "new_api": "gln_if",
          "old_text": "quest.load_time().to_milliseconds();\n",
          "new_text": "gln_if(SPAM_DEBUG, \"ResourceLoader: Starting load of: \\\"{}\\\"\", url_for_logging);\n",
          "old_line_content": "        auto load_time_ms = request.load_time().to_milliseconds();",
          "new_line_content": "    dbgln_if(SPAM_DEBUG, \"ResourceLoader: Starting load of: \\\"{}\\\"\", url_for_logging);",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "error",
          "new_api": "is_error",
          "old_text": "ybe_response.error()),",
          "new_text": "ybe_response.is_error()) ",
          "old_line_content": "                error_callback(ByteString::formatted(\"{}\", maybe_response.error()), 500u, {}, {});",
          "new_line_content": "        if (maybe_response.is_error()) {",
          "content_same": false
        },
        {
          "line": 212,
          "old_api": "release_value",
          "new_api": "g_success",
          "old_text": "ybe_response.release_value().bytes(), ",
          "new_text": "g_success(request);\n",
          "old_line_content": "        success_callback(maybe_response.release_value().bytes(), response_headers, {});",
          "new_line_content": "        log_success(request);",
          "content_same": false
        },
        {
          "line": 215,
          "old_api": "port_or_default",
          "new_api": "release_value",
          "old_text": "l.port_or_default()))",
          "new_text": "ybe_response.release_value().bytes(), ",
          "old_line_content": "    if (is_port_blocked(url.port_or_default())) {",
          "new_line_content": "        success_callback(maybe_response.release_value().bytes(), response_headers, {});",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": "ror_callback",
          "new_api": "is_filtered",
          "old_text": "ror_callback(filter_message, {}, {}, {});\n",
          "new_text": "ntentFilter::the().is_filtered(url)) ",
          "old_line_content": "        error_callback(filter_message, {}, {}, {});",
          "new_line_content": "    if (ContentFilter::the().is_filtered(url)) {",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "set",
          "new_api": "g_success",
          "old_text": "sponse_headers.set(\"Content-Type\", \"text/html; charset=UTF-8\");\n",
          "new_text": "g_success(request);\n",
          "old_line_content": "        response_headers.set(\"Content-Type\", \"text/html; charset=UTF-8\");",
          "new_line_content": "        log_success(request);",
          "content_same": false
        },
        {
          "line": 235,
          "old_api": "path_segment_at_index",
          "new_api": "set",
          "old_text": "l.path_segment_at_index(0) =",
          "new_text": "sponse_headers.set(\"Content-Type\", \"text/html; charset=UTF-8\");\n",
          "old_line_content": "        if (url.path_segment_at_index(0) == \"version\") {",
          "new_line_content": "        response_headers.set(\"Content-Type\", \"text/html; charset=UTF-8\");",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": "ccess_callback",
          "new_api": "path_segment_at_index",
          "old_text": "ccess_callback(data, response_headers, {});\n",
          "new_text": "l.path_segment_at_index(0)))",
          "old_line_content": "            success_callback(data, response_headers, {});",
          "new_line_content": "        auto resource = Core::Resource::load_from_uri(MUST(String::formatted(\"resource://ladybird/{}.html\", url.path_segment_at_index(0))));",
          "content_same": false
        },
        {
          "line": 257,
          "old_api": "error",
          "new_api": "scheme",
          "old_text": "ta_url_or_error.error().string_literal();\n",
          "new_text": "l.scheme() =",
          "old_line_content": "            auto error_message = data_url_or_error.error().string_literal();",
          "new_line_content": "    if (url.scheme() == \"data\") {",
          "content_same": false
        },
        {
          "line": 258,
          "old_api": "g_failure",
          "new_api": "tch::Infrastructure::process_data_url(url);",
          "old_text": "g_failure(request, error_message);\n",
          "new_text": "tch::Infrastructure::process_data_url(url);\n",
          "old_line_content": "            log_failure(request, error_message);",
          "new_line_content": "        auto data_url_or_error = Fetch::Infrastructure::process_data_url(url);",
          "content_same": false
        },
        {
          "line": 259,
          "old_api": "ror_callback",
          "new_api": "is_error",
          "old_text": "ror_callback(error_message, {}, {}, {});\n",
          "new_text": "ta_url_or_error.is_error()) ",
          "old_line_content": "            error_callback(error_message, {}, {}, {});",
          "new_line_content": "        if (data_url_or_error.is_error()) {",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": "release_value",
          "new_api": "ror_callback",
          "old_text": "ta_url_or_error.release_value();\n",
          "new_text": "ror_callback(error_message, {}, {}, {});\n",
          "old_line_content": "        auto data_url = data_url_or_error.release_value();",
          "new_line_content": "            error_callback(error_message, {}, {}, {});",
          "content_same": false
        },
        {
          "line": 269,
          "old_api": "to_byte_string",
          "new_api": "bytes",
          "old_text": "ta_url.mime_type.to_byte_string());",
          "new_text": "ta_url.body.bytes()))",
          "old_line_content": "        response_headers.set(\"Content-Type\", data_url.mime_type.to_byte_string());",
          "new_line_content": "            StringView(data_url.body.bytes()));",
          "content_same": false
        },
        {
          "line": 274,
          "old_api": "ccess_callback",
          "new_api": "g_success",
          "old_text": "ccess_callback(data, response_headers, {});\n",
          "new_text": "g_success(request);\n",
          "old_line_content": "            success_callback(data, response_headers, {});",
          "new_line_content": "        log_success(request);",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": "error",
          "new_api": "scheme",
          "old_text": "source.error());",
          "new_text": "l.scheme() =",
          "old_line_content": "            log_failure(request, resource.error());",
          "new_line_content": "    if (url.scheme() == \"resource\") {",
          "content_same": false
        },
        {
          "line": 295,
          "old_api": "g_success",
          "new_api": "value",
          "old_text": "g_success(request);\n",
          "new_text": "source.value()->data();\n",
          "old_line_content": "        log_success(request);",
          "new_line_content": "        auto data = resource.value()->data();",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": "ccess_callback",
          "new_api": "serialize_path",
          "old_text": "ccess_callback(data, response_headers, {});\n",
          "new_text": "l.serialize_path());",
          "old_line_content": "        success_callback(data, response_headers, {});",
          "new_line_content": "        auto response_headers = response_headers_for_file(url.serialize_path());",
          "content_same": false
        },
        {
          "line": 305,
          "old_api": "has_value",
          "new_api": "page",
          "old_text": "page.has_value()) ",
          "new_text": "quest.page())\n",
          "old_line_content": "        if (!m_page.has_value()) {",
          "new_line_content": "        if (request.page())",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": "g_failure",
          "new_api": "page",
          "old_text": "g_failure(request, \"INTERNAL ERROR: No Page for request\");\n",
          "new_text": "quest.page();\n",
          "old_line_content": "            log_failure(request, \"INTERNAL ERROR: No Page for request\");",
          "new_line_content": "            m_page = request.page();",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": "_load_counter_change",
          "new_api": "serialize_path",
          "old_text": "_load_counter_change();\n",
          "new_text": "l.serialize_path(), ",
          "old_line_content": "                on_load_counter_change();",
          "new_line_content": "        FileRequest file_request(url.serialize_path(), [this, success_callback = move(success_callback), error_callback = move(error_callback), log_success, log_failure, request, respond_directory_page](ErrorOr<i32> file_or_error) {",
          "content_same": false
        },
        {
          "line": 316,
          "old_api": "error",
          "new_api": "_load_counter_change",
          "old_text": "le_or_error.error());",
          "new_text": "_load_counter_change();\n",
          "old_line_content": "                log_failure(request, file_or_error.error());",
          "new_line_content": "                on_load_counter_change();",
          "content_same": false
        },
        {
          "line": 318,
          "old_api": "error",
          "new_api": "is_error",
          "old_text": "le_or_error.error().code() =",
          "new_text": "le_or_error.is_error()) ",
          "old_line_content": "                    auto status = file_or_error.error().code() == ENOENT ? 404u : 500u;",
          "new_line_content": "            if (file_or_error.is_error()) {",
          "content_same": false
        },
        {
          "line": 327,
          "old_api": "re::Directory::is_valid_directory(fd);",
          "new_api": "value",
          "old_text": "re::Directory::is_valid_directory(fd);\n",
          "new_text": "le_or_error.value();\n",
          "old_line_content": "            auto maybe_is_valid_directory = Core::Directory::is_valid_directory(fd);",
          "new_line_content": "            auto const fd = file_or_error.value();",
          "content_same": false
        },
        {
          "line": 338,
          "old_api": "error",
          "new_api": "is_error",
          "old_text": "ybe_file.error()),",
          "new_text": "ybe_file.is_error()) ",
          "old_line_content": "                    error_callback(ByteString::formatted(\"{}\", maybe_file.error()), 500u, {}, {});",
          "new_line_content": "            if (maybe_file.is_error()) {",
          "content_same": false
        },
        {
          "line": 345,
          "old_api": "error",
          "new_api": "release_value",
          "old_text": "ybe_data.error());",
          "new_text": "ybe_file.release_value();\n",
          "old_line_content": "                log_failure(request, maybe_data.error());",
          "new_line_content": "            auto file = maybe_file.release_value();",
          "content_same": false
        },
        {
          "line": 347,
          "old_api": "error",
          "new_api": "is_error",
          "old_text": "ybe_data.error()),",
          "new_text": "ybe_data.is_error()) ",
          "old_line_content": "                    error_callback(ByteString::formatted(\"{}\", maybe_data.error()), 500u, {}, {});",
          "new_line_content": "            if (maybe_data.is_error()) {",
          "content_same": false
        },
        {
          "line": 354,
          "old_api": "g_success",
          "new_api": "release_value",
          "old_text": "g_success(request);\n",
          "new_text": "ybe_data.release_value();\n",
          "old_line_content": "            log_success(request);",
          "new_line_content": "            auto data = maybe_data.release_value();",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": "ccess_callback",
          "new_api": "url",
          "old_text": "ccess_callback(data, response_headers, {});\n",
          "new_text": "quest.url().serialize_path());",
          "old_line_content": "            success_callback(data, response_headers, {});",
          "new_line_content": "            auto response_headers = response_headers_for_file(request.url().serialize_path());",
          "content_same": false
        },
        {
          "line": 358,
          "old_api": "ve",
          "new_api": "ccess_callback",
          "old_text": "ve(file_request));",
          "new_text": "ccess_callback(data, response_headers, {});\n",
          "old_line_content": "        (*m_page)->client().request_file(move(file_request));",
          "new_line_content": "            success_callback(data, response_headers, {});",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": "to_byte_string",
          "new_api": "proxy_for_url",
          "old_text": "user_agent.to_byte_string());",
          "new_text": "oxyMappings::the().proxy_for_url(url);\n",
          "old_line_content": "        headers.set(\"User-Agent\", m_user_agent.to_byte_string());",
          "new_line_content": "        auto proxy = ProxyMappings::the().proxy_for_url(url);",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": "headers",
          "new_api": "to_byte_string",
          "old_text": "quest.headers()) ",
          "new_text": "user_agent.to_byte_string());",
          "old_line_content": "        for (auto& it : request.headers()) {",
          "new_line_content": "        headers.set(\"User-Agent\", m_user_agent.to_byte_string());",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": "body",
          "new_api": "set",
          "old_text": "quest.body(), ",
          "new_text": "aders.set(it.key, it.value);\n",
          "old_line_content": "        auto protocol_request = m_connector->start_request(request.method(), url, headers, request.body(), proxy);",
          "new_line_content": "            headers.set(it.key, it.value);",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": "g_failure",
          "new_api": "body",
          "old_text": "g_failure(request, start_request_failure_msg);\n",
          "new_text": "quest.body(), ",
          "old_line_content": "            log_failure(request, start_request_failure_msg);",
          "new_line_content": "        auto protocol_request = m_connector->start_request(request.method(), url, headers, request.body(), proxy);",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": "stop",
          "new_api": "value",
          "old_text": "otocol_request->stop();\n",
          "new_text": "meout.value() >",
          "old_line_content": "                protocol_request->stop();",
          "new_line_content": "        if (timeout.has_value() && timeout.value() > 0) {",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": "set",
          "new_api": "start",
          "old_text": "active_requests.set(*protocol_request);\n",
          "new_text": "mer->start();\n",
          "old_line_content": "        m_active_requests.set(*protocol_request);",
          "new_line_content": "            timer->start();",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": "has_value",
          "new_api": "_load_counter_change",
          "old_text": "t_cookie.has_value())\n",
          "new_text": "_load_counter_change();\n",
          "old_line_content": "                if (auto set_cookie = response_headers.get(\"Set-Cookie\"); set_cookie.has_value())",
          "new_line_content": "                on_load_counter_change();",
          "content_same": false
        },
        {
          "line": 407,
          "old_api": "has_value",
          "new_api": "page",
          "old_text": "che_control.has_value()) ",
          "new_text": "quest.page()) ",
          "old_line_content": "                if (auto cache_control = response_headers.get(\"cache-control\"); cache_control.has_value()) {",
          "new_line_content": "            if (request.page()) {",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": "value",
          "new_api": "has_value",
          "old_text": "che_control.value().contains(\"no-store\"sv)) ",
          "new_text": "t_cookie.has_value())\n",
          "old_line_content": "                    if (cache_control.value().contains(\"no-store\"sv)) {",
          "new_line_content": "                if (auto set_cookie = response_headers.get(\"Set-Cookie\"); set_cookie.has_value())",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": "remove",
          "new_api": "url",
          "old_text": "resource_cache.remove(request);\n",
          "new_text": "quest.url(), ",
          "old_line_content": "                        s_resource_cache.remove(request);",
          "new_line_content": "                    store_response_cookies(*request.page(), request.url(), *set_cookie);",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": "appendff",
          "new_api": "is_main_resource",
          "old_text": "ror_builder.appendff(\"Load failed: {}\", *status_code);\n",
          "new_text": "quest.is_main_resource()))",
          "old_line_content": "                    error_builder.appendff(\"Load failed: {}\", *status_code);",
          "new_line_content": "            if (!success || (status_code.has_value() && *status_code >= 400 && *status_code <= 599 && (payload.is_empty() || !request.is_main_resource()))) {",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": "append",
          "new_api": "has_value",
          "old_text": "ror_builder.append(\"Load failed\"sv);\n",
          "new_text": "atus_code.has_value())\n",
          "old_line_content": "                    error_builder.append(\"Load failed\"sv);",
          "new_line_content": "                if (status_code.has_value())",
          "content_same": false
        },
        {
          "line": 420,
          "old_api": "string_view",
          "new_api": "appendff",
          "old_text": "ror_builder.string_view());",
          "new_text": "ror_builder.appendff(\"Load failed: {}\", *status_code);\n",
          "old_line_content": "                log_failure(request, error_builder.string_view());",
          "new_line_content": "                    error_builder.appendff(\"Load failed: {}\", *status_code);",
          "content_same": false
        },
        {
          "line": 422,
          "old_api": "to_byte_string",
          "new_api": "append",
          "old_text": "ror_builder.to_byte_string(), ",
          "new_text": "ror_builder.append(\"Load failed\"sv);\n",
          "old_line_content": "                    error_callback(error_builder.to_byte_string(), status_code, payload, response_headers);",
          "new_line_content": "                    error_builder.append(\"Load failed\"sv);",
          "content_same": false
        },
        {
          "line": 425,
          "old_api": "g_success",
          "new_api": "to_byte_string",
          "old_text": "g_success(request);\n",
          "new_text": "ror_builder.to_byte_string(), ",
          "old_line_content": "            log_success(request);",
          "new_line_content": "                    error_callback(error_builder.to_byte_string(), status_code, payload, response_headers);",
          "content_same": false
        },
        {
          "line": 428,
          "old_api": "remove",
          "new_api": "g_success",
          "old_text": "active_requests.remove(protocol_request);\n",
          "new_text": "g_success(request);\n",
          "old_line_content": "                m_active_requests.remove(protocol_request);",
          "new_line_content": "            log_success(request);",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": "set_should_buffer_all_input",
          "new_api": "remove",
          "old_text": "otocol_request->set_should_buffer_all_input(true);\n",
          "new_text": "active_requests.remove(protocol_request);\n",
          "old_line_content": "        protocol_request->set_should_buffer_all_input(true);",
          "new_line_content": "                m_active_requests.remove(protocol_request);",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": "ror_callback",
          "new_api": "scheme",
          "old_text": "ror_callback(not_implemented_error, {}, {}, {});\n",
          "new_text": "l.scheme());",
          "old_line_content": "        error_callback(not_implemented_error, {}, {}, {});",
          "new_line_content": "    auto not_implemented_error = ByteString::formatted(\"Protocol not implemented: {}\", url.scheme());",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 74,
          "old_api": null,
          "new_api": "is_filtered",
          "old_text": null,
          "new_text": "ntentFilter::the().is_filtered(url)) ",
          "old_line_content": "    }",
          "new_line_content": "    if (ContentFilter::the().is_filtered(url)) {",
          "content_same": false
        },
        {
          "line": 75,
          "old_api": null,
          "new_api": "gln",
          "old_text": null,
          "new_text": "gln(\"ResourceLoader: Refusing to prefetch DNS for '{}': \\033[31;1mURL was filtered\\033[0m\", url);\n",
          "old_line_content": "",
          "new_line_content": "        dbgln(\"ResourceLoader: Refusing to prefetch DNS for '{}': \\033[31;1mURL was filtered\\033[0m\", url);",
          "content_same": false
        },
        {
          "line": 79,
          "old_api": null,
          "new_api": "prefetch_dns",
          "old_text": null,
          "new_text": "connector->prefetch_dns(url);\n",
          "old_line_content": "void ResourceLoader::preconnect(URL::URL const& url)",
          "new_line_content": "    m_connector->prefetch_dns(url);",
          "content_same": false
        },
        {
          "line": 87,
          "old_api": null,
          "new_api": "is_filtered",
          "old_text": null,
          "new_text": "ntentFilter::the().is_filtered(url)) ",
          "old_line_content": "    }",
          "new_line_content": "    if (ContentFilter::the().is_filtered(url)) {",
          "content_same": false
        },
        {
          "line": 88,
          "old_api": null,
          "new_api": "gln",
          "old_text": null,
          "new_text": "gln(\"ResourceLoader: Refusing to pre-connect to '{}': \\033[31;1mURL was filtered\\033[0m\", url);\n",
          "old_line_content": "",
          "new_line_content": "        dbgln(\"ResourceLoader: Refusing to pre-connect to '{}': \\033[31;1mURL was filtered\\033[0m\", url);",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": null,
          "new_api": "preconnect",
          "old_text": null,
          "new_text": "connector->preconnect(url);\n",
          "old_line_content": "static HashMap<LoadRequest, NonnullRefPtr<Resource>> s_resource_cache;",
          "new_line_content": "    m_connector->preconnect(url);",
          "content_same": false
        },
        {
          "line": 106,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "resource_cache.end()) ",
          "old_line_content": "            } else {",
          "new_line_content": "        if (it != s_resource_cache.end()) {",
          "content_same": false
        },
        {
          "line": 108,
          "old_api": null,
          "new_api": "url",
          "old_text": null,
          "new_text": "quest.url());",
          "old_line_content": "                return it->value;",
          "new_line_content": "                dbgln(\"FIXME: Not using cached resource for {} since there's a type mismatch.\", request.url());",
          "content_same": false
        },
        {
          "line": 110,
          "old_api": null,
          "new_api": "url",
          "old_text": null,
          "new_text": "quest.url());",
          "old_line_content": "        }",
          "new_line_content": "                dbgln_if(CACHE_DEBUG, \"Reusing cached resource for: {}\", request.url());",
          "content_same": false
        },
        {
          "line": 119,
          "old_api": null,
          "new_api": "set",
          "old_text": null,
          "new_text": "resource_cache.set(request, resource);\n",
          "old_line_content": "        request,",
          "new_line_content": "        s_resource_cache.set(request, resource);",
          "content_same": false
        },
        {
          "line": 127,
          "old_api": null,
          "new_api": "did_fail",
          "old_text": null,
          "new_text": "nst_cast<Resource&>(*resource).did_fail({}, error, status_code);\n",
          "old_line_content": "    return resource;",
          "new_line_content": "            const_cast<Resource&>(*resource).did_fail({}, error, status_code);",
          "content_same": false
        },
        {
          "line": 135,
          "old_api": null,
          "new_api": "scheme",
          "old_text": null,
          "new_text": "l.scheme() =",
          "old_line_content": "}",
          "new_line_content": "    if (url.scheme() == \"data\"sv)",
          "content_same": false
        },
        {
          "line": 137,
          "old_api": null,
          "new_api": "to_byte_string",
          "old_text": null,
          "new_text": "l.to_byte_string();\n",
          "old_line_content": "static void emit_signpost(ByteString const& message, int id)",
          "new_line_content": "    return url.to_byte_string();",
          "content_same": false
        },
        {
          "line": 143,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "ssage.length());",
          "old_line_content": "    (void)message;",
          "new_line_content": "    auto string_id = perf_register_string(message.characters(), message.length());",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": null,
          "new_api": "rf_event",
          "old_text": null,
          "new_text": "rf_event(PERF_EVENT_SIGNPOST, string_id, id);\n",
          "old_line_content": "    (void)id;",
          "new_line_content": "    perf_event(PERF_EVENT_SIGNPOST, string_id, id);",
          "content_same": false
        },
        {
          "line": 159,
          "old_api": null,
          "new_api": "as_string",
          "old_text": null,
          "new_text": "t_cookie_entry.as_string());",
          "old_line_content": "",
          "new_line_content": "        auto cookie = Cookie::parse_cookie(set_cookie_entry.as_string());",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "okie.value(), ",
          "old_line_content": "",
          "new_line_content": "        page.client().page_did_set_cookie(url, cookie.value(), Cookie::Source::Http); // FIXME: Determine cookie source correctly",
          "content_same": false
        },
        {
          "line": 176,
          "old_api": null,
          "new_api": "set",
          "old_text": null,
          "new_text": "sponse_headers.set(\"Content-Type\"sv, mime_type);\n",
          "old_line_content": "}",
          "new_line_content": "    response_headers.set(\"Content-Type\"sv, mime_type);",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": null,
          "new_api": "url",
          "old_text": null,
          "new_text": "quest.url();\n",
          "old_line_content": "    auto id = resource_id++;",
          "new_line_content": "    auto& url = request.url();",
          "content_same": false
        },
        {
          "line": 187,
          "old_api": null,
          "new_api": "nitized_url_for_logging",
          "old_text": null,
          "new_text": "nitized_url_for_logging(url);\n",
          "old_line_content": "",
          "new_line_content": "    auto url_for_logging = sanitized_url_for_logging(url);",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": null,
          "new_api": "teString::formatted(\"Starting load: {}\", url_for_logging),",
          "old_text": null,
          "new_text": "teString::formatted(\"Starting load: {}\", url_for_logging), ",
          "old_line_content": "    auto const log_success = [url_for_logging, id](auto const& request) {",
          "new_line_content": "    emit_signpost(ByteString::formatted(\"Starting load: {}\", url_for_logging), id);",
          "content_same": false
        },
        {
          "line": 192,
          "old_api": null,
          "new_api": "load_time",
          "old_text": null,
          "new_text": "quest.load_time().to_milliseconds();\n",
          "old_line_content": "    };",
          "new_line_content": "        auto load_time_ms = request.load_time().to_milliseconds();",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": null,
          "new_api": "teString::formatted(\"Finished load: {}\", url_for_logging),",
          "old_text": null,
          "new_text": "teString::formatted(\"Finished load: {}\", url_for_logging), ",
          "old_line_content": "",
          "new_line_content": "        emit_signpost(ByteString::formatted(\"Finished load: {}\", url_for_logging), id);",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": null,
          "new_api": "gln_if",
          "old_text": null,
          "new_text": "gln_if(SPAM_DEBUG, \"ResourceLoader: Finished load of: \\\"{}\\\", Duration: {}ms\", url_for_logging, load_time_ms);\n",
          "old_line_content": "    auto const log_failure = [url_for_logging, id](auto const& request, auto const& error_message) {",
          "new_line_content": "        dbgln_if(SPAM_DEBUG, \"ResourceLoader: Finished load of: \\\"{}\\\", Duration: {}ms\", url_for_logging, load_time_ms);",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": null,
          "new_api": "load_time",
          "old_text": null,
          "new_text": "quest.load_time().to_milliseconds();\n",
          "old_line_content": "    };",
          "new_line_content": "        auto load_time_ms = request.load_time().to_milliseconds();",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": null,
          "new_api": "teString::formatted(\"Failed load: {}\", url_for_logging),",
          "old_text": null,
          "new_text": "teString::formatted(\"Failed load: {}\", url_for_logging), ",
          "old_line_content": "",
          "new_line_content": "        emit_signpost(ByteString::formatted(\"Failed load: {}\", url_for_logging), id);",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": null,
          "new_api": "gln",
          "old_text": null,
          "new_text": "gln(\"ResourceLoader: Failed load of: \\\"{}\\\", \\033[31;1mError: {}\\033[0m, Duration: {}ms\", url_for_logging, error_message, load_time_ms);\n",
          "old_line_content": "    auto respond_directory_page = [log_success, log_failure](LoadRequest const& request, URL::URL const& url, SuccessCallback const& success_callback, ErrorCallback const& error_callback) {",
          "new_line_content": "        dbgln(\"ResourceLoader: Failed load of: \\\"{}\\\", \\033[31;1mError: {}\\033[0m, Duration: {}ms\", url_for_logging, error_message, load_time_ms);",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": null,
          "new_api": "ad_file_directory_page",
          "old_text": null,
          "new_text": "ad_file_directory_page(url);\n",
          "old_line_content": "            if (error_callback)",
          "new_line_content": "        auto maybe_response = load_file_directory_page(url);",
          "content_same": false
        },
        {
          "line": 206,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "ybe_response.error());",
          "old_line_content": "            return;",
          "new_line_content": "            log_failure(request, maybe_response.error());",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "ybe_response.error()),",
          "old_line_content": "",
          "new_line_content": "                error_callback(ByteString::formatted(\"{}\", maybe_response.error()), 500u, {}, {});",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": null,
          "new_api": "set",
          "old_text": null,
          "new_text": "sponse_headers.set(\"Content-Type\"sv, \"text/html\"sv);\n",
          "old_line_content": "",
          "new_line_content": "        response_headers.set(\"Content-Type\"sv, \"text/html\"sv);",
          "content_same": false
        },
        {
          "line": 218,
          "old_api": null,
          "new_api": "port_or_default",
          "old_text": null,
          "new_text": "l.port_or_default()))",
          "old_line_content": "    }",
          "new_line_content": "    if (is_port_blocked(url.port_or_default())) {",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": null,
          "new_api": "port_or_default",
          "old_text": null,
          "new_text": "l.port_or_default()))",
          "old_line_content": "",
          "new_line_content": "        log_failure(request, ByteString::formatted(\"The port #{} is blocked\", url.port_or_default()));",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": null,
          "new_api": "g_failure",
          "old_text": null,
          "new_text": "g_failure(request, filter_message);\n",
          "old_line_content": "    }",
          "new_line_content": "        log_failure(request, filter_message);",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": null,
          "new_api": "ror_callback",
          "old_text": null,
          "new_text": "ror_callback(filter_message, {}, {}, {});\n",
          "old_line_content": "",
          "new_line_content": "        error_callback(filter_message, {}, {}, {});",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": null,
          "new_api": "scheme",
          "old_text": null,
          "new_text": "l.scheme() =",
          "old_line_content": "",
          "new_line_content": "    if (url.scheme() == \"about\") {",
          "content_same": false
        },
        {
          "line": 231,
          "old_api": null,
          "new_api": "gln_if",
          "old_text": null,
          "new_text": "gln_if(SPAM_DEBUG, \"Loading about: URL {}\", url);\n",
          "old_line_content": "        HashMap<ByteString, ByteString, CaseInsensitiveStringTraits> response_headers;",
          "new_line_content": "        dbgln_if(SPAM_DEBUG, \"Loading about: URL {}\", url);",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": null,
          "new_api": "path_segment_at_index",
          "old_text": null,
          "new_text": "l.path_segment_at_index(0) =",
          "old_line_content": "        }",
          "new_line_content": "        if (url.path_segment_at_index(0) == \"version\") {",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": null,
          "new_api": "ad_about_version_page",
          "old_text": null,
          "new_text": "ad_about_version_page()).",
          "old_line_content": "",
          "new_line_content": "            success_callback(MUST(load_about_version_page()).bytes(), response_headers, {});",
          "content_same": false
        },
        {
          "line": 245,
          "old_api": null,
          "new_api": "is_error",
          "old_text": null,
          "new_text": "source.is_error()) ",
          "old_line_content": "            return;",
          "new_line_content": "        if (!resource.is_error()) {",
          "content_same": false
        },
        {
          "line": 246,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "source.value()->data();\n",
          "old_line_content": "        }",
          "new_line_content": "            auto data = resource.value()->data();",
          "content_same": false
        },
        {
          "line": 247,
          "old_api": null,
          "new_api": "ccess_callback",
          "old_text": null,
          "new_text": "ccess_callback(data, response_headers, {});\n",
          "old_line_content": "",
          "new_line_content": "            success_callback(data, response_headers, {});",
          "content_same": false
        },
        {
          "line": 251,
          "old_api": null,
          "new_api": "deferred_invoke",
          "old_text": null,
          "new_text": "atform::EventLoopPlugin::the().deferred_invoke([success_callback = move(success_callback), response_headers = move(response_headers)] {\n            success_callback(ByteString::empty().to_byte_buffer(), response_headers, {});\n        });\n",
          "old_line_content": "        return;",
          "new_line_content": "        Platform::EventLoopPlugin::the().deferred_invoke([success_callback = move(success_callback), response_headers = move(response_headers)] {",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": null,
          "new_api": "to_byte_buffer",
          "old_text": null,
          "new_text": "teString::empty().to_byte_buffer(), ",
          "old_line_content": "    }",
          "new_line_content": "            success_callback(ByteString::empty().to_byte_buffer(), response_headers, {});",
          "content_same": false
        },
        {
          "line": 260,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "ta_url_or_error.error().string_literal();\n",
          "old_line_content": "            return;",
          "new_line_content": "            auto error_message = data_url_or_error.error().string_literal();",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": null,
          "new_api": "g_failure",
          "old_text": null,
          "new_text": "g_failure(request, error_message);\n",
          "old_line_content": "        }",
          "new_line_content": "            log_failure(request, error_message);",
          "content_same": false
        },
        {
          "line": 265,
          "old_api": null,
          "new_api": "release_value",
          "old_text": null,
          "new_text": "ta_url_or_error.release_value();\n",
          "old_line_content": "            data_url.mime_type,",
          "new_line_content": "        auto data_url = data_url_or_error.release_value();",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": null,
          "new_api": "bytes",
          "old_text": null,
          "new_text": "gln_if(SPAM_DEBUG, \"ResourceLoader loading a data URL with mime-type: '{}', payload='{}'\",\n            data_url.mime_type,\n            StringView(data_url.body.bytes()));\n",
          "old_line_content": "",
          "new_line_content": "        dbgln_if(SPAM_DEBUG, \"ResourceLoader loading a data URL with mime-type: '{}', payload='{}'\",",
          "content_same": false
        },
        {
          "line": 272,
          "old_api": null,
          "new_api": "to_byte_string",
          "old_text": null,
          "new_text": "ta_url.mime_type.to_byte_string());",
          "old_line_content": "",
          "new_line_content": "        response_headers.set(\"Content-Type\", data_url.mime_type.to_byte_string());",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": null,
          "new_api": "deferred_invoke",
          "old_text": null,
          "new_text": "atform::EventLoopPlugin::the().deferred_invoke([data = move(data_url.body), response_headers = move(response_headers), success_callback = move(success_callback)] {\n            success_callback(data, response_headers, {});\n        });\n",
          "old_line_content": "        return;",
          "new_line_content": "        Platform::EventLoopPlugin::the().deferred_invoke([data = move(data_url.body), response_headers = move(response_headers), success_callback = move(success_callback)] {",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": null,
          "new_api": "ccess_callback",
          "old_text": null,
          "new_text": "ccess_callback(data, response_headers, {});\n",
          "old_line_content": "    }",
          "new_line_content": "            success_callback(data, response_headers, {});",
          "content_same": false
        },
        {
          "line": 283,
          "old_api": null,
          "new_api": "serialize",
          "old_text": null,
          "new_text": "l.serialize());",
          "old_line_content": "            return;",
          "new_line_content": "        auto resource = Core::Resource::load_from_uri(url.serialize());",
          "content_same": false
        },
        {
          "line": 284,
          "old_api": null,
          "new_api": "is_error",
          "old_text": null,
          "new_text": "source.is_error()) ",
          "old_line_content": "        }",
          "new_line_content": "        if (resource.is_error()) {",
          "content_same": false
        },
        {
          "line": 285,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "source.error());",
          "old_line_content": "",
          "new_line_content": "            log_failure(request, resource.error());",
          "content_same": false
        },
        {
          "line": 290,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "source.value()->is_directory()) ",
          "old_line_content": "        }",
          "new_line_content": "        if (resource.value()->is_directory()) {",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "source.value()->file_url(), ",
          "old_line_content": "",
          "new_line_content": "            respond_directory_page(request, resource.value()->file_url(), success_callback, error_callback);",
          "content_same": false
        },
        {
          "line": 298,
          "old_api": null,
          "new_api": "g_success",
          "old_text": null,
          "new_text": "g_success(request);\n",
          "old_line_content": "        return;",
          "new_line_content": "        log_success(request);",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": null,
          "new_api": "ccess_callback",
          "old_text": null,
          "new_text": "ccess_callback(data, response_headers, {});\n",
          "old_line_content": "    }",
          "new_line_content": "        success_callback(data, response_headers, {});",
          "content_same": false
        },
        {
          "line": 304,
          "old_api": null,
          "new_api": "scheme",
          "old_text": null,
          "new_text": "l.scheme() =",
          "old_line_content": "",
          "new_line_content": "    if (url.scheme() == \"file\") {",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": null,
          "new_api": "has_value",
          "old_text": null,
          "new_text": "page.has_value()) ",
          "old_line_content": "        }",
          "new_line_content": "        if (!m_page.has_value()) {",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": null,
          "new_api": "g_failure",
          "old_text": null,
          "new_text": "g_failure(request, \"INTERNAL ERROR: No Page for request\");\n",
          "old_line_content": "",
          "new_line_content": "            log_failure(request, \"INTERNAL ERROR: No Page for request\");",
          "content_same": false
        },
        {
          "line": 321,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "le_or_error.error().code() =",
          "old_line_content": "                return;",
          "new_line_content": "                    auto status = file_or_error.error().code() == ENOENT ? 404u : 500u;",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "le_or_error.error()),",
          "old_line_content": "            }",
          "new_line_content": "                    error_callback(ByteString::formatted(\"{}\", file_or_error.error()), status, {}, {});",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": null,
          "new_api": "re::Directory::is_valid_directory(fd);",
          "old_text": null,
          "new_text": "re::Directory::is_valid_directory(fd);\n",
          "old_line_content": "                return;",
          "new_line_content": "            auto maybe_is_valid_directory = Core::Directory::is_valid_directory(fd);",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "ybe_is_valid_directory.value()) ",
          "old_line_content": "            }",
          "new_line_content": "            if (!maybe_is_valid_directory.is_error() && maybe_is_valid_directory.value()) {",
          "content_same": false
        },
        {
          "line": 332,
          "old_api": null,
          "new_api": "url",
          "old_text": null,
          "new_text": "quest.url(), ",
          "old_line_content": "",
          "new_line_content": "                respond_directory_page(request, request.url(), success_callback, error_callback);",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": null,
          "new_api": "re::File::adopt_fd(fd, Core::File::OpenMode::Read);",
          "old_text": null,
          "new_text": "re::File::adopt_fd(fd, Core::File::OpenMode::Read);\n",
          "old_line_content": "                if (error_callback)",
          "new_line_content": "            auto maybe_file = Core::File::adopt_fd(fd, Core::File::OpenMode::Read);",
          "content_same": false
        },
        {
          "line": 339,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "ybe_file.error());",
          "old_line_content": "                return;",
          "new_line_content": "                log_failure(request, maybe_file.error());",
          "content_same": false
        },
        {
          "line": 341,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "ybe_file.error()),",
          "old_line_content": "",
          "new_line_content": "                    error_callback(ByteString::formatted(\"{}\", maybe_file.error()), 500u, {}, {});",
          "content_same": false
        },
        {
          "line": 346,
          "old_api": null,
          "new_api": "read_until_eof",
          "old_text": null,
          "new_text": "le->read_until_eof();\n",
          "old_line_content": "                if (error_callback)",
          "new_line_content": "            auto maybe_data = file->read_until_eof();",
          "content_same": false
        },
        {
          "line": 348,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "ybe_data.error());",
          "old_line_content": "                return;",
          "new_line_content": "                log_failure(request, maybe_data.error());",
          "content_same": false
        },
        {
          "line": 350,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "ybe_data.error()),",
          "old_line_content": "",
          "new_line_content": "                    error_callback(ByteString::formatted(\"{}\", maybe_data.error()), 500u, {}, {});",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": null,
          "new_api": "g_success",
          "old_text": null,
          "new_text": "g_success(request);\n",
          "old_line_content": "",
          "new_line_content": "            log_success(request);",
          "content_same": false
        },
        {
          "line": 361,
          "old_api": null,
          "new_api": "ve",
          "old_text": null,
          "new_text": "ve(file_request));",
          "old_line_content": "        if (on_load_counter_change)",
          "new_line_content": "        (*m_page)->client().request_file(move(file_request));",
          "content_same": false
        },
        {
          "line": 365,
          "old_api": null,
          "new_api": "_load_counter_change",
          "old_text": null,
          "new_text": "_load_counter_change();\n",
          "old_line_content": "    }",
          "new_line_content": "            on_load_counter_change();",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": null,
          "new_api": "scheme",
          "old_text": null,
          "new_text": "l.scheme() =",
          "old_line_content": "        HashMap<ByteString, ByteString> headers;",
          "new_line_content": "    if (url.scheme() == \"http\" || url.scheme() == \"https\" || url.scheme() == \"gemini\") {",
          "content_same": false
        },
        {
          "line": 377,
          "old_api": null,
          "new_api": "headers",
          "old_text": null,
          "new_text": "quest.headers()) ",
          "old_line_content": "",
          "new_line_content": "        for (auto& it : request.headers()) {",
          "content_same": false
        },
        {
          "line": 384,
          "old_api": null,
          "new_api": "g_failure",
          "old_text": null,
          "new_text": "g_failure(request, start_request_failure_msg);\n",
          "old_line_content": "            return;",
          "new_line_content": "            log_failure(request, start_request_failure_msg);",
          "content_same": false
        },
        {
          "line": 386,
          "old_api": null,
          "new_api": "ror_callback",
          "old_text": null,
          "new_text": "ror_callback(start_request_failure_msg, {}, {}, {});\n",
          "old_line_content": "",
          "new_line_content": "                error_callback(start_request_failure_msg, {}, {}, {});",
          "content_same": false
        },
        {
          "line": 391,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "meout.value(), ",
          "old_line_content": "                if (timeout_callback)",
          "new_line_content": "            auto timer = Platform::Timer::create_single_shot(timeout.value(), nullptr);",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": null,
          "new_api": "stop",
          "old_text": null,
          "new_text": "otocol_request->stop();\n",
          "old_line_content": "            };",
          "new_line_content": "                protocol_request->stop();",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": null,
          "new_api": "meout_callback",
          "old_text": null,
          "new_text": "meout_callback();\n",
          "old_line_content": "        }",
          "new_line_content": "                    timeout_callback();",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": null,
          "new_api": "set",
          "old_text": null,
          "new_text": "active_requests.set(*protocol_request);\n",
          "old_line_content": "            --m_pending_loads;",
          "new_line_content": "        m_active_requests.set(*protocol_request);",
          "content_same": false
        },
        {
          "line": 410,
          "old_api": null,
          "new_api": "has_value",
          "old_text": null,
          "new_text": "che_control.has_value()) ",
          "old_line_content": "                    }",
          "new_line_content": "                if (auto cache_control = response_headers.get(\"cache-control\"); cache_control.has_value()) {",
          "content_same": false
        },
        {
          "line": 411,
          "old_api": null,
          "new_api": "value",
          "old_text": null,
          "new_text": "che_control.value().contains(\"no-store\"sv)) ",
          "old_line_content": "                }",
          "new_line_content": "                    if (cache_control.value().contains(\"no-store\"sv)) {",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": null,
          "new_api": "remove",
          "old_text": null,
          "new_text": "resource_cache.remove(request);\n",
          "old_line_content": "            }",
          "new_line_content": "                        s_resource_cache.remove(request);",
          "content_same": false
        },
        {
          "line": 423,
          "old_api": null,
          "new_api": "string_view",
          "old_text": null,
          "new_text": "ror_builder.string_view());",
          "old_line_content": "                return;",
          "new_line_content": "                log_failure(request, error_builder.string_view());",
          "content_same": false
        },
        {
          "line": 429,
          "old_api": null,
          "new_api": "ccess_callback",
          "old_text": null,
          "new_text": "ccess_callback(payload, response_headers, status_code);\n",
          "old_line_content": "            });",
          "new_line_content": "            success_callback(payload, response_headers, status_code);",
          "content_same": false
        },
        {
          "line": 430,
          "old_api": null,
          "new_api": "deferred_invoke",
          "old_text": null,
          "new_text": "atform::EventLoopPlugin::the().deferred_invoke([this, &protocol_request] {\n                m_active_requests.remove(protocol_request);\n            });\n",
          "old_line_content": "        };",
          "new_line_content": "            Platform::EventLoopPlugin::the().deferred_invoke([this, &protocol_request] {",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": null,
          "new_api": "set_should_buffer_all_input",
          "old_text": null,
          "new_text": "otocol_request->set_should_buffer_all_input(true);\n",
          "old_line_content": "        };",
          "new_line_content": "        protocol_request->set_should_buffer_all_input(true);",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": null,
          "new_api": "_load_counter_change",
          "old_text": null,
          "new_text": "_load_counter_change();\n",
          "old_line_content": "",
          "new_line_content": "            on_load_counter_change();",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": null,
          "new_api": "g_failure",
          "old_text": null,
          "new_text": "g_failure(request, not_implemented_error);\n",
          "old_line_content": "}",
          "new_line_content": "    log_failure(request, not_implemented_error);",
          "content_same": false
        },
        {
          "line": 447,
          "old_api": null,
          "new_api": "ror_callback",
          "old_text": null,
          "new_text": "ror_callback(not_implemented_error, {}, {}, {});\n",
          "old_line_content": "bool ResourceLoader::is_port_blocked(int port)",
          "new_line_content": "        error_callback(not_implemented_error, {}, {}, {});",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "resource_cache.size());",
          "old_line_content": "",
          "new_line_content": "    dbgln_if(CACHE_DEBUG, \"Clearing {} items from ResourceLoader cache\", s_resource_cache.size());",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "resource_cache.clear();\n",
          "old_line_content": "void ResourceLoader::evict_from_cache(LoadRequest const& request)",
          "new_line_content": "    s_resource_cache.clear();",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": null,
          "new_api": "url",
          "old_text": null,
          "new_text": "quest.url());",
          "old_line_content": "",
          "new_line_content": "    dbgln_if(CACHE_DEBUG, \"Removing resource {} from cache\", request.url());",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": null,
          "new_api": "remove",
          "old_text": null,
          "new_text": "resource_cache.remove(request);\n",
          "old_line_content": "}",
          "new_line_content": "    s_resource_cache.remove(request);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 72,
          "old_api": "gln",
          "new_api": null,
          "old_text": "gln(\"ResourceLoader: Refusing to prefetch DNS for '{}': \\033[31;1mURL was filtered\\033[0m\", url);\n",
          "new_text": null,
          "old_line_content": "        dbgln(\"ResourceLoader: Refusing to prefetch DNS for '{}': \\033[31;1mURL was filtered\\033[0m\", url);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 76,
          "old_api": "prefetch_dns",
          "new_api": null,
          "old_text": "connector->prefetch_dns(url);\n",
          "new_text": null,
          "old_line_content": "    m_connector->prefetch_dns(url);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 81,
          "old_api": "scheme",
          "new_api": null,
          "old_text": "l.scheme().is_one_of(\"file\"sv, \"data\"sv))\n",
          "new_text": null,
          "old_line_content": "    if (url.scheme().is_one_of(\"file\"sv, \"data\"sv))",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 85,
          "old_api": "gln",
          "new_api": null,
          "old_text": "gln(\"ResourceLoader: Refusing to pre-connect to '{}': \\033[31;1mURL was filtered\\033[0m\", url);\n",
          "new_text": null,
          "old_line_content": "        dbgln(\"ResourceLoader: Refusing to pre-connect to '{}': \\033[31;1mURL was filtered\\033[0m\", url);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 89,
          "old_api": "preconnect",
          "new_api": null,
          "old_text": "connector->preconnect(url);\n",
          "new_text": null,
          "old_line_content": "    m_connector->preconnect(url);",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 96,
          "old_api": "is_valid",
          "new_api": null,
          "old_text": "quest.is_valid())\n",
          "new_text": null,
          "old_line_content": "    if (!request.is_valid())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 103,
          "old_api": "end",
          "new_api": null,
          "old_text": "resource_cache.end()) ",
          "new_text": null,
          "old_line_content": "        if (it != s_resource_cache.end()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": "type",
          "new_api": null,
          "old_text": "->value->type() !",
          "new_text": null,
          "old_line_content": "            if (it->value->type() != type) {",
          "new_line_content": "    if (use_cache) {",
          "content_same": false
        },
        {
          "line": 113,
          "old_api": "source::create({}, type, request);",
          "new_api": null,
          "old_text": "source::create({}, type, request);\n",
          "new_text": null,
          "old_line_content": "    auto resource = Resource::create({}, type, request);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": "did_load",
          "new_api": null,
          "old_text": "ad(\n        request,\n        [=](auto data, auto& headers, auto status_code) {\n            const_cast<Resource&>(*resource).did_load({}, data, headers, status_code);\n        },\n        [=](auto& error, auto status_code, auto, auto) {\n            const_cast<Resource&>(*resource).did_fail({}, error, status_code);\n        });\n",
          "new_text": null,
          "old_line_content": "    load(",
          "new_line_content": "    if (use_cache)",
          "content_same": false
        },
        {
          "line": 132,
          "old_api": "scheme",
          "new_api": null,
          "old_text": "l.scheme() =",
          "new_text": null,
          "old_line_content": "    if (url.scheme() == \"data\"sv)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 134,
          "old_api": "to_byte_string",
          "new_api": null,
          "old_text": "l.to_byte_string();\n",
          "new_text": null,
          "old_line_content": "    return url.to_byte_string();",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 140,
          "old_api": "length",
          "new_api": null,
          "old_text": "ssage.length());",
          "new_text": null,
          "old_line_content": "    auto string_id = perf_register_string(message.characters(), message.length());",
          "new_line_content": "static void emit_signpost(ByteString const& message, int id)",
          "content_same": false
        },
        {
          "line": 141,
          "old_api": "rf_event",
          "new_api": null,
          "old_text": "rf_event(PERF_EVENT_SIGNPOST, string_id, id);\n",
          "new_text": null,
          "old_line_content": "    perf_event(PERF_EVENT_SIGNPOST, string_id, id);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": "onValue::from_string(cookies));",
          "new_api": null,
          "old_text": "onValue::from_string(cookies));",
          "new_text": null,
          "old_line_content": "    auto set_cookie_json_value = MUST(JsonValue::from_string(cookies));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 151,
          "old_api": "type",
          "new_api": null,
          "old_text": "t_cookie_json_value.type() =",
          "new_text": null,
          "old_line_content": "    VERIFY(set_cookie_json_value.type() == JsonValue::Type::Array);",
          "new_line_content": "static void store_response_cookies(Page& page, URL::URL const& url, ByteString const& cookies)",
          "content_same": false
        },
        {
          "line": 170,
          "old_api": "re::guess_mime_type_based_on_filename(path);",
          "new_api": null,
          "old_text": "re::guess_mime_type_based_on_filename(path);\n",
          "new_text": null,
          "old_line_content": "    auto mime_type = Core::guess_mime_type_based_on_filename(path);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": "url",
          "new_api": null,
          "old_text": "quest.url();\n",
          "new_text": null,
          "old_line_content": "    auto& url = request.url();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": "start_timer",
          "new_api": null,
          "old_text": "quest.start_timer();\n",
          "new_text": null,
          "old_line_content": "    request.start_timer();",
          "new_line_content": "void ResourceLoader::load(LoadRequest& request, SuccessCallback success_callback, ErrorCallback error_callback, Optional<u32> timeout, TimeoutCallback timeout_callback)",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": "teString::formatted(\"Starting load: {}\", url_for_logging),",
          "new_api": null,
          "old_text": "teString::formatted(\"Starting load: {}\", url_for_logging), ",
          "new_text": null,
          "old_line_content": "    emit_signpost(ByteString::formatted(\"Starting load: {}\", url_for_logging), id);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 186,
          "old_api": "gln_if",
          "new_api": null,
          "old_text": "gln_if(SPAM_DEBUG, \"ResourceLoader: Starting load of: \\\"{}\\\"\", url_for_logging);\n",
          "new_text": null,
          "old_line_content": "    dbgln_if(SPAM_DEBUG, \"ResourceLoader: Starting load of: \\\"{}\\\"\", url_for_logging);",
          "new_line_content": "    auto id = resource_id++;",
          "content_same": false
        },
        {
          "line": 190,
          "old_api": "teString::formatted(\"Finished load: {}\", url_for_logging),",
          "new_api": null,
          "old_text": "teString::formatted(\"Finished load: {}\", url_for_logging), ",
          "new_text": null,
          "old_line_content": "        emit_signpost(ByteString::formatted(\"Finished load: {}\", url_for_logging), id);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "gln_if",
          "new_api": null,
          "old_text": "gln_if(SPAM_DEBUG, \"ResourceLoader: Finished load of: \\\"{}\\\", Duration: {}ms\", url_for_logging, load_time_ms);\n",
          "new_text": null,
          "old_line_content": "        dbgln_if(SPAM_DEBUG, \"ResourceLoader: Finished load of: \\\"{}\\\", Duration: {}ms\", url_for_logging, load_time_ms);",
          "new_line_content": "    auto const log_success = [url_for_logging, id](auto const& request) {",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": "load_time",
          "new_api": null,
          "old_text": "quest.load_time().to_milliseconds();\n",
          "new_text": null,
          "old_line_content": "        auto load_time_ms = request.load_time().to_milliseconds();",
          "new_line_content": "    };",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": "teString::formatted(\"Failed load: {}\", url_for_logging),",
          "new_api": null,
          "old_text": "teString::formatted(\"Failed load: {}\", url_for_logging), ",
          "new_text": null,
          "old_line_content": "        emit_signpost(ByteString::formatted(\"Failed load: {}\", url_for_logging), id);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": "gln",
          "new_api": null,
          "old_text": "gln(\"ResourceLoader: Failed load of: \\\"{}\\\", \\033[31;1mError: {}\\033[0m, Duration: {}ms\", url_for_logging, error_message, load_time_ms);\n",
          "new_text": null,
          "old_line_content": "        dbgln(\"ResourceLoader: Failed load of: \\\"{}\\\", \\033[31;1mError: {}\\033[0m, Duration: {}ms\", url_for_logging, error_message, load_time_ms);",
          "new_line_content": "    auto const log_failure = [url_for_logging, id](auto const& request, auto const& error_message) {",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "ad_file_directory_page",
          "new_api": null,
          "old_text": "ad_file_directory_page(url);\n",
          "new_text": null,
          "old_line_content": "        auto maybe_response = load_file_directory_page(url);",
          "new_line_content": "    };",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": "is_error",
          "new_api": null,
          "old_text": "ybe_response.is_error()) ",
          "new_text": null,
          "old_line_content": "        if (maybe_response.is_error()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": "error",
          "new_api": null,
          "old_text": "ybe_response.error());",
          "new_text": null,
          "old_line_content": "            log_failure(request, maybe_response.error());",
          "new_line_content": "    auto respond_directory_page = [log_success, log_failure](LoadRequest const& request, URL::URL const& url, SuccessCallback const& success_callback, ErrorCallback const& error_callback) {",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": "g_success",
          "new_api": null,
          "old_text": "g_success(request);\n",
          "new_text": null,
          "old_line_content": "        log_success(request);",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "set",
          "new_api": null,
          "old_text": "sponse_headers.set(\"Content-Type\"sv, \"text/html\"sv);\n",
          "new_text": null,
          "old_line_content": "        response_headers.set(\"Content-Type\"sv, \"text/html\"sv);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 216,
          "old_api": "port_or_default",
          "new_api": null,
          "old_text": "l.port_or_default()))",
          "new_text": null,
          "old_line_content": "        log_failure(request, ByteString::formatted(\"The port #{} is blocked\", url.port_or_default()));",
          "new_line_content": "    };",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": "is_filtered",
          "new_api": null,
          "old_text": "ntentFilter::the().is_filtered(url)) ",
          "new_text": null,
          "old_line_content": "    if (ContentFilter::the().is_filtered(url)) {",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 222,
          "old_api": "g_failure",
          "new_api": null,
          "old_text": "g_failure(request, filter_message);\n",
          "new_text": null,
          "old_line_content": "        log_failure(request, filter_message);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 227,
          "old_api": "scheme",
          "new_api": null,
          "old_text": "l.scheme() =",
          "new_text": null,
          "old_line_content": "    if (url.scheme() == \"about\") {",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 228,
          "old_api": "gln_if",
          "new_api": null,
          "old_text": "gln_if(SPAM_DEBUG, \"Loading about: URL {}\", url);\n",
          "new_text": null,
          "old_line_content": "        dbgln_if(SPAM_DEBUG, \"Loading about: URL {}\", url);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": "g_success",
          "new_api": null,
          "old_text": "g_success(request);\n",
          "new_text": null,
          "old_line_content": "        log_success(request);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": "ad_about_version_page",
          "new_api": null,
          "old_text": "ad_about_version_page()).",
          "new_text": null,
          "old_line_content": "            success_callback(MUST(load_about_version_page()).bytes(), response_headers, {});",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": "path_segment_at_index",
          "new_api": null,
          "old_text": "l.path_segment_at_index(0)))",
          "new_text": null,
          "old_line_content": "        auto resource = Core::Resource::load_from_uri(MUST(String::formatted(\"resource://ladybird/{}.html\", url.path_segment_at_index(0))));",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 242,
          "old_api": "is_error",
          "new_api": null,
          "old_text": "source.is_error()) ",
          "new_text": null,
          "old_line_content": "        if (!resource.is_error()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": "value",
          "new_api": null,
          "old_text": "source.value()->data();\n",
          "new_text": null,
          "old_line_content": "            auto data = resource.value()->data();",
          "new_line_content": "        // Other about static HTML pages",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": "deferred_invoke",
          "new_api": null,
          "old_text": "atform::EventLoopPlugin::the().deferred_invoke([success_callback = move(success_callback), response_headers = move(response_headers)] {\n            success_callback(ByteString::empty().to_byte_buffer(), response_headers, {});\n        });\n",
          "new_text": null,
          "old_line_content": "        Platform::EventLoopPlugin::the().deferred_invoke([success_callback = move(success_callback), response_headers = move(response_headers)] {",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": "to_byte_buffer",
          "new_api": null,
          "old_text": "teString::empty().to_byte_buffer(), ",
          "new_text": null,
          "old_line_content": "            success_callback(ByteString::empty().to_byte_buffer(), response_headers, {});",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": "scheme",
          "new_api": null,
          "old_text": "l.scheme() =",
          "new_text": null,
          "old_line_content": "    if (url.scheme() == \"data\") {",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 255,
          "old_api": "tch::Infrastructure::process_data_url(url);",
          "new_api": null,
          "old_text": "tch::Infrastructure::process_data_url(url);\n",
          "new_text": null,
          "old_line_content": "        auto data_url_or_error = Fetch::Infrastructure::process_data_url(url);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 256,
          "old_api": "is_error",
          "new_api": null,
          "old_text": "ta_url_or_error.is_error()) ",
          "new_text": null,
          "old_line_content": "        if (data_url_or_error.is_error()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": "bytes",
          "new_api": null,
          "old_text": "gln_if(SPAM_DEBUG, \"ResourceLoader loading a data URL with mime-type: '{}', payload='{}'\",\n            data_url.mime_type,\n            StringView(data_url.body.bytes()));\n",
          "new_text": null,
          "old_line_content": "        dbgln_if(SPAM_DEBUG, \"ResourceLoader loading a data URL with mime-type: '{}', payload='{}'\",",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 266,
          "old_api": "bytes",
          "new_api": null,
          "old_text": "ta_url.body.bytes()))",
          "new_text": null,
          "old_line_content": "            StringView(data_url.body.bytes()));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": "g_success",
          "new_api": null,
          "old_text": "g_success(request);\n",
          "new_text": null,
          "old_line_content": "        log_success(request);",
          "new_line_content": "        HashMap<ByteString, ByteString, CaseInsensitiveStringTraits> response_headers;",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": "deferred_invoke",
          "new_api": null,
          "old_text": "atform::EventLoopPlugin::the().deferred_invoke([data = move(data_url.body), response_headers = move(response_headers), success_callback = move(success_callback)] {\n            success_callback(data, response_headers, {});\n        });\n",
          "new_text": null,
          "old_line_content": "        Platform::EventLoopPlugin::the().deferred_invoke([data = move(data_url.body), response_headers = move(response_headers), success_callback = move(success_callback)] {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": "scheme",
          "new_api": null,
          "old_text": "l.scheme() =",
          "new_text": null,
          "old_line_content": "    if (url.scheme() == \"resource\") {",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 280,
          "old_api": "serialize",
          "new_api": null,
          "old_text": "l.serialize());",
          "new_text": null,
          "old_line_content": "        auto resource = Core::Resource::load_from_uri(url.serialize());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": "is_error",
          "new_api": null,
          "old_text": "source.is_error()) ",
          "new_text": null,
          "old_line_content": "        if (resource.is_error()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 287,
          "old_api": "value",
          "new_api": null,
          "old_text": "source.value()->is_directory()) ",
          "new_text": null,
          "old_line_content": "        if (resource.value()->is_directory()) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 288,
          "old_api": "value",
          "new_api": null,
          "old_text": "source.value()->file_url(), ",
          "new_text": null,
          "old_line_content": "            respond_directory_page(request, resource.value()->file_url(), success_callback, error_callback);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": "value",
          "new_api": null,
          "old_text": "source.value()->data();\n",
          "new_text": null,
          "old_line_content": "        auto data = resource.value()->data();",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": "serialize_path",
          "new_api": null,
          "old_text": "l.serialize_path());",
          "new_text": null,
          "old_line_content": "        auto response_headers = response_headers_for_file(url.serialize_path());",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": "scheme",
          "new_api": null,
          "old_text": "l.scheme() =",
          "new_text": null,
          "old_line_content": "    if (url.scheme() == \"file\") {",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": "page",
          "new_api": null,
          "old_text": "quest.page())\n",
          "new_text": null,
          "old_line_content": "        if (request.page())",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": "page",
          "new_api": null,
          "old_text": "quest.page();\n",
          "new_text": null,
          "old_line_content": "            m_page = request.page();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": "serialize_path",
          "new_api": null,
          "old_text": "l.serialize_path(), ",
          "new_text": null,
          "old_line_content": "        FileRequest file_request(url.serialize_path(), [this, success_callback = move(success_callback), error_callback = move(error_callback), log_success, log_failure, request, respond_directory_page](ErrorOr<i32> file_or_error) {",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": "is_error",
          "new_api": null,
          "old_text": "le_or_error.is_error()) ",
          "new_text": null,
          "old_line_content": "            if (file_or_error.is_error()) {",
          "new_line_content": "            if (on_load_counter_change)",
          "content_same": false
        },
        {
          "line": 324,
          "old_api": "value",
          "new_api": null,
          "old_text": "le_or_error.value();\n",
          "new_text": null,
          "old_line_content": "            auto const fd = file_or_error.value();",
          "new_line_content": "                return;",
          "content_same": false
        },
        {
          "line": 328,
          "old_api": "value",
          "new_api": null,
          "old_text": "ybe_is_valid_directory.value()) ",
          "new_text": null,
          "old_line_content": "            if (!maybe_is_valid_directory.is_error() && maybe_is_valid_directory.value()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 329,
          "old_api": "url",
          "new_api": null,
          "old_text": "quest.url(), ",
          "new_text": null,
          "old_line_content": "                respond_directory_page(request, request.url(), success_callback, error_callback);",
          "new_line_content": "            // When local file is a directory use file directory loader to generate response",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": "re::File::adopt_fd(fd, Core::File::OpenMode::Read);",
          "new_api": null,
          "old_text": "re::File::adopt_fd(fd, Core::File::OpenMode::Read);\n",
          "new_text": null,
          "old_line_content": "            auto maybe_file = Core::File::adopt_fd(fd, Core::File::OpenMode::Read);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": "is_error",
          "new_api": null,
          "old_text": "ybe_file.is_error()) ",
          "new_text": null,
          "old_line_content": "            if (maybe_file.is_error()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 336,
          "old_api": "error",
          "new_api": null,
          "old_text": "ybe_file.error());",
          "new_text": null,
          "old_line_content": "                log_failure(request, maybe_file.error());",
          "new_line_content": "            // Try to read file normally",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": "release_value",
          "new_api": null,
          "old_text": "ybe_file.release_value();\n",
          "new_text": null,
          "old_line_content": "            auto file = maybe_file.release_value();",
          "new_line_content": "                return;",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": "read_until_eof",
          "new_api": null,
          "old_text": "le->read_until_eof();\n",
          "new_text": null,
          "old_line_content": "            auto maybe_data = file->read_until_eof();",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 344,
          "old_api": "is_error",
          "new_api": null,
          "old_text": "ybe_data.is_error()) ",
          "new_text": null,
          "old_line_content": "            if (maybe_data.is_error()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 351,
          "old_api": "release_value",
          "new_api": null,
          "old_text": "ybe_data.release_value();\n",
          "new_text": null,
          "old_line_content": "            auto data = maybe_data.release_value();",
          "new_line_content": "                return;",
          "content_same": false
        },
        {
          "line": 352,
          "old_api": "url",
          "new_api": null,
          "old_text": "quest.url().serialize_path());",
          "new_text": null,
          "old_line_content": "            auto response_headers = response_headers_for_file(request.url().serialize_path());",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 362,
          "old_api": "_load_counter_change",
          "new_api": null,
          "old_text": "_load_counter_change();\n",
          "new_text": null,
          "old_line_content": "            on_load_counter_change();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 367,
          "old_api": "scheme",
          "new_api": null,
          "old_text": "l.scheme() =",
          "new_text": null,
          "old_line_content": "    if (url.scheme() == \"http\" || url.scheme() == \"https\" || url.scheme() == \"gemini\") {",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 368,
          "old_api": "proxy_for_url",
          "new_api": null,
          "old_text": "oxyMappings::the().proxy_for_url(url);\n",
          "new_text": null,
          "old_line_content": "        auto proxy = ProxyMappings::the().proxy_for_url(url);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 372,
          "old_api": "set",
          "new_api": null,
          "old_text": "aders.set(\"Accept-Encoding\", \"gzip, deflate, br\");\n",
          "new_text": null,
          "old_line_content": "        headers.set(\"Accept-Encoding\", \"gzip, deflate, br\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": "ror_callback",
          "new_api": null,
          "old_text": "ror_callback(start_request_failure_msg, {}, {}, {});\n",
          "new_text": null,
          "old_line_content": "                error_callback(start_request_failure_msg, {}, {}, {});",
          "new_line_content": "            auto start_request_failure_msg = \"Failed to initiate load\"sv;",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": "value",
          "new_api": null,
          "old_text": "meout.value() >",
          "new_text": null,
          "old_line_content": "        if (timeout.has_value() && timeout.value() > 0) {",
          "new_line_content": "            return;",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "value",
          "new_api": null,
          "old_text": "meout.value(), ",
          "new_text": null,
          "old_line_content": "            auto timer = Platform::Timer::create_single_shot(timeout.value(), nullptr);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": "meout_callback",
          "new_api": null,
          "old_text": "meout_callback();\n",
          "new_text": null,
          "old_line_content": "                    timeout_callback();",
          "new_line_content": "            timer->on_timeout = [timer, protocol_request, timeout_callback = move(timeout_callback)] {",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": "start",
          "new_api": null,
          "old_text": "mer->start();\n",
          "new_text": null,
          "old_line_content": "            timer->start();",
          "new_line_content": "                if (timeout_callback)",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": "_load_counter_change",
          "new_api": null,
          "old_text": "_load_counter_change();\n",
          "new_text": null,
          "old_line_content": "                on_load_counter_change();",
          "new_line_content": "        protocol_request->on_buffered_request_finish = [this, success_callback = move(success_callback), error_callback = move(error_callback), log_success, log_failure, request, &protocol_request = *protocol_request](bool success, auto, auto& response_headers, auto status_code, ReadonlyBytes payload) mutable {",
          "content_same": false
        },
        {
          "line": 404,
          "old_api": "page",
          "new_api": null,
          "old_text": "quest.page()) ",
          "new_text": null,
          "old_line_content": "            if (request.page()) {",
          "new_line_content": "            if (on_load_counter_change)",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": "url",
          "new_api": null,
          "old_text": "quest.url(), ",
          "new_text": null,
          "old_line_content": "                    store_response_cookies(*request.page(), request.url(), *set_cookie);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": "is_main_resource",
          "new_api": null,
          "old_text": "quest.is_main_resource()))",
          "new_text": null,
          "old_line_content": "            if (!success || (status_code.has_value() && *status_code >= 400 && *status_code <= 599 && (payload.is_empty() || !request.is_main_resource()))) {",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": "has_value",
          "new_api": null,
          "old_text": "atus_code.has_value())\n",
          "new_text": null,
          "old_line_content": "                if (status_code.has_value())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": "ccess_callback",
          "new_api": null,
          "old_text": "ccess_callback(payload, response_headers, status_code);\n",
          "new_text": null,
          "old_line_content": "            success_callback(payload, response_headers, status_code);",
          "new_line_content": "                return;",
          "content_same": false
        },
        {
          "line": 427,
          "old_api": "deferred_invoke",
          "new_api": null,
          "old_text": "atform::EventLoopPlugin::the().deferred_invoke([this, &protocol_request] {\n                m_active_requests.remove(protocol_request);\n            });\n",
          "new_text": null,
          "old_line_content": "            Platform::EventLoopPlugin::the().deferred_invoke([this, &protocol_request] {",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "_load_counter_change",
          "new_api": null,
          "old_text": "_load_counter_change();\n",
          "new_text": null,
          "old_line_content": "            on_load_counter_change();",
          "new_line_content": "        };",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": "scheme",
          "new_api": null,
          "old_text": "l.scheme());",
          "new_text": null,
          "old_line_content": "    auto not_implemented_error = ByteString::formatted(\"Protocol not implemented: {}\", url.scheme());",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": "g_failure",
          "new_api": null,
          "old_text": "g_failure(request, not_implemented_error);\n",
          "new_text": null,
          "old_line_content": "    log_failure(request, not_implemented_error);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": "size",
          "new_api": null,
          "old_text": "resource_cache.size());",
          "new_text": null,
          "old_line_content": "    dbgln_if(CACHE_DEBUG, \"Clearing {} items from ResourceLoader cache\", s_resource_cache.size());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "clear",
          "new_api": null,
          "old_text": "resource_cache.clear();\n",
          "new_text": null,
          "old_line_content": "    s_resource_cache.clear();",
          "new_line_content": "void ResourceLoader::clear_cache()",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": "url",
          "new_api": null,
          "old_text": "quest.url());",
          "new_text": null,
          "old_line_content": "    dbgln_if(CACHE_DEBUG, \"Removing resource {} from cache\", request.url());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": "remove",
          "new_api": null,
          "old_text": "resource_cache.remove(request);\n",
          "new_text": null,
          "old_line_content": "    s_resource_cache.remove(request);",
          "new_line_content": "void ResourceLoader::evict_from_cache(LoadRequest const& request)",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 61,
      "total_additions": 97,
      "total_deletions": 96,
      "total_api_changes": 254
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 254,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          73
        ]
      }
    },
    "api_calls_before": 262,
    "api_calls_after": 264,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 0,
      "total_diff_lines": 15
    }
  }
}