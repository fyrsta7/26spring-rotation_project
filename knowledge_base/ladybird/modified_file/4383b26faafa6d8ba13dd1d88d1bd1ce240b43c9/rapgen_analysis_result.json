{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/4383b26faafa6d8ba13dd1d88d1bd1ce240b43c9",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/4383b26faafa6d8ba13dd1d88d1bd1ce240b43c9/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/4383b26faafa6d8ba13dd1d88d1bd1ce240b43c9/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/4383b26faafa6d8ba13dd1d88d1bd1ce240b43c9/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": true,
    "api_changes": {
      "replacements": [
        {
          "line": 72,
          "old_api": "release_value",
          "new_api": "buffer_length",
          "old_text": "framebuffer_length_or_error.release_value()",
          "new_text": "buffer_length(0)",
          "old_line_content": "    size_t rounded_framebuffer_length = Memory::page_round_up(framebuffer_length_or_error.release_value()).release_value_but_fixme_should_propagate_errors();",
          "new_line_content": "    auto framebuffer_length_or_error = buffer_length(0);",
          "content_same": false
        },
        {
          "line": 73,
          "old_api": "as_ptr",
          "new_api": "is_error",
          "old_text": "m_real_framebuffer_region->vaddr().as_ptr()",
          "new_text": "framebuffer_length_or_error.is_error()",
          "old_line_content": "    memcpy(m_swapped_framebuffer_region->vaddr().as_ptr(), m_real_framebuffer_region->vaddr().as_ptr(), rounded_framebuffer_length);",
          "new_line_content": "    VERIFY(!framebuffer_length_or_error.is_error());",
          "content_same": false
        },
        {
          "line": 75,
          "old_api": "release_nonnull",
          "new_api": "as_ptr",
          "old_text": "vmobject.release_nonnull()",
          "new_text": "m_real_framebuffer_region->vaddr().as_ptr()",
          "old_line_content": "    m_userspace_framebuffer_region->set_vmobject(vmobject.release_nonnull());",
          "new_line_content": "    memcpy(m_swapped_framebuffer_region->vaddr().as_ptr(), m_real_framebuffer_region->vaddr().as_ptr(), rounded_framebuffer_length);",
          "content_same": false
        },
        {
          "line": 90,
          "old_api": "release_value",
          "new_api": "is_error",
          "old_text": "framebuffer_length_or_error.release_value()",
          "new_text": "framebuffer_length_or_error.is_error()",
          "old_line_content": "    size_t rounded_framebuffer_length = Memory::page_round_up(framebuffer_length_or_error.release_value()).release_value_but_fixme_should_propagate_errors();",
          "new_line_content": "    VERIFY(!framebuffer_length_or_error.is_error());",
          "content_same": false
        },
        {
          "line": 93,
          "old_api": "release_nonnull",
          "new_api": "as_ptr",
          "old_text": "vmobject.release_nonnull()",
          "new_text": "m_swapped_framebuffer_region->vaddr().as_ptr()",
          "old_line_content": "    m_userspace_framebuffer_region->set_vmobject(vmobject.release_nonnull());",
          "new_line_content": "    memcpy(m_real_framebuffer_region->vaddr().as_ptr(), m_swapped_framebuffer_region->vaddr().as_ptr(), rounded_framebuffer_length);",
          "content_same": false
        },
        {
          "line": 104,
          "old_api": "Memory::AnonymousVMObject::try_create_for_physical_range(m_framebuffer_address, framebuffer_length)",
          "new_api": "buffer_length",
          "old_text": "Memory::AnonymousVMObject::try_create_for_physical_range(m_framebuffer_address, framebuffer_length)",
          "new_text": "buffer_length(0)",
          "old_line_content": "    m_real_framebuffer_vmobject = TRY(Memory::AnonymousVMObject::try_create_for_physical_range(m_framebuffer_address, framebuffer_length));",
          "new_line_content": "    auto framebuffer_length = TRY(buffer_length(0));",
          "content_same": false
        },
        {
          "line": 105,
          "old_api": "Memory::AnonymousVMObject::try_create_with_size(framebuffer_length, AllocationStrategy::AllocateNow)",
          "new_api": "Memory::page_round_up(framebuffer_length)",
          "old_text": "Memory::AnonymousVMObject::try_create_with_size(framebuffer_length, AllocationStrategy::AllocateNow)",
          "new_text": "Memory::page_round_up(framebuffer_length)",
          "old_line_content": "    m_swapped_framebuffer_vmobject = TRY(Memory::AnonymousVMObject::try_create_with_size(framebuffer_length, AllocationStrategy::AllocateNow));",
          "new_line_content": "    framebuffer_length = TRY(Memory::page_round_up(framebuffer_length));",
          "content_same": false
        },
        {
          "line": 106,
          "old_api": "allocate_kernel_region_with_vmobject",
          "new_api": "Memory::AnonymousVMObject::try_create_for_physical_range(m_framebuffer_address, framebuffer_length)",
          "old_text": "MM.allocate_kernel_region_with_vmobject(*m_real_framebuffer_vmobject, framebuffer_length, \"Framebuffer\", Memory::Region::Access::ReadWrite)",
          "new_text": "Memory::AnonymousVMObject::try_create_for_physical_range(m_framebuffer_address, framebuffer_length)",
          "old_line_content": "    m_real_framebuffer_region = TRY(MM.allocate_kernel_region_with_vmobject(*m_real_framebuffer_vmobject, framebuffer_length, \"Framebuffer\", Memory::Region::Access::ReadWrite));",
          "new_line_content": "    m_real_framebuffer_vmobject = TRY(Memory::AnonymousVMObject::try_create_for_physical_range(m_framebuffer_address, framebuffer_length));",
          "content_same": false
        },
        {
          "line": 107,
          "old_api": "allocate_kernel_region_with_vmobject",
          "new_api": "Memory::AnonymousVMObject::try_create_with_size(framebuffer_length, AllocationStrategy::AllocateNow)",
          "old_text": "MM.allocate_kernel_region_with_vmobject(*m_swapped_framebuffer_vmobject, framebuffer_length, \"Framebuffer Swap (Blank)\", Memory::Region::Access::ReadWrite)",
          "new_text": "Memory::AnonymousVMObject::try_create_with_size(framebuffer_length, AllocationStrategy::AllocateNow)",
          "old_line_content": "    m_swapped_framebuffer_region = TRY(MM.allocate_kernel_region_with_vmobject(*m_swapped_framebuffer_vmobject, framebuffer_length, \"Framebuffer Swap (Blank)\", Memory::Region::Access::ReadWrite));",
          "new_line_content": "    m_swapped_framebuffer_vmobject = TRY(Memory::AnonymousVMObject::try_create_with_size(framebuffer_length, AllocationStrategy::AllocateNow));",
          "content_same": false
        },
        {
          "line": 120,
          "old_api": "VERIFY",
          "new_api": "is_null",
          "old_text": "VERIFY(m_framebuffer_width)",
          "new_text": "m_framebuffer_address.is_null()",
          "old_line_content": "    VERIFY(m_framebuffer_width);",
          "new_line_content": "    VERIFY(!m_framebuffer_address.is_null());",
          "content_same": false
        },
        {
          "line": 122,
          "old_api": "minor",
          "new_api": "VERIFY",
          "old_text": "minor()",
          "new_text": "VERIFY(m_framebuffer_width)",
          "old_line_content": "    dbgln(\"Framebuffer {}: address={}, pitch={}, width={}, height={}\", minor(), addr, pitch, width, height);",
          "new_line_content": "    VERIFY(m_framebuffer_width);",
          "content_same": false
        },
        {
          "line": 132,
          "old_api": "strong_ref",
          "new_api": "VERIFY",
          "old_text": "m_graphics_adapter.strong_ref()",
          "new_text": "VERIFY(head == 0)",
          "old_line_content": "    auto adapter = m_graphics_adapter.strong_ref();",
          "new_line_content": "    VERIFY(head == 0);",
          "content_same": false
        },
        {
          "line": 134,
          "old_api": "Error::from_errno(EIO)",
          "new_api": "strong_ref",
          "old_text": "Error::from_errno(EIO)",
          "new_text": "m_graphics_adapter.strong_ref()",
          "old_line_content": "        return Error::from_errno(EIO);",
          "new_line_content": "    auto adapter = m_graphics_adapter.strong_ref();",
          "content_same": false
        },
        {
          "line": 196,
          "old_api": "Error::from_errno(EIO)",
          "new_api": "strong_ref",
          "old_text": "Error::from_errno(EIO)",
          "new_text": "m_graphics_adapter.strong_ref()",
          "old_line_content": "        return Error::from_errno(EIO);",
          "new_line_content": "    auto adapter = m_graphics_adapter.strong_ref();",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": "strong_ref",
          "new_api": "VERIFY",
          "old_text": "m_graphics_adapter.strong_ref()",
          "new_text": "VERIFY(head == 0)",
          "old_line_content": "    auto adapter = m_graphics_adapter.strong_ref();",
          "new_line_content": "    VERIFY(head == 0);",
          "content_same": false
        },
        {
          "line": 215,
          "old_api": "Error::from_errno(EIO)",
          "new_api": "strong_ref",
          "old_text": "Error::from_errno(EIO)",
          "new_text": "m_graphics_adapter.strong_ref()",
          "old_line_content": "        return Error::from_errno(EIO);",
          "new_line_content": "    auto adapter = m_graphics_adapter.strong_ref();",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": "set_y_offset",
          "new_api": "Error::from_errno(EIO)",
          "old_text": "adapter->set_y_offset(0, m_framebuffer_height)",
          "new_text": "Error::from_errno(EIO)",
          "old_line_content": "        if (!adapter->set_y_offset(0, m_framebuffer_height)) {",
          "new_line_content": "        return Error::from_errno(EIO);",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": "Error::from_errno(ENOTSUP)",
          "new_api": "set_y_offset",
          "old_text": "Error::from_errno(ENOTSUP)",
          "new_text": "adapter->set_y_offset(0, m_framebuffer_height)",
          "old_line_content": "            return Error::from_errno(ENOTSUP);",
          "new_line_content": "        if (!adapter->set_y_offset(0, m_framebuffer_height)) {",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "Error::from_errno(ENOTSUP)",
          "new_api": "set_y_offset",
          "old_text": "Error::from_errno(ENOTSUP)",
          "new_text": "adapter->set_y_offset(0, 0)",
          "old_line_content": "            return Error::from_errno(ENOTSUP);",
          "new_line_content": "        if (!adapter->set_y_offset(0, 0)) {",
          "content_same": false
        },
        {
          "line": 250,
          "old_api": "Error::from_errno(EIO)",
          "new_api": "strong_ref",
          "old_text": "Error::from_errno(EIO)",
          "new_text": "m_graphics_adapter.strong_ref()",
          "old_line_content": "        return Error::from_errno(EIO);",
          "new_line_content": "    auto adapter = m_graphics_adapter.strong_ref();",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 136,
          "old_api": null,
          "new_api": "Error::from_errno(EIO)",
          "old_text": null,
          "new_text": "Error::from_errno(EIO)",
          "old_line_content": "        return m_framebuffer_pitch * m_framebuffer_height * 2;",
          "new_line_content": "        return Error::from_errno(EIO);",
          "content_same": false
        },
        {
          "line": 137,
          "old_api": null,
          "new_api": "double_framebuffering_capable",
          "old_text": null,
          "new_text": "adapter->double_framebuffering_capable()",
          "old_line_content": "    return m_framebuffer_pitch * m_framebuffer_height;",
          "new_line_content": "    if (adapter->double_framebuffering_capable())",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": null,
          "new_api": "VERIFY",
          "old_text": null,
          "new_text": "VERIFY(head == 0)",
          "old_line_content": "    return m_framebuffer_pitch;",
          "new_line_content": "    VERIFY(head == 0);",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": null,
          "new_api": "VERIFY",
          "old_text": null,
          "new_text": "VERIFY(head == 0)",
          "old_line_content": "    return m_framebuffer_height;",
          "new_line_content": "    VERIFY(head == 0);",
          "content_same": false
        },
        {
          "line": 165,
          "old_api": null,
          "new_api": "VERIFY",
          "old_text": null,
          "new_text": "VERIFY(head == 0)",
          "old_line_content": "    return m_framebuffer_width;",
          "new_line_content": "    VERIFY(head == 0);",
          "content_same": false
        },
        {
          "line": 174,
          "old_api": null,
          "new_api": "VERIFY",
          "old_text": null,
          "new_text": "VERIFY(head == 0)",
          "old_line_content": "    return m_y_offset;",
          "new_line_content": "    VERIFY(head == 0);",
          "content_same": false
        },
        {
          "line": 183,
          "old_api": null,
          "new_api": "VERIFY",
          "old_text": null,
          "new_text": "VERIFY(head == 0)",
          "old_line_content": "    return m_y_offset == 0 ? 0 : 1;",
          "new_line_content": "    VERIFY(head == 0);",
          "content_same": false
        },
        {
          "line": 62,
          "old_api": null,
          "new_api": "is_error",
          "old_text": null,
          "new_text": "result.is_error()",
          "old_line_content": "    return m_userspace_framebuffer_region;",
          "new_line_content": "    if (auto result = m_userspace_framebuffer_region->set_write_combine(true); result.is_error())",
          "content_same": false
        },
        {
          "line": 63,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "result.error()",
          "old_line_content": "}",
          "new_line_content": "        dbgln(\"FramebufferDevice: Failed to enable Write-Combine on Framebuffer: {}\", result.error());",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": null,
          "new_api": "VERIFY",
          "old_text": null,
          "new_text": "VERIFY(head == 0)",
          "old_line_content": "    MutexLocker resolution_locker(m_resolution_lock);",
          "new_line_content": "    VERIFY(head == 0);",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": null,
          "new_api": "Error::from_errno(EIO)",
          "old_text": null,
          "new_text": "Error::from_errno(EIO)",
          "old_line_content": "    // FIXME: Find a better way to return here a ErrorOr<void>.",
          "new_line_content": "        return Error::from_errno(EIO);",
          "content_same": false
        },
        {
          "line": 199,
          "old_api": null,
          "new_api": "try_to_set_resolution",
          "old_text": null,
          "new_text": "adapter->try_to_set_resolution(0, width, height)",
          "old_line_content": "    if (!result)",
          "new_line_content": "    auto result = adapter->try_to_set_resolution(0, width, height);",
          "content_same": false
        },
        {
          "line": 74,
          "old_api": null,
          "new_api": "release_value",
          "old_text": null,
          "new_text": "framebuffer_length_or_error.release_value()",
          "old_line_content": "    auto vmobject = m_swapped_framebuffer_vmobject;",
          "new_line_content": "    size_t rounded_framebuffer_length = Memory::page_round_up(framebuffer_length_or_error.release_value()).release_value_but_fixme_should_propagate_errors();",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": null,
          "new_api": "Error::from_errno(ENOTSUP)",
          "old_text": null,
          "new_text": "Error::from_errno(ENOTSUP)",
          "old_line_content": "    m_framebuffer_height = height;",
          "new_line_content": "        return Error::from_errno(ENOTSUP);",
          "content_same": false
        },
        {
          "line": 77,
          "old_api": null,
          "new_api": "release_nonnull",
          "old_text": null,
          "new_text": "vmobject.release_nonnull()",
          "old_line_content": "    m_graphical_writes_enabled = false;",
          "new_line_content": "    m_userspace_framebuffer_region->set_vmobject(vmobject.release_nonnull());",
          "content_same": false
        },
        {
          "line": 78,
          "old_api": null,
          "new_api": "remap",
          "old_text": null,
          "new_text": "m_userspace_framebuffer_region->remap()",
          "old_line_content": "}",
          "new_line_content": "    m_userspace_framebuffer_region->remap();",
          "content_same": false
        },
        {
          "line": 89,
          "old_api": null,
          "new_api": "buffer_length",
          "old_text": null,
          "new_text": "buffer_length(0)",
          "old_line_content": "",
          "new_line_content": "    auto framebuffer_length_or_error = buffer_length(0);",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": null,
          "new_api": "release_value",
          "old_text": null,
          "new_text": "framebuffer_length_or_error.release_value()",
          "old_line_content": "    auto vmobject = m_userspace_real_framebuffer_vmobject;",
          "new_line_content": "    size_t rounded_framebuffer_length = Memory::page_round_up(framebuffer_length_or_error.release_value()).release_value_but_fixme_should_propagate_errors();",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": null,
          "new_api": "Error::from_errno(ENOTSUP)",
          "old_text": null,
          "new_text": "Error::from_errno(ENOTSUP)",
          "old_line_content": "        m_y_offset = m_framebuffer_height;",
          "new_line_content": "            return Error::from_errno(ENOTSUP);",
          "content_same": false
        },
        {
          "line": 95,
          "old_api": null,
          "new_api": "release_nonnull",
          "old_text": null,
          "new_text": "vmobject.release_nonnull()",
          "old_line_content": "    m_graphical_writes_enabled = true;",
          "new_line_content": "    m_userspace_framebuffer_region->set_vmobject(vmobject.release_nonnull());",
          "content_same": false
        },
        {
          "line": 96,
          "old_api": null,
          "new_api": "remap",
          "old_text": null,
          "new_text": "m_userspace_framebuffer_region->remap()",
          "old_line_content": "}",
          "new_line_content": "    m_userspace_framebuffer_region->remap();",
          "content_same": false
        },
        {
          "line": 227,
          "old_api": null,
          "new_api": "Error::from_errno(ENOTSUP)",
          "old_text": null,
          "new_text": "Error::from_errno(ENOTSUP)",
          "old_line_content": "        m_y_offset = 0;",
          "new_line_content": "            return Error::from_errno(ENOTSUP);",
          "content_same": false
        },
        {
          "line": 108,
          "old_api": null,
          "new_api": "allocate_kernel_region_with_vmobject",
          "old_text": null,
          "new_text": "MM.allocate_kernel_region_with_vmobject(*m_real_framebuffer_vmobject, framebuffer_length, \"Framebuffer\", Memory::Region::Access::ReadWrite)",
          "old_line_content": "    return {};",
          "new_line_content": "    m_real_framebuffer_region = TRY(MM.allocate_kernel_region_with_vmobject(*m_real_framebuffer_vmobject, framebuffer_length, \"Framebuffer\", Memory::Region::Access::ReadWrite));",
          "content_same": false
        },
        {
          "line": 109,
          "old_api": null,
          "new_api": "allocate_kernel_region_with_vmobject",
          "old_text": null,
          "new_text": "MM.allocate_kernel_region_with_vmobject(*m_swapped_framebuffer_vmobject, framebuffer_length, \"Framebuffer Swap (Blank)\", Memory::Region::Access::ReadWrite)",
          "old_line_content": "}",
          "new_line_content": "    m_swapped_framebuffer_region = TRY(MM.allocate_kernel_region_with_vmobject(*m_swapped_framebuffer_vmobject, framebuffer_length, \"Framebuffer Swap (Blank)\", Memory::Region::Access::ReadWrite));",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": null,
          "new_api": "VERIFY_NOT_REACHED",
          "old_text": null,
          "new_text": "VERIFY_NOT_REACHED()",
          "old_line_content": "ErrorOr<void> FramebufferDevice::flush_rectangle(size_t, FBRect const&)",
          "new_line_content": "    VERIFY_NOT_REACHED();",
          "content_same": false
        },
        {
          "line": 124,
          "old_api": null,
          "new_api": "minor",
          "old_text": null,
          "new_text": "minor()",
          "old_line_content": "",
          "new_line_content": "    dbgln(\"Framebuffer {}: address={}, pitch={}, width={}, height={}\", minor(), addr, pitch, width, height);",
          "content_same": false
        },
        {
          "line": 245,
          "old_api": null,
          "new_api": "VERIFY_NOT_REACHED",
          "old_text": null,
          "new_text": "VERIFY_NOT_REACHED()",
          "old_line_content": "",
          "new_line_content": "    VERIFY_NOT_REACHED();",
          "content_same": false
        },
        {
          "line": 123,
          "old_api": null,
          "new_api": "VERIFY",
          "old_text": null,
          "new_text": "VERIFY(m_framebuffer_height)",
          "old_line_content": "}",
          "new_line_content": "    VERIFY(m_framebuffer_height);",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": null,
          "new_api": "Error::from_errno(EIO)",
          "old_text": null,
          "new_text": "Error::from_errno(EIO)",
          "old_line_content": "}",
          "new_line_content": "        return Error::from_errno(EIO);",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": null,
          "new_api": "get_edid",
          "old_text": null,
          "new_text": "adapter->get_edid(head)",
          "old_line_content": "",
          "new_line_content": "    return adapter->get_edid(head);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 130,
          "old_api": "VERIFY",
          "new_api": null,
          "old_text": "VERIFY(head == 0)",
          "new_text": null,
          "old_line_content": "    VERIFY(head == 0);",
          "new_line_content": "    // We take care to verify this at the GenericFramebufferDevice::ioctl method",
          "content_same": false
        },
        {
          "line": 135,
          "old_api": "double_framebuffering_capable",
          "new_api": null,
          "old_text": "adapter->double_framebuffering_capable()",
          "new_text": null,
          "old_line_content": "    if (adapter->double_framebuffering_capable())",
          "new_line_content": "    if (!adapter)",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": "VERIFY",
          "new_api": null,
          "old_text": "VERIFY(head == 0)",
          "new_text": null,
          "old_line_content": "    VERIFY(head == 0);",
          "new_line_content": "    // We take care to verify this at the GenericFramebufferDevice::ioctl method",
          "content_same": false
        },
        {
          "line": 154,
          "old_api": "VERIFY",
          "new_api": null,
          "old_text": "VERIFY(head == 0)",
          "new_text": null,
          "old_line_content": "    VERIFY(head == 0);",
          "new_line_content": "    // We take care to verify this at the GenericFramebufferDevice::ioctl method",
          "content_same": false
        },
        {
          "line": 163,
          "old_api": "VERIFY",
          "new_api": null,
          "old_text": "VERIFY(head == 0)",
          "new_text": null,
          "old_line_content": "    VERIFY(head == 0);",
          "new_line_content": "    // We take care to verify this at the GenericFramebufferDevice::ioctl method",
          "content_same": false
        },
        {
          "line": 172,
          "old_api": "VERIFY",
          "new_api": null,
          "old_text": "VERIFY(head == 0)",
          "new_text": null,
          "old_line_content": "    VERIFY(head == 0);",
          "new_line_content": "    // We take care to verify this at the GenericFramebufferDevice::ioctl method",
          "content_same": false
        },
        {
          "line": 181,
          "old_api": "VERIFY",
          "new_api": null,
          "old_text": "VERIFY(head == 0)",
          "new_text": null,
          "old_line_content": "    VERIFY(head == 0);",
          "new_line_content": "    // We take care to verify this at the GenericFramebufferDevice::ioctl method",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "VERIFY",
          "new_api": null,
          "old_text": "VERIFY(head == 0)",
          "new_text": null,
          "old_line_content": "    VERIFY(head == 0);",
          "new_line_content": "    // We take care to verify this at the GenericFramebufferDevice::ioctl method",
          "content_same": false
        },
        {
          "line": 194,
          "old_api": "strong_ref",
          "new_api": null,
          "old_text": "m_graphics_adapter.strong_ref()",
          "new_text": null,
          "old_line_content": "    auto adapter = m_graphics_adapter.strong_ref();",
          "new_line_content": "    MutexLocker buffer_offset_locker(m_buffer_offset_lock);",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": "try_to_set_resolution",
          "new_api": null,
          "old_text": "adapter->try_to_set_resolution(0, width, height)",
          "new_text": null,
          "old_line_content": "    auto result = adapter->try_to_set_resolution(0, width, height);",
          "new_line_content": "    if (!adapter)",
          "content_same": false
        },
        {
          "line": 70,
          "old_api": "buffer_length",
          "new_api": null,
          "old_text": "buffer_length(0)",
          "new_text": null,
          "old_line_content": "    auto framebuffer_length_or_error = buffer_length(0);",
          "new_line_content": "    if (!m_userspace_framebuffer_region)",
          "content_same": false
        },
        {
          "line": 71,
          "old_api": "is_error",
          "new_api": null,
          "old_text": "framebuffer_length_or_error.is_error()",
          "new_text": null,
          "old_line_content": "    VERIFY(!framebuffer_length_or_error.is_error());",
          "new_line_content": "        return;",
          "content_same": false
        },
        {
          "line": 200,
          "old_api": "Error::from_errno(ENOTSUP)",
          "new_api": null,
          "old_text": "Error::from_errno(ENOTSUP)",
          "new_text": null,
          "old_line_content": "        return Error::from_errno(ENOTSUP);",
          "new_line_content": "    // FIXME: Find a better way to return here a ErrorOr<void>.",
          "content_same": false
        },
        {
          "line": 76,
          "old_api": "remap",
          "new_api": null,
          "old_text": "m_userspace_framebuffer_region->remap()",
          "new_text": null,
          "old_line_content": "    m_userspace_framebuffer_region->remap();",
          "new_line_content": "    auto vmobject = m_swapped_framebuffer_vmobject;",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "VERIFY",
          "new_api": null,
          "old_text": "VERIFY(head == 0)",
          "new_text": null,
          "old_line_content": "    VERIFY(head == 0);",
          "new_line_content": "    // We take care to verify this at the GenericFramebufferDevice::ioctl method",
          "content_same": false
        },
        {
          "line": 87,
          "old_api": "buffer_length",
          "new_api": null,
          "old_text": "buffer_length(0)",
          "new_text": null,
          "old_line_content": "    auto framebuffer_length_or_error = buffer_length(0);",
          "new_line_content": "    // FIXME: if we happen to have multiple Framebuffers that are writing to that location",
          "content_same": false
        },
        {
          "line": 88,
          "old_api": "is_error",
          "new_api": null,
          "old_text": "framebuffer_length_or_error.is_error()",
          "new_text": null,
          "old_line_content": "    VERIFY(!framebuffer_length_or_error.is_error());",
          "new_line_content": "    // we will experience glitches...",
          "content_same": false
        },
        {
          "line": 91,
          "old_api": "as_ptr",
          "new_api": null,
          "old_text": "m_swapped_framebuffer_region->vaddr().as_ptr()",
          "new_text": null,
          "old_line_content": "    memcpy(m_real_framebuffer_region->vaddr().as_ptr(), m_swapped_framebuffer_region->vaddr().as_ptr(), rounded_framebuffer_length);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 94,
          "old_api": "remap",
          "new_api": null,
          "old_text": "m_userspace_framebuffer_region->remap()",
          "new_text": null,
          "old_line_content": "    m_userspace_framebuffer_region->remap();",
          "new_line_content": "    auto vmobject = m_userspace_real_framebuffer_vmobject;",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": "set_y_offset",
          "new_api": null,
          "old_text": "adapter->set_y_offset(0, 0)",
          "new_text": null,
          "old_line_content": "        if (!adapter->set_y_offset(0, 0)) {",
          "new_line_content": "        m_y_offset = m_framebuffer_height;",
          "content_same": false
        },
        {
          "line": 102,
          "old_api": "buffer_length",
          "new_api": null,
          "old_text": "buffer_length(0)",
          "new_text": null,
          "old_line_content": "    auto framebuffer_length = TRY(buffer_length(0));",
          "new_line_content": "    // FIXME: Would be nice to be able to unify this with mmap above, but this",
          "content_same": false
        },
        {
          "line": 103,
          "old_api": "Memory::page_round_up(framebuffer_length)",
          "new_api": null,
          "old_text": "Memory::page_round_up(framebuffer_length)",
          "new_text": null,
          "old_line_content": "    framebuffer_length = TRY(Memory::page_round_up(framebuffer_length));",
          "new_line_content": "    //        function is UNMAP_AFTER_INIT for the time being.",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": "VERIFY_NOT_REACHED",
          "new_api": null,
          "old_text": "VERIFY_NOT_REACHED()",
          "new_text": null,
          "old_line_content": "    VERIFY_NOT_REACHED();",
          "new_line_content": "    // We take care to verify this at the GenericFramebufferDevice::ioctl method",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": "VERIFY_NOT_REACHED",
          "new_api": null,
          "old_text": "VERIFY_NOT_REACHED()",
          "new_text": null,
          "old_line_content": "    VERIFY_NOT_REACHED();",
          "new_line_content": "    // We take care to verify this at the GenericFramebufferDevice::ioctl method",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": "is_null",
          "new_api": null,
          "old_text": "m_framebuffer_address.is_null()",
          "new_text": null,
          "old_line_content": "    VERIFY(!m_framebuffer_address.is_null());",
          "new_line_content": "    , m_framebuffer_height(height)",
          "content_same": false
        },
        {
          "line": 119,
          "old_api": "VERIFY",
          "new_api": null,
          "old_text": "VERIFY(m_framebuffer_pitch)",
          "new_text": null,
          "old_line_content": "    VERIFY(m_framebuffer_pitch);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": "strong_ref",
          "new_api": null,
          "old_text": "m_graphics_adapter.strong_ref()",
          "new_text": null,
          "old_line_content": "    auto adapter = m_graphics_adapter.strong_ref();",
          "new_line_content": "ErrorOr<ByteBuffer> FramebufferDevice::get_edid(size_t head) const",
          "content_same": false
        },
        {
          "line": 251,
          "old_api": "get_edid",
          "new_api": null,
          "old_text": "adapter->get_edid(head)",
          "new_text": null,
          "old_line_content": "    return adapter->get_edid(head);",
          "new_line_content": "    if (!adapter)",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 20,
      "total_additions": 30,
      "total_deletions": 28,
      "total_api_changes": 78
    },
    "non_api_changes": {
      "has_non_api_changes": false,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 78,
        "non_api_lines": 0,
        "non_api_line_numbers": []
      }
    },
    "api_calls_before": 98,
    "api_calls_after": 102,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 0,
      "total_diff_lines": 14
    }
  }
}