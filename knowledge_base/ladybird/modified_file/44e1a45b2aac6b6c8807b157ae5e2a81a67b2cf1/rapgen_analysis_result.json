{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/44e1a45b2aac6b6c8807b157ae5e2a81a67b2cf1",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/44e1a45b2aac6b6c8807b157ae5e2a81a67b2cf1/before.h",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/44e1a45b2aac6b6c8807b157ae5e2a81a67b2cf1/after.h",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/44e1a45b2aac6b6c8807b157ae5e2a81a67b2cf1/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 176,
          "old_api": "size",
          "new_api": "move",
          "old_text": "tmp.size()",
          "new_text": "move(other.m_impl)",
          "old_line_content": "        ensure_capacity(size() + tmp.size());",
          "new_line_content": "            m_impl = move(other.m_impl);",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": "size",
          "new_api": "padded_capacity",
          "old_text": "size()",
          "new_text": "padded_capacity(neededCapacity)",
          "old_line_content": "            for (size_t i = 0; i < size(); ++i) {",
          "new_line_content": "        size_t new_capacity = padded_capacity(neededCapacity);",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": "at",
          "new_api": "VectorImpl<T, Allocator>::create(new_capacity)",
          "old_text": "m_impl->at(i)",
          "new_text": "VectorImpl<T, Allocator>::create(new_capacity)",
          "old_line_content": "                new (new_impl->slot(i)) T(move(m_impl->at(i)));",
          "new_line_content": "        auto new_impl = VectorImpl<T, Allocator>::create(new_capacity);",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": "Allocator::deallocate(m_impl)",
          "new_api": "size",
          "old_text": "Allocator::deallocate(m_impl)",
          "new_text": "size()",
          "old_line_content": "            Allocator::deallocate(m_impl);",
          "new_line_content": "            for (size_t i = 0; i < size(); ++i) {",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 261,
          "old_api": null,
          "new_api": "Iterator",
          "old_text": null,
          "new_text": "Iterator(*this, 0)",
          "old_line_content": "    public:",
          "new_line_content": "    Iterator begin() { return Iterator(*this, 0); }",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "size()",
          "old_line_content": "        bool operator!=(const ConstIterator& other) { return m_index != other.m_index; }",
          "new_line_content": "    Iterator end() { return Iterator(*this, size()); }",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": null,
          "new_api": "ConstIterator",
          "old_text": null,
          "new_text": "ConstIterator(*this, 0)",
          "old_line_content": "    static size_t padded_capacity(size_t capacity)",
          "new_line_content": "    ConstIterator begin() const { return ConstIterator(*this, 0); }",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "size()",
          "old_line_content": "    {",
          "new_line_content": "    ConstIterator end() const { return ConstIterator(*this, size()); }",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": null,
          "new_api": "max",
          "old_text": null,
          "new_text": "max(size_t(4), capacity + (capacity / 4) + 4)",
          "old_line_content": "};",
          "new_line_content": "        return max(size_t(4), capacity + (capacity / 4) + 4);",
          "content_same": false
        },
        {
          "line": 179,
          "old_api": null,
          "new_api": "move",
          "old_text": null,
          "new_text": "move(other)",
          "old_line_content": "        }",
          "new_line_content": "        Vector<T> tmp = move(other);",
          "content_same": false
        },
        {
          "line": 180,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "tmp.size()",
          "old_line_content": "    }",
          "new_line_content": "        ensure_capacity(size() + tmp.size());",
          "content_same": false
        },
        {
          "line": 182,
          "old_api": null,
          "new_api": "move",
          "old_text": null,
          "new_text": "move(v)",
          "old_line_content": "    void unchecked_append(T&& value)",
          "new_line_content": "            unchecked_append(move(v));",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": null,
          "new_api": "capacity",
          "old_text": null,
          "new_text": "capacity()",
          "old_line_content": "",
          "new_line_content": "        ASSERT((size() + 1) <= capacity());",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": null,
          "new_api": "move",
          "old_text": null,
          "new_text": "move(value)",
          "old_line_content": "    void unchecked_append(const T& value)",
          "new_line_content": "        new (m_impl->slot(m_impl->m_size)) T(move(value));",
          "content_same": false
        },
        {
          "line": 195,
          "old_api": null,
          "new_api": "slot",
          "old_text": null,
          "new_text": "m_impl->slot(m_impl->m_size)",
          "old_line_content": "    void append(T&& value)",
          "new_line_content": "        new (m_impl->slot(m_impl->m_size)) T(value);",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "size()",
          "old_line_content": "",
          "new_line_content": "        ensure_capacity(size() + 1);",
          "content_same": false
        },
        {
          "line": 202,
          "old_api": null,
          "new_api": "move",
          "old_text": null,
          "new_text": "move(value)",
          "old_line_content": "    void append(const T& value)",
          "new_line_content": "        new (m_impl->slot(m_impl->m_size)) T(move(value));",
          "content_same": false
        },
        {
          "line": 208,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "size()",
          "old_line_content": "",
          "new_line_content": "        ensure_capacity(size() + 1);",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": null,
          "new_api": "slot",
          "old_text": null,
          "new_text": "m_impl->slot(m_impl->m_size)",
          "old_line_content": "    void append(const T* values, size_t count)",
          "new_line_content": "        new (m_impl->slot(m_impl->m_size)) T(value);",
          "content_same": false
        },
        {
          "line": 215,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "size()",
          "old_line_content": "    }",
          "new_line_content": "        ensure_capacity(size() + count);",
          "content_same": false
        },
        {
          "line": 217,
          "old_api": null,
          "new_api": "slot",
          "old_text": null,
          "new_text": "m_impl->slot(m_impl->m_size + i)",
          "old_line_content": "    void ensure_capacity(size_t neededCapacity)",
          "new_line_content": "            new (m_impl->slot(m_impl->m_size + i)) T(values[i]);",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": null,
          "new_api": "capacity",
          "old_text": null,
          "new_text": "capacity()",
          "old_line_content": "        if (m_impl) {",
          "new_line_content": "        if (capacity() >= neededCapacity)",
          "content_same": false
        },
        {
          "line": 230,
          "old_api": null,
          "new_api": "at",
          "old_text": null,
          "new_text": "m_impl->at(i)",
          "old_line_content": "        }",
          "new_line_content": "                new (new_impl->slot(i)) T(move(m_impl->at(i)));",
          "content_same": false
        },
        {
          "line": 231,
          "old_api": null,
          "new_api": "at",
          "old_text": null,
          "new_text": "m_impl->at(i).~T()",
          "old_line_content": "        m_impl = new_impl;",
          "new_line_content": "                m_impl->at(i).~T();",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": null,
          "new_api": "Allocator::deallocate(m_impl)",
          "old_text": null,
          "new_text": "Allocator::deallocate(m_impl)",
          "old_line_content": "",
          "new_line_content": "            Allocator::deallocate(m_impl);",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": null,
          "new_api": "ensure_capacity",
          "old_text": null,
          "new_text": "ensure_capacity(new_size)",
          "old_line_content": "    }",
          "new_line_content": "        ensure_capacity(new_size);",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "size()",
          "old_line_content": "",
          "new_line_content": "        for (size_t i = size(); i < new_size; ++i)",
          "content_same": false
        },
        {
          "line": 245,
          "old_api": null,
          "new_api": "slot",
          "old_text": null,
          "new_text": "m_impl->slot(i)",
          "old_line_content": "    class Iterator {",
          "new_line_content": "            new (m_impl->slot(i)) T;",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 257,
          "old_api": "Iterator",
          "new_api": null,
          "old_text": "Iterator(*this, 0)",
          "new_text": null,
          "old_line_content": "    Iterator begin() { return Iterator(*this, 0); }",
          "new_line_content": "        Vector& m_vector;",
          "content_same": false
        },
        {
          "line": 258,
          "old_api": "size",
          "new_api": null,
          "old_text": "size()",
          "new_text": null,
          "old_line_content": "    Iterator end() { return Iterator(*this, size()); }",
          "new_line_content": "        size_t m_index { 0 };",
          "content_same": false
        },
        {
          "line": 272,
          "old_api": "ConstIterator",
          "new_api": null,
          "old_text": "ConstIterator(*this, 0)",
          "new_text": null,
          "old_line_content": "    ConstIterator begin() const { return ConstIterator(*this, 0); }",
          "new_line_content": "        const Vector& m_vector;",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": "size",
          "new_api": null,
          "old_text": "size()",
          "new_text": null,
          "old_line_content": "    ConstIterator end() const { return ConstIterator(*this, size()); }",
          "new_line_content": "        size_t m_index { 0 };",
          "content_same": false
        },
        {
          "line": 278,
          "old_api": "max",
          "new_api": null,
          "old_text": "max(size_t(4), capacity + (capacity / 4) + 4)",
          "new_text": null,
          "old_line_content": "        return max(size_t(4), capacity + (capacity / 4) + 4);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": "move",
          "new_api": null,
          "old_text": "move(other)",
          "new_text": null,
          "old_line_content": "        Vector<T> tmp = move(other);",
          "new_line_content": "        if (!m_impl) {",
          "content_same": false
        },
        {
          "line": 178,
          "old_api": "move",
          "new_api": null,
          "old_text": "move(v)",
          "new_text": null,
          "old_line_content": "            unchecked_append(move(v));",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 184,
          "old_api": "capacity",
          "new_api": null,
          "old_text": "capacity()",
          "new_text": null,
          "old_line_content": "        ASSERT((size() + 1) <= capacity());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 185,
          "old_api": "move",
          "new_api": null,
          "old_text": "move(value)",
          "new_text": null,
          "old_line_content": "        new (m_impl->slot(m_impl->m_size)) T(move(value));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "slot",
          "new_api": null,
          "old_text": "m_impl->slot(m_impl->m_size)",
          "new_text": null,
          "old_line_content": "        new (m_impl->slot(m_impl->m_size)) T(value);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": "size",
          "new_api": null,
          "old_text": "size()",
          "new_text": null,
          "old_line_content": "        ensure_capacity(size() + 1);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 198,
          "old_api": "move",
          "new_api": null,
          "old_text": "move(value)",
          "new_text": null,
          "old_line_content": "        new (m_impl->slot(m_impl->m_size)) T(move(value));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 204,
          "old_api": "size",
          "new_api": null,
          "old_text": "size()",
          "new_text": null,
          "old_line_content": "        ensure_capacity(size() + 1);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "slot",
          "new_api": null,
          "old_text": "m_impl->slot(m_impl->m_size)",
          "new_text": null,
          "old_line_content": "        new (m_impl->slot(m_impl->m_size)) T(value);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 211,
          "old_api": "size",
          "new_api": null,
          "old_text": "size()",
          "new_text": null,
          "old_line_content": "        ensure_capacity(size() + count);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": "slot",
          "new_api": null,
          "old_text": "m_impl->slot(m_impl->m_size + i)",
          "new_text": null,
          "old_line_content": "            new (m_impl->slot(m_impl->m_size + i)) T(values[i]);",
          "new_line_content": "    void append(const T* values, size_t count)",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": "capacity",
          "new_api": null,
          "old_text": "capacity()",
          "new_text": null,
          "old_line_content": "        if (capacity() >= neededCapacity)",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": "padded_capacity",
          "new_api": null,
          "old_text": "padded_capacity(neededCapacity)",
          "new_text": null,
          "old_line_content": "        size_t new_capacity = padded_capacity(neededCapacity);",
          "new_line_content": "    void ensure_capacity(size_t neededCapacity)",
          "content_same": false
        },
        {
          "line": 222,
          "old_api": "VectorImpl<T, Allocator>::create(new_capacity)",
          "new_api": null,
          "old_text": "VectorImpl<T, Allocator>::create(new_capacity)",
          "new_text": null,
          "old_line_content": "        auto new_impl = VectorImpl<T, Allocator>::create(new_capacity);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 227,
          "old_api": "at",
          "new_api": null,
          "old_text": "m_impl->at(i).~T()",
          "new_text": null,
          "old_line_content": "                m_impl->at(i).~T();",
          "new_line_content": "        if (m_impl) {",
          "content_same": false
        },
        {
          "line": 236,
          "old_api": "size",
          "new_api": null,
          "old_text": "size()",
          "new_text": null,
          "old_line_content": "        ASSERT(new_size >= size());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 239,
          "old_api": "ensure_capacity",
          "new_api": null,
          "old_text": "ensure_capacity(new_size)",
          "new_text": null,
          "old_line_content": "        ensure_capacity(new_size);",
          "new_line_content": "    {",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": "slot",
          "new_api": null,
          "old_text": "m_impl->slot(i)",
          "new_text": null,
          "old_line_content": "            new (m_impl->slot(i)) T;",
          "new_line_content": "        if (!new_size)",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 4,
      "total_additions": 24,
      "total_deletions": 23,
      "total_api_changes": 51
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 4,
        "api_related_lines": 51,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          177
        ]
      }
    },
    "api_calls_before": 109,
    "api_calls_after": 110,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 0,
      "total_diff_lines": 16
    }
  }
}