{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/cae184d7cfb721c8046bcf72987b8f54eb5d3258",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/cae184d7cfb721c8046bcf72987b8f54eb5d3258/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/cae184d7cfb721c8046bcf72987b8f54eb5d3258/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/cae184d7cfb721c8046bcf72987b8f54eb5d3258/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 443,
          "old_api": "append",
          "new_api": "characters_without_null_termination",
          "old_text": "positions.append(current_position + *maybe_position)",
          "new_text": "AK::memmem_optional(\n            haystack.characters_without_null_termination() + current_position, haystack.length() - current_position,\n            needle.characters_without_null_termination(), needle.length())",
          "old_line_content": "        positions.append(current_position + *maybe_position);",
          "new_line_content": "        auto maybe_position = AK::memmem_optional(",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": "is_ascii_lower_alpha",
          "new_api": "is_ascii_upper_alpha",
          "old_text": "is_ascii_lower_alpha(next_ch)",
          "new_text": "is_ascii_upper_alpha(current_char)",
          "old_line_content": "        if (is_ascii_upper_alpha(current_char) && is_ascii_lower_alpha(next_ch))",
          "new_line_content": "        if (is_ascii_lower_alpha(previous_ch) && is_ascii_upper_alpha(current_char))",
          "content_same": false
        },
        {
          "line": 512,
          "old_api": "length",
          "new_api": "to_byte_string",
          "old_text": "str.length()",
          "new_text": "builder.to_byte_string()",
          "old_line_content": "    StringBuilder builder(str.length());",
          "new_line_content": "    return builder.to_byte_string();",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": "to_byte_string",
          "new_api": "to_ascii_uppercase",
          "old_text": "builder.to_byte_string()",
          "new_text": "to_ascii_uppercase(ch)",
          "old_line_content": "    return builder.to_byte_string();",
          "new_line_content": "            builder.append(to_ascii_uppercase(ch));",
          "content_same": false
        },
        {
          "line": 539,
          "old_api": "find",
          "new_api": "length",
          "old_text": "remaining.find(needle)",
          "new_text": "needle.length()",
          "old_line_content": "            auto maybe_pos = remaining.find(needle);",
          "new_line_content": "    StringView remaining = str.substring_view(first_replacement_position + needle.length());",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": "append",
          "new_api": "is_empty",
          "old_text": "replaced_string.append(replacement)",
          "new_text": "remaining.is_empty()",
          "old_line_content": "            replaced_string.append(replacement);",
          "new_line_content": "        while (!remaining.is_empty()) {",
          "content_same": false
        },
        {
          "line": 544,
          "old_api": "length",
          "new_api": "find",
          "old_text": "needle.length()",
          "new_text": "remaining.find(needle)",
          "old_line_content": "            remaining = remaining.substring_view(*maybe_pos + needle.length());",
          "new_line_content": "            auto maybe_pos = remaining.find(needle);",
          "content_same": false
        },
        {
          "line": 570,
          "old_api": "to_byte_string",
          "new_api": "find",
          "old_text": "resulting_builder.to_byte_string()",
          "new_text": "str.find(needle)",
          "old_line_content": "    return resulting_builder.to_byte_string();",
          "new_line_content": "    auto maybe_first = str.find(needle);",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": "is_empty",
          "new_api": "to_byte_string",
          "old_text": "haystack.is_empty()",
          "new_text": "resulting_builder.to_byte_string()",
          "old_line_content": "    if (haystack.is_empty())",
          "new_line_content": "    return resulting_builder.to_byte_string();",
          "content_same": false
        },
        {
          "line": 580,
          "old_api": "find",
          "new_api": "is_empty",
          "old_text": "source_bytes.find(needle)",
          "new_text": "haystack.is_empty()",
          "old_line_content": "    auto maybe_first = source_bytes.find(needle);",
          "new_line_content": "    if (haystack.is_empty())",
          "content_same": false
        },
        {
          "line": 585,
          "old_api": "to_string",
          "new_api": "find",
          "old_text": "resulting_builder.to_string()",
          "new_text": "source_bytes.find(needle)",
          "old_line_content": "    return resulting_builder.to_string();",
          "new_line_content": "    auto maybe_first = source_bytes.find(needle);",
          "content_same": false
        },
        {
          "line": 597,
          "old_api": "substring_view",
          "new_api": "is_empty",
          "old_text": "str.substring_view(i).starts_with(needle)",
          "new_text": "needle.is_empty()",
          "old_line_content": "        if (str.substring_view(i).starts_with(needle))",
          "new_line_content": "    if (needle.is_empty())",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 517,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "str.length()",
          "old_line_content": "        else",
          "new_line_content": "    StringBuilder builder(str.length());",
          "content_same": false
        },
        {
          "line": 520,
          "old_api": null,
          "new_api": "is_ascii_lower_alpha",
          "old_text": null,
          "new_text": "is_ascii_lower_alpha(ch)",
          "old_line_content": "",
          "new_line_content": "        if (is_ascii_lower_alpha(ch))",
          "content_same": false
        },
        {
          "line": 523,
          "old_api": null,
          "new_api": "to_ascii_lowercase",
          "old_text": null,
          "new_text": "to_ascii_lowercase(ch)",
          "old_line_content": "",
          "new_line_content": "            builder.append(to_ascii_lowercase(ch));",
          "content_same": false
        },
        {
          "line": 526,
          "old_api": null,
          "new_api": "to_byte_string",
          "old_text": null,
          "new_text": "builder.to_byte_string()",
          "old_line_content": "// different route to construct its output.",
          "new_line_content": "    return builder.to_byte_string();",
          "content_same": false
        },
        {
          "line": 536,
          "old_api": null,
          "new_api": "substring_view",
          "old_text": null,
          "new_text": "str.substring_view(0, first_replacement_position)",
          "old_line_content": "    switch (replace_mode) {",
          "new_line_content": "    replaced_string.append(str.substring_view(0, first_replacement_position));",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "replaced_string.append(replacement)",
          "old_line_content": "    case ReplaceMode::All:",
          "new_line_content": "    replaced_string.append(replacement);",
          "content_same": false
        },
        {
          "line": 545,
          "old_api": null,
          "new_api": "has_value",
          "old_text": null,
          "new_text": "maybe_pos.has_value()",
          "old_line_content": "        }",
          "new_line_content": "            if (!maybe_pos.has_value())",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "needle.length()",
          "old_line_content": "            return value;",
          "new_line_content": "    for (size_t i = haystack.length() - needle.length();; --i) {",
          "content_same": false
        },
        {
          "line": 547,
          "old_api": null,
          "new_api": "substring_view",
          "old_text": null,
          "new_text": "remaining.substring_view(0, *maybe_pos)",
          "old_line_content": "    case ReplaceMode::FirstOnly:",
          "new_line_content": "            replaced_string.append(remaining.substring_view(0, *maybe_pos));",
          "content_same": false
        },
        {
          "line": 548,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "replaced_string.append(replacement)",
          "old_line_content": "        // We already made the first replacement.",
          "new_line_content": "            replaced_string.append(replacement);",
          "content_same": false
        },
        {
          "line": 549,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "needle.length()",
          "old_line_content": "        break;",
          "new_line_content": "            remaining = remaining.substring_view(*maybe_pos + needle.length());",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "needle.length()",
          "old_line_content": "    }",
          "new_line_content": "        if (haystack.substring_view(i, needle.length()) == needle)",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "replaced_string.append(remaining)",
          "old_line_content": "ByteString replace(StringView str, StringView needle, StringView replacement,",
          "new_line_content": "    replaced_string.append(remaining);",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "haystack.length()",
          "old_line_content": "}",
          "new_line_content": "    for (size_t i = haystack.length(); i > 0; --i) {",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": null,
          "new_api": "is_empty",
          "old_text": null,
          "new_text": "str.is_empty()",
          "old_line_content": "        return str;",
          "new_line_content": "    if (str.is_empty())",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "haystack.length()",
          "old_line_content": "            break;",
          "new_line_content": "    while (current_position <= haystack.length()) {",
          "content_same": false
        },
        {
          "line": 571,
          "old_api": null,
          "new_api": "has_value",
          "old_text": null,
          "new_text": "maybe_first.has_value()",
          "old_line_content": "}",
          "new_line_content": "    if (!maybe_first.has_value())",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "haystack.length()",
          "old_line_content": "        current_position += *maybe_position + 1;",
          "new_line_content": "            haystack.characters_without_null_termination() + current_position, haystack.length() - current_position,",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "needle.length()",
          "old_line_content": "    }",
          "new_line_content": "            needle.characters_without_null_termination(), needle.length());",
          "content_same": false
        },
        {
          "line": 574,
          "old_api": null,
          "new_api": "replace_into_builder",
          "old_text": null,
          "new_text": "replace_into_builder(str, needle, replacement, replace_mode, *maybe_first)",
          "old_line_content": "{",
          "new_line_content": "    auto resulting_builder = replace_into_builder(str, needle, replacement, replace_mode, *maybe_first);",
          "content_same": false
        },
        {
          "line": 446,
          "old_api": null,
          "new_api": "has_value",
          "old_text": null,
          "new_text": "maybe_position.has_value()",
          "old_line_content": "    return positions;",
          "new_line_content": "        if (!maybe_position.has_value())",
          "content_same": false
        },
        {
          "line": 448,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "positions.append(current_position + *maybe_position)",
          "old_line_content": "",
          "new_line_content": "        positions.append(current_position + *maybe_position);",
          "content_same": false
        },
        {
          "line": 583,
          "old_api": null,
          "new_api": "bytes_as_string_view",
          "old_text": null,
          "new_text": "haystack.bytes_as_string_view()",
          "old_line_content": "",
          "new_line_content": "    auto const source_bytes = haystack.bytes_as_string_view();",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": null,
          "new_api": "is_empty",
          "old_text": null,
          "new_text": "needles.is_empty()",
          "old_line_content": "                return i;",
          "new_line_content": "    if (haystack.is_empty() || needles.is_empty())",
          "content_same": false
        },
        {
          "line": 586,
          "old_api": null,
          "new_api": "has_value",
          "old_text": null,
          "new_text": "maybe_first.has_value()",
          "old_line_content": "}",
          "new_line_content": "    if (!maybe_first.has_value())",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": null,
          "new_api": "replace_into_builder",
          "old_text": null,
          "new_text": "replace_into_builder(source_bytes, needle, replacement, replace_mode, *maybe_first)",
          "old_line_content": "// TODO: Benchmark against KMP (AK/MemMem.h) and switch over if it's faster for short strings too",
          "new_line_content": "    auto resulting_builder = replace_into_builder(source_bytes, needle, replacement, replace_mode, *maybe_first);",
          "content_same": false
        },
        {
          "line": 590,
          "old_api": null,
          "new_api": "to_string",
          "old_text": null,
          "new_text": "resulting_builder.to_string()",
          "old_line_content": "size_t count(StringView str, StringView needle)",
          "new_line_content": "    return resulting_builder.to_string();",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "haystack.length()",
          "old_line_content": "    return {};",
          "new_line_content": "        for (size_t i = haystack.length(); i > 0; --i) {",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": null,
          "new_api": "contains",
          "old_text": null,
          "new_text": "needles.contains(haystack[i - 1])",
          "old_line_content": "}",
          "new_line_content": "            if (needles.contains(haystack[i - 1]))",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "str.length()",
          "old_line_content": "            count++;",
          "new_line_content": "        return str.length();",
          "content_same": false
        },
        {
          "line": 601,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "needle.length()",
          "old_line_content": "}",
          "new_line_content": "    for (size_t i = 0; i < str.length() - needle.length() + 1; ++i) {",
          "content_same": false
        },
        {
          "line": 602,
          "old_api": null,
          "new_api": "substring_view",
          "old_text": null,
          "new_text": "str.substring_view(i).starts_with(needle)",
          "old_line_content": "",
          "new_line_content": "        if (str.substring_view(i).starts_with(needle))",
          "content_same": false
        },
        {
          "line": 481,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "str.length()",
          "old_line_content": "        return false;",
          "new_line_content": "        if (i >= str.length() - 1)",
          "content_same": false
        },
        {
          "line": 611,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "str.length()",
          "old_line_content": "}",
          "new_line_content": "    for (size_t i = 0; i < str.length(); ++i) {",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": null,
          "new_api": "is_ascii_lower_alpha",
          "old_text": null,
          "new_text": "is_ascii_lower_alpha(next_ch)",
          "old_line_content": "    StringBuilder builder;",
          "new_line_content": "        if (is_ascii_upper_alpha(current_char) && is_ascii_lower_alpha(next_ch))",
          "content_same": false
        },
        {
          "line": 490,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "str.length()",
          "old_line_content": "    }",
          "new_line_content": "    for (size_t i = 0; i < str.length(); ++i) {",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": null,
          "new_api": "should_insert_underscore",
          "old_text": null,
          "new_text": "should_insert_underscore(i, ch)",
          "old_line_content": "}",
          "new_line_content": "        if (should_insert_underscore(i, ch))",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "builder.append('_')",
          "old_line_content": "",
          "new_line_content": "            builder.append('_');",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": null,
          "new_api": "append_as_lowercase",
          "old_text": null,
          "new_text": "builder.append_as_lowercase(ch)",
          "old_line_content": "ByteString to_titlecase(StringView str)",
          "new_line_content": "        builder.append_as_lowercase(ch);",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": null,
          "new_api": "to_byte_string",
          "old_text": null,
          "new_text": "builder.to_byte_string()",
          "old_line_content": "    StringBuilder builder;",
          "new_line_content": "    return builder.to_byte_string();",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": null,
          "new_api": "to_ascii_uppercase",
          "old_text": null,
          "new_text": "to_ascii_uppercase(ch)",
          "old_line_content": "",
          "new_line_content": "            builder.append(to_ascii_uppercase(ch));",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": null,
          "new_api": "to_ascii_lowercase",
          "old_text": null,
          "new_text": "to_ascii_lowercase(ch)",
          "old_line_content": "}",
          "new_line_content": "            builder.append(to_ascii_lowercase(ch));",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 515,
          "old_api": "is_ascii_lower_alpha",
          "new_api": null,
          "old_text": "is_ascii_lower_alpha(ch)",
          "new_text": null,
          "old_line_content": "        if (is_ascii_lower_alpha(ch))",
          "new_line_content": "ByteString invert_case(StringView str)",
          "content_same": false
        },
        {
          "line": 516,
          "old_api": "to_ascii_uppercase",
          "new_api": null,
          "old_text": "to_ascii_uppercase(ch)",
          "new_text": null,
          "old_line_content": "            builder.append(to_ascii_uppercase(ch));",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": "to_ascii_lowercase",
          "new_api": null,
          "old_text": "to_ascii_lowercase(ch)",
          "new_text": null,
          "old_line_content": "            builder.append(to_ascii_lowercase(ch));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": "substring_view",
          "new_api": null,
          "old_text": "str.substring_view(0, first_replacement_position)",
          "new_text": null,
          "old_line_content": "    replaced_string.append(str.substring_view(0, first_replacement_position));",
          "new_line_content": "// different route to construct its output.",
          "content_same": false
        },
        {
          "line": 532,
          "old_api": "append",
          "new_api": null,
          "old_text": "replaced_string.append(replacement)",
          "new_text": null,
          "old_line_content": "    replaced_string.append(replacement);",
          "new_line_content": "static StringBuilder replace_into_builder(StringView str, StringView needle, StringView replacement, ReplaceMode replace_mode, size_t first_replacement_position)",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": "length",
          "new_api": null,
          "old_text": "needle.length()",
          "new_text": null,
          "old_line_content": "    StringView remaining = str.substring_view(first_replacement_position + needle.length());",
          "new_line_content": "    StringBuilder replaced_string;",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "remaining.is_empty()",
          "new_text": null,
          "old_line_content": "        while (!remaining.is_empty()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": "has_value",
          "new_api": null,
          "old_text": "maybe_pos.has_value()",
          "new_text": null,
          "old_line_content": "            if (!maybe_pos.has_value())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": "substring_view",
          "new_api": null,
          "old_text": "remaining.substring_view(0, *maybe_pos)",
          "new_text": null,
          "old_line_content": "            replaced_string.append(remaining.substring_view(0, *maybe_pos));",
          "new_line_content": "    case ReplaceMode::All:",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": "StringUtils::find(haystack, needle, i - 1)",
          "new_api": null,
          "old_text": "StringUtils::find(haystack, needle, i - 1)",
          "new_text": null,
          "old_line_content": "        auto value = StringUtils::find(haystack, needle, i - 1);",
          "new_line_content": "        return {};",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": "has_value",
          "new_api": null,
          "old_text": "value.has_value()",
          "new_text": null,
          "old_line_content": "        if (value.has_value())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 554,
          "old_api": "append",
          "new_api": null,
          "old_text": "replaced_string.append(remaining)",
          "new_text": null,
          "old_line_content": "    replaced_string.append(remaining);",
          "new_line_content": "        break;",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": "length",
          "new_api": null,
          "old_text": "haystack.length()",
          "new_text": null,
          "old_line_content": "    for (size_t i = haystack.length(); i > 0; --i) {",
          "new_line_content": "    return {};",
          "content_same": false
        },
        {
          "line": 562,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "str.is_empty()",
          "new_text": null,
          "old_line_content": "    if (str.is_empty())",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 565,
          "old_api": "find",
          "new_api": null,
          "old_text": "str.find(needle)",
          "new_text": null,
          "old_line_content": "    auto maybe_first = str.find(needle);",
          "new_line_content": "    ReplaceMode replace_mode)",
          "content_same": false
        },
        {
          "line": 566,
          "old_api": "has_value",
          "new_api": null,
          "old_text": "maybe_first.has_value()",
          "new_text": null,
          "old_line_content": "    if (!maybe_first.has_value())",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "length",
          "new_api": null,
          "old_text": "haystack.length()",
          "new_text": null,
          "old_line_content": "    while (current_position <= haystack.length()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": "characters_without_null_termination",
          "new_api": null,
          "old_text": "AK::memmem_optional(\n            haystack.characters_without_null_termination() + current_position, haystack.length() - current_position,\n            needle.characters_without_null_termination(), needle.length())",
          "new_text": null,
          "old_line_content": "        auto maybe_position = AK::memmem_optional(",
          "new_line_content": "Vector<size_t> find_all(StringView haystack, StringView needle)",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "replace_into_builder",
          "new_api": null,
          "old_text": "replace_into_builder(str, needle, replacement, replace_mode, *maybe_first)",
          "new_text": null,
          "old_line_content": "    auto resulting_builder = replace_into_builder(str, needle, replacement, replace_mode, *maybe_first);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": "length",
          "new_api": null,
          "old_text": "haystack.length()",
          "new_text": null,
          "old_line_content": "            haystack.characters_without_null_termination() + current_position, haystack.length() - current_position,",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": "length",
          "new_api": null,
          "old_text": "needle.length()",
          "new_text": null,
          "old_line_content": "            needle.characters_without_null_termination(), needle.length());",
          "new_line_content": "    Vector<size_t> positions;",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": "has_value",
          "new_api": null,
          "old_text": "maybe_position.has_value()",
          "new_text": null,
          "old_line_content": "        if (!maybe_position.has_value())",
          "new_line_content": "    size_t current_position = 0;",
          "content_same": false
        },
        {
          "line": 578,
          "old_api": "bytes_as_string_view",
          "new_api": null,
          "old_text": "haystack.bytes_as_string_view()",
          "new_text": null,
          "old_line_content": "    auto const source_bytes = haystack.bytes_as_string_view();",
          "new_line_content": "ErrorOr<String> replace(String const& haystack, StringView needle, StringView replacement, ReplaceMode replace_mode)",
          "content_same": false
        },
        {
          "line": 451,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "needles.is_empty()",
          "new_text": null,
          "old_line_content": "    if (haystack.is_empty() || needles.is_empty())",
          "new_line_content": "    return positions;",
          "content_same": false
        },
        {
          "line": 581,
          "old_api": "has_value",
          "new_api": null,
          "old_text": "maybe_first.has_value()",
          "new_text": null,
          "old_line_content": "    if (!maybe_first.has_value())",
          "new_line_content": "        return haystack;",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": "length",
          "new_api": null,
          "old_text": "haystack.length()",
          "new_text": null,
          "old_line_content": "        for (size_t i = 0; i < haystack.length(); ++i) {",
          "new_line_content": "Optional<size_t> find_any_of(StringView haystack, StringView needles, SearchDirection direction)",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": "contains",
          "new_api": null,
          "old_text": "needles.contains(haystack[i])",
          "new_text": null,
          "old_line_content": "            if (needles.contains(haystack[i]))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 584,
          "old_api": "replace_into_builder",
          "new_api": null,
          "old_text": "replace_into_builder(source_bytes, needle, replacement, replace_mode, *maybe_first)",
          "new_text": null,
          "old_line_content": "    auto resulting_builder = replace_into_builder(source_bytes, needle, replacement, replace_mode, *maybe_first);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 592,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "needle.is_empty()",
          "new_text": null,
          "old_line_content": "    if (needle.is_empty())",
          "new_line_content": "#endif",
          "content_same": false
        },
        {
          "line": 593,
          "old_api": "length",
          "new_api": null,
          "old_text": "str.length()",
          "new_text": null,
          "old_line_content": "        return str.length();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": "length",
          "new_api": null,
          "old_text": "needle.length()",
          "new_text": null,
          "old_line_content": "    for (size_t i = 0; i < str.length() - needle.length() + 1; ++i) {",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": "is_ascii_upper_alpha",
          "new_api": null,
          "old_text": "is_ascii_upper_alpha(current_char)",
          "new_text": null,
          "old_line_content": "        if (is_ascii_lower_alpha(previous_ch) && is_ascii_upper_alpha(current_char))",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 476,
          "old_api": "length",
          "new_api": null,
          "old_text": "str.length()",
          "new_text": null,
          "old_line_content": "        if (i >= str.length() - 1)",
          "new_line_content": "        if (i == 0)",
          "content_same": false
        },
        {
          "line": 606,
          "old_api": "length",
          "new_api": null,
          "old_text": "str.length()",
          "new_text": null,
          "old_line_content": "    for (size_t i = 0; i < str.length(); ++i) {",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": "length",
          "new_api": null,
          "old_text": "str.length()",
          "new_text": null,
          "old_line_content": "    for (size_t i = 0; i < str.length(); ++i) {",
          "new_line_content": "            return true;",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": "should_insert_underscore",
          "new_api": null,
          "old_text": "should_insert_underscore(i, ch)",
          "new_text": null,
          "old_line_content": "        if (should_insert_underscore(i, ch))",
          "new_line_content": "    };",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": "append",
          "new_api": null,
          "old_text": "builder.append('_')",
          "new_text": null,
          "old_line_content": "            builder.append('_');",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": "append_as_lowercase",
          "new_api": null,
          "old_text": "builder.append_as_lowercase(ch)",
          "new_text": null,
          "old_line_content": "        builder.append_as_lowercase(ch);",
          "new_line_content": "    StringBuilder builder;",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": "to_byte_string",
          "new_api": null,
          "old_text": "builder.to_byte_string()",
          "new_text": null,
          "old_line_content": "    return builder.to_byte_string();",
          "new_line_content": "        auto ch = str[i];",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": "to_ascii_uppercase",
          "new_api": null,
          "old_text": "to_ascii_uppercase(ch)",
          "new_text": null,
          "old_line_content": "            builder.append(to_ascii_uppercase(ch));",
          "new_line_content": "    StringBuilder builder;",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": "to_ascii_lowercase",
          "new_api": null,
          "old_text": "to_ascii_lowercase(ch)",
          "new_text": null,
          "old_line_content": "            builder.append(to_ascii_lowercase(ch));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 507,
          "old_api": "to_byte_string",
          "new_api": null,
          "old_text": "builder.to_byte_string()",
          "new_text": null,
          "old_line_content": "    return builder.to_byte_string();",
          "new_line_content": "        else",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 12,
      "total_additions": 42,
      "total_deletions": 42,
      "total_api_changes": 96
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 9,
        "api_related_lines": 96,
        "non_api_lines": 5,
        "non_api_line_numbers": [
          420,
          421,
          422,
          423,
          415
        ]
      }
    },
    "api_calls_before": 193,
    "api_calls_after": 196,
    "diff_info": {
      "added_lines": 9,
      "removed_lines": 4,
      "total_diff_lines": 25
    }
  }
}