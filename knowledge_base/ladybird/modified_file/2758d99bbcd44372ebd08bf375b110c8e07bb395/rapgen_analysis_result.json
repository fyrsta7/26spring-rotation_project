{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/2758d99bbcd44372ebd08bf375b110c8e07bb395",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/2758d99bbcd44372ebd08bf375b110c8e07bb395/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/2758d99bbcd44372ebd08bf375b110c8e07bb395/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/ladybird/modified_file/2758d99bbcd44372ebd08bf375b110c8e07bb395/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 24,
          "old_api": "flatten",
          "new_api": "split_basic_blocks",
          "old_text": "parser_result.bytecode.flatten()",
          "new_text": "split_basic_blocks()",
          "old_line_content": "    parser_result.bytecode.flatten();",
          "new_line_content": "    attempt_rewrite_loops_as_atomic_groups(split_basic_blocks());",
          "content_same": false
        },
        {
          "line": 40,
          "old_api": "append",
          "new_api": "offset",
          "old_text": "block_boundaries.append({ end_of_last_block, state.instruction_position })",
          "new_text": "op.offset()",
          "old_line_content": "            block_boundaries.append({ end_of_last_block, state.instruction_position });",
          "new_line_content": "        ssize_t jump_offset = op.size() + op.offset();",
          "content_same": false
        },
        {
          "line": 48,
          "old_api": "size",
          "new_api": "append",
          "old_text": "opcode.size()",
          "new_text": "block_boundaries.append({ end_of_last_block, jump_offset + state.instruction_position })",
          "old_line_content": "                end_of_last_block = state.instruction_position + opcode.size();",
          "new_line_content": "                block_boundaries.append({ end_of_last_block, jump_offset + state.instruction_position });",
          "content_same": false
        },
        {
          "line": 59,
          "old_api": "opcode_id",
          "new_api": "get_opcode",
          "old_text": "opcode.opcode_id()",
          "new_text": "bytecode.get_opcode(state)",
          "old_line_content": "        switch (opcode.opcode_id()) {",
          "new_line_content": "        auto& opcode = bytecode.get_opcode(state);",
          "content_same": false
        },
        {
          "line": 61,
          "old_api": "check_jump.template operator()<OpCode_Jump>(opcode)",
          "new_api": "opcode_id",
          "old_text": "check_jump.template operator()<OpCode_Jump>(opcode)",
          "new_text": "opcode.opcode_id()",
          "old_line_content": "            check_jump.template operator()<OpCode_Jump>(opcode);",
          "new_line_content": "        switch (opcode.opcode_id()) {",
          "content_same": false
        },
        {
          "line": 80,
          "old_api": "append",
          "new_api": "offset",
          "old_text": "block_boundaries.append({ end_of_last_block, repeat_start })",
          "new_text": "static_cast<OpCode_Repeat const&>(opcode).offset()",
          "old_line_content": "                block_boundaries.append({ end_of_last_block, repeat_start });",
          "new_line_content": "            auto repeat_start = state.instruction_position - static_cast<OpCode_Repeat const&>(opcode).offset();",
          "content_same": false
        },
        {
          "line": 82,
          "old_api": "size",
          "new_api": "append",
          "old_text": "opcode.size()",
          "new_text": "block_boundaries.append({ end_of_last_block, repeat_start })",
          "old_line_content": "            end_of_last_block = state.instruction_position + opcode.size();",
          "new_line_content": "                block_boundaries.append({ end_of_last_block, repeat_start });",
          "content_same": false
        },
        {
          "line": 99,
          "old_api": "quick_sort",
          "new_api": "size",
          "old_text": "quick_sort(block_boundaries, [](auto& a, auto& b) { return a.start < b.start; })",
          "new_text": "bytecode.size()",
          "old_line_content": "    quick_sort(block_boundaries, [](auto& a, auto& b) { return a.start < b.start; });",
          "new_line_content": "        block_boundaries.append({ end_of_last_block, bytecode.size() });",
          "content_same": false
        },
        {
          "line": 113,
          "old_api": "flat_compares",
          "new_api": "opcode_id",
          "old_text": "static_cast<OpCode_Compare const&>(opcode).flat_compares()",
          "new_text": "opcode.opcode_id()",
          "old_line_content": "            auto compares = static_cast<OpCode_Compare const&>(opcode).flat_compares();",
          "new_line_content": "        switch (opcode.opcode_id()) {",
          "content_same": false
        },
        {
          "line": 116,
          "old_api": "move",
          "new_api": "any_of",
          "old_text": "move(compares)",
          "new_text": "any_of(compares, [](auto& compare) { return compare.type == CharacterCompareType::AnyChar; })",
          "old_line_content": "            repeated_values.append(move(compares));",
          "new_line_content": "            if (repeated_values.is_empty() && any_of(compares, [](auto& compare) { return compare.type == CharacterCompareType::AnyChar; }))",
          "content_same": false
        },
        {
          "line": 205,
          "old_api": "dbgln",
          "new_api": "print_bytecode",
          "old_text": "dbgln(\"block from {} to {}\", block.start, block.end)",
          "new_text": "dbg.print_bytecode(*this)",
          "old_line_content": "            dbgln(\"block from {} to {}\", block.start, block.end);",
          "new_line_content": "        dbg.print_bytecode(*this);",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": "static_cast<OpCode_JumpNonEmpty const&>(opcode)",
          "new_api": "opcode_id",
          "old_text": "static_cast<OpCode_JumpNonEmpty const&>(opcode)",
          "new_text": "opcode.opcode_id()",
          "old_line_content": "            auto& op = static_cast<OpCode_JumpNonEmpty const&>(opcode);",
          "new_line_content": "        switch (opcode.opcode_id()) {",
          "content_same": false
        },
        {
          "line": 308,
          "old_api": "get_opcode",
          "new_api": "has_value",
          "old_text": "bytecode.get_opcode(state)",
          "new_text": "fork_fallback_block.has_value()",
          "old_line_content": "            auto& opcode = bytecode.get_opcode(state);",
          "new_line_content": "        if (fork_fallback_block.has_value()) {",
          "content_same": false
        },
        {
          "line": 315,
          "old_api": "size",
          "new_api": "opcode_id",
          "old_text": "basic_blocks.size()",
          "new_text": "opcode.opcode_id()",
          "old_line_content": "                    if (i + 2 < basic_blocks.size())",
          "new_line_content": "                if (opcode.opcode_id() == OpCodeId::ForkJump || opcode.opcode_id() == OpCodeId::ForkStay) {",
          "content_same": false
        },
        {
          "line": 317,
          "old_api": "block_satisfies_atomic_rewrite_precondition",
          "new_api": "size",
          "old_text": "block_satisfies_atomic_rewrite_precondition(bytecode, *fork_fallback_block, *block_following_fork_fallback)",
          "new_text": "basic_blocks.size()",
          "old_line_content": "                    if (!block_following_fork_fallback.has_value() || block_satisfies_atomic_rewrite_precondition(bytecode, *fork_fallback_block, *block_following_fork_fallback)) {",
          "new_line_content": "                    if (i + 2 < basic_blocks.size())",
          "content_same": false
        },
        {
          "line": 328,
          "old_api": "dbgln_if",
          "new_api": "size",
          "old_text": "dbgln_if(REGEX_DEBUG, \"Failed to find anything for {}\", pattern_value)",
          "new_text": "candidate_blocks.size()",
          "old_line_content": "        dbgln_if(REGEX_DEBUG, \"Failed to find anything for {}\", pattern_value);",
          "new_line_content": "    dbgln_if(REGEX_DEBUG, \"Found {} candidate blocks\", candidate_blocks.size());",
          "content_same": false
        },
        {
          "line": 359,
          "old_api": "insert",
          "new_api": "has_value",
          "old_text": "bytecode.insert(candidate.forking_block.start, (ByteCodeValueType)OpCodeId::ForkStay)",
          "new_text": "candidate.new_target_block.has_value()",
          "old_line_content": "                bytecode.insert(candidate.forking_block.start, (ByteCodeValueType)OpCodeId::ForkStay);",
          "new_line_content": "            if (candidate.new_target_block.has_value()) {",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": "offset",
          "new_api": "opcode_id",
          "old_text": "static_cast<OpCode_Jump const&>(opcode).offset()",
          "new_text": "opcode.opcode_id()",
          "old_line_content": "                patch_points.push({ static_cast<OpCode_Jump const&>(opcode).offset(), state.instruction_position + 1 });",
          "new_line_content": "            switch (opcode.opcode_id()) {",
          "content_same": false
        },
        {
          "line": 404,
          "old_api": "size",
          "new_api": "is_empty",
          "old_text": "opcode.size()",
          "new_text": "patch_points.is_empty()",
          "old_line_content": "                auto target_offset = patch_point.value + state.instruction_position + opcode.size();",
          "new_line_content": "            while (!patch_points.is_empty()) {",
          "content_same": false
        },
        {
          "line": 406,
          "old_api": "constexpr",
          "new_api": "size",
          "old_text": "constexpr",
          "new_text": "opcode.size()",
          "old_line_content": "                constexpr auto do_patch = [](auto& patch_it, auto& patch_point, auto& target_offset, auto& bytecode, auto ip) {",
          "new_line_content": "                auto target_offset = patch_point.value + state.instruction_position + opcode.size();",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": "pop",
          "new_api": "do_patch",
          "old_text": "patch_points.pop()",
          "new_text": "do_patch(patch_it, patch_point, target_offset, bytecode, state.instruction_position)",
          "old_line_content": "                patch_points.pop();",
          "new_line_content": "                    do_patch(patch_it, patch_point, target_offset, bytecode, state.instruction_position);",
          "content_same": false
        },
        {
          "line": 431,
          "old_api": "print_bytecode",
          "new_api": "warnln",
          "old_text": "dbg.print_bytecode(*this)",
          "new_text": "warnln(\"Transformed to:\")",
          "old_line_content": "        dbg.print_bytecode(*this);",
          "new_line_content": "        warnln(\"Transformed to:\");",
          "content_same": false
        },
        {
          "line": 451,
          "old_api": "get_opcode",
          "new_api": "size",
          "old_text": "right.get_opcode(state).size()",
          "new_text": "right.size()",
          "old_line_content": "        auto right_size = right.get_opcode(state).size();",
          "new_line_content": "    for (state.instruction_position = 0; state.instruction_position < left.size() && state.instruction_position < right.size();) {",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": "static_cast<ByteCodeValueType>(OpCodeId::ForkJump)",
          "new_api": "size",
          "old_text": "static_cast<ByteCodeValueType>(OpCodeId::ForkJump)",
          "new_text": "left.size()",
          "old_line_content": "    target.empend(static_cast<ByteCodeValueType>(OpCodeId::ForkJump));",
          "new_line_content": "    auto left_size = left.size();",
          "content_same": false
        },
        {
          "line": 475,
          "old_api": "move",
          "new_api": "size",
          "old_text": "move(right)",
          "new_text": "right.size()",
          "old_line_content": "    target.extend(move(right));",
          "new_line_content": "    target.empend(right.size() + (left_size ? 2 : 0)); // Jump to the _ALT label",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 20,
          "old_api": null,
          "new_api": "flatten",
          "old_text": null,
          "new_text": "parser_result.bytecode.flatten()",
          "old_line_content": "    // Rewrite fork loops as atomic groups",
          "new_line_content": "    parser_result.bytecode.flatten();",
          "content_same": false
        },
        {
          "line": 26,
          "old_api": null,
          "new_api": "flatten",
          "old_text": null,
          "new_text": "parser_result.bytecode.flatten()",
          "old_line_content": "",
          "new_line_content": "    parser_result.bytecode.flatten();",
          "content_same": false
        },
        {
          "line": 39,
          "old_api": null,
          "new_api": "static_cast<T const&>(opcode)",
          "old_text": null,
          "new_text": "static_cast<T const&>(opcode)",
          "old_line_content": "        if (jump_offset >= 0) {",
          "new_line_content": "        auto& op = static_cast<T const&>(opcode);",
          "content_same": false
        },
        {
          "line": 42,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "block_boundaries.append({ end_of_last_block, state.instruction_position })",
          "old_line_content": "        } else {",
          "new_line_content": "            block_boundaries.append({ end_of_last_block, state.instruction_position });",
          "content_same": false
        },
        {
          "line": 43,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "opcode.size()",
          "old_line_content": "            // This op jumps back, see if that's within this \"block\".",
          "new_line_content": "            end_of_last_block = state.instruction_position + opcode.size();",
          "content_same": false
        },
        {
          "line": 49,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "block_boundaries.append({ jump_offset + state.instruction_position, state.instruction_position })",
          "old_line_content": "            } else {",
          "new_line_content": "                block_boundaries.append({ jump_offset + state.instruction_position, state.instruction_position });",
          "content_same": false
        },
        {
          "line": 50,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "opcode.size()",
          "old_line_content": "                // Nope, it's just a jump to another block",
          "new_line_content": "                end_of_last_block = state.instruction_position + opcode.size();",
          "content_same": false
        },
        {
          "line": 53,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "block_boundaries.append({ end_of_last_block, state.instruction_position })",
          "old_line_content": "            }",
          "new_line_content": "                block_boundaries.append({ end_of_last_block, state.instruction_position });",
          "content_same": false
        },
        {
          "line": 54,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "opcode.size()",
          "old_line_content": "        }",
          "new_line_content": "                end_of_last_block = state.instruction_position + opcode.size();",
          "content_same": false
        },
        {
          "line": 63,
          "old_api": null,
          "new_api": "check_jump.template operator()<OpCode_Jump>(opcode)",
          "old_text": null,
          "new_text": "check_jump.template operator()<OpCode_Jump>(opcode)",
          "old_line_content": "        case OpCodeId::JumpNonEmpty:",
          "new_line_content": "            check_jump.template operator()<OpCode_Jump>(opcode);",
          "content_same": false
        },
        {
          "line": 66,
          "old_api": null,
          "new_api": "check_jump.template operator()<OpCode_JumpNonEmpty>(opcode)",
          "old_text": null,
          "new_text": "check_jump.template operator()<OpCode_JumpNonEmpty>(opcode)",
          "old_line_content": "        case OpCodeId::ForkJump:",
          "new_line_content": "            check_jump.template operator()<OpCode_JumpNonEmpty>(opcode);",
          "content_same": false
        },
        {
          "line": 69,
          "old_api": null,
          "new_api": "check_jump.template operator()<OpCode_ForkJump>(opcode)",
          "old_text": null,
          "new_text": "check_jump.template operator()<OpCode_ForkJump>(opcode)",
          "old_line_content": "        case OpCodeId::ForkStay:",
          "new_line_content": "            check_jump.template operator()<OpCode_ForkJump>(opcode);",
          "content_same": false
        },
        {
          "line": 72,
          "old_api": null,
          "new_api": "check_jump.template operator()<OpCode_ForkStay>(opcode)",
          "old_text": null,
          "new_text": "check_jump.template operator()<OpCode_ForkStay>(opcode)",
          "old_line_content": "        case OpCodeId::FailForks:",
          "new_line_content": "            check_jump.template operator()<OpCode_ForkStay>(opcode);",
          "content_same": false
        },
        {
          "line": 75,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "block_boundaries.append({ end_of_last_block, state.instruction_position })",
          "old_line_content": "            break;",
          "new_line_content": "            block_boundaries.append({ end_of_last_block, state.instruction_position });",
          "content_same": false
        },
        {
          "line": 76,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "opcode.size()",
          "old_line_content": "        case OpCodeId::Repeat: {",
          "new_line_content": "            end_of_last_block = state.instruction_position + opcode.size();",
          "content_same": false
        },
        {
          "line": 83,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "block_boundaries.append({ repeat_start, state.instruction_position })",
          "old_line_content": "            break;",
          "new_line_content": "            block_boundaries.append({ repeat_start, state.instruction_position });",
          "content_same": false
        },
        {
          "line": 84,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "opcode.size()",
          "old_line_content": "        }",
          "new_line_content": "            end_of_last_block = state.instruction_position + opcode.size();",
          "content_same": false
        },
        {
          "line": 91,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "opcode.size()",
          "old_line_content": "            state.instruction_position = next_ip;",
          "new_line_content": "        auto next_ip = state.instruction_position + opcode.size();",
          "content_same": false
        },
        {
          "line": 92,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "bytecode.size()",
          "old_line_content": "        else",
          "new_line_content": "        if (next_ip < bytecode.size())",
          "content_same": false
        },
        {
          "line": 98,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "bytecode.size()",
          "old_line_content": "",
          "new_line_content": "    if (end_of_last_block < bytecode.size())",
          "content_same": false
        },
        {
          "line": 101,
          "old_api": null,
          "new_api": "quick_sort",
          "old_text": null,
          "new_text": "quick_sort(block_boundaries, [](auto& a, auto& b) { return a.start < b.start; })",
          "old_line_content": "    return block_boundaries;",
          "new_line_content": "    quick_sort(block_boundaries, [](auto& a, auto& b) { return a.start < b.start; });",
          "content_same": false
        },
        {
          "line": 112,
          "old_api": null,
          "new_api": "get_opcode",
          "old_text": null,
          "new_text": "bytecode.get_opcode(state)",
          "old_line_content": "        case OpCodeId::Compare: {",
          "new_line_content": "        auto& opcode = bytecode.get_opcode(state);",
          "content_same": false
        },
        {
          "line": 115,
          "old_api": null,
          "new_api": "flat_compares",
          "old_text": null,
          "new_text": "static_cast<OpCode_Compare const&>(opcode).flat_compares()",
          "old_line_content": "                return false;",
          "new_line_content": "            auto compares = static_cast<OpCode_Compare const&>(opcode).flat_compares();",
          "content_same": false
        },
        {
          "line": 118,
          "old_api": null,
          "new_api": "move",
          "old_text": null,
          "new_text": "move(compares)",
          "old_line_content": "        }",
          "new_line_content": "            repeated_values.append(move(compares));",
          "content_same": false
        },
        {
          "line": 123,
          "old_api": null,
          "new_api": "is_empty",
          "old_text": null,
          "new_text": "repeated_values.is_empty()",
          "old_line_content": "            break;",
          "new_line_content": "            if (repeated_values.is_empty())",
          "content_same": false
        },
        {
          "line": 133,
          "old_api": null,
          "new_api": "id",
          "old_text": null,
          "new_text": "static_cast<OpCode_SaveRightCaptureGroup const&>(opcode).id()",
          "old_line_content": "        case OpCodeId::SaveLeftCaptureGroup:",
          "new_line_content": "            active_capture_groups.set(static_cast<OpCode_SaveRightCaptureGroup const&>(opcode).id());",
          "content_same": false
        },
        {
          "line": 136,
          "old_api": null,
          "new_api": "id",
          "old_text": null,
          "new_text": "static_cast<OpCode_SaveLeftCaptureGroup const&>(opcode).id()",
          "old_line_content": "        default:",
          "new_line_content": "            active_capture_groups.set(static_cast<OpCode_SaveLeftCaptureGroup const&>(opcode).id());",
          "content_same": false
        },
        {
          "line": 144,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "repeated_values.size()",
          "old_line_content": "",
          "new_line_content": "    dbgln_if(REGEX_DEBUG, \"Found {} entries in reference\", repeated_values.size());",
          "content_same": false
        },
        {
          "line": 145,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "active_capture_groups.size()",
          "old_line_content": "    // Find the first compare in the following block, it must NOT match any of the values in `repeated_values'.",
          "new_line_content": "    dbgln_if(REGEX_DEBUG, \"Found {} active capture groups\", active_capture_groups.size());",
          "content_same": false
        },
        {
          "line": 149,
          "old_api": null,
          "new_api": "get_opcode",
          "old_text": null,
          "new_text": "bytecode.get_opcode(state)",
          "old_line_content": "        // Note: These have to exist since we're effectively repeating the following block as well",
          "new_line_content": "        auto& opcode = bytecode.get_opcode(state);",
          "content_same": false
        },
        {
          "line": 150,
          "old_api": null,
          "new_api": "opcode_id",
          "old_text": null,
          "new_text": "opcode.opcode_id()",
          "old_line_content": "        case OpCodeId::SaveRightCaptureGroup:",
          "new_line_content": "        switch (opcode.opcode_id()) {",
          "content_same": false
        },
        {
          "line": 153,
          "old_api": null,
          "new_api": "id",
          "old_text": null,
          "new_text": "static_cast<OpCode_SaveRightCaptureGroup const&>(opcode).id()",
          "old_line_content": "        case OpCodeId::SaveLeftCaptureGroup:",
          "new_line_content": "            active_capture_groups.set(static_cast<OpCode_SaveRightCaptureGroup const&>(opcode).id());",
          "content_same": false
        },
        {
          "line": 156,
          "old_api": null,
          "new_api": "id",
          "old_text": null,
          "new_text": "static_cast<OpCode_SaveLeftCaptureGroup const&>(opcode).id()",
          "old_line_content": "        case OpCodeId::Compare: {",
          "new_line_content": "            active_capture_groups.set(static_cast<OpCode_SaveLeftCaptureGroup const&>(opcode).id());",
          "content_same": false
        },
        {
          "line": 160,
          "old_api": null,
          "new_api": "flat_compares",
          "old_text": null,
          "new_text": "static_cast<OpCode_Compare const&>(opcode).flat_compares()",
          "old_line_content": "                break;",
          "new_line_content": "            auto compares = static_cast<OpCode_Compare const&>(opcode).flat_compares();",
          "content_same": false
        },
        {
          "line": 161,
          "old_api": null,
          "new_api": "is_empty",
          "old_text": null,
          "new_text": "compares.is_empty()",
          "old_line_content": "",
          "new_line_content": "            if (compares.is_empty())",
          "content_same": false
        },
        {
          "line": 166,
          "old_api": null,
          "new_api": "contains",
          "old_text": null,
          "new_text": "active_capture_groups.contains(compare.value)",
          "old_line_content": "                return false;",
          "new_line_content": "                        || (compare.type == CharacterCompareType::Reference && active_capture_groups.contains(compare.value));",
          "content_same": false
        },
        {
          "line": 172,
          "old_api": null,
          "new_api": "any_of",
          "old_text": null,
          "new_text": "any_of(repeated_value, [](auto& compare) { return compare.type == CharacterCompareType::AnyChar; })",
          "old_line_content": "",
          "new_line_content": "                if (any_of(repeated_value, [](auto& compare) { return compare.type == CharacterCompareType::AnyChar; }))",
          "content_same": false
        },
        {
          "line": 177,
          "old_api": null,
          "new_api": "any_of",
          "old_text": null,
          "new_text": "any_of(compares, [&](auto& compare) { return compare.type == repeated_compare.type && compare.value == repeated_compare.value; })",
          "old_line_content": "                }",
          "new_line_content": "                    if (any_of(compares, [&](auto& compare) { return compare.type == repeated_compare.type && compare.value == repeated_compare.value; }))",
          "content_same": false
        },
        {
          "line": 193,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "opcode.size()",
          "old_line_content": "",
          "new_line_content": "        state.instruction_position += opcode.size();",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": null,
          "new_api": "dbgln",
          "old_text": null,
          "new_text": "dbgln(\"block from {} to {}\", block.start, block.end)",
          "old_line_content": "",
          "new_line_content": "            dbgln(\"block from {} to {}\", block.start, block.end);",
          "content_same": false
        },
        {
          "line": 256,
          "old_api": null,
          "new_api": "static_cast<OpCode_JumpNonEmpty const&>(opcode)",
          "old_text": null,
          "new_text": "static_cast<OpCode_JumpNonEmpty const&>(opcode)",
          "old_line_content": "            if (form != OpCodeId::Jump && alternate_form == AlternateForm::DirectLoopWithHeader)",
          "new_line_content": "            auto& op = static_cast<OpCode_JumpNonEmpty const&>(opcode);",
          "content_same": false
        },
        {
          "line": 257,
          "old_api": null,
          "new_api": "form",
          "old_text": null,
          "new_text": "op.form()",
          "old_line_content": "                return false;",
          "new_line_content": "            auto form = op.form();",
          "content_same": false
        },
        {
          "line": 262,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "opcode.size()",
          "old_line_content": "        case OpCodeId::ForkJump:",
          "new_line_content": "            return op.offset() + ip + opcode.size() == block_start;",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "opcode.size()",
          "old_line_content": "            if (alternate_form == AlternateForm::DirectLoopWithHeader)",
          "new_line_content": "            return static_cast<OpCode_ForkJump const&>(opcode).offset() + ip + opcode.size() == block_start;",
          "content_same": false
        },
        {
          "line": 271,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "opcode.size()",
          "old_line_content": "            // Infinite loop does *not* produce forks.",
          "new_line_content": "            return static_cast<OpCode_ForkStay const&>(opcode).offset() + ip + opcode.size() == block_start;",
          "content_same": false
        },
        {
          "line": 277,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "opcode.size()",
          "old_line_content": "        default:",
          "new_line_content": "                return static_cast<OpCode_Jump const&>(opcode).offset() + ip + opcode.size() == block_start;",
          "content_same": false
        },
        {
          "line": 278,
          "old_api": null,
          "new_api": "VERIFY_NOT_REACHED",
          "old_text": null,
          "new_text": "VERIFY_NOT_REACHED()",
          "old_line_content": "            return false;",
          "new_line_content": "            VERIFY_NOT_REACHED();",
          "content_same": false
        },
        {
          "line": 283,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "basic_blocks.size()",
          "old_line_content": "        Optional<Block> fork_fallback_block;",
          "new_line_content": "    for (size_t i = 0; i < basic_blocks.size(); ++i) {",
          "content_same": false
        },
        {
          "line": 286,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "basic_blocks.size()",
          "old_line_content": "        MatchState state;",
          "new_line_content": "        if (i + 1 < basic_blocks.size())",
          "content_same": false
        },
        {
          "line": 292,
          "old_api": null,
          "new_api": "get_opcode",
          "old_text": null,
          "new_text": "bytecode.get_opcode(state)",
          "old_line_content": "                // We've found RE0 (and RE1 is just the following block, if any), let's see if the precondition applies.",
          "new_line_content": "            auto& opcode = bytecode.get_opcode(state);",
          "content_same": false
        },
        {
          "line": 293,
          "old_api": null,
          "new_api": "is_an_eligible_jump",
          "old_text": null,
          "new_text": "is_an_eligible_jump(opcode, state.instruction_position, forking_block.start, AlternateForm::DirectLoopWithoutHeader)",
          "old_line_content": "                // if RE1 is empty, there's no first(RE1), so this is an automatic pass.",
          "new_line_content": "            if (is_an_eligible_jump(opcode, state.instruction_position, forking_block.start, AlternateForm::DirectLoopWithoutHeader)) {",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": null,
          "new_api": "has_value",
          "old_text": null,
          "new_text": "fork_fallback_block.has_value()",
          "old_line_content": "                    break;",
          "new_line_content": "                if (!fork_fallback_block.has_value() || fork_fallback_block->end == fork_fallback_block->start) {",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "candidate_blocks.append({ forking_block, fork_fallback_block, AlternateForm::DirectLoopWithoutHeader })",
          "old_line_content": "                }",
          "new_line_content": "                    candidate_blocks.append({ forking_block, fork_fallback_block, AlternateForm::DirectLoopWithoutHeader });",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": null,
          "new_api": "block_satisfies_atomic_rewrite_precondition",
          "old_text": null,
          "new_text": "block_satisfies_atomic_rewrite_precondition(bytecode, forking_block, *fork_fallback_block)",
          "old_line_content": "                    break;",
          "new_line_content": "                if (block_satisfies_atomic_rewrite_precondition(bytecode, forking_block, *fork_fallback_block)) {",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "candidate_blocks.append({ forking_block, fork_fallback_block, AlternateForm::DirectLoopWithoutHeader })",
          "old_line_content": "                }",
          "new_line_content": "                    candidate_blocks.append({ forking_block, fork_fallback_block, AlternateForm::DirectLoopWithoutHeader });",
          "content_same": false
        },
        {
          "line": 310,
          "old_api": null,
          "new_api": "get_opcode",
          "old_text": null,
          "new_text": "bytecode.get_opcode(state)",
          "old_line_content": "                // We've found bb1 and bb0, let's just make sure that bb0 forks to bb2.",
          "new_line_content": "            auto& opcode = bytecode.get_opcode(state);",
          "content_same": false
        },
        {
          "line": 311,
          "old_api": null,
          "new_api": "is_an_eligible_jump",
          "old_text": null,
          "new_text": "is_an_eligible_jump(opcode, state.instruction_position, forking_block.start, AlternateForm::DirectLoopWithHeader)",
          "old_line_content": "                state.instruction_position = forking_block.end;",
          "new_line_content": "            if (is_an_eligible_jump(opcode, state.instruction_position, forking_block.start, AlternateForm::DirectLoopWithHeader)) {",
          "content_same": false
        },
        {
          "line": 314,
          "old_api": null,
          "new_api": "get_opcode",
          "old_text": null,
          "new_text": "bytecode.get_opcode(state)",
          "old_line_content": "                    Optional<Block> block_following_fork_fallback;",
          "new_line_content": "                auto& opcode = bytecode.get_opcode(state);",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": null,
          "new_api": "block_satisfies_atomic_rewrite_precondition",
          "old_text": null,
          "new_text": "block_satisfies_atomic_rewrite_precondition(bytecode, *fork_fallback_block, *block_following_fork_fallback)",
          "old_line_content": "                        break;",
          "new_line_content": "                    if (!block_following_fork_fallback.has_value() || block_satisfies_atomic_rewrite_precondition(bytecode, *fork_fallback_block, *block_following_fork_fallback)) {",
          "content_same": false
        },
        {
          "line": 320,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "candidate_blocks.append({ forking_block, {}, AlternateForm::DirectLoopWithHeader })",
          "old_line_content": "                    }",
          "new_line_content": "                        candidate_blocks.append({ forking_block, {}, AlternateForm::DirectLoopWithHeader });",
          "content_same": false
        },
        {
          "line": 329,
          "old_api": null,
          "new_api": "is_empty",
          "old_text": null,
          "new_text": "candidate_blocks.is_empty()",
          "old_line_content": "        return;",
          "new_line_content": "    if (candidate_blocks.is_empty()) {",
          "content_same": false
        },
        {
          "line": 330,
          "old_api": null,
          "new_api": "dbgln_if",
          "old_text": null,
          "new_text": "dbgln_if(REGEX_DEBUG, \"Failed to find anything for {}\", pattern_value)",
          "old_line_content": "    }",
          "new_line_content": "        dbgln_if(REGEX_DEBUG, \"Failed to find anything for {}\", pattern_value);",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": null,
          "new_api": "quick_sort",
          "old_text": null,
          "new_text": "quick_sort(candidate_blocks, [](auto& a, auto& b) { return b.forking_block.start > a.forking_block.start; })",
          "old_line_content": "        // Note that both forms share a ForkReplace patch in forking_block.",
          "new_line_content": "    quick_sort(candidate_blocks, [](auto& a, auto& b) { return b.forking_block.start > a.forking_block.start; });",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": null,
          "new_api": "VERIFY_NOT_REACHED",
          "old_text": null,
          "new_text": "VERIFY_NOT_REACHED()",
          "old_line_content": "",
          "new_line_content": "            VERIFY_NOT_REACHED();",
          "content_same": false
        },
        {
          "line": 362,
          "old_api": null,
          "new_api": "insert",
          "old_text": null,
          "new_text": "bytecode.insert(candidate.forking_block.start + 1, candidate.new_target_block->start - candidate.forking_block.start)",
          "old_line_content": "            }",
          "new_line_content": "                bytecode.insert(candidate.forking_block.start + 1, candidate.new_target_block->start - candidate.forking_block.start);",
          "content_same": false
        },
        {
          "line": 363,
          "old_api": null,
          "new_api": "insert",
          "old_text": null,
          "new_text": "needed_patches.insert(candidate.forking_block.start, 2u)",
          "old_line_content": "        }",
          "new_line_content": "                needed_patches.insert(candidate.forking_block.start, 2u);",
          "content_same": false
        },
        {
          "line": 368,
          "old_api": null,
          "new_api": "is_empty",
          "old_text": null,
          "new_text": "needed_patches.is_empty()",
          "old_line_content": "        state.instruction_position = 0;",
          "new_line_content": "    if (!needed_patches.is_empty()) {",
          "content_same": false
        },
        {
          "line": 377,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "bytecode.size()",
          "old_line_content": "",
          "new_line_content": "            if (state.instruction_position >= bytecode.size())",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": null,
          "new_api": "get_opcode",
          "old_text": null,
          "new_text": "bytecode.get_opcode(state)",
          "old_line_content": "",
          "new_line_content": "            auto& opcode = bytecode.get_opcode(state);",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": null,
          "new_api": "offset",
          "old_text": null,
          "new_text": "static_cast<OpCode_Jump const&>(opcode).offset()",
          "old_line_content": "            case OpCodeId::JumpNonEmpty:",
          "new_line_content": "                patch_points.push({ static_cast<OpCode_Jump const&>(opcode).offset(), state.instruction_position + 1 });",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": null,
          "new_api": "offset",
          "old_text": null,
          "new_text": "static_cast<OpCode_JumpNonEmpty const&>(opcode).offset()",
          "old_line_content": "                break;",
          "new_line_content": "                patch_points.push({ static_cast<OpCode_JumpNonEmpty const&>(opcode).offset(), state.instruction_position + 1 });",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": null,
          "new_api": "checkpoint",
          "old_text": null,
          "new_text": "static_cast<OpCode_JumpNonEmpty const&>(opcode).checkpoint()",
          "old_line_content": "            case OpCodeId::ForkJump:",
          "new_line_content": "                patch_points.push({ static_cast<OpCode_JumpNonEmpty const&>(opcode).checkpoint(), state.instruction_position + 2 });",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": null,
          "new_api": "offset",
          "old_text": null,
          "new_text": "static_cast<OpCode_ForkJump const&>(opcode).offset()",
          "old_line_content": "            case OpCodeId::ForkStay:",
          "new_line_content": "                patch_points.push({ static_cast<OpCode_ForkJump const&>(opcode).offset(), state.instruction_position + 1 });",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": null,
          "new_api": "offset",
          "old_text": null,
          "new_text": "static_cast<OpCode_ForkStay const&>(opcode).offset()",
          "old_line_content": "            case OpCodeId::Repeat:",
          "new_line_content": "                patch_points.push({ static_cast<OpCode_ForkStay const&>(opcode).offset(), state.instruction_position + 1 });",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": null,
          "new_api": "offset",
          "old_text": null,
          "new_text": "static_cast<OpCode_Repeat const&>(opcode).offset()",
          "old_line_content": "            default:",
          "new_line_content": "                patch_points.push({ -(ssize_t) static_cast<OpCode_Repeat const&>(opcode).offset(), state.instruction_position + 1, true });",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": null,
          "new_api": "top",
          "old_text": null,
          "new_text": "patch_points.top()",
          "old_line_content": "",
          "new_line_content": "                auto& patch_point = patch_points.top();",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": null,
          "new_api": "constexpr",
          "old_text": null,
          "new_text": "constexpr",
          "old_line_content": "                        return;",
          "new_line_content": "                constexpr auto do_patch = [](auto& patch_it, auto& patch_point, auto& target_offset, auto& bytecode, auto ip) {",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": null,
          "new_api": "key",
          "old_text": null,
          "new_text": "patch_it.key()",
          "old_line_content": "",
          "new_line_content": "                    if (patch_it.key() == ip)",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": null,
          "new_api": "key",
          "old_text": null,
          "new_text": "patch_it.key()",
          "old_line_content": "                };",
          "new_line_content": "                    else if (patch_point.value > 0 && target_offset > patch_it.key() && ip < patch_it.key())",
          "content_same": false
        },
        {
          "line": 420,
          "old_api": null,
          "new_api": "is_end",
          "old_text": null,
          "new_text": "patch_it.is_end()",
          "old_line_content": "",
          "new_line_content": "                else if (auto patch_it = needed_patches.find_largest_not_above_iterator(state.instruction_position); !patch_it.is_end())",
          "content_same": false
        },
        {
          "line": 423,
          "old_api": null,
          "new_api": "pop",
          "old_text": null,
          "new_text": "patch_points.pop()",
          "old_line_content": "",
          "new_line_content": "                patch_points.pop();",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "opcode.size()",
          "old_line_content": "    }",
          "new_line_content": "            state.instruction_position += opcode.size();",
          "content_same": false
        },
        {
          "line": 433,
          "old_api": null,
          "new_api": "print_bytecode",
          "old_text": null,
          "new_text": "dbg.print_bytecode(*this)",
          "old_line_content": "}",
          "new_line_content": "        dbg.print_bytecode(*this);",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": null,
          "new_api": "is_empty",
          "old_text": null,
          "new_text": "left.is_empty()",
          "old_line_content": "        return;",
          "new_line_content": "    if (left.is_empty()) {",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": null,
          "new_api": "extend",
          "old_text": null,
          "new_text": "target.extend(right)",
          "old_line_content": "    }",
          "new_line_content": "        target.extend(right);",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": null,
          "new_api": "is_empty",
          "old_text": null,
          "new_text": "right.is_empty()",
          "old_line_content": "        return;",
          "new_line_content": "    if (right.is_empty()) {",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": null,
          "new_api": "extend",
          "old_text": null,
          "new_text": "target.extend(left)",
          "old_line_content": "    }",
          "new_line_content": "        target.extend(left);",
          "content_same": false
        },
        {
          "line": 452,
          "old_api": null,
          "new_api": "get_opcode",
          "old_text": null,
          "new_text": "left.get_opcode(state).size()",
          "old_line_content": "        if (left_size != right_size)",
          "new_line_content": "        auto left_size = left.get_opcode(state).size();",
          "content_same": false
        },
        {
          "line": 453,
          "old_api": null,
          "new_api": "get_opcode",
          "old_text": null,
          "new_text": "right.get_opcode(state).size()",
          "old_line_content": "            break;",
          "new_line_content": "        auto right_size = right.get_opcode(state).size();",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": null,
          "new_api": "spans",
          "old_text": null,
          "new_text": "right.spans().slice(state.instruction_position, right_size)",
          "old_line_content": "        else",
          "new_line_content": "        if (left.spans().slice(state.instruction_position, left_size) == right.spans().slice(state.instruction_position, right_size))",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "right.size()",
          "old_line_content": "    if (left_skip) {",
          "new_line_content": "    dbgln_if(REGEX_DEBUG, \"Skipping {}/{} bytecode entries from {}/{}\", left_skip, 0, left.size(), right.size());",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": null,
          "new_api": "release_slice",
          "old_text": null,
          "new_text": "left.release_slice(0, left_skip)",
          "old_line_content": "    }",
          "new_line_content": "        target.extend(left.release_slice(0, left_skip));",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": null,
          "new_api": "release_slice",
          "old_text": null,
          "new_text": "right.release_slice(left_skip)",
          "old_line_content": "",
          "new_line_content": "        right = right.release_slice(left_skip);",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": null,
          "new_api": "static_cast<ByteCodeValueType>(OpCodeId::ForkJump)",
          "old_text": null,
          "new_text": "static_cast<ByteCodeValueType>(OpCodeId::ForkJump)",
          "old_line_content": "",
          "new_line_content": "    target.empend(static_cast<ByteCodeValueType>(OpCodeId::ForkJump));",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": null,
          "new_api": "move",
          "old_text": null,
          "new_text": "move(right)",
          "old_line_content": "    if (left_size != 0) {",
          "new_line_content": "    target.extend(move(right));",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": null,
          "new_api": "static_cast<ByteCodeValueType>(OpCodeId::Jump)",
          "old_text": null,
          "new_text": "static_cast<ByteCodeValueType>(OpCodeId::Jump)",
          "old_line_content": "    }",
          "new_line_content": "        target.empend(static_cast<ByteCodeValueType>(OpCodeId::Jump));",
          "content_same": false
        },
        {
          "line": 481,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "left.size()",
          "old_line_content": "",
          "new_line_content": "        target.empend(left.size()); // Jump to the _END label",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": null,
          "new_api": "move",
          "old_text": null,
          "new_text": "move(left)",
          "old_line_content": "    // LABEL _END = alterantive_bytecode.size",
          "new_line_content": "    target.extend(move(left));",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 22,
          "old_api": "split_basic_blocks",
          "new_api": null,
          "old_text": "split_basic_blocks()",
          "new_text": null,
          "old_line_content": "    attempt_rewrite_loops_as_atomic_groups(split_basic_blocks());",
          "new_line_content": "    // Rewrite fork loops as atomic groups",
          "content_same": false
        },
        {
          "line": 37,
          "old_api": "static_cast<T const&>(opcode)",
          "new_api": null,
          "old_text": "static_cast<T const&>(opcode)",
          "new_text": null,
          "old_line_content": "        auto& op = static_cast<T const&>(opcode);",
          "new_line_content": "    state.instruction_position = 0;",
          "content_same": false
        },
        {
          "line": 38,
          "old_api": "offset",
          "new_api": null,
          "old_text": "op.offset()",
          "new_text": null,
          "old_line_content": "        ssize_t jump_offset = op.size() + op.offset();",
          "new_line_content": "    auto check_jump = [&]<typename T>(OpCode const& opcode) {",
          "content_same": false
        },
        {
          "line": 41,
          "old_api": "size",
          "new_api": null,
          "old_text": "opcode.size()",
          "new_text": null,
          "old_line_content": "            end_of_last_block = state.instruction_position + opcode.size();",
          "new_line_content": "        if (jump_offset >= 0) {",
          "content_same": false
        },
        {
          "line": 46,
          "old_api": "append",
          "new_api": null,
          "old_text": "block_boundaries.append({ end_of_last_block, jump_offset + state.instruction_position })",
          "new_text": null,
          "old_line_content": "                block_boundaries.append({ end_of_last_block, jump_offset + state.instruction_position });",
          "new_line_content": "            if (jump_offset + state.instruction_position > end_of_last_block) {",
          "content_same": false
        },
        {
          "line": 47,
          "old_api": "append",
          "new_api": null,
          "old_text": "block_boundaries.append({ jump_offset + state.instruction_position, state.instruction_position })",
          "new_text": null,
          "old_line_content": "                block_boundaries.append({ jump_offset + state.instruction_position, state.instruction_position });",
          "new_line_content": "                // Split the block!",
          "content_same": false
        },
        {
          "line": 51,
          "old_api": "append",
          "new_api": null,
          "old_text": "block_boundaries.append({ end_of_last_block, state.instruction_position })",
          "new_text": null,
          "old_line_content": "                block_boundaries.append({ end_of_last_block, state.instruction_position });",
          "new_line_content": "            } else {",
          "content_same": false
        },
        {
          "line": 52,
          "old_api": "size",
          "new_api": null,
          "old_text": "opcode.size()",
          "new_text": null,
          "old_line_content": "                end_of_last_block = state.instruction_position + opcode.size();",
          "new_line_content": "                // Nope, it's just a jump to another block",
          "content_same": false
        },
        {
          "line": 57,
          "old_api": "get_opcode",
          "new_api": null,
          "old_text": "bytecode.get_opcode(state)",
          "new_text": null,
          "old_line_content": "        auto& opcode = bytecode.get_opcode(state);",
          "new_line_content": "    };",
          "content_same": false
        },
        {
          "line": 64,
          "old_api": "check_jump.template operator()<OpCode_JumpNonEmpty>(opcode)",
          "new_api": null,
          "old_text": "check_jump.template operator()<OpCode_JumpNonEmpty>(opcode)",
          "new_text": null,
          "old_line_content": "            check_jump.template operator()<OpCode_JumpNonEmpty>(opcode);",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 67,
          "old_api": "check_jump.template operator()<OpCode_ForkJump>(opcode)",
          "new_api": null,
          "old_text": "check_jump.template operator()<OpCode_ForkJump>(opcode)",
          "new_text": null,
          "old_line_content": "            check_jump.template operator()<OpCode_ForkJump>(opcode);",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 70,
          "old_api": "check_jump.template operator()<OpCode_ForkStay>(opcode)",
          "new_api": null,
          "old_text": "check_jump.template operator()<OpCode_ForkStay>(opcode)",
          "new_text": null,
          "old_line_content": "            check_jump.template operator()<OpCode_ForkStay>(opcode);",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 73,
          "old_api": "append",
          "new_api": null,
          "old_text": "block_boundaries.append({ end_of_last_block, state.instruction_position })",
          "new_text": null,
          "old_line_content": "            block_boundaries.append({ end_of_last_block, state.instruction_position });",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 74,
          "old_api": "size",
          "new_api": null,
          "old_text": "opcode.size()",
          "new_text": null,
          "old_line_content": "            end_of_last_block = state.instruction_position + opcode.size();",
          "new_line_content": "        case OpCodeId::FailForks:",
          "content_same": false
        },
        {
          "line": 78,
          "old_api": "offset",
          "new_api": null,
          "old_text": "static_cast<OpCode_Repeat const&>(opcode).offset()",
          "new_text": null,
          "old_line_content": "            auto repeat_start = state.instruction_position - static_cast<OpCode_Repeat const&>(opcode).offset();",
          "new_line_content": "        case OpCodeId::Repeat: {",
          "content_same": false
        },
        {
          "line": 81,
          "old_api": "append",
          "new_api": null,
          "old_text": "block_boundaries.append({ repeat_start, state.instruction_position })",
          "new_text": null,
          "old_line_content": "            block_boundaries.append({ repeat_start, state.instruction_position });",
          "new_line_content": "            if (repeat_start > end_of_last_block)",
          "content_same": false
        },
        {
          "line": 89,
          "old_api": "size",
          "new_api": null,
          "old_text": "opcode.size()",
          "new_text": null,
          "old_line_content": "        auto next_ip = state.instruction_position + opcode.size();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 90,
          "old_api": "size",
          "new_api": null,
          "old_text": "bytecode.size()",
          "new_text": null,
          "old_line_content": "        if (next_ip < bytecode.size())",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 96,
          "old_api": "size",
          "new_api": null,
          "old_text": "bytecode.size()",
          "new_text": null,
          "old_line_content": "    if (end_of_last_block < bytecode.size())",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 97,
          "old_api": "size",
          "new_api": null,
          "old_text": "bytecode.size()",
          "new_text": null,
          "old_line_content": "        block_boundaries.append({ end_of_last_block, bytecode.size() });",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 110,
          "old_api": "get_opcode",
          "new_api": null,
          "old_text": "bytecode.get_opcode(state)",
          "new_text": null,
          "old_line_content": "        auto& opcode = bytecode.get_opcode(state);",
          "new_line_content": "    MatchState state;",
          "content_same": false
        },
        {
          "line": 111,
          "old_api": "opcode_id",
          "new_api": null,
          "old_text": "opcode.opcode_id()",
          "new_text": null,
          "old_line_content": "        switch (opcode.opcode_id()) {",
          "new_line_content": "    for (state.instruction_position = repeated_block.start; state.instruction_position < repeated_block.end;) {",
          "content_same": false
        },
        {
          "line": 114,
          "old_api": "any_of",
          "new_api": null,
          "old_text": "any_of(compares, [](auto& compare) { return compare.type == CharacterCompareType::AnyChar; })",
          "new_text": null,
          "old_line_content": "            if (repeated_values.is_empty() && any_of(compares, [](auto& compare) { return compare.type == CharacterCompareType::AnyChar; }))",
          "new_line_content": "        case OpCodeId::Compare: {",
          "content_same": false
        },
        {
          "line": 121,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "repeated_values.is_empty()",
          "new_text": null,
          "old_line_content": "            if (repeated_values.is_empty())",
          "new_line_content": "        case OpCodeId::CheckBegin:",
          "content_same": false
        },
        {
          "line": 131,
          "old_api": "id",
          "new_api": null,
          "old_text": "static_cast<OpCode_SaveRightCaptureGroup const&>(opcode).id()",
          "new_text": null,
          "old_line_content": "            active_capture_groups.set(static_cast<OpCode_SaveRightCaptureGroup const&>(opcode).id());",
          "new_line_content": "            return false;",
          "content_same": false
        },
        {
          "line": 134,
          "old_api": "id",
          "new_api": null,
          "old_text": "static_cast<OpCode_SaveLeftCaptureGroup const&>(opcode).id()",
          "new_text": null,
          "old_line_content": "            active_capture_groups.set(static_cast<OpCode_SaveLeftCaptureGroup const&>(opcode).id());",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 140,
          "old_api": "size",
          "new_api": null,
          "old_text": "opcode.size()",
          "new_text": null,
          "old_line_content": "        state.instruction_position += opcode.size();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 143,
          "old_api": "size",
          "new_api": null,
          "old_text": "active_capture_groups.size()",
          "new_text": null,
          "old_line_content": "    dbgln_if(REGEX_DEBUG, \"Found {} active capture groups\", active_capture_groups.size());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 147,
          "old_api": "get_opcode",
          "new_api": null,
          "old_text": "bytecode.get_opcode(state)",
          "new_text": null,
          "old_line_content": "        auto& opcode = bytecode.get_opcode(state);",
          "new_line_content": "    // Find the first compare in the following block, it must NOT match any of the values in `repeated_values'.",
          "content_same": false
        },
        {
          "line": 148,
          "old_api": "opcode_id",
          "new_api": null,
          "old_text": "opcode.opcode_id()",
          "new_text": null,
          "old_line_content": "        switch (opcode.opcode_id()) {",
          "new_line_content": "    for (state.instruction_position = following_block.start; state.instruction_position < following_block.end;) {",
          "content_same": false
        },
        {
          "line": 151,
          "old_api": "id",
          "new_api": null,
          "old_text": "static_cast<OpCode_SaveRightCaptureGroup const&>(opcode).id()",
          "new_text": null,
          "old_line_content": "            active_capture_groups.set(static_cast<OpCode_SaveRightCaptureGroup const&>(opcode).id());",
          "new_line_content": "        // Note: These have to exist since we're effectively repeating the following block as well",
          "content_same": false
        },
        {
          "line": 154,
          "old_api": "id",
          "new_api": null,
          "old_text": "static_cast<OpCode_SaveLeftCaptureGroup const&>(opcode).id()",
          "new_text": null,
          "old_line_content": "            active_capture_groups.set(static_cast<OpCode_SaveLeftCaptureGroup const&>(opcode).id());",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 158,
          "old_api": "flat_compares",
          "new_api": null,
          "old_text": "static_cast<OpCode_Compare const&>(opcode).flat_compares()",
          "new_text": null,
          "old_line_content": "            auto compares = static_cast<OpCode_Compare const&>(opcode).flat_compares();",
          "new_line_content": "        case OpCodeId::Compare: {",
          "content_same": false
        },
        {
          "line": 159,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "compares.is_empty()",
          "new_text": null,
          "old_line_content": "            if (compares.is_empty())",
          "new_line_content": "            // We found a compare, let's see what it has.",
          "content_same": false
        },
        {
          "line": 162,
          "old_api": "contains",
          "new_api": null,
          "old_text": "any_of(compares, [&](auto& compare) {\n                    return compare.type == CharacterCompareType::AnyChar\n                        || (compare.type == CharacterCompareType::Reference && active_capture_groups.contains(compare.value));\n                })",
          "new_text": null,
          "old_line_content": "            if (any_of(compares, [&](auto& compare) {",
          "new_line_content": "                break;",
          "content_same": false
        },
        {
          "line": 170,
          "old_api": "any_of",
          "new_api": null,
          "old_text": "any_of(repeated_value, [](auto& compare) { return compare.type == CharacterCompareType::AnyChar; })",
          "new_text": null,
          "old_line_content": "                if (any_of(repeated_value, [](auto& compare) { return compare.type == CharacterCompareType::AnyChar; }))",
          "new_line_content": "            for (auto& repeated_value : repeated_values) {",
          "content_same": false
        },
        {
          "line": 175,
          "old_api": "any_of",
          "new_api": null,
          "old_text": "any_of(compares, [&](auto& compare) { return compare.type == repeated_compare.type && compare.value == repeated_compare.value; })",
          "new_text": null,
          "old_line_content": "                    if (any_of(compares, [&](auto& compare) { return compare.type == repeated_compare.type && compare.value == repeated_compare.value; }))",
          "new_line_content": "                for (auto& repeated_compare : repeated_value) {",
          "content_same": false
        },
        {
          "line": 191,
          "old_api": "size",
          "new_api": null,
          "old_text": "opcode.size()",
          "new_text": null,
          "old_line_content": "        state.instruction_position += opcode.size();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": "print_bytecode",
          "new_api": null,
          "old_text": "dbg.print_bytecode(*this)",
          "new_text": null,
          "old_line_content": "        dbg.print_bytecode(*this);",
          "new_line_content": "    if constexpr (REGEX_DEBUG) {",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": "opcode_id",
          "new_api": null,
          "old_text": "opcode.opcode_id()",
          "new_text": null,
          "old_line_content": "        switch (opcode.opcode_id()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 255,
          "old_api": "form",
          "new_api": null,
          "old_text": "op.form()",
          "new_text": null,
          "old_line_content": "            auto form = op.form();",
          "new_line_content": "        case OpCodeId::JumpNonEmpty: {",
          "content_same": false
        },
        {
          "line": 260,
          "old_api": "size",
          "new_api": null,
          "old_text": "opcode.size()",
          "new_text": null,
          "old_line_content": "            return op.offset() + ip + opcode.size() == block_start;",
          "new_line_content": "            if (form != OpCodeId::ForkJump && form != OpCodeId::ForkStay && alternate_form == AlternateForm::DirectLoopWithoutHeader)",
          "content_same": false
        },
        {
          "line": 265,
          "old_api": "size",
          "new_api": null,
          "old_text": "opcode.size()",
          "new_text": null,
          "old_line_content": "            return static_cast<OpCode_ForkJump const&>(opcode).offset() + ip + opcode.size() == block_start;",
          "new_line_content": "            if (alternate_form == AlternateForm::DirectLoopWithHeader)",
          "content_same": false
        },
        {
          "line": 269,
          "old_api": "size",
          "new_api": null,
          "old_text": "opcode.size()",
          "new_text": null,
          "old_line_content": "            return static_cast<OpCode_ForkStay const&>(opcode).offset() + ip + opcode.size() == block_start;",
          "new_line_content": "            if (alternate_form == AlternateForm::DirectLoopWithHeader)",
          "content_same": false
        },
        {
          "line": 275,
          "old_api": "size",
          "new_api": null,
          "old_text": "opcode.size()",
          "new_text": null,
          "old_line_content": "                return static_cast<OpCode_Jump const&>(opcode).offset() + ip + opcode.size() == block_start;",
          "new_line_content": "                return false;",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": "VERIFY_NOT_REACHED",
          "new_api": null,
          "old_text": "VERIFY_NOT_REACHED()",
          "new_text": null,
          "old_line_content": "            VERIFY_NOT_REACHED();",
          "new_line_content": "            if (alternate_form == AlternateForm::DirectLoopWithHeader)",
          "content_same": false
        },
        {
          "line": 281,
          "old_api": "size",
          "new_api": null,
          "old_text": "basic_blocks.size()",
          "new_text": null,
          "old_line_content": "    for (size_t i = 0; i < basic_blocks.size(); ++i) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 284,
          "old_api": "size",
          "new_api": null,
          "old_text": "basic_blocks.size()",
          "new_text": null,
          "old_line_content": "        if (i + 1 < basic_blocks.size())",
          "new_line_content": "        auto forking_block = basic_blocks[i];",
          "content_same": false
        },
        {
          "line": 290,
          "old_api": "get_opcode",
          "new_api": null,
          "old_text": "bytecode.get_opcode(state)",
          "new_text": null,
          "old_line_content": "            auto& opcode = bytecode.get_opcode(state);",
          "new_line_content": "        {",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": "is_an_eligible_jump",
          "new_api": null,
          "old_text": "is_an_eligible_jump(opcode, state.instruction_position, forking_block.start, AlternateForm::DirectLoopWithoutHeader)",
          "new_text": null,
          "old_line_content": "            if (is_an_eligible_jump(opcode, state.instruction_position, forking_block.start, AlternateForm::DirectLoopWithoutHeader)) {",
          "new_line_content": "            state.instruction_position = forking_block.end;",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": "has_value",
          "new_api": null,
          "old_text": "fork_fallback_block.has_value()",
          "new_text": null,
          "old_line_content": "                if (!fork_fallback_block.has_value() || fork_fallback_block->end == fork_fallback_block->start) {",
          "new_line_content": "                // We've found RE0 (and RE1 is just the following block, if any), let's see if the precondition applies.",
          "content_same": false
        },
        {
          "line": 295,
          "old_api": "append",
          "new_api": null,
          "old_text": "candidate_blocks.append({ forking_block, fork_fallback_block, AlternateForm::DirectLoopWithoutHeader })",
          "new_text": null,
          "old_line_content": "                    candidate_blocks.append({ forking_block, fork_fallback_block, AlternateForm::DirectLoopWithoutHeader });",
          "new_line_content": "                // if RE1 is empty, there's no first(RE1), so this is an automatic pass.",
          "content_same": false
        },
        {
          "line": 299,
          "old_api": "block_satisfies_atomic_rewrite_precondition",
          "new_api": null,
          "old_text": "block_satisfies_atomic_rewrite_precondition(bytecode, forking_block, *fork_fallback_block)",
          "new_text": null,
          "old_line_content": "                if (block_satisfies_atomic_rewrite_precondition(bytecode, forking_block, *fork_fallback_block)) {",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 300,
          "old_api": "append",
          "new_api": null,
          "old_text": "candidate_blocks.append({ forking_block, fork_fallback_block, AlternateForm::DirectLoopWithoutHeader })",
          "new_text": null,
          "old_line_content": "                    candidate_blocks.append({ forking_block, fork_fallback_block, AlternateForm::DirectLoopWithoutHeader });",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 306,
          "old_api": "has_value",
          "new_api": null,
          "old_text": "fork_fallback_block.has_value()",
          "new_text": null,
          "old_line_content": "        if (fork_fallback_block.has_value()) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 309,
          "old_api": "is_an_eligible_jump",
          "new_api": null,
          "old_text": "is_an_eligible_jump(opcode, state.instruction_position, forking_block.start, AlternateForm::DirectLoopWithHeader)",
          "new_text": null,
          "old_line_content": "            if (is_an_eligible_jump(opcode, state.instruction_position, forking_block.start, AlternateForm::DirectLoopWithHeader)) {",
          "new_line_content": "            state.instruction_position = fork_fallback_block->end;",
          "content_same": false
        },
        {
          "line": 312,
          "old_api": "get_opcode",
          "new_api": null,
          "old_text": "bytecode.get_opcode(state)",
          "new_text": null,
          "old_line_content": "                auto& opcode = bytecode.get_opcode(state);",
          "new_line_content": "                // We've found bb1 and bb0, let's just make sure that bb0 forks to bb2.",
          "content_same": false
        },
        {
          "line": 313,
          "old_api": "opcode_id",
          "new_api": null,
          "old_text": "opcode.opcode_id()",
          "new_text": null,
          "old_line_content": "                if (opcode.opcode_id() == OpCodeId::ForkJump || opcode.opcode_id() == OpCodeId::ForkStay) {",
          "new_line_content": "                state.instruction_position = forking_block.end;",
          "content_same": false
        },
        {
          "line": 318,
          "old_api": "append",
          "new_api": null,
          "old_text": "candidate_blocks.append({ forking_block, {}, AlternateForm::DirectLoopWithHeader })",
          "new_text": null,
          "old_line_content": "                        candidate_blocks.append({ forking_block, {}, AlternateForm::DirectLoopWithHeader });",
          "new_line_content": "                        block_following_fork_fallback = basic_blocks[i + 2];",
          "content_same": false
        },
        {
          "line": 326,
          "old_api": "size",
          "new_api": null,
          "old_text": "candidate_blocks.size()",
          "new_text": null,
          "old_line_content": "    dbgln_if(REGEX_DEBUG, \"Found {} candidate blocks\", candidate_blocks.size());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 327,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "candidate_blocks.is_empty()",
          "new_text": null,
          "old_line_content": "    if (candidate_blocks.is_empty()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 335,
          "old_api": "quick_sort",
          "new_api": null,
          "old_text": "quick_sort(candidate_blocks, [](auto& a, auto& b) { return b.forking_block.start > a.forking_block.start; })",
          "new_text": null,
          "old_line_content": "    quick_sort(candidate_blocks, [](auto& a, auto& b) { return b.forking_block.start > a.forking_block.start; });",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 351,
          "old_api": "VERIFY_NOT_REACHED",
          "new_api": null,
          "old_text": "VERIFY_NOT_REACHED()",
          "new_text": null,
          "old_line_content": "                VERIFY_NOT_REACHED();",
          "new_line_content": "                jump_opcode_id = (ByteCodeValueType)OpCodeId::ForkReplaceJump;",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": "has_value",
          "new_api": null,
          "old_text": "candidate.new_target_block.has_value()",
          "new_text": null,
          "old_line_content": "            if (candidate.new_target_block.has_value()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 360,
          "old_api": "insert",
          "new_api": null,
          "old_text": "bytecode.insert(candidate.forking_block.start + 1, candidate.new_target_block->start - candidate.forking_block.start)",
          "new_text": null,
          "old_line_content": "                bytecode.insert(candidate.forking_block.start + 1, candidate.new_target_block->start - candidate.forking_block.start);",
          "new_line_content": "                // Insert a fork-stay targeted at the second block.",
          "content_same": false
        },
        {
          "line": 366,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "needed_patches.is_empty()",
          "new_text": null,
          "old_line_content": "    if (!needed_patches.is_empty()) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": "size",
          "new_api": null,
          "old_text": "bytecode.size()",
          "new_text": null,
          "old_line_content": "            if (state.instruction_position >= bytecode.size())",
          "new_line_content": "        };",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": "get_opcode",
          "new_api": null,
          "old_text": "bytecode.get_opcode(state)",
          "new_text": null,
          "old_line_content": "            auto& opcode = bytecode.get_opcode(state);",
          "new_line_content": "                break;",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": "opcode_id",
          "new_api": null,
          "old_text": "opcode.opcode_id()",
          "new_text": null,
          "old_line_content": "            switch (opcode.opcode_id()) {",
          "new_line_content": "            Stack<Patch, 2> patch_points;",
          "content_same": false
        },
        {
          "line": 386,
          "old_api": "offset",
          "new_api": null,
          "old_text": "static_cast<OpCode_JumpNonEmpty const&>(opcode).offset()",
          "new_text": null,
          "old_line_content": "                patch_points.push({ static_cast<OpCode_JumpNonEmpty const&>(opcode).offset(), state.instruction_position + 1 });",
          "new_line_content": "                break;",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": "checkpoint",
          "new_api": null,
          "old_text": "static_cast<OpCode_JumpNonEmpty const&>(opcode).checkpoint()",
          "new_text": null,
          "old_line_content": "                patch_points.push({ static_cast<OpCode_JumpNonEmpty const&>(opcode).checkpoint(), state.instruction_position + 2 });",
          "new_line_content": "            case OpCodeId::JumpNonEmpty:",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": "offset",
          "new_api": null,
          "old_text": "static_cast<OpCode_ForkJump const&>(opcode).offset()",
          "new_text": null,
          "old_line_content": "                patch_points.push({ static_cast<OpCode_ForkJump const&>(opcode).offset(), state.instruction_position + 1 });",
          "new_line_content": "                break;",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": "offset",
          "new_api": null,
          "old_text": "static_cast<OpCode_ForkStay const&>(opcode).offset()",
          "new_text": null,
          "old_line_content": "                patch_points.push({ static_cast<OpCode_ForkStay const&>(opcode).offset(), state.instruction_position + 1 });",
          "new_line_content": "                break;",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": "offset",
          "new_api": null,
          "old_text": "static_cast<OpCode_Repeat const&>(opcode).offset()",
          "new_text": null,
          "old_line_content": "                patch_points.push({ -(ssize_t) static_cast<OpCode_Repeat const&>(opcode).offset(), state.instruction_position + 1, true });",
          "new_line_content": "                break;",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "patch_points.is_empty()",
          "new_text": null,
          "old_line_content": "            while (!patch_points.is_empty()) {",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": "top",
          "new_api": null,
          "old_text": "patch_points.top()",
          "new_text": null,
          "old_line_content": "                auto& patch_point = patch_points.top();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 407,
          "old_api": "key",
          "new_api": null,
          "old_text": "patch_it.key()",
          "new_text": null,
          "old_line_content": "                    if (patch_it.key() == ip)",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 410,
          "old_api": "key",
          "new_api": null,
          "old_text": "patch_it.key()",
          "new_text": null,
          "old_line_content": "                    if (patch_point.value < 0 && target_offset < patch_it.key() && ip > patch_it.key())",
          "new_line_content": "                        return;",
          "content_same": false
        },
        {
          "line": 416,
          "old_api": "is_end",
          "new_api": null,
          "old_text": "patch_it.is_end()",
          "new_text": null,
          "old_line_content": "                if (auto patch_it = needed_patches.find_largest_not_above_iterator(target_offset); !patch_it.is_end())",
          "new_line_content": "                };",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": "do_patch",
          "new_api": null,
          "old_text": "do_patch(patch_it, patch_point, target_offset, bytecode, state.instruction_position)",
          "new_text": null,
          "old_line_content": "                    do_patch(patch_it, patch_point, target_offset, bytecode, state.instruction_position);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": "size",
          "new_api": null,
          "old_text": "opcode.size()",
          "new_text": null,
          "old_line_content": "            state.instruction_position += opcode.size();",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 429,
          "old_api": "warnln",
          "new_api": null,
          "old_text": "warnln(\"Transformed to:\")",
          "new_text": null,
          "old_line_content": "        warnln(\"Transformed to:\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 437,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "left.is_empty()",
          "new_text": null,
          "old_line_content": "    if (left.is_empty()) {",
          "new_line_content": "void Optimizer::append_alternation(ByteCode& target, ByteCode&& left, ByteCode&& right)",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": "extend",
          "new_api": null,
          "old_text": "target.extend(right)",
          "new_text": null,
          "old_line_content": "        target.extend(right);",
          "new_line_content": "{",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": "is_empty",
          "new_api": null,
          "old_text": "right.is_empty()",
          "new_text": null,
          "old_line_content": "    if (right.is_empty()) {",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 443,
          "old_api": "extend",
          "new_api": null,
          "old_text": "target.extend(left)",
          "new_text": null,
          "old_line_content": "        target.extend(left);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 449,
          "old_api": "size",
          "new_api": null,
          "old_text": "right.size()",
          "new_text": null,
          "old_line_content": "    for (state.instruction_position = 0; state.instruction_position < left.size() && state.instruction_position < right.size();) {",
          "new_line_content": "    size_t left_skip = 0;",
          "content_same": false
        },
        {
          "line": 450,
          "old_api": "get_opcode",
          "new_api": null,
          "old_text": "left.get_opcode(state).size()",
          "new_text": null,
          "old_line_content": "        auto left_size = left.get_opcode(state).size();",
          "new_line_content": "    MatchState state;",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": "spans",
          "new_api": null,
          "old_text": "right.spans().slice(state.instruction_position, right_size)",
          "new_text": null,
          "old_line_content": "        if (left.spans().slice(state.instruction_position, left_size) == right.spans().slice(state.instruction_position, right_size))",
          "new_line_content": "            break;",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "size",
          "new_api": null,
          "old_text": "right.size()",
          "new_text": null,
          "old_line_content": "    dbgln_if(REGEX_DEBUG, \"Skipping {}/{} bytecode entries from {}/{}\", left_skip, 0, left.size(), right.size());",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": "release_slice",
          "new_api": null,
          "old_text": "left.release_slice(0, left_skip)",
          "new_text": null,
          "old_line_content": "        target.extend(left.release_slice(0, left_skip));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 467,
          "old_api": "release_slice",
          "new_api": null,
          "old_text": "right.release_slice(left_skip)",
          "new_text": null,
          "old_line_content": "        right = right.release_slice(left_skip);",
          "new_line_content": "    if (left_skip) {",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": "size",
          "new_api": null,
          "old_text": "left.size()",
          "new_text": null,
          "old_line_content": "    auto left_size = left.size();",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": "size",
          "new_api": null,
          "old_text": "right.size()",
          "new_text": null,
          "old_line_content": "    target.empend(right.size() + (left_size ? 2 : 0)); // Jump to the _ALT label",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": "static_cast<ByteCodeValueType>(OpCodeId::Jump)",
          "new_api": null,
          "old_text": "static_cast<ByteCodeValueType>(OpCodeId::Jump)",
          "new_text": null,
          "old_line_content": "        target.empend(static_cast<ByteCodeValueType>(OpCodeId::Jump));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": "size",
          "new_api": null,
          "old_text": "left.size()",
          "new_text": null,
          "old_line_content": "        target.empend(left.size()); // Jump to the _END label",
          "new_line_content": "    if (left_size != 0) {",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": "move",
          "new_api": null,
          "old_text": "move(left)",
          "new_text": null,
          "old_line_content": "    target.extend(move(left));",
          "new_line_content": "    // LABEL _ALT = bytecode.size() + 2",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 25,
      "total_additions": 98,
      "total_deletions": 97,
      "total_api_changes": 220
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 2,
        "api_related_lines": 220,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          21
        ]
      }
    },
    "api_calls_before": 188,
    "api_calls_after": 189,
    "diff_info": {
      "added_lines": 2,
      "removed_lines": 0,
      "total_diff_lines": 14
    }
  }
}