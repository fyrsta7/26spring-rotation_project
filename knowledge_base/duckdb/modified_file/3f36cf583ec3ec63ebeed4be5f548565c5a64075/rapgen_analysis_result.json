{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/duckdb/modified_file/3f36cf583ec3ec63ebeed4be5f548565c5a64075",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/duckdb/modified_file/3f36cf583ec3ec63ebeed4be5f548565c5a64075/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/duckdb/modified_file/3f36cf583ec3ec63ebeed4be5f548565c5a64075/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/duckdb/modified_file/3f36cf583ec3ec63ebeed4be5f548565c5a64075/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 341,
          "old_api": "Fuse",
          "new_api": "Types",
          "old_text": "payload.Fuse(input)",
          "new_text": "over.Types().end()",
          "old_line_content": "\tpayload.Fuse(input);",
          "new_line_content": "\tpayload_types.insert(payload_types.end(), over.Types().begin(), over.Types().end());",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": "Types",
          "new_api": "InitializeEmpty",
          "old_text": "payload.Types()",
          "new_text": "payload_chunk.InitializeEmpty(payload_types)",
          "old_line_content": "\tauto payload_types = payload.Types();",
          "new_line_content": "\tpayload_chunk.InitializeEmpty(payload_types);",
          "content_same": false
        },
        {
          "line": 370,
          "old_api": "Chunks",
          "new_api": "ColumnCount",
          "old_text": "payload.Chunks()",
          "new_text": "input_chunk.ColumnCount()",
          "old_line_content": "\t\tauto &payload_chunk = *payload.Chunks()[i];",
          "new_line_content": "\t\tfor (idx_t col_idx = 0; col_idx < input_chunk.ColumnCount(); ++col_idx) {",
          "content_same": false
        },
        {
          "line": 374,
          "old_api": "Chunks",
          "new_api": "ColumnCount",
          "old_text": "hashes->Chunks()",
          "new_text": "over_chunk.ColumnCount()",
          "old_line_content": "\t\t\tauto &hash_chunk = *hashes->Chunks()[i];",
          "new_line_content": "\t\tfor (idx_t col_idx = 0; col_idx < over_chunk.ColumnCount(); ++col_idx) {",
          "content_same": false
        },
        {
          "line": 375,
          "old_api": "size",
          "new_api": "ColumnCount",
          "old_text": "hash_chunk.size()",
          "new_text": "input_chunk.ColumnCount()",
          "old_line_content": "\t\t\tauto hash_size = hash_chunk.size();",
          "new_line_content": "\t\t\tpayload_chunk.data[input_chunk.ColumnCount() + col_idx].Reference(over_chunk.data[col_idx]);",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": "Reset",
          "new_api": "set_index",
          "old_text": "over_partition.Reset()",
          "new_text": "sel.set_index(bin_size++, i)",
          "old_line_content": "\t\t\t\tover_partition.Reset();",
          "new_line_content": "\t\t\t\t\tsel.set_index(bin_size++, i);",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": "Append",
          "new_api": "SinkChunk",
          "old_text": "over_partition.Append(over_chunk, false, &sel, bin_size)",
          "new_text": "local_sort_state.SinkChunk(over_partition, payload_partition)",
          "old_line_content": "\t\t\t\tover_partition.Append(over_chunk, false, &sel, bin_size);",
          "new_line_content": "\t\t\t\tlocal_sort_state.SinkChunk(over_partition, payload_partition);",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": "Append",
          "new_api": "Reset",
          "old_text": "payload_partition.Append(payload_chunk, false, &sel, bin_size)",
          "new_text": "over_partition.Reset()",
          "old_line_content": "\t\t\t\tpayload_partition.Append(payload_chunk, false, &sel, bin_size);",
          "new_line_content": "\t\t\t\tover_partition.Reset();",
          "content_same": false
        },
        {
          "line": 404,
          "old_api": "Reset",
          "new_api": "SinkChunk",
          "old_text": "over_partition.Reset()",
          "new_text": "local_sort_state.SinkChunk(over_chunk, payload_chunk)",
          "old_line_content": "\t\tover_partition.Reset();",
          "new_line_content": "\t\t\tlocal_sort_state.SinkChunk(over_chunk, payload_chunk);",
          "content_same": false
        },
        {
          "line": 410,
          "old_api": "Reset",
          "new_api": "SinkChunk",
          "old_text": "over.Reset()",
          "new_text": "local_sort_state.SinkChunk(over_partition, payload_partition)",
          "old_line_content": "\t\tover.Reset();",
          "new_line_content": "\t\tlocal_sort_state.SinkChunk(over_partition, payload_partition);",
          "content_same": false
        },
        {
          "line": 417,
          "old_api": "PrepareMergePhase",
          "new_api": "Reset",
          "old_text": "global_sort_state.PrepareMergePhase()",
          "new_text": "over.Reset()",
          "old_line_content": "\tglobal_sort_state.PrepareMergePhase();",
          "new_line_content": "\t\tover.Reset();",
          "content_same": false
        },
        {
          "line": 433,
          "old_api": "SetCardinality",
          "new_api": "end",
          "old_text": "payload_chunk.SetCardinality(0)",
          "new_text": "over_types.end()",
          "old_line_content": "\t\tpayload_chunk.SetCardinality(0);",
          "new_line_content": "\tpayload_types.insert(payload_types.end(), over_types.begin(), over_types.end());",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": "size",
          "new_api": "Scan",
          "old_text": "input_types.size()",
          "new_text": "scanner.Scan(payload_chunk)",
          "old_line_content": "\t\tpayload_chunk.Split(over_chunk, input_types.size());",
          "new_line_content": "\t\tscanner.Scan(payload_chunk);",
          "content_same": false
        },
        {
          "line": 451,
          "old_api": "Initialize",
          "new_api": "Append",
          "old_text": "hash_chunk.Initialize(hash_types)",
          "new_text": "input.Append(payload_chunk)",
          "old_line_content": "\thash_chunk.Initialize(hash_types);",
          "new_line_content": "\t\tinput.Append(payload_chunk);",
          "content_same": false
        },
        {
          "line": 452,
          "old_api": "SetCardinality",
          "new_api": "Append",
          "old_text": "hash_chunk.SetCardinality(sort_chunk)",
          "new_text": "over.Append(over_chunk)",
          "old_line_content": "\thash_chunk.SetCardinality(sort_chunk);",
          "new_line_content": "\t\tover.Append(over_chunk);",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": "VectorOperations::CombineHash(hash_vector, sort_chunk.data[prt_idx], count)",
          "new_api": "Initialize",
          "old_text": "VectorOperations::CombineHash(hash_vector, sort_chunk.data[prt_idx], count)",
          "new_text": "hash_chunk.Initialize(hash_types)",
          "old_line_content": "\t\tVectorOperations::CombineHash(hash_vector, sort_chunk.data[prt_idx], count);",
          "new_line_content": "\thash_chunk.Initialize(hash_types);",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": "FlatVector::GetData<hash_t>(hash_vector)",
          "new_api": "size",
          "old_text": "FlatVector::GetData<hash_t>(hash_vector)",
          "new_text": "sort_chunk.size()",
          "old_line_content": "\tauto hashes = FlatVector::GetData<hash_t>(hash_vector);",
          "new_line_content": "\tconst auto count = sort_chunk.size();",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "GetVectorType",
          "new_api": "VectorOperations::Hash(sort_chunk.data[0], hash_vector, count)",
          "old_text": "hash_vector.GetVectorType()",
          "new_text": "VectorOperations::Hash(sort_chunk.data[0], hash_vector, count)",
          "old_line_content": "\tif (hash_vector.GetVectorType() == VectorType::CONSTANT_VECTOR) {",
          "new_line_content": "\tVectorOperations::Hash(sort_chunk.data[0], hash_vector, count);",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": "AddExpression",
          "new_api": "push_back",
          "old_text": "executor.AddExpression(*oexpr)",
          "new_text": "over_types.push_back(pexpr->return_type)",
          "old_line_content": "\t\texecutor.AddExpression(*oexpr);",
          "new_line_content": "\t\tover_types.push_back(pexpr->return_type);",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": "Execute",
          "new_api": "push_back",
          "old_text": "executor.Execute(input_chunk, over_chunk)",
          "new_text": "over_types.push_back(oexpr->return_type)",
          "old_line_content": "\texecutor.Execute(input_chunk, over_chunk);",
          "new_line_content": "\t\tover_types.push_back(oexpr->return_type);",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": "BoundaryNeedsPeer",
          "new_api": "size",
          "old_text": "BoundaryNeedsPeer(wexpr->end)",
          "new_text": "wexpr->orders.size()",
          "old_line_content": "\t      needs_peer(BoundaryNeedsPeer(wexpr->end) || wexpr->type == ExpressionType::WINDOW_CUME_DIST) {",
          "new_line_content": "\t      partition_count(wexpr->partitions.size()), order_count(wexpr->orders.size()),",
          "content_same": false
        },
        {
          "line": 628,
          "old_api": "CellIsNull",
          "new_api": "OP::template Operation(lhs, val)",
          "old_text": "CellIsNull(boundary, 0, boundary_row)",
          "new_text": "OP::template Operation(lhs, val)",
          "old_line_content": "\tD_ASSERT(!CellIsNull(boundary, 0, boundary_row));",
          "new_line_content": "\t\treturn OP::template Operation(lhs, val);",
          "content_same": false
        },
        {
          "line": 635,
          "old_api": "std::lower_bound(begin, end, val, comp)",
          "new_api": "CellIsNull",
          "old_text": "std::lower_bound(begin, end, val, comp)",
          "new_text": "CellIsNull(boundary, 0, boundary_row)",
          "old_line_content": "\t\treturn idx_t(std::lower_bound(begin, end, val, comp));",
          "new_line_content": "\tD_ASSERT(!CellIsNull(boundary, 0, boundary_row));",
          "content_same": false
        },
        {
          "line": 644,
          "old_api": "Types",
          "new_api": "std::upper_bound(begin, end, val, comp)",
          "old_text": "over.Types()",
          "new_text": "std::upper_bound(begin, end, val, comp)",
          "old_line_content": "\tconst auto &over_types = over.Types();",
          "new_line_content": "\t\treturn idx_t(std::upper_bound(begin, end, val, comp));",
          "content_same": false
        },
        {
          "line": 651,
          "old_api": "FindTypedRangeBound<int8_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": "Types",
          "old_text": "FindTypedRangeBound<int8_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": "over.Types()",
          "old_line_content": "\t\treturn FindTypedRangeBound<int8_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "\tconst auto &over_types = over.Types();",
          "content_same": false
        },
        {
          "line": 653,
          "old_api": "FindTypedRangeBound<int16_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": "Types",
          "old_text": "FindTypedRangeBound<int16_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": "boundary.Types().size()",
          "old_line_content": "\t\treturn FindTypedRangeBound<int16_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "\tD_ASSERT(boundary.Types().size() == 1);",
          "content_same": false
        },
        {
          "line": 796,
          "old_api": "CellIsNull",
          "new_api": "FindOrderedRangeBound<true>(over_collection, order_col, bounds.range_sense, bounds.valid_start, row_idx,\n\t\t\t                                boundary_start_collection, expr_idx)",
          "old_text": "CellIsNull(boundary_start_collection, 0, expr_idx)",
          "new_text": "FindOrderedRangeBound<true>(over_collection, order_col, bounds.range_sense, bounds.valid_start, row_idx,\n\t\t\t                                boundary_start_collection, expr_idx)",
          "old_line_content": "\t\tif (CellIsNull(boundary_start_collection, 0, expr_idx)) {",
          "new_line_content": "\t\t\t    FindOrderedRangeBound<true>(over_collection, order_col, bounds.range_sense, bounds.valid_start, row_idx,",
          "content_same": false
        },
        {
          "line": 827,
          "old_api": "CellIsNull",
          "new_api": "GetCell<int64_t>(boundary_end_collection, 0, bounds.scalar_end ? 0 : row_idx)",
          "old_text": "CellIsNull(boundary_end_collection, 0, expr_idx)",
          "new_text": "GetCell<int64_t>(boundary_end_collection, 0, bounds.scalar_end ? 0 : row_idx)",
          "old_line_content": "\t\tif (CellIsNull(boundary_end_collection, 0, expr_idx)) {",
          "new_line_content": "\t\t    (int64_t)row_idx - GetCell<int64_t>(boundary_end_collection, 0, bounds.scalar_end ? 0 : row_idx) + 1;",
          "content_same": false
        },
        {
          "line": 838,
          "old_api": "CellIsNull",
          "new_api": "FindOrderedRangeBound<false>(over_collection, order_col, bounds.range_sense, bounds.valid_start,\n\t\t\t                                 row_idx, boundary_end_collection, expr_idx)",
          "old_text": "CellIsNull(boundary_end_collection, 0, expr_idx)",
          "new_text": "FindOrderedRangeBound<false>(over_collection, order_col, bounds.range_sense, bounds.valid_start,\n\t\t\t                                 row_idx, boundary_end_collection, expr_idx)",
          "old_line_content": "\t\tif (CellIsNull(boundary_end_collection, 0, expr_idx)) {",
          "new_line_content": "\t\t\t    FindOrderedRangeBound<false>(over_collection, order_col, bounds.range_sense, bounds.valid_start,",
          "content_same": false
        },
        {
          "line": 889,
          "old_api": "IsScalar",
          "new_api": "size",
          "old_text": "wexpr->offset_expr->IsScalar()",
          "new_text": "exprs.size()",
          "old_line_content": "\t\t\t                      wexpr->offset_expr->IsScalar());",
          "new_line_content": "\tMaterializeExpressions(exprs.data(), exprs.size(), input, payload_collection);",
          "content_same": false
        },
        {
          "line": 925,
          "old_api": "Count",
          "new_api": "Chunks",
          "old_text": "payload_collection.Count()",
          "new_text": "payload_collection.Chunks()",
          "old_line_content": "\t\t\t\t\t\tignore_nulls.Initialize(payload_collection.Count());",
          "new_line_content": "\t\t\tfor (auto &chunk : payload_collection.Chunks()) {",
          "content_same": false
        },
        {
          "line": 929,
          "old_api": "EntryCount",
          "new_api": "AllValid",
          "old_text": "ignore_nulls.EntryCount(pos)",
          "new_text": "vdata.validity.AllValid()",
          "old_line_content": "\t\t\t\t\tauto dst = ignore_nulls.GetData() + ignore_nulls.EntryCount(pos);",
          "new_line_content": "\t\t\t\tif (!vdata.validity.AllValid()) {",
          "content_same": false
        },
        {
          "line": 931,
          "old_api": "EntryCount",
          "new_api": "AllValid",
          "old_text": "vdata.validity.EntryCount(count)",
          "new_text": "ignore_nulls.AllValid()",
          "old_line_content": "\t\t\t\t\tfor (auto entry_count = vdata.validity.EntryCount(count); entry_count-- > 0;) {",
          "new_line_content": "\t\t\t\t\tif (ignore_nulls.AllValid()) {",
          "content_same": false
        },
        {
          "line": 966,
          "old_api": "Count",
          "new_api": "Initialize",
          "old_text": "input.Count()",
          "new_text": "output_chunk.Initialize(output_types)",
          "old_line_content": "\t\t\toutput_chunk.SetCardinality(MinValue(idx_t(STANDARD_VECTOR_SIZE), input.Count() - row_idx));",
          "new_line_content": "\toutput_chunk.Initialize(output_types);",
          "content_same": false
        },
        {
          "line": 971,
          "old_api": "Count",
          "new_api": "Append",
          "old_text": "input.Count()",
          "new_text": "output.Append(output_chunk)",
          "old_line_content": "\t\tUpdateWindowBoundaries(bounds, input.Count(), row_idx, over, boundary_start_collection, boundary_end_collection,",
          "new_line_content": "\t\t\toutput.Append(output_chunk);",
          "content_same": false
        },
        {
          "line": 973,
          "old_api": "WindowNeedsRank",
          "new_api": "Count",
          "old_text": "WindowNeedsRank(wexpr)",
          "new_text": "input.Count()",
          "old_line_content": "\t\tif (WindowNeedsRank(wexpr)) {",
          "new_line_content": "\t\t\toutput_chunk.SetCardinality(MinValue(idx_t(STANDARD_VECTOR_SIZE), input.Count() - row_idx));",
          "content_same": false
        },
        {
          "line": 1015,
          "old_api": "FlatVector::GetData<double>(result)",
          "new_api": "FlatVector::GetData<int64_t>(result)",
          "old_text": "FlatVector::GetData<double>(result)",
          "new_text": "FlatVector::GetData<int64_t>(result)",
          "old_line_content": "\t\t\tauto rdata = FlatVector::GetData<double>(result);",
          "new_line_content": "\t\t\tauto rdata = FlatVector::GetData<int64_t>(result);",
          "content_same": false
        },
        {
          "line": 1085,
          "old_api": "IsScalar",
          "new_api": "FindNextStart",
          "old_text": "wexpr->default_expr->IsScalar()",
          "new_text": "FindNextStart(ignore_nulls, row_idx + 1, bounds.partition_end, delta)",
          "old_line_content": "\t\t\t\tconst auto source_row = wexpr->default_expr->IsScalar() ? 0 : row_idx;",
          "new_line_content": "\t\t\t\tval_idx = FindNextStart(ignore_nulls, row_idx + 1, bounds.partition_end, delta);",
          "content_same": false
        },
        {
          "line": 1095,
          "old_api": "CopyCell",
          "new_api": "FlatVector::SetNull(result, output_offset, true)",
          "old_text": "payload_collection.CopyCell(0, first_idx, result, output_offset)",
          "new_text": "FlatVector::SetNull(result, output_offset, true)",
          "old_line_content": "\t\t\tpayload_collection.CopyCell(0, first_idx, result, output_offset);",
          "new_line_content": "\t\t\t\tFlatVector::SetNull(result, output_offset, true);",
          "content_same": false
        },
        {
          "line": 1115,
          "old_api": "idx_t",
          "new_api": "CellIsNull",
          "old_text": "idx_t(n_param)",
          "new_text": "CellIsNull(payload_collection, 1, row_idx)",
          "old_line_content": "\t\t\t\t\tauto n = idx_t(n_param);",
          "new_line_content": "\t\t\tif (CellIsNull(payload_collection, 1, row_idx)) {",
          "content_same": false
        },
        {
          "line": 1116,
          "old_api": "FindNextStart",
          "new_api": "FlatVector::SetNull(result, output_offset, true)",
          "old_text": "FindNextStart(ignore_nulls, bounds.window_start, bounds.window_end, n)",
          "new_text": "FlatVector::SetNull(result, output_offset, true)",
          "old_line_content": "\t\t\t\t\tconst auto nth_index = FindNextStart(ignore_nulls, bounds.window_start, bounds.window_end, n);",
          "new_line_content": "\t\t\t\tFlatVector::SetNull(result, output_offset, true);",
          "content_same": false
        },
        {
          "line": 1118,
          "old_api": "CopyCell",
          "new_api": "GetCell<int64_t>(payload_collection, 1, row_idx)",
          "old_text": "payload_collection.CopyCell(0, nth_index, result, output_offset)",
          "new_text": "GetCell<int64_t>(payload_collection, 1, row_idx)",
          "old_line_content": "\t\t\t\t\t\tpayload_collection.CopyCell(0, nth_index, result, output_offset);",
          "new_line_content": "\t\t\t\tauto n_param = GetCell<int64_t>(payload_collection, 1, row_idx);",
          "content_same": false
        },
        {
          "line": 1127,
          "old_api": "ExpressionTypeToString",
          "new_api": "FlatVector::SetNull(result, output_offset, true)",
          "old_text": "ExpressionTypeToString(wexpr->type)",
          "new_text": "FlatVector::SetNull(result, output_offset, true)",
          "old_line_content": "\t\t\tthrow InternalException(\"Window aggregate type %s\", ExpressionTypeToString(wexpr->type));",
          "new_line_content": "\t\t\t\t\t\tFlatVector::SetNull(result, output_offset, true);",
          "content_same": false
        },
        {
          "line": 1159,
          "old_api": "Count",
          "new_api": "size",
          "old_text": "input.Count()",
          "new_text": "over_expr->partitions.size()",
          "old_line_content": "\tValidityMask order_mask(partition_mask, input.Count());",
          "new_line_content": "\tfor (idx_t c = 0; c < over_expr->partitions.size(); ++c) {",
          "content_same": false
        },
        {
          "line": 1160,
          "old_api": "size",
          "new_api": "MaskColumn",
          "old_text": "over_expr->partitions.size()",
          "new_text": "MaskColumn(partition_mask, over, c)",
          "old_line_content": "\tfor (idx_t c = over_expr->partitions.size(); c < sort_col_count; ++c) {",
          "new_line_content": "\t\tMaskColumn(partition_mask, over, c);",
          "content_same": false
        },
        {
          "line": 1167,
          "old_api": "ComputeWindowExpression",
          "new_api": "size",
          "old_text": "ComputeWindowExpression(window_exprs[expr_idx], input, output, over, partition_mask, order_mask, mode)",
          "new_text": "over_expr->partitions.size()",
          "old_line_content": "\t\tComputeWindowExpression(window_exprs[expr_idx], input, output, over, partition_mask, order_mask, mode);",
          "new_line_content": "\tfor (idx_t c = over_expr->partitions.size(); c < sort_col_count; ++c) {",
          "content_same": false
        },
        {
          "line": 1168,
          "old_api": "Fuse",
          "new_api": "MaskColumn",
          "old_text": "window_results.Fuse(output)",
          "new_text": "MaskColumn(order_mask, over, c)",
          "old_line_content": "\t\twindow_results.Fuse(output);",
          "new_line_content": "\t\tMaskColumn(order_mask, over, c);",
          "content_same": false
        },
        {
          "line": 1185,
          "old_api": "Reset",
          "new_api": "size",
          "old_text": "state.chunks.Reset()",
          "new_text": "op.select_list.size()",
          "old_line_content": "\tstate.chunks.Reset();",
          "new_line_content": "\tfor (idx_t expr_idx = 0; expr_idx < op.select_list.size(); ++expr_idx) {",
          "content_same": false
        },
        {
          "line": 1186,
          "old_api": "Reset",
          "new_api": "GetExpressionClass",
          "old_text": "state.window_results.Reset()",
          "new_text": "op.select_list[expr_idx]->GetExpressionClass()",
          "old_line_content": "\tstate.window_results.Reset();",
          "new_line_content": "\t\tD_ASSERT(op.select_list[expr_idx]->GetExpressionClass() == ExpressionClass::BOUND_WINDOW);",
          "content_same": false
        },
        {
          "line": 1205,
          "old_api": "size",
          "new_api": "Types",
          "old_text": "over_expr->orders.size()",
          "new_text": "gstate.over_collection.Types()",
          "old_line_content": "\t\tconst auto has_sorting = over_expr->partitions.size() + over_expr->orders.size();",
          "new_line_content": "\tconst auto over_types = gstate.over_collection.Types();",
          "content_same": false
        },
        {
          "line": 1215,
          "old_api": "Merge",
          "new_api": "SortCollectionForPartition",
          "old_text": "state.chunks.Merge(input)",
          "new_text": "SortCollectionForPartition(state, over_expr, input, over, nullptr, 0, 0)",
          "old_line_content": "\t\tstate.chunks.Merge(input);",
          "new_line_content": "\t\t\tSortCollectionForPartition(state, over_expr, input, over, nullptr, 0, 0);",
          "content_same": false
        },
        {
          "line": 1218,
          "old_api": "size",
          "new_api": "ScanSortedPartition",
          "old_text": "gstate.counts.size()",
          "new_text": "ScanSortedPartition(state, input, input_types, over, over_types)",
          "old_line_content": "\t} else if (hash_bin < gstate.counts.size() && gstate.counts[hash_bin] > 0) {",
          "new_line_content": "\t\t\tScanSortedPartition(state, input, input_types, over, over_types);",
          "content_same": false
        },
        {
          "line": 1221,
          "old_api": "SortCollectionForPartition",
          "new_api": "ComputeWindowExpressions",
          "old_text": "SortCollectionForPartition(state, over_expr, gstate.chunks, gstate.over_collection, &gstate.hash_collection,\n\t\t                           hash_bin, hash_mask)",
          "new_text": "ComputeWindowExpressions(window_exprs, input, output, over, gstate.mode)",
          "old_line_content": "\t\tSortCollectionForPartition(state, over_expr, gstate.chunks, gstate.over_collection, &gstate.hash_collection,",
          "new_line_content": "\t\tComputeWindowExpressions(window_exprs, input, output, over, gstate.mode);",
          "content_same": false
        },
        {
          "line": 1228,
          "old_api": "ScanSortedPartition",
          "new_api": "SortCollectionForPartition",
          "old_text": "ScanSortedPartition(state, input, input_types, over, over_types)",
          "new_text": "SortCollectionForPartition(state, over_expr, gstate.chunks, gstate.over_collection, &gstate.hash_collection,\n\t\t                           hash_bin, hash_mask)",
          "old_line_content": "\t\tScanSortedPartition(state, input, input_types, over, over_types);",
          "new_line_content": "\t\tSortCollectionForPartition(state, over_expr, gstate.chunks, gstate.over_collection, &gstate.hash_collection,",
          "content_same": false
        },
        {
          "line": 1252,
          "old_api": "Reference",
          "new_api": "GetChunkForRow",
          "old_text": "chunk.data[out_idx++].Reference(proj_ch.data[col_idx])",
          "new_text": "big_data.GetChunkForRow(state.position)",
          "old_line_content": "\t\tchunk.data[out_idx++].Reference(proj_ch.data[col_idx]);",
          "new_line_content": "\tauto &proj_ch = big_data.GetChunkForRow(state.position);",
          "content_same": false
        },
        {
          "line": 1257,
          "old_api": "Verify",
          "new_api": "SetCardinality",
          "old_text": "chunk.Verify()",
          "new_text": "chunk.SetCardinality(proj_ch)",
          "old_line_content": "\tchunk.Verify();",
          "new_line_content": "\tchunk.SetCardinality(proj_ch);",
          "content_same": false
        },
        {
          "line": 1276,
          "old_api": "empty",
          "new_api": "get",
          "old_text": "over_expr->partitions.empty()",
          "new_text": "select_list[over_idx].get()",
          "old_line_content": "\t\tif (!over_expr->partitions.empty()) {",
          "new_line_content": "\tauto over_expr = reinterpret_cast<BoundWindowExpression *>(select_list[over_idx].get());",
          "content_same": false
        },
        {
          "line": 1278,
          "old_api": "resize",
          "new_api": "size",
          "old_text": "lstate.counts.resize(lstate.partition_count, 0)",
          "new_text": "over_expr->orders.size()",
          "old_line_content": "\t\t\t\tlstate.counts.resize(lstate.partition_count, 0);",
          "new_line_content": "\tconst auto sort_col_count = over_expr->partitions.size() + over_expr->orders.size();",
          "content_same": false
        },
        {
          "line": 1283,
          "old_api": "Append",
          "new_api": "empty",
          "old_text": "lstate.hash_collection.Append(hash_chunk)",
          "new_text": "over_expr->partitions.empty()",
          "old_line_content": "\t\t\tlstate.hash_collection.Append(hash_chunk);",
          "new_line_content": "\t\tif (!over_expr->partitions.empty()) {",
          "content_same": false
        },
        {
          "line": 1284,
          "old_api": "Count",
          "new_api": "empty",
          "old_text": "lstate.hash_collection.Count()",
          "new_text": "lstate.counts.empty()",
          "old_line_content": "\t\t\tD_ASSERT(lstate.chunks.Count() == lstate.hash_collection.Count());",
          "new_line_content": "\t\t\tif (lstate.counts.empty()) {",
          "content_same": false
        },
        {
          "line": 1302,
          "old_api": "Merge",
          "new_api": "Count",
          "old_text": "gstate.hash_collection.Merge(lstate.hash_collection)",
          "new_text": "lstate.chunks.Count()",
          "old_line_content": "\tgstate.hash_collection.Merge(lstate.hash_collection);",
          "new_line_content": "\tif (lstate.chunks.Count() == 0) {",
          "content_same": false
        },
        {
          "line": 1307,
          "old_api": "size",
          "new_api": "Merge",
          "old_text": "gstate.counts.size()",
          "new_text": "gstate.chunks.Merge(lstate.chunks)",
          "old_line_content": "\t\tfor (idx_t i = 0; i < gstate.counts.size(); ++i) {",
          "new_line_content": "\tgstate.chunks.Merge(lstate.chunks);",
          "content_same": false
        },
        {
          "line": 1314,
          "old_api": "make_unique<WindowLocalState>(*this)",
          "new_api": "size",
          "old_text": "make_unique<WindowLocalState>(*this)",
          "new_text": "gstate.counts.size()",
          "old_line_content": "\treturn make_unique<WindowLocalState>(*this);",
          "new_line_content": "\t\tfor (idx_t i = 0; i < gstate.counts.size(); ++i) {",
          "content_same": false
        },
        {
          "line": 1376,
          "old_api": "GeneratePartition",
          "new_api": "Count",
          "old_text": "GeneratePartition(state, gstate, hash_bin)",
          "new_text": "state.chunks.Count()",
          "old_line_content": "\t\t\tGeneratePartition(state, gstate, hash_bin);",
          "new_line_content": "\t\tif (state.position >= state.chunks.Count()) {",
          "content_same": false
        },
        {
          "line": 1385,
          "old_api": "size",
          "new_api": "Scan",
          "old_text": "chunk.size()",
          "new_text": "Scan(state, chunk)",
          "old_line_content": "\tD_ASSERT(chunk.size() == 0);",
          "new_line_content": "\t\tScan(state, chunk);",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1029,
          "old_api": null,
          "new_api": "FlatVector::GetData<double>(result)",
          "old_text": null,
          "new_text": "FlatVector::GetData<double>(result)",
          "old_line_content": "\t\t\t// With thanks from SQLite's ntileValueFunc()",
          "new_line_content": "\t\t\tauto rdata = FlatVector::GetData<double>(result);",
          "content_same": false
        },
        {
          "line": 522,
          "old_api": null,
          "new_api": "explicit",
          "old_text": null,
          "new_text": "explicit",
          "old_line_content": "\t      has_following_range(wexpr->start == WindowBoundary::EXPR_FOLLOWING_RANGE ||",
          "new_line_content": "\texplicit WindowBoundariesState(BoundWindowExpression *wexpr)",
          "content_same": false
        },
        {
          "line": 1034,
          "old_api": null,
          "new_api": "ColumnCount",
          "old_text": null,
          "new_text": "payload_collection.ColumnCount()",
          "old_line_content": "\t\t\t\tn_param = n_total;",
          "new_line_content": "\t\t\tD_ASSERT(payload_collection.ColumnCount() == 1);",
          "content_same": false
        },
        {
          "line": 1035,
          "old_api": null,
          "new_api": "GetCell<int64_t>(payload_collection, 0, row_idx)",
          "old_text": null,
          "new_text": "GetCell<int64_t>(payload_collection, 0, row_idx)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\tauto n_param = GetCell<int64_t>(payload_collection, 0, row_idx);",
          "content_same": false
        },
        {
          "line": 525,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "wexpr->orders.empty()",
          "old_line_content": "\t}",
          "new_line_content": "\t      range_sense(wexpr->orders.empty() ? OrderType::INVALID : wexpr->orders[0].type),",
          "content_same": false
        },
        {
          "line": 526,
          "old_api": null,
          "new_api": "IsScalar",
          "old_text": null,
          "new_text": "IsScalar(wexpr->end_expr)",
          "old_line_content": "",
          "new_line_content": "\t      scalar_start(IsScalar(wexpr->start_expr)), scalar_end(IsScalar(wexpr->end_expr)),",
          "content_same": false
        },
        {
          "line": 531,
          "old_api": null,
          "new_api": "BoundaryNeedsPeer",
          "old_text": null,
          "new_text": "BoundaryNeedsPeer(wexpr->end)",
          "old_line_content": "\tconst idx_t partition_count;",
          "new_line_content": "\t      needs_peer(BoundaryNeedsPeer(wexpr->end) || wexpr->type == ExpressionType::WINDOW_CUME_DIST) {",
          "content_same": false
        },
        {
          "line": 1052,
          "old_api": null,
          "new_api": "D_ASSERT",
          "old_text": null,
          "new_text": "D_ASSERT((n_large * (n_size + 1) + (n_param - n_large) * n_size) == n_total)",
          "old_line_content": "\t\t\t// result has to be between [1, NTILE]",
          "new_line_content": "\t\t\tD_ASSERT((n_large * (n_size + 1) + (n_param - n_large) * n_size) == n_total);",
          "content_same": false
        },
        {
          "line": 1060,
          "old_api": null,
          "new_api": "D_ASSERT",
          "old_text": null,
          "new_text": "D_ASSERT(result_ntile >= 1 && result_ntile <= n_param)",
          "old_line_content": "\t\t\tint64_t offset = 1;",
          "new_line_content": "\t\t\tD_ASSERT(result_ntile >= 1 && result_ntile <= n_param);",
          "content_same": false
        },
        {
          "line": 1061,
          "old_api": null,
          "new_api": "FlatVector::GetData<int64_t>(result)",
          "old_text": null,
          "new_text": "FlatVector::GetData<int64_t>(result)",
          "old_line_content": "\t\t\tif (wexpr->offset_expr) {",
          "new_line_content": "\t\t\tauto rdata = FlatVector::GetData<int64_t>(result);",
          "content_same": false
        },
        {
          "line": 1069,
          "old_api": null,
          "new_api": "IsScalar",
          "old_text": null,
          "new_text": "wexpr->offset_expr->IsScalar()",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\toffset = GetCell<int64_t>(leadlag_offset_collection, 0, wexpr->offset_expr->IsScalar() ? 0 : row_idx);",
          "content_same": false
        },
        {
          "line": 566,
          "old_api": null,
          "new_api": "ColumnCount",
          "old_text": null,
          "new_text": "collection.ColumnCount()",
          "old_line_content": "",
          "new_line_content": "\tD_ASSERT(collection.ColumnCount() > column);",
          "content_same": false
        },
        {
          "line": 567,
          "old_api": null,
          "new_api": "GetChunkForRow",
          "old_text": null,
          "new_text": "collection.GetChunkForRow(index)",
          "old_line_content": "static bool CellIsNull(ChunkCollection &collection, idx_t column, idx_t index) {",
          "new_line_content": "\tauto &chunk = collection.GetChunkForRow(index);",
          "content_same": false
        },
        {
          "line": 1081,
          "old_api": null,
          "new_api": "idx_t",
          "old_text": null,
          "new_text": "idx_t(row_idx - val_idx)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tdelta = idx_t(row_idx - val_idx);",
          "content_same": false
        },
        {
          "line": 570,
          "old_api": null,
          "new_api": "FlatVector::GetData<T>(source)",
          "old_text": null,
          "new_text": "FlatVector::GetData<T>(source)",
          "old_line_content": "\tauto &source = chunk.data[column];",
          "new_line_content": "\tconst auto data = FlatVector::GetData<T>(source);",
          "content_same": false
        },
        {
          "line": 1082,
          "old_api": null,
          "new_api": "FindPrevStart",
          "old_text": null,
          "new_text": "FindPrevStart(ignore_nulls, bounds.partition_start, row_idx, delta)",
          "old_line_content": "\t\t\tif (!delta) {",
          "new_line_content": "\t\t\t\tval_idx = FindPrevStart(ignore_nulls, bounds.partition_start, row_idx, delta);",
          "content_same": false
        },
        {
          "line": 1084,
          "old_api": null,
          "new_api": "idx_t",
          "old_text": null,
          "new_text": "idx_t(val_idx - row_idx)",
          "old_line_content": "\t\t\t} else if (wexpr->default_expr) {",
          "new_line_content": "\t\t\t\tdelta = idx_t(val_idx - row_idx);",
          "content_same": false
        },
        {
          "line": 575,
          "old_api": null,
          "new_api": "ColumnCount",
          "old_text": null,
          "new_text": "collection.ColumnCount()",
          "old_line_content": "template <typename T>",
          "new_line_content": "\tD_ASSERT(collection.ColumnCount() > column);",
          "content_same": false
        },
        {
          "line": 576,
          "old_api": null,
          "new_api": "GetChunkForRow",
          "old_text": null,
          "new_text": "collection.GetChunkForRow(index)",
          "old_line_content": "struct ChunkCollectionIterator {",
          "new_line_content": "\tauto &chunk = collection.GetChunkForRow(index);",
          "content_same": false
        },
        {
          "line": 1090,
          "old_api": null,
          "new_api": "CopyCell",
          "old_text": null,
          "new_text": "payload_collection.CopyCell(0, val_idx, result, output_offset)",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\t\t\tpayload_collection.CopyCell(0, val_idx, result, output_offset);",
          "content_same": false
        },
        {
          "line": 579,
          "old_api": null,
          "new_api": "FlatVector::IsNull(source, source_offset)",
          "old_text": null,
          "new_text": "FlatVector::IsNull(source, source_offset)",
          "old_line_content": "\tusing difference_type = std::ptrdiff_t;",
          "new_line_content": "\treturn FlatVector::IsNull(source, source_offset);",
          "content_same": false
        },
        {
          "line": 1092,
          "old_api": null,
          "new_api": "IsScalar",
          "old_text": null,
          "new_text": "wexpr->default_expr->IsScalar()",
          "old_line_content": "\t\tcase ExpressionType::WINDOW_FIRST_VALUE: {",
          "new_line_content": "\t\t\t\tconst auto source_row = wexpr->default_expr->IsScalar() ? 0 : row_idx;",
          "content_same": false
        },
        {
          "line": 1093,
          "old_api": null,
          "new_api": "CopyCell",
          "old_text": null,
          "new_text": "leadlag_default_collection.CopyCell(0, source_row, result, output_offset)",
          "old_line_content": "\t\t\tidx_t n = 1;",
          "new_line_content": "\t\t\t\tleadlag_default_collection.CopyCell(0, source_row, result, output_offset);",
          "content_same": false
        },
        {
          "line": 1101,
          "old_api": null,
          "new_api": "FindNextStart",
          "old_text": null,
          "new_text": "FindNextStart(ignore_nulls, bounds.window_start, bounds.window_end, n)",
          "old_line_content": "\t\t\t                            result, output_offset);",
          "new_line_content": "\t\t\tconst auto first_idx = FindNextStart(ignore_nulls, bounds.window_start, bounds.window_end, n);",
          "content_same": false
        },
        {
          "line": 1102,
          "old_api": null,
          "new_api": "CopyCell",
          "old_text": null,
          "new_text": "payload_collection.CopyCell(0, first_idx, result, output_offset)",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\t\tpayload_collection.CopyCell(0, first_idx, result, output_offset);",
          "content_same": false
        },
        {
          "line": 1107,
          "old_api": null,
          "new_api": "FindPrevStart",
          "old_text": null,
          "new_text": "FindPrevStart(ignore_nulls, bounds.window_start, bounds.window_end, n)",
          "old_line_content": "\t\t\t// returns NULL if there is no such row.",
          "new_line_content": "\t\t\tpayload_collection.CopyCell(0, FindPrevStart(ignore_nulls, bounds.window_start, bounds.window_end, n),",
          "content_same": false
        },
        {
          "line": 596,
          "old_api": null,
          "new_api": "GetCell<T>(*coll, col_no, pos)",
          "old_text": null,
          "new_text": "GetCell<T>(*coll, col_no, pos)",
          "old_line_content": "\t\t++pos;",
          "new_line_content": "\t\treturn GetCell<T>(*coll, col_no, pos);",
          "content_same": false
        },
        {
          "line": 598,
          "old_api": null,
          "new_api": "explicit",
          "old_text": null,
          "new_text": "explicit",
          "old_line_content": "\t}",
          "new_line_content": "\tinline explicit operator pointer() const {",
          "content_same": false
        },
        {
          "line": 1112,
          "old_api": null,
          "new_api": "ColumnCount",
          "old_text": null,
          "new_text": "payload_collection.ColumnCount()",
          "old_line_content": "\t\t\t\tif (n_param < 1) {",
          "new_line_content": "\t\t\tD_ASSERT(payload_collection.ColumnCount() == 2);",
          "content_same": false
        },
        {
          "line": 1122,
          "old_api": null,
          "new_api": "idx_t",
          "old_text": null,
          "new_text": "idx_t(n_param)",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\t\t\tauto n = idx_t(n_param);",
          "content_same": false
        },
        {
          "line": 1123,
          "old_api": null,
          "new_api": "FindNextStart",
          "old_text": null,
          "new_text": "FindNextStart(ignore_nulls, bounds.window_start, bounds.window_end, n)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\t\tconst auto nth_index = FindNextStart(ignore_nulls, bounds.window_start, bounds.window_end, n);",
          "content_same": false
        },
        {
          "line": 1125,
          "old_api": null,
          "new_api": "CopyCell",
          "old_text": null,
          "new_text": "payload_collection.CopyCell(0, nth_index, result, output_offset)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\t\t\tpayload_collection.CopyCell(0, nth_index, result, output_offset);",
          "content_same": false
        },
        {
          "line": 1134,
          "old_api": null,
          "new_api": "ExpressionTypeToString",
          "old_text": null,
          "new_text": "ExpressionTypeToString(wexpr->type)",
          "old_line_content": "",
          "new_line_content": "\t\t\tthrow InternalException(\"Window aggregate type %s\", ExpressionTypeToString(wexpr->type));",
          "content_same": false
        },
        {
          "line": 1139,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": "output.Append(output_chunk)",
          "old_line_content": "                                     WindowAggregationMode mode) {",
          "new_line_content": "\toutput.Append(output_chunk);",
          "content_same": false
        },
        {
          "line": 636,
          "old_api": null,
          "new_api": "GetCell<T>(boundary, 0, boundary_row)",
          "old_text": null,
          "new_text": "GetCell<T>(boundary, 0, boundary_row)",
          "old_line_content": "\t} else {",
          "new_line_content": "\tconst auto val = GetCell<T>(boundary, 0, boundary_row);",
          "content_same": false
        },
        {
          "line": 642,
          "old_api": null,
          "new_api": "std::lower_bound(begin, end, val, comp)",
          "old_text": null,
          "new_text": "std::lower_bound(begin, end, val, comp)",
          "old_line_content": "static idx_t FindRangeBound(ChunkCollection &over, const idx_t order_col, const idx_t order_begin,",
          "new_line_content": "\t\treturn idx_t(std::lower_bound(begin, end, val, comp));",
          "content_same": false
        },
        {
          "line": 1155,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "input.Count()",
          "old_line_content": "",
          "new_line_content": "\tvector<validity_t> partition_bits(ValidityMask::EntryCount(input.Count()), 0);",
          "content_same": false
        },
        {
          "line": 1156,
          "old_api": null,
          "new_api": "data",
          "old_text": null,
          "new_text": "partition_bits.data()",
          "old_line_content": "\t//\tSet bits for the start of each peer group.",
          "new_line_content": "\tValidityMask partition_mask(partition_bits.data());",
          "content_same": false
        },
        {
          "line": 1157,
          "old_api": null,
          "new_api": "SetValid",
          "old_text": null,
          "new_text": "partition_mask.SetValid(0)",
          "old_line_content": "\t//\tPartitions also break peer groups, so start with the partition bits.",
          "new_line_content": "\tpartition_mask.SetValid(0);",
          "content_same": false
        },
        {
          "line": 652,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "over_types.size()",
          "old_line_content": "\tcase PhysicalType::INT16:",
          "new_line_content": "\tD_ASSERT(over_types.size() > order_col);",
          "content_same": false
        },
        {
          "line": 654,
          "old_api": null,
          "new_api": "Types",
          "old_text": null,
          "new_text": "boundary.Types()",
          "old_line_content": "\tcase PhysicalType::INT32:",
          "new_line_content": "\tD_ASSERT(boundary.Types()[0] == over_types[order_col]);",
          "content_same": false
        },
        {
          "line": 1166,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "input.Count()",
          "old_line_content": "\t\tChunkCollection output;",
          "new_line_content": "\tValidityMask order_mask(partition_mask, input.Count());",
          "content_same": false
        },
        {
          "line": 656,
          "old_api": null,
          "new_api": "InternalType",
          "old_text": null,
          "new_text": "over_types[order_col].InternalType()",
          "old_line_content": "\tcase PhysicalType::INT64:",
          "new_line_content": "\tswitch (over_types[order_col].InternalType()) {",
          "content_same": false
        },
        {
          "line": 658,
          "old_api": null,
          "new_api": "FindTypedRangeBound<int8_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindTypedRangeBound<int8_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "\tcase PhysicalType::UINT8:",
          "new_line_content": "\t\treturn FindTypedRangeBound<int8_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 660,
          "old_api": null,
          "new_api": "FindTypedRangeBound<int16_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindTypedRangeBound<int16_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "\tcase PhysicalType::UINT16:",
          "new_line_content": "\t\treturn FindTypedRangeBound<int16_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 1172,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "window_exprs.size()",
          "old_line_content": "//===--------------------------------------------------------------------===//",
          "new_line_content": "\tfor (idx_t expr_idx = 0; expr_idx < window_exprs.size(); ++expr_idx) {",
          "content_same": false
        },
        {
          "line": 662,
          "old_api": null,
          "new_api": "FindTypedRangeBound<int32_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindTypedRangeBound<int32_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "\tcase PhysicalType::UINT32:",
          "new_line_content": "\t\treturn FindTypedRangeBound<int32_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 1174,
          "old_api": null,
          "new_api": "ComputeWindowExpression",
          "old_text": null,
          "new_text": "ComputeWindowExpression(window_exprs[expr_idx], input, output, over, partition_mask, order_mask, mode)",
          "old_line_content": "//===--------------------------------------------------------------------===//",
          "new_line_content": "\t\tComputeWindowExpression(window_exprs[expr_idx], input, output, over, partition_mask, order_mask, mode);",
          "content_same": false
        },
        {
          "line": 664,
          "old_api": null,
          "new_api": "FindTypedRangeBound<int64_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindTypedRangeBound<int64_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "\tcase PhysicalType::UINT64:",
          "new_line_content": "\t\treturn FindTypedRangeBound<int64_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 1175,
          "old_api": null,
          "new_api": "Fuse",
          "old_text": null,
          "new_text": "window_results.Fuse(output)",
          "old_line_content": "static void GeneratePartition(WindowOperatorState &state, WindowGlobalState &gstate, const idx_t hash_bin) {",
          "new_line_content": "\t\twindow_results.Fuse(output);",
          "content_same": false
        },
        {
          "line": 666,
          "old_api": null,
          "new_api": "FindTypedRangeBound<uint8_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindTypedRangeBound<uint8_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "\tcase PhysicalType::INT128:",
          "new_line_content": "\t\treturn FindTypedRangeBound<uint8_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 668,
          "old_api": null,
          "new_api": "FindTypedRangeBound<uint16_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindTypedRangeBound<uint16_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "\tcase PhysicalType::FLOAT:",
          "new_line_content": "\t\treturn FindTypedRangeBound<uint16_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 670,
          "old_api": null,
          "new_api": "FindTypedRangeBound<uint32_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindTypedRangeBound<uint32_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "\tcase PhysicalType::DOUBLE:",
          "new_line_content": "\t\treturn FindTypedRangeBound<uint32_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 672,
          "old_api": null,
          "new_api": "FindTypedRangeBound<uint64_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindTypedRangeBound<uint64_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "\tcase PhysicalType::INTERVAL:",
          "new_line_content": "\t\treturn FindTypedRangeBound<uint64_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 674,
          "old_api": null,
          "new_api": "FindTypedRangeBound<hugeint_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindTypedRangeBound<hugeint_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "\tdefault:",
          "new_line_content": "\t\treturn FindTypedRangeBound<hugeint_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 1187,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "op.select_list[expr_idx].get()",
          "old_line_content": "\tstate.position = 0;",
          "new_line_content": "\t\tauto wexpr = reinterpret_cast<BoundWindowExpression *>(op.select_list[expr_idx].get());",
          "content_same": false
        },
        {
          "line": 676,
          "old_api": null,
          "new_api": "FindTypedRangeBound<float, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindTypedRangeBound<float, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "\t}",
          "new_line_content": "\t\treturn FindTypedRangeBound<float, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 1188,
          "old_api": null,
          "new_api": "emplace_back",
          "old_text": null,
          "new_text": "window_exprs.emplace_back(wexpr)",
          "old_line_content": "\tstate.global_sort_state = nullptr;",
          "new_line_content": "\t\twindow_exprs.emplace_back(wexpr);",
          "content_same": false
        },
        {
          "line": 678,
          "old_api": null,
          "new_api": "FindTypedRangeBound<double, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindTypedRangeBound<double, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "",
          "new_line_content": "\t\treturn FindTypedRangeBound<double, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 680,
          "old_api": null,
          "new_api": "FindTypedRangeBound<interval_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindTypedRangeBound<interval_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "static idx_t FindOrderedRangeBound(ChunkCollection &over, const idx_t order_col, const OrderType range_sense,",
          "new_line_content": "\t\treturn FindTypedRangeBound<interval_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 1192,
          "old_api": null,
          "new_api": "Reset",
          "old_text": null,
          "new_text": "state.chunks.Reset()",
          "old_line_content": "",
          "new_line_content": "\tstate.chunks.Reset();",
          "content_same": false
        },
        {
          "line": 682,
          "old_api": null,
          "new_api": "InternalException",
          "old_text": null,
          "new_text": "InternalException(\"Unsupported column type for RANGE\")",
          "old_line_content": "                                   const idx_t expr_idx) {",
          "new_line_content": "\t\tthrow InternalException(\"Unsupported column type for RANGE\");",
          "content_same": false
        },
        {
          "line": 1193,
          "old_api": null,
          "new_api": "Reset",
          "old_text": null,
          "new_text": "state.window_results.Reset()",
          "old_line_content": "\t// There are three types of partitions:",
          "new_line_content": "\tstate.window_results.Reset();",
          "content_same": false
        },
        {
          "line": 692,
          "old_api": null,
          "new_api": "FindRangeBound<LessThan, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindRangeBound<LessThan, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "",
          "new_line_content": "\t\treturn FindRangeBound<LessThan, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 1204,
          "old_api": null,
          "new_api": "Types",
          "old_text": null,
          "new_text": "gstate.chunks.Types()",
          "old_line_content": "",
          "new_line_content": "\tconst auto input_types = gstate.chunks.Types();",
          "content_same": false
        },
        {
          "line": 694,
          "old_api": null,
          "new_api": "FindRangeBound<GreaterThan, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_text": null,
          "new_text": "FindRangeBound<GreaterThan, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "old_line_content": "                                   ChunkCollection &over_collection, ChunkCollection &boundary_start_collection,",
          "new_line_content": "\t\treturn FindRangeBound<GreaterThan, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "content_same": false
        },
        {
          "line": 1207,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "gstate.counts.empty()",
          "old_line_content": "\t\t\t// 2. One partition",
          "new_line_content": "\tif (gstate.counts.empty() && hash_bin == 0) {",
          "content_same": false
        },
        {
          "line": 696,
          "old_api": null,
          "new_api": "InternalException",
          "old_text": null,
          "new_text": "InternalException(\"Unsupported ORDER BY sense for RANGE\")",
          "old_line_content": "                                   const ValidityMask &order_mask) {",
          "new_line_content": "\t\tthrow InternalException(\"Unsupported ORDER BY sense for RANGE\");",
          "content_same": false
        },
        {
          "line": 1212,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "over_expr->orders.size()",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\tconst auto has_sorting = over_expr->partitions.size() + over_expr->orders.size();",
          "content_same": false
        },
        {
          "line": 1213,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "input.Count()",
          "old_line_content": "",
          "new_line_content": "\t\tif (has_sorting && input.Count() > 0) {",
          "content_same": false
        },
        {
          "line": 1222,
          "old_api": null,
          "new_api": "Merge",
          "old_text": null,
          "new_text": "state.chunks.Merge(input)",
          "old_line_content": "\t\t                           hash_bin, hash_mask);",
          "new_line_content": "\t\tstate.chunks.Merge(input);",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": null,
          "new_api": "RowIsValidUnsafe",
          "old_text": null,
          "new_text": "partition_mask.RowIsValidUnsafe(row_idx)",
          "old_line_content": "",
          "new_line_content": "\t\tbounds.is_same_partition = !partition_mask.RowIsValidUnsafe(row_idx);",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": null,
          "new_api": "RowIsValidUnsafe",
          "old_text": null,
          "new_text": "order_mask.RowIsValidUnsafe(row_idx)",
          "old_line_content": "\t\t\t// find end of partition",
          "new_line_content": "\t\tbounds.is_peer = !order_mask.RowIsValidUnsafe(row_idx);",
          "content_same": false
        },
        {
          "line": 1223,
          "old_api": null,
          "new_api": "Merge",
          "old_text": null,
          "new_text": "state.window_results.Merge(output)",
          "old_line_content": "",
          "new_line_content": "\t\tstate.window_results.Merge(output);",
          "content_same": false
        },
        {
          "line": 1225,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "gstate.counts.size()",
          "old_line_content": "\t\tChunkCollection input;",
          "new_line_content": "\t} else if (hash_bin < gstate.counts.size() && gstate.counts[hash_bin] > 0) {",
          "content_same": false
        },
        {
          "line": 1227,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "gstate.counts.size()",
          "old_line_content": "\t\tChunkCollection over;",
          "new_line_content": "\t\tconst auto hash_mask = hash_t(gstate.counts.size() - 1);",
          "content_same": false
        },
        {
          "line": 723,
          "old_api": null,
          "new_api": "FindNextStart",
          "old_text": null,
          "new_text": "FindNextStart(partition_mask, bounds.partition_start + 1, input_size, n)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tbounds.partition_end = FindNextStart(partition_mask, bounds.partition_start + 1, input_size, n);",
          "content_same": false
        },
        {
          "line": 1235,
          "old_api": null,
          "new_api": "ScanSortedPartition",
          "old_text": null,
          "new_text": "ScanSortedPartition(state, input, input_types, over, over_types)",
          "old_line_content": "",
          "new_line_content": "\t\tScanSortedPartition(state, input, input_types, over, over_types);",
          "content_same": false
        },
        {
          "line": 1237,
          "old_api": null,
          "new_api": "ComputeWindowExpressions",
          "old_text": null,
          "new_text": "ComputeWindowExpressions(window_exprs, input, output, over, gstate.mode)",
          "old_line_content": "\tChunkCollection &big_data = state.chunks;",
          "new_line_content": "\t\tComputeWindowExpressions(window_exprs, input, output, over, gstate.mode);",
          "content_same": false
        },
        {
          "line": 1238,
          "old_api": null,
          "new_api": "Merge",
          "old_text": null,
          "new_text": "state.chunks.Merge(input)",
          "old_line_content": "\tChunkCollection &window_results = state.window_results;",
          "new_line_content": "\t\tstate.chunks.Merge(input);",
          "content_same": false
        },
        {
          "line": 1239,
          "old_api": null,
          "new_api": "Merge",
          "old_text": null,
          "new_text": "state.window_results.Merge(output)",
          "old_line_content": "",
          "new_line_content": "\t\tstate.window_results.Merge(output);",
          "content_same": false
        },
        {
          "line": 733,
          "old_api": null,
          "new_api": "CellIsNull",
          "old_text": null,
          "new_text": "CellIsNull(over_collection, order_col, bounds.valid_start)",
          "old_line_content": "\t\t\t\t// Exclude any trailing NULLs",
          "new_line_content": "\t\t\t\tif (CellIsNull(over_collection, order_col, bounds.valid_start)) {",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": null,
          "new_api": "FindNextStart",
          "old_text": null,
          "new_text": "FindNextStart(order_mask, bounds.valid_start + 1, bounds.valid_end, n)",
          "old_line_content": "\t\t\t\t\tidx_t n = 1;",
          "new_line_content": "\t\t\t\t\tbounds.valid_start = FindNextStart(order_mask, bounds.valid_start + 1, bounds.valid_end, n);",
          "content_same": false
        },
        {
          "line": 1247,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "big_data.Count()",
          "old_line_content": "",
          "new_line_content": "\tif (state.position >= big_data.Count()) {",
          "content_same": false
        },
        {
          "line": 741,
          "old_api": null,
          "new_api": "CellIsNull",
          "old_text": null,
          "new_text": "CellIsNull(over_collection, order_col, bounds.valid_end - 1)",
          "old_line_content": "\t\t\tbounds.peer_start = row_idx;",
          "new_line_content": "\t\t\t\tif (CellIsNull(over_collection, order_col, bounds.valid_end - 1)) {",
          "content_same": false
        },
        {
          "line": 1253,
          "old_api": null,
          "new_api": "GetChunkForRow",
          "old_text": null,
          "new_text": "window_results.GetChunkForRow(state.position)",
          "old_line_content": "\t}",
          "new_line_content": "\tauto &wind_ch = window_results.GetChunkForRow(state.position);",
          "content_same": false
        },
        {
          "line": 743,
          "old_api": null,
          "new_api": "FindPrevStart",
          "old_text": null,
          "new_text": "FindPrevStart(order_mask, bounds.valid_start, bounds.valid_end, n)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\t\tbounds.valid_end = FindPrevStart(order_mask, bounds.valid_start, bounds.valid_end, n);",
          "content_same": false
        },
        {
          "line": 1256,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "wind_ch.size()",
          "old_line_content": "\t}",
          "new_line_content": "\tD_ASSERT(proj_ch.size() == wind_ch.size());",
          "content_same": false
        },
        {
          "line": 1258,
          "old_api": null,
          "new_api": "ColumnCount",
          "old_text": null,
          "new_text": "proj_ch.ColumnCount()",
          "old_line_content": "",
          "new_line_content": "\tfor (idx_t col_idx = 0; col_idx < proj_ch.ColumnCount(); col_idx++) {",
          "content_same": false
        },
        {
          "line": 1259,
          "old_api": null,
          "new_api": "Reference",
          "old_text": null,
          "new_text": "chunk.data[out_idx++].Reference(proj_ch.data[col_idx])",
          "old_line_content": "\tstate.position += STANDARD_VECTOR_SIZE;",
          "new_line_content": "\t\tchunk.data[out_idx++].Reference(proj_ch.data[col_idx]);",
          "content_same": false
        },
        {
          "line": 1261,
          "old_api": null,
          "new_api": "ColumnCount",
          "old_text": null,
          "new_text": "wind_ch.ColumnCount()",
          "old_line_content": "",
          "new_line_content": "\tfor (idx_t col_idx = 0; col_idx < wind_ch.ColumnCount(); col_idx++) {",
          "content_same": false
        },
        {
          "line": 1262,
          "old_api": null,
          "new_api": "Reference",
          "old_text": null,
          "new_text": "chunk.data[out_idx++].Reference(wind_ch.data[col_idx])",
          "old_line_content": "SinkResultType PhysicalWindow::Sink(ExecutionContext &context, GlobalSinkState &state, LocalSinkState &lstate_p,",
          "new_line_content": "\t\tchunk.data[out_idx++].Reference(wind_ch.data[col_idx]);",
          "content_same": false
        },
        {
          "line": 1264,
          "old_api": null,
          "new_api": "Verify",
          "old_text": null,
          "new_text": "chunk.Verify()",
          "old_line_content": "\tauto &lstate = (WindowLocalState &)lstate_p;",
          "new_line_content": "\tchunk.Verify();",
          "content_same": false
        },
        {
          "line": 755,
          "old_api": null,
          "new_api": "FindNextStart",
          "old_text": null,
          "new_text": "FindNextStart(order_mask, bounds.peer_start + 1, bounds.partition_end, n)",
          "old_line_content": "\t\tbounds.partition_end = input_size;",
          "new_line_content": "\t\t\t\tbounds.peer_end = FindNextStart(order_mask, bounds.peer_start + 1, bounds.partition_end, n);",
          "content_same": false
        },
        {
          "line": 1272,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": "lstate.chunks.Append(input)",
          "old_line_content": "\tif (sort_col_count > 0) {",
          "new_line_content": "\tlstate.chunks.Append(input);",
          "content_same": false
        },
        {
          "line": 1281,
          "old_api": null,
          "new_api": "MaterializeOverForWindow",
          "old_text": null,
          "new_text": "MaterializeOverForWindow(over_expr, input, over_chunk)",
          "old_line_content": "\t\t\tDataChunk hash_chunk;",
          "new_line_content": "\t\tMaterializeOverForWindow(over_expr, input, over_chunk);",
          "content_same": false
        },
        {
          "line": 1285,
          "old_api": null,
          "new_api": "resize",
          "old_text": null,
          "new_text": "lstate.counts.resize(lstate.partition_count, 0)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\tlstate.counts.resize(lstate.partition_count, 0);",
          "content_same": false
        },
        {
          "line": 1289,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "over_expr->partitions.size()",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tHashChunk(lstate.counts, hash_chunk, over_chunk, over_expr->partitions.size());",
          "content_same": false
        },
        {
          "line": 1290,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": "lstate.hash_collection.Append(hash_chunk)",
          "old_line_content": "\treturn SinkResultType::NEED_MORE_INPUT;",
          "new_line_content": "\t\t\tlstate.hash_collection.Append(hash_chunk);",
          "content_same": false
        },
        {
          "line": 1291,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "lstate.hash_collection.Count()",
          "old_line_content": "}",
          "new_line_content": "\t\t\tD_ASSERT(lstate.chunks.Count() == lstate.hash_collection.Count());",
          "content_same": false
        },
        {
          "line": 782,
          "old_api": null,
          "new_api": "GetCell<int64_t>(boundary_start_collection, 0, bounds.scalar_start ? 0 : row_idx)",
          "old_text": null,
          "new_text": "GetCell<int64_t>(boundary_start_collection, 0, bounds.scalar_start ? 0 : row_idx)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t    (int64_t)row_idx - GetCell<int64_t>(boundary_start_collection, 0, bounds.scalar_start ? 0 : row_idx);",
          "content_same": false
        },
        {
          "line": 1294,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": "lstate.over_collection.Append(over_chunk)",
          "old_line_content": "\tauto &lstate = (WindowLocalState &)lstate_p;",
          "new_line_content": "\t\tlstate.over_collection.Append(over_chunk);",
          "content_same": false
        },
        {
          "line": 787,
          "old_api": null,
          "new_api": "GetCell<int64_t>(boundary_start_collection, 0, bounds.scalar_start ? 0 : row_idx)",
          "old_text": null,
          "new_text": "GetCell<int64_t>(boundary_start_collection, 0, bounds.scalar_start ? 0 : row_idx)",
          "old_line_content": "\t\t} else {",
          "new_line_content": "\t\t    row_idx + GetCell<int64_t>(boundary_start_collection, 0, bounds.scalar_start ? 0 : row_idx);",
          "content_same": false
        },
        {
          "line": 792,
          "old_api": null,
          "new_api": "CellIsNull",
          "old_text": null,
          "new_text": "CellIsNull(boundary_start_collection, 0, expr_idx)",
          "old_line_content": "\t\tbreak;",
          "new_line_content": "\t\tif (CellIsNull(boundary_start_collection, 0, expr_idx)) {",
          "content_same": false
        },
        {
          "line": 1308,
          "old_api": null,
          "new_api": "Merge",
          "old_text": null,
          "new_text": "gstate.over_collection.Merge(lstate.over_collection)",
          "old_line_content": "\t\t\tgstate.counts[i] += lstate.counts[i];",
          "new_line_content": "\tgstate.over_collection.Merge(lstate.over_collection);",
          "content_same": false
        },
        {
          "line": 1309,
          "old_api": null,
          "new_api": "Merge",
          "old_text": null,
          "new_text": "gstate.hash_collection.Merge(lstate.hash_collection)",
          "old_line_content": "\t\t}",
          "new_line_content": "\tgstate.hash_collection.Merge(lstate.hash_collection);",
          "content_same": false
        },
        {
          "line": 1310,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "gstate.counts.empty()",
          "old_line_content": "\t}",
          "new_line_content": "\tif (gstate.counts.empty()) {",
          "content_same": false
        },
        {
          "line": 1313,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "lstate.counts.size()",
          "old_line_content": "unique_ptr<LocalSinkState> PhysicalWindow::GetLocalSinkState(ExecutionContext &context) const {",
          "new_line_content": "\t\tD_ASSERT(gstate.counts.size() == lstate.counts.size());",
          "content_same": false
        },
        {
          "line": 803,
          "old_api": null,
          "new_api": "CellIsNull",
          "old_text": null,
          "new_text": "CellIsNull(boundary_start_collection, 0, expr_idx)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tif (CellIsNull(boundary_start_collection, 0, expr_idx)) {",
          "content_same": false
        },
        {
          "line": 806,
          "old_api": null,
          "new_api": "FindOrderedRangeBound<true>(over_collection, order_col, bounds.range_sense, row_idx,\n\t\t\t                                                  bounds.valid_end, boundary_start_collection, expr_idx)",
          "old_text": null,
          "new_text": "FindOrderedRangeBound<true>(over_collection, order_col, bounds.range_sense, row_idx,\n\t\t\t                                                  bounds.valid_end, boundary_start_collection, expr_idx)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tbounds.window_start = FindOrderedRangeBound<true>(over_collection, order_col, bounds.range_sense, row_idx,",
          "content_same": false
        },
        {
          "line": 1321,
          "old_api": null,
          "new_api": "make_unique<WindowLocalState>(*this)",
          "old_text": null,
          "new_text": "make_unique<WindowLocalState>(*this)",
          "old_line_content": "//===--------------------------------------------------------------------===//",
          "new_line_content": "\treturn make_unique<WindowLocalState>(*this);",
          "content_same": false
        },
        {
          "line": 812,
          "old_api": null,
          "new_api": "InternalException",
          "old_text": null,
          "new_text": "InternalException(\"Unsupported window start boundary\")",
          "old_line_content": "\tcase WindowBoundary::CURRENT_ROW_RANGE:",
          "new_line_content": "\t\tthrow InternalException(\"Unsupported window start boundary\");",
          "content_same": false
        },
        {
          "line": 1325,
          "old_api": null,
          "new_api": "make_unique<WindowGlobalState>(*this, context)",
          "old_text": null,
          "new_text": "make_unique<WindowGlobalState>(*this, context)",
          "old_line_content": "public:",
          "new_line_content": "\treturn make_unique<WindowGlobalState>(*this, context);",
          "content_same": false
        },
        {
          "line": 1333,
          "old_api": null,
          "new_api": "explicit",
          "old_text": null,
          "new_text": "explicit",
          "old_line_content": "public:",
          "new_line_content": "\texplicit WindowGlobalSourceState(const PhysicalWindow &op) : op(op), next_part(0) {",
          "content_same": false
        },
        {
          "line": 830,
          "old_api": null,
          "new_api": "GetCell<int64_t>(boundary_end_collection, 0, bounds.scalar_end ? 0 : row_idx)",
          "old_text": null,
          "new_text": "GetCell<int64_t>(boundary_end_collection, 0, bounds.scalar_end ? 0 : row_idx)",
          "old_line_content": "\t\t\tbounds.window_end =",
          "new_line_content": "\t\tbounds.window_end = row_idx + GetCell<int64_t>(boundary_end_collection, 0, bounds.scalar_end ? 0 : row_idx) + 1;",
          "content_same": false
        },
        {
          "line": 1345,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "state.counts.empty()",
          "old_line_content": "\t\t\t\tmax_threads++;",
          "new_line_content": "\t\tif (state.counts.empty()) {",
          "content_same": false
        },
        {
          "line": 834,
          "old_api": null,
          "new_api": "CellIsNull",
          "old_text": null,
          "new_text": "CellIsNull(boundary_end_collection, 0, expr_idx)",
          "old_line_content": "\t\tbreak;",
          "new_line_content": "\t\tif (CellIsNull(boundary_end_collection, 0, expr_idx)) {",
          "content_same": false
        },
        {
          "line": 845,
          "old_api": null,
          "new_api": "CellIsNull",
          "old_text": null,
          "new_text": "CellIsNull(boundary_end_collection, 0, expr_idx)",
          "old_line_content": "\t}",
          "new_line_content": "\t\tif (CellIsNull(boundary_end_collection, 0, expr_idx)) {",
          "content_same": false
        },
        {
          "line": 848,
          "old_api": null,
          "new_api": "FindOrderedRangeBound<false>(over_collection, order_col, bounds.range_sense, row_idx,\n\t\t\t                                                 bounds.valid_end, boundary_end_collection, expr_idx)",
          "old_text": null,
          "new_text": "FindOrderedRangeBound<false>(over_collection, order_col, bounds.range_sense, row_idx,\n\t\t\t                                                 bounds.valid_end, boundary_end_collection, expr_idx)",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tbounds.window_end = FindOrderedRangeBound<false>(over_collection, order_col, bounds.range_sense, row_idx,",
          "content_same": false
        },
        {
          "line": 1362,
          "old_api": null,
          "new_api": "make_unique<WindowOperatorState>(*this, context)",
          "old_text": null,
          "new_text": "make_unique<WindowOperatorState>(*this, context)",
          "old_line_content": "void PhysicalWindow::GetData(ExecutionContext &context, DataChunk &chunk, GlobalSourceState &gstate_p,",
          "new_line_content": "\treturn make_unique<WindowOperatorState>(*this, context);",
          "content_same": false
        },
        {
          "line": 340,
          "old_api": null,
          "new_api": "Types",
          "old_text": null,
          "new_text": "input.Types()",
          "old_line_content": "\tChunkCollection payload;",
          "new_line_content": "\tauto payload_types = input.Types();",
          "content_same": false
        },
        {
          "line": 854,
          "old_api": null,
          "new_api": "InternalException",
          "old_text": null,
          "new_text": "InternalException(\"Unsupported window end boundary\")",
          "old_line_content": "\tif (bounds.window_start > (int64_t)bounds.partition_end) {",
          "new_line_content": "\t\tthrow InternalException(\"Unsupported window end boundary\");",
          "content_same": false
        },
        {
          "line": 1366,
          "old_api": null,
          "new_api": "make_unique<WindowGlobalSourceState>(*this)",
          "old_text": null,
          "new_text": "make_unique<WindowGlobalSourceState>(*this)",
          "old_line_content": "\tauto &gstate = (WindowGlobalState &)*sink_state;",
          "new_line_content": "\treturn make_unique<WindowGlobalSourceState>(*this);",
          "content_same": false
        },
        {
          "line": 1383,
          "old_api": null,
          "new_api": "GeneratePartition",
          "old_text": null,
          "new_text": "GeneratePartition(state, gstate, hash_bin)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tGeneratePartition(state, gstate, hash_bin);",
          "content_same": false
        },
        {
          "line": 872,
          "old_api": null,
          "new_api": "InternalException",
          "old_text": null,
          "new_text": "InternalException(\"Failed to compute window boundaries\")",
          "old_line_content": "",
          "new_line_content": "\t\tthrow InternalException(\"Failed to compute window boundaries\");",
          "content_same": false
        },
        {
          "line": 1386,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "chunk.size()",
          "old_line_content": "}",
          "new_line_content": "\t\tif (chunk.size() != 0) {",
          "content_same": false
        },
        {
          "line": 1392,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "chunk.size()",
          "old_line_content": "\t\t\tresult += \"\\n\";",
          "new_line_content": "\tD_ASSERT(chunk.size() == 0);",
          "content_same": false
        },
        {
          "line": 371,
          "old_api": null,
          "new_api": "Reference",
          "old_text": null,
          "new_text": "payload_chunk.data[col_idx].Reference(input_chunk.data[col_idx])",
          "old_line_content": "",
          "new_line_content": "\t\t\tpayload_chunk.data[col_idx].Reference(input_chunk.data[col_idx]);",
          "content_same": false
        },
        {
          "line": 373,
          "old_api": null,
          "new_api": "Chunks",
          "old_text": null,
          "new_text": "over.Chunks()",
          "old_line_content": "\t\tif (hashes) {",
          "new_line_content": "\t\tauto &over_chunk = *over.Chunks()[i];",
          "content_same": false
        },
        {
          "line": 886,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "child.get()",
          "old_line_content": "\tif (wexpr->type == ExpressionType::WINDOW_LEAD || wexpr->type == ExpressionType::WINDOW_LAG) {",
          "new_line_content": "\t\texprs.push_back(child.get());",
          "content_same": false
        },
        {
          "line": 1397,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "select_list.size()",
          "old_line_content": "}",
          "new_line_content": "\tfor (idx_t i = 0; i < select_list.size(); i++) {",
          "content_same": false
        },
        {
          "line": 377,
          "old_api": null,
          "new_api": "SetCardinality",
          "old_text": null,
          "new_text": "payload_chunk.SetCardinality(input_chunk)",
          "old_line_content": "\t\t\tidx_t bin_size = 0;",
          "new_line_content": "\t\tpayload_chunk.SetCardinality(input_chunk);",
          "content_same": false
        },
        {
          "line": 1401,
          "old_api": null,
          "new_api": "GetName",
          "old_text": null,
          "new_text": "select_list[i]->GetName()",
          "old_line_content": "",
          "new_line_content": "\t\tresult += select_list[i]->GetName();",
          "content_same": false
        },
        {
          "line": 381,
          "old_api": null,
          "new_api": "Chunks",
          "old_text": null,
          "new_text": "hashes->Chunks()",
          "old_line_content": "\t\t\t\t}",
          "new_line_content": "\t\t\tauto &hash_chunk = *hashes->Chunks()[i];",
          "content_same": false
        },
        {
          "line": 382,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "hash_chunk.size()",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\tauto hash_size = hash_chunk.size();",
          "content_same": false
        },
        {
          "line": 383,
          "old_api": null,
          "new_api": "FlatVector::GetData<hash_t>(hash_chunk.data[0])",
          "old_text": null,
          "new_text": "FlatVector::GetData<hash_t>(hash_chunk.data[0])",
          "old_line_content": "",
          "new_line_content": "\t\t\tauto hash_data = FlatVector::GetData<hash_t>(hash_chunk.data[0]);",
          "content_same": false
        },
        {
          "line": 895,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "wexpr->offset_expr.get()",
          "old_line_content": "\t}",
          "new_line_content": "\t\t\tMaterializeExpression(wexpr->offset_expr.get(), input, leadlag_offset_collection,",
          "content_same": false
        },
        {
          "line": 896,
          "old_api": null,
          "new_api": "IsScalar",
          "old_text": null,
          "new_text": "wexpr->offset_expr->IsScalar()",
          "old_line_content": "",
          "new_line_content": "\t\t\t                      wexpr->offset_expr->IsScalar());",
          "content_same": false
        },
        {
          "line": 899,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "wexpr->default_expr.get()",
          "old_line_content": "\tif (wexpr->start_expr) {",
          "new_line_content": "\t\t\tMaterializeExpression(wexpr->default_expr.get(), input, leadlag_default_collection,",
          "content_same": false
        },
        {
          "line": 392,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "over_partition.size()",
          "old_line_content": "\t\t\tif (bin_size) {",
          "new_line_content": "\t\t\tif (over_partition.size() + bin_size > STANDARD_VECTOR_SIZE) {",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": null,
          "new_api": "Reset",
          "old_text": null,
          "new_text": "payload_partition.Reset()",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\tpayload_partition.Reset();",
          "content_same": false
        },
        {
          "line": 907,
          "old_api": null,
          "new_api": "IsScalar",
          "old_text": null,
          "new_text": "wexpr->start_expr->IsScalar()",
          "old_line_content": "",
          "new_line_content": "\t\tMaterializeExpression(wexpr->start_expr.get(), input, boundary_start_collection, wexpr->start_expr->IsScalar());",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": "over_partition.Append(over_chunk, false, &sel, bin_size)",
          "old_line_content": "",
          "new_line_content": "\t\t\t\tover_partition.Append(over_chunk, false, &sel, bin_size);",
          "content_same": false
        },
        {
          "line": 401,
          "old_api": null,
          "new_api": "Append",
          "old_text": null,
          "new_text": "payload_partition.Append(payload_chunk, false, &sel, bin_size)",
          "old_line_content": "\t// Flush any ragged partition chunks",
          "new_line_content": "\t\t\t\tpayload_partition.Append(payload_chunk, false, &sel, bin_size);",
          "content_same": false
        },
        {
          "line": 912,
          "old_api": null,
          "new_api": "IsScalar",
          "old_text": null,
          "new_text": "wexpr->end_expr->IsScalar()",
          "old_line_content": "\t\tcase ExpressionType::WINDOW_LEAD:",
          "new_line_content": "\t\tMaterializeExpression(wexpr->end_expr.get(), input, boundary_end_collection, wexpr->end_expr->IsScalar());",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "over_partition.size()",
          "old_line_content": "\tif (!hashes) {",
          "new_line_content": "\tif (over_partition.size() > 0) {",
          "content_same": false
        },
        {
          "line": 412,
          "old_api": null,
          "new_api": "Reset",
          "old_text": null,
          "new_text": "payload_partition.Reset()",
          "old_line_content": "\t}",
          "new_line_content": "\t\tpayload_partition.Reset();",
          "content_same": false
        },
        {
          "line": 926,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "chunk->size()",
          "old_line_content": "\t\t\t\t\t}",
          "new_line_content": "\t\t\t\tconst auto count = chunk->size();",
          "content_same": false
        },
        {
          "line": 928,
          "old_api": null,
          "new_api": "Orrify",
          "old_text": null,
          "new_text": "chunk->data[0].Orrify(count, vdata)",
          "old_line_content": "\t\t\t\t\t// Chunks in a collection are full, so we don't have to worry about raggedness",
          "new_line_content": "\t\t\t\tchunk->data[0].Orrify(count, vdata);",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": null,
          "new_api": "Reset",
          "old_text": null,
          "new_text": "input.Reset()",
          "old_line_content": "}",
          "new_line_content": "\t\tinput.Reset();",
          "content_same": false
        },
        {
          "line": 932,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "payload_collection.Count()",
          "old_line_content": "\t\t\t\t\t\t*dst++ = *src++;",
          "new_line_content": "\t\t\t\t\t\tignore_nulls.Initialize(payload_collection.Count());",
          "content_same": false
        },
        {
          "line": 422,
          "old_api": null,
          "new_api": "AddLocalState",
          "old_text": null,
          "new_text": "global_sort_state.AddLocalState(local_sort_state)",
          "old_line_content": "                                const vector<LogicalType> &over_types) {",
          "new_line_content": "\tglobal_sort_state.AddLocalState(local_sort_state);",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": null,
          "new_api": "PrepareMergePhase",
          "old_text": null,
          "new_text": "global_sort_state.PrepareMergePhase()",
          "old_line_content": "",
          "new_line_content": "\tglobal_sort_state.PrepareMergePhase();",
          "content_same": false
        },
        {
          "line": 936,
          "old_api": null,
          "new_api": "EntryCount",
          "old_text": null,
          "new_text": "ignore_nulls.EntryCount(pos)",
          "old_line_content": "\t\t\t}",
          "new_line_content": "\t\t\t\t\tauto dst = ignore_nulls.GetData() + ignore_nulls.EntryCount(pos);",
          "content_same": false
        },
        {
          "line": 937,
          "old_api": null,
          "new_api": "GetData",
          "old_text": null,
          "new_text": "vdata.validity.GetData()",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\t\t\t\tauto src = vdata.validity.GetData();",
          "content_same": false
        },
        {
          "line": 938,
          "old_api": null,
          "new_api": "EntryCount",
          "old_text": null,
          "new_text": "vdata.validity.EntryCount(count)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\t\t\tfor (auto entry_count = vdata.validity.EntryCount(count); entry_count-- > 0;) {",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": null,
          "new_api": "Initialize",
          "old_text": null,
          "new_text": "payload_chunk.Initialize(payload_types)",
          "old_line_content": "\t\t// split into two",
          "new_line_content": "\t\tpayload_chunk.Initialize(payload_types);",
          "content_same": false
        },
        {
          "line": 440,
          "old_api": null,
          "new_api": "SetCardinality",
          "old_text": null,
          "new_text": "payload_chunk.SetCardinality(0)",
          "old_line_content": "\t\tDataChunk over_chunk;",
          "new_line_content": "\t\tpayload_chunk.SetCardinality(0);",
          "content_same": false
        },
        {
          "line": 442,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "payload_chunk.size()",
          "old_line_content": "",
          "new_line_content": "\t\tif (payload_chunk.size() == 0) {",
          "content_same": false
        },
        {
          "line": 956,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "wexpr->bind_info.get()",
          "old_line_content": "\t// this is the main loop, go through all sorted rows and compute window function result",
          "new_line_content": "\t\tsegment_tree = make_unique<WindowSegmentTree>(*(wexpr->aggregate), wexpr->bind_info.get(), wexpr->return_type,",
          "content_same": false
        },
        {
          "line": 448,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "input_types.size()",
          "old_line_content": "",
          "new_line_content": "\t\tpayload_chunk.Split(over_chunk, input_types.size());",
          "content_same": false
        },
        {
          "line": 967,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "input.Count()",
          "old_line_content": "\t\t}",
          "new_line_content": "\tfor (idx_t row_idx = 0; row_idx < input.Count(); row_idx++) {",
          "content_same": false
        },
        {
          "line": 459,
          "old_api": null,
          "new_api": "SetCardinality",
          "old_text": null,
          "new_text": "hash_chunk.SetCardinality(sort_chunk)",
          "old_line_content": "\t}",
          "new_line_content": "\thash_chunk.SetCardinality(sort_chunk);",
          "content_same": false
        },
        {
          "line": 972,
          "old_api": null,
          "new_api": "Reset",
          "old_text": null,
          "new_text": "output_chunk.Reset()",
          "old_line_content": "\t\t                       partition_mask, order_mask);",
          "new_line_content": "\t\t\toutput_chunk.Reset();",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": null,
          "new_api": "VectorOperations::CombineHash(hash_vector, sort_chunk.data[prt_idx], count)",
          "old_text": null,
          "new_text": "VectorOperations::CombineHash(hash_vector, sort_chunk.data[prt_idx], count)",
          "old_line_content": "\t\tcounts[bin] += count;",
          "new_line_content": "\t\tVectorOperations::CombineHash(hash_vector, sort_chunk.data[prt_idx], count);",
          "content_same": false
        },
        {
          "line": 978,
          "old_api": null,
          "new_api": "Count",
          "old_text": null,
          "new_text": "input.Count()",
          "old_line_content": "\t\t\t} else if (!bounds.is_peer) {",
          "new_line_content": "\t\tUpdateWindowBoundaries(bounds, input.Count(), row_idx, over, boundary_start_collection, boundary_end_collection,",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "counts.size()",
          "old_line_content": "\t\t\tconst auto bin = (hashes[i] & partition_mask);",
          "new_line_content": "\tconst auto partition_mask = hash_t(counts.size() - 1);",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": null,
          "new_api": "FlatVector::GetData<hash_t>(hash_vector)",
          "old_text": null,
          "new_text": "FlatVector::GetData<hash_t>(hash_vector)",
          "old_line_content": "\t\t\t++counts[bin];",
          "new_line_content": "\tauto hashes = FlatVector::GetData<hash_t>(hash_vector);",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": null,
          "new_api": "GetVectorType",
          "old_text": null,
          "new_text": "hash_vector.GetVectorType()",
          "old_line_content": "\t\t}",
          "new_line_content": "\tif (hash_vector.GetVectorType() == VectorType::CONSTANT_VECTOR) {",
          "content_same": false
        },
        {
          "line": 980,
          "old_api": null,
          "new_api": "WindowNeedsRank",
          "old_text": null,
          "new_text": "WindowNeedsRank(wexpr)",
          "old_line_content": "\t\t\t\trank += rank_equal;",
          "new_line_content": "\t\tif (WindowNeedsRank(wexpr)) {",
          "content_same": false
        },
        {
          "line": 995,
          "old_api": null,
          "new_api": "FlatVector::SetNull(result, output_offset, true)",
          "old_text": null,
          "new_text": "FlatVector::SetNull(result, output_offset, true)",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\t\tFlatVector::SetNull(result, output_offset, true);",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "wexpr->partitions.size()",
          "old_line_content": "\t\tauto &oexpr = wexpr->orders[ord_idx].expression;",
          "new_line_content": "\tfor (idx_t prt_idx = 0; prt_idx < wexpr->partitions.size(); prt_idx++) {",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": null,
          "new_api": "AddExpression",
          "old_text": null,
          "new_text": "executor.AddExpression(*pexpr)",
          "old_line_content": "\t}",
          "new_line_content": "\t\texecutor.AddExpression(*pexpr);",
          "content_same": false
        },
        {
          "line": 1001,
          "old_api": null,
          "new_api": "Compute",
          "old_text": null,
          "new_text": "segment_tree->Compute(result, output_offset, bounds.window_start, bounds.window_end)",
          "old_line_content": "\t\t}",
          "new_line_content": "\t\t\tsegment_tree->Compute(result, output_offset, bounds.window_start, bounds.window_end);",
          "content_same": false
        },
        {
          "line": 492,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "wexpr->orders.size()",
          "old_line_content": "",
          "new_line_content": "\tfor (idx_t ord_idx = 0; ord_idx < wexpr->orders.size(); ord_idx++) {",
          "content_same": false
        },
        {
          "line": 1005,
          "old_api": null,
          "new_api": "FlatVector::GetData<int64_t>(result)",
          "old_text": null,
          "new_text": "FlatVector::GetData<int64_t>(result)",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\t\tauto rdata = FlatVector::GetData<int64_t>(result);",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": null,
          "new_api": "AddExpression",
          "old_text": null,
          "new_text": "executor.AddExpression(*oexpr)",
          "old_line_content": "",
          "new_line_content": "\t\texecutor.AddExpression(*oexpr);",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "over_types.empty()",
          "old_line_content": "",
          "new_line_content": "\tD_ASSERT(!over_types.empty());",
          "content_same": false
        },
        {
          "line": 1010,
          "old_api": null,
          "new_api": "FlatVector::GetData<int64_t>(result)",
          "old_text": null,
          "new_text": "FlatVector::GetData<int64_t>(result)",
          "old_line_content": "\t\t\tbreak;",
          "new_line_content": "\t\t\tauto rdata = FlatVector::GetData<int64_t>(result);",
          "content_same": false
        },
        {
          "line": 500,
          "old_api": null,
          "new_api": "Initialize",
          "old_text": null,
          "new_text": "over_chunk.Initialize(over_types)",
          "old_line_content": "\tswitch (boundary) {",
          "new_line_content": "\tover_chunk.Initialize(over_types);",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": null,
          "new_api": "Execute",
          "old_text": null,
          "new_text": "executor.Execute(input_chunk, over_chunk)",
          "old_line_content": "\tcase WindowBoundary::CURRENT_ROW_RANGE:",
          "new_line_content": "\texecutor.Execute(input_chunk, over_chunk);",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": null,
          "new_api": "Verify",
          "old_text": null,
          "new_text": "over_chunk.Verify()",
          "old_line_content": "\tcase WindowBoundary::EXPR_FOLLOWING_RANGE:",
          "new_line_content": "\tover_chunk.Verify();",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 512,
          "old_api": "IsScalar",
          "new_api": null,
          "old_text": "expr->IsScalar()",
          "new_text": null,
          "old_line_content": "\t\treturn expr ? expr->IsScalar() : true;",
          "new_line_content": "\tdefault:",
          "content_same": false
        },
        {
          "line": 515,
          "old_api": "explicit",
          "new_api": null,
          "old_text": "explicit",
          "new_text": null,
          "old_line_content": "\texplicit WindowBoundariesState(BoundWindowExpression *wexpr)",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1027,
          "old_api": "ColumnCount",
          "new_api": null,
          "old_text": "payload_collection.ColumnCount()",
          "new_text": null,
          "old_line_content": "\t\t\tD_ASSERT(payload_collection.ColumnCount() == 1);",
          "new_line_content": "\t\t\tint64_t denom = (int64_t)bounds.partition_end - bounds.partition_start;",
          "content_same": false
        },
        {
          "line": 517,
          "old_api": "size",
          "new_api": null,
          "old_text": "wexpr->orders.size()",
          "new_text": null,
          "old_line_content": "\t      partition_count(wexpr->partitions.size()), order_count(wexpr->orders.size()),",
          "new_line_content": "struct WindowBoundariesState {",
          "content_same": false
        },
        {
          "line": 518,
          "old_api": "empty",
          "new_api": null,
          "old_text": "wexpr->orders.empty()",
          "new_text": null,
          "old_line_content": "\t      range_sense(wexpr->orders.empty() ? OrderType::INVALID : wexpr->orders[0].type),",
          "new_line_content": "\tstatic inline bool IsScalar(const unique_ptr<Expression> &expr) {",
          "content_same": false
        },
        {
          "line": 1028,
          "old_api": "GetCell<int64_t>(payload_collection, 0, row_idx)",
          "new_api": null,
          "old_text": "GetCell<int64_t>(payload_collection, 0, row_idx)",
          "new_text": null,
          "old_line_content": "\t\t\tauto n_param = GetCell<int64_t>(payload_collection, 0, row_idx);",
          "new_line_content": "\t\t\tdouble cume_dist = denom > 0 ? ((double)(bounds.peer_end - bounds.partition_start)) / denom : 0;",
          "content_same": false
        },
        {
          "line": 1038,
          "old_api": "D_ASSERT",
          "new_api": null,
          "old_text": "D_ASSERT(row_idx >= bounds.partition_start)",
          "new_text": null,
          "old_line_content": "\t\t\tD_ASSERT(row_idx >= bounds.partition_start);",
          "new_line_content": "\t\t\tif (n_param > n_total) {",
          "content_same": false
        },
        {
          "line": 1053,
          "old_api": "D_ASSERT",
          "new_api": null,
          "old_text": "D_ASSERT(result_ntile >= 1 && result_ntile <= n_param)",
          "new_text": null,
          "old_line_content": "\t\t\tD_ASSERT(result_ntile >= 1 && result_ntile <= n_param);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1054,
          "old_api": "FlatVector::GetData<int64_t>(result)",
          "new_api": null,
          "old_text": "FlatVector::GetData<int64_t>(result)",
          "new_text": null,
          "old_line_content": "\t\t\tauto rdata = FlatVector::GetData<int64_t>(result);",
          "new_line_content": "\t\t\tif (adjusted_row_idx < i_small) {",
          "content_same": false
        },
        {
          "line": 1062,
          "old_api": "IsScalar",
          "new_api": null,
          "old_text": "wexpr->offset_expr->IsScalar()",
          "new_text": null,
          "old_line_content": "\t\t\t\toffset = GetCell<int64_t>(leadlag_offset_collection, 0, wexpr->offset_expr->IsScalar() ? 0 : row_idx);",
          "new_line_content": "\t\t\trdata[output_offset] = result_ntile;",
          "content_same": false
        },
        {
          "line": 559,
          "old_api": "ColumnCount",
          "new_api": null,
          "old_text": "collection.ColumnCount()",
          "new_text": null,
          "old_line_content": "\tD_ASSERT(collection.ColumnCount() > column);",
          "new_line_content": "static bool WindowNeedsRank(BoundWindowExpression *wexpr) {",
          "content_same": false
        },
        {
          "line": 560,
          "old_api": "GetChunkForRow",
          "new_api": null,
          "old_text": "collection.GetChunkForRow(index)",
          "new_text": null,
          "old_line_content": "\tauto &chunk = collection.GetChunkForRow(index);",
          "new_line_content": "\treturn wexpr->type == ExpressionType::WINDOW_PERCENT_RANK || wexpr->type == ExpressionType::WINDOW_RANK ||",
          "content_same": false
        },
        {
          "line": 1074,
          "old_api": "idx_t",
          "new_api": null,
          "old_text": "idx_t(row_idx - val_idx)",
          "new_text": null,
          "old_line_content": "\t\t\t\tdelta = idx_t(row_idx - val_idx);",
          "new_line_content": "\t\t\t} else {",
          "content_same": false
        },
        {
          "line": 563,
          "old_api": "FlatVector::GetData<T>(source)",
          "new_api": null,
          "old_text": "FlatVector::GetData<T>(source)",
          "new_text": null,
          "old_line_content": "\tconst auto data = FlatVector::GetData<T>(source);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1075,
          "old_api": "FindPrevStart",
          "new_api": null,
          "old_text": "FindPrevStart(ignore_nulls, bounds.partition_start, row_idx, delta)",
          "new_text": null,
          "old_line_content": "\t\t\t\tval_idx = FindPrevStart(ignore_nulls, bounds.partition_start, row_idx, delta);",
          "new_line_content": "\t\t\t\tval_idx -= offset;",
          "content_same": false
        },
        {
          "line": 1077,
          "old_api": "idx_t",
          "new_api": null,
          "old_text": "idx_t(val_idx - row_idx)",
          "new_text": null,
          "old_line_content": "\t\t\t\tdelta = idx_t(val_idx - row_idx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1078,
          "old_api": "FindNextStart",
          "new_api": null,
          "old_text": "FindNextStart(ignore_nulls, row_idx + 1, bounds.partition_end, delta)",
          "new_text": null,
          "old_line_content": "\t\t\t\tval_idx = FindNextStart(ignore_nulls, row_idx + 1, bounds.partition_end, delta);",
          "new_line_content": "\t\t\tidx_t delta = 0;",
          "content_same": false
        },
        {
          "line": 568,
          "old_api": "ColumnCount",
          "new_api": null,
          "old_text": "collection.ColumnCount()",
          "new_text": null,
          "old_line_content": "\tD_ASSERT(collection.ColumnCount() > column);",
          "new_line_content": "\tauto &source = chunk.data[column];",
          "content_same": false
        },
        {
          "line": 569,
          "old_api": "GetChunkForRow",
          "new_api": null,
          "old_text": "collection.GetChunkForRow(index)",
          "new_text": null,
          "old_line_content": "\tauto &chunk = collection.GetChunkForRow(index);",
          "new_line_content": "\tconst auto source_offset = index % STANDARD_VECTOR_SIZE;",
          "content_same": false
        },
        {
          "line": 1083,
          "old_api": "CopyCell",
          "new_api": null,
          "old_text": "payload_collection.CopyCell(0, val_idx, result, output_offset)",
          "new_text": null,
          "old_line_content": "\t\t\t\tpayload_collection.CopyCell(0, val_idx, result, output_offset);",
          "new_line_content": "\t\t\t} else if (val_idx > (int64_t)row_idx) {",
          "content_same": false
        },
        {
          "line": 572,
          "old_api": "FlatVector::IsNull(source, source_offset)",
          "new_api": null,
          "old_text": "FlatVector::IsNull(source, source_offset)",
          "new_text": null,
          "old_line_content": "\treturn FlatVector::IsNull(source, source_offset);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1086,
          "old_api": "CopyCell",
          "new_api": null,
          "old_text": "leadlag_default_collection.CopyCell(0, source_row, result, output_offset)",
          "new_text": null,
          "old_line_content": "\t\t\t\tleadlag_default_collection.CopyCell(0, source_row, result, output_offset);",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 1088,
          "old_api": "FlatVector::SetNull(result, output_offset, true)",
          "new_api": null,
          "old_text": "FlatVector::SetNull(result, output_offset, true)",
          "new_text": null,
          "old_line_content": "\t\t\t\tFlatVector::SetNull(result, output_offset, true);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1094,
          "old_api": "FindNextStart",
          "new_api": null,
          "old_text": "FindNextStart(ignore_nulls, bounds.window_start, bounds.window_end, n)",
          "new_text": null,
          "old_line_content": "\t\t\tconst auto first_idx = FindNextStart(ignore_nulls, bounds.window_start, bounds.window_end, n);",
          "new_line_content": "\t\t\t} else {",
          "content_same": false
        },
        {
          "line": 1100,
          "old_api": "FindPrevStart",
          "new_api": null,
          "old_text": "FindPrevStart(ignore_nulls, bounds.window_start, bounds.window_end, n)",
          "new_text": null,
          "old_line_content": "\t\t\tpayload_collection.CopyCell(0, FindPrevStart(ignore_nulls, bounds.window_start, bounds.window_end, n),",
          "new_line_content": "\t\t\tidx_t n = 1;",
          "content_same": false
        },
        {
          "line": 589,
          "old_api": "GetCell<T>(*coll, col_no, pos)",
          "new_api": null,
          "old_text": "GetCell<T>(*coll, col_no, pos)",
          "new_text": null,
          "old_line_content": "\t\treturn GetCell<T>(*coll, col_no, pos);",
          "new_line_content": "\tusing pointer = idx_t;",
          "content_same": false
        },
        {
          "line": 591,
          "old_api": "explicit",
          "new_api": null,
          "old_text": "explicit",
          "new_text": null,
          "old_line_content": "\tinline explicit operator pointer() const {",
          "new_line_content": "\tChunkCollectionIterator(ChunkCollection &coll_p, idx_t col_no_p, pointer pos_p = 0)",
          "content_same": false
        },
        {
          "line": 1105,
          "old_api": "ColumnCount",
          "new_api": null,
          "old_text": "payload_collection.ColumnCount()",
          "new_text": null,
          "old_line_content": "\t\t\tD_ASSERT(payload_collection.ColumnCount() == 2);",
          "new_line_content": "\t\tcase ExpressionType::WINDOW_LAST_VALUE: {",
          "content_same": false
        },
        {
          "line": 1108,
          "old_api": "CellIsNull",
          "new_api": null,
          "old_text": "CellIsNull(payload_collection, 1, row_idx)",
          "new_text": null,
          "old_line_content": "\t\t\tif (CellIsNull(payload_collection, 1, row_idx)) {",
          "new_line_content": "\t\t\t                            result, output_offset);",
          "content_same": false
        },
        {
          "line": 1109,
          "old_api": "FlatVector::SetNull(result, output_offset, true)",
          "new_api": null,
          "old_text": "FlatVector::SetNull(result, output_offset, true)",
          "new_text": null,
          "old_line_content": "\t\t\t\tFlatVector::SetNull(result, output_offset, true);",
          "new_line_content": "\t\t\tbreak;",
          "content_same": false
        },
        {
          "line": 1111,
          "old_api": "GetCell<int64_t>(payload_collection, 1, row_idx)",
          "new_api": null,
          "old_text": "GetCell<int64_t>(payload_collection, 1, row_idx)",
          "new_text": null,
          "old_line_content": "\t\t\t\tauto n_param = GetCell<int64_t>(payload_collection, 1, row_idx);",
          "new_line_content": "\t\tcase ExpressionType::WINDOW_NTH_VALUE: {",
          "content_same": false
        },
        {
          "line": 1113,
          "old_api": "FlatVector::SetNull(result, output_offset, true)",
          "new_api": null,
          "old_text": "FlatVector::SetNull(result, output_offset, true)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tFlatVector::SetNull(result, output_offset, true);",
          "new_line_content": "\t\t\t// Returns value evaluated at the row that is the n'th row of the window frame (counting from 1);",
          "content_same": false
        },
        {
          "line": 1132,
          "old_api": "Append",
          "new_api": null,
          "old_text": "output.Append(output_chunk)",
          "new_text": null,
          "old_line_content": "\toutput.Append(output_chunk);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 621,
          "old_api": "OP::template Operation(lhs, val)",
          "new_api": null,
          "old_text": "OP::template Operation(lhs, val)",
          "new_text": null,
          "old_line_content": "\t\treturn OP::template Operation(lhs, val);",
          "new_line_content": "\tidx_t col_no;",
          "content_same": false
        },
        {
          "line": 629,
          "old_api": "GetCell<T>(boundary, 0, boundary_row)",
          "new_api": null,
          "old_text": "GetCell<T>(boundary, 0, boundary_row)",
          "new_text": null,
          "old_line_content": "\tconst auto val = GetCell<T>(boundary, 0, boundary_row);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1141,
          "old_api": "Count",
          "new_api": null,
          "old_text": "input.Count()",
          "new_text": null,
          "old_line_content": "\tif (input.Count() == 0) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 637,
          "old_api": "std::upper_bound(begin, end, val, comp)",
          "new_api": null,
          "old_text": "std::upper_bound(begin, end, val, comp)",
          "new_text": null,
          "old_line_content": "\t\treturn idx_t(std::upper_bound(begin, end, val, comp));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1149,
          "old_api": "data",
          "new_api": null,
          "old_text": "partition_bits.data()",
          "new_text": null,
          "old_line_content": "\tValidityMask partition_mask(partition_bits.data());",
          "new_line_content": "\t\treturn;",
          "content_same": false
        },
        {
          "line": 1150,
          "old_api": "SetValid",
          "new_api": null,
          "old_text": "partition_mask.SetValid(0)",
          "new_text": null,
          "old_line_content": "\tpartition_mask.SetValid(0);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1152,
          "old_api": "size",
          "new_api": null,
          "old_text": "over_expr->partitions.size()",
          "new_text": null,
          "old_line_content": "\tfor (idx_t c = 0; c < over_expr->partitions.size(); ++c) {",
          "new_line_content": "\tauto over_expr = window_exprs[0];",
          "content_same": false
        },
        {
          "line": 1153,
          "old_api": "MaskColumn",
          "new_api": null,
          "old_text": "MaskColumn(partition_mask, over, c)",
          "new_text": null,
          "old_line_content": "\t\tMaskColumn(partition_mask, over, c);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 645,
          "old_api": "size",
          "new_api": null,
          "old_text": "over_types.size()",
          "new_text": null,
          "old_line_content": "\tD_ASSERT(over_types.size() > order_col);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 646,
          "old_api": "Types",
          "new_api": null,
          "old_text": "boundary.Types().size()",
          "new_text": null,
          "old_line_content": "\tD_ASSERT(boundary.Types().size() == 1);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 647,
          "old_api": "Types",
          "new_api": null,
          "old_text": "boundary.Types()",
          "new_text": null,
          "old_line_content": "\tD_ASSERT(boundary.Types()[0] == over_types[order_col]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1158,
          "old_api": "size",
          "new_api": null,
          "old_text": "over_expr->orders.size()",
          "new_text": null,
          "old_line_content": "\tconst auto sort_col_count = over_expr->partitions.size() + over_expr->orders.size();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 649,
          "old_api": "InternalType",
          "new_api": null,
          "old_text": "over_types[order_col].InternalType()",
          "new_text": null,
          "old_line_content": "\tswitch (over_types[order_col].InternalType()) {",
          "new_line_content": "static idx_t FindRangeBound(ChunkCollection &over, const idx_t order_col, const idx_t order_begin,",
          "content_same": false
        },
        {
          "line": 1161,
          "old_api": "MaskColumn",
          "new_api": null,
          "old_text": "MaskColumn(order_mask, over, c)",
          "new_text": null,
          "old_line_content": "\t\tMaskColumn(order_mask, over, c);",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 655,
          "old_api": "FindTypedRangeBound<int32_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": null,
          "old_text": "FindTypedRangeBound<int32_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\treturn FindTypedRangeBound<int32_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 657,
          "old_api": "FindTypedRangeBound<int64_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": null,
          "old_text": "FindTypedRangeBound<int64_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\treturn FindTypedRangeBound<int64_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "\tcase PhysicalType::INT8:",
          "content_same": false
        },
        {
          "line": 659,
          "old_api": "FindTypedRangeBound<uint8_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": null,
          "old_text": "FindTypedRangeBound<uint8_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\treturn FindTypedRangeBound<uint8_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "\tcase PhysicalType::INT16:",
          "content_same": false
        },
        {
          "line": 661,
          "old_api": "FindTypedRangeBound<uint16_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": null,
          "old_text": "FindTypedRangeBound<uint16_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\treturn FindTypedRangeBound<uint16_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "\tcase PhysicalType::INT32:",
          "content_same": false
        },
        {
          "line": 663,
          "old_api": "FindTypedRangeBound<uint32_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": null,
          "old_text": "FindTypedRangeBound<uint32_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\treturn FindTypedRangeBound<uint32_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "\tcase PhysicalType::INT64:",
          "content_same": false
        },
        {
          "line": 665,
          "old_api": "FindTypedRangeBound<uint64_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": null,
          "old_text": "FindTypedRangeBound<uint64_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\treturn FindTypedRangeBound<uint64_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "\tcase PhysicalType::UINT8:",
          "content_same": false
        },
        {
          "line": 1178,
          "old_api": "size",
          "new_api": null,
          "old_text": "op.select_list.size()",
          "new_text": null,
          "old_line_content": "\tfor (idx_t expr_idx = 0; expr_idx < op.select_list.size(); ++expr_idx) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 667,
          "old_api": "FindTypedRangeBound<hugeint_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": null,
          "old_text": "FindTypedRangeBound<hugeint_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\treturn FindTypedRangeBound<hugeint_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "\tcase PhysicalType::UINT16:",
          "content_same": false
        },
        {
          "line": 1179,
          "old_api": "GetExpressionClass",
          "new_api": null,
          "old_text": "op.select_list[expr_idx]->GetExpressionClass()",
          "new_text": null,
          "old_line_content": "\t\tD_ASSERT(op.select_list[expr_idx]->GetExpressionClass() == ExpressionClass::BOUND_WINDOW);",
          "new_line_content": "//===--------------------------------------------------------------------===//",
          "content_same": false
        },
        {
          "line": 669,
          "old_api": "FindTypedRangeBound<float, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": null,
          "old_text": "FindTypedRangeBound<float, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\treturn FindTypedRangeBound<float, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "\tcase PhysicalType::UINT32:",
          "content_same": false
        },
        {
          "line": 1180,
          "old_api": "get",
          "new_api": null,
          "old_text": "op.select_list[expr_idx].get()",
          "new_text": null,
          "old_line_content": "\t\tauto wexpr = reinterpret_cast<BoundWindowExpression *>(op.select_list[expr_idx].get());",
          "new_line_content": "// Sink",
          "content_same": false
        },
        {
          "line": 671,
          "old_api": "FindTypedRangeBound<double, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": null,
          "old_text": "FindTypedRangeBound<double, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\treturn FindTypedRangeBound<double, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "\tcase PhysicalType::UINT64:",
          "content_same": false
        },
        {
          "line": 1181,
          "old_api": "emplace_back",
          "new_api": null,
          "old_text": "window_exprs.emplace_back(wexpr)",
          "new_text": null,
          "old_line_content": "\t\twindow_exprs.emplace_back(wexpr);",
          "new_line_content": "//===--------------------------------------------------------------------===//",
          "content_same": false
        },
        {
          "line": 673,
          "old_api": "FindTypedRangeBound<interval_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": null,
          "old_text": "FindTypedRangeBound<interval_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\treturn FindTypedRangeBound<interval_t, OP, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "\tcase PhysicalType::INT128:",
          "content_same": false
        },
        {
          "line": 675,
          "old_api": "InternalException",
          "new_api": null,
          "old_text": "InternalException(\"Unsupported column type for RANGE\")",
          "new_text": null,
          "old_line_content": "\t\tthrow InternalException(\"Unsupported column type for RANGE\");",
          "new_line_content": "\tcase PhysicalType::FLOAT:",
          "content_same": false
        },
        {
          "line": 685,
          "old_api": "FindRangeBound<LessThan, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": null,
          "old_text": "FindRangeBound<LessThan, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\treturn FindRangeBound<LessThan, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1197,
          "old_api": "Types",
          "new_api": null,
          "old_text": "gstate.chunks.Types()",
          "new_text": null,
          "old_line_content": "\tconst auto input_types = gstate.chunks.Types();",
          "new_line_content": "\t//\tPick out a function for the OVER clause",
          "content_same": false
        },
        {
          "line": 687,
          "old_api": "FindRangeBound<GreaterThan, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_api": null,
          "old_text": "FindRangeBound<GreaterThan, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\treturn FindRangeBound<GreaterThan, FROM>(over, order_col, order_begin, order_end, boundary, expr_idx);",
          "new_line_content": "static idx_t FindOrderedRangeBound(ChunkCollection &over, const idx_t order_col, const OrderType range_sense,",
          "content_same": false
        },
        {
          "line": 1198,
          "old_api": "Types",
          "new_api": null,
          "old_text": "gstate.over_collection.Types()",
          "new_text": null,
          "old_line_content": "\tconst auto over_types = gstate.over_collection.Types();",
          "new_line_content": "\tauto over_expr = window_exprs[0];",
          "content_same": false
        },
        {
          "line": 689,
          "old_api": "InternalException",
          "new_api": null,
          "old_text": "InternalException(\"Unsupported ORDER BY sense for RANGE\")",
          "new_text": null,
          "old_line_content": "\t\tthrow InternalException(\"Unsupported ORDER BY sense for RANGE\");",
          "new_line_content": "                                   const idx_t expr_idx) {",
          "content_same": false
        },
        {
          "line": 1200,
          "old_api": "empty",
          "new_api": null,
          "old_text": "gstate.counts.empty()",
          "new_text": null,
          "old_line_content": "\tif (gstate.counts.empty() && hash_bin == 0) {",
          "new_line_content": "\t// There are three types of partitions:",
          "content_same": false
        },
        {
          "line": 1206,
          "old_api": "Count",
          "new_api": null,
          "old_text": "input.Count()",
          "new_text": null,
          "old_line_content": "\t\tif (has_sorting && input.Count() > 0) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1208,
          "old_api": "SortCollectionForPartition",
          "new_api": null,
          "old_text": "SortCollectionForPartition(state, over_expr, input, over, nullptr, 0, 0)",
          "new_text": null,
          "old_line_content": "\t\t\tSortCollectionForPartition(state, over_expr, input, over, nullptr, 0, 0);",
          "new_line_content": "\t\tChunkCollection &input = gstate.chunks;",
          "content_same": false
        },
        {
          "line": 1211,
          "old_api": "ScanSortedPartition",
          "new_api": null,
          "old_text": "ScanSortedPartition(state, input, input_types, over, over_types)",
          "new_text": null,
          "old_line_content": "\t\t\tScanSortedPartition(state, input, input_types, over, over_types);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1214,
          "old_api": "ComputeWindowExpressions",
          "new_api": null,
          "old_text": "ComputeWindowExpressions(window_exprs, input, output, over, gstate.mode)",
          "new_text": null,
          "old_line_content": "\t\tComputeWindowExpressions(window_exprs, input, output, over, gstate.mode);",
          "new_line_content": "\t\t\t// 2. One partition",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": "RowIsValidUnsafe",
          "new_api": null,
          "old_text": "partition_mask.RowIsValidUnsafe(row_idx)",
          "new_text": null,
          "old_line_content": "\t\tbounds.is_same_partition = !partition_mask.RowIsValidUnsafe(row_idx);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 705,
          "old_api": "RowIsValidUnsafe",
          "new_api": null,
          "old_text": "order_mask.RowIsValidUnsafe(row_idx)",
          "new_text": null,
          "old_line_content": "\t\tbounds.is_peer = !order_mask.RowIsValidUnsafe(row_idx);",
          "new_line_content": "\t// RANGE sorting parameters",
          "content_same": false
        },
        {
          "line": 1216,
          "old_api": "Merge",
          "new_api": null,
          "old_text": "state.window_results.Merge(output)",
          "new_text": null,
          "old_line_content": "\t\tstate.window_results.Merge(output);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1220,
          "old_api": "size",
          "new_api": null,
          "old_text": "gstate.counts.size()",
          "new_text": null,
          "old_line_content": "\t\tconst auto hash_mask = hash_t(gstate.counts.size() - 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 716,
          "old_api": "FindNextStart",
          "new_api": null,
          "old_text": "FindNextStart(partition_mask, bounds.partition_start + 1, input_size, n)",
          "new_text": null,
          "old_line_content": "\t\t\t\tbounds.partition_end = FindNextStart(partition_mask, bounds.partition_start + 1, input_size, n);",
          "new_line_content": "\t\t\tbounds.partition_start = row_idx;",
          "content_same": false
        },
        {
          "line": 1230,
          "old_api": "ComputeWindowExpressions",
          "new_api": null,
          "old_text": "ComputeWindowExpressions(window_exprs, input, output, over, gstate.mode)",
          "new_text": null,
          "old_line_content": "\t\tComputeWindowExpressions(window_exprs, input, output, over, gstate.mode);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1231,
          "old_api": "Merge",
          "new_api": null,
          "old_text": "state.chunks.Merge(input)",
          "new_text": null,
          "old_line_content": "\t\tstate.chunks.Merge(input);",
          "new_line_content": "\t\t// Scan the sorted data into new Collections",
          "content_same": false
        },
        {
          "line": 1232,
          "old_api": "Merge",
          "new_api": null,
          "old_text": "state.window_results.Merge(output)",
          "new_text": null,
          "old_line_content": "\t\tstate.window_results.Merge(output);",
          "new_line_content": "\t\tChunkCollection input;",
          "content_same": false
        },
        {
          "line": 726,
          "old_api": "CellIsNull",
          "new_api": null,
          "old_text": "CellIsNull(over_collection, order_col, bounds.valid_start)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (CellIsNull(over_collection, order_col, bounds.valid_start)) {",
          "new_line_content": "\t\t\t// Find valid ordering values for the new partition",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "FindNextStart",
          "new_api": null,
          "old_text": "FindNextStart(order_mask, bounds.valid_start + 1, bounds.valid_end, n)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tbounds.valid_start = FindNextStart(order_mask, bounds.valid_start + 1, bounds.valid_end, n);",
          "new_line_content": "\t\t\tbounds.valid_start = bounds.partition_start;",
          "content_same": false
        },
        {
          "line": 1240,
          "old_api": "Count",
          "new_api": null,
          "old_text": "big_data.Count()",
          "new_text": null,
          "old_line_content": "\tif (state.position >= big_data.Count()) {",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1245,
          "old_api": "GetChunkForRow",
          "new_api": null,
          "old_text": "big_data.GetChunkForRow(state.position)",
          "new_text": null,
          "old_line_content": "\tauto &proj_ch = big_data.GetChunkForRow(state.position);",
          "new_line_content": "\tChunkCollection &window_results = state.window_results;",
          "content_same": false
        },
        {
          "line": 734,
          "old_api": "CellIsNull",
          "new_api": null,
          "old_text": "CellIsNull(over_collection, order_col, bounds.valid_end - 1)",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (CellIsNull(over_collection, order_col, bounds.valid_end - 1)) {",
          "new_line_content": "\t\t\t\t\tidx_t n = 1;",
          "content_same": false
        },
        {
          "line": 1246,
          "old_api": "GetChunkForRow",
          "new_api": null,
          "old_text": "window_results.GetChunkForRow(state.position)",
          "new_text": null,
          "old_line_content": "\tauto &wind_ch = window_results.GetChunkForRow(state.position);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 736,
          "old_api": "FindPrevStart",
          "new_api": null,
          "old_text": "FindPrevStart(order_mask, bounds.valid_start, bounds.valid_end, n)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tbounds.valid_end = FindPrevStart(order_mask, bounds.valid_start, bounds.valid_end, n);",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 1249,
          "old_api": "size",
          "new_api": null,
          "old_text": "wind_ch.size()",
          "new_text": null,
          "old_line_content": "\tD_ASSERT(proj_ch.size() == wind_ch.size());",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1250,
          "old_api": "SetCardinality",
          "new_api": null,
          "old_text": "chunk.SetCardinality(proj_ch)",
          "new_text": null,
          "old_line_content": "\tchunk.SetCardinality(proj_ch);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1251,
          "old_api": "ColumnCount",
          "new_api": null,
          "old_text": "proj_ch.ColumnCount()",
          "new_text": null,
          "old_line_content": "\tfor (idx_t col_idx = 0; col_idx < proj_ch.ColumnCount(); col_idx++) {",
          "new_line_content": "\t// just return what was computed before, appending the result cols of the window expressions at the end",
          "content_same": false
        },
        {
          "line": 1254,
          "old_api": "ColumnCount",
          "new_api": null,
          "old_text": "wind_ch.ColumnCount()",
          "new_text": null,
          "old_line_content": "\tfor (idx_t col_idx = 0; col_idx < wind_ch.ColumnCount(); col_idx++) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1255,
          "old_api": "Reference",
          "new_api": null,
          "old_text": "chunk.data[out_idx++].Reference(wind_ch.data[col_idx])",
          "new_text": null,
          "old_line_content": "\t\tchunk.data[out_idx++].Reference(wind_ch.data[col_idx]);",
          "new_line_content": "\tidx_t out_idx = 0;",
          "content_same": false
        },
        {
          "line": 748,
          "old_api": "FindNextStart",
          "new_api": null,
          "old_text": "FindNextStart(order_mask, bounds.peer_start + 1, bounds.partition_end, n)",
          "new_text": null,
          "old_line_content": "\t\t\t\tbounds.peer_end = FindNextStart(order_mask, bounds.peer_start + 1, bounds.partition_end, n);",
          "new_line_content": "\t\t\tbounds.peer_start = row_idx;",
          "content_same": false
        },
        {
          "line": 1265,
          "old_api": "Append",
          "new_api": null,
          "old_text": "lstate.chunks.Append(input)",
          "new_text": null,
          "old_line_content": "\tlstate.chunks.Append(input);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1269,
          "old_api": "get",
          "new_api": null,
          "old_text": "select_list[over_idx].get()",
          "new_text": null,
          "old_line_content": "\tauto over_expr = reinterpret_cast<BoundWindowExpression *>(select_list[over_idx].get());",
          "new_line_content": "SinkResultType PhysicalWindow::Sink(ExecutionContext &context, GlobalSinkState &state, LocalSinkState &lstate_p,",
          "content_same": false
        },
        {
          "line": 1271,
          "old_api": "size",
          "new_api": null,
          "old_text": "over_expr->orders.size()",
          "new_text": null,
          "old_line_content": "\tconst auto sort_col_count = over_expr->partitions.size() + over_expr->orders.size();",
          "new_line_content": "\tauto &lstate = (WindowLocalState &)lstate_p;",
          "content_same": false
        },
        {
          "line": 1274,
          "old_api": "MaterializeOverForWindow",
          "new_api": null,
          "old_text": "MaterializeOverForWindow(over_expr, input, over_chunk)",
          "new_text": null,
          "old_line_content": "\t\tMaterializeOverForWindow(over_expr, input, over_chunk);",
          "new_line_content": "\t// Compute the over columns and the hash values for this block (if any)",
          "content_same": false
        },
        {
          "line": 1277,
          "old_api": "empty",
          "new_api": null,
          "old_text": "lstate.counts.empty()",
          "new_text": null,
          "old_line_content": "\t\t\tif (lstate.counts.empty()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1282,
          "old_api": "size",
          "new_api": null,
          "old_text": "over_expr->partitions.size()",
          "new_text": null,
          "old_line_content": "\t\t\tHashChunk(lstate.counts, hash_chunk, over_chunk, over_expr->partitions.size());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 775,
          "old_api": "GetCell<int64_t>(boundary_start_collection, 0, bounds.scalar_start ? 0 : row_idx)",
          "new_api": null,
          "old_text": "GetCell<int64_t>(boundary_start_collection, 0, bounds.scalar_start ? 0 : row_idx)",
          "new_text": null,
          "old_line_content": "\t\t    (int64_t)row_idx - GetCell<int64_t>(boundary_start_collection, 0, bounds.scalar_start ? 0 : row_idx);",
          "new_line_content": "\t\tbounds.window_start = row_idx;",
          "content_same": false
        },
        {
          "line": 1287,
          "old_api": "Append",
          "new_api": null,
          "old_text": "lstate.over_collection.Append(over_chunk)",
          "new_text": null,
          "old_line_content": "\t\tlstate.over_collection.Append(over_chunk);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1288,
          "old_api": "Count",
          "new_api": null,
          "old_text": "lstate.over_collection.Count()",
          "new_text": null,
          "old_line_content": "\t\tD_ASSERT(lstate.chunks.Count() == lstate.over_collection.Count());",
          "new_line_content": "\t\t\tDataChunk hash_chunk;",
          "content_same": false
        },
        {
          "line": 780,
          "old_api": "GetCell<int64_t>(boundary_start_collection, 0, bounds.scalar_start ? 0 : row_idx)",
          "new_api": null,
          "old_text": "GetCell<int64_t>(boundary_start_collection, 0, bounds.scalar_start ? 0 : row_idx)",
          "new_text": null,
          "old_line_content": "\t\t    row_idx + GetCell<int64_t>(boundary_start_collection, 0, bounds.scalar_start ? 0 : row_idx);",
          "new_line_content": "\tcase WindowBoundary::EXPR_PRECEDING_ROWS: {",
          "content_same": false
        },
        {
          "line": 785,
          "old_api": "CellIsNull",
          "new_api": null,
          "old_text": "CellIsNull(boundary_start_collection, 0, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\tif (CellIsNull(boundary_start_collection, 0, expr_idx)) {",
          "new_line_content": "\tcase WindowBoundary::EXPR_FOLLOWING_ROWS: {",
          "content_same": false
        },
        {
          "line": 1300,
          "old_api": "Merge",
          "new_api": null,
          "old_text": "gstate.chunks.Merge(lstate.chunks)",
          "new_text": null,
          "old_line_content": "\tgstate.chunks.Merge(lstate.chunks);",
          "new_line_content": "void PhysicalWindow::Combine(ExecutionContext &context, GlobalSinkState &gstate_p, LocalSinkState &lstate_p) const {",
          "content_same": false
        },
        {
          "line": 789,
          "old_api": "FindOrderedRangeBound<true>(over_collection, order_col, bounds.range_sense, bounds.valid_start, row_idx,\n\t\t\t                                boundary_start_collection, expr_idx)",
          "new_api": null,
          "old_text": "FindOrderedRangeBound<true>(over_collection, order_col, bounds.range_sense, bounds.valid_start, row_idx,\n\t\t\t                                boundary_start_collection, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\t\t    FindOrderedRangeBound<true>(over_collection, order_col, bounds.range_sense, bounds.valid_start, row_idx,",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1301,
          "old_api": "Merge",
          "new_api": null,
          "old_text": "gstate.over_collection.Merge(lstate.over_collection)",
          "new_text": null,
          "old_line_content": "\tgstate.over_collection.Merge(lstate.over_collection);",
          "new_line_content": "\tauto &lstate = (WindowLocalState &)lstate_p;",
          "content_same": false
        },
        {
          "line": 1303,
          "old_api": "empty",
          "new_api": null,
          "old_text": "gstate.counts.empty()",
          "new_text": null,
          "old_line_content": "\tif (gstate.counts.empty()) {",
          "new_line_content": "\t\treturn;",
          "content_same": false
        },
        {
          "line": 1306,
          "old_api": "size",
          "new_api": null,
          "old_text": "lstate.counts.size()",
          "new_text": null,
          "old_line_content": "\t\tD_ASSERT(gstate.counts.size() == lstate.counts.size());",
          "new_line_content": "\tlock_guard<mutex> glock(gstate.lock);",
          "content_same": false
        },
        {
          "line": 799,
          "old_api": "FindOrderedRangeBound<true>(over_collection, order_col, bounds.range_sense, row_idx,\n\t\t\t                                                  bounds.valid_end, boundary_start_collection, expr_idx)",
          "new_api": null,
          "old_text": "FindOrderedRangeBound<true>(over_collection, order_col, bounds.range_sense, row_idx,\n\t\t\t                                                  bounds.valid_end, boundary_start_collection, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\t\tbounds.window_start = FindOrderedRangeBound<true>(over_collection, order_col, bounds.range_sense, row_idx,",
          "new_line_content": "\t\tbreak;",
          "content_same": false
        },
        {
          "line": 805,
          "old_api": "InternalException",
          "new_api": null,
          "old_text": "InternalException(\"Unsupported window start boundary\")",
          "new_text": null,
          "old_line_content": "\t\tthrow InternalException(\"Unsupported window start boundary\");",
          "new_line_content": "\t\t} else {",
          "content_same": false
        },
        {
          "line": 1318,
          "old_api": "make_unique<WindowGlobalState>(*this, context)",
          "new_api": null,
          "old_text": "make_unique<WindowGlobalState>(*this, context)",
          "new_text": null,
          "old_line_content": "\treturn make_unique<WindowGlobalState>(*this, context);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 1326,
          "old_api": "explicit",
          "new_api": null,
          "old_text": "explicit",
          "new_text": null,
          "old_line_content": "\texplicit WindowGlobalSourceState(const PhysicalWindow &op) : op(op), next_part(0) {",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 820,
          "old_api": "GetCell<int64_t>(boundary_end_collection, 0, bounds.scalar_end ? 0 : row_idx)",
          "new_api": null,
          "old_text": "GetCell<int64_t>(boundary_end_collection, 0, bounds.scalar_end ? 0 : row_idx)",
          "new_text": null,
          "old_line_content": "\t\t    (int64_t)row_idx - GetCell<int64_t>(boundary_end_collection, 0, bounds.scalar_end ? 0 : row_idx) + 1;",
          "new_line_content": "\t\tbounds.window_end = bounds.peer_end;",
          "content_same": false
        },
        {
          "line": 823,
          "old_api": "GetCell<int64_t>(boundary_end_collection, 0, bounds.scalar_end ? 0 : row_idx)",
          "new_api": null,
          "old_text": "GetCell<int64_t>(boundary_end_collection, 0, bounds.scalar_end ? 0 : row_idx)",
          "new_text": null,
          "old_line_content": "\t\tbounds.window_end = row_idx + GetCell<int64_t>(boundary_end_collection, 0, bounds.scalar_end ? 0 : row_idx) + 1;",
          "new_line_content": "\t\tbounds.window_end = bounds.partition_end;",
          "content_same": false
        },
        {
          "line": 1338,
          "old_api": "empty",
          "new_api": null,
          "old_text": "state.counts.empty()",
          "new_text": null,
          "old_line_content": "\t\tif (state.counts.empty()) {",
          "new_line_content": "\tatomic<idx_t> next_part;",
          "content_same": false
        },
        {
          "line": 831,
          "old_api": "FindOrderedRangeBound<false>(over_collection, order_col, bounds.range_sense, bounds.valid_start,\n\t\t\t                                 row_idx, boundary_end_collection, expr_idx)",
          "new_api": null,
          "old_text": "FindOrderedRangeBound<false>(over_collection, order_col, bounds.range_sense, bounds.valid_start,\n\t\t\t                                 row_idx, boundary_end_collection, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\t\t    FindOrderedRangeBound<false>(over_collection, order_col, bounds.range_sense, bounds.valid_start,",
          "new_line_content": "\t\tbreak;",
          "content_same": false
        },
        {
          "line": 841,
          "old_api": "FindOrderedRangeBound<false>(over_collection, order_col, bounds.range_sense, row_idx,\n\t\t\t                                                 bounds.valid_end, boundary_end_collection, expr_idx)",
          "new_api": null,
          "old_text": "FindOrderedRangeBound<false>(over_collection, order_col, bounds.range_sense, row_idx,\n\t\t\t                                                 bounds.valid_end, boundary_end_collection, expr_idx)",
          "new_text": null,
          "old_line_content": "\t\t\tbounds.window_end = FindOrderedRangeBound<false>(over_collection, order_col, bounds.range_sense, row_idx,",
          "new_line_content": "\t\tbreak;",
          "content_same": false
        },
        {
          "line": 1355,
          "old_api": "make_unique<WindowOperatorState>(*this, context)",
          "new_api": null,
          "old_text": "make_unique<WindowOperatorState>(*this, context)",
          "new_text": null,
          "old_line_content": "\treturn make_unique<WindowOperatorState>(*this, context);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 847,
          "old_api": "InternalException",
          "new_api": null,
          "old_text": "InternalException(\"Unsupported window end boundary\")",
          "new_text": null,
          "old_line_content": "\t\tthrow InternalException(\"Unsupported window end boundary\");",
          "new_line_content": "\t\t} else {",
          "content_same": false
        },
        {
          "line": 1359,
          "old_api": "make_unique<WindowGlobalSourceState>(*this)",
          "new_api": null,
          "old_text": "make_unique<WindowGlobalSourceState>(*this)",
          "new_text": null,
          "old_line_content": "\treturn make_unique<WindowGlobalSourceState>(*this);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 342,
          "old_api": "Fuse",
          "new_api": null,
          "old_text": "payload.Fuse(over)",
          "new_text": null,
          "old_line_content": "\tpayload.Fuse(over);",
          "new_line_content": "\tDataChunk payload_chunk;",
          "content_same": false
        },
        {
          "line": 1369,
          "old_api": "Count",
          "new_api": null,
          "old_text": "state.chunks.Count()",
          "new_text": null,
          "old_line_content": "\t\tif (state.position >= state.chunks.Count()) {",
          "new_line_content": "void PhysicalWindow::GetData(ExecutionContext &context, DataChunk &chunk, GlobalSourceState &gstate_p,",
          "content_same": false
        },
        {
          "line": 865,
          "old_api": "InternalException",
          "new_api": null,
          "old_text": "InternalException(\"Failed to compute window boundaries\")",
          "new_text": null,
          "old_line_content": "\t\tthrow InternalException(\"Failed to compute window boundaries\");",
          "new_line_content": "\t\tbounds.window_end = bounds.partition_start;",
          "content_same": false
        },
        {
          "line": 1378,
          "old_api": "Scan",
          "new_api": null,
          "old_text": "Scan(state, chunk)",
          "new_text": null,
          "old_line_content": "\t\tScan(state, chunk);",
          "new_line_content": "\t\t\tfor (; hash_bin < state.partitions; hash_bin = global_source.next_part++) {",
          "content_same": false
        },
        {
          "line": 1379,
          "old_api": "size",
          "new_api": null,
          "old_text": "chunk.size()",
          "new_text": null,
          "old_line_content": "\t\tif (chunk.size() != 0) {",
          "new_line_content": "\t\t\t\tif (gstate.counts[hash_bin] > 0) {",
          "content_same": false
        },
        {
          "line": 1390,
          "old_api": "size",
          "new_api": null,
          "old_text": "select_list.size()",
          "new_text": null,
          "old_line_content": "\tfor (idx_t i = 0; i < select_list.size(); i++) {",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 879,
          "old_api": "get",
          "new_api": null,
          "old_text": "child.get()",
          "new_text": null,
          "old_line_content": "\t\texprs.push_back(child.get());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 882,
          "old_api": "size",
          "new_api": null,
          "old_text": "exprs.size()",
          "new_text": null,
          "old_line_content": "\tMaterializeExpressions(exprs.data(), exprs.size(), input, payload_collection);",
          "new_line_content": "\t// evaluate inner expressions of window functions, could be more complex",
          "content_same": false
        },
        {
          "line": 1394,
          "old_api": "GetName",
          "new_api": null,
          "old_text": "select_list[i]->GetName()",
          "new_text": null,
          "old_line_content": "\t\tresult += select_list[i]->GetName();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 376,
          "old_api": "FlatVector::GetData<hash_t>(hash_chunk.data[0])",
          "new_api": null,
          "old_text": "FlatVector::GetData<hash_t>(hash_chunk.data[0])",
          "new_text": null,
          "old_line_content": "\t\t\tauto hash_data = FlatVector::GetData<hash_t>(hash_chunk.data[0]);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 888,
          "old_api": "get",
          "new_api": null,
          "old_text": "wexpr->offset_expr.get()",
          "new_text": null,
          "old_line_content": "\t\t\tMaterializeExpression(wexpr->offset_expr.get(), input, leadlag_offset_collection,",
          "new_line_content": "\t// TODO: child may be a scalar, don't need to materialize the whole collection then",
          "content_same": false
        },
        {
          "line": 380,
          "old_api": "set_index",
          "new_api": null,
          "old_text": "sel.set_index(bin_size++, i)",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tsel.set_index(bin_size++, i);",
          "new_line_content": "\t\tif (hashes) {",
          "content_same": false
        },
        {
          "line": 892,
          "old_api": "get",
          "new_api": null,
          "old_text": "wexpr->default_expr.get()",
          "new_text": null,
          "old_line_content": "\t\t\tMaterializeExpression(wexpr->default_expr.get(), input, leadlag_default_collection,",
          "new_line_content": "\tChunkCollection leadlag_default_collection;",
          "content_same": false
        },
        {
          "line": 893,
          "old_api": "IsScalar",
          "new_api": null,
          "old_text": "wexpr->default_expr->IsScalar()",
          "new_text": null,
          "old_line_content": "\t\t\t                      wexpr->default_expr->IsScalar());",
          "new_line_content": "\tif (wexpr->type == ExpressionType::WINDOW_LEAD || wexpr->type == ExpressionType::WINDOW_LAG) {",
          "content_same": false
        },
        {
          "line": 385,
          "old_api": "size",
          "new_api": null,
          "old_text": "over_partition.size()",
          "new_text": null,
          "old_line_content": "\t\t\tif (over_partition.size() + bin_size > STANDARD_VECTOR_SIZE) {",
          "new_line_content": "\t\t\tfor (idx_t i = 0; i < hash_size; ++i) {",
          "content_same": false
        },
        {
          "line": 386,
          "old_api": "SinkChunk",
          "new_api": null,
          "old_text": "local_sort_state.SinkChunk(over_partition, payload_partition)",
          "new_text": null,
          "old_line_content": "\t\t\t\tlocal_sort_state.SinkChunk(over_partition, payload_partition);",
          "new_line_content": "\t\t\t\tif ((hash_data[i] & hash_mask) == hash_bin) {",
          "content_same": false
        },
        {
          "line": 388,
          "old_api": "Reset",
          "new_api": null,
          "old_text": "payload_partition.Reset()",
          "new_text": null,
          "old_line_content": "\t\t\t\tpayload_partition.Reset();",
          "new_line_content": "\t\t\t\t}",
          "content_same": false
        },
        {
          "line": 905,
          "old_api": "IsScalar",
          "new_api": null,
          "old_text": "wexpr->end_expr->IsScalar()",
          "new_text": null,
          "old_line_content": "\t\tMaterializeExpression(wexpr->end_expr.get(), input, boundary_end_collection, wexpr->end_expr->IsScalar());",
          "new_line_content": "\tChunkCollection boundary_start_collection;",
          "content_same": false
        },
        {
          "line": 397,
          "old_api": "SinkChunk",
          "new_api": null,
          "old_text": "local_sort_state.SinkChunk(over_chunk, payload_chunk)",
          "new_text": null,
          "old_line_content": "\t\t\tlocal_sort_state.SinkChunk(over_chunk, payload_chunk);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 402,
          "old_api": "size",
          "new_api": null,
          "old_text": "over_partition.size()",
          "new_text": null,
          "old_line_content": "\tif (over_partition.size() > 0) {",
          "new_line_content": "\t\t\t}",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": "SinkChunk",
          "new_api": null,
          "old_text": "local_sort_state.SinkChunk(over_partition, payload_partition)",
          "new_text": null,
          "old_line_content": "\t\tlocal_sort_state.SinkChunk(over_partition, payload_partition);",
          "new_line_content": "\t\t} else {",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": "Reset",
          "new_api": null,
          "old_text": "payload_partition.Reset()",
          "new_text": null,
          "old_line_content": "\t\tpayload_partition.Reset();",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 918,
          "old_api": "Chunks",
          "new_api": null,
          "old_text": "payload_collection.Chunks()",
          "new_text": null,
          "old_line_content": "\t\t\tfor (auto &chunk : payload_collection.Chunks()) {",
          "new_line_content": "\t\tswitch (wexpr->type) {",
          "content_same": false
        },
        {
          "line": 919,
          "old_api": "size",
          "new_api": null,
          "old_text": "chunk->size()",
          "new_text": null,
          "old_line_content": "\t\t\t\tconst auto count = chunk->size();",
          "new_line_content": "\t\tcase ExpressionType::WINDOW_LEAD:",
          "content_same": false
        },
        {
          "line": 921,
          "old_api": "Orrify",
          "new_api": null,
          "old_text": "chunk->data[0].Orrify(count, vdata)",
          "new_text": null,
          "old_line_content": "\t\t\t\tchunk->data[0].Orrify(count, vdata);",
          "new_line_content": "\t\tcase ExpressionType::WINDOW_FIRST_VALUE:",
          "content_same": false
        },
        {
          "line": 922,
          "old_api": "AllValid",
          "new_api": null,
          "old_text": "vdata.validity.AllValid()",
          "new_text": null,
          "old_line_content": "\t\t\t\tif (!vdata.validity.AllValid()) {",
          "new_line_content": "\t\tcase ExpressionType::WINDOW_LAST_VALUE:",
          "content_same": false
        },
        {
          "line": 924,
          "old_api": "AllValid",
          "new_api": null,
          "old_text": "ignore_nulls.AllValid()",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tif (ignore_nulls.AllValid()) {",
          "new_line_content": "\t\t\tidx_t pos = 0;",
          "content_same": false
        },
        {
          "line": 415,
          "old_api": "AddLocalState",
          "new_api": null,
          "old_text": "global_sort_state.AddLocalState(local_sort_state)",
          "new_text": null,
          "old_line_content": "\tglobal_sort_state.AddLocalState(local_sort_state);",
          "new_line_content": "\t// If there are no hashes, release the input to save memory.",
          "content_same": false
        },
        {
          "line": 930,
          "old_api": "GetData",
          "new_api": null,
          "old_text": "vdata.validity.GetData()",
          "new_text": null,
          "old_line_content": "\t\t\t\t\tauto src = vdata.validity.GetData();",
          "new_line_content": "\t\t\t\t\t//\tLazily materialise the contents when we find the first NULL",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": "end",
          "new_api": null,
          "old_text": "over_types.end()",
          "new_text": null,
          "old_line_content": "\tpayload_types.insert(payload_types.end(), over_types.begin(), over_types.end());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": "Initialize",
          "new_api": null,
          "old_text": "payload_chunk.Initialize(payload_types)",
          "new_text": null,
          "old_line_content": "\t\tpayload_chunk.Initialize(payload_types);",
          "new_line_content": "\tauto payload_types = input_types;",
          "content_same": false
        },
        {
          "line": 434,
          "old_api": "Scan",
          "new_api": null,
          "old_text": "scanner.Scan(payload_chunk)",
          "new_text": null,
          "old_line_content": "\t\tscanner.Scan(payload_chunk);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": "size",
          "new_api": null,
          "old_text": "payload_chunk.size()",
          "new_text": null,
          "old_line_content": "\t\tif (payload_chunk.size() == 0) {",
          "new_line_content": "\t// scan the sorted row data",
          "content_same": false
        },
        {
          "line": 949,
          "old_api": "get",
          "new_api": null,
          "old_text": "wexpr->bind_info.get()",
          "new_text": null,
          "old_line_content": "\t\tsegment_tree = make_unique<WindowSegmentTree>(*(wexpr->aggregate), wexpr->bind_info.get(), wexpr->return_type,",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": "Append",
          "new_api": null,
          "old_text": "input.Append(payload_chunk)",
          "new_text": null,
          "old_line_content": "\t\tinput.Append(payload_chunk);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": "Append",
          "new_api": null,
          "old_text": "over.Append(over_chunk)",
          "new_text": null,
          "old_line_content": "\t\tover.Append(over_chunk);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 959,
          "old_api": "Initialize",
          "new_api": null,
          "old_text": "output_chunk.Initialize(output_types)",
          "new_text": null,
          "old_line_content": "\toutput_chunk.Initialize(output_types);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 960,
          "old_api": "Count",
          "new_api": null,
          "old_text": "input.Count()",
          "new_text": null,
          "old_line_content": "\tfor (idx_t row_idx = 0; row_idx < input.Count(); row_idx++) {",
          "new_line_content": "\tWindowBoundariesState bounds(wexpr);",
          "content_same": false
        },
        {
          "line": 964,
          "old_api": "Append",
          "new_api": null,
          "old_text": "output.Append(output_chunk)",
          "new_text": null,
          "old_line_content": "\t\t\toutput.Append(output_chunk);",
          "new_line_content": "\tconst vector<LogicalType> output_types(1, wexpr->return_type);",
          "content_same": false
        },
        {
          "line": 965,
          "old_api": "Reset",
          "new_api": null,
          "old_text": "output_chunk.Reset()",
          "new_text": null,
          "old_line_content": "\t\t\toutput_chunk.Reset();",
          "new_line_content": "\tDataChunk output_chunk;",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": "size",
          "new_api": null,
          "old_text": "sort_chunk.size()",
          "new_text": null,
          "old_line_content": "\tconst auto count = sort_chunk.size();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": "VectorOperations::Hash(sort_chunk.data[0], hash_vector, count)",
          "new_api": null,
          "old_text": "VectorOperations::Hash(sort_chunk.data[0], hash_vector, count)",
          "new_text": null,
          "old_line_content": "\tVectorOperations::Hash(sort_chunk.data[0], hash_vector, count);",
          "new_line_content": "static void HashChunk(counts_t &counts, DataChunk &hash_chunk, DataChunk &sort_chunk, const idx_t partition_cols) {",
          "content_same": false
        },
        {
          "line": 461,
          "old_api": "size",
          "new_api": null,
          "old_text": "counts.size()",
          "new_text": null,
          "old_line_content": "\tconst auto partition_mask = hash_t(counts.size() - 1);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 988,
          "old_api": "FlatVector::SetNull(result, output_offset, true)",
          "new_api": null,
          "old_text": "FlatVector::SetNull(result, output_offset, true)",
          "new_text": null,
          "old_line_content": "\t\t\tFlatVector::SetNull(result, output_offset, true);",
          "new_line_content": "\t\t\t\trank_equal = 0;",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": "size",
          "new_api": null,
          "old_text": "wexpr->partitions.size()",
          "new_text": null,
          "old_line_content": "\tfor (idx_t prt_idx = 0; prt_idx < wexpr->partitions.size(); prt_idx++) {",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 481,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "over_types.push_back(pexpr->return_type)",
          "new_text": null,
          "old_line_content": "\t\tover_types.push_back(pexpr->return_type);",
          "new_line_content": "static void MaterializeOverForWindow(BoundWindowExpression *wexpr, DataChunk &input_chunk, DataChunk &over_chunk) {",
          "content_same": false
        },
        {
          "line": 482,
          "old_api": "AddExpression",
          "new_api": null,
          "old_text": "executor.AddExpression(*pexpr)",
          "new_text": null,
          "old_line_content": "\t\texecutor.AddExpression(*pexpr);",
          "new_line_content": "\tvector<LogicalType> over_types;",
          "content_same": false
        },
        {
          "line": 994,
          "old_api": "Compute",
          "new_api": null,
          "old_text": "segment_tree->Compute(result, output_offset, bounds.window_start, bounds.window_end)",
          "new_text": null,
          "old_line_content": "\t\t\tsegment_tree->Compute(result, output_offset, bounds.window_start, bounds.window_end);",
          "new_line_content": "\t\tif (bounds.window_start >= bounds.window_end) {",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": "size",
          "new_api": null,
          "old_text": "wexpr->orders.size()",
          "new_text": null,
          "old_line_content": "\tfor (idx_t ord_idx = 0; ord_idx < wexpr->orders.size(); ord_idx++) {",
          "new_line_content": "\t// we sort by both 1) partition by expression list and 2) order by expressions",
          "content_same": false
        },
        {
          "line": 998,
          "old_api": "FlatVector::GetData<int64_t>(result)",
          "new_api": null,
          "old_text": "FlatVector::GetData<int64_t>(result)",
          "new_text": null,
          "old_line_content": "\t\t\tauto rdata = FlatVector::GetData<int64_t>(result);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "over_types.push_back(oexpr->return_type)",
          "new_text": null,
          "old_line_content": "\t\tover_types.push_back(oexpr->return_type);",
          "new_line_content": "\t\tauto &pexpr = wexpr->partitions[prt_idx];",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": "empty",
          "new_api": null,
          "old_text": "over_types.empty()",
          "new_text": null,
          "old_line_content": "\tD_ASSERT(!over_types.empty());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1003,
          "old_api": "FlatVector::GetData<int64_t>(result)",
          "new_api": null,
          "old_text": "FlatVector::GetData<int64_t>(result)",
          "new_text": null,
          "old_line_content": "\t\t\tauto rdata = FlatVector::GetData<int64_t>(result);",
          "new_line_content": "\t\t}",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": "Initialize",
          "new_api": null,
          "old_text": "over_chunk.Initialize(over_types)",
          "new_text": null,
          "old_line_content": "\tover_chunk.Initialize(over_types);",
          "new_line_content": "\t\tauto &oexpr = wexpr->orders[ord_idx].expression;",
          "content_same": false
        },
        {
          "line": 496,
          "old_api": "Verify",
          "new_api": null,
          "old_text": "over_chunk.Verify()",
          "new_text": null,
          "old_line_content": "\tover_chunk.Verify();",
          "new_line_content": "\t}",
          "content_same": false
        },
        {
          "line": 1008,
          "old_api": "FlatVector::GetData<int64_t>(result)",
          "new_api": null,
          "old_text": "FlatVector::GetData<int64_t>(result)",
          "new_text": null,
          "old_line_content": "\t\t\tauto rdata = FlatVector::GetData<int64_t>(result);",
          "new_line_content": "\t\t}",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 65,
      "total_additions": 182,
      "total_deletions": 177,
      "total_api_changes": 424
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 12,
        "api_related_lines": 424,
        "non_api_lines": 2,
        "non_api_line_numbers": [
          369,
          372
        ]
      }
    },
    "api_calls_before": 393,
    "api_calls_after": 404,
    "diff_info": {
      "added_lines": 12,
      "removed_lines": 5,
      "total_diff_lines": 37
    }
  }
}