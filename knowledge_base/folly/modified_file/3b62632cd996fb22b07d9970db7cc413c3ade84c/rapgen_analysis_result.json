{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/folly/modified_file/3b62632cd996fb22b07d9970db7cc413c3ade84c",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/folly/modified_file/3b62632cd996fb22b07d9970db7cc413c3ade84c/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/folly/modified_file/3b62632cd996fb22b07d9970db7cc413c3ade84c/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/folly/modified_file/3b62632cd996fb22b07d9970db7cc413c3ade84c/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 686,
          "old_api": "DCHECK_EQ",
          "new_api": "PCHECK",
          "old_text": "DCHECK_EQ(found, pid_)",
          "new_text": "PCHECK(found != -1)",
          "old_line_content": "      DCHECK_EQ(found, pid_);",
          "new_line_content": "    PCHECK(found != -1) << \"waitpid(\" << pid_ << \", &status, WNOHANG)\";",
          "content_same": false
        },
        {
          "line": 703,
          "old_api": "enforce",
          "new_api": "std::min(maximumSleepDuration, sleepDuration + sleepDuration)",
          "old_text": "returnCode_.enforce(ProcessReturnCode::RUNNING)",
          "new_text": "std::min(maximumSleepDuration, sleepDuration + sleepDuration)",
          "old_line_content": "  returnCode_.enforce(ProcessReturnCode::RUNNING);",
          "new_line_content": "        std::min(maximumSleepDuration, sleepDuration + sleepDuration);",
          "content_same": false
        },
        {
          "line": 716,
          "old_api": "running",
          "new_api": "enforce",
          "old_text": "returnCode_.running()",
          "new_text": "returnCode_.enforce(ProcessReturnCode::RUNNING)",
          "old_line_content": "  if (returnCode_.running()) {",
          "new_line_content": "  returnCode_.enforce(ProcessReturnCode::RUNNING);",
          "content_same": false
        },
        {
          "line": 717,
          "old_api": "terminateOrKill",
          "new_api": "DCHECK_GT",
          "old_text": "terminateOrKill(sigtermTimeout)",
          "new_text": "DCHECK_GT(pid_, 0)",
          "old_line_content": "    return terminateOrKill(sigtermTimeout);",
          "new_line_content": "  DCHECK_GT(pid_, 0) << \"The subprocess has been waited already\";",
          "content_same": false
        },
        {
          "line": 728,
          "old_api": "waitTimeout",
          "new_api": "enforce",
          "old_text": "waitTimeout(sigtermTimeout)",
          "new_text": "returnCode_.enforce(ProcessReturnCode::RUNNING)",
          "old_line_content": "  waitTimeout(sigtermTimeout);",
          "new_line_content": "  returnCode_.enforce(ProcessReturnCode::RUNNING);",
          "content_same": false
        },
        {
          "line": 729,
          "old_api": "running",
          "new_api": "DCHECK_GT",
          "old_text": "returnCode_.running()",
          "new_text": "DCHECK_GT(pid_, 0)",
          "old_line_content": "  if (!returnCode_.running()) {",
          "new_line_content": "  DCHECK_GT(pid_, 0) << \"The subprocess has been waited already\";",
          "content_same": false
        },
        {
          "line": 740,
          "old_api": "wait",
          "new_api": "LOG",
          "old_text": "wait()",
          "new_text": "LOG(INFO)",
          "old_line_content": "  return wait();",
          "new_line_content": "  LOG(INFO) << \"Send SIGKILL to \" << pid_;",
          "content_same": false
        },
        {
          "line": 765,
          "old_api": "size",
          "new_api": "queueFront",
          "old_text": "b.size()",
          "new_text": "queueFront(queue)",
          "old_line_content": "    ssize_t n = writeNoInt(fd, b.data(), b.size());",
          "new_line_content": "    auto b = queueFront(queue);",
          "content_same": false
        },
        {
          "line": 770,
          "old_api": "trimStart",
          "new_api": "size",
          "old_text": "queue.trimStart(n)",
          "new_text": "b.size()",
          "old_line_content": "    queue.trimStart(n);",
          "new_line_content": "    ssize_t n = writeNoInt(fd, b.data(), b.size());",
          "content_same": false
        },
        {
          "line": 782,
          "old_api": "checkUnixError",
          "new_api": "preallocate",
          "old_text": "checkUnixError(n, \"read\")",
          "new_text": "queue.preallocate(100, 65000)",
          "old_line_content": "    checkUnixError(n, \"read\");",
          "new_line_content": "    auto p = queue.preallocate(100, 65000);",
          "content_same": false
        },
        {
          "line": 818,
          "old_api": "coalesce",
          "new_api": "std::move(inputQueue)",
          "old_text": "outBufs.first->coalesce()",
          "new_text": "std::move(inputQueue)",
          "old_line_content": "    outBufs.first->coalesce();",
          "new_line_content": "  auto outQueues = communicateIOBuf(std::move(inputQueue));",
          "content_same": false
        },
        {
          "line": 820,
          "old_api": "data",
          "new_api": "move",
          "old_text": "outBufs.first->data()",
          "new_text": "outQueues.second.move()",
          "old_line_content": "        reinterpret_cast<const char*>(outBufs.first->data()),",
          "new_line_content": "      std::make_pair(outQueues.first.move(), outQueues.second.move());",
          "content_same": false
        },
        {
          "line": 824,
          "old_api": "coalesce",
          "new_api": "assign",
          "old_text": "outBufs.second->coalesce()",
          "new_text": "out.first.assign(\n        reinterpret_cast<const char*>(outBufs.first->data()),\n        outBufs.first->length())",
          "old_line_content": "    outBufs.second->coalesce();",
          "new_line_content": "    out.first.assign(",
          "content_same": false
        },
        {
          "line": 825,
          "old_api": "assign",
          "new_api": "data",
          "old_text": "out.second.assign(\n        reinterpret_cast<const char*>(outBufs.second->data()),\n        outBufs.second->length())",
          "new_text": "outBufs.first->data()",
          "old_line_content": "    out.second.assign(",
          "new_line_content": "        reinterpret_cast<const char*>(outBufs.first->data()),",
          "content_same": false
        },
        {
          "line": 826,
          "old_api": "data",
          "new_api": "length",
          "old_text": "outBufs.second->data()",
          "new_text": "outBufs.first->length()",
          "old_line_content": "        reinterpret_cast<const char*>(outBufs.second->data()),",
          "new_line_content": "        outBufs.first->length());",
          "content_same": false
        },
        {
          "line": 881,
          "old_api": "size",
          "new_api": "setAllNonBlocking",
          "old_text": "pipes_.size()",
          "new_text": "setAllNonBlocking()",
          "old_line_content": "  toClose.reserve(pipes_.size());",
          "new_line_content": "  setAllNonBlocking();",
          "content_same": false
        },
        {
          "line": 884,
          "old_api": "clear",
          "new_api": "size",
          "old_text": "fds.clear()",
          "new_text": "pipes_.size()",
          "old_line_content": "    fds.clear();",
          "new_line_content": "  fds.reserve(pipes_.size());",
          "content_same": false
        },
        {
          "line": 889,
          "old_api": "fd",
          "new_api": "clear",
          "old_text": "p.pipe.fd()",
          "new_text": "fds.clear()",
          "old_line_content": "      pfd.fd = p.pipe.fd();",
          "new_line_content": "    fds.clear();",
          "content_same": false
        },
        {
          "line": 906,
          "old_api": "size",
          "new_api": "push_back",
          "old_text": "fds.size()",
          "new_text": "fds.push_back(pfd)",
          "old_line_content": "      r = ::poll(fds.data(), fds.size(), -1);",
          "new_line_content": "      fds.push_back(pfd);",
          "content_same": false
        },
        {
          "line": 913,
          "old_api": "DCHECK_EQ",
          "new_api": "checkUnixError",
          "old_text": "DCHECK_EQ(fds[i].fd, parentFd)",
          "new_text": "checkUnixError(r, \"poll\")",
          "old_line_content": "      DCHECK_EQ(fds[i].fd, parentFd);",
          "new_line_content": "    checkUnixError(r, \"poll\");",
          "content_same": false
        },
        {
          "line": 918,
          "old_api": "DCHECK",
          "new_api": "DCHECK_EQ",
          "old_text": "DCHECK(!(events & POLLIN))",
          "new_text": "DCHECK_EQ(fds[i].fd, parentFd)",
          "old_line_content": "        DCHECK(!(events & POLLIN));",
          "new_line_content": "      DCHECK_EQ(fds[i].fd, parentFd);",
          "content_same": false
        },
        {
          "line": 960,
          "old_api": "end",
          "new_api": "findByChildFd",
          "old_text": "pipes_.end()",
          "new_text": "findByChildFd(childFd)",
          "old_line_content": "      pipes_.begin(), pipes_.end(), childFd, [](const Pipe& pipe, int fd) {",
          "new_line_content": "  return pipes_[findByChildFd(childFd)].enabled;",
          "content_same": false
        },
        {
          "line": 964,
          "old_api": "std::invalid_argument(\n        folly::to<std::string>(\"child fd not found \", childFd))",
          "new_api": "begin",
          "old_text": "std::invalid_argument(\n        folly::to<std::string>(\"child fd not found \", childFd))",
          "new_text": "std::lower_bound(\n      pipes_.begin(), pipes_.end(), childFd, [](const Pipe& pipe, int fd) {\n        return pipe.childFd < fd;\n      })",
          "old_line_content": "    throw std::invalid_argument(",
          "new_line_content": "  auto pos = std::lower_bound(",
          "content_same": false
        },
        {
          "line": 965,
          "old_api": "folly::to<std::string>(\"child fd not found \", childFd)",
          "new_api": "end",
          "old_text": "folly::to<std::string>(\"child fd not found \", childFd)",
          "new_text": "pipes_.end()",
          "old_line_content": "        folly::to<std::string>(\"child fd not found \", childFd));",
          "new_line_content": "      pipes_.begin(), pipes_.end(), childFd, [](const Pipe& pipe, int fd) {",
          "content_same": false
        },
        {
          "line": 972,
          "old_api": "close",
          "new_api": "begin",
          "old_text": "pipes_[idx].pipe.close()",
          "new_text": "pipes_.begin()",
          "old_line_content": "  pipes_[idx].pipe.close(); // May throw",
          "new_line_content": "  return pos - pipes_.begin();",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 774,
          "old_api": null,
          "new_api": "checkUnixError",
          "old_text": null,
          "new_text": "checkUnixError(n, \"write\")",
          "old_line_content": "// fd read",
          "new_line_content": "    checkUnixError(n, \"write\");",
          "content_same": false
        },
        {
          "line": 775,
          "old_api": null,
          "new_api": "trimStart",
          "old_text": null,
          "new_text": "queue.trimStart(n)",
          "old_line_content": "bool handleRead(int fd, IOBufQueue& queue) {",
          "new_line_content": "    queue.trimStart(n);",
          "content_same": false
        },
        {
          "line": 783,
          "old_api": null,
          "new_api": "readNoInt",
          "old_text": null,
          "new_text": "readNoInt(fd, p.first, p.second)",
          "old_line_content": "    if (n == 0) {",
          "new_line_content": "    ssize_t n = readNoInt(fd, p.first, p.second);",
          "content_same": false
        },
        {
          "line": 911,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "fds.size()",
          "old_line_content": "      auto& p = pipes_[i];",
          "new_line_content": "      r = ::poll(fds.data(), fds.size(), -1);",
          "content_same": false
        },
        {
          "line": 894,
          "old_api": null,
          "new_api": "fd",
          "old_text": null,
          "new_text": "p.pipe.fd()",
          "old_line_content": "        // POLLERR",
          "new_line_content": "      pfd.fd = p.pipe.fd();",
          "content_same": false
        },
        {
          "line": 787,
          "old_api": null,
          "new_api": "checkUnixError",
          "old_text": null,
          "new_text": "checkUnixError(n, \"read\")",
          "old_line_content": "  }",
          "new_line_content": "    checkUnixError(n, \"read\");",
          "content_same": false
        },
        {
          "line": 915,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "pipes_.size()",
          "old_line_content": "",
          "new_line_content": "    for (size_t i = 0; i < pipes_.size(); ++i) {",
          "content_same": false
        },
        {
          "line": 917,
          "old_api": null,
          "new_api": "fd",
          "old_text": null,
          "new_text": "p.pipe.fd()",
          "old_line_content": "      if (events & POLLOUT) {",
          "new_line_content": "      auto parentFd = p.pipe.fd();",
          "content_same": false
        },
        {
          "line": 791,
          "old_api": null,
          "new_api": "postallocate",
          "old_text": null,
          "new_text": "queue.postallocate(n)",
          "old_line_content": "  static const size_t bufSize = 65000;",
          "new_line_content": "    queue.postallocate(n);",
          "content_same": false
        },
        {
          "line": 923,
          "old_api": null,
          "new_api": "DCHECK",
          "old_text": null,
          "new_text": "DCHECK(!(events & POLLIN))",
          "old_line_content": "      }",
          "new_line_content": "        DCHECK(!(events & POLLIN));",
          "content_same": false
        },
        {
          "line": 924,
          "old_api": null,
          "new_api": "writeCallback",
          "old_text": null,
          "new_text": "writeCallback(parentFd, p.childFd)",
          "old_line_content": "",
          "new_line_content": "        if (writeCallback(parentFd, p.childFd)) {",
          "content_same": false
        },
        {
          "line": 925,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "toClose.push_back(i)",
          "old_line_content": "      // Call read callback on POLLHUP, to give it a chance to read (and act",
          "new_line_content": "          toClose.push_back(i);",
          "content_same": false
        },
        {
          "line": 801,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "buf.get()",
          "old_line_content": "    if (n == 0) {",
          "new_line_content": "    ssize_t n = readNoInt(fd, buf.get(), bufSize);",
          "content_same": false
        },
        {
          "line": 675,
          "old_api": null,
          "new_api": "constexpr",
          "old_text": null,
          "new_text": "constexpr",
          "old_line_content": "    // Always call waitpid once after the full timeout has elapsed.",
          "new_line_content": "  constexpr auto maximumSleepDuration = std::chrono::milliseconds{100};",
          "content_same": false
        },
        {
          "line": 805,
          "old_api": null,
          "new_api": "checkUnixError",
          "old_text": null,
          "new_text": "checkUnixError(n, \"read\")",
          "old_line_content": "}",
          "new_line_content": "    checkUnixError(n, \"read\");",
          "content_same": false
        },
        {
          "line": 933,
          "old_api": null,
          "new_api": "DCHECK",
          "old_text": null,
          "new_text": "DCHECK(!(events & POLLOUT))",
          "old_line_content": "      }",
          "new_line_content": "        DCHECK(!(events & POLLOUT));",
          "content_same": false
        },
        {
          "line": 679,
          "old_api": null,
          "new_api": "std::chrono::steady_clock::now()",
          "old_text": null,
          "new_text": "std::chrono::steady_clock::now()",
          "old_line_content": "    pid_t found;",
          "new_line_content": "    auto now = std::chrono::steady_clock::now();",
          "content_same": false
        },
        {
          "line": 934,
          "old_api": null,
          "new_api": "readCallback",
          "old_text": null,
          "new_text": "readCallback(parentFd, p.childFd)",
          "old_line_content": "",
          "new_line_content": "        if (readCallback(parentFd, p.childFd)) {",
          "content_same": false
        },
        {
          "line": 935,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "toClose.push_back(i)",
          "old_line_content": "      if ((events & (POLLHUP | POLLERR)) && !closed) {",
          "new_line_content": "          toClose.push_back(i);",
          "content_same": false
        },
        {
          "line": 684,
          "old_api": null,
          "new_api": "::waitpid(pid_, &status, WNOHANG)",
          "old_text": null,
          "new_text": "::waitpid(pid_, &status, WNOHANG)",
          "old_line_content": "    if (found) {",
          "new_line_content": "      found = ::waitpid(pid_, &status, WNOHANG);",
          "content_same": false
        },
        {
          "line": 941,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "toClose.push_back(i)",
          "old_line_content": "    // Close the fds in reverse order so the indexes hold after erase()",
          "new_line_content": "        toClose.push_back(i);",
          "content_same": false
        },
        {
          "line": 816,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "input.size()",
          "old_line_content": "  std::pair<std::string, std::string> out;",
          "new_line_content": "  inputQueue.wrapBuffer(input.data(), input.size());",
          "content_same": false
        },
        {
          "line": 689,
          "old_api": null,
          "new_api": "DCHECK_EQ",
          "old_text": null,
          "new_text": "DCHECK_EQ(found, pid_)",
          "old_line_content": "      // this method multiple times.",
          "new_line_content": "      DCHECK_EQ(found, pid_);",
          "content_same": false
        },
        {
          "line": 690,
          "old_api": null,
          "new_api": "ProcessReturnCode::make(status)",
          "old_text": null,
          "new_text": "ProcessReturnCode::make(status)",
          "old_line_content": "      pid_ = -1;",
          "new_line_content": "      returnCode_ = ProcessReturnCode::make(status);",
          "content_same": false
        },
        {
          "line": 947,
          "old_api": null,
          "new_api": "boost::adaptors::reverse(toClose)",
          "old_text": null,
          "new_text": "boost::adaptors::reverse(toClose)",
          "old_line_content": "  }",
          "new_line_content": "    for (int idx : boost::adaptors::reverse(toClose)) {",
          "content_same": false
        },
        {
          "line": 948,
          "old_api": null,
          "new_api": "begin",
          "old_text": null,
          "new_text": "pipes_.begin()",
          "old_line_content": "}",
          "new_line_content": "      auto pos = pipes_.begin() + idx;",
          "content_same": false
        },
        {
          "line": 949,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "pos->pipe.close()",
          "old_line_content": "",
          "new_line_content": "      pos->pipe.close(); // Throws on error",
          "content_same": false
        },
        {
          "line": 950,
          "old_api": null,
          "new_api": "erase",
          "old_text": null,
          "new_text": "pipes_.erase(pos)",
          "old_line_content": "void Subprocess::enableNotifications(int childFd, bool enabled) {",
          "new_line_content": "      pipes_.erase(pos);",
          "content_same": false
        },
        {
          "line": 823,
          "old_api": null,
          "new_api": "coalesce",
          "old_text": null,
          "new_text": "outBufs.first->coalesce()",
          "old_line_content": "  if (outBufs.second) {",
          "new_line_content": "    outBufs.first->coalesce();",
          "content_same": false
        },
        {
          "line": 956,
          "old_api": null,
          "new_api": "findByChildFd",
          "old_text": null,
          "new_text": "findByChildFd(childFd)",
          "old_line_content": "}",
          "new_line_content": "  pipes_[findByChildFd(childFd)].enabled = enabled;",
          "content_same": false
        },
        {
          "line": 701,
          "old_api": null,
          "new_api": "std::this_thread::sleep_for(sleepDuration)",
          "old_text": null,
          "new_text": "std::this_thread::sleep_for(sleepDuration)",
          "old_line_content": "",
          "new_line_content": "    std::this_thread::sleep_for(sleepDuration);",
          "content_same": false
        },
        {
          "line": 829,
          "old_api": null,
          "new_api": "coalesce",
          "old_text": null,
          "new_text": "outBufs.second->coalesce()",
          "old_line_content": "  return out;",
          "new_line_content": "    outBufs.second->coalesce();",
          "content_same": false
        },
        {
          "line": 830,
          "old_api": null,
          "new_api": "assign",
          "old_text": null,
          "new_text": "out.second.assign(\n        reinterpret_cast<const char*>(outBufs.second->data()),\n        outBufs.second->length())",
          "old_line_content": "}",
          "new_line_content": "    out.second.assign(",
          "content_same": false
        },
        {
          "line": 831,
          "old_api": null,
          "new_api": "data",
          "old_text": null,
          "new_text": "outBufs.second->data()",
          "old_line_content": "",
          "new_line_content": "        reinterpret_cast<const char*>(outBufs.second->data()),",
          "content_same": false
        },
        {
          "line": 832,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "outBufs.second->length()",
          "old_line_content": "std::pair<IOBufQueue, IOBufQueue> Subprocess::communicateIOBuf(",
          "new_line_content": "        outBufs.second->length());",
          "content_same": false
        },
        {
          "line": 708,
          "old_api": null,
          "new_api": "enforce",
          "old_text": null,
          "new_text": "returnCode_.enforce(ProcessReturnCode::RUNNING)",
          "old_line_content": "ProcessReturnCode Subprocess::waitOrTerminateOrKill(",
          "new_line_content": "  returnCode_.enforce(ProcessReturnCode::RUNNING);",
          "content_same": false
        },
        {
          "line": 709,
          "old_api": null,
          "new_api": "::kill(pid_, signal)",
          "old_text": null,
          "new_text": "::kill(pid_, signal)",
          "old_line_content": "    TimeoutDuration waitTimeout,",
          "new_line_content": "  int r = ::kill(pid_, signal);",
          "content_same": false
        },
        {
          "line": 710,
          "old_api": null,
          "new_api": "checkUnixError",
          "old_text": null,
          "new_text": "checkUnixError(r, \"kill\")",
          "old_line_content": "    TimeoutDuration sigtermTimeout) {",
          "new_line_content": "  checkUnixError(r, \"kill\");",
          "content_same": false
        },
        {
          "line": 968,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "pipes_.end()",
          "old_line_content": "}",
          "new_line_content": "  if (pos == pipes_.end() || pos->childFd != childFd) {",
          "content_same": false
        },
        {
          "line": 841,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "input.empty()",
          "old_line_content": "",
          "new_line_content": "  if (!input.empty()) {",
          "content_same": false
        },
        {
          "line": 969,
          "old_api": null,
          "new_api": "std::invalid_argument(\n        folly::to<std::string>(\"child fd not found \", childFd))",
          "old_text": null,
          "new_text": "std::invalid_argument(\n        folly::to<std::string>(\"child fd not found \", childFd))",
          "old_line_content": "",
          "new_line_content": "    throw std::invalid_argument(",
          "content_same": false
        },
        {
          "line": 970,
          "old_api": null,
          "new_api": "folly::to<std::string>(\"child fd not found \", childFd)",
          "old_text": null,
          "new_text": "folly::to<std::string>(\"child fd not found \", childFd)",
          "old_line_content": "void Subprocess::closeParentFd(int childFd) {",
          "new_line_content": "        folly::to<std::string>(\"child fd not found \", childFd));",
          "content_same": false
        },
        {
          "line": 844,
          "old_api": null,
          "new_api": "findByChildFd",
          "old_text": null,
          "new_text": "findByChildFd(STDIN_FILENO)",
          "old_line_content": "  auto readCallback = [&](int pfd, int cfd) -> bool {",
          "new_line_content": "    findByChildFd(STDIN_FILENO);",
          "content_same": false
        },
        {
          "line": 719,
          "old_api": null,
          "new_api": "waitTimeout",
          "old_text": null,
          "new_text": "this->waitTimeout(waitTimeout)",
          "old_line_content": "  return returnCode_;",
          "new_line_content": "  this->waitTimeout(waitTimeout);",
          "content_same": false
        },
        {
          "line": 976,
          "old_api": null,
          "new_api": "findByChildFd",
          "old_text": null,
          "new_text": "findByChildFd(childFd)",
          "old_line_content": "std::vector<Subprocess::ChildPipe> Subprocess::takeOwnershipOfPipes() {",
          "new_line_content": "  int idx = findByChildFd(childFd);",
          "content_same": false
        },
        {
          "line": 721,
          "old_api": null,
          "new_api": "running",
          "old_text": null,
          "new_text": "returnCode_.running()",
          "old_line_content": "",
          "new_line_content": "  if (returnCode_.running()) {",
          "content_same": false
        },
        {
          "line": 722,
          "old_api": null,
          "new_api": "terminateOrKill",
          "old_text": null,
          "new_text": "terminateOrKill(sigtermTimeout)",
          "old_line_content": "ProcessReturnCode Subprocess::terminateOrKill(TimeoutDuration sigtermTimeout) {",
          "new_line_content": "    return terminateOrKill(sigtermTimeout);",
          "content_same": false
        },
        {
          "line": 851,
          "old_api": null,
          "new_api": "handleRead",
          "old_text": null,
          "new_text": "handleRead(pfd, out.first)",
          "old_line_content": "      // just read and throw the data away.",
          "new_line_content": "      return handleRead(pfd, out.first);",
          "content_same": false
        },
        {
          "line": 977,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "pipes_[idx].pipe.close()",
          "old_line_content": "  std::vector<Subprocess::ChildPipe> pipes;",
          "new_line_content": "  pipes_[idx].pipe.close(); // May throw",
          "content_same": false
        },
        {
          "line": 853,
          "old_api": null,
          "new_api": "handleRead",
          "old_text": null,
          "new_text": "handleRead(pfd, out.second)",
          "old_line_content": "    }",
          "new_line_content": "      return handleRead(pfd, out.second);",
          "content_same": false
        },
        {
          "line": 978,
          "old_api": null,
          "new_api": "begin",
          "old_text": null,
          "new_text": "pipes_.begin()",
          "old_line_content": "  for (auto& p : pipes_) {",
          "new_line_content": "  pipes_.erase(pipes_.begin() + idx);",
          "content_same": false
        },
        {
          "line": 984,
          "old_api": null,
          "new_api": "std::move(p.pipe)",
          "old_text": null,
          "new_text": "std::move(p.pipe)",
          "old_line_content": "}",
          "new_line_content": "    pipes.emplace_back(p.childFd, std::move(p.pipe));",
          "content_same": false
        },
        {
          "line": 857,
          "old_api": null,
          "new_api": "discardRead",
          "old_text": null,
          "new_text": "discardRead(pfd)",
          "old_line_content": "    if (cfd == STDIN_FILENO) {",
          "new_line_content": "      return discardRead(pfd);",
          "content_same": false
        },
        {
          "line": 731,
          "old_api": null,
          "new_api": "terminate",
          "old_text": null,
          "new_text": "terminate()",
          "old_line_content": "  }",
          "new_line_content": "  terminate();",
          "content_same": false
        },
        {
          "line": 987,
          "old_api": null,
          "new_api": "swap",
          "old_text": null,
          "new_text": "std::vector<Pipe>().swap(pipes_)",
          "old_line_content": "",
          "new_line_content": "  std::vector<Pipe>().swap(pipes_);",
          "content_same": false
        },
        {
          "line": 733,
          "old_api": null,
          "new_api": "waitTimeout",
          "old_text": null,
          "new_text": "waitTimeout(sigtermTimeout)",
          "old_line_content": "  // sending SIGTERM, we have to use nuclear option SIGKILL to kill",
          "new_line_content": "  waitTimeout(sigtermTimeout);",
          "content_same": false
        },
        {
          "line": 734,
          "old_api": null,
          "new_api": "running",
          "old_text": null,
          "new_text": "returnCode_.running()",
          "old_line_content": "  // the subprocess.",
          "new_line_content": "  if (!returnCode_.running()) {",
          "content_same": false
        },
        {
          "line": 863,
          "old_api": null,
          "new_api": "handleWrite",
          "old_text": null,
          "new_text": "handleWrite(pfd, input)",
          "old_line_content": "  };",
          "new_line_content": "      return handleWrite(pfd, input);",
          "content_same": false
        },
        {
          "line": 741,
          "old_api": null,
          "new_api": "kill",
          "old_text": null,
          "new_text": "kill()",
          "old_line_content": "}",
          "new_line_content": "  kill();",
          "content_same": false
        },
        {
          "line": 870,
          "old_api": null,
          "new_api": "std::move(writeCallback)",
          "old_text": null,
          "new_text": "std::move(writeCallback)",
          "old_line_content": "void Subprocess::communicate(",
          "new_line_content": "  communicate(std::move(readCallback), std::move(writeCallback));",
          "content_same": false
        },
        {
          "line": 997,
          "old_api": null,
          "new_api": "::signal(SIGPIPE, SIG_IGN)",
          "old_text": null,
          "new_text": "::signal(SIGPIPE, SIG_IGN)",
          "old_line_content": "",
          "new_line_content": "    ::signal(SIGPIPE, SIG_IGN);",
          "content_same": false
        },
        {
          "line": 745,
          "old_api": null,
          "new_api": "wait",
          "old_text": null,
          "new_text": "wait()",
          "old_line_content": "}",
          "new_line_content": "  return wait();",
          "content_same": false
        },
        {
          "line": 880,
          "old_api": null,
          "new_api": "enforce",
          "old_text": null,
          "new_text": "returnCode_.enforce(ProcessReturnCode::RUNNING)",
          "old_line_content": "  std::vector<size_t> toClose; // indexes into pipes_",
          "new_line_content": "  returnCode_.enforce(ProcessReturnCode::RUNNING);",
          "content_same": false
        },
        {
          "line": 755,
          "old_api": null,
          "new_api": "front",
          "old_text": null,
          "new_text": "queue.front()",
          "old_line_content": "}",
          "new_line_content": "  auto* p = queue.front();",
          "content_same": false
        },
        {
          "line": 886,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "pipes_.size()",
          "old_line_content": "",
          "new_line_content": "  toClose.reserve(pipes_.size());",
          "content_same": false
        },
        {
          "line": 759,
          "old_api": null,
          "new_api": "peekBytes",
          "old_text": null,
          "new_text": "io::Cursor(p).peekBytes()",
          "old_line_content": "  for (;;) {",
          "new_line_content": "  return io::Cursor(p).peekBytes();",
          "content_same": false
        },
        {
          "line": 888,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "pipes_.empty()",
          "old_line_content": "      pollfd pfd;",
          "new_line_content": "  while (!pipes_.empty()) {",
          "content_same": false
        },
        {
          "line": 890,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "toClose.clear()",
          "old_line_content": "      // Yes, backwards, PIPE_IN / PIPE_OUT are defined from the",
          "new_line_content": "    toClose.clear();",
          "content_same": false
        },
        {
          "line": 766,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "b.empty()",
          "old_line_content": "    if (n == -1 && errno == EAGAIN) {",
          "new_line_content": "    if (b.empty()) {",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 769,
          "old_api": "checkUnixError",
          "new_api": null,
          "old_text": "checkUnixError(n, \"write\")",
          "new_text": null,
          "old_line_content": "    checkUnixError(n, \"write\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 901,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "fds.push_back(pfd)",
          "new_text": null,
          "old_line_content": "      fds.push_back(pfd);",
          "new_line_content": "      } else if (p.direction == PIPE_IN) {",
          "content_same": false
        },
        {
          "line": 777,
          "old_api": "preallocate",
          "new_api": null,
          "old_text": "queue.preallocate(100, 65000)",
          "new_text": null,
          "old_line_content": "    auto p = queue.preallocate(100, 65000);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 778,
          "old_api": "readNoInt",
          "new_api": null,
          "old_text": "readNoInt(fd, p.first, p.second)",
          "new_text": null,
          "old_line_content": "    ssize_t n = readNoInt(fd, p.first, p.second);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 908,
          "old_api": "checkUnixError",
          "new_api": null,
          "old_text": "checkUnixError(r, \"poll\")",
          "new_text": null,
          "old_line_content": "    checkUnixError(r, \"poll\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 910,
          "old_api": "size",
          "new_api": null,
          "old_text": "pipes_.size()",
          "new_text": null,
          "old_line_content": "    for (size_t i = 0; i < pipes_.size(); ++i) {",
          "new_line_content": "    do {",
          "content_same": false
        },
        {
          "line": 912,
          "old_api": "fd",
          "new_api": null,
          "old_text": "p.pipe.fd()",
          "new_text": null,
          "old_line_content": "      auto parentFd = p.pipe.fd();",
          "new_line_content": "    } while (r == -1 && errno == EINTR);",
          "content_same": false
        },
        {
          "line": 786,
          "old_api": "postallocate",
          "new_api": null,
          "old_text": "queue.postallocate(n)",
          "new_text": null,
          "old_line_content": "    queue.postallocate(n);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 919,
          "old_api": "writeCallback",
          "new_api": null,
          "old_text": "writeCallback(parentFd, p.childFd)",
          "new_text": null,
          "old_line_content": "        if (writeCallback(parentFd, p.childFd)) {",
          "new_line_content": "      short events = fds[i].revents;",
          "content_same": false
        },
        {
          "line": 920,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "toClose.push_back(i)",
          "new_text": null,
          "old_line_content": "          toClose.push_back(i);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 796,
          "old_api": "get",
          "new_api": null,
          "old_text": "buf.get()",
          "new_text": null,
          "old_line_content": "    ssize_t n = readNoInt(fd, buf.get(), bufSize);",
          "new_line_content": "  static const size_t bufSize = 65000;",
          "content_same": false
        },
        {
          "line": 800,
          "old_api": "checkUnixError",
          "new_api": null,
          "old_text": "checkUnixError(n, \"read\")",
          "new_text": null,
          "old_line_content": "    checkUnixError(n, \"read\");",
          "new_line_content": "  for (;;) {",
          "content_same": false
        },
        {
          "line": 928,
          "old_api": "DCHECK",
          "new_api": null,
          "old_text": "DCHECK(!(events & POLLOUT))",
          "new_text": null,
          "old_line_content": "        DCHECK(!(events & POLLOUT));",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 929,
          "old_api": "readCallback",
          "new_api": null,
          "old_text": "readCallback(parentFd, p.childFd)",
          "new_text": null,
          "old_line_content": "        if (readCallback(parentFd, p.childFd)) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 930,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "toClose.push_back(i)",
          "new_text": null,
          "old_line_content": "          toClose.push_back(i);",
          "new_line_content": "      // Call read callback on POLLHUP, to give it a chance to read (and act",
          "content_same": false
        },
        {
          "line": 676,
          "old_api": "std::chrono::steady_clock::now()",
          "new_api": null,
          "old_text": "std::chrono::steady_clock::now()",
          "new_text": null,
          "old_line_content": "    auto now = std::chrono::steady_clock::now();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 936,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "toClose.push_back(i)",
          "new_text": null,
          "old_line_content": "        toClose.push_back(i);",
          "new_line_content": "          closed = true;",
          "content_same": false
        },
        {
          "line": 681,
          "old_api": "::waitpid(pid_, &status, WNOHANG)",
          "new_api": null,
          "old_text": "::waitpid(pid_, &status, WNOHANG)",
          "new_text": null,
          "old_line_content": "      found = ::waitpid(pid_, &status, WNOHANG);",
          "new_line_content": "    int status;",
          "content_same": false
        },
        {
          "line": 683,
          "old_api": "PCHECK",
          "new_api": null,
          "old_text": "PCHECK(found != -1)",
          "new_text": null,
          "old_line_content": "    PCHECK(found != -1) << \"waitpid(\" << pid_ << \", &status, WNOHANG)\";",
          "new_line_content": "    do {",
          "content_same": false
        },
        {
          "line": 811,
          "old_api": "size",
          "new_api": null,
          "old_text": "input.size()",
          "new_text": null,
          "old_line_content": "  inputQueue.wrapBuffer(input.data(), input.size());",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 813,
          "old_api": "std::move(inputQueue)",
          "new_api": null,
          "old_text": "std::move(inputQueue)",
          "new_text": null,
          "old_line_content": "  auto outQueues = communicateIOBuf(std::move(inputQueue));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 942,
          "old_api": "boost::adaptors::reverse(toClose)",
          "new_api": null,
          "old_text": "boost::adaptors::reverse(toClose)",
          "new_text": null,
          "old_line_content": "    for (int idx : boost::adaptors::reverse(toClose)) {",
          "new_line_content": "        closed = true;",
          "content_same": false
        },
        {
          "line": 687,
          "old_api": "ProcessReturnCode::make(status)",
          "new_api": null,
          "old_text": "ProcessReturnCode::make(status)",
          "new_text": null,
          "old_line_content": "      returnCode_ = ProcessReturnCode::make(status);",
          "new_line_content": "    if (found) {",
          "content_same": false
        },
        {
          "line": 815,
          "old_api": "move",
          "new_api": null,
          "old_text": "outQueues.second.move()",
          "new_text": null,
          "old_line_content": "      std::make_pair(outQueues.first.move(), outQueues.second.move());",
          "new_line_content": "  IOBufQueue inputQueue;",
          "content_same": false
        },
        {
          "line": 943,
          "old_api": "begin",
          "new_api": null,
          "old_text": "pipes_.begin()",
          "new_text": null,
          "old_line_content": "      auto pos = pipes_.begin() + idx;",
          "new_line_content": "      }",
          "content_same": false
        },
        {
          "line": 944,
          "old_api": "close",
          "new_api": null,
          "old_text": "pos->pipe.close()",
          "new_text": null,
          "old_line_content": "      pos->pipe.close(); // Throws on error",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 819,
          "old_api": "assign",
          "new_api": null,
          "old_text": "out.first.assign(\n        reinterpret_cast<const char*>(outBufs.first->data()),\n        outBufs.first->length())",
          "new_text": null,
          "old_line_content": "    out.first.assign(",
          "new_line_content": "  auto outBufs =",
          "content_same": false
        },
        {
          "line": 945,
          "old_api": "erase",
          "new_api": null,
          "old_text": "pipes_.erase(pos)",
          "new_text": null,
          "old_line_content": "      pipes_.erase(pos);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 821,
          "old_api": "length",
          "new_api": null,
          "old_text": "outBufs.first->length()",
          "new_text": null,
          "old_line_content": "        outBufs.first->length());",
          "new_line_content": "  std::pair<std::string, std::string> out;",
          "content_same": false
        },
        {
          "line": 951,
          "old_api": "findByChildFd",
          "new_api": null,
          "old_text": "findByChildFd(childFd)",
          "new_text": null,
          "old_line_content": "  pipes_[findByChildFd(childFd)].enabled = enabled;",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 698,
          "old_api": "std::this_thread::sleep_for(std::chrono::milliseconds{100})",
          "new_api": null,
          "old_text": "std::this_thread::sleep_for(std::chrono::milliseconds{100})",
          "new_text": null,
          "old_line_content": "    std::this_thread::sleep_for(std::chrono::milliseconds{100});",
          "new_line_content": "      return returnCode_;",
          "content_same": false
        },
        {
          "line": 827,
          "old_api": "length",
          "new_api": null,
          "old_text": "outBufs.second->length()",
          "new_text": null,
          "old_line_content": "        outBufs.second->length());",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 955,
          "old_api": "findByChildFd",
          "new_api": null,
          "old_text": "findByChildFd(childFd)",
          "new_text": null,
          "old_line_content": "  return pipes_[findByChildFd(childFd)].enabled;",
          "new_line_content": "void Subprocess::enableNotifications(int childFd, bool enabled) {",
          "content_same": false
        },
        {
          "line": 959,
          "old_api": "begin",
          "new_api": null,
          "old_text": "std::lower_bound(\n      pipes_.begin(), pipes_.end(), childFd, [](const Pipe& pipe, int fd) {\n        return pipe.childFd < fd;\n      })",
          "new_text": null,
          "old_line_content": "  auto pos = std::lower_bound(",
          "new_line_content": "bool Subprocess::notificationsEnabled(int childFd) const {",
          "content_same": false
        },
        {
          "line": 704,
          "old_api": "::kill(pid_, signal)",
          "new_api": null,
          "old_text": "::kill(pid_, signal)",
          "new_text": null,
          "old_line_content": "  int r = ::kill(pid_, signal);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 705,
          "old_api": "checkUnixError",
          "new_api": null,
          "old_text": "checkUnixError(r, \"kill\")",
          "new_text": null,
          "old_line_content": "  checkUnixError(r, \"kill\");",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 963,
          "old_api": "end",
          "new_api": null,
          "old_text": "pipes_.end()",
          "new_text": null,
          "old_line_content": "  if (pos == pipes_.end() || pos->childFd != childFd) {",
          "new_line_content": "size_t Subprocess::findByChildFd(int childFd) const {",
          "content_same": false
        },
        {
          "line": 836,
          "old_api": "empty",
          "new_api": null,
          "old_text": "input.empty()",
          "new_text": null,
          "old_line_content": "  if (!input.empty()) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 711,
          "old_api": "enforce",
          "new_api": null,
          "old_text": "returnCode_.enforce(ProcessReturnCode::RUNNING)",
          "new_text": null,
          "old_line_content": "  returnCode_.enforce(ProcessReturnCode::RUNNING);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 712,
          "old_api": "DCHECK_GT",
          "new_api": null,
          "old_text": "DCHECK_GT(pid_, 0)",
          "new_text": null,
          "old_line_content": "  DCHECK_GT(pid_, 0) << \"The subprocess has been waited already\";",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 839,
          "old_api": "findByChildFd",
          "new_api": null,
          "old_text": "findByChildFd(STDIN_FILENO)",
          "new_text": null,
          "old_line_content": "    findByChildFd(STDIN_FILENO);",
          "new_line_content": "  // If the user supplied a non-empty input buffer, make sure",
          "content_same": false
        },
        {
          "line": 714,
          "old_api": "waitTimeout",
          "new_api": null,
          "old_text": "this->waitTimeout(waitTimeout)",
          "new_text": null,
          "old_line_content": "  this->waitTimeout(waitTimeout);",
          "new_line_content": "    TimeoutDuration waitTimeout,",
          "content_same": false
        },
        {
          "line": 967,
          "old_api": "begin",
          "new_api": null,
          "old_text": "pipes_.begin()",
          "new_text": null,
          "old_line_content": "  return pos - pipes_.begin();",
          "new_line_content": "      });",
          "content_same": false
        },
        {
          "line": 971,
          "old_api": "findByChildFd",
          "new_api": null,
          "old_text": "findByChildFd(childFd)",
          "new_text": null,
          "old_line_content": "  int idx = findByChildFd(childFd);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 973,
          "old_api": "begin",
          "new_api": null,
          "old_text": "pipes_.begin()",
          "new_text": null,
          "old_line_content": "  pipes_.erase(pipes_.begin() + idx);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 846,
          "old_api": "handleRead",
          "new_api": null,
          "old_text": "handleRead(pfd, out.first)",
          "new_text": null,
          "old_line_content": "      return handleRead(pfd, out.first);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 848,
          "old_api": "handleRead",
          "new_api": null,
          "old_text": "handleRead(pfd, out.second)",
          "new_text": null,
          "old_line_content": "      return handleRead(pfd, out.second);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 723,
          "old_api": "enforce",
          "new_api": null,
          "old_text": "returnCode_.enforce(ProcessReturnCode::RUNNING)",
          "new_text": null,
          "old_line_content": "  returnCode_.enforce(ProcessReturnCode::RUNNING);",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 724,
          "old_api": "DCHECK_GT",
          "new_api": null,
          "old_text": "DCHECK_GT(pid_, 0)",
          "new_text": null,
          "old_line_content": "  DCHECK_GT(pid_, 0) << \"The subprocess has been waited already\";",
          "new_line_content": "  return returnCode_;",
          "content_same": false
        },
        {
          "line": 852,
          "old_api": "discardRead",
          "new_api": null,
          "old_text": "discardRead(pfd)",
          "new_text": null,
          "old_line_content": "      return discardRead(pfd);",
          "new_line_content": "    } else if (cfd == STDERR_FILENO) {",
          "content_same": false
        },
        {
          "line": 726,
          "old_api": "terminate",
          "new_api": null,
          "old_text": "terminate()",
          "new_text": null,
          "old_line_content": "  terminate();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 979,
          "old_api": "std::move(p.pipe)",
          "new_api": null,
          "old_text": "std::move(p.pipe)",
          "new_text": null,
          "old_line_content": "    pipes.emplace_back(p.childFd, std::move(p.pipe));",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 982,
          "old_api": "swap",
          "new_api": null,
          "old_text": "std::vector<Pipe>().swap(pipes_)",
          "new_text": null,
          "old_line_content": "  std::vector<Pipe>().swap(pipes_);",
          "new_line_content": "  std::vector<Subprocess::ChildPipe> pipes;",
          "content_same": false
        },
        {
          "line": 858,
          "old_api": "handleWrite",
          "new_api": null,
          "old_text": "handleWrite(pfd, input)",
          "new_text": null,
          "old_line_content": "      return handleWrite(pfd, input);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 735,
          "old_api": "LOG",
          "new_api": null,
          "old_text": "LOG(INFO)",
          "new_text": null,
          "old_line_content": "  LOG(INFO) << \"Send SIGKILL to \" << pid_;",
          "new_line_content": "    return returnCode_;",
          "content_same": false
        },
        {
          "line": 736,
          "old_api": "kill",
          "new_api": null,
          "old_text": "kill()",
          "new_text": null,
          "old_line_content": "  kill();",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 865,
          "old_api": "std::move(writeCallback)",
          "new_api": null,
          "old_text": "std::move(writeCallback)",
          "new_text": null,
          "old_line_content": "  communicate(std::move(readCallback), std::move(writeCallback));",
          "new_line_content": "      // If we don't want to write to this fd, just close it.",
          "content_same": false
        },
        {
          "line": 992,
          "old_api": "::signal(SIGPIPE, SIG_IGN)",
          "new_api": null,
          "old_text": "::signal(SIGPIPE, SIG_IGN)",
          "new_text": null,
          "old_line_content": "    ::signal(SIGPIPE, SIG_IGN);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 875,
          "old_api": "enforce",
          "new_api": null,
          "old_text": "returnCode_.enforce(ProcessReturnCode::RUNNING)",
          "new_text": null,
          "old_line_content": "  returnCode_.enforce(ProcessReturnCode::RUNNING);",
          "new_line_content": "void Subprocess::communicate(",
          "content_same": false
        },
        {
          "line": 876,
          "old_api": "setAllNonBlocking",
          "new_api": null,
          "old_text": "setAllNonBlocking()",
          "new_text": null,
          "old_line_content": "  setAllNonBlocking();",
          "new_line_content": "    FdCallback readCallback,",
          "content_same": false
        },
        {
          "line": 750,
          "old_api": "front",
          "new_api": null,
          "old_text": "queue.front()",
          "new_text": null,
          "old_line_content": "  auto* p = queue.front();",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 879,
          "old_api": "size",
          "new_api": null,
          "old_text": "pipes_.size()",
          "new_text": null,
          "old_line_content": "  fds.reserve(pipes_.size());",
          "new_line_content": "  // legitimately need that, send a patch to delete this line.",
          "content_same": false
        },
        {
          "line": 754,
          "old_api": "peekBytes",
          "new_api": null,
          "old_text": "io::Cursor(p).peekBytes()",
          "new_text": null,
          "old_line_content": "  return io::Cursor(p).peekBytes();",
          "new_line_content": "ByteRange queueFront(const IOBufQueue& queue) {",
          "content_same": false
        },
        {
          "line": 883,
          "old_api": "empty",
          "new_api": null,
          "old_text": "pipes_.empty()",
          "new_text": null,
          "old_line_content": "  while (!pipes_.empty()) {",
          "new_line_content": "  std::vector<pollfd> fds;",
          "content_same": false
        },
        {
          "line": 885,
          "old_api": "clear",
          "new_api": null,
          "old_text": "toClose.clear()",
          "new_text": null,
          "old_line_content": "    toClose.clear();",
          "new_line_content": "  std::vector<size_t> toClose; // indexes into pipes_",
          "content_same": false
        },
        {
          "line": 760,
          "old_api": "queueFront",
          "new_api": null,
          "old_text": "queueFront(queue)",
          "new_text": null,
          "old_line_content": "    auto b = queueFront(queue);",
          "new_line_content": "}",
          "content_same": false
        },
        {
          "line": 761,
          "old_api": "empty",
          "new_api": null,
          "old_text": "b.empty()",
          "new_text": null,
          "old_line_content": "    if (b.empty()) {",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 25,
      "total_additions": 69,
      "total_deletions": 67,
      "total_api_changes": 161
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 9,
        "api_related_lines": 161,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          697,
          674,
          700,
          702
        ]
      }
    },
    "api_calls_before": 275,
    "api_calls_after": 277,
    "diff_info": {
      "added_lines": 7,
      "removed_lines": 2,
      "total_diff_lines": 28
    }
  }
}