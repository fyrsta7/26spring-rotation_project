{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/folly/modified_file/24e54548c4bdbcd78f5155026ca08b5dbb78b48d",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/folly/modified_file/24e54548c4bdbcd78f5155026ca08b5dbb78b48d/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/folly/modified_file/24e54548c4bdbcd78f5155026ca08b5dbb78b48d/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/folly/modified_file/24e54548c4bdbcd78f5155026ca08b5dbb78b48d/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 505,
          "old_api": "reserve",
          "new_api": "clear",
          "old_text": "line.reserve(78)",
          "new_text": "line.clear()",
          "old_line_content": "  line.reserve(78);",
          "new_line_content": "  line.clear();",
          "content_same": false
        },
        {
          "line": 506,
          "old_api": "reinterpret_cast<const uint8_t*>(ptr)",
          "new_api": "reserve",
          "old_text": "reinterpret_cast<const uint8_t*>(ptr)",
          "new_text": "line.reserve(78)",
          "old_line_content": "  const uint8_t* p = reinterpret_cast<const uint8_t*>(ptr) + offset;",
          "new_line_content": "  line.reserve(78);",
          "content_same": false
        },
        {
          "line": 507,
          "old_api": "std::min(size - offset, size_t(16))",
          "new_api": "reinterpret_cast<const uint8_t*>(ptr)",
          "old_text": "std::min(size - offset, size_t(16))",
          "new_text": "reinterpret_cast<const uint8_t*>(ptr)",
          "old_line_content": "  size_t n = std::min(size - offset, size_t(16));",
          "new_line_content": "  const uint8_t* p = reinterpret_cast<const uint8_t*>(ptr) + offset;",
          "content_same": false
        },
        {
          "line": 508,
          "old_api": "appendTo",
          "new_api": "std::min(size - offset, size_t(16))",
          "old_text": "format(\"{:08x} \", offset).appendTo(line)",
          "new_text": "std::min(size - offset, size_t(16))",
          "old_line_content": "  format(\"{:08x} \", offset).appendTo(line);",
          "new_line_content": "  size_t n = std::min(size - offset, size_t(16));",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": "push_back",
          "new_api": "static_cast<char>(p[i])",
          "old_text": "line.push_back(c)",
          "new_text": "static_cast<char>(p[i])",
          "old_line_content": "    line.push_back(c);",
          "new_line_content": "    char c = (p[i] >= 32 && p[i] <= 126 ? static_cast<char>(p[i]) : '.');",
          "content_same": false
        },
        {
          "line": 527,
          "old_api": "push_back",
          "new_api": "append",
          "old_text": "line.push_back('|')",
          "new_text": "line.append(16 - n, ' ')",
          "old_line_content": "  line.push_back('|');",
          "new_line_content": "  line.append(16 - n, ' ');",
          "content_same": false
        },
        {
          "line": 528,
          "old_api": "size",
          "new_api": "push_back",
          "old_text": "line.size()",
          "new_text": "line.push_back('|')",
          "old_line_content": "  DCHECK_EQ(line.size(), 78);",
          "new_line_content": "  line.push_back('|');",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 513,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "line.push_back(' ')",
          "old_line_content": "    }",
          "new_line_content": "      line.push_back(' ');",
          "content_same": false
        },
        {
          "line": 481,
          "old_api": null,
          "new_api": "toLowerAscii32",
          "old_text": null,
          "new_text": "toLowerAscii32(*(uint32_t*)(str + offset))",
          "old_line_content": "    offset += 4;",
          "new_line_content": "    toLowerAscii32(*(uint32_t*)(str + offset));",
          "content_same": false
        },
        {
          "line": 515,
          "old_api": null,
          "new_api": "appendTo",
          "old_text": null,
          "new_text": "format(\" {:02x}\", p[i]).appendTo(line)",
          "old_line_content": "  }",
          "new_line_content": "    format(\" {:02x}\", p[i]).appendTo(line);",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": null,
          "new_api": "toLowerAscii8",
          "old_text": null,
          "new_text": "toLowerAscii8(str[offset])",
          "old_line_content": "    offset++;",
          "new_line_content": "    toLowerAscii8(str[offset]);",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": null,
          "new_api": "std::min(4 - n, length)",
          "old_text": null,
          "new_text": "std::min(4 - n, length)",
          "old_line_content": "    do {",
          "new_line_content": "    n = std::min(4 - n, length);",
          "content_same": false
        },
        {
          "line": 521,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "line.append(\"  |\")",
          "old_line_content": "",
          "new_line_content": "  line.append(\"  |\");",
          "content_same": false
        },
        {
          "line": 458,
          "old_api": null,
          "new_api": "toLowerAscii8",
          "old_text": null,
          "new_text": "toLowerAscii8(str[offset])",
          "old_line_content": "      offset++;",
          "new_line_content": "      toLowerAscii8(str[offset]);",
          "content_same": false
        },
        {
          "line": 525,
          "old_api": null,
          "new_api": "push_back",
          "old_text": null,
          "new_text": "line.push_back(c)",
          "old_line_content": "  }",
          "new_line_content": "    line.push_back(c);",
          "content_same": false
        },
        {
          "line": 529,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "line.size()",
          "old_line_content": "",
          "new_line_content": "  DCHECK_EQ(line.size(), 78);",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": null,
          "new_api": "toLowerAscii32",
          "old_text": null,
          "new_text": "toLowerAscii32(*(uint32_t*)(str + offset))",
          "old_line_content": "    offset += 4;",
          "new_line_content": "    toLowerAscii32(*(uint32_t*)(str + offset));",
          "content_same": false
        },
        {
          "line": 475,
          "old_api": null,
          "new_api": "toLowerAscii64",
          "old_text": null,
          "new_text": "toLowerAscii64(*(uint64_t*)(str + offset))",
          "old_line_content": "    offset += 8;",
          "new_line_content": "    toLowerAscii64(*(uint64_t*)(str + offset));",
          "content_same": false
        },
        {
          "line": 509,
          "old_api": null,
          "new_api": "appendTo",
          "old_text": null,
          "new_text": "format(\"{:08x} \", offset).appendTo(line)",
          "old_line_content": "",
          "new_line_content": "  format(\"{:08x} \", offset).appendTo(line);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 512,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "line.push_back(' ')",
          "new_text": null,
          "old_line_content": "      line.push_back(' ');",
          "new_line_content": "    if (i == 8) {",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": "toLowerAscii32",
          "new_api": null,
          "old_text": "toLowerAscii32(*(uint32_t*)(str + offset))",
          "new_text": null,
          "old_line_content": "    toLowerAscii32(*(uint32_t*)(str + offset));",
          "new_line_content": "  while (offset + 4 <= length) {",
          "content_same": false
        },
        {
          "line": 514,
          "old_api": "appendTo",
          "new_api": null,
          "old_text": "format(\" {:02x}\", p[i]).appendTo(line)",
          "new_text": null,
          "old_line_content": "    format(\" {:02x}\", p[i]).appendTo(line);",
          "new_line_content": "    }",
          "content_same": false
        },
        {
          "line": 486,
          "old_api": "toLowerAscii8",
          "new_api": null,
          "old_text": "toLowerAscii8(str[offset])",
          "new_text": null,
          "old_line_content": "    toLowerAscii8(str[offset]);",
          "new_line_content": "  while (offset < length) {",
          "content_same": false
        },
        {
          "line": 519,
          "old_api": "append",
          "new_api": null,
          "old_text": "line.append(3 * (16 - n) + (n <= 8), ' ')",
          "new_text": null,
          "old_line_content": "  line.append(3 * (16 - n) + (n <= 8), ' ');",
          "new_line_content": "  // if necessary",
          "content_same": false
        },
        {
          "line": 457,
          "old_api": "toLowerAscii8",
          "new_api": null,
          "old_text": "toLowerAscii8(str[offset])",
          "new_text": null,
          "old_line_content": "      toLowerAscii8(str[offset]);",
          "new_line_content": "    do {",
          "content_same": false
        },
        {
          "line": 523,
          "old_api": "static_cast<char>(p[i])",
          "new_api": null,
          "old_text": "static_cast<char>(p[i])",
          "new_text": null,
          "old_line_content": "    char c = (p[i] >= 32 && p[i] <= 126 ? static_cast<char>(p[i]) : '.');",
          "new_line_content": "  for (size_t i = 0; i < n; i++) {",
          "content_same": false
        },
        {
          "line": 526,
          "old_api": "append",
          "new_api": null,
          "old_text": "line.append(16 - n, ' ')",
          "new_text": null,
          "old_line_content": "  line.append(16 - n, ' ');",
          "new_line_content": "  }",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": "toLowerAscii32",
          "new_api": null,
          "old_text": "toLowerAscii32(*(uint32_t*)(str + offset))",
          "new_text": null,
          "old_line_content": "    toLowerAscii32(*(uint32_t*)(str + offset));",
          "new_line_content": "    // part of the input.",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": "clear",
          "new_api": null,
          "old_text": "line.clear()",
          "new_text": null,
          "old_line_content": "  line.clear();",
          "new_line_content": "  // Total: 78",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": "toLowerAscii64",
          "new_api": null,
          "old_text": "toLowerAscii64(*(uint64_t*)(str + offset))",
          "new_text": null,
          "old_line_content": "    toLowerAscii64(*(uint64_t*)(str + offset));",
          "new_line_content": "  while (offset + 8 <= length) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 7,
      "total_additions": 12,
      "total_deletions": 11,
      "total_api_changes": 30
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 7,
        "api_related_lines": 30,
        "non_api_lines": 4,
        "non_api_line_numbers": [
          464,
          465,
          473,
          479
        ]
      }
    },
    "api_calls_before": 92,
    "api_calls_after": 93,
    "diff_info": {
      "added_lines": 4,
      "removed_lines": 3,
      "total_diff_lines": 38
    }
  }
}