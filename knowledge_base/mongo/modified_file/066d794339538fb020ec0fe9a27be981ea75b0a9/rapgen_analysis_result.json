{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mongo/modified_file/066d794339538fb020ec0fe9a27be981ea75b0a9",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mongo/modified_file/066d794339538fb020ec0fe9a27be981ea75b0a9/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mongo/modified_file/066d794339538fb020ec0fe9a27be981ea75b0a9/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mongo/modified_file/066d794339538fb020ec0fe9a27be981ea75b0a9/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 196,
          "old_api": "str",
          "new_api": "verify",
          "old_text": "ss.str()",
          "new_text": "verify( fileNo >= 0 )",
          "old_line_content": "            full /= ss.str();",
          "new_line_content": "            verify( fileNo >= 0 );",
          "content_same": false
        },
        {
          "line": 203,
          "old_api": "close",
          "new_api": "str",
          "old_text": "close()",
          "new_text": "ss.str()",
          "old_line_content": "                    close();",
          "new_line_content": "            return ss.str();",
          "content_same": false
        },
        {
          "line": 209,
          "old_api": "_close",
          "new_api": "close",
          "old_text": "_close()",
          "new_text": "close()",
          "old_line_content": "            _close();",
          "new_line_content": "                    close();",
          "content_same": false
        },
        {
          "line": 219,
          "old_api": "verify",
          "new_api": "MongoFile::flushAll(true)",
          "old_text": "verify(entry.e)",
          "new_text": "MongoFile::flushAll(true)",
          "old_line_content": "            verify(entry.e);",
          "new_line_content": "            MongoFile::flushAll(true);",
          "content_same": false
        },
        {
          "line": 220,
          "old_api": "verify",
          "new_api": "clear",
          "old_text": "verify(entry.dbName)",
          "new_text": "_mmfs.clear()",
          "old_line_content": "            verify(entry.dbName);",
          "new_line_content": "            _mmfs.clear();",
          "content_same": false
        },
        {
          "line": 227,
          "old_api": "findByPath",
          "new_api": "strnlen",
          "old_text": "finder.findByPath(fn)",
          "new_text": "strnlen(entry.dbName, MaxDatabaseNameLen)",
          "old_line_content": "                file = finder.findByPath(fn);",
          "new_line_content": "            verify(strnlen(entry.dbName, MaxDatabaseNameLen) < MaxDatabaseNameLen);",
          "content_same": false
        },
        {
          "line": 238,
          "old_api": "verify",
          "new_api": "isMongoMMF",
          "old_text": "verify(false)",
          "new_text": "file->isMongoMMF()",
          "old_line_content": "                    verify(false);",
          "new_line_content": "                verify(file->isMongoMMF());",
          "content_same": false
        },
        {
          "line": 243,
          "old_api": "get",
          "new_api": "log",
          "old_text": "sp.get()",
          "new_text": "log()",
          "old_line_content": "                mmf = sp.get();",
          "new_line_content": "                    log() << \"journal error applying writes, file \" << fn << \" is not open\" << endl;",
          "content_same": false
        },
        {
          "line": 247,
          "old_api": "view_write",
          "new_api": "open",
          "old_text": "mmf->view_write()",
          "new_text": "sp->open(fn, false)",
          "old_line_content": "                verify(mmf->view_write());",
          "new_line_content": "                verify(sp->open(fn, false));",
          "content_same": false
        },
        {
          "line": 248,
          "old_api": "srcData",
          "new_api": "push_back",
          "old_text": "entry.e->srcData()",
          "new_text": "_mmfs.push_back(sp)",
          "old_line_content": "                verify(entry.e->srcData());",
          "new_line_content": "                _mmfs.push_back(sp);",
          "content_same": false
        },
        {
          "line": 269,
          "old_api": "srcData",
          "new_api": "setw",
          "old_text": "entry.e->srcData()",
          "new_text": "setw(20)",
          "old_line_content": "                       \"  \" << hexdump(entry.e->srcData(), entry.e->len);",
          "new_line_content": "                    ss << \"  BASICWRITE \" << setw(20) << entry.dbName << '.';",
          "content_same": false
        },
        {
          "line": 270,
          "old_api": "str",
          "new_api": "isNsSuffix",
          "old_text": "ss.str()",
          "new_text": "entry.e->isNsSuffix()",
          "old_line_content": "                    log() << ss.str() << endl;",
          "new_line_content": "                    if( entry.e->isNsSuffix() )",
          "content_same": false
        },
        {
          "line": 273,
          "old_api": "write",
          "new_api": "getFileNo",
          "old_text": "write(entry)",
          "new_text": "entry.e->getFileNo()",
          "old_line_content": "                    write(entry);",
          "new_line_content": "                        ss << setw(2) << entry.e->getFileNo();",
          "content_same": false
        },
        {
          "line": 279,
          "old_api": "toString",
          "new_api": "write",
          "old_text": "entry.op->toString()",
          "new_text": "write(entry)",
          "old_line_content": "                    log() << \"  OP \" << entry.op->toString() << endl;",
          "new_line_content": "                    write(entry);",
          "content_same": false
        },
        {
          "line": 285,
          "old_api": "replay",
          "new_api": "toString",
          "old_text": "entry.op->replay()",
          "new_text": "entry.op->toString()",
          "old_line_content": "                    entry.op->replay();",
          "new_line_content": "                    log() << \"  OP \" << entry.op->toString() << endl;",
          "content_same": false
        },
        {
          "line": 337,
          "old_api": "clear",
          "new_api": "auto_ptr<JournalSectionIterator>(new JournalSectionIterator(*h, /*after header*/p, /*w/out header*/len))",
          "old_text": "entries.clear()",
          "new_text": "auto_ptr<JournalSectionIterator>(new JournalSectionIterator(*h, /*after header*/p, /*w/out header*/len))",
          "old_line_content": "            entries.clear();",
          "new_line_content": "                i = auto_ptr<JournalSectionIterator>(new JournalSectionIterator(*h, /*after header*/p, /*w/out header*/len));",
          "content_same": false
        },
        {
          "line": 356,
          "old_api": "verify",
          "new_api": "next",
          "old_text": "verify( ((const char *)h) + sizeof(JSectHeader) == p )",
          "new_text": "i->next(e)",
          "old_line_content": "                verify( ((const char *)h) + sizeof(JSectHeader) == p );",
          "new_line_content": "                i->next(e);",
          "content_same": false
        },
        {
          "line": 357,
          "old_api": "checkHash",
          "new_api": "push_back",
          "old_text": "f->checkHash(h, len + sizeof(JSectHeader))",
          "new_text": "entries.push_back(e)",
          "old_line_content": "                if( !f->checkHash(h, len + sizeof(JSectHeader)) ) { ",
          "new_line_content": "                entries.push_back(e);",
          "content_same": false
        },
        {
          "line": 363,
          "old_api": "applyEntries",
          "new_api": "checkHash",
          "old_text": "applyEntries(entries)",
          "new_text": "f->checkHash(h, len + sizeof(JSectHeader))",
          "old_line_content": "            applyEntries(entries);",
          "new_line_content": "                if( !f->checkHash(h, len + sizeof(JSectHeader)) ) { ",
          "content_same": false
        },
        {
          "line": 409,
          "old_api": "sectionLen",
          "new_api": "atEof",
          "old_text": "h.sectionLen()",
          "new_text": "br.atEof()",
          "old_line_content": "                            log() << \"  sect len:\" << h.sectionLen() << \" seqnum:\" << h.seqNumber << endl;",
          "new_line_content": "                while ( !br.atEof() ) {",
          "content_same": false
        },
        {
          "line": 415,
          "old_api": "sectionLenWithPadding",
          "new_api": "sectionLen",
          "old_text": "h.sectionLenWithPadding()",
          "new_text": "h.sectionLen()",
          "old_line_content": "                    const char *hdr = (const char *) br.skip(h.sectionLenWithPadding());",
          "new_line_content": "                            log() << \"  sect len:\" << h.sectionLen() << \" seqnum:\" << h.seqNumber << endl;",
          "content_same": false
        },
        {
          "line": 421,
          "old_api": "checkForInterrupt",
          "new_api": "sectionLenWithPadding",
          "old_text": "killCurrentOp.checkForInterrupt(false)",
          "new_text": "h.sectionLenWithPadding()",
          "old_line_content": "                    killCurrentOp.checkForInterrupt(false);",
          "new_line_content": "                    const char *hdr = (const char *) br.skip(h.sectionLenWithPadding());",
          "content_same": false
        },
        {
          "line": 444,
          "old_api": "log",
          "new_api": "string",
          "old_text": "log()",
          "new_text": "journalfile.string()",
          "old_line_content": "                log() << \"recover exception checking filesize\" << endl;",
          "new_line_content": "                if( boost::filesystem::file_size( journalfile.string() ) == 0 ) {",
          "content_same": false
        },
        {
          "line": 450,
          "old_api": "length",
          "new_api": "log",
          "old_text": "f.length()",
          "new_text": "log()",
          "old_line_content": "            return processFileBuffer(p, (unsigned) f.length());",
          "new_line_content": "                log() << \"recover exception checking filesize\" << endl;",
          "content_same": false
        },
        {
          "line": 455,
          "old_api": "log",
          "new_api": "string",
          "old_text": "log()",
          "new_text": "journalfile.string()",
          "old_line_content": "            log() << \"recover begin\" << endl;",
          "new_line_content": "            massert(13544, str::stream() << \"recover error couldn't open \" << journalfile.string(), p);",
          "content_same": false
        },
        {
          "line": 465,
          "old_api": "string",
          "new_api": "journalReadLSN",
          "old_text": "files[i].string()",
          "new_text": "journalReadLSN()",
          "old_line_content": "                    log() << \"recover error: abrupt end to file \" << files[i].string() << \", yet it isn't the last journal file\" << endl;",
          "new_line_content": "            _lastDataSyncedFromLastRun = journalReadLSN();",
          "content_same": false
        },
        {
          "line": 466,
          "old_api": "close",
          "new_api": "log",
          "old_text": "close()",
          "new_text": "log()",
          "old_line_content": "                    close();",
          "new_line_content": "            log() << \"recover lsn: \" << _lastDataSyncedFromLastRun << endl;",
          "content_same": false
        },
        {
          "line": 471,
          "old_api": "close",
          "new_api": "string",
          "old_text": "close()",
          "new_text": "files[i].string()",
          "old_line_content": "            close();",
          "new_line_content": "                    log() << \"recover error: abrupt end to file \" << files[i].string() << \", yet it isn't the last journal file\" << endl;",
          "content_same": false
        },
        {
          "line": 477,
          "old_api": "log",
          "new_api": "close",
          "old_text": "log()",
          "new_text": "close()",
          "old_line_content": "            log() << \"recover cleaning up\" << endl;",
          "new_line_content": "            close();",
          "content_same": false
        },
        {
          "line": 485,
          "old_api": "verify",
          "new_api": "log",
          "old_text": "verify( cmdLine.dur )",
          "new_text": "log()",
          "old_line_content": "            verify( cmdLine.dur );",
          "new_line_content": "            log() << \"recover done\" << endl;",
          "content_same": false
        },
        {
          "line": 495,
          "old_api": "getFiles",
          "new_api": "string",
          "old_text": "getFiles(p, journalFiles)",
          "new_text": "p.string()",
          "old_line_content": "            getFiles(p, journalFiles);",
          "new_line_content": "                log() << \"directory \" << p.string() << \" does not exist, there will be no recovery startup step\" << endl;",
          "content_same": false
        },
        {
          "line": 503,
          "old_api": "go",
          "new_api": "empty",
          "old_text": "RecoveryJob::get().go(journalFiles)",
          "new_text": "journalFiles.empty()",
          "old_line_content": "            RecoveryJob::get().go(journalFiles);",
          "new_line_content": "            if( journalFiles.empty() ) {",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 256,
          "old_api": null,
          "new_api": "view_write",
          "old_text": null,
          "new_text": "mmf->view_write()",
          "old_line_content": "            }",
          "new_line_content": "                void* dest = (char*)mmf->view_write() + entry.e->ofs;",
          "content_same": false
        },
        {
          "line": 257,
          "old_api": null,
          "new_api": "srcData",
          "old_text": null,
          "new_text": "entry.e->srcData()",
          "old_line_content": "        }",
          "new_line_content": "                memcpy(dest, entry.e->srcData(), entry.e->len);",
          "content_same": false
        },
        {
          "line": 384,
          "old_api": null,
          "new_api": "read",
          "old_text": null,
          "new_text": "br.read(h)",
          "old_line_content": "                    */",
          "new_line_content": "                    br.read(h);",
          "content_same": false
        },
        {
          "line": 509,
          "old_api": null,
          "new_api": "go",
          "old_text": null,
          "new_text": "RecoveryJob::get().go(journalFiles)",
          "old_line_content": "        */",
          "new_line_content": "            RecoveryJob::get().go(journalFiles);",
          "content_same": false
        },
        {
          "line": 261,
          "old_api": null,
          "new_api": "massert",
          "old_text": null,
          "new_text": "massert(13622, \"Trying to write past end of file in WRITETODATAFILES\", _recovering)",
          "old_line_content": "                if( dump ) {",
          "new_line_content": "                massert(13622, \"Trying to write past end of file in WRITETODATAFILES\", _recovering);",
          "content_same": false
        },
        {
          "line": 391,
          "old_api": null,
          "new_api": "valid",
          "old_text": null,
          "new_text": "uassert(13537, \n                        \"journal file header invalid. This could indicate corruption in a journal file, or perhaps a crash where sectors in file header were in flight written out of order at time of crash (unlikely but possible).\", \n                        h.valid())",
          "old_line_content": "                            << \" expected:\" << hex << (unsigned) JHeader::CurrentVersion ",
          "new_line_content": "                    uassert(13537, ",
          "content_same": false
        },
        {
          "line": 393,
          "old_api": null,
          "new_api": "valid",
          "old_text": null,
          "new_text": "h.valid()",
          "old_line_content": "                            << endl;",
          "new_line_content": "                        h.valid());",
          "content_same": false
        },
        {
          "line": 395,
          "old_api": null,
          "new_api": "versionOk",
          "old_text": null,
          "new_text": "h.versionOk()",
          "old_line_content": "                    }",
          "new_line_content": "                    if( !h.versionOk() ) {",
          "content_same": false
        },
        {
          "line": 396,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "                    fileId = h.fileId;",
          "new_line_content": "                        log() << \"journal file version number mismatch got:\" << hex << h._version                             ",
          "content_same": false
        },
        {
          "line": 400,
          "old_api": null,
          "new_api": "str::stream()",
          "old_text": null,
          "new_text": "str::stream()",
          "old_line_content": "                }",
          "new_line_content": "                        uasserted(13536, str::stream() << \"journal version number mismatch \" << h._version);",
          "content_same": false
        },
        {
          "line": 530,
          "old_api": null,
          "new_api": "_recover",
          "old_text": null,
          "new_text": "_recover()",
          "old_line_content": "            void run() {",
          "new_line_content": "            _recover(); // throws on interruption",
          "content_same": false
        },
        {
          "line": 274,
          "old_api": null,
          "new_api": "setw",
          "old_text": null,
          "new_text": "setw(6)",
          "old_line_content": "                }",
          "new_line_content": "                    ss << ' ' << setw(6) << entry.e->len << ' ' << /*hex << setw(8) << (size_t) fqe.srcData << dec <<*/",
          "content_same": false
        },
        {
          "line": 275,
          "old_api": null,
          "new_api": "srcData",
          "old_text": null,
          "new_text": "entry.e->srcData()",
          "old_line_content": "            }",
          "new_line_content": "                       \"  \" << hexdump(entry.e->srcData(), entry.e->len);",
          "content_same": false
        },
        {
          "line": 276,
          "old_api": null,
          "new_api": "str",
          "old_text": null,
          "new_text": "ss.str()",
          "old_line_content": "            else if(entry.op) {",
          "new_line_content": "                    log() << ss.str() << endl;",
          "content_same": false
        },
        {
          "line": 404,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "                    JSectHeader h;",
          "new_line_content": "                        log() << \"JHeader::fileId=\" << fileId << endl;",
          "content_same": false
        },
        {
          "line": 411,
          "old_api": null,
          "new_api": "peek",
          "old_text": null,
          "new_text": "br.peek(h)",
          "old_line_content": "                        return true;",
          "new_line_content": "                    br.peek(h);",
          "content_same": false
        },
        {
          "line": 540,
          "old_api": null,
          "new_api": "read",
          "old_text": null,
          "new_text": "r.read(x)",
          "old_line_content": "        } brunittest;",
          "new_line_content": "                r.read(x); //cout << x; // a",
          "content_same": false
        },
        {
          "line": 541,
          "old_api": null,
          "new_api": "verify",
          "old_text": null,
          "new_text": "verify( x == 'a' )",
          "old_line_content": "",
          "new_line_content": "                verify( x == 'a' );",
          "content_same": false
        },
        {
          "line": 542,
          "old_api": null,
          "new_api": "read",
          "old_text": null,
          "new_text": "r.read(y)",
          "old_line_content": "        // can't free at termination because order of destruction of global vars is arbitrary",
          "new_line_content": "                r.read(y);",
          "content_same": false
        },
        {
          "line": 543,
          "old_api": null,
          "new_api": "read",
          "old_text": null,
          "new_text": "r.read(x)",
          "old_line_content": "        RecoveryJob &RecoveryJob::_instance = *(new RecoveryJob());",
          "new_line_content": "                r.read(x);",
          "content_same": false
        },
        {
          "line": 544,
          "old_api": null,
          "new_api": "verify",
          "old_text": null,
          "new_text": "verify( x == 'b' )",
          "old_line_content": "",
          "new_line_content": "                verify( x == 'b' );",
          "content_same": false
        },
        {
          "line": 288,
          "old_api": null,
          "new_api": "needFilesClosed",
          "old_text": null,
          "new_text": "entry.op->needFilesClosed()",
          "old_line_content": "        }",
          "new_line_content": "                    if( entry.op->needFilesClosed() ) {",
          "content_same": false
        },
        {
          "line": 289,
          "old_api": null,
          "new_api": "_close",
          "old_text": null,
          "new_text": "_close()",
          "old_line_content": "",
          "new_line_content": "                        _close(); // locked in processSection",
          "content_same": false
        },
        {
          "line": 291,
          "old_api": null,
          "new_api": "replay",
          "old_text": null,
          "new_text": "entry.op->replay()",
          "old_line_content": "            bool apply = (cmdLine.durOptions & CmdLine::DurScanOnly) == 0;",
          "new_line_content": "                    entry.op->replay();",
          "content_same": false
        },
        {
          "line": 414,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "                    unsigned dataLen = slen - sizeof(JSectHeader) - sizeof(JSectFooter);",
          "new_line_content": "                            log() << \"Ending processFileBuffer at differing fileId want:\" << fileId << \" got:\" << h.fileId << endl;",
          "content_same": false
        },
        {
          "line": 419,
          "old_api": null,
          "new_api": "sectionLen",
          "old_text": null,
          "new_text": "h.sectionLen()",
          "old_line_content": "",
          "new_line_content": "                    unsigned slen = h.sectionLen();",
          "content_same": false
        },
        {
          "line": 424,
          "old_api": null,
          "new_api": "processSection",
          "old_text": null,
          "new_text": "processSection((const JSectHeader*) hdr, data, dataLen, (const JSectFooter*) footer)",
          "old_line_content": "            catch( BufReader::eof& ) {",
          "new_line_content": "                    processSection((const JSectHeader*) hdr, data, dataLen, (const JSectFooter*) footer);",
          "content_same": false
        },
        {
          "line": 427,
          "old_api": null,
          "new_api": "checkForInterrupt",
          "old_text": null,
          "new_text": "killCurrentOp.checkForInterrupt(false)",
          "old_line_content": "                return true; // abrupt end",
          "new_line_content": "                    killCurrentOp.checkForInterrupt(false);",
          "content_same": false
        },
        {
          "line": 300,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "            if( dump )",
          "new_line_content": "                log() << \"BEGIN section\" << endl;",
          "content_same": false
        },
        {
          "line": 302,
          "old_api": null,
          "new_api": "end",
          "old_text": null,
          "new_text": "entries.end()",
          "old_line_content": "        }",
          "new_line_content": "            for( vector<ParsedJournalEntry>::const_iterator i = entries.begin(); i != entries.end(); ++i ) {",
          "content_same": false
        },
        {
          "line": 303,
          "old_api": null,
          "new_api": "applyEntry",
          "old_text": null,
          "new_text": "applyEntry(*i, apply, dump)",
          "old_line_content": "",
          "new_line_content": "                applyEntry(*i, apply, dump);",
          "content_same": false
        },
        {
          "line": 432,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "",
          "new_line_content": "                    log() << \"ABRUPT END\" << endl;",
          "content_same": false
        },
        {
          "line": 307,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "",
          "new_line_content": "                log() << \"END section\" << endl;",
          "content_same": false
        },
        {
          "line": 441,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "journalfile.string()",
          "old_line_content": "                }",
          "new_line_content": "            log() << \"recover \" << journalfile.string() << endl;",
          "content_same": false
        },
        {
          "line": 189,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "full.string()",
          "old_line_content": "            if( fileNo == JEntry::DotNsSuffix )",
          "new_line_content": "            ss << full.string();",
          "content_same": false
        },
        {
          "line": 445,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "journalfile.string()",
          "old_line_content": "            }",
          "new_line_content": "                    log() << \"recover info \" << journalfile.string() << \" has zero length\" << endl;",
          "content_same": false
        },
        {
          "line": 322,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "                }",
          "new_line_content": "                        log() << \"recover skipping application of section seq:\" << h->seqNumber << \" < lsn:\" << _lastDataSyncedFromLastRun << endl;",
          "content_same": false
        },
        {
          "line": 325,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "",
          "new_line_content": "                        log() << \"recover skipping application of section more...\" << endl;",
          "content_same": false
        },
        {
          "line": 454,
          "old_api": null,
          "new_api": "string",
          "old_text": null,
          "new_text": "journalfile.string().c_str()",
          "old_line_content": "        void RecoveryJob::go(vector<boost::filesystem::path>& files) {",
          "new_line_content": "            void *p = f.mapWithOptions(journalfile.string().c_str(), MongoFile::READONLY | MongoFile::SEQUENTIAL);",
          "content_same": false
        },
        {
          "line": 456,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "f.length()",
          "old_line_content": "            _recovering = true;",
          "new_line_content": "            return processFileBuffer(p, (unsigned) f.length());",
          "content_same": false
        },
        {
          "line": 461,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "",
          "new_line_content": "            log() << \"recover begin\" << endl;",
          "content_same": false
        },
        {
          "line": 334,
          "old_api": null,
          "new_api": "auto_ptr<JournalSectionIterator>(new JournalSectionIterator(*h, p, len, _recovering))",
          "old_text": null,
          "new_text": "auto_ptr<JournalSectionIterator>(new JournalSectionIterator(*h, p, len, _recovering))",
          "old_line_content": "            // we use a static so that we don't have to reallocate every time through.  occasionally we ",
          "new_line_content": "                i = auto_ptr<JournalSectionIterator>(new JournalSectionIterator(*h, p, len, _recovering));",
          "content_same": false
        },
        {
          "line": 207,
          "old_api": null,
          "new_api": "empty",
          "old_text": null,
          "new_text": "DESTRUCTOR_GUARD(\n                if( !_mmfs.empty() )\n                    close();\n            )",
          "old_line_content": "        void RecoveryJob::close() {",
          "new_line_content": "            DESTRUCTOR_GUARD(",
          "content_same": false
        },
        {
          "line": 468,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "files.size()",
          "old_line_content": "                }",
          "new_line_content": "            for( unsigned i = 0; i != files.size(); ++i ) {",
          "content_same": false
        },
        {
          "line": 469,
          "old_api": null,
          "new_api": "processFile",
          "old_text": null,
          "new_text": "processFile(files[i])",
          "old_line_content": "            }",
          "new_line_content": "\t      bool abruptEnd = processFile(files[i]);",
          "content_same": false
        },
        {
          "line": 470,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "files.size()",
          "old_line_content": "",
          "new_line_content": "                if( abruptEnd && i+1 < files.size() ) {",
          "content_same": false
        },
        {
          "line": 215,
          "old_api": null,
          "new_api": "_close",
          "old_text": null,
          "new_text": "_close()",
          "old_line_content": "        }",
          "new_line_content": "            _close();",
          "content_same": false
        },
        {
          "line": 343,
          "old_api": null,
          "new_api": "clear",
          "old_text": null,
          "new_text": "entries.clear()",
          "old_line_content": "                }",
          "new_line_content": "            entries.clear();",
          "content_same": false
        },
        {
          "line": 472,
          "old_api": null,
          "new_api": "close",
          "old_text": null,
          "new_text": "close()",
          "old_line_content": "",
          "new_line_content": "                    close();",
          "content_same": false
        },
        {
          "line": 473,
          "old_api": null,
          "new_api": "uasserted",
          "old_text": null,
          "new_text": "uasserted(13535, \"recover abrupt journal file end\")",
          "old_line_content": "            if( cmdLine.durOptions & CmdLine::DurScanOnly ) {",
          "new_line_content": "                    uasserted(13535, \"recover abrupt journal file end\");",
          "content_same": false
        },
        {
          "line": 480,
          "old_api": null,
          "new_api": "str::stream()",
          "old_text": null,
          "new_text": "str::stream()",
          "old_line_content": "            okToCleanUp = true;",
          "new_line_content": "                uasserted(13545, str::stream() << \"--durOptions \" << (int) CmdLine::DurScanOnly << \" (scan only) specified\");",
          "content_same": false
        },
        {
          "line": 225,
          "old_api": null,
          "new_api": "verify",
          "old_text": null,
          "new_text": "verify(entry.e)",
          "old_line_content": "            {",
          "new_line_content": "            verify(entry.e);",
          "content_same": false
        },
        {
          "line": 226,
          "old_api": null,
          "new_api": "verify",
          "old_text": null,
          "new_text": "verify(entry.dbName)",
          "old_line_content": "                MongoFileFinder finder; // must release lock before creating new MongoMMF",
          "new_line_content": "            verify(entry.dbName);",
          "content_same": false
        },
        {
          "line": 355,
          "old_api": null,
          "new_api": "atEof",
          "old_text": null,
          "new_text": "i->atEof()",
          "old_line_content": "            if( _recovering ) {",
          "new_line_content": "            while( !i->atEof() ) {",
          "content_same": false
        },
        {
          "line": 483,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "",
          "new_line_content": "            log() << \"recover cleaning up\" << endl;",
          "content_same": false
        },
        {
          "line": 229,
          "old_api": null,
          "new_api": "getFileNo",
          "old_text": null,
          "new_text": "entry.e->getFileNo()",
          "old_line_content": "",
          "new_line_content": "            const string fn = fileName(entry.dbName, entry.e->getFileNo());",
          "content_same": false
        },
        {
          "line": 484,
          "old_api": null,
          "new_api": "removeJournalFiles",
          "old_text": null,
          "new_text": "removeJournalFiles()",
          "old_line_content": "        void _recover() {",
          "new_line_content": "            removeJournalFiles();",
          "content_same": false
        },
        {
          "line": 233,
          "old_api": null,
          "new_api": "findByPath",
          "old_text": null,
          "new_text": "finder.findByPath(fn)",
          "old_line_content": "                mmf = (MongoMMF*)file;",
          "new_line_content": "                file = finder.findByPath(fn);",
          "content_same": false
        },
        {
          "line": 362,
          "old_api": null,
          "new_api": "verify",
          "old_text": null,
          "new_text": "verify( ((const char *)h) + sizeof(JSectHeader) == p )",
          "old_line_content": "            // got all the entries for one group commit.  apply them:",
          "new_line_content": "                verify( ((const char *)h) + sizeof(JSectHeader) == p );",
          "content_same": false
        },
        {
          "line": 491,
          "old_api": null,
          "new_api": "verify",
          "old_text": null,
          "new_text": "verify( cmdLine.dur )",
          "old_line_content": "                return;",
          "new_line_content": "            verify( cmdLine.dur );",
          "content_same": false
        },
        {
          "line": 364,
          "old_api": null,
          "new_api": "msgasserted",
          "old_text": null,
          "new_text": "msgasserted(13594, \"journal checksum doesn't match\")",
          "old_line_content": "        }",
          "new_line_content": "                    msgasserted(13594, \"journal checksum doesn't match\");",
          "content_same": false
        },
        {
          "line": 493,
          "old_api": null,
          "new_api": "getJournalDir",
          "old_text": null,
          "new_text": "getJournalDir()",
          "old_line_content": "",
          "new_line_content": "            boost::filesystem::path p = getJournalDir();",
          "content_same": false
        },
        {
          "line": 494,
          "old_api": null,
          "new_api": "exists",
          "old_text": null,
          "new_text": "exists(p)",
          "old_line_content": "            vector<boost::filesystem::path> journalFiles;",
          "new_line_content": "            if( !exists(p) ) {",
          "content_same": false
        },
        {
          "line": 369,
          "old_api": null,
          "new_api": "applyEntries",
          "old_text": null,
          "new_text": "applyEntries(entries)",
          "old_line_content": "        */",
          "new_line_content": "            applyEntries(entries);",
          "content_same": false
        },
        {
          "line": 244,
          "old_api": null,
          "new_api": "verify",
          "old_text": null,
          "new_text": "verify(false)",
          "old_line_content": "            }",
          "new_line_content": "                    verify(false);",
          "content_same": false
        },
        {
          "line": 501,
          "old_api": null,
          "new_api": "getFiles",
          "old_text": null,
          "new_text": "getFiles(p, journalFiles)",
          "old_line_content": "            }",
          "new_line_content": "            getFiles(p, journalFiles);",
          "content_same": false
        },
        {
          "line": 504,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "        }",
          "new_line_content": "                log() << \"recover : no journal files present, no recovery needed\" << endl;",
          "content_same": false
        },
        {
          "line": 249,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "sp.get()",
          "old_line_content": "",
          "new_line_content": "                mmf = sp.get();",
          "content_same": false
        },
        {
          "line": 252,
          "old_api": null,
          "new_api": "length",
          "old_text": null,
          "new_text": "mmf->length()",
          "old_line_content": "                stats.curr->_writeToDataFilesBytes += entry.e->len;",
          "new_line_content": "            if ((entry.e->ofs + entry.e->len) <= mmf->length()) {",
          "content_same": false
        },
        {
          "line": 253,
          "old_api": null,
          "new_api": "view_write",
          "old_text": null,
          "new_text": "mmf->view_write()",
          "old_line_content": "            }",
          "new_line_content": "                verify(mmf->view_write());",
          "content_same": false
        },
        {
          "line": 254,
          "old_api": null,
          "new_api": "srcData",
          "old_text": null,
          "new_text": "entry.e->srcData()",
          "old_line_content": "            else {",
          "new_line_content": "                verify(entry.e->srcData());",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 385,
          "old_api": "valid",
          "new_api": null,
          "old_text": "uassert(13537, \n                        \"journal file header invalid. This could indicate corruption in a journal file, or perhaps a crash where sectors in file header were in flight written out of order at time of crash (unlikely but possible).\", \n                        h.valid())",
          "new_text": null,
          "old_line_content": "                    uassert(13537, ",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 387,
          "old_api": "valid",
          "new_api": null,
          "old_text": "h.valid()",
          "new_text": null,
          "old_line_content": "                        h.valid());",
          "new_line_content": "                       (1) if this is the final journal file",
          "content_same": false
        },
        {
          "line": 389,
          "old_api": "versionOk",
          "new_api": null,
          "old_text": "h.versionOk()",
          "new_text": null,
          "old_line_content": "                    if( !h.versionOk() ) {",
          "new_line_content": "                       then can just assume recovery ended cleanly and not error out (still should log).",
          "content_same": false
        },
        {
          "line": 390,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                        log() << \"journal file version number mismatch got:\" << hex << h._version                             ",
          "new_line_content": "                    */",
          "content_same": false
        },
        {
          "line": 263,
          "old_api": "setw",
          "new_api": null,
          "old_text": "setw(20)",
          "new_text": null,
          "old_line_content": "                    ss << \"  BASICWRITE \" << setw(20) << entry.dbName << '.';",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 264,
          "old_api": "isNsSuffix",
          "new_api": null,
          "old_text": "entry.e->isNsSuffix()",
          "new_text": null,
          "old_line_content": "                    if( entry.e->isNsSuffix() )",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 394,
          "old_api": "str::stream()",
          "new_api": null,
          "old_text": "str::stream()",
          "new_text": null,
          "old_line_content": "                        uasserted(13536, str::stream() << \"journal version number mismatch \" << h._version);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 267,
          "old_api": "getFileNo",
          "new_api": null,
          "old_text": "entry.e->getFileNo()",
          "new_text": null,
          "old_line_content": "                        ss << setw(2) << entry.e->getFileNo();",
          "new_line_content": "                if( dump ) {",
          "content_same": false
        },
        {
          "line": 524,
          "old_api": "_recover",
          "new_api": null,
          "old_text": "_recover()",
          "new_text": null,
          "old_line_content": "            _recover(); // throws on interruption",
          "new_line_content": "            // can't lock groupCommitMutex here as ",
          "content_same": false
        },
        {
          "line": 268,
          "old_api": "setw",
          "new_api": null,
          "old_text": "setw(6)",
          "new_text": null,
          "old_line_content": "                    ss << ' ' << setw(6) << entry.e->len << ' ' << /*hex << setw(8) << (size_t) fqe.srcData << dec <<*/",
          "new_line_content": "                    stringstream ss;",
          "content_same": false
        },
        {
          "line": 398,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                        log() << \"JHeader::fileId=\" << fileId << endl;",
          "new_line_content": "                            << \". if you have just upgraded, recover with old version of mongod, terminate cleanly, then upgrade.\" ",
          "content_same": false
        },
        {
          "line": 403,
          "old_api": "atEof",
          "new_api": null,
          "old_text": "br.atEof()",
          "new_text": null,
          "old_line_content": "                while ( !br.atEof() ) {",
          "new_line_content": "                    if(cmdLine.durOptions & CmdLine::DurDumpJournal) { ",
          "content_same": false
        },
        {
          "line": 405,
          "old_api": "peek",
          "new_api": null,
          "old_text": "br.peek(h)",
          "new_text": null,
          "old_line_content": "                    br.peek(h);",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 534,
          "old_api": "read",
          "new_api": null,
          "old_text": "r.read(x)",
          "new_text": null,
          "old_line_content": "                r.read(x); //cout << x; // a",
          "new_line_content": "        class BufReaderUnitTest : public StartupTest {",
          "content_same": false
        },
        {
          "line": 535,
          "old_api": "verify",
          "new_api": null,
          "old_text": "verify( x == 'a' )",
          "new_text": null,
          "old_line_content": "                verify( x == 'a' );",
          "new_line_content": "        public:",
          "content_same": false
        },
        {
          "line": 536,
          "old_api": "read",
          "new_api": null,
          "old_text": "r.read(y)",
          "new_text": null,
          "old_line_content": "                r.read(y);",
          "new_line_content": "            void run() {",
          "content_same": false
        },
        {
          "line": 537,
          "old_api": "read",
          "new_api": null,
          "old_text": "r.read(x)",
          "new_text": null,
          "old_line_content": "                r.read(x);",
          "new_line_content": "                BufReader r((void*) \"abcdabcdabcd\", 12);",
          "content_same": false
        },
        {
          "line": 538,
          "old_api": "verify",
          "new_api": null,
          "old_text": "verify( x == 'b' )",
          "new_text": null,
          "old_line_content": "                verify( x == 'b' );",
          "new_line_content": "                char x;",
          "content_same": false
        },
        {
          "line": 282,
          "old_api": "needFilesClosed",
          "new_api": null,
          "old_text": "entry.op->needFilesClosed()",
          "new_text": null,
          "old_line_content": "                    if( entry.op->needFilesClosed() ) {",
          "new_line_content": "            else if(entry.op) {",
          "content_same": false
        },
        {
          "line": 283,
          "old_api": "_close",
          "new_api": null,
          "old_text": "_close()",
          "new_text": null,
          "old_line_content": "                        _close(); // locked in processSection",
          "new_line_content": "                // a DurOp subclass operation",
          "content_same": false
        },
        {
          "line": 408,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                            log() << \"Ending processFileBuffer at differing fileId want:\" << fileId << \" got:\" << h.fileId << endl;",
          "new_line_content": "                // read sections",
          "content_same": false
        },
        {
          "line": 413,
          "old_api": "sectionLen",
          "new_api": null,
          "old_text": "h.sectionLen()",
          "new_text": null,
          "old_line_content": "                    unsigned slen = h.sectionLen();",
          "new_line_content": "                        if( debug || (cmdLine.durOptions & CmdLine::DurDumpJournal) ) {",
          "content_same": false
        },
        {
          "line": 418,
          "old_api": "processSection",
          "new_api": null,
          "old_text": "processSection((const JSectHeader*) hdr, data, dataLen, (const JSectFooter*) footer)",
          "new_text": null,
          "old_line_content": "                    processSection((const JSectHeader*) hdr, data, dataLen, (const JSectFooter*) footer);",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 294,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                log() << \"BEGIN section\" << endl;",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 296,
          "old_api": "end",
          "new_api": null,
          "old_text": "entries.end()",
          "new_text": null,
          "old_line_content": "            for( vector<ParsedJournalEntry>::const_iterator i = entries.begin(); i != entries.end(); ++i ) {",
          "new_line_content": "        void RecoveryJob::applyEntries(const vector<ParsedJournalEntry> &entries) {",
          "content_same": false
        },
        {
          "line": 297,
          "old_api": "applyEntry",
          "new_api": null,
          "old_text": "applyEntry(*i, apply, dump)",
          "new_text": null,
          "old_line_content": "                applyEntry(*i, apply, dump);",
          "new_line_content": "            bool apply = (cmdLine.durOptions & CmdLine::DurScanOnly) == 0;",
          "content_same": false
        },
        {
          "line": 426,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                    log() << \"ABRUPT END\" << endl;",
          "new_line_content": "                    // ctrl c check",
          "content_same": false
        },
        {
          "line": 301,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                log() << \"END section\" << endl;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 435,
          "old_api": "string",
          "new_api": null,
          "old_text": "journalfile.string()",
          "new_text": null,
          "old_line_content": "            log() << \"recover \" << journalfile.string() << endl;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 438,
          "old_api": "string",
          "new_api": null,
          "old_text": "journalfile.string()",
          "new_text": null,
          "old_line_content": "                if( boost::filesystem::file_size( journalfile.string() ) == 0 ) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 439,
          "old_api": "string",
          "new_api": null,
          "old_text": "journalfile.string()",
          "new_text": null,
          "old_line_content": "                    log() << \"recover info \" << journalfile.string() << \" has zero length\" << endl;",
          "new_line_content": "        /** apply a specific journal file */",
          "content_same": false
        },
        {
          "line": 188,
          "old_api": "verify",
          "new_api": null,
          "old_text": "verify( fileNo >= 0 )",
          "new_text": null,
          "old_line_content": "            verify( fileNo >= 0 );",
          "new_line_content": "            StackStringBuilder ss;",
          "content_same": false
        },
        {
          "line": 316,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                        log() << \"recover skipping application of section seq:\" << h->seqNumber << \" < lsn:\" << _lastDataSyncedFromLastRun << endl;",
          "new_line_content": "                      within the header itself",
          "content_same": false
        },
        {
          "line": 319,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                        log() << \"recover skipping application of section more...\" << endl;",
          "new_line_content": "                if( h->seqNumber != _lastSeqMentionedInConsoleLog ) {",
          "content_same": false
        },
        {
          "line": 448,
          "old_api": "string",
          "new_api": null,
          "old_text": "journalfile.string().c_str()",
          "new_text": null,
          "old_line_content": "            void *p = f.mapWithOptions(journalfile.string().c_str(), MongoFile::READONLY | MongoFile::SEQUENTIAL);",
          "new_line_content": "            } catch(...) { ",
          "content_same": false
        },
        {
          "line": 449,
          "old_api": "string",
          "new_api": null,
          "old_text": "journalfile.string()",
          "new_text": null,
          "old_line_content": "            massert(13544, str::stream() << \"recover error couldn't open \" << journalfile.string(), p);",
          "new_line_content": "                // if something weird like a permissions problem keep going so the massert down below can happen (presumably)",
          "content_same": false
        },
        {
          "line": 197,
          "old_api": "string",
          "new_api": null,
          "old_text": "full.string()",
          "new_text": null,
          "old_line_content": "            return full.string();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 328,
          "old_api": "auto_ptr<JournalSectionIterator>(new JournalSectionIterator(*h, p, len, _recovering))",
          "new_api": null,
          "old_text": "auto_ptr<JournalSectionIterator>(new JournalSectionIterator(*h, p, len, _recovering))",
          "new_text": null,
          "old_line_content": "                i = auto_ptr<JournalSectionIterator>(new JournalSectionIterator(*h, p, len, _recovering));",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 201,
          "old_api": "empty",
          "new_api": null,
          "old_text": "DESTRUCTOR_GUARD(\n                if( !_mmfs.empty() )\n                    close();\n            )",
          "new_text": null,
          "old_line_content": "            DESTRUCTOR_GUARD(",
          "new_line_content": "                ss << fileNo;",
          "content_same": false
        },
        {
          "line": 331,
          "old_api": "auto_ptr<JournalSectionIterator>(new JournalSectionIterator(*h, /*after header*/p, /*w/out header*/len))",
          "new_api": null,
          "old_text": "auto_ptr<JournalSectionIterator>(new JournalSectionIterator(*h, /*after header*/p, /*w/out header*/len))",
          "new_text": null,
          "old_line_content": "                i = auto_ptr<JournalSectionIterator>(new JournalSectionIterator(*h, /*after header*/p, /*w/out header*/len));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 459,
          "old_api": "journalReadLSN",
          "new_api": null,
          "old_text": "journalReadLSN()",
          "new_text": null,
          "old_line_content": "            _lastDataSyncedFromLastRun = journalReadLSN();",
          "new_line_content": "        /** @param files all the j._0 style files we need to apply for recovery */",
          "content_same": false
        },
        {
          "line": 460,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "            log() << \"recover lsn: \" << _lastDataSyncedFromLastRun << endl;",
          "new_line_content": "        void RecoveryJob::go(vector<boost::filesystem::path>& files) {",
          "content_same": false
        },
        {
          "line": 462,
          "old_api": "size",
          "new_api": null,
          "old_text": "files.size()",
          "new_text": null,
          "old_line_content": "            for( unsigned i = 0; i != files.size(); ++i ) {",
          "new_line_content": "            _recovering = true;",
          "content_same": false
        },
        {
          "line": 463,
          "old_api": "processFile",
          "new_api": null,
          "old_text": "processFile(files[i])",
          "new_text": null,
          "old_line_content": "\t      bool abruptEnd = processFile(files[i]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 464,
          "old_api": "size",
          "new_api": null,
          "old_text": "files.size()",
          "new_text": null,
          "old_line_content": "                if( abruptEnd && i+1 < files.size() ) {",
          "new_line_content": "            // load the last sequence number synced to the datafiles on disk before the last crash",
          "content_same": false
        },
        {
          "line": 467,
          "old_api": "uasserted",
          "new_api": null,
          "old_text": "uasserted(13535, \"recover abrupt journal file end\")",
          "new_text": null,
          "old_line_content": "                    uasserted(13535, \"recover abrupt journal file end\");",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 213,
          "old_api": "MongoFile::flushAll(true)",
          "new_api": null,
          "old_text": "MongoFile::flushAll(true)",
          "new_text": null,
          "old_line_content": "            MongoFile::flushAll(true);",
          "new_line_content": "        void RecoveryJob::close() {",
          "content_same": false
        },
        {
          "line": 214,
          "old_api": "clear",
          "new_api": null,
          "old_text": "_mmfs.clear()",
          "new_text": null,
          "old_line_content": "            _mmfs.clear();",
          "new_line_content": "            scoped_lock lk(_mx);",
          "content_same": false
        },
        {
          "line": 474,
          "old_api": "str::stream()",
          "new_api": null,
          "old_text": "str::stream()",
          "new_text": null,
          "old_line_content": "                uasserted(13545, str::stream() << \"--durOptions \" << (int) CmdLine::DurScanOnly << \" (scan only) specified\");",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 221,
          "old_api": "strnlen",
          "new_api": null,
          "old_text": "strnlen(entry.dbName, MaxDatabaseNameLen)",
          "new_text": null,
          "old_line_content": "            verify(strnlen(entry.dbName, MaxDatabaseNameLen) < MaxDatabaseNameLen);",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 349,
          "old_api": "atEof",
          "new_api": null,
          "old_text": "i->atEof()",
          "new_text": null,
          "old_line_content": "            while( !i->atEof() ) {",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 223,
          "old_api": "getFileNo",
          "new_api": null,
          "old_text": "entry.e->getFileNo()",
          "new_text": null,
          "old_line_content": "            const string fn = fileName(entry.dbName, entry.e->getFileNo());",
          "new_line_content": "        void RecoveryJob::write(const ParsedJournalEntry& entry) {",
          "content_same": false
        },
        {
          "line": 350,
          "old_api": "next",
          "new_api": null,
          "old_text": "i->next(e)",
          "new_text": null,
          "old_line_content": "                i->next(e);",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 351,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "entries.push_back(e)",
          "new_text": null,
          "old_line_content": "                entries.push_back(e);",
          "new_line_content": "*/",
          "content_same": false
        },
        {
          "line": 478,
          "old_api": "removeJournalFiles",
          "new_api": null,
          "old_text": "removeJournalFiles()",
          "new_text": null,
          "old_line_content": "            removeJournalFiles();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 479,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "            log() << \"recover done\" << endl;",
          "new_line_content": "            if( cmdLine.durOptions & CmdLine::DurScanOnly ) {",
          "content_same": false
        },
        {
          "line": 358,
          "old_api": "msgasserted",
          "new_api": null,
          "old_text": "msgasserted(13594, \"journal checksum doesn't match\")",
          "new_text": null,
          "old_line_content": "                    msgasserted(13594, \"journal checksum doesn't match\");",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 487,
          "old_api": "getJournalDir",
          "new_api": null,
          "old_text": "getJournalDir()",
          "new_text": null,
          "old_line_content": "            boost::filesystem::path p = getJournalDir();",
          "new_line_content": "            _recovering = false;",
          "content_same": false
        },
        {
          "line": 232,
          "old_api": "isMongoMMF",
          "new_api": null,
          "old_text": "file->isMongoMMF()",
          "new_text": null,
          "old_line_content": "                verify(file->isMongoMMF());",
          "new_line_content": "                MongoFileFinder finder; // must release lock before creating new MongoMMF",
          "content_same": false
        },
        {
          "line": 488,
          "old_api": "exists",
          "new_api": null,
          "old_text": "exists(p)",
          "new_text": null,
          "old_line_content": "            if( !exists(p) ) {",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 489,
          "old_api": "string",
          "new_api": null,
          "old_text": "p.string()",
          "new_text": null,
          "old_line_content": "                log() << \"directory \" << p.string() << \" does not exist, there will be no recovery startup step\" << endl;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 237,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                    log() << \"journal error applying writes, file \" << fn << \" is not open\" << endl;",
          "new_line_content": "            if (file) {",
          "content_same": false
        },
        {
          "line": 378,
          "old_api": "read",
          "new_api": null,
          "old_text": "br.read(h)",
          "new_text": null,
          "old_line_content": "                    br.read(h);",
          "new_line_content": "                unsigned long long fileId;",
          "content_same": false
        },
        {
          "line": 241,
          "old_api": "open",
          "new_api": null,
          "old_text": "sp->open(fn, false)",
          "new_text": null,
          "old_line_content": "                verify(sp->open(fn, false));",
          "new_line_content": "            else {",
          "content_same": false
        },
        {
          "line": 242,
          "old_api": "push_back",
          "new_api": null,
          "old_text": "_mmfs.push_back(sp)",
          "new_text": null,
          "old_line_content": "                _mmfs.push_back(sp);",
          "new_line_content": "                if( !_recovering ) {",
          "content_same": false
        },
        {
          "line": 497,
          "old_api": "empty",
          "new_api": null,
          "old_text": "journalFiles.empty()",
          "new_text": null,
          "old_line_content": "            if( journalFiles.empty() ) {",
          "new_line_content": "                return;",
          "content_same": false
        },
        {
          "line": 498,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                log() << \"recover : no journal files present, no recovery needed\" << endl;",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 246,
          "old_api": "length",
          "new_api": null,
          "old_text": "mmf->length()",
          "new_text": null,
          "old_line_content": "            if ((entry.e->ofs + entry.e->len) <= mmf->length()) {",
          "new_line_content": "                boost::shared_ptr<MongoMMF> sp (new MongoMMF);",
          "content_same": false
        },
        {
          "line": 250,
          "old_api": "view_write",
          "new_api": null,
          "old_text": "mmf->view_write()",
          "new_text": null,
          "old_line_content": "                void* dest = (char*)mmf->view_write() + entry.e->ofs;",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 251,
          "old_api": "srcData",
          "new_api": null,
          "old_text": "entry.e->srcData()",
          "new_text": null,
          "old_line_content": "                memcpy(dest, entry.e->srcData(), entry.e->len);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 255,
          "old_api": "massert",
          "new_api": null,
          "old_text": "massert(13622, \"Trying to write past end of file in WRITETODATAFILES\", _recovering)",
          "new_text": null,
          "old_line_content": "                massert(13622, \"Trying to write past end of file in WRITETODATAFILES\", _recovering);",
          "new_line_content": "",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 32,
      "total_additions": 71,
      "total_deletions": 71,
      "total_api_changes": 174
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 13,
        "api_related_lines": 174,
        "non_api_lines": 8,
        "non_api_line_numbers": [
          192,
          193,
          194,
          195,
          186,
          187,
          190,
          191
        ]
      }
    },
    "api_calls_before": 178,
    "api_calls_after": 178,
    "diff_info": {
      "added_lines": 11,
      "removed_lines": 5,
      "total_diff_lines": 35
    }
  }
}