{
  "status": "completed",
  "commit_dir": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mongo/modified_file/e8cee07ef063b849e89b507dbcb618d48b7cd2fe",
  "file_info": {
    "before_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mongo/modified_file/e8cee07ef063b849e89b507dbcb618d48b7cd2fe/before.cpp",
    "after_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mongo/modified_file/e8cee07ef063b849e89b507dbcb618d48b7cd2fe/after.cpp",
    "diff_file": "/home/zyw/llm_on_code/llm_on_code_optimization/knowledge_base/mongo/modified_file/e8cee07ef063b849e89b507dbcb618d48b7cd2fe/diff.txt"
  },
  "semgrep_analysis": {
    "is_api_change": false,
    "api_changes": {
      "replacements": [
        {
          "line": 1082,
          "old_api": "getConnString",
          "new_api": "sleepsecs",
          "old_text": "toShard.getConnString()",
          "new_text": "sleepsecs( 1 )",
          "old_line_content": "                        ScopedDbConnection::getScopedDbConnection( toShard.getConnString() ) );",
          "new_line_content": "                i < 10 ? sleepmillis( 1 << i ) : sleepsecs( 1 );",
          "content_same": false
        },
        {
          "line": 1097,
          "old_api": "mbUsed",
          "new_api": "done",
          "old_text": "migrateFromStatus.mbUsed()",
          "new_text": "conn->done()",
          "old_line_content": "                LOG(0) << \"moveChunk data transfer progress: \" << res << \" my mem used: \" << migrateFromStatus.mbUsed() << migrateLog;",
          "new_line_content": "                conn->done();",
          "content_same": false
        },
        {
          "line": 1099,
          "old_api": "String",
          "new_api": "mbUsed",
          "old_text": "res[\"state\"].String()",
          "new_text": "migrateFromStatus.mbUsed()",
          "old_line_content": "                if ( ! ok || res[\"state\"].String() == \"fail\" ) {",
          "new_line_content": "                LOG(0) << \"moveChunk data transfer progress: \" << res << \" my mem used: \" << migrateFromStatus.mbUsed() << migrateLog;",
          "content_same": false
        },
        {
          "line": 1102,
          "old_api": "append",
          "new_api": "warning",
          "old_text": "result.append( \"cause\" , res )",
          "new_text": "warning()",
          "old_line_content": "                    result.append( \"cause\" , res );",
          "new_line_content": "                    warning() << \"moveChunk error transferring data caused migration abort: \" << res << migrateLog;",
          "content_same": false
        },
        {
          "line": 1118,
          "old_api": "done",
          "new_api": "BSON",
          "old_text": "conn->done()",
          "new_text": "BSON( \"_recvChunkAbort\" << 1 )",
          "old_line_content": "                    conn->done();",
          "new_line_content": "                    conn->get()->runCommand( \"admin\" , BSON( \"_recvChunkAbort\" << 1 ) , res );",
          "content_same": false
        },
        {
          "line": 1119,
          "old_api": "error",
          "new_api": "getOwned",
          "old_text": "error()",
          "new_text": "res.getOwned()",
          "old_line_content": "                    error() << \"aborting migrate because too much memory used res: \" << res << migrateLog;",
          "new_line_content": "                    res = res.getOwned();",
          "content_same": false
        },
        {
          "line": 1121,
          "old_api": "appendBool",
          "new_api": "error",
          "old_text": "result.appendBool( \"split\" , true )",
          "new_text": "error()",
          "old_line_content": "                    result.appendBool( \"split\" , true );",
          "new_line_content": "                    error() << \"aborting migrate because too much memory used res: \" << res << migrateLog;",
          "content_same": false
        },
        {
          "line": 1127,
          "old_api": "done",
          "new_api": "checkForInterrupt",
          "old_text": "timing.done(4)",
          "new_text": "killCurrentOp.checkForInterrupt()",
          "old_line_content": "            timing.done(4);",
          "new_line_content": "                killCurrentOp.checkForInterrupt();",
          "content_same": false
        },
        {
          "line": 1135,
          "old_api": "incMajor",
          "new_api": "setInCriticalSection",
          "old_text": "myVersion.incMajor()",
          "new_text": "migrateFromStatus.setInCriticalSection( true )",
          "old_line_content": "                myVersion.incMajor();",
          "new_line_content": "                migrateFromStatus.setInCriticalSection( true );",
          "content_same": false
        },
        {
          "line": 1213,
          "old_api": "subobjStart",
          "new_api": "append",
          "old_text": "op.subobjStart( \"o\" )",
          "new_text": "op.append( \"ns\" , ConfigNS::chunk )",
          "old_line_content": "                    BSONObjBuilder n( op.subobjStart( \"o\" ) );",
          "new_line_content": "                    op.append( \"ns\" , ConfigNS::chunk );",
          "content_same": false
        },
        {
          "line": 1215,
          "old_api": "ChunkFields::lastmod()",
          "new_api": "subobjStart",
          "old_text": "ChunkFields::lastmod()",
          "new_text": "op.subobjStart( \"o\" )",
          "old_line_content": "                    myVersion.addToBSON(n, ChunkFields::lastmod());",
          "new_line_content": "                    BSONObjBuilder n( op.subobjStart( \"o\" ) );",
          "content_same": false
        },
        {
          "line": 1216,
          "old_api": "ChunkFields::ns()",
          "new_api": "Chunk::genID(ns, min)",
          "old_text": "ChunkFields::ns()",
          "new_text": "Chunk::genID(ns, min)",
          "old_line_content": "                    n.append(ChunkFields::ns(), ns);",
          "new_line_content": "                    n.append(ChunkFields::name(), Chunk::genID(ns, min));",
          "content_same": false
        },
        {
          "line": 1217,
          "old_api": "ChunkFields::min()",
          "new_api": "ChunkFields::lastmod()",
          "old_text": "ChunkFields::min()",
          "new_text": "ChunkFields::lastmod()",
          "old_line_content": "                    n.append(ChunkFields::min(), min);",
          "new_line_content": "                    myVersion.addToBSON(n, ChunkFields::lastmod());",
          "content_same": false
        },
        {
          "line": 1218,
          "old_api": "ChunkFields::max()",
          "new_api": "ChunkFields::ns()",
          "old_text": "ChunkFields::max()",
          "new_text": "ChunkFields::ns()",
          "old_line_content": "                    n.append(ChunkFields::max(), max);",
          "new_line_content": "                    n.append(ChunkFields::ns(), ns);",
          "content_same": false
        },
        {
          "line": 1219,
          "old_api": "getName",
          "new_api": "ChunkFields::min()",
          "old_text": "toShard.getName()",
          "new_text": "ChunkFields::min()",
          "old_line_content": "                    n.append(ChunkFields::shard(), toShard.getName());",
          "new_line_content": "                    n.append(ChunkFields::min(), min);",
          "content_same": false
        },
        {
          "line": 1220,
          "old_api": "done",
          "new_api": "ChunkFields::max()",
          "old_text": "n.done()",
          "new_text": "ChunkFields::max()",
          "old_line_content": "                    n.done();",
          "new_line_content": "                    n.append(ChunkFields::max(), max);",
          "content_same": false
        },
        {
          "line": 1222,
          "old_api": "subobjStart",
          "new_api": "done",
          "old_text": "op.subobjStart( \"o2\" )",
          "new_text": "n.done()",
          "old_line_content": "                    BSONObjBuilder q( op.subobjStart( \"o2\" ) );",
          "new_line_content": "                    n.done();",
          "content_same": false
        },
        {
          "line": 1224,
          "old_api": "done",
          "new_api": "subobjStart",
          "old_text": "q.done()",
          "new_text": "op.subobjStart( \"o2\" )",
          "old_line_content": "                    q.done();",
          "new_line_content": "                    BSONObjBuilder q( op.subobjStart( \"o2\" ) );",
          "content_same": false
        },
        {
          "line": 1226,
          "old_api": "obj",
          "new_api": "done",
          "old_text": "op.obj()",
          "new_text": "q.done()",
          "old_line_content": "                    updates.append( op.obj() );",
          "new_line_content": "                    q.done();",
          "content_same": false
        },
        {
          "line": 1252,
          "old_api": "incMinor",
          "new_api": "append",
          "old_text": "nextVersion.incMinor()",
          "new_text": "op.append( \"ns\" , ConfigNS::chunk )",
          "old_line_content": "                    nextVersion.incMinor();  // same as used on donateChunk",
          "new_line_content": "                    op.append( \"ns\" , ConfigNS::chunk );",
          "content_same": false
        },
        {
          "line": 1254,
          "old_api": "Chunk::genID(ns, bumpMin)",
          "new_api": "incMinor",
          "old_text": "Chunk::genID(ns, bumpMin)",
          "new_text": "nextVersion.incMinor()",
          "old_line_content": "                    n.append(ChunkFields::name(), Chunk::genID(ns, bumpMin));",
          "new_line_content": "                    nextVersion.incMinor();  // same as used on donateChunk",
          "content_same": false
        },
        {
          "line": 1255,
          "old_api": "ChunkFields::lastmod()",
          "new_api": "subobjStart",
          "old_text": "ChunkFields::lastmod()",
          "new_text": "op.subobjStart( \"o\" )",
          "old_line_content": "                    nextVersion.addToBSON(n, ChunkFields::lastmod());",
          "new_line_content": "                    BSONObjBuilder n( op.subobjStart( \"o\" ) );",
          "content_same": false
        },
        {
          "line": 1256,
          "old_api": "ChunkFields::ns()",
          "new_api": "Chunk::genID(ns, bumpMin)",
          "old_text": "ChunkFields::ns()",
          "new_text": "Chunk::genID(ns, bumpMin)",
          "old_line_content": "                    n.append(ChunkFields::ns(), ns);",
          "new_line_content": "                    n.append(ChunkFields::name(), Chunk::genID(ns, bumpMin));",
          "content_same": false
        },
        {
          "line": 1257,
          "old_api": "ChunkFields::min()",
          "new_api": "ChunkFields::lastmod()",
          "old_text": "ChunkFields::min()",
          "new_text": "ChunkFields::lastmod()",
          "old_line_content": "                    n.append(ChunkFields::min(), bumpMin);",
          "new_line_content": "                    nextVersion.addToBSON(n, ChunkFields::lastmod());",
          "content_same": false
        },
        {
          "line": 1258,
          "old_api": "ChunkFields::max()",
          "new_api": "ChunkFields::ns()",
          "old_text": "ChunkFields::max()",
          "new_text": "ChunkFields::ns()",
          "old_line_content": "                    n.append(ChunkFields::max(), bumpMax);",
          "new_line_content": "                    n.append(ChunkFields::ns(), ns);",
          "content_same": false
        },
        {
          "line": 1259,
          "old_api": "getName",
          "new_api": "ChunkFields::min()",
          "old_text": "fromShard.getName()",
          "new_text": "ChunkFields::min()",
          "old_line_content": "                    n.append(ChunkFields::shard(), fromShard.getName());",
          "new_line_content": "                    n.append(ChunkFields::min(), bumpMin);",
          "content_same": false
        },
        {
          "line": 1260,
          "old_api": "done",
          "new_api": "ChunkFields::max()",
          "old_text": "n.done()",
          "new_text": "ChunkFields::max()",
          "old_line_content": "                    n.done();",
          "new_line_content": "                    n.append(ChunkFields::max(), bumpMax);",
          "content_same": false
        },
        {
          "line": 1262,
          "old_api": "subobjStart",
          "new_api": "done",
          "old_text": "op.subobjStart( \"o2\" )",
          "new_text": "n.done()",
          "old_line_content": "                    BSONObjBuilder q( op.subobjStart( \"o2\" ) );",
          "new_line_content": "                    n.done();",
          "content_same": false
        },
        {
          "line": 1264,
          "old_api": "done",
          "new_api": "subobjStart",
          "old_text": "q.done()",
          "new_text": "op.subobjStart( \"o2\" )",
          "old_line_content": "                    q.done();",
          "new_line_content": "                    BSONObjBuilder q( op.subobjStart( \"o2\" ) );",
          "content_same": false
        },
        {
          "line": 1266,
          "old_api": "obj",
          "new_api": "done",
          "old_text": "op.obj()",
          "new_text": "q.done()",
          "old_line_content": "                    updates.append( op.obj() );",
          "new_line_content": "                    q.done();",
          "content_same": false
        },
        {
          "line": 1268,
          "old_api": "log",
          "new_api": "obj",
          "old_text": "log()",
          "new_text": "op.obj()",
          "old_line_content": "                    log() << \"moveChunk updating self version to: \" << nextVersion << \" through \"",
          "new_line_content": "                    updates.append( op.obj() );",
          "content_same": false
        },
        {
          "line": 1279,
          "old_api": "subarrayStart",
          "new_api": "done",
          "old_text": "cmdBuilder.subarrayStart( \"preCondition\" )",
          "new_text": "updates.done()",
          "old_line_content": "                BSONArrayBuilder preCond( cmdBuilder.subarrayStart( \"preCondition\" ) );",
          "new_line_content": "                updates.done();",
          "content_same": false
        },
        {
          "line": 1284,
          "old_api": "ChunkFields::lastmod()",
          "new_api": "append",
          "old_text": "ChunkFields::lastmod()",
          "new_text": "b.append(\"ns\", ConfigNS::chunk)",
          "old_line_content": "                                       \"orderby\" << BSON(ChunkFields::lastmod() << -1)));",
          "new_line_content": "                    b.append(\"ns\", ConfigNS::chunk);",
          "content_same": false
        },
        {
          "line": 1286,
          "old_api": "subobjStart",
          "new_api": "ChunkFields::lastmod()",
          "old_text": "b.subobjStart( \"res\" )",
          "new_text": "ChunkFields::lastmod()",
          "old_line_content": "                        BSONObjBuilder bb( b.subobjStart( \"res\" ) );",
          "new_line_content": "                                       \"orderby\" << BSON(ChunkFields::lastmod() << -1)));",
          "content_same": false
        },
        {
          "line": 1288,
          "old_api": "toLong",
          "new_api": "subobjStart",
          "old_text": "maxVersion.toLong()",
          "new_text": "b.subobjStart( \"res\" )",
          "old_line_content": "                        bb.appendTimestamp(ChunkFields::lastmod(), maxVersion.toLong());",
          "new_line_content": "                        BSONObjBuilder bb( b.subobjStart( \"res\" ) );",
          "content_same": false
        },
        {
          "line": 1291,
          "old_api": "obj",
          "new_api": "done",
          "old_text": "b.obj()",
          "new_text": "bb.done()",
          "old_line_content": "                    preCond.append( b.obj() );",
          "new_line_content": "                        bb.done();",
          "content_same": false
        },
        {
          "line": 1296,
          "old_api": "obj",
          "new_api": "done",
          "old_text": "cmdBuilder.obj()",
          "new_text": "preCond.done()",
          "old_line_content": "                BSONObj cmd = cmdBuilder.obj();",
          "new_line_content": "                preCond.done();",
          "content_same": false
        },
        {
          "line": 1306,
          "old_api": "get",
          "new_api": "getConfigServer",
          "old_text": "conn->get()->runCommand( \"config\" , cmd , cmdResult )",
          "new_text": "shardingState.getConfigServer()",
          "old_line_content": "                    ok = conn->get()->runCommand( \"config\" , cmd , cmdResult );",
          "new_line_content": "                                    shardingState.getConfigServer(),",
          "content_same": false
        },
        {
          "line": 1339,
          "old_api": "ChunkFields::lastmod()",
          "new_api": "sort",
          "old_text": "ChunkFields::lastmod()",
          "new_text": "conn->get()->findOne(ConfigNS::chunk,\n                                                           Query(BSON(ChunkFields::ns(ns)))\n                                                               .sort(BSON(ChunkFields::lastmod() << -1)))",
          "old_line_content": "                                                               .sort(BSON(ChunkFields::lastmod() << -1)));",
          "new_line_content": "                        BSONObj doc = conn->get()->findOne(ConfigNS::chunk,",
          "content_same": false
        },
        {
          "line": 1344,
          "old_api": "isEquivalentTo",
          "new_api": "ChunkFields::lastmod()",
          "old_text": "checkVersion.isEquivalentTo( nextVersion )",
          "new_text": "ChunkFields::lastmod()",
          "old_line_content": "                        if ( checkVersion.isEquivalentTo( nextVersion ) ) {",
          "new_line_content": "                            ShardChunkVersion::fromBSON(doc[ChunkFields::lastmod()]);",
          "content_same": false
        },
        {
          "line": 1361,
          "old_api": "dbexit",
          "new_api": "error",
          "old_text": "dbexit( EXIT_SHARDING_ERROR )",
          "new_text": "error()",
          "old_line_content": "                        dbexit( EXIT_SHARDING_ERROR );",
          "new_line_content": "                        error() << \"moveChunk failed to get confirmation of commit\" << migrateLog;",
          "content_same": false
        },
        {
          "line": 1382,
          "old_api": "ClientCursor::find( ns , c.initial )",
          "new_api": "getOwned",
          "old_text": "ClientCursor::find( ns , c.initial )",
          "new_text": "max.getOwned()",
          "old_line_content": "                ClientCursor::find( ns , c.initial );",
          "new_line_content": "                c.max = max.getOwned();",
          "content_same": false
        },
        {
          "line": 1383,
          "old_api": "size",
          "new_api": "getOwned",
          "old_text": "c.initial.size()",
          "new_text": "shardKeyPattern.getOwned()",
          "old_line_content": "                if ( c.initial.size() ) {",
          "new_line_content": "                c.shardKeyPattern = shardKeyPattern.getOwned();",
          "content_same": false
        },
        {
          "line": 1384,
          "old_api": "log",
          "new_api": "ClientCursor::find( ns , c.initial )",
          "old_text": "log()",
          "new_text": "ClientCursor::find( ns , c.initial )",
          "old_line_content": "                    log() << \"forking for cleaning up chunk data\" << migrateLog;",
          "new_line_content": "                ClientCursor::find( ns , c.initial );",
          "content_same": false
        },
        {
          "line": 1385,
          "old_api": "boost::bind( &cleanupOldData , c )",
          "new_api": "size",
          "old_text": "boost::bind( &cleanupOldData , c )",
          "new_text": "c.initial.size()",
          "old_line_content": "                    boost::thread t( boost::bind( &cleanupOldData , c ) );",
          "new_line_content": "                if ( c.initial.size() ) {",
          "content_same": false
        },
        {
          "line": 1390,
          "old_api": "doRemove",
          "new_api": "log",
          "old_text": "c.doRemove()",
          "new_text": "log()",
          "old_line_content": "                    c.doRemove();",
          "new_line_content": "                    log() << \"doing delete inline\" << migrateLog;",
          "content_same": false
        },
        {
          "line": 1454,
          "old_api": "setActive",
          "new_api": "error",
          "old_text": "setActive( false )",
          "new_text": "error()",
          "old_line_content": "            setActive( false );",
          "new_line_content": "                error() << \"migrate failed with unknown exception\" << migrateLog;",
          "content_same": false
        },
        {
          "line": 1460,
          "old_api": "isEmpty",
          "new_api": "getActive",
          "old_text": "min.isEmpty()",
          "new_text": "getActive()",
          "old_line_content": "            verify( ! min.isEmpty() );",
          "new_line_content": "            verify( getActive() );",
          "content_same": false
        },
        {
          "line": 1461,
          "old_api": "isEmpty",
          "new_api": "verify",
          "old_text": "max.isEmpty()",
          "new_text": "verify( state == READY )",
          "old_line_content": "            verify( ! max.isEmpty() );",
          "new_line_content": "            verify( state == READY );",
          "content_same": false
        },
        {
          "line": 1463,
          "old_api": "getSlaveCount",
          "new_api": "isEmpty",
          "old_text": "getSlaveCount()",
          "new_text": "max.isEmpty()",
          "old_line_content": "            slaveCount = ( getSlaveCount() / 2 ) + 1;",
          "new_line_content": "            verify( ! max.isEmpty() );",
          "content_same": false
        },
        {
          "line": 1479,
          "old_api": "BSON",
          "new_api": "c_str",
          "old_text": "BSON( \"name\" << ns )",
          "new_text": "ns.c_str()",
          "old_line_content": "                    BSONObj entry = conn->findOne( system_namespaces, BSON( \"name\" << ns ) );",
          "new_line_content": "                if ( ! nsdetails( ns.c_str() ) ) {",
          "content_same": false
        },
        {
          "line": 1480,
          "old_api": "isABSONObj",
          "new_api": "NamespaceString",
          "old_text": "entry[\"options\"].isABSONObj()",
          "new_text": "NamespaceString( ns )",
          "old_line_content": "                    if ( entry[\"options\"].isABSONObj() ) {",
          "new_line_content": "                    string system_namespaces = NamespaceString( ns ).db + \".system.namespaces\";",
          "content_same": false
        },
        {
          "line": 1482,
          "old_api": "Obj",
          "new_api": "isABSONObj",
          "old_text": "entry[\"options\"].Obj()",
          "new_text": "entry[\"options\"].isABSONObj()",
          "old_line_content": "                        if ( ! userCreateNS( ns.c_str(), entry[\"options\"].Obj(), errmsg, true, 0 ) )",
          "new_line_content": "                    if ( entry[\"options\"].isABSONObj() ) {",
          "content_same": false
        },
        {
          "line": 1496,
          "old_api": "more",
          "new_api": "getIndexes",
          "old_text": "indexes->more()",
          "new_text": "conn->getIndexes( ns )",
          "old_line_content": "                    while ( indexes->more() ) {",
          "new_line_content": "                    auto_ptr<DBClientCursor> indexes = conn->getIndexes( ns );",
          "content_same": false
        },
        {
          "line": 1525,
          "old_api": "done",
          "new_api": "warning",
          "old_text": "timing.done(2)",
          "new_text": "warning()",
          "old_line_content": "                timing.done(2);",
          "new_line_content": "                    warning() << \"moveChunkCmd deleted data already in chunk # objects: \" << num << migrateLog;",
          "content_same": false
        },
        {
          "line": 1540,
          "old_api": "done",
          "new_api": "toString",
          "old_text": "conn.done()",
          "new_text": "res.toString()",
          "old_line_content": "                        conn.done();",
          "new_line_content": "                        errmsg += res.toString();",
          "content_same": false
        },
        {
          "line": 1594,
          "old_api": "done",
          "new_api": "toString",
          "old_text": "conn.done()",
          "new_text": "res.toString()",
          "old_line_content": "                        conn.done();",
          "new_line_content": "                        errmsg += res.toString();",
          "content_same": false
        },
        {
          "line": 1639,
          "old_api": "sleepsecs",
          "new_api": "flushPendingWrites",
          "old_text": "sleepsecs(1)",
          "new_text": "flushPendingWrites( lastOpApplied )",
          "old_line_content": "                    sleepsecs(1);",
          "new_line_content": "                    if ( flushPendingWrites( lastOpApplied ) )",
          "content_same": false
        },
        {
          "line": 1651,
          "old_api": "toString",
          "new_api": "BSON",
          "old_text": "res.toString()",
          "new_text": "BSON( \"_transferMods\" << 1 )",
          "old_line_content": "                        errmsg = res.toString();",
          "new_line_content": "                    if ( ! conn->runCommand( \"admin\" , BSON( \"_transferMods\" << 1 ) , res ) ) {",
          "content_same": false
        },
        {
          "line": 1653,
          "old_api": "done",
          "new_api": "toString",
          "old_text": "conn.done()",
          "new_text": "res.toString()",
          "old_line_content": "                        conn.done();",
          "new_line_content": "                        errmsg = res.toString();",
          "content_same": false
        },
        {
          "line": 1688,
          "old_api": "append",
          "new_api": "getActive",
          "old_text": "b.append( \"ns\" , ns )",
          "new_text": "getActive()",
          "old_line_content": "            b.append( \"ns\" , ns );",
          "new_line_content": "            b.appendBool( \"active\" , getActive() );",
          "content_same": false
        },
        {
          "line": 1694,
          "old_api": "stateString",
          "new_api": "append",
          "old_text": "stateString()",
          "new_text": "b.append( \"shardKeyPattern\" , shardKeyPattern )",
          "old_line_content": "            b.append( \"state\" , stateString() );",
          "new_line_content": "            b.append( \"shardKeyPattern\" , shardKeyPattern );",
          "content_same": false
        },
        {
          "line": 1696,
          "old_api": "append",
          "new_api": "stateString",
          "old_text": "b.append( \"errmsg\" , errmsg )",
          "new_text": "stateString()",
          "old_line_content": "                b.append( \"errmsg\" , errmsg );",
          "new_line_content": "            b.append( \"state\" , stateString() );",
          "content_same": false
        },
        {
          "line": 1698,
          "old_api": "subobjStart",
          "new_api": "append",
          "old_text": "b.subobjStart( \"counts\" )",
          "new_text": "b.append( \"errmsg\" , errmsg )",
          "old_line_content": "                BSONObjBuilder bb( b.subobjStart( \"counts\" ) );",
          "new_line_content": "                b.append( \"errmsg\" , errmsg );",
          "content_same": false
        },
        {
          "line": 1700,
          "old_api": "append",
          "new_api": "subobjStart",
          "old_text": "bb.append( \"clonedBytes\" , clonedBytes )",
          "new_text": "b.subobjStart( \"counts\" )",
          "old_line_content": "                bb.append( \"clonedBytes\" , clonedBytes );",
          "new_line_content": "                BSONObjBuilder bb( b.subobjStart( \"counts\" ) );",
          "content_same": false
        },
        {
          "line": 1703,
          "old_api": "done",
          "new_api": "append",
          "old_text": "bb.done()",
          "new_text": "bb.append( \"catchup\" , numCatchup )",
          "old_line_content": "                bb.done();",
          "new_line_content": "                bb.append( \"catchup\" , numCatchup );",
          "content_same": false
        },
        {
          "line": 1730,
          "old_api": "log",
          "new_api": "c_str",
          "old_text": "log()",
          "new_text": "ns.c_str()",
          "old_line_content": "                            log() << \"not applying out of range deletion: \" << fullObj << migrateLog;",
          "new_line_content": "                    if ( Helpers::findById( cc() , ns.c_str() , id, fullObj ) ) {",
          "content_same": false
        },
        {
          "line": 1758,
          "old_api": "more",
          "new_api": "isABSONObj",
          "old_text": "i.more()",
          "new_text": "xfer[\"reload\"].isABSONObj()",
          "old_line_content": "                while ( i.more() ) {",
          "new_line_content": "            if ( xfer[\"reload\"].isABSONObj() ) {",
          "content_same": false
        },
        {
          "line": 1763,
          "old_api": "Helpers::upsert( ns , it , true )",
          "new_api": "next",
          "old_text": "Helpers::upsert( ns , it , true )",
          "new_text": "i.next().Obj()",
          "old_line_content": "                    Helpers::upsert( ns , it , true );",
          "new_line_content": "                    BSONObj it = i.next().Obj();",
          "content_same": false
        },
        {
          "line": 1765,
          "old_api": "ctx",
          "new_api": "Helpers::upsert( ns , it , true )",
          "old_text": "cx.ctx().getClient()->getLastOp().asDate()",
          "new_text": "Helpers::upsert( ns , it , true )",
          "old_line_content": "                    *lastOpApplied = cx.ctx().getClient()->getLastOp().asDate();",
          "new_line_content": "                    Helpers::upsert( ns , it , true );",
          "content_same": false
        },
        {
          "line": 1870,
          "old_api": "ShardedConnectionInfo::addHook()",
          "new_api": "Client::initThread( \"migrateThread\" )",
          "old_text": "ShardedConnectionInfo::addHook()",
          "new_text": "Client::initThread( \"migrateThread\" )",
          "old_line_content": "            ShardedConnectionInfo::addHook();",
          "new_line_content": "        Client::initThread( \"migrateThread\" );",
          "content_same": false
        },
        {
          "line": 1873,
          "old_api": "go",
          "new_api": "getAuthenticationInfo",
          "old_text": "migrateStatus.go()",
          "new_text": "cc().getAuthenticationInfo()->authorize(\"local\", internalSecurity.user)",
          "old_line_content": "        migrateStatus.go();",
          "new_line_content": "            cc().getAuthenticationInfo()->authorize(\"local\", internalSecurity.user);",
          "content_same": false
        },
        {
          "line": 1901,
          "old_api": "prepare",
          "new_api": "String",
          "old_text": "migrateStatus.prepare()",
          "new_text": "cmdObj[\"configServer\"].String()",
          "old_line_content": "            migrateStatus.prepare();",
          "new_line_content": "                configServer.init( cmdObj[\"configServer\"].String() );",
          "content_same": false
        },
        {
          "line": 1903,
          "old_api": "firstElement",
          "new_api": "prepare",
          "old_text": "cmdObj.firstElement().String()",
          "new_text": "migrateStatus.prepare()",
          "old_line_content": "            migrateStatus.ns = cmdObj.firstElement().String();",
          "new_line_content": "            migrateStatus.prepare();",
          "content_same": false
        },
        {
          "line": 1905,
          "old_api": "Obj",
          "new_api": "firstElement",
          "old_text": "cmdObj[\"min\"].Obj().getOwned()",
          "new_text": "cmdObj.firstElement().String()",
          "old_line_content": "            migrateStatus.min = cmdObj[\"min\"].Obj().getOwned();",
          "new_line_content": "            migrateStatus.ns = cmdObj.firstElement().String();",
          "content_same": false
        },
        {
          "line": 1906,
          "old_api": "Obj",
          "new_api": "String",
          "old_text": "cmdObj[\"max\"].Obj().getOwned()",
          "new_text": "cmdObj[\"from\"].String()",
          "old_line_content": "            migrateStatus.max = cmdObj[\"max\"].Obj().getOwned();",
          "new_line_content": "            migrateStatus.from = cmdObj[\"from\"].String();",
          "content_same": false
        },
        {
          "line": 1907,
          "old_api": "trueValue",
          "new_api": "Obj",
          "old_text": "cmdObj[\"secondaryThrottle\"].trueValue()",
          "new_text": "cmdObj[\"min\"].Obj().getOwned()",
          "old_line_content": "            migrateStatus.secondaryThrottle = cmdObj[\"secondaryThrottle\"].trueValue();",
          "new_line_content": "            migrateStatus.min = cmdObj[\"min\"].Obj().getOwned();",
          "content_same": false
        },
        {
          "line": 1908,
          "old_api": "hasField",
          "new_api": "Obj",
          "old_text": "cmdObj.hasField(\"shardKeyPattern\")",
          "new_text": "cmdObj[\"max\"].Obj().getOwned()",
          "old_line_content": "            if (cmdObj.hasField(\"shardKeyPattern\")) {",
          "new_line_content": "            migrateStatus.max = cmdObj[\"max\"].Obj().getOwned();",
          "content_same": false
        },
        {
          "line": 1909,
          "old_api": "Obj",
          "new_api": "trueValue",
          "old_text": "cmdObj[\"shardKeyPattern\"].Obj().getOwned()",
          "new_text": "cmdObj[\"secondaryThrottle\"].trueValue()",
          "old_line_content": "                migrateStatus.shardKeyPattern = cmdObj[\"shardKeyPattern\"].Obj().getOwned();",
          "new_line_content": "            migrateStatus.secondaryThrottle = cmdObj[\"secondaryThrottle\"].trueValue();",
          "content_same": false
        },
        {
          "line": 1917,
          "old_api": "verify",
          "new_api": "Helpers::toKeyFormat( migrateStatus.min , keya )",
          "old_text": "verify( keya == keyb )",
          "new_text": "Helpers::toKeyFormat( migrateStatus.min , keya )",
          "old_line_content": "                verify( keya == keyb );",
          "new_line_content": "                Helpers::toKeyFormat( migrateStatus.min , keya );",
          "content_same": false
        },
        {
          "line": 1919,
          "old_api": "warning",
          "new_api": "verify",
          "old_text": "warning()",
          "new_text": "verify( keya == keyb )",
          "old_line_content": "                warning() << \"No shard key pattern provided by source shard for migration.\"",
          "new_line_content": "                verify( keya == keyb );",
          "content_same": false
        },
        {
          "line": 1992,
          "old_api": "firstElement",
          "new_api": "BSON",
          "old_text": "obj.firstElement()",
          "new_text": "BSON( \"n\" << 3 )",
          "old_line_content": "            BSONObj max2 = BSON( \"x\" << BSONElementHasher::hash64( obj.firstElement() , 0 ) + 2 );",
          "new_line_content": "            BSONObj obj = BSON( \"n\" << 3 );",
          "content_same": false
        },
        {
          "line": 1993,
          "old_api": "BSON",
          "new_api": "firstElement",
          "old_text": "BSON( \"x\" << \"hashed\" )",
          "new_text": "obj.firstElement()",
          "old_line_content": "            BSONObj hashedKey =  BSON( \"x\" << \"hashed\" );",
          "new_line_content": "            BSONObj min2 = BSON( \"x\" << BSONElementHasher::hash64( obj.firstElement() , 0 ) - 2 );",
          "content_same": false
        },
        {
          "line": 1999,
          "old_api": "LOG",
          "new_api": "BSON",
          "old_text": "LOG(1)",
          "new_text": "BSON( \"x\" << 4 )",
          "old_line_content": "            LOG(1) << \"isInRangeTest passed\" << migrateLog;",
          "new_line_content": "            verify( ! isInRange( BSON( \"x\" << 4 ) , min2 , max2 , hashedKey ) );",
          "content_same": false
        }
      ],
      "additions": [
        {
          "line": 1537,
          "old_api": null,
          "new_api": "BSON",
          "old_text": null,
          "new_text": "BSON( \"_migrateClone\" << 1 )",
          "old_line_content": "                        errmsg = \"_migrateClone failed: \";",
          "new_line_content": "                    if ( ! conn->runCommand( \"admin\" , BSON( \"_migrateClone\" << 1 ) , res ) ) {  // gets array of objects to copy, in disk order",
          "content_same": false
        },
        {
          "line": 1541,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error()",
          "old_line_content": "                        return;",
          "new_line_content": "                        error() << errmsg << migrateLog;",
          "content_same": false
        },
        {
          "line": 1542,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "conn.done()",
          "old_line_content": "                    }",
          "new_line_content": "                        conn.done();",
          "content_same": false
        },
        {
          "line": 1546,
          "old_api": null,
          "new_api": "Obj",
          "old_text": null,
          "new_text": "res[\"objects\"].Obj()",
          "old_line_content": "",
          "new_line_content": "                    BSONObj arr = res[\"objects\"].Obj();",
          "content_same": false
        },
        {
          "line": 1550,
          "old_api": null,
          "new_api": "more",
          "old_text": null,
          "new_text": "i.more()",
          "old_line_content": "                        {",
          "new_line_content": "                    while( i.more() ) {",
          "content_same": false
        },
        {
          "line": 1551,
          "old_api": null,
          "new_api": "next",
          "old_text": null,
          "new_text": "i.next().Obj()",
          "old_line_content": "                            PageFaultRetryableSection pgrs;",
          "new_line_content": "                        BSONObj o = i.next().Obj();",
          "content_same": false
        },
        {
          "line": 1557,
          "old_api": null,
          "new_api": "Helpers::upsert( ns, o, true )",
          "old_text": null,
          "new_text": "Helpers::upsert( ns, o, true )",
          "old_line_content": "                                }",
          "new_line_content": "                                    Helpers::upsert( ns, o, true );",
          "content_same": false
        },
        {
          "line": 1561,
          "old_api": null,
          "new_api": "touch",
          "old_text": null,
          "new_text": "e.touch()",
          "old_line_content": "                            }",
          "new_line_content": "                                    e.touch();",
          "content_same": false
        },
        {
          "line": 1567,
          "old_api": null,
          "new_api": "objsize",
          "old_text": null,
          "new_text": "o.objsize()",
          "old_line_content": "                        if ( secondaryThrottle && thisTime > 0 ) {",
          "new_line_content": "                        clonedBytes += o.objsize();",
          "content_same": false
        },
        {
          "line": 1570,
          "old_api": null,
          "new_api": "getLastOp",
          "old_text": null,
          "new_text": "cc().getLastOp()",
          "old_line_content": "                            }",
          "new_line_content": "                            if ( ! waitForReplication( cc().getLastOp(), 2, 60 /* seconds to wait */ ) ) {",
          "content_same": false
        },
        {
          "line": 1571,
          "old_api": null,
          "new_api": "warning",
          "old_text": null,
          "new_text": "warning()",
          "old_line_content": "                        }",
          "new_line_content": "                                warning() << \"secondaryThrottle on, but doc insert timed out after 60 seconds, continuing\" << endl;",
          "content_same": false
        },
        {
          "line": 1580,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "timing.done(3)",
          "old_line_content": "",
          "new_line_content": "                timing.done(3);",
          "content_same": false
        },
        {
          "line": 1584,
          "old_api": null,
          "new_api": "getLastOp",
          "old_text": null,
          "new_text": "cc().getLastOp().asDate()",
          "old_line_content": "            {",
          "new_line_content": "            ReplTime lastOpApplied = cc().getLastOp().asDate();",
          "content_same": false
        },
        {
          "line": 1591,
          "old_api": null,
          "new_api": "BSON",
          "old_text": null,
          "new_text": "BSON( \"_transferMods\" << 1 )",
          "old_line_content": "                        errmsg = \"_transferMods failed: \";",
          "new_line_content": "                    if ( ! conn->runCommand( \"admin\" , BSON( \"_transferMods\" << 1 ) , res ) ) {",
          "content_same": false
        },
        {
          "line": 1595,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error()",
          "old_line_content": "                        return;",
          "new_line_content": "                        error() << \"_transferMods failed: \" << res << migrateLog;",
          "content_same": false
        },
        {
          "line": 1084,
          "old_api": null,
          "new_api": "getConnString",
          "old_text": null,
          "new_text": "toShard.getConnString()",
          "old_line_content": "                bool ok;",
          "new_line_content": "                        ScopedDbConnection::getScopedDbConnection( toShard.getConnString() ) );",
          "content_same": false
        },
        {
          "line": 1596,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "conn.done()",
          "old_line_content": "                    }",
          "new_line_content": "                        conn.done();",
          "content_same": false
        },
        {
          "line": 1599,
          "old_api": null,
          "new_api": "number",
          "old_text": null,
          "new_text": "res[\"size\"].number()",
          "old_line_content": "",
          "new_line_content": "                    if ( res[\"size\"].number() == 0 )",
          "content_same": false
        },
        {
          "line": 1088,
          "old_api": null,
          "new_api": "BSON",
          "old_text": null,
          "new_text": "BSON( \"_recvChunkStatus\" << 1 )",
          "old_line_content": "                }",
          "new_line_content": "                    ok = conn->get()->runCommand( \"admin\" , BSON( \"_recvChunkStatus\" << 1 ) , res );",
          "content_same": false
        },
        {
          "line": 1089,
          "old_api": null,
          "new_api": "getOwned",
          "old_text": null,
          "new_text": "res.getOwned()",
          "old_line_content": "                catch( DBException& e ){",
          "new_line_content": "                    res = res.getOwned();",
          "content_same": false
        },
        {
          "line": 1602,
          "old_api": null,
          "new_api": "apply",
          "old_text": null,
          "new_text": "apply( res , &lastOpApplied )",
          "old_line_content": "                    const int maxIterations = 3600*50;",
          "new_line_content": "                    apply( res , &lastOpApplied );",
          "content_same": false
        },
        {
          "line": 1092,
          "old_api": null,
          "new_api": "causedBy",
          "old_text": null,
          "new_text": "causedBy( e )",
          "old_line_content": "                    return false;",
          "new_line_content": "                    errmsg = str::stream() << \"moveChunk could not contact to: shard \" << to << \" to monitor transfer\" << causedBy( e );",
          "content_same": false
        },
        {
          "line": 1093,
          "old_api": null,
          "new_api": "warning",
          "old_text": null,
          "new_text": "warning()",
          "old_line_content": "                }",
          "new_line_content": "                    warning() << errmsg << endl;",
          "content_same": false
        },
        {
          "line": 1608,
          "old_api": null,
          "new_api": "note",
          "old_text": null,
          "new_text": "timing.note( \"aborted\" )",
          "old_line_content": "                        }",
          "new_line_content": "                            timing.note( \"aborted\" );",
          "content_same": false
        },
        {
          "line": 1612,
          "old_api": null,
          "new_api": "opReplicatedEnough",
          "old_text": null,
          "new_text": "opReplicatedEnough( lastOpApplied )",
          "old_line_content": "                        ",
          "new_line_content": "                        if ( opReplicatedEnough( lastOpApplied ) )",
          "content_same": false
        },
        {
          "line": 1101,
          "old_api": null,
          "new_api": "String",
          "old_text": null,
          "new_text": "res[\"state\"].String()",
          "old_line_content": "                    errmsg = \"data transfer error\";",
          "new_line_content": "                if ( ! ok || res[\"state\"].String() == \"fail\" ) {",
          "content_same": false
        },
        {
          "line": 1104,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "result.append( \"cause\" , res )",
          "old_line_content": "                }",
          "new_line_content": "                    result.append( \"cause\" , res );",
          "content_same": false
        },
        {
          "line": 1616,
          "old_api": null,
          "new_api": "warning",
          "old_text": null,
          "new_text": "warning()",
          "old_line_content": "",
          "new_line_content": "                            warning() << \"secondaries having hard time keeping up with migrate\" << migrateLog;",
          "content_same": false
        },
        {
          "line": 1619,
          "old_api": null,
          "new_api": "sleepmillis",
          "old_text": null,
          "new_text": "sleepmillis( 20 )",
          "old_line_content": "",
          "new_line_content": "                        sleepmillis( 20 );",
          "content_same": false
        },
        {
          "line": 1108,
          "old_api": null,
          "new_api": "String",
          "old_text": null,
          "new_text": "res[\"state\"].String()",
          "old_line_content": "",
          "new_line_content": "                if ( res[\"state\"].String() == \"steady\" )",
          "content_same": false
        },
        {
          "line": 1111,
          "old_api": null,
          "new_api": "mbUsed",
          "old_text": null,
          "new_text": "migrateFromStatus.mbUsed()",
          "old_line_content": "                    // so we're going to abort the migrate",
          "new_line_content": "                if ( migrateFromStatus.mbUsed() > (500 * 1024 * 1024) ) {",
          "content_same": false
        },
        {
          "line": 1624,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error()",
          "old_line_content": "                        state = FAIL;",
          "new_line_content": "                        error() << errmsg << migrateLog;",
          "content_same": false
        },
        {
          "line": 1625,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "conn.done()",
          "old_line_content": "                        return;",
          "new_line_content": "                        conn.done();",
          "content_same": false
        },
        {
          "line": 1115,
          "old_api": null,
          "new_api": "getConnString",
          "old_text": null,
          "new_text": "toShard.getConnString()",
          "old_line_content": "                    BSONObj res;",
          "new_line_content": "                            ScopedDbConnection::getScopedDbConnection( toShard.getConnString() ) );",
          "content_same": false
        },
        {
          "line": 1631,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "timing.done(4)",
          "old_line_content": "",
          "new_line_content": "                timing.done(4);",
          "content_same": false
        },
        {
          "line": 1120,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "conn->done()",
          "old_line_content": "                    errmsg = \"aborting migrate because too much memory used\";",
          "new_line_content": "                    conn->done();",
          "content_same": false
        },
        {
          "line": 1123,
          "old_api": null,
          "new_api": "appendBool",
          "old_text": null,
          "new_text": "result.appendBool( \"split\" , true )",
          "old_line_content": "                }",
          "new_line_content": "                    result.appendBool( \"split\" , true );",
          "content_same": false
        },
        {
          "line": 1638,
          "old_api": null,
          "new_api": "minutes",
          "old_text": null,
          "new_text": "t.minutes()",
          "old_line_content": "                        break;",
          "new_line_content": "                while ( t.minutes() < 600 ) {",
          "content_same": false
        },
        {
          "line": 1129,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "timing.done(4)",
          "old_line_content": "            // 5.",
          "new_line_content": "            timing.done(4);",
          "content_same": false
        },
        {
          "line": 1641,
          "old_api": null,
          "new_api": "sleepsecs",
          "old_text": null,
          "new_text": "sleepsecs(1)",
          "old_line_content": "            }",
          "new_line_content": "                    sleepsecs(1);",
          "content_same": false
        },
        {
          "line": 1137,
          "old_api": null,
          "new_api": "incMajor",
          "old_text": null,
          "new_text": "myVersion.incMajor()",
          "old_line_content": "                {",
          "new_line_content": "                myVersion.incMajor();",
          "content_same": false
        },
        {
          "line": 1652,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "                        state = FAIL;",
          "new_line_content": "                        log() << \"_transferMods failed in STEADY state: \" << res << migrateLog;",
          "content_same": false
        },
        {
          "line": 1141,
          "old_api": null,
          "new_api": "getVersion",
          "old_text": null,
          "new_text": "shardingState.getVersion( ns )",
          "old_line_content": "                    // bump the chunks manager's version up and \"forget\" about the chunk being moved",
          "new_line_content": "                    verify( myVersion > shardingState.getVersion( ns ) );",
          "content_same": false
        },
        {
          "line": 1655,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "conn.done()",
          "old_line_content": "                    }",
          "new_line_content": "                        conn.done();",
          "content_same": false
        },
        {
          "line": 1145,
          "old_api": null,
          "new_api": "donateChunk",
          "old_text": null,
          "new_text": "shardingState.donateChunk( ns , min , max , myVersion )",
          "old_line_content": "",
          "new_line_content": "                    shardingState.donateChunk( ns , min , max , myVersion );",
          "content_same": false
        },
        {
          "line": 1659,
          "old_api": null,
          "new_api": "apply",
          "old_text": null,
          "new_text": "apply( res , &lastOpApplied )",
          "old_line_content": "",
          "new_line_content": "                    if ( res[\"size\"].number() > 0 && apply( res , &lastOpApplied ) )",
          "content_same": false
        },
        {
          "line": 1148,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "                // 5.b",
          "new_line_content": "                log() << \"moveChunk setting version to: \" << myVersion << migrateLog;",
          "content_same": false
        },
        {
          "line": 1663,
          "old_api": null,
          "new_api": "note",
          "old_text": null,
          "new_text": "timing.note( \"aborted\" )",
          "old_line_content": "                    }",
          "new_line_content": "                        timing.note( \"aborted\" );",
          "content_same": false
        },
        {
          "line": 1156,
          "old_api": null,
          "new_api": "getConnString",
          "old_text": null,
          "new_text": "toShard.getConnString()",
          "old_line_content": "",
          "new_line_content": "                            ScopedDbConnection::getScopedDbConnection( toShard.getConnString(),",
          "content_same": false
        },
        {
          "line": 1668,
          "old_api": null,
          "new_api": "flushPendingWrites",
          "old_text": null,
          "new_text": "flushPendingWrites( lastOpApplied )",
          "old_line_content": "                    }",
          "new_line_content": "                        if ( flushPendingWrites( lastOpApplied ) )",
          "content_same": false
        },
        {
          "line": 1672,
          "old_api": null,
          "new_api": "sleepmillis",
          "old_text": null,
          "new_text": "sleepmillis( 10 )",
          "old_line_content": "",
          "new_line_content": "                    sleepmillis( 10 );",
          "content_same": false
        },
        {
          "line": 1162,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "connTo->get()->runCommand( \"admin\" ,\n                                                        BSON( \"_recvChunkCommit\" << 1 ) ,\n                                                        res )",
          "old_line_content": "                                                        res );",
          "new_line_content": "                        ok = connTo->get()->runCommand( \"admin\" ,",
          "content_same": false
        },
        {
          "line": 1163,
          "old_api": null,
          "new_api": "BSON",
          "old_text": null,
          "new_text": "BSON( \"_recvChunkCommit\" << 1 )",
          "old_line_content": "                    }",
          "new_line_content": "                                                        BSON( \"_recvChunkCommit\" << 1 ) ,",
          "content_same": false
        },
        {
          "line": 1167,
          "old_api": null,
          "new_api": "causedBy",
          "old_text": null,
          "new_text": "causedBy( e )",
          "old_line_content": "                        ok = false;",
          "new_line_content": "                        errmsg = str::stream() << \"moveChunk could not contact to: shard \" << toShard.getConnString() << \" to commit transfer\" << causedBy( e );",
          "content_same": false
        },
        {
          "line": 1168,
          "old_api": null,
          "new_api": "warning",
          "old_text": null,
          "new_text": "warning()",
          "old_line_content": "                    }",
          "new_line_content": "                        warning() << errmsg << endl;",
          "content_same": false
        },
        {
          "line": 1680,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "timing.done(5)",
          "old_line_content": "",
          "new_line_content": "                timing.done(5);",
          "content_same": false
        },
        {
          "line": 1172,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "connTo->done()",
          "old_line_content": "                    if ( ! ok ) {",
          "new_line_content": "                    connTo->done();",
          "content_same": false
        },
        {
          "line": 1684,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "conn.done()",
          "old_line_content": "",
          "new_line_content": "            conn.done();",
          "content_same": false
        },
        {
          "line": 1179,
          "old_api": null,
          "new_api": "undoDonateChunk",
          "old_text": null,
          "new_text": "shardingState.undoDonateChunk( ns , min , max , startingVersion )",
          "old_line_content": "",
          "new_line_content": "                            shardingState.undoDonateChunk( ns , min , max , startingVersion );",
          "content_same": false
        },
        {
          "line": 1693,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "b.append( \"max\" , max )",
          "old_line_content": "",
          "new_line_content": "            b.append( \"max\" , max );",
          "content_same": false
        },
        {
          "line": 1182,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "",
          "new_line_content": "                        log() << \"moveChunk migrate commit not accepted by TO-shard: \" << res",
          "content_same": false
        },
        {
          "line": 1186,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "result.append( \"cause\" , res )",
          "old_line_content": "                    }",
          "new_line_content": "                        result.append( \"cause\" , res );",
          "content_same": false
        },
        {
          "line": 1190,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "",
          "new_line_content": "                    log() << \"moveChunk migrate commit accepted by TO-shard: \" << res << migrateLog;",
          "content_same": false
        },
        {
          "line": 1704,
          "old_api": null,
          "new_api": "append",
          "old_text": null,
          "new_text": "bb.append( \"steady\" , numSteady )",
          "old_line_content": "            }",
          "new_line_content": "                bb.append( \"steady\" , numSteady );",
          "content_same": false
        },
        {
          "line": 1705,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "bb.done()",
          "old_line_content": "",
          "new_line_content": "                bb.done();",
          "content_same": false
        },
        {
          "line": 1207,
          "old_api": null,
          "new_api": "subarrayStart",
          "old_text": null,
          "new_text": "cmdBuilder.subarrayStart( \"applyOps\" )",
          "old_line_content": "                    // update for the chunk being moved",
          "new_line_content": "                BSONArrayBuilder updates( cmdBuilder.subarrayStart( \"applyOps\" ) );",
          "content_same": false
        },
        {
          "line": 1719,
          "old_api": null,
          "new_api": "isABSONObj",
          "old_text": null,
          "new_text": "xfer[\"deleted\"].isABSONObj()",
          "old_line_content": "",
          "new_line_content": "            if ( xfer[\"deleted\"].isABSONObj() ) {",
          "content_same": false
        },
        {
          "line": 1722,
          "old_api": null,
          "new_api": "Obj",
          "old_text": null,
          "new_text": "xfer[\"deleted\"].Obj()",
          "old_line_content": "                    Client::WriteContext cx(ns);",
          "new_line_content": "                BSONObjIterator i( xfer[\"deleted\"].Obj() );",
          "content_same": false
        },
        {
          "line": 1723,
          "old_api": null,
          "new_api": "more",
          "old_text": null,
          "new_text": "i.more()",
          "old_line_content": "",
          "new_line_content": "                while ( i.more() ) {",
          "content_same": false
        },
        {
          "line": 1212,
          "old_api": null,
          "new_api": "appendBool",
          "old_text": null,
          "new_text": "op.appendBool( \"b\" , false /* no upserting */ )",
          "old_line_content": "",
          "new_line_content": "                    op.appendBool( \"b\" , false /* no upserting */ );",
          "content_same": false
        },
        {
          "line": 1726,
          "old_api": null,
          "new_api": "next",
          "old_text": null,
          "new_text": "i.next().Obj()",
          "old_line_content": "                    // do not apply deletes if they do not belong to the chunk being migrated",
          "new_line_content": "                    BSONObj id = i.next().Obj();",
          "content_same": false
        },
        {
          "line": 1731,
          "old_api": null,
          "new_api": "isInRange",
          "old_text": null,
          "new_text": "isInRange( fullObj , min , max , shardKeyPattern )",
          "old_line_content": "",
          "new_line_content": "                        if ( ! isInRange( fullObj , min , max , shardKeyPattern ) ) {",
          "content_same": false
        },
        {
          "line": 1732,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "                            continue;",
          "new_line_content": "                            log() << \"not applying out of range deletion: \" << fullObj << migrateLog;",
          "content_same": false
        },
        {
          "line": 1221,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "toShard.getName()",
          "old_line_content": "",
          "new_line_content": "                    n.append(ChunkFields::shard(), toShard.getName());",
          "content_same": false
        },
        {
          "line": 1225,
          "old_api": null,
          "new_api": "Chunk::genID(ns, min)",
          "old_text": null,
          "new_text": "Chunk::genID(ns, min)",
          "old_line_content": "",
          "new_line_content": "                    q.append(ChunkFields::name(), Chunk::genID(ns, min));",
          "content_same": false
        },
        {
          "line": 1228,
          "old_api": null,
          "new_api": "obj",
          "old_text": null,
          "new_text": "op.obj()",
          "old_line_content": "",
          "new_line_content": "                    updates.append( op.obj() );",
          "content_same": false
        },
        {
          "line": 1741,
          "old_api": null,
          "new_api": "Helpers::toKeyFormat( id , idIndexPattern )",
          "old_text": null,
          "new_text": "Helpers::toKeyFormat( id , idIndexPattern )",
          "old_line_content": "                    // TODO: create a better interface to remove objects directly",
          "new_line_content": "                    Helpers::toKeyFormat( id , idIndexPattern );",
          "content_same": false
        },
        {
          "line": 1744,
          "old_api": null,
          "new_api": "Helpers::removeRange( ns ,\n                                          id ,\n                                          id,\n                                          idIndexPattern ,\n                                          true , /*maxInclusive*/\n                                          false , /* secondaryThrottle */\n                                          cmdLine.moveParanoia ? &rs : 0 , /*callback*/\n                                          true )",
          "old_text": null,
          "new_text": "Helpers::removeRange( ns ,\n                                          id ,\n                                          id,\n                                          idIndexPattern ,\n                                          true , /*maxInclusive*/\n                                          false , /* secondaryThrottle */\n                                          cmdLine.moveParanoia ? &rs : 0 , /*callback*/\n                                          true )",
          "old_line_content": "                                          id,",
          "new_line_content": "                    Helpers::removeRange( ns ,",
          "content_same": false
        },
        {
          "line": 1237,
          "old_api": null,
          "new_api": "getShardChunkManager",
          "old_text": null,
          "new_text": "shardingState.getShardChunkManager( ns )",
          "old_line_content": "",
          "new_line_content": "                ShardChunkManagerPtr chunkManager = shardingState.getShardChunkManager( ns );",
          "content_same": false
        },
        {
          "line": 1238,
          "old_api": null,
          "new_api": "getNumChunks",
          "old_text": null,
          "new_text": "chunkManager->getNumChunks()",
          "old_line_content": "                    // get another chunk on that shard",
          "new_line_content": "                if( chunkManager->getNumChunks() > 0 ) {",
          "content_same": false
        },
        {
          "line": 1753,
          "old_api": null,
          "new_api": "ctx",
          "old_text": null,
          "new_text": "cx.ctx().getClient()->getLastOp().asDate()",
          "old_line_content": "                }",
          "new_line_content": "                    *lastOpApplied = cx.ctx().getClient()->getLastOp().asDate();",
          "content_same": false
        },
        {
          "line": 1244,
          "old_api": null,
          "new_api": "getNextChunk",
          "old_text": null,
          "new_text": "chunkManager->getNextChunk( lookupKey , &bumpMin , &bumpMax )",
          "old_line_content": "                    }",
          "new_line_content": "                        chunkManager->getNextChunk( lookupKey , &bumpMin , &bumpMax );",
          "content_same": false
        },
        {
          "line": 1759,
          "old_api": null,
          "new_api": "Obj",
          "old_text": null,
          "new_text": "xfer[\"reload\"].Obj()",
          "old_line_content": "                    Client::WriteContext cx(ns);",
          "new_line_content": "                BSONObjIterator i( xfer[\"reload\"].Obj() );",
          "content_same": false
        },
        {
          "line": 1760,
          "old_api": null,
          "new_api": "more",
          "old_text": null,
          "new_text": "i.more()",
          "old_line_content": "",
          "new_line_content": "                while ( i.more() ) {",
          "content_same": false
        },
        {
          "line": 1251,
          "old_api": null,
          "new_api": "appendBool",
          "old_text": null,
          "new_text": "op.appendBool( \"b\" , false )",
          "old_line_content": "",
          "new_line_content": "                    op.appendBool( \"b\" , false );",
          "content_same": false
        },
        {
          "line": 1767,
          "old_api": null,
          "new_api": "ctx",
          "old_text": null,
          "new_text": "cx.ctx().getClient()->getLastOp().asDate()",
          "old_line_content": "                }",
          "new_line_content": "                    *lastOpApplied = cx.ctx().getClient()->getLastOp().asDate();",
          "content_same": false
        },
        {
          "line": 1261,
          "old_api": null,
          "new_api": "getName",
          "old_text": null,
          "new_text": "fromShard.getName()",
          "old_line_content": "",
          "new_line_content": "                    n.append(ChunkFields::shard(), fromShard.getName());",
          "content_same": false
        },
        {
          "line": 1265,
          "old_api": null,
          "new_api": "Chunk::genID(ns, bumpMin)",
          "old_text": null,
          "new_text": "Chunk::genID(ns, bumpMin)",
          "old_line_content": "",
          "new_line_content": "                    q.append(ChunkFields::name(), Chunk::genID(ns, bumpMin));",
          "content_same": false
        },
        {
          "line": 1779,
          "old_api": null,
          "new_api": "mongo::opReplicatedEnough( lastOpApplied , slaveCount )",
          "old_text": null,
          "new_text": "mongo::opReplicatedEnough( lastOpApplied , slaveCount )",
          "old_line_content": "",
          "new_line_content": "            return mongo::opReplicatedEnough( lastOpApplied , slaveCount );",
          "content_same": false
        },
        {
          "line": 1270,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "",
          "new_line_content": "                    log() << \"moveChunk updating self version to: \" << nextVersion << \" through \"",
          "content_same": false
        },
        {
          "line": 1783,
          "old_api": null,
          "new_api": "opReplicatedEnough",
          "old_text": null,
          "new_text": "opReplicatedEnough( lastOpApplied )",
          "old_line_content": "                OCCASIONALLY warning() << \"migrate commit waiting for \" << slaveCount ",
          "new_line_content": "            if ( ! opReplicatedEnough( lastOpApplied ) ) {",
          "content_same": false
        },
        {
          "line": 1276,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "",
          "new_line_content": "                    log() << \"moveChunk moved last chunk out for collection '\" << ns << \"'\" << migrateLog;",
          "content_same": false
        },
        {
          "line": 1792,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "            {",
          "new_line_content": "            log() << \"migrate commit succeeded flushing to secondaries for '\" << ns << \"' \" << min << \" -> \" << max << migrateLog;",
          "content_same": false
        },
        {
          "line": 1281,
          "old_api": null,
          "new_api": "subarrayStart",
          "old_text": null,
          "new_text": "cmdBuilder.subarrayStart( \"preCondition\" )",
          "old_line_content": "                    BSONObjBuilder b;",
          "new_line_content": "                BSONArrayBuilder preCond( cmdBuilder.subarrayStart( \"preCondition\" ) );",
          "content_same": false
        },
        {
          "line": 1285,
          "old_api": null,
          "new_api": "ChunkFields::ns(ns)",
          "old_text": null,
          "new_text": "ChunkFields::ns(ns)",
          "old_line_content": "                    {",
          "new_line_content": "                    b.append(\"q\", BSON(\"query\" << BSON(ChunkFields::ns(ns)) <<",
          "content_same": false
        },
        {
          "line": 1798,
          "old_api": null,
          "new_api": "commitNow",
          "old_text": null,
          "new_text": "getDur().commitNow()",
          "old_line_content": "                }",
          "new_line_content": "                if ( getDur().commitNow() ) {",
          "content_same": false
        },
        {
          "line": 1799,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "            }",
          "new_line_content": "                    log() << \"migrate commit flushed to journal for '\" << ns << \"' \" << min << \" -> \" << max << migrateLog;",
          "content_same": false
        },
        {
          "line": 1290,
          "old_api": null,
          "new_api": "toLong",
          "old_text": null,
          "new_text": "maxVersion.toLong()",
          "old_line_content": "                    }",
          "new_line_content": "                        bb.appendTimestamp(ChunkFields::lastmod(), maxVersion.toLong());",
          "content_same": false
        },
        {
          "line": 1293,
          "old_api": null,
          "new_api": "obj",
          "old_text": null,
          "new_text": "b.obj()",
          "old_line_content": "",
          "new_line_content": "                    preCond.append( b.obj() );",
          "content_same": false
        },
        {
          "line": 1298,
          "old_api": null,
          "new_api": "obj",
          "old_text": null,
          "new_text": "cmdBuilder.obj()",
          "old_line_content": "",
          "new_line_content": "                BSONObj cmd = cmdBuilder.obj();",
          "content_same": false
        },
        {
          "line": 1299,
          "old_api": null,
          "new_api": "LOG",
          "old_text": null,
          "new_text": "LOG(7)",
          "old_line_content": "                bool ok = false;",
          "new_line_content": "                LOG(7) << \"moveChunk update: \" << cmd << migrateLog;",
          "content_same": false
        },
        {
          "line": 1305,
          "old_api": null,
          "new_api": "getConfigServer",
          "old_text": null,
          "new_text": "ScopedDbConnection::getInternalScopedDbConnection(\n                                    shardingState.getConfigServer(),\n                                    10.0 )",
          "old_line_content": "                                    10.0 ) );",
          "new_line_content": "                            ScopedDbConnection::getInternalScopedDbConnection(",
          "content_same": false
        },
        {
          "line": 1817,
          "old_api": null,
          "new_api": "verify",
          "old_text": null,
          "new_text": "verify(0)",
          "old_line_content": "        }",
          "new_line_content": "            verify(0);",
          "content_same": false
        },
        {
          "line": 1308,
          "old_api": null,
          "new_api": "get",
          "old_text": null,
          "new_text": "conn->get()->runCommand( \"config\" , cmd , cmdResult )",
          "old_line_content": "                }",
          "new_line_content": "                    ok = conn->get()->runCommand( \"config\" , cmd , cmdResult );",
          "content_same": false
        },
        {
          "line": 1309,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "conn->done()",
          "old_line_content": "                catch ( DBException& e ) {",
          "new_line_content": "                    conn->done();",
          "content_same": false
        },
        {
          "line": 1312,
          "old_api": null,
          "new_api": "warning",
          "old_text": null,
          "new_text": "warning()",
          "old_line_content": "                    BSONObjBuilder b;",
          "new_line_content": "                    warning() << e << migrateLog;",
          "content_same": false
        },
        {
          "line": 1315,
          "old_api": null,
          "new_api": "getInfo",
          "old_text": null,
          "new_text": "e.getInfo().append( b )",
          "old_line_content": "                }",
          "new_line_content": "                    e.getInfo().append( b );",
          "content_same": false
        },
        {
          "line": 1316,
          "old_api": null,
          "new_api": "obj",
          "old_text": null,
          "new_text": "b.obj()",
          "old_line_content": "",
          "new_line_content": "                    cmdResult = b.obj();",
          "content_same": false
        },
        {
          "line": 1828,
          "old_api": null,
          "new_api": "minutes",
          "old_text": null,
          "new_text": "t.minutes()",
          "old_line_content": "                if ( state == DONE )",
          "new_line_content": "            while ( t.minutes() <= 5 ) {",
          "content_same": false
        },
        {
          "line": 1829,
          "old_api": null,
          "new_api": "sleepmillis",
          "old_text": null,
          "new_text": "sleepmillis(1)",
          "old_line_content": "                    return true;",
          "new_line_content": "                sleepmillis(1);",
          "content_same": false
        },
        {
          "line": 1834,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "        }",
          "new_line_content": "            log() << \"startCommit never finished!\" << migrateLog;",
          "content_same": false
        },
        {
          "line": 1328,
          "old_api": null,
          "new_api": "warning",
          "old_text": null,
          "new_text": "warning()",
          "old_line_content": "",
          "new_line_content": "                    warning() << \"moveChunk commit outcome ongoing: \" << cmd << \" for command :\" << cmdResult << migrateLog;",
          "content_same": false
        },
        {
          "line": 1329,
          "old_api": null,
          "new_api": "sleepsecs",
          "old_text": null,
          "new_text": "sleepsecs( 10 )",
          "old_line_content": "                    try {",
          "new_line_content": "                    sleepsecs( 10 );",
          "content_same": false
        },
        {
          "line": 1333,
          "old_api": null,
          "new_api": "getConfigServer",
          "old_text": null,
          "new_text": "ScopedDbConnection::getInternalScopedDbConnection(\n                                        shardingState.getConfigServer(),\n                                        10.0 )",
          "old_line_content": "                                        10.0 ) );",
          "new_line_content": "                                ScopedDbConnection::getInternalScopedDbConnection(",
          "content_same": false
        },
        {
          "line": 1334,
          "old_api": null,
          "new_api": "getConfigServer",
          "old_text": null,
          "new_text": "shardingState.getConfigServer()",
          "old_line_content": "",
          "new_line_content": "                                        shardingState.getConfigServer(),",
          "content_same": false
        },
        {
          "line": 1340,
          "old_api": null,
          "new_api": "ChunkFields::ns(ns)",
          "old_text": null,
          "new_text": "ChunkFields::ns(ns)",
          "old_line_content": "",
          "new_line_content": "                                                           Query(BSON(ChunkFields::ns(ns)))",
          "content_same": false
        },
        {
          "line": 1341,
          "old_api": null,
          "new_api": "ChunkFields::lastmod()",
          "old_text": null,
          "new_text": "ChunkFields::lastmod()",
          "old_line_content": "                        ShardChunkVersion checkVersion =",
          "new_line_content": "                                                               .sort(BSON(ChunkFields::lastmod() << -1)));",
          "content_same": false
        },
        {
          "line": 1346,
          "old_api": null,
          "new_api": "isEquivalentTo",
          "old_text": null,
          "new_text": "checkVersion.isEquivalentTo( nextVersion )",
          "old_line_content": "",
          "new_line_content": "                        if ( checkVersion.isEquivalentTo( nextVersion ) ) {",
          "content_same": false
        },
        {
          "line": 1347,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "                        }",
          "new_line_content": "                            log() << \"moveChunk commit confirmed\" << migrateLog;",
          "content_same": false
        },
        {
          "line": 1353,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error()",
          "old_line_content": "                        }",
          "new_line_content": "                            error() << \"TERMINATING\" << migrateLog;",
          "content_same": false
        },
        {
          "line": 1354,
          "old_api": null,
          "new_api": "dbexit",
          "old_text": null,
          "new_text": "dbexit( EXIT_SHARDING_ERROR )",
          "old_line_content": "",
          "new_line_content": "                            dbexit( EXIT_SHARDING_ERROR );",
          "content_same": false
        },
        {
          "line": 1357,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "conn->done()",
          "old_line_content": "                    }",
          "new_line_content": "                        conn->done();",
          "content_same": false
        },
        {
          "line": 1872,
          "old_api": null,
          "new_api": "ShardedConnectionInfo::addHook()",
          "old_text": null,
          "new_text": "ShardedConnectionInfo::addHook()",
          "old_line_content": "        }",
          "new_line_content": "            ShardedConnectionInfo::addHook();",
          "content_same": false
        },
        {
          "line": 1362,
          "old_api": null,
          "new_api": "error",
          "old_text": null,
          "new_text": "error()",
          "old_line_content": "                    }",
          "new_line_content": "                        error() << \"TERMINATING\" << migrateLog;",
          "content_same": false
        },
        {
          "line": 1363,
          "old_api": null,
          "new_api": "dbexit",
          "old_text": null,
          "new_text": "dbexit( EXIT_SHARDING_ERROR )",
          "old_line_content": "                }",
          "new_line_content": "                        dbexit( EXIT_SHARDING_ERROR );",
          "content_same": false
        },
        {
          "line": 1875,
          "old_api": null,
          "new_api": "go",
          "old_text": null,
          "new_text": "migrateStatus.go()",
          "old_line_content": "    }",
          "new_line_content": "        migrateStatus.go();",
          "content_same": false
        },
        {
          "line": 1876,
          "old_api": null,
          "new_api": "shutdown",
          "old_text": null,
          "new_text": "cc().shutdown()",
          "old_line_content": "",
          "new_line_content": "        cc().shutdown();",
          "content_same": false
        },
        {
          "line": 1367,
          "old_api": null,
          "new_api": "setInCriticalSection",
          "old_text": null,
          "new_text": "migrateFromStatus.setInCriticalSection( false )",
          "old_line_content": "                // 5.d",
          "new_line_content": "                migrateFromStatus.setInCriticalSection( false );",
          "content_same": false
        },
        {
          "line": 1370,
          "old_api": null,
          "new_api": "logChange",
          "old_text": null,
          "new_text": "configServer.logChange( \"moveChunk.commit\" , ns , chunkInfo )",
          "old_line_content": "",
          "new_line_content": "                configServer.logChange( \"moveChunk.commit\" , ns , chunkInfo );",
          "content_same": false
        },
        {
          "line": 1373,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "migrateFromStatus.done()",
          "old_line_content": "",
          "new_line_content": "            migrateFromStatus.done();",
          "content_same": false
        },
        {
          "line": 1374,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "timing.done(5)",
          "old_line_content": "            {",
          "new_line_content": "            timing.done(5);",
          "content_same": false
        },
        {
          "line": 1887,
          "old_api": null,
          "new_api": "getActive",
          "old_text": null,
          "new_text": "migrateStatus.getActive()",
          "old_line_content": "                return false;",
          "new_line_content": "            if ( migrateStatus.getActive() ) {",
          "content_same": false
        },
        {
          "line": 1894,
          "old_api": null,
          "new_api": "str::stream()",
          "old_text": null,
          "new_text": "str::stream()",
          "old_line_content": "                    << OldDataCleanup::_numThreads;",
          "new_line_content": "                    str::stream() ",
          "content_same": false
        },
        {
          "line": 1386,
          "old_api": null,
          "new_api": "log",
          "old_text": null,
          "new_text": "log()",
          "old_line_content": "                }",
          "new_line_content": "                    log() << \"forking for cleaning up chunk data\" << migrateLog;",
          "content_same": false
        },
        {
          "line": 1387,
          "old_api": null,
          "new_api": "boost::bind( &cleanupOldData , c )",
          "old_text": null,
          "new_text": "boost::bind( &cleanupOldData , c )",
          "old_line_content": "                else {",
          "new_line_content": "                    boost::thread t( boost::bind( &cleanupOldData , c ) );",
          "content_same": false
        },
        {
          "line": 1900,
          "old_api": null,
          "new_api": "ok",
          "old_text": null,
          "new_text": "configServer.ok()",
          "old_line_content": "",
          "new_line_content": "            if ( ! configServer.ok() )",
          "content_same": false
        },
        {
          "line": 1392,
          "old_api": null,
          "new_api": "doRemove",
          "old_text": null,
          "new_text": "c.doRemove()",
          "old_line_content": "",
          "new_line_content": "                    c.doRemove();",
          "content_same": false
        },
        {
          "line": 1397,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "timing.done(6)",
          "old_line_content": "            return true;",
          "new_line_content": "            timing.done(6);",
          "content_same": false
        },
        {
          "line": 1910,
          "old_api": null,
          "new_api": "hasField",
          "old_text": null,
          "new_text": "cmdObj.hasField(\"shardKeyPattern\")",
          "old_line_content": "            } else {",
          "new_line_content": "            if (cmdObj.hasField(\"shardKeyPattern\")) {",
          "content_same": false
        },
        {
          "line": 1911,
          "old_api": null,
          "new_api": "Obj",
          "old_text": null,
          "new_text": "cmdObj[\"shardKeyPattern\"].Obj().getOwned()",
          "old_line_content": "                // shardKeyPattern may not be provided if another shard is from pre 2.2",
          "new_line_content": "                migrateStatus.shardKeyPattern = cmdObj[\"shardKeyPattern\"].Obj().getOwned();",
          "content_same": false
        },
        {
          "line": 1406,
          "old_api": null,
          "new_api": "getInCriticalSection",
          "old_text": null,
          "new_text": "migrateFromStatus.getInCriticalSection()",
          "old_line_content": "",
          "new_line_content": "        return migrateFromStatus.getInCriticalSection();",
          "content_same": false
        },
        {
          "line": 1918,
          "old_api": null,
          "new_api": "Helpers::toKeyFormat( migrateStatus.max , keyb )",
          "old_text": null,
          "new_text": "Helpers::toKeyFormat( migrateStatus.max , keyb )",
          "old_line_content": "",
          "new_line_content": "                Helpers::toKeyFormat( migrateStatus.max , keyb );",
          "content_same": false
        },
        {
          "line": 1921,
          "old_api": null,
          "new_api": "warning",
          "old_text": null,
          "new_text": "warning()",
          "old_line_content": "                    \" Falling back to assuming the shard key matches the pattern of the min and max\"",
          "new_line_content": "                warning() << \"No shard key pattern provided by source shard for migration.\"",
          "content_same": false
        },
        {
          "line": 1926,
          "old_api": null,
          "new_api": "getOwned",
          "old_text": null,
          "new_text": "keya.getOwned()",
          "old_line_content": "",
          "new_line_content": "                migrateStatus.shardKeyPattern = keya.getOwned();",
          "content_same": false
        },
        {
          "line": 1929,
          "old_api": null,
          "new_api": "anyReplEnabled",
          "old_text": null,
          "new_text": "anyReplEnabled()",
          "old_line_content": "                migrateStatus.secondaryThrottle = false;",
          "new_line_content": "            if ( migrateStatus.secondaryThrottle && ! anyReplEnabled() ) {",
          "content_same": false
        },
        {
          "line": 1930,
          "old_api": null,
          "new_api": "warning",
          "old_text": null,
          "new_text": "warning()",
          "old_line_content": "            }",
          "new_line_content": "                warning() << \"secondaryThrottle asked for, but not replication\" << endl;",
          "content_same": false
        },
        {
          "line": 1936,
          "old_api": null,
          "new_api": "appendBool",
          "old_text": null,
          "new_text": "result.appendBool( \"started\" , true )",
          "old_line_content": "        }",
          "new_line_content": "            result.appendBool( \"started\" , true );",
          "content_same": false
        },
        {
          "line": 1430,
          "old_api": null,
          "new_api": "verify",
          "old_text": null,
          "new_text": "verify( ! active )",
          "old_line_content": "            errmsg = \"\";",
          "new_line_content": "            verify( ! active );",
          "content_same": false
        },
        {
          "line": 1947,
          "old_api": null,
          "new_api": "status",
          "old_text": null,
          "new_text": "migrateStatus.status( result )",
          "old_line_content": "        }",
          "new_line_content": "            migrateStatus.status( result );",
          "content_same": false
        },
        {
          "line": 1444,
          "old_api": null,
          "new_api": "_go",
          "old_text": null,
          "new_text": "_go()",
          "old_line_content": "            catch ( std::exception& e ) {",
          "new_line_content": "                _go();",
          "content_same": false
        },
        {
          "line": 1958,
          "old_api": null,
          "new_api": "startCommit",
          "old_text": null,
          "new_text": "migrateStatus.startCommit()",
          "old_line_content": "            return ok;",
          "new_line_content": "            bool ok = migrateStatus.startCommit();",
          "content_same": false
        },
        {
          "line": 1959,
          "old_api": null,
          "new_api": "status",
          "old_text": null,
          "new_text": "migrateStatus.status( result )",
          "old_line_content": "        }",
          "new_line_content": "            migrateStatus.status( result );",
          "content_same": false
        },
        {
          "line": 1448,
          "old_api": null,
          "new_api": "what",
          "old_text": null,
          "new_text": "e.what()",
          "old_line_content": "            }",
          "new_line_content": "                errmsg = e.what();",
          "content_same": false
        },
        {
          "line": 1449,
          "old_api": null,
          "new_api": "what",
          "old_text": null,
          "new_text": "e.what()",
          "old_line_content": "            catch ( ... ) {",
          "new_line_content": "                error() << \"migrate failed: \" << e.what() << migrateLog;",
          "content_same": false
        },
        {
          "line": 1456,
          "old_api": null,
          "new_api": "setActive",
          "old_text": null,
          "new_text": "setActive( false )",
          "old_line_content": "",
          "new_line_content": "            setActive( false );",
          "content_same": false
        },
        {
          "line": 1970,
          "old_api": null,
          "new_api": "abort",
          "old_text": null,
          "new_text": "migrateStatus.abort()",
          "old_line_content": "            return true;",
          "new_line_content": "            migrateStatus.abort();",
          "content_same": false
        },
        {
          "line": 1971,
          "old_api": null,
          "new_api": "status",
          "old_text": null,
          "new_text": "migrateStatus.status( result )",
          "old_line_content": "        }",
          "new_line_content": "            migrateStatus.status( result );",
          "content_same": false
        },
        {
          "line": 1462,
          "old_api": null,
          "new_api": "isEmpty",
          "old_text": null,
          "new_text": "min.isEmpty()",
          "old_line_content": "            ",
          "new_line_content": "            verify( ! min.isEmpty() );",
          "content_same": false
        },
        {
          "line": 1465,
          "old_api": null,
          "new_api": "getSlaveCount",
          "old_text": null,
          "new_text": "getSlaveCount()",
          "old_line_content": "            string errmsg;",
          "new_line_content": "            slaveCount = ( getSlaveCount() / 2 ) + 1;",
          "content_same": false
        },
        {
          "line": 1982,
          "old_api": null,
          "new_api": "BSON",
          "old_text": null,
          "new_text": "BSON( \"x\" << 5 )",
          "old_line_content": "",
          "new_line_content": "            BSONObj max = BSON( \"x\" << 5 );",
          "content_same": false
        },
        {
          "line": 1473,
          "old_api": null,
          "new_api": "getLastError",
          "old_text": null,
          "new_text": "conn->getLastError()",
          "old_line_content": "            {",
          "new_line_content": "            conn->getLastError(); // just test connection",
          "content_same": false
        },
        {
          "line": 1989,
          "old_api": null,
          "new_api": "BSON",
          "old_text": null,
          "new_text": "BSON( \"x\" << 5 )",
          "old_line_content": "",
          "new_line_content": "            verify( ! isInRange( BSON( \"x\" << 5 ) , min , max , skey ) );",
          "content_same": false
        },
        {
          "line": 1481,
          "old_api": null,
          "new_api": "BSON",
          "old_text": null,
          "new_text": "BSON( \"name\" << ns )",
          "old_line_content": "                        string errmsg;",
          "new_line_content": "                    BSONObj entry = conn->findOne( system_namespaces, BSON( \"name\" << ns ) );",
          "content_same": false
        },
        {
          "line": 1994,
          "old_api": null,
          "new_api": "firstElement",
          "old_text": null,
          "new_text": "obj.firstElement()",
          "old_line_content": "",
          "new_line_content": "            BSONObj max2 = BSON( \"x\" << BSONElementHasher::hash64( obj.firstElement() , 0 ) + 2 );",
          "content_same": false
        },
        {
          "line": 1484,
          "old_api": null,
          "new_api": "Obj",
          "old_text": null,
          "new_text": "entry[\"options\"].Obj()",
          "old_line_content": "                                      << endl;",
          "new_line_content": "                        if ( ! userCreateNS( ns.c_str(), entry[\"options\"].Obj(), errmsg, true, 0 ) )",
          "content_same": false
        },
        {
          "line": 1485,
          "old_api": null,
          "new_api": "warning",
          "old_text": null,
          "new_text": "warning()",
          "old_line_content": "                    }",
          "new_line_content": "                            warning() << \"failed to create collection with options: \" << errmsg",
          "content_same": false
        },
        {
          "line": 1998,
          "old_api": null,
          "new_api": "BSON",
          "old_text": null,
          "new_text": "BSON( \"x\" << 3 )",
          "old_line_content": "",
          "new_line_content": "            verify( ! isInRange( BSON( \"x\" << 3 ) , min , max , hashedKey ) );",
          "content_same": false
        },
        {
          "line": 2001,
          "old_api": null,
          "new_api": "LOG",
          "old_text": null,
          "new_text": "LOG(1)",
          "old_line_content": "    } isInRangeTest;",
          "new_line_content": "            LOG(1) << \"isInRangeTest passed\" << migrateLog;",
          "content_same": false
        },
        {
          "line": 1498,
          "old_api": null,
          "new_api": "more",
          "old_text": null,
          "new_text": "indexes->more()",
          "old_line_content": "                    }",
          "new_line_content": "                    while ( indexes->more() ) {",
          "content_same": false
        },
        {
          "line": 1499,
          "old_api": null,
          "new_api": "getOwned",
          "old_text": null,
          "new_text": "indexes->next().getOwned()",
          "old_line_content": "                }",
          "new_line_content": "                        all.push_back( indexes->next().getOwned() );",
          "content_same": false
        },
        {
          "line": 1503,
          "old_api": null,
          "new_api": "size",
          "old_text": null,
          "new_text": "all.size()",
          "old_line_content": "                    Client::WriteContext ct( ns );",
          "new_line_content": "                for ( unsigned i=0; i<all.size(); i++ ) {",
          "content_same": false
        },
        {
          "line": 1506,
          "old_api": null,
          "new_api": "database",
          "old_text": null,
          "new_text": "cc().database()",
          "old_line_content": "                }",
          "new_line_content": "                    string system_indexes = cc().database()->name + \".system.indexes\";",
          "content_same": false
        },
        {
          "line": 1507,
          "old_api": null,
          "new_api": "c_str",
          "old_text": null,
          "new_text": "system_indexes.c_str()",
          "old_line_content": "",
          "new_line_content": "                    theDataFileMgr.insertAndLog( system_indexes.c_str() , idx, true /* flag fromMigrate in oplog */ );",
          "content_same": false
        },
        {
          "line": 1510,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "timing.done(1)",
          "old_line_content": "",
          "new_line_content": "                timing.done(1);",
          "content_same": false
        },
        {
          "line": 1516,
          "old_api": null,
          "new_api": "Helpers::removeRange( ns ,\n                                                      min ,\n                                                      max ,\n                                                      findShardKeyIndexPattern_unlocked( ns , shardKeyPattern ) , \n                                                      false , /*maxInclusive*/\n                                                      secondaryThrottle , /* secondaryThrottle */\n                                                      cmdLine.moveParanoia ? &rs : 0 , /*callback*/\n                                                      true )",
          "old_text": null,
          "new_text": "Helpers::removeRange( ns ,\n                                                      min ,\n                                                      max ,\n                                                      findShardKeyIndexPattern_unlocked( ns , shardKeyPattern ) , \n                                                      false , /*maxInclusive*/\n                                                      secondaryThrottle , /* secondaryThrottle */\n                                                      cmdLine.moveParanoia ? &rs : 0 , /*callback*/\n                                                      true )",
          "old_line_content": "                                                      max ,",
          "new_line_content": "                long long num = Helpers::removeRange( ns ,",
          "content_same": false
        },
        {
          "line": 1519,
          "old_api": null,
          "new_api": "findShardKeyIndexPattern_unlocked",
          "old_text": null,
          "new_text": "findShardKeyIndexPattern_unlocked( ns , shardKeyPattern )",
          "old_line_content": "                                                      secondaryThrottle , /* secondaryThrottle */",
          "new_line_content": "                                                      findShardKeyIndexPattern_unlocked( ns , shardKeyPattern ) , ",
          "content_same": false
        },
        {
          "line": 1527,
          "old_api": null,
          "new_api": "done",
          "old_text": null,
          "new_text": "timing.done(2)",
          "old_line_content": "",
          "new_line_content": "                timing.done(2);",
          "content_same": false
        }
      ],
      "deletions": [
        {
          "line": 1538,
          "old_api": "toString",
          "new_api": null,
          "old_text": "res.toString()",
          "new_text": null,
          "old_line_content": "                        errmsg += res.toString();",
          "new_line_content": "                        state = FAIL;",
          "content_same": false
        },
        {
          "line": 1539,
          "old_api": "error",
          "new_api": null,
          "old_text": "error()",
          "new_text": null,
          "old_line_content": "                        error() << errmsg << migrateLog;",
          "new_line_content": "                        errmsg = \"_migrateClone failed: \";",
          "content_same": false
        },
        {
          "line": 1544,
          "old_api": "Obj",
          "new_api": null,
          "old_text": "res[\"objects\"].Obj()",
          "new_text": null,
          "old_line_content": "                    BSONObj arr = res[\"objects\"].Obj();",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 1548,
          "old_api": "more",
          "new_api": null,
          "old_text": "i.more()",
          "new_text": null,
          "old_line_content": "                    while( i.more() ) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1549,
          "old_api": "next",
          "new_api": null,
          "old_text": "i.next().Obj()",
          "new_text": null,
          "old_line_content": "                        BSONObj o = i.next().Obj();",
          "new_line_content": "                    BSONObjIterator i( arr );",
          "content_same": false
        },
        {
          "line": 1555,
          "old_api": "Helpers::upsert( ns, o, true )",
          "new_api": null,
          "old_text": "Helpers::upsert( ns, o, true )",
          "new_text": null,
          "old_line_content": "                                    Helpers::upsert( ns, o, true );",
          "new_line_content": "                                try {",
          "content_same": false
        },
        {
          "line": 1559,
          "old_api": "touch",
          "new_api": null,
          "old_text": "e.touch()",
          "new_text": null,
          "old_line_content": "                                    e.touch();",
          "new_line_content": "                                }",
          "content_same": false
        },
        {
          "line": 1565,
          "old_api": "objsize",
          "new_api": null,
          "old_text": "o.objsize()",
          "new_text": null,
          "old_line_content": "                        clonedBytes += o.objsize();",
          "new_line_content": "                        thisTime++;",
          "content_same": false
        },
        {
          "line": 1568,
          "old_api": "getLastOp",
          "new_api": null,
          "old_text": "cc().getLastOp()",
          "new_text": null,
          "old_line_content": "                            if ( ! waitForReplication( cc().getLastOp(), 2, 60 /* seconds to wait */ ) ) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1569,
          "old_api": "warning",
          "new_api": null,
          "old_text": "warning()",
          "new_text": null,
          "old_line_content": "                                warning() << \"secondaryThrottle on, but doc insert timed out after 60 seconds, continuing\" << endl;",
          "new_line_content": "                        if ( secondaryThrottle && thisTime > 0 ) {",
          "content_same": false
        },
        {
          "line": 1578,
          "old_api": "done",
          "new_api": null,
          "old_text": "timing.done(3)",
          "new_text": null,
          "old_line_content": "                timing.done(3);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1582,
          "old_api": "getLastOp",
          "new_api": null,
          "old_text": "cc().getLastOp().asDate()",
          "new_text": null,
          "old_line_content": "            ReplTime lastOpApplied = cc().getLastOp().asDate();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1589,
          "old_api": "BSON",
          "new_api": null,
          "old_text": "BSON( \"_transferMods\" << 1 )",
          "new_text": null,
          "old_line_content": "                    if ( ! conn->runCommand( \"admin\" , BSON( \"_transferMods\" << 1 ) , res ) ) {",
          "new_line_content": "                while ( true ) {",
          "content_same": false
        },
        {
          "line": 1080,
          "old_api": "sleepsecs",
          "new_api": null,
          "old_text": "sleepsecs( 1 )",
          "new_text": null,
          "old_line_content": "                sleepsecs( 1 );",
          "new_line_content": "                // Exponential sleep backoff, up to 1 sec. Don't sleep much on the first few",
          "content_same": false
        },
        {
          "line": 1592,
          "old_api": "toString",
          "new_api": null,
          "old_text": "res.toString()",
          "new_text": null,
          "old_line_content": "                        errmsg += res.toString();",
          "new_line_content": "                        state = FAIL;",
          "content_same": false
        },
        {
          "line": 1593,
          "old_api": "error",
          "new_api": null,
          "old_text": "error()",
          "new_text": null,
          "old_line_content": "                        error() << \"_transferMods failed: \" << res << migrateLog;",
          "new_line_content": "                        errmsg = \"_transferMods failed: \";",
          "content_same": false
        },
        {
          "line": 1597,
          "old_api": "number",
          "new_api": null,
          "old_text": "res[\"size\"].number()",
          "new_text": null,
          "old_line_content": "                    if ( res[\"size\"].number() == 0 )",
          "new_line_content": "                        return;",
          "content_same": false
        },
        {
          "line": 1086,
          "old_api": "BSON",
          "new_api": null,
          "old_text": "BSON( \"_recvChunkStatus\" << 1 )",
          "new_text": null,
          "old_line_content": "                    ok = conn->get()->runCommand( \"admin\" , BSON( \"_recvChunkStatus\" << 1 ) , res );",
          "new_line_content": "                bool ok;",
          "content_same": false
        },
        {
          "line": 1087,
          "old_api": "getOwned",
          "new_api": null,
          "old_text": "res.getOwned()",
          "new_text": null,
          "old_line_content": "                    res = res.getOwned();",
          "new_line_content": "                try {",
          "content_same": false
        },
        {
          "line": 1600,
          "old_api": "apply",
          "new_api": null,
          "old_text": "apply( res , &lastOpApplied )",
          "new_text": null,
          "old_line_content": "                    apply( res , &lastOpApplied );",
          "new_line_content": "                        break;",
          "content_same": false
        },
        {
          "line": 1090,
          "old_api": "causedBy",
          "new_api": null,
          "old_text": "causedBy( e )",
          "new_text": null,
          "old_line_content": "                    errmsg = str::stream() << \"moveChunk could not contact to: shard \" << to << \" to monitor transfer\" << causedBy( e );",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1091,
          "old_api": "warning",
          "new_api": null,
          "old_text": "warning()",
          "new_text": null,
          "old_line_content": "                    warning() << errmsg << endl;",
          "new_line_content": "                catch( DBException& e ){",
          "content_same": false
        },
        {
          "line": 1606,
          "old_api": "note",
          "new_api": null,
          "old_text": "timing.note( \"aborted\" )",
          "new_text": null,
          "old_line_content": "                            timing.note( \"aborted\" );",
          "new_line_content": "                    for ( i=0;i<maxIterations; i++) {",
          "content_same": false
        },
        {
          "line": 1095,
          "old_api": "done",
          "new_api": null,
          "old_text": "conn->done()",
          "new_text": null,
          "old_line_content": "                conn->done();",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1610,
          "old_api": "opReplicatedEnough",
          "new_api": null,
          "old_text": "opReplicatedEnough( lastOpApplied )",
          "new_text": null,
          "old_line_content": "                        if ( opReplicatedEnough( lastOpApplied ) )",
          "new_line_content": "                        }",
          "content_same": false
        },
        {
          "line": 1100,
          "old_api": "warning",
          "new_api": null,
          "old_text": "warning()",
          "new_text": null,
          "old_line_content": "                    warning() << \"moveChunk error transferring data caused migration abort: \" << res << migrateLog;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1614,
          "old_api": "warning",
          "new_api": null,
          "old_text": "warning()",
          "new_text": null,
          "old_line_content": "                            warning() << \"secondaries having hard time keeping up with migrate\" << migrateLog;",
          "new_line_content": "                        ",
          "content_same": false
        },
        {
          "line": 1617,
          "old_api": "sleepmillis",
          "new_api": null,
          "old_text": "sleepmillis( 20 )",
          "new_text": null,
          "old_line_content": "                        sleepmillis( 20 );",
          "new_line_content": "                        }",
          "content_same": false
        },
        {
          "line": 1106,
          "old_api": "String",
          "new_api": null,
          "old_text": "res[\"state\"].String()",
          "new_text": null,
          "old_line_content": "                if ( res[\"state\"].String() == \"steady\" )",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1109,
          "old_api": "mbUsed",
          "new_api": null,
          "old_text": "migrateFromStatus.mbUsed()",
          "new_text": null,
          "old_line_content": "                if ( migrateFromStatus.mbUsed() > (500 * 1024 * 1024) ) {",
          "new_line_content": "                    break;",
          "content_same": false
        },
        {
          "line": 1622,
          "old_api": "error",
          "new_api": null,
          "old_text": "error()",
          "new_text": null,
          "old_line_content": "                        error() << errmsg << migrateLog;",
          "new_line_content": "                    if ( i == maxIterations ) {",
          "content_same": false
        },
        {
          "line": 1623,
          "old_api": "done",
          "new_api": null,
          "old_text": "conn.done()",
          "new_text": null,
          "old_line_content": "                        conn.done();",
          "new_line_content": "                        errmsg = \"secondary can't keep up with migrate\";",
          "content_same": false
        },
        {
          "line": 1113,
          "old_api": "getConnString",
          "new_api": null,
          "old_text": "toShard.getConnString()",
          "new_text": null,
          "old_line_content": "                            ScopedDbConnection::getScopedDbConnection( toShard.getConnString() ) );",
          "new_line_content": "                    // so we're going to abort the migrate",
          "content_same": false
        },
        {
          "line": 1116,
          "old_api": "BSON",
          "new_api": null,
          "old_text": "BSON( \"_recvChunkAbort\" << 1 )",
          "new_text": null,
          "old_line_content": "                    conn->get()->runCommand( \"admin\" , BSON( \"_recvChunkAbort\" << 1 ) , res );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1117,
          "old_api": "getOwned",
          "new_api": null,
          "old_text": "res.getOwned()",
          "new_text": null,
          "old_line_content": "                    res = res.getOwned();",
          "new_line_content": "                    BSONObj res;",
          "content_same": false
        },
        {
          "line": 1629,
          "old_api": "done",
          "new_api": null,
          "old_text": "timing.done(4)",
          "new_text": null,
          "old_line_content": "                timing.done(4);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1636,
          "old_api": "minutes",
          "new_api": null,
          "old_text": "t.minutes()",
          "new_text": null,
          "old_line_content": "                while ( t.minutes() < 600 ) {",
          "new_line_content": "                // this will prevent us from going into critical section until we're ready",
          "content_same": false
        },
        {
          "line": 1125,
          "old_api": "checkForInterrupt",
          "new_api": null,
          "old_text": "killCurrentOp.checkForInterrupt()",
          "new_text": null,
          "old_line_content": "                killCurrentOp.checkForInterrupt();",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1637,
          "old_api": "flushPendingWrites",
          "new_api": null,
          "old_text": "flushPendingWrites( lastOpApplied )",
          "new_text": null,
          "old_line_content": "                    if ( flushPendingWrites( lastOpApplied ) )",
          "new_line_content": "                Timer t;",
          "content_same": false
        },
        {
          "line": 1133,
          "old_api": "setInCriticalSection",
          "new_api": null,
          "old_text": "migrateFromStatus.setInCriticalSection( true )",
          "new_text": null,
          "old_line_content": "                migrateFromStatus.setInCriticalSection( true );",
          "new_line_content": "                // 5.a",
          "content_same": false
        },
        {
          "line": 1649,
          "old_api": "BSON",
          "new_api": null,
          "old_text": "BSON( \"_transferMods\" << 1 )",
          "new_text": null,
          "old_line_content": "                    if ( ! conn->runCommand( \"admin\" , BSON( \"_transferMods\" << 1 ) , res ) ) {",
          "new_line_content": "                while ( state == STEADY || state == COMMIT_START ) {",
          "content_same": false
        },
        {
          "line": 1650,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                        log() << \"_transferMods failed in STEADY state: \" << res << migrateLog;",
          "new_line_content": "                    BSONObj res;",
          "content_same": false
        },
        {
          "line": 1139,
          "old_api": "getVersion",
          "new_api": null,
          "old_text": "shardingState.getVersion( ns )",
          "new_text": null,
          "old_line_content": "                    verify( myVersion > shardingState.getVersion( ns ) );",
          "new_line_content": "                {",
          "content_same": false
        },
        {
          "line": 1143,
          "old_api": "donateChunk",
          "new_api": null,
          "old_text": "shardingState.donateChunk( ns , min , max , myVersion )",
          "new_text": null,
          "old_line_content": "                    shardingState.donateChunk( ns , min , max , myVersion );",
          "new_line_content": "                    // bump the chunks manager's version up and \"forget\" about the chunk being moved",
          "content_same": false
        },
        {
          "line": 1657,
          "old_api": "apply",
          "new_api": null,
          "old_text": "apply( res , &lastOpApplied )",
          "new_text": null,
          "old_line_content": "                    if ( res[\"size\"].number() > 0 && apply( res , &lastOpApplied ) )",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 1146,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                log() << \"moveChunk setting version to: \" << myVersion << migrateLog;",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1661,
          "old_api": "note",
          "new_api": null,
          "old_text": "timing.note( \"aborted\" )",
          "new_text": null,
          "old_line_content": "                        timing.note( \"aborted\" );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1154,
          "old_api": "getConnString",
          "new_api": null,
          "old_text": "toShard.getConnString()",
          "new_text": null,
          "old_line_content": "                            ScopedDbConnection::getScopedDbConnection( toShard.getConnString(),",
          "new_line_content": "                    BSONObj res;",
          "content_same": false
        },
        {
          "line": 1666,
          "old_api": "flushPendingWrites",
          "new_api": null,
          "old_text": "flushPendingWrites( lastOpApplied )",
          "new_text": null,
          "old_line_content": "                        if ( flushPendingWrites( lastOpApplied ) )",
          "new_line_content": "                    ",
          "content_same": false
        },
        {
          "line": 1670,
          "old_api": "sleepmillis",
          "new_api": null,
          "old_text": "sleepmillis( 10 )",
          "new_text": null,
          "old_line_content": "                    sleepmillis( 10 );",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 1160,
          "old_api": "get",
          "new_api": null,
          "old_text": "connTo->get()->runCommand( \"admin\" ,\n                                                        BSON( \"_recvChunkCommit\" << 1 ) ,\n                                                        res )",
          "new_text": null,
          "old_line_content": "                        ok = connTo->get()->runCommand( \"admin\" ,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1161,
          "old_api": "BSON",
          "new_api": null,
          "old_text": "BSON( \"_recvChunkCommit\" << 1 )",
          "new_text": null,
          "old_line_content": "                                                        BSON( \"_recvChunkCommit\" << 1 ) ,",
          "new_line_content": "                    try{",
          "content_same": false
        },
        {
          "line": 1165,
          "old_api": "causedBy",
          "new_api": null,
          "old_text": "causedBy( e )",
          "new_text": null,
          "old_line_content": "                        errmsg = str::stream() << \"moveChunk could not contact to: shard \" << toShard.getConnString() << \" to commit transfer\" << causedBy( e );",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 1166,
          "old_api": "warning",
          "new_api": null,
          "old_text": "warning()",
          "new_text": null,
          "old_line_content": "                        warning() << errmsg << endl;",
          "new_line_content": "                    catch( DBException& e ){",
          "content_same": false
        },
        {
          "line": 1678,
          "old_api": "done",
          "new_api": null,
          "old_text": "timing.done(5)",
          "new_text": null,
          "old_line_content": "                timing.done(5);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1170,
          "old_api": "done",
          "new_api": null,
          "old_text": "connTo->done()",
          "new_text": null,
          "old_line_content": "                    connTo->done();",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 1682,
          "old_api": "done",
          "new_api": null,
          "old_text": "conn.done()",
          "new_text": null,
          "old_line_content": "            conn.done();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1686,
          "old_api": "getActive",
          "new_api": null,
          "old_text": "getActive()",
          "new_text": null,
          "old_line_content": "            b.appendBool( \"active\" , getActive() );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1177,
          "old_api": "undoDonateChunk",
          "new_api": null,
          "old_text": "shardingState.undoDonateChunk( ns , min , max , startingVersion )",
          "new_text": null,
          "old_line_content": "                            shardingState.undoDonateChunk( ns , min , max , startingVersion );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1689,
          "old_api": "append",
          "new_api": null,
          "old_text": "b.append( \"from\" , from )",
          "new_text": null,
          "old_line_content": "            b.append( \"from\" , from );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1180,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                        log() << \"moveChunk migrate commit not accepted by TO-shard: \" << res",
          "new_line_content": "                        }",
          "content_same": false
        },
        {
          "line": 1184,
          "old_api": "append",
          "new_api": null,
          "old_text": "result.append( \"cause\" , res )",
          "new_text": null,
          "old_line_content": "                        result.append( \"cause\" , res );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1699,
          "old_api": "append",
          "new_api": null,
          "old_text": "bb.append( \"cloned\" , numCloned )",
          "new_text": null,
          "old_line_content": "                bb.append( \"cloned\" , numCloned );",
          "new_line_content": "            {",
          "content_same": false
        },
        {
          "line": 1188,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                    log() << \"moveChunk migrate commit accepted by TO-shard: \" << res << migrateLog;",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 1205,
          "old_api": "subarrayStart",
          "new_api": null,
          "old_text": "cmdBuilder.subarrayStart( \"applyOps\" )",
          "new_text": null,
          "old_line_content": "                BSONArrayBuilder updates( cmdBuilder.subarrayStart( \"applyOps\" ) );",
          "new_line_content": "                BSONObjBuilder cmdBuilder;",
          "content_same": false
        },
        {
          "line": 1717,
          "old_api": "isABSONObj",
          "new_api": null,
          "old_text": "xfer[\"deleted\"].isABSONObj()",
          "new_text": null,
          "old_line_content": "            if ( xfer[\"deleted\"].isABSONObj() ) {",
          "new_line_content": "            bool didAnything = false;",
          "content_same": false
        },
        {
          "line": 1720,
          "old_api": "Obj",
          "new_api": null,
          "old_text": "xfer[\"deleted\"].Obj()",
          "new_text": null,
          "old_line_content": "                BSONObjIterator i( xfer[\"deleted\"].Obj() );",
          "new_line_content": "                RemoveSaver rs( \"moveChunk\" , ns , \"removedDuring\" );",
          "content_same": false
        },
        {
          "line": 1209,
          "old_api": "append",
          "new_api": null,
          "old_text": "op.append( \"op\" , \"u\" )",
          "new_text": null,
          "old_line_content": "                    op.append( \"op\" , \"u\" );",
          "new_line_content": "                    // update for the chunk being moved",
          "content_same": false
        },
        {
          "line": 1210,
          "old_api": "appendBool",
          "new_api": null,
          "old_text": "op.appendBool( \"b\" , false /* no upserting */ )",
          "new_text": null,
          "old_line_content": "                    op.appendBool( \"b\" , false /* no upserting */ );",
          "new_line_content": "                    BSONObjBuilder op;",
          "content_same": false
        },
        {
          "line": 1721,
          "old_api": "more",
          "new_api": null,
          "old_text": "i.more()",
          "new_text": null,
          "old_line_content": "                while ( i.more() ) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1724,
          "old_api": "next",
          "new_api": null,
          "old_text": "i.next().Obj()",
          "new_text": null,
          "old_line_content": "                    BSONObj id = i.next().Obj();",
          "new_line_content": "                    Client::WriteContext cx(ns);",
          "content_same": false
        },
        {
          "line": 1214,
          "old_api": "Chunk::genID(ns, min)",
          "new_api": null,
          "old_text": "Chunk::genID(ns, min)",
          "new_text": null,
          "old_line_content": "                    n.append(ChunkFields::name(), Chunk::genID(ns, min));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1728,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "ns.c_str()",
          "new_text": null,
          "old_line_content": "                    if ( Helpers::findById( cc() , ns.c_str() , id, fullObj ) ) {",
          "new_line_content": "                    // do not apply deletes if they do not belong to the chunk being migrated",
          "content_same": false
        },
        {
          "line": 1729,
          "old_api": "isInRange",
          "new_api": null,
          "old_text": "isInRange( fullObj , min , max , shardKeyPattern )",
          "new_text": null,
          "old_line_content": "                        if ( ! isInRange( fullObj , min , max , shardKeyPattern ) ) {",
          "new_line_content": "                    BSONObj fullObj;",
          "content_same": false
        },
        {
          "line": 1223,
          "old_api": "Chunk::genID(ns, min)",
          "new_api": null,
          "old_text": "Chunk::genID(ns, min)",
          "new_text": null,
          "old_line_content": "                    q.append(ChunkFields::name(), Chunk::genID(ns, min));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1739,
          "old_api": "Helpers::toKeyFormat( id , idIndexPattern )",
          "new_api": null,
          "old_text": "Helpers::toKeyFormat( id , idIndexPattern )",
          "new_text": null,
          "old_line_content": "                    Helpers::toKeyFormat( id , idIndexPattern );",
          "new_line_content": "                    // infer from that correct index to use, e.g. { _id : 1 }",
          "content_same": false
        },
        {
          "line": 1742,
          "old_api": "Helpers::removeRange( ns ,\n                                          id ,\n                                          id,\n                                          idIndexPattern ,\n                                          true , /*maxInclusive*/\n                                          false , /* secondaryThrottle */\n                                          cmdLine.moveParanoia ? &rs : 0 , /*callback*/\n                                          true )",
          "new_api": null,
          "old_text": "Helpers::removeRange( ns ,\n                                          id ,\n                                          id,\n                                          idIndexPattern ,\n                                          true , /*maxInclusive*/\n                                          false , /* secondaryThrottle */\n                                          cmdLine.moveParanoia ? &rs : 0 , /*callback*/\n                                          true )",
          "new_text": null,
          "old_line_content": "                    Helpers::removeRange( ns ,",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1235,
          "old_api": "getShardChunkManager",
          "new_api": null,
          "old_text": "shardingState.getShardChunkManager( ns )",
          "new_text": null,
          "old_line_content": "                ShardChunkManagerPtr chunkManager = shardingState.getShardChunkManager( ns );",
          "new_line_content": "                // TODO expose that manager when installing it",
          "content_same": false
        },
        {
          "line": 1236,
          "old_api": "getNumChunks",
          "new_api": null,
          "old_text": "chunkManager->getNumChunks()",
          "new_text": null,
          "old_line_content": "                if( chunkManager->getNumChunks() > 0 ) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1751,
          "old_api": "ctx",
          "new_api": null,
          "old_text": "cx.ctx().getClient()->getLastOp().asDate()",
          "new_text": null,
          "old_line_content": "                    *lastOpApplied = cx.ctx().getClient()->getLastOp().asDate();",
          "new_line_content": "                                          true ); /*fromMigrate*/",
          "content_same": false
        },
        {
          "line": 1242,
          "old_api": "getNextChunk",
          "new_api": null,
          "old_text": "chunkManager->getNextChunk( lookupKey , &bumpMin , &bumpMax )",
          "new_text": null,
          "old_line_content": "                        chunkManager->getNextChunk( lookupKey , &bumpMin , &bumpMax );",
          "new_line_content": "                    BSONObj bumpMin, bumpMax;",
          "content_same": false
        },
        {
          "line": 1756,
          "old_api": "isABSONObj",
          "new_api": null,
          "old_text": "xfer[\"reload\"].isABSONObj()",
          "new_text": null,
          "old_line_content": "            if ( xfer[\"reload\"].isABSONObj() ) {",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1757,
          "old_api": "Obj",
          "new_api": null,
          "old_text": "xfer[\"reload\"].Obj()",
          "new_text": null,
          "old_line_content": "                BSONObjIterator i( xfer[\"reload\"].Obj() );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1248,
          "old_api": "append",
          "new_api": null,
          "old_text": "op.append( \"op\" , \"u\" )",
          "new_text": null,
          "old_line_content": "                    op.append( \"op\" , \"u\" );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1249,
          "old_api": "appendBool",
          "new_api": null,
          "old_text": "op.appendBool( \"b\" , false )",
          "new_text": null,
          "old_line_content": "                    op.appendBool( \"b\" , false );",
          "new_line_content": "                    BSONObjBuilder op;",
          "content_same": false
        },
        {
          "line": 1761,
          "old_api": "next",
          "new_api": null,
          "old_text": "i.next().Obj()",
          "new_text": null,
          "old_line_content": "                    BSONObj it = i.next().Obj();",
          "new_line_content": "                    Client::WriteContext cx(ns);",
          "content_same": false
        },
        {
          "line": 1253,
          "old_api": "subobjStart",
          "new_api": null,
          "old_text": "op.subobjStart( \"o\" )",
          "new_text": null,
          "old_line_content": "                    BSONObjBuilder n( op.subobjStart( \"o\" ) );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1263,
          "old_api": "Chunk::genID(ns, bumpMin)",
          "new_api": null,
          "old_text": "Chunk::genID(ns, bumpMin)",
          "new_text": null,
          "old_line_content": "                    q.append(ChunkFields::name(), Chunk::genID(ns, bumpMin));",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1777,
          "old_api": "mongo::opReplicatedEnough( lastOpApplied , slaveCount )",
          "new_api": null,
          "old_text": "mongo::opReplicatedEnough( lastOpApplied , slaveCount )",
          "new_text": null,
          "old_line_content": "            return mongo::opReplicatedEnough( lastOpApplied , slaveCount );",
          "new_line_content": "            // TODO opReplicatedEnough should eventually honor priorities and geo-awareness",
          "content_same": false
        },
        {
          "line": 1781,
          "old_api": "opReplicatedEnough",
          "new_api": null,
          "old_text": "opReplicatedEnough( lastOpApplied )",
          "new_text": null,
          "old_line_content": "            if ( ! opReplicatedEnough( lastOpApplied ) ) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1274,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                    log() << \"moveChunk moved last chunk out for collection '\" << ns << \"'\" << migrateLog;",
          "new_line_content": "                else {",
          "content_same": false
        },
        {
          "line": 1277,
          "old_api": "done",
          "new_api": null,
          "old_text": "updates.done()",
          "new_text": null,
          "old_line_content": "                updates.done();",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1790,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "            log() << \"migrate commit succeeded flushing to secondaries for '\" << ns << \"' \" << min << \" -> \" << max << migrateLog;",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1282,
          "old_api": "append",
          "new_api": null,
          "old_text": "b.append(\"ns\", ConfigNS::chunk)",
          "new_text": null,
          "old_line_content": "                    b.append(\"ns\", ConfigNS::chunk);",
          "new_line_content": "                {",
          "content_same": false
        },
        {
          "line": 1283,
          "old_api": "ChunkFields::ns(ns)",
          "new_api": null,
          "old_text": "ChunkFields::ns(ns)",
          "new_text": null,
          "old_line_content": "                    b.append(\"q\", BSON(\"query\" << BSON(ChunkFields::ns(ns)) <<",
          "new_line_content": "                    BSONObjBuilder b;",
          "content_same": false
        },
        {
          "line": 1796,
          "old_api": "commitNow",
          "new_api": null,
          "old_text": "getDur().commitNow()",
          "new_text": null,
          "old_line_content": "                if ( getDur().commitNow() ) {",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1797,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                    log() << \"migrate commit flushed to journal for '\" << ns << \"' \" << min << \" -> \" << max << migrateLog;",
          "new_line_content": "                // if durability is on, force a write to journal",
          "content_same": false
        },
        {
          "line": 1289,
          "old_api": "done",
          "new_api": null,
          "old_text": "bb.done()",
          "new_text": null,
          "old_line_content": "                        bb.done();",
          "new_line_content": "                        // TODO: For backwards compatibility, we can't yet require an epoch here",
          "content_same": false
        },
        {
          "line": 1294,
          "old_api": "done",
          "new_api": null,
          "old_text": "preCond.done()",
          "new_text": null,
          "old_line_content": "                preCond.done();",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1297,
          "old_api": "LOG",
          "new_api": null,
          "old_text": "LOG(7)",
          "new_text": null,
          "old_line_content": "                LOG(7) << \"moveChunk update: \" << cmd << migrateLog;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1303,
          "old_api": "getConfigServer",
          "new_api": null,
          "old_text": "ScopedDbConnection::getInternalScopedDbConnection(\n                                    shardingState.getConfigServer(),\n                                    10.0 )",
          "new_text": null,
          "old_line_content": "                            ScopedDbConnection::getInternalScopedDbConnection(",
          "new_line_content": "                try {",
          "content_same": false
        },
        {
          "line": 1304,
          "old_api": "getConfigServer",
          "new_api": null,
          "old_text": "shardingState.getConfigServer()",
          "new_text": null,
          "old_line_content": "                                    shardingState.getConfigServer(),",
          "new_line_content": "                    scoped_ptr<ScopedDbConnection> conn(",
          "content_same": false
        },
        {
          "line": 1815,
          "old_api": "verify",
          "new_api": null,
          "old_text": "verify(0)",
          "new_text": null,
          "old_line_content": "            verify(0);",
          "new_line_content": "            case ABORT: return \"abort\";",
          "content_same": false
        },
        {
          "line": 1307,
          "old_api": "done",
          "new_api": null,
          "old_text": "conn->done()",
          "new_text": null,
          "old_line_content": "                    conn->done();",
          "new_line_content": "                                    10.0 ) );",
          "content_same": false
        },
        {
          "line": 1310,
          "old_api": "warning",
          "new_api": null,
          "old_text": "warning()",
          "new_text": null,
          "old_line_content": "                    warning() << e << migrateLog;",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1313,
          "old_api": "getInfo",
          "new_api": null,
          "old_text": "e.getInfo().append( b )",
          "new_text": null,
          "old_line_content": "                    e.getInfo().append( b );",
          "new_line_content": "                    ok = false;",
          "content_same": false
        },
        {
          "line": 1314,
          "old_api": "obj",
          "new_api": null,
          "old_text": "b.obj()",
          "new_text": null,
          "old_line_content": "                    cmdResult = b.obj();",
          "new_line_content": "                    BSONObjBuilder b;",
          "content_same": false
        },
        {
          "line": 1826,
          "old_api": "minutes",
          "new_api": null,
          "old_text": "t.minutes()",
          "new_text": null,
          "old_line_content": "            while ( t.minutes() <= 5 ) {",
          "new_line_content": "            Timer t;",
          "content_same": false
        },
        {
          "line": 1827,
          "old_api": "sleepmillis",
          "new_api": null,
          "old_text": "sleepmillis(1)",
          "new_text": null,
          "old_line_content": "                sleepmillis(1);",
          "new_line_content": "            // we wait for the commit to succeed before giving up",
          "content_same": false
        },
        {
          "line": 1832,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "            log() << \"startCommit never finished!\" << migrateLog;",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1326,
          "old_api": "warning",
          "new_api": null,
          "old_text": "warning()",
          "new_text": null,
          "old_line_content": "                    warning() << \"moveChunk commit outcome ongoing: \" << cmd << \" for command :\" << cmdResult << migrateLog;",
          "new_line_content": "                    // that the old state (before migrating) be brought in",
          "content_same": false
        },
        {
          "line": 1327,
          "old_api": "sleepsecs",
          "new_api": null,
          "old_text": "sleepsecs( 10 )",
          "new_text": null,
          "old_line_content": "                    sleepsecs( 10 );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1331,
          "old_api": "getConfigServer",
          "new_api": null,
          "old_text": "ScopedDbConnection::getInternalScopedDbConnection(\n                                        shardingState.getConfigServer(),\n                                        10.0 )",
          "new_text": null,
          "old_line_content": "                                ScopedDbConnection::getInternalScopedDbConnection(",
          "new_line_content": "                    try {",
          "content_same": false
        },
        {
          "line": 1332,
          "old_api": "getConfigServer",
          "new_api": null,
          "old_text": "shardingState.getConfigServer()",
          "new_text": null,
          "old_line_content": "                                        shardingState.getConfigServer(),",
          "new_line_content": "                        scoped_ptr<ScopedDbConnection> conn(",
          "content_same": false
        },
        {
          "line": 1337,
          "old_api": "sort",
          "new_api": null,
          "old_text": "conn->get()->findOne(ConfigNS::chunk,\n                                                           Query(BSON(ChunkFields::ns(ns)))\n                                                               .sort(BSON(ChunkFields::lastmod() << -1)))",
          "new_text": null,
          "old_line_content": "                        BSONObj doc = conn->get()->findOne(ConfigNS::chunk,",
          "new_line_content": "                        // look for the chunk in this shard whose version got bumped",
          "content_same": false
        },
        {
          "line": 1338,
          "old_api": "ChunkFields::ns(ns)",
          "new_api": null,
          "old_text": "ChunkFields::ns(ns)",
          "new_text": null,
          "old_line_content": "                                                           Query(BSON(ChunkFields::ns(ns)))",
          "new_line_content": "                        // we assume that if that mod made it to the config, the applyOps was successful",
          "content_same": false
        },
        {
          "line": 1342,
          "old_api": "ChunkFields::lastmod()",
          "new_api": null,
          "old_text": "ChunkFields::lastmod()",
          "new_text": null,
          "old_line_content": "                            ShardChunkVersion::fromBSON(doc[ChunkFields::lastmod()]);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1345,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                            log() << \"moveChunk commit confirmed\" << migrateLog;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1349,
          "old_api": "error",
          "new_api": null,
          "old_text": "error()",
          "new_text": null,
          "old_line_content": "                            error() << \"moveChunk commit failed: version is at\"",
          "new_line_content": "                        }",
          "content_same": false
        },
        {
          "line": 1352,
          "old_api": "dbexit",
          "new_api": null,
          "old_text": "dbexit( EXIT_SHARDING_ERROR )",
          "new_text": null,
          "old_line_content": "                            dbexit( EXIT_SHARDING_ERROR );",
          "new_line_content": "                                            << checkVersion << \" instead of \" << nextVersion << migrateLog;",
          "content_same": false
        },
        {
          "line": 1355,
          "old_api": "done",
          "new_api": null,
          "old_text": "conn->done()",
          "new_text": null,
          "old_line_content": "                        conn->done();",
          "new_line_content": "                        }",
          "content_same": false
        },
        {
          "line": 1868,
          "old_api": "Client::initThread( \"migrateThread\" )",
          "new_api": null,
          "old_text": "Client::initThread( \"migrateThread\" )",
          "new_text": null,
          "old_line_content": "        Client::initThread( \"migrateThread\" );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1359,
          "old_api": "error",
          "new_api": null,
          "old_text": "error()",
          "new_text": null,
          "old_line_content": "                        error() << \"moveChunk failed to get confirmation of commit\" << migrateLog;",
          "new_line_content": "                    }",
          "content_same": false
        },
        {
          "line": 1360,
          "old_api": "error",
          "new_api": null,
          "old_text": "error()",
          "new_text": null,
          "old_line_content": "                        error() << \"TERMINATING\" << migrateLog;",
          "new_line_content": "                    catch ( ... ) {",
          "content_same": false
        },
        {
          "line": 1871,
          "old_api": "getAuthenticationInfo",
          "new_api": null,
          "old_text": "cc().getAuthenticationInfo()->authorize(\"local\", internalSecurity.user)",
          "new_text": null,
          "old_line_content": "            cc().getAuthenticationInfo()->authorize(\"local\", internalSecurity.user);",
          "new_line_content": "        if (!noauth) {",
          "content_same": false
        },
        {
          "line": 1874,
          "old_api": "shutdown",
          "new_api": null,
          "old_text": "cc().shutdown()",
          "new_text": null,
          "old_line_content": "        cc().shutdown();",
          "new_line_content": "        }",
          "content_same": false
        },
        {
          "line": 1365,
          "old_api": "setInCriticalSection",
          "new_api": null,
          "old_text": "migrateFromStatus.setInCriticalSection( false )",
          "new_text": null,
          "old_line_content": "                migrateFromStatus.setInCriticalSection( false );",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1368,
          "old_api": "logChange",
          "new_api": null,
          "old_text": "configServer.logChange( \"moveChunk.commit\" , ns , chunkInfo )",
          "new_text": null,
          "old_line_content": "                configServer.logChange( \"moveChunk.commit\" , ns , chunkInfo );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1371,
          "old_api": "done",
          "new_api": null,
          "old_text": "migrateFromStatus.done()",
          "new_text": null,
          "old_line_content": "            migrateFromStatus.done();",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1372,
          "old_api": "done",
          "new_api": null,
          "old_text": "timing.done(5)",
          "new_text": null,
          "old_line_content": "            timing.done(5);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1885,
          "old_api": "getActive",
          "new_api": null,
          "old_text": "migrateStatus.getActive()",
          "new_text": null,
          "old_line_content": "            if ( migrateStatus.getActive() ) {",
          "new_line_content": "        bool run(const string& , BSONObj& cmdObj, int, string& errmsg, BSONObjBuilder& result, bool) {",
          "content_same": false
        },
        {
          "line": 1379,
          "old_api": "getOwned",
          "new_api": null,
          "old_text": "min.getOwned()",
          "new_text": null,
          "old_line_content": "                c.min = min.getOwned();",
          "new_line_content": "                c.secondaryThrottle = secondaryThrottle;",
          "content_same": false
        },
        {
          "line": 1380,
          "old_api": "getOwned",
          "new_api": null,
          "old_text": "max.getOwned()",
          "new_text": null,
          "old_line_content": "                c.max = max.getOwned();",
          "new_line_content": "                c.ns = ns;",
          "content_same": false
        },
        {
          "line": 1892,
          "old_api": "str::stream()",
          "new_api": null,
          "old_text": "str::stream()",
          "new_text": null,
          "old_line_content": "                    str::stream() ",
          "new_line_content": "            if ( OldDataCleanup::_numThreads > 0 ) {",
          "content_same": false
        },
        {
          "line": 1898,
          "old_api": "ok",
          "new_api": null,
          "old_text": "configServer.ok()",
          "new_text": null,
          "old_line_content": "            if ( ! configServer.ok() )",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1899,
          "old_api": "String",
          "new_api": null,
          "old_text": "cmdObj[\"configServer\"].String()",
          "new_text": null,
          "old_line_content": "                configServer.init( cmdObj[\"configServer\"].String() );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1388,
          "old_api": "log",
          "new_api": null,
          "old_text": "log()",
          "new_text": null,
          "old_line_content": "                    log() << \"doing delete inline\" << migrateLog;",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1904,
          "old_api": "String",
          "new_api": null,
          "old_text": "cmdObj[\"from\"].String()",
          "new_text": null,
          "old_line_content": "            migrateStatus.from = cmdObj[\"from\"].String();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1395,
          "old_api": "done",
          "new_api": null,
          "old_text": "timing.done(6)",
          "new_text": null,
          "old_line_content": "            timing.done(6);",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1915,
          "old_api": "Helpers::toKeyFormat( migrateStatus.min , keya )",
          "new_api": null,
          "old_text": "Helpers::toKeyFormat( migrateStatus.min , keya )",
          "new_text": null,
          "old_line_content": "                Helpers::toKeyFormat( migrateStatus.min , keya );",
          "new_line_content": "                // specifiers provided.",
          "content_same": false
        },
        {
          "line": 1404,
          "old_api": "getInCriticalSection",
          "new_api": null,
          "old_text": "migrateFromStatus.getInCriticalSection()",
          "new_text": null,
          "old_line_content": "        return migrateFromStatus.getInCriticalSection();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1916,
          "old_api": "Helpers::toKeyFormat( migrateStatus.max , keyb )",
          "new_api": null,
          "old_text": "Helpers::toKeyFormat( migrateStatus.max , keyb )",
          "new_text": null,
          "old_line_content": "                Helpers::toKeyFormat( migrateStatus.max , keyb );",
          "new_line_content": "                BSONObj keya , keyb;",
          "content_same": false
        },
        {
          "line": 1924,
          "old_api": "getOwned",
          "new_api": null,
          "old_text": "keya.getOwned()",
          "new_text": null,
          "old_line_content": "                migrateStatus.shardKeyPattern = keya.getOwned();",
          "new_line_content": "                    \" chunk range specifiers.  Inferred shard key: \" << keya << endl;",
          "content_same": false
        },
        {
          "line": 1927,
          "old_api": "anyReplEnabled",
          "new_api": null,
          "old_text": "anyReplEnabled()",
          "new_text": null,
          "old_line_content": "            if ( migrateStatus.secondaryThrottle && ! anyReplEnabled() ) {",
          "new_line_content": "            }",
          "content_same": false
        },
        {
          "line": 1928,
          "old_api": "warning",
          "new_api": null,
          "old_text": "warning()",
          "new_text": null,
          "old_line_content": "                warning() << \"secondaryThrottle asked for, but not replication\" << endl;",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1934,
          "old_api": "appendBool",
          "new_api": null,
          "old_text": "result.appendBool( \"started\" , true )",
          "new_text": null,
          "old_line_content": "            result.appendBool( \"started\" , true );",
          "new_line_content": "            boost::thread m( migrateThread );",
          "content_same": false
        },
        {
          "line": 1428,
          "old_api": "verify",
          "new_api": null,
          "old_text": "verify( ! active )",
          "new_text": null,
          "old_line_content": "            verify( ! active );",
          "new_line_content": "            scoped_lock l(m_active); // reading and writing 'active'",
          "content_same": false
        },
        {
          "line": 1945,
          "old_api": "status",
          "new_api": null,
          "old_text": "migrateStatus.status( result )",
          "new_text": null,
          "old_line_content": "            migrateStatus.status( result );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1442,
          "old_api": "_go",
          "new_api": null,
          "old_text": "_go()",
          "new_text": null,
          "old_line_content": "                _go();",
          "new_line_content": "        void go() {",
          "content_same": false
        },
        {
          "line": 1956,
          "old_api": "startCommit",
          "new_api": null,
          "old_text": "migrateStatus.startCommit()",
          "new_text": null,
          "old_line_content": "            bool ok = migrateStatus.startCommit();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1957,
          "old_api": "status",
          "new_api": null,
          "old_text": "migrateStatus.status( result )",
          "new_text": null,
          "old_line_content": "            migrateStatus.status( result );",
          "new_line_content": "        bool run(const string& , BSONObj& cmdObj, int, string& errmsg, BSONObjBuilder& result, bool) {",
          "content_same": false
        },
        {
          "line": 1446,
          "old_api": "what",
          "new_api": null,
          "old_text": "e.what()",
          "new_text": null,
          "old_line_content": "                errmsg = e.what();",
          "new_line_content": "            catch ( std::exception& e ) {",
          "content_same": false
        },
        {
          "line": 1447,
          "old_api": "what",
          "new_api": null,
          "old_text": "e.what()",
          "new_text": null,
          "old_line_content": "                error() << \"migrate failed: \" << e.what() << migrateLog;",
          "new_line_content": "                state = FAIL;",
          "content_same": false
        },
        {
          "line": 1452,
          "old_api": "error",
          "new_api": null,
          "old_text": "error()",
          "new_text": null,
          "old_line_content": "                error() << \"migrate failed with unknown exception\" << migrateLog;",
          "new_line_content": "                state = FAIL;",
          "content_same": false
        },
        {
          "line": 1968,
          "old_api": "abort",
          "new_api": null,
          "old_text": "migrateStatus.abort()",
          "new_text": null,
          "old_line_content": "            migrateStatus.abort();",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1969,
          "old_api": "status",
          "new_api": null,
          "old_text": "migrateStatus.status( result )",
          "new_text": null,
          "old_line_content": "            migrateStatus.status( result );",
          "new_line_content": "        bool run(const string& , BSONObj& cmdObj, int, string& errmsg, BSONObjBuilder& result, bool) {",
          "content_same": false
        },
        {
          "line": 1458,
          "old_api": "getActive",
          "new_api": null,
          "old_text": "getActive()",
          "new_text": null,
          "old_line_content": "            verify( getActive() );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1459,
          "old_api": "verify",
          "new_api": null,
          "old_text": "verify( state == READY )",
          "new_text": null,
          "old_line_content": "            verify( state == READY );",
          "new_line_content": "        void _go() {",
          "content_same": false
        },
        {
          "line": 1979,
          "old_api": "BSON",
          "new_api": null,
          "old_text": "BSON( \"x\" << 1 )",
          "new_text": null,
          "old_line_content": "            BSONObj min = BSON( \"x\" << 1 );",
          "new_line_content": "    public:",
          "content_same": false
        },
        {
          "line": 1980,
          "old_api": "BSON",
          "new_api": null,
          "old_text": "BSON( \"x\" << 5 )",
          "new_text": null,
          "old_line_content": "            BSONObj max = BSON( \"x\" << 5 );",
          "new_line_content": "        void run() {",
          "content_same": false
        },
        {
          "line": 1471,
          "old_api": "getLastError",
          "new_api": null,
          "old_text": "conn->getLastError()",
          "new_text": null,
          "old_line_content": "            conn->getLastError(); // just test connection",
          "new_line_content": "                    ScopedDbConnection::getScopedDbConnection( from ) );",
          "content_same": false
        },
        {
          "line": 1984,
          "old_api": "BSON",
          "new_api": null,
          "old_text": "BSON( \"x\" << 1 )",
          "new_text": null,
          "old_line_content": "            verify( isInRange( BSON( \"x\" << 1 ) , min , max , skey ) );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1477,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "ns.c_str()",
          "new_text": null,
          "old_line_content": "                if ( ! nsdetails( ns.c_str() ) ) {",
          "new_line_content": "                Client::WriteContext ctx( ns );",
          "content_same": false
        },
        {
          "line": 1478,
          "old_api": "NamespaceString",
          "new_api": null,
          "old_text": "NamespaceString( ns )",
          "new_text": null,
          "old_line_content": "                    string system_namespaces = NamespaceString( ns ).db + \".system.namespaces\";",
          "new_line_content": "                // Only copy if ns doesn't already exist",
          "content_same": false
        },
        {
          "line": 1991,
          "old_api": "firstElement",
          "new_api": null,
          "old_text": "obj.firstElement()",
          "new_text": null,
          "old_line_content": "            BSONObj min2 = BSON( \"x\" << BSONElementHasher::hash64( obj.firstElement() , 0 ) - 2 );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1483,
          "old_api": "warning",
          "new_api": null,
          "old_text": "warning()",
          "new_text": null,
          "old_line_content": "                            warning() << \"failed to create collection with options: \" << errmsg",
          "new_line_content": "                        string errmsg;",
          "content_same": false
        },
        {
          "line": 1996,
          "old_api": "BSON",
          "new_api": null,
          "old_text": "BSON( \"x\" << 3 )",
          "new_text": null,
          "old_line_content": "            verify( ! isInRange( BSON( \"x\" << 3 ) , min , max , hashedKey ) );",
          "new_line_content": "",
          "content_same": false
        },
        {
          "line": 1494,
          "old_api": "getIndexes",
          "new_api": null,
          "old_text": "conn->getIndexes( ns )",
          "new_text": null,
          "old_line_content": "                    auto_ptr<DBClientCursor> indexes = conn->getIndexes( ns );",
          "new_line_content": "                vector<BSONObj> all;",
          "content_same": false
        },
        {
          "line": 1497,
          "old_api": "getOwned",
          "new_api": null,
          "old_text": "indexes->next().getOwned()",
          "new_text": null,
          "old_line_content": "                        all.push_back( indexes->next().getOwned() );",
          "new_line_content": "                    ",
          "content_same": false
        },
        {
          "line": 1501,
          "old_api": "size",
          "new_api": null,
          "old_text": "all.size()",
          "new_text": null,
          "old_line_content": "                for ( unsigned i=0; i<all.size(); i++ ) {",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1504,
          "old_api": "database",
          "new_api": null,
          "old_text": "cc().database()",
          "new_text": null,
          "old_line_content": "                    string system_indexes = cc().database()->name + \".system.indexes\";",
          "new_line_content": "                    BSONObj idx = all[i];",
          "content_same": false
        },
        {
          "line": 1505,
          "old_api": "c_str",
          "new_api": null,
          "old_text": "system_indexes.c_str()",
          "new_text": null,
          "old_line_content": "                    theDataFileMgr.insertAndLog( system_indexes.c_str() , idx, true /* flag fromMigrate in oplog */ );",
          "new_line_content": "                    Client::WriteContext ct( ns );",
          "content_same": false
        },
        {
          "line": 1508,
          "old_api": "done",
          "new_api": null,
          "old_text": "timing.done(1)",
          "new_text": null,
          "old_line_content": "                timing.done(1);",
          "new_line_content": "                }",
          "content_same": false
        },
        {
          "line": 1514,
          "old_api": "Helpers::removeRange( ns ,\n                                                      min ,\n                                                      max ,\n                                                      findShardKeyIndexPattern_unlocked( ns , shardKeyPattern ) , \n                                                      false , /*maxInclusive*/\n                                                      secondaryThrottle , /* secondaryThrottle */\n                                                      cmdLine.moveParanoia ? &rs : 0 , /*callback*/\n                                                      true )",
          "new_api": null,
          "old_text": "Helpers::removeRange( ns ,\n                                                      min ,\n                                                      max ,\n                                                      findShardKeyIndexPattern_unlocked( ns , shardKeyPattern ) , \n                                                      false , /*maxInclusive*/\n                                                      secondaryThrottle , /* secondaryThrottle */\n                                                      cmdLine.moveParanoia ? &rs : 0 , /*callback*/\n                                                      true )",
          "new_text": null,
          "old_line_content": "                long long num = Helpers::removeRange( ns ,",
          "new_line_content": "                // 2. delete any data already in range",
          "content_same": false
        },
        {
          "line": 1517,
          "old_api": "findShardKeyIndexPattern_unlocked",
          "new_api": null,
          "old_text": "findShardKeyIndexPattern_unlocked( ns , shardKeyPattern )",
          "new_text": null,
          "old_line_content": "                                                      findShardKeyIndexPattern_unlocked( ns , shardKeyPattern ) , ",
          "new_line_content": "                                                      min ,",
          "content_same": false
        },
        {
          "line": 1523,
          "old_api": "warning",
          "new_api": null,
          "old_text": "warning()",
          "new_text": null,
          "old_line_content": "                    warning() << \"moveChunkCmd deleted data already in chunk # objects: \" << num << migrateLog;",
          "new_line_content": "                                                      true ); /* flag fromMigrate in oplog */",
          "content_same": false
        },
        {
          "line": 1535,
          "old_api": "BSON",
          "new_api": null,
          "old_text": "BSON( \"_migrateClone\" << 1 )",
          "new_text": null,
          "old_line_content": "                    if ( ! conn->runCommand( \"admin\" , BSON( \"_migrateClone\" << 1 ) , res ) ) {  // gets array of objects to copy, in disk order",
          "new_line_content": "                while ( true ) {",
          "content_same": false
        }
      ]
    },
    "api_summary": {
      "total_replacements": 84,
      "total_additions": 177,
      "total_deletions": 177,
      "total_api_changes": 438
    },
    "non_api_changes": {
      "has_non_api_changes": true,
      "evidence": {
        "total_diff_lines": 3,
        "api_related_lines": 438,
        "non_api_lines": 1,
        "non_api_line_numbers": [
          1081
        ]
      }
    },
    "api_calls_before": 733,
    "api_calls_after": 734,
    "diff_info": {
      "added_lines": 3,
      "removed_lines": 1,
      "total_diff_lines": 16
    }
  }
}